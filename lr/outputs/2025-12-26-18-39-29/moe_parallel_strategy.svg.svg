<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7399pt" height="9000pt"
 viewBox="0.00 0.00 1775.64 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.77 0.77) rotate(0) translate(4 11743.38)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11743.38 9653,-11743.38 9653,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<path fill="lightgray" stroke="black" d="M93,-10239.39C93,-10239.39 9508,-10239.39 9508,-10239.39 9514,-10239.39 9520,-10245.39 9520,-10251.39 9520,-10251.39 9520,-11671.3 9520,-11671.3 9520,-11677.3 9514,-11683.3 9508,-11683.3 9508,-11683.3 93,-11683.3 93,-11683.3 87,-11683.3 81,-11677.3 81,-11671.3 81,-11671.3 81,-10251.39 81,-10251.39 81,-10245.39 87,-10239.39 93,-10239.39"/>
<text text-anchor="middle" x="4800.5" y="-11668.1" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_1</title>
<path fill="lightgray" stroke="black" d="M20,-8787.49C20,-8787.49 9435,-8787.49 9435,-8787.49 9441,-8787.49 9447,-8793.49 9447,-8799.49 9447,-8799.49 9447,-10219.39 9447,-10219.39 9447,-10225.39 9441,-10231.39 9435,-10231.39 9435,-10231.39 20,-10231.39 20,-10231.39 14,-10231.39 8,-10225.39 8,-10219.39 8,-10219.39 8,-8799.49 8,-8799.49 8,-8793.49 14,-8787.49 20,-8787.49"/>
<text text-anchor="middle" x="4727.5" y="-10216.19" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_2</title>
<path fill="lightgray" stroke="black" d="M166,-7335.59C166,-7335.59 9581,-7335.59 9581,-7335.59 9587,-7335.59 9593,-7341.59 9593,-7347.59 9593,-7347.59 9593,-8767.49 9593,-8767.49 9593,-8773.49 9587,-8779.49 9581,-8779.49 9581,-8779.49 166,-8779.49 166,-8779.49 160,-8779.49 154,-8773.49 154,-8767.49 154,-8767.49 154,-7347.59 154,-7347.59 154,-7341.59 160,-7335.59 166,-7335.59"/>
<text text-anchor="middle" x="4873.5" y="-8764.29" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (Layers 4&#45;5)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_3</title>
<path fill="lightgray" stroke="black" d="M93,-5883.69C93,-5883.69 9508,-5883.69 9508,-5883.69 9514,-5883.69 9520,-5889.69 9520,-5895.69 9520,-5895.69 9520,-7315.59 9520,-7315.59 9520,-7321.59 9514,-7327.59 9508,-7327.59 9508,-7327.59 93,-7327.59 93,-7327.59 87,-7327.59 81,-7321.59 81,-7315.59 81,-7315.59 81,-5895.69 81,-5895.69 81,-5889.69 87,-5883.69 93,-5883.69"/>
<text text-anchor="middle" x="4800.5" y="-7312.39" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (Layers 6&#45;7)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage_4</title>
<path fill="lightgray" stroke="black" d="M20,-4431.79C20,-4431.79 9435,-4431.79 9435,-4431.79 9441,-4431.79 9447,-4437.79 9447,-4443.79 9447,-4443.79 9447,-5863.69 9447,-5863.69 9447,-5869.69 9441,-5875.69 9435,-5875.69 9435,-5875.69 20,-5875.69 20,-5875.69 14,-5875.69 8,-5869.69 8,-5863.69 8,-5863.69 8,-4443.79 8,-4443.79 8,-4437.79 14,-4431.79 20,-4431.79"/>
<text text-anchor="middle" x="4727.5" y="-5860.49" font-family="Times,serif" font-size="14.00">Pipeline Stage 4 (Layers 8&#45;9)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage_5</title>
<path fill="lightgray" stroke="black" d="M213,-2979.89C213,-2979.89 9628,-2979.89 9628,-2979.89 9634,-2979.89 9640,-2985.89 9640,-2991.89 9640,-2991.89 9640,-4411.79 9640,-4411.79 9640,-4417.79 9634,-4423.79 9628,-4423.79 9628,-4423.79 213,-4423.79 213,-4423.79 207,-4423.79 201,-4417.79 201,-4411.79 201,-4411.79 201,-2991.89 201,-2991.89 201,-2985.89 207,-2979.89 213,-2979.89"/>
<text text-anchor="middle" x="4920.5" y="-4408.59" font-family="Times,serif" font-size="14.00">Pipeline Stage 5 (Layers 10&#45;11)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_stage_6</title>
<path fill="lightgray" stroke="black" d="M130,-1527.98C130,-1527.98 9545,-1527.98 9545,-1527.98 9551,-1527.98 9557,-1533.98 9557,-1539.98 9557,-1539.98 9557,-2959.89 9557,-2959.89 9557,-2965.89 9551,-2971.89 9545,-2971.89 9545,-2971.89 130,-2971.89 130,-2971.89 124,-2971.89 118,-2965.89 118,-2959.89 118,-2959.89 118,-1539.98 118,-1539.98 118,-1533.98 124,-1527.98 130,-1527.98"/>
<text text-anchor="middle" x="4837.5" y="-2956.69" font-family="Times,serif" font-size="14.00">Pipeline Stage 6 (Layers 12&#45;13)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_stage_7</title>
<path fill="lightgray" stroke="black" d="M214,-76.08C214,-76.08 9629,-76.08 9629,-76.08 9635,-76.08 9641,-82.08 9641,-88.08 9641,-88.08 9641,-1507.98 9641,-1507.98 9641,-1513.98 9635,-1519.98 9629,-1519.98 9629,-1519.98 214,-1519.98 214,-1519.98 208,-1519.98 202,-1513.98 202,-1507.98 202,-1507.98 202,-88.08 202,-88.08 202,-82.08 208,-76.08 214,-76.08"/>
<text text-anchor="middle" x="4921.5" y="-1504.78" font-family="Times,serif" font-size="14.00">Pipeline Stage 7 (Layers 14&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="4800" cy="-11715.34" rx="209.11" ry="24.08"/>
<text text-anchor="middle" x="4800" y="-11723.14" font-family="Times,serif" font-size="9.00">Input</text>
<text text-anchor="middle" x="4800" y="-11713.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-11703.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- q_proj_0 -->
<g id="node2" class="node">
<title>q_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="5262,-11652.3 4966,-11652.3 4966,-11608.3 5262,-11608.3 5262,-11652.3"/>
<text text-anchor="middle" x="5114" y="-11643.1" font-family="Times,serif" font-size="9.00">Q Projection L0</text>
<text text-anchor="middle" x="5114" y="-11633.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="5114" y="-11623.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5114" y="-11613.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;q_proj_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;q_proj_0</title>
<path fill="none" stroke="black" d="M4908.51,-11694.72C4924.84,-11691.24 4941.42,-11687.4 4957,-11683.3 4986.81,-11675.45 5019.22,-11665.04 5046.81,-11655.59"/>
<polygon fill="black" stroke="black" points="5048.05,-11658.87 5056.36,-11652.3 5045.77,-11652.25 5048.05,-11658.87"/>
</g>
<!-- k_proj_0 -->
<g id="node3" class="node">
<title>k_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="4948,-11652.3 4652,-11652.3 4652,-11608.3 4948,-11608.3 4948,-11652.3"/>
<text text-anchor="middle" x="4800" y="-11643.1" font-family="Times,serif" font-size="9.00">K Projection L0</text>
<text text-anchor="middle" x="4800" y="-11633.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-11623.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-11613.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;k_proj_0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M4800,-11691.21C4800,-11682.35 4800,-11672.09 4800,-11662.6"/>
<polygon fill="black" stroke="black" points="4803.5,-11662.32 4800,-11652.32 4796.5,-11662.32 4803.5,-11662.32"/>
</g>
<!-- v_proj_0 -->
<g id="node4" class="node">
<title>v_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="4634,-11652.3 4338,-11652.3 4338,-11608.3 4634,-11608.3 4634,-11652.3"/>
<text text-anchor="middle" x="4486" y="-11643.1" font-family="Times,serif" font-size="9.00">V Projection L0</text>
<text text-anchor="middle" x="4486" y="-11633.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4486" y="-11623.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4486" y="-11613.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;v_proj_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M4691.49,-11694.72C4675.16,-11691.24 4658.58,-11687.4 4643,-11683.3 4613.19,-11675.45 4580.78,-11665.04 4553.19,-11655.59"/>
<polygon fill="black" stroke="black" points="4554.23,-11652.25 4543.64,-11652.3 4551.95,-11658.87 4554.23,-11652.25"/>
</g>
<!-- attn_scores_0 -->
<g id="node5" class="node">
<title>attn_scores_0</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-11572.3 4633.5,-11572.3 4633.5,-11528.3 4966.5,-11528.3 4966.5,-11572.3"/>
<text text-anchor="middle" x="4800" y="-11563.1" font-family="Times,serif" font-size="9.00">Attention Scores L0</text>
<text text-anchor="middle" x="4800" y="-11553.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-11543.1" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-11533.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_0&#45;&gt;attn_scores_0 -->
<g id="edge4" class="edge">
<title>q_proj_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M5029.44,-11608.29C4987.82,-11597.95 4937.49,-11585.45 4894.59,-11574.79"/>
<polygon fill="black" stroke="black" points="4895.26,-11571.35 4884.71,-11572.34 4893.57,-11578.15 4895.26,-11571.35"/>
</g>
<!-- k_proj_0&#45;&gt;attn_scores_0 -->
<g id="edge5" class="edge">
<title>k_proj_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M4800,-11607.98C4800,-11600.09 4800,-11590.98 4800,-11582.4"/>
<polygon fill="black" stroke="black" points="4803.5,-11582.31 4800,-11572.31 4796.5,-11582.31 4803.5,-11582.31"/>
</g>
<!-- v_proj_0&#45;&gt;attn_scores_0 -->
<g id="edge6" class="edge">
<title>v_proj_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M4570.56,-11608.29C4612.18,-11597.95 4662.51,-11585.45 4705.41,-11574.79"/>
<polygon fill="black" stroke="black" points="4706.43,-11578.15 4715.29,-11572.34 4704.74,-11571.35 4706.43,-11578.15"/>
</g>
<!-- softmax_0 -->
<g id="node6" class="node">
<title>softmax_0</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-11492.3 4633.5,-11492.3 4633.5,-11448.3 4966.5,-11448.3 4966.5,-11492.3"/>
<text text-anchor="middle" x="4800" y="-11483.1" font-family="Times,serif" font-size="9.00">Softmax L0</text>
<text text-anchor="middle" x="4800" y="-11473.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-11463.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4800" y="-11453.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_0&#45;&gt;softmax_0 -->
<g id="edge7" class="edge">
<title>attn_scores_0&#45;&gt;softmax_0</title>
<path fill="none" stroke="black" d="M4800,-11527.98C4800,-11520.09 4800,-11510.98 4800,-11502.4"/>
<polygon fill="black" stroke="black" points="4803.5,-11502.31 4800,-11492.31 4796.5,-11502.31 4803.5,-11502.31"/>
</g>
<!-- attn_out_0 -->
<g id="node7" class="node">
<title>attn_out_0</title>
<polygon fill="lightgreen" stroke="black" points="4948,-11412.3 4652,-11412.3 4652,-11368.3 4948,-11368.3 4948,-11412.3"/>
<text text-anchor="middle" x="4800" y="-11403.1" font-family="Times,serif" font-size="9.00">Attention Output L0</text>
<text text-anchor="middle" x="4800" y="-11393.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-11383.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-11373.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_0&#45;&gt;attn_out_0 -->
<g id="edge8" class="edge">
<title>softmax_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M4800,-11447.98C4800,-11440.09 4800,-11430.98 4800,-11422.4"/>
<polygon fill="black" stroke="black" points="4803.5,-11422.31 4800,-11412.31 4796.5,-11422.31 4803.5,-11422.31"/>
</g>
<!-- gate_0 -->
<g id="node8" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="5099.74,-11332.3 4622.92,-11332.3 4500.26,-11244.3 4977.08,-11244.3 5099.74,-11332.3"/>
<text text-anchor="middle" x="4800" y="-11301.1" font-family="Times,serif" font-size="9.00">Gate L0</text>
<text text-anchor="middle" x="4800" y="-11291.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="4800" y="-11281.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-11271.1" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_0&#45;&gt;gate_0 -->
<g id="edge9" class="edge">
<title>attn_out_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M4800,-11368.09C4800,-11360.59 4800,-11351.78 4800,-11342.82"/>
<polygon fill="black" stroke="black" points="4803.5,-11342.7 4800,-11332.7 4796.5,-11342.7 4803.5,-11342.7"/>
</g>
<!-- route_0_0 -->
<g id="node9" class="node">
<title>route_0_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="523" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="523" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="523" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="523" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_0 -->
<g id="edge10" class="edge">
<title>gate_0&#45;&gt;route_0_0</title>
<path fill="none" stroke="black" d="M4560.09,-11287.34C3949.43,-11286.37 2286.63,-11277.08 903,-11208.3 837.75,-11205.05 766.32,-11199.83 703.17,-11194.64"/>
<polygon fill="black" stroke="black" points="703.36,-11191.15 693.11,-11193.81 702.79,-11198.12 703.36,-11191.15"/>
</g>
<!-- route_0_1 -->
<g id="node13" class="node">
<title>route_0_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1113" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1113" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1113" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 2,3</text>
<text text-anchor="middle" x="1113" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_1 -->
<g id="edge15" class="edge">
<title>gate_0&#45;&gt;route_0_1</title>
<path fill="none" stroke="black" d="M4558.4,-11286.09C4011.99,-11282.36 2639.53,-11267.37 1493,-11208.3 1427.91,-11204.94 1356.67,-11199.71 1293.63,-11194.55"/>
<polygon fill="black" stroke="black" points="1293.84,-11191.05 1283.59,-11193.72 1293.27,-11198.03 1293.84,-11191.05"/>
</g>
<!-- route_0_2 -->
<g id="node17" class="node">
<title>route_0_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1703" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1703" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1703" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 4,5</text>
<text text-anchor="middle" x="1703" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_2 -->
<g id="edge20" class="edge">
<title>gate_0&#45;&gt;route_0_2</title>
<path fill="none" stroke="black" d="M4555.82,-11284.29C4079.8,-11277.52 2994.5,-11257.63 2083,-11208.3 2018.08,-11204.78 1947.02,-11199.53 1884.1,-11194.39"/>
<polygon fill="black" stroke="black" points="1884.32,-11190.9 1874.07,-11193.57 1883.75,-11197.88 1884.32,-11190.9"/>
</g>
<!-- route_0_3 -->
<g id="node21" class="node">
<title>route_0_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2293" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2293" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2293" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 6,7</text>
<text text-anchor="middle" x="2293" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_3 -->
<g id="edge25" class="edge">
<title>gate_0&#45;&gt;route_0_3</title>
<path fill="none" stroke="black" d="M4551.78,-11281.45C4154.71,-11271.35 3352.24,-11247.81 2673,-11208.3 2608.41,-11204.54 2537.73,-11199.26 2475.03,-11194.17"/>
<polygon fill="black" stroke="black" points="2475.29,-11190.68 2465.04,-11193.35 2474.72,-11197.65 2475.29,-11190.68"/>
</g>
<!-- route_0_4 -->
<g id="node25" class="node">
<title>route_0_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2883" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2883" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2883" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 8,9</text>
<text text-anchor="middle" x="2883" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_4 -->
<g id="edge30" class="edge">
<title>gate_0&#45;&gt;route_0_4</title>
<path fill="none" stroke="black" d="M4544.91,-11276.35C4239.88,-11262.76 3713.93,-11237.75 3263,-11208.3 3199.04,-11204.12 3129.08,-11198.79 3066.82,-11193.78"/>
<polygon fill="black" stroke="black" points="3066.74,-11190.27 3056.49,-11192.95 3066.18,-11197.24 3066.74,-11190.27"/>
</g>
<!-- route_0_5 -->
<g id="node29" class="node">
<title>route_0_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3473" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3473" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3473" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 10,11</text>
<text text-anchor="middle" x="3473" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_5 -->
<g id="edge35" class="edge">
<title>gate_0&#45;&gt;route_0_5</title>
<path fill="none" stroke="black" d="M4529.06,-11265.02C4269.32,-11243.66 3884.23,-11212 3657.92,-11193.39"/>
<polygon fill="black" stroke="black" points="3658.18,-11189.9 3647.93,-11192.57 3657.61,-11196.87 3658.18,-11189.9"/>
</g>
<!-- route_0_6 -->
<g id="node33" class="node">
<title>route_0_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4063" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4063" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4063" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 12,13</text>
<text text-anchor="middle" x="4063" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_6 -->
<g id="edge40" class="edge">
<title>gate_0&#45;&gt;route_0_6</title>
<path fill="none" stroke="black" d="M4509.51,-11244.29C4408.8,-11229.38 4299.94,-11213.26 4214.92,-11200.67"/>
<polygon fill="black" stroke="black" points="4215.34,-11197.2 4204.93,-11199.2 4214.31,-11204.12 4215.34,-11197.2"/>
</g>
<!-- route_0_7 -->
<g id="node37" class="node">
<title>route_0_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4590" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4590" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4590" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 14,15</text>
<text text-anchor="middle" x="4590" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4590" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_7 -->
<g id="edge45" class="edge">
<title>gate_0&#45;&gt;route_0_7</title>
<path fill="none" stroke="black" d="M4717,-11244.17C4696.22,-11233.38 4674.24,-11221.95 4654.51,-11211.7"/>
<polygon fill="black" stroke="black" points="4656.1,-11208.59 4645.62,-11207.08 4652.88,-11214.8 4656.1,-11208.59"/>
</g>
<!-- route_0_8 -->
<g id="node41" class="node">
<title>route_0_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5010" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5010" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5010" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="5010" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5010" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_8 -->
<g id="edge50" class="edge">
<title>gate_0&#45;&gt;route_0_8</title>
<path fill="none" stroke="black" d="M4883,-11244.17C4903.78,-11233.38 4925.76,-11221.95 4945.49,-11211.7"/>
<polygon fill="black" stroke="black" points="4947.12,-11214.8 4954.38,-11207.08 4943.9,-11208.59 4947.12,-11214.8"/>
</g>
<!-- route_0_9 -->
<g id="node45" class="node">
<title>route_0_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5538" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5538" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5538" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 34,35</text>
<text text-anchor="middle" x="5538" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_9 -->
<g id="edge55" class="edge">
<title>gate_0&#45;&gt;route_0_9</title>
<path fill="none" stroke="black" d="M4996.8,-11258.2C5118.76,-11240.17 5273.08,-11217.35 5385.69,-11200.7"/>
<polygon fill="black" stroke="black" points="5386.39,-11204.14 5395.77,-11199.21 5385.37,-11197.21 5386.39,-11204.14"/>
</g>
<!-- route_0_10 -->
<g id="node49" class="node">
<title>route_0_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6128" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6128" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6128" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 36,37</text>
<text text-anchor="middle" x="6128" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_10 -->
<g id="edge60" class="edge">
<title>gate_0&#45;&gt;route_0_10</title>
<path fill="none" stroke="black" d="M5013,-11269.8C5270.37,-11248.65 5699.14,-11213.42 5943.18,-11193.37"/>
<polygon fill="black" stroke="black" points="5943.54,-11196.85 5953.22,-11192.54 5942.96,-11189.87 5943.54,-11196.85"/>
</g>
<!-- route_0_11 -->
<g id="node53" class="node">
<title>route_0_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6718" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6718" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6718" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 38,39</text>
<text text-anchor="middle" x="6718" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_11 -->
<g id="edge65" class="edge">
<title>gate_0&#45;&gt;route_0_11</title>
<path fill="none" stroke="black" d="M5023.94,-11277.74C5323.44,-11264.52 5870.94,-11238.79 6338,-11208.3 6401.96,-11204.12 6471.92,-11198.79 6534.18,-11193.78"/>
<polygon fill="black" stroke="black" points="6534.82,-11197.24 6544.51,-11192.95 6534.26,-11190.27 6534.82,-11197.24"/>
</g>
<!-- route_0_12 -->
<g id="node57" class="node">
<title>route_0_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7308" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7308" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7308" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 40,41</text>
<text text-anchor="middle" x="7308" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_12 -->
<g id="edge70" class="edge">
<title>gate_0&#45;&gt;route_0_12</title>
<path fill="none" stroke="black" d="M5029.64,-11281.93C5419.94,-11272.1 6237.6,-11248.45 6928,-11208.3 6992.59,-11204.54 7063.27,-11199.26 7125.97,-11194.17"/>
<polygon fill="black" stroke="black" points="7126.28,-11197.66 7135.96,-11193.35 7125.71,-11190.68 7126.28,-11197.66"/>
</g>
<!-- route_0_13 -->
<g id="node61" class="node">
<title>route_0_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7898" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7898" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7898" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 42,43</text>
<text text-anchor="middle" x="7898" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_13 -->
<g id="edge75" class="edge">
<title>gate_0&#45;&gt;route_0_13</title>
<path fill="none" stroke="black" d="M5033.3,-11284.44C5503.62,-11277.83 6599.09,-11258.03 7518,-11208.3 7582.92,-11204.78 7653.98,-11199.53 7716.9,-11194.39"/>
<polygon fill="black" stroke="black" points="7717.25,-11197.88 7726.93,-11193.57 7716.68,-11190.9 7717.25,-11197.88"/>
</g>
<!-- route_0_14 -->
<g id="node65" class="node">
<title>route_0_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8488" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8488" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8488" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 44,45</text>
<text text-anchor="middle" x="8488" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_14 -->
<g id="edge80" class="edge">
<title>gate_0&#45;&gt;route_0_14</title>
<path fill="none" stroke="black" d="M5035.56,-11286.13C5577.95,-11282.48 6956.82,-11267.61 8108,-11208.3 8173.09,-11204.94 8244.33,-11199.71 8307.37,-11194.55"/>
<polygon fill="black" stroke="black" points="8307.73,-11198.03 8317.41,-11193.72 8307.16,-11191.05 8307.73,-11198.03"/>
</g>
<!-- route_0_15 -->
<g id="node69" class="node">
<title>route_0_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9078" cy="-11177.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9078" y="-11189.98" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9078" y="-11179.98" font-family="Times,serif" font-size="9.00">GPU: 46,47</text>
<text text-anchor="middle" x="9078" y="-11169.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-11159.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_15 -->
<g id="edge85" class="edge">
<title>gate_0&#45;&gt;route_0_15</title>
<path fill="none" stroke="black" d="M5037.19,-11287.34C5645.71,-11286.41 7311.91,-11277.2 8698,-11208.3 8763.25,-11205.05 8834.68,-11199.83 8897.83,-11194.64"/>
<polygon fill="black" stroke="black" points="8898.21,-11198.12 8907.89,-11193.81 8897.64,-11191.15 8898.21,-11198.12"/>
</g>
<!-- expert_0_0_0 -->
<g id="node10" class="node">
<title>expert_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="366.5,-11110.07 89.5,-11110.07 89.5,-11066.07 366.5,-11066.07 366.5,-11110.07"/>
<text text-anchor="middle" x="228" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L0</text>
<text text-anchor="middle" x="228" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="228" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_0&#45;&gt;expert_0_0_0 -->
<g id="edge11" class="edge">
<title>route_0_0&#45;&gt;expert_0_0_0</title>
<path fill="none" stroke="black" d="M432.08,-11149.34C392.92,-11137.77 347.49,-11124.35 309.44,-11113.12"/>
<polygon fill="black" stroke="black" points="310.01,-11109.64 299.43,-11110.16 308.03,-11116.35 310.01,-11109.64"/>
</g>
<!-- expert_0_0_1 -->
<g id="node11" class="node">
<title>expert_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="661.5,-11110.07 384.5,-11110.07 384.5,-11066.07 661.5,-11066.07 661.5,-11110.07"/>
<text text-anchor="middle" x="523" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L0</text>
<text text-anchor="middle" x="523" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="523" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_0&#45;&gt;expert_0_0_1 -->
<g id="edge12" class="edge">
<title>route_0_0&#45;&gt;expert_0_0_1</title>
<path fill="none" stroke="black" d="M523,-11145.72C523,-11137.44 523,-11128.46 523,-11120.15"/>
<polygon fill="black" stroke="black" points="526.5,-11120.07 523,-11110.07 519.5,-11120.07 526.5,-11120.07"/>
</g>
<!-- tp_0_0 -->
<g id="node12" class="node">
<title>tp_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="2925" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2925" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L0</text>
<text text-anchor="middle" x="2925" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="2925" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2925" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_0_0&#45;&gt;tp_0_0 -->
<g id="edge13" class="edge">
<title>expert_0_0_0&#45;&gt;tp_0_0</title>
<path fill="none" stroke="black" d="M366.84,-11066.8C369.58,-11066.54 372.3,-11066.3 375,-11066.07 853.88,-11025.79 2353.56,-11006.29 2799.02,-11001.29"/>
<polygon fill="black" stroke="black" points="2799.07,-11004.79 2809.03,-11001.18 2798.99,-10997.79 2799.07,-11004.79"/>
</g>
<!-- expert_0_0_1&#45;&gt;tp_0_0 -->
<g id="edge14" class="edge">
<title>expert_0_0_1&#45;&gt;tp_0_0</title>
<path fill="none" stroke="black" d="M661.6,-11066.93C664.76,-11066.62 667.9,-11066.34 671,-11066.07 1089.26,-11030.37 2388.54,-11008.09 2799.23,-11001.8"/>
<polygon fill="black" stroke="black" points="2799.41,-11005.29 2809.35,-11001.64 2799.3,-10998.29 2799.41,-11005.29"/>
</g>
<!-- q_proj_1 -->
<g id="node73" class="node">
<title>q_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="4948,-10931.85 4652,-10931.85 4652,-10887.85 4948,-10887.85 4948,-10931.85"/>
<text text-anchor="middle" x="4800" y="-10922.65" font-family="Times,serif" font-size="9.00">Q Projection L1</text>
<text text-anchor="middle" x="4800" y="-10912.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-10902.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-10892.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_0_0&#45;&gt;q_proj_1 -->
<g id="edge1380" class="edge">
<title>tp_0_0&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M3004.21,-10976.19C3019.31,-10972.8 3035.06,-10969.79 3050,-10967.85 3397.87,-10922.54 4273.53,-10958.68 4641.51,-10931.89"/>
<polygon fill="black" stroke="black" points="4642,-10935.36 4651.71,-10931.12 4641.48,-10928.38 4642,-10935.36"/>
</g>
<!-- k_proj_1 -->
<g id="node74" class="node">
<title>k_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="5262,-10931.85 4966,-10931.85 4966,-10887.85 5262,-10887.85 5262,-10931.85"/>
<text text-anchor="middle" x="5114" y="-10922.65" font-family="Times,serif" font-size="9.00">K Projection L1</text>
<text text-anchor="middle" x="5114" y="-10912.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="5114" y="-10902.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5114" y="-10892.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_0_0&#45;&gt;k_proj_1 -->
<g id="edge1381" class="edge">
<title>tp_0_0&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M3004.2,-10976.14C3019.3,-10972.76 3035.06,-10969.76 3050,-10967.85 3467.12,-10914.31 4517.78,-10963.22 4955.49,-10931.89"/>
<polygon fill="black" stroke="black" points="4956,-10935.36 4965.71,-10931.14 4955.48,-10928.38 4956,-10935.36"/>
</g>
<!-- v_proj_1 -->
<g id="node75" class="node">
<title>v_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="4634,-10931.85 4338,-10931.85 4338,-10887.85 4634,-10887.85 4634,-10931.85"/>
<text text-anchor="middle" x="4486" y="-10922.65" font-family="Times,serif" font-size="9.00">V Projection L1</text>
<text text-anchor="middle" x="4486" y="-10912.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4486" y="-10902.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4486" y="-10892.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_0_0&#45;&gt;v_proj_1 -->
<g id="edge1382" class="edge">
<title>tp_0_0&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M3004.57,-10976.32C3019.56,-10972.95 3035.19,-10969.9 3050,-10967.85 3292.49,-10934.16 4007.06,-10918.62 4327.44,-10913.21"/>
<polygon fill="black" stroke="black" points="4327.79,-10916.7 4337.73,-10913.03 4327.68,-10909.7 4327.79,-10916.7"/>
</g>
<!-- expert_0_1_0 -->
<g id="node14" class="node">
<title>expert_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="956.5,-11110.07 679.5,-11110.07 679.5,-11066.07 956.5,-11066.07 956.5,-11110.07"/>
<text text-anchor="middle" x="818" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L0</text>
<text text-anchor="middle" x="818" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 2</text>
<text text-anchor="middle" x="818" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="818" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_1&#45;&gt;expert_0_1_0 -->
<g id="edge16" class="edge">
<title>route_0_1&#45;&gt;expert_0_1_0</title>
<path fill="none" stroke="black" d="M1022.08,-11149.34C982.92,-11137.77 937.49,-11124.35 899.44,-11113.12"/>
<polygon fill="black" stroke="black" points="900.01,-11109.64 889.43,-11110.16 898.03,-11116.35 900.01,-11109.64"/>
</g>
<!-- expert_0_1_1 -->
<g id="node15" class="node">
<title>expert_0_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1251.5,-11110.07 974.5,-11110.07 974.5,-11066.07 1251.5,-11066.07 1251.5,-11110.07"/>
<text text-anchor="middle" x="1113" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L0</text>
<text text-anchor="middle" x="1113" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 3</text>
<text text-anchor="middle" x="1113" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_1&#45;&gt;expert_0_1_1 -->
<g id="edge17" class="edge">
<title>route_0_1&#45;&gt;expert_0_1_1</title>
<path fill="none" stroke="black" d="M1113,-11145.72C1113,-11137.44 1113,-11128.46 1113,-11120.15"/>
<polygon fill="black" stroke="black" points="1116.5,-11120.07 1113,-11110.07 1109.5,-11120.07 1116.5,-11120.07"/>
</g>
<!-- tp_0_1 -->
<g id="node16" class="node">
<title>tp_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="3175" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3175" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L0</text>
<text text-anchor="middle" x="3175" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 2↔3</text>
<text text-anchor="middle" x="3175" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3175" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_1_0&#45;&gt;tp_0_1 -->
<g id="edge18" class="edge">
<title>expert_0_1_0&#45;&gt;tp_0_1</title>
<path fill="none" stroke="black" d="M956.59,-11066.88C959.76,-11066.59 962.9,-11066.32 966,-11066.07 1427.73,-11029.47 2590.54,-11088.66 3050,-11030.07 3061.68,-11028.58 3073.85,-11026.43 3085.81,-11023.95"/>
<polygon fill="black" stroke="black" points="3086.76,-11027.32 3095.8,-11021.79 3085.29,-11020.48 3086.76,-11027.32"/>
</g>
<!-- expert_0_1_1&#45;&gt;tp_0_1 -->
<g id="edge19" class="edge">
<title>expert_0_1_1&#45;&gt;tp_0_1</title>
<path fill="none" stroke="black" d="M1251.6,-11066.89C1254.76,-11066.59 1257.9,-11066.32 1261,-11066.07 1657.35,-11034.08 2655.63,-11080.93 3050,-11030.07 3061.67,-11028.56 3073.84,-11026.4 3085.81,-11023.92"/>
<polygon fill="black" stroke="black" points="3086.76,-11027.29 3095.79,-11021.76 3085.28,-11020.45 3086.76,-11027.29"/>
</g>
<!-- tp_0_1&#45;&gt;q_proj_1 -->
<g id="edge1383" class="edge">
<title>tp_0_1&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M3254.55,-10976.16C3269.55,-10972.81 3285.17,-10969.81 3300,-10967.85 3888.62,-10889.93 4046.04,-10978.49 4641.58,-10931.91"/>
<polygon fill="black" stroke="black" points="4642.02,-10935.38 4651.71,-10931.11 4641.47,-10928.41 4642.02,-10935.38"/>
</g>
<!-- tp_0_1&#45;&gt;k_proj_1 -->
<g id="edge1384" class="edge">
<title>tp_0_1&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M3254.21,-10976.18C3269.3,-10972.79 3285.06,-10969.78 3300,-10967.85 3662.04,-10920.86 4573.58,-10959.61 4955.67,-10931.88"/>
<polygon fill="black" stroke="black" points="4956,-10935.37 4965.71,-10931.13 4955.48,-10928.38 4956,-10935.37"/>
</g>
<!-- tp_0_1&#45;&gt;v_proj_1 -->
<g id="edge1385" class="edge">
<title>tp_0_1&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M3254.92,-10976.34C3269.81,-10972.99 3285.31,-10969.95 3300,-10967.85 3493.63,-10940.12 4051.96,-10922.18 4327.85,-10914.75"/>
<polygon fill="black" stroke="black" points="4328.05,-10918.24 4337.95,-10914.48 4327.86,-10911.25 4328.05,-10918.24"/>
</g>
<!-- expert_0_2_0 -->
<g id="node18" class="node">
<title>expert_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1546.5,-11110.07 1269.5,-11110.07 1269.5,-11066.07 1546.5,-11066.07 1546.5,-11110.07"/>
<text text-anchor="middle" x="1408" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L0</text>
<text text-anchor="middle" x="1408" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 4</text>
<text text-anchor="middle" x="1408" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1408" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_2&#45;&gt;expert_0_2_0 -->
<g id="edge21" class="edge">
<title>route_0_2&#45;&gt;expert_0_2_0</title>
<path fill="none" stroke="black" d="M1612.08,-11149.34C1572.92,-11137.77 1527.49,-11124.35 1489.44,-11113.12"/>
<polygon fill="black" stroke="black" points="1490.01,-11109.64 1479.43,-11110.16 1488.03,-11116.35 1490.01,-11109.64"/>
</g>
<!-- expert_0_2_1 -->
<g id="node19" class="node">
<title>expert_0_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1841.5,-11110.07 1564.5,-11110.07 1564.5,-11066.07 1841.5,-11066.07 1841.5,-11110.07"/>
<text text-anchor="middle" x="1703" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L0</text>
<text text-anchor="middle" x="1703" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 5</text>
<text text-anchor="middle" x="1703" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_2&#45;&gt;expert_0_2_1 -->
<g id="edge22" class="edge">
<title>route_0_2&#45;&gt;expert_0_2_1</title>
<path fill="none" stroke="black" d="M1703,-11145.72C1703,-11137.44 1703,-11128.46 1703,-11120.15"/>
<polygon fill="black" stroke="black" points="1706.5,-11120.07 1703,-11110.07 1699.5,-11120.07 1706.5,-11120.07"/>
</g>
<!-- tp_0_2 -->
<g id="node20" class="node">
<title>tp_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="3425" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3425" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L0</text>
<text text-anchor="middle" x="3425" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 4↔5</text>
<text text-anchor="middle" x="3425" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3425" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_2_0&#45;&gt;tp_0_2 -->
<g id="edge23" class="edge">
<title>expert_0_2_0&#45;&gt;tp_0_2</title>
<path fill="none" stroke="black" d="M1546.6,-11066.89C1549.76,-11066.6 1552.9,-11066.32 1556,-11066.07 1942.37,-11034.79 2915.56,-11079.75 3300,-11030.07 3311.67,-11028.56 3323.84,-11026.4 3335.81,-11023.91"/>
<polygon fill="black" stroke="black" points="3336.76,-11027.29 3345.79,-11021.75 3335.28,-11020.44 3336.76,-11027.29"/>
</g>
<!-- expert_0_2_1&#45;&gt;tp_0_2 -->
<g id="edge24" class="edge">
<title>expert_0_2_1&#45;&gt;tp_0_2</title>
<path fill="none" stroke="black" d="M1841.6,-11066.91C1844.76,-11066.61 1847.9,-11066.33 1851,-11066.07 2492.99,-11012.73 2661.29,-11113.98 3300,-11030.07 3311.67,-11028.54 3323.84,-11026.36 3335.8,-11023.86"/>
<polygon fill="black" stroke="black" points="3336.75,-11027.24 3345.79,-11021.7 3335.27,-11020.4 3336.75,-11027.24"/>
</g>
<!-- tp_0_2&#45;&gt;q_proj_1 -->
<g id="edge1386" class="edge">
<title>tp_0_2&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M3504.56,-10976.24C3519.55,-10972.87 3535.18,-10969.85 3550,-10967.85 4028.35,-10903.04 4156.88,-10971.17 4641.65,-10931.91"/>
<polygon fill="black" stroke="black" points="4642.03,-10935.39 4651.71,-10931.08 4641.46,-10928.41 4642.03,-10935.39"/>
</g>
<!-- tp_0_2&#45;&gt;k_proj_1 -->
<g id="edge1387" class="edge">
<title>tp_0_2&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M3504.21,-10976.22C3519.31,-10972.84 3535.06,-10969.81 3550,-10967.85 4166.85,-10886.58 4331.66,-10980.36 4955.56,-10931.91"/>
<polygon fill="black" stroke="black" points="4956.02,-10935.38 4965.71,-10931.11 4955.47,-10928.41 4956.02,-10935.38"/>
</g>
<!-- tp_0_2&#45;&gt;v_proj_1 -->
<g id="edge1388" class="edge">
<title>tp_0_2&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M3505.28,-10976.42C3520.06,-10973.08 3535.43,-10970.03 3550,-10967.85 3821.14,-10927.25 4140.59,-10915.4 4327.46,-10912.04"/>
<polygon fill="black" stroke="black" points="4327.7,-10915.54 4337.64,-10911.86 4327.58,-10908.54 4327.7,-10915.54"/>
</g>
<!-- expert_0_3_0 -->
<g id="node22" class="node">
<title>expert_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2136.5,-11110.07 1859.5,-11110.07 1859.5,-11066.07 2136.5,-11066.07 2136.5,-11110.07"/>
<text text-anchor="middle" x="1998" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L0</text>
<text text-anchor="middle" x="1998" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 6</text>
<text text-anchor="middle" x="1998" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1998" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_3&#45;&gt;expert_0_3_0 -->
<g id="edge26" class="edge">
<title>route_0_3&#45;&gt;expert_0_3_0</title>
<path fill="none" stroke="black" d="M2202.08,-11149.34C2162.92,-11137.77 2117.49,-11124.35 2079.44,-11113.12"/>
<polygon fill="black" stroke="black" points="2080.01,-11109.64 2069.43,-11110.16 2078.03,-11116.35 2080.01,-11109.64"/>
</g>
<!-- expert_0_3_1 -->
<g id="node23" class="node">
<title>expert_0_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2431.5,-11110.07 2154.5,-11110.07 2154.5,-11066.07 2431.5,-11066.07 2431.5,-11110.07"/>
<text text-anchor="middle" x="2293" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L0</text>
<text text-anchor="middle" x="2293" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 7</text>
<text text-anchor="middle" x="2293" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_3&#45;&gt;expert_0_3_1 -->
<g id="edge27" class="edge">
<title>route_0_3&#45;&gt;expert_0_3_1</title>
<path fill="none" stroke="black" d="M2293,-11145.72C2293,-11137.44 2293,-11128.46 2293,-11120.15"/>
<polygon fill="black" stroke="black" points="2296.5,-11120.07 2293,-11110.07 2289.5,-11120.07 2296.5,-11120.07"/>
</g>
<!-- tp_0_3 -->
<g id="node24" class="node">
<title>tp_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="3675" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3675" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L0</text>
<text text-anchor="middle" x="3675" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 6↔7</text>
<text text-anchor="middle" x="3675" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3675" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_3_0&#45;&gt;tp_0_3 -->
<g id="edge28" class="edge">
<title>expert_0_3_0&#45;&gt;tp_0_3</title>
<path fill="none" stroke="black" d="M2136.6,-11066.91C2139.76,-11066.61 2142.9,-11066.33 2146,-11066.07 2768.04,-11014.14 2931.14,-11111.62 3550,-11030.07 3561.67,-11028.53 3573.84,-11026.35 3585.8,-11023.86"/>
<polygon fill="black" stroke="black" points="3586.75,-11027.23 3595.79,-11021.69 3585.27,-11020.39 3586.75,-11027.23"/>
</g>
<!-- expert_0_3_1&#45;&gt;tp_0_3 -->
<g id="edge29" class="edge">
<title>expert_0_3_1&#45;&gt;tp_0_3</title>
<path fill="none" stroke="black" d="M2431.6,-11066.94C2434.76,-11066.63 2437.9,-11066.34 2441,-11066.07 2932.3,-11023.37 3061.3,-11096.16 3550,-11030.07 3561.58,-11028.5 3573.65,-11026.32 3585.52,-11023.84"/>
<polygon fill="black" stroke="black" points="3586.41,-11027.23 3595.44,-11021.68 3584.92,-11020.38 3586.41,-11027.23"/>
</g>
<!-- tp_0_3&#45;&gt;q_proj_1 -->
<g id="edge1389" class="edge">
<title>tp_0_3&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M3754.91,-10976.28C3769.8,-10972.93 3785.3,-10969.91 3800,-10967.85 4168.1,-10916.15 4267.69,-10963.88 4641.69,-10931.91"/>
<polygon fill="black" stroke="black" points="4642.05,-10935.4 4651.71,-10931.04 4641.44,-10928.42 4642.05,-10935.4"/>
</g>
<!-- tp_0_3&#45;&gt;k_proj_1 -->
<g id="edge1390" class="edge">
<title>tp_0_3&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M3754.56,-10976.21C3769.55,-10972.85 3785.18,-10969.84 3800,-10967.85 4306.52,-10899.69 4442.47,-10973.02 4955.45,-10931.92"/>
<polygon fill="black" stroke="black" points="4956.03,-10935.39 4965.71,-10931.09 4955.46,-10928.41 4956.03,-10935.39"/>
</g>
<!-- tp_0_3&#45;&gt;v_proj_1 -->
<g id="edge1391" class="edge">
<title>tp_0_3&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M3755.99,-10976.54C3770.57,-10973.23 3785.68,-10970.15 3800,-10967.85 3979.42,-10938.95 4187.75,-10924.27 4327.32,-10917.12"/>
<polygon fill="black" stroke="black" points="4327.86,-10920.59 4337.67,-10916.59 4327.51,-10913.6 4327.86,-10920.59"/>
</g>
<!-- expert_0_4_0 -->
<g id="node26" class="node">
<title>expert_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2726.5,-11110.07 2449.5,-11110.07 2449.5,-11066.07 2726.5,-11066.07 2726.5,-11110.07"/>
<text text-anchor="middle" x="2588" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L0</text>
<text text-anchor="middle" x="2588" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 8</text>
<text text-anchor="middle" x="2588" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2588" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_4&#45;&gt;expert_0_4_0 -->
<g id="edge31" class="edge">
<title>route_0_4&#45;&gt;expert_0_4_0</title>
<path fill="none" stroke="black" d="M2792.08,-11149.34C2752.92,-11137.77 2707.49,-11124.35 2669.44,-11113.12"/>
<polygon fill="black" stroke="black" points="2670.01,-11109.64 2659.43,-11110.16 2668.03,-11116.35 2670.01,-11109.64"/>
</g>
<!-- expert_0_4_1 -->
<g id="node27" class="node">
<title>expert_0_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3021.5,-11110.07 2744.5,-11110.07 2744.5,-11066.07 3021.5,-11066.07 3021.5,-11110.07"/>
<text text-anchor="middle" x="2883" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L0</text>
<text text-anchor="middle" x="2883" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 9</text>
<text text-anchor="middle" x="2883" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_4&#45;&gt;expert_0_4_1 -->
<g id="edge32" class="edge">
<title>route_0_4&#45;&gt;expert_0_4_1</title>
<path fill="none" stroke="black" d="M2883,-11145.72C2883,-11137.44 2883,-11128.46 2883,-11120.15"/>
<polygon fill="black" stroke="black" points="2886.5,-11120.07 2883,-11110.07 2879.5,-11120.07 2886.5,-11120.07"/>
</g>
<!-- tp_0_4 -->
<g id="node28" class="node">
<title>tp_0_4</title>
<ellipse fill="lightblue" stroke="black" cx="3925" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3925" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L0</text>
<text text-anchor="middle" x="3925" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 8↔9</text>
<text text-anchor="middle" x="3925" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3925" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_4_0&#45;&gt;tp_0_4 -->
<g id="edge33" class="edge">
<title>expert_0_4_0&#45;&gt;tp_0_4</title>
<path fill="none" stroke="black" d="M2726.6,-11066.95C2729.76,-11066.63 2732.9,-11066.34 2736,-11066.07 3207.35,-11024.78 3331.15,-11093.8 3800,-11030.07 3811.58,-11028.5 3823.65,-11026.31 3835.52,-11023.82"/>
<polygon fill="black" stroke="black" points="3836.41,-11027.21 3845.44,-11021.67 3834.92,-11020.37 3836.41,-11027.21"/>
</g>
<!-- expert_0_4_1&#45;&gt;tp_0_4 -->
<g id="edge34" class="edge">
<title>expert_0_4_1&#45;&gt;tp_0_4</title>
<path fill="none" stroke="black" d="M3021.6,-11067C3024.76,-11066.67 3027.9,-11066.36 3031,-11066.07 3371.65,-11034 3461.27,-11078.35 3800,-11030.07 3811.48,-11028.43 3823.45,-11026.22 3835.24,-11023.73"/>
<polygon fill="black" stroke="black" points="3836.06,-11027.14 3845.08,-11021.59 3834.56,-11020.3 3836.06,-11027.14"/>
</g>
<!-- tp_0_4&#45;&gt;q_proj_1 -->
<g id="edge1392" class="edge">
<title>tp_0_4&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M4005.28,-10976.42C4020.06,-10973.08 4035.43,-10970.03 4050,-10967.85 4307.82,-10929.27 4378.41,-10956.65 4641.46,-10931.95"/>
<polygon fill="black" stroke="black" points="4642.08,-10935.41 4651.7,-10930.97 4641.41,-10928.44 4642.08,-10935.41"/>
</g>
<!-- tp_0_4&#45;&gt;k_proj_1 -->
<g id="edge1393" class="edge">
<title>tp_0_4&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M4004.57,-10976.32C4019.56,-10972.95 4035.19,-10969.9 4050,-10967.85 4446.27,-10912.8 4553.3,-10965.73 4955.54,-10931.92"/>
<polygon fill="black" stroke="black" points="4956.04,-10935.39 4965.71,-10931.06 4955.45,-10928.42 4956.04,-10935.39"/>
</g>
<!-- tp_0_4&#45;&gt;v_proj_1 -->
<g id="edge1394" class="edge">
<title>tp_0_4&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M4007.1,-10976.86C4021.35,-10973.58 4036.06,-10970.43 4050,-10967.85 4141.51,-10950.89 4244.75,-10937.16 4327.79,-10927.42"/>
<polygon fill="black" stroke="black" points="4328.28,-10930.89 4337.81,-10926.25 4327.47,-10923.93 4328.28,-10930.89"/>
</g>
<!-- expert_0_5_0 -->
<g id="node30" class="node">
<title>expert_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-11110.07 3039.5,-11110.07 3039.5,-11066.07 3316.5,-11066.07 3316.5,-11110.07"/>
<text text-anchor="middle" x="3178" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L0</text>
<text text-anchor="middle" x="3178" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 10</text>
<text text-anchor="middle" x="3178" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3178" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_5&#45;&gt;expert_0_5_0 -->
<g id="edge36" class="edge">
<title>route_0_5&#45;&gt;expert_0_5_0</title>
<path fill="none" stroke="black" d="M3382.08,-11149.34C3342.92,-11137.77 3297.49,-11124.35 3259.44,-11113.12"/>
<polygon fill="black" stroke="black" points="3260.01,-11109.64 3249.43,-11110.16 3258.03,-11116.35 3260.01,-11109.64"/>
</g>
<!-- expert_0_5_1 -->
<g id="node31" class="node">
<title>expert_0_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3611.5,-11110.07 3334.5,-11110.07 3334.5,-11066.07 3611.5,-11066.07 3611.5,-11110.07"/>
<text text-anchor="middle" x="3473" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L0</text>
<text text-anchor="middle" x="3473" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 11</text>
<text text-anchor="middle" x="3473" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_5&#45;&gt;expert_0_5_1 -->
<g id="edge37" class="edge">
<title>route_0_5&#45;&gt;expert_0_5_1</title>
<path fill="none" stroke="black" d="M3473,-11145.72C3473,-11137.44 3473,-11128.46 3473,-11120.15"/>
<polygon fill="black" stroke="black" points="3476.5,-11120.07 3473,-11110.07 3469.5,-11120.07 3476.5,-11120.07"/>
</g>
<!-- tp_0_5 -->
<g id="node32" class="node">
<title>tp_0_5</title>
<ellipse fill="lightblue" stroke="black" cx="4175" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4175" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L0</text>
<text text-anchor="middle" x="4175" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 10↔11</text>
<text text-anchor="middle" x="4175" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4175" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_5_0&#45;&gt;tp_0_5 -->
<g id="edge38" class="edge">
<title>expert_0_5_0&#45;&gt;tp_0_5</title>
<path fill="none" stroke="black" d="M3316.61,-11067.01C3319.77,-11066.68 3322.9,-11066.37 3326,-11066.07 3646.71,-11035.41 3731.11,-11076 4050,-11030.07 4061.48,-11028.42 4073.45,-11026.19 4085.23,-11023.7"/>
<polygon fill="black" stroke="black" points="4086.05,-11027.11 4095.07,-11021.55 4084.56,-11020.27 4086.05,-11027.11"/>
</g>
<!-- expert_0_5_1&#45;&gt;tp_0_5 -->
<g id="edge39" class="edge">
<title>expert_0_5_1&#45;&gt;tp_0_5</title>
<path fill="none" stroke="black" d="M3611.62,-11067.16C3614.78,-11066.78 3617.91,-11066.42 3621,-11066.07 3811.13,-11044.62 3861.11,-11060.57 4050,-11030.07 4061.08,-11028.28 4072.63,-11026.03 4084.03,-11023.58"/>
<polygon fill="black" stroke="black" points="4085,-11026.95 4094,-11021.37 4083.48,-11020.11 4085,-11026.95"/>
</g>
<!-- tp_0_5&#45;&gt;q_proj_1 -->
<g id="edge1395" class="edge">
<title>tp_0_5&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M4256.37,-10976.72C4270.84,-10973.41 4285.81,-10970.29 4300,-10967.85 4447.81,-10942.4 4489.04,-10949.67 4641.48,-10932"/>
<polygon fill="black" stroke="black" points="4642.16,-10935.44 4651.68,-10930.8 4641.34,-10928.49 4642.16,-10935.44"/>
</g>
<!-- tp_0_5&#45;&gt;k_proj_1 -->
<g id="edge1396" class="edge">
<title>tp_0_5&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M4255.27,-10976.35C4270.05,-10973.02 4285.42,-10969.98 4300,-10967.85 4586.1,-10925.9 4664.1,-10958.5 4955.68,-10931.92"/>
<polygon fill="black" stroke="black" points="4956.07,-10935.4 4965.7,-10931 4955.42,-10928.43 4956.07,-10935.4"/>
</g>
<!-- tp_0_5&#45;&gt;v_proj_1 -->
<g id="edge1397" class="edge">
<title>tp_0_5&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M4253.48,-10975.98C4298.5,-10963.36 4355.05,-10947.53 4401.1,-10934.62"/>
<polygon fill="black" stroke="black" points="4402.08,-10937.99 4410.77,-10931.92 4400.19,-10931.25 4402.08,-10937.99"/>
</g>
<!-- expert_0_6_0 -->
<g id="node34" class="node">
<title>expert_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3906.5,-11110.07 3629.5,-11110.07 3629.5,-11066.07 3906.5,-11066.07 3906.5,-11110.07"/>
<text text-anchor="middle" x="3768" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L0</text>
<text text-anchor="middle" x="3768" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 12</text>
<text text-anchor="middle" x="3768" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3768" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_6&#45;&gt;expert_0_6_0 -->
<g id="edge41" class="edge">
<title>route_0_6&#45;&gt;expert_0_6_0</title>
<path fill="none" stroke="black" d="M3972.08,-11149.34C3932.92,-11137.77 3887.49,-11124.35 3849.44,-11113.12"/>
<polygon fill="black" stroke="black" points="3850.01,-11109.64 3839.43,-11110.16 3848.03,-11116.35 3850.01,-11109.64"/>
</g>
<!-- expert_0_6_1 -->
<g id="node35" class="node">
<title>expert_0_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4201.5,-11110.07 3924.5,-11110.07 3924.5,-11066.07 4201.5,-11066.07 4201.5,-11110.07"/>
<text text-anchor="middle" x="4063" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L0</text>
<text text-anchor="middle" x="4063" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 13</text>
<text text-anchor="middle" x="4063" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_6&#45;&gt;expert_0_6_1 -->
<g id="edge42" class="edge">
<title>route_0_6&#45;&gt;expert_0_6_1</title>
<path fill="none" stroke="black" d="M4063,-11145.72C4063,-11137.44 4063,-11128.46 4063,-11120.15"/>
<polygon fill="black" stroke="black" points="4066.5,-11120.07 4063,-11110.07 4059.5,-11120.07 4066.5,-11120.07"/>
</g>
<!-- tp_0_6 -->
<g id="node36" class="node">
<title>tp_0_6</title>
<ellipse fill="lightblue" stroke="black" cx="4425" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4425" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L0</text>
<text text-anchor="middle" x="4425" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 12↔13</text>
<text text-anchor="middle" x="4425" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4425" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_6_0&#45;&gt;tp_0_6 -->
<g id="edge43" class="edge">
<title>expert_0_6_0&#45;&gt;tp_0_6</title>
<path fill="none" stroke="black" d="M3906.63,-11067.2C3909.78,-11066.81 3912.91,-11066.43 3916,-11066.07 4086.24,-11046.02 4130.91,-11058.22 4300,-11030.07 4311.07,-11028.23 4322.61,-11025.95 4334.02,-11023.47"/>
<polygon fill="black" stroke="black" points="4334.98,-11026.84 4343.98,-11021.25 4333.46,-11020.01 4334.98,-11026.84"/>
</g>
<!-- expert_0_6_1&#45;&gt;tp_0_6 -->
<g id="edge44" class="edge">
<title>expert_0_6_1&#45;&gt;tp_0_6</title>
<path fill="none" stroke="black" d="M4150.51,-11066.03C4195.24,-11055.28 4250.52,-11041.98 4300,-11030.07 4309.87,-11027.7 4320.17,-11025.21 4330.45,-11022.74"/>
<polygon fill="black" stroke="black" points="4331.38,-11026.12 4340.28,-11020.37 4329.74,-11019.31 4331.38,-11026.12"/>
</g>
<!-- tp_0_6&#45;&gt;q_proj_1 -->
<g id="edge1398" class="edge">
<title>tp_0_6&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M4509.35,-10977.49C4522.94,-10974.24 4536.85,-10970.93 4550,-10967.85 4598.15,-10956.56 4651.59,-10944.33 4696.67,-10934.11"/>
<polygon fill="black" stroke="black" points="4697.47,-10937.51 4706.45,-10931.89 4695.92,-10930.69 4697.47,-10937.51"/>
</g>
<!-- tp_0_6&#45;&gt;k_proj_1 -->
<g id="edge1399" class="edge">
<title>tp_0_6&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M4506,-10976.6C4520.58,-10973.29 4535.68,-10970.19 4550,-10967.85 4725.97,-10939.03 4774.76,-10951.42 4955.57,-10931.97"/>
<polygon fill="black" stroke="black" points="4956.13,-10935.43 4965.69,-10930.86 4955.37,-10928.47 4956.13,-10935.43"/>
</g>
<!-- tp_0_6&#45;&gt;v_proj_1 -->
<g id="edge1400" class="edge">
<title>tp_0_6&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M4445.99,-10967.98C4452.26,-10959.03 4459.12,-10949.23 4465.37,-10940.31"/>
<polygon fill="black" stroke="black" points="4468.26,-10942.28 4471.13,-10932.09 4462.52,-10938.27 4468.26,-10942.28"/>
</g>
<!-- expert_0_7_0 -->
<g id="node38" class="node">
<title>expert_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4496.5,-11110.07 4219.5,-11110.07 4219.5,-11066.07 4496.5,-11066.07 4496.5,-11110.07"/>
<text text-anchor="middle" x="4358" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L0</text>
<text text-anchor="middle" x="4358" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 14</text>
<text text-anchor="middle" x="4358" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4358" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_7&#45;&gt;expert_0_7_0 -->
<g id="edge46" class="edge">
<title>route_0_7&#45;&gt;expert_0_7_0</title>
<path fill="none" stroke="black" d="M4515.64,-11148.26C4486.11,-11137.17 4452.42,-11124.53 4423.8,-11113.78"/>
<polygon fill="black" stroke="black" points="4424.89,-11110.45 4414.29,-11110.21 4422.43,-11117 4424.89,-11110.45"/>
</g>
<!-- expert_0_7_1 -->
<g id="node39" class="node">
<title>expert_0_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4791.5,-11110.07 4514.5,-11110.07 4514.5,-11066.07 4791.5,-11066.07 4791.5,-11110.07"/>
<text text-anchor="middle" x="4653" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L0</text>
<text text-anchor="middle" x="4653" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 15</text>
<text text-anchor="middle" x="4653" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4653" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_7&#45;&gt;expert_0_7_1 -->
<g id="edge47" class="edge">
<title>route_0_7&#45;&gt;expert_0_7_1</title>
<path fill="none" stroke="black" d="M4611.68,-11146.2C4618.15,-11137.25 4625.24,-11127.45 4631.69,-11118.53"/>
<polygon fill="black" stroke="black" points="4634.61,-11120.47 4637.64,-11110.31 4628.94,-11116.36 4634.61,-11120.47"/>
</g>
<!-- tp_0_7 -->
<g id="node40" class="node">
<title>tp_0_7</title>
<ellipse fill="lightblue" stroke="black" cx="4675" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4675" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L0</text>
<text text-anchor="middle" x="4675" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 14↔15</text>
<text text-anchor="middle" x="4675" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4675" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_7_0&#45;&gt;tp_0_7 -->
<g id="edge48" class="edge">
<title>expert_0_7_0&#45;&gt;tp_0_7</title>
<path fill="none" stroke="black" d="M4434.74,-11065.98C4480.34,-11053.45 4538.37,-11037.5 4585.98,-11024.42"/>
<polygon fill="black" stroke="black" points="4586.94,-11027.79 4595.66,-11021.76 4585.09,-11021.04 4586.94,-11027.79"/>
</g>
<!-- expert_0_7_1&#45;&gt;tp_0_7 -->
<g id="edge49" class="edge">
<title>expert_0_7_1&#45;&gt;tp_0_7</title>
<path fill="none" stroke="black" d="M4658.33,-11065.98C4660.3,-11058.15 4662.62,-11048.99 4664.88,-11040.03"/>
<polygon fill="black" stroke="black" points="4668.34,-11040.62 4667.4,-11030.07 4661.55,-11038.91 4668.34,-11040.62"/>
</g>
<!-- tp_0_7&#45;&gt;q_proj_1 -->
<g id="edge1401" class="edge">
<title>tp_0_7&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M4715.58,-10969.67C4730.24,-10959.46 4746.74,-10947.96 4761.24,-10937.85"/>
<polygon fill="black" stroke="black" points="4763.32,-10940.68 4769.52,-10932.09 4759.31,-10934.93 4763.32,-10940.68"/>
</g>
<!-- tp_0_7&#45;&gt;k_proj_1 -->
<g id="edge1402" class="edge">
<title>tp_0_7&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M4758.23,-10977.21C4772.14,-10973.94 4786.46,-10970.7 4800,-10967.85 4858.43,-10955.51 4923.31,-10943.46 4978.87,-10933.64"/>
<polygon fill="black" stroke="black" points="4979.53,-10937.08 4988.77,-10931.9 4978.31,-10930.19 4979.53,-10937.08"/>
</g>
<!-- tp_0_7&#45;&gt;v_proj_1 -->
<g id="edge1403" class="edge">
<title>tp_0_7&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M4618.04,-10971.7C4593.67,-10960.47 4565.32,-10947.4 4541.15,-10936.26"/>
<polygon fill="black" stroke="black" points="4542.31,-10932.94 4531.76,-10931.94 4539.38,-10939.3 4542.31,-10932.94"/>
</g>
<!-- expert_0_8_0 -->
<g id="node42" class="node">
<title>expert_0_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-11110.07 4809.5,-11110.07 4809.5,-11066.07 5086.5,-11066.07 5086.5,-11110.07"/>
<text text-anchor="middle" x="4948" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L0</text>
<text text-anchor="middle" x="4948" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="4948" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4948" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_8&#45;&gt;expert_0_8_0 -->
<g id="edge51" class="edge">
<title>route_0_8&#45;&gt;expert_0_8_0</title>
<path fill="none" stroke="black" d="M4988.66,-11146.2C4982.29,-11137.25 4975.32,-11127.45 4968.97,-11118.53"/>
<polygon fill="black" stroke="black" points="4971.77,-11116.43 4963.12,-11110.31 4966.06,-11120.49 4971.77,-11116.43"/>
</g>
<!-- expert_0_8_1 -->
<g id="node43" class="node">
<title>expert_0_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5381.5,-11110.07 5104.5,-11110.07 5104.5,-11066.07 5381.5,-11066.07 5381.5,-11110.07"/>
<text text-anchor="middle" x="5243" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L0</text>
<text text-anchor="middle" x="5243" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="5243" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5243" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_8&#45;&gt;expert_0_8_1 -->
<g id="edge52" class="edge">
<title>route_0_8&#45;&gt;expert_0_8_1</title>
<path fill="none" stroke="black" d="M5084.68,-11148.26C5114.34,-11137.17 5148.17,-11124.53 5176.92,-11113.78"/>
<polygon fill="black" stroke="black" points="5178.32,-11116.99 5186.46,-11110.21 5175.87,-11110.43 5178.32,-11116.99"/>
</g>
<!-- tp_0_8 -->
<g id="node44" class="node">
<title>tp_0_8</title>
<ellipse fill="lightblue" stroke="black" cx="4925" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4925" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L0</text>
<text text-anchor="middle" x="4925" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="4925" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4925" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_8_0&#45;&gt;tp_0_8 -->
<g id="edge53" class="edge">
<title>expert_0_8_0&#45;&gt;tp_0_8</title>
<path fill="none" stroke="black" d="M4942.43,-11065.98C4940.37,-11058.15 4937.95,-11048.99 4935.58,-11040.03"/>
<polygon fill="black" stroke="black" points="4938.89,-11038.85 4932.95,-11030.07 4932.12,-11040.63 4938.89,-11038.85"/>
</g>
<!-- expert_0_8_1&#45;&gt;tp_0_8 -->
<g id="edge54" class="edge">
<title>expert_0_8_1&#45;&gt;tp_0_8</title>
<path fill="none" stroke="black" d="M5166.02,-11065.98C5120.19,-11053.43 5061.84,-11037.44 5014.04,-11024.35"/>
<polygon fill="black" stroke="black" points="5014.88,-11020.95 5004.31,-11021.68 5013.03,-11027.7 5014.88,-11020.95"/>
</g>
<!-- tp_0_8&#45;&gt;q_proj_1 -->
<g id="edge1404" class="edge">
<title>tp_0_8&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M4884.42,-10969.67C4869.76,-10959.46 4853.26,-10947.96 4838.76,-10937.85"/>
<polygon fill="black" stroke="black" points="4840.69,-10934.93 4830.48,-10932.09 4836.68,-10940.68 4840.69,-10934.93"/>
</g>
<!-- tp_0_8&#45;&gt;k_proj_1 -->
<g id="edge1405" class="edge">
<title>tp_0_8&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M4981.96,-10971.7C5006.33,-10960.47 5034.68,-10947.4 5058.85,-10936.26"/>
<polygon fill="black" stroke="black" points="5060.62,-10939.3 5068.24,-10931.94 5057.69,-10932.94 5060.62,-10939.3"/>
</g>
<!-- tp_0_8&#45;&gt;v_proj_1 -->
<g id="edge1406" class="edge">
<title>tp_0_8&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M4841.77,-10977.21C4827.86,-10973.94 4813.54,-10970.7 4800,-10967.85 4741.57,-10955.51 4676.69,-10943.46 4621.13,-10933.64"/>
<polygon fill="black" stroke="black" points="4621.69,-10930.19 4611.23,-10931.9 4620.47,-10937.08 4621.69,-10930.19"/>
</g>
<!-- expert_0_9_0 -->
<g id="node46" class="node">
<title>expert_0_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5676.5,-11110.07 5399.5,-11110.07 5399.5,-11066.07 5676.5,-11066.07 5676.5,-11110.07"/>
<text text-anchor="middle" x="5538" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L0</text>
<text text-anchor="middle" x="5538" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 34</text>
<text text-anchor="middle" x="5538" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_9&#45;&gt;expert_0_9_0 -->
<g id="edge56" class="edge">
<title>route_0_9&#45;&gt;expert_0_9_0</title>
<path fill="none" stroke="black" d="M5538,-11145.72C5538,-11137.44 5538,-11128.46 5538,-11120.15"/>
<polygon fill="black" stroke="black" points="5541.5,-11120.07 5538,-11110.07 5534.5,-11120.07 5541.5,-11120.07"/>
</g>
<!-- expert_0_9_1 -->
<g id="node47" class="node">
<title>expert_0_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5971.5,-11110.07 5694.5,-11110.07 5694.5,-11066.07 5971.5,-11066.07 5971.5,-11110.07"/>
<text text-anchor="middle" x="5833" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L0</text>
<text text-anchor="middle" x="5833" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 35</text>
<text text-anchor="middle" x="5833" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5833" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_9&#45;&gt;expert_0_9_1 -->
<g id="edge57" class="edge">
<title>route_0_9&#45;&gt;expert_0_9_1</title>
<path fill="none" stroke="black" d="M5628.92,-11149.34C5668.08,-11137.77 5713.51,-11124.35 5751.56,-11113.12"/>
<polygon fill="black" stroke="black" points="5752.97,-11116.35 5761.57,-11110.16 5750.99,-11109.64 5752.97,-11116.35"/>
</g>
<!-- tp_0_9 -->
<g id="node48" class="node">
<title>tp_0_9</title>
<ellipse fill="lightblue" stroke="black" cx="5175" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5175" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L0</text>
<text text-anchor="middle" x="5175" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 34↔35</text>
<text text-anchor="middle" x="5175" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5175" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_9_0&#45;&gt;tp_0_9 -->
<g id="edge58" class="edge">
<title>expert_0_9_0&#45;&gt;tp_0_9</title>
<path fill="none" stroke="black" d="M5450.11,-11066.05C5405.2,-11055.3 5349.68,-11042 5300,-11030.07 5290.05,-11027.68 5279.65,-11025.18 5269.29,-11022.69"/>
<polygon fill="black" stroke="black" points="5269.92,-11019.24 5259.38,-11020.3 5268.28,-11026.04 5269.92,-11019.24"/>
</g>
<!-- expert_0_9_1&#45;&gt;tp_0_9 -->
<g id="edge59" class="edge">
<title>expert_0_9_1&#45;&gt;tp_0_9</title>
<path fill="none" stroke="black" d="M5694.14,-11067.05C5691.4,-11066.71 5688.69,-11066.39 5686,-11066.07 5514.89,-11045.88 5469.97,-11058.32 5300,-11030.07 5288.93,-11028.23 5277.39,-11025.95 5265.98,-11023.48"/>
<polygon fill="black" stroke="black" points="5266.54,-11020.02 5256.01,-11021.26 5265.02,-11026.85 5266.54,-11020.02"/>
</g>
<!-- tp_0_9&#45;&gt;q_proj_1 -->
<g id="edge1407" class="edge">
<title>tp_0_9&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M5090.65,-10977.49C5077.06,-10974.24 5063.15,-10970.93 5050,-10967.85 5001.85,-10956.56 4948.41,-10944.33 4903.33,-10934.11"/>
<polygon fill="black" stroke="black" points="4904.08,-10930.69 4893.55,-10931.89 4902.53,-10937.51 4904.08,-10930.69"/>
</g>
<!-- tp_0_9&#45;&gt;k_proj_1 -->
<g id="edge1408" class="edge">
<title>tp_0_9&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M5154.01,-10967.98C5147.74,-10959.03 5140.88,-10949.23 5134.63,-10940.31"/>
<polygon fill="black" stroke="black" points="5137.48,-10938.27 5128.87,-10932.09 5131.74,-10942.28 5137.48,-10938.27"/>
</g>
<!-- tp_0_9&#45;&gt;v_proj_1 -->
<g id="edge1409" class="edge">
<title>tp_0_9&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M5094,-10976.6C5079.42,-10973.29 5064.32,-10970.19 5050,-10967.85 4874.03,-10939.03 4825.24,-10951.42 4644.43,-10931.97"/>
<polygon fill="black" stroke="black" points="4644.63,-10928.47 4634.31,-10930.86 4643.87,-10935.43 4644.63,-10928.47"/>
</g>
<!-- expert_0_10_0 -->
<g id="node50" class="node">
<title>expert_0_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6266.5,-11110.07 5989.5,-11110.07 5989.5,-11066.07 6266.5,-11066.07 6266.5,-11110.07"/>
<text text-anchor="middle" x="6128" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L0</text>
<text text-anchor="middle" x="6128" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 36</text>
<text text-anchor="middle" x="6128" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_10&#45;&gt;expert_0_10_0 -->
<g id="edge61" class="edge">
<title>route_0_10&#45;&gt;expert_0_10_0</title>
<path fill="none" stroke="black" d="M6128,-11145.72C6128,-11137.44 6128,-11128.46 6128,-11120.15"/>
<polygon fill="black" stroke="black" points="6131.5,-11120.07 6128,-11110.07 6124.5,-11120.07 6131.5,-11120.07"/>
</g>
<!-- expert_0_10_1 -->
<g id="node51" class="node">
<title>expert_0_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6561.5,-11110.07 6284.5,-11110.07 6284.5,-11066.07 6561.5,-11066.07 6561.5,-11110.07"/>
<text text-anchor="middle" x="6423" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L0</text>
<text text-anchor="middle" x="6423" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 37</text>
<text text-anchor="middle" x="6423" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6423" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_10&#45;&gt;expert_0_10_1 -->
<g id="edge62" class="edge">
<title>route_0_10&#45;&gt;expert_0_10_1</title>
<path fill="none" stroke="black" d="M6218.92,-11149.34C6258.08,-11137.77 6303.51,-11124.35 6341.56,-11113.12"/>
<polygon fill="black" stroke="black" points="6342.97,-11116.35 6351.57,-11110.16 6340.99,-11109.64 6342.97,-11116.35"/>
</g>
<!-- tp_0_10 -->
<g id="node52" class="node">
<title>tp_0_10</title>
<ellipse fill="lightblue" stroke="black" cx="5425" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5425" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L0</text>
<text text-anchor="middle" x="5425" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 36↔37</text>
<text text-anchor="middle" x="5425" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5425" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_10_0&#45;&gt;tp_0_10 -->
<g id="edge63" class="edge">
<title>expert_0_10_0&#45;&gt;tp_0_10</title>
<path fill="none" stroke="black" d="M5989.14,-11067.01C5986.41,-11066.69 5983.69,-11066.37 5981,-11066.07 5790,-11044.47 5739.77,-11060.67 5550,-11030.07 5538.92,-11028.28 5527.37,-11026.04 5515.97,-11023.58"/>
<polygon fill="black" stroke="black" points="5516.52,-11020.12 5506,-11021.38 5515,-11026.95 5516.52,-11020.12"/>
</g>
<!-- expert_0_10_1&#45;&gt;tp_0_10 -->
<g id="edge64" class="edge">
<title>expert_0_10_1&#45;&gt;tp_0_10</title>
<path fill="none" stroke="black" d="M6284.16,-11066.89C6281.42,-11066.6 6278.69,-11066.33 6276,-11066.07 5954.42,-11035.19 5869.77,-11076.1 5550,-11030.07 5538.52,-11028.42 5526.55,-11026.2 5514.77,-11023.7"/>
<polygon fill="black" stroke="black" points="5515.44,-11020.27 5504.93,-11021.55 5513.95,-11027.11 5515.44,-11020.27"/>
</g>
<!-- tp_0_10&#45;&gt;q_proj_1 -->
<g id="edge1410" class="edge">
<title>tp_0_10&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M5343.63,-10976.72C5329.16,-10973.41 5314.19,-10970.29 5300,-10967.85 5152.19,-10942.4 5110.96,-10949.67 4958.52,-10932"/>
<polygon fill="black" stroke="black" points="4958.66,-10928.49 4948.32,-10930.8 4957.84,-10935.44 4958.66,-10928.49"/>
</g>
<!-- tp_0_10&#45;&gt;k_proj_1 -->
<g id="edge1411" class="edge">
<title>tp_0_10&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M5346.52,-10975.98C5301.5,-10963.36 5244.95,-10947.53 5198.9,-10934.62"/>
<polygon fill="black" stroke="black" points="5199.81,-10931.25 5189.23,-10931.92 5197.92,-10937.99 5199.81,-10931.25"/>
</g>
<!-- tp_0_10&#45;&gt;v_proj_1 -->
<g id="edge1412" class="edge">
<title>tp_0_10&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M5344.73,-10976.35C5329.95,-10973.02 5314.58,-10969.98 5300,-10967.85 5013.9,-10925.9 4935.9,-10958.5 4644.32,-10931.92"/>
<polygon fill="black" stroke="black" points="4644.58,-10928.43 4634.3,-10931 4643.93,-10935.4 4644.58,-10928.43"/>
</g>
<!-- expert_0_11_0 -->
<g id="node54" class="node">
<title>expert_0_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6856.5,-11110.07 6579.5,-11110.07 6579.5,-11066.07 6856.5,-11066.07 6856.5,-11110.07"/>
<text text-anchor="middle" x="6718" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L0</text>
<text text-anchor="middle" x="6718" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 38</text>
<text text-anchor="middle" x="6718" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_11&#45;&gt;expert_0_11_0 -->
<g id="edge66" class="edge">
<title>route_0_11&#45;&gt;expert_0_11_0</title>
<path fill="none" stroke="black" d="M6718,-11145.72C6718,-11137.44 6718,-11128.46 6718,-11120.15"/>
<polygon fill="black" stroke="black" points="6721.5,-11120.07 6718,-11110.07 6714.5,-11120.07 6721.5,-11120.07"/>
</g>
<!-- expert_0_11_1 -->
<g id="node55" class="node">
<title>expert_0_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7151.5,-11110.07 6874.5,-11110.07 6874.5,-11066.07 7151.5,-11066.07 7151.5,-11110.07"/>
<text text-anchor="middle" x="7013" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L0</text>
<text text-anchor="middle" x="7013" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 39</text>
<text text-anchor="middle" x="7013" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7013" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_11&#45;&gt;expert_0_11_1 -->
<g id="edge67" class="edge">
<title>route_0_11&#45;&gt;expert_0_11_1</title>
<path fill="none" stroke="black" d="M6808.92,-11149.34C6848.08,-11137.77 6893.51,-11124.35 6931.56,-11113.12"/>
<polygon fill="black" stroke="black" points="6932.97,-11116.35 6941.57,-11110.16 6930.99,-11109.64 6932.97,-11116.35"/>
</g>
<!-- tp_0_11 -->
<g id="node56" class="node">
<title>tp_0_11</title>
<ellipse fill="lightblue" stroke="black" cx="5675" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5675" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L0</text>
<text text-anchor="middle" x="5675" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 38↔39</text>
<text text-anchor="middle" x="5675" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5675" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_11_0&#45;&gt;tp_0_11 -->
<g id="edge68" class="edge">
<title>expert_0_11_0&#45;&gt;tp_0_11</title>
<path fill="none" stroke="black" d="M6579.16,-11066.88C6576.42,-11066.59 6573.69,-11066.33 6571,-11066.07 6229.48,-11033.78 6139.61,-11078.46 5800,-11030.07 5788.52,-11028.43 5776.55,-11026.22 5764.76,-11023.74"/>
<polygon fill="black" stroke="black" points="5765.44,-11020.3 5754.92,-11021.59 5763.94,-11027.14 5765.44,-11020.3"/>
</g>
<!-- expert_0_11_1&#45;&gt;tp_0_11 -->
<g id="edge69" class="edge">
<title>expert_0_11_1&#45;&gt;tp_0_11</title>
<path fill="none" stroke="black" d="M6874.16,-11066.83C6871.42,-11066.56 6868.7,-11066.31 6866,-11066.07 6393.78,-11024.49 6269.73,-11093.91 5800,-11030.07 5788.42,-11028.5 5776.35,-11026.31 5764.48,-11023.82"/>
<polygon fill="black" stroke="black" points="5765.08,-11020.37 5754.56,-11021.67 5763.59,-11027.21 5765.08,-11020.37"/>
</g>
<!-- tp_0_11&#45;&gt;q_proj_1 -->
<g id="edge1413" class="edge">
<title>tp_0_11&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M5594.72,-10976.42C5579.94,-10973.08 5564.57,-10970.03 5550,-10967.85 5292.18,-10929.27 5221.59,-10956.65 4958.54,-10931.95"/>
<polygon fill="black" stroke="black" points="4958.59,-10928.44 4948.3,-10930.97 4957.92,-10935.41 4958.59,-10928.44"/>
</g>
<!-- tp_0_11&#45;&gt;k_proj_1 -->
<g id="edge1414" class="edge">
<title>tp_0_11&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M5592.9,-10976.86C5578.65,-10973.58 5563.94,-10970.43 5550,-10967.85 5458.49,-10950.89 5355.25,-10937.16 5272.21,-10927.42"/>
<polygon fill="black" stroke="black" points="5272.53,-10923.93 5262.19,-10926.25 5271.72,-10930.89 5272.53,-10923.93"/>
</g>
<!-- tp_0_11&#45;&gt;v_proj_1 -->
<g id="edge1415" class="edge">
<title>tp_0_11&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M5595.43,-10976.32C5580.44,-10972.95 5564.81,-10969.9 5550,-10967.85 5153.73,-10912.8 5046.7,-10965.73 4644.46,-10931.92"/>
<polygon fill="black" stroke="black" points="4644.55,-10928.42 4634.29,-10931.06 4643.96,-10935.39 4644.55,-10928.42"/>
</g>
<!-- expert_0_12_0 -->
<g id="node58" class="node">
<title>expert_0_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7446.5,-11110.07 7169.5,-11110.07 7169.5,-11066.07 7446.5,-11066.07 7446.5,-11110.07"/>
<text text-anchor="middle" x="7308" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L0</text>
<text text-anchor="middle" x="7308" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 40</text>
<text text-anchor="middle" x="7308" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_12&#45;&gt;expert_0_12_0 -->
<g id="edge71" class="edge">
<title>route_0_12&#45;&gt;expert_0_12_0</title>
<path fill="none" stroke="black" d="M7308,-11145.72C7308,-11137.44 7308,-11128.46 7308,-11120.15"/>
<polygon fill="black" stroke="black" points="7311.5,-11120.07 7308,-11110.07 7304.5,-11120.07 7311.5,-11120.07"/>
</g>
<!-- expert_0_12_1 -->
<g id="node59" class="node">
<title>expert_0_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7741.5,-11110.07 7464.5,-11110.07 7464.5,-11066.07 7741.5,-11066.07 7741.5,-11110.07"/>
<text text-anchor="middle" x="7603" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L0</text>
<text text-anchor="middle" x="7603" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 41</text>
<text text-anchor="middle" x="7603" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7603" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_12&#45;&gt;expert_0_12_1 -->
<g id="edge72" class="edge">
<title>route_0_12&#45;&gt;expert_0_12_1</title>
<path fill="none" stroke="black" d="M7398.92,-11149.34C7438.08,-11137.77 7483.51,-11124.35 7521.56,-11113.12"/>
<polygon fill="black" stroke="black" points="7522.97,-11116.35 7531.57,-11110.16 7520.99,-11109.64 7522.97,-11116.35"/>
</g>
<!-- tp_0_12 -->
<g id="node60" class="node">
<title>tp_0_12</title>
<ellipse fill="lightblue" stroke="black" cx="5925" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5925" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L0</text>
<text text-anchor="middle" x="5925" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 40↔41</text>
<text text-anchor="middle" x="5925" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5925" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_12_0&#45;&gt;tp_0_12 -->
<g id="edge73" class="edge">
<title>expert_0_12_0&#45;&gt;tp_0_12</title>
<path fill="none" stroke="black" d="M7169.16,-11066.82C7166.42,-11066.56 7163.7,-11066.31 7161,-11066.07 6668.84,-11023.07 6539.58,-11096.27 6050,-11030.07 6038.42,-11028.5 6026.35,-11026.32 6014.48,-11023.84"/>
<polygon fill="black" stroke="black" points="6015.08,-11020.38 6004.56,-11021.69 6013.59,-11027.23 6015.08,-11020.38"/>
</g>
<!-- expert_0_12_1&#45;&gt;tp_0_12 -->
<g id="edge74" class="edge">
<title>expert_0_12_1&#45;&gt;tp_0_12</title>
<path fill="none" stroke="black" d="M7464.16,-11066.8C7461.42,-11066.54 7458.7,-11066.3 7456,-11066.07 6833.1,-11013.78 6669.74,-11111.72 6050,-11030.07 6038.33,-11028.53 6026.16,-11026.35 6014.2,-11023.86"/>
<polygon fill="black" stroke="black" points="6014.73,-11020.39 6004.21,-11021.69 6013.25,-11027.23 6014.73,-11020.39"/>
</g>
<!-- tp_0_12&#45;&gt;q_proj_1 -->
<g id="edge1416" class="edge">
<title>tp_0_12&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M5845.09,-10976.28C5830.2,-10972.93 5814.7,-10969.91 5800,-10967.85 5431.9,-10916.15 5332.31,-10963.88 4958.31,-10931.91"/>
<polygon fill="black" stroke="black" points="4958.56,-10928.42 4948.29,-10931.04 4957.95,-10935.4 4958.56,-10928.42"/>
</g>
<!-- tp_0_12&#45;&gt;k_proj_1 -->
<g id="edge1417" class="edge">
<title>tp_0_12&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M5844.01,-10976.54C5829.43,-10973.23 5814.32,-10970.15 5800,-10967.85 5620.58,-10938.95 5412.25,-10924.27 5272.68,-10917.12"/>
<polygon fill="black" stroke="black" points="5272.49,-10913.6 5262.33,-10916.59 5272.14,-10920.59 5272.49,-10913.6"/>
</g>
<!-- tp_0_12&#45;&gt;v_proj_1 -->
<g id="edge1418" class="edge">
<title>tp_0_12&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M5845.44,-10976.21C5830.45,-10972.85 5814.82,-10969.84 5800,-10967.85 5293.48,-10899.69 5157.53,-10973.02 4644.55,-10931.92"/>
<polygon fill="black" stroke="black" points="4644.54,-10928.41 4634.29,-10931.09 4643.97,-10935.39 4644.54,-10928.41"/>
</g>
<!-- expert_0_13_0 -->
<g id="node62" class="node">
<title>expert_0_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8036.5,-11110.07 7759.5,-11110.07 7759.5,-11066.07 8036.5,-11066.07 8036.5,-11110.07"/>
<text text-anchor="middle" x="7898" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L0</text>
<text text-anchor="middle" x="7898" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 42</text>
<text text-anchor="middle" x="7898" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_13&#45;&gt;expert_0_13_0 -->
<g id="edge76" class="edge">
<title>route_0_13&#45;&gt;expert_0_13_0</title>
<path fill="none" stroke="black" d="M7898,-11145.72C7898,-11137.44 7898,-11128.46 7898,-11120.15"/>
<polygon fill="black" stroke="black" points="7901.5,-11120.07 7898,-11110.07 7894.5,-11120.07 7901.5,-11120.07"/>
</g>
<!-- expert_0_13_1 -->
<g id="node63" class="node">
<title>expert_0_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8331.5,-11110.07 8054.5,-11110.07 8054.5,-11066.07 8331.5,-11066.07 8331.5,-11110.07"/>
<text text-anchor="middle" x="8193" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L0</text>
<text text-anchor="middle" x="8193" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 43</text>
<text text-anchor="middle" x="8193" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8193" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_13&#45;&gt;expert_0_13_1 -->
<g id="edge77" class="edge">
<title>route_0_13&#45;&gt;expert_0_13_1</title>
<path fill="none" stroke="black" d="M7988.92,-11149.34C8028.08,-11137.77 8073.51,-11124.35 8111.56,-11113.12"/>
<polygon fill="black" stroke="black" points="8112.97,-11116.35 8121.57,-11110.16 8110.99,-11109.64 8112.97,-11116.35"/>
</g>
<!-- tp_0_13 -->
<g id="node64" class="node">
<title>tp_0_13</title>
<ellipse fill="lightblue" stroke="black" cx="6175" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6175" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L0</text>
<text text-anchor="middle" x="6175" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 42↔43</text>
<text text-anchor="middle" x="6175" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6175" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_13_0&#45;&gt;tp_0_13 -->
<g id="edge78" class="edge">
<title>expert_0_13_0&#45;&gt;tp_0_13</title>
<path fill="none" stroke="black" d="M7759.16,-11066.8C7756.42,-11066.54 7753.7,-11066.3 7751,-11066.07 7108.15,-11012.36 6939.59,-11114.08 6300,-11030.07 6288.33,-11028.54 6276.16,-11026.36 6264.2,-11023.86"/>
<polygon fill="black" stroke="black" points="6264.73,-11020.4 6254.21,-11021.7 6263.25,-11027.24 6264.73,-11020.4"/>
</g>
<!-- expert_0_13_1&#45;&gt;tp_0_13 -->
<g id="edge79" class="edge">
<title>expert_0_13_1&#45;&gt;tp_0_13</title>
<path fill="none" stroke="black" d="M8054.17,-11066.78C8051.42,-11066.53 8048.7,-11066.29 8046,-11066.07 7659.2,-11034.57 6684.88,-11079.8 6300,-11030.07 6288.33,-11028.56 6276.16,-11026.4 6264.19,-11023.91"/>
<polygon fill="black" stroke="black" points="6264.72,-11020.44 6254.21,-11021.75 6263.24,-11027.29 6264.72,-11020.44"/>
</g>
<!-- tp_0_13&#45;&gt;q_proj_1 -->
<g id="edge1419" class="edge">
<title>tp_0_13&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M6095.44,-10976.24C6080.45,-10972.87 6064.82,-10969.85 6050,-10967.85 5571.65,-10903.04 5443.12,-10971.17 4958.35,-10931.91"/>
<polygon fill="black" stroke="black" points="4958.54,-10928.41 4948.29,-10931.08 4957.97,-10935.39 4958.54,-10928.41"/>
</g>
<!-- tp_0_13&#45;&gt;k_proj_1 -->
<g id="edge1420" class="edge">
<title>tp_0_13&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M6094.72,-10976.42C6079.94,-10973.08 6064.57,-10970.03 6050,-10967.85 5778.86,-10927.25 5459.41,-10915.4 5272.54,-10912.04"/>
<polygon fill="black" stroke="black" points="5272.42,-10908.54 5262.36,-10911.86 5272.3,-10915.54 5272.42,-10908.54"/>
</g>
<!-- tp_0_13&#45;&gt;v_proj_1 -->
<g id="edge1421" class="edge">
<title>tp_0_13&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M6095.79,-10976.22C6080.69,-10972.84 6064.94,-10969.81 6050,-10967.85 5433.15,-10886.58 5268.34,-10980.36 4644.44,-10931.91"/>
<polygon fill="black" stroke="black" points="4644.53,-10928.41 4634.29,-10931.11 4643.98,-10935.38 4644.53,-10928.41"/>
</g>
<!-- expert_0_14_0 -->
<g id="node66" class="node">
<title>expert_0_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8626.5,-11110.07 8349.5,-11110.07 8349.5,-11066.07 8626.5,-11066.07 8626.5,-11110.07"/>
<text text-anchor="middle" x="8488" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L0</text>
<text text-anchor="middle" x="8488" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 44</text>
<text text-anchor="middle" x="8488" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_14&#45;&gt;expert_0_14_0 -->
<g id="edge81" class="edge">
<title>route_0_14&#45;&gt;expert_0_14_0</title>
<path fill="none" stroke="black" d="M8488,-11145.72C8488,-11137.44 8488,-11128.46 8488,-11120.15"/>
<polygon fill="black" stroke="black" points="8491.5,-11120.07 8488,-11110.07 8484.5,-11120.07 8491.5,-11120.07"/>
</g>
<!-- expert_0_14_1 -->
<g id="node67" class="node">
<title>expert_0_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8921.5,-11110.07 8644.5,-11110.07 8644.5,-11066.07 8921.5,-11066.07 8921.5,-11110.07"/>
<text text-anchor="middle" x="8783" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L0</text>
<text text-anchor="middle" x="8783" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 45</text>
<text text-anchor="middle" x="8783" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8783" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_14&#45;&gt;expert_0_14_1 -->
<g id="edge82" class="edge">
<title>route_0_14&#45;&gt;expert_0_14_1</title>
<path fill="none" stroke="black" d="M8578.92,-11149.34C8618.08,-11137.77 8663.51,-11124.35 8701.56,-11113.12"/>
<polygon fill="black" stroke="black" points="8702.97,-11116.35 8711.57,-11110.16 8700.99,-11109.64 8702.97,-11116.35"/>
</g>
<!-- tp_0_14 -->
<g id="node68" class="node">
<title>tp_0_14</title>
<ellipse fill="lightblue" stroke="black" cx="6425" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6425" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L0</text>
<text text-anchor="middle" x="6425" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 44↔45</text>
<text text-anchor="middle" x="6425" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6425" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_14_0&#45;&gt;tp_0_14 -->
<g id="edge83" class="edge">
<title>expert_0_14_0&#45;&gt;tp_0_14</title>
<path fill="none" stroke="black" d="M8349.17,-11066.78C8346.42,-11066.53 8343.7,-11066.29 8341,-11066.07 7944.22,-11033.86 6944.81,-11080.98 6550,-11030.07 6538.33,-11028.57 6526.16,-11026.4 6514.19,-11023.92"/>
<polygon fill="black" stroke="black" points="6514.72,-11020.45 6504.21,-11021.76 6513.24,-11027.29 6514.72,-11020.45"/>
</g>
<!-- expert_0_14_1&#45;&gt;tp_0_14 -->
<g id="edge84" class="edge">
<title>expert_0_14_1&#45;&gt;tp_0_14</title>
<path fill="none" stroke="black" d="M8644.17,-11066.77C8641.42,-11066.52 8638.7,-11066.29 8636,-11066.07 8173.84,-11029.22 7009.9,-11088.71 6550,-11030.07 6538.32,-11028.58 6526.15,-11026.43 6514.19,-11023.95"/>
<polygon fill="black" stroke="black" points="6514.71,-11020.48 6504.2,-11021.79 6513.24,-11027.32 6514.71,-11020.48"/>
</g>
<!-- tp_0_14&#45;&gt;q_proj_1 -->
<g id="edge1422" class="edge">
<title>tp_0_14&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M6345.45,-10976.16C6330.45,-10972.81 6314.83,-10969.81 6300,-10967.85 5711.38,-10889.93 5553.96,-10978.49 4958.42,-10931.91"/>
<polygon fill="black" stroke="black" points="4958.53,-10928.41 4948.29,-10931.11 4957.98,-10935.38 4958.53,-10928.41"/>
</g>
<!-- tp_0_14&#45;&gt;k_proj_1 -->
<g id="edge1423" class="edge">
<title>tp_0_14&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M6345.08,-10976.34C6330.19,-10972.99 6314.69,-10969.95 6300,-10967.85 6106.37,-10940.12 5548.04,-10922.18 5272.15,-10914.75"/>
<polygon fill="black" stroke="black" points="5272.14,-10911.25 5262.05,-10914.48 5271.95,-10918.24 5272.14,-10911.25"/>
</g>
<!-- tp_0_14&#45;&gt;v_proj_1 -->
<g id="edge1424" class="edge">
<title>tp_0_14&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M6345.79,-10976.18C6330.7,-10972.79 6314.94,-10969.78 6300,-10967.85 5937.96,-10920.86 5026.42,-10959.61 4644.33,-10931.88"/>
<polygon fill="black" stroke="black" points="4644.52,-10928.38 4634.29,-10931.13 4644,-10935.37 4644.52,-10928.38"/>
</g>
<!-- expert_0_15_0 -->
<g id="node70" class="node">
<title>expert_0_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9216.5,-11110.07 8939.5,-11110.07 8939.5,-11066.07 9216.5,-11066.07 9216.5,-11110.07"/>
<text text-anchor="middle" x="9078" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L0</text>
<text text-anchor="middle" x="9078" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 46</text>
<text text-anchor="middle" x="9078" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_15&#45;&gt;expert_0_15_0 -->
<g id="edge86" class="edge">
<title>route_0_15&#45;&gt;expert_0_15_0</title>
<path fill="none" stroke="black" d="M9078,-11145.72C9078,-11137.44 9078,-11128.46 9078,-11120.15"/>
<polygon fill="black" stroke="black" points="9081.5,-11120.07 9078,-11110.07 9074.5,-11120.07 9081.5,-11120.07"/>
</g>
<!-- expert_0_15_1 -->
<g id="node71" class="node">
<title>expert_0_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9511.5,-11110.07 9234.5,-11110.07 9234.5,-11066.07 9511.5,-11066.07 9511.5,-11110.07"/>
<text text-anchor="middle" x="9373" y="-11100.87" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L0</text>
<text text-anchor="middle" x="9373" y="-11090.87" font-family="Times,serif" font-size="9.00">GPU: 47</text>
<text text-anchor="middle" x="9373" y="-11080.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9373" y="-11070.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_15&#45;&gt;expert_0_15_1 -->
<g id="edge87" class="edge">
<title>route_0_15&#45;&gt;expert_0_15_1</title>
<path fill="none" stroke="black" d="M9168.92,-11149.34C9208.08,-11137.77 9253.51,-11124.35 9291.56,-11113.12"/>
<polygon fill="black" stroke="black" points="9292.97,-11116.35 9301.57,-11110.16 9290.99,-11109.64 9292.97,-11116.35"/>
</g>
<!-- tp_0_15 -->
<g id="node72" class="node">
<title>tp_0_15</title>
<ellipse fill="lightblue" stroke="black" cx="6675" cy="-10998.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6675" y="-11011.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L0</text>
<text text-anchor="middle" x="6675" y="-11001.76" font-family="Times,serif" font-size="9.00">GPU: 46↔47</text>
<text text-anchor="middle" x="6675" y="-10991.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6675" y="-10981.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_15_0&#45;&gt;tp_0_15 -->
<g id="edge88" class="edge">
<title>expert_0_15_0&#45;&gt;tp_0_15</title>
<path fill="none" stroke="black" d="M8939.16,-11066.81C8936.42,-11066.55 8933.7,-11066.3 8931,-11066.07 8512.38,-11030.15 7211.95,-11008.02 6800.89,-11001.78"/>
<polygon fill="black" stroke="black" points="6800.8,-10998.28 6790.75,-11001.62 6800.7,-11005.28 6800.8,-10998.28"/>
</g>
<!-- expert_0_15_1&#45;&gt;tp_0_15 -->
<g id="edge89" class="edge">
<title>expert_0_15_1&#45;&gt;tp_0_15</title>
<path fill="none" stroke="black" d="M9234.16,-11066.8C9231.42,-11066.54 9228.7,-11066.3 9226,-11066.07 8746.93,-11025.78 7246.66,-11006.29 6801.03,-11001.29"/>
<polygon fill="black" stroke="black" points="6801.05,-10997.79 6791.02,-11001.17 6800.98,-11004.79 6801.05,-10997.79"/>
</g>
<!-- tp_0_15&#45;&gt;q_proj_1 -->
<g id="edge1425" class="edge">
<title>tp_0_15&#45;&gt;q_proj_1</title>
<path fill="none" stroke="black" d="M6595.79,-10976.19C6580.69,-10972.8 6564.94,-10969.79 6550,-10967.85 6202.13,-10922.54 5326.47,-10958.68 4958.49,-10931.89"/>
<polygon fill="black" stroke="black" points="4958.52,-10928.38 4948.29,-10931.12 4958,-10935.36 4958.52,-10928.38"/>
</g>
<!-- tp_0_15&#45;&gt;k_proj_1 -->
<g id="edge1426" class="edge">
<title>tp_0_15&#45;&gt;k_proj_1</title>
<path fill="none" stroke="black" d="M6595.43,-10976.32C6580.44,-10972.95 6564.81,-10969.9 6550,-10967.85 6307.51,-10934.16 5592.94,-10918.62 5272.56,-10913.21"/>
<polygon fill="black" stroke="black" points="5272.32,-10909.7 5262.27,-10913.03 5272.21,-10916.7 5272.32,-10909.7"/>
</g>
<!-- tp_0_15&#45;&gt;v_proj_1 -->
<g id="edge1427" class="edge">
<title>tp_0_15&#45;&gt;v_proj_1</title>
<path fill="none" stroke="black" d="M6595.8,-10976.14C6580.7,-10972.76 6564.94,-10969.76 6550,-10967.85 6132.88,-10914.31 5082.22,-10963.22 4644.51,-10931.89"/>
<polygon fill="black" stroke="black" points="4644.52,-10928.38 4634.29,-10931.14 4644,-10935.36 4644.52,-10928.38"/>
</g>
<!-- attn_scores_1 -->
<g id="node76" class="node">
<title>attn_scores_1</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-10851.85 4633.5,-10851.85 4633.5,-10807.85 4966.5,-10807.85 4966.5,-10851.85"/>
<text text-anchor="middle" x="4800" y="-10842.65" font-family="Times,serif" font-size="9.00">Attention Scores L1</text>
<text text-anchor="middle" x="4800" y="-10832.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-10822.65" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-10812.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_1&#45;&gt;attn_scores_1 -->
<g id="edge90" class="edge">
<title>q_proj_1&#45;&gt;attn_scores_1</title>
<path fill="none" stroke="black" d="M4800,-10887.53C4800,-10879.64 4800,-10870.53 4800,-10861.95"/>
<polygon fill="black" stroke="black" points="4803.5,-10861.86 4800,-10851.86 4796.5,-10861.86 4803.5,-10861.86"/>
</g>
<!-- k_proj_1&#45;&gt;attn_scores_1 -->
<g id="edge91" class="edge">
<title>k_proj_1&#45;&gt;attn_scores_1</title>
<path fill="none" stroke="black" d="M5029.44,-10887.84C4987.82,-10877.5 4937.49,-10865 4894.59,-10854.34"/>
<polygon fill="black" stroke="black" points="4895.26,-10850.9 4884.71,-10851.89 4893.57,-10857.7 4895.26,-10850.9"/>
</g>
<!-- v_proj_1&#45;&gt;attn_scores_1 -->
<g id="edge92" class="edge">
<title>v_proj_1&#45;&gt;attn_scores_1</title>
<path fill="none" stroke="black" d="M4570.56,-10887.84C4612.18,-10877.5 4662.51,-10865 4705.41,-10854.34"/>
<polygon fill="black" stroke="black" points="4706.43,-10857.7 4715.29,-10851.89 4704.74,-10850.9 4706.43,-10857.7"/>
</g>
<!-- softmax_1 -->
<g id="node77" class="node">
<title>softmax_1</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-10771.85 4633.5,-10771.85 4633.5,-10727.85 4966.5,-10727.85 4966.5,-10771.85"/>
<text text-anchor="middle" x="4800" y="-10762.65" font-family="Times,serif" font-size="9.00">Softmax L1</text>
<text text-anchor="middle" x="4800" y="-10752.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-10742.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4800" y="-10732.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_1&#45;&gt;softmax_1 -->
<g id="edge93" class="edge">
<title>attn_scores_1&#45;&gt;softmax_1</title>
<path fill="none" stroke="black" d="M4800,-10807.53C4800,-10799.64 4800,-10790.53 4800,-10781.95"/>
<polygon fill="black" stroke="black" points="4803.5,-10781.86 4800,-10771.86 4796.5,-10781.86 4803.5,-10781.86"/>
</g>
<!-- attn_out_1 -->
<g id="node78" class="node">
<title>attn_out_1</title>
<polygon fill="lightgreen" stroke="black" points="4948,-10691.85 4652,-10691.85 4652,-10647.85 4948,-10647.85 4948,-10691.85"/>
<text text-anchor="middle" x="4800" y="-10682.65" font-family="Times,serif" font-size="9.00">Attention Output L1</text>
<text text-anchor="middle" x="4800" y="-10672.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="4800" y="-10662.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-10652.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_1&#45;&gt;attn_out_1 -->
<g id="edge94" class="edge">
<title>softmax_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M4800,-10727.53C4800,-10719.64 4800,-10710.53 4800,-10701.95"/>
<polygon fill="black" stroke="black" points="4803.5,-10701.86 4800,-10691.86 4796.5,-10701.86 4803.5,-10701.86"/>
</g>
<!-- gate_1 -->
<g id="node79" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="5099.74,-10611.85 4622.92,-10611.85 4500.26,-10523.85 4977.08,-10523.85 5099.74,-10611.85"/>
<text text-anchor="middle" x="4800" y="-10580.65" font-family="Times,serif" font-size="9.00">Gate L1</text>
<text text-anchor="middle" x="4800" y="-10570.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="4800" y="-10560.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-10550.65" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_1&#45;&gt;gate_1 -->
<g id="edge95" class="edge">
<title>attn_out_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M4800,-10647.64C4800,-10640.14 4800,-10631.33 4800,-10622.37"/>
<polygon fill="black" stroke="black" points="4803.5,-10622.25 4800,-10612.25 4796.5,-10622.25 4803.5,-10622.25"/>
</g>
<!-- route_1_0 -->
<g id="node80" class="node">
<title>route_1_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="523" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="523" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="523" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="523" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_0 -->
<g id="edge96" class="edge">
<title>gate_1&#45;&gt;route_1_0</title>
<path fill="none" stroke="black" d="M4560.09,-10566.89C3949.43,-10565.92 2286.63,-10556.63 903,-10487.85 837.75,-10484.6 766.32,-10479.38 703.17,-10474.19"/>
<polygon fill="black" stroke="black" points="703.36,-10470.7 693.11,-10473.36 702.79,-10477.67 703.36,-10470.7"/>
</g>
<!-- route_1_1 -->
<g id="node84" class="node">
<title>route_1_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1113" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1113" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1113" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 2,3</text>
<text text-anchor="middle" x="1113" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_1 -->
<g id="edge101" class="edge">
<title>gate_1&#45;&gt;route_1_1</title>
<path fill="none" stroke="black" d="M4558.4,-10565.64C4011.99,-10561.91 2639.53,-10546.92 1493,-10487.85 1427.91,-10484.49 1356.67,-10479.26 1293.63,-10474.1"/>
<polygon fill="black" stroke="black" points="1293.84,-10470.6 1283.59,-10473.27 1293.27,-10477.58 1293.84,-10470.6"/>
</g>
<!-- route_1_2 -->
<g id="node88" class="node">
<title>route_1_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1703" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1703" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1703" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 4,5</text>
<text text-anchor="middle" x="1703" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_2 -->
<g id="edge106" class="edge">
<title>gate_1&#45;&gt;route_1_2</title>
<path fill="none" stroke="black" d="M4555.82,-10563.84C4079.8,-10557.06 2994.5,-10537.18 2083,-10487.85 2018.08,-10484.33 1947.02,-10479.08 1884.1,-10473.94"/>
<polygon fill="black" stroke="black" points="1884.32,-10470.45 1874.07,-10473.12 1883.75,-10477.42 1884.32,-10470.45"/>
</g>
<!-- route_1_3 -->
<g id="node92" class="node">
<title>route_1_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2293" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2293" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2293" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 6,7</text>
<text text-anchor="middle" x="2293" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_3 -->
<g id="edge111" class="edge">
<title>gate_1&#45;&gt;route_1_3</title>
<path fill="none" stroke="black" d="M4551.78,-10561C4154.71,-10550.9 3352.24,-10527.35 2673,-10487.85 2608.41,-10484.09 2537.73,-10478.81 2475.03,-10473.72"/>
<polygon fill="black" stroke="black" points="2475.29,-10470.23 2465.04,-10472.9 2474.72,-10477.2 2475.29,-10470.23"/>
</g>
<!-- route_1_4 -->
<g id="node96" class="node">
<title>route_1_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2883" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2883" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2883" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 8,9</text>
<text text-anchor="middle" x="2883" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_4 -->
<g id="edge116" class="edge">
<title>gate_1&#45;&gt;route_1_4</title>
<path fill="none" stroke="black" d="M4544.91,-10555.9C4239.88,-10542.31 3713.93,-10517.29 3263,-10487.85 3199.04,-10483.67 3129.08,-10478.34 3066.82,-10473.33"/>
<polygon fill="black" stroke="black" points="3066.74,-10469.81 3056.49,-10472.5 3066.18,-10476.79 3066.74,-10469.81"/>
</g>
<!-- route_1_5 -->
<g id="node100" class="node">
<title>route_1_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3473" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3473" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3473" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 10,11</text>
<text text-anchor="middle" x="3473" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_5 -->
<g id="edge121" class="edge">
<title>gate_1&#45;&gt;route_1_5</title>
<path fill="none" stroke="black" d="M4529.06,-10544.57C4269.32,-10523.21 3884.23,-10491.55 3657.92,-10472.94"/>
<polygon fill="black" stroke="black" points="3658.18,-10469.45 3647.93,-10472.12 3657.61,-10476.42 3658.18,-10469.45"/>
</g>
<!-- route_1_6 -->
<g id="node104" class="node">
<title>route_1_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4063" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4063" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4063" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 12,13</text>
<text text-anchor="middle" x="4063" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_6 -->
<g id="edge126" class="edge">
<title>gate_1&#45;&gt;route_1_6</title>
<path fill="none" stroke="black" d="M4509.51,-10523.84C4408.8,-10508.93 4299.94,-10492.81 4214.92,-10480.22"/>
<polygon fill="black" stroke="black" points="4215.34,-10476.75 4204.93,-10478.75 4214.31,-10483.67 4215.34,-10476.75"/>
</g>
<!-- route_1_7 -->
<g id="node108" class="node">
<title>route_1_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4590" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4590" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4590" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 14,15</text>
<text text-anchor="middle" x="4590" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4590" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_7 -->
<g id="edge131" class="edge">
<title>gate_1&#45;&gt;route_1_7</title>
<path fill="none" stroke="black" d="M4717,-10523.72C4696.22,-10512.92 4674.24,-10501.5 4654.51,-10491.25"/>
<polygon fill="black" stroke="black" points="4656.1,-10488.14 4645.62,-10486.63 4652.88,-10494.35 4656.1,-10488.14"/>
</g>
<!-- route_1_8 -->
<g id="node112" class="node">
<title>route_1_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5010" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5010" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5010" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="5010" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5010" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_8 -->
<g id="edge136" class="edge">
<title>gate_1&#45;&gt;route_1_8</title>
<path fill="none" stroke="black" d="M4883,-10523.72C4903.78,-10512.92 4925.76,-10501.5 4945.49,-10491.25"/>
<polygon fill="black" stroke="black" points="4947.12,-10494.35 4954.38,-10486.63 4943.9,-10488.14 4947.12,-10494.35"/>
</g>
<!-- route_1_9 -->
<g id="node116" class="node">
<title>route_1_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5538" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5538" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5538" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 34,35</text>
<text text-anchor="middle" x="5538" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_9 -->
<g id="edge141" class="edge">
<title>gate_1&#45;&gt;route_1_9</title>
<path fill="none" stroke="black" d="M4996.8,-10537.75C5118.76,-10519.72 5273.08,-10496.9 5385.69,-10480.25"/>
<polygon fill="black" stroke="black" points="5386.39,-10483.69 5395.77,-10478.76 5385.37,-10476.76 5386.39,-10483.69"/>
</g>
<!-- route_1_10 -->
<g id="node120" class="node">
<title>route_1_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6128" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6128" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6128" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 36,37</text>
<text text-anchor="middle" x="6128" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_10 -->
<g id="edge146" class="edge">
<title>gate_1&#45;&gt;route_1_10</title>
<path fill="none" stroke="black" d="M5013,-10549.34C5270.37,-10528.2 5699.14,-10492.97 5943.18,-10472.92"/>
<polygon fill="black" stroke="black" points="5943.54,-10476.4 5953.22,-10472.09 5942.96,-10469.42 5943.54,-10476.4"/>
</g>
<!-- route_1_11 -->
<g id="node124" class="node">
<title>route_1_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6718" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6718" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6718" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 38,39</text>
<text text-anchor="middle" x="6718" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_11 -->
<g id="edge151" class="edge">
<title>gate_1&#45;&gt;route_1_11</title>
<path fill="none" stroke="black" d="M5023.94,-10557.29C5323.44,-10544.07 5870.94,-10518.34 6338,-10487.85 6401.96,-10483.67 6471.92,-10478.34 6534.18,-10473.33"/>
<polygon fill="black" stroke="black" points="6534.82,-10476.79 6544.51,-10472.5 6534.26,-10469.82 6534.82,-10476.79"/>
</g>
<!-- route_1_12 -->
<g id="node128" class="node">
<title>route_1_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7308" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7308" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7308" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 40,41</text>
<text text-anchor="middle" x="7308" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_12 -->
<g id="edge156" class="edge">
<title>gate_1&#45;&gt;route_1_12</title>
<path fill="none" stroke="black" d="M5029.64,-10561.48C5419.94,-10551.65 6237.6,-10528 6928,-10487.85 6992.59,-10484.09 7063.27,-10478.81 7125.97,-10473.72"/>
<polygon fill="black" stroke="black" points="7126.28,-10477.2 7135.96,-10472.9 7125.71,-10470.23 7126.28,-10477.2"/>
</g>
<!-- route_1_13 -->
<g id="node132" class="node">
<title>route_1_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7898" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7898" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7898" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 42,43</text>
<text text-anchor="middle" x="7898" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_13 -->
<g id="edge161" class="edge">
<title>gate_1&#45;&gt;route_1_13</title>
<path fill="none" stroke="black" d="M5033.3,-10563.99C5503.62,-10557.38 6599.09,-10537.58 7518,-10487.85 7582.92,-10484.33 7653.98,-10479.08 7716.9,-10473.94"/>
<polygon fill="black" stroke="black" points="7717.25,-10477.42 7726.93,-10473.12 7716.68,-10470.45 7717.25,-10477.42"/>
</g>
<!-- route_1_14 -->
<g id="node136" class="node">
<title>route_1_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8488" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8488" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8488" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 44,45</text>
<text text-anchor="middle" x="8488" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_14 -->
<g id="edge166" class="edge">
<title>gate_1&#45;&gt;route_1_14</title>
<path fill="none" stroke="black" d="M5035.56,-10565.68C5577.95,-10562.03 6956.82,-10547.16 8108,-10487.85 8173.09,-10484.49 8244.33,-10479.26 8307.37,-10474.1"/>
<polygon fill="black" stroke="black" points="8307.73,-10477.58 8317.41,-10473.27 8307.16,-10470.6 8307.73,-10477.58"/>
</g>
<!-- route_1_15 -->
<g id="node140" class="node">
<title>route_1_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9078" cy="-10456.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9078" y="-10469.53" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9078" y="-10459.53" font-family="Times,serif" font-size="9.00">GPU: 46,47</text>
<text text-anchor="middle" x="9078" y="-10449.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-10439.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_15 -->
<g id="edge171" class="edge">
<title>gate_1&#45;&gt;route_1_15</title>
<path fill="none" stroke="black" d="M5037.19,-10566.89C5645.71,-10565.96 7311.91,-10556.75 8698,-10487.85 8763.25,-10484.6 8834.68,-10479.38 8897.83,-10474.19"/>
<polygon fill="black" stroke="black" points="8898.21,-10477.67 8907.89,-10473.36 8897.64,-10470.7 8898.21,-10477.67"/>
</g>
<!-- expert_1_0_0 -->
<g id="node81" class="node">
<title>expert_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="366.5,-10389.62 89.5,-10389.62 89.5,-10345.62 366.5,-10345.62 366.5,-10389.62"/>
<text text-anchor="middle" x="228" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L1</text>
<text text-anchor="middle" x="228" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="228" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_0&#45;&gt;expert_1_0_0 -->
<g id="edge97" class="edge">
<title>route_1_0&#45;&gt;expert_1_0_0</title>
<path fill="none" stroke="black" d="M432.08,-10428.88C392.92,-10417.32 347.49,-10403.9 309.44,-10392.67"/>
<polygon fill="black" stroke="black" points="310.01,-10389.19 299.43,-10389.71 308.03,-10395.9 310.01,-10389.19"/>
</g>
<!-- expert_1_0_1 -->
<g id="node82" class="node">
<title>expert_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="661.5,-10389.62 384.5,-10389.62 384.5,-10345.62 661.5,-10345.62 661.5,-10389.62"/>
<text text-anchor="middle" x="523" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L1</text>
<text text-anchor="middle" x="523" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="523" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_0&#45;&gt;expert_1_0_1 -->
<g id="edge98" class="edge">
<title>route_1_0&#45;&gt;expert_1_0_1</title>
<path fill="none" stroke="black" d="M523,-10425.26C523,-10416.99 523,-10408.01 523,-10399.7"/>
<polygon fill="black" stroke="black" points="526.5,-10399.62 523,-10389.62 519.5,-10399.62 526.5,-10399.62"/>
</g>
<!-- tp_1_0 -->
<g id="node83" class="node">
<title>tp_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="2925" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2925" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L1</text>
<text text-anchor="middle" x="2925" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="2925" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2925" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_0_0&#45;&gt;tp_1_0 -->
<g id="edge99" class="edge">
<title>expert_1_0_0&#45;&gt;tp_1_0</title>
<path fill="none" stroke="black" d="M366.84,-10346.35C369.58,-10346.09 372.3,-10345.85 375,-10345.62 853.88,-10305.34 2353.56,-10285.84 2799.02,-10280.84"/>
<polygon fill="black" stroke="black" points="2799.07,-10284.34 2809.03,-10280.72 2798.99,-10277.34 2799.07,-10284.34"/>
</g>
<!-- expert_1_0_1&#45;&gt;tp_1_0 -->
<g id="edge100" class="edge">
<title>expert_1_0_1&#45;&gt;tp_1_0</title>
<path fill="none" stroke="black" d="M661.6,-10346.48C664.76,-10346.17 667.9,-10345.88 671,-10345.62 1089.26,-10309.92 2388.54,-10287.64 2799.23,-10281.35"/>
<polygon fill="black" stroke="black" points="2799.41,-10284.84 2809.35,-10281.19 2799.3,-10277.84 2799.41,-10284.84"/>
</g>
<!-- q_proj_2 -->
<g id="node144" class="node">
<title>q_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="4634,-10200.39 4338,-10200.39 4338,-10156.39 4634,-10156.39 4634,-10200.39"/>
<text text-anchor="middle" x="4486" y="-10191.19" font-family="Times,serif" font-size="9.00">Q Projection L2</text>
<text text-anchor="middle" x="4486" y="-10181.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4486" y="-10171.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4486" y="-10161.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_1_0&#45;&gt;q_proj_2 -->
<g id="edge1428" class="edge">
<title>tp_1_0&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M2993.34,-10253.25C3011.53,-10247.74 3031.33,-10242.58 3050,-10239.39 3291.43,-10198.24 4006.98,-10184.92 4327.56,-10180.95"/>
<polygon fill="black" stroke="black" points="4327.9,-10184.44 4337.86,-10180.82 4327.82,-10177.44 4327.9,-10184.44"/>
</g>
<!-- k_proj_2 -->
<g id="node145" class="node">
<title>k_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="5262,-10200.39 4966,-10200.39 4966,-10156.39 5262,-10156.39 5262,-10200.39"/>
<text text-anchor="middle" x="5114" y="-10191.19" font-family="Times,serif" font-size="9.00">K Projection L2</text>
<text text-anchor="middle" x="5114" y="-10181.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="5114" y="-10171.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5114" y="-10161.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_1_0&#45;&gt;k_proj_2 -->
<g id="edge1429" class="edge">
<title>tp_1_0&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M2992.29,-10253.07C3010.75,-10247.45 3030.93,-10242.28 3050,-10239.39 3154.75,-10223.55 4852.44,-10248.48 4957,-10231.39 4990.1,-10225.98 5025.67,-10214.69 5054.58,-10204"/>
<polygon fill="black" stroke="black" points="5055.99,-10207.21 5064.11,-10200.41 5053.52,-10200.66 5055.99,-10207.21"/>
</g>
<!-- v_proj_2 -->
<g id="node146" class="node">
<title>v_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="4948,-10200.39 4652,-10200.39 4652,-10156.39 4948,-10156.39 4948,-10200.39"/>
<text text-anchor="middle" x="4800" y="-10191.19" font-family="Times,serif" font-size="9.00">V Projection L2</text>
<text text-anchor="middle" x="4800" y="-10181.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4800" y="-10171.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-10161.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_1_0&#45;&gt;v_proj_2 -->
<g id="edge1430" class="edge">
<title>tp_1_0&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M2992.29,-10253.08C3010.75,-10247.46 3030.93,-10242.29 3050,-10239.39 3137.5,-10226.13 4555.66,-10245.71 4643,-10231.39 4676.09,-10225.97 4711.67,-10214.67 4740.58,-10203.99"/>
<polygon fill="black" stroke="black" points="4741.99,-10207.2 4750.11,-10200.4 4739.52,-10200.65 4741.99,-10207.2"/>
</g>
<!-- expert_1_1_0 -->
<g id="node85" class="node">
<title>expert_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="956.5,-10389.62 679.5,-10389.62 679.5,-10345.62 956.5,-10345.62 956.5,-10389.62"/>
<text text-anchor="middle" x="818" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L1</text>
<text text-anchor="middle" x="818" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 2</text>
<text text-anchor="middle" x="818" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="818" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_1&#45;&gt;expert_1_1_0 -->
<g id="edge102" class="edge">
<title>route_1_1&#45;&gt;expert_1_1_0</title>
<path fill="none" stroke="black" d="M1022.08,-10428.88C982.92,-10417.32 937.49,-10403.9 899.44,-10392.67"/>
<polygon fill="black" stroke="black" points="900.01,-10389.19 889.43,-10389.71 898.03,-10395.9 900.01,-10389.19"/>
</g>
<!-- expert_1_1_1 -->
<g id="node86" class="node">
<title>expert_1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1251.5,-10389.62 974.5,-10389.62 974.5,-10345.62 1251.5,-10345.62 1251.5,-10389.62"/>
<text text-anchor="middle" x="1113" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L1</text>
<text text-anchor="middle" x="1113" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 3</text>
<text text-anchor="middle" x="1113" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_1&#45;&gt;expert_1_1_1 -->
<g id="edge103" class="edge">
<title>route_1_1&#45;&gt;expert_1_1_1</title>
<path fill="none" stroke="black" d="M1113,-10425.26C1113,-10416.99 1113,-10408.01 1113,-10399.7"/>
<polygon fill="black" stroke="black" points="1116.5,-10399.62 1113,-10389.62 1109.5,-10399.62 1116.5,-10399.62"/>
</g>
<!-- tp_1_1 -->
<g id="node87" class="node">
<title>tp_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="3175" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3175" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L1</text>
<text text-anchor="middle" x="3175" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 2↔3</text>
<text text-anchor="middle" x="3175" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3175" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_1_0&#45;&gt;tp_1_1 -->
<g id="edge104" class="edge">
<title>expert_1_1_0&#45;&gt;tp_1_1</title>
<path fill="none" stroke="black" d="M956.59,-10346.42C959.76,-10346.14 962.9,-10345.87 966,-10345.62 1427.73,-10309.01 2590.54,-10368.21 3050,-10309.62 3061.68,-10308.13 3073.85,-10305.98 3085.81,-10303.5"/>
<polygon fill="black" stroke="black" points="3086.76,-10306.87 3095.8,-10301.34 3085.29,-10300.03 3086.76,-10306.87"/>
</g>
<!-- expert_1_1_1&#45;&gt;tp_1_1 -->
<g id="edge105" class="edge">
<title>expert_1_1_1&#45;&gt;tp_1_1</title>
<path fill="none" stroke="black" d="M1251.6,-10346.44C1254.76,-10346.14 1257.9,-10345.87 1261,-10345.62 1657.35,-10313.63 2655.63,-10360.48 3050,-10309.62 3061.67,-10308.11 3073.84,-10305.95 3085.81,-10303.47"/>
<polygon fill="black" stroke="black" points="3086.76,-10306.84 3095.79,-10301.31 3085.28,-10300 3086.76,-10306.84"/>
</g>
<!-- tp_1_1&#45;&gt;q_proj_2 -->
<g id="edge1431" class="edge">
<title>tp_1_1&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M3243.36,-10253.36C3261.55,-10247.85 3281.34,-10242.66 3300,-10239.39 3492.7,-10205.67 4051.48,-10188.97 4327.67,-10182.59"/>
<polygon fill="black" stroke="black" points="4327.86,-10186.09 4337.77,-10182.36 4327.7,-10179.09 4327.86,-10186.09"/>
</g>
<!-- tp_1_1&#45;&gt;k_proj_2 -->
<g id="edge1432" class="edge">
<title>tp_1_1&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M3242.29,-10253.08C3260.75,-10247.46 3280.93,-10242.28 3300,-10239.39 3391.02,-10225.6 4866.15,-10246.27 4957,-10231.39 4990.1,-10225.97 5025.67,-10214.68 5054.58,-10203.99"/>
<polygon fill="black" stroke="black" points="5055.99,-10207.2 5064.11,-10200.4 5053.52,-10200.65 5055.99,-10207.2"/>
</g>
<!-- tp_1_1&#45;&gt;v_proj_2 -->
<g id="edge1433" class="edge">
<title>tp_1_1&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M3242.29,-10253.09C3260.75,-10247.47 3280.93,-10242.29 3300,-10239.39 3373.76,-10228.17 4569.38,-10243.49 4643,-10231.39 4675.96,-10225.98 4711.39,-10214.74 4740.24,-10204.1"/>
<polygon fill="black" stroke="black" points="4741.63,-10207.32 4749.76,-10200.52 4739.16,-10200.76 4741.63,-10207.32"/>
</g>
<!-- expert_1_2_0 -->
<g id="node89" class="node">
<title>expert_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1546.5,-10389.62 1269.5,-10389.62 1269.5,-10345.62 1546.5,-10345.62 1546.5,-10389.62"/>
<text text-anchor="middle" x="1408" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L1</text>
<text text-anchor="middle" x="1408" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 4</text>
<text text-anchor="middle" x="1408" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1408" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_2&#45;&gt;expert_1_2_0 -->
<g id="edge107" class="edge">
<title>route_1_2&#45;&gt;expert_1_2_0</title>
<path fill="none" stroke="black" d="M1612.08,-10428.88C1572.92,-10417.32 1527.49,-10403.9 1489.44,-10392.67"/>
<polygon fill="black" stroke="black" points="1490.01,-10389.19 1479.43,-10389.71 1488.03,-10395.9 1490.01,-10389.19"/>
</g>
<!-- expert_1_2_1 -->
<g id="node90" class="node">
<title>expert_1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1841.5,-10389.62 1564.5,-10389.62 1564.5,-10345.62 1841.5,-10345.62 1841.5,-10389.62"/>
<text text-anchor="middle" x="1703" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L1</text>
<text text-anchor="middle" x="1703" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 5</text>
<text text-anchor="middle" x="1703" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_2&#45;&gt;expert_1_2_1 -->
<g id="edge108" class="edge">
<title>route_1_2&#45;&gt;expert_1_2_1</title>
<path fill="none" stroke="black" d="M1703,-10425.26C1703,-10416.99 1703,-10408.01 1703,-10399.7"/>
<polygon fill="black" stroke="black" points="1706.5,-10399.62 1703,-10389.62 1699.5,-10399.62 1706.5,-10399.62"/>
</g>
<!-- tp_1_2 -->
<g id="node91" class="node">
<title>tp_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="3425" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3425" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L1</text>
<text text-anchor="middle" x="3425" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 4↔5</text>
<text text-anchor="middle" x="3425" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3425" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_2_0&#45;&gt;tp_1_2 -->
<g id="edge109" class="edge">
<title>expert_1_2_0&#45;&gt;tp_1_2</title>
<path fill="none" stroke="black" d="M1546.6,-10346.44C1549.76,-10346.15 1552.9,-10345.87 1556,-10345.62 1942.37,-10314.33 2915.56,-10359.3 3300,-10309.62 3311.67,-10308.11 3323.84,-10305.95 3335.81,-10303.46"/>
<polygon fill="black" stroke="black" points="3336.76,-10306.83 3345.79,-10301.3 3335.28,-10299.99 3336.76,-10306.83"/>
</g>
<!-- expert_1_2_1&#45;&gt;tp_1_2 -->
<g id="edge110" class="edge">
<title>expert_1_2_1&#45;&gt;tp_1_2</title>
<path fill="none" stroke="black" d="M1841.6,-10346.46C1844.76,-10346.16 1847.9,-10345.88 1851,-10345.62 2492.99,-10292.28 2661.29,-10393.52 3300,-10309.62 3311.67,-10308.09 3323.84,-10305.91 3335.8,-10303.41"/>
<polygon fill="black" stroke="black" points="3336.75,-10306.79 3345.79,-10301.25 3335.27,-10299.95 3336.75,-10306.79"/>
</g>
<!-- tp_1_2&#45;&gt;q_proj_2 -->
<g id="edge1434" class="edge">
<title>tp_1_2&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M3493.72,-10253.43C3511.82,-10247.96 3531.47,-10242.77 3550,-10239.39 3694.64,-10213.08 4100.9,-10194.04 4327.76,-10185.1"/>
<polygon fill="black" stroke="black" points="4327.9,-10188.6 4337.76,-10184.71 4327.63,-10181.6 4327.9,-10188.6"/>
</g>
<!-- tp_1_2&#45;&gt;k_proj_2 -->
<g id="edge1435" class="edge">
<title>tp_1_2&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M3492.29,-10253.09C3510.75,-10247.47 3530.93,-10242.29 3550,-10239.39 3627.28,-10227.65 4879.87,-10244.06 4957,-10231.39 4989.97,-10225.98 5025.4,-10214.75 5054.24,-10204.1"/>
<polygon fill="black" stroke="black" points="5055.63,-10207.32 5063.76,-10200.52 5053.17,-10200.77 5055.63,-10207.32"/>
</g>
<!-- tp_1_2&#45;&gt;v_proj_2 -->
<g id="edge1436" class="edge">
<title>tp_1_2&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M3492.29,-10253.11C3510.75,-10247.49 3530.94,-10242.31 3550,-10239.39 3670.05,-10221.05 4523.17,-10251.17 4643,-10231.39 4675.96,-10225.95 4711.39,-10214.72 4740.24,-10204.08"/>
<polygon fill="black" stroke="black" points="4741.62,-10207.3 4749.75,-10200.5 4739.16,-10200.74 4741.62,-10207.3"/>
</g>
<!-- expert_1_3_0 -->
<g id="node93" class="node">
<title>expert_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2136.5,-10389.62 1859.5,-10389.62 1859.5,-10345.62 2136.5,-10345.62 2136.5,-10389.62"/>
<text text-anchor="middle" x="1998" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L1</text>
<text text-anchor="middle" x="1998" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 6</text>
<text text-anchor="middle" x="1998" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1998" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_3&#45;&gt;expert_1_3_0 -->
<g id="edge112" class="edge">
<title>route_1_3&#45;&gt;expert_1_3_0</title>
<path fill="none" stroke="black" d="M2202.08,-10428.88C2162.92,-10417.32 2117.49,-10403.9 2079.44,-10392.67"/>
<polygon fill="black" stroke="black" points="2080.01,-10389.19 2069.43,-10389.71 2078.03,-10395.9 2080.01,-10389.19"/>
</g>
<!-- expert_1_3_1 -->
<g id="node94" class="node">
<title>expert_1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2431.5,-10389.62 2154.5,-10389.62 2154.5,-10345.62 2431.5,-10345.62 2431.5,-10389.62"/>
<text text-anchor="middle" x="2293" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L1</text>
<text text-anchor="middle" x="2293" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 7</text>
<text text-anchor="middle" x="2293" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_3&#45;&gt;expert_1_3_1 -->
<g id="edge113" class="edge">
<title>route_1_3&#45;&gt;expert_1_3_1</title>
<path fill="none" stroke="black" d="M2293,-10425.26C2293,-10416.99 2293,-10408.01 2293,-10399.7"/>
<polygon fill="black" stroke="black" points="2296.5,-10399.62 2293,-10389.62 2289.5,-10399.62 2296.5,-10399.62"/>
</g>
<!-- tp_1_3 -->
<g id="node95" class="node">
<title>tp_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="3675" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3675" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L1</text>
<text text-anchor="middle" x="3675" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 6↔7</text>
<text text-anchor="middle" x="3675" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3675" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_3_0&#45;&gt;tp_1_3 -->
<g id="edge114" class="edge">
<title>expert_1_3_0&#45;&gt;tp_1_3</title>
<path fill="none" stroke="black" d="M2136.6,-10346.46C2139.76,-10346.16 2142.9,-10345.88 2146,-10345.62 2768.04,-10293.69 2931.14,-10391.17 3550,-10309.62 3561.67,-10308.08 3573.84,-10305.9 3585.8,-10303.4"/>
<polygon fill="black" stroke="black" points="3586.75,-10306.78 3595.79,-10301.24 3585.27,-10299.94 3586.75,-10306.78"/>
</g>
<!-- expert_1_3_1&#45;&gt;tp_1_3 -->
<g id="edge115" class="edge">
<title>expert_1_3_1&#45;&gt;tp_1_3</title>
<path fill="none" stroke="black" d="M2431.6,-10346.49C2434.76,-10346.18 2437.9,-10345.89 2441,-10345.62 2932.3,-10302.92 3061.3,-10375.71 3550,-10309.62 3561.58,-10308.05 3573.65,-10305.87 3585.52,-10303.38"/>
<polygon fill="black" stroke="black" points="3586.41,-10306.77 3595.44,-10301.23 3584.92,-10299.93 3586.41,-10306.77"/>
</g>
<!-- tp_1_3&#45;&gt;q_proj_2 -->
<g id="edge1437" class="edge">
<title>tp_1_3&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M3744.43,-10253.53C3762.35,-10248.12 3781.74,-10242.94 3800,-10239.39 3978.76,-10204.72 4187.65,-10190.07 4327.53,-10183.88"/>
<polygon fill="black" stroke="black" points="4328.06,-10187.36 4337.9,-10183.44 4327.76,-10180.37 4328.06,-10187.36"/>
</g>
<!-- tp_1_3&#45;&gt;k_proj_2 -->
<g id="edge1438" class="edge">
<title>tp_1_3&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M3742.29,-10253.1C3760.75,-10247.48 3780.94,-10242.3 3800,-10239.39 3927.09,-10220 4830.15,-10252.3 4957,-10231.39 4989.96,-10225.96 5025.39,-10214.73 5054.24,-10204.08"/>
<polygon fill="black" stroke="black" points="5055.63,-10207.3 5063.75,-10200.51 5053.16,-10200.75 5055.63,-10207.3"/>
</g>
<!-- tp_1_3&#45;&gt;v_proj_2 -->
<g id="edge1439" class="edge">
<title>tp_1_3&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M3742.3,-10253.14C3760.76,-10247.52 3780.94,-10242.33 3800,-10239.39 3892.58,-10225.14 4550.6,-10246.75 4643,-10231.39 4675.96,-10225.92 4711.38,-10214.68 4740.23,-10204.05"/>
<polygon fill="black" stroke="black" points="4741.62,-10207.26 4749.75,-10200.47 4739.16,-10200.71 4741.62,-10207.26"/>
</g>
<!-- expert_1_4_0 -->
<g id="node97" class="node">
<title>expert_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2726.5,-10389.62 2449.5,-10389.62 2449.5,-10345.62 2726.5,-10345.62 2726.5,-10389.62"/>
<text text-anchor="middle" x="2588" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L1</text>
<text text-anchor="middle" x="2588" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 8</text>
<text text-anchor="middle" x="2588" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2588" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_4&#45;&gt;expert_1_4_0 -->
<g id="edge117" class="edge">
<title>route_1_4&#45;&gt;expert_1_4_0</title>
<path fill="none" stroke="black" d="M2792.08,-10428.88C2752.92,-10417.32 2707.49,-10403.9 2669.44,-10392.67"/>
<polygon fill="black" stroke="black" points="2670.01,-10389.19 2659.43,-10389.71 2668.03,-10395.9 2670.01,-10389.19"/>
</g>
<!-- expert_1_4_1 -->
<g id="node98" class="node">
<title>expert_1_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3021.5,-10389.62 2744.5,-10389.62 2744.5,-10345.62 3021.5,-10345.62 3021.5,-10389.62"/>
<text text-anchor="middle" x="2883" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L1</text>
<text text-anchor="middle" x="2883" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 9</text>
<text text-anchor="middle" x="2883" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_4&#45;&gt;expert_1_4_1 -->
<g id="edge118" class="edge">
<title>route_1_4&#45;&gt;expert_1_4_1</title>
<path fill="none" stroke="black" d="M2883,-10425.26C2883,-10416.99 2883,-10408.01 2883,-10399.7"/>
<polygon fill="black" stroke="black" points="2886.5,-10399.62 2883,-10389.62 2879.5,-10399.62 2886.5,-10399.62"/>
</g>
<!-- tp_1_4 -->
<g id="node99" class="node">
<title>tp_1_4</title>
<ellipse fill="lightblue" stroke="black" cx="3925" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3925" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L1</text>
<text text-anchor="middle" x="3925" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 8↔9</text>
<text text-anchor="middle" x="3925" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3925" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_4_0&#45;&gt;tp_1_4 -->
<g id="edge119" class="edge">
<title>expert_1_4_0&#45;&gt;tp_1_4</title>
<path fill="none" stroke="black" d="M2726.6,-10346.49C2729.76,-10346.18 2732.9,-10345.89 2736,-10345.62 3207.35,-10304.32 3331.15,-10373.35 3800,-10309.62 3811.58,-10308.05 3823.65,-10305.86 3835.52,-10303.37"/>
<polygon fill="black" stroke="black" points="3836.41,-10306.76 3845.44,-10301.22 3834.92,-10299.92 3836.41,-10306.76"/>
</g>
<!-- expert_1_4_1&#45;&gt;tp_1_4 -->
<g id="edge120" class="edge">
<title>expert_1_4_1&#45;&gt;tp_1_4</title>
<path fill="none" stroke="black" d="M3021.6,-10346.55C3024.76,-10346.22 3027.9,-10345.91 3031,-10345.62 3371.65,-10313.55 3461.27,-10357.9 3800,-10309.62 3811.48,-10307.98 3823.45,-10305.77 3835.24,-10303.28"/>
<polygon fill="black" stroke="black" points="3836.06,-10306.69 3845.08,-10301.14 3834.56,-10299.85 3836.06,-10306.69"/>
</g>
<!-- tp_1_4&#45;&gt;q_proj_2 -->
<g id="edge1440" class="edge">
<title>tp_1_4&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M3995.87,-10253.76C4013.42,-10248.47 4032.27,-10243.29 4050,-10239.39 4141.16,-10219.36 4244.6,-10204.78 4327.84,-10195.02"/>
<polygon fill="black" stroke="black" points="4328.36,-10198.48 4337.89,-10193.85 4327.56,-10191.53 4328.36,-10198.48"/>
</g>
<!-- tp_1_4&#45;&gt;k_proj_2 -->
<g id="edge1441" class="edge">
<title>tp_1_4&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M3992.3,-10253.13C4010.75,-10247.51 4030.94,-10242.32 4050,-10239.39 4149.61,-10224.1 4857.58,-10247.88 4957,-10231.39 4989.96,-10225.93 5025.39,-10214.69 5054.23,-10204.06"/>
<polygon fill="black" stroke="black" points="5055.62,-10207.27 5063.75,-10200.48 5053.16,-10200.72 5055.62,-10207.27"/>
</g>
<!-- tp_1_4&#45;&gt;v_proj_2 -->
<g id="edge1442" class="edge">
<title>tp_1_4&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M3992.63,-10253.09C4011,-10247.51 4031.06,-10242.35 4050,-10239.39 4180.22,-10219.09 4513.04,-10253.26 4643,-10231.39 4675.94,-10225.85 4711.37,-10214.61 4740.22,-10203.99"/>
<polygon fill="black" stroke="black" points="4741.61,-10207.21 4749.74,-10200.42 4739.15,-10200.65 4741.61,-10207.21"/>
</g>
<!-- expert_1_5_0 -->
<g id="node101" class="node">
<title>expert_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-10389.62 3039.5,-10389.62 3039.5,-10345.62 3316.5,-10345.62 3316.5,-10389.62"/>
<text text-anchor="middle" x="3178" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L1</text>
<text text-anchor="middle" x="3178" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 10</text>
<text text-anchor="middle" x="3178" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3178" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_5&#45;&gt;expert_1_5_0 -->
<g id="edge122" class="edge">
<title>route_1_5&#45;&gt;expert_1_5_0</title>
<path fill="none" stroke="black" d="M3382.08,-10428.88C3342.92,-10417.32 3297.49,-10403.9 3259.44,-10392.67"/>
<polygon fill="black" stroke="black" points="3260.01,-10389.19 3249.43,-10389.71 3258.03,-10395.9 3260.01,-10389.19"/>
</g>
<!-- expert_1_5_1 -->
<g id="node102" class="node">
<title>expert_1_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3611.5,-10389.62 3334.5,-10389.62 3334.5,-10345.62 3611.5,-10345.62 3611.5,-10389.62"/>
<text text-anchor="middle" x="3473" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L1</text>
<text text-anchor="middle" x="3473" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 11</text>
<text text-anchor="middle" x="3473" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_5&#45;&gt;expert_1_5_1 -->
<g id="edge123" class="edge">
<title>route_1_5&#45;&gt;expert_1_5_1</title>
<path fill="none" stroke="black" d="M3473,-10425.26C3473,-10416.99 3473,-10408.01 3473,-10399.7"/>
<polygon fill="black" stroke="black" points="3476.5,-10399.62 3473,-10389.62 3469.5,-10399.62 3476.5,-10399.62"/>
</g>
<!-- tp_1_5 -->
<g id="node103" class="node">
<title>tp_1_5</title>
<ellipse fill="lightblue" stroke="black" cx="4175" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4175" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L1</text>
<text text-anchor="middle" x="4175" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 10↔11</text>
<text text-anchor="middle" x="4175" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4175" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_5_0&#45;&gt;tp_1_5 -->
<g id="edge124" class="edge">
<title>expert_1_5_0&#45;&gt;tp_1_5</title>
<path fill="none" stroke="black" d="M3316.61,-10346.56C3319.77,-10346.23 3322.9,-10345.92 3326,-10345.62 3646.71,-10314.96 3731.11,-10355.55 4050,-10309.62 4061.48,-10307.97 4073.45,-10305.74 4085.23,-10303.25"/>
<polygon fill="black" stroke="black" points="4086.05,-10306.66 4095.07,-10301.1 4084.56,-10299.82 4086.05,-10306.66"/>
</g>
<!-- expert_1_5_1&#45;&gt;tp_1_5 -->
<g id="edge125" class="edge">
<title>expert_1_5_1&#45;&gt;tp_1_5</title>
<path fill="none" stroke="black" d="M3611.62,-10346.71C3614.78,-10346.33 3617.91,-10345.97 3621,-10345.62 3811.13,-10324.17 3861.11,-10340.11 4050,-10309.62 4061.08,-10307.83 4072.63,-10305.58 4084.03,-10303.13"/>
<polygon fill="black" stroke="black" points="4085,-10306.5 4094,-10300.92 4083.48,-10299.66 4085,-10306.5"/>
</g>
<!-- tp_1_5&#45;&gt;q_proj_2 -->
<g id="edge1443" class="edge">
<title>tp_1_5&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M4248.31,-10254.38C4296.88,-10239.06 4360.46,-10219 4409.65,-10203.48"/>
<polygon fill="black" stroke="black" points="4410.8,-10206.79 4419.28,-10200.44 4408.69,-10200.11 4410.8,-10206.79"/>
</g>
<!-- tp_1_5&#45;&gt;k_proj_2 -->
<g id="edge1444" class="edge">
<title>tp_1_5&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M4242.63,-10253.07C4261,-10247.49 4281.06,-10242.34 4300,-10239.39 4372.14,-10228.19 4885,-10243.46 4957,-10231.39 4989.95,-10225.87 5025.38,-10214.63 5054.23,-10204.01"/>
<polygon fill="black" stroke="black" points="5055.61,-10207.23 5063.74,-10200.44 5053.15,-10200.67 5055.61,-10207.23"/>
</g>
<!-- tp_1_5&#45;&gt;v_proj_2 -->
<g id="edge1445" class="edge">
<title>tp_1_5&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M4242.65,-10253.21C4261.02,-10247.63 4281.07,-10242.44 4300,-10239.39 4375.27,-10227.28 4567.88,-10244.41 4643,-10231.39 4675.79,-10225.71 4711.07,-10214.52 4739.86,-10203.97"/>
<polygon fill="black" stroke="black" points="4741.22,-10207.19 4749.37,-10200.42 4738.77,-10200.64 4741.22,-10207.19"/>
</g>
<!-- expert_1_6_0 -->
<g id="node105" class="node">
<title>expert_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3906.5,-10389.62 3629.5,-10389.62 3629.5,-10345.62 3906.5,-10345.62 3906.5,-10389.62"/>
<text text-anchor="middle" x="3768" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L1</text>
<text text-anchor="middle" x="3768" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 12</text>
<text text-anchor="middle" x="3768" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3768" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_6&#45;&gt;expert_1_6_0 -->
<g id="edge127" class="edge">
<title>route_1_6&#45;&gt;expert_1_6_0</title>
<path fill="none" stroke="black" d="M3972.08,-10428.88C3932.92,-10417.32 3887.49,-10403.9 3849.44,-10392.67"/>
<polygon fill="black" stroke="black" points="3850.01,-10389.19 3839.43,-10389.71 3848.03,-10395.9 3850.01,-10389.19"/>
</g>
<!-- expert_1_6_1 -->
<g id="node106" class="node">
<title>expert_1_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4201.5,-10389.62 3924.5,-10389.62 3924.5,-10345.62 4201.5,-10345.62 4201.5,-10389.62"/>
<text text-anchor="middle" x="4063" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L1</text>
<text text-anchor="middle" x="4063" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 13</text>
<text text-anchor="middle" x="4063" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_6&#45;&gt;expert_1_6_1 -->
<g id="edge128" class="edge">
<title>route_1_6&#45;&gt;expert_1_6_1</title>
<path fill="none" stroke="black" d="M4063,-10425.26C4063,-10416.99 4063,-10408.01 4063,-10399.7"/>
<polygon fill="black" stroke="black" points="4066.5,-10399.62 4063,-10389.62 4059.5,-10399.62 4066.5,-10399.62"/>
</g>
<!-- tp_1_6 -->
<g id="node107" class="node">
<title>tp_1_6</title>
<ellipse fill="lightblue" stroke="black" cx="4425" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4425" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L1</text>
<text text-anchor="middle" x="4425" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 12↔13</text>
<text text-anchor="middle" x="4425" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4425" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_6_0&#45;&gt;tp_1_6 -->
<g id="edge129" class="edge">
<title>expert_1_6_0&#45;&gt;tp_1_6</title>
<path fill="none" stroke="black" d="M3906.63,-10346.75C3909.78,-10346.36 3912.91,-10345.98 3916,-10345.62 4086.24,-10325.57 4130.91,-10337.76 4300,-10309.62 4311.07,-10307.78 4322.61,-10305.5 4334.02,-10303.02"/>
<polygon fill="black" stroke="black" points="4334.98,-10306.39 4343.98,-10300.8 4333.46,-10299.56 4334.98,-10306.39"/>
</g>
<!-- expert_1_6_1&#45;&gt;tp_1_6 -->
<g id="edge130" class="edge">
<title>expert_1_6_1&#45;&gt;tp_1_6</title>
<path fill="none" stroke="black" d="M4150.51,-10345.58C4195.24,-10334.83 4250.52,-10321.53 4300,-10309.62 4309.87,-10307.24 4320.17,-10304.76 4330.45,-10302.29"/>
<polygon fill="black" stroke="black" points="4331.38,-10305.67 4340.28,-10299.92 4329.74,-10298.86 4331.38,-10305.67"/>
</g>
<!-- tp_1_6&#45;&gt;q_proj_2 -->
<g id="edge1446" class="edge">
<title>tp_1_6&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M4443.63,-10247.54C4451.17,-10235.41 4459.86,-10221.44 4467.39,-10209.32"/>
<polygon fill="black" stroke="black" points="4470.59,-10210.82 4472.89,-10200.48 4464.64,-10207.12 4470.59,-10210.82"/>
</g>
<!-- tp_1_6&#45;&gt;k_proj_2 -->
<g id="edge1447" class="edge">
<title>tp_1_6&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M4492.64,-10253.17C4511.01,-10247.58 4531.07,-10242.41 4550,-10239.39 4639.34,-10225.18 4867.84,-10246.68 4957,-10231.39 4989.8,-10225.77 5025.08,-10214.58 5053.87,-10204.02"/>
<polygon fill="black" stroke="black" points="5055.23,-10207.25 5063.37,-10200.47 5052.78,-10200.69 5055.23,-10207.25"/>
</g>
<!-- tp_1_6&#45;&gt;v_proj_2 -->
<g id="edge1448" class="edge">
<title>tp_1_6&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M4494.43,-10253.51C4512.34,-10248.1 4531.73,-10242.92 4550,-10239.39 4590.73,-10231.52 4602.36,-10239.75 4643,-10231.39 4674.57,-10224.9 4708.65,-10214.1 4736.96,-10204.02"/>
<polygon fill="black" stroke="black" points="4738.5,-10207.19 4746.72,-10200.5 4736.12,-10200.6 4738.5,-10207.19"/>
</g>
<!-- expert_1_7_0 -->
<g id="node109" class="node">
<title>expert_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4496.5,-10389.62 4219.5,-10389.62 4219.5,-10345.62 4496.5,-10345.62 4496.5,-10389.62"/>
<text text-anchor="middle" x="4358" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L1</text>
<text text-anchor="middle" x="4358" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 14</text>
<text text-anchor="middle" x="4358" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4358" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_7&#45;&gt;expert_1_7_0 -->
<g id="edge132" class="edge">
<title>route_1_7&#45;&gt;expert_1_7_0</title>
<path fill="none" stroke="black" d="M4515.64,-10427.81C4486.11,-10416.72 4452.42,-10404.07 4423.8,-10393.33"/>
<polygon fill="black" stroke="black" points="4424.89,-10390 4414.29,-10389.76 4422.43,-10396.55 4424.89,-10390"/>
</g>
<!-- expert_1_7_1 -->
<g id="node110" class="node">
<title>expert_1_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4791.5,-10389.62 4514.5,-10389.62 4514.5,-10345.62 4791.5,-10345.62 4791.5,-10389.62"/>
<text text-anchor="middle" x="4653" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L1</text>
<text text-anchor="middle" x="4653" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 15</text>
<text text-anchor="middle" x="4653" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4653" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_7&#45;&gt;expert_1_7_1 -->
<g id="edge133" class="edge">
<title>route_1_7&#45;&gt;expert_1_7_1</title>
<path fill="none" stroke="black" d="M4611.68,-10425.75C4618.15,-10416.8 4625.24,-10407 4631.69,-10398.08"/>
<polygon fill="black" stroke="black" points="4634.61,-10400.01 4637.64,-10389.86 4628.94,-10395.91 4634.61,-10400.01"/>
</g>
<!-- tp_1_7 -->
<g id="node111" class="node">
<title>tp_1_7</title>
<ellipse fill="lightblue" stroke="black" cx="4675" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4675" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L1</text>
<text text-anchor="middle" x="4675" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 14↔15</text>
<text text-anchor="middle" x="4675" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4675" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_7_0&#45;&gt;tp_1_7 -->
<g id="edge134" class="edge">
<title>expert_1_7_0&#45;&gt;tp_1_7</title>
<path fill="none" stroke="black" d="M4434.74,-10345.53C4480.34,-10333 4538.37,-10317.05 4585.98,-10303.97"/>
<polygon fill="black" stroke="black" points="4586.94,-10307.33 4595.66,-10301.31 4585.09,-10300.59 4586.94,-10307.33"/>
</g>
<!-- expert_1_7_1&#45;&gt;tp_1_7 -->
<g id="edge135" class="edge">
<title>expert_1_7_1&#45;&gt;tp_1_7</title>
<path fill="none" stroke="black" d="M4658.33,-10345.53C4660.3,-10337.7 4662.62,-10328.54 4664.88,-10319.58"/>
<polygon fill="black" stroke="black" points="4668.34,-10320.17 4667.4,-10309.62 4661.55,-10318.46 4668.34,-10320.17"/>
</g>
<!-- tp_1_7&#45;&gt;q_proj_2 -->
<g id="edge1449" class="edge">
<title>tp_1_7&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M4623.1,-10250.57C4595.81,-10236.4 4562.52,-10219.12 4535.58,-10205.13"/>
<polygon fill="black" stroke="black" points="4537.19,-10202.02 4526.7,-10200.52 4533.96,-10208.24 4537.19,-10202.02"/>
</g>
<!-- tp_1_7&#45;&gt;k_proj_2 -->
<g id="edge1450" class="edge">
<title>tp_1_7&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M4743.36,-10253.37C4761.55,-10247.85 4781.34,-10242.66 4800,-10239.39 4868.82,-10227.34 4888.33,-10244.27 4957,-10231.39 4989.33,-10225.33 5024.16,-10214.28 5052.78,-10203.92"/>
<polygon fill="black" stroke="black" points="5054.06,-10207.18 5062.24,-10200.45 5051.64,-10200.61 5054.06,-10207.18"/>
</g>
<!-- tp_1_7&#45;&gt;v_proj_2 -->
<g id="edge1451" class="edge">
<title>tp_1_7&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M4711.49,-10248.87C4728.46,-10235.55 4748.54,-10219.78 4765.28,-10206.64"/>
<polygon fill="black" stroke="black" points="4767.5,-10209.35 4773.2,-10200.43 4763.18,-10203.85 4767.5,-10209.35"/>
</g>
<!-- expert_1_8_0 -->
<g id="node113" class="node">
<title>expert_1_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-10389.62 4809.5,-10389.62 4809.5,-10345.62 5086.5,-10345.62 5086.5,-10389.62"/>
<text text-anchor="middle" x="4948" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L1</text>
<text text-anchor="middle" x="4948" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="4948" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4948" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_8&#45;&gt;expert_1_8_0 -->
<g id="edge137" class="edge">
<title>route_1_8&#45;&gt;expert_1_8_0</title>
<path fill="none" stroke="black" d="M4988.66,-10425.75C4982.29,-10416.8 4975.32,-10407 4968.97,-10398.08"/>
<polygon fill="black" stroke="black" points="4971.77,-10395.98 4963.12,-10389.86 4966.06,-10400.04 4971.77,-10395.98"/>
</g>
<!-- expert_1_8_1 -->
<g id="node114" class="node">
<title>expert_1_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5381.5,-10389.62 5104.5,-10389.62 5104.5,-10345.62 5381.5,-10345.62 5381.5,-10389.62"/>
<text text-anchor="middle" x="5243" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L1</text>
<text text-anchor="middle" x="5243" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="5243" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5243" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_8&#45;&gt;expert_1_8_1 -->
<g id="edge138" class="edge">
<title>route_1_8&#45;&gt;expert_1_8_1</title>
<path fill="none" stroke="black" d="M5084.68,-10427.81C5114.34,-10416.72 5148.17,-10404.07 5176.92,-10393.33"/>
<polygon fill="black" stroke="black" points="5178.32,-10396.54 5186.46,-10389.76 5175.87,-10389.98 5178.32,-10396.54"/>
</g>
<!-- tp_1_8 -->
<g id="node115" class="node">
<title>tp_1_8</title>
<ellipse fill="lightblue" stroke="black" cx="4925" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4925" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L1</text>
<text text-anchor="middle" x="4925" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="4925" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4925" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_8_0&#45;&gt;tp_1_8 -->
<g id="edge139" class="edge">
<title>expert_1_8_0&#45;&gt;tp_1_8</title>
<path fill="none" stroke="black" d="M4942.43,-10345.53C4940.37,-10337.7 4937.95,-10328.54 4935.58,-10319.58"/>
<polygon fill="black" stroke="black" points="4938.89,-10318.39 4932.95,-10309.62 4932.12,-10320.18 4938.89,-10318.39"/>
</g>
<!-- expert_1_8_1&#45;&gt;tp_1_8 -->
<g id="edge140" class="edge">
<title>expert_1_8_1&#45;&gt;tp_1_8</title>
<path fill="none" stroke="black" d="M5166.02,-10345.53C5120.19,-10332.98 5061.84,-10316.99 5014.04,-10303.9"/>
<polygon fill="black" stroke="black" points="5014.88,-10300.5 5004.31,-10301.23 5013.03,-10307.25 5014.88,-10300.5"/>
</g>
<!-- tp_1_8&#45;&gt;q_proj_2 -->
<g id="edge1452" class="edge">
<title>tp_1_8&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M4856.64,-10253.37C4838.45,-10247.85 4818.66,-10242.66 4800,-10239.39 4731.18,-10227.34 4711.67,-10244.27 4643,-10231.39 4610.67,-10225.33 4575.84,-10214.28 4547.22,-10203.92"/>
<polygon fill="black" stroke="black" points="4548.36,-10200.61 4537.76,-10200.45 4545.94,-10207.18 4548.36,-10200.61"/>
</g>
<!-- tp_1_8&#45;&gt;k_proj_2 -->
<g id="edge1453" class="edge">
<title>tp_1_8&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M4976.9,-10250.57C5004.19,-10236.4 5037.48,-10219.12 5064.42,-10205.13"/>
<polygon fill="black" stroke="black" points="5066.04,-10208.24 5073.3,-10200.52 5062.81,-10202.02 5066.04,-10208.24"/>
</g>
<!-- tp_1_8&#45;&gt;v_proj_2 -->
<g id="edge1454" class="edge">
<title>tp_1_8&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M4888.51,-10248.87C4871.54,-10235.55 4851.46,-10219.78 4834.72,-10206.64"/>
<polygon fill="black" stroke="black" points="4836.82,-10203.85 4826.8,-10200.43 4832.5,-10209.35 4836.82,-10203.85"/>
</g>
<!-- expert_1_9_0 -->
<g id="node117" class="node">
<title>expert_1_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5676.5,-10389.62 5399.5,-10389.62 5399.5,-10345.62 5676.5,-10345.62 5676.5,-10389.62"/>
<text text-anchor="middle" x="5538" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L1</text>
<text text-anchor="middle" x="5538" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 34</text>
<text text-anchor="middle" x="5538" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_9&#45;&gt;expert_1_9_0 -->
<g id="edge142" class="edge">
<title>route_1_9&#45;&gt;expert_1_9_0</title>
<path fill="none" stroke="black" d="M5538,-10425.26C5538,-10416.99 5538,-10408.01 5538,-10399.7"/>
<polygon fill="black" stroke="black" points="5541.5,-10399.62 5538,-10389.62 5534.5,-10399.62 5541.5,-10399.62"/>
</g>
<!-- expert_1_9_1 -->
<g id="node118" class="node">
<title>expert_1_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5971.5,-10389.62 5694.5,-10389.62 5694.5,-10345.62 5971.5,-10345.62 5971.5,-10389.62"/>
<text text-anchor="middle" x="5833" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L1</text>
<text text-anchor="middle" x="5833" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 35</text>
<text text-anchor="middle" x="5833" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5833" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_9&#45;&gt;expert_1_9_1 -->
<g id="edge143" class="edge">
<title>route_1_9&#45;&gt;expert_1_9_1</title>
<path fill="none" stroke="black" d="M5628.92,-10428.88C5668.08,-10417.32 5713.51,-10403.9 5751.56,-10392.67"/>
<polygon fill="black" stroke="black" points="5752.97,-10395.9 5761.57,-10389.71 5750.99,-10389.19 5752.97,-10395.9"/>
</g>
<!-- tp_1_9 -->
<g id="node119" class="node">
<title>tp_1_9</title>
<ellipse fill="lightblue" stroke="black" cx="5175" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5175" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L1</text>
<text text-anchor="middle" x="5175" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 34↔35</text>
<text text-anchor="middle" x="5175" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5175" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_9_0&#45;&gt;tp_1_9 -->
<g id="edge144" class="edge">
<title>expert_1_9_0&#45;&gt;tp_1_9</title>
<path fill="none" stroke="black" d="M5450.11,-10345.6C5405.2,-10334.85 5349.68,-10321.55 5300,-10309.62 5290.05,-10307.23 5279.65,-10304.73 5269.29,-10302.24"/>
<polygon fill="black" stroke="black" points="5269.92,-10298.79 5259.38,-10299.85 5268.28,-10305.59 5269.92,-10298.79"/>
</g>
<!-- expert_1_9_1&#45;&gt;tp_1_9 -->
<g id="edge145" class="edge">
<title>expert_1_9_1&#45;&gt;tp_1_9</title>
<path fill="none" stroke="black" d="M5694.14,-10346.6C5691.4,-10346.26 5688.69,-10345.94 5686,-10345.62 5514.89,-10325.43 5469.97,-10337.87 5300,-10309.62 5288.93,-10307.78 5277.39,-10305.5 5265.98,-10303.03"/>
<polygon fill="black" stroke="black" points="5266.54,-10299.56 5256.01,-10300.81 5265.02,-10306.4 5266.54,-10299.56"/>
</g>
<!-- tp_1_9&#45;&gt;q_proj_2 -->
<g id="edge1455" class="edge">
<title>tp_1_9&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M5107.36,-10253.17C5088.99,-10247.58 5068.93,-10242.41 5050,-10239.39 4960.66,-10225.18 4732.16,-10246.68 4643,-10231.39 4610.2,-10225.77 4574.92,-10214.58 4546.13,-10204.02"/>
<polygon fill="black" stroke="black" points="4547.22,-10200.69 4536.63,-10200.47 4544.77,-10207.25 4547.22,-10200.69"/>
</g>
<!-- tp_1_9&#45;&gt;k_proj_2 -->
<g id="edge1456" class="edge">
<title>tp_1_9&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5156.37,-10247.54C5148.83,-10235.41 5140.14,-10221.44 5132.61,-10209.32"/>
<polygon fill="black" stroke="black" points="5135.36,-10207.12 5127.11,-10200.48 5129.41,-10210.82 5135.36,-10207.12"/>
</g>
<!-- tp_1_9&#45;&gt;v_proj_2 -->
<g id="edge1457" class="edge">
<title>tp_1_9&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5105.57,-10253.51C5087.66,-10248.1 5068.27,-10242.92 5050,-10239.39 5009.27,-10231.52 4997.64,-10239.75 4957,-10231.39 4925.43,-10224.9 4891.35,-10214.1 4863.04,-10204.02"/>
<polygon fill="black" stroke="black" points="4863.88,-10200.6 4853.28,-10200.5 4861.5,-10207.19 4863.88,-10200.6"/>
</g>
<!-- expert_1_10_0 -->
<g id="node121" class="node">
<title>expert_1_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6266.5,-10389.62 5989.5,-10389.62 5989.5,-10345.62 6266.5,-10345.62 6266.5,-10389.62"/>
<text text-anchor="middle" x="6128" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L1</text>
<text text-anchor="middle" x="6128" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 36</text>
<text text-anchor="middle" x="6128" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_10&#45;&gt;expert_1_10_0 -->
<g id="edge147" class="edge">
<title>route_1_10&#45;&gt;expert_1_10_0</title>
<path fill="none" stroke="black" d="M6128,-10425.26C6128,-10416.99 6128,-10408.01 6128,-10399.7"/>
<polygon fill="black" stroke="black" points="6131.5,-10399.62 6128,-10389.62 6124.5,-10399.62 6131.5,-10399.62"/>
</g>
<!-- expert_1_10_1 -->
<g id="node122" class="node">
<title>expert_1_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6561.5,-10389.62 6284.5,-10389.62 6284.5,-10345.62 6561.5,-10345.62 6561.5,-10389.62"/>
<text text-anchor="middle" x="6423" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L1</text>
<text text-anchor="middle" x="6423" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 37</text>
<text text-anchor="middle" x="6423" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6423" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_10&#45;&gt;expert_1_10_1 -->
<g id="edge148" class="edge">
<title>route_1_10&#45;&gt;expert_1_10_1</title>
<path fill="none" stroke="black" d="M6218.92,-10428.88C6258.08,-10417.32 6303.51,-10403.9 6341.56,-10392.67"/>
<polygon fill="black" stroke="black" points="6342.97,-10395.9 6351.57,-10389.71 6340.99,-10389.19 6342.97,-10395.9"/>
</g>
<!-- tp_1_10 -->
<g id="node123" class="node">
<title>tp_1_10</title>
<ellipse fill="lightblue" stroke="black" cx="5425" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5425" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L1</text>
<text text-anchor="middle" x="5425" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 36↔37</text>
<text text-anchor="middle" x="5425" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5425" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_10_0&#45;&gt;tp_1_10 -->
<g id="edge149" class="edge">
<title>expert_1_10_0&#45;&gt;tp_1_10</title>
<path fill="none" stroke="black" d="M5989.14,-10346.56C5986.41,-10346.24 5983.69,-10345.92 5981,-10345.62 5790,-10324.02 5739.77,-10340.22 5550,-10309.62 5538.92,-10307.83 5527.37,-10305.59 5515.97,-10303.13"/>
<polygon fill="black" stroke="black" points="5516.52,-10299.67 5506,-10300.92 5515,-10306.5 5516.52,-10299.67"/>
</g>
<!-- expert_1_10_1&#45;&gt;tp_1_10 -->
<g id="edge150" class="edge">
<title>expert_1_10_1&#45;&gt;tp_1_10</title>
<path fill="none" stroke="black" d="M6284.16,-10346.44C6281.42,-10346.15 6278.69,-10345.88 6276,-10345.62 5954.42,-10314.74 5869.77,-10355.65 5550,-10309.62 5538.52,-10307.97 5526.55,-10305.75 5514.77,-10303.25"/>
<polygon fill="black" stroke="black" points="5515.44,-10299.82 5504.93,-10301.1 5513.95,-10306.66 5515.44,-10299.82"/>
</g>
<!-- tp_1_10&#45;&gt;q_proj_2 -->
<g id="edge1458" class="edge">
<title>tp_1_10&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M5357.37,-10253.07C5339,-10247.49 5318.94,-10242.34 5300,-10239.39 5227.86,-10228.19 4715,-10243.46 4643,-10231.39 4610.05,-10225.87 4574.62,-10214.63 4545.77,-10204.01"/>
<polygon fill="black" stroke="black" points="4546.85,-10200.67 4536.26,-10200.44 4544.39,-10207.23 4546.85,-10200.67"/>
</g>
<!-- tp_1_10&#45;&gt;k_proj_2 -->
<g id="edge1459" class="edge">
<title>tp_1_10&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5351.69,-10254.38C5303.12,-10239.06 5239.54,-10219 5190.35,-10203.48"/>
<polygon fill="black" stroke="black" points="5191.31,-10200.11 5180.72,-10200.44 5189.2,-10206.79 5191.31,-10200.11"/>
</g>
<!-- tp_1_10&#45;&gt;v_proj_2 -->
<g id="edge1460" class="edge">
<title>tp_1_10&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5357.35,-10253.21C5338.98,-10247.63 5318.93,-10242.44 5300,-10239.39 5224.73,-10227.28 5032.12,-10244.41 4957,-10231.39 4924.21,-10225.71 4888.93,-10214.52 4860.14,-10203.97"/>
<polygon fill="black" stroke="black" points="4861.23,-10200.64 4850.63,-10200.42 4858.78,-10207.19 4861.23,-10200.64"/>
</g>
<!-- expert_1_11_0 -->
<g id="node125" class="node">
<title>expert_1_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6856.5,-10389.62 6579.5,-10389.62 6579.5,-10345.62 6856.5,-10345.62 6856.5,-10389.62"/>
<text text-anchor="middle" x="6718" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L1</text>
<text text-anchor="middle" x="6718" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 38</text>
<text text-anchor="middle" x="6718" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_11&#45;&gt;expert_1_11_0 -->
<g id="edge152" class="edge">
<title>route_1_11&#45;&gt;expert_1_11_0</title>
<path fill="none" stroke="black" d="M6718,-10425.26C6718,-10416.99 6718,-10408.01 6718,-10399.7"/>
<polygon fill="black" stroke="black" points="6721.5,-10399.62 6718,-10389.62 6714.5,-10399.62 6721.5,-10399.62"/>
</g>
<!-- expert_1_11_1 -->
<g id="node126" class="node">
<title>expert_1_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7151.5,-10389.62 6874.5,-10389.62 6874.5,-10345.62 7151.5,-10345.62 7151.5,-10389.62"/>
<text text-anchor="middle" x="7013" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L1</text>
<text text-anchor="middle" x="7013" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 39</text>
<text text-anchor="middle" x="7013" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7013" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_11&#45;&gt;expert_1_11_1 -->
<g id="edge153" class="edge">
<title>route_1_11&#45;&gt;expert_1_11_1</title>
<path fill="none" stroke="black" d="M6808.92,-10428.88C6848.08,-10417.32 6893.51,-10403.9 6931.56,-10392.67"/>
<polygon fill="black" stroke="black" points="6932.97,-10395.9 6941.57,-10389.71 6930.99,-10389.19 6932.97,-10395.9"/>
</g>
<!-- tp_1_11 -->
<g id="node127" class="node">
<title>tp_1_11</title>
<ellipse fill="lightblue" stroke="black" cx="5675" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5675" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L1</text>
<text text-anchor="middle" x="5675" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 38↔39</text>
<text text-anchor="middle" x="5675" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5675" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_11_0&#45;&gt;tp_1_11 -->
<g id="edge154" class="edge">
<title>expert_1_11_0&#45;&gt;tp_1_11</title>
<path fill="none" stroke="black" d="M6579.16,-10346.43C6576.42,-10346.14 6573.69,-10345.87 6571,-10345.62 6229.48,-10313.33 6139.61,-10358.01 5800,-10309.62 5788.52,-10307.98 5776.55,-10305.77 5764.76,-10303.28"/>
<polygon fill="black" stroke="black" points="5765.44,-10299.85 5754.92,-10301.14 5763.94,-10306.69 5765.44,-10299.85"/>
</g>
<!-- expert_1_11_1&#45;&gt;tp_1_11 -->
<g id="edge155" class="edge">
<title>expert_1_11_1&#45;&gt;tp_1_11</title>
<path fill="none" stroke="black" d="M6874.16,-10346.38C6871.42,-10346.11 6868.7,-10345.86 6866,-10345.62 6393.78,-10304.04 6269.73,-10373.46 5800,-10309.62 5788.42,-10308.05 5776.35,-10305.86 5764.48,-10303.37"/>
<polygon fill="black" stroke="black" points="5765.08,-10299.92 5754.56,-10301.22 5763.59,-10306.76 5765.08,-10299.92"/>
</g>
<!-- tp_1_11&#45;&gt;q_proj_2 -->
<g id="edge1461" class="edge">
<title>tp_1_11&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M5607.7,-10253.13C5589.25,-10247.51 5569.06,-10242.32 5550,-10239.39 5450.39,-10224.1 4742.42,-10247.88 4643,-10231.39 4610.04,-10225.93 4574.61,-10214.69 4545.77,-10204.06"/>
<polygon fill="black" stroke="black" points="4546.84,-10200.72 4536.25,-10200.48 4544.38,-10207.27 4546.84,-10200.72"/>
</g>
<!-- tp_1_11&#45;&gt;k_proj_2 -->
<g id="edge1462" class="edge">
<title>tp_1_11&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5604.13,-10253.76C5586.58,-10248.47 5567.73,-10243.29 5550,-10239.39 5458.84,-10219.36 5355.4,-10204.78 5272.16,-10195.02"/>
<polygon fill="black" stroke="black" points="5272.44,-10191.53 5262.11,-10193.85 5271.64,-10198.48 5272.44,-10191.53"/>
</g>
<!-- tp_1_11&#45;&gt;v_proj_2 -->
<g id="edge1463" class="edge">
<title>tp_1_11&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5607.37,-10253.09C5589,-10247.51 5568.94,-10242.35 5550,-10239.39 5419.78,-10219.09 5086.96,-10253.26 4957,-10231.39 4924.06,-10225.85 4888.63,-10214.61 4859.78,-10203.99"/>
<polygon fill="black" stroke="black" points="4860.85,-10200.65 4850.26,-10200.42 4858.39,-10207.21 4860.85,-10200.65"/>
</g>
<!-- expert_1_12_0 -->
<g id="node129" class="node">
<title>expert_1_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7446.5,-10389.62 7169.5,-10389.62 7169.5,-10345.62 7446.5,-10345.62 7446.5,-10389.62"/>
<text text-anchor="middle" x="7308" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L1</text>
<text text-anchor="middle" x="7308" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 40</text>
<text text-anchor="middle" x="7308" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_12&#45;&gt;expert_1_12_0 -->
<g id="edge157" class="edge">
<title>route_1_12&#45;&gt;expert_1_12_0</title>
<path fill="none" stroke="black" d="M7308,-10425.26C7308,-10416.99 7308,-10408.01 7308,-10399.7"/>
<polygon fill="black" stroke="black" points="7311.5,-10399.62 7308,-10389.62 7304.5,-10399.62 7311.5,-10399.62"/>
</g>
<!-- expert_1_12_1 -->
<g id="node130" class="node">
<title>expert_1_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7741.5,-10389.62 7464.5,-10389.62 7464.5,-10345.62 7741.5,-10345.62 7741.5,-10389.62"/>
<text text-anchor="middle" x="7603" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L1</text>
<text text-anchor="middle" x="7603" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 41</text>
<text text-anchor="middle" x="7603" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7603" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_12&#45;&gt;expert_1_12_1 -->
<g id="edge158" class="edge">
<title>route_1_12&#45;&gt;expert_1_12_1</title>
<path fill="none" stroke="black" d="M7398.92,-10428.88C7438.08,-10417.32 7483.51,-10403.9 7521.56,-10392.67"/>
<polygon fill="black" stroke="black" points="7522.97,-10395.9 7531.57,-10389.71 7520.99,-10389.19 7522.97,-10395.9"/>
</g>
<!-- tp_1_12 -->
<g id="node131" class="node">
<title>tp_1_12</title>
<ellipse fill="lightblue" stroke="black" cx="5925" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5925" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L1</text>
<text text-anchor="middle" x="5925" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 40↔41</text>
<text text-anchor="middle" x="5925" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5925" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_12_0&#45;&gt;tp_1_12 -->
<g id="edge159" class="edge">
<title>expert_1_12_0&#45;&gt;tp_1_12</title>
<path fill="none" stroke="black" d="M7169.16,-10346.37C7166.42,-10346.11 7163.7,-10345.86 7161,-10345.62 6668.84,-10302.62 6539.58,-10375.82 6050,-10309.62 6038.42,-10308.05 6026.35,-10305.87 6014.48,-10303.39"/>
<polygon fill="black" stroke="black" points="6015.08,-10299.93 6004.56,-10301.23 6013.59,-10306.78 6015.08,-10299.93"/>
</g>
<!-- expert_1_12_1&#45;&gt;tp_1_12 -->
<g id="edge160" class="edge">
<title>expert_1_12_1&#45;&gt;tp_1_12</title>
<path fill="none" stroke="black" d="M7464.16,-10346.35C7461.42,-10346.09 7458.7,-10345.85 7456,-10345.62 6833.1,-10293.33 6669.74,-10391.27 6050,-10309.62 6038.33,-10308.08 6026.16,-10305.9 6014.2,-10303.4"/>
<polygon fill="black" stroke="black" points="6014.73,-10299.94 6004.21,-10301.24 6013.25,-10306.78 6014.73,-10299.94"/>
</g>
<!-- tp_1_12&#45;&gt;q_proj_2 -->
<g id="edge1464" class="edge">
<title>tp_1_12&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M5857.71,-10253.1C5839.25,-10247.48 5819.06,-10242.3 5800,-10239.39 5672.91,-10220 4769.85,-10252.3 4643,-10231.39 4610.04,-10225.96 4574.61,-10214.73 4545.76,-10204.08"/>
<polygon fill="black" stroke="black" points="4546.84,-10200.75 4536.25,-10200.51 4544.37,-10207.3 4546.84,-10200.75"/>
</g>
<!-- tp_1_12&#45;&gt;k_proj_2 -->
<g id="edge1465" class="edge">
<title>tp_1_12&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M5855.57,-10253.53C5837.65,-10248.12 5818.26,-10242.94 5800,-10239.39 5621.24,-10204.72 5412.35,-10190.07 5272.47,-10183.88"/>
<polygon fill="black" stroke="black" points="5272.24,-10180.37 5262.1,-10183.44 5271.94,-10187.36 5272.24,-10180.37"/>
</g>
<!-- tp_1_12&#45;&gt;v_proj_2 -->
<g id="edge1466" class="edge">
<title>tp_1_12&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M5857.7,-10253.14C5839.24,-10247.52 5819.06,-10242.33 5800,-10239.39 5707.42,-10225.14 5049.4,-10246.75 4957,-10231.39 4924.04,-10225.92 4888.62,-10214.68 4859.77,-10204.05"/>
<polygon fill="black" stroke="black" points="4860.84,-10200.71 4850.25,-10200.47 4858.38,-10207.26 4860.84,-10200.71"/>
</g>
<!-- expert_1_13_0 -->
<g id="node133" class="node">
<title>expert_1_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8036.5,-10389.62 7759.5,-10389.62 7759.5,-10345.62 8036.5,-10345.62 8036.5,-10389.62"/>
<text text-anchor="middle" x="7898" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L1</text>
<text text-anchor="middle" x="7898" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 42</text>
<text text-anchor="middle" x="7898" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_13&#45;&gt;expert_1_13_0 -->
<g id="edge162" class="edge">
<title>route_1_13&#45;&gt;expert_1_13_0</title>
<path fill="none" stroke="black" d="M7898,-10425.26C7898,-10416.99 7898,-10408.01 7898,-10399.7"/>
<polygon fill="black" stroke="black" points="7901.5,-10399.62 7898,-10389.62 7894.5,-10399.62 7901.5,-10399.62"/>
</g>
<!-- expert_1_13_1 -->
<g id="node134" class="node">
<title>expert_1_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8331.5,-10389.62 8054.5,-10389.62 8054.5,-10345.62 8331.5,-10345.62 8331.5,-10389.62"/>
<text text-anchor="middle" x="8193" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L1</text>
<text text-anchor="middle" x="8193" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 43</text>
<text text-anchor="middle" x="8193" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8193" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_13&#45;&gt;expert_1_13_1 -->
<g id="edge163" class="edge">
<title>route_1_13&#45;&gt;expert_1_13_1</title>
<path fill="none" stroke="black" d="M7988.92,-10428.88C8028.08,-10417.32 8073.51,-10403.9 8111.56,-10392.67"/>
<polygon fill="black" stroke="black" points="8112.97,-10395.9 8121.57,-10389.71 8110.99,-10389.19 8112.97,-10395.9"/>
</g>
<!-- tp_1_13 -->
<g id="node135" class="node">
<title>tp_1_13</title>
<ellipse fill="lightblue" stroke="black" cx="6175" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6175" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L1</text>
<text text-anchor="middle" x="6175" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 42↔43</text>
<text text-anchor="middle" x="6175" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6175" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_13_0&#45;&gt;tp_1_13 -->
<g id="edge164" class="edge">
<title>expert_1_13_0&#45;&gt;tp_1_13</title>
<path fill="none" stroke="black" d="M7759.16,-10346.34C7756.42,-10346.09 7753.7,-10345.85 7751,-10345.62 7108.15,-10291.91 6939.59,-10393.63 6300,-10309.62 6288.33,-10308.09 6276.16,-10305.91 6264.2,-10303.41"/>
<polygon fill="black" stroke="black" points="6264.73,-10299.95 6254.21,-10301.25 6263.25,-10306.79 6264.73,-10299.95"/>
</g>
<!-- expert_1_13_1&#45;&gt;tp_1_13 -->
<g id="edge165" class="edge">
<title>expert_1_13_1&#45;&gt;tp_1_13</title>
<path fill="none" stroke="black" d="M8054.17,-10346.33C8051.42,-10346.08 8048.7,-10345.84 8046,-10345.62 7659.2,-10314.12 6684.88,-10359.35 6300,-10309.62 6288.33,-10308.11 6276.16,-10305.95 6264.19,-10303.46"/>
<polygon fill="black" stroke="black" points="6264.72,-10299.99 6254.21,-10301.3 6263.24,-10306.84 6264.72,-10299.99"/>
</g>
<!-- tp_1_13&#45;&gt;q_proj_2 -->
<g id="edge1467" class="edge">
<title>tp_1_13&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M6107.71,-10253.09C6089.25,-10247.47 6069.07,-10242.29 6050,-10239.39 5972.72,-10227.65 4720.13,-10244.06 4643,-10231.39 4610.03,-10225.98 4574.6,-10214.75 4545.76,-10204.1"/>
<polygon fill="black" stroke="black" points="4546.83,-10200.77 4536.24,-10200.52 4544.37,-10207.32 4546.83,-10200.77"/>
</g>
<!-- tp_1_13&#45;&gt;k_proj_2 -->
<g id="edge1468" class="edge">
<title>tp_1_13&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M6106.28,-10253.43C6088.18,-10247.96 6068.53,-10242.77 6050,-10239.39 5905.36,-10213.08 5499.1,-10194.04 5272.24,-10185.1"/>
<polygon fill="black" stroke="black" points="5272.37,-10181.6 5262.24,-10184.71 5272.1,-10188.6 5272.37,-10181.6"/>
</g>
<!-- tp_1_13&#45;&gt;v_proj_2 -->
<g id="edge1469" class="edge">
<title>tp_1_13&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M6107.71,-10253.11C6089.25,-10247.49 6069.06,-10242.31 6050,-10239.39 5929.95,-10221.05 5076.83,-10251.17 4957,-10231.39 4924.04,-10225.95 4888.61,-10214.72 4859.76,-10204.08"/>
<polygon fill="black" stroke="black" points="4860.84,-10200.74 4850.25,-10200.5 4858.38,-10207.3 4860.84,-10200.74"/>
</g>
<!-- expert_1_14_0 -->
<g id="node137" class="node">
<title>expert_1_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8626.5,-10389.62 8349.5,-10389.62 8349.5,-10345.62 8626.5,-10345.62 8626.5,-10389.62"/>
<text text-anchor="middle" x="8488" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L1</text>
<text text-anchor="middle" x="8488" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 44</text>
<text text-anchor="middle" x="8488" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_14&#45;&gt;expert_1_14_0 -->
<g id="edge167" class="edge">
<title>route_1_14&#45;&gt;expert_1_14_0</title>
<path fill="none" stroke="black" d="M8488,-10425.26C8488,-10416.99 8488,-10408.01 8488,-10399.7"/>
<polygon fill="black" stroke="black" points="8491.5,-10399.62 8488,-10389.62 8484.5,-10399.62 8491.5,-10399.62"/>
</g>
<!-- expert_1_14_1 -->
<g id="node138" class="node">
<title>expert_1_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8921.5,-10389.62 8644.5,-10389.62 8644.5,-10345.62 8921.5,-10345.62 8921.5,-10389.62"/>
<text text-anchor="middle" x="8783" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L1</text>
<text text-anchor="middle" x="8783" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 45</text>
<text text-anchor="middle" x="8783" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8783" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_14&#45;&gt;expert_1_14_1 -->
<g id="edge168" class="edge">
<title>route_1_14&#45;&gt;expert_1_14_1</title>
<path fill="none" stroke="black" d="M8578.92,-10428.88C8618.08,-10417.32 8663.51,-10403.9 8701.56,-10392.67"/>
<polygon fill="black" stroke="black" points="8702.97,-10395.9 8711.57,-10389.71 8700.99,-10389.19 8702.97,-10395.9"/>
</g>
<!-- tp_1_14 -->
<g id="node139" class="node">
<title>tp_1_14</title>
<ellipse fill="lightblue" stroke="black" cx="6425" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6425" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L1</text>
<text text-anchor="middle" x="6425" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 44↔45</text>
<text text-anchor="middle" x="6425" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6425" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_14_0&#45;&gt;tp_1_14 -->
<g id="edge169" class="edge">
<title>expert_1_14_0&#45;&gt;tp_1_14</title>
<path fill="none" stroke="black" d="M8349.17,-10346.33C8346.42,-10346.08 8343.7,-10345.84 8341,-10345.62 7944.22,-10313.41 6944.81,-10360.53 6550,-10309.62 6538.33,-10308.11 6526.16,-10305.95 6514.19,-10303.47"/>
<polygon fill="black" stroke="black" points="6514.72,-10300 6504.21,-10301.31 6513.24,-10306.84 6514.72,-10300"/>
</g>
<!-- expert_1_14_1&#45;&gt;tp_1_14 -->
<g id="edge170" class="edge">
<title>expert_1_14_1&#45;&gt;tp_1_14</title>
<path fill="none" stroke="black" d="M8644.17,-10346.32C8641.42,-10346.07 8638.7,-10345.83 8636,-10345.62 8173.84,-10308.77 7009.9,-10368.26 6550,-10309.62 6538.32,-10308.13 6526.15,-10305.98 6514.19,-10303.5"/>
<polygon fill="black" stroke="black" points="6514.71,-10300.03 6504.2,-10301.34 6513.24,-10306.87 6514.71,-10300.03"/>
</g>
<!-- tp_1_14&#45;&gt;q_proj_2 -->
<g id="edge1470" class="edge">
<title>tp_1_14&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M6357.71,-10253.08C6339.25,-10247.46 6319.07,-10242.28 6300,-10239.39 6208.98,-10225.6 4733.85,-10246.27 4643,-10231.39 4609.9,-10225.97 4574.33,-10214.68 4545.42,-10203.99"/>
<polygon fill="black" stroke="black" points="4546.48,-10200.65 4535.89,-10200.4 4544.01,-10207.2 4546.48,-10200.65"/>
</g>
<!-- tp_1_14&#45;&gt;k_proj_2 -->
<g id="edge1471" class="edge">
<title>tp_1_14&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M6356.64,-10253.36C6338.45,-10247.85 6318.66,-10242.66 6300,-10239.39 6107.3,-10205.67 5548.52,-10188.97 5272.33,-10182.59"/>
<polygon fill="black" stroke="black" points="5272.3,-10179.09 5262.23,-10182.36 5272.14,-10186.09 5272.3,-10179.09"/>
</g>
<!-- tp_1_14&#45;&gt;v_proj_2 -->
<g id="edge1472" class="edge">
<title>tp_1_14&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M6357.71,-10253.09C6339.25,-10247.47 6319.07,-10242.29 6300,-10239.39 6226.24,-10228.17 5030.62,-10243.49 4957,-10231.39 4924.04,-10225.98 4888.61,-10214.74 4859.76,-10204.1"/>
<polygon fill="black" stroke="black" points="4860.84,-10200.76 4850.24,-10200.52 4858.37,-10207.32 4860.84,-10200.76"/>
</g>
<!-- expert_1_15_0 -->
<g id="node141" class="node">
<title>expert_1_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9216.5,-10389.62 8939.5,-10389.62 8939.5,-10345.62 9216.5,-10345.62 9216.5,-10389.62"/>
<text text-anchor="middle" x="9078" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L1</text>
<text text-anchor="middle" x="9078" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 46</text>
<text text-anchor="middle" x="9078" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_15&#45;&gt;expert_1_15_0 -->
<g id="edge172" class="edge">
<title>route_1_15&#45;&gt;expert_1_15_0</title>
<path fill="none" stroke="black" d="M9078,-10425.26C9078,-10416.99 9078,-10408.01 9078,-10399.7"/>
<polygon fill="black" stroke="black" points="9081.5,-10399.62 9078,-10389.62 9074.5,-10399.62 9081.5,-10399.62"/>
</g>
<!-- expert_1_15_1 -->
<g id="node142" class="node">
<title>expert_1_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9511.5,-10389.62 9234.5,-10389.62 9234.5,-10345.62 9511.5,-10345.62 9511.5,-10389.62"/>
<text text-anchor="middle" x="9373" y="-10380.42" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L1</text>
<text text-anchor="middle" x="9373" y="-10370.42" font-family="Times,serif" font-size="9.00">GPU: 47</text>
<text text-anchor="middle" x="9373" y="-10360.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9373" y="-10350.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_15&#45;&gt;expert_1_15_1 -->
<g id="edge173" class="edge">
<title>route_1_15&#45;&gt;expert_1_15_1</title>
<path fill="none" stroke="black" d="M9168.92,-10428.88C9208.08,-10417.32 9253.51,-10403.9 9291.56,-10392.67"/>
<polygon fill="black" stroke="black" points="9292.97,-10395.9 9301.57,-10389.71 9290.99,-10389.19 9292.97,-10395.9"/>
</g>
<!-- tp_1_15 -->
<g id="node143" class="node">
<title>tp_1_15</title>
<ellipse fill="lightblue" stroke="black" cx="6675" cy="-10278.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6675" y="-10291.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L1</text>
<text text-anchor="middle" x="6675" y="-10281.31" font-family="Times,serif" font-size="9.00">GPU: 46↔47</text>
<text text-anchor="middle" x="6675" y="-10271.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6675" y="-10261.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_15_0&#45;&gt;tp_1_15 -->
<g id="edge174" class="edge">
<title>expert_1_15_0&#45;&gt;tp_1_15</title>
<path fill="none" stroke="black" d="M8939.16,-10346.36C8936.42,-10346.1 8933.7,-10345.85 8931,-10345.62 8512.38,-10309.7 7211.95,-10287.57 6800.89,-10281.33"/>
<polygon fill="black" stroke="black" points="6800.8,-10277.83 6790.75,-10281.17 6800.7,-10284.83 6800.8,-10277.83"/>
</g>
<!-- expert_1_15_1&#45;&gt;tp_1_15 -->
<g id="edge175" class="edge">
<title>expert_1_15_1&#45;&gt;tp_1_15</title>
<path fill="none" stroke="black" d="M9234.16,-10346.35C9231.42,-10346.09 9228.7,-10345.85 9226,-10345.62 8746.93,-10305.33 7246.66,-10285.84 6801.03,-10280.84"/>
<polygon fill="black" stroke="black" points="6801.05,-10277.34 6791.02,-10280.72 6800.98,-10284.34 6801.05,-10277.34"/>
</g>
<!-- tp_1_15&#45;&gt;q_proj_2 -->
<g id="edge1473" class="edge">
<title>tp_1_15&#45;&gt;q_proj_2</title>
<path fill="none" stroke="black" d="M6607.71,-10253.07C6589.25,-10247.45 6569.07,-10242.28 6550,-10239.39 6445.25,-10223.55 4747.56,-10248.48 4643,-10231.39 4609.9,-10225.98 4574.33,-10214.69 4545.42,-10204"/>
<polygon fill="black" stroke="black" points="4546.48,-10200.66 4535.89,-10200.41 4544.01,-10207.21 4546.48,-10200.66"/>
</g>
<!-- tp_1_15&#45;&gt;k_proj_2 -->
<g id="edge1474" class="edge">
<title>tp_1_15&#45;&gt;k_proj_2</title>
<path fill="none" stroke="black" d="M6606.66,-10253.25C6588.47,-10247.74 6568.67,-10242.58 6550,-10239.39 6308.57,-10198.24 5593.02,-10184.92 5272.44,-10180.95"/>
<polygon fill="black" stroke="black" points="5272.18,-10177.44 5262.14,-10180.82 5272.1,-10184.44 5272.18,-10177.44"/>
</g>
<!-- tp_1_15&#45;&gt;v_proj_2 -->
<g id="edge1475" class="edge">
<title>tp_1_15&#45;&gt;v_proj_2</title>
<path fill="none" stroke="black" d="M6607.71,-10253.08C6589.25,-10247.46 6569.07,-10242.29 6550,-10239.39 6462.5,-10226.13 5044.34,-10245.71 4957,-10231.39 4923.91,-10225.97 4888.33,-10214.67 4859.42,-10203.99"/>
<polygon fill="black" stroke="black" points="4860.48,-10200.65 4849.89,-10200.4 4858.01,-10207.2 4860.48,-10200.65"/>
</g>
<!-- attn_scores_2 -->
<g id="node147" class="node">
<title>attn_scores_2</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-10120.39 4633.5,-10120.39 4633.5,-10076.39 4966.5,-10076.39 4966.5,-10120.39"/>
<text text-anchor="middle" x="4800" y="-10111.19" font-family="Times,serif" font-size="9.00">Attention Scores L2</text>
<text text-anchor="middle" x="4800" y="-10101.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4800" y="-10091.19" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-10081.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_2&#45;&gt;attn_scores_2 -->
<g id="edge176" class="edge">
<title>q_proj_2&#45;&gt;attn_scores_2</title>
<path fill="none" stroke="black" d="M4570.56,-10156.39C4612.18,-10146.05 4662.51,-10133.55 4705.41,-10122.89"/>
<polygon fill="black" stroke="black" points="4706.43,-10126.24 4715.29,-10120.44 4704.74,-10119.45 4706.43,-10126.24"/>
</g>
<!-- k_proj_2&#45;&gt;attn_scores_2 -->
<g id="edge177" class="edge">
<title>k_proj_2&#45;&gt;attn_scores_2</title>
<path fill="none" stroke="black" d="M5029.44,-10156.39C4987.82,-10146.05 4937.49,-10133.55 4894.59,-10122.89"/>
<polygon fill="black" stroke="black" points="4895.26,-10119.45 4884.71,-10120.44 4893.57,-10126.24 4895.26,-10119.45"/>
</g>
<!-- v_proj_2&#45;&gt;attn_scores_2 -->
<g id="edge178" class="edge">
<title>v_proj_2&#45;&gt;attn_scores_2</title>
<path fill="none" stroke="black" d="M4800,-10156.08C4800,-10148.19 4800,-10139.08 4800,-10130.5"/>
<polygon fill="black" stroke="black" points="4803.5,-10130.41 4800,-10120.41 4796.5,-10130.41 4803.5,-10130.41"/>
</g>
<!-- softmax_2 -->
<g id="node148" class="node">
<title>softmax_2</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-10040.39 4633.5,-10040.39 4633.5,-9996.39 4966.5,-9996.39 4966.5,-10040.39"/>
<text text-anchor="middle" x="4800" y="-10031.19" font-family="Times,serif" font-size="9.00">Softmax L2</text>
<text text-anchor="middle" x="4800" y="-10021.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4800" y="-10011.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4800" y="-10001.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_2&#45;&gt;softmax_2 -->
<g id="edge179" class="edge">
<title>attn_scores_2&#45;&gt;softmax_2</title>
<path fill="none" stroke="black" d="M4800,-10076.08C4800,-10068.19 4800,-10059.08 4800,-10050.5"/>
<polygon fill="black" stroke="black" points="4803.5,-10050.41 4800,-10040.41 4796.5,-10050.41 4803.5,-10050.41"/>
</g>
<!-- attn_out_2 -->
<g id="node149" class="node">
<title>attn_out_2</title>
<polygon fill="lightgreen" stroke="black" points="4948,-9960.39 4652,-9960.39 4652,-9916.39 4948,-9916.39 4948,-9960.39"/>
<text text-anchor="middle" x="4800" y="-9951.19" font-family="Times,serif" font-size="9.00">Attention Output L2</text>
<text text-anchor="middle" x="4800" y="-9941.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4800" y="-9931.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-9921.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_2&#45;&gt;attn_out_2 -->
<g id="edge180" class="edge">
<title>softmax_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M4800,-9996.08C4800,-9988.19 4800,-9979.08 4800,-9970.5"/>
<polygon fill="black" stroke="black" points="4803.5,-9970.41 4800,-9960.41 4796.5,-9970.41 4803.5,-9970.41"/>
</g>
<!-- gate_2 -->
<g id="node150" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="5099.74,-9880.39 4622.92,-9880.39 4500.26,-9792.39 4977.08,-9792.39 5099.74,-9880.39"/>
<text text-anchor="middle" x="4800" y="-9849.19" font-family="Times,serif" font-size="9.00">Gate L2</text>
<text text-anchor="middle" x="4800" y="-9839.19" font-family="Times,serif" font-size="9.00">GPU: 64&#45;127</text>
<text text-anchor="middle" x="4800" y="-9829.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-9819.19" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_2&#45;&gt;gate_2 -->
<g id="edge181" class="edge">
<title>attn_out_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M4800,-9916.19C4800,-9908.69 4800,-9899.88 4800,-9890.92"/>
<polygon fill="black" stroke="black" points="4803.5,-9890.8 4800,-9880.8 4796.5,-9890.8 4803.5,-9890.8"/>
</g>
<!-- route_2_0 -->
<g id="node151" class="node">
<title>route_2_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="450" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="450" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="450" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="450" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_0 -->
<g id="edge182" class="edge">
<title>gate_2&#45;&gt;route_2_0</title>
<path fill="none" stroke="black" d="M4560.41,-9835.56C3942.29,-9834.93 2243.2,-9826.39 830,-9756.39 764.75,-9753.16 693.31,-9747.95 630.17,-9742.75"/>
<polygon fill="black" stroke="black" points="630.36,-9739.26 620.11,-9741.92 629.79,-9746.24 630.36,-9739.26"/>
</g>
<!-- route_2_1 -->
<g id="node155" class="node">
<title>route_2_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1040" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1040" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 66,67</text>
<text text-anchor="middle" x="1040" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_1 -->
<g id="edge187" class="edge">
<title>gate_2&#45;&gt;route_2_1</title>
<path fill="none" stroke="black" d="M4558.54,-9834.36C4003.81,-9830.99 2595.69,-9816.67 1420,-9756.39 1354.91,-9753.06 1283.67,-9747.83 1220.63,-9742.66"/>
<polygon fill="black" stroke="black" points="1220.84,-9739.17 1210.59,-9741.84 1220.27,-9746.15 1220.84,-9739.17"/>
</g>
<!-- route_2_2 -->
<g id="node159" class="node">
<title>route_2_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1630" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1630" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 68,69</text>
<text text-anchor="middle" x="1630" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_2 -->
<g id="edge192" class="edge">
<title>gate_2&#45;&gt;route_2_2</title>
<path fill="none" stroke="black" d="M4556.32,-9832.65C4071.25,-9826.27 2950.52,-9806.94 2010,-9756.39 1945.08,-9752.91 1874.02,-9747.66 1811.1,-9742.52"/>
<polygon fill="black" stroke="black" points="1811.32,-9739.03 1801.07,-9741.69 1810.75,-9746 1811.32,-9739.03"/>
</g>
<!-- route_2_3 -->
<g id="node163" class="node">
<title>route_2_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2220" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2220" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 70,71</text>
<text text-anchor="middle" x="2220" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_3 -->
<g id="edge197" class="edge">
<title>gate_2&#45;&gt;route_2_3</title>
<path fill="none" stroke="black" d="M4552.39,-9829.99C4144.97,-9820.31 3307.79,-9797.13 2600,-9756.39 2535.25,-9752.67 2464.38,-9747.38 2401.57,-9742.28"/>
<polygon fill="black" stroke="black" points="2401.81,-9738.78 2391.56,-9741.46 2401.24,-9745.76 2401.81,-9738.78"/>
</g>
<!-- route_2_4 -->
<g id="node167" class="node">
<title>route_2_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2810" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2810" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 72,73</text>
<text text-anchor="middle" x="2810" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_4 -->
<g id="edge202" class="edge">
<title>gate_2&#45;&gt;route_2_4</title>
<path fill="none" stroke="black" d="M4546.11,-9825.3C4228.75,-9812.13 3668.96,-9787.12 3190,-9756.39 3125.88,-9752.28 3055.73,-9746.96 2993.35,-9741.93"/>
<polygon fill="black" stroke="black" points="2993.26,-9738.41 2983.01,-9741.09 2992.7,-9745.39 2993.26,-9738.41"/>
</g>
<!-- route_2_5 -->
<g id="node171" class="node">
<title>route_2_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3400" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 74,75</text>
<text text-anchor="middle" x="3400" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_5 -->
<g id="edge207" class="edge">
<title>gate_2&#45;&gt;route_2_5</title>
<path fill="none" stroke="black" d="M4531.27,-9814.71C4325.59,-9798.85 4034.87,-9776.36 3780,-9756.39 3716.88,-9751.45 3647.86,-9745.99 3586.17,-9741.1"/>
<polygon fill="black" stroke="black" points="3586.19,-9737.59 3575.94,-9740.29 3585.63,-9744.57 3586.19,-9737.59"/>
</g>
<!-- route_2_6 -->
<g id="node175" class="node">
<title>route_2_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3990" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="3990" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 76,77</text>
<text text-anchor="middle" x="3990" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_6 -->
<g id="edge212" class="edge">
<title>gate_2&#45;&gt;route_2_6</title>
<path fill="none" stroke="black" d="M4504.71,-9795.62C4384.27,-9779.39 4249.83,-9761.28 4148.56,-9747.64"/>
<polygon fill="black" stroke="black" points="4148.93,-9744.16 4138.55,-9746.29 4148,-9751.1 4148.93,-9744.16"/>
</g>
<!-- route_2_7 -->
<g id="node179" class="node">
<title>route_2_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4517" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4517" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4517" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 78,79</text>
<text text-anchor="middle" x="4517" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4517" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_7 -->
<g id="edge217" class="edge">
<title>gate_2&#45;&gt;route_2_7</title>
<path fill="none" stroke="black" d="M4688.15,-9792.27C4658.58,-9780.87 4627.19,-9768.77 4599.48,-9758.08"/>
<polygon fill="black" stroke="black" points="4600.43,-9754.7 4589.85,-9754.37 4597.92,-9761.23 4600.43,-9754.7"/>
</g>
<!-- route_2_8 -->
<g id="node183" class="node">
<title>route_2_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4937" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4937" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4937" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="4937" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4937" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_8 -->
<g id="edge222" class="edge">
<title>gate_2&#45;&gt;route_2_8</title>
<path fill="none" stroke="black" d="M4854.15,-9792.27C4866.54,-9782.4 4879.6,-9772 4891.58,-9762.45"/>
<polygon fill="black" stroke="black" points="4894.05,-9764.97 4899.69,-9756 4889.69,-9759.49 4894.05,-9764.97"/>
</g>
<!-- route_2_9 -->
<g id="node187" class="node">
<title>route_2_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5465" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5465" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 98,99</text>
<text text-anchor="middle" x="5465" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_9 -->
<g id="edge227" class="edge">
<title>gate_2&#45;&gt;route_2_9</title>
<path fill="none" stroke="black" d="M4993.24,-9803.69C5097.59,-9786.57 5224.28,-9765.78 5320.09,-9750.06"/>
<polygon fill="black" stroke="black" points="5320.84,-9753.48 5330.14,-9748.41 5319.71,-9746.57 5320.84,-9753.48"/>
</g>
<!-- route_2_10 -->
<g id="node191" class="node">
<title>route_2_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6055" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6055" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 100,101</text>
<text text-anchor="middle" x="6055" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_10 -->
<g id="edge232" class="edge">
<title>gate_2&#45;&gt;route_2_10</title>
<path fill="none" stroke="black" d="M5011.47,-9817.01C5252.91,-9796.02 5643.88,-9762.03 5872.5,-9742.15"/>
<polygon fill="black" stroke="black" points="5872.93,-9745.62 5882.59,-9741.27 5872.32,-9738.65 5872.93,-9745.62"/>
</g>
<!-- route_2_11 -->
<g id="node195" class="node">
<title>route_2_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6645" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6645" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 102,103</text>
<text text-anchor="middle" x="6645" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_11 -->
<g id="edge237" class="edge">
<title>gate_2&#45;&gt;route_2_11</title>
<path fill="none" stroke="black" d="M5022.86,-9825.13C5310.12,-9811.49 5825.01,-9785.69 6265,-9756.39 6328.96,-9752.14 6398.92,-9746.79 6461.18,-9741.79"/>
<polygon fill="black" stroke="black" points="6461.82,-9745.25 6471.5,-9740.96 6461.25,-9738.27 6461.82,-9745.25"/>
</g>
<!-- route_2_12 -->
<g id="node199" class="node">
<title>route_2_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7235" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7235" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 104,105</text>
<text text-anchor="middle" x="7235" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_12 -->
<g id="edge242" class="edge">
<title>gate_2&#45;&gt;route_2_12</title>
<path fill="none" stroke="black" d="M5028.98,-9829.63C5408.69,-9819.39 6192.51,-9795.36 6855,-9756.39 6919.59,-9752.6 6990.27,-9747.31 7052.97,-9742.22"/>
<polygon fill="black" stroke="black" points="7053.28,-9745.71 7062.96,-9741.4 7052.71,-9738.73 7053.28,-9745.71"/>
</g>
<!-- route_2_13 -->
<g id="node203" class="node">
<title>route_2_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7825" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7825" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 106,107</text>
<text text-anchor="middle" x="7825" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_13 -->
<g id="edge247" class="edge">
<title>gate_2&#45;&gt;route_2_13</title>
<path fill="none" stroke="black" d="M5032.79,-9832.29C5493.61,-9825.29 6554.5,-9804.95 7445,-9756.39 7509.92,-9752.85 7580.98,-9747.6 7643.9,-9742.46"/>
<polygon fill="black" stroke="black" points="7644.25,-9745.94 7653.93,-9741.64 7643.67,-9738.97 7644.25,-9745.94"/>
</g>
<!-- route_2_14 -->
<g id="node207" class="node">
<title>route_2_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8415" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8415" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 108,109</text>
<text text-anchor="middle" x="8415" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_14 -->
<g id="edge252" class="edge">
<title>gate_2&#45;&gt;route_2_14</title>
<path fill="none" stroke="black" d="M5035.59,-9834.05C5569.6,-9830.04 6912.91,-9814.51 8035,-9756.39 8100.09,-9753.02 8171.33,-9747.79 8234.37,-9742.63"/>
<polygon fill="black" stroke="black" points="8234.73,-9746.11 8244.41,-9741.8 8234.16,-9739.13 8234.73,-9746.11"/>
</g>
<!-- route_2_15 -->
<g id="node211" class="node">
<title>route_2_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9005" cy="-9725.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-9738.08" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9005" y="-9728.08" font-family="Times,serif" font-size="9.00">GPU: 110,111</text>
<text text-anchor="middle" x="9005" y="-9718.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-9708.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_15 -->
<g id="edge257" class="edge">
<title>gate_2&#45;&gt;route_2_15</title>
<path fill="none" stroke="black" d="M5037.13,-9835.31C5637.85,-9834.05 7268.18,-9824.11 8625,-9756.39 8690.25,-9753.14 8761.68,-9747.92 8824.83,-9742.73"/>
<polygon fill="black" stroke="black" points="8825.21,-9746.21 8834.89,-9741.89 8824.64,-9739.23 8825.21,-9746.21"/>
</g>
<!-- expert_2_0_0 -->
<g id="node152" class="node">
<title>expert_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293.5,-9658.17 16.5,-9658.17 16.5,-9614.17 293.5,-9614.17 293.5,-9658.17"/>
<text text-anchor="middle" x="155" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L2</text>
<text text-anchor="middle" x="155" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="155" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_0&#45;&gt;expert_2_0_0 -->
<g id="edge183" class="edge">
<title>route_2_0&#45;&gt;expert_2_0_0</title>
<path fill="none" stroke="black" d="M359.08,-9697.43C319.92,-9685.87 274.49,-9672.45 236.44,-9661.22"/>
<polygon fill="black" stroke="black" points="237.01,-9657.74 226.43,-9658.26 235.03,-9664.45 237.01,-9657.74"/>
</g>
<!-- expert_2_0_1 -->
<g id="node153" class="node">
<title>expert_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="588.5,-9658.17 311.5,-9658.17 311.5,-9614.17 588.5,-9614.17 588.5,-9658.17"/>
<text text-anchor="middle" x="450" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L2</text>
<text text-anchor="middle" x="450" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="450" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_0&#45;&gt;expert_2_0_1 -->
<g id="edge184" class="edge">
<title>route_2_0&#45;&gt;expert_2_0_1</title>
<path fill="none" stroke="black" d="M450,-9693.81C450,-9685.53 450,-9676.56 450,-9668.25"/>
<polygon fill="black" stroke="black" points="453.5,-9668.17 450,-9658.17 446.5,-9668.17 453.5,-9668.17"/>
</g>
<!-- tp_2_0 -->
<g id="node154" class="node">
<title>tp_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="2852" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2852" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L2</text>
<text text-anchor="middle" x="2852" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="2852" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2852" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_0_0&#45;&gt;tp_2_0 -->
<g id="edge185" class="edge">
<title>expert_2_0_0&#45;&gt;tp_2_0</title>
<path fill="none" stroke="black" d="M293.84,-9614.9C296.58,-9614.64 299.3,-9614.4 302,-9614.17 780.88,-9573.89 2280.56,-9554.39 2726.02,-9549.39"/>
<polygon fill="black" stroke="black" points="2726.07,-9552.89 2736.03,-9549.27 2725.99,-9545.89 2726.07,-9552.89"/>
</g>
<!-- expert_2_0_1&#45;&gt;tp_2_0 -->
<g id="edge186" class="edge">
<title>expert_2_0_1&#45;&gt;tp_2_0</title>
<path fill="none" stroke="black" d="M588.6,-9615.02C591.76,-9614.72 594.9,-9614.43 598,-9614.17 1016.26,-9578.47 2315.54,-9556.19 2726.23,-9549.89"/>
<polygon fill="black" stroke="black" points="2726.41,-9553.39 2736.35,-9549.74 2726.3,-9546.39 2726.41,-9553.39"/>
</g>
<!-- q_proj_3 -->
<g id="node215" class="node">
<title>q_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="4875,-9479.94 4579,-9479.94 4579,-9435.94 4875,-9435.94 4875,-9479.94"/>
<text text-anchor="middle" x="4727" y="-9470.74" font-family="Times,serif" font-size="9.00">Q Projection L3</text>
<text text-anchor="middle" x="4727" y="-9460.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4727" y="-9450.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-9440.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_2_0&#45;&gt;q_proj_3 -->
<g id="edge1476" class="edge">
<title>tp_2_0&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M2931.21,-9524.28C2946.31,-9520.9 2962.06,-9517.89 2977,-9515.94 3324.87,-9470.64 4200.53,-9506.77 4568.51,-9479.99"/>
<polygon fill="black" stroke="black" points="4569,-9483.46 4578.71,-9479.22 4568.48,-9476.48 4569,-9483.46"/>
</g>
<!-- k_proj_3 -->
<g id="node216" class="node">
<title>k_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="5189,-9479.94 4893,-9479.94 4893,-9435.94 5189,-9435.94 5189,-9479.94"/>
<text text-anchor="middle" x="5041" y="-9470.74" font-family="Times,serif" font-size="9.00">K Projection L3</text>
<text text-anchor="middle" x="5041" y="-9460.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="5041" y="-9450.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5041" y="-9440.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_2_0&#45;&gt;k_proj_3 -->
<g id="edge1477" class="edge">
<title>tp_2_0&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M2931.2,-9524.24C2946.3,-9520.86 2962.06,-9517.86 2977,-9515.94 3394.12,-9462.41 4444.78,-9511.32 4882.49,-9479.99"/>
<polygon fill="black" stroke="black" points="4883,-9483.46 4892.71,-9479.24 4882.48,-9476.48 4883,-9483.46"/>
</g>
<!-- v_proj_3 -->
<g id="node217" class="node">
<title>v_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="4561,-9479.94 4265,-9479.94 4265,-9435.94 4561,-9435.94 4561,-9479.94"/>
<text text-anchor="middle" x="4413" y="-9470.74" font-family="Times,serif" font-size="9.00">V Projection L3</text>
<text text-anchor="middle" x="4413" y="-9460.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4413" y="-9450.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4413" y="-9440.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_2_0&#45;&gt;v_proj_3 -->
<g id="edge1478" class="edge">
<title>tp_2_0&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M2931.57,-9524.42C2946.56,-9521.04 2962.19,-9518 2977,-9515.94 3219.49,-9482.26 3934.06,-9466.72 4254.44,-9461.3"/>
<polygon fill="black" stroke="black" points="4254.79,-9464.8 4264.73,-9461.13 4254.68,-9457.8 4254.79,-9464.8"/>
</g>
<!-- expert_2_1_0 -->
<g id="node156" class="node">
<title>expert_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="883.5,-9658.17 606.5,-9658.17 606.5,-9614.17 883.5,-9614.17 883.5,-9658.17"/>
<text text-anchor="middle" x="745" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L2</text>
<text text-anchor="middle" x="745" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 66</text>
<text text-anchor="middle" x="745" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="745" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_1&#45;&gt;expert_2_1_0 -->
<g id="edge188" class="edge">
<title>route_2_1&#45;&gt;expert_2_1_0</title>
<path fill="none" stroke="black" d="M949.08,-9697.43C909.92,-9685.87 864.49,-9672.45 826.44,-9661.22"/>
<polygon fill="black" stroke="black" points="827.01,-9657.74 816.43,-9658.26 825.03,-9664.45 827.01,-9657.74"/>
</g>
<!-- expert_2_1_1 -->
<g id="node157" class="node">
<title>expert_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1178.5,-9658.17 901.5,-9658.17 901.5,-9614.17 1178.5,-9614.17 1178.5,-9658.17"/>
<text text-anchor="middle" x="1040" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L2</text>
<text text-anchor="middle" x="1040" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 67</text>
<text text-anchor="middle" x="1040" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_1&#45;&gt;expert_2_1_1 -->
<g id="edge189" class="edge">
<title>route_2_1&#45;&gt;expert_2_1_1</title>
<path fill="none" stroke="black" d="M1040,-9693.81C1040,-9685.53 1040,-9676.56 1040,-9668.25"/>
<polygon fill="black" stroke="black" points="1043.5,-9668.17 1040,-9658.17 1036.5,-9668.17 1043.5,-9668.17"/>
</g>
<!-- tp_2_1 -->
<g id="node158" class="node">
<title>tp_2_1</title>
<ellipse fill="lightblue" stroke="black" cx="3102" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3102" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L2</text>
<text text-anchor="middle" x="3102" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 66↔67</text>
<text text-anchor="middle" x="3102" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3102" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_1_0&#45;&gt;tp_2_1 -->
<g id="edge190" class="edge">
<title>expert_2_1_0&#45;&gt;tp_2_1</title>
<path fill="none" stroke="black" d="M883.59,-9614.97C886.76,-9614.68 889.9,-9614.42 893,-9614.17 1354.73,-9577.56 2517.54,-9636.76 2977,-9578.17 2988.68,-9576.68 3000.85,-9574.53 3012.81,-9572.05"/>
<polygon fill="black" stroke="black" points="3013.76,-9575.42 3022.8,-9569.89 3012.29,-9568.58 3013.76,-9575.42"/>
</g>
<!-- expert_2_1_1&#45;&gt;tp_2_1 -->
<g id="edge191" class="edge">
<title>expert_2_1_1&#45;&gt;tp_2_1</title>
<path fill="none" stroke="black" d="M1178.6,-9614.99C1181.76,-9614.69 1184.9,-9614.42 1188,-9614.17 1584.35,-9582.18 2582.63,-9629.03 2977,-9578.17 2988.67,-9576.66 3000.84,-9574.5 3012.81,-9572.01"/>
<polygon fill="black" stroke="black" points="3013.76,-9575.39 3022.79,-9569.86 3012.28,-9568.55 3013.76,-9575.39"/>
</g>
<!-- tp_2_1&#45;&gt;q_proj_3 -->
<g id="edge1479" class="edge">
<title>tp_2_1&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M3181.55,-9524.26C3196.55,-9520.9 3212.17,-9517.91 3227,-9515.94 3815.62,-9438.03 3973.04,-9526.59 4568.58,-9480.01"/>
<polygon fill="black" stroke="black" points="4569.02,-9483.48 4578.71,-9479.2 4568.47,-9476.51 4569.02,-9483.48"/>
</g>
<!-- tp_2_1&#45;&gt;k_proj_3 -->
<g id="edge1480" class="edge">
<title>tp_2_1&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M3181.21,-9524.27C3196.3,-9520.89 3212.06,-9517.88 3227,-9515.94 3589.04,-9468.96 4500.58,-9507.71 4882.67,-9479.98"/>
<polygon fill="black" stroke="black" points="4883,-9483.46 4892.71,-9479.22 4882.48,-9476.48 4883,-9483.46"/>
</g>
<!-- tp_2_1&#45;&gt;v_proj_3 -->
<g id="edge1481" class="edge">
<title>tp_2_1&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M3181.92,-9524.44C3196.81,-9521.09 3212.31,-9518.05 3227,-9515.94 3420.63,-9488.22 3978.96,-9470.28 4254.85,-9462.85"/>
<polygon fill="black" stroke="black" points="4255.05,-9466.34 4264.95,-9462.58 4254.86,-9459.35 4255.05,-9466.34"/>
</g>
<!-- expert_2_2_0 -->
<g id="node160" class="node">
<title>expert_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-9658.17 1196.5,-9658.17 1196.5,-9614.17 1473.5,-9614.17 1473.5,-9658.17"/>
<text text-anchor="middle" x="1335" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L2</text>
<text text-anchor="middle" x="1335" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 68</text>
<text text-anchor="middle" x="1335" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1335" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_2&#45;&gt;expert_2_2_0 -->
<g id="edge193" class="edge">
<title>route_2_2&#45;&gt;expert_2_2_0</title>
<path fill="none" stroke="black" d="M1539.08,-9697.43C1499.92,-9685.87 1454.49,-9672.45 1416.44,-9661.22"/>
<polygon fill="black" stroke="black" points="1417.01,-9657.74 1406.43,-9658.26 1415.03,-9664.45 1417.01,-9657.74"/>
</g>
<!-- expert_2_2_1 -->
<g id="node161" class="node">
<title>expert_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1768.5,-9658.17 1491.5,-9658.17 1491.5,-9614.17 1768.5,-9614.17 1768.5,-9658.17"/>
<text text-anchor="middle" x="1630" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L2</text>
<text text-anchor="middle" x="1630" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 69</text>
<text text-anchor="middle" x="1630" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_2&#45;&gt;expert_2_2_1 -->
<g id="edge194" class="edge">
<title>route_2_2&#45;&gt;expert_2_2_1</title>
<path fill="none" stroke="black" d="M1630,-9693.81C1630,-9685.53 1630,-9676.56 1630,-9668.25"/>
<polygon fill="black" stroke="black" points="1633.5,-9668.17 1630,-9658.17 1626.5,-9668.17 1633.5,-9668.17"/>
</g>
<!-- tp_2_2 -->
<g id="node162" class="node">
<title>tp_2_2</title>
<ellipse fill="lightblue" stroke="black" cx="3352" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3352" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L2</text>
<text text-anchor="middle" x="3352" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 68↔69</text>
<text text-anchor="middle" x="3352" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3352" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_2_0&#45;&gt;tp_2_2 -->
<g id="edge195" class="edge">
<title>expert_2_2_0&#45;&gt;tp_2_2</title>
<path fill="none" stroke="black" d="M1473.6,-9614.99C1476.76,-9614.69 1479.9,-9614.42 1483,-9614.17 1869.37,-9582.88 2842.56,-9627.85 3227,-9578.17 3238.67,-9576.66 3250.84,-9574.5 3262.81,-9572.01"/>
<polygon fill="black" stroke="black" points="3263.76,-9575.38 3272.79,-9569.85 3262.28,-9568.54 3263.76,-9575.38"/>
</g>
<!-- expert_2_2_1&#45;&gt;tp_2_2 -->
<g id="edge196" class="edge">
<title>expert_2_2_1&#45;&gt;tp_2_2</title>
<path fill="none" stroke="black" d="M1768.6,-9615.01C1771.76,-9614.71 1774.9,-9614.43 1778,-9614.17 2419.99,-9560.83 2588.29,-9662.07 3227,-9578.17 3238.67,-9576.64 3250.84,-9574.46 3262.8,-9571.96"/>
<polygon fill="black" stroke="black" points="3263.75,-9575.34 3272.79,-9569.8 3262.27,-9568.5 3263.75,-9575.34"/>
</g>
<!-- tp_2_2&#45;&gt;q_proj_3 -->
<g id="edge1482" class="edge">
<title>tp_2_2&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M3431.56,-9524.34C3446.55,-9520.97 3462.18,-9517.95 3477,-9515.94 3955.35,-9451.14 4083.88,-9519.27 4568.65,-9480.01"/>
<polygon fill="black" stroke="black" points="4569.03,-9483.49 4578.71,-9479.18 4568.46,-9476.51 4569.03,-9483.49"/>
</g>
<!-- tp_2_2&#45;&gt;k_proj_3 -->
<g id="edge1483" class="edge">
<title>tp_2_2&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M3431.21,-9524.32C3446.31,-9520.94 3462.06,-9517.91 3477,-9515.94 4093.85,-9434.68 4258.66,-9528.46 4882.56,-9480.01"/>
<polygon fill="black" stroke="black" points="4883.02,-9483.48 4892.71,-9479.21 4882.47,-9476.5 4883.02,-9483.48"/>
</g>
<!-- tp_2_2&#45;&gt;v_proj_3 -->
<g id="edge1484" class="edge">
<title>tp_2_2&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M3432.28,-9524.52C3447.06,-9521.18 3462.43,-9518.12 3477,-9515.94 3748.14,-9475.35 4067.59,-9463.5 4254.46,-9460.14"/>
<polygon fill="black" stroke="black" points="4254.7,-9463.64 4264.64,-9459.96 4254.58,-9456.64 4254.7,-9463.64"/>
</g>
<!-- expert_2_3_0 -->
<g id="node164" class="node">
<title>expert_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-9658.17 1786.5,-9658.17 1786.5,-9614.17 2063.5,-9614.17 2063.5,-9658.17"/>
<text text-anchor="middle" x="1925" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L2</text>
<text text-anchor="middle" x="1925" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 70</text>
<text text-anchor="middle" x="1925" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1925" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_3&#45;&gt;expert_2_3_0 -->
<g id="edge198" class="edge">
<title>route_2_3&#45;&gt;expert_2_3_0</title>
<path fill="none" stroke="black" d="M2129.08,-9697.43C2089.92,-9685.87 2044.49,-9672.45 2006.44,-9661.22"/>
<polygon fill="black" stroke="black" points="2007.01,-9657.74 1996.43,-9658.26 2005.03,-9664.45 2007.01,-9657.74"/>
</g>
<!-- expert_2_3_1 -->
<g id="node165" class="node">
<title>expert_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2358.5,-9658.17 2081.5,-9658.17 2081.5,-9614.17 2358.5,-9614.17 2358.5,-9658.17"/>
<text text-anchor="middle" x="2220" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L2</text>
<text text-anchor="middle" x="2220" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 71</text>
<text text-anchor="middle" x="2220" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_3&#45;&gt;expert_2_3_1 -->
<g id="edge199" class="edge">
<title>route_2_3&#45;&gt;expert_2_3_1</title>
<path fill="none" stroke="black" d="M2220,-9693.81C2220,-9685.53 2220,-9676.56 2220,-9668.25"/>
<polygon fill="black" stroke="black" points="2223.5,-9668.17 2220,-9658.17 2216.5,-9668.17 2223.5,-9668.17"/>
</g>
<!-- tp_2_3 -->
<g id="node166" class="node">
<title>tp_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="3602" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3602" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L2</text>
<text text-anchor="middle" x="3602" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 70↔71</text>
<text text-anchor="middle" x="3602" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3602" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_3_0&#45;&gt;tp_2_3 -->
<g id="edge200" class="edge">
<title>expert_2_3_0&#45;&gt;tp_2_3</title>
<path fill="none" stroke="black" d="M2063.6,-9615.01C2066.76,-9614.71 2069.9,-9614.43 2073,-9614.17 2695.04,-9562.24 2858.14,-9659.72 3477,-9578.17 3488.67,-9576.63 3500.84,-9574.45 3512.8,-9571.95"/>
<polygon fill="black" stroke="black" points="3513.75,-9575.33 3522.79,-9569.79 3512.27,-9568.49 3513.75,-9575.33"/>
</g>
<!-- expert_2_3_1&#45;&gt;tp_2_3 -->
<g id="edge201" class="edge">
<title>expert_2_3_1&#45;&gt;tp_2_3</title>
<path fill="none" stroke="black" d="M2358.6,-9615.04C2361.76,-9614.73 2364.9,-9614.44 2368,-9614.17 2859.3,-9571.47 2988.3,-9644.26 3477,-9578.17 3488.58,-9576.6 3500.65,-9574.42 3512.52,-9571.93"/>
<polygon fill="black" stroke="black" points="3513.41,-9575.32 3522.44,-9569.78 3511.92,-9568.48 3513.41,-9575.32"/>
</g>
<!-- tp_2_3&#45;&gt;q_proj_3 -->
<g id="edge1485" class="edge">
<title>tp_2_3&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M3681.91,-9524.38C3696.8,-9521.03 3712.3,-9518.01 3727,-9515.94 4095.1,-9464.24 4194.69,-9511.98 4568.69,-9480.01"/>
<polygon fill="black" stroke="black" points="4569.05,-9483.49 4578.71,-9479.14 4568.44,-9476.52 4569.05,-9483.49"/>
</g>
<!-- tp_2_3&#45;&gt;k_proj_3 -->
<g id="edge1486" class="edge">
<title>tp_2_3&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M3681.56,-9524.31C3696.55,-9520.95 3712.18,-9517.94 3727,-9515.94 4233.52,-9447.79 4369.47,-9521.12 4882.45,-9480.02"/>
<polygon fill="black" stroke="black" points="4883.03,-9483.49 4892.71,-9479.19 4882.46,-9476.51 4883.03,-9483.49"/>
</g>
<!-- tp_2_3&#45;&gt;v_proj_3 -->
<g id="edge1487" class="edge">
<title>tp_2_3&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M3682.99,-9524.63C3697.57,-9521.33 3712.68,-9518.25 3727,-9515.94 3906.42,-9487.05 4114.75,-9472.37 4254.32,-9465.21"/>
<polygon fill="black" stroke="black" points="4254.86,-9468.69 4264.67,-9464.69 4254.51,-9461.7 4254.86,-9468.69"/>
</g>
<!-- expert_2_4_0 -->
<g id="node168" class="node">
<title>expert_2_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2653.5,-9658.17 2376.5,-9658.17 2376.5,-9614.17 2653.5,-9614.17 2653.5,-9658.17"/>
<text text-anchor="middle" x="2515" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L2</text>
<text text-anchor="middle" x="2515" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 72</text>
<text text-anchor="middle" x="2515" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2515" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_4&#45;&gt;expert_2_4_0 -->
<g id="edge203" class="edge">
<title>route_2_4&#45;&gt;expert_2_4_0</title>
<path fill="none" stroke="black" d="M2719.08,-9697.43C2679.92,-9685.87 2634.49,-9672.45 2596.44,-9661.22"/>
<polygon fill="black" stroke="black" points="2597.01,-9657.74 2586.43,-9658.26 2595.03,-9664.45 2597.01,-9657.74"/>
</g>
<!-- expert_2_4_1 -->
<g id="node169" class="node">
<title>expert_2_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2948.5,-9658.17 2671.5,-9658.17 2671.5,-9614.17 2948.5,-9614.17 2948.5,-9658.17"/>
<text text-anchor="middle" x="2810" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L2</text>
<text text-anchor="middle" x="2810" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 73</text>
<text text-anchor="middle" x="2810" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_4&#45;&gt;expert_2_4_1 -->
<g id="edge204" class="edge">
<title>route_2_4&#45;&gt;expert_2_4_1</title>
<path fill="none" stroke="black" d="M2810,-9693.81C2810,-9685.53 2810,-9676.56 2810,-9668.25"/>
<polygon fill="black" stroke="black" points="2813.5,-9668.17 2810,-9658.17 2806.5,-9668.17 2813.5,-9668.17"/>
</g>
<!-- tp_2_4 -->
<g id="node170" class="node">
<title>tp_2_4</title>
<ellipse fill="lightblue" stroke="black" cx="3852" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3852" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L2</text>
<text text-anchor="middle" x="3852" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 72↔73</text>
<text text-anchor="middle" x="3852" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3852" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_4_0&#45;&gt;tp_2_4 -->
<g id="edge205" class="edge">
<title>expert_2_4_0&#45;&gt;tp_2_4</title>
<path fill="none" stroke="black" d="M2653.6,-9615.04C2656.76,-9614.73 2659.9,-9614.44 2663,-9614.17 3134.35,-9572.87 3258.15,-9641.9 3727,-9578.17 3738.58,-9576.6 3750.65,-9574.41 3762.52,-9571.92"/>
<polygon fill="black" stroke="black" points="3763.41,-9575.31 3772.44,-9569.77 3761.92,-9568.47 3763.41,-9575.31"/>
</g>
<!-- expert_2_4_1&#45;&gt;tp_2_4 -->
<g id="edge206" class="edge">
<title>expert_2_4_1&#45;&gt;tp_2_4</title>
<path fill="none" stroke="black" d="M2948.6,-9615.1C2951.76,-9614.77 2954.9,-9614.46 2958,-9614.17 3298.65,-9582.1 3388.27,-9626.45 3727,-9578.17 3738.48,-9576.53 3750.45,-9574.32 3762.24,-9571.83"/>
<polygon fill="black" stroke="black" points="3763.06,-9575.24 3772.08,-9569.69 3761.56,-9568.4 3763.06,-9575.24"/>
</g>
<!-- tp_2_4&#45;&gt;q_proj_3 -->
<g id="edge1488" class="edge">
<title>tp_2_4&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M3932.28,-9524.52C3947.06,-9521.18 3962.43,-9518.12 3977,-9515.94 4234.82,-9477.37 4305.41,-9504.75 4568.46,-9480.05"/>
<polygon fill="black" stroke="black" points="4569.08,-9483.51 4578.7,-9479.07 4568.41,-9476.54 4569.08,-9483.51"/>
</g>
<!-- tp_2_4&#45;&gt;k_proj_3 -->
<g id="edge1489" class="edge">
<title>tp_2_4&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M3931.57,-9524.42C3946.56,-9521.04 3962.19,-9518 3977,-9515.94 4373.27,-9460.89 4480.3,-9513.83 4882.54,-9480.02"/>
<polygon fill="black" stroke="black" points="4883.04,-9483.49 4892.71,-9479.15 4882.45,-9476.52 4883.04,-9483.49"/>
</g>
<!-- tp_2_4&#45;&gt;v_proj_3 -->
<g id="edge1490" class="edge">
<title>tp_2_4&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M3934.1,-9524.96C3948.35,-9521.68 3963.06,-9518.53 3977,-9515.94 4068.51,-9498.99 4171.75,-9485.25 4254.79,-9475.52"/>
<polygon fill="black" stroke="black" points="4255.28,-9478.99 4264.81,-9474.35 4254.47,-9472.03 4255.28,-9478.99"/>
</g>
<!-- expert_2_5_0 -->
<g id="node172" class="node">
<title>expert_2_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3243.5,-9658.17 2966.5,-9658.17 2966.5,-9614.17 3243.5,-9614.17 3243.5,-9658.17"/>
<text text-anchor="middle" x="3105" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L2</text>
<text text-anchor="middle" x="3105" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 74</text>
<text text-anchor="middle" x="3105" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3105" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_5&#45;&gt;expert_2_5_0 -->
<g id="edge208" class="edge">
<title>route_2_5&#45;&gt;expert_2_5_0</title>
<path fill="none" stroke="black" d="M3309.08,-9697.43C3269.92,-9685.87 3224.49,-9672.45 3186.44,-9661.22"/>
<polygon fill="black" stroke="black" points="3187.01,-9657.74 3176.43,-9658.26 3185.03,-9664.45 3187.01,-9657.74"/>
</g>
<!-- expert_2_5_1 -->
<g id="node173" class="node">
<title>expert_2_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3538.5,-9658.17 3261.5,-9658.17 3261.5,-9614.17 3538.5,-9614.17 3538.5,-9658.17"/>
<text text-anchor="middle" x="3400" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L2</text>
<text text-anchor="middle" x="3400" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 75</text>
<text text-anchor="middle" x="3400" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_5&#45;&gt;expert_2_5_1 -->
<g id="edge209" class="edge">
<title>route_2_5&#45;&gt;expert_2_5_1</title>
<path fill="none" stroke="black" d="M3400,-9693.81C3400,-9685.53 3400,-9676.56 3400,-9668.25"/>
<polygon fill="black" stroke="black" points="3403.5,-9668.17 3400,-9658.17 3396.5,-9668.17 3403.5,-9668.17"/>
</g>
<!-- tp_2_5 -->
<g id="node174" class="node">
<title>tp_2_5</title>
<ellipse fill="lightblue" stroke="black" cx="4102" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4102" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L2</text>
<text text-anchor="middle" x="4102" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 74↔75</text>
<text text-anchor="middle" x="4102" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4102" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_5_0&#45;&gt;tp_2_5 -->
<g id="edge210" class="edge">
<title>expert_2_5_0&#45;&gt;tp_2_5</title>
<path fill="none" stroke="black" d="M3243.61,-9615.11C3246.77,-9614.78 3249.9,-9614.47 3253,-9614.17 3573.71,-9583.51 3658.11,-9624.1 3977,-9578.17 3988.48,-9576.52 4000.45,-9574.29 4012.23,-9571.8"/>
<polygon fill="black" stroke="black" points="4013.05,-9575.2 4022.07,-9569.65 4011.56,-9568.37 4013.05,-9575.2"/>
</g>
<!-- expert_2_5_1&#45;&gt;tp_2_5 -->
<g id="edge211" class="edge">
<title>expert_2_5_1&#45;&gt;tp_2_5</title>
<path fill="none" stroke="black" d="M3538.62,-9615.25C3541.78,-9614.88 3544.91,-9614.52 3548,-9614.17 3738.13,-9592.72 3788.11,-9608.66 3977,-9578.17 3988.08,-9576.38 3999.63,-9574.13 4011.03,-9571.68"/>
<polygon fill="black" stroke="black" points="4012,-9575.05 4021,-9569.47 4010.48,-9568.21 4012,-9575.05"/>
</g>
<!-- tp_2_5&#45;&gt;q_proj_3 -->
<g id="edge1491" class="edge">
<title>tp_2_5&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M4183.37,-9524.82C4197.84,-9521.51 4212.81,-9518.39 4227,-9515.94 4374.81,-9490.5 4416.04,-9497.77 4568.48,-9480.1"/>
<polygon fill="black" stroke="black" points="4569.16,-9483.54 4578.68,-9478.9 4568.34,-9476.59 4569.16,-9483.54"/>
</g>
<!-- tp_2_5&#45;&gt;k_proj_3 -->
<g id="edge1492" class="edge">
<title>tp_2_5&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M4182.27,-9524.45C4197.05,-9521.12 4212.42,-9518.08 4227,-9515.94 4513.1,-9474 4591.1,-9506.6 4882.68,-9480.02"/>
<polygon fill="black" stroke="black" points="4883.07,-9483.5 4892.7,-9479.09 4882.42,-9476.53 4883.07,-9483.5"/>
</g>
<!-- tp_2_5&#45;&gt;v_proj_3 -->
<g id="edge1493" class="edge">
<title>tp_2_5&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M4180.48,-9524.07C4225.5,-9511.46 4282.05,-9495.62 4328.1,-9482.72"/>
<polygon fill="black" stroke="black" points="4329.08,-9486.08 4337.77,-9480.02 4327.19,-9479.34 4329.08,-9486.08"/>
</g>
<!-- expert_2_6_0 -->
<g id="node176" class="node">
<title>expert_2_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3833.5,-9658.17 3556.5,-9658.17 3556.5,-9614.17 3833.5,-9614.17 3833.5,-9658.17"/>
<text text-anchor="middle" x="3695" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L2</text>
<text text-anchor="middle" x="3695" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 76</text>
<text text-anchor="middle" x="3695" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3695" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_6&#45;&gt;expert_2_6_0 -->
<g id="edge213" class="edge">
<title>route_2_6&#45;&gt;expert_2_6_0</title>
<path fill="none" stroke="black" d="M3899.08,-9697.43C3859.92,-9685.87 3814.49,-9672.45 3776.44,-9661.22"/>
<polygon fill="black" stroke="black" points="3777.01,-9657.74 3766.43,-9658.26 3775.03,-9664.45 3777.01,-9657.74"/>
</g>
<!-- expert_2_6_1 -->
<g id="node177" class="node">
<title>expert_2_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4128.5,-9658.17 3851.5,-9658.17 3851.5,-9614.17 4128.5,-9614.17 4128.5,-9658.17"/>
<text text-anchor="middle" x="3990" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L2</text>
<text text-anchor="middle" x="3990" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 77</text>
<text text-anchor="middle" x="3990" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_6&#45;&gt;expert_2_6_1 -->
<g id="edge214" class="edge">
<title>route_2_6&#45;&gt;expert_2_6_1</title>
<path fill="none" stroke="black" d="M3990,-9693.81C3990,-9685.53 3990,-9676.56 3990,-9668.25"/>
<polygon fill="black" stroke="black" points="3993.5,-9668.17 3990,-9658.17 3986.5,-9668.17 3993.5,-9668.17"/>
</g>
<!-- tp_2_6 -->
<g id="node178" class="node">
<title>tp_2_6</title>
<ellipse fill="lightblue" stroke="black" cx="4352" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4352" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L2</text>
<text text-anchor="middle" x="4352" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 76↔77</text>
<text text-anchor="middle" x="4352" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4352" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_6_0&#45;&gt;tp_2_6 -->
<g id="edge215" class="edge">
<title>expert_2_6_0&#45;&gt;tp_2_6</title>
<path fill="none" stroke="black" d="M3833.63,-9615.3C3836.78,-9614.91 3839.91,-9614.53 3843,-9614.17 4013.24,-9594.12 4057.91,-9606.31 4227,-9578.17 4238.07,-9576.33 4249.61,-9574.05 4261.02,-9571.57"/>
<polygon fill="black" stroke="black" points="4261.98,-9574.94 4270.98,-9569.35 4260.46,-9568.11 4261.98,-9574.94"/>
</g>
<!-- expert_2_6_1&#45;&gt;tp_2_6 -->
<g id="edge216" class="edge">
<title>expert_2_6_1&#45;&gt;tp_2_6</title>
<path fill="none" stroke="black" d="M4077.51,-9614.13C4122.24,-9603.38 4177.52,-9590.08 4227,-9578.17 4236.87,-9575.79 4247.17,-9573.31 4257.45,-9570.84"/>
<polygon fill="black" stroke="black" points="4258.38,-9574.21 4267.28,-9568.47 4256.74,-9567.41 4258.38,-9574.21"/>
</g>
<!-- tp_2_6&#45;&gt;q_proj_3 -->
<g id="edge1494" class="edge">
<title>tp_2_6&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M4436.35,-9525.59C4449.94,-9522.33 4463.85,-9519.03 4477,-9515.94 4525.15,-9504.65 4578.59,-9492.43 4623.67,-9482.21"/>
<polygon fill="black" stroke="black" points="4624.47,-9485.61 4633.45,-9479.99 4622.92,-9478.79 4624.47,-9485.61"/>
</g>
<!-- tp_2_6&#45;&gt;k_proj_3 -->
<g id="edge1495" class="edge">
<title>tp_2_6&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M4433,-9524.7C4447.58,-9521.38 4462.68,-9518.29 4477,-9515.94 4652.97,-9487.13 4701.76,-9499.52 4882.57,-9480.07"/>
<polygon fill="black" stroke="black" points="4883.13,-9483.53 4892.69,-9478.96 4882.37,-9476.57 4883.13,-9483.53"/>
</g>
<!-- tp_2_6&#45;&gt;v_proj_3 -->
<g id="edge1496" class="edge">
<title>tp_2_6&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M4372.99,-9516.08C4379.26,-9507.13 4386.12,-9497.32 4392.37,-9488.41"/>
<polygon fill="black" stroke="black" points="4395.26,-9490.38 4398.13,-9480.18 4389.52,-9486.37 4395.26,-9490.38"/>
</g>
<!-- expert_2_7_0 -->
<g id="node180" class="node">
<title>expert_2_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4423.5,-9658.17 4146.5,-9658.17 4146.5,-9614.17 4423.5,-9614.17 4423.5,-9658.17"/>
<text text-anchor="middle" x="4285" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L2</text>
<text text-anchor="middle" x="4285" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 78</text>
<text text-anchor="middle" x="4285" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4285" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_7&#45;&gt;expert_2_7_0 -->
<g id="edge218" class="edge">
<title>route_2_7&#45;&gt;expert_2_7_0</title>
<path fill="none" stroke="black" d="M4442.64,-9696.36C4413.11,-9685.27 4379.42,-9672.62 4350.8,-9661.87"/>
<polygon fill="black" stroke="black" points="4351.89,-9658.55 4341.29,-9658.31 4349.43,-9665.1 4351.89,-9658.55"/>
</g>
<!-- expert_2_7_1 -->
<g id="node181" class="node">
<title>expert_2_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4718.5,-9658.17 4441.5,-9658.17 4441.5,-9614.17 4718.5,-9614.17 4718.5,-9658.17"/>
<text text-anchor="middle" x="4580" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L2</text>
<text text-anchor="middle" x="4580" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 79</text>
<text text-anchor="middle" x="4580" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_7&#45;&gt;expert_2_7_1 -->
<g id="edge219" class="edge">
<title>route_2_7&#45;&gt;expert_2_7_1</title>
<path fill="none" stroke="black" d="M4538.68,-9694.3C4545.15,-9685.35 4552.24,-9675.55 4558.69,-9666.63"/>
<polygon fill="black" stroke="black" points="4561.61,-9668.56 4564.64,-9658.41 4555.94,-9664.46 4561.61,-9668.56"/>
</g>
<!-- tp_2_7 -->
<g id="node182" class="node">
<title>tp_2_7</title>
<ellipse fill="lightblue" stroke="black" cx="4602" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4602" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L2</text>
<text text-anchor="middle" x="4602" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 78↔79</text>
<text text-anchor="middle" x="4602" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4602" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_7_0&#45;&gt;tp_2_7 -->
<g id="edge220" class="edge">
<title>expert_2_7_0&#45;&gt;tp_2_7</title>
<path fill="none" stroke="black" d="M4361.74,-9614.08C4407.34,-9601.55 4465.37,-9585.6 4512.98,-9572.52"/>
<polygon fill="black" stroke="black" points="4513.94,-9575.88 4522.66,-9569.86 4512.09,-9569.13 4513.94,-9575.88"/>
</g>
<!-- expert_2_7_1&#45;&gt;tp_2_7 -->
<g id="edge221" class="edge">
<title>expert_2_7_1&#45;&gt;tp_2_7</title>
<path fill="none" stroke="black" d="M4585.33,-9614.08C4587.3,-9606.25 4589.62,-9597.09 4591.88,-9588.12"/>
<polygon fill="black" stroke="black" points="4595.34,-9588.72 4594.4,-9578.17 4588.55,-9587.01 4595.34,-9588.72"/>
</g>
<!-- tp_2_7&#45;&gt;q_proj_3 -->
<g id="edge1497" class="edge">
<title>tp_2_7&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M4642.58,-9517.77C4657.24,-9507.56 4673.74,-9496.06 4688.24,-9485.95"/>
<polygon fill="black" stroke="black" points="4690.32,-9488.77 4696.52,-9480.18 4686.31,-9483.03 4690.32,-9488.77"/>
</g>
<!-- tp_2_7&#45;&gt;k_proj_3 -->
<g id="edge1498" class="edge">
<title>tp_2_7&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M4685.23,-9525.31C4699.14,-9522.04 4713.46,-9518.8 4727,-9515.94 4785.43,-9503.61 4850.31,-9491.56 4905.87,-9481.74"/>
<polygon fill="black" stroke="black" points="4906.53,-9485.18 4915.77,-9480 4905.31,-9478.28 4906.53,-9485.18"/>
</g>
<!-- tp_2_7&#45;&gt;v_proj_3 -->
<g id="edge1499" class="edge">
<title>tp_2_7&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M4545.04,-9519.8C4520.67,-9508.57 4492.32,-9495.5 4468.15,-9484.36"/>
<polygon fill="black" stroke="black" points="4469.31,-9481.04 4458.76,-9480.04 4466.38,-9487.4 4469.31,-9481.04"/>
</g>
<!-- expert_2_8_0 -->
<g id="node184" class="node">
<title>expert_2_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5013.5,-9658.17 4736.5,-9658.17 4736.5,-9614.17 5013.5,-9614.17 5013.5,-9658.17"/>
<text text-anchor="middle" x="4875" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L2</text>
<text text-anchor="middle" x="4875" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="4875" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4875" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_8&#45;&gt;expert_2_8_0 -->
<g id="edge223" class="edge">
<title>route_2_8&#45;&gt;expert_2_8_0</title>
<path fill="none" stroke="black" d="M4915.66,-9694.3C4909.29,-9685.35 4902.32,-9675.55 4895.97,-9666.63"/>
<polygon fill="black" stroke="black" points="4898.77,-9664.53 4890.12,-9658.41 4893.06,-9668.59 4898.77,-9664.53"/>
</g>
<!-- expert_2_8_1 -->
<g id="node185" class="node">
<title>expert_2_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5308.5,-9658.17 5031.5,-9658.17 5031.5,-9614.17 5308.5,-9614.17 5308.5,-9658.17"/>
<text text-anchor="middle" x="5170" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L2</text>
<text text-anchor="middle" x="5170" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="5170" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5170" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_8&#45;&gt;expert_2_8_1 -->
<g id="edge224" class="edge">
<title>route_2_8&#45;&gt;expert_2_8_1</title>
<path fill="none" stroke="black" d="M5011.68,-9696.36C5041.34,-9685.27 5075.17,-9672.62 5103.92,-9661.87"/>
<polygon fill="black" stroke="black" points="5105.32,-9665.09 5113.46,-9658.31 5102.87,-9658.53 5105.32,-9665.09"/>
</g>
<!-- tp_2_8 -->
<g id="node186" class="node">
<title>tp_2_8</title>
<ellipse fill="lightblue" stroke="black" cx="4852" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4852" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L2</text>
<text text-anchor="middle" x="4852" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="4852" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4852" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_8_0&#45;&gt;tp_2_8 -->
<g id="edge225" class="edge">
<title>expert_2_8_0&#45;&gt;tp_2_8</title>
<path fill="none" stroke="black" d="M4869.43,-9614.08C4867.37,-9606.25 4864.95,-9597.09 4862.58,-9588.12"/>
<polygon fill="black" stroke="black" points="4865.89,-9586.94 4859.95,-9578.17 4859.12,-9588.73 4865.89,-9586.94"/>
</g>
<!-- expert_2_8_1&#45;&gt;tp_2_8 -->
<g id="edge226" class="edge">
<title>expert_2_8_1&#45;&gt;tp_2_8</title>
<path fill="none" stroke="black" d="M5093.02,-9614.08C5047.19,-9601.53 4988.84,-9585.54 4941.04,-9572.45"/>
<polygon fill="black" stroke="black" points="4941.88,-9569.05 4931.31,-9569.78 4940.03,-9575.8 4941.88,-9569.05"/>
</g>
<!-- tp_2_8&#45;&gt;q_proj_3 -->
<g id="edge1500" class="edge">
<title>tp_2_8&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M4811.42,-9517.77C4796.76,-9507.56 4780.26,-9496.06 4765.76,-9485.95"/>
<polygon fill="black" stroke="black" points="4767.69,-9483.03 4757.48,-9480.18 4763.68,-9488.77 4767.69,-9483.03"/>
</g>
<!-- tp_2_8&#45;&gt;k_proj_3 -->
<g id="edge1501" class="edge">
<title>tp_2_8&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M4908.96,-9519.8C4933.33,-9508.57 4961.68,-9495.5 4985.85,-9484.36"/>
<polygon fill="black" stroke="black" points="4987.62,-9487.4 4995.24,-9480.04 4984.69,-9481.04 4987.62,-9487.4"/>
</g>
<!-- tp_2_8&#45;&gt;v_proj_3 -->
<g id="edge1502" class="edge">
<title>tp_2_8&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M4768.77,-9525.31C4754.86,-9522.04 4740.54,-9518.8 4727,-9515.94 4668.57,-9503.61 4603.69,-9491.56 4548.13,-9481.74"/>
<polygon fill="black" stroke="black" points="4548.69,-9478.28 4538.23,-9480 4547.47,-9485.18 4548.69,-9478.28"/>
</g>
<!-- expert_2_9_0 -->
<g id="node188" class="node">
<title>expert_2_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5603.5,-9658.17 5326.5,-9658.17 5326.5,-9614.17 5603.5,-9614.17 5603.5,-9658.17"/>
<text text-anchor="middle" x="5465" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L2</text>
<text text-anchor="middle" x="5465" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 98</text>
<text text-anchor="middle" x="5465" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_9&#45;&gt;expert_2_9_0 -->
<g id="edge228" class="edge">
<title>route_2_9&#45;&gt;expert_2_9_0</title>
<path fill="none" stroke="black" d="M5465,-9693.81C5465,-9685.53 5465,-9676.56 5465,-9668.25"/>
<polygon fill="black" stroke="black" points="5468.5,-9668.17 5465,-9658.17 5461.5,-9668.17 5468.5,-9668.17"/>
</g>
<!-- expert_2_9_1 -->
<g id="node189" class="node">
<title>expert_2_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5898.5,-9658.17 5621.5,-9658.17 5621.5,-9614.17 5898.5,-9614.17 5898.5,-9658.17"/>
<text text-anchor="middle" x="5760" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L2</text>
<text text-anchor="middle" x="5760" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 99</text>
<text text-anchor="middle" x="5760" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5760" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_9&#45;&gt;expert_2_9_1 -->
<g id="edge229" class="edge">
<title>route_2_9&#45;&gt;expert_2_9_1</title>
<path fill="none" stroke="black" d="M5555.92,-9697.43C5595.08,-9685.87 5640.51,-9672.45 5678.56,-9661.22"/>
<polygon fill="black" stroke="black" points="5679.97,-9664.45 5688.57,-9658.26 5677.99,-9657.74 5679.97,-9664.45"/>
</g>
<!-- tp_2_9 -->
<g id="node190" class="node">
<title>tp_2_9</title>
<ellipse fill="lightblue" stroke="black" cx="5102" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5102" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L2</text>
<text text-anchor="middle" x="5102" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 98↔99</text>
<text text-anchor="middle" x="5102" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5102" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_9_0&#45;&gt;tp_2_9 -->
<g id="edge230" class="edge">
<title>expert_2_9_0&#45;&gt;tp_2_9</title>
<path fill="none" stroke="black" d="M5377.11,-9614.15C5332.2,-9603.4 5276.68,-9590.1 5227,-9578.17 5217.05,-9575.78 5206.65,-9573.28 5196.29,-9570.79"/>
<polygon fill="black" stroke="black" points="5196.92,-9567.34 5186.38,-9568.4 5195.28,-9574.14 5196.92,-9567.34"/>
</g>
<!-- expert_2_9_1&#45;&gt;tp_2_9 -->
<g id="edge231" class="edge">
<title>expert_2_9_1&#45;&gt;tp_2_9</title>
<path fill="none" stroke="black" d="M5621.14,-9615.15C5618.4,-9614.81 5615.69,-9614.49 5613,-9614.17 5441.89,-9593.98 5396.97,-9606.42 5227,-9578.17 5215.93,-9576.33 5204.39,-9574.05 5192.98,-9571.58"/>
<polygon fill="black" stroke="black" points="5193.54,-9568.11 5183.01,-9569.36 5192.02,-9574.95 5193.54,-9568.11"/>
</g>
<!-- tp_2_9&#45;&gt;q_proj_3 -->
<g id="edge1503" class="edge">
<title>tp_2_9&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M5017.65,-9525.59C5004.06,-9522.33 4990.15,-9519.03 4977,-9515.94 4928.85,-9504.65 4875.41,-9492.43 4830.33,-9482.21"/>
<polygon fill="black" stroke="black" points="4831.08,-9478.79 4820.55,-9479.99 4829.53,-9485.61 4831.08,-9478.79"/>
</g>
<!-- tp_2_9&#45;&gt;k_proj_3 -->
<g id="edge1504" class="edge">
<title>tp_2_9&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M5081.01,-9516.08C5074.74,-9507.13 5067.88,-9497.32 5061.63,-9488.41"/>
<polygon fill="black" stroke="black" points="5064.48,-9486.37 5055.87,-9480.18 5058.74,-9490.38 5064.48,-9486.37"/>
</g>
<!-- tp_2_9&#45;&gt;v_proj_3 -->
<g id="edge1505" class="edge">
<title>tp_2_9&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M5021,-9524.7C5006.42,-9521.38 4991.32,-9518.29 4977,-9515.94 4801.03,-9487.13 4752.24,-9499.52 4571.43,-9480.07"/>
<polygon fill="black" stroke="black" points="4571.63,-9476.57 4561.31,-9478.96 4570.87,-9483.53 4571.63,-9476.57"/>
</g>
<!-- expert_2_10_0 -->
<g id="node192" class="node">
<title>expert_2_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6193.5,-9658.17 5916.5,-9658.17 5916.5,-9614.17 6193.5,-9614.17 6193.5,-9658.17"/>
<text text-anchor="middle" x="6055" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L2</text>
<text text-anchor="middle" x="6055" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 100</text>
<text text-anchor="middle" x="6055" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_10&#45;&gt;expert_2_10_0 -->
<g id="edge233" class="edge">
<title>route_2_10&#45;&gt;expert_2_10_0</title>
<path fill="none" stroke="black" d="M6055,-9693.81C6055,-9685.53 6055,-9676.56 6055,-9668.25"/>
<polygon fill="black" stroke="black" points="6058.5,-9668.17 6055,-9658.17 6051.5,-9668.17 6058.5,-9668.17"/>
</g>
<!-- expert_2_10_1 -->
<g id="node193" class="node">
<title>expert_2_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-9658.17 6211.5,-9658.17 6211.5,-9614.17 6488.5,-9614.17 6488.5,-9658.17"/>
<text text-anchor="middle" x="6350" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L2</text>
<text text-anchor="middle" x="6350" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 101</text>
<text text-anchor="middle" x="6350" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6350" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_10&#45;&gt;expert_2_10_1 -->
<g id="edge234" class="edge">
<title>route_2_10&#45;&gt;expert_2_10_1</title>
<path fill="none" stroke="black" d="M6145.92,-9697.43C6185.08,-9685.87 6230.51,-9672.45 6268.56,-9661.22"/>
<polygon fill="black" stroke="black" points="6269.97,-9664.45 6278.57,-9658.26 6267.99,-9657.74 6269.97,-9664.45"/>
</g>
<!-- tp_2_10 -->
<g id="node194" class="node">
<title>tp_2_10</title>
<ellipse fill="lightblue" stroke="black" cx="5352" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5352" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L2</text>
<text text-anchor="middle" x="5352" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 100↔101</text>
<text text-anchor="middle" x="5352" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5352" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_10_0&#45;&gt;tp_2_10 -->
<g id="edge235" class="edge">
<title>expert_2_10_0&#45;&gt;tp_2_10</title>
<path fill="none" stroke="black" d="M5916.14,-9615.11C5913.41,-9614.79 5910.69,-9614.47 5908,-9614.17 5717,-9592.57 5666.77,-9608.77 5477,-9578.17 5465.92,-9576.38 5454.37,-9574.14 5442.97,-9571.68"/>
<polygon fill="black" stroke="black" points="5443.52,-9568.22 5433,-9569.47 5442,-9575.05 5443.52,-9568.22"/>
</g>
<!-- expert_2_10_1&#45;&gt;tp_2_10 -->
<g id="edge236" class="edge">
<title>expert_2_10_1&#45;&gt;tp_2_10</title>
<path fill="none" stroke="black" d="M6211.16,-9614.99C6208.42,-9614.7 6205.69,-9614.43 6203,-9614.17 5881.42,-9583.29 5796.77,-9624.2 5477,-9578.17 5465.52,-9576.52 5453.55,-9574.29 5441.77,-9571.8"/>
<polygon fill="black" stroke="black" points="5442.44,-9568.37 5431.93,-9569.65 5440.95,-9575.21 5442.44,-9568.37"/>
</g>
<!-- tp_2_10&#45;&gt;q_proj_3 -->
<g id="edge1506" class="edge">
<title>tp_2_10&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M5270.63,-9524.82C5256.16,-9521.51 5241.19,-9518.39 5227,-9515.94 5079.19,-9490.5 5037.96,-9497.77 4885.52,-9480.1"/>
<polygon fill="black" stroke="black" points="4885.66,-9476.59 4875.32,-9478.9 4884.84,-9483.54 4885.66,-9476.59"/>
</g>
<!-- tp_2_10&#45;&gt;k_proj_3 -->
<g id="edge1507" class="edge">
<title>tp_2_10&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M5273.52,-9524.07C5228.5,-9511.46 5171.95,-9495.62 5125.9,-9482.72"/>
<polygon fill="black" stroke="black" points="5126.81,-9479.34 5116.23,-9480.02 5124.92,-9486.08 5126.81,-9479.34"/>
</g>
<!-- tp_2_10&#45;&gt;v_proj_3 -->
<g id="edge1508" class="edge">
<title>tp_2_10&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M5271.73,-9524.45C5256.95,-9521.12 5241.58,-9518.08 5227,-9515.94 4940.9,-9474 4862.9,-9506.6 4571.32,-9480.02"/>
<polygon fill="black" stroke="black" points="4571.58,-9476.53 4561.3,-9479.09 4570.93,-9483.5 4571.58,-9476.53"/>
</g>
<!-- expert_2_11_0 -->
<g id="node196" class="node">
<title>expert_2_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6783.5,-9658.17 6506.5,-9658.17 6506.5,-9614.17 6783.5,-9614.17 6783.5,-9658.17"/>
<text text-anchor="middle" x="6645" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L2</text>
<text text-anchor="middle" x="6645" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 102</text>
<text text-anchor="middle" x="6645" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_11&#45;&gt;expert_2_11_0 -->
<g id="edge238" class="edge">
<title>route_2_11&#45;&gt;expert_2_11_0</title>
<path fill="none" stroke="black" d="M6645,-9693.81C6645,-9685.53 6645,-9676.56 6645,-9668.25"/>
<polygon fill="black" stroke="black" points="6648.5,-9668.17 6645,-9658.17 6641.5,-9668.17 6648.5,-9668.17"/>
</g>
<!-- expert_2_11_1 -->
<g id="node197" class="node">
<title>expert_2_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-9658.17 6801.5,-9658.17 6801.5,-9614.17 7078.5,-9614.17 7078.5,-9658.17"/>
<text text-anchor="middle" x="6940" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L2</text>
<text text-anchor="middle" x="6940" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 103</text>
<text text-anchor="middle" x="6940" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6940" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_11&#45;&gt;expert_2_11_1 -->
<g id="edge239" class="edge">
<title>route_2_11&#45;&gt;expert_2_11_1</title>
<path fill="none" stroke="black" d="M6735.92,-9697.43C6775.08,-9685.87 6820.51,-9672.45 6858.56,-9661.22"/>
<polygon fill="black" stroke="black" points="6859.97,-9664.45 6868.57,-9658.26 6857.99,-9657.74 6859.97,-9664.45"/>
</g>
<!-- tp_2_11 -->
<g id="node198" class="node">
<title>tp_2_11</title>
<ellipse fill="lightblue" stroke="black" cx="5602" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5602" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L2</text>
<text text-anchor="middle" x="5602" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 102↔103</text>
<text text-anchor="middle" x="5602" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5602" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_11_0&#45;&gt;tp_2_11 -->
<g id="edge240" class="edge">
<title>expert_2_11_0&#45;&gt;tp_2_11</title>
<path fill="none" stroke="black" d="M6506.16,-9614.98C6503.42,-9614.69 6500.69,-9614.42 6498,-9614.17 6156.48,-9581.88 6066.61,-9626.56 5727,-9578.17 5715.52,-9576.53 5703.55,-9574.32 5691.76,-9571.83"/>
<polygon fill="black" stroke="black" points="5692.44,-9568.4 5681.92,-9569.69 5690.94,-9575.24 5692.44,-9568.4"/>
</g>
<!-- expert_2_11_1&#45;&gt;tp_2_11 -->
<g id="edge241" class="edge">
<title>expert_2_11_1&#45;&gt;tp_2_11</title>
<path fill="none" stroke="black" d="M6801.16,-9614.93C6798.42,-9614.66 6795.7,-9614.41 6793,-9614.17 6320.78,-9572.59 6196.73,-9642.01 5727,-9578.17 5715.42,-9576.6 5703.35,-9574.41 5691.48,-9571.92"/>
<polygon fill="black" stroke="black" points="5692.08,-9568.47 5681.56,-9569.77 5690.59,-9575.31 5692.08,-9568.47"/>
</g>
<!-- tp_2_11&#45;&gt;q_proj_3 -->
<g id="edge1509" class="edge">
<title>tp_2_11&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M5521.72,-9524.52C5506.94,-9521.18 5491.57,-9518.12 5477,-9515.94 5219.18,-9477.37 5148.59,-9504.75 4885.54,-9480.05"/>
<polygon fill="black" stroke="black" points="4885.59,-9476.54 4875.3,-9479.07 4884.92,-9483.51 4885.59,-9476.54"/>
</g>
<!-- tp_2_11&#45;&gt;k_proj_3 -->
<g id="edge1510" class="edge">
<title>tp_2_11&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M5519.9,-9524.96C5505.65,-9521.68 5490.94,-9518.53 5477,-9515.94 5385.49,-9498.99 5282.25,-9485.25 5199.21,-9475.52"/>
<polygon fill="black" stroke="black" points="5199.53,-9472.03 5189.19,-9474.35 5198.72,-9478.99 5199.53,-9472.03"/>
</g>
<!-- tp_2_11&#45;&gt;v_proj_3 -->
<g id="edge1511" class="edge">
<title>tp_2_11&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M5522.43,-9524.42C5507.44,-9521.04 5491.81,-9518 5477,-9515.94 5080.73,-9460.89 4973.7,-9513.83 4571.46,-9480.02"/>
<polygon fill="black" stroke="black" points="4571.55,-9476.52 4561.29,-9479.15 4570.96,-9483.49 4571.55,-9476.52"/>
</g>
<!-- expert_2_12_0 -->
<g id="node200" class="node">
<title>expert_2_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7373.5,-9658.17 7096.5,-9658.17 7096.5,-9614.17 7373.5,-9614.17 7373.5,-9658.17"/>
<text text-anchor="middle" x="7235" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L2</text>
<text text-anchor="middle" x="7235" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 104</text>
<text text-anchor="middle" x="7235" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_12&#45;&gt;expert_2_12_0 -->
<g id="edge243" class="edge">
<title>route_2_12&#45;&gt;expert_2_12_0</title>
<path fill="none" stroke="black" d="M7235,-9693.81C7235,-9685.53 7235,-9676.56 7235,-9668.25"/>
<polygon fill="black" stroke="black" points="7238.5,-9668.17 7235,-9658.17 7231.5,-9668.17 7238.5,-9668.17"/>
</g>
<!-- expert_2_12_1 -->
<g id="node201" class="node">
<title>expert_2_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7668.5,-9658.17 7391.5,-9658.17 7391.5,-9614.17 7668.5,-9614.17 7668.5,-9658.17"/>
<text text-anchor="middle" x="7530" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L2</text>
<text text-anchor="middle" x="7530" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 105</text>
<text text-anchor="middle" x="7530" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7530" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_12&#45;&gt;expert_2_12_1 -->
<g id="edge244" class="edge">
<title>route_2_12&#45;&gt;expert_2_12_1</title>
<path fill="none" stroke="black" d="M7325.92,-9697.43C7365.08,-9685.87 7410.51,-9672.45 7448.56,-9661.22"/>
<polygon fill="black" stroke="black" points="7449.97,-9664.45 7458.57,-9658.26 7447.99,-9657.74 7449.97,-9664.45"/>
</g>
<!-- tp_2_12 -->
<g id="node202" class="node">
<title>tp_2_12</title>
<ellipse fill="lightblue" stroke="black" cx="5852" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5852" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L2</text>
<text text-anchor="middle" x="5852" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 104↔105</text>
<text text-anchor="middle" x="5852" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5852" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_12_0&#45;&gt;tp_2_12 -->
<g id="edge245" class="edge">
<title>expert_2_12_0&#45;&gt;tp_2_12</title>
<path fill="none" stroke="black" d="M7096.16,-9614.92C7093.42,-9614.66 7090.7,-9614.4 7088,-9614.17 6595.84,-9571.17 6466.58,-9644.37 5977,-9578.17 5965.42,-9576.6 5953.35,-9574.42 5941.48,-9571.93"/>
<polygon fill="black" stroke="black" points="5942.08,-9568.48 5931.56,-9569.78 5940.59,-9575.32 5942.08,-9568.48"/>
</g>
<!-- expert_2_12_1&#45;&gt;tp_2_12 -->
<g id="edge246" class="edge">
<title>expert_2_12_1&#45;&gt;tp_2_12</title>
<path fill="none" stroke="black" d="M7391.16,-9614.9C7388.42,-9614.64 7385.7,-9614.4 7383,-9614.17 6760.1,-9561.88 6596.74,-9659.82 5977,-9578.17 5965.33,-9576.63 5953.16,-9574.45 5941.2,-9571.95"/>
<polygon fill="black" stroke="black" points="5941.73,-9568.49 5931.21,-9569.79 5940.25,-9575.33 5941.73,-9568.49"/>
</g>
<!-- tp_2_12&#45;&gt;q_proj_3 -->
<g id="edge1512" class="edge">
<title>tp_2_12&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M5772.09,-9524.38C5757.2,-9521.03 5741.7,-9518.01 5727,-9515.94 5358.9,-9464.24 5259.31,-9511.98 4885.31,-9480.01"/>
<polygon fill="black" stroke="black" points="4885.56,-9476.52 4875.29,-9479.14 4884.95,-9483.49 4885.56,-9476.52"/>
</g>
<!-- tp_2_12&#45;&gt;k_proj_3 -->
<g id="edge1513" class="edge">
<title>tp_2_12&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M5771.01,-9524.63C5756.43,-9521.33 5741.32,-9518.25 5727,-9515.94 5547.58,-9487.05 5339.25,-9472.37 5199.68,-9465.21"/>
<polygon fill="black" stroke="black" points="5199.49,-9461.7 5189.33,-9464.69 5199.14,-9468.69 5199.49,-9461.7"/>
</g>
<!-- tp_2_12&#45;&gt;v_proj_3 -->
<g id="edge1514" class="edge">
<title>tp_2_12&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M5772.44,-9524.31C5757.45,-9520.95 5741.82,-9517.94 5727,-9515.94 5220.48,-9447.79 5084.53,-9521.12 4571.55,-9480.02"/>
<polygon fill="black" stroke="black" points="4571.54,-9476.51 4561.29,-9479.19 4570.97,-9483.49 4571.54,-9476.51"/>
</g>
<!-- expert_2_13_0 -->
<g id="node204" class="node">
<title>expert_2_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7963.5,-9658.17 7686.5,-9658.17 7686.5,-9614.17 7963.5,-9614.17 7963.5,-9658.17"/>
<text text-anchor="middle" x="7825" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L2</text>
<text text-anchor="middle" x="7825" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 106</text>
<text text-anchor="middle" x="7825" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_13&#45;&gt;expert_2_13_0 -->
<g id="edge248" class="edge">
<title>route_2_13&#45;&gt;expert_2_13_0</title>
<path fill="none" stroke="black" d="M7825,-9693.81C7825,-9685.53 7825,-9676.56 7825,-9668.25"/>
<polygon fill="black" stroke="black" points="7828.5,-9668.17 7825,-9658.17 7821.5,-9668.17 7828.5,-9668.17"/>
</g>
<!-- expert_2_13_1 -->
<g id="node205" class="node">
<title>expert_2_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8258.5,-9658.17 7981.5,-9658.17 7981.5,-9614.17 8258.5,-9614.17 8258.5,-9658.17"/>
<text text-anchor="middle" x="8120" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L2</text>
<text text-anchor="middle" x="8120" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 107</text>
<text text-anchor="middle" x="8120" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8120" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_13&#45;&gt;expert_2_13_1 -->
<g id="edge249" class="edge">
<title>route_2_13&#45;&gt;expert_2_13_1</title>
<path fill="none" stroke="black" d="M7915.92,-9697.43C7955.08,-9685.87 8000.51,-9672.45 8038.56,-9661.22"/>
<polygon fill="black" stroke="black" points="8039.97,-9664.45 8048.57,-9658.26 8037.99,-9657.74 8039.97,-9664.45"/>
</g>
<!-- tp_2_13 -->
<g id="node206" class="node">
<title>tp_2_13</title>
<ellipse fill="lightblue" stroke="black" cx="6102" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6102" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L2</text>
<text text-anchor="middle" x="6102" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 106↔107</text>
<text text-anchor="middle" x="6102" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6102" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_13_0&#45;&gt;tp_2_13 -->
<g id="edge250" class="edge">
<title>expert_2_13_0&#45;&gt;tp_2_13</title>
<path fill="none" stroke="black" d="M7686.16,-9614.89C7683.42,-9614.64 7680.7,-9614.39 7678,-9614.17 7035.15,-9560.46 6866.59,-9662.18 6227,-9578.17 6215.33,-9576.64 6203.16,-9574.46 6191.2,-9571.96"/>
<polygon fill="black" stroke="black" points="6191.73,-9568.5 6181.21,-9569.8 6190.25,-9575.34 6191.73,-9568.5"/>
</g>
<!-- expert_2_13_1&#45;&gt;tp_2_13 -->
<g id="edge251" class="edge">
<title>expert_2_13_1&#45;&gt;tp_2_13</title>
<path fill="none" stroke="black" d="M7981.17,-9614.88C7978.42,-9614.63 7975.7,-9614.39 7973,-9614.17 7586.2,-9582.67 6611.88,-9627.9 6227,-9578.17 6215.33,-9576.66 6203.16,-9574.5 6191.19,-9572.01"/>
<polygon fill="black" stroke="black" points="6191.72,-9568.54 6181.21,-9569.85 6190.24,-9575.38 6191.72,-9568.54"/>
</g>
<!-- tp_2_13&#45;&gt;q_proj_3 -->
<g id="edge1515" class="edge">
<title>tp_2_13&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M6022.44,-9524.34C6007.45,-9520.97 5991.82,-9517.95 5977,-9515.94 5498.65,-9451.14 5370.12,-9519.27 4885.35,-9480.01"/>
<polygon fill="black" stroke="black" points="4885.54,-9476.51 4875.29,-9479.18 4884.97,-9483.49 4885.54,-9476.51"/>
</g>
<!-- tp_2_13&#45;&gt;k_proj_3 -->
<g id="edge1516" class="edge">
<title>tp_2_13&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M6021.72,-9524.52C6006.94,-9521.18 5991.57,-9518.12 5977,-9515.94 5705.86,-9475.35 5386.41,-9463.5 5199.54,-9460.14"/>
<polygon fill="black" stroke="black" points="5199.42,-9456.64 5189.36,-9459.96 5199.3,-9463.64 5199.42,-9456.64"/>
</g>
<!-- tp_2_13&#45;&gt;v_proj_3 -->
<g id="edge1517" class="edge">
<title>tp_2_13&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M6022.79,-9524.32C6007.69,-9520.94 5991.94,-9517.91 5977,-9515.94 5360.15,-9434.68 5195.34,-9528.46 4571.44,-9480.01"/>
<polygon fill="black" stroke="black" points="4571.53,-9476.5 4561.29,-9479.21 4570.98,-9483.48 4571.53,-9476.5"/>
</g>
<!-- expert_2_14_0 -->
<g id="node208" class="node">
<title>expert_2_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8553.5,-9658.17 8276.5,-9658.17 8276.5,-9614.17 8553.5,-9614.17 8553.5,-9658.17"/>
<text text-anchor="middle" x="8415" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L2</text>
<text text-anchor="middle" x="8415" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 108</text>
<text text-anchor="middle" x="8415" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_14&#45;&gt;expert_2_14_0 -->
<g id="edge253" class="edge">
<title>route_2_14&#45;&gt;expert_2_14_0</title>
<path fill="none" stroke="black" d="M8415,-9693.81C8415,-9685.53 8415,-9676.56 8415,-9668.25"/>
<polygon fill="black" stroke="black" points="8418.5,-9668.17 8415,-9658.17 8411.5,-9668.17 8418.5,-9668.17"/>
</g>
<!-- expert_2_14_1 -->
<g id="node209" class="node">
<title>expert_2_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8848.5,-9658.17 8571.5,-9658.17 8571.5,-9614.17 8848.5,-9614.17 8848.5,-9658.17"/>
<text text-anchor="middle" x="8710" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L2</text>
<text text-anchor="middle" x="8710" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 109</text>
<text text-anchor="middle" x="8710" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8710" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_14&#45;&gt;expert_2_14_1 -->
<g id="edge254" class="edge">
<title>route_2_14&#45;&gt;expert_2_14_1</title>
<path fill="none" stroke="black" d="M8505.92,-9697.43C8545.08,-9685.87 8590.51,-9672.45 8628.56,-9661.22"/>
<polygon fill="black" stroke="black" points="8629.97,-9664.45 8638.57,-9658.26 8627.99,-9657.74 8629.97,-9664.45"/>
</g>
<!-- tp_2_14 -->
<g id="node210" class="node">
<title>tp_2_14</title>
<ellipse fill="lightblue" stroke="black" cx="6352" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6352" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L2</text>
<text text-anchor="middle" x="6352" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 108↔109</text>
<text text-anchor="middle" x="6352" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6352" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_14_0&#45;&gt;tp_2_14 -->
<g id="edge255" class="edge">
<title>expert_2_14_0&#45;&gt;tp_2_14</title>
<path fill="none" stroke="black" d="M8276.17,-9614.88C8273.42,-9614.62 8270.7,-9614.39 8268,-9614.17 7871.22,-9581.96 6871.81,-9629.08 6477,-9578.17 6465.33,-9576.66 6453.16,-9574.5 6441.19,-9572.01"/>
<polygon fill="black" stroke="black" points="6441.72,-9568.55 6431.21,-9569.86 6440.24,-9575.39 6441.72,-9568.55"/>
</g>
<!-- expert_2_14_1&#45;&gt;tp_2_14 -->
<g id="edge256" class="edge">
<title>expert_2_14_1&#45;&gt;tp_2_14</title>
<path fill="none" stroke="black" d="M8571.17,-9614.87C8568.42,-9614.62 8565.7,-9614.38 8563,-9614.17 8100.84,-9577.31 6936.9,-9636.81 6477,-9578.17 6465.32,-9576.68 6453.15,-9574.53 6441.19,-9572.05"/>
<polygon fill="black" stroke="black" points="6441.71,-9568.58 6431.2,-9569.89 6440.24,-9575.42 6441.71,-9568.58"/>
</g>
<!-- tp_2_14&#45;&gt;q_proj_3 -->
<g id="edge1518" class="edge">
<title>tp_2_14&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M6272.45,-9524.26C6257.45,-9520.9 6241.83,-9517.91 6227,-9515.94 5638.38,-9438.03 5480.96,-9526.59 4885.42,-9480.01"/>
<polygon fill="black" stroke="black" points="4885.53,-9476.51 4875.29,-9479.2 4884.98,-9483.48 4885.53,-9476.51"/>
</g>
<!-- tp_2_14&#45;&gt;k_proj_3 -->
<g id="edge1519" class="edge">
<title>tp_2_14&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M6272.08,-9524.44C6257.19,-9521.09 6241.69,-9518.05 6227,-9515.94 6033.37,-9488.22 5475.04,-9470.28 5199.15,-9462.85"/>
<polygon fill="black" stroke="black" points="5199.14,-9459.35 5189.05,-9462.58 5198.95,-9466.34 5199.14,-9459.35"/>
</g>
<!-- tp_2_14&#45;&gt;v_proj_3 -->
<g id="edge1520" class="edge">
<title>tp_2_14&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M6272.79,-9524.27C6257.7,-9520.89 6241.94,-9517.88 6227,-9515.94 5864.96,-9468.96 4953.42,-9507.71 4571.33,-9479.98"/>
<polygon fill="black" stroke="black" points="4571.52,-9476.48 4561.29,-9479.22 4571,-9483.46 4571.52,-9476.48"/>
</g>
<!-- expert_2_15_0 -->
<g id="node212" class="node">
<title>expert_2_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9143.5,-9658.17 8866.5,-9658.17 8866.5,-9614.17 9143.5,-9614.17 9143.5,-9658.17"/>
<text text-anchor="middle" x="9005" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L2</text>
<text text-anchor="middle" x="9005" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 110</text>
<text text-anchor="middle" x="9005" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_15&#45;&gt;expert_2_15_0 -->
<g id="edge258" class="edge">
<title>route_2_15&#45;&gt;expert_2_15_0</title>
<path fill="none" stroke="black" d="M9005,-9693.81C9005,-9685.53 9005,-9676.56 9005,-9668.25"/>
<polygon fill="black" stroke="black" points="9008.5,-9668.17 9005,-9658.17 9001.5,-9668.17 9008.5,-9668.17"/>
</g>
<!-- expert_2_15_1 -->
<g id="node213" class="node">
<title>expert_2_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9438.5,-9658.17 9161.5,-9658.17 9161.5,-9614.17 9438.5,-9614.17 9438.5,-9658.17"/>
<text text-anchor="middle" x="9300" y="-9648.97" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L2</text>
<text text-anchor="middle" x="9300" y="-9638.97" font-family="Times,serif" font-size="9.00">GPU: 111</text>
<text text-anchor="middle" x="9300" y="-9628.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9300" y="-9618.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_15&#45;&gt;expert_2_15_1 -->
<g id="edge259" class="edge">
<title>route_2_15&#45;&gt;expert_2_15_1</title>
<path fill="none" stroke="black" d="M9095.92,-9697.43C9135.08,-9685.87 9180.51,-9672.45 9218.56,-9661.22"/>
<polygon fill="black" stroke="black" points="9219.97,-9664.45 9228.57,-9658.26 9217.99,-9657.74 9219.97,-9664.45"/>
</g>
<!-- tp_2_15 -->
<g id="node214" class="node">
<title>tp_2_15</title>
<ellipse fill="lightblue" stroke="black" cx="6602" cy="-9547.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6602" y="-9559.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L2</text>
<text text-anchor="middle" x="6602" y="-9549.86" font-family="Times,serif" font-size="9.00">GPU: 110↔111</text>
<text text-anchor="middle" x="6602" y="-9539.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6602" y="-9529.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_15_0&#45;&gt;tp_2_15 -->
<g id="edge260" class="edge">
<title>expert_2_15_0&#45;&gt;tp_2_15</title>
<path fill="none" stroke="black" d="M8866.16,-9614.91C8863.42,-9614.65 8860.7,-9614.4 8858,-9614.17 8439.38,-9578.25 7138.95,-9556.11 6727.89,-9549.88"/>
<polygon fill="black" stroke="black" points="6727.8,-9546.38 6717.75,-9549.72 6727.7,-9553.37 6727.8,-9546.38"/>
</g>
<!-- expert_2_15_1&#45;&gt;tp_2_15 -->
<g id="edge261" class="edge">
<title>expert_2_15_1&#45;&gt;tp_2_15</title>
<path fill="none" stroke="black" d="M9161.16,-9614.9C9158.42,-9614.64 9155.7,-9614.4 9153,-9614.17 8673.93,-9573.88 7173.66,-9554.39 6728.03,-9549.38"/>
<polygon fill="black" stroke="black" points="6728.05,-9545.89 6718.02,-9549.27 6727.98,-9552.88 6728.05,-9545.89"/>
</g>
<!-- tp_2_15&#45;&gt;q_proj_3 -->
<g id="edge1521" class="edge">
<title>tp_2_15&#45;&gt;q_proj_3</title>
<path fill="none" stroke="black" d="M6522.79,-9524.28C6507.69,-9520.9 6491.94,-9517.89 6477,-9515.94 6129.13,-9470.64 5253.47,-9506.77 4885.49,-9479.99"/>
<polygon fill="black" stroke="black" points="4885.52,-9476.48 4875.29,-9479.22 4885,-9483.46 4885.52,-9476.48"/>
</g>
<!-- tp_2_15&#45;&gt;k_proj_3 -->
<g id="edge1522" class="edge">
<title>tp_2_15&#45;&gt;k_proj_3</title>
<path fill="none" stroke="black" d="M6522.43,-9524.42C6507.44,-9521.04 6491.81,-9518 6477,-9515.94 6234.51,-9482.26 5519.94,-9466.72 5199.56,-9461.3"/>
<polygon fill="black" stroke="black" points="5199.32,-9457.8 5189.27,-9461.13 5199.21,-9464.8 5199.32,-9457.8"/>
</g>
<!-- tp_2_15&#45;&gt;v_proj_3 -->
<g id="edge1523" class="edge">
<title>tp_2_15&#45;&gt;v_proj_3</title>
<path fill="none" stroke="black" d="M6522.8,-9524.24C6507.7,-9520.86 6491.94,-9517.86 6477,-9515.94 6059.88,-9462.41 5009.22,-9511.32 4571.51,-9479.99"/>
<polygon fill="black" stroke="black" points="4571.52,-9476.48 4561.29,-9479.24 4571,-9483.46 4571.52,-9476.48"/>
</g>
<!-- attn_scores_3 -->
<g id="node218" class="node">
<title>attn_scores_3</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-9399.94 4560.5,-9399.94 4560.5,-9355.94 4893.5,-9355.94 4893.5,-9399.94"/>
<text text-anchor="middle" x="4727" y="-9390.74" font-family="Times,serif" font-size="9.00">Attention Scores L3</text>
<text text-anchor="middle" x="4727" y="-9380.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4727" y="-9370.74" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-9360.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_3&#45;&gt;attn_scores_3 -->
<g id="edge262" class="edge">
<title>q_proj_3&#45;&gt;attn_scores_3</title>
<path fill="none" stroke="black" d="M4727,-9435.63C4727,-9427.74 4727,-9418.63 4727,-9410.05"/>
<polygon fill="black" stroke="black" points="4730.5,-9409.96 4727,-9399.96 4723.5,-9409.96 4730.5,-9409.96"/>
</g>
<!-- k_proj_3&#45;&gt;attn_scores_3 -->
<g id="edge263" class="edge">
<title>k_proj_3&#45;&gt;attn_scores_3</title>
<path fill="none" stroke="black" d="M4956.44,-9435.94C4914.82,-9425.6 4864.49,-9413.1 4821.59,-9402.44"/>
<polygon fill="black" stroke="black" points="4822.26,-9399 4811.71,-9399.99 4820.57,-9405.79 4822.26,-9399"/>
</g>
<!-- v_proj_3&#45;&gt;attn_scores_3 -->
<g id="edge264" class="edge">
<title>v_proj_3&#45;&gt;attn_scores_3</title>
<path fill="none" stroke="black" d="M4497.56,-9435.94C4539.18,-9425.6 4589.51,-9413.1 4632.41,-9402.44"/>
<polygon fill="black" stroke="black" points="4633.43,-9405.79 4642.29,-9399.99 4631.74,-9399 4633.43,-9405.79"/>
</g>
<!-- softmax_3 -->
<g id="node219" class="node">
<title>softmax_3</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-9319.94 4560.5,-9319.94 4560.5,-9275.94 4893.5,-9275.94 4893.5,-9319.94"/>
<text text-anchor="middle" x="4727" y="-9310.74" font-family="Times,serif" font-size="9.00">Softmax L3</text>
<text text-anchor="middle" x="4727" y="-9300.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4727" y="-9290.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4727" y="-9280.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_3&#45;&gt;softmax_3 -->
<g id="edge265" class="edge">
<title>attn_scores_3&#45;&gt;softmax_3</title>
<path fill="none" stroke="black" d="M4727,-9355.63C4727,-9347.74 4727,-9338.63 4727,-9330.05"/>
<polygon fill="black" stroke="black" points="4730.5,-9329.96 4727,-9319.96 4723.5,-9329.96 4730.5,-9329.96"/>
</g>
<!-- attn_out_3 -->
<g id="node220" class="node">
<title>attn_out_3</title>
<polygon fill="lightgreen" stroke="black" points="4875,-9239.94 4579,-9239.94 4579,-9195.94 4875,-9195.94 4875,-9239.94"/>
<text text-anchor="middle" x="4727" y="-9230.74" font-family="Times,serif" font-size="9.00">Attention Output L3</text>
<text text-anchor="middle" x="4727" y="-9220.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="4727" y="-9210.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-9200.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_3&#45;&gt;attn_out_3 -->
<g id="edge266" class="edge">
<title>softmax_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M4727,-9275.63C4727,-9267.74 4727,-9258.63 4727,-9250.05"/>
<polygon fill="black" stroke="black" points="4730.5,-9249.96 4727,-9239.96 4723.5,-9249.96 4730.5,-9249.96"/>
</g>
<!-- gate_3 -->
<g id="node221" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="5026.74,-9159.94 4549.92,-9159.94 4427.26,-9071.94 4904.08,-9071.94 5026.74,-9159.94"/>
<text text-anchor="middle" x="4727" y="-9128.74" font-family="Times,serif" font-size="9.00">Gate L3</text>
<text text-anchor="middle" x="4727" y="-9118.74" font-family="Times,serif" font-size="9.00">GPU: 64&#45;127</text>
<text text-anchor="middle" x="4727" y="-9108.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-9098.74" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_3&#45;&gt;gate_3 -->
<g id="edge267" class="edge">
<title>attn_out_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M4727,-9195.74C4727,-9188.24 4727,-9179.43 4727,-9170.47"/>
<polygon fill="black" stroke="black" points="4730.5,-9170.35 4727,-9160.35 4723.5,-9170.35 4730.5,-9170.35"/>
</g>
<!-- route_3_0 -->
<g id="node222" class="node">
<title>route_3_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="450" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="450" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="450" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="450" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_0 -->
<g id="edge268" class="edge">
<title>gate_3&#45;&gt;route_3_0</title>
<path fill="none" stroke="black" d="M4487.09,-9114.98C3876.43,-9114.02 2213.63,-9104.73 830,-9035.94 764.75,-9032.7 693.32,-9027.48 630.17,-9022.29"/>
<polygon fill="black" stroke="black" points="630.36,-9018.79 620.11,-9021.46 629.79,-9025.77 630.36,-9018.79"/>
</g>
<!-- route_3_1 -->
<g id="node226" class="node">
<title>route_3_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1040" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1040" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 66,67</text>
<text text-anchor="middle" x="1040" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_1 -->
<g id="edge273" class="edge">
<title>gate_3&#45;&gt;route_3_1</title>
<path fill="none" stroke="black" d="M4485.4,-9113.74C3938.99,-9110.01 2566.53,-9095.02 1420,-9035.94 1354.91,-9032.59 1283.67,-9027.36 1220.63,-9022.19"/>
<polygon fill="black" stroke="black" points="1220.84,-9018.7 1210.59,-9021.37 1220.27,-9025.68 1220.84,-9018.7"/>
</g>
<!-- route_3_2 -->
<g id="node230" class="node">
<title>route_3_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1630" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1630" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 68,69</text>
<text text-anchor="middle" x="1630" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_2 -->
<g id="edge278" class="edge">
<title>gate_3&#45;&gt;route_3_2</title>
<path fill="none" stroke="black" d="M4482.82,-9111.93C4006.8,-9105.16 2921.5,-9085.28 2010,-9035.94 1945.08,-9032.43 1874.02,-9027.18 1811.1,-9022.04"/>
<polygon fill="black" stroke="black" points="1811.32,-9018.55 1801.07,-9021.22 1810.75,-9025.52 1811.32,-9018.55"/>
</g>
<!-- route_3_3 -->
<g id="node234" class="node">
<title>route_3_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2220" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2220" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 70,71</text>
<text text-anchor="middle" x="2220" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_3 -->
<g id="edge283" class="edge">
<title>gate_3&#45;&gt;route_3_3</title>
<path fill="none" stroke="black" d="M4478.78,-9109.1C4081.71,-9099 3279.24,-9075.45 2600,-9035.94 2535.41,-9032.19 2464.73,-9026.91 2402.03,-9021.82"/>
<polygon fill="black" stroke="black" points="2402.29,-9018.33 2392.04,-9021 2401.72,-9025.3 2402.29,-9018.33"/>
</g>
<!-- route_3_4 -->
<g id="node238" class="node">
<title>route_3_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2810" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2810" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 72,73</text>
<text text-anchor="middle" x="2810" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_4 -->
<g id="edge288" class="edge">
<title>gate_3&#45;&gt;route_3_4</title>
<path fill="none" stroke="black" d="M4471.91,-9104C4166.88,-9090.41 3640.93,-9065.39 3190,-9035.94 3126.04,-9031.77 3056.08,-9026.44 2993.82,-9021.43"/>
<polygon fill="black" stroke="black" points="2993.74,-9017.91 2983.49,-9020.6 2993.18,-9024.89 2993.74,-9017.91"/>
</g>
<!-- route_3_5 -->
<g id="node242" class="node">
<title>route_3_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3400" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 74,75</text>
<text text-anchor="middle" x="3400" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_5 -->
<g id="edge293" class="edge">
<title>gate_3&#45;&gt;route_3_5</title>
<path fill="none" stroke="black" d="M4456.06,-9092.67C4196.32,-9071.31 3811.23,-9039.64 3584.92,-9021.04"/>
<polygon fill="black" stroke="black" points="3585.18,-9017.55 3574.93,-9020.21 3584.61,-9024.52 3585.18,-9017.55"/>
</g>
<!-- route_3_6 -->
<g id="node246" class="node">
<title>route_3_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3990" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="3990" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 76,77</text>
<text text-anchor="middle" x="3990" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_6 -->
<g id="edge298" class="edge">
<title>gate_3&#45;&gt;route_3_6</title>
<path fill="none" stroke="black" d="M4436.51,-9071.94C4335.8,-9057.03 4226.94,-9040.91 4141.92,-9028.32"/>
<polygon fill="black" stroke="black" points="4142.34,-9024.85 4131.93,-9026.84 4141.31,-9031.77 4142.34,-9024.85"/>
</g>
<!-- route_3_7 -->
<g id="node250" class="node">
<title>route_3_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4518" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4518" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4518" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 78,79</text>
<text text-anchor="middle" x="4518" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4518" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_7 -->
<g id="edge303" class="edge">
<title>gate_3&#45;&gt;route_3_7</title>
<path fill="none" stroke="black" d="M4644.4,-9071.82C4623.91,-9061.12 4602.25,-9049.81 4582.75,-9039.64"/>
<polygon fill="black" stroke="black" points="4584.15,-9036.42 4573.67,-9034.89 4580.91,-9042.62 4584.15,-9036.42"/>
</g>
<!-- route_3_8 -->
<g id="node254" class="node">
<title>route_3_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4938" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4938" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4938" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="4938" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4938" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_8 -->
<g id="edge308" class="edge">
<title>gate_3&#45;&gt;route_3_8</title>
<path fill="none" stroke="black" d="M4810.39,-9071.82C4831.27,-9061.02 4853.36,-9049.6 4873.18,-9039.35"/>
<polygon fill="black" stroke="black" points="4874.84,-9042.43 4882.12,-9034.73 4871.63,-9036.21 4874.84,-9042.43"/>
</g>
<!-- route_3_9 -->
<g id="node258" class="node">
<title>route_3_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5465" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5465" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 98,99</text>
<text text-anchor="middle" x="5465" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_9 -->
<g id="edge313" class="edge">
<title>gate_3&#45;&gt;route_3_9</title>
<path fill="none" stroke="black" d="M4923.8,-9085.85C5045.76,-9067.81 5200.08,-9045 5312.69,-9028.35"/>
<polygon fill="black" stroke="black" points="5313.39,-9031.78 5322.77,-9026.86 5312.37,-9024.86 5313.39,-9031.78"/>
</g>
<!-- route_3_10 -->
<g id="node262" class="node">
<title>route_3_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6055" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6055" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 100,101</text>
<text text-anchor="middle" x="6055" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_10 -->
<g id="edge318" class="edge">
<title>gate_3&#45;&gt;route_3_10</title>
<path fill="none" stroke="black" d="M4940,-9097.44C5197.37,-9076.3 5626.14,-9041.07 5870.18,-9021.02"/>
<polygon fill="black" stroke="black" points="5870.54,-9024.5 5880.22,-9020.19 5869.96,-9017.52 5870.54,-9024.5"/>
</g>
<!-- route_3_11 -->
<g id="node266" class="node">
<title>route_3_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6645" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6645" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 102,103</text>
<text text-anchor="middle" x="6645" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_11 -->
<g id="edge323" class="edge">
<title>gate_3&#45;&gt;route_3_11</title>
<path fill="none" stroke="black" d="M4950.94,-9105.39C5250.44,-9092.17 5797.94,-9066.44 6265,-9035.94 6328.96,-9031.77 6398.92,-9026.44 6461.18,-9021.43"/>
<polygon fill="black" stroke="black" points="6461.82,-9024.89 6471.51,-9020.6 6461.26,-9017.91 6461.82,-9024.89"/>
</g>
<!-- route_3_12 -->
<g id="node270" class="node">
<title>route_3_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7235" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7235" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 104,105</text>
<text text-anchor="middle" x="7235" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_12 -->
<g id="edge328" class="edge">
<title>gate_3&#45;&gt;route_3_12</title>
<path fill="none" stroke="black" d="M4956.64,-9109.58C5346.94,-9099.75 6164.6,-9076.1 6855,-9035.94 6919.59,-9032.19 6990.27,-9026.91 7052.97,-9021.82"/>
<polygon fill="black" stroke="black" points="7053.28,-9025.3 7062.96,-9021 7052.71,-9018.33 7053.28,-9025.3"/>
</g>
<!-- route_3_13 -->
<g id="node274" class="node">
<title>route_3_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7825" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7825" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 106,107</text>
<text text-anchor="middle" x="7825" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_13 -->
<g id="edge333" class="edge">
<title>gate_3&#45;&gt;route_3_13</title>
<path fill="none" stroke="black" d="M4960.3,-9112.09C5430.62,-9105.48 6526.09,-9085.68 7445,-9035.94 7509.92,-9032.43 7580.98,-9027.18 7643.9,-9022.04"/>
<polygon fill="black" stroke="black" points="7644.25,-9025.52 7653.93,-9021.22 7643.68,-9018.55 7644.25,-9025.52"/>
</g>
<!-- route_3_14 -->
<g id="node278" class="node">
<title>route_3_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8415" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8415" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 108,109</text>
<text text-anchor="middle" x="8415" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_14 -->
<g id="edge338" class="edge">
<title>gate_3&#45;&gt;route_3_14</title>
<path fill="none" stroke="black" d="M4962.56,-9113.78C5504.95,-9110.12 6883.82,-9095.26 8035,-9035.94 8100.09,-9032.59 8171.33,-9027.36 8234.37,-9022.19"/>
<polygon fill="black" stroke="black" points="8234.73,-9025.68 8244.41,-9021.37 8234.16,-9018.7 8234.73,-9025.68"/>
</g>
<!-- route_3_15 -->
<g id="node282" class="node">
<title>route_3_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9005" cy="-9004.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-9017.63" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9005" y="-9007.63" font-family="Times,serif" font-size="9.00">GPU: 110,111</text>
<text text-anchor="middle" x="9005" y="-8997.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-8987.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_15 -->
<g id="edge343" class="edge">
<title>gate_3&#45;&gt;route_3_15</title>
<path fill="none" stroke="black" d="M4964.19,-9114.99C5572.71,-9114.06 7238.91,-9104.85 8625,-9035.94 8690.25,-9032.7 8761.68,-9027.48 8824.83,-9022.29"/>
<polygon fill="black" stroke="black" points="8825.21,-9025.77 8834.89,-9021.46 8824.64,-9018.79 8825.21,-9025.77"/>
</g>
<!-- expert_3_0_0 -->
<g id="node223" class="node">
<title>expert_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293.5,-8937.72 16.5,-8937.72 16.5,-8893.72 293.5,-8893.72 293.5,-8937.72"/>
<text text-anchor="middle" x="155" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L3</text>
<text text-anchor="middle" x="155" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="155" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_0&#45;&gt;expert_3_0_0 -->
<g id="edge269" class="edge">
<title>route_3_0&#45;&gt;expert_3_0_0</title>
<path fill="none" stroke="black" d="M359.08,-8976.98C319.92,-8965.42 274.49,-8952 236.44,-8940.77"/>
<polygon fill="black" stroke="black" points="237.01,-8937.29 226.43,-8937.81 235.03,-8944 237.01,-8937.29"/>
</g>
<!-- expert_3_0_1 -->
<g id="node224" class="node">
<title>expert_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="588.5,-8937.72 311.5,-8937.72 311.5,-8893.72 588.5,-8893.72 588.5,-8937.72"/>
<text text-anchor="middle" x="450" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L3</text>
<text text-anchor="middle" x="450" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="450" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_0&#45;&gt;expert_3_0_1 -->
<g id="edge270" class="edge">
<title>route_3_0&#45;&gt;expert_3_0_1</title>
<path fill="none" stroke="black" d="M450,-8973.36C450,-8965.08 450,-8956.11 450,-8947.8"/>
<polygon fill="black" stroke="black" points="453.5,-8947.72 450,-8937.72 446.5,-8947.72 453.5,-8947.72"/>
</g>
<!-- tp_3_0 -->
<g id="node225" class="node">
<title>tp_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="2852" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2852" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L3</text>
<text text-anchor="middle" x="2852" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="2852" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2852" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_0_0&#45;&gt;tp_3_0 -->
<g id="edge271" class="edge">
<title>expert_3_0_0&#45;&gt;tp_3_0</title>
<path fill="none" stroke="black" d="M293.84,-8894.45C296.58,-8894.19 299.3,-8893.95 302,-8893.72 780.88,-8853.44 2280.56,-8833.94 2726.02,-8828.93"/>
<polygon fill="black" stroke="black" points="2726.07,-8832.43 2736.03,-8828.82 2725.99,-8825.44 2726.07,-8832.43"/>
</g>
<!-- expert_3_0_1&#45;&gt;tp_3_0 -->
<g id="edge272" class="edge">
<title>expert_3_0_1&#45;&gt;tp_3_0</title>
<path fill="none" stroke="black" d="M588.6,-8894.57C591.76,-8894.27 594.9,-8893.98 598,-8893.72 1016.26,-8858.02 2315.54,-8835.74 2726.23,-8829.44"/>
<polygon fill="black" stroke="black" points="2726.41,-8832.94 2736.35,-8829.29 2726.3,-8825.94 2726.41,-8832.94"/>
</g>
<!-- q_proj_4 -->
<g id="node286" class="node">
<title>q_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="4561,-8748.49 4265,-8748.49 4265,-8704.49 4561,-8704.49 4561,-8748.49"/>
<text text-anchor="middle" x="4413" y="-8739.29" font-family="Times,serif" font-size="9.00">Q Projection L4</text>
<text text-anchor="middle" x="4413" y="-8729.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4413" y="-8719.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4413" y="-8709.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_3_0&#45;&gt;q_proj_4 -->
<g id="edge1524" class="edge">
<title>tp_3_0&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M2920.34,-8801.35C2938.53,-8795.84 2958.33,-8790.68 2977,-8787.49 3218.43,-8746.33 3933.98,-8733.02 4254.56,-8729.04"/>
<polygon fill="black" stroke="black" points="4254.9,-8732.54 4264.86,-8728.92 4254.82,-8725.54 4254.9,-8732.54"/>
</g>
<!-- k_proj_4 -->
<g id="node287" class="node">
<title>k_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="5189,-8748.49 4893,-8748.49 4893,-8704.49 5189,-8704.49 5189,-8748.49"/>
<text text-anchor="middle" x="5041" y="-8739.29" font-family="Times,serif" font-size="9.00">K Projection L4</text>
<text text-anchor="middle" x="5041" y="-8729.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="5041" y="-8719.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5041" y="-8709.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_3_0&#45;&gt;k_proj_4 -->
<g id="edge1525" class="edge">
<title>tp_3_0&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M2919.29,-8801.17C2937.75,-8795.55 2957.93,-8790.38 2977,-8787.49 3081.75,-8771.65 4779.44,-8796.58 4884,-8779.49 4917.1,-8774.08 4952.67,-8762.79 4981.58,-8752.1"/>
<polygon fill="black" stroke="black" points="4982.99,-8755.31 4991.11,-8748.51 4980.52,-8748.76 4982.99,-8755.31"/>
</g>
<!-- v_proj_4 -->
<g id="node288" class="node">
<title>v_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="4875,-8748.49 4579,-8748.49 4579,-8704.49 4875,-8704.49 4875,-8748.49"/>
<text text-anchor="middle" x="4727" y="-8739.29" font-family="Times,serif" font-size="9.00">V Projection L4</text>
<text text-anchor="middle" x="4727" y="-8729.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4727" y="-8719.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-8709.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_3_0&#45;&gt;v_proj_4 -->
<g id="edge1526" class="edge">
<title>tp_3_0&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M2919.29,-8801.18C2937.75,-8795.56 2957.93,-8790.38 2977,-8787.49 3064.5,-8774.22 4482.66,-8793.8 4570,-8779.49 4603.09,-8774.07 4638.67,-8762.77 4667.58,-8752.09"/>
<polygon fill="black" stroke="black" points="4668.99,-8755.3 4677.11,-8748.5 4666.52,-8748.75 4668.99,-8755.3"/>
</g>
<!-- expert_3_1_0 -->
<g id="node227" class="node">
<title>expert_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="883.5,-8937.72 606.5,-8937.72 606.5,-8893.72 883.5,-8893.72 883.5,-8937.72"/>
<text text-anchor="middle" x="745" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L3</text>
<text text-anchor="middle" x="745" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 66</text>
<text text-anchor="middle" x="745" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="745" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_1&#45;&gt;expert_3_1_0 -->
<g id="edge274" class="edge">
<title>route_3_1&#45;&gt;expert_3_1_0</title>
<path fill="none" stroke="black" d="M949.08,-8976.98C909.92,-8965.42 864.49,-8952 826.44,-8940.77"/>
<polygon fill="black" stroke="black" points="827.01,-8937.29 816.43,-8937.81 825.03,-8944 827.01,-8937.29"/>
</g>
<!-- expert_3_1_1 -->
<g id="node228" class="node">
<title>expert_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1178.5,-8937.72 901.5,-8937.72 901.5,-8893.72 1178.5,-8893.72 1178.5,-8937.72"/>
<text text-anchor="middle" x="1040" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L3</text>
<text text-anchor="middle" x="1040" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 67</text>
<text text-anchor="middle" x="1040" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_1&#45;&gt;expert_3_1_1 -->
<g id="edge275" class="edge">
<title>route_3_1&#45;&gt;expert_3_1_1</title>
<path fill="none" stroke="black" d="M1040,-8973.36C1040,-8965.08 1040,-8956.11 1040,-8947.8"/>
<polygon fill="black" stroke="black" points="1043.5,-8947.72 1040,-8937.72 1036.5,-8947.72 1043.5,-8947.72"/>
</g>
<!-- tp_3_1 -->
<g id="node229" class="node">
<title>tp_3_1</title>
<ellipse fill="lightblue" stroke="black" cx="3102" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3102" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L3</text>
<text text-anchor="middle" x="3102" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 66↔67</text>
<text text-anchor="middle" x="3102" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3102" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_1_0&#45;&gt;tp_3_1 -->
<g id="edge276" class="edge">
<title>expert_3_1_0&#45;&gt;tp_3_1</title>
<path fill="none" stroke="black" d="M883.59,-8894.52C886.76,-8894.23 889.9,-8893.96 893,-8893.72 1354.73,-8857.11 2517.54,-8916.31 2977,-8857.72 2988.68,-8856.23 3000.85,-8854.08 3012.81,-8851.59"/>
<polygon fill="black" stroke="black" points="3013.76,-8854.97 3022.8,-8849.44 3012.29,-8848.13 3013.76,-8854.97"/>
</g>
<!-- expert_3_1_1&#45;&gt;tp_3_1 -->
<g id="edge277" class="edge">
<title>expert_3_1_1&#45;&gt;tp_3_1</title>
<path fill="none" stroke="black" d="M1178.6,-8894.54C1181.76,-8894.24 1184.9,-8893.97 1188,-8893.72 1584.35,-8861.73 2582.63,-8908.58 2977,-8857.72 2988.67,-8856.21 3000.84,-8854.05 3012.81,-8851.56"/>
<polygon fill="black" stroke="black" points="3013.76,-8854.94 3022.79,-8849.41 3012.28,-8848.1 3013.76,-8854.94"/>
</g>
<!-- tp_3_1&#45;&gt;q_proj_4 -->
<g id="edge1527" class="edge">
<title>tp_3_1&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M3170.36,-8801.46C3188.55,-8795.95 3208.34,-8790.76 3227,-8787.49 3419.7,-8753.77 3978.48,-8737.07 4254.67,-8730.69"/>
<polygon fill="black" stroke="black" points="4254.86,-8734.19 4264.77,-8730.46 4254.7,-8727.19 4254.86,-8734.19"/>
</g>
<!-- tp_3_1&#45;&gt;k_proj_4 -->
<g id="edge1528" class="edge">
<title>tp_3_1&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M3169.29,-8801.18C3187.75,-8795.55 3207.93,-8790.38 3227,-8787.49 3318.02,-8773.7 4793.15,-8794.37 4884,-8779.49 4917.1,-8774.07 4952.67,-8762.77 4981.58,-8752.09"/>
<polygon fill="black" stroke="black" points="4982.99,-8755.3 4991.11,-8748.5 4980.52,-8748.75 4982.99,-8755.3"/>
</g>
<!-- tp_3_1&#45;&gt;v_proj_4 -->
<g id="edge1529" class="edge">
<title>tp_3_1&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M3169.29,-8801.19C3187.75,-8795.57 3207.93,-8790.39 3227,-8787.49 3300.76,-8776.27 4496.38,-8791.59 4570,-8779.49 4602.96,-8774.07 4638.39,-8762.84 4667.24,-8752.2"/>
<polygon fill="black" stroke="black" points="4668.63,-8755.41 4676.76,-8748.62 4666.16,-8748.86 4668.63,-8755.41"/>
</g>
<!-- expert_3_2_0 -->
<g id="node231" class="node">
<title>expert_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-8937.72 1196.5,-8937.72 1196.5,-8893.72 1473.5,-8893.72 1473.5,-8937.72"/>
<text text-anchor="middle" x="1335" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L3</text>
<text text-anchor="middle" x="1335" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 68</text>
<text text-anchor="middle" x="1335" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1335" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_2&#45;&gt;expert_3_2_0 -->
<g id="edge279" class="edge">
<title>route_3_2&#45;&gt;expert_3_2_0</title>
<path fill="none" stroke="black" d="M1539.08,-8976.98C1499.92,-8965.42 1454.49,-8952 1416.44,-8940.77"/>
<polygon fill="black" stroke="black" points="1417.01,-8937.29 1406.43,-8937.81 1415.03,-8944 1417.01,-8937.29"/>
</g>
<!-- expert_3_2_1 -->
<g id="node232" class="node">
<title>expert_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1768.5,-8937.72 1491.5,-8937.72 1491.5,-8893.72 1768.5,-8893.72 1768.5,-8937.72"/>
<text text-anchor="middle" x="1630" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L3</text>
<text text-anchor="middle" x="1630" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 69</text>
<text text-anchor="middle" x="1630" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_2&#45;&gt;expert_3_2_1 -->
<g id="edge280" class="edge">
<title>route_3_2&#45;&gt;expert_3_2_1</title>
<path fill="none" stroke="black" d="M1630,-8973.36C1630,-8965.08 1630,-8956.11 1630,-8947.8"/>
<polygon fill="black" stroke="black" points="1633.5,-8947.72 1630,-8937.72 1626.5,-8947.72 1633.5,-8947.72"/>
</g>
<!-- tp_3_2 -->
<g id="node233" class="node">
<title>tp_3_2</title>
<ellipse fill="lightblue" stroke="black" cx="3352" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3352" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L3</text>
<text text-anchor="middle" x="3352" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 68↔69</text>
<text text-anchor="middle" x="3352" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3352" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_2_0&#45;&gt;tp_3_2 -->
<g id="edge281" class="edge">
<title>expert_3_2_0&#45;&gt;tp_3_2</title>
<path fill="none" stroke="black" d="M1473.6,-8894.54C1476.76,-8894.24 1479.9,-8893.97 1483,-8893.72 1869.37,-8862.43 2842.56,-8907.4 3227,-8857.72 3238.67,-8856.21 3250.84,-8854.04 3262.81,-8851.56"/>
<polygon fill="black" stroke="black" points="3263.76,-8854.93 3272.79,-8849.4 3262.28,-8848.09 3263.76,-8854.93"/>
</g>
<!-- expert_3_2_1&#45;&gt;tp_3_2 -->
<g id="edge282" class="edge">
<title>expert_3_2_1&#45;&gt;tp_3_2</title>
<path fill="none" stroke="black" d="M1768.6,-8894.56C1771.76,-8894.26 1774.9,-8893.98 1778,-8893.72 2419.99,-8840.38 2588.29,-8941.62 3227,-8857.72 3238.67,-8856.18 3250.84,-8854.01 3262.8,-8851.51"/>
<polygon fill="black" stroke="black" points="3263.75,-8854.89 3272.79,-8849.35 3262.27,-8848.04 3263.75,-8854.89"/>
</g>
<!-- tp_3_2&#45;&gt;q_proj_4 -->
<g id="edge1530" class="edge">
<title>tp_3_2&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M3420.72,-8801.53C3438.82,-8796.06 3458.47,-8790.86 3477,-8787.49 3621.64,-8761.18 4027.9,-8742.13 4254.76,-8733.2"/>
<polygon fill="black" stroke="black" points="4254.9,-8736.69 4264.76,-8732.8 4254.63,-8729.7 4254.9,-8736.69"/>
</g>
<!-- tp_3_2&#45;&gt;k_proj_4 -->
<g id="edge1531" class="edge">
<title>tp_3_2&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M3419.29,-8801.19C3437.75,-8795.57 3457.93,-8790.39 3477,-8787.49 3554.28,-8775.75 4806.87,-8792.16 4884,-8779.49 4916.97,-8774.08 4952.4,-8762.85 4981.24,-8752.2"/>
<polygon fill="black" stroke="black" points="4982.63,-8755.42 4990.76,-8748.62 4980.17,-8748.87 4982.63,-8755.42"/>
</g>
<!-- tp_3_2&#45;&gt;v_proj_4 -->
<g id="edge1532" class="edge">
<title>tp_3_2&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M3419.29,-8801.21C3437.75,-8795.59 3457.94,-8790.41 3477,-8787.49 3597.05,-8769.15 4450.17,-8799.27 4570,-8779.49 4602.96,-8774.05 4638.39,-8762.82 4667.24,-8752.18"/>
<polygon fill="black" stroke="black" points="4668.62,-8755.39 4676.75,-8748.6 4666.16,-8748.84 4668.62,-8755.39"/>
</g>
<!-- expert_3_3_0 -->
<g id="node235" class="node">
<title>expert_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-8937.72 1786.5,-8937.72 1786.5,-8893.72 2063.5,-8893.72 2063.5,-8937.72"/>
<text text-anchor="middle" x="1925" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L3</text>
<text text-anchor="middle" x="1925" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 70</text>
<text text-anchor="middle" x="1925" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1925" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_3&#45;&gt;expert_3_3_0 -->
<g id="edge284" class="edge">
<title>route_3_3&#45;&gt;expert_3_3_0</title>
<path fill="none" stroke="black" d="M2129.08,-8976.98C2089.92,-8965.42 2044.49,-8952 2006.44,-8940.77"/>
<polygon fill="black" stroke="black" points="2007.01,-8937.29 1996.43,-8937.81 2005.03,-8944 2007.01,-8937.29"/>
</g>
<!-- expert_3_3_1 -->
<g id="node236" class="node">
<title>expert_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2358.5,-8937.72 2081.5,-8937.72 2081.5,-8893.72 2358.5,-8893.72 2358.5,-8937.72"/>
<text text-anchor="middle" x="2220" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L3</text>
<text text-anchor="middle" x="2220" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 71</text>
<text text-anchor="middle" x="2220" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_3&#45;&gt;expert_3_3_1 -->
<g id="edge285" class="edge">
<title>route_3_3&#45;&gt;expert_3_3_1</title>
<path fill="none" stroke="black" d="M2220,-8973.36C2220,-8965.08 2220,-8956.11 2220,-8947.8"/>
<polygon fill="black" stroke="black" points="2223.5,-8947.72 2220,-8937.72 2216.5,-8947.72 2223.5,-8947.72"/>
</g>
<!-- tp_3_3 -->
<g id="node237" class="node">
<title>tp_3_3</title>
<ellipse fill="lightblue" stroke="black" cx="3602" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3602" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L3</text>
<text text-anchor="middle" x="3602" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 70↔71</text>
<text text-anchor="middle" x="3602" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3602" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_3_0&#45;&gt;tp_3_3 -->
<g id="edge286" class="edge">
<title>expert_3_3_0&#45;&gt;tp_3_3</title>
<path fill="none" stroke="black" d="M2063.6,-8894.56C2066.76,-8894.26 2069.9,-8893.98 2073,-8893.72 2695.04,-8841.79 2858.14,-8939.27 3477,-8857.72 3488.67,-8856.18 3500.84,-8854 3512.8,-8851.5"/>
<polygon fill="black" stroke="black" points="3513.75,-8854.88 3522.79,-8849.34 3512.27,-8848.04 3513.75,-8854.88"/>
</g>
<!-- expert_3_3_1&#45;&gt;tp_3_3 -->
<g id="edge287" class="edge">
<title>expert_3_3_1&#45;&gt;tp_3_3</title>
<path fill="none" stroke="black" d="M2358.6,-8894.59C2361.76,-8894.28 2364.9,-8893.99 2368,-8893.72 2859.3,-8851.02 2988.3,-8923.81 3477,-8857.72 3488.58,-8856.15 3500.65,-8853.97 3512.52,-8851.48"/>
<polygon fill="black" stroke="black" points="3513.41,-8854.87 3522.44,-8849.33 3511.92,-8848.03 3513.41,-8854.87"/>
</g>
<!-- tp_3_3&#45;&gt;q_proj_4 -->
<g id="edge1533" class="edge">
<title>tp_3_3&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M3671.43,-8801.63C3689.35,-8796.22 3708.74,-8791.04 3727,-8787.49 3905.76,-8752.82 4114.65,-8738.16 4254.53,-8731.98"/>
<polygon fill="black" stroke="black" points="4255.06,-8735.46 4264.9,-8731.53 4254.76,-8728.47 4255.06,-8735.46"/>
</g>
<!-- tp_3_3&#45;&gt;k_proj_4 -->
<g id="edge1534" class="edge">
<title>tp_3_3&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M3669.29,-8801.2C3687.75,-8795.58 3707.94,-8790.4 3727,-8787.49 3854.09,-8768.1 4757.15,-8800.4 4884,-8779.49 4916.96,-8774.06 4952.39,-8762.82 4981.24,-8752.18"/>
<polygon fill="black" stroke="black" points="4982.63,-8755.4 4990.75,-8748.61 4980.16,-8748.85 4982.63,-8755.4"/>
</g>
<!-- tp_3_3&#45;&gt;v_proj_4 -->
<g id="edge1535" class="edge">
<title>tp_3_3&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M3669.3,-8801.23C3687.76,-8795.61 3707.94,-8790.43 3727,-8787.49 3819.58,-8773.24 4477.6,-8794.85 4570,-8779.49 4602.96,-8774.02 4638.38,-8762.78 4667.23,-8752.14"/>
<polygon fill="black" stroke="black" points="4668.62,-8755.36 4676.75,-8748.57 4666.16,-8748.81 4668.62,-8755.36"/>
</g>
<!-- expert_3_4_0 -->
<g id="node239" class="node">
<title>expert_3_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2653.5,-8937.72 2376.5,-8937.72 2376.5,-8893.72 2653.5,-8893.72 2653.5,-8937.72"/>
<text text-anchor="middle" x="2515" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L3</text>
<text text-anchor="middle" x="2515" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 72</text>
<text text-anchor="middle" x="2515" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2515" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_4&#45;&gt;expert_3_4_0 -->
<g id="edge289" class="edge">
<title>route_3_4&#45;&gt;expert_3_4_0</title>
<path fill="none" stroke="black" d="M2719.08,-8976.98C2679.92,-8965.42 2634.49,-8952 2596.44,-8940.77"/>
<polygon fill="black" stroke="black" points="2597.01,-8937.29 2586.43,-8937.81 2595.03,-8944 2597.01,-8937.29"/>
</g>
<!-- expert_3_4_1 -->
<g id="node240" class="node">
<title>expert_3_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2948.5,-8937.72 2671.5,-8937.72 2671.5,-8893.72 2948.5,-8893.72 2948.5,-8937.72"/>
<text text-anchor="middle" x="2810" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L3</text>
<text text-anchor="middle" x="2810" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 73</text>
<text text-anchor="middle" x="2810" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_4&#45;&gt;expert_3_4_1 -->
<g id="edge290" class="edge">
<title>route_3_4&#45;&gt;expert_3_4_1</title>
<path fill="none" stroke="black" d="M2810,-8973.36C2810,-8965.08 2810,-8956.11 2810,-8947.8"/>
<polygon fill="black" stroke="black" points="2813.5,-8947.72 2810,-8937.72 2806.5,-8947.72 2813.5,-8947.72"/>
</g>
<!-- tp_3_4 -->
<g id="node241" class="node">
<title>tp_3_4</title>
<ellipse fill="lightblue" stroke="black" cx="3852" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3852" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L3</text>
<text text-anchor="middle" x="3852" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 72↔73</text>
<text text-anchor="middle" x="3852" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3852" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_4_0&#45;&gt;tp_3_4 -->
<g id="edge291" class="edge">
<title>expert_3_4_0&#45;&gt;tp_3_4</title>
<path fill="none" stroke="black" d="M2653.6,-8894.59C2656.76,-8894.28 2659.9,-8893.99 2663,-8893.72 3134.35,-8852.42 3258.15,-8921.45 3727,-8857.72 3738.58,-8856.14 3750.65,-8853.96 3762.52,-8851.47"/>
<polygon fill="black" stroke="black" points="3763.41,-8854.86 3772.44,-8849.32 3761.92,-8848.02 3763.41,-8854.86"/>
</g>
<!-- expert_3_4_1&#45;&gt;tp_3_4 -->
<g id="edge292" class="edge">
<title>expert_3_4_1&#45;&gt;tp_3_4</title>
<path fill="none" stroke="black" d="M2948.6,-8894.65C2951.76,-8894.32 2954.9,-8894.01 2958,-8893.72 3298.65,-8861.65 3388.27,-8906 3727,-8857.72 3738.48,-8856.08 3750.45,-8853.87 3762.24,-8851.38"/>
<polygon fill="black" stroke="black" points="3763.06,-8854.79 3772.08,-8849.23 3761.56,-8847.95 3763.06,-8854.79"/>
</g>
<!-- tp_3_4&#45;&gt;q_proj_4 -->
<g id="edge1536" class="edge">
<title>tp_3_4&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M3922.87,-8801.86C3940.42,-8796.57 3959.27,-8791.39 3977,-8787.49 4068.16,-8767.46 4171.6,-8752.88 4254.84,-8743.11"/>
<polygon fill="black" stroke="black" points="4255.36,-8746.58 4264.89,-8741.95 4254.56,-8739.62 4255.36,-8746.58"/>
</g>
<!-- tp_3_4&#45;&gt;k_proj_4 -->
<g id="edge1537" class="edge">
<title>tp_3_4&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M3919.3,-8801.23C3937.75,-8795.61 3957.94,-8790.42 3977,-8787.49 4076.61,-8772.19 4784.58,-8795.98 4884,-8779.49 4916.96,-8774.03 4952.39,-8762.79 4981.23,-8752.15"/>
<polygon fill="black" stroke="black" points="4982.62,-8755.37 4990.75,-8748.58 4980.16,-8748.82 4982.62,-8755.37"/>
</g>
<!-- tp_3_4&#45;&gt;v_proj_4 -->
<g id="edge1538" class="edge">
<title>tp_3_4&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M3919.63,-8801.19C3938,-8795.6 3958.06,-8790.45 3977,-8787.49 4107.22,-8767.18 4440.04,-8801.36 4570,-8779.49 4602.94,-8773.95 4638.37,-8762.71 4667.22,-8752.09"/>
<polygon fill="black" stroke="black" points="4668.61,-8755.3 4676.74,-8748.52 4666.15,-8748.75 4668.61,-8755.3"/>
</g>
<!-- expert_3_5_0 -->
<g id="node243" class="node">
<title>expert_3_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3243.5,-8937.72 2966.5,-8937.72 2966.5,-8893.72 3243.5,-8893.72 3243.5,-8937.72"/>
<text text-anchor="middle" x="3105" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L3</text>
<text text-anchor="middle" x="3105" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 74</text>
<text text-anchor="middle" x="3105" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3105" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_5&#45;&gt;expert_3_5_0 -->
<g id="edge294" class="edge">
<title>route_3_5&#45;&gt;expert_3_5_0</title>
<path fill="none" stroke="black" d="M3309.08,-8976.98C3269.92,-8965.42 3224.49,-8952 3186.44,-8940.77"/>
<polygon fill="black" stroke="black" points="3187.01,-8937.29 3176.43,-8937.81 3185.03,-8944 3187.01,-8937.29"/>
</g>
<!-- expert_3_5_1 -->
<g id="node244" class="node">
<title>expert_3_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3538.5,-8937.72 3261.5,-8937.72 3261.5,-8893.72 3538.5,-8893.72 3538.5,-8937.72"/>
<text text-anchor="middle" x="3400" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L3</text>
<text text-anchor="middle" x="3400" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 75</text>
<text text-anchor="middle" x="3400" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_5&#45;&gt;expert_3_5_1 -->
<g id="edge295" class="edge">
<title>route_3_5&#45;&gt;expert_3_5_1</title>
<path fill="none" stroke="black" d="M3400,-8973.36C3400,-8965.08 3400,-8956.11 3400,-8947.8"/>
<polygon fill="black" stroke="black" points="3403.5,-8947.72 3400,-8937.72 3396.5,-8947.72 3403.5,-8947.72"/>
</g>
<!-- tp_3_5 -->
<g id="node245" class="node">
<title>tp_3_5</title>
<ellipse fill="lightblue" stroke="black" cx="4102" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4102" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L3</text>
<text text-anchor="middle" x="4102" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 74↔75</text>
<text text-anchor="middle" x="4102" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4102" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_5_0&#45;&gt;tp_3_5 -->
<g id="edge296" class="edge">
<title>expert_3_5_0&#45;&gt;tp_3_5</title>
<path fill="none" stroke="black" d="M3243.61,-8894.66C3246.77,-8894.33 3249.9,-8894.01 3253,-8893.72 3573.71,-8863.06 3658.11,-8903.65 3977,-8857.72 3988.48,-8856.06 4000.45,-8853.84 4012.23,-8851.35"/>
<polygon fill="black" stroke="black" points="4013.05,-8854.75 4022.07,-8849.2 4011.56,-8847.91 4013.05,-8854.75"/>
</g>
<!-- expert_3_5_1&#45;&gt;tp_3_5 -->
<g id="edge297" class="edge">
<title>expert_3_5_1&#45;&gt;tp_3_5</title>
<path fill="none" stroke="black" d="M3538.62,-8894.8C3541.78,-8894.43 3544.91,-8894.07 3548,-8893.72 3738.13,-8872.27 3788.11,-8888.21 3977,-8857.72 3988.08,-8855.93 3999.63,-8853.68 4011.03,-8851.23"/>
<polygon fill="black" stroke="black" points="4012,-8854.6 4021,-8849.02 4010.48,-8847.76 4012,-8854.6"/>
</g>
<!-- tp_3_5&#45;&gt;q_proj_4 -->
<g id="edge1539" class="edge">
<title>tp_3_5&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M4175.31,-8802.48C4223.88,-8787.16 4287.46,-8767.1 4336.65,-8751.58"/>
<polygon fill="black" stroke="black" points="4337.8,-8754.89 4346.28,-8748.54 4335.69,-8748.21 4337.8,-8754.89"/>
</g>
<!-- tp_3_5&#45;&gt;k_proj_4 -->
<g id="edge1540" class="edge">
<title>tp_3_5&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M4169.63,-8801.17C4188,-8795.59 4208.06,-8790.43 4227,-8787.49 4299.14,-8776.29 4812,-8791.56 4884,-8779.49 4916.95,-8773.97 4952.38,-8762.73 4981.23,-8752.1"/>
<polygon fill="black" stroke="black" points="4982.61,-8755.32 4990.74,-8748.53 4980.15,-8748.77 4982.61,-8755.32"/>
</g>
<!-- tp_3_5&#45;&gt;v_proj_4 -->
<g id="edge1541" class="edge">
<title>tp_3_5&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M4169.65,-8801.31C4188.02,-8795.73 4208.07,-8790.54 4227,-8787.49 4302.27,-8775.37 4494.88,-8792.51 4570,-8779.49 4602.79,-8773.81 4638.07,-8762.62 4666.86,-8752.06"/>
<polygon fill="black" stroke="black" points="4668.22,-8755.29 4676.37,-8748.52 4665.77,-8748.73 4668.22,-8755.29"/>
</g>
<!-- expert_3_6_0 -->
<g id="node247" class="node">
<title>expert_3_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3833.5,-8937.72 3556.5,-8937.72 3556.5,-8893.72 3833.5,-8893.72 3833.5,-8937.72"/>
<text text-anchor="middle" x="3695" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L3</text>
<text text-anchor="middle" x="3695" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 76</text>
<text text-anchor="middle" x="3695" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3695" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_6&#45;&gt;expert_3_6_0 -->
<g id="edge299" class="edge">
<title>route_3_6&#45;&gt;expert_3_6_0</title>
<path fill="none" stroke="black" d="M3899.08,-8976.98C3859.92,-8965.42 3814.49,-8952 3776.44,-8940.77"/>
<polygon fill="black" stroke="black" points="3777.01,-8937.29 3766.43,-8937.81 3775.03,-8944 3777.01,-8937.29"/>
</g>
<!-- expert_3_6_1 -->
<g id="node248" class="node">
<title>expert_3_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4128.5,-8937.72 3851.5,-8937.72 3851.5,-8893.72 4128.5,-8893.72 4128.5,-8937.72"/>
<text text-anchor="middle" x="3990" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L3</text>
<text text-anchor="middle" x="3990" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 77</text>
<text text-anchor="middle" x="3990" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_6&#45;&gt;expert_3_6_1 -->
<g id="edge300" class="edge">
<title>route_3_6&#45;&gt;expert_3_6_1</title>
<path fill="none" stroke="black" d="M3990,-8973.36C3990,-8965.08 3990,-8956.11 3990,-8947.8"/>
<polygon fill="black" stroke="black" points="3993.5,-8947.72 3990,-8937.72 3986.5,-8947.72 3993.5,-8947.72"/>
</g>
<!-- tp_3_6 -->
<g id="node249" class="node">
<title>tp_3_6</title>
<ellipse fill="lightblue" stroke="black" cx="4352" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4352" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L3</text>
<text text-anchor="middle" x="4352" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 76↔77</text>
<text text-anchor="middle" x="4352" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4352" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_6_0&#45;&gt;tp_3_6 -->
<g id="edge301" class="edge">
<title>expert_3_6_0&#45;&gt;tp_3_6</title>
<path fill="none" stroke="black" d="M3833.63,-8894.84C3836.78,-8894.46 3839.91,-8894.08 3843,-8893.72 4013.24,-8873.67 4057.91,-8885.86 4227,-8857.72 4238.07,-8855.88 4249.61,-8853.6 4261.02,-8851.12"/>
<polygon fill="black" stroke="black" points="4261.98,-8854.49 4270.98,-8848.9 4260.46,-8847.66 4261.98,-8854.49"/>
</g>
<!-- expert_3_6_1&#45;&gt;tp_3_6 -->
<g id="edge302" class="edge">
<title>expert_3_6_1&#45;&gt;tp_3_6</title>
<path fill="none" stroke="black" d="M4077.51,-8893.68C4122.24,-8882.92 4177.52,-8869.63 4227,-8857.72 4236.87,-8855.34 4247.17,-8852.86 4257.45,-8850.39"/>
<polygon fill="black" stroke="black" points="4258.38,-8853.76 4267.28,-8848.02 4256.74,-8846.96 4258.38,-8853.76"/>
</g>
<!-- tp_3_6&#45;&gt;q_proj_4 -->
<g id="edge1542" class="edge">
<title>tp_3_6&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M4370.63,-8795.64C4378.17,-8783.51 4386.86,-8769.54 4394.39,-8757.42"/>
<polygon fill="black" stroke="black" points="4397.59,-8758.91 4399.89,-8748.57 4391.64,-8755.22 4397.59,-8758.91"/>
</g>
<!-- tp_3_6&#45;&gt;k_proj_4 -->
<g id="edge1543" class="edge">
<title>tp_3_6&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M4419.64,-8801.27C4438.01,-8795.68 4458.07,-8790.51 4477,-8787.49 4566.34,-8773.28 4794.84,-8794.77 4884,-8779.49 4916.8,-8773.87 4952.08,-8762.68 4980.87,-8752.12"/>
<polygon fill="black" stroke="black" points="4982.23,-8755.35 4990.37,-8748.57 4979.78,-8748.79 4982.23,-8755.35"/>
</g>
<!-- tp_3_6&#45;&gt;v_proj_4 -->
<g id="edge1544" class="edge">
<title>tp_3_6&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M4421.43,-8801.61C4439.34,-8796.2 4458.73,-8791.02 4477,-8787.49 4517.73,-8779.62 4529.36,-8787.85 4570,-8779.49 4601.57,-8773 4635.65,-8762.2 4663.96,-8752.12"/>
<polygon fill="black" stroke="black" points="4665.5,-8755.29 4673.72,-8748.6 4663.12,-8748.7 4665.5,-8755.29"/>
</g>
<!-- expert_3_7_0 -->
<g id="node251" class="node">
<title>expert_3_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4423.5,-8937.72 4146.5,-8937.72 4146.5,-8893.72 4423.5,-8893.72 4423.5,-8937.72"/>
<text text-anchor="middle" x="4285" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L3</text>
<text text-anchor="middle" x="4285" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 78</text>
<text text-anchor="middle" x="4285" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4285" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_7&#45;&gt;expert_3_7_0 -->
<g id="edge304" class="edge">
<title>route_3_7&#45;&gt;expert_3_7_0</title>
<path fill="none" stroke="black" d="M4443.32,-8975.91C4413.66,-8964.82 4379.83,-8952.17 4351.08,-8941.42"/>
<polygon fill="black" stroke="black" points="4352.13,-8938.08 4341.54,-8937.86 4349.68,-8944.64 4352.13,-8938.08"/>
</g>
<!-- expert_3_7_1 -->
<g id="node252" class="node">
<title>expert_3_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4718.5,-8937.72 4441.5,-8937.72 4441.5,-8893.72 4718.5,-8893.72 4718.5,-8937.72"/>
<text text-anchor="middle" x="4580" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L3</text>
<text text-anchor="middle" x="4580" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 79</text>
<text text-anchor="middle" x="4580" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_7&#45;&gt;expert_3_7_1 -->
<g id="edge305" class="edge">
<title>route_3_7&#45;&gt;expert_3_7_1</title>
<path fill="none" stroke="black" d="M4539.34,-8973.85C4545.71,-8964.9 4552.68,-8955.1 4559.03,-8946.18"/>
<polygon fill="black" stroke="black" points="4561.94,-8948.14 4564.88,-8937.96 4556.23,-8944.08 4561.94,-8948.14"/>
</g>
<!-- tp_3_7 -->
<g id="node253" class="node">
<title>tp_3_7</title>
<ellipse fill="lightblue" stroke="black" cx="4602" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4602" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L3</text>
<text text-anchor="middle" x="4602" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 78↔79</text>
<text text-anchor="middle" x="4602" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4602" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_7_0&#45;&gt;tp_3_7 -->
<g id="edge306" class="edge">
<title>expert_3_7_0&#45;&gt;tp_3_7</title>
<path fill="none" stroke="black" d="M4361.74,-8893.63C4407.34,-8881.1 4465.37,-8865.15 4512.98,-8852.07"/>
<polygon fill="black" stroke="black" points="4513.94,-8855.43 4522.66,-8849.41 4512.09,-8848.68 4513.94,-8855.43"/>
</g>
<!-- expert_3_7_1&#45;&gt;tp_3_7 -->
<g id="edge307" class="edge">
<title>expert_3_7_1&#45;&gt;tp_3_7</title>
<path fill="none" stroke="black" d="M4585.33,-8893.63C4587.3,-8885.8 4589.62,-8876.64 4591.88,-8867.67"/>
<polygon fill="black" stroke="black" points="4595.34,-8868.27 4594.4,-8857.72 4588.55,-8866.56 4595.34,-8868.27"/>
</g>
<!-- tp_3_7&#45;&gt;q_proj_4 -->
<g id="edge1545" class="edge">
<title>tp_3_7&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M4550.1,-8798.67C4522.81,-8784.5 4489.52,-8767.21 4462.58,-8753.23"/>
<polygon fill="black" stroke="black" points="4464.19,-8750.12 4453.7,-8748.62 4460.96,-8756.33 4464.19,-8750.12"/>
</g>
<!-- tp_3_7&#45;&gt;k_proj_4 -->
<g id="edge1546" class="edge">
<title>tp_3_7&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M4670.36,-8801.46C4688.55,-8795.95 4708.34,-8790.76 4727,-8787.49 4795.82,-8775.44 4815.33,-8792.37 4884,-8779.49 4916.33,-8773.43 4951.16,-8762.38 4979.78,-8752.02"/>
<polygon fill="black" stroke="black" points="4981.06,-8755.28 4989.24,-8748.54 4978.64,-8748.71 4981.06,-8755.28"/>
</g>
<!-- tp_3_7&#45;&gt;v_proj_4 -->
<g id="edge1547" class="edge">
<title>tp_3_7&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M4638.49,-8796.96C4655.46,-8783.65 4675.54,-8767.88 4692.28,-8754.74"/>
<polygon fill="black" stroke="black" points="4694.5,-8757.45 4700.2,-8748.52 4690.18,-8751.95 4694.5,-8757.45"/>
</g>
<!-- expert_3_8_0 -->
<g id="node255" class="node">
<title>expert_3_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5013.5,-8937.72 4736.5,-8937.72 4736.5,-8893.72 5013.5,-8893.72 5013.5,-8937.72"/>
<text text-anchor="middle" x="4875" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L3</text>
<text text-anchor="middle" x="4875" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="4875" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4875" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_8&#45;&gt;expert_3_8_0 -->
<g id="edge309" class="edge">
<title>route_3_8&#45;&gt;expert_3_8_0</title>
<path fill="none" stroke="black" d="M4916.32,-8973.85C4909.85,-8964.9 4902.76,-8955.1 4896.31,-8946.18"/>
<polygon fill="black" stroke="black" points="4899.06,-8944.01 4890.36,-8937.96 4893.39,-8948.11 4899.06,-8944.01"/>
</g>
<!-- expert_3_8_1 -->
<g id="node256" class="node">
<title>expert_3_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5308.5,-8937.72 5031.5,-8937.72 5031.5,-8893.72 5308.5,-8893.72 5308.5,-8937.72"/>
<text text-anchor="middle" x="5170" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L3</text>
<text text-anchor="middle" x="5170" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="5170" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5170" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_8&#45;&gt;expert_3_8_1 -->
<g id="edge310" class="edge">
<title>route_3_8&#45;&gt;expert_3_8_1</title>
<path fill="none" stroke="black" d="M5012.36,-8975.91C5041.89,-8964.82 5075.58,-8952.17 5104.2,-8941.42"/>
<polygon fill="black" stroke="black" points="5105.57,-8944.65 5113.71,-8937.86 5103.11,-8938.09 5105.57,-8944.65"/>
</g>
<!-- tp_3_8 -->
<g id="node257" class="node">
<title>tp_3_8</title>
<ellipse fill="lightblue" stroke="black" cx="4852" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4852" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L3</text>
<text text-anchor="middle" x="4852" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="4852" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4852" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_8_0&#45;&gt;tp_3_8 -->
<g id="edge311" class="edge">
<title>expert_3_8_0&#45;&gt;tp_3_8</title>
<path fill="none" stroke="black" d="M4869.43,-8893.63C4867.37,-8885.8 4864.95,-8876.64 4862.58,-8867.67"/>
<polygon fill="black" stroke="black" points="4865.89,-8866.49 4859.95,-8857.72 4859.12,-8868.28 4865.89,-8866.49"/>
</g>
<!-- expert_3_8_1&#45;&gt;tp_3_8 -->
<g id="edge312" class="edge">
<title>expert_3_8_1&#45;&gt;tp_3_8</title>
<path fill="none" stroke="black" d="M5093.02,-8893.63C5047.19,-8881.08 4988.84,-8865.09 4941.04,-8852"/>
<polygon fill="black" stroke="black" points="4941.88,-8848.6 4931.31,-8849.33 4940.03,-8855.35 4941.88,-8848.6"/>
</g>
<!-- tp_3_8&#45;&gt;q_proj_4 -->
<g id="edge1548" class="edge">
<title>tp_3_8&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M4783.64,-8801.46C4765.45,-8795.95 4745.66,-8790.76 4727,-8787.49 4658.18,-8775.44 4638.67,-8792.37 4570,-8779.49 4537.67,-8773.43 4502.84,-8762.38 4474.22,-8752.02"/>
<polygon fill="black" stroke="black" points="4475.36,-8748.71 4464.76,-8748.54 4472.94,-8755.28 4475.36,-8748.71"/>
</g>
<!-- tp_3_8&#45;&gt;k_proj_4 -->
<g id="edge1549" class="edge">
<title>tp_3_8&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M4903.9,-8798.67C4931.19,-8784.5 4964.48,-8767.21 4991.42,-8753.23"/>
<polygon fill="black" stroke="black" points="4993.04,-8756.33 5000.3,-8748.62 4989.81,-8750.12 4993.04,-8756.33"/>
</g>
<!-- tp_3_8&#45;&gt;v_proj_4 -->
<g id="edge1550" class="edge">
<title>tp_3_8&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M4815.51,-8796.96C4798.54,-8783.65 4778.46,-8767.88 4761.72,-8754.74"/>
<polygon fill="black" stroke="black" points="4763.82,-8751.95 4753.8,-8748.52 4759.5,-8757.45 4763.82,-8751.95"/>
</g>
<!-- expert_3_9_0 -->
<g id="node259" class="node">
<title>expert_3_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5603.5,-8937.72 5326.5,-8937.72 5326.5,-8893.72 5603.5,-8893.72 5603.5,-8937.72"/>
<text text-anchor="middle" x="5465" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L3</text>
<text text-anchor="middle" x="5465" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 98</text>
<text text-anchor="middle" x="5465" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_9&#45;&gt;expert_3_9_0 -->
<g id="edge314" class="edge">
<title>route_3_9&#45;&gt;expert_3_9_0</title>
<path fill="none" stroke="black" d="M5465,-8973.36C5465,-8965.08 5465,-8956.11 5465,-8947.8"/>
<polygon fill="black" stroke="black" points="5468.5,-8947.72 5465,-8937.72 5461.5,-8947.72 5468.5,-8947.72"/>
</g>
<!-- expert_3_9_1 -->
<g id="node260" class="node">
<title>expert_3_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5898.5,-8937.72 5621.5,-8937.72 5621.5,-8893.72 5898.5,-8893.72 5898.5,-8937.72"/>
<text text-anchor="middle" x="5760" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L3</text>
<text text-anchor="middle" x="5760" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 99</text>
<text text-anchor="middle" x="5760" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5760" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_9&#45;&gt;expert_3_9_1 -->
<g id="edge315" class="edge">
<title>route_3_9&#45;&gt;expert_3_9_1</title>
<path fill="none" stroke="black" d="M5555.92,-8976.98C5595.08,-8965.42 5640.51,-8952 5678.56,-8940.77"/>
<polygon fill="black" stroke="black" points="5679.97,-8944 5688.57,-8937.81 5677.99,-8937.29 5679.97,-8944"/>
</g>
<!-- tp_3_9 -->
<g id="node261" class="node">
<title>tp_3_9</title>
<ellipse fill="lightblue" stroke="black" cx="5102" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5102" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L3</text>
<text text-anchor="middle" x="5102" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 98↔99</text>
<text text-anchor="middle" x="5102" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5102" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_9_0&#45;&gt;tp_3_9 -->
<g id="edge316" class="edge">
<title>expert_3_9_0&#45;&gt;tp_3_9</title>
<path fill="none" stroke="black" d="M5377.11,-8893.7C5332.2,-8882.95 5276.68,-8869.65 5227,-8857.72 5217.05,-8855.33 5206.65,-8852.83 5196.29,-8850.33"/>
<polygon fill="black" stroke="black" points="5196.92,-8846.89 5186.38,-8847.95 5195.28,-8853.69 5196.92,-8846.89"/>
</g>
<!-- expert_3_9_1&#45;&gt;tp_3_9 -->
<g id="edge317" class="edge">
<title>expert_3_9_1&#45;&gt;tp_3_9</title>
<path fill="none" stroke="black" d="M5621.14,-8894.7C5618.4,-8894.36 5615.69,-8894.04 5613,-8893.72 5441.89,-8873.53 5396.97,-8885.97 5227,-8857.72 5215.93,-8855.88 5204.39,-8853.6 5192.98,-8851.13"/>
<polygon fill="black" stroke="black" points="5193.54,-8847.66 5183.01,-8848.91 5192.02,-8854.5 5193.54,-8847.66"/>
</g>
<!-- tp_3_9&#45;&gt;q_proj_4 -->
<g id="edge1551" class="edge">
<title>tp_3_9&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M5034.36,-8801.27C5015.99,-8795.68 4995.93,-8790.51 4977,-8787.49 4887.66,-8773.28 4659.16,-8794.77 4570,-8779.49 4537.2,-8773.87 4501.92,-8762.68 4473.13,-8752.12"/>
<polygon fill="black" stroke="black" points="4474.22,-8748.79 4463.63,-8748.57 4471.77,-8755.35 4474.22,-8748.79"/>
</g>
<!-- tp_3_9&#45;&gt;k_proj_4 -->
<g id="edge1552" class="edge">
<title>tp_3_9&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M5083.37,-8795.64C5075.83,-8783.51 5067.14,-8769.54 5059.61,-8757.42"/>
<polygon fill="black" stroke="black" points="5062.36,-8755.22 5054.11,-8748.57 5056.41,-8758.91 5062.36,-8755.22"/>
</g>
<!-- tp_3_9&#45;&gt;v_proj_4 -->
<g id="edge1553" class="edge">
<title>tp_3_9&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M5032.57,-8801.61C5014.66,-8796.2 4995.27,-8791.02 4977,-8787.49 4936.27,-8779.62 4924.64,-8787.85 4884,-8779.49 4852.43,-8773 4818.35,-8762.2 4790.04,-8752.12"/>
<polygon fill="black" stroke="black" points="4790.88,-8748.7 4780.28,-8748.6 4788.5,-8755.29 4790.88,-8748.7"/>
</g>
<!-- expert_3_10_0 -->
<g id="node263" class="node">
<title>expert_3_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6193.5,-8937.72 5916.5,-8937.72 5916.5,-8893.72 6193.5,-8893.72 6193.5,-8937.72"/>
<text text-anchor="middle" x="6055" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L3</text>
<text text-anchor="middle" x="6055" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 100</text>
<text text-anchor="middle" x="6055" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_10&#45;&gt;expert_3_10_0 -->
<g id="edge319" class="edge">
<title>route_3_10&#45;&gt;expert_3_10_0</title>
<path fill="none" stroke="black" d="M6055,-8973.36C6055,-8965.08 6055,-8956.11 6055,-8947.8"/>
<polygon fill="black" stroke="black" points="6058.5,-8947.72 6055,-8937.72 6051.5,-8947.72 6058.5,-8947.72"/>
</g>
<!-- expert_3_10_1 -->
<g id="node264" class="node">
<title>expert_3_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-8937.72 6211.5,-8937.72 6211.5,-8893.72 6488.5,-8893.72 6488.5,-8937.72"/>
<text text-anchor="middle" x="6350" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L3</text>
<text text-anchor="middle" x="6350" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 101</text>
<text text-anchor="middle" x="6350" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6350" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_10&#45;&gt;expert_3_10_1 -->
<g id="edge320" class="edge">
<title>route_3_10&#45;&gt;expert_3_10_1</title>
<path fill="none" stroke="black" d="M6145.92,-8976.98C6185.08,-8965.42 6230.51,-8952 6268.56,-8940.77"/>
<polygon fill="black" stroke="black" points="6269.97,-8944 6278.57,-8937.81 6267.99,-8937.29 6269.97,-8944"/>
</g>
<!-- tp_3_10 -->
<g id="node265" class="node">
<title>tp_3_10</title>
<ellipse fill="lightblue" stroke="black" cx="5352" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5352" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L3</text>
<text text-anchor="middle" x="5352" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 100↔101</text>
<text text-anchor="middle" x="5352" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5352" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_10_0&#45;&gt;tp_3_10 -->
<g id="edge321" class="edge">
<title>expert_3_10_0&#45;&gt;tp_3_10</title>
<path fill="none" stroke="black" d="M5916.14,-8894.66C5913.41,-8894.34 5910.69,-8894.02 5908,-8893.72 5717,-8872.12 5666.77,-8888.32 5477,-8857.72 5465.92,-8855.93 5454.37,-8853.69 5442.97,-8851.23"/>
<polygon fill="black" stroke="black" points="5443.52,-8847.77 5433,-8849.02 5442,-8854.6 5443.52,-8847.77"/>
</g>
<!-- expert_3_10_1&#45;&gt;tp_3_10 -->
<g id="edge322" class="edge">
<title>expert_3_10_1&#45;&gt;tp_3_10</title>
<path fill="none" stroke="black" d="M6211.16,-8894.54C6208.42,-8894.25 6205.69,-8893.98 6203,-8893.72 5881.42,-8862.84 5796.77,-8903.75 5477,-8857.72 5465.52,-8856.07 5453.55,-8853.84 5441.77,-8851.35"/>
<polygon fill="black" stroke="black" points="5442.44,-8847.92 5431.93,-8849.2 5440.95,-8854.76 5442.44,-8847.92"/>
</g>
<!-- tp_3_10&#45;&gt;q_proj_4 -->
<g id="edge1554" class="edge">
<title>tp_3_10&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M5284.37,-8801.17C5266,-8795.59 5245.94,-8790.43 5227,-8787.49 5154.86,-8776.29 4642,-8791.56 4570,-8779.49 4537.05,-8773.97 4501.62,-8762.73 4472.77,-8752.1"/>
<polygon fill="black" stroke="black" points="4473.85,-8748.77 4463.26,-8748.53 4471.39,-8755.32 4473.85,-8748.77"/>
</g>
<!-- tp_3_10&#45;&gt;k_proj_4 -->
<g id="edge1555" class="edge">
<title>tp_3_10&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M5278.69,-8802.48C5230.12,-8787.16 5166.54,-8767.1 5117.35,-8751.58"/>
<polygon fill="black" stroke="black" points="5118.31,-8748.21 5107.72,-8748.54 5116.2,-8754.89 5118.31,-8748.21"/>
</g>
<!-- tp_3_10&#45;&gt;v_proj_4 -->
<g id="edge1556" class="edge">
<title>tp_3_10&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M5284.35,-8801.31C5265.98,-8795.73 5245.93,-8790.54 5227,-8787.49 5151.73,-8775.37 4959.12,-8792.51 4884,-8779.49 4851.21,-8773.81 4815.93,-8762.62 4787.14,-8752.06"/>
<polygon fill="black" stroke="black" points="4788.23,-8748.73 4777.63,-8748.52 4785.78,-8755.29 4788.23,-8748.73"/>
</g>
<!-- expert_3_11_0 -->
<g id="node267" class="node">
<title>expert_3_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6783.5,-8937.72 6506.5,-8937.72 6506.5,-8893.72 6783.5,-8893.72 6783.5,-8937.72"/>
<text text-anchor="middle" x="6645" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L3</text>
<text text-anchor="middle" x="6645" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 102</text>
<text text-anchor="middle" x="6645" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_11&#45;&gt;expert_3_11_0 -->
<g id="edge324" class="edge">
<title>route_3_11&#45;&gt;expert_3_11_0</title>
<path fill="none" stroke="black" d="M6645,-8973.36C6645,-8965.08 6645,-8956.11 6645,-8947.8"/>
<polygon fill="black" stroke="black" points="6648.5,-8947.72 6645,-8937.72 6641.5,-8947.72 6648.5,-8947.72"/>
</g>
<!-- expert_3_11_1 -->
<g id="node268" class="node">
<title>expert_3_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-8937.72 6801.5,-8937.72 6801.5,-8893.72 7078.5,-8893.72 7078.5,-8937.72"/>
<text text-anchor="middle" x="6940" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L3</text>
<text text-anchor="middle" x="6940" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 103</text>
<text text-anchor="middle" x="6940" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6940" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_11&#45;&gt;expert_3_11_1 -->
<g id="edge325" class="edge">
<title>route_3_11&#45;&gt;expert_3_11_1</title>
<path fill="none" stroke="black" d="M6735.92,-8976.98C6775.08,-8965.42 6820.51,-8952 6858.56,-8940.77"/>
<polygon fill="black" stroke="black" points="6859.97,-8944 6868.57,-8937.81 6857.99,-8937.29 6859.97,-8944"/>
</g>
<!-- tp_3_11 -->
<g id="node269" class="node">
<title>tp_3_11</title>
<ellipse fill="lightblue" stroke="black" cx="5602" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5602" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L3</text>
<text text-anchor="middle" x="5602" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 102↔103</text>
<text text-anchor="middle" x="5602" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5602" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_11_0&#45;&gt;tp_3_11 -->
<g id="edge326" class="edge">
<title>expert_3_11_0&#45;&gt;tp_3_11</title>
<path fill="none" stroke="black" d="M6506.16,-8894.52C6503.42,-8894.24 6500.69,-8893.97 6498,-8893.72 6156.48,-8861.42 6066.61,-8906.11 5727,-8857.72 5715.52,-8856.08 5703.55,-8853.87 5691.76,-8851.38"/>
<polygon fill="black" stroke="black" points="5692.44,-8847.95 5681.92,-8849.24 5690.94,-8854.79 5692.44,-8847.95"/>
</g>
<!-- expert_3_11_1&#45;&gt;tp_3_11 -->
<g id="edge327" class="edge">
<title>expert_3_11_1&#45;&gt;tp_3_11</title>
<path fill="none" stroke="black" d="M6801.16,-8894.48C6798.42,-8894.21 6795.7,-8893.96 6793,-8893.72 6320.78,-8852.14 6196.73,-8921.56 5727,-8857.72 5715.42,-8856.14 5703.35,-8853.96 5691.48,-8851.47"/>
<polygon fill="black" stroke="black" points="5692.08,-8848.02 5681.56,-8849.32 5690.59,-8854.86 5692.08,-8848.02"/>
</g>
<!-- tp_3_11&#45;&gt;q_proj_4 -->
<g id="edge1557" class="edge">
<title>tp_3_11&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M5534.7,-8801.23C5516.25,-8795.61 5496.06,-8790.42 5477,-8787.49 5377.39,-8772.19 4669.42,-8795.98 4570,-8779.49 4537.04,-8774.03 4501.61,-8762.79 4472.77,-8752.15"/>
<polygon fill="black" stroke="black" points="4473.84,-8748.82 4463.25,-8748.58 4471.38,-8755.37 4473.84,-8748.82"/>
</g>
<!-- tp_3_11&#45;&gt;k_proj_4 -->
<g id="edge1558" class="edge">
<title>tp_3_11&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M5531.13,-8801.86C5513.58,-8796.57 5494.73,-8791.39 5477,-8787.49 5385.84,-8767.46 5282.4,-8752.88 5199.16,-8743.11"/>
<polygon fill="black" stroke="black" points="5199.44,-8739.62 5189.11,-8741.95 5198.64,-8746.58 5199.44,-8739.62"/>
</g>
<!-- tp_3_11&#45;&gt;v_proj_4 -->
<g id="edge1559" class="edge">
<title>tp_3_11&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M5534.37,-8801.19C5516,-8795.6 5495.94,-8790.45 5477,-8787.49 5346.78,-8767.18 5013.96,-8801.36 4884,-8779.49 4851.06,-8773.95 4815.63,-8762.71 4786.78,-8752.09"/>
<polygon fill="black" stroke="black" points="4787.85,-8748.75 4777.26,-8748.52 4785.39,-8755.3 4787.85,-8748.75"/>
</g>
<!-- expert_3_12_0 -->
<g id="node271" class="node">
<title>expert_3_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7373.5,-8937.72 7096.5,-8937.72 7096.5,-8893.72 7373.5,-8893.72 7373.5,-8937.72"/>
<text text-anchor="middle" x="7235" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L3</text>
<text text-anchor="middle" x="7235" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 104</text>
<text text-anchor="middle" x="7235" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_12&#45;&gt;expert_3_12_0 -->
<g id="edge329" class="edge">
<title>route_3_12&#45;&gt;expert_3_12_0</title>
<path fill="none" stroke="black" d="M7235,-8973.36C7235,-8965.08 7235,-8956.11 7235,-8947.8"/>
<polygon fill="black" stroke="black" points="7238.5,-8947.72 7235,-8937.72 7231.5,-8947.72 7238.5,-8947.72"/>
</g>
<!-- expert_3_12_1 -->
<g id="node272" class="node">
<title>expert_3_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7668.5,-8937.72 7391.5,-8937.72 7391.5,-8893.72 7668.5,-8893.72 7668.5,-8937.72"/>
<text text-anchor="middle" x="7530" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L3</text>
<text text-anchor="middle" x="7530" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 105</text>
<text text-anchor="middle" x="7530" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7530" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_12&#45;&gt;expert_3_12_1 -->
<g id="edge330" class="edge">
<title>route_3_12&#45;&gt;expert_3_12_1</title>
<path fill="none" stroke="black" d="M7325.92,-8976.98C7365.08,-8965.42 7410.51,-8952 7448.56,-8940.77"/>
<polygon fill="black" stroke="black" points="7449.97,-8944 7458.57,-8937.81 7447.99,-8937.29 7449.97,-8944"/>
</g>
<!-- tp_3_12 -->
<g id="node273" class="node">
<title>tp_3_12</title>
<ellipse fill="lightblue" stroke="black" cx="5852" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5852" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L3</text>
<text text-anchor="middle" x="5852" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 104↔105</text>
<text text-anchor="middle" x="5852" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5852" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_12_0&#45;&gt;tp_3_12 -->
<g id="edge331" class="edge">
<title>expert_3_12_0&#45;&gt;tp_3_12</title>
<path fill="none" stroke="black" d="M7096.16,-8894.47C7093.42,-8894.21 7090.7,-8893.95 7088,-8893.72 6595.84,-8850.72 6466.58,-8923.91 5977,-8857.72 5965.42,-8856.15 5953.35,-8853.97 5941.48,-8851.48"/>
<polygon fill="black" stroke="black" points="5942.08,-8848.03 5931.56,-8849.33 5940.59,-8854.87 5942.08,-8848.03"/>
</g>
<!-- expert_3_12_1&#45;&gt;tp_3_12 -->
<g id="edge332" class="edge">
<title>expert_3_12_1&#45;&gt;tp_3_12</title>
<path fill="none" stroke="black" d="M7391.16,-8894.45C7388.42,-8894.19 7385.7,-8893.94 7383,-8893.72 6760.1,-8841.43 6596.74,-8939.37 5977,-8857.72 5965.33,-8856.18 5953.16,-8854 5941.2,-8851.5"/>
<polygon fill="black" stroke="black" points="5941.73,-8848.04 5931.21,-8849.34 5940.25,-8854.88 5941.73,-8848.04"/>
</g>
<!-- tp_3_12&#45;&gt;q_proj_4 -->
<g id="edge1560" class="edge">
<title>tp_3_12&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M5784.71,-8801.2C5766.25,-8795.58 5746.06,-8790.4 5727,-8787.49 5599.91,-8768.1 4696.85,-8800.4 4570,-8779.49 4537.04,-8774.06 4501.61,-8762.82 4472.76,-8752.18"/>
<polygon fill="black" stroke="black" points="4473.84,-8748.85 4463.25,-8748.61 4471.37,-8755.4 4473.84,-8748.85"/>
</g>
<!-- tp_3_12&#45;&gt;k_proj_4 -->
<g id="edge1561" class="edge">
<title>tp_3_12&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M5782.57,-8801.63C5764.65,-8796.22 5745.26,-8791.04 5727,-8787.49 5548.24,-8752.82 5339.35,-8738.16 5199.47,-8731.98"/>
<polygon fill="black" stroke="black" points="5199.24,-8728.47 5189.1,-8731.53 5198.94,-8735.46 5199.24,-8728.47"/>
</g>
<!-- tp_3_12&#45;&gt;v_proj_4 -->
<g id="edge1562" class="edge">
<title>tp_3_12&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M5784.7,-8801.23C5766.24,-8795.61 5746.06,-8790.43 5727,-8787.49 5634.42,-8773.24 4976.4,-8794.85 4884,-8779.49 4851.04,-8774.02 4815.62,-8762.78 4786.77,-8752.14"/>
<polygon fill="black" stroke="black" points="4787.84,-8748.81 4777.25,-8748.57 4785.38,-8755.36 4787.84,-8748.81"/>
</g>
<!-- expert_3_13_0 -->
<g id="node275" class="node">
<title>expert_3_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7963.5,-8937.72 7686.5,-8937.72 7686.5,-8893.72 7963.5,-8893.72 7963.5,-8937.72"/>
<text text-anchor="middle" x="7825" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L3</text>
<text text-anchor="middle" x="7825" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 106</text>
<text text-anchor="middle" x="7825" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_13&#45;&gt;expert_3_13_0 -->
<g id="edge334" class="edge">
<title>route_3_13&#45;&gt;expert_3_13_0</title>
<path fill="none" stroke="black" d="M7825,-8973.36C7825,-8965.08 7825,-8956.11 7825,-8947.8"/>
<polygon fill="black" stroke="black" points="7828.5,-8947.72 7825,-8937.72 7821.5,-8947.72 7828.5,-8947.72"/>
</g>
<!-- expert_3_13_1 -->
<g id="node276" class="node">
<title>expert_3_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8258.5,-8937.72 7981.5,-8937.72 7981.5,-8893.72 8258.5,-8893.72 8258.5,-8937.72"/>
<text text-anchor="middle" x="8120" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L3</text>
<text text-anchor="middle" x="8120" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 107</text>
<text text-anchor="middle" x="8120" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8120" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_13&#45;&gt;expert_3_13_1 -->
<g id="edge335" class="edge">
<title>route_3_13&#45;&gt;expert_3_13_1</title>
<path fill="none" stroke="black" d="M7915.92,-8976.98C7955.08,-8965.42 8000.51,-8952 8038.56,-8940.77"/>
<polygon fill="black" stroke="black" points="8039.97,-8944 8048.57,-8937.81 8037.99,-8937.29 8039.97,-8944"/>
</g>
<!-- tp_3_13 -->
<g id="node277" class="node">
<title>tp_3_13</title>
<ellipse fill="lightblue" stroke="black" cx="6102" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6102" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L3</text>
<text text-anchor="middle" x="6102" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 106↔107</text>
<text text-anchor="middle" x="6102" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6102" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_13_0&#45;&gt;tp_3_13 -->
<g id="edge336" class="edge">
<title>expert_3_13_0&#45;&gt;tp_3_13</title>
<path fill="none" stroke="black" d="M7686.16,-8894.44C7683.42,-8894.19 7680.7,-8893.94 7678,-8893.72 7035.15,-8840.01 6866.59,-8941.73 6227,-8857.72 6215.33,-8856.19 6203.16,-8854.01 6191.2,-8851.51"/>
<polygon fill="black" stroke="black" points="6191.73,-8848.05 6181.21,-8849.35 6190.25,-8854.89 6191.73,-8848.05"/>
</g>
<!-- expert_3_13_1&#45;&gt;tp_3_13 -->
<g id="edge337" class="edge">
<title>expert_3_13_1&#45;&gt;tp_3_13</title>
<path fill="none" stroke="black" d="M7981.17,-8894.43C7978.42,-8894.17 7975.7,-8893.94 7973,-8893.72 7586.2,-8862.22 6611.88,-8907.45 6227,-8857.72 6215.33,-8856.21 6203.16,-8854.04 6191.19,-8851.56"/>
<polygon fill="black" stroke="black" points="6191.72,-8848.09 6181.21,-8849.4 6190.24,-8854.93 6191.72,-8848.09"/>
</g>
<!-- tp_3_13&#45;&gt;q_proj_4 -->
<g id="edge1563" class="edge">
<title>tp_3_13&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M6034.71,-8801.19C6016.25,-8795.57 5996.07,-8790.39 5977,-8787.49 5899.72,-8775.75 4647.13,-8792.16 4570,-8779.49 4537.03,-8774.08 4501.6,-8762.85 4472.76,-8752.2"/>
<polygon fill="black" stroke="black" points="4473.83,-8748.87 4463.24,-8748.62 4471.37,-8755.42 4473.83,-8748.87"/>
</g>
<!-- tp_3_13&#45;&gt;k_proj_4 -->
<g id="edge1564" class="edge">
<title>tp_3_13&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M6033.28,-8801.53C6015.18,-8796.06 5995.53,-8790.86 5977,-8787.49 5832.36,-8761.18 5426.1,-8742.13 5199.24,-8733.2"/>
<polygon fill="black" stroke="black" points="5199.37,-8729.7 5189.24,-8732.8 5199.1,-8736.69 5199.37,-8729.7"/>
</g>
<!-- tp_3_13&#45;&gt;v_proj_4 -->
<g id="edge1565" class="edge">
<title>tp_3_13&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M6034.71,-8801.21C6016.25,-8795.59 5996.06,-8790.41 5977,-8787.49 5856.95,-8769.15 5003.83,-8799.27 4884,-8779.49 4851.04,-8774.05 4815.61,-8762.82 4786.76,-8752.18"/>
<polygon fill="black" stroke="black" points="4787.84,-8748.84 4777.25,-8748.6 4785.38,-8755.39 4787.84,-8748.84"/>
</g>
<!-- expert_3_14_0 -->
<g id="node279" class="node">
<title>expert_3_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8553.5,-8937.72 8276.5,-8937.72 8276.5,-8893.72 8553.5,-8893.72 8553.5,-8937.72"/>
<text text-anchor="middle" x="8415" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L3</text>
<text text-anchor="middle" x="8415" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 108</text>
<text text-anchor="middle" x="8415" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_14&#45;&gt;expert_3_14_0 -->
<g id="edge339" class="edge">
<title>route_3_14&#45;&gt;expert_3_14_0</title>
<path fill="none" stroke="black" d="M8415,-8973.36C8415,-8965.08 8415,-8956.11 8415,-8947.8"/>
<polygon fill="black" stroke="black" points="8418.5,-8947.72 8415,-8937.72 8411.5,-8947.72 8418.5,-8947.72"/>
</g>
<!-- expert_3_14_1 -->
<g id="node280" class="node">
<title>expert_3_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8848.5,-8937.72 8571.5,-8937.72 8571.5,-8893.72 8848.5,-8893.72 8848.5,-8937.72"/>
<text text-anchor="middle" x="8710" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L3</text>
<text text-anchor="middle" x="8710" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 109</text>
<text text-anchor="middle" x="8710" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8710" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_14&#45;&gt;expert_3_14_1 -->
<g id="edge340" class="edge">
<title>route_3_14&#45;&gt;expert_3_14_1</title>
<path fill="none" stroke="black" d="M8505.92,-8976.98C8545.08,-8965.42 8590.51,-8952 8628.56,-8940.77"/>
<polygon fill="black" stroke="black" points="8629.97,-8944 8638.57,-8937.81 8627.99,-8937.29 8629.97,-8944"/>
</g>
<!-- tp_3_14 -->
<g id="node281" class="node">
<title>tp_3_14</title>
<ellipse fill="lightblue" stroke="black" cx="6352" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6352" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L3</text>
<text text-anchor="middle" x="6352" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 108↔109</text>
<text text-anchor="middle" x="6352" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6352" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_14_0&#45;&gt;tp_3_14 -->
<g id="edge341" class="edge">
<title>expert_3_14_0&#45;&gt;tp_3_14</title>
<path fill="none" stroke="black" d="M8276.17,-8894.43C8273.42,-8894.17 8270.7,-8893.94 8268,-8893.72 7871.22,-8861.51 6871.81,-8908.63 6477,-8857.72 6465.33,-8856.21 6453.16,-8854.05 6441.19,-8851.56"/>
<polygon fill="black" stroke="black" points="6441.72,-8848.1 6431.21,-8849.41 6440.24,-8854.94 6441.72,-8848.1"/>
</g>
<!-- expert_3_14_1&#45;&gt;tp_3_14 -->
<g id="edge342" class="edge">
<title>expert_3_14_1&#45;&gt;tp_3_14</title>
<path fill="none" stroke="black" d="M8571.17,-8894.41C8568.42,-8894.17 8565.7,-8893.93 8563,-8893.72 8100.84,-8856.86 6936.9,-8916.36 6477,-8857.72 6465.32,-8856.23 6453.15,-8854.08 6441.19,-8851.6"/>
<polygon fill="black" stroke="black" points="6441.71,-8848.13 6431.2,-8849.44 6440.24,-8854.97 6441.71,-8848.13"/>
</g>
<!-- tp_3_14&#45;&gt;q_proj_4 -->
<g id="edge1566" class="edge">
<title>tp_3_14&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M6284.71,-8801.18C6266.25,-8795.55 6246.07,-8790.38 6227,-8787.49 6135.98,-8773.7 4660.85,-8794.37 4570,-8779.49 4536.9,-8774.07 4501.33,-8762.77 4472.42,-8752.09"/>
<polygon fill="black" stroke="black" points="4473.48,-8748.75 4462.89,-8748.5 4471.01,-8755.3 4473.48,-8748.75"/>
</g>
<!-- tp_3_14&#45;&gt;k_proj_4 -->
<g id="edge1567" class="edge">
<title>tp_3_14&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M6283.64,-8801.46C6265.45,-8795.95 6245.66,-8790.76 6227,-8787.49 6034.3,-8753.77 5475.52,-8737.07 5199.33,-8730.69"/>
<polygon fill="black" stroke="black" points="5199.3,-8727.19 5189.23,-8730.46 5199.14,-8734.19 5199.3,-8727.19"/>
</g>
<!-- tp_3_14&#45;&gt;v_proj_4 -->
<g id="edge1568" class="edge">
<title>tp_3_14&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M6284.71,-8801.19C6266.25,-8795.57 6246.07,-8790.39 6227,-8787.49 6153.24,-8776.27 4957.62,-8791.59 4884,-8779.49 4851.04,-8774.07 4815.61,-8762.84 4786.76,-8752.2"/>
<polygon fill="black" stroke="black" points="4787.84,-8748.86 4777.24,-8748.62 4785.37,-8755.41 4787.84,-8748.86"/>
</g>
<!-- expert_3_15_0 -->
<g id="node283" class="node">
<title>expert_3_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9143.5,-8937.72 8866.5,-8937.72 8866.5,-8893.72 9143.5,-8893.72 9143.5,-8937.72"/>
<text text-anchor="middle" x="9005" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L3</text>
<text text-anchor="middle" x="9005" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 110</text>
<text text-anchor="middle" x="9005" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_15&#45;&gt;expert_3_15_0 -->
<g id="edge344" class="edge">
<title>route_3_15&#45;&gt;expert_3_15_0</title>
<path fill="none" stroke="black" d="M9005,-8973.36C9005,-8965.08 9005,-8956.11 9005,-8947.8"/>
<polygon fill="black" stroke="black" points="9008.5,-8947.72 9005,-8937.72 9001.5,-8947.72 9008.5,-8947.72"/>
</g>
<!-- expert_3_15_1 -->
<g id="node284" class="node">
<title>expert_3_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9438.5,-8937.72 9161.5,-8937.72 9161.5,-8893.72 9438.5,-8893.72 9438.5,-8937.72"/>
<text text-anchor="middle" x="9300" y="-8928.52" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L3</text>
<text text-anchor="middle" x="9300" y="-8918.52" font-family="Times,serif" font-size="9.00">GPU: 111</text>
<text text-anchor="middle" x="9300" y="-8908.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9300" y="-8898.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_15&#45;&gt;expert_3_15_1 -->
<g id="edge345" class="edge">
<title>route_3_15&#45;&gt;expert_3_15_1</title>
<path fill="none" stroke="black" d="M9095.92,-8976.98C9135.08,-8965.42 9180.51,-8952 9218.56,-8940.77"/>
<polygon fill="black" stroke="black" points="9219.97,-8944 9228.57,-8937.81 9217.99,-8937.29 9219.97,-8944"/>
</g>
<!-- tp_3_15 -->
<g id="node285" class="node">
<title>tp_3_15</title>
<ellipse fill="lightblue" stroke="black" cx="6602" cy="-8826.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6602" y="-8839.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L3</text>
<text text-anchor="middle" x="6602" y="-8829.41" font-family="Times,serif" font-size="9.00">GPU: 110↔111</text>
<text text-anchor="middle" x="6602" y="-8819.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6602" y="-8809.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_15_0&#45;&gt;tp_3_15 -->
<g id="edge346" class="edge">
<title>expert_3_15_0&#45;&gt;tp_3_15</title>
<path fill="none" stroke="black" d="M8866.16,-8894.46C8863.42,-8894.2 8860.7,-8893.95 8858,-8893.72 8439.38,-8857.8 7138.95,-8835.66 6727.89,-8829.43"/>
<polygon fill="black" stroke="black" points="6727.8,-8825.92 6717.75,-8829.27 6727.7,-8832.92 6727.8,-8825.92"/>
</g>
<!-- expert_3_15_1&#45;&gt;tp_3_15 -->
<g id="edge347" class="edge">
<title>expert_3_15_1&#45;&gt;tp_3_15</title>
<path fill="none" stroke="black" d="M9161.16,-8894.45C9158.42,-8894.19 9155.7,-8893.95 9153,-8893.72 8673.93,-8853.43 7173.66,-8833.93 6728.03,-8828.93"/>
<polygon fill="black" stroke="black" points="6728.05,-8825.43 6718.02,-8828.82 6727.98,-8832.43 6728.05,-8825.43"/>
</g>
<!-- tp_3_15&#45;&gt;q_proj_4 -->
<g id="edge1569" class="edge">
<title>tp_3_15&#45;&gt;q_proj_4</title>
<path fill="none" stroke="black" d="M6534.71,-8801.17C6516.25,-8795.55 6496.07,-8790.38 6477,-8787.49 6372.25,-8771.65 4674.56,-8796.58 4570,-8779.49 4536.9,-8774.08 4501.33,-8762.79 4472.42,-8752.1"/>
<polygon fill="black" stroke="black" points="4473.48,-8748.76 4462.89,-8748.51 4471.01,-8755.31 4473.48,-8748.76"/>
</g>
<!-- tp_3_15&#45;&gt;k_proj_4 -->
<g id="edge1570" class="edge">
<title>tp_3_15&#45;&gt;k_proj_4</title>
<path fill="none" stroke="black" d="M6533.66,-8801.35C6515.47,-8795.84 6495.67,-8790.68 6477,-8787.49 6235.57,-8746.33 5520.02,-8733.02 5199.44,-8729.04"/>
<polygon fill="black" stroke="black" points="5199.18,-8725.54 5189.14,-8728.92 5199.1,-8732.54 5199.18,-8725.54"/>
</g>
<!-- tp_3_15&#45;&gt;v_proj_4 -->
<g id="edge1571" class="edge">
<title>tp_3_15&#45;&gt;v_proj_4</title>
<path fill="none" stroke="black" d="M6534.71,-8801.18C6516.25,-8795.56 6496.07,-8790.38 6477,-8787.49 6389.5,-8774.22 4971.34,-8793.8 4884,-8779.49 4850.91,-8774.07 4815.33,-8762.77 4786.42,-8752.09"/>
<polygon fill="black" stroke="black" points="4787.48,-8748.75 4776.89,-8748.5 4785.01,-8755.3 4787.48,-8748.75"/>
</g>
<!-- attn_scores_4 -->
<g id="node289" class="node">
<title>attn_scores_4</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-8668.49 4560.5,-8668.49 4560.5,-8624.49 4893.5,-8624.49 4893.5,-8668.49"/>
<text text-anchor="middle" x="4727" y="-8659.29" font-family="Times,serif" font-size="9.00">Attention Scores L4</text>
<text text-anchor="middle" x="4727" y="-8649.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4727" y="-8639.29" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-8629.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_4&#45;&gt;attn_scores_4 -->
<g id="edge348" class="edge">
<title>q_proj_4&#45;&gt;attn_scores_4</title>
<path fill="none" stroke="black" d="M4497.56,-8704.49C4539.18,-8694.15 4589.51,-8681.65 4632.41,-8670.99"/>
<polygon fill="black" stroke="black" points="4633.43,-8674.34 4642.29,-8668.54 4631.74,-8667.55 4633.43,-8674.34"/>
</g>
<!-- k_proj_4&#45;&gt;attn_scores_4 -->
<g id="edge349" class="edge">
<title>k_proj_4&#45;&gt;attn_scores_4</title>
<path fill="none" stroke="black" d="M4956.44,-8704.49C4914.82,-8694.15 4864.49,-8681.65 4821.59,-8670.99"/>
<polygon fill="black" stroke="black" points="4822.26,-8667.55 4811.71,-8668.54 4820.57,-8674.34 4822.26,-8667.55"/>
</g>
<!-- v_proj_4&#45;&gt;attn_scores_4 -->
<g id="edge350" class="edge">
<title>v_proj_4&#45;&gt;attn_scores_4</title>
<path fill="none" stroke="black" d="M4727,-8704.18C4727,-8696.29 4727,-8687.18 4727,-8678.6"/>
<polygon fill="black" stroke="black" points="4730.5,-8678.51 4727,-8668.51 4723.5,-8678.51 4730.5,-8678.51"/>
</g>
<!-- softmax_4 -->
<g id="node290" class="node">
<title>softmax_4</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-8588.49 4560.5,-8588.49 4560.5,-8544.49 4893.5,-8544.49 4893.5,-8588.49"/>
<text text-anchor="middle" x="4727" y="-8579.29" font-family="Times,serif" font-size="9.00">Softmax L4</text>
<text text-anchor="middle" x="4727" y="-8569.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4727" y="-8559.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4727" y="-8549.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_4&#45;&gt;softmax_4 -->
<g id="edge351" class="edge">
<title>attn_scores_4&#45;&gt;softmax_4</title>
<path fill="none" stroke="black" d="M4727,-8624.18C4727,-8616.29 4727,-8607.18 4727,-8598.6"/>
<polygon fill="black" stroke="black" points="4730.5,-8598.51 4727,-8588.51 4723.5,-8598.51 4730.5,-8598.51"/>
</g>
<!-- attn_out_4 -->
<g id="node291" class="node">
<title>attn_out_4</title>
<polygon fill="lightgreen" stroke="black" points="4875,-8508.49 4579,-8508.49 4579,-8464.49 4875,-8464.49 4875,-8508.49"/>
<text text-anchor="middle" x="4727" y="-8499.29" font-family="Times,serif" font-size="9.00">Attention Output L4</text>
<text text-anchor="middle" x="4727" y="-8489.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4727" y="-8479.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-8469.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_4&#45;&gt;attn_out_4 -->
<g id="edge352" class="edge">
<title>softmax_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M4727,-8544.18C4727,-8536.29 4727,-8527.18 4727,-8518.6"/>
<polygon fill="black" stroke="black" points="4730.5,-8518.51 4727,-8508.51 4723.5,-8518.51 4730.5,-8518.51"/>
</g>
<!-- gate_4 -->
<g id="node292" class="node">
<title>gate_4</title>
<polygon fill="lightyellow" stroke="black" points="5026.74,-8428.49 4549.92,-8428.49 4427.26,-8340.49 4904.08,-8340.49 5026.74,-8428.49"/>
<text text-anchor="middle" x="4727" y="-8397.29" font-family="Times,serif" font-size="9.00">Gate L4</text>
<text text-anchor="middle" x="4727" y="-8387.29" font-family="Times,serif" font-size="9.00">GPU: 128&#45;191</text>
<text text-anchor="middle" x="4727" y="-8377.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-8367.29" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_4&#45;&gt;gate_4 -->
<g id="edge353" class="edge">
<title>attn_out_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M4727,-8464.29C4727,-8456.79 4727,-8447.98 4727,-8439.02"/>
<polygon fill="black" stroke="black" points="4730.5,-8438.9 4727,-8428.9 4723.5,-8438.9 4730.5,-8438.9"/>
</g>
<!-- route_4_0 -->
<g id="node293" class="node">
<title>route_4_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="596" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="596" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="596" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="596" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="596" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_0 -->
<g id="edge354" class="edge">
<title>gate_4&#45;&gt;route_4_0</title>
<path fill="none" stroke="black" d="M4486.84,-8383.26C3891.69,-8381.64 2300.87,-8370.88 976,-8304.49 910.75,-8301.22 839.32,-8296 776.17,-8290.81"/>
<polygon fill="black" stroke="black" points="776.37,-8287.31 766.11,-8289.98 775.79,-8294.29 776.37,-8287.31"/>
</g>
<!-- route_4_1 -->
<g id="node297" class="node">
<title>route_4_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1186" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1186" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1186" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 130,131</text>
<text text-anchor="middle" x="1186" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1186" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_1 -->
<g id="edge359" class="edge">
<title>gate_4&#45;&gt;route_4_1</title>
<path fill="none" stroke="black" d="M4484.92,-8381.9C3955.33,-8377.45 2654.2,-8361.17 1566,-8304.49 1500.91,-8301.1 1429.67,-8295.87 1366.63,-8290.7"/>
<polygon fill="black" stroke="black" points="1366.84,-8287.21 1356.59,-8289.87 1366.27,-8294.18 1366.84,-8287.21"/>
</g>
<!-- route_4_2 -->
<g id="node301" class="node">
<title>route_4_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1776" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1776" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1776" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 132,133</text>
<text text-anchor="middle" x="1776" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1776" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_2 -->
<g id="edge364" class="edge">
<title>gate_4&#45;&gt;route_4_2</title>
<path fill="none" stroke="black" d="M4481.78,-8379.9C4024.28,-8372.33 3009.6,-8351.4 2156,-8304.49 2091.08,-8300.93 2020.02,-8295.66 1957.1,-8290.53"/>
<polygon fill="black" stroke="black" points="1957.33,-8287.03 1947.08,-8289.71 1956.76,-8294.01 1957.33,-8287.03"/>
</g>
<!-- route_4_3 -->
<g id="node305" class="node">
<title>route_4_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2366" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2366" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2366" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 134,135</text>
<text text-anchor="middle" x="2366" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2366" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_3 -->
<g id="edge369" class="edge">
<title>gate_4&#45;&gt;route_4_3</title>
<path fill="none" stroke="black" d="M4477.45,-8376.68C4101.69,-8365.71 3368.32,-8341.55 2746,-8304.49 2681.41,-8300.65 2610.73,-8295.35 2548.03,-8290.26"/>
<polygon fill="black" stroke="black" points="2548.29,-8286.77 2538.04,-8289.45 2547.72,-8293.75 2548.29,-8286.77"/>
</g>
<!-- route_4_4 -->
<g id="node309" class="node">
<title>route_4_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2956" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2956" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2956" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 136,137</text>
<text text-anchor="middle" x="2956" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2956" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_4 -->
<g id="edge374" class="edge">
<title>gate_4&#45;&gt;route_4_4</title>
<path fill="none" stroke="black" d="M4468.92,-8370.56C4189.58,-8356.17 3731.02,-8331.36 3336,-8304.49 3272.2,-8300.15 3202.43,-8294.8 3140.29,-8289.82"/>
<polygon fill="black" stroke="black" points="3140.23,-8286.3 3129.98,-8288.99 3139.67,-8293.28 3140.23,-8286.3"/>
</g>
<!-- route_4_5 -->
<g id="node313" class="node">
<title>route_4_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3546" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3546" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3546" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 138,139</text>
<text text-anchor="middle" x="3546" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3546" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_5 -->
<g id="edge379" class="edge">
<title>gate_4&#45;&gt;route_4_5</title>
<path fill="none" stroke="black" d="M4451.6,-8358.05C4227.84,-8337.38 3918.7,-8308.81 3725.68,-8290.98"/>
<polygon fill="black" stroke="black" points="3725.99,-8287.49 3715.71,-8290.06 3725.35,-8294.47 3725.99,-8287.49"/>
</g>
<!-- route_4_6 -->
<g id="node317" class="node">
<title>route_4_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4136" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4136" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4136" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 140,141</text>
<text text-anchor="middle" x="4136" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4136" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_6 -->
<g id="edge384" class="edge">
<title>gate_4&#45;&gt;route_4_6</title>
<path fill="none" stroke="black" d="M4493.85,-8340.45C4418.61,-8326.56 4337.73,-8311.62 4271.93,-8299.48"/>
<polygon fill="black" stroke="black" points="4272.39,-8296 4261.92,-8297.63 4271.12,-8302.89 4272.39,-8296"/>
</g>
<!-- route_4_7 -->
<g id="node321" class="node">
<title>route_4_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4664" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4664" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4664" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 142,143</text>
<text text-anchor="middle" x="4664" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4664" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_7 -->
<g id="edge389" class="edge">
<title>gate_4&#45;&gt;route_4_7</title>
<path fill="none" stroke="black" d="M4702.1,-8340.37C4696.94,-8331.44 4691.54,-8322.08 4686.48,-8313.31"/>
<polygon fill="black" stroke="black" points="4689.38,-8311.34 4681.35,-8304.43 4683.32,-8314.84 4689.38,-8311.34"/>
</g>
<!-- route_4_8 -->
<g id="node325" class="node">
<title>route_4_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5084" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5084" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5084" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="5084" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5084" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_8 -->
<g id="edge394" class="edge">
<title>gate_4&#45;&gt;route_4_8</title>
<path fill="none" stroke="black" d="M4867.84,-8340.45C4907.4,-8328.36 4949.55,-8315.47 4986.02,-8304.33"/>
<polygon fill="black" stroke="black" points="4987.12,-8307.65 4995.66,-8301.38 4985.07,-8300.96 4987.12,-8307.65"/>
</g>
<!-- route_4_9 -->
<g id="node329" class="node">
<title>route_4_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5611" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5611" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5611" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 162,163</text>
<text text-anchor="middle" x="5611" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5611" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_9 -->
<g id="edge399" class="edge">
<title>gate_4&#45;&gt;route_4_9</title>
<path fill="none" stroke="black" d="M4929.25,-8358.53C5086.07,-8339.17 5300.61,-8312.69 5446.86,-8294.64"/>
<polygon fill="black" stroke="black" points="5447.34,-8298.11 5456.84,-8293.41 5446.48,-8291.16 5447.34,-8298.11"/>
</g>
<!-- route_4_10 -->
<g id="node333" class="node">
<title>route_4_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6201" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6201" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6201" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 164,165</text>
<text text-anchor="middle" x="6201" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6201" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_10 -->
<g id="edge404" class="edge">
<title>gate_4&#45;&gt;route_4_10</title>
<path fill="none" stroke="black" d="M4942.91,-8368.35C5163.6,-8352.76 5516.24,-8327.57 5821,-8304.49 5884.29,-8299.7 5953.5,-8294.27 6015.3,-8289.36"/>
<polygon fill="black" stroke="black" points="6015.86,-8292.82 6025.55,-8288.54 6015.31,-8285.85 6015.86,-8292.82"/>
</g>
<!-- route_4_11 -->
<g id="node337" class="node">
<title>route_4_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6791" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6791" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6791" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 166,167</text>
<text text-anchor="middle" x="6791" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6791" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_11 -->
<g id="edge409" class="edge">
<title>gate_4&#45;&gt;route_4_11</title>
<path fill="none" stroke="black" d="M4952.53,-8375.22C5275.72,-8362.84 5889.23,-8337.4 6411,-8304.49 6475.13,-8300.45 6545.28,-8295.14 6607.65,-8290.11"/>
<polygon fill="black" stroke="black" points="6608.31,-8293.57 6617.99,-8289.27 6607.74,-8286.59 6608.31,-8293.57"/>
</g>
<!-- route_4_12 -->
<g id="node341" class="node">
<title>route_4_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7381" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7381" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7381" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 168,169</text>
<text text-anchor="middle" x="7381" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7381" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_12 -->
<g id="edge414" class="edge">
<title>gate_4&#45;&gt;route_4_12</title>
<path fill="none" stroke="black" d="M4957.95,-8378.85C5369.03,-8369.84 6254.62,-8347.01 7001,-8304.49 7065.76,-8300.8 7136.62,-8295.53 7199.43,-8290.42"/>
<polygon fill="black" stroke="black" points="7199.76,-8293.9 7209.44,-8289.6 7199.19,-8286.92 7199.76,-8293.9"/>
</g>
<!-- route_4_13 -->
<g id="node345" class="node">
<title>route_4_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7971" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7971" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7971" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 170,171</text>
<text text-anchor="middle" x="7971" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7971" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_13 -->
<g id="edge419" class="edge">
<title>gate_4&#45;&gt;route_4_13</title>
<path fill="none" stroke="black" d="M4961.05,-8381.12C5449.9,-8375.26 6614.98,-8356.59 7591,-8304.49 7655.92,-8301.03 7726.98,-8295.79 7789.9,-8290.64"/>
<polygon fill="black" stroke="black" points="7790.25,-8294.13 7799.93,-8289.82 7789.68,-8287.15 7790.25,-8294.13"/>
</g>
<!-- route_4_14 -->
<g id="node349" class="node">
<title>route_4_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8561" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8561" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8561" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 172,173</text>
<text text-anchor="middle" x="8561" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8561" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_14 -->
<g id="edge424" class="edge">
<title>gate_4&#45;&gt;route_4_14</title>
<path fill="none" stroke="black" d="M4962.99,-8382.66C5522.23,-8379.7 6971.89,-8366.18 8181,-8304.49 8246.09,-8301.17 8317.34,-8295.95 8380.37,-8290.78"/>
<polygon fill="black" stroke="black" points="8380.73,-8294.26 8390.41,-8289.95 8380.16,-8287.29 8380.73,-8294.26"/>
</g>
<!-- route_4_15 -->
<g id="node353" class="node">
<title>route_4_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9151" cy="-8273.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9151" y="-8286.18" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9151" y="-8276.18" font-family="Times,serif" font-size="9.00">GPU: 174,175</text>
<text text-anchor="middle" x="9151" y="-8266.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9151" y="-8256.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_15 -->
<g id="edge429" class="edge">
<title>gate_4&#45;&gt;route_4_15</title>
<path fill="none" stroke="black" d="M4964.48,-8383.79C5588.57,-8383.49 7326.41,-8375.78 8771,-8304.49 8836.25,-8301.27 8907.69,-8296.06 8970.83,-8290.87"/>
<polygon fill="black" stroke="black" points="8971.21,-8294.35 8980.89,-8290.03 8970.64,-8287.37 8971.21,-8294.35"/>
</g>
<!-- expert_4_0_0 -->
<g id="node294" class="node">
<title>expert_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="439.5,-8206.27 162.5,-8206.27 162.5,-8162.27 439.5,-8162.27 439.5,-8206.27"/>
<text text-anchor="middle" x="301" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L4</text>
<text text-anchor="middle" x="301" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="301" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="301" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_0&#45;&gt;expert_4_0_0 -->
<g id="edge355" class="edge">
<title>route_4_0&#45;&gt;expert_4_0_0</title>
<path fill="none" stroke="black" d="M505.08,-8245.53C465.92,-8233.97 420.49,-8220.55 382.44,-8209.32"/>
<polygon fill="black" stroke="black" points="383.01,-8205.84 372.43,-8206.36 381.03,-8212.55 383.01,-8205.84"/>
</g>
<!-- expert_4_0_1 -->
<g id="node295" class="node">
<title>expert_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="734.5,-8206.27 457.5,-8206.27 457.5,-8162.27 734.5,-8162.27 734.5,-8206.27"/>
<text text-anchor="middle" x="596" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L4</text>
<text text-anchor="middle" x="596" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="596" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="596" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_0&#45;&gt;expert_4_0_1 -->
<g id="edge356" class="edge">
<title>route_4_0&#45;&gt;expert_4_0_1</title>
<path fill="none" stroke="black" d="M596,-8241.91C596,-8233.63 596,-8224.66 596,-8216.34"/>
<polygon fill="black" stroke="black" points="599.5,-8216.27 596,-8206.27 592.5,-8216.27 599.5,-8216.27"/>
</g>
<!-- tp_4_0 -->
<g id="node296" class="node">
<title>tp_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="2998" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2998" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L4</text>
<text text-anchor="middle" x="2998" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="2998" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2998" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_0_0&#45;&gt;tp_4_0 -->
<g id="edge357" class="edge">
<title>expert_4_0_0&#45;&gt;tp_4_0</title>
<path fill="none" stroke="black" d="M439.84,-8163C442.58,-8162.74 445.3,-8162.49 448,-8162.27 926.88,-8121.99 2426.56,-8102.49 2872.02,-8097.48"/>
<polygon fill="black" stroke="black" points="2872.07,-8100.98 2882.03,-8097.37 2871.99,-8093.98 2872.07,-8100.98"/>
</g>
<!-- expert_4_0_1&#45;&gt;tp_4_0 -->
<g id="edge358" class="edge">
<title>expert_4_0_1&#45;&gt;tp_4_0</title>
<path fill="none" stroke="black" d="M734.6,-8163.12C737.76,-8162.82 740.9,-8162.53 744,-8162.27 1162.26,-8126.57 2461.54,-8104.29 2872.23,-8097.99"/>
<polygon fill="black" stroke="black" points="2872.41,-8101.49 2882.35,-8097.84 2872.3,-8094.49 2872.41,-8101.49"/>
</g>
<!-- q_proj_5 -->
<g id="node357" class="node">
<title>q_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="5021,-8028.04 4725,-8028.04 4725,-7984.04 5021,-7984.04 5021,-8028.04"/>
<text text-anchor="middle" x="4873" y="-8018.84" font-family="Times,serif" font-size="9.00">Q Projection L5</text>
<text text-anchor="middle" x="4873" y="-8008.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4873" y="-7998.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7988.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_4_0&#45;&gt;q_proj_5 -->
<g id="edge1572" class="edge">
<title>tp_4_0&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M3077.21,-8072.38C3092.31,-8069 3108.06,-8065.99 3123,-8064.04 3470.87,-8018.74 4346.53,-8054.87 4714.51,-8028.09"/>
<polygon fill="black" stroke="black" points="4715,-8031.56 4724.71,-8027.32 4714.48,-8024.58 4715,-8031.56"/>
</g>
<!-- k_proj_5 -->
<g id="node358" class="node">
<title>k_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="5335,-8028.04 5039,-8028.04 5039,-7984.04 5335,-7984.04 5335,-8028.04"/>
<text text-anchor="middle" x="5187" y="-8018.84" font-family="Times,serif" font-size="9.00">K Projection L5</text>
<text text-anchor="middle" x="5187" y="-8008.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="5187" y="-7998.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5187" y="-7988.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_4_0&#45;&gt;k_proj_5 -->
<g id="edge1573" class="edge">
<title>tp_4_0&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M3077.2,-8072.34C3092.3,-8068.96 3108.06,-8065.96 3123,-8064.04 3540.12,-8010.51 4590.78,-8059.41 5028.49,-8028.09"/>
<polygon fill="black" stroke="black" points="5029,-8031.56 5038.71,-8027.33 5028.48,-8024.58 5029,-8031.56"/>
</g>
<!-- v_proj_5 -->
<g id="node359" class="node">
<title>v_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="4707,-8028.04 4411,-8028.04 4411,-7984.04 4707,-7984.04 4707,-8028.04"/>
<text text-anchor="middle" x="4559" y="-8018.84" font-family="Times,serif" font-size="9.00">V Projection L5</text>
<text text-anchor="middle" x="4559" y="-8008.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4559" y="-7998.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4559" y="-7988.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_4_0&#45;&gt;v_proj_5 -->
<g id="edge1574" class="edge">
<title>tp_4_0&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M3077.57,-8072.52C3092.56,-8069.14 3108.19,-8066.1 3123,-8064.04 3365.49,-8030.36 4080.06,-8014.82 4400.44,-8009.4"/>
<polygon fill="black" stroke="black" points="4400.79,-8012.9 4410.73,-8009.23 4400.68,-8005.9 4400.79,-8012.9"/>
</g>
<!-- expert_4_1_0 -->
<g id="node298" class="node">
<title>expert_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1029.5,-8206.27 752.5,-8206.27 752.5,-8162.27 1029.5,-8162.27 1029.5,-8206.27"/>
<text text-anchor="middle" x="891" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L4</text>
<text text-anchor="middle" x="891" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 130</text>
<text text-anchor="middle" x="891" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="891" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_1&#45;&gt;expert_4_1_0 -->
<g id="edge360" class="edge">
<title>route_4_1&#45;&gt;expert_4_1_0</title>
<path fill="none" stroke="black" d="M1095.08,-8245.53C1055.92,-8233.97 1010.49,-8220.55 972.44,-8209.32"/>
<polygon fill="black" stroke="black" points="973.01,-8205.84 962.43,-8206.36 971.03,-8212.55 973.01,-8205.84"/>
</g>
<!-- expert_4_1_1 -->
<g id="node299" class="node">
<title>expert_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1324.5,-8206.27 1047.5,-8206.27 1047.5,-8162.27 1324.5,-8162.27 1324.5,-8206.27"/>
<text text-anchor="middle" x="1186" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L4</text>
<text text-anchor="middle" x="1186" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 131</text>
<text text-anchor="middle" x="1186" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1186" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_1&#45;&gt;expert_4_1_1 -->
<g id="edge361" class="edge">
<title>route_4_1&#45;&gt;expert_4_1_1</title>
<path fill="none" stroke="black" d="M1186,-8241.91C1186,-8233.63 1186,-8224.66 1186,-8216.34"/>
<polygon fill="black" stroke="black" points="1189.5,-8216.27 1186,-8206.27 1182.5,-8216.27 1189.5,-8216.27"/>
</g>
<!-- tp_4_1 -->
<g id="node300" class="node">
<title>tp_4_1</title>
<ellipse fill="lightblue" stroke="black" cx="3248" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3248" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L4</text>
<text text-anchor="middle" x="3248" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 130↔131</text>
<text text-anchor="middle" x="3248" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3248" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_1_0&#45;&gt;tp_4_1 -->
<g id="edge362" class="edge">
<title>expert_4_1_0&#45;&gt;tp_4_1</title>
<path fill="none" stroke="black" d="M1029.59,-8163.07C1032.76,-8162.78 1035.9,-8162.51 1039,-8162.27 1500.73,-8125.66 2663.54,-8184.86 3123,-8126.27 3134.68,-8124.78 3146.85,-8122.62 3158.81,-8120.14"/>
<polygon fill="black" stroke="black" points="3159.76,-8123.52 3168.8,-8117.99 3158.29,-8116.68 3159.76,-8123.52"/>
</g>
<!-- expert_4_1_1&#45;&gt;tp_4_1 -->
<g id="edge363" class="edge">
<title>expert_4_1_1&#45;&gt;tp_4_1</title>
<path fill="none" stroke="black" d="M1324.6,-8163.08C1327.76,-8162.79 1330.9,-8162.52 1334,-8162.27 1730.35,-8130.28 2728.63,-8177.13 3123,-8126.27 3134.67,-8124.76 3146.84,-8122.6 3158.81,-8120.11"/>
<polygon fill="black" stroke="black" points="3159.76,-8123.49 3168.79,-8117.96 3158.28,-8116.65 3159.76,-8123.49"/>
</g>
<!-- tp_4_1&#45;&gt;q_proj_5 -->
<g id="edge1575" class="edge">
<title>tp_4_1&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M3327.55,-8072.36C3342.55,-8069 3358.17,-8066 3373,-8064.04 3961.62,-7986.13 4119.04,-8074.68 4714.58,-8028.11"/>
<polygon fill="black" stroke="black" points="4715.02,-8031.58 4724.71,-8027.3 4714.47,-8024.6 4715.02,-8031.58"/>
</g>
<!-- tp_4_1&#45;&gt;k_proj_5 -->
<g id="edge1576" class="edge">
<title>tp_4_1&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M3327.21,-8072.37C3342.3,-8068.99 3358.06,-8065.98 3373,-8064.04 3735.04,-8017.06 4646.58,-8055.81 5028.67,-8028.08"/>
<polygon fill="black" stroke="black" points="5029,-8031.56 5038.71,-8027.32 5028.48,-8024.58 5029,-8031.56"/>
</g>
<!-- tp_4_1&#45;&gt;v_proj_5 -->
<g id="edge1577" class="edge">
<title>tp_4_1&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M3327.92,-8072.54C3342.81,-8069.19 3358.31,-8066.15 3373,-8064.04 3566.63,-8036.32 4124.96,-8018.37 4400.85,-8010.95"/>
<polygon fill="black" stroke="black" points="4401.05,-8014.44 4410.95,-8010.68 4400.86,-8007.44 4401.05,-8014.44"/>
</g>
<!-- expert_4_2_0 -->
<g id="node302" class="node">
<title>expert_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1619.5,-8206.27 1342.5,-8206.27 1342.5,-8162.27 1619.5,-8162.27 1619.5,-8206.27"/>
<text text-anchor="middle" x="1481" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L4</text>
<text text-anchor="middle" x="1481" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 132</text>
<text text-anchor="middle" x="1481" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1481" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_2&#45;&gt;expert_4_2_0 -->
<g id="edge365" class="edge">
<title>route_4_2&#45;&gt;expert_4_2_0</title>
<path fill="none" stroke="black" d="M1685.08,-8245.53C1645.92,-8233.97 1600.49,-8220.55 1562.44,-8209.32"/>
<polygon fill="black" stroke="black" points="1563.01,-8205.84 1552.43,-8206.36 1561.03,-8212.55 1563.01,-8205.84"/>
</g>
<!-- expert_4_2_1 -->
<g id="node303" class="node">
<title>expert_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1914.5,-8206.27 1637.5,-8206.27 1637.5,-8162.27 1914.5,-8162.27 1914.5,-8206.27"/>
<text text-anchor="middle" x="1776" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L4</text>
<text text-anchor="middle" x="1776" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 133</text>
<text text-anchor="middle" x="1776" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1776" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_2&#45;&gt;expert_4_2_1 -->
<g id="edge366" class="edge">
<title>route_4_2&#45;&gt;expert_4_2_1</title>
<path fill="none" stroke="black" d="M1776,-8241.91C1776,-8233.63 1776,-8224.66 1776,-8216.34"/>
<polygon fill="black" stroke="black" points="1779.5,-8216.27 1776,-8206.27 1772.5,-8216.27 1779.5,-8216.27"/>
</g>
<!-- tp_4_2 -->
<g id="node304" class="node">
<title>tp_4_2</title>
<ellipse fill="lightblue" stroke="black" cx="3498" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3498" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L4</text>
<text text-anchor="middle" x="3498" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 132↔133</text>
<text text-anchor="middle" x="3498" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3498" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_2_0&#45;&gt;tp_4_2 -->
<g id="edge367" class="edge">
<title>expert_4_2_0&#45;&gt;tp_4_2</title>
<path fill="none" stroke="black" d="M1619.6,-8163.09C1622.76,-8162.79 1625.9,-8162.52 1629,-8162.27 2015.37,-8130.98 2988.56,-8175.95 3373,-8126.27 3384.67,-8124.76 3396.84,-8122.59 3408.81,-8120.11"/>
<polygon fill="black" stroke="black" points="3409.76,-8123.48 3418.79,-8117.95 3408.28,-8116.64 3409.76,-8123.48"/>
</g>
<!-- expert_4_2_1&#45;&gt;tp_4_2 -->
<g id="edge368" class="edge">
<title>expert_4_2_1&#45;&gt;tp_4_2</title>
<path fill="none" stroke="black" d="M1914.6,-8163.1C1917.76,-8162.81 1920.9,-8162.53 1924,-8162.27 2565.99,-8108.93 2734.29,-8210.17 3373,-8126.27 3384.67,-8124.73 3396.84,-8122.55 3408.8,-8120.06"/>
<polygon fill="black" stroke="black" points="3409.75,-8123.44 3418.79,-8117.9 3408.27,-8116.59 3409.75,-8123.44"/>
</g>
<!-- tp_4_2&#45;&gt;q_proj_5 -->
<g id="edge1578" class="edge">
<title>tp_4_2&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M3577.56,-8072.43C3592.55,-8069.07 3608.18,-8066.05 3623,-8064.04 4101.35,-7999.23 4229.88,-8067.37 4714.65,-8028.1"/>
<polygon fill="black" stroke="black" points="4715.03,-8031.59 4724.71,-8027.28 4714.46,-8024.61 4715.03,-8031.59"/>
</g>
<!-- tp_4_2&#45;&gt;k_proj_5 -->
<g id="edge1579" class="edge">
<title>tp_4_2&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M3577.21,-8072.42C3592.31,-8069.03 3608.06,-8066.01 3623,-8064.04 4239.85,-7982.78 4404.66,-8076.56 5028.56,-8028.11"/>
<polygon fill="black" stroke="black" points="5029.02,-8031.58 5038.71,-8027.31 5028.47,-8024.6 5029.02,-8031.58"/>
</g>
<!-- tp_4_2&#45;&gt;v_proj_5 -->
<g id="edge1580" class="edge">
<title>tp_4_2&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M3578.28,-8072.62C3593.06,-8069.28 3608.43,-8066.22 3623,-8064.04 3894.14,-8023.45 4213.59,-8011.6 4400.46,-8008.24"/>
<polygon fill="black" stroke="black" points="4400.7,-8011.73 4410.64,-8008.06 4400.58,-8004.74 4400.7,-8011.73"/>
</g>
<!-- expert_4_3_0 -->
<g id="node306" class="node">
<title>expert_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2209.5,-8206.27 1932.5,-8206.27 1932.5,-8162.27 2209.5,-8162.27 2209.5,-8206.27"/>
<text text-anchor="middle" x="2071" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L4</text>
<text text-anchor="middle" x="2071" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 134</text>
<text text-anchor="middle" x="2071" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2071" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_3&#45;&gt;expert_4_3_0 -->
<g id="edge370" class="edge">
<title>route_4_3&#45;&gt;expert_4_3_0</title>
<path fill="none" stroke="black" d="M2275.08,-8245.53C2235.92,-8233.97 2190.49,-8220.55 2152.44,-8209.32"/>
<polygon fill="black" stroke="black" points="2153.01,-8205.84 2142.43,-8206.36 2151.03,-8212.55 2153.01,-8205.84"/>
</g>
<!-- expert_4_3_1 -->
<g id="node307" class="node">
<title>expert_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2504.5,-8206.27 2227.5,-8206.27 2227.5,-8162.27 2504.5,-8162.27 2504.5,-8206.27"/>
<text text-anchor="middle" x="2366" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L4</text>
<text text-anchor="middle" x="2366" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 135</text>
<text text-anchor="middle" x="2366" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2366" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_3&#45;&gt;expert_4_3_1 -->
<g id="edge371" class="edge">
<title>route_4_3&#45;&gt;expert_4_3_1</title>
<path fill="none" stroke="black" d="M2366,-8241.91C2366,-8233.63 2366,-8224.66 2366,-8216.34"/>
<polygon fill="black" stroke="black" points="2369.5,-8216.27 2366,-8206.27 2362.5,-8216.27 2369.5,-8216.27"/>
</g>
<!-- tp_4_3 -->
<g id="node308" class="node">
<title>tp_4_3</title>
<ellipse fill="lightblue" stroke="black" cx="3748" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3748" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L4</text>
<text text-anchor="middle" x="3748" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 134↔135</text>
<text text-anchor="middle" x="3748" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3748" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_3_0&#45;&gt;tp_4_3 -->
<g id="edge372" class="edge">
<title>expert_4_3_0&#45;&gt;tp_4_3</title>
<path fill="none" stroke="black" d="M2209.6,-8163.11C2212.76,-8162.81 2215.9,-8162.53 2219,-8162.27 2841.04,-8110.34 3004.14,-8207.81 3623,-8126.27 3634.67,-8124.73 3646.84,-8122.55 3658.8,-8120.05"/>
<polygon fill="black" stroke="black" points="3659.75,-8123.43 3668.79,-8117.89 3658.27,-8116.59 3659.75,-8123.43"/>
</g>
<!-- expert_4_3_1&#45;&gt;tp_4_3 -->
<g id="edge373" class="edge">
<title>expert_4_3_1&#45;&gt;tp_4_3</title>
<path fill="none" stroke="black" d="M2504.6,-8163.14C2507.76,-8162.83 2510.9,-8162.54 2514,-8162.27 3005.3,-8119.56 3134.3,-8192.36 3623,-8126.27 3634.58,-8124.7 3646.65,-8122.52 3658.52,-8120.03"/>
<polygon fill="black" stroke="black" points="3659.41,-8123.42 3668.44,-8117.88 3657.92,-8116.58 3659.41,-8123.42"/>
</g>
<!-- tp_4_3&#45;&gt;q_proj_5 -->
<g id="edge1581" class="edge">
<title>tp_4_3&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M3827.91,-8072.48C3842.8,-8069.13 3858.3,-8066.11 3873,-8064.04 4241.1,-8012.34 4340.69,-8060.08 4714.69,-8028.11"/>
<polygon fill="black" stroke="black" points="4715.05,-8031.59 4724.71,-8027.24 4714.44,-8024.62 4715.05,-8031.59"/>
</g>
<!-- tp_4_3&#45;&gt;k_proj_5 -->
<g id="edge1582" class="edge">
<title>tp_4_3&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M3827.56,-8072.41C3842.55,-8069.05 3858.18,-8066.04 3873,-8064.04 4379.52,-7995.89 4515.47,-8069.22 5028.45,-8028.12"/>
<polygon fill="black" stroke="black" points="5029.03,-8031.58 5038.71,-8027.29 5028.46,-8024.61 5029.03,-8031.58"/>
</g>
<!-- tp_4_3&#45;&gt;v_proj_5 -->
<g id="edge1583" class="edge">
<title>tp_4_3&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M3828.99,-8072.73C3843.57,-8069.43 3858.68,-8066.35 3873,-8064.04 4052.42,-8035.15 4260.75,-8020.47 4400.32,-8013.31"/>
<polygon fill="black" stroke="black" points="4400.86,-8016.79 4410.67,-8012.79 4400.51,-8009.8 4400.86,-8016.79"/>
</g>
<!-- expert_4_4_0 -->
<g id="node310" class="node">
<title>expert_4_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2799.5,-8206.27 2522.5,-8206.27 2522.5,-8162.27 2799.5,-8162.27 2799.5,-8206.27"/>
<text text-anchor="middle" x="2661" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L4</text>
<text text-anchor="middle" x="2661" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 136</text>
<text text-anchor="middle" x="2661" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2661" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_4&#45;&gt;expert_4_4_0 -->
<g id="edge375" class="edge">
<title>route_4_4&#45;&gt;expert_4_4_0</title>
<path fill="none" stroke="black" d="M2865.08,-8245.53C2825.92,-8233.97 2780.49,-8220.55 2742.44,-8209.32"/>
<polygon fill="black" stroke="black" points="2743.01,-8205.84 2732.43,-8206.36 2741.03,-8212.55 2743.01,-8205.84"/>
</g>
<!-- expert_4_4_1 -->
<g id="node311" class="node">
<title>expert_4_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3094.5,-8206.27 2817.5,-8206.27 2817.5,-8162.27 3094.5,-8162.27 3094.5,-8206.27"/>
<text text-anchor="middle" x="2956" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L4</text>
<text text-anchor="middle" x="2956" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 137</text>
<text text-anchor="middle" x="2956" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2956" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_4&#45;&gt;expert_4_4_1 -->
<g id="edge376" class="edge">
<title>route_4_4&#45;&gt;expert_4_4_1</title>
<path fill="none" stroke="black" d="M2956,-8241.91C2956,-8233.63 2956,-8224.66 2956,-8216.34"/>
<polygon fill="black" stroke="black" points="2959.5,-8216.27 2956,-8206.27 2952.5,-8216.27 2959.5,-8216.27"/>
</g>
<!-- tp_4_4 -->
<g id="node312" class="node">
<title>tp_4_4</title>
<ellipse fill="lightblue" stroke="black" cx="3998" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3998" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L4</text>
<text text-anchor="middle" x="3998" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 136↔137</text>
<text text-anchor="middle" x="3998" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3998" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_4_0&#45;&gt;tp_4_4 -->
<g id="edge377" class="edge">
<title>expert_4_4_0&#45;&gt;tp_4_4</title>
<path fill="none" stroke="black" d="M2799.6,-8163.14C2802.76,-8162.83 2805.9,-8162.54 2809,-8162.27 3280.35,-8120.97 3404.15,-8190 3873,-8126.27 3884.58,-8124.69 3896.65,-8122.5 3908.52,-8120.02"/>
<polygon fill="black" stroke="black" points="3909.41,-8123.41 3918.44,-8117.87 3907.92,-8116.57 3909.41,-8123.41"/>
</g>
<!-- expert_4_4_1&#45;&gt;tp_4_4 -->
<g id="edge378" class="edge">
<title>expert_4_4_1&#45;&gt;tp_4_4</title>
<path fill="none" stroke="black" d="M3094.6,-8163.2C3097.76,-8162.87 3100.9,-8162.56 3104,-8162.27 3444.65,-8130.2 3534.27,-8174.55 3873,-8126.27 3884.48,-8124.63 3896.45,-8122.42 3908.24,-8119.93"/>
<polygon fill="black" stroke="black" points="3909.06,-8123.33 3918.08,-8117.78 3907.56,-8116.5 3909.06,-8123.33"/>
</g>
<!-- tp_4_4&#45;&gt;q_proj_5 -->
<g id="edge1584" class="edge">
<title>tp_4_4&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M4078.28,-8072.62C4093.06,-8069.28 4108.43,-8066.22 4123,-8064.04 4380.82,-8025.47 4451.41,-8052.85 4714.46,-8028.15"/>
<polygon fill="black" stroke="black" points="4715.08,-8031.6 4724.7,-8027.17 4714.41,-8024.64 4715.08,-8031.6"/>
</g>
<!-- tp_4_4&#45;&gt;k_proj_5 -->
<g id="edge1585" class="edge">
<title>tp_4_4&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M4077.57,-8072.52C4092.56,-8069.14 4108.19,-8066.1 4123,-8064.04 4519.27,-8008.99 4626.3,-8061.93 5028.54,-8028.12"/>
<polygon fill="black" stroke="black" points="5029.04,-8031.59 5038.71,-8027.25 5028.45,-8024.62 5029.04,-8031.59"/>
</g>
<!-- tp_4_4&#45;&gt;v_proj_5 -->
<g id="edge1586" class="edge">
<title>tp_4_4&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M4080.1,-8073.06C4094.35,-8069.78 4109.06,-8066.62 4123,-8064.04 4214.51,-8047.09 4317.75,-8033.35 4400.79,-8023.62"/>
<polygon fill="black" stroke="black" points="4401.28,-8027.08 4410.81,-8022.45 4400.47,-8020.13 4401.28,-8027.08"/>
</g>
<!-- expert_4_5_0 -->
<g id="node314" class="node">
<title>expert_4_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3389.5,-8206.27 3112.5,-8206.27 3112.5,-8162.27 3389.5,-8162.27 3389.5,-8206.27"/>
<text text-anchor="middle" x="3251" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L4</text>
<text text-anchor="middle" x="3251" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 138</text>
<text text-anchor="middle" x="3251" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3251" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_5&#45;&gt;expert_4_5_0 -->
<g id="edge380" class="edge">
<title>route_4_5&#45;&gt;expert_4_5_0</title>
<path fill="none" stroke="black" d="M3455.08,-8245.53C3415.92,-8233.97 3370.49,-8220.55 3332.44,-8209.32"/>
<polygon fill="black" stroke="black" points="3333.01,-8205.84 3322.43,-8206.36 3331.03,-8212.55 3333.01,-8205.84"/>
</g>
<!-- expert_4_5_1 -->
<g id="node315" class="node">
<title>expert_4_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3684.5,-8206.27 3407.5,-8206.27 3407.5,-8162.27 3684.5,-8162.27 3684.5,-8206.27"/>
<text text-anchor="middle" x="3546" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L4</text>
<text text-anchor="middle" x="3546" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 139</text>
<text text-anchor="middle" x="3546" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3546" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_5&#45;&gt;expert_4_5_1 -->
<g id="edge381" class="edge">
<title>route_4_5&#45;&gt;expert_4_5_1</title>
<path fill="none" stroke="black" d="M3546,-8241.91C3546,-8233.63 3546,-8224.66 3546,-8216.34"/>
<polygon fill="black" stroke="black" points="3549.5,-8216.27 3546,-8206.27 3542.5,-8216.27 3549.5,-8216.27"/>
</g>
<!-- tp_4_5 -->
<g id="node316" class="node">
<title>tp_4_5</title>
<ellipse fill="lightblue" stroke="black" cx="4248" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4248" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L4</text>
<text text-anchor="middle" x="4248" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 138↔139</text>
<text text-anchor="middle" x="4248" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4248" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_5_0&#45;&gt;tp_4_5 -->
<g id="edge382" class="edge">
<title>expert_4_5_0&#45;&gt;tp_4_5</title>
<path fill="none" stroke="black" d="M3389.61,-8163.21C3392.77,-8162.88 3395.9,-8162.56 3399,-8162.27 3719.71,-8131.61 3804.11,-8172.19 4123,-8126.27 4134.48,-8124.61 4146.45,-8122.39 4158.23,-8119.9"/>
<polygon fill="black" stroke="black" points="4159.05,-8123.3 4168.07,-8117.75 4157.56,-8116.46 4159.05,-8123.3"/>
</g>
<!-- expert_4_5_1&#45;&gt;tp_4_5 -->
<g id="edge383" class="edge">
<title>expert_4_5_1&#45;&gt;tp_4_5</title>
<path fill="none" stroke="black" d="M3684.62,-8163.35C3687.78,-8162.98 3690.91,-8162.62 3694,-8162.27 3884.13,-8140.82 3934.11,-8156.76 4123,-8126.27 4134.08,-8124.48 4145.63,-8122.23 4157.03,-8119.77"/>
<polygon fill="black" stroke="black" points="4158,-8123.15 4167,-8117.57 4156.48,-8116.31 4158,-8123.15"/>
</g>
<!-- tp_4_5&#45;&gt;q_proj_5 -->
<g id="edge1587" class="edge">
<title>tp_4_5&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M4329.37,-8072.91C4343.84,-8069.61 4358.81,-8066.48 4373,-8064.04 4520.81,-8038.59 4562.04,-8045.87 4714.48,-8028.2"/>
<polygon fill="black" stroke="black" points="4715.16,-8031.64 4724.68,-8026.99 4714.34,-8024.69 4715.16,-8031.64"/>
</g>
<!-- tp_4_5&#45;&gt;k_proj_5 -->
<g id="edge1588" class="edge">
<title>tp_4_5&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M4328.27,-8072.55C4343.05,-8069.22 4358.42,-8066.18 4373,-8064.04 4659.1,-8022.1 4737.1,-8054.7 5028.68,-8028.12"/>
<polygon fill="black" stroke="black" points="5029.07,-8031.6 5038.7,-8027.19 5028.42,-8024.63 5029.07,-8031.6"/>
</g>
<!-- tp_4_5&#45;&gt;v_proj_5 -->
<g id="edge1589" class="edge">
<title>tp_4_5&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M4326.48,-8072.17C4371.5,-8059.56 4428.05,-8043.72 4474.1,-8030.82"/>
<polygon fill="black" stroke="black" points="4475.08,-8034.18 4483.77,-8028.12 4473.19,-8027.44 4475.08,-8034.18"/>
</g>
<!-- expert_4_6_0 -->
<g id="node318" class="node">
<title>expert_4_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3979.5,-8206.27 3702.5,-8206.27 3702.5,-8162.27 3979.5,-8162.27 3979.5,-8206.27"/>
<text text-anchor="middle" x="3841" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L4</text>
<text text-anchor="middle" x="3841" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 140</text>
<text text-anchor="middle" x="3841" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3841" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_6&#45;&gt;expert_4_6_0 -->
<g id="edge385" class="edge">
<title>route_4_6&#45;&gt;expert_4_6_0</title>
<path fill="none" stroke="black" d="M4045.08,-8245.53C4005.92,-8233.97 3960.49,-8220.55 3922.44,-8209.32"/>
<polygon fill="black" stroke="black" points="3923.01,-8205.84 3912.43,-8206.36 3921.03,-8212.55 3923.01,-8205.84"/>
</g>
<!-- expert_4_6_1 -->
<g id="node319" class="node">
<title>expert_4_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4274.5,-8206.27 3997.5,-8206.27 3997.5,-8162.27 4274.5,-8162.27 4274.5,-8206.27"/>
<text text-anchor="middle" x="4136" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L4</text>
<text text-anchor="middle" x="4136" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 141</text>
<text text-anchor="middle" x="4136" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4136" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_6&#45;&gt;expert_4_6_1 -->
<g id="edge386" class="edge">
<title>route_4_6&#45;&gt;expert_4_6_1</title>
<path fill="none" stroke="black" d="M4136,-8241.91C4136,-8233.63 4136,-8224.66 4136,-8216.34"/>
<polygon fill="black" stroke="black" points="4139.5,-8216.27 4136,-8206.27 4132.5,-8216.27 4139.5,-8216.27"/>
</g>
<!-- tp_4_6 -->
<g id="node320" class="node">
<title>tp_4_6</title>
<ellipse fill="lightblue" stroke="black" cx="4498" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4498" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L4</text>
<text text-anchor="middle" x="4498" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 140↔141</text>
<text text-anchor="middle" x="4498" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4498" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_6_0&#45;&gt;tp_4_6 -->
<g id="edge387" class="edge">
<title>expert_4_6_0&#45;&gt;tp_4_6</title>
<path fill="none" stroke="black" d="M3979.63,-8163.39C3982.78,-8163.01 3985.91,-8162.63 3989,-8162.27 4159.24,-8142.22 4203.91,-8154.41 4373,-8126.27 4384.07,-8124.42 4395.61,-8122.14 4407.02,-8119.67"/>
<polygon fill="black" stroke="black" points="4407.98,-8123.04 4416.98,-8117.45 4406.46,-8116.21 4407.98,-8123.04"/>
</g>
<!-- expert_4_6_1&#45;&gt;tp_4_6 -->
<g id="edge388" class="edge">
<title>expert_4_6_1&#45;&gt;tp_4_6</title>
<path fill="none" stroke="black" d="M4223.51,-8162.23C4268.24,-8151.47 4323.52,-8138.18 4373,-8126.27 4382.87,-8123.89 4393.17,-8121.41 4403.45,-8118.94"/>
<polygon fill="black" stroke="black" points="4404.38,-8122.31 4413.28,-8116.57 4402.74,-8115.51 4404.38,-8122.31"/>
</g>
<!-- tp_4_6&#45;&gt;q_proj_5 -->
<g id="edge1590" class="edge">
<title>tp_4_6&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M4582.35,-8073.69C4595.94,-8070.43 4609.85,-8067.12 4623,-8064.04 4671.15,-8052.75 4724.59,-8040.53 4769.67,-8030.3"/>
<polygon fill="black" stroke="black" points="4770.47,-8033.71 4779.45,-8028.09 4768.92,-8026.88 4770.47,-8033.71"/>
</g>
<!-- tp_4_6&#45;&gt;k_proj_5 -->
<g id="edge1591" class="edge">
<title>tp_4_6&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M4579,-8072.8C4593.58,-8069.48 4608.68,-8066.39 4623,-8064.04 4798.97,-8035.23 4847.76,-8047.61 5028.57,-8028.17"/>
<polygon fill="black" stroke="black" points="5029.13,-8031.63 5038.69,-8027.06 5028.37,-8024.67 5029.13,-8031.63"/>
</g>
<!-- tp_4_6&#45;&gt;v_proj_5 -->
<g id="edge1592" class="edge">
<title>tp_4_6&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M4518.99,-8064.18C4525.26,-8055.22 4532.12,-8045.42 4538.37,-8036.51"/>
<polygon fill="black" stroke="black" points="4541.26,-8038.48 4544.13,-8028.28 4535.52,-8034.47 4541.26,-8038.48"/>
</g>
<!-- expert_4_7_0 -->
<g id="node322" class="node">
<title>expert_4_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4569.5,-8206.27 4292.5,-8206.27 4292.5,-8162.27 4569.5,-8162.27 4569.5,-8206.27"/>
<text text-anchor="middle" x="4431" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L4</text>
<text text-anchor="middle" x="4431" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 142</text>
<text text-anchor="middle" x="4431" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4431" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_7&#45;&gt;expert_4_7_0 -->
<g id="edge390" class="edge">
<title>route_4_7&#45;&gt;expert_4_7_0</title>
<path fill="none" stroke="black" d="M4589.32,-8244.46C4559.66,-8233.37 4525.83,-8220.72 4497.08,-8209.97"/>
<polygon fill="black" stroke="black" points="4498.13,-8206.63 4487.54,-8206.41 4495.68,-8213.19 4498.13,-8206.63"/>
</g>
<!-- expert_4_7_1 -->
<g id="node323" class="node">
<title>expert_4_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4864.5,-8206.27 4587.5,-8206.27 4587.5,-8162.27 4864.5,-8162.27 4864.5,-8206.27"/>
<text text-anchor="middle" x="4726" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L4</text>
<text text-anchor="middle" x="4726" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 143</text>
<text text-anchor="middle" x="4726" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4726" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_7&#45;&gt;expert_4_7_1 -->
<g id="edge391" class="edge">
<title>route_4_7&#45;&gt;expert_4_7_1</title>
<path fill="none" stroke="black" d="M4685.34,-8242.4C4691.71,-8233.45 4698.68,-8223.65 4705.03,-8214.73"/>
<polygon fill="black" stroke="black" points="4707.94,-8216.68 4710.88,-8206.51 4702.23,-8212.63 4707.94,-8216.68"/>
</g>
<!-- tp_4_7 -->
<g id="node324" class="node">
<title>tp_4_7</title>
<ellipse fill="lightblue" stroke="black" cx="4748" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4748" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L4</text>
<text text-anchor="middle" x="4748" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 142↔143</text>
<text text-anchor="middle" x="4748" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4748" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_7_0&#45;&gt;tp_4_7 -->
<g id="edge392" class="edge">
<title>expert_4_7_0&#45;&gt;tp_4_7</title>
<path fill="none" stroke="black" d="M4507.74,-8162.18C4553.34,-8149.65 4611.37,-8133.7 4658.98,-8120.62"/>
<polygon fill="black" stroke="black" points="4659.94,-8123.98 4668.66,-8117.96 4658.09,-8117.23 4659.94,-8123.98"/>
</g>
<!-- expert_4_7_1&#45;&gt;tp_4_7 -->
<g id="edge393" class="edge">
<title>expert_4_7_1&#45;&gt;tp_4_7</title>
<path fill="none" stroke="black" d="M4731.33,-8162.18C4733.3,-8154.35 4735.62,-8145.19 4737.88,-8136.22"/>
<polygon fill="black" stroke="black" points="4741.34,-8136.82 4740.4,-8126.27 4734.55,-8135.11 4741.34,-8136.82"/>
</g>
<!-- tp_4_7&#45;&gt;q_proj_5 -->
<g id="edge1593" class="edge">
<title>tp_4_7&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M4788.58,-8065.87C4803.24,-8055.66 4819.74,-8044.16 4834.24,-8034.05"/>
<polygon fill="black" stroke="black" points="4836.32,-8036.87 4842.52,-8028.28 4832.31,-8031.13 4836.32,-8036.87"/>
</g>
<!-- tp_4_7&#45;&gt;k_proj_5 -->
<g id="edge1594" class="edge">
<title>tp_4_7&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M4831.23,-8073.41C4845.14,-8070.14 4859.46,-8066.9 4873,-8064.04 4931.43,-8051.71 4996.31,-8039.66 5051.87,-8029.84"/>
<polygon fill="black" stroke="black" points="5052.53,-8033.28 5061.77,-8028.09 5051.31,-8026.38 5052.53,-8033.28"/>
</g>
<!-- tp_4_7&#45;&gt;v_proj_5 -->
<g id="edge1595" class="edge">
<title>tp_4_7&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M4691.04,-8067.9C4666.67,-8056.67 4638.32,-8043.6 4614.15,-8032.46"/>
<polygon fill="black" stroke="black" points="4615.31,-8029.14 4604.76,-8028.13 4612.38,-8035.5 4615.31,-8029.14"/>
</g>
<!-- expert_4_8_0 -->
<g id="node326" class="node">
<title>expert_4_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5159.5,-8206.27 4882.5,-8206.27 4882.5,-8162.27 5159.5,-8162.27 5159.5,-8206.27"/>
<text text-anchor="middle" x="5021" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L4</text>
<text text-anchor="middle" x="5021" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="5021" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5021" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_8&#45;&gt;expert_4_8_0 -->
<g id="edge395" class="edge">
<title>route_4_8&#45;&gt;expert_4_8_0</title>
<path fill="none" stroke="black" d="M5062.32,-8242.4C5055.85,-8233.45 5048.76,-8223.65 5042.31,-8214.73"/>
<polygon fill="black" stroke="black" points="5045.06,-8212.56 5036.36,-8206.51 5039.39,-8216.66 5045.06,-8212.56"/>
</g>
<!-- expert_4_8_1 -->
<g id="node327" class="node">
<title>expert_4_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5454.5,-8206.27 5177.5,-8206.27 5177.5,-8162.27 5454.5,-8162.27 5454.5,-8206.27"/>
<text text-anchor="middle" x="5316" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L4</text>
<text text-anchor="middle" x="5316" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="5316" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5316" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_8&#45;&gt;expert_4_8_1 -->
<g id="edge396" class="edge">
<title>route_4_8&#45;&gt;expert_4_8_1</title>
<path fill="none" stroke="black" d="M5158.36,-8244.46C5187.89,-8233.37 5221.58,-8220.72 5250.2,-8209.97"/>
<polygon fill="black" stroke="black" points="5251.57,-8213.2 5259.71,-8206.41 5249.11,-8206.64 5251.57,-8213.2"/>
</g>
<!-- tp_4_8 -->
<g id="node328" class="node">
<title>tp_4_8</title>
<ellipse fill="lightblue" stroke="black" cx="4998" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4998" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L4</text>
<text text-anchor="middle" x="4998" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="4998" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4998" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_8_0&#45;&gt;tp_4_8 -->
<g id="edge397" class="edge">
<title>expert_4_8_0&#45;&gt;tp_4_8</title>
<path fill="none" stroke="black" d="M5015.43,-8162.18C5013.37,-8154.35 5010.95,-8145.19 5008.58,-8136.22"/>
<polygon fill="black" stroke="black" points="5011.89,-8135.04 5005.95,-8126.27 5005.12,-8136.83 5011.89,-8135.04"/>
</g>
<!-- expert_4_8_1&#45;&gt;tp_4_8 -->
<g id="edge398" class="edge">
<title>expert_4_8_1&#45;&gt;tp_4_8</title>
<path fill="none" stroke="black" d="M5239.02,-8162.18C5193.19,-8149.63 5134.84,-8133.64 5087.04,-8120.55"/>
<polygon fill="black" stroke="black" points="5087.88,-8117.15 5077.31,-8117.88 5086.03,-8123.9 5087.88,-8117.15"/>
</g>
<!-- tp_4_8&#45;&gt;q_proj_5 -->
<g id="edge1596" class="edge">
<title>tp_4_8&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M4957.42,-8065.87C4942.76,-8055.66 4926.26,-8044.16 4911.76,-8034.05"/>
<polygon fill="black" stroke="black" points="4913.69,-8031.13 4903.48,-8028.28 4909.68,-8036.87 4913.69,-8031.13"/>
</g>
<!-- tp_4_8&#45;&gt;k_proj_5 -->
<g id="edge1597" class="edge">
<title>tp_4_8&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M5054.96,-8067.9C5079.33,-8056.67 5107.68,-8043.6 5131.85,-8032.46"/>
<polygon fill="black" stroke="black" points="5133.62,-8035.5 5141.24,-8028.13 5130.69,-8029.14 5133.62,-8035.5"/>
</g>
<!-- tp_4_8&#45;&gt;v_proj_5 -->
<g id="edge1598" class="edge">
<title>tp_4_8&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M4914.77,-8073.41C4900.86,-8070.14 4886.54,-8066.9 4873,-8064.04 4814.57,-8051.71 4749.69,-8039.66 4694.13,-8029.84"/>
<polygon fill="black" stroke="black" points="4694.69,-8026.38 4684.23,-8028.09 4693.47,-8033.28 4694.69,-8026.38"/>
</g>
<!-- expert_4_9_0 -->
<g id="node330" class="node">
<title>expert_4_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5749.5,-8206.27 5472.5,-8206.27 5472.5,-8162.27 5749.5,-8162.27 5749.5,-8206.27"/>
<text text-anchor="middle" x="5611" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L4</text>
<text text-anchor="middle" x="5611" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 162</text>
<text text-anchor="middle" x="5611" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5611" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_9&#45;&gt;expert_4_9_0 -->
<g id="edge400" class="edge">
<title>route_4_9&#45;&gt;expert_4_9_0</title>
<path fill="none" stroke="black" d="M5611,-8241.91C5611,-8233.63 5611,-8224.66 5611,-8216.34"/>
<polygon fill="black" stroke="black" points="5614.5,-8216.27 5611,-8206.27 5607.5,-8216.27 5614.5,-8216.27"/>
</g>
<!-- expert_4_9_1 -->
<g id="node331" class="node">
<title>expert_4_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6044.5,-8206.27 5767.5,-8206.27 5767.5,-8162.27 6044.5,-8162.27 6044.5,-8206.27"/>
<text text-anchor="middle" x="5906" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L4</text>
<text text-anchor="middle" x="5906" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 163</text>
<text text-anchor="middle" x="5906" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5906" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_9&#45;&gt;expert_4_9_1 -->
<g id="edge401" class="edge">
<title>route_4_9&#45;&gt;expert_4_9_1</title>
<path fill="none" stroke="black" d="M5701.92,-8245.53C5741.08,-8233.97 5786.51,-8220.55 5824.56,-8209.32"/>
<polygon fill="black" stroke="black" points="5825.97,-8212.55 5834.57,-8206.36 5823.99,-8205.84 5825.97,-8212.55"/>
</g>
<!-- tp_4_9 -->
<g id="node332" class="node">
<title>tp_4_9</title>
<ellipse fill="lightblue" stroke="black" cx="5248" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5248" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L4</text>
<text text-anchor="middle" x="5248" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 162↔163</text>
<text text-anchor="middle" x="5248" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5248" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_9_0&#45;&gt;tp_4_9 -->
<g id="edge402" class="edge">
<title>expert_4_9_0&#45;&gt;tp_4_9</title>
<path fill="none" stroke="black" d="M5523.11,-8162.25C5478.2,-8151.5 5422.68,-8138.2 5373,-8126.27 5363.05,-8123.88 5352.65,-8121.38 5342.29,-8118.88"/>
<polygon fill="black" stroke="black" points="5342.92,-8115.44 5332.38,-8116.5 5341.28,-8122.24 5342.92,-8115.44"/>
</g>
<!-- expert_4_9_1&#45;&gt;tp_4_9 -->
<g id="edge403" class="edge">
<title>expert_4_9_1&#45;&gt;tp_4_9</title>
<path fill="none" stroke="black" d="M5767.14,-8163.25C5764.4,-8162.91 5761.69,-8162.58 5759,-8162.27 5587.89,-8142.08 5542.97,-8154.52 5373,-8126.27 5361.93,-8124.43 5350.39,-8122.15 5338.98,-8119.67"/>
<polygon fill="black" stroke="black" points="5339.54,-8116.21 5329.01,-8117.46 5338.02,-8123.05 5339.54,-8116.21"/>
</g>
<!-- tp_4_9&#45;&gt;q_proj_5 -->
<g id="edge1599" class="edge">
<title>tp_4_9&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M5163.65,-8073.69C5150.06,-8070.43 5136.15,-8067.12 5123,-8064.04 5074.85,-8052.75 5021.41,-8040.53 4976.33,-8030.3"/>
<polygon fill="black" stroke="black" points="4977.08,-8026.88 4966.55,-8028.09 4975.53,-8033.71 4977.08,-8026.88"/>
</g>
<!-- tp_4_9&#45;&gt;k_proj_5 -->
<g id="edge1600" class="edge">
<title>tp_4_9&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M5227.01,-8064.18C5220.74,-8055.22 5213.88,-8045.42 5207.63,-8036.51"/>
<polygon fill="black" stroke="black" points="5210.48,-8034.47 5201.87,-8028.28 5204.74,-8038.48 5210.48,-8034.47"/>
</g>
<!-- tp_4_9&#45;&gt;v_proj_5 -->
<g id="edge1601" class="edge">
<title>tp_4_9&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M5167,-8072.8C5152.42,-8069.48 5137.32,-8066.39 5123,-8064.04 4947.03,-8035.23 4898.24,-8047.61 4717.43,-8028.17"/>
<polygon fill="black" stroke="black" points="4717.63,-8024.67 4707.31,-8027.06 4716.87,-8031.63 4717.63,-8024.67"/>
</g>
<!-- expert_4_10_0 -->
<g id="node334" class="node">
<title>expert_4_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6339.5,-8206.27 6062.5,-8206.27 6062.5,-8162.27 6339.5,-8162.27 6339.5,-8206.27"/>
<text text-anchor="middle" x="6201" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L4</text>
<text text-anchor="middle" x="6201" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 164</text>
<text text-anchor="middle" x="6201" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6201" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_10&#45;&gt;expert_4_10_0 -->
<g id="edge405" class="edge">
<title>route_4_10&#45;&gt;expert_4_10_0</title>
<path fill="none" stroke="black" d="M6201,-8241.91C6201,-8233.63 6201,-8224.66 6201,-8216.34"/>
<polygon fill="black" stroke="black" points="6204.5,-8216.27 6201,-8206.27 6197.5,-8216.27 6204.5,-8216.27"/>
</g>
<!-- expert_4_10_1 -->
<g id="node335" class="node">
<title>expert_4_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6634.5,-8206.27 6357.5,-8206.27 6357.5,-8162.27 6634.5,-8162.27 6634.5,-8206.27"/>
<text text-anchor="middle" x="6496" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L4</text>
<text text-anchor="middle" x="6496" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 165</text>
<text text-anchor="middle" x="6496" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6496" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_10&#45;&gt;expert_4_10_1 -->
<g id="edge406" class="edge">
<title>route_4_10&#45;&gt;expert_4_10_1</title>
<path fill="none" stroke="black" d="M6291.92,-8245.53C6331.08,-8233.97 6376.51,-8220.55 6414.56,-8209.32"/>
<polygon fill="black" stroke="black" points="6415.97,-8212.55 6424.57,-8206.36 6413.99,-8205.84 6415.97,-8212.55"/>
</g>
<!-- tp_4_10 -->
<g id="node336" class="node">
<title>tp_4_10</title>
<ellipse fill="lightblue" stroke="black" cx="5498" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5498" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L4</text>
<text text-anchor="middle" x="5498" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 164↔165</text>
<text text-anchor="middle" x="5498" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5498" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_10_0&#45;&gt;tp_4_10 -->
<g id="edge407" class="edge">
<title>expert_4_10_0&#45;&gt;tp_4_10</title>
<path fill="none" stroke="black" d="M6062.14,-8163.21C6059.41,-8162.89 6056.69,-8162.57 6054,-8162.27 5863,-8140.67 5812.77,-8156.87 5623,-8126.27 5611.92,-8124.48 5600.37,-8122.23 5588.97,-8119.78"/>
<polygon fill="black" stroke="black" points="5589.52,-8116.32 5579,-8117.57 5588,-8123.15 5589.52,-8116.32"/>
</g>
<!-- expert_4_10_1&#45;&gt;tp_4_10 -->
<g id="edge408" class="edge">
<title>expert_4_10_1&#45;&gt;tp_4_10</title>
<path fill="none" stroke="black" d="M6357.16,-8163.08C6354.42,-8162.8 6351.69,-8162.53 6349,-8162.27 6027.42,-8131.39 5942.77,-8172.3 5623,-8126.27 5611.52,-8124.61 5599.55,-8122.39 5587.77,-8119.9"/>
<polygon fill="black" stroke="black" points="5588.44,-8116.47 5577.93,-8117.75 5586.95,-8123.3 5588.44,-8116.47"/>
</g>
<!-- tp_4_10&#45;&gt;q_proj_5 -->
<g id="edge1602" class="edge">
<title>tp_4_10&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M5416.63,-8072.91C5402.16,-8069.61 5387.19,-8066.48 5373,-8064.04 5225.19,-8038.59 5183.96,-8045.87 5031.52,-8028.2"/>
<polygon fill="black" stroke="black" points="5031.66,-8024.69 5021.32,-8026.99 5030.84,-8031.64 5031.66,-8024.69"/>
</g>
<!-- tp_4_10&#45;&gt;k_proj_5 -->
<g id="edge1603" class="edge">
<title>tp_4_10&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M5419.52,-8072.17C5374.5,-8059.56 5317.95,-8043.72 5271.9,-8030.82"/>
<polygon fill="black" stroke="black" points="5272.81,-8027.44 5262.23,-8028.12 5270.92,-8034.18 5272.81,-8027.44"/>
</g>
<!-- tp_4_10&#45;&gt;v_proj_5 -->
<g id="edge1604" class="edge">
<title>tp_4_10&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M5417.73,-8072.55C5402.95,-8069.22 5387.58,-8066.18 5373,-8064.04 5086.9,-8022.1 5008.9,-8054.7 4717.32,-8028.12"/>
<polygon fill="black" stroke="black" points="4717.58,-8024.63 4707.3,-8027.19 4716.93,-8031.6 4717.58,-8024.63"/>
</g>
<!-- expert_4_11_0 -->
<g id="node338" class="node">
<title>expert_4_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6929.5,-8206.27 6652.5,-8206.27 6652.5,-8162.27 6929.5,-8162.27 6929.5,-8206.27"/>
<text text-anchor="middle" x="6791" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L4</text>
<text text-anchor="middle" x="6791" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 166</text>
<text text-anchor="middle" x="6791" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6791" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_11&#45;&gt;expert_4_11_0 -->
<g id="edge410" class="edge">
<title>route_4_11&#45;&gt;expert_4_11_0</title>
<path fill="none" stroke="black" d="M6791,-8241.91C6791,-8233.63 6791,-8224.66 6791,-8216.34"/>
<polygon fill="black" stroke="black" points="6794.5,-8216.27 6791,-8206.27 6787.5,-8216.27 6794.5,-8216.27"/>
</g>
<!-- expert_4_11_1 -->
<g id="node339" class="node">
<title>expert_4_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7224.5,-8206.27 6947.5,-8206.27 6947.5,-8162.27 7224.5,-8162.27 7224.5,-8206.27"/>
<text text-anchor="middle" x="7086" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L4</text>
<text text-anchor="middle" x="7086" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 167</text>
<text text-anchor="middle" x="7086" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7086" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_11&#45;&gt;expert_4_11_1 -->
<g id="edge411" class="edge">
<title>route_4_11&#45;&gt;expert_4_11_1</title>
<path fill="none" stroke="black" d="M6881.92,-8245.53C6921.08,-8233.97 6966.51,-8220.55 7004.56,-8209.32"/>
<polygon fill="black" stroke="black" points="7005.97,-8212.55 7014.57,-8206.36 7003.99,-8205.84 7005.97,-8212.55"/>
</g>
<!-- tp_4_11 -->
<g id="node340" class="node">
<title>tp_4_11</title>
<ellipse fill="lightblue" stroke="black" cx="5748" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5748" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L4</text>
<text text-anchor="middle" x="5748" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 166↔167</text>
<text text-anchor="middle" x="5748" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5748" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_11_0&#45;&gt;tp_4_11 -->
<g id="edge412" class="edge">
<title>expert_4_11_0&#45;&gt;tp_4_11</title>
<path fill="none" stroke="black" d="M6652.16,-8163.07C6649.42,-8162.79 6646.69,-8162.52 6644,-8162.27 6302.48,-8129.97 6212.61,-8174.66 5873,-8126.27 5861.52,-8124.63 5849.55,-8122.42 5837.76,-8119.93"/>
<polygon fill="black" stroke="black" points="5838.44,-8116.5 5827.92,-8117.79 5836.94,-8123.34 5838.44,-8116.5"/>
</g>
<!-- expert_4_11_1&#45;&gt;tp_4_11 -->
<g id="edge413" class="edge">
<title>expert_4_11_1&#45;&gt;tp_4_11</title>
<path fill="none" stroke="black" d="M6947.16,-8163.03C6944.42,-8162.76 6941.7,-8162.5 6939,-8162.27 6466.78,-8120.69 6342.73,-8190.11 5873,-8126.27 5861.42,-8124.69 5849.35,-8122.5 5837.48,-8120.02"/>
<polygon fill="black" stroke="black" points="5838.08,-8116.57 5827.56,-8117.87 5836.59,-8123.41 5838.08,-8116.57"/>
</g>
<!-- tp_4_11&#45;&gt;q_proj_5 -->
<g id="edge1605" class="edge">
<title>tp_4_11&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M5667.72,-8072.62C5652.94,-8069.28 5637.57,-8066.22 5623,-8064.04 5365.18,-8025.47 5294.59,-8052.85 5031.54,-8028.15"/>
<polygon fill="black" stroke="black" points="5031.59,-8024.64 5021.3,-8027.17 5030.92,-8031.6 5031.59,-8024.64"/>
</g>
<!-- tp_4_11&#45;&gt;k_proj_5 -->
<g id="edge1606" class="edge">
<title>tp_4_11&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M5665.9,-8073.06C5651.65,-8069.78 5636.94,-8066.62 5623,-8064.04 5531.49,-8047.09 5428.25,-8033.35 5345.21,-8023.62"/>
<polygon fill="black" stroke="black" points="5345.53,-8020.13 5335.19,-8022.45 5344.72,-8027.08 5345.53,-8020.13"/>
</g>
<!-- tp_4_11&#45;&gt;v_proj_5 -->
<g id="edge1607" class="edge">
<title>tp_4_11&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M5668.43,-8072.52C5653.44,-8069.14 5637.81,-8066.1 5623,-8064.04 5226.73,-8008.99 5119.7,-8061.93 4717.46,-8028.12"/>
<polygon fill="black" stroke="black" points="4717.55,-8024.62 4707.29,-8027.25 4716.96,-8031.59 4717.55,-8024.62"/>
</g>
<!-- expert_4_12_0 -->
<g id="node342" class="node">
<title>expert_4_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7519.5,-8206.27 7242.5,-8206.27 7242.5,-8162.27 7519.5,-8162.27 7519.5,-8206.27"/>
<text text-anchor="middle" x="7381" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L4</text>
<text text-anchor="middle" x="7381" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 168</text>
<text text-anchor="middle" x="7381" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7381" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_12&#45;&gt;expert_4_12_0 -->
<g id="edge415" class="edge">
<title>route_4_12&#45;&gt;expert_4_12_0</title>
<path fill="none" stroke="black" d="M7381,-8241.91C7381,-8233.63 7381,-8224.66 7381,-8216.34"/>
<polygon fill="black" stroke="black" points="7384.5,-8216.27 7381,-8206.27 7377.5,-8216.27 7384.5,-8216.27"/>
</g>
<!-- expert_4_12_1 -->
<g id="node343" class="node">
<title>expert_4_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7814.5,-8206.27 7537.5,-8206.27 7537.5,-8162.27 7814.5,-8162.27 7814.5,-8206.27"/>
<text text-anchor="middle" x="7676" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L4</text>
<text text-anchor="middle" x="7676" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 169</text>
<text text-anchor="middle" x="7676" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7676" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_12&#45;&gt;expert_4_12_1 -->
<g id="edge416" class="edge">
<title>route_4_12&#45;&gt;expert_4_12_1</title>
<path fill="none" stroke="black" d="M7471.92,-8245.53C7511.08,-8233.97 7556.51,-8220.55 7594.56,-8209.32"/>
<polygon fill="black" stroke="black" points="7595.97,-8212.55 7604.57,-8206.36 7593.99,-8205.84 7595.97,-8212.55"/>
</g>
<!-- tp_4_12 -->
<g id="node344" class="node">
<title>tp_4_12</title>
<ellipse fill="lightblue" stroke="black" cx="5998" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5998" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L4</text>
<text text-anchor="middle" x="5998" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 168↔169</text>
<text text-anchor="middle" x="5998" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5998" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_12_0&#45;&gt;tp_4_12 -->
<g id="edge417" class="edge">
<title>expert_4_12_0&#45;&gt;tp_4_12</title>
<path fill="none" stroke="black" d="M7242.16,-8163.02C7239.42,-8162.75 7236.7,-8162.5 7234,-8162.27 6741.84,-8119.27 6612.58,-8192.46 6123,-8126.27 6111.42,-8124.7 6099.35,-8122.52 6087.48,-8120.03"/>
<polygon fill="black" stroke="black" points="6088.08,-8116.58 6077.56,-8117.88 6086.59,-8123.42 6088.08,-8116.58"/>
</g>
<!-- expert_4_12_1&#45;&gt;tp_4_12 -->
<g id="edge418" class="edge">
<title>expert_4_12_1&#45;&gt;tp_4_12</title>
<path fill="none" stroke="black" d="M7537.16,-8163C7534.42,-8162.74 7531.7,-8162.49 7529,-8162.27 6906.1,-8109.98 6742.74,-8207.92 6123,-8126.27 6111.33,-8124.73 6099.16,-8122.55 6087.2,-8120.05"/>
<polygon fill="black" stroke="black" points="6087.73,-8116.59 6077.21,-8117.89 6086.25,-8123.43 6087.73,-8116.59"/>
</g>
<!-- tp_4_12&#45;&gt;q_proj_5 -->
<g id="edge1608" class="edge">
<title>tp_4_12&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M5918.09,-8072.48C5903.2,-8069.13 5887.7,-8066.11 5873,-8064.04 5504.9,-8012.34 5405.31,-8060.08 5031.31,-8028.11"/>
<polygon fill="black" stroke="black" points="5031.56,-8024.62 5021.29,-8027.24 5030.95,-8031.59 5031.56,-8024.62"/>
</g>
<!-- tp_4_12&#45;&gt;k_proj_5 -->
<g id="edge1609" class="edge">
<title>tp_4_12&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M5917.01,-8072.73C5902.43,-8069.43 5887.32,-8066.35 5873,-8064.04 5693.58,-8035.15 5485.25,-8020.47 5345.68,-8013.31"/>
<polygon fill="black" stroke="black" points="5345.49,-8009.8 5335.33,-8012.79 5345.14,-8016.79 5345.49,-8009.8"/>
</g>
<!-- tp_4_12&#45;&gt;v_proj_5 -->
<g id="edge1610" class="edge">
<title>tp_4_12&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M5918.44,-8072.41C5903.45,-8069.05 5887.82,-8066.04 5873,-8064.04 5366.48,-7995.89 5230.53,-8069.22 4717.55,-8028.12"/>
<polygon fill="black" stroke="black" points="4717.54,-8024.61 4707.29,-8027.29 4716.97,-8031.58 4717.54,-8024.61"/>
</g>
<!-- expert_4_13_0 -->
<g id="node346" class="node">
<title>expert_4_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8109.5,-8206.27 7832.5,-8206.27 7832.5,-8162.27 8109.5,-8162.27 8109.5,-8206.27"/>
<text text-anchor="middle" x="7971" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L4</text>
<text text-anchor="middle" x="7971" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 170</text>
<text text-anchor="middle" x="7971" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7971" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_13&#45;&gt;expert_4_13_0 -->
<g id="edge420" class="edge">
<title>route_4_13&#45;&gt;expert_4_13_0</title>
<path fill="none" stroke="black" d="M7971,-8241.91C7971,-8233.63 7971,-8224.66 7971,-8216.34"/>
<polygon fill="black" stroke="black" points="7974.5,-8216.27 7971,-8206.27 7967.5,-8216.27 7974.5,-8216.27"/>
</g>
<!-- expert_4_13_1 -->
<g id="node347" class="node">
<title>expert_4_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8404.5,-8206.27 8127.5,-8206.27 8127.5,-8162.27 8404.5,-8162.27 8404.5,-8206.27"/>
<text text-anchor="middle" x="8266" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L4</text>
<text text-anchor="middle" x="8266" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 171</text>
<text text-anchor="middle" x="8266" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8266" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_13&#45;&gt;expert_4_13_1 -->
<g id="edge421" class="edge">
<title>route_4_13&#45;&gt;expert_4_13_1</title>
<path fill="none" stroke="black" d="M8061.92,-8245.53C8101.08,-8233.97 8146.51,-8220.55 8184.56,-8209.32"/>
<polygon fill="black" stroke="black" points="8185.97,-8212.55 8194.57,-8206.36 8183.99,-8205.84 8185.97,-8212.55"/>
</g>
<!-- tp_4_13 -->
<g id="node348" class="node">
<title>tp_4_13</title>
<ellipse fill="lightblue" stroke="black" cx="6248" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6248" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L4</text>
<text text-anchor="middle" x="6248" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 170↔171</text>
<text text-anchor="middle" x="6248" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6248" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_13_0&#45;&gt;tp_4_13 -->
<g id="edge422" class="edge">
<title>expert_4_13_0&#45;&gt;tp_4_13</title>
<path fill="none" stroke="black" d="M7832.16,-8162.99C7829.42,-8162.73 7826.7,-8162.49 7824,-8162.27 7181.15,-8108.56 7012.59,-8210.28 6373,-8126.27 6361.33,-8124.73 6349.16,-8122.56 6337.2,-8120.06"/>
<polygon fill="black" stroke="black" points="6337.73,-8116.59 6327.21,-8117.9 6336.25,-8123.44 6337.73,-8116.59"/>
</g>
<!-- expert_4_13_1&#45;&gt;tp_4_13 -->
<g id="edge423" class="edge">
<title>expert_4_13_1&#45;&gt;tp_4_13</title>
<path fill="none" stroke="black" d="M8127.17,-8162.98C8124.42,-8162.72 8121.7,-8162.49 8119,-8162.27 7732.2,-8130.77 6757.88,-8176 6373,-8126.27 6361.33,-8124.76 6349.16,-8122.59 6337.19,-8120.11"/>
<polygon fill="black" stroke="black" points="6337.72,-8116.64 6327.21,-8117.95 6336.24,-8123.48 6337.72,-8116.64"/>
</g>
<!-- tp_4_13&#45;&gt;q_proj_5 -->
<g id="edge1611" class="edge">
<title>tp_4_13&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M6168.44,-8072.43C6153.45,-8069.07 6137.82,-8066.05 6123,-8064.04 5644.65,-7999.23 5516.12,-8067.37 5031.35,-8028.1"/>
<polygon fill="black" stroke="black" points="5031.54,-8024.61 5021.29,-8027.28 5030.97,-8031.59 5031.54,-8024.61"/>
</g>
<!-- tp_4_13&#45;&gt;k_proj_5 -->
<g id="edge1612" class="edge">
<title>tp_4_13&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M6167.72,-8072.62C6152.94,-8069.28 6137.57,-8066.22 6123,-8064.04 5851.86,-8023.45 5532.41,-8011.6 5345.54,-8008.24"/>
<polygon fill="black" stroke="black" points="5345.42,-8004.74 5335.36,-8008.06 5345.3,-8011.73 5345.42,-8004.74"/>
</g>
<!-- tp_4_13&#45;&gt;v_proj_5 -->
<g id="edge1613" class="edge">
<title>tp_4_13&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M6168.79,-8072.42C6153.69,-8069.03 6137.94,-8066.01 6123,-8064.04 5506.15,-7982.78 5341.34,-8076.56 4717.44,-8028.11"/>
<polygon fill="black" stroke="black" points="4717.53,-8024.6 4707.29,-8027.31 4716.98,-8031.58 4717.53,-8024.6"/>
</g>
<!-- expert_4_14_0 -->
<g id="node350" class="node">
<title>expert_4_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8699.5,-8206.27 8422.5,-8206.27 8422.5,-8162.27 8699.5,-8162.27 8699.5,-8206.27"/>
<text text-anchor="middle" x="8561" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L4</text>
<text text-anchor="middle" x="8561" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 172</text>
<text text-anchor="middle" x="8561" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8561" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_14&#45;&gt;expert_4_14_0 -->
<g id="edge425" class="edge">
<title>route_4_14&#45;&gt;expert_4_14_0</title>
<path fill="none" stroke="black" d="M8561,-8241.91C8561,-8233.63 8561,-8224.66 8561,-8216.34"/>
<polygon fill="black" stroke="black" points="8564.5,-8216.27 8561,-8206.27 8557.5,-8216.27 8564.5,-8216.27"/>
</g>
<!-- expert_4_14_1 -->
<g id="node351" class="node">
<title>expert_4_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8994.5,-8206.27 8717.5,-8206.27 8717.5,-8162.27 8994.5,-8162.27 8994.5,-8206.27"/>
<text text-anchor="middle" x="8856" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L4</text>
<text text-anchor="middle" x="8856" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 173</text>
<text text-anchor="middle" x="8856" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8856" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_14&#45;&gt;expert_4_14_1 -->
<g id="edge426" class="edge">
<title>route_4_14&#45;&gt;expert_4_14_1</title>
<path fill="none" stroke="black" d="M8651.92,-8245.53C8691.08,-8233.97 8736.51,-8220.55 8774.56,-8209.32"/>
<polygon fill="black" stroke="black" points="8775.97,-8212.55 8784.57,-8206.36 8773.99,-8205.84 8775.97,-8212.55"/>
</g>
<!-- tp_4_14 -->
<g id="node352" class="node">
<title>tp_4_14</title>
<ellipse fill="lightblue" stroke="black" cx="6498" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6498" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L4</text>
<text text-anchor="middle" x="6498" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 172↔173</text>
<text text-anchor="middle" x="6498" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6498" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_14_0&#45;&gt;tp_4_14 -->
<g id="edge427" class="edge">
<title>expert_4_14_0&#45;&gt;tp_4_14</title>
<path fill="none" stroke="black" d="M8422.17,-8162.97C8419.42,-8162.72 8416.7,-8162.49 8414,-8162.27 8017.22,-8130.06 7017.81,-8177.18 6623,-8126.27 6611.33,-8124.76 6599.16,-8122.6 6587.19,-8120.11"/>
<polygon fill="black" stroke="black" points="6587.72,-8116.65 6577.21,-8117.96 6586.24,-8123.49 6587.72,-8116.65"/>
</g>
<!-- expert_4_14_1&#45;&gt;tp_4_14 -->
<g id="edge428" class="edge">
<title>expert_4_14_1&#45;&gt;tp_4_14</title>
<path fill="none" stroke="black" d="M8717.17,-8162.96C8714.42,-8162.72 8711.7,-8162.48 8709,-8162.27 8246.84,-8125.41 7082.9,-8184.91 6623,-8126.27 6611.32,-8124.78 6599.15,-8122.63 6587.19,-8120.14"/>
<polygon fill="black" stroke="black" points="6587.71,-8116.68 6577.2,-8117.99 6586.24,-8123.52 6587.71,-8116.68"/>
</g>
<!-- tp_4_14&#45;&gt;q_proj_5 -->
<g id="edge1614" class="edge">
<title>tp_4_14&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M6418.45,-8072.36C6403.45,-8069 6387.83,-8066 6373,-8064.04 5784.38,-7986.13 5626.96,-8074.68 5031.42,-8028.11"/>
<polygon fill="black" stroke="black" points="5031.53,-8024.6 5021.29,-8027.3 5030.98,-8031.58 5031.53,-8024.6"/>
</g>
<!-- tp_4_14&#45;&gt;k_proj_5 -->
<g id="edge1615" class="edge">
<title>tp_4_14&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M6418.08,-8072.54C6403.19,-8069.19 6387.69,-8066.15 6373,-8064.04 6179.37,-8036.32 5621.04,-8018.37 5345.15,-8010.95"/>
<polygon fill="black" stroke="black" points="5345.14,-8007.44 5335.05,-8010.68 5344.95,-8014.44 5345.14,-8007.44"/>
</g>
<!-- tp_4_14&#45;&gt;v_proj_5 -->
<g id="edge1616" class="edge">
<title>tp_4_14&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M6418.79,-8072.37C6403.7,-8068.99 6387.94,-8065.98 6373,-8064.04 6010.96,-8017.06 5099.42,-8055.81 4717.33,-8028.08"/>
<polygon fill="black" stroke="black" points="4717.52,-8024.58 4707.29,-8027.32 4717,-8031.56 4717.52,-8024.58"/>
</g>
<!-- expert_4_15_0 -->
<g id="node354" class="node">
<title>expert_4_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9289.5,-8206.27 9012.5,-8206.27 9012.5,-8162.27 9289.5,-8162.27 9289.5,-8206.27"/>
<text text-anchor="middle" x="9151" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L4</text>
<text text-anchor="middle" x="9151" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 174</text>
<text text-anchor="middle" x="9151" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9151" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_15&#45;&gt;expert_4_15_0 -->
<g id="edge430" class="edge">
<title>route_4_15&#45;&gt;expert_4_15_0</title>
<path fill="none" stroke="black" d="M9151,-8241.91C9151,-8233.63 9151,-8224.66 9151,-8216.34"/>
<polygon fill="black" stroke="black" points="9154.5,-8216.27 9151,-8206.27 9147.5,-8216.27 9154.5,-8216.27"/>
</g>
<!-- expert_4_15_1 -->
<g id="node355" class="node">
<title>expert_4_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9584.5,-8206.27 9307.5,-8206.27 9307.5,-8162.27 9584.5,-8162.27 9584.5,-8206.27"/>
<text text-anchor="middle" x="9446" y="-8197.07" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L4</text>
<text text-anchor="middle" x="9446" y="-8187.07" font-family="Times,serif" font-size="9.00">GPU: 175</text>
<text text-anchor="middle" x="9446" y="-8177.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9446" y="-8167.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_15&#45;&gt;expert_4_15_1 -->
<g id="edge431" class="edge">
<title>route_4_15&#45;&gt;expert_4_15_1</title>
<path fill="none" stroke="black" d="M9241.92,-8245.53C9281.08,-8233.97 9326.51,-8220.55 9364.56,-8209.32"/>
<polygon fill="black" stroke="black" points="9365.97,-8212.55 9374.57,-8206.36 9363.99,-8205.84 9365.97,-8212.55"/>
</g>
<!-- tp_4_15 -->
<g id="node356" class="node">
<title>tp_4_15</title>
<ellipse fill="lightblue" stroke="black" cx="6748" cy="-8095.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6748" y="-8107.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L4</text>
<text text-anchor="middle" x="6748" y="-8097.95" font-family="Times,serif" font-size="9.00">GPU: 174↔175</text>
<text text-anchor="middle" x="6748" y="-8087.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6748" y="-8077.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_15_0&#45;&gt;tp_4_15 -->
<g id="edge432" class="edge">
<title>expert_4_15_0&#45;&gt;tp_4_15</title>
<path fill="none" stroke="black" d="M9012.16,-8163.01C9009.42,-8162.75 9006.7,-8162.5 9004,-8162.27 8585.38,-8126.35 7284.95,-8104.21 6873.89,-8097.98"/>
<polygon fill="black" stroke="black" points="6873.8,-8094.47 6863.75,-8097.82 6873.7,-8101.47 6873.8,-8094.47"/>
</g>
<!-- expert_4_15_1&#45;&gt;tp_4_15 -->
<g id="edge433" class="edge">
<title>expert_4_15_1&#45;&gt;tp_4_15</title>
<path fill="none" stroke="black" d="M9307.16,-8163C9304.42,-8162.74 9301.7,-8162.49 9299,-8162.27 8819.93,-8121.98 7319.66,-8102.48 6874.03,-8097.48"/>
<polygon fill="black" stroke="black" points="6874.05,-8093.98 6864.02,-8097.37 6873.98,-8100.98 6874.05,-8093.98"/>
</g>
<!-- tp_4_15&#45;&gt;q_proj_5 -->
<g id="edge1617" class="edge">
<title>tp_4_15&#45;&gt;q_proj_5</title>
<path fill="none" stroke="black" d="M6668.79,-8072.38C6653.69,-8069 6637.94,-8065.99 6623,-8064.04 6275.13,-8018.74 5399.47,-8054.87 5031.49,-8028.09"/>
<polygon fill="black" stroke="black" points="5031.52,-8024.58 5021.29,-8027.32 5031,-8031.56 5031.52,-8024.58"/>
</g>
<!-- tp_4_15&#45;&gt;k_proj_5 -->
<g id="edge1618" class="edge">
<title>tp_4_15&#45;&gt;k_proj_5</title>
<path fill="none" stroke="black" d="M6668.43,-8072.52C6653.44,-8069.14 6637.81,-8066.1 6623,-8064.04 6380.51,-8030.36 5665.94,-8014.82 5345.56,-8009.4"/>
<polygon fill="black" stroke="black" points="5345.32,-8005.9 5335.27,-8009.23 5345.21,-8012.9 5345.32,-8005.9"/>
</g>
<!-- tp_4_15&#45;&gt;v_proj_5 -->
<g id="edge1619" class="edge">
<title>tp_4_15&#45;&gt;v_proj_5</title>
<path fill="none" stroke="black" d="M6668.8,-8072.34C6653.7,-8068.96 6637.94,-8065.96 6623,-8064.04 6205.88,-8010.51 5155.22,-8059.41 4717.51,-8028.09"/>
<polygon fill="black" stroke="black" points="4717.52,-8024.58 4707.29,-8027.33 4717,-8031.56 4717.52,-8024.58"/>
</g>
<!-- attn_scores_5 -->
<g id="node360" class="node">
<title>attn_scores_5</title>
<polygon fill="lightgreen" stroke="black" points="5039.5,-7948.04 4706.5,-7948.04 4706.5,-7904.04 5039.5,-7904.04 5039.5,-7948.04"/>
<text text-anchor="middle" x="4873" y="-7938.84" font-family="Times,serif" font-size="9.00">Attention Scores L5</text>
<text text-anchor="middle" x="4873" y="-7928.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4873" y="-7918.84" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7908.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_5&#45;&gt;attn_scores_5 -->
<g id="edge434" class="edge">
<title>q_proj_5&#45;&gt;attn_scores_5</title>
<path fill="none" stroke="black" d="M4873,-7983.73C4873,-7975.84 4873,-7966.73 4873,-7958.14"/>
<polygon fill="black" stroke="black" points="4876.5,-7958.06 4873,-7948.06 4869.5,-7958.06 4876.5,-7958.06"/>
</g>
<!-- k_proj_5&#45;&gt;attn_scores_5 -->
<g id="edge435" class="edge">
<title>k_proj_5&#45;&gt;attn_scores_5</title>
<path fill="none" stroke="black" d="M5102.44,-7984.04C5060.82,-7973.7 5010.49,-7961.2 4967.59,-7950.54"/>
<polygon fill="black" stroke="black" points="4968.26,-7947.1 4957.71,-7948.08 4966.57,-7953.89 4968.26,-7947.1"/>
</g>
<!-- v_proj_5&#45;&gt;attn_scores_5 -->
<g id="edge436" class="edge">
<title>v_proj_5&#45;&gt;attn_scores_5</title>
<path fill="none" stroke="black" d="M4643.56,-7984.04C4685.18,-7973.7 4735.51,-7961.2 4778.41,-7950.54"/>
<polygon fill="black" stroke="black" points="4779.43,-7953.89 4788.29,-7948.08 4777.74,-7947.1 4779.43,-7953.89"/>
</g>
<!-- softmax_5 -->
<g id="node361" class="node">
<title>softmax_5</title>
<polygon fill="lightgreen" stroke="black" points="5039.5,-7868.04 4706.5,-7868.04 4706.5,-7824.04 5039.5,-7824.04 5039.5,-7868.04"/>
<text text-anchor="middle" x="4873" y="-7858.84" font-family="Times,serif" font-size="9.00">Softmax L5</text>
<text text-anchor="middle" x="4873" y="-7848.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4873" y="-7838.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4873" y="-7828.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_5&#45;&gt;softmax_5 -->
<g id="edge437" class="edge">
<title>attn_scores_5&#45;&gt;softmax_5</title>
<path fill="none" stroke="black" d="M4873,-7903.73C4873,-7895.84 4873,-7886.73 4873,-7878.14"/>
<polygon fill="black" stroke="black" points="4876.5,-7878.06 4873,-7868.06 4869.5,-7878.06 4876.5,-7878.06"/>
</g>
<!-- attn_out_5 -->
<g id="node362" class="node">
<title>attn_out_5</title>
<polygon fill="lightgreen" stroke="black" points="5021,-7788.04 4725,-7788.04 4725,-7744.04 5021,-7744.04 5021,-7788.04"/>
<text text-anchor="middle" x="4873" y="-7778.84" font-family="Times,serif" font-size="9.00">Attention Output L5</text>
<text text-anchor="middle" x="4873" y="-7768.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="4873" y="-7758.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7748.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_5&#45;&gt;attn_out_5 -->
<g id="edge438" class="edge">
<title>softmax_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M4873,-7823.73C4873,-7815.84 4873,-7806.73 4873,-7798.14"/>
<polygon fill="black" stroke="black" points="4876.5,-7798.06 4873,-7788.06 4869.5,-7798.06 4876.5,-7798.06"/>
</g>
<!-- gate_5 -->
<g id="node363" class="node">
<title>gate_5</title>
<polygon fill="lightyellow" stroke="black" points="5172.74,-7708.04 4695.92,-7708.04 4573.26,-7620.04 5050.08,-7620.04 5172.74,-7708.04"/>
<text text-anchor="middle" x="4873" y="-7676.84" font-family="Times,serif" font-size="9.00">Gate L5</text>
<text text-anchor="middle" x="4873" y="-7666.84" font-family="Times,serif" font-size="9.00">GPU: 128&#45;191</text>
<text text-anchor="middle" x="4873" y="-7656.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7646.84" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_5&#45;&gt;gate_5 -->
<g id="edge439" class="edge">
<title>attn_out_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M4873,-7743.83C4873,-7736.34 4873,-7727.53 4873,-7718.57"/>
<polygon fill="black" stroke="black" points="4876.5,-7718.45 4873,-7708.45 4869.5,-7718.45 4876.5,-7718.45"/>
</g>
<!-- route_5_0 -->
<g id="node364" class="node">
<title>route_5_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="596" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="596" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="596" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="596" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="596" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_0 -->
<g id="edge440" class="edge">
<title>gate_5&#45;&gt;route_5_0</title>
<path fill="none" stroke="black" d="M4633.09,-7663.08C4022.43,-7662.12 2359.63,-7652.83 976,-7584.04 910.75,-7580.8 839.32,-7575.58 776.17,-7570.39"/>
<polygon fill="black" stroke="black" points="776.36,-7566.89 766.11,-7569.56 775.79,-7573.87 776.36,-7566.89"/>
</g>
<!-- route_5_1 -->
<g id="node368" class="node">
<title>route_5_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1186" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1186" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1186" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 130,131</text>
<text text-anchor="middle" x="1186" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1186" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_1 -->
<g id="edge445" class="edge">
<title>gate_5&#45;&gt;route_5_1</title>
<path fill="none" stroke="black" d="M4631.4,-7661.83C4084.99,-7658.1 2712.53,-7643.12 1566,-7584.04 1500.91,-7580.69 1429.67,-7575.46 1366.63,-7570.29"/>
<polygon fill="black" stroke="black" points="1366.84,-7566.8 1356.59,-7569.46 1366.27,-7573.77 1366.84,-7566.8"/>
</g>
<!-- route_5_2 -->
<g id="node372" class="node">
<title>route_5_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1776" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1776" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1776" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 132,133</text>
<text text-anchor="middle" x="1776" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1776" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_2 -->
<g id="edge450" class="edge">
<title>gate_5&#45;&gt;route_5_2</title>
<path fill="none" stroke="black" d="M4628.82,-7660.03C4152.8,-7653.26 3067.5,-7633.38 2156,-7584.04 2091.08,-7580.53 2020.02,-7575.28 1957.1,-7570.14"/>
<polygon fill="black" stroke="black" points="1957.32,-7566.64 1947.07,-7569.31 1956.75,-7573.62 1957.32,-7566.64"/>
</g>
<!-- route_5_3 -->
<g id="node376" class="node">
<title>route_5_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2366" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2366" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2366" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 134,135</text>
<text text-anchor="middle" x="2366" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2366" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_3 -->
<g id="edge455" class="edge">
<title>gate_5&#45;&gt;route_5_3</title>
<path fill="none" stroke="black" d="M4624.78,-7657.2C4227.71,-7647.09 3425.24,-7623.55 2746,-7584.04 2681.41,-7580.28 2610.73,-7575.01 2548.03,-7569.91"/>
<polygon fill="black" stroke="black" points="2548.29,-7566.42 2538.04,-7569.1 2547.72,-7573.4 2548.29,-7566.42"/>
</g>
<!-- route_5_4 -->
<g id="node380" class="node">
<title>route_5_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2956" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2956" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2956" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 136,137</text>
<text text-anchor="middle" x="2956" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2956" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_4 -->
<g id="edge460" class="edge">
<title>gate_5&#45;&gt;route_5_4</title>
<path fill="none" stroke="black" d="M4617.91,-7652.1C4312.88,-7638.51 3786.93,-7613.49 3336,-7584.04 3272.04,-7579.86 3202.08,-7574.54 3139.82,-7569.53"/>
<polygon fill="black" stroke="black" points="3139.74,-7566.01 3129.49,-7568.7 3139.18,-7572.99 3139.74,-7566.01"/>
</g>
<!-- route_5_5 -->
<g id="node384" class="node">
<title>route_5_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3546" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3546" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3546" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 138,139</text>
<text text-anchor="middle" x="3546" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3546" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_5 -->
<g id="edge465" class="edge">
<title>gate_5&#45;&gt;route_5_5</title>
<path fill="none" stroke="black" d="M4602.06,-7640.76C4342.32,-7619.41 3957.23,-7587.74 3730.92,-7569.13"/>
<polygon fill="black" stroke="black" points="3731.18,-7565.64 3720.93,-7568.31 3730.61,-7572.62 3731.18,-7565.64"/>
</g>
<!-- route_5_6 -->
<g id="node388" class="node">
<title>route_5_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4136" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4136" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4136" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 140,141</text>
<text text-anchor="middle" x="4136" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4136" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_6 -->
<g id="edge470" class="edge">
<title>gate_5&#45;&gt;route_5_6</title>
<path fill="none" stroke="black" d="M4582.51,-7620.04C4481.8,-7605.12 4372.94,-7589.01 4287.92,-7576.42"/>
<polygon fill="black" stroke="black" points="4288.34,-7572.94 4277.93,-7574.94 4287.31,-7579.87 4288.34,-7572.94"/>
</g>
<!-- route_5_7 -->
<g id="node392" class="node">
<title>route_5_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4663" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4663" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4663" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 142,143</text>
<text text-anchor="middle" x="4663" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4663" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_7 -->
<g id="edge475" class="edge">
<title>gate_5&#45;&gt;route_5_7</title>
<path fill="none" stroke="black" d="M4790,-7619.92C4769.22,-7609.12 4747.24,-7597.7 4727.51,-7587.45"/>
<polygon fill="black" stroke="black" points="4729.1,-7584.33 4718.62,-7582.83 4725.88,-7590.54 4729.1,-7584.33"/>
</g>
<!-- route_5_8 -->
<g id="node396" class="node">
<title>route_5_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5083" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5083" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5083" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="5083" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5083" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_8 -->
<g id="edge480" class="edge">
<title>gate_5&#45;&gt;route_5_8</title>
<path fill="none" stroke="black" d="M4956,-7619.92C4976.78,-7609.12 4998.76,-7597.7 5018.49,-7587.45"/>
<polygon fill="black" stroke="black" points="5020.12,-7590.54 5027.38,-7582.83 5016.9,-7584.33 5020.12,-7590.54"/>
</g>
<!-- route_5_9 -->
<g id="node400" class="node">
<title>route_5_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5611" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5611" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5611" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 162,163</text>
<text text-anchor="middle" x="5611" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5611" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_9 -->
<g id="edge485" class="edge">
<title>gate_5&#45;&gt;route_5_9</title>
<path fill="none" stroke="black" d="M5069.8,-7633.95C5191.76,-7615.91 5346.08,-7593.1 5458.69,-7576.45"/>
<polygon fill="black" stroke="black" points="5459.39,-7579.88 5468.77,-7574.96 5458.37,-7572.96 5459.39,-7579.88"/>
</g>
<!-- route_5_10 -->
<g id="node404" class="node">
<title>route_5_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6201" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6201" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6201" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 164,165</text>
<text text-anchor="middle" x="6201" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6201" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_10 -->
<g id="edge490" class="edge">
<title>gate_5&#45;&gt;route_5_10</title>
<path fill="none" stroke="black" d="M5086,-7645.54C5343.37,-7624.4 5772.14,-7589.17 6016.18,-7569.12"/>
<polygon fill="black" stroke="black" points="6016.54,-7572.6 6026.22,-7568.29 6015.96,-7565.62 6016.54,-7572.6"/>
</g>
<!-- route_5_11 -->
<g id="node408" class="node">
<title>route_5_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6791" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6791" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6791" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 166,167</text>
<text text-anchor="middle" x="6791" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6791" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_11 -->
<g id="edge495" class="edge">
<title>gate_5&#45;&gt;route_5_11</title>
<path fill="none" stroke="black" d="M5096.94,-7653.49C5396.44,-7640.27 5943.94,-7614.54 6411,-7584.04 6474.96,-7579.87 6544.92,-7574.54 6607.18,-7569.53"/>
<polygon fill="black" stroke="black" points="6607.82,-7572.99 6617.51,-7568.7 6607.26,-7566.01 6607.82,-7572.99"/>
</g>
<!-- route_5_12 -->
<g id="node412" class="node">
<title>route_5_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7381" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7381" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7381" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 168,169</text>
<text text-anchor="middle" x="7381" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7381" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_12 -->
<g id="edge500" class="edge">
<title>gate_5&#45;&gt;route_5_12</title>
<path fill="none" stroke="black" d="M5102.64,-7657.68C5492.94,-7647.85 6310.6,-7624.19 7001,-7584.04 7065.59,-7580.29 7136.27,-7575.01 7198.97,-7569.91"/>
<polygon fill="black" stroke="black" points="7199.28,-7573.4 7208.96,-7569.1 7198.71,-7566.42 7199.28,-7573.4"/>
</g>
<!-- route_5_13 -->
<g id="node416" class="node">
<title>route_5_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7971" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7971" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7971" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 170,171</text>
<text text-anchor="middle" x="7971" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7971" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_13 -->
<g id="edge505" class="edge">
<title>gate_5&#45;&gt;route_5_13</title>
<path fill="none" stroke="black" d="M5106.3,-7660.19C5576.62,-7653.57 6672.09,-7633.77 7591,-7584.04 7655.92,-7580.53 7726.98,-7575.28 7789.9,-7570.14"/>
<polygon fill="black" stroke="black" points="7790.25,-7573.62 7799.93,-7569.31 7789.68,-7566.65 7790.25,-7573.62"/>
</g>
<!-- route_5_14 -->
<g id="node420" class="node">
<title>route_5_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8561" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8561" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8561" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 172,173</text>
<text text-anchor="middle" x="8561" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8561" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_14 -->
<g id="edge510" class="edge">
<title>gate_5&#45;&gt;route_5_14</title>
<path fill="none" stroke="black" d="M5108.56,-7661.88C5650.95,-7658.22 7029.82,-7643.35 8181,-7584.04 8246.09,-7580.69 8317.33,-7575.46 8380.37,-7570.29"/>
<polygon fill="black" stroke="black" points="8380.73,-7573.77 8390.41,-7569.46 8380.16,-7566.8 8380.73,-7573.77"/>
</g>
<!-- route_5_15 -->
<g id="node424" class="node">
<title>route_5_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9151" cy="-7552.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9151" y="-7565.73" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9151" y="-7555.73" font-family="Times,serif" font-size="9.00">GPU: 174,175</text>
<text text-anchor="middle" x="9151" y="-7545.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9151" y="-7535.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_15 -->
<g id="edge515" class="edge">
<title>gate_5&#45;&gt;route_5_15</title>
<path fill="none" stroke="black" d="M5110.19,-7663.09C5718.71,-7662.15 7384.91,-7652.95 8771,-7584.04 8836.25,-7580.8 8907.68,-7575.58 8970.83,-7570.39"/>
<polygon fill="black" stroke="black" points="8971.21,-7573.87 8980.89,-7569.56 8970.64,-7566.89 8971.21,-7573.87"/>
</g>
<!-- expert_5_0_0 -->
<g id="node365" class="node">
<title>expert_5_0_0</title>
<polygon fill="lightgreen" stroke="black" points="439.5,-7485.82 162.5,-7485.82 162.5,-7441.82 439.5,-7441.82 439.5,-7485.82"/>
<text text-anchor="middle" x="301" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L5</text>
<text text-anchor="middle" x="301" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="301" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="301" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_0&#45;&gt;expert_5_0_0 -->
<g id="edge441" class="edge">
<title>route_5_0&#45;&gt;expert_5_0_0</title>
<path fill="none" stroke="black" d="M505.08,-7525.08C465.92,-7513.52 420.49,-7500.1 382.44,-7488.87"/>
<polygon fill="black" stroke="black" points="383.01,-7485.38 372.43,-7485.91 381.03,-7492.1 383.01,-7485.38"/>
</g>
<!-- expert_5_0_1 -->
<g id="node366" class="node">
<title>expert_5_0_1</title>
<polygon fill="lightgreen" stroke="black" points="734.5,-7485.82 457.5,-7485.82 457.5,-7441.82 734.5,-7441.82 734.5,-7485.82"/>
<text text-anchor="middle" x="596" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L5</text>
<text text-anchor="middle" x="596" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="596" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="596" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_0&#45;&gt;expert_5_0_1 -->
<g id="edge442" class="edge">
<title>route_5_0&#45;&gt;expert_5_0_1</title>
<path fill="none" stroke="black" d="M596,-7521.46C596,-7513.18 596,-7504.21 596,-7495.89"/>
<polygon fill="black" stroke="black" points="599.5,-7495.82 596,-7485.82 592.5,-7495.82 599.5,-7495.82"/>
</g>
<!-- tp_5_0 -->
<g id="node367" class="node">
<title>tp_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="2998" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2998" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L5</text>
<text text-anchor="middle" x="2998" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="2998" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2998" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_0_0&#45;&gt;tp_5_0 -->
<g id="edge443" class="edge">
<title>expert_5_0_0&#45;&gt;tp_5_0</title>
<path fill="none" stroke="black" d="M439.84,-7442.55C442.58,-7442.29 445.3,-7442.04 448,-7441.82 926.88,-7401.54 2426.56,-7382.04 2872.02,-7377.03"/>
<polygon fill="black" stroke="black" points="2872.07,-7380.53 2882.03,-7376.92 2871.99,-7373.53 2872.07,-7380.53"/>
</g>
<!-- expert_5_0_1&#45;&gt;tp_5_0 -->
<g id="edge444" class="edge">
<title>expert_5_0_1&#45;&gt;tp_5_0</title>
<path fill="none" stroke="black" d="M734.6,-7442.67C737.76,-7442.37 740.9,-7442.08 744,-7441.82 1162.26,-7406.12 2461.54,-7383.84 2872.23,-7377.54"/>
<polygon fill="black" stroke="black" points="2872.41,-7381.04 2882.35,-7377.39 2872.3,-7374.04 2872.41,-7381.04"/>
</g>
<!-- q_proj_6 -->
<g id="node428" class="node">
<title>q_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="4707,-7296.59 4411,-7296.59 4411,-7252.59 4707,-7252.59 4707,-7296.59"/>
<text text-anchor="middle" x="4559" y="-7287.39" font-family="Times,serif" font-size="9.00">Q Projection L6</text>
<text text-anchor="middle" x="4559" y="-7277.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4559" y="-7267.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4559" y="-7257.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_5_0&#45;&gt;q_proj_6 -->
<g id="edge1620" class="edge">
<title>tp_5_0&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M3066.34,-7349.45C3084.53,-7343.94 3104.33,-7338.77 3123,-7335.59 3364.43,-7294.43 4079.98,-7281.12 4400.56,-7277.14"/>
<polygon fill="black" stroke="black" points="4400.9,-7280.64 4410.86,-7277.02 4400.82,-7273.64 4400.9,-7280.64"/>
</g>
<!-- k_proj_6 -->
<g id="node429" class="node">
<title>k_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="5335,-7296.59 5039,-7296.59 5039,-7252.59 5335,-7252.59 5335,-7296.59"/>
<text text-anchor="middle" x="5187" y="-7287.39" font-family="Times,serif" font-size="9.00">K Projection L6</text>
<text text-anchor="middle" x="5187" y="-7277.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="5187" y="-7267.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5187" y="-7257.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_5_0&#45;&gt;k_proj_6 -->
<g id="edge1621" class="edge">
<title>tp_5_0&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M3065.29,-7349.27C3083.75,-7343.64 3103.93,-7338.47 3123,-7335.59 3227.75,-7319.75 4925.44,-7344.68 5030,-7327.59 5063.1,-7322.18 5098.67,-7310.88 5127.58,-7300.2"/>
<polygon fill="black" stroke="black" points="5128.99,-7303.41 5137.11,-7296.61 5126.52,-7296.86 5128.99,-7303.41"/>
</g>
<!-- v_proj_6 -->
<g id="node430" class="node">
<title>v_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="5021,-7296.59 4725,-7296.59 4725,-7252.59 5021,-7252.59 5021,-7296.59"/>
<text text-anchor="middle" x="4873" y="-7287.39" font-family="Times,serif" font-size="9.00">V Projection L6</text>
<text text-anchor="middle" x="4873" y="-7277.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4873" y="-7267.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7257.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_5_0&#45;&gt;v_proj_6 -->
<g id="edge1622" class="edge">
<title>tp_5_0&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M3065.29,-7349.28C3083.75,-7343.66 3103.93,-7338.48 3123,-7335.59 3210.5,-7322.32 4628.66,-7341.9 4716,-7327.59 4749.09,-7322.17 4784.67,-7310.87 4813.58,-7300.19"/>
<polygon fill="black" stroke="black" points="4814.99,-7303.39 4823.11,-7296.59 4812.52,-7296.84 4814.99,-7303.39"/>
</g>
<!-- expert_5_1_0 -->
<g id="node369" class="node">
<title>expert_5_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1029.5,-7485.82 752.5,-7485.82 752.5,-7441.82 1029.5,-7441.82 1029.5,-7485.82"/>
<text text-anchor="middle" x="891" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L5</text>
<text text-anchor="middle" x="891" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 130</text>
<text text-anchor="middle" x="891" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="891" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_1&#45;&gt;expert_5_1_0 -->
<g id="edge446" class="edge">
<title>route_5_1&#45;&gt;expert_5_1_0</title>
<path fill="none" stroke="black" d="M1095.08,-7525.08C1055.92,-7513.52 1010.49,-7500.1 972.44,-7488.87"/>
<polygon fill="black" stroke="black" points="973.01,-7485.38 962.43,-7485.91 971.03,-7492.1 973.01,-7485.38"/>
</g>
<!-- expert_5_1_1 -->
<g id="node370" class="node">
<title>expert_5_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1324.5,-7485.82 1047.5,-7485.82 1047.5,-7441.82 1324.5,-7441.82 1324.5,-7485.82"/>
<text text-anchor="middle" x="1186" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L5</text>
<text text-anchor="middle" x="1186" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 131</text>
<text text-anchor="middle" x="1186" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1186" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_1&#45;&gt;expert_5_1_1 -->
<g id="edge447" class="edge">
<title>route_5_1&#45;&gt;expert_5_1_1</title>
<path fill="none" stroke="black" d="M1186,-7521.46C1186,-7513.18 1186,-7504.21 1186,-7495.89"/>
<polygon fill="black" stroke="black" points="1189.5,-7495.82 1186,-7485.82 1182.5,-7495.82 1189.5,-7495.82"/>
</g>
<!-- tp_5_1 -->
<g id="node371" class="node">
<title>tp_5_1</title>
<ellipse fill="lightblue" stroke="black" cx="3248" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3248" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L5</text>
<text text-anchor="middle" x="3248" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 130↔131</text>
<text text-anchor="middle" x="3248" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3248" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_1_0&#45;&gt;tp_5_1 -->
<g id="edge448" class="edge">
<title>expert_5_1_0&#45;&gt;tp_5_1</title>
<path fill="none" stroke="black" d="M1029.59,-7442.62C1032.76,-7442.33 1035.9,-7442.06 1039,-7441.82 1500.73,-7405.21 2663.54,-7464.41 3123,-7405.82 3134.68,-7404.33 3146.85,-7402.17 3158.81,-7399.69"/>
<polygon fill="black" stroke="black" points="3159.76,-7403.07 3168.8,-7397.54 3158.29,-7396.23 3159.76,-7403.07"/>
</g>
<!-- expert_5_1_1&#45;&gt;tp_5_1 -->
<g id="edge449" class="edge">
<title>expert_5_1_1&#45;&gt;tp_5_1</title>
<path fill="none" stroke="black" d="M1324.6,-7442.63C1327.76,-7442.34 1330.9,-7442.07 1334,-7441.82 1730.35,-7409.83 2728.63,-7456.68 3123,-7405.82 3134.67,-7404.31 3146.84,-7402.15 3158.81,-7399.66"/>
<polygon fill="black" stroke="black" points="3159.76,-7403.04 3168.79,-7397.51 3158.28,-7396.2 3159.76,-7403.04"/>
</g>
<!-- tp_5_1&#45;&gt;q_proj_6 -->
<g id="edge1623" class="edge">
<title>tp_5_1&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M3316.36,-7349.56C3334.55,-7344.05 3354.34,-7338.86 3373,-7335.59 3565.7,-7301.87 4124.48,-7285.17 4400.67,-7278.79"/>
<polygon fill="black" stroke="black" points="4400.86,-7282.29 4410.77,-7278.56 4400.7,-7275.29 4400.86,-7282.29"/>
</g>
<!-- tp_5_1&#45;&gt;k_proj_6 -->
<g id="edge1624" class="edge">
<title>tp_5_1&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M3315.29,-7349.27C3333.75,-7343.65 3353.93,-7338.48 3373,-7335.59 3464.02,-7321.8 4939.15,-7342.47 5030,-7327.59 5063.1,-7322.17 5098.67,-7310.87 5127.58,-7300.19"/>
<polygon fill="black" stroke="black" points="5128.99,-7303.4 5137.11,-7296.6 5126.52,-7296.85 5128.99,-7303.4"/>
</g>
<!-- tp_5_1&#45;&gt;v_proj_6 -->
<g id="edge1625" class="edge">
<title>tp_5_1&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M3315.29,-7349.29C3333.75,-7343.67 3353.93,-7338.49 3373,-7335.59 3446.76,-7324.37 4642.38,-7339.69 4716,-7327.59 4748.96,-7322.17 4784.39,-7310.94 4813.24,-7300.29"/>
<polygon fill="black" stroke="black" points="4814.63,-7303.51 4822.76,-7296.72 4812.16,-7296.96 4814.63,-7303.51"/>
</g>
<!-- expert_5_2_0 -->
<g id="node373" class="node">
<title>expert_5_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1619.5,-7485.82 1342.5,-7485.82 1342.5,-7441.82 1619.5,-7441.82 1619.5,-7485.82"/>
<text text-anchor="middle" x="1481" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L5</text>
<text text-anchor="middle" x="1481" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 132</text>
<text text-anchor="middle" x="1481" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1481" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_2&#45;&gt;expert_5_2_0 -->
<g id="edge451" class="edge">
<title>route_5_2&#45;&gt;expert_5_2_0</title>
<path fill="none" stroke="black" d="M1685.08,-7525.08C1645.92,-7513.52 1600.49,-7500.1 1562.44,-7488.87"/>
<polygon fill="black" stroke="black" points="1563.01,-7485.38 1552.43,-7485.91 1561.03,-7492.1 1563.01,-7485.38"/>
</g>
<!-- expert_5_2_1 -->
<g id="node374" class="node">
<title>expert_5_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1914.5,-7485.82 1637.5,-7485.82 1637.5,-7441.82 1914.5,-7441.82 1914.5,-7485.82"/>
<text text-anchor="middle" x="1776" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L5</text>
<text text-anchor="middle" x="1776" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 133</text>
<text text-anchor="middle" x="1776" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1776" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_2&#45;&gt;expert_5_2_1 -->
<g id="edge452" class="edge">
<title>route_5_2&#45;&gt;expert_5_2_1</title>
<path fill="none" stroke="black" d="M1776,-7521.46C1776,-7513.18 1776,-7504.21 1776,-7495.89"/>
<polygon fill="black" stroke="black" points="1779.5,-7495.82 1776,-7485.82 1772.5,-7495.82 1779.5,-7495.82"/>
</g>
<!-- tp_5_2 -->
<g id="node375" class="node">
<title>tp_5_2</title>
<ellipse fill="lightblue" stroke="black" cx="3498" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3498" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L5</text>
<text text-anchor="middle" x="3498" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 132↔133</text>
<text text-anchor="middle" x="3498" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3498" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_2_0&#45;&gt;tp_5_2 -->
<g id="edge453" class="edge">
<title>expert_5_2_0&#45;&gt;tp_5_2</title>
<path fill="none" stroke="black" d="M1619.6,-7442.64C1622.76,-7442.34 1625.9,-7442.07 1629,-7441.82 2015.37,-7410.53 2988.56,-7455.5 3373,-7405.82 3384.67,-7404.31 3396.84,-7402.14 3408.81,-7399.66"/>
<polygon fill="black" stroke="black" points="3409.76,-7403.03 3418.79,-7397.5 3408.28,-7396.19 3409.76,-7403.03"/>
</g>
<!-- expert_5_2_1&#45;&gt;tp_5_2 -->
<g id="edge454" class="edge">
<title>expert_5_2_1&#45;&gt;tp_5_2</title>
<path fill="none" stroke="black" d="M1914.6,-7442.65C1917.76,-7442.35 1920.9,-7442.07 1924,-7441.82 2565.99,-7388.48 2734.29,-7489.72 3373,-7405.82 3384.67,-7404.28 3396.84,-7402.1 3408.8,-7399.61"/>
<polygon fill="black" stroke="black" points="3409.75,-7402.98 3418.79,-7397.45 3408.27,-7396.14 3409.75,-7402.98"/>
</g>
<!-- tp_5_2&#45;&gt;q_proj_6 -->
<g id="edge1626" class="edge">
<title>tp_5_2&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M3566.72,-7349.63C3584.82,-7344.15 3604.47,-7338.96 3623,-7335.59 3767.64,-7309.27 4173.9,-7290.23 4400.76,-7281.29"/>
<polygon fill="black" stroke="black" points="4400.9,-7284.79 4410.76,-7280.9 4400.63,-7277.8 4400.9,-7284.79"/>
</g>
<!-- tp_5_2&#45;&gt;k_proj_6 -->
<g id="edge1627" class="edge">
<title>tp_5_2&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M3565.29,-7349.28C3583.75,-7343.66 3603.93,-7338.49 3623,-7335.59 3700.28,-7323.85 4952.87,-7340.26 5030,-7327.59 5062.97,-7322.18 5098.4,-7310.94 5127.24,-7300.3"/>
<polygon fill="black" stroke="black" points="5128.63,-7303.52 5136.76,-7296.72 5126.17,-7296.96 5128.63,-7303.52"/>
</g>
<!-- tp_5_2&#45;&gt;v_proj_6 -->
<g id="edge1628" class="edge">
<title>tp_5_2&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M3565.29,-7349.31C3583.75,-7343.68 3603.94,-7338.5 3623,-7335.59 3743.05,-7317.25 4596.17,-7347.37 4716,-7327.59 4748.96,-7322.15 4784.39,-7310.91 4813.24,-7300.27"/>
<polygon fill="black" stroke="black" points="4814.62,-7303.49 4822.75,-7296.7 4812.16,-7296.94 4814.62,-7303.49"/>
</g>
<!-- expert_5_3_0 -->
<g id="node377" class="node">
<title>expert_5_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2209.5,-7485.82 1932.5,-7485.82 1932.5,-7441.82 2209.5,-7441.82 2209.5,-7485.82"/>
<text text-anchor="middle" x="2071" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L5</text>
<text text-anchor="middle" x="2071" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 134</text>
<text text-anchor="middle" x="2071" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2071" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_3&#45;&gt;expert_5_3_0 -->
<g id="edge456" class="edge">
<title>route_5_3&#45;&gt;expert_5_3_0</title>
<path fill="none" stroke="black" d="M2275.08,-7525.08C2235.92,-7513.52 2190.49,-7500.1 2152.44,-7488.87"/>
<polygon fill="black" stroke="black" points="2153.01,-7485.38 2142.43,-7485.91 2151.03,-7492.1 2153.01,-7485.38"/>
</g>
<!-- expert_5_3_1 -->
<g id="node378" class="node">
<title>expert_5_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2504.5,-7485.82 2227.5,-7485.82 2227.5,-7441.82 2504.5,-7441.82 2504.5,-7485.82"/>
<text text-anchor="middle" x="2366" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L5</text>
<text text-anchor="middle" x="2366" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 135</text>
<text text-anchor="middle" x="2366" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2366" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_3&#45;&gt;expert_5_3_1 -->
<g id="edge457" class="edge">
<title>route_5_3&#45;&gt;expert_5_3_1</title>
<path fill="none" stroke="black" d="M2366,-7521.46C2366,-7513.18 2366,-7504.21 2366,-7495.89"/>
<polygon fill="black" stroke="black" points="2369.5,-7495.82 2366,-7485.82 2362.5,-7495.82 2369.5,-7495.82"/>
</g>
<!-- tp_5_3 -->
<g id="node379" class="node">
<title>tp_5_3</title>
<ellipse fill="lightblue" stroke="black" cx="3748" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3748" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L5</text>
<text text-anchor="middle" x="3748" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 134↔135</text>
<text text-anchor="middle" x="3748" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3748" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_3_0&#45;&gt;tp_5_3 -->
<g id="edge458" class="edge">
<title>expert_5_3_0&#45;&gt;tp_5_3</title>
<path fill="none" stroke="black" d="M2209.6,-7442.66C2212.76,-7442.36 2215.9,-7442.08 2219,-7441.82 2841.04,-7389.88 3004.14,-7487.36 3623,-7405.82 3634.67,-7404.28 3646.84,-7402.1 3658.8,-7399.6"/>
<polygon fill="black" stroke="black" points="3659.75,-7402.98 3668.79,-7397.44 3658.27,-7396.13 3659.75,-7402.98"/>
</g>
<!-- expert_5_3_1&#45;&gt;tp_5_3 -->
<g id="edge459" class="edge">
<title>expert_5_3_1&#45;&gt;tp_5_3</title>
<path fill="none" stroke="black" d="M2504.6,-7442.69C2507.76,-7442.38 2510.9,-7442.09 2514,-7441.82 3005.3,-7399.11 3134.3,-7471.91 3623,-7405.82 3634.58,-7404.25 3646.65,-7402.07 3658.52,-7399.58"/>
<polygon fill="black" stroke="black" points="3659.41,-7402.97 3668.44,-7397.43 3657.92,-7396.13 3659.41,-7402.97"/>
</g>
<!-- tp_5_3&#45;&gt;q_proj_6 -->
<g id="edge1629" class="edge">
<title>tp_5_3&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M3817.43,-7349.73C3835.35,-7344.32 3854.74,-7339.13 3873,-7335.59 4051.76,-7300.92 4260.65,-7286.26 4400.53,-7280.08"/>
<polygon fill="black" stroke="black" points="4401.06,-7283.56 4410.9,-7279.63 4400.76,-7276.57 4401.06,-7283.56"/>
</g>
<!-- tp_5_3&#45;&gt;k_proj_6 -->
<g id="edge1630" class="edge">
<title>tp_5_3&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M3815.29,-7349.3C3833.75,-7343.68 3853.94,-7338.5 3873,-7335.59 4000.09,-7316.2 4903.15,-7348.5 5030,-7327.59 5062.96,-7322.16 5098.39,-7310.92 5127.24,-7300.28"/>
<polygon fill="black" stroke="black" points="5128.63,-7303.5 5136.75,-7296.7 5126.16,-7296.95 5128.63,-7303.5"/>
</g>
<!-- tp_5_3&#45;&gt;v_proj_6 -->
<g id="edge1631" class="edge">
<title>tp_5_3&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M3815.3,-7349.33C3833.76,-7343.71 3853.94,-7338.52 3873,-7335.59 3965.58,-7321.34 4623.6,-7342.95 4716,-7327.59 4748.96,-7322.12 4784.38,-7310.88 4813.23,-7300.24"/>
<polygon fill="black" stroke="black" points="4814.62,-7303.46 4822.75,-7296.67 4812.16,-7296.91 4814.62,-7303.46"/>
</g>
<!-- expert_5_4_0 -->
<g id="node381" class="node">
<title>expert_5_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2799.5,-7485.82 2522.5,-7485.82 2522.5,-7441.82 2799.5,-7441.82 2799.5,-7485.82"/>
<text text-anchor="middle" x="2661" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L5</text>
<text text-anchor="middle" x="2661" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 136</text>
<text text-anchor="middle" x="2661" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2661" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_4&#45;&gt;expert_5_4_0 -->
<g id="edge461" class="edge">
<title>route_5_4&#45;&gt;expert_5_4_0</title>
<path fill="none" stroke="black" d="M2865.08,-7525.08C2825.92,-7513.52 2780.49,-7500.1 2742.44,-7488.87"/>
<polygon fill="black" stroke="black" points="2743.01,-7485.38 2732.43,-7485.91 2741.03,-7492.1 2743.01,-7485.38"/>
</g>
<!-- expert_5_4_1 -->
<g id="node382" class="node">
<title>expert_5_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3094.5,-7485.82 2817.5,-7485.82 2817.5,-7441.82 3094.5,-7441.82 3094.5,-7485.82"/>
<text text-anchor="middle" x="2956" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L5</text>
<text text-anchor="middle" x="2956" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 137</text>
<text text-anchor="middle" x="2956" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2956" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_4&#45;&gt;expert_5_4_1 -->
<g id="edge462" class="edge">
<title>route_5_4&#45;&gt;expert_5_4_1</title>
<path fill="none" stroke="black" d="M2956,-7521.46C2956,-7513.18 2956,-7504.21 2956,-7495.89"/>
<polygon fill="black" stroke="black" points="2959.5,-7495.82 2956,-7485.82 2952.5,-7495.82 2959.5,-7495.82"/>
</g>
<!-- tp_5_4 -->
<g id="node383" class="node">
<title>tp_5_4</title>
<ellipse fill="lightblue" stroke="black" cx="3998" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3998" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L5</text>
<text text-anchor="middle" x="3998" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 136↔137</text>
<text text-anchor="middle" x="3998" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3998" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_4_0&#45;&gt;tp_5_4 -->
<g id="edge463" class="edge">
<title>expert_5_4_0&#45;&gt;tp_5_4</title>
<path fill="none" stroke="black" d="M2799.6,-7442.69C2802.76,-7442.38 2805.9,-7442.09 2809,-7441.82 3280.35,-7400.52 3404.15,-7469.55 3873,-7405.82 3884.58,-7404.24 3896.65,-7402.05 3908.52,-7399.57"/>
<polygon fill="black" stroke="black" points="3909.41,-7402.96 3918.44,-7397.41 3907.92,-7396.12 3909.41,-7402.96"/>
</g>
<!-- expert_5_4_1&#45;&gt;tp_5_4 -->
<g id="edge464" class="edge">
<title>expert_5_4_1&#45;&gt;tp_5_4</title>
<path fill="none" stroke="black" d="M3094.6,-7442.75C3097.76,-7442.42 3100.9,-7442.11 3104,-7441.82 3444.65,-7409.75 3534.27,-7454.1 3873,-7405.82 3884.48,-7404.18 3896.45,-7401.97 3908.24,-7399.48"/>
<polygon fill="black" stroke="black" points="3909.06,-7402.88 3918.08,-7397.33 3907.56,-7396.04 3909.06,-7402.88"/>
</g>
<!-- tp_5_4&#45;&gt;q_proj_6 -->
<g id="edge1632" class="edge">
<title>tp_5_4&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M4068.87,-7349.96C4086.42,-7344.67 4105.27,-7339.49 4123,-7335.59 4214.16,-7315.55 4317.6,-7300.98 4400.84,-7291.21"/>
<polygon fill="black" stroke="black" points="4401.36,-7294.68 4410.89,-7290.05 4400.56,-7287.72 4401.36,-7294.68"/>
</g>
<!-- tp_5_4&#45;&gt;k_proj_6 -->
<g id="edge1633" class="edge">
<title>tp_5_4&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M4065.3,-7349.32C4083.75,-7343.7 4103.94,-7338.52 4123,-7335.59 4222.61,-7320.29 4930.58,-7344.08 5030,-7327.59 5062.96,-7322.13 5098.39,-7310.89 5127.23,-7300.25"/>
<polygon fill="black" stroke="black" points="5128.62,-7303.47 5136.75,-7296.68 5126.16,-7296.92 5128.62,-7303.47"/>
</g>
<!-- tp_5_4&#45;&gt;v_proj_6 -->
<g id="edge1634" class="edge">
<title>tp_5_4&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M4065.63,-7349.28C4084,-7343.7 4104.06,-7338.55 4123,-7335.59 4253.22,-7315.28 4586.04,-7349.45 4716,-7327.59 4748.94,-7322.05 4784.37,-7310.8 4813.22,-7300.18"/>
<polygon fill="black" stroke="black" points="4814.61,-7303.4 4822.74,-7296.62 4812.15,-7296.85 4814.61,-7303.4"/>
</g>
<!-- expert_5_5_0 -->
<g id="node385" class="node">
<title>expert_5_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3389.5,-7485.82 3112.5,-7485.82 3112.5,-7441.82 3389.5,-7441.82 3389.5,-7485.82"/>
<text text-anchor="middle" x="3251" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L5</text>
<text text-anchor="middle" x="3251" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 138</text>
<text text-anchor="middle" x="3251" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3251" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_5&#45;&gt;expert_5_5_0 -->
<g id="edge466" class="edge">
<title>route_5_5&#45;&gt;expert_5_5_0</title>
<path fill="none" stroke="black" d="M3455.08,-7525.08C3415.92,-7513.52 3370.49,-7500.1 3332.44,-7488.87"/>
<polygon fill="black" stroke="black" points="3333.01,-7485.38 3322.43,-7485.91 3331.03,-7492.1 3333.01,-7485.38"/>
</g>
<!-- expert_5_5_1 -->
<g id="node386" class="node">
<title>expert_5_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3684.5,-7485.82 3407.5,-7485.82 3407.5,-7441.82 3684.5,-7441.82 3684.5,-7485.82"/>
<text text-anchor="middle" x="3546" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L5</text>
<text text-anchor="middle" x="3546" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 139</text>
<text text-anchor="middle" x="3546" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3546" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_5&#45;&gt;expert_5_5_1 -->
<g id="edge467" class="edge">
<title>route_5_5&#45;&gt;expert_5_5_1</title>
<path fill="none" stroke="black" d="M3546,-7521.46C3546,-7513.18 3546,-7504.21 3546,-7495.89"/>
<polygon fill="black" stroke="black" points="3549.5,-7495.82 3546,-7485.82 3542.5,-7495.82 3549.5,-7495.82"/>
</g>
<!-- tp_5_5 -->
<g id="node387" class="node">
<title>tp_5_5</title>
<ellipse fill="lightblue" stroke="black" cx="4248" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4248" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L5</text>
<text text-anchor="middle" x="4248" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 138↔139</text>
<text text-anchor="middle" x="4248" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4248" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_5_0&#45;&gt;tp_5_5 -->
<g id="edge468" class="edge">
<title>expert_5_5_0&#45;&gt;tp_5_5</title>
<path fill="none" stroke="black" d="M3389.61,-7442.76C3392.77,-7442.43 3395.9,-7442.11 3399,-7441.82 3719.71,-7411.15 3804.11,-7451.74 4123,-7405.82 4134.48,-7404.16 4146.45,-7401.94 4158.23,-7399.45"/>
<polygon fill="black" stroke="black" points="4159.05,-7402.85 4168.07,-7397.3 4157.56,-7396.01 4159.05,-7402.85"/>
</g>
<!-- expert_5_5_1&#45;&gt;tp_5_5 -->
<g id="edge469" class="edge">
<title>expert_5_5_1&#45;&gt;tp_5_5</title>
<path fill="none" stroke="black" d="M3684.62,-7442.9C3687.78,-7442.53 3690.91,-7442.17 3694,-7441.82 3884.13,-7420.37 3934.11,-7436.31 4123,-7405.82 4134.08,-7404.03 4145.63,-7401.78 4157.03,-7399.32"/>
<polygon fill="black" stroke="black" points="4158,-7402.7 4167,-7397.12 4156.48,-7395.86 4158,-7402.7"/>
</g>
<!-- tp_5_5&#45;&gt;q_proj_6 -->
<g id="edge1635" class="edge">
<title>tp_5_5&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M4321.31,-7350.58C4369.88,-7335.25 4433.46,-7315.19 4482.65,-7299.68"/>
<polygon fill="black" stroke="black" points="4483.8,-7302.99 4492.28,-7296.64 4481.69,-7296.31 4483.8,-7302.99"/>
</g>
<!-- tp_5_5&#45;&gt;k_proj_6 -->
<g id="edge1636" class="edge">
<title>tp_5_5&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M4315.63,-7349.27C4334,-7343.69 4354.06,-7338.53 4373,-7335.59 4445.14,-7324.39 4958,-7339.66 5030,-7327.59 5062.95,-7322.07 5098.38,-7310.83 5127.23,-7300.2"/>
<polygon fill="black" stroke="black" points="5128.61,-7303.42 5136.74,-7296.63 5126.15,-7296.87 5128.61,-7303.42"/>
</g>
<!-- tp_5_5&#45;&gt;v_proj_6 -->
<g id="edge1637" class="edge">
<title>tp_5_5&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M4315.65,-7349.41C4334.02,-7343.83 4354.07,-7338.64 4373,-7335.59 4448.27,-7323.47 4640.88,-7340.61 4716,-7327.59 4748.79,-7321.91 4784.07,-7310.71 4812.86,-7300.16"/>
<polygon fill="black" stroke="black" points="4814.22,-7303.39 4822.37,-7296.62 4811.77,-7296.83 4814.22,-7303.39"/>
</g>
<!-- expert_5_6_0 -->
<g id="node389" class="node">
<title>expert_5_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3979.5,-7485.82 3702.5,-7485.82 3702.5,-7441.82 3979.5,-7441.82 3979.5,-7485.82"/>
<text text-anchor="middle" x="3841" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L5</text>
<text text-anchor="middle" x="3841" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 140</text>
<text text-anchor="middle" x="3841" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3841" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_6&#45;&gt;expert_5_6_0 -->
<g id="edge471" class="edge">
<title>route_5_6&#45;&gt;expert_5_6_0</title>
<path fill="none" stroke="black" d="M4045.08,-7525.08C4005.92,-7513.52 3960.49,-7500.1 3922.44,-7488.87"/>
<polygon fill="black" stroke="black" points="3923.01,-7485.38 3912.43,-7485.91 3921.03,-7492.1 3923.01,-7485.38"/>
</g>
<!-- expert_5_6_1 -->
<g id="node390" class="node">
<title>expert_5_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4274.5,-7485.82 3997.5,-7485.82 3997.5,-7441.82 4274.5,-7441.82 4274.5,-7485.82"/>
<text text-anchor="middle" x="4136" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L5</text>
<text text-anchor="middle" x="4136" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 141</text>
<text text-anchor="middle" x="4136" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4136" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_6&#45;&gt;expert_5_6_1 -->
<g id="edge472" class="edge">
<title>route_5_6&#45;&gt;expert_5_6_1</title>
<path fill="none" stroke="black" d="M4136,-7521.46C4136,-7513.18 4136,-7504.21 4136,-7495.89"/>
<polygon fill="black" stroke="black" points="4139.5,-7495.82 4136,-7485.82 4132.5,-7495.82 4139.5,-7495.82"/>
</g>
<!-- tp_5_6 -->
<g id="node391" class="node">
<title>tp_5_6</title>
<ellipse fill="lightblue" stroke="black" cx="4498" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4498" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L5</text>
<text text-anchor="middle" x="4498" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 140↔141</text>
<text text-anchor="middle" x="4498" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4498" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_6_0&#45;&gt;tp_5_6 -->
<g id="edge473" class="edge">
<title>expert_5_6_0&#45;&gt;tp_5_6</title>
<path fill="none" stroke="black" d="M3979.63,-7442.94C3982.78,-7442.56 3985.91,-7442.18 3989,-7441.82 4159.24,-7421.77 4203.91,-7433.96 4373,-7405.82 4384.07,-7403.97 4395.61,-7401.69 4407.02,-7399.22"/>
<polygon fill="black" stroke="black" points="4407.98,-7402.59 4416.98,-7397 4406.46,-7395.76 4407.98,-7402.59"/>
</g>
<!-- expert_5_6_1&#45;&gt;tp_5_6 -->
<g id="edge474" class="edge">
<title>expert_5_6_1&#45;&gt;tp_5_6</title>
<path fill="none" stroke="black" d="M4223.51,-7441.78C4268.24,-7431.02 4323.52,-7417.73 4373,-7405.82 4382.87,-7403.44 4393.17,-7400.96 4403.45,-7398.48"/>
<polygon fill="black" stroke="black" points="4404.38,-7401.86 4413.28,-7396.12 4402.74,-7395.06 4404.38,-7401.86"/>
</g>
<!-- tp_5_6&#45;&gt;q_proj_6 -->
<g id="edge1638" class="edge">
<title>tp_5_6&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M4516.63,-7343.73C4524.17,-7331.61 4532.86,-7317.64 4540.39,-7305.52"/>
<polygon fill="black" stroke="black" points="4543.59,-7307.01 4545.89,-7296.67 4537.64,-7303.32 4543.59,-7307.01"/>
</g>
<!-- tp_5_6&#45;&gt;k_proj_6 -->
<g id="edge1639" class="edge">
<title>tp_5_6&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M4565.64,-7349.36C4584.01,-7343.78 4604.07,-7338.6 4623,-7335.59 4712.34,-7321.38 4940.84,-7342.87 5030,-7327.59 5062.8,-7321.97 5098.08,-7310.78 5126.87,-7300.22"/>
<polygon fill="black" stroke="black" points="5128.23,-7303.44 5136.37,-7296.67 5125.78,-7296.89 5128.23,-7303.44"/>
</g>
<!-- tp_5_6&#45;&gt;v_proj_6 -->
<g id="edge1640" class="edge">
<title>tp_5_6&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M4567.43,-7349.71C4585.34,-7344.3 4604.73,-7339.12 4623,-7335.59 4663.73,-7327.72 4675.36,-7335.95 4716,-7327.59 4747.57,-7321.1 4781.65,-7310.3 4809.96,-7300.22"/>
<polygon fill="black" stroke="black" points="4811.5,-7303.38 4819.72,-7296.69 4809.12,-7296.8 4811.5,-7303.38"/>
</g>
<!-- expert_5_7_0 -->
<g id="node393" class="node">
<title>expert_5_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4569.5,-7485.82 4292.5,-7485.82 4292.5,-7441.82 4569.5,-7441.82 4569.5,-7485.82"/>
<text text-anchor="middle" x="4431" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L5</text>
<text text-anchor="middle" x="4431" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 142</text>
<text text-anchor="middle" x="4431" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4431" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_7&#45;&gt;expert_5_7_0 -->
<g id="edge476" class="edge">
<title>route_5_7&#45;&gt;expert_5_7_0</title>
<path fill="none" stroke="black" d="M4588.64,-7524.01C4559.11,-7512.92 4525.42,-7500.27 4496.8,-7489.52"/>
<polygon fill="black" stroke="black" points="4497.89,-7486.19 4487.29,-7485.95 4495.43,-7492.75 4497.89,-7486.19"/>
</g>
<!-- expert_5_7_1 -->
<g id="node394" class="node">
<title>expert_5_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4864.5,-7485.82 4587.5,-7485.82 4587.5,-7441.82 4864.5,-7441.82 4864.5,-7485.82"/>
<text text-anchor="middle" x="4726" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L5</text>
<text text-anchor="middle" x="4726" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 143</text>
<text text-anchor="middle" x="4726" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4726" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_7&#45;&gt;expert_5_7_1 -->
<g id="edge477" class="edge">
<title>route_5_7&#45;&gt;expert_5_7_1</title>
<path fill="none" stroke="black" d="M4684.68,-7521.95C4691.15,-7513 4698.24,-7503.2 4704.69,-7494.28"/>
<polygon fill="black" stroke="black" points="4707.61,-7496.21 4710.64,-7486.06 4701.94,-7492.11 4707.61,-7496.21"/>
</g>
<!-- tp_5_7 -->
<g id="node395" class="node">
<title>tp_5_7</title>
<ellipse fill="lightblue" stroke="black" cx="4748" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4748" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L5</text>
<text text-anchor="middle" x="4748" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 142↔143</text>
<text text-anchor="middle" x="4748" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4748" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_7_0&#45;&gt;tp_5_7 -->
<g id="edge478" class="edge">
<title>expert_5_7_0&#45;&gt;tp_5_7</title>
<path fill="none" stroke="black" d="M4507.74,-7441.73C4553.34,-7429.2 4611.37,-7413.25 4658.98,-7400.17"/>
<polygon fill="black" stroke="black" points="4659.94,-7403.53 4668.66,-7397.51 4658.09,-7396.78 4659.94,-7403.53"/>
</g>
<!-- expert_5_7_1&#45;&gt;tp_5_7 -->
<g id="edge479" class="edge">
<title>expert_5_7_1&#45;&gt;tp_5_7</title>
<path fill="none" stroke="black" d="M4731.33,-7441.73C4733.3,-7433.9 4735.62,-7424.74 4737.88,-7415.77"/>
<polygon fill="black" stroke="black" points="4741.34,-7416.37 4740.4,-7405.82 4734.55,-7414.66 4741.34,-7416.37"/>
</g>
<!-- tp_5_7&#45;&gt;q_proj_6 -->
<g id="edge1641" class="edge">
<title>tp_5_7&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M4696.1,-7346.76C4668.81,-7332.6 4635.52,-7315.31 4608.58,-7301.33"/>
<polygon fill="black" stroke="black" points="4610.19,-7298.22 4599.7,-7296.72 4606.96,-7304.43 4610.19,-7298.22"/>
</g>
<!-- tp_5_7&#45;&gt;k_proj_6 -->
<g id="edge1642" class="edge">
<title>tp_5_7&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M4816.36,-7349.56C4834.55,-7344.05 4854.34,-7338.86 4873,-7335.59 4941.82,-7323.53 4961.33,-7340.47 5030,-7327.59 5062.33,-7321.53 5097.16,-7310.48 5125.78,-7300.12"/>
<polygon fill="black" stroke="black" points="5127.06,-7303.38 5135.24,-7296.64 5124.64,-7296.81 5127.06,-7303.38"/>
</g>
<!-- tp_5_7&#45;&gt;v_proj_6 -->
<g id="edge1643" class="edge">
<title>tp_5_7&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M4784.49,-7345.06C4801.46,-7331.74 4821.54,-7315.98 4838.28,-7302.84"/>
<polygon fill="black" stroke="black" points="4840.5,-7305.55 4846.2,-7296.62 4836.18,-7300.04 4840.5,-7305.55"/>
</g>
<!-- expert_5_8_0 -->
<g id="node397" class="node">
<title>expert_5_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5159.5,-7485.82 4882.5,-7485.82 4882.5,-7441.82 5159.5,-7441.82 5159.5,-7485.82"/>
<text text-anchor="middle" x="5021" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L5</text>
<text text-anchor="middle" x="5021" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="5021" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5021" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_8&#45;&gt;expert_5_8_0 -->
<g id="edge481" class="edge">
<title>route_5_8&#45;&gt;expert_5_8_0</title>
<path fill="none" stroke="black" d="M5061.66,-7521.95C5055.29,-7513 5048.32,-7503.2 5041.97,-7494.28"/>
<polygon fill="black" stroke="black" points="5044.77,-7492.17 5036.12,-7486.06 5039.06,-7496.23 5044.77,-7492.17"/>
</g>
<!-- expert_5_8_1 -->
<g id="node398" class="node">
<title>expert_5_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5454.5,-7485.82 5177.5,-7485.82 5177.5,-7441.82 5454.5,-7441.82 5454.5,-7485.82"/>
<text text-anchor="middle" x="5316" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L5</text>
<text text-anchor="middle" x="5316" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="5316" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5316" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_8&#45;&gt;expert_5_8_1 -->
<g id="edge482" class="edge">
<title>route_5_8&#45;&gt;expert_5_8_1</title>
<path fill="none" stroke="black" d="M5157.68,-7524.01C5187.34,-7512.92 5221.17,-7500.27 5249.92,-7489.52"/>
<polygon fill="black" stroke="black" points="5251.32,-7492.73 5259.46,-7485.95 5248.87,-7486.18 5251.32,-7492.73"/>
</g>
<!-- tp_5_8 -->
<g id="node399" class="node">
<title>tp_5_8</title>
<ellipse fill="lightblue" stroke="black" cx="4998" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4998" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L5</text>
<text text-anchor="middle" x="4998" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="4998" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4998" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_8_0&#45;&gt;tp_5_8 -->
<g id="edge483" class="edge">
<title>expert_5_8_0&#45;&gt;tp_5_8</title>
<path fill="none" stroke="black" d="M5015.43,-7441.73C5013.37,-7433.9 5010.95,-7424.74 5008.58,-7415.77"/>
<polygon fill="black" stroke="black" points="5011.89,-7414.59 5005.95,-7405.82 5005.12,-7416.38 5011.89,-7414.59"/>
</g>
<!-- expert_5_8_1&#45;&gt;tp_5_8 -->
<g id="edge484" class="edge">
<title>expert_5_8_1&#45;&gt;tp_5_8</title>
<path fill="none" stroke="black" d="M5239.02,-7441.73C5193.19,-7429.17 5134.84,-7413.19 5087.04,-7400.09"/>
<polygon fill="black" stroke="black" points="5087.88,-7396.7 5077.31,-7397.43 5086.03,-7403.45 5087.88,-7396.7"/>
</g>
<!-- tp_5_8&#45;&gt;q_proj_6 -->
<g id="edge1644" class="edge">
<title>tp_5_8&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M4929.64,-7349.56C4911.45,-7344.05 4891.66,-7338.86 4873,-7335.59 4804.18,-7323.53 4784.67,-7340.47 4716,-7327.59 4683.67,-7321.53 4648.84,-7310.48 4620.22,-7300.12"/>
<polygon fill="black" stroke="black" points="4621.36,-7296.81 4610.76,-7296.64 4618.94,-7303.38 4621.36,-7296.81"/>
</g>
<!-- tp_5_8&#45;&gt;k_proj_6 -->
<g id="edge1645" class="edge">
<title>tp_5_8&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M5049.9,-7346.76C5077.19,-7332.6 5110.48,-7315.31 5137.42,-7301.33"/>
<polygon fill="black" stroke="black" points="5139.04,-7304.43 5146.3,-7296.72 5135.81,-7298.22 5139.04,-7304.43"/>
</g>
<!-- tp_5_8&#45;&gt;v_proj_6 -->
<g id="edge1646" class="edge">
<title>tp_5_8&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M4961.51,-7345.06C4944.54,-7331.74 4924.46,-7315.98 4907.72,-7302.84"/>
<polygon fill="black" stroke="black" points="4909.82,-7300.04 4899.8,-7296.62 4905.5,-7305.55 4909.82,-7300.04"/>
</g>
<!-- expert_5_9_0 -->
<g id="node401" class="node">
<title>expert_5_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5749.5,-7485.82 5472.5,-7485.82 5472.5,-7441.82 5749.5,-7441.82 5749.5,-7485.82"/>
<text text-anchor="middle" x="5611" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L5</text>
<text text-anchor="middle" x="5611" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 162</text>
<text text-anchor="middle" x="5611" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5611" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_9&#45;&gt;expert_5_9_0 -->
<g id="edge486" class="edge">
<title>route_5_9&#45;&gt;expert_5_9_0</title>
<path fill="none" stroke="black" d="M5611,-7521.46C5611,-7513.18 5611,-7504.21 5611,-7495.89"/>
<polygon fill="black" stroke="black" points="5614.5,-7495.82 5611,-7485.82 5607.5,-7495.82 5614.5,-7495.82"/>
</g>
<!-- expert_5_9_1 -->
<g id="node402" class="node">
<title>expert_5_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6044.5,-7485.82 5767.5,-7485.82 5767.5,-7441.82 6044.5,-7441.82 6044.5,-7485.82"/>
<text text-anchor="middle" x="5906" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L5</text>
<text text-anchor="middle" x="5906" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 163</text>
<text text-anchor="middle" x="5906" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5906" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_9&#45;&gt;expert_5_9_1 -->
<g id="edge487" class="edge">
<title>route_5_9&#45;&gt;expert_5_9_1</title>
<path fill="none" stroke="black" d="M5701.92,-7525.08C5741.08,-7513.52 5786.51,-7500.1 5824.56,-7488.87"/>
<polygon fill="black" stroke="black" points="5825.97,-7492.1 5834.57,-7485.91 5823.99,-7485.38 5825.97,-7492.1"/>
</g>
<!-- tp_5_9 -->
<g id="node403" class="node">
<title>tp_5_9</title>
<ellipse fill="lightblue" stroke="black" cx="5248" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5248" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L5</text>
<text text-anchor="middle" x="5248" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 162↔163</text>
<text text-anchor="middle" x="5248" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5248" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_9_0&#45;&gt;tp_5_9 -->
<g id="edge488" class="edge">
<title>expert_5_9_0&#45;&gt;tp_5_9</title>
<path fill="none" stroke="black" d="M5523.11,-7441.8C5478.2,-7431.05 5422.68,-7417.75 5373,-7405.82 5363.05,-7403.43 5352.65,-7400.93 5342.29,-7398.43"/>
<polygon fill="black" stroke="black" points="5342.92,-7394.99 5332.38,-7396.05 5341.28,-7401.79 5342.92,-7394.99"/>
</g>
<!-- expert_5_9_1&#45;&gt;tp_5_9 -->
<g id="edge489" class="edge">
<title>expert_5_9_1&#45;&gt;tp_5_9</title>
<path fill="none" stroke="black" d="M5767.14,-7442.79C5764.4,-7442.46 5761.69,-7442.13 5759,-7441.82 5587.89,-7421.63 5542.97,-7434.07 5373,-7405.82 5361.93,-7403.98 5350.39,-7401.7 5338.98,-7399.22"/>
<polygon fill="black" stroke="black" points="5339.54,-7395.76 5329.01,-7397.01 5338.02,-7402.59 5339.54,-7395.76"/>
</g>
<!-- tp_5_9&#45;&gt;q_proj_6 -->
<g id="edge1647" class="edge">
<title>tp_5_9&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M5180.36,-7349.36C5161.99,-7343.78 5141.93,-7338.6 5123,-7335.59 5033.66,-7321.38 4805.16,-7342.87 4716,-7327.59 4683.2,-7321.97 4647.92,-7310.78 4619.13,-7300.22"/>
<polygon fill="black" stroke="black" points="4620.22,-7296.89 4609.63,-7296.67 4617.77,-7303.44 4620.22,-7296.89"/>
</g>
<!-- tp_5_9&#45;&gt;k_proj_6 -->
<g id="edge1648" class="edge">
<title>tp_5_9&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M5229.37,-7343.73C5221.83,-7331.61 5213.14,-7317.64 5205.61,-7305.52"/>
<polygon fill="black" stroke="black" points="5208.36,-7303.32 5200.11,-7296.67 5202.41,-7307.01 5208.36,-7303.32"/>
</g>
<!-- tp_5_9&#45;&gt;v_proj_6 -->
<g id="edge1649" class="edge">
<title>tp_5_9&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M5178.57,-7349.71C5160.66,-7344.3 5141.27,-7339.12 5123,-7335.59 5082.27,-7327.72 5070.64,-7335.95 5030,-7327.59 4998.43,-7321.1 4964.35,-7310.3 4936.04,-7300.22"/>
<polygon fill="black" stroke="black" points="4936.88,-7296.8 4926.28,-7296.69 4934.5,-7303.38 4936.88,-7296.8"/>
</g>
<!-- expert_5_10_0 -->
<g id="node405" class="node">
<title>expert_5_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6339.5,-7485.82 6062.5,-7485.82 6062.5,-7441.82 6339.5,-7441.82 6339.5,-7485.82"/>
<text text-anchor="middle" x="6201" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L5</text>
<text text-anchor="middle" x="6201" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 164</text>
<text text-anchor="middle" x="6201" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6201" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_10&#45;&gt;expert_5_10_0 -->
<g id="edge491" class="edge">
<title>route_5_10&#45;&gt;expert_5_10_0</title>
<path fill="none" stroke="black" d="M6201,-7521.46C6201,-7513.18 6201,-7504.21 6201,-7495.89"/>
<polygon fill="black" stroke="black" points="6204.5,-7495.82 6201,-7485.82 6197.5,-7495.82 6204.5,-7495.82"/>
</g>
<!-- expert_5_10_1 -->
<g id="node406" class="node">
<title>expert_5_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6634.5,-7485.82 6357.5,-7485.82 6357.5,-7441.82 6634.5,-7441.82 6634.5,-7485.82"/>
<text text-anchor="middle" x="6496" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L5</text>
<text text-anchor="middle" x="6496" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 165</text>
<text text-anchor="middle" x="6496" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6496" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_10&#45;&gt;expert_5_10_1 -->
<g id="edge492" class="edge">
<title>route_5_10&#45;&gt;expert_5_10_1</title>
<path fill="none" stroke="black" d="M6291.92,-7525.08C6331.08,-7513.52 6376.51,-7500.1 6414.56,-7488.87"/>
<polygon fill="black" stroke="black" points="6415.97,-7492.1 6424.57,-7485.91 6413.99,-7485.38 6415.97,-7492.1"/>
</g>
<!-- tp_5_10 -->
<g id="node407" class="node">
<title>tp_5_10</title>
<ellipse fill="lightblue" stroke="black" cx="5498" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5498" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L5</text>
<text text-anchor="middle" x="5498" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 164↔165</text>
<text text-anchor="middle" x="5498" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5498" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_10_0&#45;&gt;tp_5_10 -->
<g id="edge493" class="edge">
<title>expert_5_10_0&#45;&gt;tp_5_10</title>
<path fill="none" stroke="black" d="M6062.14,-7442.76C6059.41,-7442.44 6056.69,-7442.12 6054,-7441.82 5863,-7420.22 5812.77,-7436.42 5623,-7405.82 5611.92,-7404.03 5600.37,-7401.78 5588.97,-7399.33"/>
<polygon fill="black" stroke="black" points="5589.52,-7395.86 5579,-7397.12 5588,-7402.7 5589.52,-7395.86"/>
</g>
<!-- expert_5_10_1&#45;&gt;tp_5_10 -->
<g id="edge494" class="edge">
<title>expert_5_10_1&#45;&gt;tp_5_10</title>
<path fill="none" stroke="black" d="M6357.16,-7442.63C6354.42,-7442.35 6351.69,-7442.08 6349,-7441.82 6027.42,-7410.94 5942.77,-7451.85 5623,-7405.82 5611.52,-7404.16 5599.55,-7401.94 5587.77,-7399.45"/>
<polygon fill="black" stroke="black" points="5588.44,-7396.01 5577.93,-7397.3 5586.95,-7402.85 5588.44,-7396.01"/>
</g>
<!-- tp_5_10&#45;&gt;q_proj_6 -->
<g id="edge1650" class="edge">
<title>tp_5_10&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M5430.37,-7349.27C5412,-7343.69 5391.94,-7338.53 5373,-7335.59 5300.86,-7324.39 4788,-7339.66 4716,-7327.59 4683.05,-7322.07 4647.62,-7310.83 4618.77,-7300.2"/>
<polygon fill="black" stroke="black" points="4619.85,-7296.87 4609.26,-7296.63 4617.39,-7303.42 4619.85,-7296.87"/>
</g>
<!-- tp_5_10&#45;&gt;k_proj_6 -->
<g id="edge1651" class="edge">
<title>tp_5_10&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M5424.69,-7350.58C5376.12,-7335.25 5312.54,-7315.19 5263.35,-7299.68"/>
<polygon fill="black" stroke="black" points="5264.31,-7296.31 5253.72,-7296.64 5262.2,-7302.99 5264.31,-7296.31"/>
</g>
<!-- tp_5_10&#45;&gt;v_proj_6 -->
<g id="edge1652" class="edge">
<title>tp_5_10&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M5430.35,-7349.41C5411.98,-7343.83 5391.93,-7338.64 5373,-7335.59 5297.73,-7323.47 5105.12,-7340.61 5030,-7327.59 4997.21,-7321.91 4961.93,-7310.71 4933.14,-7300.16"/>
<polygon fill="black" stroke="black" points="4934.23,-7296.83 4923.63,-7296.62 4931.78,-7303.39 4934.23,-7296.83"/>
</g>
<!-- expert_5_11_0 -->
<g id="node409" class="node">
<title>expert_5_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6929.5,-7485.82 6652.5,-7485.82 6652.5,-7441.82 6929.5,-7441.82 6929.5,-7485.82"/>
<text text-anchor="middle" x="6791" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L5</text>
<text text-anchor="middle" x="6791" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 166</text>
<text text-anchor="middle" x="6791" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6791" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_11&#45;&gt;expert_5_11_0 -->
<g id="edge496" class="edge">
<title>route_5_11&#45;&gt;expert_5_11_0</title>
<path fill="none" stroke="black" d="M6791,-7521.46C6791,-7513.18 6791,-7504.21 6791,-7495.89"/>
<polygon fill="black" stroke="black" points="6794.5,-7495.82 6791,-7485.82 6787.5,-7495.82 6794.5,-7495.82"/>
</g>
<!-- expert_5_11_1 -->
<g id="node410" class="node">
<title>expert_5_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7224.5,-7485.82 6947.5,-7485.82 6947.5,-7441.82 7224.5,-7441.82 7224.5,-7485.82"/>
<text text-anchor="middle" x="7086" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L5</text>
<text text-anchor="middle" x="7086" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 167</text>
<text text-anchor="middle" x="7086" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7086" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_11&#45;&gt;expert_5_11_1 -->
<g id="edge497" class="edge">
<title>route_5_11&#45;&gt;expert_5_11_1</title>
<path fill="none" stroke="black" d="M6881.92,-7525.08C6921.08,-7513.52 6966.51,-7500.1 7004.56,-7488.87"/>
<polygon fill="black" stroke="black" points="7005.97,-7492.1 7014.57,-7485.91 7003.99,-7485.38 7005.97,-7492.1"/>
</g>
<!-- tp_5_11 -->
<g id="node411" class="node">
<title>tp_5_11</title>
<ellipse fill="lightblue" stroke="black" cx="5748" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5748" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L5</text>
<text text-anchor="middle" x="5748" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 166↔167</text>
<text text-anchor="middle" x="5748" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5748" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_11_0&#45;&gt;tp_5_11 -->
<g id="edge498" class="edge">
<title>expert_5_11_0&#45;&gt;tp_5_11</title>
<path fill="none" stroke="black" d="M6652.16,-7442.62C6649.42,-7442.34 6646.69,-7442.07 6644,-7441.82 6302.48,-7409.52 6212.61,-7454.2 5873,-7405.82 5861.52,-7404.18 5849.55,-7401.97 5837.76,-7399.48"/>
<polygon fill="black" stroke="black" points="5838.44,-7396.05 5827.92,-7397.33 5836.94,-7402.89 5838.44,-7396.05"/>
</g>
<!-- expert_5_11_1&#45;&gt;tp_5_11 -->
<g id="edge499" class="edge">
<title>expert_5_11_1&#45;&gt;tp_5_11</title>
<path fill="none" stroke="black" d="M6947.16,-7442.57C6944.42,-7442.31 6941.7,-7442.05 6939,-7441.82 6466.78,-7400.24 6342.73,-7469.66 5873,-7405.82 5861.42,-7404.24 5849.35,-7402.05 5837.48,-7399.57"/>
<polygon fill="black" stroke="black" points="5838.08,-7396.12 5827.56,-7397.42 5836.59,-7402.96 5838.08,-7396.12"/>
</g>
<!-- tp_5_11&#45;&gt;q_proj_6 -->
<g id="edge1653" class="edge">
<title>tp_5_11&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M5680.7,-7349.32C5662.25,-7343.7 5642.06,-7338.52 5623,-7335.59 5523.39,-7320.29 4815.42,-7344.08 4716,-7327.59 4683.04,-7322.13 4647.61,-7310.89 4618.77,-7300.25"/>
<polygon fill="black" stroke="black" points="4619.84,-7296.92 4609.25,-7296.68 4617.38,-7303.47 4619.84,-7296.92"/>
</g>
<!-- tp_5_11&#45;&gt;k_proj_6 -->
<g id="edge1654" class="edge">
<title>tp_5_11&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M5677.13,-7349.96C5659.58,-7344.67 5640.73,-7339.49 5623,-7335.59 5531.84,-7315.55 5428.4,-7300.98 5345.16,-7291.21"/>
<polygon fill="black" stroke="black" points="5345.44,-7287.72 5335.11,-7290.05 5344.64,-7294.68 5345.44,-7287.72"/>
</g>
<!-- tp_5_11&#45;&gt;v_proj_6 -->
<g id="edge1655" class="edge">
<title>tp_5_11&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M5680.37,-7349.28C5662,-7343.7 5641.94,-7338.55 5623,-7335.59 5492.78,-7315.28 5159.96,-7349.45 5030,-7327.59 4997.06,-7322.05 4961.63,-7310.8 4932.78,-7300.18"/>
<polygon fill="black" stroke="black" points="4933.85,-7296.85 4923.26,-7296.62 4931.39,-7303.4 4933.85,-7296.85"/>
</g>
<!-- expert_5_12_0 -->
<g id="node413" class="node">
<title>expert_5_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7519.5,-7485.82 7242.5,-7485.82 7242.5,-7441.82 7519.5,-7441.82 7519.5,-7485.82"/>
<text text-anchor="middle" x="7381" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L5</text>
<text text-anchor="middle" x="7381" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 168</text>
<text text-anchor="middle" x="7381" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7381" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_12&#45;&gt;expert_5_12_0 -->
<g id="edge501" class="edge">
<title>route_5_12&#45;&gt;expert_5_12_0</title>
<path fill="none" stroke="black" d="M7381,-7521.46C7381,-7513.18 7381,-7504.21 7381,-7495.89"/>
<polygon fill="black" stroke="black" points="7384.5,-7495.82 7381,-7485.82 7377.5,-7495.82 7384.5,-7495.82"/>
</g>
<!-- expert_5_12_1 -->
<g id="node414" class="node">
<title>expert_5_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7814.5,-7485.82 7537.5,-7485.82 7537.5,-7441.82 7814.5,-7441.82 7814.5,-7485.82"/>
<text text-anchor="middle" x="7676" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L5</text>
<text text-anchor="middle" x="7676" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 169</text>
<text text-anchor="middle" x="7676" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7676" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_12&#45;&gt;expert_5_12_1 -->
<g id="edge502" class="edge">
<title>route_5_12&#45;&gt;expert_5_12_1</title>
<path fill="none" stroke="black" d="M7471.92,-7525.08C7511.08,-7513.52 7556.51,-7500.1 7594.56,-7488.87"/>
<polygon fill="black" stroke="black" points="7595.97,-7492.1 7604.57,-7485.91 7593.99,-7485.38 7595.97,-7492.1"/>
</g>
<!-- tp_5_12 -->
<g id="node415" class="node">
<title>tp_5_12</title>
<ellipse fill="lightblue" stroke="black" cx="5998" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5998" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L5</text>
<text text-anchor="middle" x="5998" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 168↔169</text>
<text text-anchor="middle" x="5998" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5998" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_12_0&#45;&gt;tp_5_12 -->
<g id="edge503" class="edge">
<title>expert_5_12_0&#45;&gt;tp_5_12</title>
<path fill="none" stroke="black" d="M7242.16,-7442.57C7239.42,-7442.3 7236.7,-7442.05 7234,-7441.82 6741.84,-7398.82 6612.58,-7472.01 6123,-7405.82 6111.42,-7404.25 6099.35,-7402.07 6087.48,-7399.58"/>
<polygon fill="black" stroke="black" points="6088.08,-7396.13 6077.56,-7397.43 6086.59,-7402.97 6088.08,-7396.13"/>
</g>
<!-- expert_5_12_1&#45;&gt;tp_5_12 -->
<g id="edge504" class="edge">
<title>expert_5_12_1&#45;&gt;tp_5_12</title>
<path fill="none" stroke="black" d="M7537.16,-7442.54C7534.42,-7442.29 7531.7,-7442.04 7529,-7441.82 6906.1,-7389.53 6742.74,-7487.47 6123,-7405.82 6111.33,-7404.28 6099.16,-7402.1 6087.2,-7399.6"/>
<polygon fill="black" stroke="black" points="6087.73,-7396.13 6077.21,-7397.44 6086.25,-7402.98 6087.73,-7396.13"/>
</g>
<!-- tp_5_12&#45;&gt;q_proj_6 -->
<g id="edge1656" class="edge">
<title>tp_5_12&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M5930.71,-7349.3C5912.25,-7343.68 5892.06,-7338.5 5873,-7335.59 5745.91,-7316.2 4842.85,-7348.5 4716,-7327.59 4683.04,-7322.16 4647.61,-7310.92 4618.76,-7300.28"/>
<polygon fill="black" stroke="black" points="4619.84,-7296.95 4609.25,-7296.7 4617.37,-7303.5 4619.84,-7296.95"/>
</g>
<!-- tp_5_12&#45;&gt;k_proj_6 -->
<g id="edge1657" class="edge">
<title>tp_5_12&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M5928.57,-7349.73C5910.65,-7344.32 5891.26,-7339.13 5873,-7335.59 5694.24,-7300.92 5485.35,-7286.26 5345.47,-7280.08"/>
<polygon fill="black" stroke="black" points="5345.24,-7276.57 5335.1,-7279.63 5344.94,-7283.56 5345.24,-7276.57"/>
</g>
<!-- tp_5_12&#45;&gt;v_proj_6 -->
<g id="edge1658" class="edge">
<title>tp_5_12&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M5930.7,-7349.33C5912.24,-7343.71 5892.06,-7338.52 5873,-7335.59 5780.42,-7321.34 5122.4,-7342.95 5030,-7327.59 4997.04,-7322.12 4961.62,-7310.88 4932.77,-7300.24"/>
<polygon fill="black" stroke="black" points="4933.84,-7296.91 4923.25,-7296.67 4931.38,-7303.46 4933.84,-7296.91"/>
</g>
<!-- expert_5_13_0 -->
<g id="node417" class="node">
<title>expert_5_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8109.5,-7485.82 7832.5,-7485.82 7832.5,-7441.82 8109.5,-7441.82 8109.5,-7485.82"/>
<text text-anchor="middle" x="7971" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L5</text>
<text text-anchor="middle" x="7971" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 170</text>
<text text-anchor="middle" x="7971" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7971" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_13&#45;&gt;expert_5_13_0 -->
<g id="edge506" class="edge">
<title>route_5_13&#45;&gt;expert_5_13_0</title>
<path fill="none" stroke="black" d="M7971,-7521.46C7971,-7513.18 7971,-7504.21 7971,-7495.89"/>
<polygon fill="black" stroke="black" points="7974.5,-7495.82 7971,-7485.82 7967.5,-7495.82 7974.5,-7495.82"/>
</g>
<!-- expert_5_13_1 -->
<g id="node418" class="node">
<title>expert_5_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8404.5,-7485.82 8127.5,-7485.82 8127.5,-7441.82 8404.5,-7441.82 8404.5,-7485.82"/>
<text text-anchor="middle" x="8266" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L5</text>
<text text-anchor="middle" x="8266" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 171</text>
<text text-anchor="middle" x="8266" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8266" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_13&#45;&gt;expert_5_13_1 -->
<g id="edge507" class="edge">
<title>route_5_13&#45;&gt;expert_5_13_1</title>
<path fill="none" stroke="black" d="M8061.92,-7525.08C8101.08,-7513.52 8146.51,-7500.1 8184.56,-7488.87"/>
<polygon fill="black" stroke="black" points="8185.97,-7492.1 8194.57,-7485.91 8183.99,-7485.38 8185.97,-7492.1"/>
</g>
<!-- tp_5_13 -->
<g id="node419" class="node">
<title>tp_5_13</title>
<ellipse fill="lightblue" stroke="black" cx="6248" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6248" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L5</text>
<text text-anchor="middle" x="6248" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 170↔171</text>
<text text-anchor="middle" x="6248" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6248" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_13_0&#45;&gt;tp_5_13 -->
<g id="edge508" class="edge">
<title>expert_5_13_0&#45;&gt;tp_5_13</title>
<path fill="none" stroke="black" d="M7832.16,-7442.54C7829.42,-7442.28 7826.7,-7442.04 7824,-7441.82 7181.15,-7388.11 7012.59,-7489.83 6373,-7405.82 6361.33,-7404.28 6349.16,-7402.1 6337.2,-7399.61"/>
<polygon fill="black" stroke="black" points="6337.73,-7396.14 6327.21,-7397.45 6336.25,-7402.99 6337.73,-7396.14"/>
</g>
<!-- expert_5_13_1&#45;&gt;tp_5_13 -->
<g id="edge509" class="edge">
<title>expert_5_13_1&#45;&gt;tp_5_13</title>
<path fill="none" stroke="black" d="M8127.17,-7442.53C8124.42,-7442.27 8121.7,-7442.04 8119,-7441.82 7732.2,-7410.32 6757.88,-7455.55 6373,-7405.82 6361.33,-7404.31 6349.16,-7402.14 6337.19,-7399.66"/>
<polygon fill="black" stroke="black" points="6337.72,-7396.19 6327.21,-7397.5 6336.24,-7403.03 6337.72,-7396.19"/>
</g>
<!-- tp_5_13&#45;&gt;q_proj_6 -->
<g id="edge1659" class="edge">
<title>tp_5_13&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M6180.71,-7349.28C6162.25,-7343.66 6142.07,-7338.49 6123,-7335.59 6045.72,-7323.85 4793.13,-7340.26 4716,-7327.59 4683.03,-7322.18 4647.6,-7310.94 4618.76,-7300.3"/>
<polygon fill="black" stroke="black" points="4619.83,-7296.96 4609.24,-7296.72 4617.37,-7303.52 4619.83,-7296.96"/>
</g>
<!-- tp_5_13&#45;&gt;k_proj_6 -->
<g id="edge1660" class="edge">
<title>tp_5_13&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M6179.28,-7349.63C6161.18,-7344.15 6141.53,-7338.96 6123,-7335.59 5978.36,-7309.27 5572.1,-7290.23 5345.24,-7281.29"/>
<polygon fill="black" stroke="black" points="5345.37,-7277.8 5335.24,-7280.9 5345.1,-7284.79 5345.37,-7277.8"/>
</g>
<!-- tp_5_13&#45;&gt;v_proj_6 -->
<g id="edge1661" class="edge">
<title>tp_5_13&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M6180.71,-7349.31C6162.25,-7343.68 6142.06,-7338.5 6123,-7335.59 6002.95,-7317.25 5149.83,-7347.37 5030,-7327.59 4997.04,-7322.15 4961.61,-7310.91 4932.76,-7300.27"/>
<polygon fill="black" stroke="black" points="4933.84,-7296.94 4923.25,-7296.7 4931.38,-7303.49 4933.84,-7296.94"/>
</g>
<!-- expert_5_14_0 -->
<g id="node421" class="node">
<title>expert_5_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8699.5,-7485.82 8422.5,-7485.82 8422.5,-7441.82 8699.5,-7441.82 8699.5,-7485.82"/>
<text text-anchor="middle" x="8561" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L5</text>
<text text-anchor="middle" x="8561" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 172</text>
<text text-anchor="middle" x="8561" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8561" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_14&#45;&gt;expert_5_14_0 -->
<g id="edge511" class="edge">
<title>route_5_14&#45;&gt;expert_5_14_0</title>
<path fill="none" stroke="black" d="M8561,-7521.46C8561,-7513.18 8561,-7504.21 8561,-7495.89"/>
<polygon fill="black" stroke="black" points="8564.5,-7495.82 8561,-7485.82 8557.5,-7495.82 8564.5,-7495.82"/>
</g>
<!-- expert_5_14_1 -->
<g id="node422" class="node">
<title>expert_5_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8994.5,-7485.82 8717.5,-7485.82 8717.5,-7441.82 8994.5,-7441.82 8994.5,-7485.82"/>
<text text-anchor="middle" x="8856" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L5</text>
<text text-anchor="middle" x="8856" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 173</text>
<text text-anchor="middle" x="8856" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8856" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_14&#45;&gt;expert_5_14_1 -->
<g id="edge512" class="edge">
<title>route_5_14&#45;&gt;expert_5_14_1</title>
<path fill="none" stroke="black" d="M8651.92,-7525.08C8691.08,-7513.52 8736.51,-7500.1 8774.56,-7488.87"/>
<polygon fill="black" stroke="black" points="8775.97,-7492.1 8784.57,-7485.91 8773.99,-7485.38 8775.97,-7492.1"/>
</g>
<!-- tp_5_14 -->
<g id="node423" class="node">
<title>tp_5_14</title>
<ellipse fill="lightblue" stroke="black" cx="6498" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6498" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L5</text>
<text text-anchor="middle" x="6498" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 172↔173</text>
<text text-anchor="middle" x="6498" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6498" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_14_0&#45;&gt;tp_5_14 -->
<g id="edge513" class="edge">
<title>expert_5_14_0&#45;&gt;tp_5_14</title>
<path fill="none" stroke="black" d="M8422.17,-7442.52C8419.42,-7442.27 8416.7,-7442.04 8414,-7441.82 8017.22,-7409.61 7017.81,-7456.73 6623,-7405.82 6611.33,-7404.31 6599.16,-7402.15 6587.19,-7399.66"/>
<polygon fill="black" stroke="black" points="6587.72,-7396.2 6577.21,-7397.51 6586.24,-7403.04 6587.72,-7396.2"/>
</g>
<!-- expert_5_14_1&#45;&gt;tp_5_14 -->
<g id="edge514" class="edge">
<title>expert_5_14_1&#45;&gt;tp_5_14</title>
<path fill="none" stroke="black" d="M8717.17,-7442.51C8714.42,-7442.26 8711.7,-7442.03 8709,-7441.82 8246.84,-7404.96 7082.9,-7464.46 6623,-7405.82 6611.32,-7404.33 6599.15,-7402.17 6587.19,-7399.69"/>
<polygon fill="black" stroke="black" points="6587.71,-7396.23 6577.2,-7397.54 6586.24,-7403.07 6587.71,-7396.23"/>
</g>
<!-- tp_5_14&#45;&gt;q_proj_6 -->
<g id="edge1662" class="edge">
<title>tp_5_14&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M6430.71,-7349.27C6412.25,-7343.65 6392.07,-7338.48 6373,-7335.59 6281.98,-7321.8 4806.85,-7342.47 4716,-7327.59 4682.9,-7322.17 4647.33,-7310.87 4618.42,-7300.19"/>
<polygon fill="black" stroke="black" points="4619.48,-7296.85 4608.89,-7296.6 4617.01,-7303.4 4619.48,-7296.85"/>
</g>
<!-- tp_5_14&#45;&gt;k_proj_6 -->
<g id="edge1663" class="edge">
<title>tp_5_14&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M6429.64,-7349.56C6411.45,-7344.05 6391.66,-7338.86 6373,-7335.59 6180.3,-7301.87 5621.52,-7285.17 5345.33,-7278.79"/>
<polygon fill="black" stroke="black" points="5345.3,-7275.29 5335.23,-7278.56 5345.14,-7282.29 5345.3,-7275.29"/>
</g>
<!-- tp_5_14&#45;&gt;v_proj_6 -->
<g id="edge1664" class="edge">
<title>tp_5_14&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M6430.71,-7349.29C6412.25,-7343.67 6392.07,-7338.49 6373,-7335.59 6299.24,-7324.37 5103.62,-7339.69 5030,-7327.59 4997.04,-7322.17 4961.61,-7310.94 4932.76,-7300.29"/>
<polygon fill="black" stroke="black" points="4933.84,-7296.96 4923.24,-7296.72 4931.37,-7303.51 4933.84,-7296.96"/>
</g>
<!-- expert_5_15_0 -->
<g id="node425" class="node">
<title>expert_5_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9289.5,-7485.82 9012.5,-7485.82 9012.5,-7441.82 9289.5,-7441.82 9289.5,-7485.82"/>
<text text-anchor="middle" x="9151" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L5</text>
<text text-anchor="middle" x="9151" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 174</text>
<text text-anchor="middle" x="9151" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9151" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_15&#45;&gt;expert_5_15_0 -->
<g id="edge516" class="edge">
<title>route_5_15&#45;&gt;expert_5_15_0</title>
<path fill="none" stroke="black" d="M9151,-7521.46C9151,-7513.18 9151,-7504.21 9151,-7495.89"/>
<polygon fill="black" stroke="black" points="9154.5,-7495.82 9151,-7485.82 9147.5,-7495.82 9154.5,-7495.82"/>
</g>
<!-- expert_5_15_1 -->
<g id="node426" class="node">
<title>expert_5_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9584.5,-7485.82 9307.5,-7485.82 9307.5,-7441.82 9584.5,-7441.82 9584.5,-7485.82"/>
<text text-anchor="middle" x="9446" y="-7476.62" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L5</text>
<text text-anchor="middle" x="9446" y="-7466.62" font-family="Times,serif" font-size="9.00">GPU: 175</text>
<text text-anchor="middle" x="9446" y="-7456.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9446" y="-7446.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_15&#45;&gt;expert_5_15_1 -->
<g id="edge517" class="edge">
<title>route_5_15&#45;&gt;expert_5_15_1</title>
<path fill="none" stroke="black" d="M9241.92,-7525.08C9281.08,-7513.52 9326.51,-7500.1 9364.56,-7488.87"/>
<polygon fill="black" stroke="black" points="9365.97,-7492.1 9374.57,-7485.91 9363.99,-7485.38 9365.97,-7492.1"/>
</g>
<!-- tp_5_15 -->
<g id="node427" class="node">
<title>tp_5_15</title>
<ellipse fill="lightblue" stroke="black" cx="6748" cy="-7374.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6748" y="-7387.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L5</text>
<text text-anchor="middle" x="6748" y="-7377.5" font-family="Times,serif" font-size="9.00">GPU: 174↔175</text>
<text text-anchor="middle" x="6748" y="-7367.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6748" y="-7357.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_15_0&#45;&gt;tp_5_15 -->
<g id="edge518" class="edge">
<title>expert_5_15_0&#45;&gt;tp_5_15</title>
<path fill="none" stroke="black" d="M9012.16,-7442.56C9009.42,-7442.3 9006.7,-7442.05 9004,-7441.82 8585.38,-7405.9 7284.95,-7383.76 6873.89,-7377.52"/>
<polygon fill="black" stroke="black" points="6873.8,-7374.02 6863.75,-7377.37 6873.7,-7381.02 6873.8,-7374.02"/>
</g>
<!-- expert_5_15_1&#45;&gt;tp_5_15 -->
<g id="edge519" class="edge">
<title>expert_5_15_1&#45;&gt;tp_5_15</title>
<path fill="none" stroke="black" d="M9307.16,-7442.55C9304.42,-7442.29 9301.7,-7442.04 9299,-7441.82 8819.93,-7401.53 7319.66,-7382.03 6874.03,-7377.03"/>
<polygon fill="black" stroke="black" points="6874.05,-7373.53 6864.02,-7376.92 6873.98,-7380.53 6874.05,-7373.53"/>
</g>
<!-- tp_5_15&#45;&gt;q_proj_6 -->
<g id="edge1665" class="edge">
<title>tp_5_15&#45;&gt;q_proj_6</title>
<path fill="none" stroke="black" d="M6680.71,-7349.27C6662.25,-7343.64 6642.07,-7338.47 6623,-7335.59 6518.25,-7319.75 4820.56,-7344.68 4716,-7327.59 4682.9,-7322.18 4647.33,-7310.88 4618.42,-7300.2"/>
<polygon fill="black" stroke="black" points="4619.48,-7296.86 4608.89,-7296.61 4617.01,-7303.41 4619.48,-7296.86"/>
</g>
<!-- tp_5_15&#45;&gt;k_proj_6 -->
<g id="edge1666" class="edge">
<title>tp_5_15&#45;&gt;k_proj_6</title>
<path fill="none" stroke="black" d="M6679.66,-7349.45C6661.47,-7343.94 6641.67,-7338.77 6623,-7335.59 6381.57,-7294.43 5666.02,-7281.12 5345.44,-7277.14"/>
<polygon fill="black" stroke="black" points="5345.18,-7273.64 5335.14,-7277.02 5345.1,-7280.64 5345.18,-7273.64"/>
</g>
<!-- tp_5_15&#45;&gt;v_proj_6 -->
<g id="edge1667" class="edge">
<title>tp_5_15&#45;&gt;v_proj_6</title>
<path fill="none" stroke="black" d="M6680.71,-7349.28C6662.25,-7343.66 6642.07,-7338.48 6623,-7335.59 6535.5,-7322.32 5117.34,-7341.9 5030,-7327.59 4996.91,-7322.17 4961.33,-7310.87 4932.42,-7300.19"/>
<polygon fill="black" stroke="black" points="4933.48,-7296.84 4922.89,-7296.59 4931.01,-7303.39 4933.48,-7296.84"/>
</g>
<!-- attn_scores_6 -->
<g id="node431" class="node">
<title>attn_scores_6</title>
<polygon fill="lightgreen" stroke="black" points="5039.5,-7216.59 4706.5,-7216.59 4706.5,-7172.59 5039.5,-7172.59 5039.5,-7216.59"/>
<text text-anchor="middle" x="4873" y="-7207.39" font-family="Times,serif" font-size="9.00">Attention Scores L6</text>
<text text-anchor="middle" x="4873" y="-7197.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4873" y="-7187.39" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7177.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_6&#45;&gt;attn_scores_6 -->
<g id="edge520" class="edge">
<title>q_proj_6&#45;&gt;attn_scores_6</title>
<path fill="none" stroke="black" d="M4643.56,-7252.59C4685.18,-7242.25 4735.51,-7229.75 4778.41,-7219.09"/>
<polygon fill="black" stroke="black" points="4779.43,-7222.44 4788.29,-7216.63 4777.74,-7215.65 4779.43,-7222.44"/>
</g>
<!-- k_proj_6&#45;&gt;attn_scores_6 -->
<g id="edge521" class="edge">
<title>k_proj_6&#45;&gt;attn_scores_6</title>
<path fill="none" stroke="black" d="M5102.44,-7252.59C5060.82,-7242.25 5010.49,-7229.75 4967.59,-7219.09"/>
<polygon fill="black" stroke="black" points="4968.26,-7215.65 4957.71,-7216.63 4966.57,-7222.44 4968.26,-7215.65"/>
</g>
<!-- v_proj_6&#45;&gt;attn_scores_6 -->
<g id="edge522" class="edge">
<title>v_proj_6&#45;&gt;attn_scores_6</title>
<path fill="none" stroke="black" d="M4873,-7252.28C4873,-7244.39 4873,-7235.28 4873,-7226.69"/>
<polygon fill="black" stroke="black" points="4876.5,-7226.61 4873,-7216.61 4869.5,-7226.61 4876.5,-7226.61"/>
</g>
<!-- softmax_6 -->
<g id="node432" class="node">
<title>softmax_6</title>
<polygon fill="lightgreen" stroke="black" points="5039.5,-7136.59 4706.5,-7136.59 4706.5,-7092.59 5039.5,-7092.59 5039.5,-7136.59"/>
<text text-anchor="middle" x="4873" y="-7127.39" font-family="Times,serif" font-size="9.00">Softmax L6</text>
<text text-anchor="middle" x="4873" y="-7117.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4873" y="-7107.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4873" y="-7097.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_6&#45;&gt;softmax_6 -->
<g id="edge523" class="edge">
<title>attn_scores_6&#45;&gt;softmax_6</title>
<path fill="none" stroke="black" d="M4873,-7172.28C4873,-7164.39 4873,-7155.28 4873,-7146.69"/>
<polygon fill="black" stroke="black" points="4876.5,-7146.61 4873,-7136.61 4869.5,-7146.61 4876.5,-7146.61"/>
</g>
<!-- attn_out_6 -->
<g id="node433" class="node">
<title>attn_out_6</title>
<polygon fill="lightgreen" stroke="black" points="5021,-7056.59 4725,-7056.59 4725,-7012.59 5021,-7012.59 5021,-7056.59"/>
<text text-anchor="middle" x="4873" y="-7047.39" font-family="Times,serif" font-size="9.00">Attention Output L6</text>
<text text-anchor="middle" x="4873" y="-7037.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4873" y="-7027.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-7017.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_6&#45;&gt;attn_out_6 -->
<g id="edge524" class="edge">
<title>softmax_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M4873,-7092.28C4873,-7084.39 4873,-7075.28 4873,-7066.69"/>
<polygon fill="black" stroke="black" points="4876.5,-7066.61 4873,-7056.61 4869.5,-7066.61 4876.5,-7066.61"/>
</g>
<!-- gate_6 -->
<g id="node434" class="node">
<title>gate_6</title>
<polygon fill="lightyellow" stroke="black" points="5172.74,-6976.59 4695.92,-6976.59 4573.26,-6888.59 5050.08,-6888.59 5172.74,-6976.59"/>
<text text-anchor="middle" x="4873" y="-6945.39" font-family="Times,serif" font-size="9.00">Gate L6</text>
<text text-anchor="middle" x="4873" y="-6935.39" font-family="Times,serif" font-size="9.00">GPU: 192&#45;255</text>
<text text-anchor="middle" x="4873" y="-6925.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4873" y="-6915.39" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_6&#45;&gt;gate_6 -->
<g id="edge525" class="edge">
<title>attn_out_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M4873,-7012.38C4873,-7004.89 4873,-6996.08 4873,-6987.12"/>
<polygon fill="black" stroke="black" points="4876.5,-6987 4873,-6977 4869.5,-6987 4876.5,-6987"/>
</g>
<!-- route_6_0 -->
<g id="node435" class="node">
<title>route_6_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="523" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="523" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="523" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="523" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_0 -->
<g id="edge526" class="edge">
<title>gate_6&#45;&gt;route_6_0</title>
<path fill="none" stroke="black" d="M4633.41,-6931.76C4015.29,-6931.12 2316.2,-6922.58 903,-6852.59 837.75,-6849.36 766.31,-6844.14 703.17,-6838.95"/>
<polygon fill="black" stroke="black" points="703.36,-6835.46 693.11,-6838.12 702.79,-6842.43 703.36,-6835.46"/>
</g>
<!-- route_6_1 -->
<g id="node439" class="node">
<title>route_6_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1113" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1113" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1113" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 194,195</text>
<text text-anchor="middle" x="1113" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_1 -->
<g id="edge531" class="edge">
<title>gate_6&#45;&gt;route_6_1</title>
<path fill="none" stroke="black" d="M4631.54,-6930.56C4076.81,-6927.19 2668.69,-6912.87 1493,-6852.59 1427.91,-6849.25 1356.67,-6844.03 1293.63,-6838.86"/>
<polygon fill="black" stroke="black" points="1293.84,-6835.37 1283.59,-6838.03 1293.27,-6842.34 1293.84,-6835.37"/>
</g>
<!-- route_6_2 -->
<g id="node443" class="node">
<title>route_6_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1703" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1703" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1703" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 196,197</text>
<text text-anchor="middle" x="1703" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_2 -->
<g id="edge536" class="edge">
<title>gate_6&#45;&gt;route_6_2</title>
<path fill="none" stroke="black" d="M4629.32,-6928.85C4144.25,-6922.47 3023.52,-6903.14 2083,-6852.59 2018.08,-6849.1 1947.02,-6843.86 1884.1,-6838.72"/>
<polygon fill="black" stroke="black" points="1884.32,-6835.22 1874.07,-6837.89 1883.75,-6842.2 1884.32,-6835.22"/>
</g>
<!-- route_6_3 -->
<g id="node447" class="node">
<title>route_6_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2293" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2293" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2293" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 198,199</text>
<text text-anchor="middle" x="2293" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_3 -->
<g id="edge541" class="edge">
<title>gate_6&#45;&gt;route_6_3</title>
<path fill="none" stroke="black" d="M4625.39,-6926.18C4217.97,-6916.51 3380.79,-6893.32 2673,-6852.59 2608.25,-6848.86 2537.38,-6843.58 2474.57,-6838.47"/>
<polygon fill="black" stroke="black" points="2474.81,-6834.98 2464.56,-6837.65 2474.24,-6841.96 2474.81,-6834.98"/>
</g>
<!-- route_6_4 -->
<g id="node451" class="node">
<title>route_6_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2883" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2883" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2883" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 200,201</text>
<text text-anchor="middle" x="2883" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_4 -->
<g id="edge546" class="edge">
<title>gate_6&#45;&gt;route_6_4</title>
<path fill="none" stroke="black" d="M4619.11,-6921.49C4301.75,-6908.33 3741.96,-6883.31 3263,-6852.59 3198.88,-6848.48 3128.73,-6843.15 3066.35,-6838.13"/>
<polygon fill="black" stroke="black" points="3066.26,-6834.61 3056.01,-6837.29 3065.7,-6841.59 3066.26,-6834.61"/>
</g>
<!-- route_6_5 -->
<g id="node455" class="node">
<title>route_6_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3473" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3473" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3473" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 202,203</text>
<text text-anchor="middle" x="3473" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_5 -->
<g id="edge551" class="edge">
<title>gate_6&#45;&gt;route_6_5</title>
<path fill="none" stroke="black" d="M4604.27,-6910.91C4398.59,-6895.05 4107.87,-6872.56 3853,-6852.59 3789.88,-6847.65 3720.86,-6842.19 3659.17,-6837.3"/>
<polygon fill="black" stroke="black" points="3659.19,-6833.79 3648.94,-6836.49 3658.63,-6840.77 3659.19,-6833.79"/>
</g>
<!-- route_6_6 -->
<g id="node459" class="node">
<title>route_6_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4063" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4063" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4063" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 204,205</text>
<text text-anchor="middle" x="4063" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_6 -->
<g id="edge556" class="edge">
<title>gate_6&#45;&gt;route_6_6</title>
<path fill="none" stroke="black" d="M4577.71,-6891.81C4457.27,-6875.59 4322.83,-6857.48 4221.56,-6843.84"/>
<polygon fill="black" stroke="black" points="4221.93,-6840.36 4211.55,-6842.49 4221,-6847.29 4221.93,-6840.36"/>
</g>
<!-- route_6_7 -->
<g id="node463" class="node">
<title>route_6_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4590" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4590" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4590" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 206,207</text>
<text text-anchor="middle" x="4590" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4590" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_7 -->
<g id="edge561" class="edge">
<title>gate_6&#45;&gt;route_6_7</title>
<path fill="none" stroke="black" d="M4761.15,-6888.47C4731.58,-6877.06 4700.19,-6864.96 4672.48,-6854.28"/>
<polygon fill="black" stroke="black" points="4673.43,-6850.9 4662.85,-6850.56 4670.92,-6857.43 4673.43,-6850.9"/>
</g>
<!-- route_6_8 -->
<g id="node467" class="node">
<title>route_6_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5010" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5010" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5010" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="5010" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5010" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_8 -->
<g id="edge566" class="edge">
<title>gate_6&#45;&gt;route_6_8</title>
<path fill="none" stroke="black" d="M4927.15,-6888.47C4939.54,-6878.59 4952.6,-6868.2 4964.58,-6858.65"/>
<polygon fill="black" stroke="black" points="4967.05,-6861.16 4972.69,-6852.19 4962.69,-6855.69 4967.05,-6861.16"/>
</g>
<!-- route_6_9 -->
<g id="node471" class="node">
<title>route_6_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5538" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5538" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5538" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 226,227</text>
<text text-anchor="middle" x="5538" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_9 -->
<g id="edge571" class="edge">
<title>gate_6&#45;&gt;route_6_9</title>
<path fill="none" stroke="black" d="M5066.24,-6899.88C5170.59,-6882.76 5297.28,-6861.98 5393.09,-6846.26"/>
<polygon fill="black" stroke="black" points="5393.84,-6849.68 5403.14,-6844.61 5392.71,-6842.77 5393.84,-6849.68"/>
</g>
<!-- route_6_10 -->
<g id="node475" class="node">
<title>route_6_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6128" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6128" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6128" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 228,229</text>
<text text-anchor="middle" x="6128" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_10 -->
<g id="edge576" class="edge">
<title>gate_6&#45;&gt;route_6_10</title>
<path fill="none" stroke="black" d="M5084.47,-6913.21C5325.91,-6892.21 5716.88,-6858.22 5945.5,-6838.35"/>
<polygon fill="black" stroke="black" points="5945.93,-6841.82 5955.59,-6837.47 5945.32,-6834.85 5945.93,-6841.82"/>
</g>
<!-- route_6_11 -->
<g id="node479" class="node">
<title>route_6_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6718" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6718" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6718" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 230,231</text>
<text text-anchor="middle" x="6718" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_11 -->
<g id="edge581" class="edge">
<title>gate_6&#45;&gt;route_6_11</title>
<path fill="none" stroke="black" d="M5095.86,-6921.32C5383.12,-6907.69 5898.01,-6881.88 6338,-6852.59 6401.96,-6848.33 6471.92,-6842.99 6534.18,-6837.98"/>
<polygon fill="black" stroke="black" points="6534.82,-6841.44 6544.5,-6837.15 6534.25,-6834.47 6534.82,-6841.44"/>
</g>
<!-- route_6_12 -->
<g id="node483" class="node">
<title>route_6_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7308" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7308" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7308" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 232,233</text>
<text text-anchor="middle" x="7308" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_12 -->
<g id="edge586" class="edge">
<title>gate_6&#45;&gt;route_6_12</title>
<path fill="none" stroke="black" d="M5101.98,-6925.83C5481.69,-6915.59 6265.51,-6891.56 6928,-6852.59 6992.59,-6848.79 7063.27,-6843.5 7125.97,-6838.42"/>
<polygon fill="black" stroke="black" points="7126.28,-6841.9 7135.96,-6837.6 7125.71,-6834.92 7126.28,-6841.9"/>
</g>
<!-- route_6_13 -->
<g id="node487" class="node">
<title>route_6_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7898" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7898" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7898" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 234,235</text>
<text text-anchor="middle" x="7898" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_13 -->
<g id="edge591" class="edge">
<title>gate_6&#45;&gt;route_6_13</title>
<path fill="none" stroke="black" d="M5105.79,-6928.49C5566.61,-6921.49 6627.5,-6901.14 7518,-6852.59 7582.92,-6849.05 7653.98,-6843.79 7716.9,-6838.66"/>
<polygon fill="black" stroke="black" points="7717.25,-6842.14 7726.93,-6837.84 7716.67,-6835.16 7717.25,-6842.14"/>
</g>
<!-- route_6_14 -->
<g id="node491" class="node">
<title>route_6_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8488" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8488" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8488" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 236,237</text>
<text text-anchor="middle" x="8488" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_14 -->
<g id="edge596" class="edge">
<title>gate_6&#45;&gt;route_6_14</title>
<path fill="none" stroke="black" d="M5108.59,-6930.25C5642.6,-6926.24 6985.91,-6910.71 8108,-6852.59 8173.09,-6849.22 8244.33,-6843.99 8307.37,-6838.82"/>
<polygon fill="black" stroke="black" points="8307.73,-6842.3 8317.41,-6837.99 8307.16,-6835.33 8307.73,-6842.3"/>
</g>
<!-- route_6_15 -->
<g id="node495" class="node">
<title>route_6_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9078" cy="-6821.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9078" y="-6834.28" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9078" y="-6824.28" font-family="Times,serif" font-size="9.00">GPU: 238,239</text>
<text text-anchor="middle" x="9078" y="-6814.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-6804.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_15 -->
<g id="edge601" class="edge">
<title>gate_6&#45;&gt;route_6_15</title>
<path fill="none" stroke="black" d="M5110.13,-6931.51C5710.85,-6930.25 7341.18,-6920.3 8698,-6852.59 8763.25,-6849.33 8834.68,-6844.11 8897.83,-6838.92"/>
<polygon fill="black" stroke="black" points="8898.21,-6842.4 8907.89,-6838.09 8897.64,-6835.43 8898.21,-6842.4"/>
</g>
<!-- expert_6_0_0 -->
<g id="node436" class="node">
<title>expert_6_0_0</title>
<polygon fill="lightgreen" stroke="black" points="366.5,-6754.37 89.5,-6754.37 89.5,-6710.37 366.5,-6710.37 366.5,-6754.37"/>
<text text-anchor="middle" x="228" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L6</text>
<text text-anchor="middle" x="228" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="228" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_0&#45;&gt;expert_6_0_0 -->
<g id="edge527" class="edge">
<title>route_6_0&#45;&gt;expert_6_0_0</title>
<path fill="none" stroke="black" d="M432.08,-6793.63C392.92,-6782.07 347.49,-6768.65 309.44,-6757.42"/>
<polygon fill="black" stroke="black" points="310.01,-6753.93 299.43,-6754.46 308.03,-6760.65 310.01,-6753.93"/>
</g>
<!-- expert_6_0_1 -->
<g id="node437" class="node">
<title>expert_6_0_1</title>
<polygon fill="lightgreen" stroke="black" points="661.5,-6754.37 384.5,-6754.37 384.5,-6710.37 661.5,-6710.37 661.5,-6754.37"/>
<text text-anchor="middle" x="523" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L6</text>
<text text-anchor="middle" x="523" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="523" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_0&#45;&gt;expert_6_0_1 -->
<g id="edge528" class="edge">
<title>route_6_0&#45;&gt;expert_6_0_1</title>
<path fill="none" stroke="black" d="M523,-6790.01C523,-6781.73 523,-6772.76 523,-6764.44"/>
<polygon fill="black" stroke="black" points="526.5,-6764.37 523,-6754.37 519.5,-6764.37 526.5,-6764.37"/>
</g>
<!-- tp_6_0 -->
<g id="node438" class="node">
<title>tp_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="2925" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2925" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L6</text>
<text text-anchor="middle" x="2925" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="2925" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2925" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_0_0&#45;&gt;tp_6_0 -->
<g id="edge529" class="edge">
<title>expert_6_0_0&#45;&gt;tp_6_0</title>
<path fill="none" stroke="black" d="M366.84,-6711.09C369.58,-6710.84 372.3,-6710.59 375,-6710.37 853.88,-6670.09 2353.56,-6650.59 2799.02,-6645.58"/>
<polygon fill="black" stroke="black" points="2799.07,-6649.08 2809.03,-6645.47 2798.99,-6642.08 2799.07,-6649.08"/>
</g>
<!-- expert_6_0_1&#45;&gt;tp_6_0 -->
<g id="edge530" class="edge">
<title>expert_6_0_1&#45;&gt;tp_6_0</title>
<path fill="none" stroke="black" d="M661.6,-6711.22C664.76,-6710.92 667.9,-6710.63 671,-6710.37 1089.26,-6674.67 2388.54,-6652.38 2799.23,-6646.09"/>
<polygon fill="black" stroke="black" points="2799.41,-6649.59 2809.35,-6645.94 2799.3,-6642.59 2799.41,-6649.59"/>
</g>
<!-- q_proj_7 -->
<g id="node499" class="node">
<title>q_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="4948,-6576.14 4652,-6576.14 4652,-6532.14 4948,-6532.14 4948,-6576.14"/>
<text text-anchor="middle" x="4800" y="-6566.94" font-family="Times,serif" font-size="9.00">Q Projection L7</text>
<text text-anchor="middle" x="4800" y="-6556.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4800" y="-6546.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-6536.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_6_0&#45;&gt;q_proj_7 -->
<g id="edge1668" class="edge">
<title>tp_6_0&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M3004.21,-6620.48C3019.31,-6617.1 3035.06,-6614.09 3050,-6612.14 3397.87,-6566.84 4273.53,-6602.97 4641.51,-6576.19"/>
<polygon fill="black" stroke="black" points="4642,-6579.66 4651.71,-6575.42 4641.48,-6572.68 4642,-6579.66"/>
</g>
<!-- k_proj_7 -->
<g id="node500" class="node">
<title>k_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="5262,-6576.14 4966,-6576.14 4966,-6532.14 5262,-6532.14 5262,-6576.14"/>
<text text-anchor="middle" x="5114" y="-6566.94" font-family="Times,serif" font-size="9.00">K Projection L7</text>
<text text-anchor="middle" x="5114" y="-6556.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="5114" y="-6546.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5114" y="-6536.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_6_0&#45;&gt;k_proj_7 -->
<g id="edge1669" class="edge">
<title>tp_6_0&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M3004.2,-6620.44C3019.3,-6617.06 3035.06,-6614.06 3050,-6612.14 3467.12,-6558.61 4517.78,-6607.51 4955.49,-6576.19"/>
<polygon fill="black" stroke="black" points="4956,-6579.66 4965.71,-6575.43 4955.48,-6572.68 4956,-6579.66"/>
</g>
<!-- v_proj_7 -->
<g id="node501" class="node">
<title>v_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="4634,-6576.14 4338,-6576.14 4338,-6532.14 4634,-6532.14 4634,-6576.14"/>
<text text-anchor="middle" x="4486" y="-6566.94" font-family="Times,serif" font-size="9.00">V Projection L7</text>
<text text-anchor="middle" x="4486" y="-6556.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4486" y="-6546.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4486" y="-6536.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_6_0&#45;&gt;v_proj_7 -->
<g id="edge1670" class="edge">
<title>tp_6_0&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M3004.57,-6620.61C3019.56,-6617.24 3035.19,-6614.2 3050,-6612.14 3292.49,-6578.45 4007.06,-6562.92 4327.44,-6557.5"/>
<polygon fill="black" stroke="black" points="4327.79,-6561 4337.73,-6557.33 4327.68,-6554 4327.79,-6561"/>
</g>
<!-- expert_6_1_0 -->
<g id="node440" class="node">
<title>expert_6_1_0</title>
<polygon fill="lightgreen" stroke="black" points="956.5,-6754.37 679.5,-6754.37 679.5,-6710.37 956.5,-6710.37 956.5,-6754.37"/>
<text text-anchor="middle" x="818" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L6</text>
<text text-anchor="middle" x="818" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 194</text>
<text text-anchor="middle" x="818" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="818" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_1&#45;&gt;expert_6_1_0 -->
<g id="edge532" class="edge">
<title>route_6_1&#45;&gt;expert_6_1_0</title>
<path fill="none" stroke="black" d="M1022.08,-6793.63C982.92,-6782.07 937.49,-6768.65 899.44,-6757.42"/>
<polygon fill="black" stroke="black" points="900.01,-6753.93 889.43,-6754.46 898.03,-6760.65 900.01,-6753.93"/>
</g>
<!-- expert_6_1_1 -->
<g id="node441" class="node">
<title>expert_6_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1251.5,-6754.37 974.5,-6754.37 974.5,-6710.37 1251.5,-6710.37 1251.5,-6754.37"/>
<text text-anchor="middle" x="1113" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L6</text>
<text text-anchor="middle" x="1113" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 195</text>
<text text-anchor="middle" x="1113" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_1&#45;&gt;expert_6_1_1 -->
<g id="edge533" class="edge">
<title>route_6_1&#45;&gt;expert_6_1_1</title>
<path fill="none" stroke="black" d="M1113,-6790.01C1113,-6781.73 1113,-6772.76 1113,-6764.44"/>
<polygon fill="black" stroke="black" points="1116.5,-6764.37 1113,-6754.37 1109.5,-6764.37 1116.5,-6764.37"/>
</g>
<!-- tp_6_1 -->
<g id="node442" class="node">
<title>tp_6_1</title>
<ellipse fill="lightblue" stroke="black" cx="3175" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3175" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L6</text>
<text text-anchor="middle" x="3175" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 194↔195</text>
<text text-anchor="middle" x="3175" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3175" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_1_0&#45;&gt;tp_6_1 -->
<g id="edge534" class="edge">
<title>expert_6_1_0&#45;&gt;tp_6_1</title>
<path fill="none" stroke="black" d="M956.59,-6711.17C959.76,-6710.88 962.9,-6710.61 966,-6710.37 1427.73,-6673.76 2590.54,-6732.96 3050,-6674.37 3061.68,-6672.88 3073.85,-6670.72 3085.81,-6668.24"/>
<polygon fill="black" stroke="black" points="3086.76,-6671.62 3095.8,-6666.09 3085.29,-6664.78 3086.76,-6671.62"/>
</g>
<!-- expert_6_1_1&#45;&gt;tp_6_1 -->
<g id="edge535" class="edge">
<title>expert_6_1_1&#45;&gt;tp_6_1</title>
<path fill="none" stroke="black" d="M1251.6,-6711.18C1254.76,-6710.89 1257.9,-6710.62 1261,-6710.37 1657.35,-6678.38 2655.63,-6725.23 3050,-6674.37 3061.67,-6672.86 3073.84,-6670.7 3085.81,-6668.21"/>
<polygon fill="black" stroke="black" points="3086.76,-6671.59 3095.79,-6666.05 3085.28,-6664.74 3086.76,-6671.59"/>
</g>
<!-- tp_6_1&#45;&gt;q_proj_7 -->
<g id="edge1671" class="edge">
<title>tp_6_1&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M3254.55,-6620.46C3269.55,-6617.1 3285.17,-6614.1 3300,-6612.14 3888.62,-6534.23 4046.04,-6622.78 4641.58,-6576.2"/>
<polygon fill="black" stroke="black" points="4642.02,-6579.68 4651.71,-6575.4 4641.47,-6572.7 4642.02,-6579.68"/>
</g>
<!-- tp_6_1&#45;&gt;k_proj_7 -->
<g id="edge1672" class="edge">
<title>tp_6_1&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M3254.21,-6620.47C3269.3,-6617.09 3285.06,-6614.08 3300,-6612.14 3662.04,-6565.15 4573.58,-6603.91 4955.67,-6576.18"/>
<polygon fill="black" stroke="black" points="4956,-6579.66 4965.71,-6575.42 4955.48,-6572.68 4956,-6579.66"/>
</g>
<!-- tp_6_1&#45;&gt;v_proj_7 -->
<g id="edge1673" class="edge">
<title>tp_6_1&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M3254.92,-6620.64C3269.81,-6617.29 3285.31,-6614.24 3300,-6612.14 3493.63,-6584.42 4051.96,-6566.47 4327.85,-6559.04"/>
<polygon fill="black" stroke="black" points="4328.05,-6562.54 4337.95,-6558.77 4327.86,-6555.54 4328.05,-6562.54"/>
</g>
<!-- expert_6_2_0 -->
<g id="node444" class="node">
<title>expert_6_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1546.5,-6754.37 1269.5,-6754.37 1269.5,-6710.37 1546.5,-6710.37 1546.5,-6754.37"/>
<text text-anchor="middle" x="1408" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L6</text>
<text text-anchor="middle" x="1408" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 196</text>
<text text-anchor="middle" x="1408" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1408" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_2&#45;&gt;expert_6_2_0 -->
<g id="edge537" class="edge">
<title>route_6_2&#45;&gt;expert_6_2_0</title>
<path fill="none" stroke="black" d="M1612.08,-6793.63C1572.92,-6782.07 1527.49,-6768.65 1489.44,-6757.42"/>
<polygon fill="black" stroke="black" points="1490.01,-6753.93 1479.43,-6754.46 1488.03,-6760.65 1490.01,-6753.93"/>
</g>
<!-- expert_6_2_1 -->
<g id="node445" class="node">
<title>expert_6_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1841.5,-6754.37 1564.5,-6754.37 1564.5,-6710.37 1841.5,-6710.37 1841.5,-6754.37"/>
<text text-anchor="middle" x="1703" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L6</text>
<text text-anchor="middle" x="1703" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 197</text>
<text text-anchor="middle" x="1703" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_2&#45;&gt;expert_6_2_1 -->
<g id="edge538" class="edge">
<title>route_6_2&#45;&gt;expert_6_2_1</title>
<path fill="none" stroke="black" d="M1703,-6790.01C1703,-6781.73 1703,-6772.76 1703,-6764.44"/>
<polygon fill="black" stroke="black" points="1706.5,-6764.37 1703,-6754.37 1699.5,-6764.37 1706.5,-6764.37"/>
</g>
<!-- tp_6_2 -->
<g id="node446" class="node">
<title>tp_6_2</title>
<ellipse fill="lightblue" stroke="black" cx="3425" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3425" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L6</text>
<text text-anchor="middle" x="3425" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 196↔197</text>
<text text-anchor="middle" x="3425" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3425" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_2_0&#45;&gt;tp_6_2 -->
<g id="edge539" class="edge">
<title>expert_6_2_0&#45;&gt;tp_6_2</title>
<path fill="none" stroke="black" d="M1546.6,-6711.18C1549.76,-6710.89 1552.9,-6710.62 1556,-6710.37 1942.37,-6679.08 2915.56,-6724.05 3300,-6674.37 3311.67,-6672.86 3323.84,-6670.69 3335.81,-6668.21"/>
<polygon fill="black" stroke="black" points="3336.76,-6671.58 3345.79,-6666.05 3335.28,-6664.74 3336.76,-6671.58"/>
</g>
<!-- expert_6_2_1&#45;&gt;tp_6_2 -->
<g id="edge540" class="edge">
<title>expert_6_2_1&#45;&gt;tp_6_2</title>
<path fill="none" stroke="black" d="M1841.6,-6711.2C1844.76,-6710.9 1847.9,-6710.62 1851,-6710.37 2492.99,-6657.03 2661.29,-6758.27 3300,-6674.37 3311.67,-6672.83 3323.84,-6670.65 3335.8,-6668.16"/>
<polygon fill="black" stroke="black" points="3336.75,-6671.53 3345.79,-6666 3335.27,-6664.69 3336.75,-6671.53"/>
</g>
<!-- tp_6_2&#45;&gt;q_proj_7 -->
<g id="edge1674" class="edge">
<title>tp_6_2&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M3504.56,-6620.53C3519.55,-6617.17 3535.18,-6614.15 3550,-6612.14 4028.35,-6547.33 4156.88,-6615.47 4641.65,-6576.2"/>
<polygon fill="black" stroke="black" points="4642.03,-6579.68 4651.71,-6575.38 4641.46,-6572.71 4642.03,-6579.68"/>
</g>
<!-- tp_6_2&#45;&gt;k_proj_7 -->
<g id="edge1675" class="edge">
<title>tp_6_2&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M3504.21,-6620.52C3519.31,-6617.13 3535.06,-6614.11 3550,-6612.14 4166.85,-6530.87 4331.66,-6624.66 4955.56,-6576.2"/>
<polygon fill="black" stroke="black" points="4956.02,-6579.68 4965.71,-6575.41 4955.47,-6572.7 4956.02,-6579.68"/>
</g>
<!-- tp_6_2&#45;&gt;v_proj_7 -->
<g id="edge1676" class="edge">
<title>tp_6_2&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M3505.28,-6620.72C3520.06,-6617.38 3535.43,-6614.32 3550,-6612.14 3821.14,-6571.55 4140.59,-6559.69 4327.46,-6556.34"/>
<polygon fill="black" stroke="black" points="4327.7,-6559.83 4337.64,-6556.16 4327.58,-6552.83 4327.7,-6559.83"/>
</g>
<!-- expert_6_3_0 -->
<g id="node448" class="node">
<title>expert_6_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2136.5,-6754.37 1859.5,-6754.37 1859.5,-6710.37 2136.5,-6710.37 2136.5,-6754.37"/>
<text text-anchor="middle" x="1998" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L6</text>
<text text-anchor="middle" x="1998" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 198</text>
<text text-anchor="middle" x="1998" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1998" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_3&#45;&gt;expert_6_3_0 -->
<g id="edge542" class="edge">
<title>route_6_3&#45;&gt;expert_6_3_0</title>
<path fill="none" stroke="black" d="M2202.08,-6793.63C2162.92,-6782.07 2117.49,-6768.65 2079.44,-6757.42"/>
<polygon fill="black" stroke="black" points="2080.01,-6753.93 2069.43,-6754.46 2078.03,-6760.65 2080.01,-6753.93"/>
</g>
<!-- expert_6_3_1 -->
<g id="node449" class="node">
<title>expert_6_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2431.5,-6754.37 2154.5,-6754.37 2154.5,-6710.37 2431.5,-6710.37 2431.5,-6754.37"/>
<text text-anchor="middle" x="2293" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L6</text>
<text text-anchor="middle" x="2293" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 199</text>
<text text-anchor="middle" x="2293" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_3&#45;&gt;expert_6_3_1 -->
<g id="edge543" class="edge">
<title>route_6_3&#45;&gt;expert_6_3_1</title>
<path fill="none" stroke="black" d="M2293,-6790.01C2293,-6781.73 2293,-6772.76 2293,-6764.44"/>
<polygon fill="black" stroke="black" points="2296.5,-6764.37 2293,-6754.37 2289.5,-6764.37 2296.5,-6764.37"/>
</g>
<!-- tp_6_3 -->
<g id="node450" class="node">
<title>tp_6_3</title>
<ellipse fill="lightblue" stroke="black" cx="3675" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3675" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L6</text>
<text text-anchor="middle" x="3675" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 198↔199</text>
<text text-anchor="middle" x="3675" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3675" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_3_0&#45;&gt;tp_6_3 -->
<g id="edge544" class="edge">
<title>expert_6_3_0&#45;&gt;tp_6_3</title>
<path fill="none" stroke="black" d="M2136.6,-6711.21C2139.76,-6710.91 2142.9,-6710.62 2146,-6710.37 2768.04,-6658.43 2931.14,-6755.91 3550,-6674.37 3561.67,-6672.83 3573.84,-6670.65 3585.8,-6668.15"/>
<polygon fill="black" stroke="black" points="3586.75,-6671.53 3595.79,-6665.99 3585.27,-6664.68 3586.75,-6671.53"/>
</g>
<!-- expert_6_3_1&#45;&gt;tp_6_3 -->
<g id="edge545" class="edge">
<title>expert_6_3_1&#45;&gt;tp_6_3</title>
<path fill="none" stroke="black" d="M2431.6,-6711.23C2434.76,-6710.93 2437.9,-6710.64 2441,-6710.37 2932.3,-6667.66 3061.3,-6740.46 3550,-6674.37 3561.58,-6672.8 3573.65,-6670.62 3585.52,-6668.13"/>
<polygon fill="black" stroke="black" points="3586.41,-6671.52 3595.44,-6665.98 3584.92,-6664.68 3586.41,-6671.52"/>
</g>
<!-- tp_6_3&#45;&gt;q_proj_7 -->
<g id="edge1677" class="edge">
<title>tp_6_3&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M3754.91,-6620.57C3769.8,-6617.23 3785.3,-6614.21 3800,-6612.14 4168.1,-6560.44 4267.69,-6608.18 4641.69,-6576.21"/>
<polygon fill="black" stroke="black" points="4642.05,-6579.69 4651.71,-6575.34 4641.44,-6572.72 4642.05,-6579.69"/>
</g>
<!-- tp_6_3&#45;&gt;k_proj_7 -->
<g id="edge1678" class="edge">
<title>tp_6_3&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M3754.56,-6620.51C3769.55,-6617.15 3785.18,-6614.13 3800,-6612.14 4306.52,-6543.99 4442.47,-6617.32 4955.45,-6576.22"/>
<polygon fill="black" stroke="black" points="4956.03,-6579.68 4965.71,-6575.38 4955.46,-6572.71 4956.03,-6579.68"/>
</g>
<!-- tp_6_3&#45;&gt;v_proj_7 -->
<g id="edge1679" class="edge">
<title>tp_6_3&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M3755.99,-6620.83C3770.57,-6617.52 3785.68,-6614.45 3800,-6612.14 3979.42,-6583.25 4187.75,-6568.57 4327.32,-6561.41"/>
<polygon fill="black" stroke="black" points="4327.86,-6564.89 4337.67,-6560.89 4327.51,-6557.9 4327.86,-6564.89"/>
</g>
<!-- expert_6_4_0 -->
<g id="node452" class="node">
<title>expert_6_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2726.5,-6754.37 2449.5,-6754.37 2449.5,-6710.37 2726.5,-6710.37 2726.5,-6754.37"/>
<text text-anchor="middle" x="2588" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L6</text>
<text text-anchor="middle" x="2588" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 200</text>
<text text-anchor="middle" x="2588" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2588" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_4&#45;&gt;expert_6_4_0 -->
<g id="edge547" class="edge">
<title>route_6_4&#45;&gt;expert_6_4_0</title>
<path fill="none" stroke="black" d="M2792.08,-6793.63C2752.92,-6782.07 2707.49,-6768.65 2669.44,-6757.42"/>
<polygon fill="black" stroke="black" points="2670.01,-6753.93 2659.43,-6754.46 2668.03,-6760.65 2670.01,-6753.93"/>
</g>
<!-- expert_6_4_1 -->
<g id="node453" class="node">
<title>expert_6_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3021.5,-6754.37 2744.5,-6754.37 2744.5,-6710.37 3021.5,-6710.37 3021.5,-6754.37"/>
<text text-anchor="middle" x="2883" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L6</text>
<text text-anchor="middle" x="2883" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 201</text>
<text text-anchor="middle" x="2883" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_4&#45;&gt;expert_6_4_1 -->
<g id="edge548" class="edge">
<title>route_6_4&#45;&gt;expert_6_4_1</title>
<path fill="none" stroke="black" d="M2883,-6790.01C2883,-6781.73 2883,-6772.76 2883,-6764.44"/>
<polygon fill="black" stroke="black" points="2886.5,-6764.37 2883,-6754.37 2879.5,-6764.37 2886.5,-6764.37"/>
</g>
<!-- tp_6_4 -->
<g id="node454" class="node">
<title>tp_6_4</title>
<ellipse fill="lightblue" stroke="black" cx="3925" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3925" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L6</text>
<text text-anchor="middle" x="3925" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 200↔201</text>
<text text-anchor="middle" x="3925" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3925" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_4_0&#45;&gt;tp_6_4 -->
<g id="edge549" class="edge">
<title>expert_6_4_0&#45;&gt;tp_6_4</title>
<path fill="none" stroke="black" d="M2726.6,-6711.24C2729.76,-6710.93 2732.9,-6710.64 2736,-6710.37 3207.35,-6669.07 3331.15,-6738.1 3800,-6674.37 3811.58,-6672.79 3823.65,-6670.6 3835.52,-6668.12"/>
<polygon fill="black" stroke="black" points="3836.41,-6671.51 3845.44,-6665.96 3834.92,-6664.66 3836.41,-6671.51"/>
</g>
<!-- expert_6_4_1&#45;&gt;tp_6_4 -->
<g id="edge550" class="edge">
<title>expert_6_4_1&#45;&gt;tp_6_4</title>
<path fill="none" stroke="black" d="M3021.6,-6711.3C3024.76,-6710.97 3027.9,-6710.66 3031,-6710.37 3371.65,-6678.3 3461.27,-6722.65 3800,-6674.37 3811.48,-6672.73 3823.45,-6670.52 3835.24,-6668.03"/>
<polygon fill="black" stroke="black" points="3836.06,-6671.43 3845.08,-6665.88 3834.56,-6664.59 3836.06,-6671.43"/>
</g>
<!-- tp_6_4&#45;&gt;q_proj_7 -->
<g id="edge1680" class="edge">
<title>tp_6_4&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M4005.28,-6620.72C4020.06,-6617.38 4035.43,-6614.32 4050,-6612.14 4307.82,-6573.57 4378.41,-6600.94 4641.46,-6576.25"/>
<polygon fill="black" stroke="black" points="4642.08,-6579.7 4651.7,-6575.27 4641.41,-6572.73 4642.08,-6579.7"/>
</g>
<!-- tp_6_4&#45;&gt;k_proj_7 -->
<g id="edge1681" class="edge">
<title>tp_6_4&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M4004.57,-6620.61C4019.56,-6617.24 4035.19,-6614.2 4050,-6612.14 4446.27,-6557.09 4553.3,-6610.03 4955.54,-6576.22"/>
<polygon fill="black" stroke="black" points="4956.04,-6579.69 4965.71,-6575.35 4955.45,-6572.71 4956.04,-6579.69"/>
</g>
<!-- tp_6_4&#45;&gt;v_proj_7 -->
<g id="edge1682" class="edge">
<title>tp_6_4&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M4007.1,-6621.16C4021.35,-6617.88 4036.06,-6614.72 4050,-6612.14 4141.51,-6595.19 4244.75,-6581.45 4327.79,-6571.72"/>
<polygon fill="black" stroke="black" points="4328.28,-6575.18 4337.81,-6570.55 4327.47,-6568.23 4328.28,-6575.18"/>
</g>
<!-- expert_6_5_0 -->
<g id="node456" class="node">
<title>expert_6_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-6754.37 3039.5,-6754.37 3039.5,-6710.37 3316.5,-6710.37 3316.5,-6754.37"/>
<text text-anchor="middle" x="3178" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L6</text>
<text text-anchor="middle" x="3178" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 202</text>
<text text-anchor="middle" x="3178" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3178" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_5&#45;&gt;expert_6_5_0 -->
<g id="edge552" class="edge">
<title>route_6_5&#45;&gt;expert_6_5_0</title>
<path fill="none" stroke="black" d="M3382.08,-6793.63C3342.92,-6782.07 3297.49,-6768.65 3259.44,-6757.42"/>
<polygon fill="black" stroke="black" points="3260.01,-6753.93 3249.43,-6754.46 3258.03,-6760.65 3260.01,-6753.93"/>
</g>
<!-- expert_6_5_1 -->
<g id="node457" class="node">
<title>expert_6_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3611.5,-6754.37 3334.5,-6754.37 3334.5,-6710.37 3611.5,-6710.37 3611.5,-6754.37"/>
<text text-anchor="middle" x="3473" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L6</text>
<text text-anchor="middle" x="3473" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 203</text>
<text text-anchor="middle" x="3473" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_5&#45;&gt;expert_6_5_1 -->
<g id="edge553" class="edge">
<title>route_6_5&#45;&gt;expert_6_5_1</title>
<path fill="none" stroke="black" d="M3473,-6790.01C3473,-6781.73 3473,-6772.76 3473,-6764.44"/>
<polygon fill="black" stroke="black" points="3476.5,-6764.37 3473,-6754.37 3469.5,-6764.37 3476.5,-6764.37"/>
</g>
<!-- tp_6_5 -->
<g id="node458" class="node">
<title>tp_6_5</title>
<ellipse fill="lightblue" stroke="black" cx="4175" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4175" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L6</text>
<text text-anchor="middle" x="4175" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 202↔203</text>
<text text-anchor="middle" x="4175" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4175" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_5_0&#45;&gt;tp_6_5 -->
<g id="edge554" class="edge">
<title>expert_6_5_0&#45;&gt;tp_6_5</title>
<path fill="none" stroke="black" d="M3316.61,-6711.31C3319.77,-6710.98 3322.9,-6710.66 3326,-6710.37 3646.71,-6679.7 3731.11,-6720.29 4050,-6674.37 4061.48,-6672.71 4073.45,-6670.49 4085.23,-6668"/>
<polygon fill="black" stroke="black" points="4086.05,-6671.4 4095.07,-6665.85 4084.56,-6664.56 4086.05,-6671.4"/>
</g>
<!-- expert_6_5_1&#45;&gt;tp_6_5 -->
<g id="edge555" class="edge">
<title>expert_6_5_1&#45;&gt;tp_6_5</title>
<path fill="none" stroke="black" d="M3611.62,-6711.45C3614.78,-6711.08 3617.91,-6710.71 3621,-6710.37 3811.13,-6688.92 3861.11,-6704.86 4050,-6674.37 4061.08,-6672.58 4072.63,-6670.33 4084.03,-6667.87"/>
<polygon fill="black" stroke="black" points="4085,-6671.24 4094,-6665.67 4083.48,-6664.41 4085,-6671.24"/>
</g>
<!-- tp_6_5&#45;&gt;q_proj_7 -->
<g id="edge1683" class="edge">
<title>tp_6_5&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M4256.37,-6621.01C4270.84,-6617.71 4285.81,-6614.58 4300,-6612.14 4447.81,-6586.69 4489.04,-6593.97 4641.48,-6576.29"/>
<polygon fill="black" stroke="black" points="4642.16,-6579.74 4651.68,-6575.09 4641.34,-6572.79 4642.16,-6579.74"/>
</g>
<!-- tp_6_5&#45;&gt;k_proj_7 -->
<g id="edge1684" class="edge">
<title>tp_6_5&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M4255.27,-6620.64C4270.05,-6617.31 4285.42,-6614.28 4300,-6612.14 4586.1,-6570.2 4664.1,-6602.8 4955.68,-6576.22"/>
<polygon fill="black" stroke="black" points="4956.07,-6579.7 4965.7,-6575.29 4955.42,-6572.73 4956.07,-6579.7"/>
</g>
<!-- tp_6_5&#45;&gt;v_proj_7 -->
<g id="edge1685" class="edge">
<title>tp_6_5&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M4253.48,-6620.27C4298.5,-6607.66 4355.05,-6591.82 4401.1,-6578.92"/>
<polygon fill="black" stroke="black" points="4402.08,-6582.28 4410.77,-6576.21 4400.19,-6575.54 4402.08,-6582.28"/>
</g>
<!-- expert_6_6_0 -->
<g id="node460" class="node">
<title>expert_6_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3906.5,-6754.37 3629.5,-6754.37 3629.5,-6710.37 3906.5,-6710.37 3906.5,-6754.37"/>
<text text-anchor="middle" x="3768" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L6</text>
<text text-anchor="middle" x="3768" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 204</text>
<text text-anchor="middle" x="3768" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3768" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_6&#45;&gt;expert_6_6_0 -->
<g id="edge557" class="edge">
<title>route_6_6&#45;&gt;expert_6_6_0</title>
<path fill="none" stroke="black" d="M3972.08,-6793.63C3932.92,-6782.07 3887.49,-6768.65 3849.44,-6757.42"/>
<polygon fill="black" stroke="black" points="3850.01,-6753.93 3839.43,-6754.46 3848.03,-6760.65 3850.01,-6753.93"/>
</g>
<!-- expert_6_6_1 -->
<g id="node461" class="node">
<title>expert_6_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4201.5,-6754.37 3924.5,-6754.37 3924.5,-6710.37 4201.5,-6710.37 4201.5,-6754.37"/>
<text text-anchor="middle" x="4063" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L6</text>
<text text-anchor="middle" x="4063" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 205</text>
<text text-anchor="middle" x="4063" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_6&#45;&gt;expert_6_6_1 -->
<g id="edge558" class="edge">
<title>route_6_6&#45;&gt;expert_6_6_1</title>
<path fill="none" stroke="black" d="M4063,-6790.01C4063,-6781.73 4063,-6772.76 4063,-6764.44"/>
<polygon fill="black" stroke="black" points="4066.5,-6764.37 4063,-6754.37 4059.5,-6764.37 4066.5,-6764.37"/>
</g>
<!-- tp_6_6 -->
<g id="node462" class="node">
<title>tp_6_6</title>
<ellipse fill="lightblue" stroke="black" cx="4425" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4425" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L6</text>
<text text-anchor="middle" x="4425" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 204↔205</text>
<text text-anchor="middle" x="4425" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4425" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_6_0&#45;&gt;tp_6_6 -->
<g id="edge559" class="edge">
<title>expert_6_6_0&#45;&gt;tp_6_6</title>
<path fill="none" stroke="black" d="M3906.63,-6711.49C3909.78,-6711.11 3912.91,-6710.73 3916,-6710.37 4086.24,-6690.32 4130.91,-6702.51 4300,-6674.37 4311.07,-6672.52 4322.61,-6670.24 4334.02,-6667.77"/>
<polygon fill="black" stroke="black" points="4334.98,-6671.14 4343.98,-6665.55 4333.46,-6664.31 4334.98,-6671.14"/>
</g>
<!-- expert_6_6_1&#45;&gt;tp_6_6 -->
<g id="edge560" class="edge">
<title>expert_6_6_1&#45;&gt;tp_6_6</title>
<path fill="none" stroke="black" d="M4150.51,-6710.33C4195.24,-6699.57 4250.52,-6686.27 4300,-6674.37 4309.87,-6671.99 4320.17,-6669.51 4330.45,-6667.03"/>
<polygon fill="black" stroke="black" points="4331.38,-6670.41 4340.28,-6664.67 4329.74,-6663.61 4331.38,-6670.41"/>
</g>
<!-- tp_6_6&#45;&gt;q_proj_7 -->
<g id="edge1686" class="edge">
<title>tp_6_6&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M4509.35,-6621.78C4522.94,-6618.53 4536.85,-6615.22 4550,-6612.14 4598.15,-6600.85 4651.59,-6588.63 4696.67,-6578.4"/>
<polygon fill="black" stroke="black" points="4697.47,-6581.81 4706.45,-6576.19 4695.92,-6574.98 4697.47,-6581.81"/>
</g>
<!-- tp_6_6&#45;&gt;k_proj_7 -->
<g id="edge1687" class="edge">
<title>tp_6_6&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M4506,-6620.89C4520.58,-6617.58 4535.68,-6614.49 4550,-6612.14 4725.97,-6583.33 4774.76,-6595.71 4955.57,-6576.26"/>
<polygon fill="black" stroke="black" points="4956.13,-6579.72 4965.69,-6575.16 4955.37,-6572.77 4956.13,-6579.72"/>
</g>
<!-- tp_6_6&#45;&gt;v_proj_7 -->
<g id="edge1688" class="edge">
<title>tp_6_6&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M4445.99,-6612.27C4452.26,-6603.32 4459.12,-6593.52 4465.37,-6584.6"/>
<polygon fill="black" stroke="black" points="4468.26,-6586.58 4471.13,-6576.38 4462.52,-6582.56 4468.26,-6586.58"/>
</g>
<!-- expert_6_7_0 -->
<g id="node464" class="node">
<title>expert_6_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4496.5,-6754.37 4219.5,-6754.37 4219.5,-6710.37 4496.5,-6710.37 4496.5,-6754.37"/>
<text text-anchor="middle" x="4358" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L6</text>
<text text-anchor="middle" x="4358" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 206</text>
<text text-anchor="middle" x="4358" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4358" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_7&#45;&gt;expert_6_7_0 -->
<g id="edge562" class="edge">
<title>route_6_7&#45;&gt;expert_6_7_0</title>
<path fill="none" stroke="black" d="M4515.64,-6792.56C4486.11,-6781.47 4452.42,-6768.82 4423.8,-6758.07"/>
<polygon fill="black" stroke="black" points="4424.89,-6754.74 4414.29,-6754.5 4422.43,-6761.3 4424.89,-6754.74"/>
</g>
<!-- expert_6_7_1 -->
<g id="node465" class="node">
<title>expert_6_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4791.5,-6754.37 4514.5,-6754.37 4514.5,-6710.37 4791.5,-6710.37 4791.5,-6754.37"/>
<text text-anchor="middle" x="4653" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L6</text>
<text text-anchor="middle" x="4653" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 207</text>
<text text-anchor="middle" x="4653" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4653" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_7&#45;&gt;expert_6_7_1 -->
<g id="edge563" class="edge">
<title>route_6_7&#45;&gt;expert_6_7_1</title>
<path fill="none" stroke="black" d="M4611.68,-6790.5C4618.15,-6781.55 4625.24,-6771.75 4631.69,-6762.83"/>
<polygon fill="black" stroke="black" points="4634.61,-6764.76 4637.64,-6754.61 4628.94,-6760.66 4634.61,-6764.76"/>
</g>
<!-- tp_6_7 -->
<g id="node466" class="node">
<title>tp_6_7</title>
<ellipse fill="lightblue" stroke="black" cx="4675" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4675" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L6</text>
<text text-anchor="middle" x="4675" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 206↔207</text>
<text text-anchor="middle" x="4675" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4675" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_7_0&#45;&gt;tp_6_7 -->
<g id="edge564" class="edge">
<title>expert_6_7_0&#45;&gt;tp_6_7</title>
<path fill="none" stroke="black" d="M4434.74,-6710.28C4480.34,-6697.75 4538.37,-6681.8 4585.98,-6668.72"/>
<polygon fill="black" stroke="black" points="4586.94,-6672.08 4595.66,-6666.06 4585.09,-6665.33 4586.94,-6672.08"/>
</g>
<!-- expert_6_7_1&#45;&gt;tp_6_7 -->
<g id="edge565" class="edge">
<title>expert_6_7_1&#45;&gt;tp_6_7</title>
<path fill="none" stroke="black" d="M4658.33,-6710.28C4660.3,-6702.45 4662.62,-6693.29 4664.88,-6684.32"/>
<polygon fill="black" stroke="black" points="4668.34,-6684.92 4667.4,-6674.37 4661.55,-6683.2 4668.34,-6684.92"/>
</g>
<!-- tp_6_7&#45;&gt;q_proj_7 -->
<g id="edge1689" class="edge">
<title>tp_6_7&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M4715.58,-6613.97C4730.24,-6603.75 4746.74,-6592.25 4761.24,-6582.15"/>
<polygon fill="black" stroke="black" points="4763.32,-6584.97 4769.52,-6576.38 4759.31,-6579.23 4763.32,-6584.97"/>
</g>
<!-- tp_6_7&#45;&gt;k_proj_7 -->
<g id="edge1690" class="edge">
<title>tp_6_7&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M4758.23,-6621.51C4772.14,-6618.24 4786.46,-6615 4800,-6612.14 4858.43,-6599.81 4923.31,-6587.76 4978.87,-6577.94"/>
<polygon fill="black" stroke="black" points="4979.53,-6581.37 4988.77,-6576.19 4978.31,-6574.48 4979.53,-6581.37"/>
</g>
<!-- tp_6_7&#45;&gt;v_proj_7 -->
<g id="edge1691" class="edge">
<title>tp_6_7&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M4618.04,-6616C4593.67,-6604.76 4565.32,-6591.7 4541.15,-6580.56"/>
<polygon fill="black" stroke="black" points="4542.31,-6577.24 4531.76,-6576.23 4539.38,-6583.6 4542.31,-6577.24"/>
</g>
<!-- expert_6_8_0 -->
<g id="node468" class="node">
<title>expert_6_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-6754.37 4809.5,-6754.37 4809.5,-6710.37 5086.5,-6710.37 5086.5,-6754.37"/>
<text text-anchor="middle" x="4948" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L6</text>
<text text-anchor="middle" x="4948" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="4948" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4948" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_8&#45;&gt;expert_6_8_0 -->
<g id="edge567" class="edge">
<title>route_6_8&#45;&gt;expert_6_8_0</title>
<path fill="none" stroke="black" d="M4988.66,-6790.5C4982.29,-6781.55 4975.32,-6771.75 4968.97,-6762.83"/>
<polygon fill="black" stroke="black" points="4971.77,-6760.72 4963.12,-6754.61 4966.06,-6764.78 4971.77,-6760.72"/>
</g>
<!-- expert_6_8_1 -->
<g id="node469" class="node">
<title>expert_6_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5381.5,-6754.37 5104.5,-6754.37 5104.5,-6710.37 5381.5,-6710.37 5381.5,-6754.37"/>
<text text-anchor="middle" x="5243" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L6</text>
<text text-anchor="middle" x="5243" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="5243" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5243" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_8&#45;&gt;expert_6_8_1 -->
<g id="edge568" class="edge">
<title>route_6_8&#45;&gt;expert_6_8_1</title>
<path fill="none" stroke="black" d="M5084.68,-6792.56C5114.34,-6781.47 5148.17,-6768.82 5176.92,-6758.07"/>
<polygon fill="black" stroke="black" points="5178.32,-6761.28 5186.46,-6754.5 5175.87,-6754.73 5178.32,-6761.28"/>
</g>
<!-- tp_6_8 -->
<g id="node470" class="node">
<title>tp_6_8</title>
<ellipse fill="lightblue" stroke="black" cx="4925" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4925" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L6</text>
<text text-anchor="middle" x="4925" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="4925" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4925" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_8_0&#45;&gt;tp_6_8 -->
<g id="edge569" class="edge">
<title>expert_6_8_0&#45;&gt;tp_6_8</title>
<path fill="none" stroke="black" d="M4942.43,-6710.28C4940.37,-6702.45 4937.95,-6693.29 4935.58,-6684.32"/>
<polygon fill="black" stroke="black" points="4938.89,-6683.14 4932.95,-6674.37 4932.12,-6684.93 4938.89,-6683.14"/>
</g>
<!-- expert_6_8_1&#45;&gt;tp_6_8 -->
<g id="edge570" class="edge">
<title>expert_6_8_1&#45;&gt;tp_6_8</title>
<path fill="none" stroke="black" d="M5166.02,-6710.28C5120.19,-6697.72 5061.84,-6681.74 5014.04,-6668.64"/>
<polygon fill="black" stroke="black" points="5014.88,-6665.25 5004.31,-6665.98 5013.03,-6672 5014.88,-6665.25"/>
</g>
<!-- tp_6_8&#45;&gt;q_proj_7 -->
<g id="edge1692" class="edge">
<title>tp_6_8&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M4884.42,-6613.97C4869.76,-6603.75 4853.26,-6592.25 4838.76,-6582.15"/>
<polygon fill="black" stroke="black" points="4840.69,-6579.23 4830.48,-6576.38 4836.68,-6584.97 4840.69,-6579.23"/>
</g>
<!-- tp_6_8&#45;&gt;k_proj_7 -->
<g id="edge1693" class="edge">
<title>tp_6_8&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M4981.96,-6616C5006.33,-6604.76 5034.68,-6591.7 5058.85,-6580.56"/>
<polygon fill="black" stroke="black" points="5060.62,-6583.6 5068.24,-6576.23 5057.69,-6577.24 5060.62,-6583.6"/>
</g>
<!-- tp_6_8&#45;&gt;v_proj_7 -->
<g id="edge1694" class="edge">
<title>tp_6_8&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M4841.77,-6621.51C4827.86,-6618.24 4813.54,-6615 4800,-6612.14 4741.57,-6599.81 4676.69,-6587.76 4621.13,-6577.94"/>
<polygon fill="black" stroke="black" points="4621.69,-6574.48 4611.23,-6576.19 4620.47,-6581.37 4621.69,-6574.48"/>
</g>
<!-- expert_6_9_0 -->
<g id="node472" class="node">
<title>expert_6_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5676.5,-6754.37 5399.5,-6754.37 5399.5,-6710.37 5676.5,-6710.37 5676.5,-6754.37"/>
<text text-anchor="middle" x="5538" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L6</text>
<text text-anchor="middle" x="5538" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 226</text>
<text text-anchor="middle" x="5538" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_9&#45;&gt;expert_6_9_0 -->
<g id="edge572" class="edge">
<title>route_6_9&#45;&gt;expert_6_9_0</title>
<path fill="none" stroke="black" d="M5538,-6790.01C5538,-6781.73 5538,-6772.76 5538,-6764.44"/>
<polygon fill="black" stroke="black" points="5541.5,-6764.37 5538,-6754.37 5534.5,-6764.37 5541.5,-6764.37"/>
</g>
<!-- expert_6_9_1 -->
<g id="node473" class="node">
<title>expert_6_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5971.5,-6754.37 5694.5,-6754.37 5694.5,-6710.37 5971.5,-6710.37 5971.5,-6754.37"/>
<text text-anchor="middle" x="5833" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L6</text>
<text text-anchor="middle" x="5833" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 227</text>
<text text-anchor="middle" x="5833" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5833" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_9&#45;&gt;expert_6_9_1 -->
<g id="edge573" class="edge">
<title>route_6_9&#45;&gt;expert_6_9_1</title>
<path fill="none" stroke="black" d="M5628.92,-6793.63C5668.08,-6782.07 5713.51,-6768.65 5751.56,-6757.42"/>
<polygon fill="black" stroke="black" points="5752.97,-6760.65 5761.57,-6754.46 5750.99,-6753.93 5752.97,-6760.65"/>
</g>
<!-- tp_6_9 -->
<g id="node474" class="node">
<title>tp_6_9</title>
<ellipse fill="lightblue" stroke="black" cx="5175" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5175" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L6</text>
<text text-anchor="middle" x="5175" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 226↔227</text>
<text text-anchor="middle" x="5175" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5175" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_9_0&#45;&gt;tp_6_9 -->
<g id="edge574" class="edge">
<title>expert_6_9_0&#45;&gt;tp_6_9</title>
<path fill="none" stroke="black" d="M5450.11,-6710.35C5405.2,-6699.6 5349.68,-6686.3 5300,-6674.37 5290.05,-6671.98 5279.65,-6669.48 5269.29,-6666.98"/>
<polygon fill="black" stroke="black" points="5269.92,-6663.53 5259.38,-6664.6 5268.28,-6670.34 5269.92,-6663.53"/>
</g>
<!-- expert_6_9_1&#45;&gt;tp_6_9 -->
<g id="edge575" class="edge">
<title>expert_6_9_1&#45;&gt;tp_6_9</title>
<path fill="none" stroke="black" d="M5694.14,-6711.34C5691.4,-6711.01 5688.69,-6710.68 5686,-6710.37 5514.89,-6690.18 5469.97,-6702.61 5300,-6674.37 5288.93,-6672.53 5277.39,-6670.25 5265.98,-6667.77"/>
<polygon fill="black" stroke="black" points="5266.54,-6664.31 5256.01,-6665.56 5265.02,-6671.14 5266.54,-6664.31"/>
</g>
<!-- tp_6_9&#45;&gt;q_proj_7 -->
<g id="edge1695" class="edge">
<title>tp_6_9&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M5090.65,-6621.78C5077.06,-6618.53 5063.15,-6615.22 5050,-6612.14 5001.85,-6600.85 4948.41,-6588.63 4903.33,-6578.4"/>
<polygon fill="black" stroke="black" points="4904.08,-6574.98 4893.55,-6576.19 4902.53,-6581.81 4904.08,-6574.98"/>
</g>
<!-- tp_6_9&#45;&gt;k_proj_7 -->
<g id="edge1696" class="edge">
<title>tp_6_9&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M5154.01,-6612.27C5147.74,-6603.32 5140.88,-6593.52 5134.63,-6584.6"/>
<polygon fill="black" stroke="black" points="5137.48,-6582.56 5128.87,-6576.38 5131.74,-6586.58 5137.48,-6582.56"/>
</g>
<!-- tp_6_9&#45;&gt;v_proj_7 -->
<g id="edge1697" class="edge">
<title>tp_6_9&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M5094,-6620.89C5079.42,-6617.58 5064.32,-6614.49 5050,-6612.14 4874.03,-6583.33 4825.24,-6595.71 4644.43,-6576.26"/>
<polygon fill="black" stroke="black" points="4644.63,-6572.77 4634.31,-6575.16 4643.87,-6579.72 4644.63,-6572.77"/>
</g>
<!-- expert_6_10_0 -->
<g id="node476" class="node">
<title>expert_6_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6266.5,-6754.37 5989.5,-6754.37 5989.5,-6710.37 6266.5,-6710.37 6266.5,-6754.37"/>
<text text-anchor="middle" x="6128" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L6</text>
<text text-anchor="middle" x="6128" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 228</text>
<text text-anchor="middle" x="6128" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_10&#45;&gt;expert_6_10_0 -->
<g id="edge577" class="edge">
<title>route_6_10&#45;&gt;expert_6_10_0</title>
<path fill="none" stroke="black" d="M6128,-6790.01C6128,-6781.73 6128,-6772.76 6128,-6764.44"/>
<polygon fill="black" stroke="black" points="6131.5,-6764.37 6128,-6754.37 6124.5,-6764.37 6131.5,-6764.37"/>
</g>
<!-- expert_6_10_1 -->
<g id="node477" class="node">
<title>expert_6_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6561.5,-6754.37 6284.5,-6754.37 6284.5,-6710.37 6561.5,-6710.37 6561.5,-6754.37"/>
<text text-anchor="middle" x="6423" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L6</text>
<text text-anchor="middle" x="6423" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 229</text>
<text text-anchor="middle" x="6423" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6423" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_10&#45;&gt;expert_6_10_1 -->
<g id="edge578" class="edge">
<title>route_6_10&#45;&gt;expert_6_10_1</title>
<path fill="none" stroke="black" d="M6218.92,-6793.63C6258.08,-6782.07 6303.51,-6768.65 6341.56,-6757.42"/>
<polygon fill="black" stroke="black" points="6342.97,-6760.65 6351.57,-6754.46 6340.99,-6753.93 6342.97,-6760.65"/>
</g>
<!-- tp_6_10 -->
<g id="node478" class="node">
<title>tp_6_10</title>
<ellipse fill="lightblue" stroke="black" cx="5425" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5425" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L6</text>
<text text-anchor="middle" x="5425" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 228↔229</text>
<text text-anchor="middle" x="5425" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5425" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_10_0&#45;&gt;tp_6_10 -->
<g id="edge579" class="edge">
<title>expert_6_10_0&#45;&gt;tp_6_10</title>
<path fill="none" stroke="black" d="M5989.14,-6711.31C5986.41,-6710.98 5983.69,-6710.67 5981,-6710.37 5790,-6688.76 5739.77,-6704.96 5550,-6674.37 5538.92,-6672.58 5527.37,-6670.33 5515.97,-6667.88"/>
<polygon fill="black" stroke="black" points="5516.52,-6664.41 5506,-6665.67 5515,-6671.25 5516.52,-6664.41"/>
</g>
<!-- expert_6_10_1&#45;&gt;tp_6_10 -->
<g id="edge580" class="edge">
<title>expert_6_10_1&#45;&gt;tp_6_10</title>
<path fill="none" stroke="black" d="M6284.16,-6711.18C6281.42,-6710.9 6278.69,-6710.62 6276,-6710.37 5954.42,-6679.49 5869.77,-6720.4 5550,-6674.37 5538.52,-6672.71 5526.55,-6670.49 5514.77,-6668"/>
<polygon fill="black" stroke="black" points="5515.44,-6664.56 5504.93,-6665.85 5513.95,-6671.4 5515.44,-6664.56"/>
</g>
<!-- tp_6_10&#45;&gt;q_proj_7 -->
<g id="edge1698" class="edge">
<title>tp_6_10&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M5343.63,-6621.01C5329.16,-6617.71 5314.19,-6614.58 5300,-6612.14 5152.19,-6586.69 5110.96,-6593.97 4958.52,-6576.29"/>
<polygon fill="black" stroke="black" points="4958.66,-6572.79 4948.32,-6575.09 4957.84,-6579.74 4958.66,-6572.79"/>
</g>
<!-- tp_6_10&#45;&gt;k_proj_7 -->
<g id="edge1699" class="edge">
<title>tp_6_10&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M5346.52,-6620.27C5301.5,-6607.66 5244.95,-6591.82 5198.9,-6578.92"/>
<polygon fill="black" stroke="black" points="5199.81,-6575.54 5189.23,-6576.21 5197.92,-6582.28 5199.81,-6575.54"/>
</g>
<!-- tp_6_10&#45;&gt;v_proj_7 -->
<g id="edge1700" class="edge">
<title>tp_6_10&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M5344.73,-6620.64C5329.95,-6617.31 5314.58,-6614.28 5300,-6612.14 5013.9,-6570.2 4935.9,-6602.8 4644.32,-6576.22"/>
<polygon fill="black" stroke="black" points="4644.58,-6572.73 4634.3,-6575.29 4643.93,-6579.7 4644.58,-6572.73"/>
</g>
<!-- expert_6_11_0 -->
<g id="node480" class="node">
<title>expert_6_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6856.5,-6754.37 6579.5,-6754.37 6579.5,-6710.37 6856.5,-6710.37 6856.5,-6754.37"/>
<text text-anchor="middle" x="6718" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L6</text>
<text text-anchor="middle" x="6718" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 230</text>
<text text-anchor="middle" x="6718" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_11&#45;&gt;expert_6_11_0 -->
<g id="edge582" class="edge">
<title>route_6_11&#45;&gt;expert_6_11_0</title>
<path fill="none" stroke="black" d="M6718,-6790.01C6718,-6781.73 6718,-6772.76 6718,-6764.44"/>
<polygon fill="black" stroke="black" points="6721.5,-6764.37 6718,-6754.37 6714.5,-6764.37 6721.5,-6764.37"/>
</g>
<!-- expert_6_11_1 -->
<g id="node481" class="node">
<title>expert_6_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7151.5,-6754.37 6874.5,-6754.37 6874.5,-6710.37 7151.5,-6710.37 7151.5,-6754.37"/>
<text text-anchor="middle" x="7013" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L6</text>
<text text-anchor="middle" x="7013" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 231</text>
<text text-anchor="middle" x="7013" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7013" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_11&#45;&gt;expert_6_11_1 -->
<g id="edge583" class="edge">
<title>route_6_11&#45;&gt;expert_6_11_1</title>
<path fill="none" stroke="black" d="M6808.92,-6793.63C6848.08,-6782.07 6893.51,-6768.65 6931.56,-6757.42"/>
<polygon fill="black" stroke="black" points="6932.97,-6760.65 6941.57,-6754.46 6930.99,-6753.93 6932.97,-6760.65"/>
</g>
<!-- tp_6_11 -->
<g id="node482" class="node">
<title>tp_6_11</title>
<ellipse fill="lightblue" stroke="black" cx="5675" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5675" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L6</text>
<text text-anchor="middle" x="5675" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 230↔231</text>
<text text-anchor="middle" x="5675" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5675" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_11_0&#45;&gt;tp_6_11 -->
<g id="edge584" class="edge">
<title>expert_6_11_0&#45;&gt;tp_6_11</title>
<path fill="none" stroke="black" d="M6579.16,-6711.17C6576.42,-6710.89 6573.69,-6710.62 6571,-6710.37 6229.48,-6678.07 6139.61,-6722.75 5800,-6674.37 5788.52,-6672.73 5776.55,-6670.52 5764.76,-6668.03"/>
<polygon fill="black" stroke="black" points="5765.44,-6664.6 5754.92,-6665.88 5763.94,-6671.43 5765.44,-6664.6"/>
</g>
<!-- expert_6_11_1&#45;&gt;tp_6_11 -->
<g id="edge585" class="edge">
<title>expert_6_11_1&#45;&gt;tp_6_11</title>
<path fill="none" stroke="black" d="M6874.16,-6711.12C6871.42,-6710.86 6868.7,-6710.6 6866,-6710.37 6393.78,-6668.78 6269.73,-6738.2 5800,-6674.37 5788.42,-6672.79 5776.35,-6670.6 5764.48,-6668.12"/>
<polygon fill="black" stroke="black" points="5765.08,-6664.67 5754.56,-6665.96 5763.59,-6671.51 5765.08,-6664.67"/>
</g>
<!-- tp_6_11&#45;&gt;q_proj_7 -->
<g id="edge1701" class="edge">
<title>tp_6_11&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M5594.72,-6620.72C5579.94,-6617.38 5564.57,-6614.32 5550,-6612.14 5292.18,-6573.57 5221.59,-6600.94 4958.54,-6576.25"/>
<polygon fill="black" stroke="black" points="4958.59,-6572.73 4948.3,-6575.27 4957.92,-6579.7 4958.59,-6572.73"/>
</g>
<!-- tp_6_11&#45;&gt;k_proj_7 -->
<g id="edge1702" class="edge">
<title>tp_6_11&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M5592.9,-6621.16C5578.65,-6617.88 5563.94,-6614.72 5550,-6612.14 5458.49,-6595.19 5355.25,-6581.45 5272.21,-6571.72"/>
<polygon fill="black" stroke="black" points="5272.53,-6568.23 5262.19,-6570.55 5271.72,-6575.18 5272.53,-6568.23"/>
</g>
<!-- tp_6_11&#45;&gt;v_proj_7 -->
<g id="edge1703" class="edge">
<title>tp_6_11&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M5595.43,-6620.61C5580.44,-6617.24 5564.81,-6614.2 5550,-6612.14 5153.73,-6557.09 5046.7,-6610.03 4644.46,-6576.22"/>
<polygon fill="black" stroke="black" points="4644.55,-6572.71 4634.29,-6575.35 4643.96,-6579.69 4644.55,-6572.71"/>
</g>
<!-- expert_6_12_0 -->
<g id="node484" class="node">
<title>expert_6_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7446.5,-6754.37 7169.5,-6754.37 7169.5,-6710.37 7446.5,-6710.37 7446.5,-6754.37"/>
<text text-anchor="middle" x="7308" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L6</text>
<text text-anchor="middle" x="7308" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 232</text>
<text text-anchor="middle" x="7308" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_12&#45;&gt;expert_6_12_0 -->
<g id="edge587" class="edge">
<title>route_6_12&#45;&gt;expert_6_12_0</title>
<path fill="none" stroke="black" d="M7308,-6790.01C7308,-6781.73 7308,-6772.76 7308,-6764.44"/>
<polygon fill="black" stroke="black" points="7311.5,-6764.37 7308,-6754.37 7304.5,-6764.37 7311.5,-6764.37"/>
</g>
<!-- expert_6_12_1 -->
<g id="node485" class="node">
<title>expert_6_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7741.5,-6754.37 7464.5,-6754.37 7464.5,-6710.37 7741.5,-6710.37 7741.5,-6754.37"/>
<text text-anchor="middle" x="7603" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L6</text>
<text text-anchor="middle" x="7603" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 233</text>
<text text-anchor="middle" x="7603" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7603" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_12&#45;&gt;expert_6_12_1 -->
<g id="edge588" class="edge">
<title>route_6_12&#45;&gt;expert_6_12_1</title>
<path fill="none" stroke="black" d="M7398.92,-6793.63C7438.08,-6782.07 7483.51,-6768.65 7521.56,-6757.42"/>
<polygon fill="black" stroke="black" points="7522.97,-6760.65 7531.57,-6754.46 7520.99,-6753.93 7522.97,-6760.65"/>
</g>
<!-- tp_6_12 -->
<g id="node486" class="node">
<title>tp_6_12</title>
<ellipse fill="lightblue" stroke="black" cx="5925" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5925" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L6</text>
<text text-anchor="middle" x="5925" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 232↔233</text>
<text text-anchor="middle" x="5925" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5925" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_12_0&#45;&gt;tp_6_12 -->
<g id="edge589" class="edge">
<title>expert_6_12_0&#45;&gt;tp_6_12</title>
<path fill="none" stroke="black" d="M7169.16,-6711.12C7166.42,-6710.85 7163.7,-6710.6 7161,-6710.37 6668.84,-6667.37 6539.58,-6740.56 6050,-6674.37 6038.42,-6672.8 6026.35,-6670.62 6014.48,-6668.13"/>
<polygon fill="black" stroke="black" points="6015.08,-6664.68 6004.56,-6665.98 6013.59,-6671.52 6015.08,-6664.68"/>
</g>
<!-- expert_6_12_1&#45;&gt;tp_6_12 -->
<g id="edge590" class="edge">
<title>expert_6_12_1&#45;&gt;tp_6_12</title>
<path fill="none" stroke="black" d="M7464.16,-6711.09C7461.42,-6710.84 7458.7,-6710.59 7456,-6710.37 6833.1,-6658.08 6669.74,-6756.02 6050,-6674.37 6038.33,-6672.83 6026.16,-6670.65 6014.2,-6668.15"/>
<polygon fill="black" stroke="black" points="6014.73,-6664.68 6004.21,-6665.99 6013.25,-6671.53 6014.73,-6664.68"/>
</g>
<!-- tp_6_12&#45;&gt;q_proj_7 -->
<g id="edge1704" class="edge">
<title>tp_6_12&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M5845.09,-6620.57C5830.2,-6617.23 5814.7,-6614.21 5800,-6612.14 5431.9,-6560.44 5332.31,-6608.18 4958.31,-6576.21"/>
<polygon fill="black" stroke="black" points="4958.56,-6572.72 4948.29,-6575.34 4957.95,-6579.69 4958.56,-6572.72"/>
</g>
<!-- tp_6_12&#45;&gt;k_proj_7 -->
<g id="edge1705" class="edge">
<title>tp_6_12&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M5844.01,-6620.83C5829.43,-6617.52 5814.32,-6614.45 5800,-6612.14 5620.58,-6583.25 5412.25,-6568.57 5272.68,-6561.41"/>
<polygon fill="black" stroke="black" points="5272.49,-6557.9 5262.33,-6560.89 5272.14,-6564.89 5272.49,-6557.9"/>
</g>
<!-- tp_6_12&#45;&gt;v_proj_7 -->
<g id="edge1706" class="edge">
<title>tp_6_12&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M5845.44,-6620.51C5830.45,-6617.15 5814.82,-6614.13 5800,-6612.14 5293.48,-6543.99 5157.53,-6617.32 4644.55,-6576.22"/>
<polygon fill="black" stroke="black" points="4644.54,-6572.71 4634.29,-6575.38 4643.97,-6579.68 4644.54,-6572.71"/>
</g>
<!-- expert_6_13_0 -->
<g id="node488" class="node">
<title>expert_6_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8036.5,-6754.37 7759.5,-6754.37 7759.5,-6710.37 8036.5,-6710.37 8036.5,-6754.37"/>
<text text-anchor="middle" x="7898" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L6</text>
<text text-anchor="middle" x="7898" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 234</text>
<text text-anchor="middle" x="7898" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_13&#45;&gt;expert_6_13_0 -->
<g id="edge592" class="edge">
<title>route_6_13&#45;&gt;expert_6_13_0</title>
<path fill="none" stroke="black" d="M7898,-6790.01C7898,-6781.73 7898,-6772.76 7898,-6764.44"/>
<polygon fill="black" stroke="black" points="7901.5,-6764.37 7898,-6754.37 7894.5,-6764.37 7901.5,-6764.37"/>
</g>
<!-- expert_6_13_1 -->
<g id="node489" class="node">
<title>expert_6_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8331.5,-6754.37 8054.5,-6754.37 8054.5,-6710.37 8331.5,-6710.37 8331.5,-6754.37"/>
<text text-anchor="middle" x="8193" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L6</text>
<text text-anchor="middle" x="8193" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 235</text>
<text text-anchor="middle" x="8193" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8193" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_13&#45;&gt;expert_6_13_1 -->
<g id="edge593" class="edge">
<title>route_6_13&#45;&gt;expert_6_13_1</title>
<path fill="none" stroke="black" d="M7988.92,-6793.63C8028.08,-6782.07 8073.51,-6768.65 8111.56,-6757.42"/>
<polygon fill="black" stroke="black" points="8112.97,-6760.65 8121.57,-6754.46 8110.99,-6753.93 8112.97,-6760.65"/>
</g>
<!-- tp_6_13 -->
<g id="node490" class="node">
<title>tp_6_13</title>
<ellipse fill="lightblue" stroke="black" cx="6175" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6175" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L6</text>
<text text-anchor="middle" x="6175" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 234↔235</text>
<text text-anchor="middle" x="6175" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6175" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_13_0&#45;&gt;tp_6_13 -->
<g id="edge594" class="edge">
<title>expert_6_13_0&#45;&gt;tp_6_13</title>
<path fill="none" stroke="black" d="M7759.16,-6711.09C7756.42,-6710.83 7753.7,-6710.59 7751,-6710.37 7108.15,-6656.66 6939.59,-6758.38 6300,-6674.37 6288.33,-6672.83 6276.16,-6670.65 6264.2,-6668.16"/>
<polygon fill="black" stroke="black" points="6264.73,-6664.69 6254.21,-6666 6263.25,-6671.53 6264.73,-6664.69"/>
</g>
<!-- expert_6_13_1&#45;&gt;tp_6_13 -->
<g id="edge595" class="edge">
<title>expert_6_13_1&#45;&gt;tp_6_13</title>
<path fill="none" stroke="black" d="M8054.17,-6711.08C8051.42,-6710.82 8048.7,-6710.59 8046,-6710.37 7659.2,-6678.87 6684.88,-6724.1 6300,-6674.37 6288.33,-6672.86 6276.16,-6670.69 6264.19,-6668.21"/>
<polygon fill="black" stroke="black" points="6264.72,-6664.74 6254.21,-6666.05 6263.24,-6671.58 6264.72,-6664.74"/>
</g>
<!-- tp_6_13&#45;&gt;q_proj_7 -->
<g id="edge1707" class="edge">
<title>tp_6_13&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M6095.44,-6620.53C6080.45,-6617.17 6064.82,-6614.15 6050,-6612.14 5571.65,-6547.33 5443.12,-6615.47 4958.35,-6576.2"/>
<polygon fill="black" stroke="black" points="4958.54,-6572.71 4948.29,-6575.38 4957.97,-6579.68 4958.54,-6572.71"/>
</g>
<!-- tp_6_13&#45;&gt;k_proj_7 -->
<g id="edge1708" class="edge">
<title>tp_6_13&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M6094.72,-6620.72C6079.94,-6617.38 6064.57,-6614.32 6050,-6612.14 5778.86,-6571.55 5459.41,-6559.69 5272.54,-6556.34"/>
<polygon fill="black" stroke="black" points="5272.42,-6552.83 5262.36,-6556.16 5272.3,-6559.83 5272.42,-6552.83"/>
</g>
<!-- tp_6_13&#45;&gt;v_proj_7 -->
<g id="edge1709" class="edge">
<title>tp_6_13&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M6095.79,-6620.52C6080.69,-6617.13 6064.94,-6614.11 6050,-6612.14 5433.15,-6530.87 5268.34,-6624.66 4644.44,-6576.2"/>
<polygon fill="black" stroke="black" points="4644.53,-6572.7 4634.29,-6575.41 4643.98,-6579.68 4644.53,-6572.7"/>
</g>
<!-- expert_6_14_0 -->
<g id="node492" class="node">
<title>expert_6_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8626.5,-6754.37 8349.5,-6754.37 8349.5,-6710.37 8626.5,-6710.37 8626.5,-6754.37"/>
<text text-anchor="middle" x="8488" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L6</text>
<text text-anchor="middle" x="8488" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 236</text>
<text text-anchor="middle" x="8488" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_14&#45;&gt;expert_6_14_0 -->
<g id="edge597" class="edge">
<title>route_6_14&#45;&gt;expert_6_14_0</title>
<path fill="none" stroke="black" d="M8488,-6790.01C8488,-6781.73 8488,-6772.76 8488,-6764.44"/>
<polygon fill="black" stroke="black" points="8491.5,-6764.37 8488,-6754.37 8484.5,-6764.37 8491.5,-6764.37"/>
</g>
<!-- expert_6_14_1 -->
<g id="node493" class="node">
<title>expert_6_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8921.5,-6754.37 8644.5,-6754.37 8644.5,-6710.37 8921.5,-6710.37 8921.5,-6754.37"/>
<text text-anchor="middle" x="8783" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L6</text>
<text text-anchor="middle" x="8783" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 237</text>
<text text-anchor="middle" x="8783" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8783" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_14&#45;&gt;expert_6_14_1 -->
<g id="edge598" class="edge">
<title>route_6_14&#45;&gt;expert_6_14_1</title>
<path fill="none" stroke="black" d="M8578.92,-6793.63C8618.08,-6782.07 8663.51,-6768.65 8701.56,-6757.42"/>
<polygon fill="black" stroke="black" points="8702.97,-6760.65 8711.57,-6754.46 8700.99,-6753.93 8702.97,-6760.65"/>
</g>
<!-- tp_6_14 -->
<g id="node494" class="node">
<title>tp_6_14</title>
<ellipse fill="lightblue" stroke="black" cx="6425" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6425" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L6</text>
<text text-anchor="middle" x="6425" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 236↔237</text>
<text text-anchor="middle" x="6425" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6425" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_14_0&#45;&gt;tp_6_14 -->
<g id="edge599" class="edge">
<title>expert_6_14_0&#45;&gt;tp_6_14</title>
<path fill="none" stroke="black" d="M8349.17,-6711.07C8346.42,-6710.82 8343.7,-6710.58 8341,-6710.37 7944.22,-6678.16 6944.81,-6725.28 6550,-6674.37 6538.33,-6672.86 6526.16,-6670.7 6514.19,-6668.21"/>
<polygon fill="black" stroke="black" points="6514.72,-6664.74 6504.21,-6666.05 6513.24,-6671.59 6514.72,-6664.74"/>
</g>
<!-- expert_6_14_1&#45;&gt;tp_6_14 -->
<g id="edge600" class="edge">
<title>expert_6_14_1&#45;&gt;tp_6_14</title>
<path fill="none" stroke="black" d="M8644.17,-6711.06C8641.42,-6710.81 8638.7,-6710.58 8636,-6710.37 8173.84,-6673.51 7009.9,-6733.01 6550,-6674.37 6538.32,-6672.88 6526.15,-6670.72 6514.19,-6668.24"/>
<polygon fill="black" stroke="black" points="6514.71,-6664.78 6504.2,-6666.09 6513.24,-6671.62 6514.71,-6664.78"/>
</g>
<!-- tp_6_14&#45;&gt;q_proj_7 -->
<g id="edge1710" class="edge">
<title>tp_6_14&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M6345.45,-6620.46C6330.45,-6617.1 6314.83,-6614.1 6300,-6612.14 5711.38,-6534.23 5553.96,-6622.78 4958.42,-6576.2"/>
<polygon fill="black" stroke="black" points="4958.53,-6572.7 4948.29,-6575.4 4957.98,-6579.68 4958.53,-6572.7"/>
</g>
<!-- tp_6_14&#45;&gt;k_proj_7 -->
<g id="edge1711" class="edge">
<title>tp_6_14&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M6345.08,-6620.64C6330.19,-6617.29 6314.69,-6614.24 6300,-6612.14 6106.37,-6584.42 5548.04,-6566.47 5272.15,-6559.04"/>
<polygon fill="black" stroke="black" points="5272.14,-6555.54 5262.05,-6558.77 5271.95,-6562.54 5272.14,-6555.54"/>
</g>
<!-- tp_6_14&#45;&gt;v_proj_7 -->
<g id="edge1712" class="edge">
<title>tp_6_14&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M6345.79,-6620.47C6330.7,-6617.09 6314.94,-6614.08 6300,-6612.14 5937.96,-6565.15 5026.42,-6603.91 4644.33,-6576.18"/>
<polygon fill="black" stroke="black" points="4644.52,-6572.68 4634.29,-6575.42 4644,-6579.66 4644.52,-6572.68"/>
</g>
<!-- expert_6_15_0 -->
<g id="node496" class="node">
<title>expert_6_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9216.5,-6754.37 8939.5,-6754.37 8939.5,-6710.37 9216.5,-6710.37 9216.5,-6754.37"/>
<text text-anchor="middle" x="9078" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L6</text>
<text text-anchor="middle" x="9078" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 238</text>
<text text-anchor="middle" x="9078" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_15&#45;&gt;expert_6_15_0 -->
<g id="edge602" class="edge">
<title>route_6_15&#45;&gt;expert_6_15_0</title>
<path fill="none" stroke="black" d="M9078,-6790.01C9078,-6781.73 9078,-6772.76 9078,-6764.44"/>
<polygon fill="black" stroke="black" points="9081.5,-6764.37 9078,-6754.37 9074.5,-6764.37 9081.5,-6764.37"/>
</g>
<!-- expert_6_15_1 -->
<g id="node497" class="node">
<title>expert_6_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9511.5,-6754.37 9234.5,-6754.37 9234.5,-6710.37 9511.5,-6710.37 9511.5,-6754.37"/>
<text text-anchor="middle" x="9373" y="-6745.17" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L6</text>
<text text-anchor="middle" x="9373" y="-6735.17" font-family="Times,serif" font-size="9.00">GPU: 239</text>
<text text-anchor="middle" x="9373" y="-6725.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9373" y="-6715.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_15&#45;&gt;expert_6_15_1 -->
<g id="edge603" class="edge">
<title>route_6_15&#45;&gt;expert_6_15_1</title>
<path fill="none" stroke="black" d="M9168.92,-6793.63C9208.08,-6782.07 9253.51,-6768.65 9291.56,-6757.42"/>
<polygon fill="black" stroke="black" points="9292.97,-6760.65 9301.57,-6754.46 9290.99,-6753.93 9292.97,-6760.65"/>
</g>
<!-- tp_6_15 -->
<g id="node498" class="node">
<title>tp_6_15</title>
<ellipse fill="lightblue" stroke="black" cx="6675" cy="-6643.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6675" y="-6656.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L6</text>
<text text-anchor="middle" x="6675" y="-6646.05" font-family="Times,serif" font-size="9.00">GPU: 238↔239</text>
<text text-anchor="middle" x="6675" y="-6636.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6675" y="-6626.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_15_0&#45;&gt;tp_6_15 -->
<g id="edge604" class="edge">
<title>expert_6_15_0&#45;&gt;tp_6_15</title>
<path fill="none" stroke="black" d="M8939.16,-6711.11C8936.42,-6710.84 8933.7,-6710.6 8931,-6710.37 8512.38,-6674.45 7211.95,-6652.31 6800.89,-6646.07"/>
<polygon fill="black" stroke="black" points="6800.8,-6642.57 6790.75,-6645.92 6800.7,-6649.57 6800.8,-6642.57"/>
</g>
<!-- expert_6_15_1&#45;&gt;tp_6_15 -->
<g id="edge605" class="edge">
<title>expert_6_15_1&#45;&gt;tp_6_15</title>
<path fill="none" stroke="black" d="M9234.16,-6711.09C9231.42,-6710.84 9228.7,-6710.59 9226,-6710.37 8746.93,-6670.08 7246.66,-6650.58 6801.03,-6645.58"/>
<polygon fill="black" stroke="black" points="6801.05,-6642.08 6791.02,-6645.47 6800.98,-6649.08 6801.05,-6642.08"/>
</g>
<!-- tp_6_15&#45;&gt;q_proj_7 -->
<g id="edge1713" class="edge">
<title>tp_6_15&#45;&gt;q_proj_7</title>
<path fill="none" stroke="black" d="M6595.79,-6620.48C6580.69,-6617.1 6564.94,-6614.09 6550,-6612.14 6202.13,-6566.84 5326.47,-6602.97 4958.49,-6576.19"/>
<polygon fill="black" stroke="black" points="4958.52,-6572.68 4948.29,-6575.42 4958,-6579.66 4958.52,-6572.68"/>
</g>
<!-- tp_6_15&#45;&gt;k_proj_7 -->
<g id="edge1714" class="edge">
<title>tp_6_15&#45;&gt;k_proj_7</title>
<path fill="none" stroke="black" d="M6595.43,-6620.61C6580.44,-6617.24 6564.81,-6614.2 6550,-6612.14 6307.51,-6578.45 5592.94,-6562.92 5272.56,-6557.5"/>
<polygon fill="black" stroke="black" points="5272.32,-6554 5262.27,-6557.33 5272.21,-6561 5272.32,-6554"/>
</g>
<!-- tp_6_15&#45;&gt;v_proj_7 -->
<g id="edge1715" class="edge">
<title>tp_6_15&#45;&gt;v_proj_7</title>
<path fill="none" stroke="black" d="M6595.8,-6620.44C6580.7,-6617.06 6564.94,-6614.06 6550,-6612.14 6132.88,-6558.61 5082.22,-6607.51 4644.51,-6576.19"/>
<polygon fill="black" stroke="black" points="4644.52,-6572.68 4634.29,-6575.43 4644,-6579.66 4644.52,-6572.68"/>
</g>
<!-- attn_scores_7 -->
<g id="node502" class="node">
<title>attn_scores_7</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-6496.14 4633.5,-6496.14 4633.5,-6452.14 4966.5,-6452.14 4966.5,-6496.14"/>
<text text-anchor="middle" x="4800" y="-6486.94" font-family="Times,serif" font-size="9.00">Attention Scores L7</text>
<text text-anchor="middle" x="4800" y="-6476.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4800" y="-6466.94" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-6456.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_7&#45;&gt;attn_scores_7 -->
<g id="edge606" class="edge">
<title>q_proj_7&#45;&gt;attn_scores_7</title>
<path fill="none" stroke="black" d="M4800,-6531.83C4800,-6523.94 4800,-6514.82 4800,-6506.24"/>
<polygon fill="black" stroke="black" points="4803.5,-6506.16 4800,-6496.16 4796.5,-6506.16 4803.5,-6506.16"/>
</g>
<!-- k_proj_7&#45;&gt;attn_scores_7 -->
<g id="edge607" class="edge">
<title>k_proj_7&#45;&gt;attn_scores_7</title>
<path fill="none" stroke="black" d="M5029.44,-6532.14C4987.82,-6521.8 4937.49,-6509.29 4894.59,-6498.64"/>
<polygon fill="black" stroke="black" points="4895.26,-6495.2 4884.71,-6496.18 4893.57,-6501.99 4895.26,-6495.2"/>
</g>
<!-- v_proj_7&#45;&gt;attn_scores_7 -->
<g id="edge608" class="edge">
<title>v_proj_7&#45;&gt;attn_scores_7</title>
<path fill="none" stroke="black" d="M4570.56,-6532.14C4612.18,-6521.8 4662.51,-6509.29 4705.41,-6498.64"/>
<polygon fill="black" stroke="black" points="4706.43,-6501.99 4715.29,-6496.18 4704.74,-6495.2 4706.43,-6501.99"/>
</g>
<!-- softmax_7 -->
<g id="node503" class="node">
<title>softmax_7</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-6416.14 4633.5,-6416.14 4633.5,-6372.14 4966.5,-6372.14 4966.5,-6416.14"/>
<text text-anchor="middle" x="4800" y="-6406.94" font-family="Times,serif" font-size="9.00">Softmax L7</text>
<text text-anchor="middle" x="4800" y="-6396.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4800" y="-6386.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4800" y="-6376.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_7&#45;&gt;softmax_7 -->
<g id="edge609" class="edge">
<title>attn_scores_7&#45;&gt;softmax_7</title>
<path fill="none" stroke="black" d="M4800,-6451.83C4800,-6443.94 4800,-6434.82 4800,-6426.24"/>
<polygon fill="black" stroke="black" points="4803.5,-6426.16 4800,-6416.16 4796.5,-6426.16 4803.5,-6426.16"/>
</g>
<!-- attn_out_7 -->
<g id="node504" class="node">
<title>attn_out_7</title>
<polygon fill="lightgreen" stroke="black" points="4948,-6336.14 4652,-6336.14 4652,-6292.14 4948,-6292.14 4948,-6336.14"/>
<text text-anchor="middle" x="4800" y="-6326.94" font-family="Times,serif" font-size="9.00">Attention Output L7</text>
<text text-anchor="middle" x="4800" y="-6316.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="4800" y="-6306.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-6296.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_7&#45;&gt;attn_out_7 -->
<g id="edge610" class="edge">
<title>softmax_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M4800,-6371.83C4800,-6363.94 4800,-6354.82 4800,-6346.24"/>
<polygon fill="black" stroke="black" points="4803.5,-6346.16 4800,-6336.16 4796.5,-6346.16 4803.5,-6346.16"/>
</g>
<!-- gate_7 -->
<g id="node505" class="node">
<title>gate_7</title>
<polygon fill="lightyellow" stroke="black" points="5099.74,-6256.14 4622.92,-6256.14 4500.26,-6168.14 4977.08,-6168.14 5099.74,-6256.14"/>
<text text-anchor="middle" x="4800" y="-6224.94" font-family="Times,serif" font-size="9.00">Gate L7</text>
<text text-anchor="middle" x="4800" y="-6214.94" font-family="Times,serif" font-size="9.00">GPU: 192&#45;255</text>
<text text-anchor="middle" x="4800" y="-6204.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-6194.94" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_7&#45;&gt;gate_7 -->
<g id="edge611" class="edge">
<title>attn_out_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M4800,-6291.93C4800,-6284.43 4800,-6275.63 4800,-6266.67"/>
<polygon fill="black" stroke="black" points="4803.5,-6266.55 4800,-6256.55 4796.5,-6266.55 4803.5,-6266.55"/>
</g>
<!-- route_7_0 -->
<g id="node506" class="node">
<title>route_7_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="523" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="523" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="523" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="523" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_0 -->
<g id="edge612" class="edge">
<title>gate_7&#45;&gt;route_7_0</title>
<path fill="none" stroke="black" d="M4560.09,-6211.18C3949.43,-6210.22 2286.63,-6200.93 903,-6132.14 837.75,-6128.9 766.32,-6123.68 703.17,-6118.49"/>
<polygon fill="black" stroke="black" points="703.36,-6114.99 693.11,-6117.65 702.79,-6121.97 703.36,-6114.99"/>
</g>
<!-- route_7_1 -->
<g id="node510" class="node">
<title>route_7_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1113" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1113" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1113" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 194,195</text>
<text text-anchor="middle" x="1113" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_1 -->
<g id="edge617" class="edge">
<title>gate_7&#45;&gt;route_7_1</title>
<path fill="none" stroke="black" d="M4558.4,-6209.93C4011.99,-6206.2 2639.53,-6191.22 1493,-6132.14 1427.91,-6128.79 1356.67,-6123.56 1293.63,-6118.39"/>
<polygon fill="black" stroke="black" points="1293.84,-6114.9 1283.59,-6117.56 1293.27,-6121.87 1293.84,-6114.9"/>
</g>
<!-- route_7_2 -->
<g id="node514" class="node">
<title>route_7_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1703" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1703" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1703" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 196,197</text>
<text text-anchor="middle" x="1703" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_2 -->
<g id="edge622" class="edge">
<title>gate_7&#45;&gt;route_7_2</title>
<path fill="none" stroke="black" d="M4555.82,-6208.13C4079.8,-6201.36 2994.5,-6181.48 2083,-6132.14 2018.08,-6128.63 1947.02,-6123.37 1884.1,-6118.24"/>
<polygon fill="black" stroke="black" points="1884.32,-6114.74 1874.07,-6117.41 1883.75,-6121.72 1884.32,-6114.74"/>
</g>
<!-- route_7_3 -->
<g id="node518" class="node">
<title>route_7_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2293" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2293" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2293" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 198,199</text>
<text text-anchor="middle" x="2293" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_3 -->
<g id="edge627" class="edge">
<title>gate_7&#45;&gt;route_7_3</title>
<path fill="none" stroke="black" d="M4551.78,-6205.3C4154.71,-6195.19 3352.24,-6171.65 2673,-6132.14 2608.41,-6128.38 2537.73,-6123.1 2475.03,-6118.01"/>
<polygon fill="black" stroke="black" points="2475.29,-6114.52 2465.04,-6117.2 2474.72,-6121.5 2475.29,-6114.52"/>
</g>
<!-- route_7_4 -->
<g id="node522" class="node">
<title>route_7_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2883" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2883" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2883" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 200,201</text>
<text text-anchor="middle" x="2883" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_4 -->
<g id="edge632" class="edge">
<title>gate_7&#45;&gt;route_7_4</title>
<path fill="none" stroke="black" d="M4544.91,-6200.2C4239.88,-6186.61 3713.93,-6161.59 3263,-6132.14 3199.04,-6127.96 3129.08,-6122.64 3066.82,-6117.63"/>
<polygon fill="black" stroke="black" points="3066.74,-6114.11 3056.49,-6116.79 3066.18,-6121.09 3066.74,-6114.11"/>
</g>
<!-- route_7_5 -->
<g id="node526" class="node">
<title>route_7_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3473" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3473" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3473" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 202,203</text>
<text text-anchor="middle" x="3473" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_5 -->
<g id="edge637" class="edge">
<title>gate_7&#45;&gt;route_7_5</title>
<path fill="none" stroke="black" d="M4529.06,-6188.86C4269.32,-6167.5 3884.23,-6135.84 3657.92,-6117.23"/>
<polygon fill="black" stroke="black" points="3658.18,-6113.74 3647.93,-6116.41 3657.61,-6120.72 3658.18,-6113.74"/>
</g>
<!-- route_7_6 -->
<g id="node530" class="node">
<title>route_7_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4063" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4063" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4063" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 204,205</text>
<text text-anchor="middle" x="4063" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_6 -->
<g id="edge642" class="edge">
<title>gate_7&#45;&gt;route_7_6</title>
<path fill="none" stroke="black" d="M4509.51,-6168.13C4408.8,-6153.22 4299.94,-6137.11 4214.92,-6124.52"/>
<polygon fill="black" stroke="black" points="4215.34,-6121.04 4204.93,-6123.04 4214.31,-6127.97 4215.34,-6121.04"/>
</g>
<!-- route_7_7 -->
<g id="node534" class="node">
<title>route_7_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4591" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4591" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4591" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 206,207</text>
<text text-anchor="middle" x="4591" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4591" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_7 -->
<g id="edge647" class="edge">
<title>gate_7&#45;&gt;route_7_7</title>
<path fill="none" stroke="black" d="M4717.4,-6168.02C4696.91,-6157.32 4675.25,-6146.01 4655.75,-6135.83"/>
<polygon fill="black" stroke="black" points="4657.15,-6132.61 4646.67,-6131.09 4653.91,-6138.82 4657.15,-6132.61"/>
</g>
<!-- route_7_8 -->
<g id="node538" class="node">
<title>route_7_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5011" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5011" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5011" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="5011" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5011" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_8 -->
<g id="edge652" class="edge">
<title>gate_7&#45;&gt;route_7_8</title>
<path fill="none" stroke="black" d="M4883.39,-6168.02C4904.27,-6157.22 4926.36,-6145.8 4946.18,-6135.55"/>
<polygon fill="black" stroke="black" points="4947.84,-6138.63 4955.12,-6130.93 4944.63,-6132.41 4947.84,-6138.63"/>
</g>
<!-- route_7_9 -->
<g id="node542" class="node">
<title>route_7_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5538" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5538" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5538" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 226,227</text>
<text text-anchor="middle" x="5538" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_9 -->
<g id="edge657" class="edge">
<title>gate_7&#45;&gt;route_7_9</title>
<path fill="none" stroke="black" d="M4996.8,-6182.04C5118.76,-6164.01 5273.08,-6141.2 5385.69,-6124.55"/>
<polygon fill="black" stroke="black" points="5386.39,-6127.98 5395.77,-6123.06 5385.37,-6121.06 5386.39,-6127.98"/>
</g>
<!-- route_7_10 -->
<g id="node546" class="node">
<title>route_7_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6128" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6128" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6128" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 228,229</text>
<text text-anchor="middle" x="6128" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_10 -->
<g id="edge662" class="edge">
<title>gate_7&#45;&gt;route_7_10</title>
<path fill="none" stroke="black" d="M5013,-6193.64C5270.37,-6172.49 5699.14,-6137.26 5943.18,-6117.21"/>
<polygon fill="black" stroke="black" points="5943.54,-6120.7 5953.22,-6116.39 5942.96,-6113.72 5943.54,-6120.7"/>
</g>
<!-- route_7_11 -->
<g id="node550" class="node">
<title>route_7_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6718" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6718" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6718" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 230,231</text>
<text text-anchor="middle" x="6718" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_11 -->
<g id="edge667" class="edge">
<title>gate_7&#45;&gt;route_7_11</title>
<path fill="none" stroke="black" d="M5023.94,-6201.59C5323.44,-6188.37 5870.94,-6162.64 6338,-6132.14 6401.96,-6127.96 6471.92,-6122.64 6534.18,-6117.63"/>
<polygon fill="black" stroke="black" points="6534.82,-6121.09 6544.51,-6116.8 6534.26,-6114.11 6534.82,-6121.09"/>
</g>
<!-- route_7_12 -->
<g id="node554" class="node">
<title>route_7_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7308" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7308" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7308" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 232,233</text>
<text text-anchor="middle" x="7308" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_12 -->
<g id="edge672" class="edge">
<title>gate_7&#45;&gt;route_7_12</title>
<path fill="none" stroke="black" d="M5029.64,-6205.77C5419.94,-6195.95 6237.6,-6172.29 6928,-6132.14 6992.59,-6128.38 7063.27,-6123.1 7125.97,-6118.01"/>
<polygon fill="black" stroke="black" points="7126.28,-6121.5 7135.96,-6117.2 7125.71,-6114.52 7126.28,-6121.5"/>
</g>
<!-- route_7_13 -->
<g id="node558" class="node">
<title>route_7_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7898" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7898" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7898" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 234,235</text>
<text text-anchor="middle" x="7898" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_13 -->
<g id="edge677" class="edge">
<title>gate_7&#45;&gt;route_7_13</title>
<path fill="none" stroke="black" d="M5033.3,-6208.29C5503.62,-6201.67 6599.09,-6181.87 7518,-6132.14 7582.92,-6128.63 7653.98,-6123.38 7716.9,-6118.24"/>
<polygon fill="black" stroke="black" points="7717.25,-6121.72 7726.93,-6117.41 7716.68,-6114.74 7717.25,-6121.72"/>
</g>
<!-- route_7_14 -->
<g id="node562" class="node">
<title>route_7_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8488" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8488" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8488" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 236,237</text>
<text text-anchor="middle" x="8488" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_14 -->
<g id="edge682" class="edge">
<title>gate_7&#45;&gt;route_7_14</title>
<path fill="none" stroke="black" d="M5035.56,-6209.98C5577.95,-6206.32 6956.82,-6191.45 8108,-6132.14 8173.09,-6128.79 8244.33,-6123.56 8307.37,-6118.39"/>
<polygon fill="black" stroke="black" points="8307.73,-6121.87 8317.41,-6117.56 8307.16,-6114.9 8307.73,-6121.87"/>
</g>
<!-- route_7_15 -->
<g id="node566" class="node">
<title>route_7_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9078" cy="-6101.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9078" y="-6113.83" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9078" y="-6103.83" font-family="Times,serif" font-size="9.00">GPU: 238,239</text>
<text text-anchor="middle" x="9078" y="-6093.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-6083.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_15 -->
<g id="edge687" class="edge">
<title>gate_7&#45;&gt;route_7_15</title>
<path fill="none" stroke="black" d="M5037.19,-6211.19C5645.71,-6210.25 7311.91,-6201.05 8698,-6132.14 8763.25,-6128.9 8834.68,-6123.68 8897.83,-6118.49"/>
<polygon fill="black" stroke="black" points="8898.21,-6121.97 8907.89,-6117.65 8897.64,-6114.99 8898.21,-6121.97"/>
</g>
<!-- expert_7_0_0 -->
<g id="node507" class="node">
<title>expert_7_0_0</title>
<polygon fill="lightgreen" stroke="black" points="366.5,-6033.92 89.5,-6033.92 89.5,-5989.92 366.5,-5989.92 366.5,-6033.92"/>
<text text-anchor="middle" x="228" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L7</text>
<text text-anchor="middle" x="228" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="228" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_0&#45;&gt;expert_7_0_0 -->
<g id="edge613" class="edge">
<title>route_7_0&#45;&gt;expert_7_0_0</title>
<path fill="none" stroke="black" d="M432.08,-6073.18C392.92,-6061.62 347.49,-6048.2 309.44,-6036.96"/>
<polygon fill="black" stroke="black" points="310.01,-6033.48 299.43,-6034.01 308.03,-6040.2 310.01,-6033.48"/>
</g>
<!-- expert_7_0_1 -->
<g id="node508" class="node">
<title>expert_7_0_1</title>
<polygon fill="lightgreen" stroke="black" points="661.5,-6033.92 384.5,-6033.92 384.5,-5989.92 661.5,-5989.92 661.5,-6033.92"/>
<text text-anchor="middle" x="523" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L7</text>
<text text-anchor="middle" x="523" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="523" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="523" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_0&#45;&gt;expert_7_0_1 -->
<g id="edge614" class="edge">
<title>route_7_0&#45;&gt;expert_7_0_1</title>
<path fill="none" stroke="black" d="M523,-6069.56C523,-6061.28 523,-6052.31 523,-6043.99"/>
<polygon fill="black" stroke="black" points="526.5,-6043.92 523,-6033.92 519.5,-6043.92 526.5,-6043.92"/>
</g>
<!-- tp_7_0 -->
<g id="node509" class="node">
<title>tp_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="2925" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2925" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L7</text>
<text text-anchor="middle" x="2925" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="2925" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2925" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_0_0&#45;&gt;tp_7_0 -->
<g id="edge615" class="edge">
<title>expert_7_0_0&#45;&gt;tp_7_0</title>
<path fill="none" stroke="black" d="M366.84,-5990.64C369.58,-5990.39 372.3,-5990.14 375,-5989.92 853.88,-5949.64 2353.56,-5930.14 2799.02,-5925.13"/>
<polygon fill="black" stroke="black" points="2799.07,-5928.63 2809.03,-5925.02 2798.99,-5921.63 2799.07,-5928.63"/>
</g>
<!-- expert_7_0_1&#45;&gt;tp_7_0 -->
<g id="edge616" class="edge">
<title>expert_7_0_1&#45;&gt;tp_7_0</title>
<path fill="none" stroke="black" d="M661.6,-5990.77C664.76,-5990.47 667.9,-5990.18 671,-5989.92 1089.26,-5954.22 2388.54,-5931.93 2799.23,-5925.64"/>
<polygon fill="black" stroke="black" points="2799.41,-5929.14 2809.35,-5925.49 2799.3,-5922.14 2799.41,-5929.14"/>
</g>
<!-- q_proj_8 -->
<g id="node570" class="node">
<title>q_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="4634,-5844.69 4338,-5844.69 4338,-5800.69 4634,-5800.69 4634,-5844.69"/>
<text text-anchor="middle" x="4486" y="-5835.49" font-family="Times,serif" font-size="9.00">Q Projection L8</text>
<text text-anchor="middle" x="4486" y="-5825.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4486" y="-5815.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4486" y="-5805.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_7_0&#45;&gt;q_proj_8 -->
<g id="edge1716" class="edge">
<title>tp_7_0&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M2993.34,-5897.55C3011.53,-5892.03 3031.33,-5886.87 3050,-5883.69 3291.43,-5842.53 4006.98,-5829.21 4327.56,-5825.24"/>
<polygon fill="black" stroke="black" points="4327.9,-5828.74 4337.86,-5825.12 4327.82,-5821.74 4327.9,-5828.74"/>
</g>
<!-- k_proj_8 -->
<g id="node571" class="node">
<title>k_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="5262,-5844.69 4966,-5844.69 4966,-5800.69 5262,-5800.69 5262,-5844.69"/>
<text text-anchor="middle" x="5114" y="-5835.49" font-family="Times,serif" font-size="9.00">K Projection L8</text>
<text text-anchor="middle" x="5114" y="-5825.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="5114" y="-5815.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5114" y="-5805.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_7_0&#45;&gt;k_proj_8 -->
<g id="edge1717" class="edge">
<title>tp_7_0&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M2992.29,-5897.36C3010.75,-5891.74 3030.93,-5886.57 3050,-5883.69 3154.75,-5867.85 4852.44,-5892.78 4957,-5875.69 4990.1,-5870.28 5025.67,-5858.98 5054.58,-5848.3"/>
<polygon fill="black" stroke="black" points="5055.99,-5851.51 5064.11,-5844.7 5053.52,-5844.95 5055.99,-5851.51"/>
</g>
<!-- v_proj_8 -->
<g id="node572" class="node">
<title>v_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="4948,-5844.69 4652,-5844.69 4652,-5800.69 4948,-5800.69 4948,-5844.69"/>
<text text-anchor="middle" x="4800" y="-5835.49" font-family="Times,serif" font-size="9.00">V Projection L8</text>
<text text-anchor="middle" x="4800" y="-5825.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4800" y="-5815.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-5805.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_7_0&#45;&gt;v_proj_8 -->
<g id="edge1718" class="edge">
<title>tp_7_0&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M2992.29,-5897.37C3010.75,-5891.75 3030.93,-5886.58 3050,-5883.69 3137.5,-5870.42 4555.66,-5890 4643,-5875.69 4676.09,-5870.27 4711.67,-5858.97 4740.58,-5848.28"/>
<polygon fill="black" stroke="black" points="4741.99,-5851.49 4750.11,-5844.69 4739.52,-5844.94 4741.99,-5851.49"/>
</g>
<!-- expert_7_1_0 -->
<g id="node511" class="node">
<title>expert_7_1_0</title>
<polygon fill="lightgreen" stroke="black" points="956.5,-6033.92 679.5,-6033.92 679.5,-5989.92 956.5,-5989.92 956.5,-6033.92"/>
<text text-anchor="middle" x="818" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L7</text>
<text text-anchor="middle" x="818" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 194</text>
<text text-anchor="middle" x="818" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="818" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_1&#45;&gt;expert_7_1_0 -->
<g id="edge618" class="edge">
<title>route_7_1&#45;&gt;expert_7_1_0</title>
<path fill="none" stroke="black" d="M1022.08,-6073.18C982.92,-6061.62 937.49,-6048.2 899.44,-6036.96"/>
<polygon fill="black" stroke="black" points="900.01,-6033.48 889.43,-6034.01 898.03,-6040.2 900.01,-6033.48"/>
</g>
<!-- expert_7_1_1 -->
<g id="node512" class="node">
<title>expert_7_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1251.5,-6033.92 974.5,-6033.92 974.5,-5989.92 1251.5,-5989.92 1251.5,-6033.92"/>
<text text-anchor="middle" x="1113" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L7</text>
<text text-anchor="middle" x="1113" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 195</text>
<text text-anchor="middle" x="1113" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1113" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_1&#45;&gt;expert_7_1_1 -->
<g id="edge619" class="edge">
<title>route_7_1&#45;&gt;expert_7_1_1</title>
<path fill="none" stroke="black" d="M1113,-6069.56C1113,-6061.28 1113,-6052.31 1113,-6043.99"/>
<polygon fill="black" stroke="black" points="1116.5,-6043.92 1113,-6033.92 1109.5,-6043.92 1116.5,-6043.92"/>
</g>
<!-- tp_7_1 -->
<g id="node513" class="node">
<title>tp_7_1</title>
<ellipse fill="lightblue" stroke="black" cx="3175" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3175" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L7</text>
<text text-anchor="middle" x="3175" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 194↔195</text>
<text text-anchor="middle" x="3175" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3175" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_1_0&#45;&gt;tp_7_1 -->
<g id="edge620" class="edge">
<title>expert_7_1_0&#45;&gt;tp_7_1</title>
<path fill="none" stroke="black" d="M956.59,-5990.72C959.76,-5990.43 962.9,-5990.16 966,-5989.92 1427.73,-5953.31 2590.54,-6012.51 3050,-5953.92 3061.68,-5952.43 3073.85,-5950.27 3085.81,-5947.79"/>
<polygon fill="black" stroke="black" points="3086.76,-5951.17 3095.8,-5945.64 3085.29,-5944.32 3086.76,-5951.17"/>
</g>
<!-- expert_7_1_1&#45;&gt;tp_7_1 -->
<g id="edge621" class="edge">
<title>expert_7_1_1&#45;&gt;tp_7_1</title>
<path fill="none" stroke="black" d="M1251.6,-5990.73C1254.76,-5990.44 1257.9,-5990.17 1261,-5989.92 1657.35,-5957.93 2655.63,-6004.78 3050,-5953.92 3061.67,-5952.41 3073.84,-5950.25 3085.81,-5947.76"/>
<polygon fill="black" stroke="black" points="3086.76,-5951.14 3095.79,-5945.6 3085.28,-5944.29 3086.76,-5951.14"/>
</g>
<!-- tp_7_1&#45;&gt;q_proj_8 -->
<g id="edge1719" class="edge">
<title>tp_7_1&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M3243.36,-5897.66C3261.55,-5892.15 3281.34,-5886.96 3300,-5883.69 3492.7,-5849.97 4051.48,-5833.27 4327.67,-5826.89"/>
<polygon fill="black" stroke="black" points="4327.86,-5830.38 4337.77,-5826.66 4327.7,-5823.39 4327.86,-5830.38"/>
</g>
<!-- tp_7_1&#45;&gt;k_proj_8 -->
<g id="edge1720" class="edge">
<title>tp_7_1&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M3242.29,-5897.37C3260.75,-5891.75 3280.93,-5886.58 3300,-5883.69 3391.02,-5869.9 4866.15,-5890.57 4957,-5875.69 4990.1,-5870.27 5025.67,-5858.97 5054.58,-5848.29"/>
<polygon fill="black" stroke="black" points="5055.99,-5851.5 5064.11,-5844.7 5053.52,-5844.95 5055.99,-5851.5"/>
</g>
<!-- tp_7_1&#45;&gt;v_proj_8 -->
<g id="edge1721" class="edge">
<title>tp_7_1&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M3242.29,-5897.39C3260.75,-5891.77 3280.93,-5886.59 3300,-5883.69 3373.76,-5872.47 4569.38,-5887.79 4643,-5875.69 4675.96,-5870.27 4711.39,-5859.04 4740.24,-5848.39"/>
<polygon fill="black" stroke="black" points="4741.63,-5851.61 4749.76,-5844.82 4739.16,-5845.06 4741.63,-5851.61"/>
</g>
<!-- expert_7_2_0 -->
<g id="node515" class="node">
<title>expert_7_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1546.5,-6033.92 1269.5,-6033.92 1269.5,-5989.92 1546.5,-5989.92 1546.5,-6033.92"/>
<text text-anchor="middle" x="1408" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L7</text>
<text text-anchor="middle" x="1408" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 196</text>
<text text-anchor="middle" x="1408" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1408" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_2&#45;&gt;expert_7_2_0 -->
<g id="edge623" class="edge">
<title>route_7_2&#45;&gt;expert_7_2_0</title>
<path fill="none" stroke="black" d="M1612.08,-6073.18C1572.92,-6061.62 1527.49,-6048.2 1489.44,-6036.96"/>
<polygon fill="black" stroke="black" points="1490.01,-6033.48 1479.43,-6034.01 1488.03,-6040.2 1490.01,-6033.48"/>
</g>
<!-- expert_7_2_1 -->
<g id="node516" class="node">
<title>expert_7_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1841.5,-6033.92 1564.5,-6033.92 1564.5,-5989.92 1841.5,-5989.92 1841.5,-6033.92"/>
<text text-anchor="middle" x="1703" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L7</text>
<text text-anchor="middle" x="1703" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 197</text>
<text text-anchor="middle" x="1703" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1703" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_2&#45;&gt;expert_7_2_1 -->
<g id="edge624" class="edge">
<title>route_7_2&#45;&gt;expert_7_2_1</title>
<path fill="none" stroke="black" d="M1703,-6069.56C1703,-6061.28 1703,-6052.31 1703,-6043.99"/>
<polygon fill="black" stroke="black" points="1706.5,-6043.92 1703,-6033.92 1699.5,-6043.92 1706.5,-6043.92"/>
</g>
<!-- tp_7_2 -->
<g id="node517" class="node">
<title>tp_7_2</title>
<ellipse fill="lightblue" stroke="black" cx="3425" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3425" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L7</text>
<text text-anchor="middle" x="3425" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 196↔197</text>
<text text-anchor="middle" x="3425" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3425" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_2_0&#45;&gt;tp_7_2 -->
<g id="edge625" class="edge">
<title>expert_7_2_0&#45;&gt;tp_7_2</title>
<path fill="none" stroke="black" d="M1546.6,-5990.73C1549.76,-5990.44 1552.9,-5990.17 1556,-5989.92 1942.37,-5958.63 2915.56,-6003.6 3300,-5953.92 3311.67,-5952.41 3323.84,-5950.24 3335.81,-5947.75"/>
<polygon fill="black" stroke="black" points="3336.76,-5951.13 3345.79,-5945.6 3335.28,-5944.29 3336.76,-5951.13"/>
</g>
<!-- expert_7_2_1&#45;&gt;tp_7_2 -->
<g id="edge626" class="edge">
<title>expert_7_2_1&#45;&gt;tp_7_2</title>
<path fill="none" stroke="black" d="M1841.6,-5990.75C1844.76,-5990.45 1847.9,-5990.17 1851,-5989.92 2492.99,-5936.58 2661.29,-6037.82 3300,-5953.92 3311.67,-5952.38 3323.84,-5950.2 3335.8,-5947.71"/>
<polygon fill="black" stroke="black" points="3336.75,-5951.08 3345.79,-5945.55 3335.27,-5944.24 3336.75,-5951.08"/>
</g>
<!-- tp_7_2&#45;&gt;q_proj_8 -->
<g id="edge1722" class="edge">
<title>tp_7_2&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M3493.72,-5897.73C3511.82,-5892.25 3531.47,-5887.06 3550,-5883.69 3694.64,-5857.37 4100.9,-5838.33 4327.76,-5829.39"/>
<polygon fill="black" stroke="black" points="4327.9,-5832.89 4337.76,-5829 4327.63,-5825.9 4327.9,-5832.89"/>
</g>
<!-- tp_7_2&#45;&gt;k_proj_8 -->
<g id="edge1723" class="edge">
<title>tp_7_2&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M3492.29,-5897.38C3510.75,-5891.76 3530.93,-5886.59 3550,-5883.69 3627.28,-5871.95 4879.87,-5888.36 4957,-5875.69 4989.97,-5870.28 5025.4,-5859.04 5054.24,-5848.4"/>
<polygon fill="black" stroke="black" points="5055.63,-5851.61 5063.76,-5844.82 5053.17,-5845.06 5055.63,-5851.61"/>
</g>
<!-- tp_7_2&#45;&gt;v_proj_8 -->
<g id="edge1724" class="edge">
<title>tp_7_2&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M3492.29,-5897.4C3510.75,-5891.78 3530.94,-5886.6 3550,-5883.69 3670.05,-5865.34 4523.17,-5895.47 4643,-5875.69 4675.96,-5870.25 4711.39,-5859.01 4740.24,-5848.37"/>
<polygon fill="black" stroke="black" points="4741.62,-5851.59 4749.75,-5844.8 4739.16,-5845.04 4741.62,-5851.59"/>
</g>
<!-- expert_7_3_0 -->
<g id="node519" class="node">
<title>expert_7_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2136.5,-6033.92 1859.5,-6033.92 1859.5,-5989.92 2136.5,-5989.92 2136.5,-6033.92"/>
<text text-anchor="middle" x="1998" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L7</text>
<text text-anchor="middle" x="1998" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 198</text>
<text text-anchor="middle" x="1998" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1998" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_3&#45;&gt;expert_7_3_0 -->
<g id="edge628" class="edge">
<title>route_7_3&#45;&gt;expert_7_3_0</title>
<path fill="none" stroke="black" d="M2202.08,-6073.18C2162.92,-6061.62 2117.49,-6048.2 2079.44,-6036.96"/>
<polygon fill="black" stroke="black" points="2080.01,-6033.48 2069.43,-6034.01 2078.03,-6040.2 2080.01,-6033.48"/>
</g>
<!-- expert_7_3_1 -->
<g id="node520" class="node">
<title>expert_7_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2431.5,-6033.92 2154.5,-6033.92 2154.5,-5989.92 2431.5,-5989.92 2431.5,-6033.92"/>
<text text-anchor="middle" x="2293" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L7</text>
<text text-anchor="middle" x="2293" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 199</text>
<text text-anchor="middle" x="2293" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2293" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_3&#45;&gt;expert_7_3_1 -->
<g id="edge629" class="edge">
<title>route_7_3&#45;&gt;expert_7_3_1</title>
<path fill="none" stroke="black" d="M2293,-6069.56C2293,-6061.28 2293,-6052.31 2293,-6043.99"/>
<polygon fill="black" stroke="black" points="2296.5,-6043.92 2293,-6033.92 2289.5,-6043.92 2296.5,-6043.92"/>
</g>
<!-- tp_7_3 -->
<g id="node521" class="node">
<title>tp_7_3</title>
<ellipse fill="lightblue" stroke="black" cx="3675" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3675" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L7</text>
<text text-anchor="middle" x="3675" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 198↔199</text>
<text text-anchor="middle" x="3675" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3675" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_3_0&#45;&gt;tp_7_3 -->
<g id="edge630" class="edge">
<title>expert_7_3_0&#45;&gt;tp_7_3</title>
<path fill="none" stroke="black" d="M2136.6,-5990.76C2139.76,-5990.46 2142.9,-5990.17 2146,-5989.92 2768.04,-5937.98 2931.14,-6035.46 3550,-5953.92 3561.67,-5952.38 3573.84,-5950.2 3585.8,-5947.7"/>
<polygon fill="black" stroke="black" points="3586.75,-5951.07 3595.79,-5945.54 3585.27,-5944.23 3586.75,-5951.07"/>
</g>
<!-- expert_7_3_1&#45;&gt;tp_7_3 -->
<g id="edge631" class="edge">
<title>expert_7_3_1&#45;&gt;tp_7_3</title>
<path fill="none" stroke="black" d="M2431.6,-5990.78C2434.76,-5990.48 2437.9,-5990.18 2441,-5989.92 2932.3,-5947.21 3061.3,-6020.01 3550,-5953.92 3561.58,-5952.35 3573.65,-5950.16 3585.52,-5947.68"/>
<polygon fill="black" stroke="black" points="3586.41,-5951.07 3595.44,-5945.53 3584.92,-5944.23 3586.41,-5951.07"/>
</g>
<!-- tp_7_3&#45;&gt;q_proj_8 -->
<g id="edge1725" class="edge">
<title>tp_7_3&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M3744.43,-5897.83C3762.35,-5892.42 3781.74,-5887.23 3800,-5883.69 3978.76,-5849.01 4187.65,-5834.36 4327.53,-5828.18"/>
<polygon fill="black" stroke="black" points="4328.06,-5831.66 4337.9,-5827.73 4327.76,-5824.67 4328.06,-5831.66"/>
</g>
<!-- tp_7_3&#45;&gt;k_proj_8 -->
<g id="edge1726" class="edge">
<title>tp_7_3&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M3742.29,-5897.4C3760.75,-5891.78 3780.94,-5886.6 3800,-5883.69 3927.09,-5864.3 4830.15,-5896.6 4957,-5875.69 4989.96,-5870.26 5025.39,-5859.02 5054.24,-5848.38"/>
<polygon fill="black" stroke="black" points="5055.63,-5851.6 5063.75,-5844.8 5053.16,-5845.04 5055.63,-5851.6"/>
</g>
<!-- tp_7_3&#45;&gt;v_proj_8 -->
<g id="edge1727" class="edge">
<title>tp_7_3&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M3742.3,-5897.43C3760.76,-5891.81 3780.94,-5886.62 3800,-5883.69 3892.58,-5869.44 4550.6,-5891.04 4643,-5875.69 4675.96,-5870.21 4711.38,-5858.97 4740.23,-5848.34"/>
<polygon fill="black" stroke="black" points="4741.62,-5851.56 4749.75,-5844.77 4739.16,-5845.01 4741.62,-5851.56"/>
</g>
<!-- expert_7_4_0 -->
<g id="node523" class="node">
<title>expert_7_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2726.5,-6033.92 2449.5,-6033.92 2449.5,-5989.92 2726.5,-5989.92 2726.5,-6033.92"/>
<text text-anchor="middle" x="2588" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L7</text>
<text text-anchor="middle" x="2588" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 200</text>
<text text-anchor="middle" x="2588" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2588" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_4&#45;&gt;expert_7_4_0 -->
<g id="edge633" class="edge">
<title>route_7_4&#45;&gt;expert_7_4_0</title>
<path fill="none" stroke="black" d="M2792.08,-6073.18C2752.92,-6061.62 2707.49,-6048.2 2669.44,-6036.96"/>
<polygon fill="black" stroke="black" points="2670.01,-6033.48 2659.43,-6034.01 2668.03,-6040.2 2670.01,-6033.48"/>
</g>
<!-- expert_7_4_1 -->
<g id="node524" class="node">
<title>expert_7_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3021.5,-6033.92 2744.5,-6033.92 2744.5,-5989.92 3021.5,-5989.92 3021.5,-6033.92"/>
<text text-anchor="middle" x="2883" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L7</text>
<text text-anchor="middle" x="2883" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 201</text>
<text text-anchor="middle" x="2883" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2883" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_4&#45;&gt;expert_7_4_1 -->
<g id="edge634" class="edge">
<title>route_7_4&#45;&gt;expert_7_4_1</title>
<path fill="none" stroke="black" d="M2883,-6069.56C2883,-6061.28 2883,-6052.31 2883,-6043.99"/>
<polygon fill="black" stroke="black" points="2886.5,-6043.92 2883,-6033.92 2879.5,-6043.92 2886.5,-6043.92"/>
</g>
<!-- tp_7_4 -->
<g id="node525" class="node">
<title>tp_7_4</title>
<ellipse fill="lightblue" stroke="black" cx="3925" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3925" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L7</text>
<text text-anchor="middle" x="3925" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 200↔201</text>
<text text-anchor="middle" x="3925" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3925" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_4_0&#45;&gt;tp_7_4 -->
<g id="edge635" class="edge">
<title>expert_7_4_0&#45;&gt;tp_7_4</title>
<path fill="none" stroke="black" d="M2726.6,-5990.79C2729.76,-5990.48 2732.9,-5990.19 2736,-5989.92 3207.35,-5948.62 3331.15,-6017.65 3800,-5953.92 3811.58,-5952.34 3823.65,-5950.15 3835.52,-5947.66"/>
<polygon fill="black" stroke="black" points="3836.41,-5951.05 3845.44,-5945.51 3834.92,-5944.21 3836.41,-5951.05"/>
</g>
<!-- expert_7_4_1&#45;&gt;tp_7_4 -->
<g id="edge636" class="edge">
<title>expert_7_4_1&#45;&gt;tp_7_4</title>
<path fill="none" stroke="black" d="M3021.6,-5990.84C3024.76,-5990.52 3027.9,-5990.21 3031,-5989.92 3371.65,-5957.85 3461.27,-6002.2 3800,-5953.92 3811.48,-5952.28 3823.45,-5950.07 3835.24,-5947.58"/>
<polygon fill="black" stroke="black" points="3836.06,-5950.98 3845.08,-5945.43 3834.56,-5944.14 3836.06,-5950.98"/>
</g>
<!-- tp_7_4&#45;&gt;q_proj_8 -->
<g id="edge1728" class="edge">
<title>tp_7_4&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M3995.87,-5898.05C4013.42,-5892.77 4032.27,-5887.59 4050,-5883.69 4141.16,-5863.65 4244.6,-5849.08 4327.84,-5839.31"/>
<polygon fill="black" stroke="black" points="4328.36,-5842.77 4337.89,-5838.14 4327.56,-5835.82 4328.36,-5842.77"/>
</g>
<!-- tp_7_4&#45;&gt;k_proj_8 -->
<g id="edge1729" class="edge">
<title>tp_7_4&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M3992.3,-5897.42C4010.75,-5891.8 4030.94,-5886.62 4050,-5883.69 4149.61,-5868.39 4857.58,-5892.18 4957,-5875.69 4989.96,-5870.22 5025.39,-5858.99 5054.23,-5848.35"/>
<polygon fill="black" stroke="black" points="5055.62,-5851.57 5063.75,-5844.78 5053.16,-5845.02 5055.62,-5851.57"/>
</g>
<!-- tp_7_4&#45;&gt;v_proj_8 -->
<g id="edge1730" class="edge">
<title>tp_7_4&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M3992.63,-5897.38C4011,-5891.8 4031.06,-5886.64 4050,-5883.69 4180.22,-5863.38 4513.04,-5897.55 4643,-5875.69 4675.94,-5870.15 4711.37,-5858.9 4740.22,-5848.28"/>
<polygon fill="black" stroke="black" points="4741.61,-5851.5 4749.74,-5844.71 4739.15,-5844.95 4741.61,-5851.5"/>
</g>
<!-- expert_7_5_0 -->
<g id="node527" class="node">
<title>expert_7_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-6033.92 3039.5,-6033.92 3039.5,-5989.92 3316.5,-5989.92 3316.5,-6033.92"/>
<text text-anchor="middle" x="3178" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L7</text>
<text text-anchor="middle" x="3178" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 202</text>
<text text-anchor="middle" x="3178" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3178" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_5&#45;&gt;expert_7_5_0 -->
<g id="edge638" class="edge">
<title>route_7_5&#45;&gt;expert_7_5_0</title>
<path fill="none" stroke="black" d="M3382.08,-6073.18C3342.92,-6061.62 3297.49,-6048.2 3259.44,-6036.96"/>
<polygon fill="black" stroke="black" points="3260.01,-6033.48 3249.43,-6034.01 3258.03,-6040.2 3260.01,-6033.48"/>
</g>
<!-- expert_7_5_1 -->
<g id="node528" class="node">
<title>expert_7_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3611.5,-6033.92 3334.5,-6033.92 3334.5,-5989.92 3611.5,-5989.92 3611.5,-6033.92"/>
<text text-anchor="middle" x="3473" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L7</text>
<text text-anchor="middle" x="3473" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 203</text>
<text text-anchor="middle" x="3473" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3473" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_5&#45;&gt;expert_7_5_1 -->
<g id="edge639" class="edge">
<title>route_7_5&#45;&gt;expert_7_5_1</title>
<path fill="none" stroke="black" d="M3473,-6069.56C3473,-6061.28 3473,-6052.31 3473,-6043.99"/>
<polygon fill="black" stroke="black" points="3476.5,-6043.92 3473,-6033.92 3469.5,-6043.92 3476.5,-6043.92"/>
</g>
<!-- tp_7_5 -->
<g id="node529" class="node">
<title>tp_7_5</title>
<ellipse fill="lightblue" stroke="black" cx="4175" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4175" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L7</text>
<text text-anchor="middle" x="4175" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 202↔203</text>
<text text-anchor="middle" x="4175" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4175" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_5_0&#45;&gt;tp_7_5 -->
<g id="edge640" class="edge">
<title>expert_7_5_0&#45;&gt;tp_7_5</title>
<path fill="none" stroke="black" d="M3316.61,-5990.86C3319.77,-5990.53 3322.9,-5990.21 3326,-5989.92 3646.71,-5959.25 3731.11,-5999.84 4050,-5953.92 4061.48,-5952.26 4073.45,-5950.04 4085.23,-5947.55"/>
<polygon fill="black" stroke="black" points="4086.05,-5950.95 4095.07,-5945.4 4084.56,-5944.11 4086.05,-5950.95"/>
</g>
<!-- expert_7_5_1&#45;&gt;tp_7_5 -->
<g id="edge641" class="edge">
<title>expert_7_5_1&#45;&gt;tp_7_5</title>
<path fill="none" stroke="black" d="M3611.62,-5991C3614.78,-5990.63 3617.91,-5990.26 3621,-5989.92 3811.13,-5968.47 3861.11,-5984.41 4050,-5953.92 4061.08,-5952.13 4072.63,-5949.88 4084.03,-5947.42"/>
<polygon fill="black" stroke="black" points="4085,-5950.79 4094,-5945.22 4083.48,-5943.96 4085,-5950.79"/>
</g>
<!-- tp_7_5&#45;&gt;q_proj_8 -->
<g id="edge1731" class="edge">
<title>tp_7_5&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M4248.31,-5898.68C4296.88,-5883.35 4360.46,-5863.29 4409.65,-5847.78"/>
<polygon fill="black" stroke="black" points="4410.8,-5851.08 4419.28,-5844.74 4408.69,-5844.41 4410.8,-5851.08"/>
</g>
<!-- tp_7_5&#45;&gt;k_proj_8 -->
<g id="edge1732" class="edge">
<title>tp_7_5&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M4242.63,-5897.37C4261,-5891.78 4281.06,-5886.63 4300,-5883.69 4372.14,-5872.49 4885,-5887.75 4957,-5875.69 4989.95,-5870.17 5025.38,-5858.93 5054.23,-5848.3"/>
<polygon fill="black" stroke="black" points="5055.61,-5851.52 5063.74,-5844.73 5053.15,-5844.97 5055.61,-5851.52"/>
</g>
<!-- tp_7_5&#45;&gt;v_proj_8 -->
<g id="edge1733" class="edge">
<title>tp_7_5&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M4242.65,-5897.51C4261.02,-5891.93 4281.07,-5886.74 4300,-5883.69 4375.27,-5871.57 4567.88,-5888.71 4643,-5875.69 4675.79,-5870.01 4711.07,-5858.81 4739.86,-5848.26"/>
<polygon fill="black" stroke="black" points="4741.22,-5851.49 4749.37,-5844.72 4738.77,-5844.93 4741.22,-5851.49"/>
</g>
<!-- expert_7_6_0 -->
<g id="node531" class="node">
<title>expert_7_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3906.5,-6033.92 3629.5,-6033.92 3629.5,-5989.92 3906.5,-5989.92 3906.5,-6033.92"/>
<text text-anchor="middle" x="3768" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L7</text>
<text text-anchor="middle" x="3768" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 204</text>
<text text-anchor="middle" x="3768" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3768" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_6&#45;&gt;expert_7_6_0 -->
<g id="edge643" class="edge">
<title>route_7_6&#45;&gt;expert_7_6_0</title>
<path fill="none" stroke="black" d="M3972.08,-6073.18C3932.92,-6061.62 3887.49,-6048.2 3849.44,-6036.96"/>
<polygon fill="black" stroke="black" points="3850.01,-6033.48 3839.43,-6034.01 3848.03,-6040.2 3850.01,-6033.48"/>
</g>
<!-- expert_7_6_1 -->
<g id="node532" class="node">
<title>expert_7_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4201.5,-6033.92 3924.5,-6033.92 3924.5,-5989.92 4201.5,-5989.92 4201.5,-6033.92"/>
<text text-anchor="middle" x="4063" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L7</text>
<text text-anchor="middle" x="4063" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 205</text>
<text text-anchor="middle" x="4063" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4063" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_6&#45;&gt;expert_7_6_1 -->
<g id="edge644" class="edge">
<title>route_7_6&#45;&gt;expert_7_6_1</title>
<path fill="none" stroke="black" d="M4063,-6069.56C4063,-6061.28 4063,-6052.31 4063,-6043.99"/>
<polygon fill="black" stroke="black" points="4066.5,-6043.92 4063,-6033.92 4059.5,-6043.92 4066.5,-6043.92"/>
</g>
<!-- tp_7_6 -->
<g id="node533" class="node">
<title>tp_7_6</title>
<ellipse fill="lightblue" stroke="black" cx="4425" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4425" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L7</text>
<text text-anchor="middle" x="4425" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 204↔205</text>
<text text-anchor="middle" x="4425" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4425" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_6_0&#45;&gt;tp_7_6 -->
<g id="edge645" class="edge">
<title>expert_7_6_0&#45;&gt;tp_7_6</title>
<path fill="none" stroke="black" d="M3906.63,-5991.04C3909.78,-5990.66 3912.91,-5990.28 3916,-5989.92 4086.24,-5969.87 4130.91,-5982.06 4300,-5953.92 4311.07,-5952.07 4322.61,-5949.79 4334.02,-5947.32"/>
<polygon fill="black" stroke="black" points="4334.98,-5950.69 4343.98,-5945.1 4333.46,-5943.85 4334.98,-5950.69"/>
</g>
<!-- expert_7_6_1&#45;&gt;tp_7_6 -->
<g id="edge646" class="edge">
<title>expert_7_6_1&#45;&gt;tp_7_6</title>
<path fill="none" stroke="black" d="M4150.51,-5989.88C4195.24,-5979.12 4250.52,-5965.82 4300,-5953.92 4309.87,-5951.54 4320.17,-5949.06 4330.45,-5946.58"/>
<polygon fill="black" stroke="black" points="4331.38,-5949.96 4340.28,-5944.22 4329.74,-5943.16 4331.38,-5949.96"/>
</g>
<!-- tp_7_6&#45;&gt;q_proj_8 -->
<g id="edge1734" class="edge">
<title>tp_7_6&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M4443.63,-5891.83C4451.17,-5879.71 4459.86,-5865.74 4467.39,-5853.62"/>
<polygon fill="black" stroke="black" points="4470.59,-5855.11 4472.89,-5844.77 4464.64,-5851.42 4470.59,-5855.11"/>
</g>
<!-- tp_7_6&#45;&gt;k_proj_8 -->
<g id="edge1735" class="edge">
<title>tp_7_6&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M4492.64,-5897.46C4511.01,-5891.88 4531.07,-5886.7 4550,-5883.69 4639.34,-5869.47 4867.84,-5890.97 4957,-5875.69 4989.8,-5870.07 5025.08,-5858.88 5053.87,-5848.31"/>
<polygon fill="black" stroke="black" points="5055.23,-5851.54 5063.37,-5844.77 5052.78,-5844.99 5055.23,-5851.54"/>
</g>
<!-- tp_7_6&#45;&gt;v_proj_8 -->
<g id="edge1736" class="edge">
<title>tp_7_6&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M4494.43,-5897.81C4512.34,-5892.4 4531.73,-5887.22 4550,-5883.69 4590.73,-5875.82 4602.36,-5884.05 4643,-5875.69 4674.57,-5869.2 4708.65,-5858.4 4736.96,-5848.32"/>
<polygon fill="black" stroke="black" points="4738.5,-5851.48 4746.72,-5844.79 4736.12,-5844.9 4738.5,-5851.48"/>
</g>
<!-- expert_7_7_0 -->
<g id="node535" class="node">
<title>expert_7_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4496.5,-6033.92 4219.5,-6033.92 4219.5,-5989.92 4496.5,-5989.92 4496.5,-6033.92"/>
<text text-anchor="middle" x="4358" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L7</text>
<text text-anchor="middle" x="4358" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 206</text>
<text text-anchor="middle" x="4358" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4358" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_7&#45;&gt;expert_7_7_0 -->
<g id="edge648" class="edge">
<title>route_7_7&#45;&gt;expert_7_7_0</title>
<path fill="none" stroke="black" d="M4516.32,-6072.11C4486.66,-6061.02 4452.83,-6048.37 4424.08,-6037.62"/>
<polygon fill="black" stroke="black" points="4425.13,-6034.28 4414.54,-6034.05 4422.68,-6040.83 4425.13,-6034.28"/>
</g>
<!-- expert_7_7_1 -->
<g id="node536" class="node">
<title>expert_7_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4791.5,-6033.92 4514.5,-6033.92 4514.5,-5989.92 4791.5,-5989.92 4791.5,-6033.92"/>
<text text-anchor="middle" x="4653" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L7</text>
<text text-anchor="middle" x="4653" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 207</text>
<text text-anchor="middle" x="4653" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4653" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_7&#45;&gt;expert_7_7_1 -->
<g id="edge649" class="edge">
<title>route_7_7&#45;&gt;expert_7_7_1</title>
<path fill="none" stroke="black" d="M4612.34,-6070.05C4618.71,-6061.1 4625.68,-6051.3 4632.03,-6042.38"/>
<polygon fill="black" stroke="black" points="4634.94,-6044.33 4637.88,-6034.16 4629.23,-6040.27 4634.94,-6044.33"/>
</g>
<!-- tp_7_7 -->
<g id="node537" class="node">
<title>tp_7_7</title>
<ellipse fill="lightblue" stroke="black" cx="4675" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4675" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L7</text>
<text text-anchor="middle" x="4675" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 206↔207</text>
<text text-anchor="middle" x="4675" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4675" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_7_0&#45;&gt;tp_7_7 -->
<g id="edge650" class="edge">
<title>expert_7_7_0&#45;&gt;tp_7_7</title>
<path fill="none" stroke="black" d="M4434.74,-5989.83C4480.34,-5977.3 4538.37,-5961.35 4585.98,-5948.27"/>
<polygon fill="black" stroke="black" points="4586.94,-5951.63 4595.66,-5945.61 4585.09,-5944.88 4586.94,-5951.63"/>
</g>
<!-- expert_7_7_1&#45;&gt;tp_7_7 -->
<g id="edge651" class="edge">
<title>expert_7_7_1&#45;&gt;tp_7_7</title>
<path fill="none" stroke="black" d="M4658.33,-5989.83C4660.3,-5982 4662.62,-5972.84 4664.88,-5963.87"/>
<polygon fill="black" stroke="black" points="4668.34,-5964.47 4667.4,-5953.91 4661.55,-5962.75 4668.34,-5964.47"/>
</g>
<!-- tp_7_7&#45;&gt;q_proj_8 -->
<g id="edge1737" class="edge">
<title>tp_7_7&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M4623.1,-5894.86C4595.81,-5880.69 4562.52,-5863.41 4535.58,-5849.43"/>
<polygon fill="black" stroke="black" points="4537.19,-5846.32 4526.7,-5844.82 4533.96,-5852.53 4537.19,-5846.32"/>
</g>
<!-- tp_7_7&#45;&gt;k_proj_8 -->
<g id="edge1738" class="edge">
<title>tp_7_7&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M4743.36,-5897.66C4761.55,-5892.15 4781.34,-5886.96 4800,-5883.69 4868.82,-5871.63 4888.33,-5888.57 4957,-5875.69 4989.33,-5869.63 5024.16,-5858.58 5052.78,-5848.22"/>
<polygon fill="black" stroke="black" points="5054.06,-5851.48 5062.24,-5844.74 5051.64,-5844.91 5054.06,-5851.48"/>
</g>
<!-- tp_7_7&#45;&gt;v_proj_8 -->
<g id="edge1739" class="edge">
<title>tp_7_7&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M4711.49,-5893.16C4728.46,-5879.84 4748.54,-5864.08 4765.28,-5850.94"/>
<polygon fill="black" stroke="black" points="4767.5,-5853.65 4773.2,-5844.72 4763.18,-5848.14 4767.5,-5853.65"/>
</g>
<!-- expert_7_8_0 -->
<g id="node539" class="node">
<title>expert_7_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-6033.92 4809.5,-6033.92 4809.5,-5989.92 5086.5,-5989.92 5086.5,-6033.92"/>
<text text-anchor="middle" x="4948" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L7</text>
<text text-anchor="middle" x="4948" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="4948" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4948" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_8&#45;&gt;expert_7_8_0 -->
<g id="edge653" class="edge">
<title>route_7_8&#45;&gt;expert_7_8_0</title>
<path fill="none" stroke="black" d="M4989.32,-6070.05C4982.85,-6061.1 4975.76,-6051.3 4969.31,-6042.38"/>
<polygon fill="black" stroke="black" points="4972.06,-6040.21 4963.36,-6034.16 4966.39,-6044.31 4972.06,-6040.21"/>
</g>
<!-- expert_7_8_1 -->
<g id="node540" class="node">
<title>expert_7_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5381.5,-6033.92 5104.5,-6033.92 5104.5,-5989.92 5381.5,-5989.92 5381.5,-6033.92"/>
<text text-anchor="middle" x="5243" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L7</text>
<text text-anchor="middle" x="5243" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="5243" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5243" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_8&#45;&gt;expert_7_8_1 -->
<g id="edge654" class="edge">
<title>route_7_8&#45;&gt;expert_7_8_1</title>
<path fill="none" stroke="black" d="M5085.36,-6072.11C5114.89,-6061.02 5148.58,-6048.37 5177.2,-6037.62"/>
<polygon fill="black" stroke="black" points="5178.57,-6040.84 5186.71,-6034.05 5176.11,-6034.29 5178.57,-6040.84"/>
</g>
<!-- tp_7_8 -->
<g id="node541" class="node">
<title>tp_7_8</title>
<ellipse fill="lightblue" stroke="black" cx="4925" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4925" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L7</text>
<text text-anchor="middle" x="4925" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="4925" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4925" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_8_0&#45;&gt;tp_7_8 -->
<g id="edge655" class="edge">
<title>expert_7_8_0&#45;&gt;tp_7_8</title>
<path fill="none" stroke="black" d="M4942.43,-5989.83C4940.37,-5982 4937.95,-5972.84 4935.58,-5963.87"/>
<polygon fill="black" stroke="black" points="4938.89,-5962.69 4932.95,-5953.91 4932.12,-5964.48 4938.89,-5962.69"/>
</g>
<!-- expert_7_8_1&#45;&gt;tp_7_8 -->
<g id="edge656" class="edge">
<title>expert_7_8_1&#45;&gt;tp_7_8</title>
<path fill="none" stroke="black" d="M5166.02,-5989.83C5120.19,-5977.27 5061.84,-5961.29 5014.04,-5948.19"/>
<polygon fill="black" stroke="black" points="5014.88,-5944.8 5004.31,-5945.53 5013.03,-5951.55 5014.88,-5944.8"/>
</g>
<!-- tp_7_8&#45;&gt;q_proj_8 -->
<g id="edge1740" class="edge">
<title>tp_7_8&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M4856.64,-5897.66C4838.45,-5892.15 4818.66,-5886.96 4800,-5883.69 4731.18,-5871.63 4711.67,-5888.57 4643,-5875.69 4610.67,-5869.63 4575.84,-5858.58 4547.22,-5848.22"/>
<polygon fill="black" stroke="black" points="4548.36,-5844.91 4537.76,-5844.74 4545.94,-5851.48 4548.36,-5844.91"/>
</g>
<!-- tp_7_8&#45;&gt;k_proj_8 -->
<g id="edge1741" class="edge">
<title>tp_7_8&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M4976.9,-5894.86C5004.19,-5880.69 5037.48,-5863.41 5064.42,-5849.43"/>
<polygon fill="black" stroke="black" points="5066.04,-5852.53 5073.3,-5844.82 5062.81,-5846.32 5066.04,-5852.53"/>
</g>
<!-- tp_7_8&#45;&gt;v_proj_8 -->
<g id="edge1742" class="edge">
<title>tp_7_8&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M4888.51,-5893.16C4871.54,-5879.84 4851.46,-5864.08 4834.72,-5850.94"/>
<polygon fill="black" stroke="black" points="4836.82,-5848.14 4826.8,-5844.72 4832.5,-5853.65 4836.82,-5848.14"/>
</g>
<!-- expert_7_9_0 -->
<g id="node543" class="node">
<title>expert_7_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5676.5,-6033.92 5399.5,-6033.92 5399.5,-5989.92 5676.5,-5989.92 5676.5,-6033.92"/>
<text text-anchor="middle" x="5538" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L7</text>
<text text-anchor="middle" x="5538" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 226</text>
<text text-anchor="middle" x="5538" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5538" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_9&#45;&gt;expert_7_9_0 -->
<g id="edge658" class="edge">
<title>route_7_9&#45;&gt;expert_7_9_0</title>
<path fill="none" stroke="black" d="M5538,-6069.56C5538,-6061.28 5538,-6052.31 5538,-6043.99"/>
<polygon fill="black" stroke="black" points="5541.5,-6043.92 5538,-6033.92 5534.5,-6043.92 5541.5,-6043.92"/>
</g>
<!-- expert_7_9_1 -->
<g id="node544" class="node">
<title>expert_7_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5971.5,-6033.92 5694.5,-6033.92 5694.5,-5989.92 5971.5,-5989.92 5971.5,-6033.92"/>
<text text-anchor="middle" x="5833" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L7</text>
<text text-anchor="middle" x="5833" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 227</text>
<text text-anchor="middle" x="5833" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5833" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_9&#45;&gt;expert_7_9_1 -->
<g id="edge659" class="edge">
<title>route_7_9&#45;&gt;expert_7_9_1</title>
<path fill="none" stroke="black" d="M5628.92,-6073.18C5668.08,-6061.62 5713.51,-6048.2 5751.56,-6036.96"/>
<polygon fill="black" stroke="black" points="5752.97,-6040.2 5761.57,-6034.01 5750.99,-6033.48 5752.97,-6040.2"/>
</g>
<!-- tp_7_9 -->
<g id="node545" class="node">
<title>tp_7_9</title>
<ellipse fill="lightblue" stroke="black" cx="5175" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5175" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L7</text>
<text text-anchor="middle" x="5175" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 226↔227</text>
<text text-anchor="middle" x="5175" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5175" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_9_0&#45;&gt;tp_7_9 -->
<g id="edge660" class="edge">
<title>expert_7_9_0&#45;&gt;tp_7_9</title>
<path fill="none" stroke="black" d="M5450.11,-5989.9C5405.2,-5979.15 5349.68,-5965.85 5300,-5953.92 5290.05,-5951.52 5279.65,-5949.02 5269.29,-5946.53"/>
<polygon fill="black" stroke="black" points="5269.92,-5943.08 5259.38,-5944.15 5268.28,-5949.89 5269.92,-5943.08"/>
</g>
<!-- expert_7_9_1&#45;&gt;tp_7_9 -->
<g id="edge661" class="edge">
<title>expert_7_9_1&#45;&gt;tp_7_9</title>
<path fill="none" stroke="black" d="M5694.14,-5990.89C5691.4,-5990.56 5688.69,-5990.23 5686,-5989.92 5514.89,-5969.73 5469.97,-5982.16 5300,-5953.92 5288.93,-5952.08 5277.39,-5949.8 5265.98,-5947.32"/>
<polygon fill="black" stroke="black" points="5266.54,-5943.86 5256.01,-5945.1 5265.02,-5950.69 5266.54,-5943.86"/>
</g>
<!-- tp_7_9&#45;&gt;q_proj_8 -->
<g id="edge1743" class="edge">
<title>tp_7_9&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M5107.36,-5897.46C5088.99,-5891.88 5068.93,-5886.7 5050,-5883.69 4960.66,-5869.47 4732.16,-5890.97 4643,-5875.69 4610.2,-5870.07 4574.92,-5858.88 4546.13,-5848.31"/>
<polygon fill="black" stroke="black" points="4547.22,-5844.99 4536.63,-5844.77 4544.77,-5851.54 4547.22,-5844.99"/>
</g>
<!-- tp_7_9&#45;&gt;k_proj_8 -->
<g id="edge1744" class="edge">
<title>tp_7_9&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M5156.37,-5891.83C5148.83,-5879.71 5140.14,-5865.74 5132.61,-5853.62"/>
<polygon fill="black" stroke="black" points="5135.36,-5851.42 5127.11,-5844.77 5129.41,-5855.11 5135.36,-5851.42"/>
</g>
<!-- tp_7_9&#45;&gt;v_proj_8 -->
<g id="edge1745" class="edge">
<title>tp_7_9&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M5105.57,-5897.81C5087.66,-5892.4 5068.27,-5887.22 5050,-5883.69 5009.27,-5875.82 4997.64,-5884.05 4957,-5875.69 4925.43,-5869.2 4891.35,-5858.4 4863.04,-5848.32"/>
<polygon fill="black" stroke="black" points="4863.88,-5844.9 4853.28,-5844.79 4861.5,-5851.48 4863.88,-5844.9"/>
</g>
<!-- expert_7_10_0 -->
<g id="node547" class="node">
<title>expert_7_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6266.5,-6033.92 5989.5,-6033.92 5989.5,-5989.92 6266.5,-5989.92 6266.5,-6033.92"/>
<text text-anchor="middle" x="6128" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L7</text>
<text text-anchor="middle" x="6128" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 228</text>
<text text-anchor="middle" x="6128" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6128" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_10&#45;&gt;expert_7_10_0 -->
<g id="edge663" class="edge">
<title>route_7_10&#45;&gt;expert_7_10_0</title>
<path fill="none" stroke="black" d="M6128,-6069.56C6128,-6061.28 6128,-6052.31 6128,-6043.99"/>
<polygon fill="black" stroke="black" points="6131.5,-6043.92 6128,-6033.92 6124.5,-6043.92 6131.5,-6043.92"/>
</g>
<!-- expert_7_10_1 -->
<g id="node548" class="node">
<title>expert_7_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6561.5,-6033.92 6284.5,-6033.92 6284.5,-5989.92 6561.5,-5989.92 6561.5,-6033.92"/>
<text text-anchor="middle" x="6423" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L7</text>
<text text-anchor="middle" x="6423" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 229</text>
<text text-anchor="middle" x="6423" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6423" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_10&#45;&gt;expert_7_10_1 -->
<g id="edge664" class="edge">
<title>route_7_10&#45;&gt;expert_7_10_1</title>
<path fill="none" stroke="black" d="M6218.92,-6073.18C6258.08,-6061.62 6303.51,-6048.2 6341.56,-6036.96"/>
<polygon fill="black" stroke="black" points="6342.97,-6040.2 6351.57,-6034.01 6340.99,-6033.48 6342.97,-6040.2"/>
</g>
<!-- tp_7_10 -->
<g id="node549" class="node">
<title>tp_7_10</title>
<ellipse fill="lightblue" stroke="black" cx="5425" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5425" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L7</text>
<text text-anchor="middle" x="5425" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 228↔229</text>
<text text-anchor="middle" x="5425" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5425" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_10_0&#45;&gt;tp_7_10 -->
<g id="edge665" class="edge">
<title>expert_7_10_0&#45;&gt;tp_7_10</title>
<path fill="none" stroke="black" d="M5989.14,-5990.86C5986.41,-5990.53 5983.69,-5990.22 5981,-5989.92 5790,-5968.31 5739.77,-5984.51 5550,-5953.92 5538.92,-5952.13 5527.37,-5949.88 5515.97,-5947.43"/>
<polygon fill="black" stroke="black" points="5516.52,-5943.96 5506,-5945.22 5515,-5950.8 5516.52,-5943.96"/>
</g>
<!-- expert_7_10_1&#45;&gt;tp_7_10 -->
<g id="edge666" class="edge">
<title>expert_7_10_1&#45;&gt;tp_7_10</title>
<path fill="none" stroke="black" d="M6284.16,-5990.73C6281.42,-5990.45 6278.69,-5990.17 6276,-5989.92 5954.42,-5959.04 5869.77,-5999.95 5550,-5953.92 5538.52,-5952.26 5526.55,-5950.04 5514.77,-5947.55"/>
<polygon fill="black" stroke="black" points="5515.44,-5944.11 5504.93,-5945.4 5513.95,-5950.95 5515.44,-5944.11"/>
</g>
<!-- tp_7_10&#45;&gt;q_proj_8 -->
<g id="edge1746" class="edge">
<title>tp_7_10&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M5357.37,-5897.37C5339,-5891.78 5318.94,-5886.63 5300,-5883.69 5227.86,-5872.49 4715,-5887.75 4643,-5875.69 4610.05,-5870.17 4574.62,-5858.93 4545.77,-5848.3"/>
<polygon fill="black" stroke="black" points="4546.85,-5844.97 4536.26,-5844.73 4544.39,-5851.52 4546.85,-5844.97"/>
</g>
<!-- tp_7_10&#45;&gt;k_proj_8 -->
<g id="edge1747" class="edge">
<title>tp_7_10&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M5351.69,-5898.68C5303.12,-5883.35 5239.54,-5863.29 5190.35,-5847.78"/>
<polygon fill="black" stroke="black" points="5191.31,-5844.41 5180.72,-5844.74 5189.2,-5851.08 5191.31,-5844.41"/>
</g>
<!-- tp_7_10&#45;&gt;v_proj_8 -->
<g id="edge1748" class="edge">
<title>tp_7_10&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M5357.35,-5897.51C5338.98,-5891.93 5318.93,-5886.74 5300,-5883.69 5224.73,-5871.57 5032.12,-5888.71 4957,-5875.69 4924.21,-5870.01 4888.93,-5858.81 4860.14,-5848.26"/>
<polygon fill="black" stroke="black" points="4861.23,-5844.93 4850.63,-5844.72 4858.78,-5851.49 4861.23,-5844.93"/>
</g>
<!-- expert_7_11_0 -->
<g id="node551" class="node">
<title>expert_7_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6856.5,-6033.92 6579.5,-6033.92 6579.5,-5989.92 6856.5,-5989.92 6856.5,-6033.92"/>
<text text-anchor="middle" x="6718" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L7</text>
<text text-anchor="middle" x="6718" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 230</text>
<text text-anchor="middle" x="6718" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6718" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_11&#45;&gt;expert_7_11_0 -->
<g id="edge668" class="edge">
<title>route_7_11&#45;&gt;expert_7_11_0</title>
<path fill="none" stroke="black" d="M6718,-6069.56C6718,-6061.28 6718,-6052.31 6718,-6043.99"/>
<polygon fill="black" stroke="black" points="6721.5,-6043.92 6718,-6033.92 6714.5,-6043.92 6721.5,-6043.92"/>
</g>
<!-- expert_7_11_1 -->
<g id="node552" class="node">
<title>expert_7_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7151.5,-6033.92 6874.5,-6033.92 6874.5,-5989.92 7151.5,-5989.92 7151.5,-6033.92"/>
<text text-anchor="middle" x="7013" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L7</text>
<text text-anchor="middle" x="7013" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 231</text>
<text text-anchor="middle" x="7013" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7013" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_11&#45;&gt;expert_7_11_1 -->
<g id="edge669" class="edge">
<title>route_7_11&#45;&gt;expert_7_11_1</title>
<path fill="none" stroke="black" d="M6808.92,-6073.18C6848.08,-6061.62 6893.51,-6048.2 6931.56,-6036.96"/>
<polygon fill="black" stroke="black" points="6932.97,-6040.2 6941.57,-6034.01 6930.99,-6033.48 6932.97,-6040.2"/>
</g>
<!-- tp_7_11 -->
<g id="node553" class="node">
<title>tp_7_11</title>
<ellipse fill="lightblue" stroke="black" cx="5675" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5675" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L7</text>
<text text-anchor="middle" x="5675" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 230↔231</text>
<text text-anchor="middle" x="5675" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5675" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_11_0&#45;&gt;tp_7_11 -->
<g id="edge670" class="edge">
<title>expert_7_11_0&#45;&gt;tp_7_11</title>
<path fill="none" stroke="black" d="M6579.16,-5990.72C6576.42,-5990.44 6573.69,-5990.17 6571,-5989.92 6229.48,-5957.62 6139.61,-6002.3 5800,-5953.92 5788.52,-5952.28 5776.55,-5950.07 5764.76,-5947.58"/>
<polygon fill="black" stroke="black" points="5765.44,-5944.14 5754.92,-5945.43 5763.94,-5950.98 5765.44,-5944.14"/>
</g>
<!-- expert_7_11_1&#45;&gt;tp_7_11 -->
<g id="edge671" class="edge">
<title>expert_7_11_1&#45;&gt;tp_7_11</title>
<path fill="none" stroke="black" d="M6874.16,-5990.67C6871.42,-5990.41 6868.7,-5990.15 6866,-5989.92 6393.78,-5948.33 6269.73,-6017.75 5800,-5953.92 5788.42,-5952.34 5776.35,-5950.15 5764.48,-5947.67"/>
<polygon fill="black" stroke="black" points="5765.08,-5944.21 5754.56,-5945.51 5763.59,-5951.06 5765.08,-5944.21"/>
</g>
<!-- tp_7_11&#45;&gt;q_proj_8 -->
<g id="edge1749" class="edge">
<title>tp_7_11&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M5607.7,-5897.42C5589.25,-5891.8 5569.06,-5886.62 5550,-5883.69 5450.39,-5868.39 4742.42,-5892.18 4643,-5875.69 4610.04,-5870.22 4574.61,-5858.99 4545.77,-5848.35"/>
<polygon fill="black" stroke="black" points="4546.84,-5845.02 4536.25,-5844.78 4544.38,-5851.57 4546.84,-5845.02"/>
</g>
<!-- tp_7_11&#45;&gt;k_proj_8 -->
<g id="edge1750" class="edge">
<title>tp_7_11&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M5604.13,-5898.05C5586.58,-5892.77 5567.73,-5887.59 5550,-5883.69 5458.84,-5863.65 5355.4,-5849.08 5272.16,-5839.31"/>
<polygon fill="black" stroke="black" points="5272.44,-5835.82 5262.11,-5838.14 5271.64,-5842.77 5272.44,-5835.82"/>
</g>
<!-- tp_7_11&#45;&gt;v_proj_8 -->
<g id="edge1751" class="edge">
<title>tp_7_11&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M5607.37,-5897.38C5589,-5891.8 5568.94,-5886.64 5550,-5883.69 5419.78,-5863.38 5086.96,-5897.55 4957,-5875.69 4924.06,-5870.15 4888.63,-5858.9 4859.78,-5848.28"/>
<polygon fill="black" stroke="black" points="4860.85,-5844.95 4850.26,-5844.71 4858.39,-5851.5 4860.85,-5844.95"/>
</g>
<!-- expert_7_12_0 -->
<g id="node555" class="node">
<title>expert_7_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7446.5,-6033.92 7169.5,-6033.92 7169.5,-5989.92 7446.5,-5989.92 7446.5,-6033.92"/>
<text text-anchor="middle" x="7308" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L7</text>
<text text-anchor="middle" x="7308" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 232</text>
<text text-anchor="middle" x="7308" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7308" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_12&#45;&gt;expert_7_12_0 -->
<g id="edge673" class="edge">
<title>route_7_12&#45;&gt;expert_7_12_0</title>
<path fill="none" stroke="black" d="M7308,-6069.56C7308,-6061.28 7308,-6052.31 7308,-6043.99"/>
<polygon fill="black" stroke="black" points="7311.5,-6043.92 7308,-6033.92 7304.5,-6043.92 7311.5,-6043.92"/>
</g>
<!-- expert_7_12_1 -->
<g id="node556" class="node">
<title>expert_7_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7741.5,-6033.92 7464.5,-6033.92 7464.5,-5989.92 7741.5,-5989.92 7741.5,-6033.92"/>
<text text-anchor="middle" x="7603" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L7</text>
<text text-anchor="middle" x="7603" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 233</text>
<text text-anchor="middle" x="7603" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7603" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_12&#45;&gt;expert_7_12_1 -->
<g id="edge674" class="edge">
<title>route_7_12&#45;&gt;expert_7_12_1</title>
<path fill="none" stroke="black" d="M7398.92,-6073.18C7438.08,-6061.62 7483.51,-6048.2 7521.56,-6036.96"/>
<polygon fill="black" stroke="black" points="7522.97,-6040.2 7531.57,-6034.01 7520.99,-6033.48 7522.97,-6040.2"/>
</g>
<!-- tp_7_12 -->
<g id="node557" class="node">
<title>tp_7_12</title>
<ellipse fill="lightblue" stroke="black" cx="5925" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5925" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L7</text>
<text text-anchor="middle" x="5925" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 232↔233</text>
<text text-anchor="middle" x="5925" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5925" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_12_0&#45;&gt;tp_7_12 -->
<g id="edge675" class="edge">
<title>expert_7_12_0&#45;&gt;tp_7_12</title>
<path fill="none" stroke="black" d="M7169.16,-5990.67C7166.42,-5990.4 7163.7,-5990.15 7161,-5989.92 6668.84,-5946.92 6539.58,-6020.11 6050,-5953.92 6038.42,-5952.35 6026.35,-5950.17 6014.48,-5947.68"/>
<polygon fill="black" stroke="black" points="6015.08,-5944.23 6004.56,-5945.53 6013.59,-5951.07 6015.08,-5944.23"/>
</g>
<!-- expert_7_12_1&#45;&gt;tp_7_12 -->
<g id="edge676" class="edge">
<title>expert_7_12_1&#45;&gt;tp_7_12</title>
<path fill="none" stroke="black" d="M7464.16,-5990.64C7461.42,-5990.38 7458.7,-5990.14 7456,-5989.92 6833.1,-5937.63 6669.74,-6035.57 6050,-5953.92 6038.33,-5952.38 6026.16,-5950.2 6014.2,-5947.7"/>
<polygon fill="black" stroke="black" points="6014.73,-5944.23 6004.21,-5945.54 6013.25,-5951.07 6014.73,-5944.23"/>
</g>
<!-- tp_7_12&#45;&gt;q_proj_8 -->
<g id="edge1752" class="edge">
<title>tp_7_12&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M5857.71,-5897.4C5839.25,-5891.78 5819.06,-5886.6 5800,-5883.69 5672.91,-5864.3 4769.85,-5896.6 4643,-5875.69 4610.04,-5870.26 4574.61,-5859.02 4545.76,-5848.38"/>
<polygon fill="black" stroke="black" points="4546.84,-5845.04 4536.25,-5844.8 4544.37,-5851.6 4546.84,-5845.04"/>
</g>
<!-- tp_7_12&#45;&gt;k_proj_8 -->
<g id="edge1753" class="edge">
<title>tp_7_12&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M5855.57,-5897.83C5837.65,-5892.42 5818.26,-5887.23 5800,-5883.69 5621.24,-5849.01 5412.35,-5834.36 5272.47,-5828.18"/>
<polygon fill="black" stroke="black" points="5272.24,-5824.67 5262.1,-5827.73 5271.94,-5831.66 5272.24,-5824.67"/>
</g>
<!-- tp_7_12&#45;&gt;v_proj_8 -->
<g id="edge1754" class="edge">
<title>tp_7_12&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M5857.7,-5897.43C5839.24,-5891.81 5819.06,-5886.62 5800,-5883.69 5707.42,-5869.44 5049.4,-5891.04 4957,-5875.69 4924.04,-5870.21 4888.62,-5858.97 4859.77,-5848.34"/>
<polygon fill="black" stroke="black" points="4860.84,-5845.01 4850.25,-5844.77 4858.38,-5851.56 4860.84,-5845.01"/>
</g>
<!-- expert_7_13_0 -->
<g id="node559" class="node">
<title>expert_7_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8036.5,-6033.92 7759.5,-6033.92 7759.5,-5989.92 8036.5,-5989.92 8036.5,-6033.92"/>
<text text-anchor="middle" x="7898" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L7</text>
<text text-anchor="middle" x="7898" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 234</text>
<text text-anchor="middle" x="7898" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7898" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_13&#45;&gt;expert_7_13_0 -->
<g id="edge678" class="edge">
<title>route_7_13&#45;&gt;expert_7_13_0</title>
<path fill="none" stroke="black" d="M7898,-6069.56C7898,-6061.28 7898,-6052.31 7898,-6043.99"/>
<polygon fill="black" stroke="black" points="7901.5,-6043.92 7898,-6033.92 7894.5,-6043.92 7901.5,-6043.92"/>
</g>
<!-- expert_7_13_1 -->
<g id="node560" class="node">
<title>expert_7_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8331.5,-6033.92 8054.5,-6033.92 8054.5,-5989.92 8331.5,-5989.92 8331.5,-6033.92"/>
<text text-anchor="middle" x="8193" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L7</text>
<text text-anchor="middle" x="8193" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 235</text>
<text text-anchor="middle" x="8193" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8193" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_13&#45;&gt;expert_7_13_1 -->
<g id="edge679" class="edge">
<title>route_7_13&#45;&gt;expert_7_13_1</title>
<path fill="none" stroke="black" d="M7988.92,-6073.18C8028.08,-6061.62 8073.51,-6048.2 8111.56,-6036.96"/>
<polygon fill="black" stroke="black" points="8112.97,-6040.2 8121.57,-6034.01 8110.99,-6033.48 8112.97,-6040.2"/>
</g>
<!-- tp_7_13 -->
<g id="node561" class="node">
<title>tp_7_13</title>
<ellipse fill="lightblue" stroke="black" cx="6175" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6175" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L7</text>
<text text-anchor="middle" x="6175" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 234↔235</text>
<text text-anchor="middle" x="6175" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6175" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_13_0&#45;&gt;tp_7_13 -->
<g id="edge680" class="edge">
<title>expert_7_13_0&#45;&gt;tp_7_13</title>
<path fill="none" stroke="black" d="M7759.16,-5990.64C7756.42,-5990.38 7753.7,-5990.14 7751,-5989.92 7108.15,-5936.21 6939.59,-6037.92 6300,-5953.92 6288.33,-5952.38 6276.16,-5950.2 6264.2,-5947.71"/>
<polygon fill="black" stroke="black" points="6264.73,-5944.24 6254.21,-5945.55 6263.25,-5951.08 6264.73,-5944.24"/>
</g>
<!-- expert_7_13_1&#45;&gt;tp_7_13 -->
<g id="edge681" class="edge">
<title>expert_7_13_1&#45;&gt;tp_7_13</title>
<path fill="none" stroke="black" d="M8054.17,-5990.62C8051.42,-5990.37 8048.7,-5990.13 8046,-5989.92 7659.2,-5958.42 6684.88,-6003.65 6300,-5953.92 6288.33,-5952.41 6276.16,-5950.24 6264.19,-5947.75"/>
<polygon fill="black" stroke="black" points="6264.72,-5944.29 6254.21,-5945.6 6263.24,-5951.13 6264.72,-5944.29"/>
</g>
<!-- tp_7_13&#45;&gt;q_proj_8 -->
<g id="edge1755" class="edge">
<title>tp_7_13&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M6107.71,-5897.38C6089.25,-5891.76 6069.07,-5886.59 6050,-5883.69 5972.72,-5871.95 4720.13,-5888.36 4643,-5875.69 4610.03,-5870.28 4574.6,-5859.04 4545.76,-5848.4"/>
<polygon fill="black" stroke="black" points="4546.83,-5845.06 4536.24,-5844.82 4544.37,-5851.61 4546.83,-5845.06"/>
</g>
<!-- tp_7_13&#45;&gt;k_proj_8 -->
<g id="edge1756" class="edge">
<title>tp_7_13&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M6106.28,-5897.73C6088.18,-5892.25 6068.53,-5887.06 6050,-5883.69 5905.36,-5857.37 5499.1,-5838.33 5272.24,-5829.39"/>
<polygon fill="black" stroke="black" points="5272.37,-5825.9 5262.24,-5829 5272.1,-5832.89 5272.37,-5825.9"/>
</g>
<!-- tp_7_13&#45;&gt;v_proj_8 -->
<g id="edge1757" class="edge">
<title>tp_7_13&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M6107.71,-5897.4C6089.25,-5891.78 6069.06,-5886.6 6050,-5883.69 5929.95,-5865.34 5076.83,-5895.47 4957,-5875.69 4924.04,-5870.25 4888.61,-5859.01 4859.76,-5848.37"/>
<polygon fill="black" stroke="black" points="4860.84,-5845.04 4850.25,-5844.8 4858.38,-5851.59 4860.84,-5845.04"/>
</g>
<!-- expert_7_14_0 -->
<g id="node563" class="node">
<title>expert_7_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8626.5,-6033.92 8349.5,-6033.92 8349.5,-5989.92 8626.5,-5989.92 8626.5,-6033.92"/>
<text text-anchor="middle" x="8488" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L7</text>
<text text-anchor="middle" x="8488" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 236</text>
<text text-anchor="middle" x="8488" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8488" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_14&#45;&gt;expert_7_14_0 -->
<g id="edge683" class="edge">
<title>route_7_14&#45;&gt;expert_7_14_0</title>
<path fill="none" stroke="black" d="M8488,-6069.56C8488,-6061.28 8488,-6052.31 8488,-6043.99"/>
<polygon fill="black" stroke="black" points="8491.5,-6043.92 8488,-6033.92 8484.5,-6043.92 8491.5,-6043.92"/>
</g>
<!-- expert_7_14_1 -->
<g id="node564" class="node">
<title>expert_7_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8921.5,-6033.92 8644.5,-6033.92 8644.5,-5989.92 8921.5,-5989.92 8921.5,-6033.92"/>
<text text-anchor="middle" x="8783" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L7</text>
<text text-anchor="middle" x="8783" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 237</text>
<text text-anchor="middle" x="8783" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8783" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_14&#45;&gt;expert_7_14_1 -->
<g id="edge684" class="edge">
<title>route_7_14&#45;&gt;expert_7_14_1</title>
<path fill="none" stroke="black" d="M8578.92,-6073.18C8618.08,-6061.62 8663.51,-6048.2 8701.56,-6036.96"/>
<polygon fill="black" stroke="black" points="8702.97,-6040.2 8711.57,-6034.01 8700.99,-6033.48 8702.97,-6040.2"/>
</g>
<!-- tp_7_14 -->
<g id="node565" class="node">
<title>tp_7_14</title>
<ellipse fill="lightblue" stroke="black" cx="6425" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6425" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L7</text>
<text text-anchor="middle" x="6425" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 236↔237</text>
<text text-anchor="middle" x="6425" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6425" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_14_0&#45;&gt;tp_7_14 -->
<g id="edge685" class="edge">
<title>expert_7_14_0&#45;&gt;tp_7_14</title>
<path fill="none" stroke="black" d="M8349.17,-5990.62C8346.42,-5990.37 8343.7,-5990.13 8341,-5989.92 7944.22,-5957.71 6944.81,-6004.83 6550,-5953.92 6538.33,-5952.41 6526.16,-5950.25 6514.19,-5947.76"/>
<polygon fill="black" stroke="black" points="6514.72,-5944.29 6504.21,-5945.6 6513.24,-5951.14 6514.72,-5944.29"/>
</g>
<!-- expert_7_14_1&#45;&gt;tp_7_14 -->
<g id="edge686" class="edge">
<title>expert_7_14_1&#45;&gt;tp_7_14</title>
<path fill="none" stroke="black" d="M8644.17,-5990.61C8641.42,-5990.36 8638.7,-5990.13 8636,-5989.92 8173.84,-5953.06 7009.9,-6012.56 6550,-5953.92 6538.32,-5952.43 6526.15,-5950.27 6514.19,-5947.79"/>
<polygon fill="black" stroke="black" points="6514.71,-5944.33 6504.2,-5945.64 6513.24,-5951.17 6514.71,-5944.33"/>
</g>
<!-- tp_7_14&#45;&gt;q_proj_8 -->
<g id="edge1758" class="edge">
<title>tp_7_14&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M6357.71,-5897.37C6339.25,-5891.75 6319.07,-5886.58 6300,-5883.69 6208.98,-5869.9 4733.85,-5890.57 4643,-5875.69 4609.9,-5870.27 4574.33,-5858.97 4545.42,-5848.29"/>
<polygon fill="black" stroke="black" points="4546.48,-5844.95 4535.89,-5844.7 4544.01,-5851.5 4546.48,-5844.95"/>
</g>
<!-- tp_7_14&#45;&gt;k_proj_8 -->
<g id="edge1759" class="edge">
<title>tp_7_14&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M6356.64,-5897.66C6338.45,-5892.15 6318.66,-5886.96 6300,-5883.69 6107.3,-5849.97 5548.52,-5833.27 5272.33,-5826.89"/>
<polygon fill="black" stroke="black" points="5272.3,-5823.39 5262.23,-5826.66 5272.14,-5830.38 5272.3,-5823.39"/>
</g>
<!-- tp_7_14&#45;&gt;v_proj_8 -->
<g id="edge1760" class="edge">
<title>tp_7_14&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M6357.71,-5897.39C6339.25,-5891.77 6319.07,-5886.59 6300,-5883.69 6226.24,-5872.47 5030.62,-5887.79 4957,-5875.69 4924.04,-5870.27 4888.61,-5859.04 4859.76,-5848.39"/>
<polygon fill="black" stroke="black" points="4860.84,-5845.06 4850.24,-5844.82 4858.37,-5851.61 4860.84,-5845.06"/>
</g>
<!-- expert_7_15_0 -->
<g id="node567" class="node">
<title>expert_7_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9216.5,-6033.92 8939.5,-6033.92 8939.5,-5989.92 9216.5,-5989.92 9216.5,-6033.92"/>
<text text-anchor="middle" x="9078" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L7</text>
<text text-anchor="middle" x="9078" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 238</text>
<text text-anchor="middle" x="9078" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9078" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_15&#45;&gt;expert_7_15_0 -->
<g id="edge688" class="edge">
<title>route_7_15&#45;&gt;expert_7_15_0</title>
<path fill="none" stroke="black" d="M9078,-6069.56C9078,-6061.28 9078,-6052.31 9078,-6043.99"/>
<polygon fill="black" stroke="black" points="9081.5,-6043.92 9078,-6033.92 9074.5,-6043.92 9081.5,-6043.92"/>
</g>
<!-- expert_7_15_1 -->
<g id="node568" class="node">
<title>expert_7_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9511.5,-6033.92 9234.5,-6033.92 9234.5,-5989.92 9511.5,-5989.92 9511.5,-6033.92"/>
<text text-anchor="middle" x="9373" y="-6024.72" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L7</text>
<text text-anchor="middle" x="9373" y="-6014.72" font-family="Times,serif" font-size="9.00">GPU: 239</text>
<text text-anchor="middle" x="9373" y="-6004.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9373" y="-5994.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_15&#45;&gt;expert_7_15_1 -->
<g id="edge689" class="edge">
<title>route_7_15&#45;&gt;expert_7_15_1</title>
<path fill="none" stroke="black" d="M9168.92,-6073.18C9208.08,-6061.62 9253.51,-6048.2 9291.56,-6036.96"/>
<polygon fill="black" stroke="black" points="9292.97,-6040.2 9301.57,-6034.01 9290.99,-6033.48 9292.97,-6040.2"/>
</g>
<!-- tp_7_15 -->
<g id="node569" class="node">
<title>tp_7_15</title>
<ellipse fill="lightblue" stroke="black" cx="6675" cy="-5922.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6675" y="-5935.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L7</text>
<text text-anchor="middle" x="6675" y="-5925.6" font-family="Times,serif" font-size="9.00">GPU: 238↔239</text>
<text text-anchor="middle" x="6675" y="-5915.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6675" y="-5905.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_15_0&#45;&gt;tp_7_15 -->
<g id="edge690" class="edge">
<title>expert_7_15_0&#45;&gt;tp_7_15</title>
<path fill="none" stroke="black" d="M8939.16,-5990.66C8936.42,-5990.39 8933.7,-5990.15 8931,-5989.92 8512.38,-5953.99 7211.95,-5931.86 6800.89,-5925.62"/>
<polygon fill="black" stroke="black" points="6800.8,-5922.12 6790.75,-5925.47 6800.7,-5929.12 6800.8,-5922.12"/>
</g>
<!-- expert_7_15_1&#45;&gt;tp_7_15 -->
<g id="edge691" class="edge">
<title>expert_7_15_1&#45;&gt;tp_7_15</title>
<path fill="none" stroke="black" d="M9234.16,-5990.64C9231.42,-5990.39 9228.7,-5990.14 9226,-5989.92 8746.93,-5949.62 7246.66,-5930.13 6801.03,-5925.13"/>
<polygon fill="black" stroke="black" points="6801.05,-5921.63 6791.02,-5925.02 6800.98,-5928.63 6801.05,-5921.63"/>
</g>
<!-- tp_7_15&#45;&gt;q_proj_8 -->
<g id="edge1761" class="edge">
<title>tp_7_15&#45;&gt;q_proj_8</title>
<path fill="none" stroke="black" d="M6607.71,-5897.36C6589.25,-5891.74 6569.07,-5886.57 6550,-5883.69 6445.25,-5867.85 4747.56,-5892.78 4643,-5875.69 4609.9,-5870.28 4574.33,-5858.98 4545.42,-5848.3"/>
<polygon fill="black" stroke="black" points="4546.48,-5844.95 4535.89,-5844.7 4544.01,-5851.51 4546.48,-5844.95"/>
</g>
<!-- tp_7_15&#45;&gt;k_proj_8 -->
<g id="edge1762" class="edge">
<title>tp_7_15&#45;&gt;k_proj_8</title>
<path fill="none" stroke="black" d="M6606.66,-5897.55C6588.47,-5892.03 6568.67,-5886.87 6550,-5883.69 6308.57,-5842.53 5593.02,-5829.21 5272.44,-5825.24"/>
<polygon fill="black" stroke="black" points="5272.18,-5821.74 5262.14,-5825.12 5272.1,-5828.74 5272.18,-5821.74"/>
</g>
<!-- tp_7_15&#45;&gt;v_proj_8 -->
<g id="edge1763" class="edge">
<title>tp_7_15&#45;&gt;v_proj_8</title>
<path fill="none" stroke="black" d="M6607.71,-5897.37C6589.25,-5891.75 6569.07,-5886.58 6550,-5883.69 6462.5,-5870.42 5044.34,-5890 4957,-5875.69 4923.91,-5870.27 4888.33,-5858.97 4859.42,-5848.28"/>
<polygon fill="black" stroke="black" points="4860.48,-5844.94 4849.89,-5844.69 4858.01,-5851.49 4860.48,-5844.94"/>
</g>
<!-- attn_scores_8 -->
<g id="node573" class="node">
<title>attn_scores_8</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-5764.69 4633.5,-5764.69 4633.5,-5720.69 4966.5,-5720.69 4966.5,-5764.69"/>
<text text-anchor="middle" x="4800" y="-5755.49" font-family="Times,serif" font-size="9.00">Attention Scores L8</text>
<text text-anchor="middle" x="4800" y="-5745.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4800" y="-5735.49" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-5725.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_8&#45;&gt;attn_scores_8 -->
<g id="edge692" class="edge">
<title>q_proj_8&#45;&gt;attn_scores_8</title>
<path fill="none" stroke="black" d="M4570.56,-5800.68C4612.18,-5790.34 4662.51,-5777.84 4705.41,-5767.19"/>
<polygon fill="black" stroke="black" points="4706.43,-5770.54 4715.29,-5764.73 4704.74,-5763.75 4706.43,-5770.54"/>
</g>
<!-- k_proj_8&#45;&gt;attn_scores_8 -->
<g id="edge693" class="edge">
<title>k_proj_8&#45;&gt;attn_scores_8</title>
<path fill="none" stroke="black" d="M5029.44,-5800.68C4987.82,-5790.34 4937.49,-5777.84 4894.59,-5767.19"/>
<polygon fill="black" stroke="black" points="4895.26,-5763.75 4884.71,-5764.73 4893.57,-5770.54 4895.26,-5763.75"/>
</g>
<!-- v_proj_8&#45;&gt;attn_scores_8 -->
<g id="edge694" class="edge">
<title>v_proj_8&#45;&gt;attn_scores_8</title>
<path fill="none" stroke="black" d="M4800,-5800.38C4800,-5792.49 4800,-5783.37 4800,-5774.79"/>
<polygon fill="black" stroke="black" points="4803.5,-5774.71 4800,-5764.71 4796.5,-5774.71 4803.5,-5774.71"/>
</g>
<!-- softmax_8 -->
<g id="node574" class="node">
<title>softmax_8</title>
<polygon fill="lightgreen" stroke="black" points="4966.5,-5684.69 4633.5,-5684.69 4633.5,-5640.69 4966.5,-5640.69 4966.5,-5684.69"/>
<text text-anchor="middle" x="4800" y="-5675.49" font-family="Times,serif" font-size="9.00">Softmax L8</text>
<text text-anchor="middle" x="4800" y="-5665.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4800" y="-5655.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4800" y="-5645.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_8&#45;&gt;softmax_8 -->
<g id="edge695" class="edge">
<title>attn_scores_8&#45;&gt;softmax_8</title>
<path fill="none" stroke="black" d="M4800,-5720.38C4800,-5712.49 4800,-5703.37 4800,-5694.79"/>
<polygon fill="black" stroke="black" points="4803.5,-5694.71 4800,-5684.71 4796.5,-5694.71 4803.5,-5694.71"/>
</g>
<!-- attn_out_8 -->
<g id="node575" class="node">
<title>attn_out_8</title>
<polygon fill="lightgreen" stroke="black" points="4948,-5604.69 4652,-5604.69 4652,-5560.69 4948,-5560.69 4948,-5604.69"/>
<text text-anchor="middle" x="4800" y="-5595.49" font-family="Times,serif" font-size="9.00">Attention Output L8</text>
<text text-anchor="middle" x="4800" y="-5585.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4800" y="-5575.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-5565.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_8&#45;&gt;attn_out_8 -->
<g id="edge696" class="edge">
<title>softmax_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M4800,-5640.38C4800,-5632.49 4800,-5623.37 4800,-5614.79"/>
<polygon fill="black" stroke="black" points="4803.5,-5614.71 4800,-5604.71 4796.5,-5614.71 4803.5,-5614.71"/>
</g>
<!-- gate_8 -->
<g id="node576" class="node">
<title>gate_8</title>
<polygon fill="lightyellow" stroke="black" points="5099.74,-5524.69 4622.92,-5524.69 4500.26,-5436.69 4977.08,-5436.69 5099.74,-5524.69"/>
<text text-anchor="middle" x="4800" y="-5493.49" font-family="Times,serif" font-size="9.00">Gate L8</text>
<text text-anchor="middle" x="4800" y="-5483.49" font-family="Times,serif" font-size="9.00">GPU: 256&#45;319</text>
<text text-anchor="middle" x="4800" y="-5473.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4800" y="-5463.49" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_8&#45;&gt;gate_8 -->
<g id="edge697" class="edge">
<title>attn_out_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M4800,-5560.48C4800,-5552.98 4800,-5544.18 4800,-5535.22"/>
<polygon fill="black" stroke="black" points="4803.5,-5535.1 4800,-5525.1 4796.5,-5535.1 4803.5,-5535.1"/>
</g>
<!-- route_8_0 -->
<g id="node577" class="node">
<title>route_8_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="450" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="450" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="450" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="450" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_0 -->
<g id="edge698" class="edge">
<title>gate_8&#45;&gt;route_8_0</title>
<path fill="none" stroke="black" d="M4560.41,-5479.86C3942.29,-5479.22 2243.2,-5470.68 830,-5400.69 764.75,-5397.46 693.31,-5392.24 630.17,-5387.05"/>
<polygon fill="black" stroke="black" points="630.36,-5383.55 620.11,-5386.22 629.79,-5390.53 630.36,-5383.55"/>
</g>
<!-- route_8_1 -->
<g id="node581" class="node">
<title>route_8_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1040" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1040" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 258,259</text>
<text text-anchor="middle" x="1040" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_1 -->
<g id="edge703" class="edge">
<title>gate_8&#45;&gt;route_8_1</title>
<path fill="none" stroke="black" d="M4558.54,-5478.66C4003.81,-5475.28 2595.69,-5460.97 1420,-5400.69 1354.91,-5397.35 1283.67,-5392.13 1220.63,-5386.96"/>
<polygon fill="black" stroke="black" points="1220.84,-5383.46 1210.59,-5386.13 1220.27,-5390.44 1220.84,-5383.46"/>
</g>
<!-- route_8_2 -->
<g id="node585" class="node">
<title>route_8_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1630" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1630" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 260,261</text>
<text text-anchor="middle" x="1630" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_2 -->
<g id="edge708" class="edge">
<title>gate_8&#45;&gt;route_8_2</title>
<path fill="none" stroke="black" d="M4556.32,-5476.95C4071.25,-5470.57 2950.52,-5451.24 2010,-5400.69 1945.08,-5397.2 1874.02,-5391.95 1811.1,-5386.81"/>
<polygon fill="black" stroke="black" points="1811.32,-5383.32 1801.07,-5385.99 1810.75,-5390.3 1811.32,-5383.32"/>
</g>
<!-- route_8_3 -->
<g id="node589" class="node">
<title>route_8_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2220" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2220" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 262,263</text>
<text text-anchor="middle" x="2220" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_3 -->
<g id="edge713" class="edge">
<title>gate_8&#45;&gt;route_8_3</title>
<path fill="none" stroke="black" d="M4552.39,-5474.28C4144.97,-5464.6 3307.79,-5441.42 2600,-5400.69 2535.25,-5396.96 2464.38,-5391.68 2401.57,-5386.57"/>
<polygon fill="black" stroke="black" points="2401.81,-5383.08 2391.56,-5385.75 2401.24,-5390.06 2401.81,-5383.08"/>
</g>
<!-- route_8_4 -->
<g id="node593" class="node">
<title>route_8_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2810" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2810" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 264,265</text>
<text text-anchor="middle" x="2810" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_4 -->
<g id="edge718" class="edge">
<title>gate_8&#45;&gt;route_8_4</title>
<path fill="none" stroke="black" d="M4546.11,-5469.59C4228.75,-5456.43 3668.96,-5431.41 3190,-5400.69 3125.88,-5396.58 3055.73,-5391.25 2993.35,-5386.23"/>
<polygon fill="black" stroke="black" points="2993.26,-5382.71 2983.01,-5385.39 2992.7,-5389.68 2993.26,-5382.71"/>
</g>
<!-- route_8_5 -->
<g id="node597" class="node">
<title>route_8_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3400" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 266,267</text>
<text text-anchor="middle" x="3400" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_5 -->
<g id="edge723" class="edge">
<title>gate_8&#45;&gt;route_8_5</title>
<path fill="none" stroke="black" d="M4531.27,-5459.01C4325.59,-5443.15 4034.87,-5420.66 3780,-5400.69 3716.88,-5395.74 3647.86,-5390.29 3586.17,-5385.4"/>
<polygon fill="black" stroke="black" points="3586.19,-5381.89 3575.94,-5384.58 3585.63,-5388.86 3586.19,-5381.89"/>
</g>
<!-- route_8_6 -->
<g id="node601" class="node">
<title>route_8_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3990" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="3990" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 268,269</text>
<text text-anchor="middle" x="3990" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_6 -->
<g id="edge728" class="edge">
<title>gate_8&#45;&gt;route_8_6</title>
<path fill="none" stroke="black" d="M4504.71,-5439.91C4384.27,-5423.69 4249.83,-5405.58 4148.56,-5391.94"/>
<polygon fill="black" stroke="black" points="4148.93,-5388.45 4138.55,-5390.59 4148,-5395.39 4148.93,-5388.45"/>
</g>
<!-- route_8_7 -->
<g id="node605" class="node">
<title>route_8_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4517" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4517" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4517" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 270,271</text>
<text text-anchor="middle" x="4517" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4517" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_7 -->
<g id="edge733" class="edge">
<title>gate_8&#45;&gt;route_8_7</title>
<path fill="none" stroke="black" d="M4688.15,-5436.57C4658.58,-5425.16 4627.19,-5413.06 4599.48,-5402.38"/>
<polygon fill="black" stroke="black" points="4600.43,-5398.99 4589.85,-5398.66 4597.92,-5405.53 4600.43,-5398.99"/>
</g>
<!-- route_8_8 -->
<g id="node609" class="node">
<title>route_8_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4937" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4937" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4937" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="4937" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4937" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_8 -->
<g id="edge738" class="edge">
<title>gate_8&#45;&gt;route_8_8</title>
<path fill="none" stroke="black" d="M4854.15,-5436.57C4866.54,-5426.69 4879.6,-5416.3 4891.58,-5406.75"/>
<polygon fill="black" stroke="black" points="4894.05,-5409.26 4899.69,-5400.29 4889.69,-5403.79 4894.05,-5409.26"/>
</g>
<!-- route_8_9 -->
<g id="node613" class="node">
<title>route_8_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5465" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5465" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 290,291</text>
<text text-anchor="middle" x="5465" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_9 -->
<g id="edge743" class="edge">
<title>gate_8&#45;&gt;route_8_9</title>
<path fill="none" stroke="black" d="M4993.24,-5447.98C5097.59,-5430.86 5224.28,-5410.07 5320.09,-5394.35"/>
<polygon fill="black" stroke="black" points="5320.84,-5397.78 5330.14,-5392.7 5319.71,-5390.87 5320.84,-5397.78"/>
</g>
<!-- route_8_10 -->
<g id="node617" class="node">
<title>route_8_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6055" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6055" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 292,293</text>
<text text-anchor="middle" x="6055" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_10 -->
<g id="edge748" class="edge">
<title>gate_8&#45;&gt;route_8_10</title>
<path fill="none" stroke="black" d="M5011.47,-5461.3C5252.91,-5440.31 5643.88,-5406.32 5872.5,-5386.44"/>
<polygon fill="black" stroke="black" points="5872.93,-5389.92 5882.59,-5385.57 5872.32,-5382.95 5872.93,-5389.92"/>
</g>
<!-- route_8_11 -->
<g id="node621" class="node">
<title>route_8_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6645" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6645" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 294,295</text>
<text text-anchor="middle" x="6645" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_11 -->
<g id="edge753" class="edge">
<title>gate_8&#45;&gt;route_8_11</title>
<path fill="none" stroke="black" d="M5022.86,-5469.42C5310.12,-5455.78 5825.01,-5429.98 6265,-5400.69 6328.96,-5396.43 6398.92,-5391.09 6461.18,-5386.08"/>
<polygon fill="black" stroke="black" points="6461.82,-5389.54 6471.5,-5385.25 6461.25,-5382.57 6461.82,-5389.54"/>
</g>
<!-- route_8_12 -->
<g id="node625" class="node">
<title>route_8_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7235" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7235" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 296,297</text>
<text text-anchor="middle" x="7235" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_12 -->
<g id="edge758" class="edge">
<title>gate_8&#45;&gt;route_8_12</title>
<path fill="none" stroke="black" d="M5028.98,-5473.93C5408.69,-5463.69 6192.51,-5439.66 6855,-5400.69 6919.59,-5396.89 6990.27,-5391.6 7052.97,-5386.51"/>
<polygon fill="black" stroke="black" points="7053.28,-5390 7062.96,-5385.7 7052.71,-5383.02 7053.28,-5390"/>
</g>
<!-- route_8_13 -->
<g id="node629" class="node">
<title>route_8_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7825" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7825" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 298,299</text>
<text text-anchor="middle" x="7825" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_13 -->
<g id="edge763" class="edge">
<title>gate_8&#45;&gt;route_8_13</title>
<path fill="none" stroke="black" d="M5032.79,-5476.58C5493.61,-5469.59 6554.5,-5449.24 7445,-5400.69 7509.92,-5397.15 7580.98,-5391.89 7643.9,-5386.76"/>
<polygon fill="black" stroke="black" points="7644.25,-5390.24 7653.93,-5385.93 7643.67,-5383.26 7644.25,-5390.24"/>
</g>
<!-- route_8_14 -->
<g id="node633" class="node">
<title>route_8_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8415" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8415" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 300,301</text>
<text text-anchor="middle" x="8415" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_14 -->
<g id="edge768" class="edge">
<title>gate_8&#45;&gt;route_8_14</title>
<path fill="none" stroke="black" d="M5035.59,-5478.35C5569.6,-5474.33 6912.91,-5458.81 8035,-5400.69 8100.09,-5397.32 8171.33,-5392.08 8234.37,-5386.92"/>
<polygon fill="black" stroke="black" points="8234.73,-5390.4 8244.41,-5386.09 8234.16,-5383.43 8234.73,-5390.4"/>
</g>
<!-- route_8_15 -->
<g id="node637" class="node">
<title>route_8_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9005" cy="-5369.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-5382.38" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9005" y="-5372.38" font-family="Times,serif" font-size="9.00">GPU: 302,303</text>
<text text-anchor="middle" x="9005" y="-5362.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-5352.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_15 -->
<g id="edge773" class="edge">
<title>gate_8&#45;&gt;route_8_15</title>
<path fill="none" stroke="black" d="M5037.13,-5479.6C5637.85,-5478.34 7268.18,-5468.4 8625,-5400.69 8690.25,-5397.43 8761.68,-5392.21 8824.83,-5387.02"/>
<polygon fill="black" stroke="black" points="8825.21,-5390.5 8834.89,-5386.19 8824.64,-5383.53 8825.21,-5390.5"/>
</g>
<!-- expert_8_0_0 -->
<g id="node578" class="node">
<title>expert_8_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293.5,-5302.46 16.5,-5302.46 16.5,-5258.46 293.5,-5258.46 293.5,-5302.46"/>
<text text-anchor="middle" x="155" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L8</text>
<text text-anchor="middle" x="155" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="155" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_0&#45;&gt;expert_8_0_0 -->
<g id="edge699" class="edge">
<title>route_8_0&#45;&gt;expert_8_0_0</title>
<path fill="none" stroke="black" d="M359.08,-5341.73C319.92,-5330.16 274.49,-5316.75 236.44,-5305.51"/>
<polygon fill="black" stroke="black" points="237.01,-5302.03 226.43,-5302.56 235.03,-5308.75 237.01,-5302.03"/>
</g>
<!-- expert_8_0_1 -->
<g id="node579" class="node">
<title>expert_8_0_1</title>
<polygon fill="lightgreen" stroke="black" points="588.5,-5302.46 311.5,-5302.46 311.5,-5258.46 588.5,-5258.46 588.5,-5302.46"/>
<text text-anchor="middle" x="450" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L8</text>
<text text-anchor="middle" x="450" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="450" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_0&#45;&gt;expert_8_0_1 -->
<g id="edge700" class="edge">
<title>route_8_0&#45;&gt;expert_8_0_1</title>
<path fill="none" stroke="black" d="M450,-5338.11C450,-5329.83 450,-5320.85 450,-5312.54"/>
<polygon fill="black" stroke="black" points="453.5,-5312.47 450,-5302.47 446.5,-5312.47 453.5,-5312.47"/>
</g>
<!-- tp_8_0 -->
<g id="node580" class="node">
<title>tp_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="2852" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2852" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L8</text>
<text text-anchor="middle" x="2852" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="2852" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2852" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_0_0&#45;&gt;tp_8_0 -->
<g id="edge701" class="edge">
<title>expert_8_0_0&#45;&gt;tp_8_0</title>
<path fill="none" stroke="black" d="M293.84,-5259.19C296.58,-5258.93 299.3,-5258.69 302,-5258.46 780.88,-5218.19 2280.56,-5198.68 2726.02,-5193.68"/>
<polygon fill="black" stroke="black" points="2726.07,-5197.18 2736.03,-5193.57 2725.99,-5190.18 2726.07,-5197.18"/>
</g>
<!-- expert_8_0_1&#45;&gt;tp_8_0 -->
<g id="edge702" class="edge">
<title>expert_8_0_1&#45;&gt;tp_8_0</title>
<path fill="none" stroke="black" d="M588.6,-5259.32C591.76,-5259.02 594.9,-5258.73 598,-5258.46 1016.26,-5222.77 2315.54,-5200.48 2726.23,-5194.19"/>
<polygon fill="black" stroke="black" points="2726.41,-5197.69 2736.35,-5194.03 2726.3,-5190.69 2726.41,-5197.69"/>
</g>
<!-- q_proj_9 -->
<g id="node641" class="node">
<title>q_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="4875,-5124.24 4579,-5124.24 4579,-5080.24 4875,-5080.24 4875,-5124.24"/>
<text text-anchor="middle" x="4727" y="-5115.04" font-family="Times,serif" font-size="9.00">Q Projection L9</text>
<text text-anchor="middle" x="4727" y="-5105.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4727" y="-5095.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-5085.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_8_0&#45;&gt;q_proj_9 -->
<g id="edge1764" class="edge">
<title>tp_8_0&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M2931.21,-5168.58C2946.31,-5165.2 2962.06,-5162.18 2977,-5160.24 3324.87,-5114.94 4200.53,-5151.07 4568.51,-5124.29"/>
<polygon fill="black" stroke="black" points="4569,-5127.76 4578.71,-5123.52 4568.48,-5120.78 4569,-5127.76"/>
</g>
<!-- k_proj_9 -->
<g id="node642" class="node">
<title>k_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="5189,-5124.24 4893,-5124.24 4893,-5080.24 5189,-5080.24 5189,-5124.24"/>
<text text-anchor="middle" x="5041" y="-5115.04" font-family="Times,serif" font-size="9.00">K Projection L9</text>
<text text-anchor="middle" x="5041" y="-5105.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="5041" y="-5095.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5041" y="-5085.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_8_0&#45;&gt;k_proj_9 -->
<g id="edge1765" class="edge">
<title>tp_8_0&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M2931.2,-5168.53C2946.3,-5165.16 2962.06,-5162.16 2977,-5160.24 3394.12,-5106.71 4444.78,-5155.61 4882.49,-5124.29"/>
<polygon fill="black" stroke="black" points="4883,-5127.76 4892.71,-5123.53 4882.48,-5120.78 4883,-5127.76"/>
</g>
<!-- v_proj_9 -->
<g id="node643" class="node">
<title>v_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="4561,-5124.24 4265,-5124.24 4265,-5080.24 4561,-5080.24 4561,-5124.24"/>
<text text-anchor="middle" x="4413" y="-5115.04" font-family="Times,serif" font-size="9.00">V Projection L9</text>
<text text-anchor="middle" x="4413" y="-5105.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4413" y="-5095.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4413" y="-5085.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_8_0&#45;&gt;v_proj_9 -->
<g id="edge1766" class="edge">
<title>tp_8_0&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M2931.57,-5168.71C2946.56,-5165.34 2962.19,-5162.3 2977,-5160.24 3219.49,-5126.55 3934.06,-5111.02 4254.44,-5105.6"/>
<polygon fill="black" stroke="black" points="4254.79,-5109.09 4264.73,-5105.43 4254.68,-5102.1 4254.79,-5109.09"/>
</g>
<!-- expert_8_1_0 -->
<g id="node582" class="node">
<title>expert_8_1_0</title>
<polygon fill="lightgreen" stroke="black" points="883.5,-5302.46 606.5,-5302.46 606.5,-5258.46 883.5,-5258.46 883.5,-5302.46"/>
<text text-anchor="middle" x="745" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L8</text>
<text text-anchor="middle" x="745" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 258</text>
<text text-anchor="middle" x="745" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="745" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_1&#45;&gt;expert_8_1_0 -->
<g id="edge704" class="edge">
<title>route_8_1&#45;&gt;expert_8_1_0</title>
<path fill="none" stroke="black" d="M949.08,-5341.73C909.92,-5330.16 864.49,-5316.75 826.44,-5305.51"/>
<polygon fill="black" stroke="black" points="827.01,-5302.03 816.43,-5302.56 825.03,-5308.75 827.01,-5302.03"/>
</g>
<!-- expert_8_1_1 -->
<g id="node583" class="node">
<title>expert_8_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1178.5,-5302.46 901.5,-5302.46 901.5,-5258.46 1178.5,-5258.46 1178.5,-5302.46"/>
<text text-anchor="middle" x="1040" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L8</text>
<text text-anchor="middle" x="1040" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 259</text>
<text text-anchor="middle" x="1040" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_1&#45;&gt;expert_8_1_1 -->
<g id="edge705" class="edge">
<title>route_8_1&#45;&gt;expert_8_1_1</title>
<path fill="none" stroke="black" d="M1040,-5338.11C1040,-5329.83 1040,-5320.85 1040,-5312.54"/>
<polygon fill="black" stroke="black" points="1043.5,-5312.47 1040,-5302.47 1036.5,-5312.47 1043.5,-5312.47"/>
</g>
<!-- tp_8_1 -->
<g id="node584" class="node">
<title>tp_8_1</title>
<ellipse fill="lightblue" stroke="black" cx="3102" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3102" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L8</text>
<text text-anchor="middle" x="3102" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 258↔259</text>
<text text-anchor="middle" x="3102" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3102" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_1_0&#45;&gt;tp_8_1 -->
<g id="edge706" class="edge">
<title>expert_8_1_0&#45;&gt;tp_8_1</title>
<path fill="none" stroke="black" d="M883.59,-5259.27C886.76,-5258.98 889.9,-5258.71 893,-5258.46 1354.73,-5221.86 2517.54,-5281.05 2977,-5222.46 2988.68,-5220.98 3000.85,-5218.82 3012.81,-5216.34"/>
<polygon fill="black" stroke="black" points="3013.76,-5219.72 3022.8,-5214.19 3012.29,-5212.87 3013.76,-5219.72"/>
</g>
<!-- expert_8_1_1&#45;&gt;tp_8_1 -->
<g id="edge707" class="edge">
<title>expert_8_1_1&#45;&gt;tp_8_1</title>
<path fill="none" stroke="black" d="M1178.6,-5259.28C1181.76,-5258.99 1184.9,-5258.71 1188,-5258.46 1584.35,-5226.47 2582.63,-5273.32 2977,-5222.46 2988.67,-5220.96 3000.84,-5218.8 3012.81,-5216.31"/>
<polygon fill="black" stroke="black" points="3013.76,-5219.69 3022.79,-5214.15 3012.28,-5212.84 3013.76,-5219.69"/>
</g>
<!-- tp_8_1&#45;&gt;q_proj_9 -->
<g id="edge1767" class="edge">
<title>tp_8_1&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M3181.55,-5168.56C3196.55,-5165.2 3212.17,-5162.2 3227,-5160.24 3815.62,-5082.33 3973.04,-5170.88 4568.58,-5124.3"/>
<polygon fill="black" stroke="black" points="4569.02,-5127.78 4578.71,-5123.5 4568.47,-5120.8 4569.02,-5127.78"/>
</g>
<!-- tp_8_1&#45;&gt;k_proj_9 -->
<g id="edge1768" class="edge">
<title>tp_8_1&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M3181.21,-5168.57C3196.3,-5165.19 3212.06,-5162.18 3227,-5160.24 3589.04,-5113.25 4500.58,-5152 4882.67,-5124.27"/>
<polygon fill="black" stroke="black" points="4883,-5127.76 4892.71,-5123.52 4882.48,-5120.78 4883,-5127.76"/>
</g>
<!-- tp_8_1&#45;&gt;v_proj_9 -->
<g id="edge1769" class="edge">
<title>tp_8_1&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M3181.92,-5168.74C3196.81,-5165.39 3212.31,-5162.34 3227,-5160.24 3420.63,-5132.52 3978.96,-5114.57 4254.85,-5107.14"/>
<polygon fill="black" stroke="black" points="4255.05,-5110.64 4264.95,-5106.87 4254.86,-5103.64 4255.05,-5110.64"/>
</g>
<!-- expert_8_2_0 -->
<g id="node586" class="node">
<title>expert_8_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-5302.46 1196.5,-5302.46 1196.5,-5258.46 1473.5,-5258.46 1473.5,-5302.46"/>
<text text-anchor="middle" x="1335" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L8</text>
<text text-anchor="middle" x="1335" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 260</text>
<text text-anchor="middle" x="1335" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1335" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_2&#45;&gt;expert_8_2_0 -->
<g id="edge709" class="edge">
<title>route_8_2&#45;&gt;expert_8_2_0</title>
<path fill="none" stroke="black" d="M1539.08,-5341.73C1499.92,-5330.16 1454.49,-5316.75 1416.44,-5305.51"/>
<polygon fill="black" stroke="black" points="1417.01,-5302.03 1406.43,-5302.56 1415.03,-5308.75 1417.01,-5302.03"/>
</g>
<!-- expert_8_2_1 -->
<g id="node587" class="node">
<title>expert_8_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1768.5,-5302.46 1491.5,-5302.46 1491.5,-5258.46 1768.5,-5258.46 1768.5,-5302.46"/>
<text text-anchor="middle" x="1630" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L8</text>
<text text-anchor="middle" x="1630" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 261</text>
<text text-anchor="middle" x="1630" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_2&#45;&gt;expert_8_2_1 -->
<g id="edge710" class="edge">
<title>route_8_2&#45;&gt;expert_8_2_1</title>
<path fill="none" stroke="black" d="M1630,-5338.11C1630,-5329.83 1630,-5320.85 1630,-5312.54"/>
<polygon fill="black" stroke="black" points="1633.5,-5312.47 1630,-5302.47 1626.5,-5312.47 1633.5,-5312.47"/>
</g>
<!-- tp_8_2 -->
<g id="node588" class="node">
<title>tp_8_2</title>
<ellipse fill="lightblue" stroke="black" cx="3352" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3352" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L8</text>
<text text-anchor="middle" x="3352" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 260↔261</text>
<text text-anchor="middle" x="3352" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3352" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_2_0&#45;&gt;tp_8_2 -->
<g id="edge711" class="edge">
<title>expert_8_2_0&#45;&gt;tp_8_2</title>
<path fill="none" stroke="black" d="M1473.6,-5259.28C1476.76,-5258.99 1479.9,-5258.72 1483,-5258.46 1869.37,-5227.18 2842.56,-5272.15 3227,-5222.46 3238.67,-5220.96 3250.84,-5218.79 3262.81,-5216.3"/>
<polygon fill="black" stroke="black" points="3263.76,-5219.68 3272.79,-5214.15 3262.28,-5212.84 3263.76,-5219.68"/>
</g>
<!-- expert_8_2_1&#45;&gt;tp_8_2 -->
<g id="edge712" class="edge">
<title>expert_8_2_1&#45;&gt;tp_8_2</title>
<path fill="none" stroke="black" d="M1768.6,-5259.3C1771.76,-5259 1774.9,-5258.72 1778,-5258.46 2419.99,-5205.12 2588.29,-5306.37 3227,-5222.46 3238.67,-5220.93 3250.84,-5218.75 3262.8,-5216.26"/>
<polygon fill="black" stroke="black" points="3263.75,-5219.63 3272.79,-5214.1 3262.27,-5212.79 3263.75,-5219.63"/>
</g>
<!-- tp_8_2&#45;&gt;q_proj_9 -->
<g id="edge1770" class="edge">
<title>tp_8_2&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M3431.56,-5168.63C3446.55,-5165.27 3462.18,-5162.25 3477,-5160.24 3955.35,-5095.43 4083.88,-5163.56 4568.65,-5124.3"/>
<polygon fill="black" stroke="black" points="4569.03,-5127.78 4578.71,-5123.48 4568.46,-5120.81 4569.03,-5127.78"/>
</g>
<!-- tp_8_2&#45;&gt;k_proj_9 -->
<g id="edge1771" class="edge">
<title>tp_8_2&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M3431.21,-5168.62C3446.31,-5165.23 3462.06,-5162.21 3477,-5160.24 4093.85,-5078.97 4258.66,-5172.76 4882.56,-5124.3"/>
<polygon fill="black" stroke="black" points="4883.02,-5127.78 4892.71,-5123.5 4882.47,-5120.8 4883.02,-5127.78"/>
</g>
<!-- tp_8_2&#45;&gt;v_proj_9 -->
<g id="edge1772" class="edge">
<title>tp_8_2&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M3432.28,-5168.82C3447.06,-5165.48 3462.43,-5162.42 3477,-5160.24 3748.14,-5119.65 4067.59,-5107.79 4254.46,-5104.43"/>
<polygon fill="black" stroke="black" points="4254.7,-5107.93 4264.64,-5104.26 4254.58,-5100.93 4254.7,-5107.93"/>
</g>
<!-- expert_8_3_0 -->
<g id="node590" class="node">
<title>expert_8_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-5302.46 1786.5,-5302.46 1786.5,-5258.46 2063.5,-5258.46 2063.5,-5302.46"/>
<text text-anchor="middle" x="1925" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L8</text>
<text text-anchor="middle" x="1925" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 262</text>
<text text-anchor="middle" x="1925" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1925" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_3&#45;&gt;expert_8_3_0 -->
<g id="edge714" class="edge">
<title>route_8_3&#45;&gt;expert_8_3_0</title>
<path fill="none" stroke="black" d="M2129.08,-5341.73C2089.92,-5330.16 2044.49,-5316.75 2006.44,-5305.51"/>
<polygon fill="black" stroke="black" points="2007.01,-5302.03 1996.43,-5302.56 2005.03,-5308.75 2007.01,-5302.03"/>
</g>
<!-- expert_8_3_1 -->
<g id="node591" class="node">
<title>expert_8_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2358.5,-5302.46 2081.5,-5302.46 2081.5,-5258.46 2358.5,-5258.46 2358.5,-5302.46"/>
<text text-anchor="middle" x="2220" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L8</text>
<text text-anchor="middle" x="2220" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 263</text>
<text text-anchor="middle" x="2220" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_3&#45;&gt;expert_8_3_1 -->
<g id="edge715" class="edge">
<title>route_8_3&#45;&gt;expert_8_3_1</title>
<path fill="none" stroke="black" d="M2220,-5338.11C2220,-5329.83 2220,-5320.85 2220,-5312.54"/>
<polygon fill="black" stroke="black" points="2223.5,-5312.47 2220,-5302.47 2216.5,-5312.47 2223.5,-5312.47"/>
</g>
<!-- tp_8_3 -->
<g id="node592" class="node">
<title>tp_8_3</title>
<ellipse fill="lightblue" stroke="black" cx="3602" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3602" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L8</text>
<text text-anchor="middle" x="3602" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 262↔263</text>
<text text-anchor="middle" x="3602" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3602" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_3_0&#45;&gt;tp_8_3 -->
<g id="edge716" class="edge">
<title>expert_8_3_0&#45;&gt;tp_8_3</title>
<path fill="none" stroke="black" d="M2063.6,-5259.3C2066.76,-5259 2069.9,-5258.72 2073,-5258.46 2695.04,-5206.53 2858.14,-5304.01 3477,-5222.46 3488.67,-5220.93 3500.84,-5218.74 3512.8,-5216.25"/>
<polygon fill="black" stroke="black" points="3513.75,-5219.62 3522.79,-5214.09 3512.27,-5212.78 3513.75,-5219.62"/>
</g>
<!-- expert_8_3_1&#45;&gt;tp_8_3 -->
<g id="edge717" class="edge">
<title>expert_8_3_1&#45;&gt;tp_8_3</title>
<path fill="none" stroke="black" d="M2358.6,-5259.33C2361.76,-5259.02 2364.9,-5258.73 2368,-5258.46 2859.3,-5215.76 2988.3,-5288.56 3477,-5222.46 3488.58,-5220.9 3500.65,-5218.71 3512.52,-5216.23"/>
<polygon fill="black" stroke="black" points="3513.41,-5219.62 3522.44,-5214.08 3511.92,-5212.78 3513.41,-5219.62"/>
</g>
<!-- tp_8_3&#45;&gt;q_proj_9 -->
<g id="edge1773" class="edge">
<title>tp_8_3&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M3681.91,-5168.67C3696.8,-5165.33 3712.3,-5162.3 3727,-5160.24 4095.1,-5108.54 4194.69,-5156.28 4568.69,-5124.31"/>
<polygon fill="black" stroke="black" points="4569.05,-5127.79 4578.71,-5123.44 4568.44,-5120.82 4569.05,-5127.79"/>
</g>
<!-- tp_8_3&#45;&gt;k_proj_9 -->
<g id="edge1774" class="edge">
<title>tp_8_3&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M3681.56,-5168.61C3696.55,-5165.25 3712.18,-5162.23 3727,-5160.24 4233.52,-5092.08 4369.47,-5165.42 4882.45,-5124.32"/>
<polygon fill="black" stroke="black" points="4883.03,-5127.78 4892.71,-5123.48 4882.46,-5120.8 4883.03,-5127.78"/>
</g>
<!-- tp_8_3&#45;&gt;v_proj_9 -->
<g id="edge1775" class="edge">
<title>tp_8_3&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M3682.99,-5168.93C3697.57,-5165.62 3712.68,-5162.55 3727,-5160.24 3906.42,-5131.35 4114.75,-5116.67 4254.32,-5109.51"/>
<polygon fill="black" stroke="black" points="4254.86,-5112.99 4264.67,-5108.99 4254.51,-5106 4254.86,-5112.99"/>
</g>
<!-- expert_8_4_0 -->
<g id="node594" class="node">
<title>expert_8_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2653.5,-5302.46 2376.5,-5302.46 2376.5,-5258.46 2653.5,-5258.46 2653.5,-5302.46"/>
<text text-anchor="middle" x="2515" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L8</text>
<text text-anchor="middle" x="2515" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 264</text>
<text text-anchor="middle" x="2515" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2515" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_4&#45;&gt;expert_8_4_0 -->
<g id="edge719" class="edge">
<title>route_8_4&#45;&gt;expert_8_4_0</title>
<path fill="none" stroke="black" d="M2719.08,-5341.73C2679.92,-5330.16 2634.49,-5316.75 2596.44,-5305.51"/>
<polygon fill="black" stroke="black" points="2597.01,-5302.03 2586.43,-5302.56 2595.03,-5308.75 2597.01,-5302.03"/>
</g>
<!-- expert_8_4_1 -->
<g id="node595" class="node">
<title>expert_8_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2948.5,-5302.46 2671.5,-5302.46 2671.5,-5258.46 2948.5,-5258.46 2948.5,-5302.46"/>
<text text-anchor="middle" x="2810" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L8</text>
<text text-anchor="middle" x="2810" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 265</text>
<text text-anchor="middle" x="2810" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_4&#45;&gt;expert_8_4_1 -->
<g id="edge720" class="edge">
<title>route_8_4&#45;&gt;expert_8_4_1</title>
<path fill="none" stroke="black" d="M2810,-5338.11C2810,-5329.83 2810,-5320.85 2810,-5312.54"/>
<polygon fill="black" stroke="black" points="2813.5,-5312.47 2810,-5302.47 2806.5,-5312.47 2813.5,-5312.47"/>
</g>
<!-- tp_8_4 -->
<g id="node596" class="node">
<title>tp_8_4</title>
<ellipse fill="lightblue" stroke="black" cx="3852" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3852" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L8</text>
<text text-anchor="middle" x="3852" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 264↔265</text>
<text text-anchor="middle" x="3852" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3852" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_4_0&#45;&gt;tp_8_4 -->
<g id="edge721" class="edge">
<title>expert_8_4_0&#45;&gt;tp_8_4</title>
<path fill="none" stroke="black" d="M2653.6,-5259.34C2656.76,-5259.03 2659.9,-5258.74 2663,-5258.46 3134.35,-5217.17 3258.15,-5286.2 3727,-5222.46 3738.58,-5220.89 3750.65,-5218.7 3762.52,-5216.21"/>
<polygon fill="black" stroke="black" points="3763.41,-5219.6 3772.44,-5214.06 3761.92,-5212.76 3763.41,-5219.6"/>
</g>
<!-- expert_8_4_1&#45;&gt;tp_8_4 -->
<g id="edge722" class="edge">
<title>expert_8_4_1&#45;&gt;tp_8_4</title>
<path fill="none" stroke="black" d="M2948.6,-5259.39C2951.76,-5259.07 2954.9,-5258.76 2958,-5258.46 3298.65,-5226.4 3388.27,-5270.75 3727,-5222.46 3738.48,-5220.83 3750.45,-5218.62 3762.24,-5216.13"/>
<polygon fill="black" stroke="black" points="3763.06,-5219.53 3772.08,-5213.98 3761.56,-5212.69 3763.06,-5219.53"/>
</g>
<!-- tp_8_4&#45;&gt;q_proj_9 -->
<g id="edge1776" class="edge">
<title>tp_8_4&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M3932.28,-5168.81C3947.06,-5165.48 3962.43,-5162.42 3977,-5160.24 4234.82,-5121.66 4305.41,-5149.04 4568.46,-5124.34"/>
<polygon fill="black" stroke="black" points="4569.08,-5127.8 4578.7,-5123.37 4568.41,-5120.83 4569.08,-5127.8"/>
</g>
<!-- tp_8_4&#45;&gt;k_proj_9 -->
<g id="edge1777" class="edge">
<title>tp_8_4&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M3931.57,-5168.71C3946.56,-5165.34 3962.19,-5162.3 3977,-5160.24 4373.27,-5105.19 4480.3,-5158.13 4882.54,-5124.32"/>
<polygon fill="black" stroke="black" points="4883.04,-5127.79 4892.71,-5123.45 4882.45,-5120.81 4883.04,-5127.79"/>
</g>
<!-- tp_8_4&#45;&gt;v_proj_9 -->
<g id="edge1778" class="edge">
<title>tp_8_4&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M3934.1,-5169.26C3948.35,-5165.98 3963.06,-5162.82 3977,-5160.24 4068.51,-5143.28 4171.75,-5129.55 4254.79,-5119.81"/>
<polygon fill="black" stroke="black" points="4255.28,-5123.28 4264.81,-5118.65 4254.47,-5116.33 4255.28,-5123.28"/>
</g>
<!-- expert_8_5_0 -->
<g id="node598" class="node">
<title>expert_8_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3243.5,-5302.46 2966.5,-5302.46 2966.5,-5258.46 3243.5,-5258.46 3243.5,-5302.46"/>
<text text-anchor="middle" x="3105" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L8</text>
<text text-anchor="middle" x="3105" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 266</text>
<text text-anchor="middle" x="3105" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3105" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_5&#45;&gt;expert_8_5_0 -->
<g id="edge724" class="edge">
<title>route_8_5&#45;&gt;expert_8_5_0</title>
<path fill="none" stroke="black" d="M3309.08,-5341.73C3269.92,-5330.16 3224.49,-5316.75 3186.44,-5305.51"/>
<polygon fill="black" stroke="black" points="3187.01,-5302.03 3176.43,-5302.56 3185.03,-5308.75 3187.01,-5302.03"/>
</g>
<!-- expert_8_5_1 -->
<g id="node599" class="node">
<title>expert_8_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3538.5,-5302.46 3261.5,-5302.46 3261.5,-5258.46 3538.5,-5258.46 3538.5,-5302.46"/>
<text text-anchor="middle" x="3400" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L8</text>
<text text-anchor="middle" x="3400" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 267</text>
<text text-anchor="middle" x="3400" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_5&#45;&gt;expert_8_5_1 -->
<g id="edge725" class="edge">
<title>route_8_5&#45;&gt;expert_8_5_1</title>
<path fill="none" stroke="black" d="M3400,-5338.11C3400,-5329.83 3400,-5320.85 3400,-5312.54"/>
<polygon fill="black" stroke="black" points="3403.5,-5312.47 3400,-5302.47 3396.5,-5312.47 3403.5,-5312.47"/>
</g>
<!-- tp_8_5 -->
<g id="node600" class="node">
<title>tp_8_5</title>
<ellipse fill="lightblue" stroke="black" cx="4102" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4102" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L8</text>
<text text-anchor="middle" x="4102" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 266↔267</text>
<text text-anchor="middle" x="4102" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4102" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_5_0&#45;&gt;tp_8_5 -->
<g id="edge726" class="edge">
<title>expert_8_5_0&#45;&gt;tp_8_5</title>
<path fill="none" stroke="black" d="M3243.61,-5259.41C3246.77,-5259.08 3249.9,-5258.76 3253,-5258.46 3573.71,-5227.8 3658.11,-5268.39 3977,-5222.46 3988.48,-5220.81 4000.45,-5218.59 4012.23,-5216.1"/>
<polygon fill="black" stroke="black" points="4013.05,-5219.5 4022.07,-5213.95 4011.56,-5212.66 4013.05,-5219.5"/>
</g>
<!-- expert_8_5_1&#45;&gt;tp_8_5 -->
<g id="edge727" class="edge">
<title>expert_8_5_1&#45;&gt;tp_8_5</title>
<path fill="none" stroke="black" d="M3538.62,-5259.55C3541.78,-5259.18 3544.91,-5258.81 3548,-5258.46 3738.13,-5237.02 3788.11,-5252.96 3977,-5222.46 3988.08,-5220.68 3999.63,-5218.43 4011.03,-5215.97"/>
<polygon fill="black" stroke="black" points="4012,-5219.34 4021,-5213.76 4010.48,-5212.51 4012,-5219.34"/>
</g>
<!-- tp_8_5&#45;&gt;q_proj_9 -->
<g id="edge1779" class="edge">
<title>tp_8_5&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M4183.37,-5169.11C4197.84,-5165.8 4212.81,-5162.68 4227,-5160.24 4374.81,-5134.79 4416.04,-5142.07 4568.48,-5124.39"/>
<polygon fill="black" stroke="black" points="4569.16,-5127.84 4578.68,-5123.19 4568.34,-5120.88 4569.16,-5127.84"/>
</g>
<!-- tp_8_5&#45;&gt;k_proj_9 -->
<g id="edge1780" class="edge">
<title>tp_8_5&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M4182.27,-5168.74C4197.05,-5165.41 4212.42,-5162.38 4227,-5160.24 4513.1,-5118.3 4591.1,-5150.89 4882.68,-5124.32"/>
<polygon fill="black" stroke="black" points="4883.07,-5127.8 4892.7,-5123.39 4882.42,-5120.83 4883.07,-5127.8"/>
</g>
<!-- tp_8_5&#45;&gt;v_proj_9 -->
<g id="edge1781" class="edge">
<title>tp_8_5&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M4180.48,-5168.37C4225.5,-5155.76 4282.05,-5139.92 4328.1,-5127.02"/>
<polygon fill="black" stroke="black" points="4329.08,-5130.38 4337.77,-5124.31 4327.19,-5123.64 4329.08,-5130.38"/>
</g>
<!-- expert_8_6_0 -->
<g id="node602" class="node">
<title>expert_8_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3833.5,-5302.46 3556.5,-5302.46 3556.5,-5258.46 3833.5,-5258.46 3833.5,-5302.46"/>
<text text-anchor="middle" x="3695" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L8</text>
<text text-anchor="middle" x="3695" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 268</text>
<text text-anchor="middle" x="3695" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3695" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_6&#45;&gt;expert_8_6_0 -->
<g id="edge729" class="edge">
<title>route_8_6&#45;&gt;expert_8_6_0</title>
<path fill="none" stroke="black" d="M3899.08,-5341.73C3859.92,-5330.16 3814.49,-5316.75 3776.44,-5305.51"/>
<polygon fill="black" stroke="black" points="3777.01,-5302.03 3766.43,-5302.56 3775.03,-5308.75 3777.01,-5302.03"/>
</g>
<!-- expert_8_6_1 -->
<g id="node603" class="node">
<title>expert_8_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4128.5,-5302.46 3851.5,-5302.46 3851.5,-5258.46 4128.5,-5258.46 4128.5,-5302.46"/>
<text text-anchor="middle" x="3990" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L8</text>
<text text-anchor="middle" x="3990" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 269</text>
<text text-anchor="middle" x="3990" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_6&#45;&gt;expert_8_6_1 -->
<g id="edge730" class="edge">
<title>route_8_6&#45;&gt;expert_8_6_1</title>
<path fill="none" stroke="black" d="M3990,-5338.11C3990,-5329.83 3990,-5320.85 3990,-5312.54"/>
<polygon fill="black" stroke="black" points="3993.5,-5312.47 3990,-5302.47 3986.5,-5312.47 3993.5,-5312.47"/>
</g>
<!-- tp_8_6 -->
<g id="node604" class="node">
<title>tp_8_6</title>
<ellipse fill="lightblue" stroke="black" cx="4352" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4352" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L8</text>
<text text-anchor="middle" x="4352" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 268↔269</text>
<text text-anchor="middle" x="4352" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4352" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_6_0&#45;&gt;tp_8_6 -->
<g id="edge731" class="edge">
<title>expert_8_6_0&#45;&gt;tp_8_6</title>
<path fill="none" stroke="black" d="M3833.63,-5259.59C3836.78,-5259.2 3839.91,-5258.83 3843,-5258.46 4013.24,-5238.42 4057.91,-5250.61 4227,-5222.46 4238.07,-5220.62 4249.61,-5218.34 4261.02,-5215.87"/>
<polygon fill="black" stroke="black" points="4261.98,-5219.24 4270.98,-5213.65 4260.46,-5212.4 4261.98,-5219.24"/>
</g>
<!-- expert_8_6_1&#45;&gt;tp_8_6 -->
<g id="edge732" class="edge">
<title>expert_8_6_1&#45;&gt;tp_8_6</title>
<path fill="none" stroke="black" d="M4077.51,-5258.43C4122.24,-5247.67 4177.52,-5234.37 4227,-5222.46 4236.87,-5220.09 4247.17,-5217.61 4257.45,-5215.13"/>
<polygon fill="black" stroke="black" points="4258.38,-5218.51 4267.28,-5212.77 4256.74,-5211.7 4258.38,-5218.51"/>
</g>
<!-- tp_8_6&#45;&gt;q_proj_9 -->
<g id="edge1782" class="edge">
<title>tp_8_6&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M4436.35,-5169.88C4449.94,-5166.63 4463.85,-5163.32 4477,-5160.24 4525.15,-5148.95 4578.59,-5136.72 4623.67,-5126.5"/>
<polygon fill="black" stroke="black" points="4624.47,-5129.91 4633.45,-5124.28 4622.92,-5123.08 4624.47,-5129.91"/>
</g>
<!-- tp_8_6&#45;&gt;k_proj_9 -->
<g id="edge1783" class="edge">
<title>tp_8_6&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M4433,-5168.99C4447.58,-5165.68 4462.68,-5162.58 4477,-5160.24 4652.97,-5131.42 4701.76,-5143.81 4882.57,-5124.36"/>
<polygon fill="black" stroke="black" points="4883.13,-5127.82 4892.69,-5123.26 4882.37,-5120.86 4883.13,-5127.82"/>
</g>
<!-- tp_8_6&#45;&gt;v_proj_9 -->
<g id="edge1784" class="edge">
<title>tp_8_6&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M4372.99,-5160.37C4379.26,-5151.42 4386.12,-5141.62 4392.37,-5132.7"/>
<polygon fill="black" stroke="black" points="4395.26,-5134.68 4398.13,-5124.48 4389.52,-5130.66 4395.26,-5134.68"/>
</g>
<!-- expert_8_7_0 -->
<g id="node606" class="node">
<title>expert_8_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4423.5,-5302.46 4146.5,-5302.46 4146.5,-5258.46 4423.5,-5258.46 4423.5,-5302.46"/>
<text text-anchor="middle" x="4285" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L8</text>
<text text-anchor="middle" x="4285" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 270</text>
<text text-anchor="middle" x="4285" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4285" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_7&#45;&gt;expert_8_7_0 -->
<g id="edge734" class="edge">
<title>route_8_7&#45;&gt;expert_8_7_0</title>
<path fill="none" stroke="black" d="M4442.64,-5340.65C4413.11,-5329.57 4379.42,-5316.92 4350.8,-5306.17"/>
<polygon fill="black" stroke="black" points="4351.89,-5302.84 4341.29,-5302.6 4349.43,-5309.39 4351.89,-5302.84"/>
</g>
<!-- expert_8_7_1 -->
<g id="node607" class="node">
<title>expert_8_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4718.5,-5302.46 4441.5,-5302.46 4441.5,-5258.46 4718.5,-5258.46 4718.5,-5302.46"/>
<text text-anchor="middle" x="4580" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L8</text>
<text text-anchor="middle" x="4580" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 271</text>
<text text-anchor="middle" x="4580" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_7&#45;&gt;expert_8_7_1 -->
<g id="edge735" class="edge">
<title>route_8_7&#45;&gt;expert_8_7_1</title>
<path fill="none" stroke="black" d="M4538.68,-5338.6C4545.15,-5329.65 4552.24,-5319.85 4558.69,-5310.93"/>
<polygon fill="black" stroke="black" points="4561.61,-5312.86 4564.64,-5302.7 4555.94,-5308.76 4561.61,-5312.86"/>
</g>
<!-- tp_8_7 -->
<g id="node608" class="node">
<title>tp_8_7</title>
<ellipse fill="lightblue" stroke="black" cx="4602" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4602" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L8</text>
<text text-anchor="middle" x="4602" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 270↔271</text>
<text text-anchor="middle" x="4602" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4602" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_7_0&#45;&gt;tp_8_7 -->
<g id="edge736" class="edge">
<title>expert_8_7_0&#45;&gt;tp_8_7</title>
<path fill="none" stroke="black" d="M4361.74,-5258.38C4407.34,-5245.85 4465.37,-5229.9 4512.98,-5216.82"/>
<polygon fill="black" stroke="black" points="4513.94,-5220.18 4522.66,-5214.15 4512.09,-5213.43 4513.94,-5220.18"/>
</g>
<!-- expert_8_7_1&#45;&gt;tp_8_7 -->
<g id="edge737" class="edge">
<title>expert_8_7_1&#45;&gt;tp_8_7</title>
<path fill="none" stroke="black" d="M4585.33,-5258.38C4587.3,-5250.55 4589.62,-5241.38 4591.88,-5232.42"/>
<polygon fill="black" stroke="black" points="4595.34,-5233.02 4594.4,-5222.46 4588.55,-5231.3 4595.34,-5233.02"/>
</g>
<!-- tp_8_7&#45;&gt;q_proj_9 -->
<g id="edge1785" class="edge">
<title>tp_8_7&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M4642.58,-5162.07C4657.24,-5151.85 4673.74,-5140.35 4688.24,-5130.25"/>
<polygon fill="black" stroke="black" points="4690.32,-5133.07 4696.52,-5124.48 4686.31,-5127.33 4690.32,-5133.07"/>
</g>
<!-- tp_8_7&#45;&gt;k_proj_9 -->
<g id="edge1786" class="edge">
<title>tp_8_7&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M4685.23,-5169.61C4699.14,-5166.34 4713.46,-5163.1 4727,-5160.24 4785.43,-5147.91 4850.31,-5135.86 4905.87,-5126.04"/>
<polygon fill="black" stroke="black" points="4906.53,-5129.47 4915.77,-5124.29 4905.31,-5122.58 4906.53,-5129.47"/>
</g>
<!-- tp_8_7&#45;&gt;v_proj_9 -->
<g id="edge1787" class="edge">
<title>tp_8_7&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M4545.04,-5164.1C4520.67,-5152.86 4492.32,-5139.8 4468.15,-5128.66"/>
<polygon fill="black" stroke="black" points="4469.31,-5125.34 4458.76,-5124.33 4466.38,-5131.7 4469.31,-5125.34"/>
</g>
<!-- expert_8_8_0 -->
<g id="node610" class="node">
<title>expert_8_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5013.5,-5302.46 4736.5,-5302.46 4736.5,-5258.46 5013.5,-5258.46 5013.5,-5302.46"/>
<text text-anchor="middle" x="4875" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L8</text>
<text text-anchor="middle" x="4875" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="4875" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4875" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_8&#45;&gt;expert_8_8_0 -->
<g id="edge739" class="edge">
<title>route_8_8&#45;&gt;expert_8_8_0</title>
<path fill="none" stroke="black" d="M4915.66,-5338.6C4909.29,-5329.65 4902.32,-5319.85 4895.97,-5310.93"/>
<polygon fill="black" stroke="black" points="4898.77,-5308.82 4890.12,-5302.7 4893.06,-5312.88 4898.77,-5308.82"/>
</g>
<!-- expert_8_8_1 -->
<g id="node611" class="node">
<title>expert_8_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5308.5,-5302.46 5031.5,-5302.46 5031.5,-5258.46 5308.5,-5258.46 5308.5,-5302.46"/>
<text text-anchor="middle" x="5170" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L8</text>
<text text-anchor="middle" x="5170" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="5170" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5170" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_8&#45;&gt;expert_8_8_1 -->
<g id="edge740" class="edge">
<title>route_8_8&#45;&gt;expert_8_8_1</title>
<path fill="none" stroke="black" d="M5011.68,-5340.65C5041.34,-5329.57 5075.17,-5316.92 5103.92,-5306.17"/>
<polygon fill="black" stroke="black" points="5105.32,-5309.38 5113.46,-5302.6 5102.87,-5302.83 5105.32,-5309.38"/>
</g>
<!-- tp_8_8 -->
<g id="node612" class="node">
<title>tp_8_8</title>
<ellipse fill="lightblue" stroke="black" cx="4852" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4852" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L8</text>
<text text-anchor="middle" x="4852" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="4852" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4852" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_8_0&#45;&gt;tp_8_8 -->
<g id="edge741" class="edge">
<title>expert_8_8_0&#45;&gt;tp_8_8</title>
<path fill="none" stroke="black" d="M4869.43,-5258.38C4867.37,-5250.55 4864.95,-5241.38 4862.58,-5232.42"/>
<polygon fill="black" stroke="black" points="4865.89,-5231.24 4859.95,-5222.46 4859.12,-5233.03 4865.89,-5231.24"/>
</g>
<!-- expert_8_8_1&#45;&gt;tp_8_8 -->
<g id="edge742" class="edge">
<title>expert_8_8_1&#45;&gt;tp_8_8</title>
<path fill="none" stroke="black" d="M5093.02,-5258.38C5047.19,-5245.82 4988.84,-5229.84 4941.04,-5216.74"/>
<polygon fill="black" stroke="black" points="4941.88,-5213.34 4931.31,-5214.08 4940.03,-5220.1 4941.88,-5213.34"/>
</g>
<!-- tp_8_8&#45;&gt;q_proj_9 -->
<g id="edge1788" class="edge">
<title>tp_8_8&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M4811.42,-5162.07C4796.76,-5151.85 4780.26,-5140.35 4765.76,-5130.25"/>
<polygon fill="black" stroke="black" points="4767.69,-5127.33 4757.48,-5124.48 4763.68,-5133.07 4767.69,-5127.33"/>
</g>
<!-- tp_8_8&#45;&gt;k_proj_9 -->
<g id="edge1789" class="edge">
<title>tp_8_8&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M4908.96,-5164.1C4933.33,-5152.86 4961.68,-5139.8 4985.85,-5128.66"/>
<polygon fill="black" stroke="black" points="4987.62,-5131.7 4995.24,-5124.33 4984.69,-5125.34 4987.62,-5131.7"/>
</g>
<!-- tp_8_8&#45;&gt;v_proj_9 -->
<g id="edge1790" class="edge">
<title>tp_8_8&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M4768.77,-5169.61C4754.86,-5166.34 4740.54,-5163.1 4727,-5160.24 4668.57,-5147.91 4603.69,-5135.86 4548.13,-5126.04"/>
<polygon fill="black" stroke="black" points="4548.69,-5122.58 4538.23,-5124.29 4547.47,-5129.47 4548.69,-5122.58"/>
</g>
<!-- expert_8_9_0 -->
<g id="node614" class="node">
<title>expert_8_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5603.5,-5302.46 5326.5,-5302.46 5326.5,-5258.46 5603.5,-5258.46 5603.5,-5302.46"/>
<text text-anchor="middle" x="5465" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L8</text>
<text text-anchor="middle" x="5465" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 290</text>
<text text-anchor="middle" x="5465" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_9&#45;&gt;expert_8_9_0 -->
<g id="edge744" class="edge">
<title>route_8_9&#45;&gt;expert_8_9_0</title>
<path fill="none" stroke="black" d="M5465,-5338.11C5465,-5329.83 5465,-5320.85 5465,-5312.54"/>
<polygon fill="black" stroke="black" points="5468.5,-5312.47 5465,-5302.47 5461.5,-5312.47 5468.5,-5312.47"/>
</g>
<!-- expert_8_9_1 -->
<g id="node615" class="node">
<title>expert_8_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5898.5,-5302.46 5621.5,-5302.46 5621.5,-5258.46 5898.5,-5258.46 5898.5,-5302.46"/>
<text text-anchor="middle" x="5760" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L8</text>
<text text-anchor="middle" x="5760" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 291</text>
<text text-anchor="middle" x="5760" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5760" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_9&#45;&gt;expert_8_9_1 -->
<g id="edge745" class="edge">
<title>route_8_9&#45;&gt;expert_8_9_1</title>
<path fill="none" stroke="black" d="M5555.92,-5341.73C5595.08,-5330.16 5640.51,-5316.75 5678.56,-5305.51"/>
<polygon fill="black" stroke="black" points="5679.97,-5308.75 5688.57,-5302.56 5677.99,-5302.03 5679.97,-5308.75"/>
</g>
<!-- tp_8_9 -->
<g id="node616" class="node">
<title>tp_8_9</title>
<ellipse fill="lightblue" stroke="black" cx="5102" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5102" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L8</text>
<text text-anchor="middle" x="5102" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 290↔291</text>
<text text-anchor="middle" x="5102" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5102" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_9_0&#45;&gt;tp_8_9 -->
<g id="edge746" class="edge">
<title>expert_8_9_0&#45;&gt;tp_8_9</title>
<path fill="none" stroke="black" d="M5377.11,-5258.45C5332.2,-5247.7 5276.68,-5234.4 5227,-5222.46 5217.05,-5220.07 5206.65,-5217.57 5196.29,-5215.08"/>
<polygon fill="black" stroke="black" points="5196.92,-5211.63 5186.38,-5212.7 5195.28,-5218.44 5196.92,-5211.63"/>
</g>
<!-- expert_8_9_1&#45;&gt;tp_8_9 -->
<g id="edge747" class="edge">
<title>expert_8_9_1&#45;&gt;tp_8_9</title>
<path fill="none" stroke="black" d="M5621.14,-5259.44C5618.4,-5259.11 5615.69,-5258.78 5613,-5258.46 5441.89,-5238.27 5396.97,-5250.71 5227,-5222.46 5215.93,-5220.62 5204.39,-5218.35 5192.98,-5215.87"/>
<polygon fill="black" stroke="black" points="5193.54,-5212.41 5183.01,-5213.65 5192.02,-5219.24 5193.54,-5212.41"/>
</g>
<!-- tp_8_9&#45;&gt;q_proj_9 -->
<g id="edge1791" class="edge">
<title>tp_8_9&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M5017.65,-5169.88C5004.06,-5166.63 4990.15,-5163.32 4977,-5160.24 4928.85,-5148.95 4875.41,-5136.72 4830.33,-5126.5"/>
<polygon fill="black" stroke="black" points="4831.08,-5123.08 4820.55,-5124.28 4829.53,-5129.91 4831.08,-5123.08"/>
</g>
<!-- tp_8_9&#45;&gt;k_proj_9 -->
<g id="edge1792" class="edge">
<title>tp_8_9&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M5081.01,-5160.37C5074.74,-5151.42 5067.88,-5141.62 5061.63,-5132.7"/>
<polygon fill="black" stroke="black" points="5064.48,-5130.66 5055.87,-5124.48 5058.74,-5134.68 5064.48,-5130.66"/>
</g>
<!-- tp_8_9&#45;&gt;v_proj_9 -->
<g id="edge1793" class="edge">
<title>tp_8_9&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M5021,-5168.99C5006.42,-5165.68 4991.32,-5162.58 4977,-5160.24 4801.03,-5131.42 4752.24,-5143.81 4571.43,-5124.36"/>
<polygon fill="black" stroke="black" points="4571.63,-5120.86 4561.31,-5123.26 4570.87,-5127.82 4571.63,-5120.86"/>
</g>
<!-- expert_8_10_0 -->
<g id="node618" class="node">
<title>expert_8_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6193.5,-5302.46 5916.5,-5302.46 5916.5,-5258.46 6193.5,-5258.46 6193.5,-5302.46"/>
<text text-anchor="middle" x="6055" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L8</text>
<text text-anchor="middle" x="6055" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 292</text>
<text text-anchor="middle" x="6055" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_10&#45;&gt;expert_8_10_0 -->
<g id="edge749" class="edge">
<title>route_8_10&#45;&gt;expert_8_10_0</title>
<path fill="none" stroke="black" d="M6055,-5338.11C6055,-5329.83 6055,-5320.85 6055,-5312.54"/>
<polygon fill="black" stroke="black" points="6058.5,-5312.47 6055,-5302.47 6051.5,-5312.47 6058.5,-5312.47"/>
</g>
<!-- expert_8_10_1 -->
<g id="node619" class="node">
<title>expert_8_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-5302.46 6211.5,-5302.46 6211.5,-5258.46 6488.5,-5258.46 6488.5,-5302.46"/>
<text text-anchor="middle" x="6350" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L8</text>
<text text-anchor="middle" x="6350" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 293</text>
<text text-anchor="middle" x="6350" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6350" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_10&#45;&gt;expert_8_10_1 -->
<g id="edge750" class="edge">
<title>route_8_10&#45;&gt;expert_8_10_1</title>
<path fill="none" stroke="black" d="M6145.92,-5341.73C6185.08,-5330.16 6230.51,-5316.75 6268.56,-5305.51"/>
<polygon fill="black" stroke="black" points="6269.97,-5308.75 6278.57,-5302.56 6267.99,-5302.03 6269.97,-5308.75"/>
</g>
<!-- tp_8_10 -->
<g id="node620" class="node">
<title>tp_8_10</title>
<ellipse fill="lightblue" stroke="black" cx="5352" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5352" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L8</text>
<text text-anchor="middle" x="5352" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 292↔293</text>
<text text-anchor="middle" x="5352" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5352" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_10_0&#45;&gt;tp_8_10 -->
<g id="edge751" class="edge">
<title>expert_8_10_0&#45;&gt;tp_8_10</title>
<path fill="none" stroke="black" d="M5916.14,-5259.41C5913.41,-5259.08 5910.69,-5258.77 5908,-5258.46 5717,-5236.86 5666.77,-5253.06 5477,-5222.46 5465.92,-5220.68 5454.37,-5218.43 5442.97,-5215.98"/>
<polygon fill="black" stroke="black" points="5443.52,-5212.51 5433,-5213.77 5442,-5219.35 5443.52,-5212.51"/>
</g>
<!-- expert_8_10_1&#45;&gt;tp_8_10 -->
<g id="edge752" class="edge">
<title>expert_8_10_1&#45;&gt;tp_8_10</title>
<path fill="none" stroke="black" d="M6211.16,-5259.28C6208.42,-5259 6205.69,-5258.72 6203,-5258.46 5881.42,-5227.59 5796.77,-5268.5 5477,-5222.46 5465.52,-5220.81 5453.55,-5218.59 5441.77,-5216.1"/>
<polygon fill="black" stroke="black" points="5442.44,-5212.66 5431.93,-5213.95 5440.95,-5219.5 5442.44,-5212.66"/>
</g>
<!-- tp_8_10&#45;&gt;q_proj_9 -->
<g id="edge1794" class="edge">
<title>tp_8_10&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M5270.63,-5169.11C5256.16,-5165.8 5241.19,-5162.68 5227,-5160.24 5079.19,-5134.79 5037.96,-5142.07 4885.52,-5124.39"/>
<polygon fill="black" stroke="black" points="4885.66,-5120.88 4875.32,-5123.19 4884.84,-5127.84 4885.66,-5120.88"/>
</g>
<!-- tp_8_10&#45;&gt;k_proj_9 -->
<g id="edge1795" class="edge">
<title>tp_8_10&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M5273.52,-5168.37C5228.5,-5155.76 5171.95,-5139.92 5125.9,-5127.02"/>
<polygon fill="black" stroke="black" points="5126.81,-5123.64 5116.23,-5124.31 5124.92,-5130.38 5126.81,-5123.64"/>
</g>
<!-- tp_8_10&#45;&gt;v_proj_9 -->
<g id="edge1796" class="edge">
<title>tp_8_10&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M5271.73,-5168.74C5256.95,-5165.41 5241.58,-5162.38 5227,-5160.24 4940.9,-5118.3 4862.9,-5150.89 4571.32,-5124.32"/>
<polygon fill="black" stroke="black" points="4571.58,-5120.83 4561.3,-5123.39 4570.93,-5127.8 4571.58,-5120.83"/>
</g>
<!-- expert_8_11_0 -->
<g id="node622" class="node">
<title>expert_8_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6783.5,-5302.46 6506.5,-5302.46 6506.5,-5258.46 6783.5,-5258.46 6783.5,-5302.46"/>
<text text-anchor="middle" x="6645" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L8</text>
<text text-anchor="middle" x="6645" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 294</text>
<text text-anchor="middle" x="6645" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_11&#45;&gt;expert_8_11_0 -->
<g id="edge754" class="edge">
<title>route_8_11&#45;&gt;expert_8_11_0</title>
<path fill="none" stroke="black" d="M6645,-5338.11C6645,-5329.83 6645,-5320.85 6645,-5312.54"/>
<polygon fill="black" stroke="black" points="6648.5,-5312.47 6645,-5302.47 6641.5,-5312.47 6648.5,-5312.47"/>
</g>
<!-- expert_8_11_1 -->
<g id="node623" class="node">
<title>expert_8_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-5302.46 6801.5,-5302.46 6801.5,-5258.46 7078.5,-5258.46 7078.5,-5302.46"/>
<text text-anchor="middle" x="6940" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L8</text>
<text text-anchor="middle" x="6940" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 295</text>
<text text-anchor="middle" x="6940" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6940" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_11&#45;&gt;expert_8_11_1 -->
<g id="edge755" class="edge">
<title>route_8_11&#45;&gt;expert_8_11_1</title>
<path fill="none" stroke="black" d="M6735.92,-5341.73C6775.08,-5330.16 6820.51,-5316.75 6858.56,-5305.51"/>
<polygon fill="black" stroke="black" points="6859.97,-5308.75 6868.57,-5302.56 6857.99,-5302.03 6859.97,-5308.75"/>
</g>
<!-- tp_8_11 -->
<g id="node624" class="node">
<title>tp_8_11</title>
<ellipse fill="lightblue" stroke="black" cx="5602" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5602" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L8</text>
<text text-anchor="middle" x="5602" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 294↔295</text>
<text text-anchor="middle" x="5602" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5602" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_11_0&#45;&gt;tp_8_11 -->
<g id="edge756" class="edge">
<title>expert_8_11_0&#45;&gt;tp_8_11</title>
<path fill="none" stroke="black" d="M6506.16,-5259.27C6503.42,-5258.99 6500.69,-5258.72 6498,-5258.46 6156.48,-5226.17 6066.61,-5270.85 5727,-5222.46 5715.52,-5220.83 5703.55,-5218.62 5691.76,-5216.13"/>
<polygon fill="black" stroke="black" points="5692.44,-5212.69 5681.92,-5213.98 5690.94,-5219.53 5692.44,-5212.69"/>
</g>
<!-- expert_8_11_1&#45;&gt;tp_8_11 -->
<g id="edge757" class="edge">
<title>expert_8_11_1&#45;&gt;tp_8_11</title>
<path fill="none" stroke="black" d="M6801.16,-5259.22C6798.42,-5258.95 6795.7,-5258.7 6793,-5258.46 6320.78,-5216.88 6196.73,-5286.3 5727,-5222.46 5715.42,-5220.89 5703.35,-5218.7 5691.48,-5216.21"/>
<polygon fill="black" stroke="black" points="5692.08,-5212.76 5681.56,-5214.06 5690.59,-5219.6 5692.08,-5212.76"/>
</g>
<!-- tp_8_11&#45;&gt;q_proj_9 -->
<g id="edge1797" class="edge">
<title>tp_8_11&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M5521.72,-5168.81C5506.94,-5165.48 5491.57,-5162.42 5477,-5160.24 5219.18,-5121.66 5148.59,-5149.04 4885.54,-5124.34"/>
<polygon fill="black" stroke="black" points="4885.59,-5120.83 4875.3,-5123.37 4884.92,-5127.8 4885.59,-5120.83"/>
</g>
<!-- tp_8_11&#45;&gt;k_proj_9 -->
<g id="edge1798" class="edge">
<title>tp_8_11&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M5519.9,-5169.26C5505.65,-5165.98 5490.94,-5162.82 5477,-5160.24 5385.49,-5143.28 5282.25,-5129.55 5199.21,-5119.81"/>
<polygon fill="black" stroke="black" points="5199.53,-5116.33 5189.19,-5118.65 5198.72,-5123.28 5199.53,-5116.33"/>
</g>
<!-- tp_8_11&#45;&gt;v_proj_9 -->
<g id="edge1799" class="edge">
<title>tp_8_11&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M5522.43,-5168.71C5507.44,-5165.34 5491.81,-5162.3 5477,-5160.24 5080.73,-5105.19 4973.7,-5158.13 4571.46,-5124.32"/>
<polygon fill="black" stroke="black" points="4571.55,-5120.81 4561.29,-5123.45 4570.96,-5127.79 4571.55,-5120.81"/>
</g>
<!-- expert_8_12_0 -->
<g id="node626" class="node">
<title>expert_8_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7373.5,-5302.46 7096.5,-5302.46 7096.5,-5258.46 7373.5,-5258.46 7373.5,-5302.46"/>
<text text-anchor="middle" x="7235" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L8</text>
<text text-anchor="middle" x="7235" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 296</text>
<text text-anchor="middle" x="7235" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_12&#45;&gt;expert_8_12_0 -->
<g id="edge759" class="edge">
<title>route_8_12&#45;&gt;expert_8_12_0</title>
<path fill="none" stroke="black" d="M7235,-5338.11C7235,-5329.83 7235,-5320.85 7235,-5312.54"/>
<polygon fill="black" stroke="black" points="7238.5,-5312.47 7235,-5302.47 7231.5,-5312.47 7238.5,-5312.47"/>
</g>
<!-- expert_8_12_1 -->
<g id="node627" class="node">
<title>expert_8_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7668.5,-5302.46 7391.5,-5302.46 7391.5,-5258.46 7668.5,-5258.46 7668.5,-5302.46"/>
<text text-anchor="middle" x="7530" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L8</text>
<text text-anchor="middle" x="7530" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 297</text>
<text text-anchor="middle" x="7530" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7530" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_12&#45;&gt;expert_8_12_1 -->
<g id="edge760" class="edge">
<title>route_8_12&#45;&gt;expert_8_12_1</title>
<path fill="none" stroke="black" d="M7325.92,-5341.73C7365.08,-5330.16 7410.51,-5316.75 7448.56,-5305.51"/>
<polygon fill="black" stroke="black" points="7449.97,-5308.75 7458.57,-5302.56 7447.99,-5302.03 7449.97,-5308.75"/>
</g>
<!-- tp_8_12 -->
<g id="node628" class="node">
<title>tp_8_12</title>
<ellipse fill="lightblue" stroke="black" cx="5852" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5852" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L8</text>
<text text-anchor="middle" x="5852" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 296↔297</text>
<text text-anchor="middle" x="5852" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5852" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_12_0&#45;&gt;tp_8_12 -->
<g id="edge761" class="edge">
<title>expert_8_12_0&#45;&gt;tp_8_12</title>
<path fill="none" stroke="black" d="M7096.16,-5259.22C7093.42,-5258.95 7090.7,-5258.7 7088,-5258.46 6595.84,-5215.47 6466.58,-5288.66 5977,-5222.46 5965.42,-5220.9 5953.35,-5218.71 5941.48,-5216.23"/>
<polygon fill="black" stroke="black" points="5942.08,-5212.78 5931.56,-5214.08 5940.59,-5219.62 5942.08,-5212.78"/>
</g>
<!-- expert_8_12_1&#45;&gt;tp_8_12 -->
<g id="edge762" class="edge">
<title>expert_8_12_1&#45;&gt;tp_8_12</title>
<path fill="none" stroke="black" d="M7391.16,-5259.19C7388.42,-5258.93 7385.7,-5258.69 7383,-5258.46 6760.1,-5206.18 6596.74,-5304.12 5977,-5222.46 5965.33,-5220.93 5953.16,-5218.74 5941.2,-5216.25"/>
<polygon fill="black" stroke="black" points="5941.73,-5212.78 5931.21,-5214.09 5940.25,-5219.62 5941.73,-5212.78"/>
</g>
<!-- tp_8_12&#45;&gt;q_proj_9 -->
<g id="edge1800" class="edge">
<title>tp_8_12&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M5772.09,-5168.67C5757.2,-5165.33 5741.7,-5162.3 5727,-5160.24 5358.9,-5108.54 5259.31,-5156.28 4885.31,-5124.31"/>
<polygon fill="black" stroke="black" points="4885.56,-5120.82 4875.29,-5123.44 4884.95,-5127.79 4885.56,-5120.82"/>
</g>
<!-- tp_8_12&#45;&gt;k_proj_9 -->
<g id="edge1801" class="edge">
<title>tp_8_12&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M5771.01,-5168.93C5756.43,-5165.62 5741.32,-5162.55 5727,-5160.24 5547.58,-5131.35 5339.25,-5116.67 5199.68,-5109.51"/>
<polygon fill="black" stroke="black" points="5199.49,-5106 5189.33,-5108.99 5199.14,-5112.99 5199.49,-5106"/>
</g>
<!-- tp_8_12&#45;&gt;v_proj_9 -->
<g id="edge1802" class="edge">
<title>tp_8_12&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M5772.44,-5168.61C5757.45,-5165.25 5741.82,-5162.23 5727,-5160.24 5220.48,-5092.08 5084.53,-5165.42 4571.55,-5124.32"/>
<polygon fill="black" stroke="black" points="4571.54,-5120.8 4561.29,-5123.48 4570.97,-5127.78 4571.54,-5120.8"/>
</g>
<!-- expert_8_13_0 -->
<g id="node630" class="node">
<title>expert_8_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7963.5,-5302.46 7686.5,-5302.46 7686.5,-5258.46 7963.5,-5258.46 7963.5,-5302.46"/>
<text text-anchor="middle" x="7825" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L8</text>
<text text-anchor="middle" x="7825" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 298</text>
<text text-anchor="middle" x="7825" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_13&#45;&gt;expert_8_13_0 -->
<g id="edge764" class="edge">
<title>route_8_13&#45;&gt;expert_8_13_0</title>
<path fill="none" stroke="black" d="M7825,-5338.11C7825,-5329.83 7825,-5320.85 7825,-5312.54"/>
<polygon fill="black" stroke="black" points="7828.5,-5312.47 7825,-5302.47 7821.5,-5312.47 7828.5,-5312.47"/>
</g>
<!-- expert_8_13_1 -->
<g id="node631" class="node">
<title>expert_8_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8258.5,-5302.46 7981.5,-5302.46 7981.5,-5258.46 8258.5,-5258.46 8258.5,-5302.46"/>
<text text-anchor="middle" x="8120" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L8</text>
<text text-anchor="middle" x="8120" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 299</text>
<text text-anchor="middle" x="8120" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8120" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_13&#45;&gt;expert_8_13_1 -->
<g id="edge765" class="edge">
<title>route_8_13&#45;&gt;expert_8_13_1</title>
<path fill="none" stroke="black" d="M7915.92,-5341.73C7955.08,-5330.16 8000.51,-5316.75 8038.56,-5305.51"/>
<polygon fill="black" stroke="black" points="8039.97,-5308.75 8048.57,-5302.56 8037.99,-5302.03 8039.97,-5308.75"/>
</g>
<!-- tp_8_13 -->
<g id="node632" class="node">
<title>tp_8_13</title>
<ellipse fill="lightblue" stroke="black" cx="6102" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6102" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L8</text>
<text text-anchor="middle" x="6102" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 298↔299</text>
<text text-anchor="middle" x="6102" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6102" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_13_0&#45;&gt;tp_8_13 -->
<g id="edge766" class="edge">
<title>expert_8_13_0&#45;&gt;tp_8_13</title>
<path fill="none" stroke="black" d="M7686.16,-5259.19C7683.42,-5258.93 7680.7,-5258.69 7678,-5258.46 7035.15,-5204.76 6866.59,-5306.47 6227,-5222.46 6215.33,-5220.93 6203.16,-5218.75 6191.2,-5216.26"/>
<polygon fill="black" stroke="black" points="6191.73,-5212.79 6181.21,-5214.1 6190.25,-5219.63 6191.73,-5212.79"/>
</g>
<!-- expert_8_13_1&#45;&gt;tp_8_13 -->
<g id="edge767" class="edge">
<title>expert_8_13_1&#45;&gt;tp_8_13</title>
<path fill="none" stroke="black" d="M7981.17,-5259.17C7978.42,-5258.92 7975.7,-5258.68 7973,-5258.46 7586.2,-5226.96 6611.88,-5272.2 6227,-5222.46 6215.33,-5220.96 6203.16,-5218.79 6191.19,-5216.3"/>
<polygon fill="black" stroke="black" points="6191.72,-5212.84 6181.21,-5214.15 6190.24,-5219.68 6191.72,-5212.84"/>
</g>
<!-- tp_8_13&#45;&gt;q_proj_9 -->
<g id="edge1803" class="edge">
<title>tp_8_13&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M6022.44,-5168.63C6007.45,-5165.27 5991.82,-5162.25 5977,-5160.24 5498.65,-5095.43 5370.12,-5163.56 4885.35,-5124.3"/>
<polygon fill="black" stroke="black" points="4885.54,-5120.81 4875.29,-5123.48 4884.97,-5127.78 4885.54,-5120.81"/>
</g>
<!-- tp_8_13&#45;&gt;k_proj_9 -->
<g id="edge1804" class="edge">
<title>tp_8_13&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M6021.72,-5168.82C6006.94,-5165.48 5991.57,-5162.42 5977,-5160.24 5705.86,-5119.65 5386.41,-5107.79 5199.54,-5104.43"/>
<polygon fill="black" stroke="black" points="5199.42,-5100.93 5189.36,-5104.26 5199.3,-5107.93 5199.42,-5100.93"/>
</g>
<!-- tp_8_13&#45;&gt;v_proj_9 -->
<g id="edge1805" class="edge">
<title>tp_8_13&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M6022.79,-5168.62C6007.69,-5165.23 5991.94,-5162.21 5977,-5160.24 5360.15,-5078.97 5195.34,-5172.76 4571.44,-5124.3"/>
<polygon fill="black" stroke="black" points="4571.53,-5120.8 4561.29,-5123.5 4570.98,-5127.78 4571.53,-5120.8"/>
</g>
<!-- expert_8_14_0 -->
<g id="node634" class="node">
<title>expert_8_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8553.5,-5302.46 8276.5,-5302.46 8276.5,-5258.46 8553.5,-5258.46 8553.5,-5302.46"/>
<text text-anchor="middle" x="8415" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L8</text>
<text text-anchor="middle" x="8415" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 300</text>
<text text-anchor="middle" x="8415" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_14&#45;&gt;expert_8_14_0 -->
<g id="edge769" class="edge">
<title>route_8_14&#45;&gt;expert_8_14_0</title>
<path fill="none" stroke="black" d="M8415,-5338.11C8415,-5329.83 8415,-5320.85 8415,-5312.54"/>
<polygon fill="black" stroke="black" points="8418.5,-5312.47 8415,-5302.47 8411.5,-5312.47 8418.5,-5312.47"/>
</g>
<!-- expert_8_14_1 -->
<g id="node635" class="node">
<title>expert_8_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8848.5,-5302.46 8571.5,-5302.46 8571.5,-5258.46 8848.5,-5258.46 8848.5,-5302.46"/>
<text text-anchor="middle" x="8710" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L8</text>
<text text-anchor="middle" x="8710" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 301</text>
<text text-anchor="middle" x="8710" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8710" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_14&#45;&gt;expert_8_14_1 -->
<g id="edge770" class="edge">
<title>route_8_14&#45;&gt;expert_8_14_1</title>
<path fill="none" stroke="black" d="M8505.92,-5341.73C8545.08,-5330.16 8590.51,-5316.75 8628.56,-5305.51"/>
<polygon fill="black" stroke="black" points="8629.97,-5308.75 8638.57,-5302.56 8627.99,-5302.03 8629.97,-5308.75"/>
</g>
<!-- tp_8_14 -->
<g id="node636" class="node">
<title>tp_8_14</title>
<ellipse fill="lightblue" stroke="black" cx="6352" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6352" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L8</text>
<text text-anchor="middle" x="6352" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 300↔301</text>
<text text-anchor="middle" x="6352" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6352" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_14_0&#45;&gt;tp_8_14 -->
<g id="edge771" class="edge">
<title>expert_8_14_0&#45;&gt;tp_8_14</title>
<path fill="none" stroke="black" d="M8276.17,-5259.17C8273.42,-5258.92 8270.7,-5258.68 8268,-5258.46 7871.22,-5226.26 6871.81,-5273.38 6477,-5222.46 6465.33,-5220.96 6453.16,-5218.8 6441.19,-5216.31"/>
<polygon fill="black" stroke="black" points="6441.72,-5212.84 6431.21,-5214.15 6440.24,-5219.69 6441.72,-5212.84"/>
</g>
<!-- expert_8_14_1&#45;&gt;tp_8_14 -->
<g id="edge772" class="edge">
<title>expert_8_14_1&#45;&gt;tp_8_14</title>
<path fill="none" stroke="black" d="M8571.17,-5259.16C8568.42,-5258.91 8565.7,-5258.68 8563,-5258.46 8100.84,-5221.61 6936.9,-5281.11 6477,-5222.46 6465.32,-5220.98 6453.15,-5218.82 6441.19,-5216.34"/>
<polygon fill="black" stroke="black" points="6441.71,-5212.87 6431.2,-5214.19 6440.24,-5219.72 6441.71,-5212.87"/>
</g>
<!-- tp_8_14&#45;&gt;q_proj_9 -->
<g id="edge1806" class="edge">
<title>tp_8_14&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M6272.45,-5168.56C6257.45,-5165.2 6241.83,-5162.2 6227,-5160.24 5638.38,-5082.33 5480.96,-5170.88 4885.42,-5124.3"/>
<polygon fill="black" stroke="black" points="4885.53,-5120.8 4875.29,-5123.5 4884.98,-5127.78 4885.53,-5120.8"/>
</g>
<!-- tp_8_14&#45;&gt;k_proj_9 -->
<g id="edge1807" class="edge">
<title>tp_8_14&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M6272.08,-5168.74C6257.19,-5165.39 6241.69,-5162.34 6227,-5160.24 6033.37,-5132.52 5475.04,-5114.57 5199.15,-5107.14"/>
<polygon fill="black" stroke="black" points="5199.14,-5103.64 5189.05,-5106.87 5198.95,-5110.64 5199.14,-5103.64"/>
</g>
<!-- tp_8_14&#45;&gt;v_proj_9 -->
<g id="edge1808" class="edge">
<title>tp_8_14&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M6272.79,-5168.57C6257.7,-5165.19 6241.94,-5162.18 6227,-5160.24 5864.96,-5113.25 4953.42,-5152 4571.33,-5124.27"/>
<polygon fill="black" stroke="black" points="4571.52,-5120.78 4561.29,-5123.52 4571,-5127.76 4571.52,-5120.78"/>
</g>
<!-- expert_8_15_0 -->
<g id="node638" class="node">
<title>expert_8_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9143.5,-5302.46 8866.5,-5302.46 8866.5,-5258.46 9143.5,-5258.46 9143.5,-5302.46"/>
<text text-anchor="middle" x="9005" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L8</text>
<text text-anchor="middle" x="9005" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 302</text>
<text text-anchor="middle" x="9005" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_15&#45;&gt;expert_8_15_0 -->
<g id="edge774" class="edge">
<title>route_8_15&#45;&gt;expert_8_15_0</title>
<path fill="none" stroke="black" d="M9005,-5338.11C9005,-5329.83 9005,-5320.85 9005,-5312.54"/>
<polygon fill="black" stroke="black" points="9008.5,-5312.47 9005,-5302.47 9001.5,-5312.47 9008.5,-5312.47"/>
</g>
<!-- expert_8_15_1 -->
<g id="node639" class="node">
<title>expert_8_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9438.5,-5302.46 9161.5,-5302.46 9161.5,-5258.46 9438.5,-5258.46 9438.5,-5302.46"/>
<text text-anchor="middle" x="9300" y="-5293.26" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L8</text>
<text text-anchor="middle" x="9300" y="-5283.26" font-family="Times,serif" font-size="9.00">GPU: 303</text>
<text text-anchor="middle" x="9300" y="-5273.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9300" y="-5263.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_15&#45;&gt;expert_8_15_1 -->
<g id="edge775" class="edge">
<title>route_8_15&#45;&gt;expert_8_15_1</title>
<path fill="none" stroke="black" d="M9095.92,-5341.73C9135.08,-5330.16 9180.51,-5316.75 9218.56,-5305.51"/>
<polygon fill="black" stroke="black" points="9219.97,-5308.75 9228.57,-5302.56 9217.99,-5302.03 9219.97,-5308.75"/>
</g>
<!-- tp_8_15 -->
<g id="node640" class="node">
<title>tp_8_15</title>
<ellipse fill="lightblue" stroke="black" cx="6602" cy="-5191.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6602" y="-5204.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L8</text>
<text text-anchor="middle" x="6602" y="-5194.15" font-family="Times,serif" font-size="9.00">GPU: 302↔303</text>
<text text-anchor="middle" x="6602" y="-5184.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6602" y="-5174.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_15_0&#45;&gt;tp_8_15 -->
<g id="edge776" class="edge">
<title>expert_8_15_0&#45;&gt;tp_8_15</title>
<path fill="none" stroke="black" d="M8866.16,-5259.21C8863.42,-5258.94 8860.7,-5258.7 8858,-5258.46 8439.38,-5222.54 7138.95,-5200.41 6727.89,-5194.17"/>
<polygon fill="black" stroke="black" points="6727.8,-5190.67 6717.75,-5194.02 6727.7,-5197.67 6727.8,-5190.67"/>
</g>
<!-- expert_8_15_1&#45;&gt;tp_8_15 -->
<g id="edge777" class="edge">
<title>expert_8_15_1&#45;&gt;tp_8_15</title>
<path fill="none" stroke="black" d="M9161.16,-5259.19C9158.42,-5258.93 9155.7,-5258.69 9153,-5258.46 8673.93,-5218.17 7173.66,-5198.68 6728.03,-5193.68"/>
<polygon fill="black" stroke="black" points="6728.05,-5190.18 6718.02,-5193.57 6727.98,-5197.18 6728.05,-5190.18"/>
</g>
<!-- tp_8_15&#45;&gt;q_proj_9 -->
<g id="edge1809" class="edge">
<title>tp_8_15&#45;&gt;q_proj_9</title>
<path fill="none" stroke="black" d="M6522.79,-5168.58C6507.69,-5165.2 6491.94,-5162.18 6477,-5160.24 6129.13,-5114.94 5253.47,-5151.07 4885.49,-5124.29"/>
<polygon fill="black" stroke="black" points="4885.52,-5120.78 4875.29,-5123.52 4885,-5127.76 4885.52,-5120.78"/>
</g>
<!-- tp_8_15&#45;&gt;k_proj_9 -->
<g id="edge1810" class="edge">
<title>tp_8_15&#45;&gt;k_proj_9</title>
<path fill="none" stroke="black" d="M6522.43,-5168.71C6507.44,-5165.34 6491.81,-5162.3 6477,-5160.24 6234.51,-5126.55 5519.94,-5111.02 5199.56,-5105.6"/>
<polygon fill="black" stroke="black" points="5199.32,-5102.1 5189.27,-5105.43 5199.21,-5109.09 5199.32,-5102.1"/>
</g>
<!-- tp_8_15&#45;&gt;v_proj_9 -->
<g id="edge1811" class="edge">
<title>tp_8_15&#45;&gt;v_proj_9</title>
<path fill="none" stroke="black" d="M6522.8,-5168.53C6507.7,-5165.16 6491.94,-5162.16 6477,-5160.24 6059.88,-5106.71 5009.22,-5155.61 4571.51,-5124.29"/>
<polygon fill="black" stroke="black" points="4571.52,-5120.78 4561.29,-5123.53 4571,-5127.76 4571.52,-5120.78"/>
</g>
<!-- attn_scores_9 -->
<g id="node644" class="node">
<title>attn_scores_9</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-5044.24 4560.5,-5044.24 4560.5,-5000.24 4893.5,-5000.24 4893.5,-5044.24"/>
<text text-anchor="middle" x="4727" y="-5035.04" font-family="Times,serif" font-size="9.00">Attention Scores L9</text>
<text text-anchor="middle" x="4727" y="-5025.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4727" y="-5015.04" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-5005.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_9&#45;&gt;attn_scores_9 -->
<g id="edge778" class="edge">
<title>q_proj_9&#45;&gt;attn_scores_9</title>
<path fill="none" stroke="black" d="M4727,-5079.92C4727,-5072.04 4727,-5062.92 4727,-5054.34"/>
<polygon fill="black" stroke="black" points="4730.5,-5054.26 4727,-5044.26 4723.5,-5054.26 4730.5,-5054.26"/>
</g>
<!-- k_proj_9&#45;&gt;attn_scores_9 -->
<g id="edge779" class="edge">
<title>k_proj_9&#45;&gt;attn_scores_9</title>
<path fill="none" stroke="black" d="M4956.44,-5080.23C4914.82,-5069.89 4864.49,-5057.39 4821.59,-5046.74"/>
<polygon fill="black" stroke="black" points="4822.26,-5043.3 4811.71,-5044.28 4820.57,-5050.09 4822.26,-5043.3"/>
</g>
<!-- v_proj_9&#45;&gt;attn_scores_9 -->
<g id="edge780" class="edge">
<title>v_proj_9&#45;&gt;attn_scores_9</title>
<path fill="none" stroke="black" d="M4497.56,-5080.23C4539.18,-5069.89 4589.51,-5057.39 4632.41,-5046.74"/>
<polygon fill="black" stroke="black" points="4633.43,-5050.09 4642.29,-5044.28 4631.74,-5043.3 4633.43,-5050.09"/>
</g>
<!-- softmax_9 -->
<g id="node645" class="node">
<title>softmax_9</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-4964.24 4560.5,-4964.24 4560.5,-4920.24 4893.5,-4920.24 4893.5,-4964.24"/>
<text text-anchor="middle" x="4727" y="-4955.04" font-family="Times,serif" font-size="9.00">Softmax L9</text>
<text text-anchor="middle" x="4727" y="-4945.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4727" y="-4935.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4727" y="-4925.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_9&#45;&gt;softmax_9 -->
<g id="edge781" class="edge">
<title>attn_scores_9&#45;&gt;softmax_9</title>
<path fill="none" stroke="black" d="M4727,-4999.92C4727,-4992.04 4727,-4982.92 4727,-4974.34"/>
<polygon fill="black" stroke="black" points="4730.5,-4974.26 4727,-4964.26 4723.5,-4974.26 4730.5,-4974.26"/>
</g>
<!-- attn_out_9 -->
<g id="node646" class="node">
<title>attn_out_9</title>
<polygon fill="lightgreen" stroke="black" points="4875,-4884.24 4579,-4884.24 4579,-4840.24 4875,-4840.24 4875,-4884.24"/>
<text text-anchor="middle" x="4727" y="-4875.04" font-family="Times,serif" font-size="9.00">Attention Output L9</text>
<text text-anchor="middle" x="4727" y="-4865.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="4727" y="-4855.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-4845.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_9&#45;&gt;attn_out_9 -->
<g id="edge782" class="edge">
<title>softmax_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M4727,-4919.92C4727,-4912.04 4727,-4902.92 4727,-4894.34"/>
<polygon fill="black" stroke="black" points="4730.5,-4894.26 4727,-4884.26 4723.5,-4894.26 4730.5,-4894.26"/>
</g>
<!-- gate_9 -->
<g id="node647" class="node">
<title>gate_9</title>
<polygon fill="lightyellow" stroke="black" points="5026.74,-4804.24 4549.92,-4804.24 4427.26,-4716.24 4904.08,-4716.24 5026.74,-4804.24"/>
<text text-anchor="middle" x="4727" y="-4773.04" font-family="Times,serif" font-size="9.00">Gate L9</text>
<text text-anchor="middle" x="4727" y="-4763.04" font-family="Times,serif" font-size="9.00">GPU: 256&#45;319</text>
<text text-anchor="middle" x="4727" y="-4753.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-4743.04" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_9&#45;&gt;gate_9 -->
<g id="edge783" class="edge">
<title>attn_out_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M4727,-4840.03C4727,-4832.53 4727,-4823.73 4727,-4814.76"/>
<polygon fill="black" stroke="black" points="4730.5,-4814.65 4727,-4804.65 4723.5,-4814.65 4730.5,-4814.65"/>
</g>
<!-- route_9_0 -->
<g id="node648" class="node">
<title>route_9_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="450" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="450" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="450" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="450" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_0 -->
<g id="edge784" class="edge">
<title>gate_9&#45;&gt;route_9_0</title>
<path fill="none" stroke="black" d="M4487.09,-4759.28C3876.43,-4758.32 2213.63,-4749.03 830,-4680.24 764.75,-4676.99 693.32,-4671.77 630.17,-4666.59"/>
<polygon fill="black" stroke="black" points="630.36,-4663.09 620.11,-4665.75 629.79,-4670.07 630.36,-4663.09"/>
</g>
<!-- route_9_1 -->
<g id="node652" class="node">
<title>route_9_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1040" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1040" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 258,259</text>
<text text-anchor="middle" x="1040" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_1 -->
<g id="edge789" class="edge">
<title>gate_9&#45;&gt;route_9_1</title>
<path fill="none" stroke="black" d="M4485.4,-4758.03C3938.99,-4754.3 2566.53,-4739.32 1420,-4680.24 1354.91,-4676.89 1283.67,-4671.66 1220.63,-4666.49"/>
<polygon fill="black" stroke="black" points="1220.84,-4662.99 1210.59,-4665.66 1220.27,-4669.97 1220.84,-4662.99"/>
</g>
<!-- route_9_2 -->
<g id="node656" class="node">
<title>route_9_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1630" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1630" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 260,261</text>
<text text-anchor="middle" x="1630" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_2 -->
<g id="edge794" class="edge">
<title>gate_9&#45;&gt;route_9_2</title>
<path fill="none" stroke="black" d="M4482.82,-4756.23C4006.8,-4749.46 2921.5,-4729.57 2010,-4680.24 1945.08,-4676.72 1874.02,-4671.47 1811.1,-4666.33"/>
<polygon fill="black" stroke="black" points="1811.32,-4662.84 1801.07,-4665.51 1810.75,-4669.82 1811.32,-4662.84"/>
</g>
<!-- route_9_3 -->
<g id="node660" class="node">
<title>route_9_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2220" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2220" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 262,263</text>
<text text-anchor="middle" x="2220" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_3 -->
<g id="edge799" class="edge">
<title>gate_9&#45;&gt;route_9_3</title>
<path fill="none" stroke="black" d="M4478.78,-4753.4C4081.71,-4743.29 3279.24,-4719.75 2600,-4680.24 2535.41,-4676.48 2464.73,-4671.2 2402.03,-4666.11"/>
<polygon fill="black" stroke="black" points="2402.29,-4662.62 2392.04,-4665.3 2401.72,-4669.6 2402.29,-4662.62"/>
</g>
<!-- route_9_4 -->
<g id="node664" class="node">
<title>route_9_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2810" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2810" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 264,265</text>
<text text-anchor="middle" x="2810" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_4 -->
<g id="edge804" class="edge">
<title>gate_9&#45;&gt;route_9_4</title>
<path fill="none" stroke="black" d="M4471.91,-4748.29C4166.88,-4734.71 3640.93,-4709.69 3190,-4680.24 3126.04,-4676.06 3056.08,-4670.73 2993.82,-4665.73"/>
<polygon fill="black" stroke="black" points="2993.74,-4662.21 2983.49,-4664.89 2993.18,-4669.19 2993.74,-4662.21"/>
</g>
<!-- route_9_5 -->
<g id="node668" class="node">
<title>route_9_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3400" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 266,267</text>
<text text-anchor="middle" x="3400" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_5 -->
<g id="edge809" class="edge">
<title>gate_9&#45;&gt;route_9_5</title>
<path fill="none" stroke="black" d="M4456.06,-4736.96C4196.32,-4715.6 3811.23,-4683.94 3584.92,-4665.33"/>
<polygon fill="black" stroke="black" points="3585.18,-4661.84 3574.93,-4664.51 3584.61,-4668.82 3585.18,-4661.84"/>
</g>
<!-- route_9_6 -->
<g id="node672" class="node">
<title>route_9_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3990" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="3990" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 268,269</text>
<text text-anchor="middle" x="3990" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_6 -->
<g id="edge814" class="edge">
<title>gate_9&#45;&gt;route_9_6</title>
<path fill="none" stroke="black" d="M4436.51,-4716.23C4335.8,-4701.32 4226.94,-4685.2 4141.92,-4672.62"/>
<polygon fill="black" stroke="black" points="4142.34,-4669.14 4131.93,-4671.14 4141.31,-4676.07 4142.34,-4669.14"/>
</g>
<!-- route_9_7 -->
<g id="node676" class="node">
<title>route_9_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4517" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4517" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4517" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 270,271</text>
<text text-anchor="middle" x="4517" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4517" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_7 -->
<g id="edge819" class="edge">
<title>gate_9&#45;&gt;route_9_7</title>
<path fill="none" stroke="black" d="M4644,-4716.11C4623.22,-4705.32 4601.24,-4693.9 4581.51,-4683.65"/>
<polygon fill="black" stroke="black" points="4583.1,-4680.53 4572.62,-4679.02 4579.88,-4686.74 4583.1,-4680.53"/>
</g>
<!-- route_9_8 -->
<g id="node680" class="node">
<title>route_9_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4937" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4937" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4937" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="4937" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4937" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_8 -->
<g id="edge824" class="edge">
<title>gate_9&#45;&gt;route_9_8</title>
<path fill="none" stroke="black" d="M4810,-4716.11C4830.78,-4705.32 4852.76,-4693.9 4872.49,-4683.65"/>
<polygon fill="black" stroke="black" points="4874.12,-4686.74 4881.38,-4679.02 4870.9,-4680.53 4874.12,-4686.74"/>
</g>
<!-- route_9_9 -->
<g id="node684" class="node">
<title>route_9_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5465" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5465" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 290,291</text>
<text text-anchor="middle" x="5465" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_9 -->
<g id="edge829" class="edge">
<title>gate_9&#45;&gt;route_9_9</title>
<path fill="none" stroke="black" d="M4923.8,-4730.14C5045.76,-4712.11 5200.08,-4689.29 5312.69,-4672.64"/>
<polygon fill="black" stroke="black" points="5313.39,-4676.08 5322.77,-4671.15 5312.37,-4669.15 5313.39,-4676.08"/>
</g>
<!-- route_9_10 -->
<g id="node688" class="node">
<title>route_9_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6055" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6055" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 292,293</text>
<text text-anchor="middle" x="6055" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_10 -->
<g id="edge834" class="edge">
<title>gate_9&#45;&gt;route_9_10</title>
<path fill="none" stroke="black" d="M4940,-4741.74C5197.37,-4720.59 5626.14,-4685.36 5870.18,-4665.31"/>
<polygon fill="black" stroke="black" points="5870.54,-4668.79 5880.22,-4664.49 5869.96,-4661.82 5870.54,-4668.79"/>
</g>
<!-- route_9_11 -->
<g id="node692" class="node">
<title>route_9_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6645" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6645" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 294,295</text>
<text text-anchor="middle" x="6645" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_11 -->
<g id="edge839" class="edge">
<title>gate_9&#45;&gt;route_9_11</title>
<path fill="none" stroke="black" d="M4950.94,-4749.69C5250.44,-4736.46 5797.94,-4710.73 6265,-4680.24 6328.96,-4676.06 6398.92,-4670.74 6461.18,-4665.73"/>
<polygon fill="black" stroke="black" points="6461.82,-4669.19 6471.51,-4664.89 6461.26,-4662.21 6461.82,-4669.19"/>
</g>
<!-- route_9_12 -->
<g id="node696" class="node">
<title>route_9_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7235" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7235" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 296,297</text>
<text text-anchor="middle" x="7235" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_12 -->
<g id="edge844" class="edge">
<title>gate_9&#45;&gt;route_9_12</title>
<path fill="none" stroke="black" d="M4956.64,-4753.87C5346.94,-4744.05 6164.6,-4720.39 6855,-4680.24 6919.59,-4676.48 6990.27,-4671.2 7052.97,-4666.11"/>
<polygon fill="black" stroke="black" points="7053.28,-4669.6 7062.96,-4665.3 7052.71,-4662.62 7053.28,-4669.6"/>
</g>
<!-- route_9_13 -->
<g id="node700" class="node">
<title>route_9_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7825" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7825" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 298,299</text>
<text text-anchor="middle" x="7825" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_13 -->
<g id="edge849" class="edge">
<title>gate_9&#45;&gt;route_9_13</title>
<path fill="none" stroke="black" d="M4960.3,-4756.39C5430.62,-4749.77 6526.09,-4729.97 7445,-4680.24 7509.92,-4676.73 7580.98,-4671.47 7643.9,-4666.34"/>
<polygon fill="black" stroke="black" points="7644.25,-4669.82 7653.93,-4665.51 7643.68,-4662.84 7644.25,-4669.82"/>
</g>
<!-- route_9_14 -->
<g id="node704" class="node">
<title>route_9_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8415" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8415" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 300,301</text>
<text text-anchor="middle" x="8415" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_14 -->
<g id="edge854" class="edge">
<title>gate_9&#45;&gt;route_9_14</title>
<path fill="none" stroke="black" d="M4962.56,-4758.07C5504.95,-4754.42 6883.82,-4739.55 8035,-4680.24 8100.09,-4676.89 8171.33,-4671.66 8234.37,-4666.49"/>
<polygon fill="black" stroke="black" points="8234.73,-4669.97 8244.41,-4665.66 8234.16,-4662.99 8234.73,-4669.97"/>
</g>
<!-- route_9_15 -->
<g id="node708" class="node">
<title>route_9_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9005" cy="-4649.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-4661.93" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9005" y="-4651.93" font-family="Times,serif" font-size="9.00">GPU: 302,303</text>
<text text-anchor="middle" x="9005" y="-4641.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-4631.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_15 -->
<g id="edge859" class="edge">
<title>gate_9&#45;&gt;route_9_15</title>
<path fill="none" stroke="black" d="M4964.19,-4759.29C5572.71,-4758.35 7238.91,-4749.14 8625,-4680.24 8690.25,-4677 8761.68,-4671.78 8824.83,-4666.59"/>
<polygon fill="black" stroke="black" points="8825.21,-4670.07 8834.89,-4665.75 8824.64,-4663.09 8825.21,-4670.07"/>
</g>
<!-- expert_9_0_0 -->
<g id="node649" class="node">
<title>expert_9_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293.5,-4582.01 16.5,-4582.01 16.5,-4538.01 293.5,-4538.01 293.5,-4582.01"/>
<text text-anchor="middle" x="155" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L9</text>
<text text-anchor="middle" x="155" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="155" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_0&#45;&gt;expert_9_0_0 -->
<g id="edge785" class="edge">
<title>route_9_0&#45;&gt;expert_9_0_0</title>
<path fill="none" stroke="black" d="M359.08,-4621.28C319.92,-4609.71 274.49,-4596.3 236.44,-4585.06"/>
<polygon fill="black" stroke="black" points="237.01,-4581.58 226.43,-4582.11 235.03,-4588.3 237.01,-4581.58"/>
</g>
<!-- expert_9_0_1 -->
<g id="node650" class="node">
<title>expert_9_0_1</title>
<polygon fill="lightgreen" stroke="black" points="588.5,-4582.01 311.5,-4582.01 311.5,-4538.01 588.5,-4538.01 588.5,-4582.01"/>
<text text-anchor="middle" x="450" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L9</text>
<text text-anchor="middle" x="450" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="450" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_0&#45;&gt;expert_9_0_1 -->
<g id="edge786" class="edge">
<title>route_9_0&#45;&gt;expert_9_0_1</title>
<path fill="none" stroke="black" d="M450,-4617.66C450,-4609.38 450,-4600.4 450,-4592.09"/>
<polygon fill="black" stroke="black" points="453.5,-4592.02 450,-4582.02 446.5,-4592.02 453.5,-4592.02"/>
</g>
<!-- tp_9_0 -->
<g id="node651" class="node">
<title>tp_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="2852" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2852" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L9</text>
<text text-anchor="middle" x="2852" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="2852" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2852" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_0_0&#45;&gt;tp_9_0 -->
<g id="edge787" class="edge">
<title>expert_9_0_0&#45;&gt;tp_9_0</title>
<path fill="none" stroke="black" d="M293.84,-4538.74C296.58,-4538.48 299.3,-4538.24 302,-4538.01 780.88,-4497.74 2280.56,-4478.23 2726.02,-4473.23"/>
<polygon fill="black" stroke="black" points="2726.07,-4476.73 2736.03,-4473.12 2725.99,-4469.73 2726.07,-4476.73"/>
</g>
<!-- expert_9_0_1&#45;&gt;tp_9_0 -->
<g id="edge788" class="edge">
<title>expert_9_0_1&#45;&gt;tp_9_0</title>
<path fill="none" stroke="black" d="M588.6,-4538.87C591.76,-4538.56 594.9,-4538.28 598,-4538.01 1016.26,-4502.32 2315.54,-4480.03 2726.23,-4473.74"/>
<polygon fill="black" stroke="black" points="2726.41,-4477.24 2736.35,-4473.58 2726.3,-4470.24 2726.41,-4477.24"/>
</g>
<!-- q_proj_10 -->
<g id="node712" class="node">
<title>q_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="4561,-4392.79 4265,-4392.79 4265,-4348.79 4561,-4348.79 4561,-4392.79"/>
<text text-anchor="middle" x="4413" y="-4383.59" font-family="Times,serif" font-size="9.00">Q Projection L10</text>
<text text-anchor="middle" x="4413" y="-4373.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4413" y="-4363.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4413" y="-4353.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_9_0&#45;&gt;q_proj_10 -->
<g id="edge1812" class="edge">
<title>tp_9_0&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M2920.34,-4445.64C2938.53,-4440.13 2958.33,-4434.97 2977,-4431.79 3218.43,-4390.63 3933.98,-4377.31 4254.56,-4373.34"/>
<polygon fill="black" stroke="black" points="4254.9,-4376.84 4264.86,-4373.21 4254.82,-4369.84 4254.9,-4376.84"/>
</g>
<!-- k_proj_10 -->
<g id="node713" class="node">
<title>k_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="5189,-4392.79 4893,-4392.79 4893,-4348.79 5189,-4348.79 5189,-4392.79"/>
<text text-anchor="middle" x="5041" y="-4383.59" font-family="Times,serif" font-size="9.00">K Projection L10</text>
<text text-anchor="middle" x="5041" y="-4373.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="5041" y="-4363.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5041" y="-4353.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_9_0&#45;&gt;k_proj_10 -->
<g id="edge1813" class="edge">
<title>tp_9_0&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M2919.29,-4445.46C2937.75,-4439.84 2957.93,-4434.67 2977,-4431.79 3081.75,-4415.95 4779.44,-4440.88 4884,-4423.79 4917.1,-4418.38 4952.67,-4407.08 4981.58,-4396.39"/>
<polygon fill="black" stroke="black" points="4982.99,-4399.6 4991.11,-4392.8 4980.52,-4393.05 4982.99,-4399.6"/>
</g>
<!-- v_proj_10 -->
<g id="node714" class="node">
<title>v_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="4875,-4392.79 4579,-4392.79 4579,-4348.79 4875,-4348.79 4875,-4392.79"/>
<text text-anchor="middle" x="4727" y="-4383.59" font-family="Times,serif" font-size="9.00">V Projection L10</text>
<text text-anchor="middle" x="4727" y="-4373.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4727" y="-4363.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-4353.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_9_0&#45;&gt;v_proj_10 -->
<g id="edge1814" class="edge">
<title>tp_9_0&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M2919.29,-4445.47C2937.75,-4439.85 2957.93,-4434.68 2977,-4431.79 3064.5,-4418.52 4482.66,-4438.1 4570,-4423.79 4603.09,-4418.36 4638.67,-4407.07 4667.58,-4396.38"/>
<polygon fill="black" stroke="black" points="4668.99,-4399.59 4677.11,-4392.79 4666.52,-4393.04 4668.99,-4399.59"/>
</g>
<!-- expert_9_1_0 -->
<g id="node653" class="node">
<title>expert_9_1_0</title>
<polygon fill="lightgreen" stroke="black" points="883.5,-4582.01 606.5,-4582.01 606.5,-4538.01 883.5,-4538.01 883.5,-4582.01"/>
<text text-anchor="middle" x="745" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L9</text>
<text text-anchor="middle" x="745" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 258</text>
<text text-anchor="middle" x="745" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="745" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_1&#45;&gt;expert_9_1_0 -->
<g id="edge790" class="edge">
<title>route_9_1&#45;&gt;expert_9_1_0</title>
<path fill="none" stroke="black" d="M949.08,-4621.28C909.92,-4609.71 864.49,-4596.3 826.44,-4585.06"/>
<polygon fill="black" stroke="black" points="827.01,-4581.58 816.43,-4582.11 825.03,-4588.3 827.01,-4581.58"/>
</g>
<!-- expert_9_1_1 -->
<g id="node654" class="node">
<title>expert_9_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1178.5,-4582.01 901.5,-4582.01 901.5,-4538.01 1178.5,-4538.01 1178.5,-4582.01"/>
<text text-anchor="middle" x="1040" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L9</text>
<text text-anchor="middle" x="1040" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 259</text>
<text text-anchor="middle" x="1040" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_1&#45;&gt;expert_9_1_1 -->
<g id="edge791" class="edge">
<title>route_9_1&#45;&gt;expert_9_1_1</title>
<path fill="none" stroke="black" d="M1040,-4617.66C1040,-4609.38 1040,-4600.4 1040,-4592.09"/>
<polygon fill="black" stroke="black" points="1043.5,-4592.02 1040,-4582.02 1036.5,-4592.02 1043.5,-4592.02"/>
</g>
<!-- tp_9_1 -->
<g id="node655" class="node">
<title>tp_9_1</title>
<ellipse fill="lightblue" stroke="black" cx="3102" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3102" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L9</text>
<text text-anchor="middle" x="3102" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 258↔259</text>
<text text-anchor="middle" x="3102" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3102" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_1_0&#45;&gt;tp_9_1 -->
<g id="edge792" class="edge">
<title>expert_9_1_0&#45;&gt;tp_9_1</title>
<path fill="none" stroke="black" d="M883.59,-4538.82C886.76,-4538.53 889.9,-4538.26 893,-4538.01 1354.73,-4501.41 2517.54,-4560.6 2977,-4502.01 2988.68,-4500.52 3000.85,-4498.37 3012.81,-4495.89"/>
<polygon fill="black" stroke="black" points="3013.76,-4499.27 3022.8,-4493.74 3012.29,-4492.42 3013.76,-4499.27"/>
</g>
<!-- expert_9_1_1&#45;&gt;tp_9_1 -->
<g id="edge793" class="edge">
<title>expert_9_1_1&#45;&gt;tp_9_1</title>
<path fill="none" stroke="black" d="M1178.6,-4538.83C1181.76,-4538.54 1184.9,-4538.26 1188,-4538.01 1584.35,-4506.02 2582.63,-4552.87 2977,-4502.01 2988.67,-4500.51 3000.84,-4498.34 3012.81,-4495.86"/>
<polygon fill="black" stroke="black" points="3013.76,-4499.23 3022.79,-4493.7 3012.28,-4492.39 3013.76,-4499.23"/>
</g>
<!-- tp_9_1&#45;&gt;q_proj_10 -->
<g id="edge1815" class="edge">
<title>tp_9_1&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M3170.36,-4445.76C3188.55,-4440.24 3208.34,-4435.05 3227,-4431.79 3419.7,-4398.06 3978.48,-4381.37 4254.67,-4374.99"/>
<polygon fill="black" stroke="black" points="4254.86,-4378.48 4264.77,-4374.75 4254.7,-4371.48 4254.86,-4378.48"/>
</g>
<!-- tp_9_1&#45;&gt;k_proj_10 -->
<g id="edge1816" class="edge">
<title>tp_9_1&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M3169.29,-4445.47C3187.75,-4439.85 3207.93,-4434.68 3227,-4431.79 3318.02,-4418 4793.15,-4438.67 4884,-4423.79 4917.1,-4418.37 4952.67,-4407.07 4981.58,-4396.38"/>
<polygon fill="black" stroke="black" points="4982.99,-4399.59 4991.11,-4392.79 4980.52,-4393.04 4982.99,-4399.59"/>
</g>
<!-- tp_9_1&#45;&gt;v_proj_10 -->
<g id="edge1817" class="edge">
<title>tp_9_1&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M3169.29,-4445.48C3187.75,-4439.86 3207.93,-4434.69 3227,-4431.79 3300.76,-4420.57 4496.38,-4435.89 4570,-4423.79 4602.96,-4418.37 4638.39,-4407.14 4667.24,-4396.49"/>
<polygon fill="black" stroke="black" points="4668.63,-4399.71 4676.76,-4392.91 4666.16,-4393.16 4668.63,-4399.71"/>
</g>
<!-- expert_9_2_0 -->
<g id="node657" class="node">
<title>expert_9_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-4582.01 1196.5,-4582.01 1196.5,-4538.01 1473.5,-4538.01 1473.5,-4582.01"/>
<text text-anchor="middle" x="1335" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L9</text>
<text text-anchor="middle" x="1335" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 260</text>
<text text-anchor="middle" x="1335" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1335" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_2&#45;&gt;expert_9_2_0 -->
<g id="edge795" class="edge">
<title>route_9_2&#45;&gt;expert_9_2_0</title>
<path fill="none" stroke="black" d="M1539.08,-4621.28C1499.92,-4609.71 1454.49,-4596.3 1416.44,-4585.06"/>
<polygon fill="black" stroke="black" points="1417.01,-4581.58 1406.43,-4582.11 1415.03,-4588.3 1417.01,-4581.58"/>
</g>
<!-- expert_9_2_1 -->
<g id="node658" class="node">
<title>expert_9_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1768.5,-4582.01 1491.5,-4582.01 1491.5,-4538.01 1768.5,-4538.01 1768.5,-4582.01"/>
<text text-anchor="middle" x="1630" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L9</text>
<text text-anchor="middle" x="1630" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 261</text>
<text text-anchor="middle" x="1630" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_2&#45;&gt;expert_9_2_1 -->
<g id="edge796" class="edge">
<title>route_9_2&#45;&gt;expert_9_2_1</title>
<path fill="none" stroke="black" d="M1630,-4617.66C1630,-4609.38 1630,-4600.4 1630,-4592.09"/>
<polygon fill="black" stroke="black" points="1633.5,-4592.02 1630,-4582.02 1626.5,-4592.02 1633.5,-4592.02"/>
</g>
<!-- tp_9_2 -->
<g id="node659" class="node">
<title>tp_9_2</title>
<ellipse fill="lightblue" stroke="black" cx="3352" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3352" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L9</text>
<text text-anchor="middle" x="3352" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 260↔261</text>
<text text-anchor="middle" x="3352" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3352" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_2_0&#45;&gt;tp_9_2 -->
<g id="edge797" class="edge">
<title>expert_9_2_0&#45;&gt;tp_9_2</title>
<path fill="none" stroke="black" d="M1473.6,-4538.83C1476.76,-4538.54 1479.9,-4538.26 1483,-4538.01 1869.37,-4506.73 2842.56,-4551.69 3227,-4502.01 3238.67,-4500.5 3250.84,-4498.34 3262.81,-4495.85"/>
<polygon fill="black" stroke="black" points="3263.76,-4499.23 3272.79,-4493.7 3262.28,-4492.39 3263.76,-4499.23"/>
</g>
<!-- expert_9_2_1&#45;&gt;tp_9_2 -->
<g id="edge798" class="edge">
<title>expert_9_2_1&#45;&gt;tp_9_2</title>
<path fill="none" stroke="black" d="M1768.6,-4538.85C1771.76,-4538.55 1774.9,-4538.27 1778,-4538.01 2419.99,-4484.67 2588.29,-4585.92 3227,-4502.01 3238.67,-4500.48 3250.84,-4498.3 3262.8,-4495.81"/>
<polygon fill="black" stroke="black" points="3263.75,-4499.18 3272.79,-4493.64 3262.27,-4492.34 3263.75,-4499.18"/>
</g>
<!-- tp_9_2&#45;&gt;q_proj_10 -->
<g id="edge1818" class="edge">
<title>tp_9_2&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M3420.72,-4445.83C3438.82,-4440.35 3458.47,-4435.16 3477,-4431.79 3621.64,-4405.47 4027.9,-4386.43 4254.76,-4377.49"/>
<polygon fill="black" stroke="black" points="4254.9,-4380.99 4264.76,-4377.1 4254.63,-4373.99 4254.9,-4380.99"/>
</g>
<!-- tp_9_2&#45;&gt;k_proj_10 -->
<g id="edge1819" class="edge">
<title>tp_9_2&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M3419.29,-4445.48C3437.75,-4439.86 3457.93,-4434.69 3477,-4431.79 3554.28,-4420.04 4806.87,-4436.45 4884,-4423.79 4916.97,-4418.37 4952.4,-4407.14 4981.24,-4396.5"/>
<polygon fill="black" stroke="black" points="4982.63,-4399.71 4990.76,-4392.92 4980.17,-4393.16 4982.63,-4399.71"/>
</g>
<!-- tp_9_2&#45;&gt;v_proj_10 -->
<g id="edge1820" class="edge">
<title>tp_9_2&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M3419.29,-4445.5C3437.75,-4439.88 3457.94,-4434.7 3477,-4431.79 3597.05,-4413.44 4450.17,-4443.57 4570,-4423.79 4602.96,-4418.35 4638.39,-4407.11 4667.24,-4396.47"/>
<polygon fill="black" stroke="black" points="4668.62,-4399.69 4676.75,-4392.9 4666.16,-4393.14 4668.62,-4399.69"/>
</g>
<!-- expert_9_3_0 -->
<g id="node661" class="node">
<title>expert_9_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-4582.01 1786.5,-4582.01 1786.5,-4538.01 2063.5,-4538.01 2063.5,-4582.01"/>
<text text-anchor="middle" x="1925" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L9</text>
<text text-anchor="middle" x="1925" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 262</text>
<text text-anchor="middle" x="1925" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1925" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_3&#45;&gt;expert_9_3_0 -->
<g id="edge800" class="edge">
<title>route_9_3&#45;&gt;expert_9_3_0</title>
<path fill="none" stroke="black" d="M2129.08,-4621.28C2089.92,-4609.71 2044.49,-4596.3 2006.44,-4585.06"/>
<polygon fill="black" stroke="black" points="2007.01,-4581.58 1996.43,-4582.11 2005.03,-4588.3 2007.01,-4581.58"/>
</g>
<!-- expert_9_3_1 -->
<g id="node662" class="node">
<title>expert_9_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2358.5,-4582.01 2081.5,-4582.01 2081.5,-4538.01 2358.5,-4538.01 2358.5,-4582.01"/>
<text text-anchor="middle" x="2220" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L9</text>
<text text-anchor="middle" x="2220" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 263</text>
<text text-anchor="middle" x="2220" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_3&#45;&gt;expert_9_3_1 -->
<g id="edge801" class="edge">
<title>route_9_3&#45;&gt;expert_9_3_1</title>
<path fill="none" stroke="black" d="M2220,-4617.66C2220,-4609.38 2220,-4600.4 2220,-4592.09"/>
<polygon fill="black" stroke="black" points="2223.5,-4592.02 2220,-4582.02 2216.5,-4592.02 2223.5,-4592.02"/>
</g>
<!-- tp_9_3 -->
<g id="node663" class="node">
<title>tp_9_3</title>
<ellipse fill="lightblue" stroke="black" cx="3602" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3602" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L9</text>
<text text-anchor="middle" x="3602" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 262↔263</text>
<text text-anchor="middle" x="3602" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3602" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_3_0&#45;&gt;tp_9_3 -->
<g id="edge802" class="edge">
<title>expert_9_3_0&#45;&gt;tp_9_3</title>
<path fill="none" stroke="black" d="M2063.6,-4538.85C2066.76,-4538.55 2069.9,-4538.27 2073,-4538.01 2695.04,-4486.08 2858.14,-4583.56 3477,-4502.01 3488.67,-4500.48 3500.84,-4498.29 3512.8,-4495.8"/>
<polygon fill="black" stroke="black" points="3513.75,-4499.17 3522.79,-4493.64 3512.27,-4492.33 3513.75,-4499.17"/>
</g>
<!-- expert_9_3_1&#45;&gt;tp_9_3 -->
<g id="edge803" class="edge">
<title>expert_9_3_1&#45;&gt;tp_9_3</title>
<path fill="none" stroke="black" d="M2358.6,-4538.88C2361.76,-4538.57 2364.9,-4538.28 2368,-4538.01 2859.3,-4495.31 2988.3,-4568.1 3477,-4502.01 3488.58,-4500.45 3500.65,-4498.26 3512.52,-4495.78"/>
<polygon fill="black" stroke="black" points="3513.41,-4499.17 3522.44,-4493.63 3511.92,-4492.33 3513.41,-4499.17"/>
</g>
<!-- tp_9_3&#45;&gt;q_proj_10 -->
<g id="edge1821" class="edge">
<title>tp_9_3&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M3671.43,-4445.92C3689.35,-4440.51 3708.74,-4435.33 3727,-4431.79 3905.76,-4397.11 4114.65,-4382.46 4254.53,-4376.28"/>
<polygon fill="black" stroke="black" points="4255.06,-4379.76 4264.9,-4375.83 4254.76,-4372.77 4255.06,-4379.76"/>
</g>
<!-- tp_9_3&#45;&gt;k_proj_10 -->
<g id="edge1822" class="edge">
<title>tp_9_3&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M3669.29,-4445.5C3687.75,-4439.88 3707.94,-4434.7 3727,-4431.79 3854.09,-4412.39 4757.15,-4444.7 4884,-4423.79 4916.96,-4418.35 4952.39,-4407.12 4981.24,-4396.48"/>
<polygon fill="black" stroke="black" points="4982.63,-4399.7 4990.75,-4392.9 4980.16,-4393.14 4982.63,-4399.7"/>
</g>
<!-- tp_9_3&#45;&gt;v_proj_10 -->
<g id="edge1823" class="edge">
<title>tp_9_3&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M3669.3,-4445.53C3687.76,-4439.91 3707.94,-4434.72 3727,-4431.79 3819.58,-4417.54 4477.6,-4439.14 4570,-4423.79 4602.96,-4418.31 4638.38,-4407.07 4667.23,-4396.44"/>
<polygon fill="black" stroke="black" points="4668.62,-4399.66 4676.75,-4392.87 4666.16,-4393.1 4668.62,-4399.66"/>
</g>
<!-- expert_9_4_0 -->
<g id="node665" class="node">
<title>expert_9_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2653.5,-4582.01 2376.5,-4582.01 2376.5,-4538.01 2653.5,-4538.01 2653.5,-4582.01"/>
<text text-anchor="middle" x="2515" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L9</text>
<text text-anchor="middle" x="2515" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 264</text>
<text text-anchor="middle" x="2515" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2515" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_4&#45;&gt;expert_9_4_0 -->
<g id="edge805" class="edge">
<title>route_9_4&#45;&gt;expert_9_4_0</title>
<path fill="none" stroke="black" d="M2719.08,-4621.28C2679.92,-4609.71 2634.49,-4596.3 2596.44,-4585.06"/>
<polygon fill="black" stroke="black" points="2597.01,-4581.58 2586.43,-4582.11 2595.03,-4588.3 2597.01,-4581.58"/>
</g>
<!-- expert_9_4_1 -->
<g id="node666" class="node">
<title>expert_9_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2948.5,-4582.01 2671.5,-4582.01 2671.5,-4538.01 2948.5,-4538.01 2948.5,-4582.01"/>
<text text-anchor="middle" x="2810" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L9</text>
<text text-anchor="middle" x="2810" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 265</text>
<text text-anchor="middle" x="2810" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_4&#45;&gt;expert_9_4_1 -->
<g id="edge806" class="edge">
<title>route_9_4&#45;&gt;expert_9_4_1</title>
<path fill="none" stroke="black" d="M2810,-4617.66C2810,-4609.38 2810,-4600.4 2810,-4592.09"/>
<polygon fill="black" stroke="black" points="2813.5,-4592.02 2810,-4582.02 2806.5,-4592.02 2813.5,-4592.02"/>
</g>
<!-- tp_9_4 -->
<g id="node667" class="node">
<title>tp_9_4</title>
<ellipse fill="lightblue" stroke="black" cx="3852" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3852" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L9</text>
<text text-anchor="middle" x="3852" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 264↔265</text>
<text text-anchor="middle" x="3852" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3852" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_4_0&#45;&gt;tp_9_4 -->
<g id="edge807" class="edge">
<title>expert_9_4_0&#45;&gt;tp_9_4</title>
<path fill="none" stroke="black" d="M2653.6,-4538.89C2656.76,-4538.58 2659.9,-4538.29 2663,-4538.01 3134.35,-4496.72 3258.15,-4565.75 3727,-4502.01 3738.58,-4500.44 3750.65,-4498.25 3762.52,-4495.76"/>
<polygon fill="black" stroke="black" points="3763.41,-4499.15 3772.44,-4493.61 3761.92,-4492.31 3763.41,-4499.15"/>
</g>
<!-- expert_9_4_1&#45;&gt;tp_9_4 -->
<g id="edge808" class="edge">
<title>expert_9_4_1&#45;&gt;tp_9_4</title>
<path fill="none" stroke="black" d="M2948.6,-4538.94C2951.76,-4538.62 2954.9,-4538.31 2958,-4538.01 3298.65,-4505.94 3388.27,-4550.3 3727,-4502.01 3738.48,-4500.38 3750.45,-4498.16 3762.24,-4495.68"/>
<polygon fill="black" stroke="black" points="3763.06,-4499.08 3772.08,-4493.53 3761.56,-4492.24 3763.06,-4499.08"/>
</g>
<!-- tp_9_4&#45;&gt;q_proj_10 -->
<g id="edge1824" class="edge">
<title>tp_9_4&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M3922.87,-4446.15C3940.42,-4440.87 3959.27,-4435.68 3977,-4431.79 4068.16,-4411.75 4171.6,-4397.17 4254.84,-4387.41"/>
<polygon fill="black" stroke="black" points="4255.36,-4390.87 4264.89,-4386.24 4254.56,-4383.92 4255.36,-4390.87"/>
</g>
<!-- tp_9_4&#45;&gt;k_proj_10 -->
<g id="edge1825" class="edge">
<title>tp_9_4&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M3919.3,-4445.52C3937.75,-4439.9 3957.94,-4434.72 3977,-4431.79 4076.61,-4416.49 4784.58,-4440.27 4884,-4423.79 4916.96,-4418.32 4952.39,-4407.08 4981.23,-4396.45"/>
<polygon fill="black" stroke="black" points="4982.62,-4399.67 4990.75,-4392.88 4980.16,-4393.11 4982.62,-4399.67"/>
</g>
<!-- tp_9_4&#45;&gt;v_proj_10 -->
<g id="edge1826" class="edge">
<title>tp_9_4&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M3919.63,-4445.48C3938,-4439.9 3958.06,-4434.74 3977,-4431.79 4107.22,-4411.48 4440.04,-4445.65 4570,-4423.79 4602.94,-4418.25 4638.37,-4407 4667.22,-4396.38"/>
<polygon fill="black" stroke="black" points="4668.61,-4399.6 4676.74,-4392.81 4666.15,-4393.05 4668.61,-4399.6"/>
</g>
<!-- expert_9_5_0 -->
<g id="node669" class="node">
<title>expert_9_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3243.5,-4582.01 2966.5,-4582.01 2966.5,-4538.01 3243.5,-4538.01 3243.5,-4582.01"/>
<text text-anchor="middle" x="3105" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L9</text>
<text text-anchor="middle" x="3105" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 266</text>
<text text-anchor="middle" x="3105" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3105" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_5&#45;&gt;expert_9_5_0 -->
<g id="edge810" class="edge">
<title>route_9_5&#45;&gt;expert_9_5_0</title>
<path fill="none" stroke="black" d="M3309.08,-4621.28C3269.92,-4609.71 3224.49,-4596.3 3186.44,-4585.06"/>
<polygon fill="black" stroke="black" points="3187.01,-4581.58 3176.43,-4582.11 3185.03,-4588.3 3187.01,-4581.58"/>
</g>
<!-- expert_9_5_1 -->
<g id="node670" class="node">
<title>expert_9_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3538.5,-4582.01 3261.5,-4582.01 3261.5,-4538.01 3538.5,-4538.01 3538.5,-4582.01"/>
<text text-anchor="middle" x="3400" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L9</text>
<text text-anchor="middle" x="3400" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 267</text>
<text text-anchor="middle" x="3400" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_5&#45;&gt;expert_9_5_1 -->
<g id="edge811" class="edge">
<title>route_9_5&#45;&gt;expert_9_5_1</title>
<path fill="none" stroke="black" d="M3400,-4617.66C3400,-4609.38 3400,-4600.4 3400,-4592.09"/>
<polygon fill="black" stroke="black" points="3403.5,-4592.02 3400,-4582.02 3396.5,-4592.02 3403.5,-4592.02"/>
</g>
<!-- tp_9_5 -->
<g id="node671" class="node">
<title>tp_9_5</title>
<ellipse fill="lightblue" stroke="black" cx="4102" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4102" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L9</text>
<text text-anchor="middle" x="4102" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 266↔267</text>
<text text-anchor="middle" x="4102" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4102" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_5_0&#45;&gt;tp_9_5 -->
<g id="edge812" class="edge">
<title>expert_9_5_0&#45;&gt;tp_9_5</title>
<path fill="none" stroke="black" d="M3243.61,-4538.96C3246.77,-4538.62 3249.9,-4538.31 3253,-4538.01 3573.71,-4507.35 3658.11,-4547.94 3977,-4502.01 3988.48,-4500.36 4000.45,-4498.14 4012.23,-4495.65"/>
<polygon fill="black" stroke="black" points="4013.05,-4499.05 4022.07,-4493.49 4011.56,-4492.21 4013.05,-4499.05"/>
</g>
<!-- expert_9_5_1&#45;&gt;tp_9_5 -->
<g id="edge813" class="edge">
<title>expert_9_5_1&#45;&gt;tp_9_5</title>
<path fill="none" stroke="black" d="M3538.62,-4539.1C3541.78,-4538.73 3544.91,-4538.36 3548,-4538.01 3738.13,-4516.56 3788.11,-4532.51 3977,-4502.01 3988.08,-4500.22 3999.63,-4497.98 4011.03,-4495.52"/>
<polygon fill="black" stroke="black" points="4012,-4498.89 4021,-4493.31 4010.48,-4492.06 4012,-4498.89"/>
</g>
<!-- tp_9_5&#45;&gt;q_proj_10 -->
<g id="edge1827" class="edge">
<title>tp_9_5&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M4175.31,-4446.77C4223.88,-4431.45 4287.46,-4411.39 4336.65,-4395.88"/>
<polygon fill="black" stroke="black" points="4337.8,-4399.18 4346.28,-4392.84 4335.69,-4392.51 4337.8,-4399.18"/>
</g>
<!-- tp_9_5&#45;&gt;k_proj_10 -->
<g id="edge1828" class="edge">
<title>tp_9_5&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M4169.63,-4445.46C4188,-4439.88 4208.06,-4434.73 4227,-4431.79 4299.14,-4420.59 4812,-4435.85 4884,-4423.79 4916.95,-4418.27 4952.38,-4407.02 4981.23,-4396.4"/>
<polygon fill="black" stroke="black" points="4982.61,-4399.62 4990.74,-4392.83 4980.15,-4393.06 4982.61,-4399.62"/>
</g>
<!-- tp_9_5&#45;&gt;v_proj_10 -->
<g id="edge1829" class="edge">
<title>tp_9_5&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M4169.65,-4445.61C4188.02,-4440.02 4208.07,-4434.84 4227,-4431.79 4302.27,-4419.67 4494.88,-4436.81 4570,-4423.79 4602.79,-4418.11 4638.07,-4406.91 4666.86,-4396.36"/>
<polygon fill="black" stroke="black" points="4668.22,-4399.59 4676.37,-4392.81 4665.77,-4393.03 4668.22,-4399.59"/>
</g>
<!-- expert_9_6_0 -->
<g id="node673" class="node">
<title>expert_9_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3833.5,-4582.01 3556.5,-4582.01 3556.5,-4538.01 3833.5,-4538.01 3833.5,-4582.01"/>
<text text-anchor="middle" x="3695" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L9</text>
<text text-anchor="middle" x="3695" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 268</text>
<text text-anchor="middle" x="3695" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3695" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_6&#45;&gt;expert_9_6_0 -->
<g id="edge815" class="edge">
<title>route_9_6&#45;&gt;expert_9_6_0</title>
<path fill="none" stroke="black" d="M3899.08,-4621.28C3859.92,-4609.71 3814.49,-4596.3 3776.44,-4585.06"/>
<polygon fill="black" stroke="black" points="3777.01,-4581.58 3766.43,-4582.11 3775.03,-4588.3 3777.01,-4581.58"/>
</g>
<!-- expert_9_6_1 -->
<g id="node674" class="node">
<title>expert_9_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4128.5,-4582.01 3851.5,-4582.01 3851.5,-4538.01 4128.5,-4538.01 4128.5,-4582.01"/>
<text text-anchor="middle" x="3990" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L9</text>
<text text-anchor="middle" x="3990" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 269</text>
<text text-anchor="middle" x="3990" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_6&#45;&gt;expert_9_6_1 -->
<g id="edge816" class="edge">
<title>route_9_6&#45;&gt;expert_9_6_1</title>
<path fill="none" stroke="black" d="M3990,-4617.66C3990,-4609.38 3990,-4600.4 3990,-4592.09"/>
<polygon fill="black" stroke="black" points="3993.5,-4592.02 3990,-4582.02 3986.5,-4592.02 3993.5,-4592.02"/>
</g>
<!-- tp_9_6 -->
<g id="node675" class="node">
<title>tp_9_6</title>
<ellipse fill="lightblue" stroke="black" cx="4352" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4352" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L9</text>
<text text-anchor="middle" x="4352" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 268↔269</text>
<text text-anchor="middle" x="4352" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4352" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_6_0&#45;&gt;tp_9_6 -->
<g id="edge817" class="edge">
<title>expert_9_6_0&#45;&gt;tp_9_6</title>
<path fill="none" stroke="black" d="M3833.63,-4539.14C3836.78,-4538.75 3839.91,-4538.38 3843,-4538.01 4013.24,-4517.97 4057.91,-4530.16 4227,-4502.01 4238.07,-4500.17 4249.61,-4497.89 4261.02,-4495.42"/>
<polygon fill="black" stroke="black" points="4261.98,-4498.79 4270.98,-4493.2 4260.46,-4491.95 4261.98,-4498.79"/>
</g>
<!-- expert_9_6_1&#45;&gt;tp_9_6 -->
<g id="edge818" class="edge">
<title>expert_9_6_1&#45;&gt;tp_9_6</title>
<path fill="none" stroke="black" d="M4077.51,-4537.97C4122.24,-4527.22 4177.52,-4513.92 4227,-4502.01 4236.87,-4499.64 4247.17,-4497.16 4257.45,-4494.68"/>
<polygon fill="black" stroke="black" points="4258.38,-4498.06 4267.28,-4492.31 4256.74,-4491.25 4258.38,-4498.06"/>
</g>
<!-- tp_9_6&#45;&gt;q_proj_10 -->
<g id="edge1830" class="edge">
<title>tp_9_6&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M4370.63,-4439.93C4378.17,-4427.81 4386.86,-4413.84 4394.39,-4401.72"/>
<polygon fill="black" stroke="black" points="4397.59,-4403.21 4399.89,-4392.87 4391.64,-4399.51 4397.59,-4403.21"/>
</g>
<!-- tp_9_6&#45;&gt;k_proj_10 -->
<g id="edge1831" class="edge">
<title>tp_9_6&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M4419.64,-4445.56C4438.01,-4439.98 4458.07,-4434.8 4477,-4431.79 4566.34,-4417.57 4794.84,-4439.07 4884,-4423.79 4916.8,-4418.17 4952.08,-4406.98 4980.87,-4396.41"/>
<polygon fill="black" stroke="black" points="4982.23,-4399.64 4990.37,-4392.86 4979.78,-4393.08 4982.23,-4399.64"/>
</g>
<!-- tp_9_6&#45;&gt;v_proj_10 -->
<g id="edge1832" class="edge">
<title>tp_9_6&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M4421.43,-4445.91C4439.34,-4440.5 4458.73,-4435.32 4477,-4431.79 4517.73,-4423.92 4529.36,-4432.14 4570,-4423.79 4601.57,-4417.29 4635.65,-4406.5 4663.96,-4396.42"/>
<polygon fill="black" stroke="black" points="4665.5,-4399.58 4673.72,-4392.89 4663.12,-4393 4665.5,-4399.58"/>
</g>
<!-- expert_9_7_0 -->
<g id="node677" class="node">
<title>expert_9_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4423.5,-4582.01 4146.5,-4582.01 4146.5,-4538.01 4423.5,-4538.01 4423.5,-4582.01"/>
<text text-anchor="middle" x="4285" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L9</text>
<text text-anchor="middle" x="4285" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 270</text>
<text text-anchor="middle" x="4285" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4285" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_7&#45;&gt;expert_9_7_0 -->
<g id="edge820" class="edge">
<title>route_9_7&#45;&gt;expert_9_7_0</title>
<path fill="none" stroke="black" d="M4442.64,-4620.2C4413.11,-4609.12 4379.42,-4596.47 4350.8,-4585.72"/>
<polygon fill="black" stroke="black" points="4351.89,-4582.39 4341.29,-4582.15 4349.43,-4588.94 4351.89,-4582.39"/>
</g>
<!-- expert_9_7_1 -->
<g id="node678" class="node">
<title>expert_9_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4718.5,-4582.01 4441.5,-4582.01 4441.5,-4538.01 4718.5,-4538.01 4718.5,-4582.01"/>
<text text-anchor="middle" x="4580" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L9</text>
<text text-anchor="middle" x="4580" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 271</text>
<text text-anchor="middle" x="4580" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_7&#45;&gt;expert_9_7_1 -->
<g id="edge821" class="edge">
<title>route_9_7&#45;&gt;expert_9_7_1</title>
<path fill="none" stroke="black" d="M4538.68,-4618.15C4545.15,-4609.2 4552.24,-4599.39 4558.69,-4590.48"/>
<polygon fill="black" stroke="black" points="4561.61,-4592.41 4564.64,-4582.25 4555.94,-4588.31 4561.61,-4592.41"/>
</g>
<!-- tp_9_7 -->
<g id="node679" class="node">
<title>tp_9_7</title>
<ellipse fill="lightblue" stroke="black" cx="4602" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4602" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L9</text>
<text text-anchor="middle" x="4602" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 270↔271</text>
<text text-anchor="middle" x="4602" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4602" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_7_0&#45;&gt;tp_9_7 -->
<g id="edge822" class="edge">
<title>expert_9_7_0&#45;&gt;tp_9_7</title>
<path fill="none" stroke="black" d="M4361.74,-4537.93C4407.34,-4525.39 4465.37,-4509.45 4512.98,-4496.36"/>
<polygon fill="black" stroke="black" points="4513.94,-4499.73 4522.66,-4493.7 4512.09,-4492.98 4513.94,-4499.73"/>
</g>
<!-- expert_9_7_1&#45;&gt;tp_9_7 -->
<g id="edge823" class="edge">
<title>expert_9_7_1&#45;&gt;tp_9_7</title>
<path fill="none" stroke="black" d="M4585.33,-4537.93C4587.3,-4530.1 4589.62,-4520.93 4591.88,-4511.97"/>
<polygon fill="black" stroke="black" points="4595.34,-4512.57 4594.4,-4502.01 4588.55,-4510.85 4595.34,-4512.57"/>
</g>
<!-- tp_9_7&#45;&gt;q_proj_10 -->
<g id="edge1833" class="edge">
<title>tp_9_7&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M4550.1,-4442.96C4522.81,-4428.79 4489.52,-4411.51 4462.58,-4397.52"/>
<polygon fill="black" stroke="black" points="4464.19,-4394.42 4453.7,-4392.92 4460.96,-4400.63 4464.19,-4394.42"/>
</g>
<!-- tp_9_7&#45;&gt;k_proj_10 -->
<g id="edge1834" class="edge">
<title>tp_9_7&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M4670.36,-4445.76C4688.55,-4440.25 4708.34,-4435.06 4727,-4431.79 4795.82,-4419.73 4815.33,-4436.67 4884,-4423.79 4916.33,-4417.73 4951.16,-4406.68 4979.78,-4396.32"/>
<polygon fill="black" stroke="black" points="4981.06,-4399.58 4989.24,-4392.84 4978.64,-4393.01 4981.06,-4399.58"/>
</g>
<!-- tp_9_7&#45;&gt;v_proj_10 -->
<g id="edge1835" class="edge">
<title>tp_9_7&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M4638.49,-4441.26C4655.46,-4427.94 4675.54,-4412.18 4692.28,-4399.04"/>
<polygon fill="black" stroke="black" points="4694.5,-4401.75 4700.2,-4392.82 4690.18,-4396.24 4694.5,-4401.75"/>
</g>
<!-- expert_9_8_0 -->
<g id="node681" class="node">
<title>expert_9_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5013.5,-4582.01 4736.5,-4582.01 4736.5,-4538.01 5013.5,-4538.01 5013.5,-4582.01"/>
<text text-anchor="middle" x="4875" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L9</text>
<text text-anchor="middle" x="4875" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="4875" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4875" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_8&#45;&gt;expert_9_8_0 -->
<g id="edge825" class="edge">
<title>route_9_8&#45;&gt;expert_9_8_0</title>
<path fill="none" stroke="black" d="M4915.66,-4618.15C4909.29,-4609.2 4902.32,-4599.39 4895.97,-4590.48"/>
<polygon fill="black" stroke="black" points="4898.77,-4588.37 4890.12,-4582.25 4893.06,-4592.43 4898.77,-4588.37"/>
</g>
<!-- expert_9_8_1 -->
<g id="node682" class="node">
<title>expert_9_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5308.5,-4582.01 5031.5,-4582.01 5031.5,-4538.01 5308.5,-4538.01 5308.5,-4582.01"/>
<text text-anchor="middle" x="5170" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L9</text>
<text text-anchor="middle" x="5170" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="5170" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5170" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_8&#45;&gt;expert_9_8_1 -->
<g id="edge826" class="edge">
<title>route_9_8&#45;&gt;expert_9_8_1</title>
<path fill="none" stroke="black" d="M5011.68,-4620.2C5041.34,-4609.12 5075.17,-4596.47 5103.92,-4585.72"/>
<polygon fill="black" stroke="black" points="5105.32,-4588.93 5113.46,-4582.15 5102.87,-4582.38 5105.32,-4588.93"/>
</g>
<!-- tp_9_8 -->
<g id="node683" class="node">
<title>tp_9_8</title>
<ellipse fill="lightblue" stroke="black" cx="4852" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4852" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L9</text>
<text text-anchor="middle" x="4852" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="4852" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4852" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_8_0&#45;&gt;tp_9_8 -->
<g id="edge827" class="edge">
<title>expert_9_8_0&#45;&gt;tp_9_8</title>
<path fill="none" stroke="black" d="M4869.43,-4537.93C4867.37,-4530.1 4864.95,-4520.93 4862.58,-4511.97"/>
<polygon fill="black" stroke="black" points="4865.89,-4510.79 4859.95,-4502.01 4859.12,-4512.58 4865.89,-4510.79"/>
</g>
<!-- expert_9_8_1&#45;&gt;tp_9_8 -->
<g id="edge828" class="edge">
<title>expert_9_8_1&#45;&gt;tp_9_8</title>
<path fill="none" stroke="black" d="M5093.02,-4537.93C5047.19,-4525.37 4988.84,-4509.39 4941.04,-4496.29"/>
<polygon fill="black" stroke="black" points="4941.88,-4492.89 4931.31,-4493.63 4940.03,-4499.65 4941.88,-4492.89"/>
</g>
<!-- tp_9_8&#45;&gt;q_proj_10 -->
<g id="edge1836" class="edge">
<title>tp_9_8&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M4783.64,-4445.76C4765.45,-4440.25 4745.66,-4435.06 4727,-4431.79 4658.18,-4419.73 4638.67,-4436.67 4570,-4423.79 4537.67,-4417.73 4502.84,-4406.68 4474.22,-4396.32"/>
<polygon fill="black" stroke="black" points="4475.36,-4393.01 4464.76,-4392.84 4472.94,-4399.58 4475.36,-4393.01"/>
</g>
<!-- tp_9_8&#45;&gt;k_proj_10 -->
<g id="edge1837" class="edge">
<title>tp_9_8&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M4903.9,-4442.96C4931.19,-4428.79 4964.48,-4411.51 4991.42,-4397.52"/>
<polygon fill="black" stroke="black" points="4993.04,-4400.63 5000.3,-4392.92 4989.81,-4394.42 4993.04,-4400.63"/>
</g>
<!-- tp_9_8&#45;&gt;v_proj_10 -->
<g id="edge1838" class="edge">
<title>tp_9_8&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M4815.51,-4441.26C4798.54,-4427.94 4778.46,-4412.18 4761.72,-4399.04"/>
<polygon fill="black" stroke="black" points="4763.82,-4396.24 4753.8,-4392.82 4759.5,-4401.75 4763.82,-4396.24"/>
</g>
<!-- expert_9_9_0 -->
<g id="node685" class="node">
<title>expert_9_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5603.5,-4582.01 5326.5,-4582.01 5326.5,-4538.01 5603.5,-4538.01 5603.5,-4582.01"/>
<text text-anchor="middle" x="5465" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L9</text>
<text text-anchor="middle" x="5465" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 290</text>
<text text-anchor="middle" x="5465" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_9&#45;&gt;expert_9_9_0 -->
<g id="edge830" class="edge">
<title>route_9_9&#45;&gt;expert_9_9_0</title>
<path fill="none" stroke="black" d="M5465,-4617.66C5465,-4609.38 5465,-4600.4 5465,-4592.09"/>
<polygon fill="black" stroke="black" points="5468.5,-4592.02 5465,-4582.02 5461.5,-4592.02 5468.5,-4592.02"/>
</g>
<!-- expert_9_9_1 -->
<g id="node686" class="node">
<title>expert_9_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5898.5,-4582.01 5621.5,-4582.01 5621.5,-4538.01 5898.5,-4538.01 5898.5,-4582.01"/>
<text text-anchor="middle" x="5760" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L9</text>
<text text-anchor="middle" x="5760" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 291</text>
<text text-anchor="middle" x="5760" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5760" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_9&#45;&gt;expert_9_9_1 -->
<g id="edge831" class="edge">
<title>route_9_9&#45;&gt;expert_9_9_1</title>
<path fill="none" stroke="black" d="M5555.92,-4621.28C5595.08,-4609.71 5640.51,-4596.3 5678.56,-4585.06"/>
<polygon fill="black" stroke="black" points="5679.97,-4588.3 5688.57,-4582.11 5677.99,-4581.58 5679.97,-4588.3"/>
</g>
<!-- tp_9_9 -->
<g id="node687" class="node">
<title>tp_9_9</title>
<ellipse fill="lightblue" stroke="black" cx="5102" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5102" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L9</text>
<text text-anchor="middle" x="5102" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 290↔291</text>
<text text-anchor="middle" x="5102" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5102" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_9_0&#45;&gt;tp_9_9 -->
<g id="edge832" class="edge">
<title>expert_9_9_0&#45;&gt;tp_9_9</title>
<path fill="none" stroke="black" d="M5377.11,-4537.99C5332.2,-4527.25 5276.68,-4513.95 5227,-4502.01 5217.05,-4499.62 5206.65,-4497.12 5196.29,-4494.63"/>
<polygon fill="black" stroke="black" points="5196.92,-4491.18 5186.38,-4492.24 5195.28,-4497.99 5196.92,-4491.18"/>
</g>
<!-- expert_9_9_1&#45;&gt;tp_9_9 -->
<g id="edge833" class="edge">
<title>expert_9_9_1&#45;&gt;tp_9_9</title>
<path fill="none" stroke="black" d="M5621.14,-4538.99C5618.4,-4538.66 5615.69,-4538.33 5613,-4538.01 5441.89,-4517.82 5396.97,-4530.26 5227,-4502.01 5215.93,-4500.17 5204.39,-4497.89 5192.98,-4495.42"/>
<polygon fill="black" stroke="black" points="5193.54,-4491.96 5183.01,-4493.2 5192.02,-4498.79 5193.54,-4491.96"/>
</g>
<!-- tp_9_9&#45;&gt;q_proj_10 -->
<g id="edge1839" class="edge">
<title>tp_9_9&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M5034.36,-4445.56C5015.99,-4439.98 4995.93,-4434.8 4977,-4431.79 4887.66,-4417.57 4659.16,-4439.07 4570,-4423.79 4537.2,-4418.17 4501.92,-4406.98 4473.13,-4396.41"/>
<polygon fill="black" stroke="black" points="4474.22,-4393.08 4463.63,-4392.86 4471.77,-4399.64 4474.22,-4393.08"/>
</g>
<!-- tp_9_9&#45;&gt;k_proj_10 -->
<g id="edge1840" class="edge">
<title>tp_9_9&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M5083.37,-4439.93C5075.83,-4427.81 5067.14,-4413.84 5059.61,-4401.72"/>
<polygon fill="black" stroke="black" points="5062.36,-4399.51 5054.11,-4392.87 5056.41,-4403.21 5062.36,-4399.51"/>
</g>
<!-- tp_9_9&#45;&gt;v_proj_10 -->
<g id="edge1841" class="edge">
<title>tp_9_9&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M5032.57,-4445.91C5014.66,-4440.5 4995.27,-4435.32 4977,-4431.79 4936.27,-4423.92 4924.64,-4432.14 4884,-4423.79 4852.43,-4417.29 4818.35,-4406.5 4790.04,-4396.42"/>
<polygon fill="black" stroke="black" points="4790.88,-4393 4780.28,-4392.89 4788.5,-4399.58 4790.88,-4393"/>
</g>
<!-- expert_9_10_0 -->
<g id="node689" class="node">
<title>expert_9_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6193.5,-4582.01 5916.5,-4582.01 5916.5,-4538.01 6193.5,-4538.01 6193.5,-4582.01"/>
<text text-anchor="middle" x="6055" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L9</text>
<text text-anchor="middle" x="6055" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 292</text>
<text text-anchor="middle" x="6055" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_10&#45;&gt;expert_9_10_0 -->
<g id="edge835" class="edge">
<title>route_9_10&#45;&gt;expert_9_10_0</title>
<path fill="none" stroke="black" d="M6055,-4617.66C6055,-4609.38 6055,-4600.4 6055,-4592.09"/>
<polygon fill="black" stroke="black" points="6058.5,-4592.02 6055,-4582.02 6051.5,-4592.02 6058.5,-4592.02"/>
</g>
<!-- expert_9_10_1 -->
<g id="node690" class="node">
<title>expert_9_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-4582.01 6211.5,-4582.01 6211.5,-4538.01 6488.5,-4538.01 6488.5,-4582.01"/>
<text text-anchor="middle" x="6350" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L9</text>
<text text-anchor="middle" x="6350" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 293</text>
<text text-anchor="middle" x="6350" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6350" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_10&#45;&gt;expert_9_10_1 -->
<g id="edge836" class="edge">
<title>route_9_10&#45;&gt;expert_9_10_1</title>
<path fill="none" stroke="black" d="M6145.92,-4621.28C6185.08,-4609.71 6230.51,-4596.3 6268.56,-4585.06"/>
<polygon fill="black" stroke="black" points="6269.97,-4588.3 6278.57,-4582.11 6267.99,-4581.58 6269.97,-4588.3"/>
</g>
<!-- tp_9_10 -->
<g id="node691" class="node">
<title>tp_9_10</title>
<ellipse fill="lightblue" stroke="black" cx="5352" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5352" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L9</text>
<text text-anchor="middle" x="5352" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 292↔293</text>
<text text-anchor="middle" x="5352" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5352" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_10_0&#45;&gt;tp_9_10 -->
<g id="edge837" class="edge">
<title>expert_9_10_0&#45;&gt;tp_9_10</title>
<path fill="none" stroke="black" d="M5916.14,-4538.96C5913.41,-4538.63 5910.69,-4538.32 5908,-4538.01 5717,-4516.41 5666.77,-4532.61 5477,-4502.01 5465.92,-4500.23 5454.37,-4497.98 5442.97,-4495.52"/>
<polygon fill="black" stroke="black" points="5443.52,-4492.06 5433,-4493.32 5442,-4498.9 5443.52,-4492.06"/>
</g>
<!-- expert_9_10_1&#45;&gt;tp_9_10 -->
<g id="edge838" class="edge">
<title>expert_9_10_1&#45;&gt;tp_9_10</title>
<path fill="none" stroke="black" d="M6211.16,-4538.83C6208.42,-4538.54 6205.69,-4538.27 6203,-4538.01 5881.42,-4507.14 5796.77,-4548.05 5477,-4502.01 5465.52,-4500.36 5453.55,-4498.14 5441.77,-4495.65"/>
<polygon fill="black" stroke="black" points="5442.44,-4492.21 5431.93,-4493.5 5440.95,-4499.05 5442.44,-4492.21"/>
</g>
<!-- tp_9_10&#45;&gt;q_proj_10 -->
<g id="edge1842" class="edge">
<title>tp_9_10&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M5284.37,-4445.46C5266,-4439.88 5245.94,-4434.73 5227,-4431.79 5154.86,-4420.59 4642,-4435.85 4570,-4423.79 4537.05,-4418.27 4501.62,-4407.02 4472.77,-4396.4"/>
<polygon fill="black" stroke="black" points="4473.85,-4393.06 4463.26,-4392.83 4471.39,-4399.62 4473.85,-4393.06"/>
</g>
<!-- tp_9_10&#45;&gt;k_proj_10 -->
<g id="edge1843" class="edge">
<title>tp_9_10&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M5278.69,-4446.77C5230.12,-4431.45 5166.54,-4411.39 5117.35,-4395.88"/>
<polygon fill="black" stroke="black" points="5118.31,-4392.51 5107.72,-4392.84 5116.2,-4399.18 5118.31,-4392.51"/>
</g>
<!-- tp_9_10&#45;&gt;v_proj_10 -->
<g id="edge1844" class="edge">
<title>tp_9_10&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M5284.35,-4445.61C5265.98,-4440.02 5245.93,-4434.84 5227,-4431.79 5151.73,-4419.67 4959.12,-4436.81 4884,-4423.79 4851.21,-4418.11 4815.93,-4406.91 4787.14,-4396.36"/>
<polygon fill="black" stroke="black" points="4788.23,-4393.03 4777.63,-4392.81 4785.78,-4399.59 4788.23,-4393.03"/>
</g>
<!-- expert_9_11_0 -->
<g id="node693" class="node">
<title>expert_9_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6783.5,-4582.01 6506.5,-4582.01 6506.5,-4538.01 6783.5,-4538.01 6783.5,-4582.01"/>
<text text-anchor="middle" x="6645" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L9</text>
<text text-anchor="middle" x="6645" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 294</text>
<text text-anchor="middle" x="6645" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_11&#45;&gt;expert_9_11_0 -->
<g id="edge840" class="edge">
<title>route_9_11&#45;&gt;expert_9_11_0</title>
<path fill="none" stroke="black" d="M6645,-4617.66C6645,-4609.38 6645,-4600.4 6645,-4592.09"/>
<polygon fill="black" stroke="black" points="6648.5,-4592.02 6645,-4582.02 6641.5,-4592.02 6648.5,-4592.02"/>
</g>
<!-- expert_9_11_1 -->
<g id="node694" class="node">
<title>expert_9_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-4582.01 6801.5,-4582.01 6801.5,-4538.01 7078.5,-4538.01 7078.5,-4582.01"/>
<text text-anchor="middle" x="6940" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L9</text>
<text text-anchor="middle" x="6940" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 295</text>
<text text-anchor="middle" x="6940" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6940" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_11&#45;&gt;expert_9_11_1 -->
<g id="edge841" class="edge">
<title>route_9_11&#45;&gt;expert_9_11_1</title>
<path fill="none" stroke="black" d="M6735.92,-4621.28C6775.08,-4609.71 6820.51,-4596.3 6858.56,-4585.06"/>
<polygon fill="black" stroke="black" points="6859.97,-4588.3 6868.57,-4582.11 6857.99,-4581.58 6859.97,-4588.3"/>
</g>
<!-- tp_9_11 -->
<g id="node695" class="node">
<title>tp_9_11</title>
<ellipse fill="lightblue" stroke="black" cx="5602" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5602" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L9</text>
<text text-anchor="middle" x="5602" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 294↔295</text>
<text text-anchor="middle" x="5602" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5602" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_11_0&#45;&gt;tp_9_11 -->
<g id="edge842" class="edge">
<title>expert_9_11_0&#45;&gt;tp_9_11</title>
<path fill="none" stroke="black" d="M6506.16,-4538.82C6503.42,-4538.54 6500.69,-4538.27 6498,-4538.01 6156.48,-4505.72 6066.61,-4550.4 5727,-4502.01 5715.52,-4500.38 5703.55,-4498.17 5691.76,-4495.68"/>
<polygon fill="black" stroke="black" points="5692.44,-4492.24 5681.92,-4493.53 5690.94,-4499.08 5692.44,-4492.24"/>
</g>
<!-- expert_9_11_1&#45;&gt;tp_9_11 -->
<g id="edge843" class="edge">
<title>expert_9_11_1&#45;&gt;tp_9_11</title>
<path fill="none" stroke="black" d="M6801.16,-4538.77C6798.42,-4538.5 6795.7,-4538.25 6793,-4538.01 6320.78,-4496.43 6196.73,-4565.85 5727,-4502.01 5715.42,-4500.44 5703.35,-4498.25 5691.48,-4495.76"/>
<polygon fill="black" stroke="black" points="5692.08,-4492.31 5681.56,-4493.61 5690.59,-4499.15 5692.08,-4492.31"/>
</g>
<!-- tp_9_11&#45;&gt;q_proj_10 -->
<g id="edge1845" class="edge">
<title>tp_9_11&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M5534.7,-4445.52C5516.25,-4439.9 5496.06,-4434.72 5477,-4431.79 5377.39,-4416.49 4669.42,-4440.27 4570,-4423.79 4537.04,-4418.32 4501.61,-4407.08 4472.77,-4396.45"/>
<polygon fill="black" stroke="black" points="4473.84,-4393.11 4463.25,-4392.88 4471.38,-4399.67 4473.84,-4393.11"/>
</g>
<!-- tp_9_11&#45;&gt;k_proj_10 -->
<g id="edge1846" class="edge">
<title>tp_9_11&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M5531.13,-4446.15C5513.58,-4440.87 5494.73,-4435.68 5477,-4431.79 5385.84,-4411.75 5282.4,-4397.17 5199.16,-4387.41"/>
<polygon fill="black" stroke="black" points="5199.44,-4383.92 5189.11,-4386.24 5198.64,-4390.87 5199.44,-4383.92"/>
</g>
<!-- tp_9_11&#45;&gt;v_proj_10 -->
<g id="edge1847" class="edge">
<title>tp_9_11&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M5534.37,-4445.48C5516,-4439.9 5495.94,-4434.74 5477,-4431.79 5346.78,-4411.48 5013.96,-4445.65 4884,-4423.79 4851.06,-4418.25 4815.63,-4407 4786.78,-4396.38"/>
<polygon fill="black" stroke="black" points="4787.85,-4393.05 4777.26,-4392.81 4785.39,-4399.6 4787.85,-4393.05"/>
</g>
<!-- expert_9_12_0 -->
<g id="node697" class="node">
<title>expert_9_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7373.5,-4582.01 7096.5,-4582.01 7096.5,-4538.01 7373.5,-4538.01 7373.5,-4582.01"/>
<text text-anchor="middle" x="7235" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L9</text>
<text text-anchor="middle" x="7235" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 296</text>
<text text-anchor="middle" x="7235" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_12&#45;&gt;expert_9_12_0 -->
<g id="edge845" class="edge">
<title>route_9_12&#45;&gt;expert_9_12_0</title>
<path fill="none" stroke="black" d="M7235,-4617.66C7235,-4609.38 7235,-4600.4 7235,-4592.09"/>
<polygon fill="black" stroke="black" points="7238.5,-4592.02 7235,-4582.02 7231.5,-4592.02 7238.5,-4592.02"/>
</g>
<!-- expert_9_12_1 -->
<g id="node698" class="node">
<title>expert_9_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7668.5,-4582.01 7391.5,-4582.01 7391.5,-4538.01 7668.5,-4538.01 7668.5,-4582.01"/>
<text text-anchor="middle" x="7530" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L9</text>
<text text-anchor="middle" x="7530" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 297</text>
<text text-anchor="middle" x="7530" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7530" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_12&#45;&gt;expert_9_12_1 -->
<g id="edge846" class="edge">
<title>route_9_12&#45;&gt;expert_9_12_1</title>
<path fill="none" stroke="black" d="M7325.92,-4621.28C7365.08,-4609.71 7410.51,-4596.3 7448.56,-4585.06"/>
<polygon fill="black" stroke="black" points="7449.97,-4588.3 7458.57,-4582.11 7447.99,-4581.58 7449.97,-4588.3"/>
</g>
<!-- tp_9_12 -->
<g id="node699" class="node">
<title>tp_9_12</title>
<ellipse fill="lightblue" stroke="black" cx="5852" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5852" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L9</text>
<text text-anchor="middle" x="5852" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 296↔297</text>
<text text-anchor="middle" x="5852" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5852" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_12_0&#45;&gt;tp_9_12 -->
<g id="edge847" class="edge">
<title>expert_9_12_0&#45;&gt;tp_9_12</title>
<path fill="none" stroke="black" d="M7096.16,-4538.77C7093.42,-4538.5 7090.7,-4538.25 7088,-4538.01 6595.84,-4495.02 6466.58,-4568.21 5977,-4502.01 5965.42,-4500.45 5953.35,-4498.26 5941.48,-4495.78"/>
<polygon fill="black" stroke="black" points="5942.08,-4492.33 5931.56,-4493.63 5940.59,-4499.17 5942.08,-4492.33"/>
</g>
<!-- expert_9_12_1&#45;&gt;tp_9_12 -->
<g id="edge848" class="edge">
<title>expert_9_12_1&#45;&gt;tp_9_12</title>
<path fill="none" stroke="black" d="M7391.16,-4538.74C7388.42,-4538.48 7385.7,-4538.24 7383,-4538.01 6760.1,-4485.72 6596.74,-4583.67 5977,-4502.01 5965.33,-4500.48 5953.16,-4498.29 5941.2,-4495.8"/>
<polygon fill="black" stroke="black" points="5941.73,-4492.33 5931.21,-4493.64 5940.25,-4499.17 5941.73,-4492.33"/>
</g>
<!-- tp_9_12&#45;&gt;q_proj_10 -->
<g id="edge1848" class="edge">
<title>tp_9_12&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M5784.71,-4445.5C5766.25,-4439.88 5746.06,-4434.7 5727,-4431.79 5599.91,-4412.39 4696.85,-4444.7 4570,-4423.79 4537.04,-4418.35 4501.61,-4407.12 4472.76,-4396.48"/>
<polygon fill="black" stroke="black" points="4473.84,-4393.14 4463.25,-4392.9 4471.37,-4399.7 4473.84,-4393.14"/>
</g>
<!-- tp_9_12&#45;&gt;k_proj_10 -->
<g id="edge1849" class="edge">
<title>tp_9_12&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M5782.57,-4445.92C5764.65,-4440.51 5745.26,-4435.33 5727,-4431.79 5548.24,-4397.11 5339.35,-4382.46 5199.47,-4376.28"/>
<polygon fill="black" stroke="black" points="5199.24,-4372.77 5189.1,-4375.83 5198.94,-4379.76 5199.24,-4372.77"/>
</g>
<!-- tp_9_12&#45;&gt;v_proj_10 -->
<g id="edge1850" class="edge">
<title>tp_9_12&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M5784.7,-4445.53C5766.24,-4439.91 5746.06,-4434.72 5727,-4431.79 5634.42,-4417.54 4976.4,-4439.14 4884,-4423.79 4851.04,-4418.31 4815.62,-4407.07 4786.77,-4396.44"/>
<polygon fill="black" stroke="black" points="4787.84,-4393.1 4777.25,-4392.87 4785.38,-4399.66 4787.84,-4393.1"/>
</g>
<!-- expert_9_13_0 -->
<g id="node701" class="node">
<title>expert_9_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7963.5,-4582.01 7686.5,-4582.01 7686.5,-4538.01 7963.5,-4538.01 7963.5,-4582.01"/>
<text text-anchor="middle" x="7825" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L9</text>
<text text-anchor="middle" x="7825" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 298</text>
<text text-anchor="middle" x="7825" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_13&#45;&gt;expert_9_13_0 -->
<g id="edge850" class="edge">
<title>route_9_13&#45;&gt;expert_9_13_0</title>
<path fill="none" stroke="black" d="M7825,-4617.66C7825,-4609.38 7825,-4600.4 7825,-4592.09"/>
<polygon fill="black" stroke="black" points="7828.5,-4592.02 7825,-4582.02 7821.5,-4592.02 7828.5,-4592.02"/>
</g>
<!-- expert_9_13_1 -->
<g id="node702" class="node">
<title>expert_9_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8258.5,-4582.01 7981.5,-4582.01 7981.5,-4538.01 8258.5,-4538.01 8258.5,-4582.01"/>
<text text-anchor="middle" x="8120" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L9</text>
<text text-anchor="middle" x="8120" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 299</text>
<text text-anchor="middle" x="8120" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8120" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_13&#45;&gt;expert_9_13_1 -->
<g id="edge851" class="edge">
<title>route_9_13&#45;&gt;expert_9_13_1</title>
<path fill="none" stroke="black" d="M7915.92,-4621.28C7955.08,-4609.71 8000.51,-4596.3 8038.56,-4585.06"/>
<polygon fill="black" stroke="black" points="8039.97,-4588.3 8048.57,-4582.11 8037.99,-4581.58 8039.97,-4588.3"/>
</g>
<!-- tp_9_13 -->
<g id="node703" class="node">
<title>tp_9_13</title>
<ellipse fill="lightblue" stroke="black" cx="6102" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6102" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L9</text>
<text text-anchor="middle" x="6102" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 298↔299</text>
<text text-anchor="middle" x="6102" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6102" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_13_0&#45;&gt;tp_9_13 -->
<g id="edge852" class="edge">
<title>expert_9_13_0&#45;&gt;tp_9_13</title>
<path fill="none" stroke="black" d="M7686.16,-4538.74C7683.42,-4538.48 7680.7,-4538.24 7678,-4538.01 7035.15,-4484.31 6866.59,-4586.02 6227,-4502.01 6215.33,-4500.48 6203.16,-4498.3 6191.2,-4495.81"/>
<polygon fill="black" stroke="black" points="6191.73,-4492.34 6181.21,-4493.65 6190.25,-4499.18 6191.73,-4492.34"/>
</g>
<!-- expert_9_13_1&#45;&gt;tp_9_13 -->
<g id="edge853" class="edge">
<title>expert_9_13_1&#45;&gt;tp_9_13</title>
<path fill="none" stroke="black" d="M7981.17,-4538.72C7978.42,-4538.47 7975.7,-4538.23 7973,-4538.01 7586.2,-4506.51 6611.88,-4551.75 6227,-4502.01 6215.33,-4500.5 6203.16,-4498.34 6191.19,-4495.85"/>
<polygon fill="black" stroke="black" points="6191.72,-4492.39 6181.21,-4493.7 6190.24,-4499.23 6191.72,-4492.39"/>
</g>
<!-- tp_9_13&#45;&gt;q_proj_10 -->
<g id="edge1851" class="edge">
<title>tp_9_13&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M6034.71,-4445.48C6016.25,-4439.86 5996.07,-4434.69 5977,-4431.79 5899.72,-4420.04 4647.13,-4436.45 4570,-4423.79 4537.03,-4418.37 4501.6,-4407.14 4472.76,-4396.5"/>
<polygon fill="black" stroke="black" points="4473.83,-4393.16 4463.24,-4392.92 4471.37,-4399.71 4473.83,-4393.16"/>
</g>
<!-- tp_9_13&#45;&gt;k_proj_10 -->
<g id="edge1852" class="edge">
<title>tp_9_13&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M6033.28,-4445.83C6015.18,-4440.35 5995.53,-4435.16 5977,-4431.79 5832.36,-4405.47 5426.1,-4386.43 5199.24,-4377.49"/>
<polygon fill="black" stroke="black" points="5199.37,-4373.99 5189.24,-4377.1 5199.1,-4380.99 5199.37,-4373.99"/>
</g>
<!-- tp_9_13&#45;&gt;v_proj_10 -->
<g id="edge1853" class="edge">
<title>tp_9_13&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M6034.71,-4445.5C6016.25,-4439.88 5996.06,-4434.7 5977,-4431.79 5856.95,-4413.44 5003.83,-4443.57 4884,-4423.79 4851.04,-4418.35 4815.61,-4407.11 4786.76,-4396.47"/>
<polygon fill="black" stroke="black" points="4787.84,-4393.14 4777.25,-4392.9 4785.38,-4399.69 4787.84,-4393.14"/>
</g>
<!-- expert_9_14_0 -->
<g id="node705" class="node">
<title>expert_9_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8553.5,-4582.01 8276.5,-4582.01 8276.5,-4538.01 8553.5,-4538.01 8553.5,-4582.01"/>
<text text-anchor="middle" x="8415" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L9</text>
<text text-anchor="middle" x="8415" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 300</text>
<text text-anchor="middle" x="8415" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_14&#45;&gt;expert_9_14_0 -->
<g id="edge855" class="edge">
<title>route_9_14&#45;&gt;expert_9_14_0</title>
<path fill="none" stroke="black" d="M8415,-4617.66C8415,-4609.38 8415,-4600.4 8415,-4592.09"/>
<polygon fill="black" stroke="black" points="8418.5,-4592.02 8415,-4582.02 8411.5,-4592.02 8418.5,-4592.02"/>
</g>
<!-- expert_9_14_1 -->
<g id="node706" class="node">
<title>expert_9_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8848.5,-4582.01 8571.5,-4582.01 8571.5,-4538.01 8848.5,-4538.01 8848.5,-4582.01"/>
<text text-anchor="middle" x="8710" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L9</text>
<text text-anchor="middle" x="8710" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 301</text>
<text text-anchor="middle" x="8710" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8710" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_14&#45;&gt;expert_9_14_1 -->
<g id="edge856" class="edge">
<title>route_9_14&#45;&gt;expert_9_14_1</title>
<path fill="none" stroke="black" d="M8505.92,-4621.28C8545.08,-4609.71 8590.51,-4596.3 8628.56,-4585.06"/>
<polygon fill="black" stroke="black" points="8629.97,-4588.3 8638.57,-4582.11 8627.99,-4581.58 8629.97,-4588.3"/>
</g>
<!-- tp_9_14 -->
<g id="node707" class="node">
<title>tp_9_14</title>
<ellipse fill="lightblue" stroke="black" cx="6352" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6352" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L9</text>
<text text-anchor="middle" x="6352" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 300↔301</text>
<text text-anchor="middle" x="6352" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6352" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_14_0&#45;&gt;tp_9_14 -->
<g id="edge857" class="edge">
<title>expert_9_14_0&#45;&gt;tp_9_14</title>
<path fill="none" stroke="black" d="M8276.17,-4538.72C8273.42,-4538.47 8270.7,-4538.23 8268,-4538.01 7871.22,-4505.81 6871.81,-4552.93 6477,-4502.01 6465.33,-4500.51 6453.16,-4498.34 6441.19,-4495.86"/>
<polygon fill="black" stroke="black" points="6441.72,-4492.39 6431.21,-4493.7 6440.24,-4499.23 6441.72,-4492.39"/>
</g>
<!-- expert_9_14_1&#45;&gt;tp_9_14 -->
<g id="edge858" class="edge">
<title>expert_9_14_1&#45;&gt;tp_9_14</title>
<path fill="none" stroke="black" d="M8571.17,-4538.71C8568.42,-4538.46 8565.7,-4538.23 8563,-4538.01 8100.84,-4501.16 6936.9,-4560.66 6477,-4502.01 6465.32,-4500.52 6453.15,-4498.37 6441.19,-4495.89"/>
<polygon fill="black" stroke="black" points="6441.71,-4492.42 6431.2,-4493.74 6440.24,-4499.27 6441.71,-4492.42"/>
</g>
<!-- tp_9_14&#45;&gt;q_proj_10 -->
<g id="edge1854" class="edge">
<title>tp_9_14&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M6284.71,-4445.47C6266.25,-4439.85 6246.07,-4434.68 6227,-4431.79 6135.98,-4418 4660.85,-4438.67 4570,-4423.79 4536.9,-4418.37 4501.33,-4407.07 4472.42,-4396.38"/>
<polygon fill="black" stroke="black" points="4473.48,-4393.04 4462.89,-4392.79 4471.01,-4399.59 4473.48,-4393.04"/>
</g>
<!-- tp_9_14&#45;&gt;k_proj_10 -->
<g id="edge1855" class="edge">
<title>tp_9_14&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M6283.64,-4445.76C6265.45,-4440.24 6245.66,-4435.05 6227,-4431.79 6034.3,-4398.06 5475.52,-4381.37 5199.33,-4374.99"/>
<polygon fill="black" stroke="black" points="5199.3,-4371.48 5189.23,-4374.75 5199.14,-4378.48 5199.3,-4371.48"/>
</g>
<!-- tp_9_14&#45;&gt;v_proj_10 -->
<g id="edge1856" class="edge">
<title>tp_9_14&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M6284.71,-4445.48C6266.25,-4439.86 6246.07,-4434.69 6227,-4431.79 6153.24,-4420.57 4957.62,-4435.89 4884,-4423.79 4851.04,-4418.37 4815.61,-4407.14 4786.76,-4396.49"/>
<polygon fill="black" stroke="black" points="4787.84,-4393.16 4777.24,-4392.91 4785.37,-4399.71 4787.84,-4393.16"/>
</g>
<!-- expert_9_15_0 -->
<g id="node709" class="node">
<title>expert_9_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9143.5,-4582.01 8866.5,-4582.01 8866.5,-4538.01 9143.5,-4538.01 9143.5,-4582.01"/>
<text text-anchor="middle" x="9005" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L9</text>
<text text-anchor="middle" x="9005" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 302</text>
<text text-anchor="middle" x="9005" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_15&#45;&gt;expert_9_15_0 -->
<g id="edge860" class="edge">
<title>route_9_15&#45;&gt;expert_9_15_0</title>
<path fill="none" stroke="black" d="M9005,-4617.66C9005,-4609.38 9005,-4600.4 9005,-4592.09"/>
<polygon fill="black" stroke="black" points="9008.5,-4592.02 9005,-4582.02 9001.5,-4592.02 9008.5,-4592.02"/>
</g>
<!-- expert_9_15_1 -->
<g id="node710" class="node">
<title>expert_9_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9438.5,-4582.01 9161.5,-4582.01 9161.5,-4538.01 9438.5,-4538.01 9438.5,-4582.01"/>
<text text-anchor="middle" x="9300" y="-4572.81" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L9</text>
<text text-anchor="middle" x="9300" y="-4562.81" font-family="Times,serif" font-size="9.00">GPU: 303</text>
<text text-anchor="middle" x="9300" y="-4552.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9300" y="-4542.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_15&#45;&gt;expert_9_15_1 -->
<g id="edge861" class="edge">
<title>route_9_15&#45;&gt;expert_9_15_1</title>
<path fill="none" stroke="black" d="M9095.92,-4621.28C9135.08,-4609.71 9180.51,-4596.3 9218.56,-4585.06"/>
<polygon fill="black" stroke="black" points="9219.97,-4588.3 9228.57,-4582.11 9217.99,-4581.58 9219.97,-4588.3"/>
</g>
<!-- tp_9_15 -->
<g id="node711" class="node">
<title>tp_9_15</title>
<ellipse fill="lightblue" stroke="black" cx="6602" cy="-4470.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6602" y="-4483.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L9</text>
<text text-anchor="middle" x="6602" y="-4473.7" font-family="Times,serif" font-size="9.00">GPU: 302↔303</text>
<text text-anchor="middle" x="6602" y="-4463.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6602" y="-4453.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_15_0&#45;&gt;tp_9_15 -->
<g id="edge862" class="edge">
<title>expert_9_15_0&#45;&gt;tp_9_15</title>
<path fill="none" stroke="black" d="M8866.16,-4538.75C8863.42,-4538.49 8860.7,-4538.24 8858,-4538.01 8439.38,-4502.09 7138.95,-4479.96 6727.89,-4473.72"/>
<polygon fill="black" stroke="black" points="6727.8,-4470.22 6717.75,-4473.57 6727.7,-4477.22 6727.8,-4470.22"/>
</g>
<!-- expert_9_15_1&#45;&gt;tp_9_15 -->
<g id="edge863" class="edge">
<title>expert_9_15_1&#45;&gt;tp_9_15</title>
<path fill="none" stroke="black" d="M9161.16,-4538.74C9158.42,-4538.48 9155.7,-4538.24 9153,-4538.01 8673.93,-4497.72 7173.66,-4478.23 6728.03,-4473.23"/>
<polygon fill="black" stroke="black" points="6728.05,-4469.73 6718.02,-4473.12 6727.98,-4476.73 6728.05,-4469.73"/>
</g>
<!-- tp_9_15&#45;&gt;q_proj_10 -->
<g id="edge1857" class="edge">
<title>tp_9_15&#45;&gt;q_proj_10</title>
<path fill="none" stroke="black" d="M6534.71,-4445.46C6516.25,-4439.84 6496.07,-4434.67 6477,-4431.79 6372.25,-4415.95 4674.56,-4440.88 4570,-4423.79 4536.9,-4418.38 4501.33,-4407.08 4472.42,-4396.39"/>
<polygon fill="black" stroke="black" points="4473.48,-4393.05 4462.89,-4392.8 4471.01,-4399.6 4473.48,-4393.05"/>
</g>
<!-- tp_9_15&#45;&gt;k_proj_10 -->
<g id="edge1858" class="edge">
<title>tp_9_15&#45;&gt;k_proj_10</title>
<path fill="none" stroke="black" d="M6533.66,-4445.64C6515.47,-4440.13 6495.67,-4434.97 6477,-4431.79 6235.57,-4390.63 5520.02,-4377.31 5199.44,-4373.34"/>
<polygon fill="black" stroke="black" points="5199.18,-4369.84 5189.14,-4373.21 5199.1,-4376.84 5199.18,-4369.84"/>
</g>
<!-- tp_9_15&#45;&gt;v_proj_10 -->
<g id="edge1859" class="edge">
<title>tp_9_15&#45;&gt;v_proj_10</title>
<path fill="none" stroke="black" d="M6534.71,-4445.47C6516.25,-4439.85 6496.07,-4434.68 6477,-4431.79 6389.5,-4418.52 4971.34,-4438.1 4884,-4423.79 4850.91,-4418.36 4815.33,-4407.07 4786.42,-4396.38"/>
<polygon fill="black" stroke="black" points="4787.48,-4393.04 4776.89,-4392.79 4785.01,-4399.59 4787.48,-4393.04"/>
</g>
<!-- attn_scores_10 -->
<g id="node715" class="node">
<title>attn_scores_10</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-4312.79 4560.5,-4312.79 4560.5,-4268.79 4893.5,-4268.79 4893.5,-4312.79"/>
<text text-anchor="middle" x="4727" y="-4303.59" font-family="Times,serif" font-size="9.00">Attention Scores L10</text>
<text text-anchor="middle" x="4727" y="-4293.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4727" y="-4283.59" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-4273.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_10&#45;&gt;attn_scores_10 -->
<g id="edge864" class="edge">
<title>q_proj_10&#45;&gt;attn_scores_10</title>
<path fill="none" stroke="black" d="M4497.56,-4348.78C4539.18,-4338.44 4589.51,-4325.94 4632.41,-4315.29"/>
<polygon fill="black" stroke="black" points="4633.43,-4318.64 4642.29,-4312.83 4631.74,-4311.84 4633.43,-4318.64"/>
</g>
<!-- k_proj_10&#45;&gt;attn_scores_10 -->
<g id="edge865" class="edge">
<title>k_proj_10&#45;&gt;attn_scores_10</title>
<path fill="none" stroke="black" d="M4956.44,-4348.78C4914.82,-4338.44 4864.49,-4325.94 4821.59,-4315.29"/>
<polygon fill="black" stroke="black" points="4822.26,-4311.84 4811.71,-4312.83 4820.57,-4318.64 4822.26,-4311.84"/>
</g>
<!-- v_proj_10&#45;&gt;attn_scores_10 -->
<g id="edge866" class="edge">
<title>v_proj_10&#45;&gt;attn_scores_10</title>
<path fill="none" stroke="black" d="M4727,-4348.47C4727,-4340.59 4727,-4331.47 4727,-4322.89"/>
<polygon fill="black" stroke="black" points="4730.5,-4322.81 4727,-4312.81 4723.5,-4322.81 4730.5,-4322.81"/>
</g>
<!-- softmax_10 -->
<g id="node716" class="node">
<title>softmax_10</title>
<polygon fill="lightgreen" stroke="black" points="4893.5,-4232.79 4560.5,-4232.79 4560.5,-4188.79 4893.5,-4188.79 4893.5,-4232.79"/>
<text text-anchor="middle" x="4727" y="-4223.59" font-family="Times,serif" font-size="9.00">Softmax L10</text>
<text text-anchor="middle" x="4727" y="-4213.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4727" y="-4203.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4727" y="-4193.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_10&#45;&gt;softmax_10 -->
<g id="edge867" class="edge">
<title>attn_scores_10&#45;&gt;softmax_10</title>
<path fill="none" stroke="black" d="M4727,-4268.47C4727,-4260.59 4727,-4251.47 4727,-4242.89"/>
<polygon fill="black" stroke="black" points="4730.5,-4242.81 4727,-4232.81 4723.5,-4242.81 4730.5,-4242.81"/>
</g>
<!-- attn_out_10 -->
<g id="node717" class="node">
<title>attn_out_10</title>
<polygon fill="lightgreen" stroke="black" points="4875,-4152.79 4579,-4152.79 4579,-4108.79 4875,-4108.79 4875,-4152.79"/>
<text text-anchor="middle" x="4727" y="-4143.59" font-family="Times,serif" font-size="9.00">Attention Output L10</text>
<text text-anchor="middle" x="4727" y="-4133.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4727" y="-4123.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-4113.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_10&#45;&gt;attn_out_10 -->
<g id="edge868" class="edge">
<title>softmax_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M4727,-4188.47C4727,-4180.59 4727,-4171.47 4727,-4162.89"/>
<polygon fill="black" stroke="black" points="4730.5,-4162.81 4727,-4152.81 4723.5,-4162.81 4730.5,-4162.81"/>
</g>
<!-- gate_10 -->
<g id="node718" class="node">
<title>gate_10</title>
<polygon fill="lightyellow" stroke="black" points="5026.74,-4072.79 4549.92,-4072.79 4427.26,-3984.79 4904.08,-3984.79 5026.74,-4072.79"/>
<text text-anchor="middle" x="4727" y="-4041.59" font-family="Times,serif" font-size="9.00">Gate L10</text>
<text text-anchor="middle" x="4727" y="-4031.59" font-family="Times,serif" font-size="9.00">GPU: 320&#45;383</text>
<text text-anchor="middle" x="4727" y="-4021.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-4011.59" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_10&#45;&gt;gate_10 -->
<g id="edge869" class="edge">
<title>attn_out_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M4727,-4108.58C4727,-4101.08 4727,-4092.27 4727,-4083.31"/>
<polygon fill="black" stroke="black" points="4730.5,-4083.19 4727,-4073.2 4723.5,-4083.2 4730.5,-4083.19"/>
</g>
<!-- route_10_0 -->
<g id="node719" class="node">
<title>route_10_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="643" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="643" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="643" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="643" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="643" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_0 -->
<g id="edge870" class="edge">
<title>gate_10&#45;&gt;route_10_0</title>
<path fill="none" stroke="black" d="M4486.59,-4027.46C3896.37,-4025.62 2328.86,-4014.4 1023,-3948.79 957.75,-3945.51 886.32,-3940.28 823.17,-3935.1"/>
<polygon fill="black" stroke="black" points="823.37,-3931.6 813.11,-3934.26 822.79,-3938.58 823.37,-3931.6"/>
</g>
<!-- route_10_1 -->
<g id="node723" class="node">
<title>route_10_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1233" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1233" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1233" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 322,323</text>
<text text-anchor="middle" x="1233" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1233" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_1 -->
<g id="edge875" class="edge">
<title>gate_10&#45;&gt;route_10_1</title>
<path fill="none" stroke="black" d="M4484.57,-4026.07C3960.35,-4021.37 2682.32,-4004.68 1613,-3948.79 1547.91,-3945.39 1476.67,-3940.15 1413.64,-3934.98"/>
<polygon fill="black" stroke="black" points="1413.85,-3931.49 1403.59,-3934.16 1413.27,-3938.47 1413.85,-3931.49"/>
</g>
<!-- route_10_2 -->
<g id="node727" class="node">
<title>route_10_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1823" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1823" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1823" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 324,325</text>
<text text-anchor="middle" x="1823" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1823" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_2 -->
<g id="edge880" class="edge">
<title>gate_10&#45;&gt;route_10_2</title>
<path fill="none" stroke="black" d="M4481.85,-4024C4030.62,-4016.18 3038.27,-3994.93 2203,-3948.79 2138.08,-3945.2 2067.03,-3939.93 2004.1,-3934.8"/>
<polygon fill="black" stroke="black" points="2004.33,-3931.31 1994.08,-3933.98 2003.76,-3938.29 2004.33,-3931.31"/>
</g>
<!-- route_10_3 -->
<g id="node731" class="node">
<title>route_10_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2413" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2413" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2413" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 326,327</text>
<text text-anchor="middle" x="2413" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2413" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_3 -->
<g id="edge885" class="edge">
<title>gate_10&#45;&gt;route_10_3</title>
<path fill="none" stroke="black" d="M4476.88,-4020.63C4108.14,-4009.38 3397,-3985.04 2793,-3948.79 2728.57,-3944.92 2658.08,-3939.63 2595.49,-3934.56"/>
<polygon fill="black" stroke="black" points="2595.77,-3931.07 2585.52,-3933.75 2595.2,-3938.05 2595.77,-3931.07"/>
</g>
<!-- route_10_4 -->
<g id="node735" class="node">
<title>route_10_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3003" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3003" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="3003" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 328,329</text>
<text text-anchor="middle" x="3003" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3003" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_4 -->
<g id="edge890" class="edge">
<title>gate_10&#45;&gt;route_10_4</title>
<path fill="none" stroke="black" d="M4467.99,-4014.13C4197.27,-3999.49 3760.17,-3974.81 3383,-3948.79 3319.37,-3944.4 3249.78,-3939.04 3187.75,-3934.08"/>
<polygon fill="black" stroke="black" points="3187.71,-3930.56 3177.46,-3933.25 3187.15,-3937.54 3187.71,-3930.56"/>
</g>
<!-- route_10_5 -->
<g id="node739" class="node">
<title>route_10_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3593" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3593" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3593" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 330,331</text>
<text text-anchor="middle" x="3593" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3593" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_5 -->
<g id="edge895" class="edge">
<title>gate_10&#45;&gt;route_10_5</title>
<path fill="none" stroke="black" d="M4449.96,-4001.13C4238.4,-3980.78 3953.16,-3953.33 3771.12,-3935.81"/>
<polygon fill="black" stroke="black" points="3771.2,-3932.31 3760.91,-3934.83 3770.53,-3939.27 3771.2,-3932.31"/>
</g>
<!-- route_10_6 -->
<g id="node743" class="node">
<title>route_10_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4183" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4183" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4183" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 332,333</text>
<text text-anchor="middle" x="4183" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4183" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_6 -->
<g id="edge900" class="edge">
<title>gate_10&#45;&gt;route_10_6</title>
<path fill="none" stroke="black" d="M4512.39,-3984.74C4444.83,-3971.19 4372.33,-3956.65 4312.59,-3944.67"/>
<polygon fill="black" stroke="black" points="4313.22,-3941.23 4302.73,-3942.69 4311.85,-3948.09 4313.22,-3941.23"/>
</g>
<!-- route_10_7 -->
<g id="node747" class="node">
<title>route_10_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4701" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4701" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4701" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 334,335</text>
<text text-anchor="middle" x="4701" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4701" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_7 -->
<g id="edge905" class="edge">
<title>gate_10&#45;&gt;route_10_7</title>
<path fill="none" stroke="black" d="M4716.72,-3984.66C4714.71,-3976.19 4712.6,-3967.34 4710.6,-3958.97"/>
<polygon fill="black" stroke="black" points="4713.96,-3957.97 4708.24,-3949.05 4707.15,-3959.59 4713.96,-3957.97"/>
</g>
<!-- route_10_8 -->
<g id="node751" class="node">
<title>route_10_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5121" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5121" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5121" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="5121" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5121" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_8 -->
<g id="edge910" class="edge">
<title>gate_10&#45;&gt;route_10_8</title>
<path fill="none" stroke="black" d="M4882.44,-3984.74C4927.17,-3972.35 4974.89,-3959.14 5015.81,-3947.81"/>
<polygon fill="black" stroke="black" points="5016.81,-3951.16 5025.52,-3945.12 5014.95,-3944.41 5016.81,-3951.16"/>
</g>
<!-- route_10_9 -->
<g id="node755" class="node">
<title>route_10_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5658" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5658" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5658" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 354,355</text>
<text text-anchor="middle" x="5658" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5658" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_9 -->
<g id="edge915" class="edge">
<title>gate_10&#45;&gt;route_10_9</title>
<path fill="none" stroke="black" d="M4930.74,-4003.91C5098.57,-3984.24 5333.66,-3956.69 5490.64,-3938.29"/>
<polygon fill="black" stroke="black" points="5491.34,-3941.73 5500.87,-3937.09 5490.53,-3934.78 5491.34,-3941.73"/>
</g>
<!-- route_10_10 -->
<g id="node759" class="node">
<title>route_10_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6248" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6248" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6248" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 356,357</text>
<text text-anchor="middle" x="6248" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6248" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_10 -->
<g id="edge920" class="edge">
<title>gate_10&#45;&gt;route_10_10</title>
<path fill="none" stroke="black" d="M4944.19,-4013.4C5173.78,-3998.03 5546.47,-3972.66 5868,-3948.79 5931.3,-3944.09 6000.51,-3938.68 6062.31,-3933.76"/>
<polygon fill="black" stroke="black" points="6062.87,-3937.23 6072.56,-3932.94 6062.31,-3930.25 6062.87,-3937.23"/>
</g>
<!-- route_10_11 -->
<g id="node763" class="node">
<title>route_10_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6838" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6838" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6838" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 358,359</text>
<text text-anchor="middle" x="6838" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6838" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_11 -->
<g id="edge925" class="edge">
<title>gate_10&#45;&gt;route_10_11</title>
<path fill="none" stroke="black" d="M4953.27,-4019.88C5283.98,-4007.77 5918.68,-3982.45 6458,-3948.79 6522.13,-3944.78 6592.28,-3939.49 6654.65,-3934.45"/>
<polygon fill="black" stroke="black" points="6655.31,-3937.91 6665,-3933.61 6654.75,-3930.93 6655.31,-3937.91"/>
</g>
<!-- route_10_12 -->
<g id="node767" class="node">
<title>route_10_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7428" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7428" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7428" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 360,361</text>
<text text-anchor="middle" x="7428" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7428" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_12 -->
<g id="edge930" class="edge">
<title>gate_10&#45;&gt;route_10_12</title>
<path fill="none" stroke="black" d="M4958.17,-4023.37C5375.73,-4014.62 6283.43,-3992.07 7048,-3948.79 7112.76,-3945.12 7183.63,-3939.85 7246.44,-3934.74"/>
<polygon fill="black" stroke="black" points="7246.76,-3938.22 7256.44,-3933.92 7246.19,-3931.25 7246.76,-3938.22"/>
</g>
<!-- route_10_13 -->
<g id="node771" class="node">
<title>route_10_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8018" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8018" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="8018" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 362,363</text>
<text text-anchor="middle" x="8018" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8018" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_13 -->
<g id="edge935" class="edge">
<title>gate_10&#45;&gt;route_10_13</title>
<path fill="none" stroke="black" d="M4961.11,-4025.56C5455.74,-4019.94 6643.44,-4001.65 7638,-3948.79 7703.08,-3945.33 7774.33,-3940.07 7837.36,-3934.92"/>
<polygon fill="black" stroke="black" points="7837.73,-3938.4 7847.41,-3934.09 7837.15,-3931.42 7837.73,-3938.4"/>
</g>
<!-- route_10_14 -->
<g id="node775" class="node">
<title>route_10_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8608" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8608" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8608" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 364,365</text>
<text text-anchor="middle" x="8608" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8608" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_14 -->
<g id="edge940" class="edge">
<title>gate_10&#45;&gt;route_10_14</title>
<path fill="none" stroke="black" d="M4963.05,-4027.06C5527.59,-4024.32 7000.16,-4011.24 8228,-3948.79 8293.25,-3945.47 8364.68,-3940.23 8427.83,-3935.05"/>
<polygon fill="black" stroke="black" points="8428.21,-3938.53 8437.89,-3934.22 8427.63,-3931.55 8428.21,-3938.53"/>
</g>
<!-- route_10_15 -->
<g id="node779" class="node">
<title>route_10_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9198" cy="-3917.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9198" y="-3930.48" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9198" y="-3920.48" font-family="Times,serif" font-size="9.00">GPU: 366,367</text>
<text text-anchor="middle" x="9198" y="-3910.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9198" y="-3900.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_15 -->
<g id="edge945" class="edge">
<title>gate_10&#45;&gt;route_10_15</title>
<path fill="none" stroke="black" d="M4964.66,-4028.16C5593.78,-4028.07 7354.62,-4020.83 8818,-3948.79 8883.25,-3945.58 8954.69,-3940.36 9017.83,-3935.17"/>
<polygon fill="black" stroke="black" points="9018.22,-3938.65 9027.89,-3934.34 9017.64,-3931.67 9018.22,-3938.65"/>
</g>
<!-- expert_10_0_0 -->
<g id="node720" class="node">
<title>expert_10_0_0</title>
<polygon fill="lightgreen" stroke="black" points="486.5,-3850.56 209.5,-3850.56 209.5,-3806.56 486.5,-3806.56 486.5,-3850.56"/>
<text text-anchor="middle" x="348" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L10</text>
<text text-anchor="middle" x="348" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="348" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="348" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_0&#45;&gt;expert_10_0_0 -->
<g id="edge871" class="edge">
<title>route_10_0&#45;&gt;expert_10_0_0</title>
<path fill="none" stroke="black" d="M552.08,-3889.83C512.92,-3878.26 467.49,-3864.85 429.44,-3853.61"/>
<polygon fill="black" stroke="black" points="430.01,-3850.13 419.43,-3850.66 428.03,-3856.84 430.01,-3850.13"/>
</g>
<!-- expert_10_0_1 -->
<g id="node721" class="node">
<title>expert_10_0_1</title>
<polygon fill="lightgreen" stroke="black" points="781.5,-3850.56 504.5,-3850.56 504.5,-3806.56 781.5,-3806.56 781.5,-3850.56"/>
<text text-anchor="middle" x="643" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L10</text>
<text text-anchor="middle" x="643" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="643" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="643" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_0&#45;&gt;expert_10_0_1 -->
<g id="edge872" class="edge">
<title>route_10_0&#45;&gt;expert_10_0_1</title>
<path fill="none" stroke="black" d="M643,-3886.21C643,-3877.93 643,-3868.95 643,-3860.64"/>
<polygon fill="black" stroke="black" points="646.5,-3860.57 643,-3850.57 639.5,-3860.57 646.5,-3860.57"/>
</g>
<!-- tp_10_0 -->
<g id="node722" class="node">
<title>tp_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="3045" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3045" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L10</text>
<text text-anchor="middle" x="3045" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="3045" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3045" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_0_0&#45;&gt;tp_10_0 -->
<g id="edge873" class="edge">
<title>expert_10_0_0&#45;&gt;tp_10_0</title>
<path fill="none" stroke="black" d="M486.6,-3807.4C489.76,-3807.1 492.9,-3806.82 496,-3806.56 974.71,-3766.53 2473.79,-3746.86 2919.07,-3741.8"/>
<polygon fill="black" stroke="black" points="2919.12,-3745.3 2929.08,-3741.68 2919.04,-3738.3 2919.12,-3745.3"/>
</g>
<!-- expert_10_0_1&#45;&gt;tp_10_0 -->
<g id="edge874" class="edge">
<title>expert_10_0_1&#45;&gt;tp_10_0</title>
<path fill="none" stroke="black" d="M781.6,-3807.42C784.76,-3807.11 787.9,-3806.83 791,-3806.56 1209.26,-3770.87 2508.54,-3748.58 2919.23,-3742.29"/>
<polygon fill="black" stroke="black" points="2919.41,-3745.79 2929.35,-3742.13 2919.3,-3738.79 2919.41,-3745.79"/>
</g>
<!-- q_proj_11 -->
<g id="node783" class="node">
<title>q_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="5068,-3672.34 4772,-3672.34 4772,-3628.34 5068,-3628.34 5068,-3672.34"/>
<text text-anchor="middle" x="4920" y="-3663.14" font-family="Times,serif" font-size="9.00">Q Projection L11</text>
<text text-anchor="middle" x="4920" y="-3653.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4920" y="-3643.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-3633.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_10_0&#45;&gt;q_proj_11 -->
<g id="edge1860" class="edge">
<title>tp_10_0&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M3124.21,-3716.68C3139.31,-3713.3 3155.06,-3710.28 3170,-3708.34 3517.87,-3663.04 4393.53,-3699.17 4761.51,-3672.38"/>
<polygon fill="black" stroke="black" points="4762,-3675.86 4771.71,-3671.62 4761.48,-3668.88 4762,-3675.86"/>
</g>
<!-- k_proj_11 -->
<g id="node784" class="node">
<title>k_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="5382,-3672.34 5086,-3672.34 5086,-3628.34 5382,-3628.34 5382,-3672.34"/>
<text text-anchor="middle" x="5234" y="-3663.14" font-family="Times,serif" font-size="9.00">K Projection L11</text>
<text text-anchor="middle" x="5234" y="-3653.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="5234" y="-3643.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5234" y="-3633.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_10_0&#45;&gt;k_proj_11 -->
<g id="edge1861" class="edge">
<title>tp_10_0&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M3124.2,-3716.63C3139.3,-3713.26 3155.06,-3710.26 3170,-3708.34 3587.12,-3654.81 4637.78,-3703.71 5075.49,-3672.38"/>
<polygon fill="black" stroke="black" points="5076,-3675.86 5085.71,-3671.63 5075.48,-3668.88 5076,-3675.86"/>
</g>
<!-- v_proj_11 -->
<g id="node785" class="node">
<title>v_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="4754,-3672.34 4458,-3672.34 4458,-3628.34 4754,-3628.34 4754,-3672.34"/>
<text text-anchor="middle" x="4606" y="-3663.14" font-family="Times,serif" font-size="9.00">V Projection L11</text>
<text text-anchor="middle" x="4606" y="-3653.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4606" y="-3643.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4606" y="-3633.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_10_0&#45;&gt;v_proj_11 -->
<g id="edge1862" class="edge">
<title>tp_10_0&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M3124.57,-3716.81C3139.56,-3713.44 3155.19,-3710.4 3170,-3708.34 3412.49,-3674.65 4127.06,-3659.12 4447.44,-3653.7"/>
<polygon fill="black" stroke="black" points="4447.79,-3657.19 4457.73,-3653.53 4447.68,-3650.19 4447.79,-3657.19"/>
</g>
<!-- expert_10_1_0 -->
<g id="node724" class="node">
<title>expert_10_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1076.5,-3850.56 799.5,-3850.56 799.5,-3806.56 1076.5,-3806.56 1076.5,-3850.56"/>
<text text-anchor="middle" x="938" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L10</text>
<text text-anchor="middle" x="938" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 322</text>
<text text-anchor="middle" x="938" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="938" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_1&#45;&gt;expert_10_1_0 -->
<g id="edge876" class="edge">
<title>route_10_1&#45;&gt;expert_10_1_0</title>
<path fill="none" stroke="black" d="M1142.08,-3889.83C1102.92,-3878.26 1057.49,-3864.85 1019.44,-3853.61"/>
<polygon fill="black" stroke="black" points="1020.01,-3850.13 1009.43,-3850.66 1018.03,-3856.84 1020.01,-3850.13"/>
</g>
<!-- expert_10_1_1 -->
<g id="node725" class="node">
<title>expert_10_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1371.5,-3850.56 1094.5,-3850.56 1094.5,-3806.56 1371.5,-3806.56 1371.5,-3850.56"/>
<text text-anchor="middle" x="1233" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L10</text>
<text text-anchor="middle" x="1233" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 323</text>
<text text-anchor="middle" x="1233" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1233" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_1&#45;&gt;expert_10_1_1 -->
<g id="edge877" class="edge">
<title>route_10_1&#45;&gt;expert_10_1_1</title>
<path fill="none" stroke="black" d="M1233,-3886.21C1233,-3877.93 1233,-3868.95 1233,-3860.64"/>
<polygon fill="black" stroke="black" points="1236.5,-3860.57 1233,-3850.57 1229.5,-3860.57 1236.5,-3860.57"/>
</g>
<!-- tp_10_1 -->
<g id="node726" class="node">
<title>tp_10_1</title>
<ellipse fill="lightblue" stroke="black" cx="3295" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3295" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L10</text>
<text text-anchor="middle" x="3295" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 322↔323</text>
<text text-anchor="middle" x="3295" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3295" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_1_0&#45;&gt;tp_10_1 -->
<g id="edge878" class="edge">
<title>expert_10_1_0&#45;&gt;tp_10_1</title>
<path fill="none" stroke="black" d="M1076.59,-3807.37C1079.76,-3807.08 1082.9,-3806.81 1086,-3806.56 1547.73,-3769.96 2710.54,-3829.15 3170,-3770.56 3181.68,-3769.07 3193.85,-3766.92 3205.81,-3764.44"/>
<polygon fill="black" stroke="black" points="3206.76,-3767.82 3215.8,-3762.29 3205.29,-3760.97 3206.76,-3767.82"/>
</g>
<!-- expert_10_1_1&#45;&gt;tp_10_1 -->
<g id="edge879" class="edge">
<title>expert_10_1_1&#45;&gt;tp_10_1</title>
<path fill="none" stroke="black" d="M1371.6,-3807.38C1374.76,-3807.09 1377.9,-3806.81 1381,-3806.56 1777.35,-3774.57 2775.63,-3821.42 3170,-3770.56 3181.67,-3769.06 3193.84,-3766.89 3205.81,-3764.41"/>
<polygon fill="black" stroke="black" points="3206.76,-3767.78 3215.79,-3762.25 3205.28,-3760.94 3206.76,-3767.78"/>
</g>
<!-- tp_10_1&#45;&gt;q_proj_11 -->
<g id="edge1863" class="edge">
<title>tp_10_1&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M3374.55,-3716.65C3389.55,-3713.3 3405.17,-3710.3 3420,-3708.34 4008.62,-3630.43 4166.04,-3718.98 4761.58,-3672.4"/>
<polygon fill="black" stroke="black" points="4762.02,-3675.88 4771.71,-3671.6 4761.47,-3668.9 4762.02,-3675.88"/>
</g>
<!-- tp_10_1&#45;&gt;k_proj_11 -->
<g id="edge1864" class="edge">
<title>tp_10_1&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M3374.21,-3716.67C3389.3,-3713.29 3405.06,-3710.28 3420,-3708.34 3782.04,-3661.35 4693.58,-3700.1 5075.67,-3672.37"/>
<polygon fill="black" stroke="black" points="5076,-3675.86 5085.71,-3671.62 5075.48,-3668.88 5076,-3675.86"/>
</g>
<!-- tp_10_1&#45;&gt;v_proj_11 -->
<g id="edge1865" class="edge">
<title>tp_10_1&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M3374.92,-3716.84C3389.81,-3713.48 3405.31,-3710.44 3420,-3708.34 3613.63,-3680.61 4171.96,-3662.67 4447.85,-3655.24"/>
<polygon fill="black" stroke="black" points="4448.05,-3658.74 4457.95,-3654.97 4447.86,-3651.74 4448.05,-3658.74"/>
</g>
<!-- expert_10_2_0 -->
<g id="node728" class="node">
<title>expert_10_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1666.5,-3850.56 1389.5,-3850.56 1389.5,-3806.56 1666.5,-3806.56 1666.5,-3850.56"/>
<text text-anchor="middle" x="1528" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L10</text>
<text text-anchor="middle" x="1528" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 324</text>
<text text-anchor="middle" x="1528" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1528" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_2&#45;&gt;expert_10_2_0 -->
<g id="edge881" class="edge">
<title>route_10_2&#45;&gt;expert_10_2_0</title>
<path fill="none" stroke="black" d="M1732.08,-3889.83C1692.92,-3878.26 1647.49,-3864.85 1609.44,-3853.61"/>
<polygon fill="black" stroke="black" points="1610.01,-3850.13 1599.43,-3850.66 1608.03,-3856.84 1610.01,-3850.13"/>
</g>
<!-- expert_10_2_1 -->
<g id="node729" class="node">
<title>expert_10_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1961.5,-3850.56 1684.5,-3850.56 1684.5,-3806.56 1961.5,-3806.56 1961.5,-3850.56"/>
<text text-anchor="middle" x="1823" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L10</text>
<text text-anchor="middle" x="1823" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 325</text>
<text text-anchor="middle" x="1823" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1823" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_2&#45;&gt;expert_10_2_1 -->
<g id="edge882" class="edge">
<title>route_10_2&#45;&gt;expert_10_2_1</title>
<path fill="none" stroke="black" d="M1823,-3886.21C1823,-3877.93 1823,-3868.95 1823,-3860.64"/>
<polygon fill="black" stroke="black" points="1826.5,-3860.57 1823,-3850.57 1819.5,-3860.57 1826.5,-3860.57"/>
</g>
<!-- tp_10_2 -->
<g id="node730" class="node">
<title>tp_10_2</title>
<ellipse fill="lightblue" stroke="black" cx="3545" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3545" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L10</text>
<text text-anchor="middle" x="3545" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 324↔325</text>
<text text-anchor="middle" x="3545" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3545" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_2_0&#45;&gt;tp_10_2 -->
<g id="edge883" class="edge">
<title>expert_10_2_0&#45;&gt;tp_10_2</title>
<path fill="none" stroke="black" d="M1666.6,-3807.38C1669.76,-3807.09 1672.9,-3806.81 1676,-3806.56 2062.37,-3775.28 3035.56,-3820.24 3420,-3770.56 3431.67,-3769.05 3443.84,-3766.89 3455.81,-3764.4"/>
<polygon fill="black" stroke="black" points="3456.76,-3767.78 3465.79,-3762.25 3455.28,-3760.94 3456.76,-3767.78"/>
</g>
<!-- expert_10_2_1&#45;&gt;tp_10_2 -->
<g id="edge884" class="edge">
<title>expert_10_2_1&#45;&gt;tp_10_2</title>
<path fill="none" stroke="black" d="M1961.6,-3807.4C1964.76,-3807.1 1967.9,-3806.82 1971,-3806.56 2612.99,-3753.22 2781.29,-3854.47 3420,-3770.56 3431.67,-3769.03 3443.84,-3766.85 3455.8,-3764.36"/>
<polygon fill="black" stroke="black" points="3456.75,-3767.73 3465.79,-3762.19 3455.27,-3760.89 3456.75,-3767.73"/>
</g>
<!-- tp_10_2&#45;&gt;q_proj_11 -->
<g id="edge1866" class="edge">
<title>tp_10_2&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M3624.56,-3716.73C3639.55,-3713.36 3655.18,-3710.35 3670,-3708.34 4148.35,-3643.53 4276.88,-3711.66 4761.65,-3672.4"/>
<polygon fill="black" stroke="black" points="4762.03,-3675.88 4771.71,-3671.57 4761.46,-3668.9 4762.03,-3675.88"/>
</g>
<!-- tp_10_2&#45;&gt;k_proj_11 -->
<g id="edge1867" class="edge">
<title>tp_10_2&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M3624.21,-3716.71C3639.31,-3713.33 3655.06,-3710.31 3670,-3708.34 4286.85,-3627.07 4451.66,-3720.86 5075.56,-3672.4"/>
<polygon fill="black" stroke="black" points="5076.02,-3675.88 5085.71,-3671.6 5075.47,-3668.9 5076.02,-3675.88"/>
</g>
<!-- tp_10_2&#45;&gt;v_proj_11 -->
<g id="edge1868" class="edge">
<title>tp_10_2&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M3625.28,-3716.91C3640.06,-3713.58 3655.43,-3710.52 3670,-3708.34 3941.14,-3667.74 4260.59,-3655.89 4447.46,-3652.53"/>
<polygon fill="black" stroke="black" points="4447.7,-3656.03 4457.64,-3652.36 4447.58,-3649.03 4447.7,-3656.03"/>
</g>
<!-- expert_10_3_0 -->
<g id="node732" class="node">
<title>expert_10_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2256.5,-3850.56 1979.5,-3850.56 1979.5,-3806.56 2256.5,-3806.56 2256.5,-3850.56"/>
<text text-anchor="middle" x="2118" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L10</text>
<text text-anchor="middle" x="2118" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 326</text>
<text text-anchor="middle" x="2118" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2118" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_3&#45;&gt;expert_10_3_0 -->
<g id="edge886" class="edge">
<title>route_10_3&#45;&gt;expert_10_3_0</title>
<path fill="none" stroke="black" d="M2322.08,-3889.83C2282.92,-3878.26 2237.49,-3864.85 2199.44,-3853.61"/>
<polygon fill="black" stroke="black" points="2200.01,-3850.13 2189.43,-3850.66 2198.03,-3856.84 2200.01,-3850.13"/>
</g>
<!-- expert_10_3_1 -->
<g id="node733" class="node">
<title>expert_10_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2551.5,-3850.56 2274.5,-3850.56 2274.5,-3806.56 2551.5,-3806.56 2551.5,-3850.56"/>
<text text-anchor="middle" x="2413" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L10</text>
<text text-anchor="middle" x="2413" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 327</text>
<text text-anchor="middle" x="2413" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2413" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_3&#45;&gt;expert_10_3_1 -->
<g id="edge887" class="edge">
<title>route_10_3&#45;&gt;expert_10_3_1</title>
<path fill="none" stroke="black" d="M2413,-3886.21C2413,-3877.93 2413,-3868.95 2413,-3860.64"/>
<polygon fill="black" stroke="black" points="2416.5,-3860.57 2413,-3850.57 2409.5,-3860.57 2416.5,-3860.57"/>
</g>
<!-- tp_10_3 -->
<g id="node734" class="node">
<title>tp_10_3</title>
<ellipse fill="lightblue" stroke="black" cx="3795" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3795" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L10</text>
<text text-anchor="middle" x="3795" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 326↔327</text>
<text text-anchor="middle" x="3795" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3795" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_3_0&#45;&gt;tp_10_3 -->
<g id="edge888" class="edge">
<title>expert_10_3_0&#45;&gt;tp_10_3</title>
<path fill="none" stroke="black" d="M2256.6,-3807.4C2259.76,-3807.1 2262.9,-3806.82 2266,-3806.56 2888.04,-3754.63 3051.14,-3852.11 3670,-3770.56 3681.67,-3769.02 3693.84,-3766.84 3705.8,-3764.35"/>
<polygon fill="black" stroke="black" points="3706.75,-3767.72 3715.79,-3762.18 3705.27,-3760.88 3706.75,-3767.72"/>
</g>
<!-- expert_10_3_1&#45;&gt;tp_10_3 -->
<g id="edge889" class="edge">
<title>expert_10_3_1&#45;&gt;tp_10_3</title>
<path fill="none" stroke="black" d="M2551.6,-3807.43C2554.76,-3807.12 2557.9,-3806.83 2561,-3806.56 3052.3,-3763.86 3181.3,-3836.65 3670,-3770.56 3681.58,-3769 3693.65,-3766.81 3705.52,-3764.33"/>
<polygon fill="black" stroke="black" points="3706.41,-3767.72 3715.44,-3762.18 3704.92,-3760.88 3706.41,-3767.72"/>
</g>
<!-- tp_10_3&#45;&gt;q_proj_11 -->
<g id="edge1869" class="edge">
<title>tp_10_3&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M3874.91,-3716.77C3889.8,-3713.43 3905.3,-3710.4 3920,-3708.34 4288.1,-3656.64 4387.69,-3704.38 4761.69,-3672.4"/>
<polygon fill="black" stroke="black" points="4762.05,-3675.89 4771.71,-3671.54 4761.44,-3668.91 4762.05,-3675.89"/>
</g>
<!-- tp_10_3&#45;&gt;k_proj_11 -->
<g id="edge1870" class="edge">
<title>tp_10_3&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M3874.56,-3716.71C3889.55,-3713.34 3905.18,-3710.33 3920,-3708.34 4426.52,-3640.18 4562.47,-3713.52 5075.45,-3672.41"/>
<polygon fill="black" stroke="black" points="5076.03,-3675.88 5085.71,-3671.58 5075.46,-3668.9 5076.03,-3675.88"/>
</g>
<!-- tp_10_3&#45;&gt;v_proj_11 -->
<g id="edge1871" class="edge">
<title>tp_10_3&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M3875.99,-3717.03C3890.57,-3713.72 3905.68,-3710.64 3920,-3708.34 4099.42,-3679.45 4307.75,-3664.77 4447.32,-3657.61"/>
<polygon fill="black" stroke="black" points="4447.86,-3661.09 4457.67,-3657.08 4447.51,-3654.09 4447.86,-3661.09"/>
</g>
<!-- expert_10_4_0 -->
<g id="node736" class="node">
<title>expert_10_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2846.5,-3850.56 2569.5,-3850.56 2569.5,-3806.56 2846.5,-3806.56 2846.5,-3850.56"/>
<text text-anchor="middle" x="2708" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L10</text>
<text text-anchor="middle" x="2708" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 328</text>
<text text-anchor="middle" x="2708" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2708" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_4&#45;&gt;expert_10_4_0 -->
<g id="edge891" class="edge">
<title>route_10_4&#45;&gt;expert_10_4_0</title>
<path fill="none" stroke="black" d="M2912.08,-3889.83C2872.92,-3878.26 2827.49,-3864.85 2789.44,-3853.61"/>
<polygon fill="black" stroke="black" points="2790.01,-3850.13 2779.43,-3850.66 2788.03,-3856.84 2790.01,-3850.13"/>
</g>
<!-- expert_10_4_1 -->
<g id="node737" class="node">
<title>expert_10_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3141.5,-3850.56 2864.5,-3850.56 2864.5,-3806.56 3141.5,-3806.56 3141.5,-3850.56"/>
<text text-anchor="middle" x="3003" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L10</text>
<text text-anchor="middle" x="3003" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 329</text>
<text text-anchor="middle" x="3003" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3003" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_4&#45;&gt;expert_10_4_1 -->
<g id="edge892" class="edge">
<title>route_10_4&#45;&gt;expert_10_4_1</title>
<path fill="none" stroke="black" d="M3003,-3886.21C3003,-3877.93 3003,-3868.95 3003,-3860.64"/>
<polygon fill="black" stroke="black" points="3006.5,-3860.57 3003,-3850.57 2999.5,-3860.57 3006.5,-3860.57"/>
</g>
<!-- tp_10_4 -->
<g id="node738" class="node">
<title>tp_10_4</title>
<ellipse fill="lightblue" stroke="black" cx="4045" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4045" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L10</text>
<text text-anchor="middle" x="4045" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 328↔329</text>
<text text-anchor="middle" x="4045" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4045" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_4_0&#45;&gt;tp_10_4 -->
<g id="edge893" class="edge">
<title>expert_10_4_0&#45;&gt;tp_10_4</title>
<path fill="none" stroke="black" d="M2846.6,-3807.44C2849.76,-3807.13 2852.9,-3806.83 2856,-3806.56 3327.35,-3765.27 3451.15,-3834.3 3920,-3770.56 3931.58,-3768.99 3943.65,-3766.8 3955.52,-3764.31"/>
<polygon fill="black" stroke="black" points="3956.41,-3767.7 3965.44,-3762.16 3954.92,-3760.86 3956.41,-3767.7"/>
</g>
<!-- expert_10_4_1&#45;&gt;tp_10_4 -->
<g id="edge894" class="edge">
<title>expert_10_4_1&#45;&gt;tp_10_4</title>
<path fill="none" stroke="black" d="M3141.6,-3807.49C3144.76,-3807.17 3147.9,-3806.85 3151,-3806.56 3491.65,-3774.49 3581.27,-3818.85 3920,-3770.56 3931.48,-3768.93 3943.45,-3766.71 3955.24,-3764.23"/>
<polygon fill="black" stroke="black" points="3956.06,-3767.63 3965.08,-3762.08 3954.56,-3760.79 3956.06,-3767.63"/>
</g>
<!-- tp_10_4&#45;&gt;q_proj_11 -->
<g id="edge1872" class="edge">
<title>tp_10_4&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M4125.28,-3716.91C4140.06,-3713.57 4155.43,-3710.52 4170,-3708.34 4427.82,-3669.76 4498.41,-3697.14 4761.46,-3672.44"/>
<polygon fill="black" stroke="black" points="4762.08,-3675.9 4771.7,-3671.46 4761.41,-3668.93 4762.08,-3675.9"/>
</g>
<!-- tp_10_4&#45;&gt;k_proj_11 -->
<g id="edge1873" class="edge">
<title>tp_10_4&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M4124.57,-3716.81C4139.56,-3713.44 4155.19,-3710.4 4170,-3708.34 4566.27,-3653.29 4673.3,-3706.22 5075.54,-3672.41"/>
<polygon fill="black" stroke="black" points="5076.04,-3675.89 5085.71,-3671.55 5075.45,-3668.91 5076.04,-3675.89"/>
</g>
<!-- tp_10_4&#45;&gt;v_proj_11 -->
<g id="edge1874" class="edge">
<title>tp_10_4&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M4127.1,-3717.36C4141.35,-3714.07 4156.06,-3710.92 4170,-3708.34 4261.51,-3691.38 4364.75,-3677.65 4447.79,-3667.91"/>
<polygon fill="black" stroke="black" points="4448.28,-3671.38 4457.81,-3666.75 4447.47,-3664.43 4448.28,-3671.38"/>
</g>
<!-- expert_10_5_0 -->
<g id="node740" class="node">
<title>expert_10_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3436.5,-3850.56 3159.5,-3850.56 3159.5,-3806.56 3436.5,-3806.56 3436.5,-3850.56"/>
<text text-anchor="middle" x="3298" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L10</text>
<text text-anchor="middle" x="3298" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 330</text>
<text text-anchor="middle" x="3298" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3298" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_5&#45;&gt;expert_10_5_0 -->
<g id="edge896" class="edge">
<title>route_10_5&#45;&gt;expert_10_5_0</title>
<path fill="none" stroke="black" d="M3502.08,-3889.83C3462.92,-3878.26 3417.49,-3864.85 3379.44,-3853.61"/>
<polygon fill="black" stroke="black" points="3380.01,-3850.13 3369.43,-3850.66 3378.03,-3856.84 3380.01,-3850.13"/>
</g>
<!-- expert_10_5_1 -->
<g id="node741" class="node">
<title>expert_10_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3731.5,-3850.56 3454.5,-3850.56 3454.5,-3806.56 3731.5,-3806.56 3731.5,-3850.56"/>
<text text-anchor="middle" x="3593" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L10</text>
<text text-anchor="middle" x="3593" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 331</text>
<text text-anchor="middle" x="3593" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3593" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_5&#45;&gt;expert_10_5_1 -->
<g id="edge897" class="edge">
<title>route_10_5&#45;&gt;expert_10_5_1</title>
<path fill="none" stroke="black" d="M3593,-3886.21C3593,-3877.93 3593,-3868.95 3593,-3860.64"/>
<polygon fill="black" stroke="black" points="3596.5,-3860.57 3593,-3850.57 3589.5,-3860.57 3596.5,-3860.57"/>
</g>
<!-- tp_10_5 -->
<g id="node742" class="node">
<title>tp_10_5</title>
<ellipse fill="lightblue" stroke="black" cx="4295" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4295" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L10</text>
<text text-anchor="middle" x="4295" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 330↔331</text>
<text text-anchor="middle" x="4295" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4295" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_5_0&#45;&gt;tp_10_5 -->
<g id="edge898" class="edge">
<title>expert_10_5_0&#45;&gt;tp_10_5</title>
<path fill="none" stroke="black" d="M3436.61,-3807.5C3439.77,-3807.17 3442.9,-3806.86 3446,-3806.56 3766.71,-3775.9 3851.11,-3816.49 4170,-3770.56 4181.48,-3768.91 4193.45,-3766.69 4205.23,-3764.19"/>
<polygon fill="black" stroke="black" points="4206.05,-3767.6 4215.07,-3762.04 4204.56,-3760.76 4206.05,-3767.6"/>
</g>
<!-- expert_10_5_1&#45;&gt;tp_10_5 -->
<g id="edge899" class="edge">
<title>expert_10_5_1&#45;&gt;tp_10_5</title>
<path fill="none" stroke="black" d="M3731.62,-3807.65C3734.78,-3807.27 3737.91,-3806.91 3741,-3806.56 3931.13,-3785.11 3981.11,-3801.06 4170,-3770.56 4181.08,-3768.77 4192.63,-3766.53 4204.03,-3764.07"/>
<polygon fill="black" stroke="black" points="4205,-3767.44 4214,-3761.86 4203.48,-3760.61 4205,-3767.44"/>
</g>
<!-- tp_10_5&#45;&gt;q_proj_11 -->
<g id="edge1875" class="edge">
<title>tp_10_5&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M4376.37,-3717.21C4390.84,-3713.9 4405.81,-3710.78 4420,-3708.34 4567.81,-3682.89 4609.04,-3690.16 4761.48,-3672.49"/>
<polygon fill="black" stroke="black" points="4762.16,-3675.94 4771.68,-3671.29 4761.34,-3668.98 4762.16,-3675.94"/>
</g>
<!-- tp_10_5&#45;&gt;k_proj_11 -->
<g id="edge1876" class="edge">
<title>tp_10_5&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M4375.27,-3716.84C4390.05,-3713.51 4405.42,-3710.47 4420,-3708.34 4706.1,-3666.39 4784.1,-3698.99 5075.68,-3672.42"/>
<polygon fill="black" stroke="black" points="5076.07,-3675.9 5085.7,-3671.49 5075.42,-3668.93 5076.07,-3675.9"/>
</g>
<!-- tp_10_5&#45;&gt;v_proj_11 -->
<g id="edge1877" class="edge">
<title>tp_10_5&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M4373.48,-3716.47C4418.5,-3703.86 4475.05,-3688.02 4521.1,-3675.12"/>
<polygon fill="black" stroke="black" points="4522.08,-3678.48 4530.77,-3672.41 4520.19,-3671.74 4522.08,-3678.48"/>
</g>
<!-- expert_10_6_0 -->
<g id="node744" class="node">
<title>expert_10_6_0</title>
<polygon fill="lightgreen" stroke="black" points="4026.5,-3850.56 3749.5,-3850.56 3749.5,-3806.56 4026.5,-3806.56 4026.5,-3850.56"/>
<text text-anchor="middle" x="3888" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L10</text>
<text text-anchor="middle" x="3888" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 332</text>
<text text-anchor="middle" x="3888" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3888" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_6&#45;&gt;expert_10_6_0 -->
<g id="edge901" class="edge">
<title>route_10_6&#45;&gt;expert_10_6_0</title>
<path fill="none" stroke="black" d="M4092.08,-3889.83C4052.92,-3878.26 4007.49,-3864.85 3969.44,-3853.61"/>
<polygon fill="black" stroke="black" points="3970.01,-3850.13 3959.43,-3850.66 3968.03,-3856.84 3970.01,-3850.13"/>
</g>
<!-- expert_10_6_1 -->
<g id="node745" class="node">
<title>expert_10_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4321.5,-3850.56 4044.5,-3850.56 4044.5,-3806.56 4321.5,-3806.56 4321.5,-3850.56"/>
<text text-anchor="middle" x="4183" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L10</text>
<text text-anchor="middle" x="4183" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 333</text>
<text text-anchor="middle" x="4183" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4183" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_6&#45;&gt;expert_10_6_1 -->
<g id="edge902" class="edge">
<title>route_10_6&#45;&gt;expert_10_6_1</title>
<path fill="none" stroke="black" d="M4183,-3886.21C4183,-3877.93 4183,-3868.95 4183,-3860.64"/>
<polygon fill="black" stroke="black" points="4186.5,-3860.57 4183,-3850.57 4179.5,-3860.57 4186.5,-3860.57"/>
</g>
<!-- tp_10_6 -->
<g id="node746" class="node">
<title>tp_10_6</title>
<ellipse fill="lightblue" stroke="black" cx="4545" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4545" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L10</text>
<text text-anchor="middle" x="4545" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 332↔333</text>
<text text-anchor="middle" x="4545" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4545" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_6_0&#45;&gt;tp_10_6 -->
<g id="edge903" class="edge">
<title>expert_10_6_0&#45;&gt;tp_10_6</title>
<path fill="none" stroke="black" d="M4026.63,-3807.69C4029.78,-3807.3 4032.91,-3806.93 4036,-3806.56 4206.24,-3786.52 4250.91,-3798.71 4420,-3770.56 4431.07,-3768.72 4442.61,-3766.44 4454.02,-3763.97"/>
<polygon fill="black" stroke="black" points="4454.98,-3767.34 4463.98,-3761.75 4453.46,-3760.5 4454.98,-3767.34"/>
</g>
<!-- expert_10_6_1&#45;&gt;tp_10_6 -->
<g id="edge904" class="edge">
<title>expert_10_6_1&#45;&gt;tp_10_6</title>
<path fill="none" stroke="black" d="M4270.51,-3806.52C4315.24,-3795.77 4370.52,-3782.47 4420,-3770.56 4429.87,-3768.19 4440.17,-3765.71 4450.45,-3763.23"/>
<polygon fill="black" stroke="black" points="4451.38,-3766.61 4460.28,-3760.86 4449.74,-3759.8 4451.38,-3766.61"/>
</g>
<!-- tp_10_6&#45;&gt;q_proj_11 -->
<g id="edge1878" class="edge">
<title>tp_10_6&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M4629.35,-3717.98C4642.94,-3714.73 4656.85,-3711.42 4670,-3708.34 4718.15,-3697.05 4771.59,-3684.82 4816.67,-3674.6"/>
<polygon fill="black" stroke="black" points="4817.47,-3678.01 4826.45,-3672.38 4815.92,-3671.18 4817.47,-3678.01"/>
</g>
<!-- tp_10_6&#45;&gt;k_proj_11 -->
<g id="edge1879" class="edge">
<title>tp_10_6&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M4626,-3717.09C4640.58,-3713.78 4655.68,-3710.68 4670,-3708.34 4845.97,-3679.52 4894.76,-3691.91 5075.57,-3672.46"/>
<polygon fill="black" stroke="black" points="5076.13,-3675.92 5085.69,-3671.35 5075.37,-3668.96 5076.13,-3675.92"/>
</g>
<!-- tp_10_6&#45;&gt;v_proj_11 -->
<g id="edge1880" class="edge">
<title>tp_10_6&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M4565.99,-3708.47C4572.26,-3699.52 4579.12,-3689.72 4585.37,-3680.8"/>
<polygon fill="black" stroke="black" points="4588.26,-3682.78 4591.13,-3672.58 4582.52,-3678.76 4588.26,-3682.78"/>
</g>
<!-- expert_10_7_0 -->
<g id="node748" class="node">
<title>expert_10_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4616.5,-3850.56 4339.5,-3850.56 4339.5,-3806.56 4616.5,-3806.56 4616.5,-3850.56"/>
<text text-anchor="middle" x="4478" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L10</text>
<text text-anchor="middle" x="4478" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 334</text>
<text text-anchor="middle" x="4478" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4478" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_7&#45;&gt;expert_10_7_0 -->
<g id="edge906" class="edge">
<title>route_10_7&#45;&gt;expert_10_7_0</title>
<path fill="none" stroke="black" d="M4628.91,-3888.51C4600.68,-3877.48 4568.58,-3864.95 4541.27,-3854.28"/>
<polygon fill="black" stroke="black" points="4542.41,-3850.96 4531.82,-3850.59 4539.86,-3857.48 4542.41,-3850.96"/>
</g>
<!-- expert_10_7_1 -->
<g id="node749" class="node">
<title>expert_10_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4911.5,-3850.56 4634.5,-3850.56 4634.5,-3806.56 4911.5,-3806.56 4911.5,-3850.56"/>
<text text-anchor="middle" x="4773" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L10</text>
<text text-anchor="middle" x="4773" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 335</text>
<text text-anchor="middle" x="4773" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4773" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_7&#45;&gt;expert_10_7_1 -->
<g id="edge907" class="edge">
<title>route_10_7&#45;&gt;expert_10_7_1</title>
<path fill="none" stroke="black" d="M4725.78,-3886.7C4733.25,-3877.65 4741.44,-3867.74 4748.88,-3858.75"/>
<polygon fill="black" stroke="black" points="4751.77,-3860.74 4755.44,-3850.8 4746.38,-3856.28 4751.77,-3860.74"/>
</g>
<!-- tp_10_7 -->
<g id="node750" class="node">
<title>tp_10_7</title>
<ellipse fill="lightblue" stroke="black" cx="4795" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4795" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L10</text>
<text text-anchor="middle" x="4795" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 334↔335</text>
<text text-anchor="middle" x="4795" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4795" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_7_0&#45;&gt;tp_10_7 -->
<g id="edge908" class="edge">
<title>expert_10_7_0&#45;&gt;tp_10_7</title>
<path fill="none" stroke="black" d="M4554.74,-3806.48C4600.34,-3793.94 4658.37,-3778 4705.98,-3764.91"/>
<polygon fill="black" stroke="black" points="4706.94,-3768.28 4715.66,-3762.25 4705.09,-3761.53 4706.94,-3768.28"/>
</g>
<!-- expert_10_7_1&#45;&gt;tp_10_7 -->
<g id="edge909" class="edge">
<title>expert_10_7_1&#45;&gt;tp_10_7</title>
<path fill="none" stroke="black" d="M4778.33,-3806.48C4780.3,-3798.65 4782.62,-3789.48 4784.88,-3780.52"/>
<polygon fill="black" stroke="black" points="4788.34,-3781.12 4787.4,-3770.56 4781.55,-3779.4 4788.34,-3781.12"/>
</g>
<!-- tp_10_7&#45;&gt;q_proj_11 -->
<g id="edge1881" class="edge">
<title>tp_10_7&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M4835.58,-3710.17C4850.24,-3699.95 4866.74,-3688.45 4881.24,-3678.35"/>
<polygon fill="black" stroke="black" points="4883.32,-3681.17 4889.52,-3672.58 4879.31,-3675.42 4883.32,-3681.17"/>
</g>
<!-- tp_10_7&#45;&gt;k_proj_11 -->
<g id="edge1882" class="edge">
<title>tp_10_7&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M4878.23,-3717.7C4892.14,-3714.43 4906.46,-3711.19 4920,-3708.34 4978.43,-3696.01 5043.31,-3683.96 5098.87,-3674.13"/>
<polygon fill="black" stroke="black" points="5099.53,-3677.57 5108.77,-3672.39 5098.31,-3670.68 5099.53,-3677.57"/>
</g>
<!-- tp_10_7&#45;&gt;v_proj_11 -->
<g id="edge1883" class="edge">
<title>tp_10_7&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M4738.04,-3712.2C4713.67,-3700.96 4685.32,-3687.89 4661.15,-3676.76"/>
<polygon fill="black" stroke="black" points="4662.31,-3673.44 4651.76,-3672.43 4659.38,-3679.79 4662.31,-3673.44"/>
</g>
<!-- expert_10_8_0 -->
<g id="node752" class="node">
<title>expert_10_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5206.5,-3850.56 4929.5,-3850.56 4929.5,-3806.56 5206.5,-3806.56 5206.5,-3850.56"/>
<text text-anchor="middle" x="5068" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L10</text>
<text text-anchor="middle" x="5068" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="5068" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5068" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_8&#45;&gt;expert_10_8_0 -->
<g id="edge911" class="edge">
<title>route_10_8&#45;&gt;expert_10_8_0</title>
<path fill="none" stroke="black" d="M5102.46,-3886.21C5097.15,-3877.47 5091.36,-3867.95 5086.07,-3859.26"/>
<polygon fill="black" stroke="black" points="5088.97,-3857.29 5080.78,-3850.57 5082.99,-3860.93 5088.97,-3857.29"/>
</g>
<!-- expert_10_8_1 -->
<g id="node753" class="node">
<title>expert_10_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5501.5,-3850.56 5224.5,-3850.56 5224.5,-3806.56 5501.5,-3806.56 5501.5,-3850.56"/>
<text text-anchor="middle" x="5363" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L10</text>
<text text-anchor="middle" x="5363" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="5363" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5363" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_8&#45;&gt;expert_10_8_1 -->
<g id="edge912" class="edge">
<title>route_10_8&#45;&gt;expert_10_8_1</title>
<path fill="none" stroke="black" d="M5198.24,-3888.87C5229.32,-3877.69 5264.85,-3864.89 5294.94,-3854.06"/>
<polygon fill="black" stroke="black" points="5296.28,-3857.3 5304.5,-3850.62 5293.91,-3850.71 5296.28,-3857.3"/>
</g>
<!-- tp_10_8 -->
<g id="node754" class="node">
<title>tp_10_8</title>
<ellipse fill="lightblue" stroke="black" cx="5045" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5045" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L10</text>
<text text-anchor="middle" x="5045" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="5045" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5045" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_8_0&#45;&gt;tp_10_8 -->
<g id="edge913" class="edge">
<title>expert_10_8_0&#45;&gt;tp_10_8</title>
<path fill="none" stroke="black" d="M5062.43,-3806.48C5060.37,-3798.65 5057.95,-3789.48 5055.58,-3780.52"/>
<polygon fill="black" stroke="black" points="5058.89,-3779.34 5052.95,-3770.56 5052.12,-3781.12 5058.89,-3779.34"/>
</g>
<!-- expert_10_8_1&#45;&gt;tp_10_8 -->
<g id="edge914" class="edge">
<title>expert_10_8_1&#45;&gt;tp_10_8</title>
<path fill="none" stroke="black" d="M5286.02,-3806.48C5240.19,-3793.92 5181.84,-3777.94 5134.04,-3764.84"/>
<polygon fill="black" stroke="black" points="5134.88,-3761.44 5124.31,-3762.18 5133.03,-3768.19 5134.88,-3761.44"/>
</g>
<!-- tp_10_8&#45;&gt;q_proj_11 -->
<g id="edge1884" class="edge">
<title>tp_10_8&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M5004.42,-3710.17C4989.76,-3699.95 4973.26,-3688.45 4958.76,-3678.35"/>
<polygon fill="black" stroke="black" points="4960.69,-3675.42 4950.48,-3672.58 4956.68,-3681.17 4960.69,-3675.42"/>
</g>
<!-- tp_10_8&#45;&gt;k_proj_11 -->
<g id="edge1885" class="edge">
<title>tp_10_8&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M5101.96,-3712.2C5126.33,-3700.96 5154.68,-3687.89 5178.85,-3676.76"/>
<polygon fill="black" stroke="black" points="5180.62,-3679.79 5188.24,-3672.43 5177.69,-3673.44 5180.62,-3679.79"/>
</g>
<!-- tp_10_8&#45;&gt;v_proj_11 -->
<g id="edge1886" class="edge">
<title>tp_10_8&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M4961.77,-3717.7C4947.86,-3714.43 4933.54,-3711.19 4920,-3708.34 4861.57,-3696.01 4796.69,-3683.96 4741.13,-3674.13"/>
<polygon fill="black" stroke="black" points="4741.69,-3670.68 4731.23,-3672.39 4740.47,-3677.57 4741.69,-3670.68"/>
</g>
<!-- expert_10_9_0 -->
<g id="node756" class="node">
<title>expert_10_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5796.5,-3850.56 5519.5,-3850.56 5519.5,-3806.56 5796.5,-3806.56 5796.5,-3850.56"/>
<text text-anchor="middle" x="5658" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L10</text>
<text text-anchor="middle" x="5658" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 354</text>
<text text-anchor="middle" x="5658" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5658" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_9&#45;&gt;expert_10_9_0 -->
<g id="edge916" class="edge">
<title>route_10_9&#45;&gt;expert_10_9_0</title>
<path fill="none" stroke="black" d="M5658,-3886.21C5658,-3877.93 5658,-3868.95 5658,-3860.64"/>
<polygon fill="black" stroke="black" points="5661.5,-3860.57 5658,-3850.57 5654.5,-3860.57 5661.5,-3860.57"/>
</g>
<!-- expert_10_9_1 -->
<g id="node757" class="node">
<title>expert_10_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6091.5,-3850.56 5814.5,-3850.56 5814.5,-3806.56 6091.5,-3806.56 6091.5,-3850.56"/>
<text text-anchor="middle" x="5953" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L10</text>
<text text-anchor="middle" x="5953" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 355</text>
<text text-anchor="middle" x="5953" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5953" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_9&#45;&gt;expert_10_9_1 -->
<g id="edge917" class="edge">
<title>route_10_9&#45;&gt;expert_10_9_1</title>
<path fill="none" stroke="black" d="M5748.92,-3889.83C5788.08,-3878.26 5833.51,-3864.85 5871.56,-3853.61"/>
<polygon fill="black" stroke="black" points="5872.97,-3856.84 5881.57,-3850.66 5870.99,-3850.13 5872.97,-3856.84"/>
</g>
<!-- tp_10_9 -->
<g id="node758" class="node">
<title>tp_10_9</title>
<ellipse fill="lightblue" stroke="black" cx="5295" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5295" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L10</text>
<text text-anchor="middle" x="5295" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 354↔355</text>
<text text-anchor="middle" x="5295" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5295" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_9_0&#45;&gt;tp_10_9 -->
<g id="edge918" class="edge">
<title>expert_10_9_0&#45;&gt;tp_10_9</title>
<path fill="none" stroke="black" d="M5570.11,-3806.54C5525.2,-3795.79 5469.68,-3782.5 5420,-3770.56 5410.05,-3768.17 5399.65,-3765.67 5389.29,-3763.18"/>
<polygon fill="black" stroke="black" points="5389.92,-3759.73 5379.38,-3760.79 5388.28,-3766.54 5389.92,-3759.73"/>
</g>
<!-- expert_10_9_1&#45;&gt;tp_10_9 -->
<g id="edge919" class="edge">
<title>expert_10_9_1&#45;&gt;tp_10_9</title>
<path fill="none" stroke="black" d="M5814.14,-3807.54C5811.4,-3807.21 5808.69,-3806.88 5806,-3806.56 5634.89,-3786.37 5589.97,-3798.81 5420,-3770.56 5408.93,-3768.72 5397.39,-3766.44 5385.98,-3763.97"/>
<polygon fill="black" stroke="black" points="5386.54,-3760.51 5376.01,-3761.75 5385.02,-3767.34 5386.54,-3760.51"/>
</g>
<!-- tp_10_9&#45;&gt;q_proj_11 -->
<g id="edge1887" class="edge">
<title>tp_10_9&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M5210.65,-3717.98C5197.06,-3714.73 5183.15,-3711.42 5170,-3708.34 5121.85,-3697.05 5068.41,-3684.82 5023.33,-3674.6"/>
<polygon fill="black" stroke="black" points="5024.08,-3671.18 5013.55,-3672.38 5022.53,-3678.01 5024.08,-3671.18"/>
</g>
<!-- tp_10_9&#45;&gt;k_proj_11 -->
<g id="edge1888" class="edge">
<title>tp_10_9&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M5274.01,-3708.47C5267.74,-3699.52 5260.88,-3689.72 5254.63,-3680.8"/>
<polygon fill="black" stroke="black" points="5257.48,-3678.76 5248.87,-3672.58 5251.74,-3682.78 5257.48,-3678.76"/>
</g>
<!-- tp_10_9&#45;&gt;v_proj_11 -->
<g id="edge1889" class="edge">
<title>tp_10_9&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M5214,-3717.09C5199.42,-3713.78 5184.32,-3710.68 5170,-3708.34 4994.03,-3679.52 4945.24,-3691.91 4764.43,-3672.46"/>
<polygon fill="black" stroke="black" points="4764.63,-3668.96 4754.31,-3671.35 4763.87,-3675.92 4764.63,-3668.96"/>
</g>
<!-- expert_10_10_0 -->
<g id="node760" class="node">
<title>expert_10_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6386.5,-3850.56 6109.5,-3850.56 6109.5,-3806.56 6386.5,-3806.56 6386.5,-3850.56"/>
<text text-anchor="middle" x="6248" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L10</text>
<text text-anchor="middle" x="6248" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 356</text>
<text text-anchor="middle" x="6248" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6248" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_10&#45;&gt;expert_10_10_0 -->
<g id="edge921" class="edge">
<title>route_10_10&#45;&gt;expert_10_10_0</title>
<path fill="none" stroke="black" d="M6248,-3886.21C6248,-3877.93 6248,-3868.95 6248,-3860.64"/>
<polygon fill="black" stroke="black" points="6251.5,-3860.57 6248,-3850.57 6244.5,-3860.57 6251.5,-3860.57"/>
</g>
<!-- expert_10_10_1 -->
<g id="node761" class="node">
<title>expert_10_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6681.5,-3850.56 6404.5,-3850.56 6404.5,-3806.56 6681.5,-3806.56 6681.5,-3850.56"/>
<text text-anchor="middle" x="6543" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L10</text>
<text text-anchor="middle" x="6543" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 357</text>
<text text-anchor="middle" x="6543" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6543" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_10&#45;&gt;expert_10_10_1 -->
<g id="edge922" class="edge">
<title>route_10_10&#45;&gt;expert_10_10_1</title>
<path fill="none" stroke="black" d="M6338.92,-3889.83C6378.08,-3878.26 6423.51,-3864.85 6461.56,-3853.61"/>
<polygon fill="black" stroke="black" points="6462.97,-3856.84 6471.57,-3850.66 6460.99,-3850.13 6462.97,-3856.84"/>
</g>
<!-- tp_10_10 -->
<g id="node762" class="node">
<title>tp_10_10</title>
<ellipse fill="lightblue" stroke="black" cx="5545" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5545" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L10</text>
<text text-anchor="middle" x="5545" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 356↔357</text>
<text text-anchor="middle" x="5545" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5545" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_10_0&#45;&gt;tp_10_10 -->
<g id="edge923" class="edge">
<title>expert_10_10_0&#45;&gt;tp_10_10</title>
<path fill="none" stroke="black" d="M6109.14,-3807.5C6106.41,-3807.18 6103.69,-3806.87 6101,-3806.56 5910,-3784.96 5859.77,-3801.16 5670,-3770.56 5658.92,-3768.78 5647.37,-3766.53 5635.97,-3764.07"/>
<polygon fill="black" stroke="black" points="5636.52,-3760.61 5626,-3761.87 5635,-3767.45 5636.52,-3760.61"/>
</g>
<!-- expert_10_10_1&#45;&gt;tp_10_10 -->
<g id="edge924" class="edge">
<title>expert_10_10_1&#45;&gt;tp_10_10</title>
<path fill="none" stroke="black" d="M6404.16,-3807.38C6401.42,-3807.09 6398.69,-3806.82 6396,-3806.56 6074.42,-3775.69 5989.77,-3816.59 5670,-3770.56 5658.52,-3768.91 5646.55,-3766.69 5634.77,-3764.2"/>
<polygon fill="black" stroke="black" points="5635.44,-3760.76 5624.93,-3762.05 5633.95,-3767.6 5635.44,-3760.76"/>
</g>
<!-- tp_10_10&#45;&gt;q_proj_11 -->
<g id="edge1890" class="edge">
<title>tp_10_10&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M5463.63,-3717.21C5449.16,-3713.9 5434.19,-3710.78 5420,-3708.34 5272.19,-3682.89 5230.96,-3690.16 5078.52,-3672.49"/>
<polygon fill="black" stroke="black" points="5078.66,-3668.98 5068.32,-3671.29 5077.84,-3675.94 5078.66,-3668.98"/>
</g>
<!-- tp_10_10&#45;&gt;k_proj_11 -->
<g id="edge1891" class="edge">
<title>tp_10_10&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M5466.52,-3716.47C5421.5,-3703.86 5364.95,-3688.02 5318.9,-3675.12"/>
<polygon fill="black" stroke="black" points="5319.81,-3671.74 5309.23,-3672.41 5317.92,-3678.48 5319.81,-3671.74"/>
</g>
<!-- tp_10_10&#45;&gt;v_proj_11 -->
<g id="edge1892" class="edge">
<title>tp_10_10&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M5464.73,-3716.84C5449.95,-3713.51 5434.58,-3710.47 5420,-3708.34 5133.9,-3666.39 5055.9,-3698.99 4764.32,-3672.42"/>
<polygon fill="black" stroke="black" points="4764.58,-3668.93 4754.3,-3671.49 4763.93,-3675.9 4764.58,-3668.93"/>
</g>
<!-- expert_10_11_0 -->
<g id="node764" class="node">
<title>expert_10_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6976.5,-3850.56 6699.5,-3850.56 6699.5,-3806.56 6976.5,-3806.56 6976.5,-3850.56"/>
<text text-anchor="middle" x="6838" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L10</text>
<text text-anchor="middle" x="6838" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 358</text>
<text text-anchor="middle" x="6838" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6838" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_11&#45;&gt;expert_10_11_0 -->
<g id="edge926" class="edge">
<title>route_10_11&#45;&gt;expert_10_11_0</title>
<path fill="none" stroke="black" d="M6838,-3886.21C6838,-3877.93 6838,-3868.95 6838,-3860.64"/>
<polygon fill="black" stroke="black" points="6841.5,-3860.57 6838,-3850.57 6834.5,-3860.57 6841.5,-3860.57"/>
</g>
<!-- expert_10_11_1 -->
<g id="node765" class="node">
<title>expert_10_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7271.5,-3850.56 6994.5,-3850.56 6994.5,-3806.56 7271.5,-3806.56 7271.5,-3850.56"/>
<text text-anchor="middle" x="7133" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L10</text>
<text text-anchor="middle" x="7133" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 359</text>
<text text-anchor="middle" x="7133" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7133" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_11&#45;&gt;expert_10_11_1 -->
<g id="edge927" class="edge">
<title>route_10_11&#45;&gt;expert_10_11_1</title>
<path fill="none" stroke="black" d="M6928.92,-3889.83C6968.08,-3878.26 7013.51,-3864.85 7051.56,-3853.61"/>
<polygon fill="black" stroke="black" points="7052.97,-3856.84 7061.57,-3850.66 7050.99,-3850.13 7052.97,-3856.84"/>
</g>
<!-- tp_10_11 -->
<g id="node766" class="node">
<title>tp_10_11</title>
<ellipse fill="lightblue" stroke="black" cx="5795" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5795" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L10</text>
<text text-anchor="middle" x="5795" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 358↔359</text>
<text text-anchor="middle" x="5795" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5795" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_11_0&#45;&gt;tp_10_11 -->
<g id="edge928" class="edge">
<title>expert_10_11_0&#45;&gt;tp_10_11</title>
<path fill="none" stroke="black" d="M6699.16,-3807.37C6696.42,-3807.09 6693.69,-3806.82 6691,-3806.56 6349.48,-3774.27 6259.61,-3818.95 5920,-3770.56 5908.52,-3768.93 5896.55,-3766.71 5884.76,-3764.23"/>
<polygon fill="black" stroke="black" points="5885.44,-3760.79 5874.92,-3762.08 5883.94,-3767.63 5885.44,-3760.79"/>
</g>
<!-- expert_10_11_1&#45;&gt;tp_10_11 -->
<g id="edge929" class="edge">
<title>expert_10_11_1&#45;&gt;tp_10_11</title>
<path fill="none" stroke="black" d="M6994.16,-3807.32C6991.42,-3807.05 6988.7,-3806.8 6986,-3806.56 6513.78,-3764.98 6389.73,-3834.4 5920,-3770.56 5908.42,-3768.99 5896.35,-3766.8 5884.48,-3764.31"/>
<polygon fill="black" stroke="black" points="5885.08,-3760.86 5874.56,-3762.16 5883.59,-3767.7 5885.08,-3760.86"/>
</g>
<!-- tp_10_11&#45;&gt;q_proj_11 -->
<g id="edge1893" class="edge">
<title>tp_10_11&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M5714.72,-3716.91C5699.94,-3713.57 5684.57,-3710.52 5670,-3708.34 5412.18,-3669.76 5341.59,-3697.14 5078.54,-3672.44"/>
<polygon fill="black" stroke="black" points="5078.59,-3668.93 5068.3,-3671.46 5077.92,-3675.9 5078.59,-3668.93"/>
</g>
<!-- tp_10_11&#45;&gt;k_proj_11 -->
<g id="edge1894" class="edge">
<title>tp_10_11&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M5712.9,-3717.36C5698.65,-3714.07 5683.94,-3710.92 5670,-3708.34 5578.49,-3691.38 5475.25,-3677.65 5392.21,-3667.91"/>
<polygon fill="black" stroke="black" points="5392.53,-3664.43 5382.19,-3666.75 5391.72,-3671.38 5392.53,-3664.43"/>
</g>
<!-- tp_10_11&#45;&gt;v_proj_11 -->
<g id="edge1895" class="edge">
<title>tp_10_11&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M5715.43,-3716.81C5700.44,-3713.44 5684.81,-3710.4 5670,-3708.34 5273.73,-3653.29 5166.7,-3706.22 4764.46,-3672.41"/>
<polygon fill="black" stroke="black" points="4764.55,-3668.91 4754.29,-3671.55 4763.96,-3675.89 4764.55,-3668.91"/>
</g>
<!-- expert_10_12_0 -->
<g id="node768" class="node">
<title>expert_10_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7566.5,-3850.56 7289.5,-3850.56 7289.5,-3806.56 7566.5,-3806.56 7566.5,-3850.56"/>
<text text-anchor="middle" x="7428" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L10</text>
<text text-anchor="middle" x="7428" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 360</text>
<text text-anchor="middle" x="7428" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7428" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_12&#45;&gt;expert_10_12_0 -->
<g id="edge931" class="edge">
<title>route_10_12&#45;&gt;expert_10_12_0</title>
<path fill="none" stroke="black" d="M7428,-3886.21C7428,-3877.93 7428,-3868.95 7428,-3860.64"/>
<polygon fill="black" stroke="black" points="7431.5,-3860.57 7428,-3850.57 7424.5,-3860.57 7431.5,-3860.57"/>
</g>
<!-- expert_10_12_1 -->
<g id="node769" class="node">
<title>expert_10_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7861.5,-3850.56 7584.5,-3850.56 7584.5,-3806.56 7861.5,-3806.56 7861.5,-3850.56"/>
<text text-anchor="middle" x="7723" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L10</text>
<text text-anchor="middle" x="7723" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 361</text>
<text text-anchor="middle" x="7723" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7723" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_12&#45;&gt;expert_10_12_1 -->
<g id="edge932" class="edge">
<title>route_10_12&#45;&gt;expert_10_12_1</title>
<path fill="none" stroke="black" d="M7518.92,-3889.83C7558.08,-3878.26 7603.51,-3864.85 7641.56,-3853.61"/>
<polygon fill="black" stroke="black" points="7642.97,-3856.84 7651.57,-3850.66 7640.99,-3850.13 7642.97,-3856.84"/>
</g>
<!-- tp_10_12 -->
<g id="node770" class="node">
<title>tp_10_12</title>
<ellipse fill="lightblue" stroke="black" cx="6045" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6045" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L10</text>
<text text-anchor="middle" x="6045" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 360↔361</text>
<text text-anchor="middle" x="6045" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6045" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_12_0&#45;&gt;tp_10_12 -->
<g id="edge933" class="edge">
<title>expert_10_12_0&#45;&gt;tp_10_12</title>
<path fill="none" stroke="black" d="M7289.16,-3807.32C7286.42,-3807.05 7283.7,-3806.8 7281,-3806.56 6788.84,-3763.56 6659.58,-3836.76 6170,-3770.56 6158.42,-3769 6146.35,-3766.81 6134.48,-3764.33"/>
<polygon fill="black" stroke="black" points="6135.08,-3760.88 6124.56,-3762.18 6133.59,-3767.72 6135.08,-3760.88"/>
</g>
<!-- expert_10_12_1&#45;&gt;tp_10_12 -->
<g id="edge934" class="edge">
<title>expert_10_12_1&#45;&gt;tp_10_12</title>
<path fill="none" stroke="black" d="M7584.16,-3807.29C7581.42,-3807.03 7578.7,-3806.79 7576,-3806.56 6953.1,-3754.27 6789.74,-3852.21 6170,-3770.56 6158.33,-3769.02 6146.16,-3766.84 6134.2,-3764.35"/>
<polygon fill="black" stroke="black" points="6134.73,-3760.88 6124.21,-3762.18 6133.25,-3767.72 6134.73,-3760.88"/>
</g>
<!-- tp_10_12&#45;&gt;q_proj_11 -->
<g id="edge1896" class="edge">
<title>tp_10_12&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M5965.09,-3716.77C5950.2,-3713.43 5934.7,-3710.4 5920,-3708.34 5551.9,-3656.64 5452.31,-3704.38 5078.31,-3672.4"/>
<polygon fill="black" stroke="black" points="5078.56,-3668.91 5068.29,-3671.54 5077.95,-3675.89 5078.56,-3668.91"/>
</g>
<!-- tp_10_12&#45;&gt;k_proj_11 -->
<g id="edge1897" class="edge">
<title>tp_10_12&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M5964.01,-3717.03C5949.43,-3713.72 5934.32,-3710.64 5920,-3708.34 5740.58,-3679.45 5532.25,-3664.77 5392.68,-3657.61"/>
<polygon fill="black" stroke="black" points="5392.49,-3654.09 5382.33,-3657.08 5392.14,-3661.09 5392.49,-3654.09"/>
</g>
<!-- tp_10_12&#45;&gt;v_proj_11 -->
<g id="edge1898" class="edge">
<title>tp_10_12&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M5965.44,-3716.71C5950.45,-3713.34 5934.82,-3710.33 5920,-3708.34 5413.48,-3640.18 5277.53,-3713.52 4764.55,-3672.41"/>
<polygon fill="black" stroke="black" points="4764.54,-3668.9 4754.29,-3671.58 4763.97,-3675.88 4764.54,-3668.9"/>
</g>
<!-- expert_10_13_0 -->
<g id="node772" class="node">
<title>expert_10_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8156.5,-3850.56 7879.5,-3850.56 7879.5,-3806.56 8156.5,-3806.56 8156.5,-3850.56"/>
<text text-anchor="middle" x="8018" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L10</text>
<text text-anchor="middle" x="8018" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 362</text>
<text text-anchor="middle" x="8018" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8018" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_13&#45;&gt;expert_10_13_0 -->
<g id="edge936" class="edge">
<title>route_10_13&#45;&gt;expert_10_13_0</title>
<path fill="none" stroke="black" d="M8018,-3886.21C8018,-3877.93 8018,-3868.95 8018,-3860.64"/>
<polygon fill="black" stroke="black" points="8021.5,-3860.57 8018,-3850.57 8014.5,-3860.57 8021.5,-3860.57"/>
</g>
<!-- expert_10_13_1 -->
<g id="node773" class="node">
<title>expert_10_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8451.5,-3850.56 8174.5,-3850.56 8174.5,-3806.56 8451.5,-3806.56 8451.5,-3850.56"/>
<text text-anchor="middle" x="8313" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L10</text>
<text text-anchor="middle" x="8313" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 363</text>
<text text-anchor="middle" x="8313" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8313" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_13&#45;&gt;expert_10_13_1 -->
<g id="edge937" class="edge">
<title>route_10_13&#45;&gt;expert_10_13_1</title>
<path fill="none" stroke="black" d="M8108.92,-3889.83C8148.08,-3878.26 8193.51,-3864.85 8231.56,-3853.61"/>
<polygon fill="black" stroke="black" points="8232.97,-3856.84 8241.57,-3850.66 8230.99,-3850.13 8232.97,-3856.84"/>
</g>
<!-- tp_10_13 -->
<g id="node774" class="node">
<title>tp_10_13</title>
<ellipse fill="lightblue" stroke="black" cx="6295" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6295" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L10</text>
<text text-anchor="middle" x="6295" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 362↔363</text>
<text text-anchor="middle" x="6295" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6295" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_13_0&#45;&gt;tp_10_13 -->
<g id="edge938" class="edge">
<title>expert_10_13_0&#45;&gt;tp_10_13</title>
<path fill="none" stroke="black" d="M7879.16,-3807.29C7876.42,-3807.03 7873.7,-3806.79 7871,-3806.56 7228.15,-3752.86 7059.59,-3854.57 6420,-3770.56 6408.33,-3769.03 6396.16,-3766.85 6384.2,-3764.36"/>
<polygon fill="black" stroke="black" points="6384.73,-3760.89 6374.21,-3762.19 6383.25,-3767.73 6384.73,-3760.89"/>
</g>
<!-- expert_10_13_1&#45;&gt;tp_10_13 -->
<g id="edge939" class="edge">
<title>expert_10_13_1&#45;&gt;tp_10_13</title>
<path fill="none" stroke="black" d="M8174.17,-3807.27C8171.42,-3807.02 8168.7,-3806.78 8166,-3806.56 7779.2,-3775.06 6804.88,-3820.3 6420,-3770.56 6408.33,-3769.05 6396.16,-3766.89 6384.19,-3764.4"/>
<polygon fill="black" stroke="black" points="6384.72,-3760.94 6374.21,-3762.25 6383.24,-3767.78 6384.72,-3760.94"/>
</g>
<!-- tp_10_13&#45;&gt;q_proj_11 -->
<g id="edge1899" class="edge">
<title>tp_10_13&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M6215.44,-3716.73C6200.45,-3713.36 6184.82,-3710.35 6170,-3708.34 5691.65,-3643.53 5563.12,-3711.66 5078.35,-3672.4"/>
<polygon fill="black" stroke="black" points="5078.54,-3668.9 5068.29,-3671.57 5077.97,-3675.88 5078.54,-3668.9"/>
</g>
<!-- tp_10_13&#45;&gt;k_proj_11 -->
<g id="edge1900" class="edge">
<title>tp_10_13&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M6214.72,-3716.91C6199.94,-3713.58 6184.57,-3710.52 6170,-3708.34 5898.86,-3667.74 5579.41,-3655.89 5392.54,-3652.53"/>
<polygon fill="black" stroke="black" points="5392.42,-3649.03 5382.36,-3652.36 5392.3,-3656.03 5392.42,-3649.03"/>
</g>
<!-- tp_10_13&#45;&gt;v_proj_11 -->
<g id="edge1901" class="edge">
<title>tp_10_13&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M6215.79,-3716.71C6200.69,-3713.33 6184.94,-3710.31 6170,-3708.34 5553.15,-3627.07 5388.34,-3720.86 4764.44,-3672.4"/>
<polygon fill="black" stroke="black" points="4764.53,-3668.9 4754.29,-3671.6 4763.98,-3675.88 4764.53,-3668.9"/>
</g>
<!-- expert_10_14_0 -->
<g id="node776" class="node">
<title>expert_10_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8746.5,-3850.56 8469.5,-3850.56 8469.5,-3806.56 8746.5,-3806.56 8746.5,-3850.56"/>
<text text-anchor="middle" x="8608" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L10</text>
<text text-anchor="middle" x="8608" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 364</text>
<text text-anchor="middle" x="8608" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8608" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_14&#45;&gt;expert_10_14_0 -->
<g id="edge941" class="edge">
<title>route_10_14&#45;&gt;expert_10_14_0</title>
<path fill="none" stroke="black" d="M8608,-3886.21C8608,-3877.93 8608,-3868.95 8608,-3860.64"/>
<polygon fill="black" stroke="black" points="8611.5,-3860.57 8608,-3850.57 8604.5,-3860.57 8611.5,-3860.57"/>
</g>
<!-- expert_10_14_1 -->
<g id="node777" class="node">
<title>expert_10_14_1</title>
<polygon fill="lightgreen" stroke="black" points="9041.5,-3850.56 8764.5,-3850.56 8764.5,-3806.56 9041.5,-3806.56 9041.5,-3850.56"/>
<text text-anchor="middle" x="8903" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L10</text>
<text text-anchor="middle" x="8903" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 365</text>
<text text-anchor="middle" x="8903" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8903" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_14&#45;&gt;expert_10_14_1 -->
<g id="edge942" class="edge">
<title>route_10_14&#45;&gt;expert_10_14_1</title>
<path fill="none" stroke="black" d="M8698.92,-3889.83C8738.08,-3878.26 8783.51,-3864.85 8821.56,-3853.61"/>
<polygon fill="black" stroke="black" points="8822.97,-3856.84 8831.57,-3850.66 8820.99,-3850.13 8822.97,-3856.84"/>
</g>
<!-- tp_10_14 -->
<g id="node778" class="node">
<title>tp_10_14</title>
<ellipse fill="lightblue" stroke="black" cx="6545" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6545" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L10</text>
<text text-anchor="middle" x="6545" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 364↔365</text>
<text text-anchor="middle" x="6545" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6545" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_14_0&#45;&gt;tp_10_14 -->
<g id="edge943" class="edge">
<title>expert_10_14_0&#45;&gt;tp_10_14</title>
<path fill="none" stroke="black" d="M8469.17,-3807.27C8466.42,-3807.02 8463.7,-3806.78 8461,-3806.56 8064.22,-3774.35 7064.81,-3821.48 6670,-3770.56 6658.33,-3769.06 6646.16,-3766.89 6634.19,-3764.41"/>
<polygon fill="black" stroke="black" points="6634.72,-3760.94 6624.21,-3762.25 6633.24,-3767.78 6634.72,-3760.94"/>
</g>
<!-- expert_10_14_1&#45;&gt;tp_10_14 -->
<g id="edge944" class="edge">
<title>expert_10_14_1&#45;&gt;tp_10_14</title>
<path fill="none" stroke="black" d="M8764.17,-3807.26C8761.42,-3807.01 8758.7,-3806.78 8756,-3806.56 8293.84,-3769.71 7129.9,-3829.21 6670,-3770.56 6658.32,-3769.07 6646.15,-3766.92 6634.19,-3764.44"/>
<polygon fill="black" stroke="black" points="6634.71,-3760.97 6624.2,-3762.29 6633.24,-3767.82 6634.71,-3760.97"/>
</g>
<!-- tp_10_14&#45;&gt;q_proj_11 -->
<g id="edge1902" class="edge">
<title>tp_10_14&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M6465.45,-3716.65C6450.45,-3713.3 6434.83,-3710.3 6420,-3708.34 5831.38,-3630.43 5673.96,-3718.98 5078.42,-3672.4"/>
<polygon fill="black" stroke="black" points="5078.53,-3668.9 5068.29,-3671.6 5077.98,-3675.88 5078.53,-3668.9"/>
</g>
<!-- tp_10_14&#45;&gt;k_proj_11 -->
<g id="edge1903" class="edge">
<title>tp_10_14&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M6465.08,-3716.84C6450.19,-3713.48 6434.69,-3710.44 6420,-3708.34 6226.37,-3680.61 5668.04,-3662.67 5392.15,-3655.24"/>
<polygon fill="black" stroke="black" points="5392.14,-3651.74 5382.05,-3654.97 5391.95,-3658.74 5392.14,-3651.74"/>
</g>
<!-- tp_10_14&#45;&gt;v_proj_11 -->
<g id="edge1904" class="edge">
<title>tp_10_14&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M6465.79,-3716.67C6450.7,-3713.29 6434.94,-3710.28 6420,-3708.34 6057.96,-3661.35 5146.42,-3700.1 4764.33,-3672.37"/>
<polygon fill="black" stroke="black" points="4764.52,-3668.88 4754.29,-3671.62 4764,-3675.86 4764.52,-3668.88"/>
</g>
<!-- expert_10_15_0 -->
<g id="node780" class="node">
<title>expert_10_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9336.5,-3850.56 9059.5,-3850.56 9059.5,-3806.56 9336.5,-3806.56 9336.5,-3850.56"/>
<text text-anchor="middle" x="9198" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L10</text>
<text text-anchor="middle" x="9198" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 366</text>
<text text-anchor="middle" x="9198" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9198" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_15&#45;&gt;expert_10_15_0 -->
<g id="edge946" class="edge">
<title>route_10_15&#45;&gt;expert_10_15_0</title>
<path fill="none" stroke="black" d="M9198,-3886.21C9198,-3877.93 9198,-3868.95 9198,-3860.64"/>
<polygon fill="black" stroke="black" points="9201.5,-3860.57 9198,-3850.57 9194.5,-3860.57 9201.5,-3860.57"/>
</g>
<!-- expert_10_15_1 -->
<g id="node781" class="node">
<title>expert_10_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9631.5,-3850.56 9354.5,-3850.56 9354.5,-3806.56 9631.5,-3806.56 9631.5,-3850.56"/>
<text text-anchor="middle" x="9493" y="-3841.36" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L10</text>
<text text-anchor="middle" x="9493" y="-3831.36" font-family="Times,serif" font-size="9.00">GPU: 367</text>
<text text-anchor="middle" x="9493" y="-3821.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9493" y="-3811.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_15&#45;&gt;expert_10_15_1 -->
<g id="edge947" class="edge">
<title>route_10_15&#45;&gt;expert_10_15_1</title>
<path fill="none" stroke="black" d="M9288.92,-3889.83C9328.08,-3878.26 9373.51,-3864.85 9411.56,-3853.61"/>
<polygon fill="black" stroke="black" points="9412.97,-3856.84 9421.57,-3850.66 9410.99,-3850.13 9412.97,-3856.84"/>
</g>
<!-- tp_10_15 -->
<g id="node782" class="node">
<title>tp_10_15</title>
<ellipse fill="lightblue" stroke="black" cx="6795" cy="-3739.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6795" y="-3752.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L10</text>
<text text-anchor="middle" x="6795" y="-3742.25" font-family="Times,serif" font-size="9.00">GPU: 366↔367</text>
<text text-anchor="middle" x="6795" y="-3732.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6795" y="-3722.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_15_0&#45;&gt;tp_10_15 -->
<g id="edge948" class="edge">
<title>expert_10_15_0&#45;&gt;tp_10_15</title>
<path fill="none" stroke="black" d="M9059.16,-3807.3C9056.42,-3807.04 9053.7,-3806.79 9051,-3806.56 8632.38,-3770.64 7331.95,-3748.51 6920.89,-3742.27"/>
<polygon fill="black" stroke="black" points="6920.8,-3738.77 6910.75,-3742.12 6920.7,-3745.77 6920.8,-3738.77"/>
</g>
<!-- expert_10_15_1&#45;&gt;tp_10_15 -->
<g id="edge949" class="edge">
<title>expert_10_15_1&#45;&gt;tp_10_15</title>
<path fill="none" stroke="black" d="M9354.16,-3807.29C9351.42,-3807.03 9348.7,-3806.79 9346,-3806.56 8866.93,-3766.27 7366.66,-3746.78 6921.03,-3741.78"/>
<polygon fill="black" stroke="black" points="6921.05,-3738.28 6911.02,-3741.67 6920.98,-3745.28 6921.05,-3738.28"/>
</g>
<!-- tp_10_15&#45;&gt;q_proj_11 -->
<g id="edge1905" class="edge">
<title>tp_10_15&#45;&gt;q_proj_11</title>
<path fill="none" stroke="black" d="M6715.79,-3716.68C6700.69,-3713.3 6684.94,-3710.28 6670,-3708.34 6322.13,-3663.04 5446.47,-3699.17 5078.49,-3672.38"/>
<polygon fill="black" stroke="black" points="5078.52,-3668.88 5068.29,-3671.62 5078,-3675.86 5078.52,-3668.88"/>
</g>
<!-- tp_10_15&#45;&gt;k_proj_11 -->
<g id="edge1906" class="edge">
<title>tp_10_15&#45;&gt;k_proj_11</title>
<path fill="none" stroke="black" d="M6715.43,-3716.81C6700.44,-3713.44 6684.81,-3710.4 6670,-3708.34 6427.51,-3674.65 5712.94,-3659.12 5392.56,-3653.7"/>
<polygon fill="black" stroke="black" points="5392.32,-3650.19 5382.27,-3653.53 5392.21,-3657.19 5392.32,-3650.19"/>
</g>
<!-- tp_10_15&#45;&gt;v_proj_11 -->
<g id="edge1907" class="edge">
<title>tp_10_15&#45;&gt;v_proj_11</title>
<path fill="none" stroke="black" d="M6715.8,-3716.63C6700.7,-3713.26 6684.94,-3710.26 6670,-3708.34 6252.88,-3654.81 5202.22,-3703.71 4764.51,-3672.38"/>
<polygon fill="black" stroke="black" points="4764.52,-3668.88 4754.29,-3671.63 4764,-3675.86 4764.52,-3668.88"/>
</g>
<!-- attn_scores_11 -->
<g id="node786" class="node">
<title>attn_scores_11</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-3592.34 4753.5,-3592.34 4753.5,-3548.34 5086.5,-3548.34 5086.5,-3592.34"/>
<text text-anchor="middle" x="4920" y="-3583.14" font-family="Times,serif" font-size="9.00">Attention Scores L11</text>
<text text-anchor="middle" x="4920" y="-3573.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4920" y="-3563.14" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-3553.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_11&#45;&gt;attn_scores_11 -->
<g id="edge950" class="edge">
<title>q_proj_11&#45;&gt;attn_scores_11</title>
<path fill="none" stroke="black" d="M4920,-3628.02C4920,-3620.13 4920,-3611.02 4920,-3602.44"/>
<polygon fill="black" stroke="black" points="4923.5,-3602.36 4920,-3592.36 4916.5,-3602.36 4923.5,-3602.36"/>
</g>
<!-- k_proj_11&#45;&gt;attn_scores_11 -->
<g id="edge951" class="edge">
<title>k_proj_11&#45;&gt;attn_scores_11</title>
<path fill="none" stroke="black" d="M5149.44,-3628.33C5107.82,-3617.99 5057.49,-3605.49 5014.59,-3594.83"/>
<polygon fill="black" stroke="black" points="5015.26,-3591.39 5004.71,-3592.38 5013.57,-3598.19 5015.26,-3591.39"/>
</g>
<!-- v_proj_11&#45;&gt;attn_scores_11 -->
<g id="edge952" class="edge">
<title>v_proj_11&#45;&gt;attn_scores_11</title>
<path fill="none" stroke="black" d="M4690.56,-3628.33C4732.18,-3617.99 4782.51,-3605.49 4825.41,-3594.83"/>
<polygon fill="black" stroke="black" points="4826.43,-3598.19 4835.29,-3592.38 4824.74,-3591.39 4826.43,-3598.19"/>
</g>
<!-- softmax_11 -->
<g id="node787" class="node">
<title>softmax_11</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-3512.34 4753.5,-3512.34 4753.5,-3468.34 5086.5,-3468.34 5086.5,-3512.34"/>
<text text-anchor="middle" x="4920" y="-3503.14" font-family="Times,serif" font-size="9.00">Softmax L11</text>
<text text-anchor="middle" x="4920" y="-3493.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4920" y="-3483.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4920" y="-3473.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_11&#45;&gt;softmax_11 -->
<g id="edge953" class="edge">
<title>attn_scores_11&#45;&gt;softmax_11</title>
<path fill="none" stroke="black" d="M4920,-3548.02C4920,-3540.13 4920,-3531.02 4920,-3522.44"/>
<polygon fill="black" stroke="black" points="4923.5,-3522.36 4920,-3512.36 4916.5,-3522.36 4923.5,-3522.36"/>
</g>
<!-- attn_out_11 -->
<g id="node788" class="node">
<title>attn_out_11</title>
<polygon fill="lightgreen" stroke="black" points="5068,-3432.34 4772,-3432.34 4772,-3388.34 5068,-3388.34 5068,-3432.34"/>
<text text-anchor="middle" x="4920" y="-3423.14" font-family="Times,serif" font-size="9.00">Attention Output L11</text>
<text text-anchor="middle" x="4920" y="-3413.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="4920" y="-3403.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-3393.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_11&#45;&gt;attn_out_11 -->
<g id="edge954" class="edge">
<title>softmax_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M4920,-3468.02C4920,-3460.13 4920,-3451.02 4920,-3442.44"/>
<polygon fill="black" stroke="black" points="4923.5,-3442.36 4920,-3432.36 4916.5,-3442.36 4923.5,-3442.36"/>
</g>
<!-- gate_11 -->
<g id="node789" class="node">
<title>gate_11</title>
<polygon fill="lightyellow" stroke="black" points="5219.74,-3352.34 4742.92,-3352.34 4620.26,-3264.34 5097.08,-3264.34 5219.74,-3352.34"/>
<text text-anchor="middle" x="4920" y="-3321.14" font-family="Times,serif" font-size="9.00">Gate L11</text>
<text text-anchor="middle" x="4920" y="-3311.14" font-family="Times,serif" font-size="9.00">GPU: 320&#45;383</text>
<text text-anchor="middle" x="4920" y="-3301.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-3291.14" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_11&#45;&gt;gate_11 -->
<g id="edge955" class="edge">
<title>attn_out_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M4920,-3388.13C4920,-3380.63 4920,-3371.82 4920,-3362.86"/>
<polygon fill="black" stroke="black" points="4923.5,-3362.74 4920,-3352.74 4916.5,-3362.74 4923.5,-3362.74"/>
</g>
<!-- route_11_0 -->
<g id="node790" class="node">
<title>route_11_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="643" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="643" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="643" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="643" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="643" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_0 -->
<g id="edge956" class="edge">
<title>gate_11&#45;&gt;route_11_0</title>
<path fill="none" stroke="black" d="M4680.09,-3307.38C4069.43,-3306.42 2406.63,-3297.12 1023,-3228.34 957.75,-3225.09 886.32,-3219.87 823.17,-3214.68"/>
<polygon fill="black" stroke="black" points="823.36,-3211.19 813.11,-3213.85 822.79,-3218.16 823.36,-3211.19"/>
</g>
<!-- route_11_1 -->
<g id="node794" class="node">
<title>route_11_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1233" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1233" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1233" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 322,323</text>
<text text-anchor="middle" x="1233" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1233" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_1 -->
<g id="edge961" class="edge">
<title>gate_11&#45;&gt;route_11_1</title>
<path fill="none" stroke="black" d="M4678.4,-3306.13C4131.99,-3302.4 2759.53,-3287.41 1613,-3228.34 1547.91,-3224.98 1476.67,-3219.75 1413.63,-3214.59"/>
<polygon fill="black" stroke="black" points="1413.84,-3211.09 1403.59,-3213.76 1413.27,-3218.07 1413.84,-3211.09"/>
</g>
<!-- route_11_2 -->
<g id="node798" class="node">
<title>route_11_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1823" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1823" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1823" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 324,325</text>
<text text-anchor="middle" x="1823" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1823" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_2 -->
<g id="edge966" class="edge">
<title>gate_11&#45;&gt;route_11_2</title>
<path fill="none" stroke="black" d="M4675.82,-3304.33C4199.8,-3297.56 3114.5,-3277.67 2203,-3228.34 2138.08,-3224.82 2067.02,-3219.57 2004.1,-3214.43"/>
<polygon fill="black" stroke="black" points="2004.32,-3210.94 1994.07,-3213.61 2003.75,-3217.92 2004.32,-3210.94"/>
</g>
<!-- route_11_3 -->
<g id="node802" class="node">
<title>route_11_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2413" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2413" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2413" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 326,327</text>
<text text-anchor="middle" x="2413" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2413" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_3 -->
<g id="edge971" class="edge">
<title>gate_11&#45;&gt;route_11_3</title>
<path fill="none" stroke="black" d="M4671.78,-3301.5C4274.71,-3291.39 3472.24,-3267.85 2793,-3228.34 2728.41,-3224.58 2657.73,-3219.3 2595.03,-3214.21"/>
<polygon fill="black" stroke="black" points="2595.29,-3210.72 2585.04,-3213.39 2594.72,-3217.7 2595.29,-3210.72"/>
</g>
<!-- route_11_4 -->
<g id="node806" class="node">
<title>route_11_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3003" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3003" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="3003" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 328,329</text>
<text text-anchor="middle" x="3003" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3003" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_4 -->
<g id="edge976" class="edge">
<title>gate_11&#45;&gt;route_11_4</title>
<path fill="none" stroke="black" d="M4664.91,-3296.39C4359.88,-3282.8 3833.93,-3257.79 3383,-3228.34 3319.04,-3224.16 3249.08,-3218.83 3186.82,-3213.82"/>
<polygon fill="black" stroke="black" points="3186.74,-3210.31 3176.49,-3212.99 3186.18,-3217.28 3186.74,-3210.31"/>
</g>
<!-- route_11_5 -->
<g id="node810" class="node">
<title>route_11_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3593" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3593" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3593" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 330,331</text>
<text text-anchor="middle" x="3593" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3593" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_5 -->
<g id="edge981" class="edge">
<title>gate_11&#45;&gt;route_11_5</title>
<path fill="none" stroke="black" d="M4649.06,-3285.06C4389.32,-3263.7 4004.23,-3232.04 3777.92,-3213.43"/>
<polygon fill="black" stroke="black" points="3778.18,-3209.94 3767.93,-3212.61 3777.61,-3216.92 3778.18,-3209.94"/>
</g>
<!-- route_11_6 -->
<g id="node814" class="node">
<title>route_11_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4183" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4183" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4183" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 332,333</text>
<text text-anchor="middle" x="4183" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4183" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_6 -->
<g id="edge986" class="edge">
<title>gate_11&#45;&gt;route_11_6</title>
<path fill="none" stroke="black" d="M4629.51,-3264.33C4528.8,-3249.42 4419.94,-3233.3 4334.92,-3220.72"/>
<polygon fill="black" stroke="black" points="4335.34,-3217.24 4324.93,-3219.24 4334.31,-3224.16 4335.34,-3217.24"/>
</g>
<!-- route_11_7 -->
<g id="node818" class="node">
<title>route_11_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4711" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4711" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4711" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 334,335</text>
<text text-anchor="middle" x="4711" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4711" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_7 -->
<g id="edge991" class="edge">
<title>gate_11&#45;&gt;route_11_7</title>
<path fill="none" stroke="black" d="M4837.4,-3264.21C4816.91,-3253.52 4795.25,-3242.21 4775.75,-3232.03"/>
<polygon fill="black" stroke="black" points="4777.15,-3228.81 4766.67,-3227.29 4773.91,-3235.02 4777.15,-3228.81"/>
</g>
<!-- route_11_8 -->
<g id="node822" class="node">
<title>route_11_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5131" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5131" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5131" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="5131" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5131" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_8 -->
<g id="edge996" class="edge">
<title>gate_11&#45;&gt;route_11_8</title>
<path fill="none" stroke="black" d="M5003.39,-3264.21C5024.27,-3253.42 5046.36,-3242 5066.18,-3231.74"/>
<polygon fill="black" stroke="black" points="5067.84,-3234.82 5075.12,-3227.12 5064.63,-3228.61 5067.84,-3234.82"/>
</g>
<!-- route_11_9 -->
<g id="node826" class="node">
<title>route_11_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5658" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5658" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5658" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 354,355</text>
<text text-anchor="middle" x="5658" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5658" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_9 -->
<g id="edge1001" class="edge">
<title>gate_11&#45;&gt;route_11_9</title>
<path fill="none" stroke="black" d="M5116.8,-3278.24C5238.76,-3260.21 5393.08,-3237.39 5505.69,-3220.74"/>
<polygon fill="black" stroke="black" points="5506.39,-3224.18 5515.77,-3219.25 5505.37,-3217.25 5506.39,-3224.18"/>
</g>
<!-- route_11_10 -->
<g id="node830" class="node">
<title>route_11_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6248" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6248" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6248" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 356,357</text>
<text text-anchor="middle" x="6248" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6248" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_10 -->
<g id="edge1006" class="edge">
<title>gate_11&#45;&gt;route_11_10</title>
<path fill="none" stroke="black" d="M5133,-3289.84C5390.37,-3268.69 5819.14,-3233.46 6063.18,-3213.41"/>
<polygon fill="black" stroke="black" points="6063.54,-3216.89 6073.22,-3212.59 6062.96,-3209.92 6063.54,-3216.89"/>
</g>
<!-- route_11_11 -->
<g id="node834" class="node">
<title>route_11_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6838" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6838" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6838" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 358,359</text>
<text text-anchor="middle" x="6838" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6838" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_11 -->
<g id="edge1011" class="edge">
<title>gate_11&#45;&gt;route_11_11</title>
<path fill="none" stroke="black" d="M5143.94,-3297.79C5443.44,-3284.56 5990.94,-3258.83 6458,-3228.34 6521.96,-3224.16 6591.92,-3218.83 6654.18,-3213.83"/>
<polygon fill="black" stroke="black" points="6654.82,-3217.29 6664.51,-3212.99 6654.26,-3210.31 6654.82,-3217.29"/>
</g>
<!-- route_11_12 -->
<g id="node838" class="node">
<title>route_11_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7428" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7428" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7428" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 360,361</text>
<text text-anchor="middle" x="7428" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7428" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_12 -->
<g id="edge1016" class="edge">
<title>gate_11&#45;&gt;route_11_12</title>
<path fill="none" stroke="black" d="M5149.64,-3301.97C5539.94,-3292.14 6357.6,-3268.49 7048,-3228.34 7112.59,-3224.58 7183.27,-3219.3 7245.97,-3214.21"/>
<polygon fill="black" stroke="black" points="7246.28,-3217.7 7255.96,-3213.39 7245.71,-3210.72 7246.28,-3217.7"/>
</g>
<!-- route_11_13 -->
<g id="node842" class="node">
<title>route_11_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8018" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8018" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="8018" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 362,363</text>
<text text-anchor="middle" x="8018" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8018" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_13 -->
<g id="edge1021" class="edge">
<title>gate_11&#45;&gt;route_11_13</title>
<path fill="none" stroke="black" d="M5153.3,-3304.49C5623.62,-3297.87 6719.09,-3278.07 7638,-3228.34 7702.92,-3224.82 7773.98,-3219.57 7836.9,-3214.43"/>
<polygon fill="black" stroke="black" points="7837.25,-3217.92 7846.93,-3213.61 7836.68,-3210.94 7837.25,-3217.92"/>
</g>
<!-- route_11_14 -->
<g id="node846" class="node">
<title>route_11_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8608" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8608" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8608" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 364,365</text>
<text text-anchor="middle" x="8608" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8608" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_14 -->
<g id="edge1026" class="edge">
<title>gate_11&#45;&gt;route_11_14</title>
<path fill="none" stroke="black" d="M5155.56,-3306.17C5697.95,-3302.52 7076.82,-3287.65 8228,-3228.34 8293.09,-3224.98 8364.33,-3219.75 8427.37,-3214.59"/>
<polygon fill="black" stroke="black" points="8427.73,-3218.07 8437.41,-3213.76 8427.16,-3211.09 8427.73,-3218.07"/>
</g>
<!-- route_11_15 -->
<g id="node850" class="node">
<title>route_11_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9198" cy="-3197.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9198" y="-3210.02" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9198" y="-3200.02" font-family="Times,serif" font-size="9.00">GPU: 366,367</text>
<text text-anchor="middle" x="9198" y="-3190.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9198" y="-3180.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_15 -->
<g id="edge1031" class="edge">
<title>gate_11&#45;&gt;route_11_15</title>
<path fill="none" stroke="black" d="M5157.19,-3307.38C5765.71,-3306.45 7431.91,-3297.24 8818,-3228.34 8883.25,-3225.09 8954.68,-3219.87 9017.83,-3214.68"/>
<polygon fill="black" stroke="black" points="9018.21,-3218.16 9027.89,-3213.85 9017.64,-3211.19 9018.21,-3218.16"/>
</g>
<!-- expert_11_0_0 -->
<g id="node791" class="node">
<title>expert_11_0_0</title>
<polygon fill="lightgreen" stroke="black" points="486.5,-3130.11 209.5,-3130.11 209.5,-3086.11 486.5,-3086.11 486.5,-3130.11"/>
<text text-anchor="middle" x="348" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L11</text>
<text text-anchor="middle" x="348" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="348" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="348" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_0&#45;&gt;expert_11_0_0 -->
<g id="edge957" class="edge">
<title>route_11_0&#45;&gt;expert_11_0_0</title>
<path fill="none" stroke="black" d="M552.08,-3169.38C512.92,-3157.81 467.49,-3144.4 429.44,-3133.16"/>
<polygon fill="black" stroke="black" points="430.01,-3129.68 419.43,-3130.2 428.03,-3136.39 430.01,-3129.68"/>
</g>
<!-- expert_11_0_1 -->
<g id="node792" class="node">
<title>expert_11_0_1</title>
<polygon fill="lightgreen" stroke="black" points="781.5,-3130.11 504.5,-3130.11 504.5,-3086.11 781.5,-3086.11 781.5,-3130.11"/>
<text text-anchor="middle" x="643" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L11</text>
<text text-anchor="middle" x="643" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="643" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="643" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_0&#45;&gt;expert_11_0_1 -->
<g id="edge958" class="edge">
<title>route_11_0&#45;&gt;expert_11_0_1</title>
<path fill="none" stroke="black" d="M643,-3165.76C643,-3157.48 643,-3148.5 643,-3140.19"/>
<polygon fill="black" stroke="black" points="646.5,-3140.12 643,-3130.12 639.5,-3140.12 646.5,-3140.12"/>
</g>
<!-- tp_11_0 -->
<g id="node793" class="node">
<title>tp_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="3045" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3045" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L11</text>
<text text-anchor="middle" x="3045" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="3045" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3045" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_0_0&#45;&gt;tp_11_0 -->
<g id="edge959" class="edge">
<title>expert_11_0_0&#45;&gt;tp_11_0</title>
<path fill="none" stroke="black" d="M486.6,-3086.95C489.76,-3086.65 492.9,-3086.37 496,-3086.11 974.71,-3046.07 2473.79,-3026.41 2919.07,-3021.35"/>
<polygon fill="black" stroke="black" points="2919.12,-3024.85 2929.08,-3021.23 2919.04,-3017.85 2919.12,-3024.85"/>
</g>
<!-- expert_11_0_1&#45;&gt;tp_11_0 -->
<g id="edge960" class="edge">
<title>expert_11_0_1&#45;&gt;tp_11_0</title>
<path fill="none" stroke="black" d="M781.6,-3086.97C784.76,-3086.66 787.9,-3086.38 791,-3086.11 1209.26,-3050.42 2508.54,-3028.13 2919.23,-3021.84"/>
<polygon fill="black" stroke="black" points="2919.41,-3025.33 2929.35,-3021.68 2919.3,-3018.34 2919.41,-3025.33"/>
</g>
<!-- q_proj_12 -->
<g id="node854" class="node">
<title>q_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="4754,-2940.89 4458,-2940.89 4458,-2896.89 4754,-2896.89 4754,-2940.89"/>
<text text-anchor="middle" x="4606" y="-2931.69" font-family="Times,serif" font-size="9.00">Q Projection L12</text>
<text text-anchor="middle" x="4606" y="-2921.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4606" y="-2911.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4606" y="-2901.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_11_0&#45;&gt;q_proj_12 -->
<g id="edge1908" class="edge">
<title>tp_11_0&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M3113.34,-2993.74C3131.53,-2988.23 3151.33,-2983.07 3170,-2979.89 3411.43,-2938.73 4126.98,-2925.41 4447.56,-2921.44"/>
<polygon fill="black" stroke="black" points="4447.9,-2924.93 4457.86,-2921.31 4447.82,-2917.94 4447.9,-2924.93"/>
</g>
<!-- k_proj_12 -->
<g id="node855" class="node">
<title>k_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="5382,-2940.89 5086,-2940.89 5086,-2896.89 5382,-2896.89 5382,-2940.89"/>
<text text-anchor="middle" x="5234" y="-2931.69" font-family="Times,serif" font-size="9.00">K Projection L12</text>
<text text-anchor="middle" x="5234" y="-2921.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="5234" y="-2911.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5234" y="-2901.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_11_0&#45;&gt;k_proj_12 -->
<g id="edge1909" class="edge">
<title>tp_11_0&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M3112.29,-2993.56C3130.75,-2987.94 3150.93,-2982.77 3170,-2979.89 3274.75,-2964.05 4972.44,-2988.98 5077,-2971.89 5110.1,-2966.48 5145.67,-2955.18 5174.58,-2944.49"/>
<polygon fill="black" stroke="black" points="5175.99,-2947.7 5184.11,-2940.9 5173.52,-2941.15 5175.99,-2947.7"/>
</g>
<!-- v_proj_12 -->
<g id="node856" class="node">
<title>v_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="5068,-2940.89 4772,-2940.89 4772,-2896.89 5068,-2896.89 5068,-2940.89"/>
<text text-anchor="middle" x="4920" y="-2931.69" font-family="Times,serif" font-size="9.00">V Projection L12</text>
<text text-anchor="middle" x="4920" y="-2921.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4920" y="-2911.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-2901.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_11_0&#45;&gt;v_proj_12 -->
<g id="edge1910" class="edge">
<title>tp_11_0&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M3112.29,-2993.57C3130.75,-2987.95 3150.93,-2982.78 3170,-2979.89 3257.5,-2966.62 4675.66,-2986.2 4763,-2971.89 4796.09,-2966.46 4831.67,-2955.16 4860.58,-2944.48"/>
<polygon fill="black" stroke="black" points="4861.99,-2947.69 4870.11,-2940.89 4859.52,-2941.14 4861.99,-2947.69"/>
</g>
<!-- expert_11_1_0 -->
<g id="node795" class="node">
<title>expert_11_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1076.5,-3130.11 799.5,-3130.11 799.5,-3086.11 1076.5,-3086.11 1076.5,-3130.11"/>
<text text-anchor="middle" x="938" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L11</text>
<text text-anchor="middle" x="938" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 322</text>
<text text-anchor="middle" x="938" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="938" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_1&#45;&gt;expert_11_1_0 -->
<g id="edge962" class="edge">
<title>route_11_1&#45;&gt;expert_11_1_0</title>
<path fill="none" stroke="black" d="M1142.08,-3169.38C1102.92,-3157.81 1057.49,-3144.4 1019.44,-3133.16"/>
<polygon fill="black" stroke="black" points="1020.01,-3129.68 1009.43,-3130.2 1018.03,-3136.39 1020.01,-3129.68"/>
</g>
<!-- expert_11_1_1 -->
<g id="node796" class="node">
<title>expert_11_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1371.5,-3130.11 1094.5,-3130.11 1094.5,-3086.11 1371.5,-3086.11 1371.5,-3130.11"/>
<text text-anchor="middle" x="1233" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L11</text>
<text text-anchor="middle" x="1233" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 323</text>
<text text-anchor="middle" x="1233" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1233" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_1&#45;&gt;expert_11_1_1 -->
<g id="edge963" class="edge">
<title>route_11_1&#45;&gt;expert_11_1_1</title>
<path fill="none" stroke="black" d="M1233,-3165.76C1233,-3157.48 1233,-3148.5 1233,-3140.19"/>
<polygon fill="black" stroke="black" points="1236.5,-3140.12 1233,-3130.12 1229.5,-3140.12 1236.5,-3140.12"/>
</g>
<!-- tp_11_1 -->
<g id="node797" class="node">
<title>tp_11_1</title>
<ellipse fill="lightblue" stroke="black" cx="3295" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3295" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L11</text>
<text text-anchor="middle" x="3295" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 322↔323</text>
<text text-anchor="middle" x="3295" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3295" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_1_0&#45;&gt;tp_11_1 -->
<g id="edge964" class="edge">
<title>expert_11_1_0&#45;&gt;tp_11_1</title>
<path fill="none" stroke="black" d="M1076.59,-3086.92C1079.76,-3086.63 1082.9,-3086.36 1086,-3086.11 1547.73,-3049.51 2710.54,-3108.7 3170,-3050.11 3181.68,-3048.62 3193.85,-3046.47 3205.81,-3043.99"/>
<polygon fill="black" stroke="black" points="3206.76,-3047.36 3215.8,-3041.84 3205.29,-3040.52 3206.76,-3047.36"/>
</g>
<!-- expert_11_1_1&#45;&gt;tp_11_1 -->
<g id="edge965" class="edge">
<title>expert_11_1_1&#45;&gt;tp_11_1</title>
<path fill="none" stroke="black" d="M1371.6,-3086.93C1374.76,-3086.64 1377.9,-3086.36 1381,-3086.11 1777.35,-3054.12 2775.63,-3100.97 3170,-3050.11 3181.67,-3048.61 3193.84,-3046.44 3205.81,-3043.96"/>
<polygon fill="black" stroke="black" points="3206.76,-3047.33 3215.79,-3041.8 3205.28,-3040.49 3206.76,-3047.33"/>
</g>
<!-- tp_11_1&#45;&gt;q_proj_12 -->
<g id="edge1911" class="edge">
<title>tp_11_1&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M3363.36,-2993.85C3381.55,-2988.34 3401.34,-2983.15 3420,-2979.89 3612.7,-2946.16 4171.48,-2929.47 4447.67,-2923.08"/>
<polygon fill="black" stroke="black" points="4447.86,-2926.58 4457.77,-2922.85 4447.7,-2919.58 4447.86,-2926.58"/>
</g>
<!-- tp_11_1&#45;&gt;k_proj_12 -->
<g id="edge1912" class="edge">
<title>tp_11_1&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M3362.29,-2993.57C3380.75,-2987.95 3400.93,-2982.78 3420,-2979.89 3511.02,-2966.09 4986.15,-2986.76 5077,-2971.89 5110.1,-2966.47 5145.67,-2955.17 5174.58,-2944.48"/>
<polygon fill="black" stroke="black" points="5175.99,-2947.69 5184.11,-2940.89 5173.52,-2941.14 5175.99,-2947.69"/>
</g>
<!-- tp_11_1&#45;&gt;v_proj_12 -->
<g id="edge1913" class="edge">
<title>tp_11_1&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M3362.29,-2993.58C3380.75,-2987.96 3400.93,-2982.79 3420,-2979.89 3493.76,-2968.67 4689.38,-2983.99 4763,-2971.89 4795.96,-2966.47 4831.39,-2955.23 4860.24,-2944.59"/>
<polygon fill="black" stroke="black" points="4861.63,-2947.81 4869.76,-2941.01 4859.16,-2941.26 4861.63,-2947.81"/>
</g>
<!-- expert_11_2_0 -->
<g id="node799" class="node">
<title>expert_11_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1666.5,-3130.11 1389.5,-3130.11 1389.5,-3086.11 1666.5,-3086.11 1666.5,-3130.11"/>
<text text-anchor="middle" x="1528" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L11</text>
<text text-anchor="middle" x="1528" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 324</text>
<text text-anchor="middle" x="1528" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1528" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_2&#45;&gt;expert_11_2_0 -->
<g id="edge967" class="edge">
<title>route_11_2&#45;&gt;expert_11_2_0</title>
<path fill="none" stroke="black" d="M1732.08,-3169.38C1692.92,-3157.81 1647.49,-3144.4 1609.44,-3133.16"/>
<polygon fill="black" stroke="black" points="1610.01,-3129.68 1599.43,-3130.2 1608.03,-3136.39 1610.01,-3129.68"/>
</g>
<!-- expert_11_2_1 -->
<g id="node800" class="node">
<title>expert_11_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1961.5,-3130.11 1684.5,-3130.11 1684.5,-3086.11 1961.5,-3086.11 1961.5,-3130.11"/>
<text text-anchor="middle" x="1823" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L11</text>
<text text-anchor="middle" x="1823" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 325</text>
<text text-anchor="middle" x="1823" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1823" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_2&#45;&gt;expert_11_2_1 -->
<g id="edge968" class="edge">
<title>route_11_2&#45;&gt;expert_11_2_1</title>
<path fill="none" stroke="black" d="M1823,-3165.76C1823,-3157.48 1823,-3148.5 1823,-3140.19"/>
<polygon fill="black" stroke="black" points="1826.5,-3140.12 1823,-3130.12 1819.5,-3140.12 1826.5,-3140.12"/>
</g>
<!-- tp_11_2 -->
<g id="node801" class="node">
<title>tp_11_2</title>
<ellipse fill="lightblue" stroke="black" cx="3545" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3545" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L11</text>
<text text-anchor="middle" x="3545" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 324↔325</text>
<text text-anchor="middle" x="3545" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3545" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_2_0&#45;&gt;tp_11_2 -->
<g id="edge969" class="edge">
<title>expert_11_2_0&#45;&gt;tp_11_2</title>
<path fill="none" stroke="black" d="M1666.6,-3086.93C1669.76,-3086.64 1672.9,-3086.36 1676,-3086.11 2062.37,-3054.83 3035.56,-3099.79 3420,-3050.11 3431.67,-3048.6 3443.84,-3046.44 3455.81,-3043.95"/>
<polygon fill="black" stroke="black" points="3456.76,-3047.33 3465.79,-3041.79 3455.28,-3040.48 3456.76,-3047.33"/>
</g>
<!-- expert_11_2_1&#45;&gt;tp_11_2 -->
<g id="edge970" class="edge">
<title>expert_11_2_1&#45;&gt;tp_11_2</title>
<path fill="none" stroke="black" d="M1961.6,-3086.95C1964.76,-3086.65 1967.9,-3086.37 1971,-3086.11 2612.99,-3032.77 2781.29,-3134.02 3420,-3050.11 3431.67,-3048.58 3443.84,-3046.4 3455.8,-3043.91"/>
<polygon fill="black" stroke="black" points="3456.75,-3047.28 3465.79,-3041.74 3455.27,-3040.44 3456.75,-3047.28"/>
</g>
<!-- tp_11_2&#45;&gt;q_proj_12 -->
<g id="edge1914" class="edge">
<title>tp_11_2&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M3613.72,-2993.93C3631.82,-2988.45 3651.47,-2983.26 3670,-2979.89 3814.64,-2953.57 4220.9,-2934.53 4447.76,-2925.59"/>
<polygon fill="black" stroke="black" points="4447.9,-2929.09 4457.76,-2925.2 4447.63,-2922.09 4447.9,-2929.09"/>
</g>
<!-- tp_11_2&#45;&gt;k_proj_12 -->
<g id="edge1915" class="edge">
<title>tp_11_2&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M3612.29,-2993.58C3630.75,-2987.96 3650.93,-2982.78 3670,-2979.89 3747.28,-2968.14 4999.87,-2984.55 5077,-2971.89 5109.97,-2966.47 5145.4,-2955.24 5174.24,-2944.59"/>
<polygon fill="black" stroke="black" points="5175.63,-2947.81 5183.76,-2941.02 5173.17,-2941.26 5175.63,-2947.81"/>
</g>
<!-- tp_11_2&#45;&gt;v_proj_12 -->
<g id="edge1916" class="edge">
<title>tp_11_2&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M3612.29,-2993.6C3630.75,-2987.98 3650.94,-2982.8 3670,-2979.89 3790.05,-2961.54 4643.17,-2991.66 4763,-2971.89 4795.96,-2966.45 4831.39,-2955.21 4860.24,-2944.57"/>
<polygon fill="black" stroke="black" points="4861.62,-2947.79 4869.75,-2940.99 4859.16,-2941.24 4861.62,-2947.79"/>
</g>
<!-- expert_11_3_0 -->
<g id="node803" class="node">
<title>expert_11_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2256.5,-3130.11 1979.5,-3130.11 1979.5,-3086.11 2256.5,-3086.11 2256.5,-3130.11"/>
<text text-anchor="middle" x="2118" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L11</text>
<text text-anchor="middle" x="2118" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 326</text>
<text text-anchor="middle" x="2118" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2118" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_3&#45;&gt;expert_11_3_0 -->
<g id="edge972" class="edge">
<title>route_11_3&#45;&gt;expert_11_3_0</title>
<path fill="none" stroke="black" d="M2322.08,-3169.38C2282.92,-3157.81 2237.49,-3144.4 2199.44,-3133.16"/>
<polygon fill="black" stroke="black" points="2200.01,-3129.68 2189.43,-3130.2 2198.03,-3136.39 2200.01,-3129.68"/>
</g>
<!-- expert_11_3_1 -->
<g id="node804" class="node">
<title>expert_11_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2551.5,-3130.11 2274.5,-3130.11 2274.5,-3086.11 2551.5,-3086.11 2551.5,-3130.11"/>
<text text-anchor="middle" x="2413" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L11</text>
<text text-anchor="middle" x="2413" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 327</text>
<text text-anchor="middle" x="2413" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2413" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_3&#45;&gt;expert_11_3_1 -->
<g id="edge973" class="edge">
<title>route_11_3&#45;&gt;expert_11_3_1</title>
<path fill="none" stroke="black" d="M2413,-3165.76C2413,-3157.48 2413,-3148.5 2413,-3140.19"/>
<polygon fill="black" stroke="black" points="2416.5,-3140.12 2413,-3130.12 2409.5,-3140.12 2416.5,-3140.12"/>
</g>
<!-- tp_11_3 -->
<g id="node805" class="node">
<title>tp_11_3</title>
<ellipse fill="lightblue" stroke="black" cx="3795" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3795" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L11</text>
<text text-anchor="middle" x="3795" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 326↔327</text>
<text text-anchor="middle" x="3795" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3795" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_3_0&#45;&gt;tp_11_3 -->
<g id="edge974" class="edge">
<title>expert_11_3_0&#45;&gt;tp_11_3</title>
<path fill="none" stroke="black" d="M2256.6,-3086.95C2259.76,-3086.65 2262.9,-3086.37 2266,-3086.11 2888.04,-3034.18 3051.14,-3131.66 3670,-3050.11 3681.67,-3048.57 3693.84,-3046.39 3705.8,-3043.9"/>
<polygon fill="black" stroke="black" points="3706.75,-3047.27 3715.79,-3041.73 3705.27,-3040.43 3706.75,-3047.27"/>
</g>
<!-- expert_11_3_1&#45;&gt;tp_11_3 -->
<g id="edge975" class="edge">
<title>expert_11_3_1&#45;&gt;tp_11_3</title>
<path fill="none" stroke="black" d="M2551.6,-3086.98C2554.76,-3086.67 2557.9,-3086.38 2561,-3086.11 3052.3,-3043.41 3181.3,-3116.2 3670,-3050.11 3681.58,-3048.55 3693.65,-3046.36 3705.52,-3043.88"/>
<polygon fill="black" stroke="black" points="3706.41,-3047.27 3715.44,-3041.73 3704.92,-3040.43 3706.41,-3047.27"/>
</g>
<!-- tp_11_3&#45;&gt;q_proj_12 -->
<g id="edge1917" class="edge">
<title>tp_11_3&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M3864.43,-2994.02C3882.35,-2988.61 3901.74,-2983.43 3920,-2979.89 4098.76,-2945.21 4307.65,-2930.56 4447.53,-2924.38"/>
<polygon fill="black" stroke="black" points="4448.06,-2927.86 4457.9,-2923.93 4447.76,-2920.86 4448.06,-2927.86"/>
</g>
<!-- tp_11_3&#45;&gt;k_proj_12 -->
<g id="edge1918" class="edge">
<title>tp_11_3&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M3862.29,-2993.6C3880.75,-2987.97 3900.94,-2982.8 3920,-2979.89 4047.09,-2960.49 4950.15,-2992.8 5077,-2971.89 5109.96,-2966.45 5145.39,-2955.22 5174.24,-2944.58"/>
<polygon fill="black" stroke="black" points="5175.63,-2947.79 5183.75,-2941 5173.16,-2941.24 5175.63,-2947.79"/>
</g>
<!-- tp_11_3&#45;&gt;v_proj_12 -->
<g id="edge1919" class="edge">
<title>tp_11_3&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M3862.3,-2993.63C3880.76,-2988.01 3900.94,-2982.82 3920,-2979.89 4012.58,-2965.64 4670.6,-2987.24 4763,-2971.89 4795.96,-2966.41 4831.38,-2955.17 4860.23,-2944.54"/>
<polygon fill="black" stroke="black" points="4861.62,-2947.76 4869.75,-2940.96 4859.16,-2941.2 4861.62,-2947.76"/>
</g>
<!-- expert_11_4_0 -->
<g id="node807" class="node">
<title>expert_11_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2846.5,-3130.11 2569.5,-3130.11 2569.5,-3086.11 2846.5,-3086.11 2846.5,-3130.11"/>
<text text-anchor="middle" x="2708" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L11</text>
<text text-anchor="middle" x="2708" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 328</text>
<text text-anchor="middle" x="2708" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2708" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_4&#45;&gt;expert_11_4_0 -->
<g id="edge977" class="edge">
<title>route_11_4&#45;&gt;expert_11_4_0</title>
<path fill="none" stroke="black" d="M2912.08,-3169.38C2872.92,-3157.81 2827.49,-3144.4 2789.44,-3133.16"/>
<polygon fill="black" stroke="black" points="2790.01,-3129.68 2779.43,-3130.2 2788.03,-3136.39 2790.01,-3129.68"/>
</g>
<!-- expert_11_4_1 -->
<g id="node808" class="node">
<title>expert_11_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3141.5,-3130.11 2864.5,-3130.11 2864.5,-3086.11 3141.5,-3086.11 3141.5,-3130.11"/>
<text text-anchor="middle" x="3003" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L11</text>
<text text-anchor="middle" x="3003" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 329</text>
<text text-anchor="middle" x="3003" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3003" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_4&#45;&gt;expert_11_4_1 -->
<g id="edge978" class="edge">
<title>route_11_4&#45;&gt;expert_11_4_1</title>
<path fill="none" stroke="black" d="M3003,-3165.76C3003,-3157.48 3003,-3148.5 3003,-3140.19"/>
<polygon fill="black" stroke="black" points="3006.5,-3140.12 3003,-3130.12 2999.5,-3140.12 3006.5,-3140.12"/>
</g>
<!-- tp_11_4 -->
<g id="node809" class="node">
<title>tp_11_4</title>
<ellipse fill="lightblue" stroke="black" cx="4045" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4045" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L11</text>
<text text-anchor="middle" x="4045" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 328↔329</text>
<text text-anchor="middle" x="4045" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4045" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_4_0&#45;&gt;tp_11_4 -->
<g id="edge979" class="edge">
<title>expert_11_4_0&#45;&gt;tp_11_4</title>
<path fill="none" stroke="black" d="M2846.6,-3086.99C2849.76,-3086.68 2852.9,-3086.38 2856,-3086.11 3327.35,-3044.82 3451.15,-3113.85 3920,-3050.11 3931.58,-3048.54 3943.65,-3046.35 3955.52,-3043.86"/>
<polygon fill="black" stroke="black" points="3956.41,-3047.25 3965.44,-3041.71 3954.92,-3040.41 3956.41,-3047.25"/>
</g>
<!-- expert_11_4_1&#45;&gt;tp_11_4 -->
<g id="edge980" class="edge">
<title>expert_11_4_1&#45;&gt;tp_11_4</title>
<path fill="none" stroke="black" d="M3141.6,-3087.04C3144.76,-3086.71 3147.9,-3086.4 3151,-3086.11 3491.65,-3054.04 3581.27,-3098.39 3920,-3050.11 3931.48,-3048.48 3943.45,-3046.26 3955.24,-3043.78"/>
<polygon fill="black" stroke="black" points="3956.06,-3047.18 3965.08,-3041.63 3954.56,-3040.34 3956.06,-3047.18"/>
</g>
<!-- tp_11_4&#45;&gt;q_proj_12 -->
<g id="edge1920" class="edge">
<title>tp_11_4&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M4115.87,-2994.25C4133.42,-2988.97 4152.27,-2983.78 4170,-2979.89 4261.16,-2959.85 4364.6,-2945.27 4447.84,-2935.51"/>
<polygon fill="black" stroke="black" points="4448.36,-2938.97 4457.89,-2934.34 4447.56,-2932.02 4448.36,-2938.97"/>
</g>
<!-- tp_11_4&#45;&gt;k_proj_12 -->
<g id="edge1921" class="edge">
<title>tp_11_4&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M4112.3,-2993.62C4130.75,-2988 4150.94,-2982.81 4170,-2979.89 4269.61,-2964.59 4977.58,-2988.37 5077,-2971.89 5109.96,-2966.42 5145.39,-2955.18 5174.23,-2944.55"/>
<polygon fill="black" stroke="black" points="5175.62,-2947.77 5183.75,-2940.97 5173.16,-2941.21 5175.62,-2947.77"/>
</g>
<!-- tp_11_4&#45;&gt;v_proj_12 -->
<g id="edge1922" class="edge">
<title>tp_11_4&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M4112.63,-2993.58C4131,-2988 4151.06,-2982.84 4170,-2979.89 4300.22,-2959.58 4633.04,-2993.75 4763,-2971.89 4795.94,-2966.34 4831.37,-2955.1 4860.22,-2944.48"/>
<polygon fill="black" stroke="black" points="4861.61,-2947.7 4869.74,-2940.91 4859.15,-2941.14 4861.61,-2947.7"/>
</g>
<!-- expert_11_5_0 -->
<g id="node811" class="node">
<title>expert_11_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3436.5,-3130.11 3159.5,-3130.11 3159.5,-3086.11 3436.5,-3086.11 3436.5,-3130.11"/>
<text text-anchor="middle" x="3298" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L11</text>
<text text-anchor="middle" x="3298" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 330</text>
<text text-anchor="middle" x="3298" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3298" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_5&#45;&gt;expert_11_5_0 -->
<g id="edge982" class="edge">
<title>route_11_5&#45;&gt;expert_11_5_0</title>
<path fill="none" stroke="black" d="M3502.08,-3169.38C3462.92,-3157.81 3417.49,-3144.4 3379.44,-3133.16"/>
<polygon fill="black" stroke="black" points="3380.01,-3129.68 3369.43,-3130.2 3378.03,-3136.39 3380.01,-3129.68"/>
</g>
<!-- expert_11_5_1 -->
<g id="node812" class="node">
<title>expert_11_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3731.5,-3130.11 3454.5,-3130.11 3454.5,-3086.11 3731.5,-3086.11 3731.5,-3130.11"/>
<text text-anchor="middle" x="3593" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L11</text>
<text text-anchor="middle" x="3593" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 331</text>
<text text-anchor="middle" x="3593" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3593" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_5&#45;&gt;expert_11_5_1 -->
<g id="edge983" class="edge">
<title>route_11_5&#45;&gt;expert_11_5_1</title>
<path fill="none" stroke="black" d="M3593,-3165.76C3593,-3157.48 3593,-3148.5 3593,-3140.19"/>
<polygon fill="black" stroke="black" points="3596.5,-3140.12 3593,-3130.12 3589.5,-3140.12 3596.5,-3140.12"/>
</g>
<!-- tp_11_5 -->
<g id="node813" class="node">
<title>tp_11_5</title>
<ellipse fill="lightblue" stroke="black" cx="4295" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4295" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L11</text>
<text text-anchor="middle" x="4295" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 330↔331</text>
<text text-anchor="middle" x="4295" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4295" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_5_0&#45;&gt;tp_11_5 -->
<g id="edge984" class="edge">
<title>expert_11_5_0&#45;&gt;tp_11_5</title>
<path fill="none" stroke="black" d="M3436.61,-3087.05C3439.77,-3086.72 3442.9,-3086.41 3446,-3086.11 3766.71,-3055.45 3851.11,-3096.04 4170,-3050.11 4181.48,-3048.46 4193.45,-3046.24 4205.23,-3043.74"/>
<polygon fill="black" stroke="black" points="4206.05,-3047.15 4215.07,-3041.59 4204.56,-3040.31 4206.05,-3047.15"/>
</g>
<!-- expert_11_5_1&#45;&gt;tp_11_5 -->
<g id="edge985" class="edge">
<title>expert_11_5_1&#45;&gt;tp_11_5</title>
<path fill="none" stroke="black" d="M3731.62,-3087.2C3734.78,-3086.82 3737.91,-3086.46 3741,-3086.11 3931.13,-3064.66 3981.11,-3080.61 4170,-3050.11 4181.08,-3048.32 4192.63,-3046.08 4204.03,-3043.62"/>
<polygon fill="black" stroke="black" points="4205,-3046.99 4214,-3041.41 4203.48,-3040.16 4205,-3046.99"/>
</g>
<!-- tp_11_5&#45;&gt;q_proj_12 -->
<g id="edge1923" class="edge">
<title>tp_11_5&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M4368.31,-2994.87C4416.88,-2979.55 4480.46,-2959.49 4529.65,-2943.97"/>
<polygon fill="black" stroke="black" points="4530.8,-2947.28 4539.28,-2940.93 4528.69,-2940.61 4530.8,-2947.28"/>
</g>
<!-- tp_11_5&#45;&gt;k_proj_12 -->
<g id="edge1924" class="edge">
<title>tp_11_5&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M4362.63,-2993.56C4381,-2987.98 4401.06,-2982.83 4420,-2979.89 4492.14,-2968.68 5005,-2983.95 5077,-2971.89 5109.95,-2966.37 5145.38,-2955.12 5174.23,-2944.5"/>
<polygon fill="black" stroke="black" points="5175.61,-2947.72 5183.74,-2940.93 5173.15,-2941.16 5175.61,-2947.72"/>
</g>
<!-- tp_11_5&#45;&gt;v_proj_12 -->
<g id="edge1925" class="edge">
<title>tp_11_5&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M4362.65,-2993.71C4381.02,-2988.12 4401.07,-2982.93 4420,-2979.89 4495.27,-2967.77 4687.88,-2984.9 4763,-2971.89 4795.79,-2966.2 4831.07,-2955.01 4859.86,-2944.46"/>
<polygon fill="black" stroke="black" points="4861.22,-2947.69 4869.37,-2940.91 4858.77,-2941.13 4861.22,-2947.69"/>
</g>
<!-- expert_11_6_0 -->
<g id="node815" class="node">
<title>expert_11_6_0</title>
<polygon fill="lightgreen" stroke="black" points="4026.5,-3130.11 3749.5,-3130.11 3749.5,-3086.11 4026.5,-3086.11 4026.5,-3130.11"/>
<text text-anchor="middle" x="3888" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L11</text>
<text text-anchor="middle" x="3888" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 332</text>
<text text-anchor="middle" x="3888" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3888" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_6&#45;&gt;expert_11_6_0 -->
<g id="edge987" class="edge">
<title>route_11_6&#45;&gt;expert_11_6_0</title>
<path fill="none" stroke="black" d="M4092.08,-3169.38C4052.92,-3157.81 4007.49,-3144.4 3969.44,-3133.16"/>
<polygon fill="black" stroke="black" points="3970.01,-3129.68 3959.43,-3130.2 3968.03,-3136.39 3970.01,-3129.68"/>
</g>
<!-- expert_11_6_1 -->
<g id="node816" class="node">
<title>expert_11_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4321.5,-3130.11 4044.5,-3130.11 4044.5,-3086.11 4321.5,-3086.11 4321.5,-3130.11"/>
<text text-anchor="middle" x="4183" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L11</text>
<text text-anchor="middle" x="4183" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 333</text>
<text text-anchor="middle" x="4183" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4183" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_6&#45;&gt;expert_11_6_1 -->
<g id="edge988" class="edge">
<title>route_11_6&#45;&gt;expert_11_6_1</title>
<path fill="none" stroke="black" d="M4183,-3165.76C4183,-3157.48 4183,-3148.5 4183,-3140.19"/>
<polygon fill="black" stroke="black" points="4186.5,-3140.12 4183,-3130.12 4179.5,-3140.12 4186.5,-3140.12"/>
</g>
<!-- tp_11_6 -->
<g id="node817" class="node">
<title>tp_11_6</title>
<ellipse fill="lightblue" stroke="black" cx="4545" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4545" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L11</text>
<text text-anchor="middle" x="4545" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 332↔333</text>
<text text-anchor="middle" x="4545" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4545" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_6_0&#45;&gt;tp_11_6 -->
<g id="edge989" class="edge">
<title>expert_11_6_0&#45;&gt;tp_11_6</title>
<path fill="none" stroke="black" d="M4026.63,-3087.24C4029.78,-3086.85 4032.91,-3086.48 4036,-3086.11 4206.24,-3066.07 4250.91,-3078.26 4420,-3050.11 4431.07,-3048.27 4442.61,-3045.99 4454.02,-3043.51"/>
<polygon fill="black" stroke="black" points="4454.98,-3046.88 4463.98,-3041.3 4453.46,-3040.05 4454.98,-3046.88"/>
</g>
<!-- expert_11_6_1&#45;&gt;tp_11_6 -->
<g id="edge990" class="edge">
<title>expert_11_6_1&#45;&gt;tp_11_6</title>
<path fill="none" stroke="black" d="M4270.51,-3086.07C4315.24,-3075.32 4370.52,-3062.02 4420,-3050.11 4429.87,-3047.74 4440.17,-3045.26 4450.45,-3042.78"/>
<polygon fill="black" stroke="black" points="4451.38,-3046.16 4460.28,-3040.41 4449.74,-3039.35 4451.38,-3046.16"/>
</g>
<!-- tp_11_6&#45;&gt;q_proj_12 -->
<g id="edge1926" class="edge">
<title>tp_11_6&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M4563.63,-2988.03C4571.17,-2975.9 4579.86,-2961.94 4587.39,-2949.82"/>
<polygon fill="black" stroke="black" points="4590.59,-2951.31 4592.89,-2940.97 4584.64,-2947.61 4590.59,-2951.31"/>
</g>
<!-- tp_11_6&#45;&gt;k_proj_12 -->
<g id="edge1927" class="edge">
<title>tp_11_6&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M4612.64,-2993.66C4631.01,-2988.08 4651.07,-2982.9 4670,-2979.89 4759.34,-2965.67 4987.84,-2987.17 5077,-2971.89 5109.8,-2966.26 5145.08,-2955.08 5173.87,-2944.51"/>
<polygon fill="black" stroke="black" points="5175.23,-2947.74 5183.37,-2940.96 5172.78,-2941.18 5175.23,-2947.74"/>
</g>
<!-- tp_11_6&#45;&gt;v_proj_12 -->
<g id="edge1928" class="edge">
<title>tp_11_6&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M4614.43,-2994C4632.34,-2988.59 4651.73,-2983.42 4670,-2979.89 4710.73,-2972.02 4722.36,-2980.24 4763,-2971.89 4794.57,-2965.39 4828.65,-2954.59 4856.96,-2944.52"/>
<polygon fill="black" stroke="black" points="4858.5,-2947.68 4866.72,-2940.99 4856.12,-2941.1 4858.5,-2947.68"/>
</g>
<!-- expert_11_7_0 -->
<g id="node819" class="node">
<title>expert_11_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4616.5,-3130.11 4339.5,-3130.11 4339.5,-3086.11 4616.5,-3086.11 4616.5,-3130.11"/>
<text text-anchor="middle" x="4478" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L11</text>
<text text-anchor="middle" x="4478" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 334</text>
<text text-anchor="middle" x="4478" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4478" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_7&#45;&gt;expert_11_7_0 -->
<g id="edge992" class="edge">
<title>route_11_7&#45;&gt;expert_11_7_0</title>
<path fill="none" stroke="black" d="M4636.32,-3168.3C4606.66,-3157.21 4572.83,-3144.57 4544.08,-3133.82"/>
<polygon fill="black" stroke="black" points="4545.13,-3130.47 4534.54,-3130.25 4542.68,-3137.03 4545.13,-3130.47"/>
</g>
<!-- expert_11_7_1 -->
<g id="node820" class="node">
<title>expert_11_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4911.5,-3130.11 4634.5,-3130.11 4634.5,-3086.11 4911.5,-3086.11 4911.5,-3130.11"/>
<text text-anchor="middle" x="4773" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L11</text>
<text text-anchor="middle" x="4773" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 335</text>
<text text-anchor="middle" x="4773" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4773" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_7&#45;&gt;expert_11_7_1 -->
<g id="edge993" class="edge">
<title>route_11_7&#45;&gt;expert_11_7_1</title>
<path fill="none" stroke="black" d="M4732.34,-3166.25C4738.71,-3157.29 4745.68,-3147.49 4752.03,-3138.58"/>
<polygon fill="black" stroke="black" points="4754.94,-3140.53 4757.88,-3130.35 4749.23,-3136.47 4754.94,-3140.53"/>
</g>
<!-- tp_11_7 -->
<g id="node821" class="node">
<title>tp_11_7</title>
<ellipse fill="lightblue" stroke="black" cx="4795" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4795" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L11</text>
<text text-anchor="middle" x="4795" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 334↔335</text>
<text text-anchor="middle" x="4795" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4795" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_7_0&#45;&gt;tp_11_7 -->
<g id="edge994" class="edge">
<title>expert_11_7_0&#45;&gt;tp_11_7</title>
<path fill="none" stroke="black" d="M4554.74,-3086.02C4600.34,-3073.49 4658.37,-3057.55 4705.98,-3044.46"/>
<polygon fill="black" stroke="black" points="4706.94,-3047.83 4715.66,-3041.8 4705.09,-3041.08 4706.94,-3047.83"/>
</g>
<!-- expert_11_7_1&#45;&gt;tp_11_7 -->
<g id="edge995" class="edge">
<title>expert_11_7_1&#45;&gt;tp_11_7</title>
<path fill="none" stroke="black" d="M4778.33,-3086.02C4780.3,-3078.2 4782.62,-3069.03 4784.88,-3060.07"/>
<polygon fill="black" stroke="black" points="4788.34,-3060.66 4787.4,-3050.11 4781.55,-3058.95 4788.34,-3060.66"/>
</g>
<!-- tp_11_7&#45;&gt;q_proj_12 -->
<g id="edge1929" class="edge">
<title>tp_11_7&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M4743.1,-2991.06C4715.81,-2976.89 4682.52,-2959.61 4655.58,-2945.62"/>
<polygon fill="black" stroke="black" points="4657.19,-2942.52 4646.7,-2941.01 4653.96,-2948.73 4657.19,-2942.52"/>
</g>
<!-- tp_11_7&#45;&gt;k_proj_12 -->
<g id="edge1930" class="edge">
<title>tp_11_7&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M4863.36,-2993.86C4881.55,-2988.35 4901.34,-2983.16 4920,-2979.89 4988.82,-2967.83 5008.33,-2984.76 5077,-2971.89 5109.33,-2965.82 5144.16,-2954.78 5172.78,-2944.42"/>
<polygon fill="black" stroke="black" points="5174.06,-2947.68 5182.24,-2940.94 5171.64,-2941.11 5174.06,-2947.68"/>
</g>
<!-- tp_11_7&#45;&gt;v_proj_12 -->
<g id="edge1931" class="edge">
<title>tp_11_7&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M4831.49,-2989.36C4848.46,-2976.04 4868.54,-2960.28 4885.28,-2947.14"/>
<polygon fill="black" stroke="black" points="4887.5,-2949.85 4893.2,-2940.92 4883.18,-2944.34 4887.5,-2949.85"/>
</g>
<!-- expert_11_8_0 -->
<g id="node823" class="node">
<title>expert_11_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5206.5,-3130.11 4929.5,-3130.11 4929.5,-3086.11 5206.5,-3086.11 5206.5,-3130.11"/>
<text text-anchor="middle" x="5068" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L11</text>
<text text-anchor="middle" x="5068" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="5068" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5068" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_8&#45;&gt;expert_11_8_0 -->
<g id="edge997" class="edge">
<title>route_11_8&#45;&gt;expert_11_8_0</title>
<path fill="none" stroke="black" d="M5109.32,-3166.25C5102.85,-3157.29 5095.76,-3147.49 5089.31,-3138.58"/>
<polygon fill="black" stroke="black" points="5092.06,-3136.4 5083.36,-3130.35 5086.39,-3140.51 5092.06,-3136.4"/>
</g>
<!-- expert_11_8_1 -->
<g id="node824" class="node">
<title>expert_11_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5501.5,-3130.11 5224.5,-3130.11 5224.5,-3086.11 5501.5,-3086.11 5501.5,-3130.11"/>
<text text-anchor="middle" x="5363" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L11</text>
<text text-anchor="middle" x="5363" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="5363" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5363" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_8&#45;&gt;expert_11_8_1 -->
<g id="edge998" class="edge">
<title>route_11_8&#45;&gt;expert_11_8_1</title>
<path fill="none" stroke="black" d="M5205.36,-3168.3C5234.89,-3157.21 5268.58,-3144.57 5297.2,-3133.82"/>
<polygon fill="black" stroke="black" points="5298.57,-3137.04 5306.71,-3130.25 5296.11,-3130.49 5298.57,-3137.04"/>
</g>
<!-- tp_11_8 -->
<g id="node825" class="node">
<title>tp_11_8</title>
<ellipse fill="lightblue" stroke="black" cx="5045" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5045" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L11</text>
<text text-anchor="middle" x="5045" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="5045" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5045" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_8_0&#45;&gt;tp_11_8 -->
<g id="edge999" class="edge">
<title>expert_11_8_0&#45;&gt;tp_11_8</title>
<path fill="none" stroke="black" d="M5062.43,-3086.02C5060.37,-3078.2 5057.95,-3069.03 5055.58,-3060.07"/>
<polygon fill="black" stroke="black" points="5058.89,-3058.89 5052.95,-3050.11 5052.12,-3060.67 5058.89,-3058.89"/>
</g>
<!-- expert_11_8_1&#45;&gt;tp_11_8 -->
<g id="edge1000" class="edge">
<title>expert_11_8_1&#45;&gt;tp_11_8</title>
<path fill="none" stroke="black" d="M5286.02,-3086.02C5240.19,-3073.47 5181.84,-3057.49 5134.04,-3044.39"/>
<polygon fill="black" stroke="black" points="5134.88,-3040.99 5124.31,-3041.73 5133.03,-3047.74 5134.88,-3040.99"/>
</g>
<!-- tp_11_8&#45;&gt;q_proj_12 -->
<g id="edge1932" class="edge">
<title>tp_11_8&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M4976.64,-2993.86C4958.45,-2988.35 4938.66,-2983.16 4920,-2979.89 4851.18,-2967.83 4831.67,-2984.76 4763,-2971.89 4730.67,-2965.82 4695.84,-2954.78 4667.22,-2944.42"/>
<polygon fill="black" stroke="black" points="4668.36,-2941.11 4657.76,-2940.94 4665.94,-2947.68 4668.36,-2941.11"/>
</g>
<!-- tp_11_8&#45;&gt;k_proj_12 -->
<g id="edge1933" class="edge">
<title>tp_11_8&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M5096.9,-2991.06C5124.19,-2976.89 5157.48,-2959.61 5184.42,-2945.62"/>
<polygon fill="black" stroke="black" points="5186.04,-2948.73 5193.3,-2941.01 5182.81,-2942.52 5186.04,-2948.73"/>
</g>
<!-- tp_11_8&#45;&gt;v_proj_12 -->
<g id="edge1934" class="edge">
<title>tp_11_8&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M5008.51,-2989.36C4991.54,-2976.04 4971.46,-2960.28 4954.72,-2947.14"/>
<polygon fill="black" stroke="black" points="4956.82,-2944.34 4946.8,-2940.92 4952.5,-2949.85 4956.82,-2944.34"/>
</g>
<!-- expert_11_9_0 -->
<g id="node827" class="node">
<title>expert_11_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5796.5,-3130.11 5519.5,-3130.11 5519.5,-3086.11 5796.5,-3086.11 5796.5,-3130.11"/>
<text text-anchor="middle" x="5658" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L11</text>
<text text-anchor="middle" x="5658" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 354</text>
<text text-anchor="middle" x="5658" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5658" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_9&#45;&gt;expert_11_9_0 -->
<g id="edge1002" class="edge">
<title>route_11_9&#45;&gt;expert_11_9_0</title>
<path fill="none" stroke="black" d="M5658,-3165.76C5658,-3157.48 5658,-3148.5 5658,-3140.19"/>
<polygon fill="black" stroke="black" points="5661.5,-3140.12 5658,-3130.12 5654.5,-3140.12 5661.5,-3140.12"/>
</g>
<!-- expert_11_9_1 -->
<g id="node828" class="node">
<title>expert_11_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6091.5,-3130.11 5814.5,-3130.11 5814.5,-3086.11 6091.5,-3086.11 6091.5,-3130.11"/>
<text text-anchor="middle" x="5953" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L11</text>
<text text-anchor="middle" x="5953" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 355</text>
<text text-anchor="middle" x="5953" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5953" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_9&#45;&gt;expert_11_9_1 -->
<g id="edge1003" class="edge">
<title>route_11_9&#45;&gt;expert_11_9_1</title>
<path fill="none" stroke="black" d="M5748.92,-3169.38C5788.08,-3157.81 5833.51,-3144.4 5871.56,-3133.16"/>
<polygon fill="black" stroke="black" points="5872.97,-3136.39 5881.57,-3130.2 5870.99,-3129.68 5872.97,-3136.39"/>
</g>
<!-- tp_11_9 -->
<g id="node829" class="node">
<title>tp_11_9</title>
<ellipse fill="lightblue" stroke="black" cx="5295" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5295" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L11</text>
<text text-anchor="middle" x="5295" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 354↔355</text>
<text text-anchor="middle" x="5295" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5295" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_9_0&#45;&gt;tp_11_9 -->
<g id="edge1004" class="edge">
<title>expert_11_9_0&#45;&gt;tp_11_9</title>
<path fill="none" stroke="black" d="M5570.11,-3086.09C5525.2,-3075.34 5469.68,-3062.04 5420,-3050.11 5410.05,-3047.72 5399.65,-3045.22 5389.29,-3042.73"/>
<polygon fill="black" stroke="black" points="5389.92,-3039.28 5379.38,-3040.34 5388.28,-3046.09 5389.92,-3039.28"/>
</g>
<!-- expert_11_9_1&#45;&gt;tp_11_9 -->
<g id="edge1005" class="edge">
<title>expert_11_9_1&#45;&gt;tp_11_9</title>
<path fill="none" stroke="black" d="M5814.14,-3087.09C5811.4,-3086.76 5808.69,-3086.43 5806,-3086.11 5634.89,-3065.92 5589.97,-3078.36 5420,-3050.11 5408.93,-3048.27 5397.39,-3045.99 5385.98,-3043.52"/>
<polygon fill="black" stroke="black" points="5386.54,-3040.06 5376.01,-3041.3 5385.02,-3046.89 5386.54,-3040.06"/>
</g>
<!-- tp_11_9&#45;&gt;q_proj_12 -->
<g id="edge1935" class="edge">
<title>tp_11_9&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M5227.36,-2993.66C5208.99,-2988.08 5188.93,-2982.9 5170,-2979.89 5080.66,-2965.67 4852.16,-2987.17 4763,-2971.89 4730.2,-2966.26 4694.92,-2955.08 4666.13,-2944.51"/>
<polygon fill="black" stroke="black" points="4667.22,-2941.18 4656.63,-2940.96 4664.77,-2947.74 4667.22,-2941.18"/>
</g>
<!-- tp_11_9&#45;&gt;k_proj_12 -->
<g id="edge1936" class="edge">
<title>tp_11_9&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M5276.37,-2988.03C5268.83,-2975.9 5260.14,-2961.94 5252.61,-2949.82"/>
<polygon fill="black" stroke="black" points="5255.36,-2947.61 5247.11,-2940.97 5249.41,-2951.31 5255.36,-2947.61"/>
</g>
<!-- tp_11_9&#45;&gt;v_proj_12 -->
<g id="edge1937" class="edge">
<title>tp_11_9&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M5225.57,-2994C5207.66,-2988.59 5188.27,-2983.42 5170,-2979.89 5129.27,-2972.02 5117.64,-2980.24 5077,-2971.89 5045.43,-2965.39 5011.35,-2954.59 4983.04,-2944.52"/>
<polygon fill="black" stroke="black" points="4983.88,-2941.1 4973.28,-2940.99 4981.5,-2947.68 4983.88,-2941.1"/>
</g>
<!-- expert_11_10_0 -->
<g id="node831" class="node">
<title>expert_11_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6386.5,-3130.11 6109.5,-3130.11 6109.5,-3086.11 6386.5,-3086.11 6386.5,-3130.11"/>
<text text-anchor="middle" x="6248" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L11</text>
<text text-anchor="middle" x="6248" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 356</text>
<text text-anchor="middle" x="6248" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6248" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_10&#45;&gt;expert_11_10_0 -->
<g id="edge1007" class="edge">
<title>route_11_10&#45;&gt;expert_11_10_0</title>
<path fill="none" stroke="black" d="M6248,-3165.76C6248,-3157.48 6248,-3148.5 6248,-3140.19"/>
<polygon fill="black" stroke="black" points="6251.5,-3140.12 6248,-3130.12 6244.5,-3140.12 6251.5,-3140.12"/>
</g>
<!-- expert_11_10_1 -->
<g id="node832" class="node">
<title>expert_11_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6681.5,-3130.11 6404.5,-3130.11 6404.5,-3086.11 6681.5,-3086.11 6681.5,-3130.11"/>
<text text-anchor="middle" x="6543" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L11</text>
<text text-anchor="middle" x="6543" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 357</text>
<text text-anchor="middle" x="6543" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6543" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_10&#45;&gt;expert_11_10_1 -->
<g id="edge1008" class="edge">
<title>route_11_10&#45;&gt;expert_11_10_1</title>
<path fill="none" stroke="black" d="M6338.92,-3169.38C6378.08,-3157.81 6423.51,-3144.4 6461.56,-3133.16"/>
<polygon fill="black" stroke="black" points="6462.97,-3136.39 6471.57,-3130.2 6460.99,-3129.68 6462.97,-3136.39"/>
</g>
<!-- tp_11_10 -->
<g id="node833" class="node">
<title>tp_11_10</title>
<ellipse fill="lightblue" stroke="black" cx="5545" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5545" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L11</text>
<text text-anchor="middle" x="5545" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 356↔357</text>
<text text-anchor="middle" x="5545" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5545" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_10_0&#45;&gt;tp_11_10 -->
<g id="edge1009" class="edge">
<title>expert_11_10_0&#45;&gt;tp_11_10</title>
<path fill="none" stroke="black" d="M6109.14,-3087.05C6106.41,-3086.73 6103.69,-3086.42 6101,-3086.11 5910,-3064.51 5859.77,-3080.71 5670,-3050.11 5658.92,-3048.33 5647.37,-3046.08 5635.97,-3043.62"/>
<polygon fill="black" stroke="black" points="5636.52,-3040.16 5626,-3041.42 5635,-3046.99 5636.52,-3040.16"/>
</g>
<!-- expert_11_10_1&#45;&gt;tp_11_10 -->
<g id="edge1010" class="edge">
<title>expert_11_10_1&#45;&gt;tp_11_10</title>
<path fill="none" stroke="black" d="M6404.16,-3086.93C6401.42,-3086.64 6398.69,-3086.37 6396,-3086.11 6074.42,-3055.23 5989.77,-3096.14 5670,-3050.11 5658.52,-3048.46 5646.55,-3046.24 5634.77,-3043.75"/>
<polygon fill="black" stroke="black" points="5635.44,-3040.31 5624.93,-3041.59 5633.95,-3047.15 5635.44,-3040.31"/>
</g>
<!-- tp_11_10&#45;&gt;q_proj_12 -->
<g id="edge1938" class="edge">
<title>tp_11_10&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M5477.37,-2993.56C5459,-2987.98 5438.94,-2982.83 5420,-2979.89 5347.86,-2968.68 4835,-2983.95 4763,-2971.89 4730.05,-2966.37 4694.62,-2955.12 4665.77,-2944.5"/>
<polygon fill="black" stroke="black" points="4666.85,-2941.16 4656.26,-2940.93 4664.39,-2947.72 4666.85,-2941.16"/>
</g>
<!-- tp_11_10&#45;&gt;k_proj_12 -->
<g id="edge1939" class="edge">
<title>tp_11_10&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M5471.69,-2994.87C5423.12,-2979.55 5359.54,-2959.49 5310.35,-2943.97"/>
<polygon fill="black" stroke="black" points="5311.31,-2940.61 5300.72,-2940.93 5309.2,-2947.28 5311.31,-2940.61"/>
</g>
<!-- tp_11_10&#45;&gt;v_proj_12 -->
<g id="edge1940" class="edge">
<title>tp_11_10&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M5477.35,-2993.71C5458.98,-2988.12 5438.93,-2982.93 5420,-2979.89 5344.73,-2967.77 5152.12,-2984.9 5077,-2971.89 5044.21,-2966.2 5008.93,-2955.01 4980.14,-2944.46"/>
<polygon fill="black" stroke="black" points="4981.23,-2941.13 4970.63,-2940.91 4978.78,-2947.69 4981.23,-2941.13"/>
</g>
<!-- expert_11_11_0 -->
<g id="node835" class="node">
<title>expert_11_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6976.5,-3130.11 6699.5,-3130.11 6699.5,-3086.11 6976.5,-3086.11 6976.5,-3130.11"/>
<text text-anchor="middle" x="6838" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L11</text>
<text text-anchor="middle" x="6838" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 358</text>
<text text-anchor="middle" x="6838" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6838" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_11&#45;&gt;expert_11_11_0 -->
<g id="edge1012" class="edge">
<title>route_11_11&#45;&gt;expert_11_11_0</title>
<path fill="none" stroke="black" d="M6838,-3165.76C6838,-3157.48 6838,-3148.5 6838,-3140.19"/>
<polygon fill="black" stroke="black" points="6841.5,-3140.12 6838,-3130.12 6834.5,-3140.12 6841.5,-3140.12"/>
</g>
<!-- expert_11_11_1 -->
<g id="node836" class="node">
<title>expert_11_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7271.5,-3130.11 6994.5,-3130.11 6994.5,-3086.11 7271.5,-3086.11 7271.5,-3130.11"/>
<text text-anchor="middle" x="7133" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L11</text>
<text text-anchor="middle" x="7133" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 359</text>
<text text-anchor="middle" x="7133" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7133" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_11&#45;&gt;expert_11_11_1 -->
<g id="edge1013" class="edge">
<title>route_11_11&#45;&gt;expert_11_11_1</title>
<path fill="none" stroke="black" d="M6928.92,-3169.38C6968.08,-3157.81 7013.51,-3144.4 7051.56,-3133.16"/>
<polygon fill="black" stroke="black" points="7052.97,-3136.39 7061.57,-3130.2 7050.99,-3129.68 7052.97,-3136.39"/>
</g>
<!-- tp_11_11 -->
<g id="node837" class="node">
<title>tp_11_11</title>
<ellipse fill="lightblue" stroke="black" cx="5795" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5795" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L11</text>
<text text-anchor="middle" x="5795" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 358↔359</text>
<text text-anchor="middle" x="5795" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5795" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_11_0&#45;&gt;tp_11_11 -->
<g id="edge1014" class="edge">
<title>expert_11_11_0&#45;&gt;tp_11_11</title>
<path fill="none" stroke="black" d="M6699.16,-3086.92C6696.42,-3086.64 6693.69,-3086.37 6691,-3086.11 6349.48,-3053.82 6259.61,-3098.5 5920,-3050.11 5908.52,-3048.48 5896.55,-3046.26 5884.76,-3043.78"/>
<polygon fill="black" stroke="black" points="5885.44,-3040.34 5874.92,-3041.63 5883.94,-3047.18 5885.44,-3040.34"/>
</g>
<!-- expert_11_11_1&#45;&gt;tp_11_11 -->
<g id="edge1015" class="edge">
<title>expert_11_11_1&#45;&gt;tp_11_11</title>
<path fill="none" stroke="black" d="M6994.16,-3086.87C6991.42,-3086.6 6988.7,-3086.35 6986,-3086.11 6513.78,-3044.53 6389.73,-3113.95 5920,-3050.11 5908.42,-3048.54 5896.35,-3046.35 5884.48,-3043.86"/>
<polygon fill="black" stroke="black" points="5885.08,-3040.41 5874.56,-3041.71 5883.59,-3047.25 5885.08,-3040.41"/>
</g>
<!-- tp_11_11&#45;&gt;q_proj_12 -->
<g id="edge1941" class="edge">
<title>tp_11_11&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M5727.7,-2993.62C5709.25,-2988 5689.06,-2982.81 5670,-2979.89 5570.39,-2964.59 4862.42,-2988.37 4763,-2971.89 4730.04,-2966.42 4694.61,-2955.18 4665.77,-2944.55"/>
<polygon fill="black" stroke="black" points="4666.84,-2941.21 4656.25,-2940.97 4664.38,-2947.77 4666.84,-2941.21"/>
</g>
<!-- tp_11_11&#45;&gt;k_proj_12 -->
<g id="edge1942" class="edge">
<title>tp_11_11&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M5724.13,-2994.25C5706.58,-2988.97 5687.73,-2983.78 5670,-2979.89 5578.84,-2959.85 5475.4,-2945.27 5392.16,-2935.51"/>
<polygon fill="black" stroke="black" points="5392.44,-2932.02 5382.11,-2934.34 5391.64,-2938.97 5392.44,-2932.02"/>
</g>
<!-- tp_11_11&#45;&gt;v_proj_12 -->
<g id="edge1943" class="edge">
<title>tp_11_11&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M5727.37,-2993.58C5709,-2988 5688.94,-2982.84 5670,-2979.89 5539.78,-2959.58 5206.96,-2993.75 5077,-2971.89 5044.06,-2966.34 5008.63,-2955.1 4979.78,-2944.48"/>
<polygon fill="black" stroke="black" points="4980.85,-2941.14 4970.26,-2940.91 4978.39,-2947.7 4980.85,-2941.14"/>
</g>
<!-- expert_11_12_0 -->
<g id="node839" class="node">
<title>expert_11_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7566.5,-3130.11 7289.5,-3130.11 7289.5,-3086.11 7566.5,-3086.11 7566.5,-3130.11"/>
<text text-anchor="middle" x="7428" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L11</text>
<text text-anchor="middle" x="7428" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 360</text>
<text text-anchor="middle" x="7428" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7428" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_12&#45;&gt;expert_11_12_0 -->
<g id="edge1017" class="edge">
<title>route_11_12&#45;&gt;expert_11_12_0</title>
<path fill="none" stroke="black" d="M7428,-3165.76C7428,-3157.48 7428,-3148.5 7428,-3140.19"/>
<polygon fill="black" stroke="black" points="7431.5,-3140.12 7428,-3130.12 7424.5,-3140.12 7431.5,-3140.12"/>
</g>
<!-- expert_11_12_1 -->
<g id="node840" class="node">
<title>expert_11_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7861.5,-3130.11 7584.5,-3130.11 7584.5,-3086.11 7861.5,-3086.11 7861.5,-3130.11"/>
<text text-anchor="middle" x="7723" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L11</text>
<text text-anchor="middle" x="7723" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 361</text>
<text text-anchor="middle" x="7723" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7723" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_12&#45;&gt;expert_11_12_1 -->
<g id="edge1018" class="edge">
<title>route_11_12&#45;&gt;expert_11_12_1</title>
<path fill="none" stroke="black" d="M7518.92,-3169.38C7558.08,-3157.81 7603.51,-3144.4 7641.56,-3133.16"/>
<polygon fill="black" stroke="black" points="7642.97,-3136.39 7651.57,-3130.2 7640.99,-3129.68 7642.97,-3136.39"/>
</g>
<!-- tp_11_12 -->
<g id="node841" class="node">
<title>tp_11_12</title>
<ellipse fill="lightblue" stroke="black" cx="6045" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6045" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L11</text>
<text text-anchor="middle" x="6045" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 360↔361</text>
<text text-anchor="middle" x="6045" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6045" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_12_0&#45;&gt;tp_11_12 -->
<g id="edge1019" class="edge">
<title>expert_11_12_0&#45;&gt;tp_11_12</title>
<path fill="none" stroke="black" d="M7289.16,-3086.86C7286.42,-3086.6 7283.7,-3086.35 7281,-3086.11 6788.84,-3043.11 6659.58,-3116.31 6170,-3050.11 6158.42,-3048.55 6146.35,-3046.36 6134.48,-3043.88"/>
<polygon fill="black" stroke="black" points="6135.08,-3040.43 6124.56,-3041.73 6133.59,-3047.27 6135.08,-3040.43"/>
</g>
<!-- expert_11_12_1&#45;&gt;tp_11_12 -->
<g id="edge1020" class="edge">
<title>expert_11_12_1&#45;&gt;tp_11_12</title>
<path fill="none" stroke="black" d="M7584.16,-3086.84C7581.42,-3086.58 7578.7,-3086.34 7576,-3086.11 6953.1,-3033.82 6789.74,-3131.76 6170,-3050.11 6158.33,-3048.57 6146.16,-3046.39 6134.2,-3043.9"/>
<polygon fill="black" stroke="black" points="6134.73,-3040.43 6124.21,-3041.73 6133.25,-3047.27 6134.73,-3040.43"/>
</g>
<!-- tp_11_12&#45;&gt;q_proj_12 -->
<g id="edge1944" class="edge">
<title>tp_11_12&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M5977.71,-2993.6C5959.25,-2987.97 5939.06,-2982.8 5920,-2979.89 5792.91,-2960.49 4889.85,-2992.8 4763,-2971.89 4730.04,-2966.45 4694.61,-2955.22 4665.76,-2944.58"/>
<polygon fill="black" stroke="black" points="4666.84,-2941.24 4656.25,-2941 4664.37,-2947.79 4666.84,-2941.24"/>
</g>
<!-- tp_11_12&#45;&gt;k_proj_12 -->
<g id="edge1945" class="edge">
<title>tp_11_12&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M5975.57,-2994.02C5957.65,-2988.61 5938.26,-2983.43 5920,-2979.89 5741.24,-2945.21 5532.35,-2930.56 5392.47,-2924.38"/>
<polygon fill="black" stroke="black" points="5392.24,-2920.86 5382.1,-2923.93 5391.94,-2927.86 5392.24,-2920.86"/>
</g>
<!-- tp_11_12&#45;&gt;v_proj_12 -->
<g id="edge1946" class="edge">
<title>tp_11_12&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M5977.7,-2993.63C5959.24,-2988.01 5939.06,-2982.82 5920,-2979.89 5827.42,-2965.64 5169.4,-2987.24 5077,-2971.89 5044.04,-2966.41 5008.62,-2955.17 4979.77,-2944.54"/>
<polygon fill="black" stroke="black" points="4980.84,-2941.2 4970.25,-2940.96 4978.38,-2947.76 4980.84,-2941.2"/>
</g>
<!-- expert_11_13_0 -->
<g id="node843" class="node">
<title>expert_11_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8156.5,-3130.11 7879.5,-3130.11 7879.5,-3086.11 8156.5,-3086.11 8156.5,-3130.11"/>
<text text-anchor="middle" x="8018" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L11</text>
<text text-anchor="middle" x="8018" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 362</text>
<text text-anchor="middle" x="8018" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8018" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_13&#45;&gt;expert_11_13_0 -->
<g id="edge1022" class="edge">
<title>route_11_13&#45;&gt;expert_11_13_0</title>
<path fill="none" stroke="black" d="M8018,-3165.76C8018,-3157.48 8018,-3148.5 8018,-3140.19"/>
<polygon fill="black" stroke="black" points="8021.5,-3140.12 8018,-3130.12 8014.5,-3140.12 8021.5,-3140.12"/>
</g>
<!-- expert_11_13_1 -->
<g id="node844" class="node">
<title>expert_11_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8451.5,-3130.11 8174.5,-3130.11 8174.5,-3086.11 8451.5,-3086.11 8451.5,-3130.11"/>
<text text-anchor="middle" x="8313" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L11</text>
<text text-anchor="middle" x="8313" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 363</text>
<text text-anchor="middle" x="8313" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8313" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_13&#45;&gt;expert_11_13_1 -->
<g id="edge1023" class="edge">
<title>route_11_13&#45;&gt;expert_11_13_1</title>
<path fill="none" stroke="black" d="M8108.92,-3169.38C8148.08,-3157.81 8193.51,-3144.4 8231.56,-3133.16"/>
<polygon fill="black" stroke="black" points="8232.97,-3136.39 8241.57,-3130.2 8230.99,-3129.68 8232.97,-3136.39"/>
</g>
<!-- tp_11_13 -->
<g id="node845" class="node">
<title>tp_11_13</title>
<ellipse fill="lightblue" stroke="black" cx="6295" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6295" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L11</text>
<text text-anchor="middle" x="6295" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 362↔363</text>
<text text-anchor="middle" x="6295" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6295" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_13_0&#45;&gt;tp_11_13 -->
<g id="edge1024" class="edge">
<title>expert_11_13_0&#45;&gt;tp_11_13</title>
<path fill="none" stroke="black" d="M7879.16,-3086.84C7876.42,-3086.58 7873.7,-3086.34 7871,-3086.11 7228.15,-3032.41 7059.59,-3134.12 6420,-3050.11 6408.33,-3048.58 6396.16,-3046.4 6384.2,-3043.91"/>
<polygon fill="black" stroke="black" points="6384.73,-3040.44 6374.21,-3041.74 6383.25,-3047.28 6384.73,-3040.44"/>
</g>
<!-- expert_11_13_1&#45;&gt;tp_11_13 -->
<g id="edge1025" class="edge">
<title>expert_11_13_1&#45;&gt;tp_11_13</title>
<path fill="none" stroke="black" d="M8174.17,-3086.82C8171.42,-3086.57 8168.7,-3086.33 8166,-3086.11 7779.2,-3054.61 6804.88,-3099.85 6420,-3050.11 6408.33,-3048.6 6396.16,-3046.44 6384.19,-3043.95"/>
<polygon fill="black" stroke="black" points="6384.72,-3040.48 6374.21,-3041.79 6383.24,-3047.33 6384.72,-3040.48"/>
</g>
<!-- tp_11_13&#45;&gt;q_proj_12 -->
<g id="edge1947" class="edge">
<title>tp_11_13&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M6227.71,-2993.58C6209.25,-2987.96 6189.07,-2982.78 6170,-2979.89 6092.72,-2968.14 4840.13,-2984.55 4763,-2971.89 4730.03,-2966.47 4694.6,-2955.24 4665.76,-2944.59"/>
<polygon fill="black" stroke="black" points="4666.83,-2941.26 4656.24,-2941.02 4664.37,-2947.81 4666.83,-2941.26"/>
</g>
<!-- tp_11_13&#45;&gt;k_proj_12 -->
<g id="edge1948" class="edge">
<title>tp_11_13&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M6226.28,-2993.93C6208.18,-2988.45 6188.53,-2983.26 6170,-2979.89 6025.36,-2953.57 5619.1,-2934.53 5392.24,-2925.59"/>
<polygon fill="black" stroke="black" points="5392.37,-2922.09 5382.24,-2925.2 5392.1,-2929.09 5392.37,-2922.09"/>
</g>
<!-- tp_11_13&#45;&gt;v_proj_12 -->
<g id="edge1949" class="edge">
<title>tp_11_13&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M6227.71,-2993.6C6209.25,-2987.98 6189.06,-2982.8 6170,-2979.89 6049.95,-2961.54 5196.83,-2991.66 5077,-2971.89 5044.04,-2966.45 5008.61,-2955.21 4979.76,-2944.57"/>
<polygon fill="black" stroke="black" points="4980.84,-2941.24 4970.25,-2940.99 4978.38,-2947.79 4980.84,-2941.24"/>
</g>
<!-- expert_11_14_0 -->
<g id="node847" class="node">
<title>expert_11_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8746.5,-3130.11 8469.5,-3130.11 8469.5,-3086.11 8746.5,-3086.11 8746.5,-3130.11"/>
<text text-anchor="middle" x="8608" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L11</text>
<text text-anchor="middle" x="8608" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 364</text>
<text text-anchor="middle" x="8608" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8608" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_14&#45;&gt;expert_11_14_0 -->
<g id="edge1027" class="edge">
<title>route_11_14&#45;&gt;expert_11_14_0</title>
<path fill="none" stroke="black" d="M8608,-3165.76C8608,-3157.48 8608,-3148.5 8608,-3140.19"/>
<polygon fill="black" stroke="black" points="8611.5,-3140.12 8608,-3130.12 8604.5,-3140.12 8611.5,-3140.12"/>
</g>
<!-- expert_11_14_1 -->
<g id="node848" class="node">
<title>expert_11_14_1</title>
<polygon fill="lightgreen" stroke="black" points="9041.5,-3130.11 8764.5,-3130.11 8764.5,-3086.11 9041.5,-3086.11 9041.5,-3130.11"/>
<text text-anchor="middle" x="8903" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L11</text>
<text text-anchor="middle" x="8903" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 365</text>
<text text-anchor="middle" x="8903" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8903" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_14&#45;&gt;expert_11_14_1 -->
<g id="edge1028" class="edge">
<title>route_11_14&#45;&gt;expert_11_14_1</title>
<path fill="none" stroke="black" d="M8698.92,-3169.38C8738.08,-3157.81 8783.51,-3144.4 8821.56,-3133.16"/>
<polygon fill="black" stroke="black" points="8822.97,-3136.39 8831.57,-3130.2 8820.99,-3129.68 8822.97,-3136.39"/>
</g>
<!-- tp_11_14 -->
<g id="node849" class="node">
<title>tp_11_14</title>
<ellipse fill="lightblue" stroke="black" cx="6545" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6545" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L11</text>
<text text-anchor="middle" x="6545" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 364↔365</text>
<text text-anchor="middle" x="6545" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6545" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_14_0&#45;&gt;tp_11_14 -->
<g id="edge1029" class="edge">
<title>expert_11_14_0&#45;&gt;tp_11_14</title>
<path fill="none" stroke="black" d="M8469.17,-3086.82C8466.42,-3086.57 8463.7,-3086.33 8461,-3086.11 8064.22,-3053.9 7064.81,-3101.02 6670,-3050.11 6658.33,-3048.61 6646.16,-3046.44 6634.19,-3043.96"/>
<polygon fill="black" stroke="black" points="6634.72,-3040.49 6624.21,-3041.8 6633.24,-3047.33 6634.72,-3040.49"/>
</g>
<!-- expert_11_14_1&#45;&gt;tp_11_14 -->
<g id="edge1030" class="edge">
<title>expert_11_14_1&#45;&gt;tp_11_14</title>
<path fill="none" stroke="black" d="M8764.17,-3086.81C8761.42,-3086.56 8758.7,-3086.33 8756,-3086.11 8293.84,-3049.26 7129.9,-3108.75 6670,-3050.11 6658.32,-3048.62 6646.15,-3046.47 6634.19,-3043.99"/>
<polygon fill="black" stroke="black" points="6634.71,-3040.52 6624.2,-3041.84 6633.24,-3047.36 6634.71,-3040.52"/>
</g>
<!-- tp_11_14&#45;&gt;q_proj_12 -->
<g id="edge1950" class="edge">
<title>tp_11_14&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M6477.71,-2993.57C6459.25,-2987.95 6439.07,-2982.78 6420,-2979.89 6328.98,-2966.09 4853.85,-2986.76 4763,-2971.89 4729.9,-2966.47 4694.33,-2955.17 4665.42,-2944.48"/>
<polygon fill="black" stroke="black" points="4666.48,-2941.14 4655.89,-2940.89 4664.01,-2947.69 4666.48,-2941.14"/>
</g>
<!-- tp_11_14&#45;&gt;k_proj_12 -->
<g id="edge1951" class="edge">
<title>tp_11_14&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M6476.64,-2993.85C6458.45,-2988.34 6438.66,-2983.15 6420,-2979.89 6227.3,-2946.16 5668.52,-2929.47 5392.33,-2923.08"/>
<polygon fill="black" stroke="black" points="5392.3,-2919.58 5382.23,-2922.85 5392.14,-2926.58 5392.3,-2919.58"/>
</g>
<!-- tp_11_14&#45;&gt;v_proj_12 -->
<g id="edge1952" class="edge">
<title>tp_11_14&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M6477.71,-2993.58C6459.25,-2987.96 6439.07,-2982.79 6420,-2979.89 6346.24,-2968.67 5150.62,-2983.99 5077,-2971.89 5044.04,-2966.47 5008.61,-2955.23 4979.76,-2944.59"/>
<polygon fill="black" stroke="black" points="4980.84,-2941.26 4970.24,-2941.01 4978.37,-2947.81 4980.84,-2941.26"/>
</g>
<!-- expert_11_15_0 -->
<g id="node851" class="node">
<title>expert_11_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9336.5,-3130.11 9059.5,-3130.11 9059.5,-3086.11 9336.5,-3086.11 9336.5,-3130.11"/>
<text text-anchor="middle" x="9198" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L11</text>
<text text-anchor="middle" x="9198" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 366</text>
<text text-anchor="middle" x="9198" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9198" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_15&#45;&gt;expert_11_15_0 -->
<g id="edge1032" class="edge">
<title>route_11_15&#45;&gt;expert_11_15_0</title>
<path fill="none" stroke="black" d="M9198,-3165.76C9198,-3157.48 9198,-3148.5 9198,-3140.19"/>
<polygon fill="black" stroke="black" points="9201.5,-3140.12 9198,-3130.12 9194.5,-3140.12 9201.5,-3140.12"/>
</g>
<!-- expert_11_15_1 -->
<g id="node852" class="node">
<title>expert_11_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9631.5,-3130.11 9354.5,-3130.11 9354.5,-3086.11 9631.5,-3086.11 9631.5,-3130.11"/>
<text text-anchor="middle" x="9493" y="-3120.91" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L11</text>
<text text-anchor="middle" x="9493" y="-3110.91" font-family="Times,serif" font-size="9.00">GPU: 367</text>
<text text-anchor="middle" x="9493" y="-3100.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9493" y="-3090.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_15&#45;&gt;expert_11_15_1 -->
<g id="edge1033" class="edge">
<title>route_11_15&#45;&gt;expert_11_15_1</title>
<path fill="none" stroke="black" d="M9288.92,-3169.38C9328.08,-3157.81 9373.51,-3144.4 9411.56,-3133.16"/>
<polygon fill="black" stroke="black" points="9412.97,-3136.39 9421.57,-3130.2 9410.99,-3129.68 9412.97,-3136.39"/>
</g>
<!-- tp_11_15 -->
<g id="node853" class="node">
<title>tp_11_15</title>
<ellipse fill="lightblue" stroke="black" cx="6795" cy="-3019" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6795" y="-3031.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L11</text>
<text text-anchor="middle" x="6795" y="-3021.8" font-family="Times,serif" font-size="9.00">GPU: 366↔367</text>
<text text-anchor="middle" x="6795" y="-3011.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6795" y="-3001.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_15_0&#45;&gt;tp_11_15 -->
<g id="edge1034" class="edge">
<title>expert_11_15_0&#45;&gt;tp_11_15</title>
<path fill="none" stroke="black" d="M9059.16,-3086.85C9056.42,-3086.59 9053.7,-3086.34 9051,-3086.11 8632.38,-3050.19 7331.95,-3028.06 6920.89,-3021.82"/>
<polygon fill="black" stroke="black" points="6920.8,-3018.32 6910.75,-3021.67 6920.7,-3025.32 6920.8,-3018.32"/>
</g>
<!-- expert_11_15_1&#45;&gt;tp_11_15 -->
<g id="edge1035" class="edge">
<title>expert_11_15_1&#45;&gt;tp_11_15</title>
<path fill="none" stroke="black" d="M9354.16,-3086.84C9351.42,-3086.58 9348.7,-3086.34 9346,-3086.11 8866.93,-3045.82 7366.66,-3026.33 6921.03,-3021.33"/>
<polygon fill="black" stroke="black" points="6921.05,-3017.83 6911.02,-3021.22 6920.98,-3024.83 6921.05,-3017.83"/>
</g>
<!-- tp_11_15&#45;&gt;q_proj_12 -->
<g id="edge1953" class="edge">
<title>tp_11_15&#45;&gt;q_proj_12</title>
<path fill="none" stroke="black" d="M6727.71,-2993.56C6709.25,-2987.94 6689.07,-2982.77 6670,-2979.89 6565.25,-2964.05 4867.56,-2988.98 4763,-2971.89 4729.9,-2966.48 4694.33,-2955.18 4665.42,-2944.49"/>
<polygon fill="black" stroke="black" points="4666.48,-2941.15 4655.89,-2940.9 4664.01,-2947.7 4666.48,-2941.15"/>
</g>
<!-- tp_11_15&#45;&gt;k_proj_12 -->
<g id="edge1954" class="edge">
<title>tp_11_15&#45;&gt;k_proj_12</title>
<path fill="none" stroke="black" d="M6726.66,-2993.74C6708.47,-2988.23 6688.67,-2983.07 6670,-2979.89 6428.57,-2938.73 5713.02,-2925.41 5392.44,-2921.44"/>
<polygon fill="black" stroke="black" points="5392.18,-2917.94 5382.14,-2921.31 5392.1,-2924.93 5392.18,-2917.94"/>
</g>
<!-- tp_11_15&#45;&gt;v_proj_12 -->
<g id="edge1955" class="edge">
<title>tp_11_15&#45;&gt;v_proj_12</title>
<path fill="none" stroke="black" d="M6727.71,-2993.57C6709.25,-2987.95 6689.07,-2982.78 6670,-2979.89 6582.5,-2966.62 5164.34,-2986.2 5077,-2971.89 5043.91,-2966.46 5008.33,-2955.16 4979.42,-2944.48"/>
<polygon fill="black" stroke="black" points="4980.48,-2941.14 4969.89,-2940.89 4978.01,-2947.69 4980.48,-2941.14"/>
</g>
<!-- attn_scores_12 -->
<g id="node857" class="node">
<title>attn_scores_12</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-2860.89 4753.5,-2860.89 4753.5,-2816.89 5086.5,-2816.89 5086.5,-2860.89"/>
<text text-anchor="middle" x="4920" y="-2851.69" font-family="Times,serif" font-size="9.00">Attention Scores L12</text>
<text text-anchor="middle" x="4920" y="-2841.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4920" y="-2831.69" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-2821.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_12&#45;&gt;attn_scores_12 -->
<g id="edge1036" class="edge">
<title>q_proj_12&#45;&gt;attn_scores_12</title>
<path fill="none" stroke="black" d="M4690.56,-2896.88C4732.18,-2886.54 4782.51,-2874.04 4825.41,-2863.38"/>
<polygon fill="black" stroke="black" points="4826.43,-2866.74 4835.29,-2860.93 4824.74,-2859.94 4826.43,-2866.74"/>
</g>
<!-- k_proj_12&#45;&gt;attn_scores_12 -->
<g id="edge1037" class="edge">
<title>k_proj_12&#45;&gt;attn_scores_12</title>
<path fill="none" stroke="black" d="M5149.44,-2896.88C5107.82,-2886.54 5057.49,-2874.04 5014.59,-2863.38"/>
<polygon fill="black" stroke="black" points="5015.26,-2859.94 5004.71,-2860.93 5013.57,-2866.74 5015.26,-2859.94"/>
</g>
<!-- v_proj_12&#45;&gt;attn_scores_12 -->
<g id="edge1038" class="edge">
<title>v_proj_12&#45;&gt;attn_scores_12</title>
<path fill="none" stroke="black" d="M4920,-2896.57C4920,-2888.68 4920,-2879.57 4920,-2870.99"/>
<polygon fill="black" stroke="black" points="4923.5,-2870.9 4920,-2860.9 4916.5,-2870.9 4923.5,-2870.9"/>
</g>
<!-- softmax_12 -->
<g id="node858" class="node">
<title>softmax_12</title>
<polygon fill="lightgreen" stroke="black" points="5086.5,-2780.89 4753.5,-2780.89 4753.5,-2736.89 5086.5,-2736.89 5086.5,-2780.89"/>
<text text-anchor="middle" x="4920" y="-2771.69" font-family="Times,serif" font-size="9.00">Softmax L12</text>
<text text-anchor="middle" x="4920" y="-2761.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4920" y="-2751.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4920" y="-2741.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_12&#45;&gt;softmax_12 -->
<g id="edge1039" class="edge">
<title>attn_scores_12&#45;&gt;softmax_12</title>
<path fill="none" stroke="black" d="M4920,-2816.57C4920,-2808.68 4920,-2799.57 4920,-2790.99"/>
<polygon fill="black" stroke="black" points="4923.5,-2790.9 4920,-2780.9 4916.5,-2790.9 4923.5,-2790.9"/>
</g>
<!-- attn_out_12 -->
<g id="node859" class="node">
<title>attn_out_12</title>
<polygon fill="lightgreen" stroke="black" points="5068,-2700.89 4772,-2700.89 4772,-2656.89 5068,-2656.89 5068,-2700.89"/>
<text text-anchor="middle" x="4920" y="-2691.69" font-family="Times,serif" font-size="9.00">Attention Output L12</text>
<text text-anchor="middle" x="4920" y="-2681.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4920" y="-2671.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-2661.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_12&#45;&gt;attn_out_12 -->
<g id="edge1040" class="edge">
<title>softmax_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M4920,-2736.57C4920,-2728.68 4920,-2719.57 4920,-2710.99"/>
<polygon fill="black" stroke="black" points="4923.5,-2710.9 4920,-2700.9 4916.5,-2710.9 4923.5,-2710.9"/>
</g>
<!-- gate_12 -->
<g id="node860" class="node">
<title>gate_12</title>
<polygon fill="lightyellow" stroke="black" points="5219.74,-2620.89 4742.92,-2620.89 4620.26,-2532.89 5097.08,-2532.89 5219.74,-2620.89"/>
<text text-anchor="middle" x="4920" y="-2589.69" font-family="Times,serif" font-size="9.00">Gate L12</text>
<text text-anchor="middle" x="4920" y="-2579.69" font-family="Times,serif" font-size="9.00">GPU: 384&#45;447</text>
<text text-anchor="middle" x="4920" y="-2569.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4920" y="-2559.69" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_12&#45;&gt;gate_12 -->
<g id="edge1041" class="edge">
<title>attn_out_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M4920,-2656.68C4920,-2649.18 4920,-2640.37 4920,-2631.41"/>
<polygon fill="black" stroke="black" points="4923.5,-2631.29 4920,-2621.29 4916.5,-2631.29 4923.5,-2631.29"/>
</g>
<!-- route_12_0 -->
<g id="node861" class="node">
<title>route_12_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="560" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="560" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="560" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="560" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="560" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_0 -->
<g id="edge1042" class="edge">
<title>gate_12&#45;&gt;route_12_0</title>
<path fill="none" stroke="black" d="M4680.38,-2576.07C4061.17,-2575.48 2357.2,-2567.04 940,-2496.89 874.75,-2493.66 803.31,-2488.44 740.17,-2483.25"/>
<polygon fill="black" stroke="black" points="740.36,-2479.75 730.11,-2482.42 739.79,-2486.73 740.36,-2479.75"/>
</g>
<!-- route_12_1 -->
<g id="node865" class="node">
<title>route_12_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1150" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1150" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1150" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 386,387</text>
<text text-anchor="middle" x="1150" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1150" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_1 -->
<g id="edge1047" class="edge">
<title>gate_12&#45;&gt;route_12_1</title>
<path fill="none" stroke="black" d="M4678.6,-2574.88C4122.77,-2571.55 2709.72,-2557.33 1530,-2496.89 1464.91,-2493.55 1393.67,-2488.33 1330.63,-2483.16"/>
<polygon fill="black" stroke="black" points="1330.84,-2479.66 1320.59,-2482.33 1330.27,-2486.64 1330.84,-2479.66"/>
</g>
<!-- route_12_2 -->
<g id="node869" class="node">
<title>route_12_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1740" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1740" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1740" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 388,389</text>
<text text-anchor="middle" x="1740" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1740" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_2 -->
<g id="edge1052" class="edge">
<title>gate_12&#45;&gt;route_12_2</title>
<path fill="none" stroke="black" d="M4676.38,-2573.18C4190.09,-2566.86 3064.5,-2547.6 2120,-2496.89 2055.08,-2493.4 1984.02,-2488.16 1921.1,-2483.01"/>
<polygon fill="black" stroke="black" points="1921.32,-2479.52 1911.07,-2482.19 1920.75,-2486.5 1921.32,-2479.52"/>
</g>
<!-- route_12_3 -->
<g id="node873" class="node">
<title>route_12_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2330" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2330" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2330" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 390,391</text>
<text text-anchor="middle" x="2330" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2330" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_3 -->
<g id="edge1057" class="edge">
<title>gate_12&#45;&gt;route_12_3</title>
<path fill="none" stroke="black" d="M4672.5,-2570.54C4263.69,-2560.92 3421.73,-2537.79 2710,-2496.89 2645.25,-2493.17 2574.38,-2487.88 2511.57,-2482.77"/>
<polygon fill="black" stroke="black" points="2511.81,-2479.28 2501.56,-2481.96 2511.24,-2486.26 2511.81,-2479.28"/>
</g>
<!-- route_12_4 -->
<g id="node877" class="node">
<title>route_12_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2920" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2920" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2920" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 392,393</text>
<text text-anchor="middle" x="2920" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2920" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_4 -->
<g id="edge1062" class="edge">
<title>gate_12&#45;&gt;route_12_4</title>
<path fill="none" stroke="black" d="M4665.93,-2565.88C4346.84,-2552.77 3782.63,-2527.77 3300,-2496.89 3235.87,-2492.78 3165.73,-2487.46 3103.35,-2482.43"/>
<polygon fill="black" stroke="black" points="3103.26,-2478.92 3093.01,-2481.6 3102.7,-2485.89 3103.26,-2478.92"/>
</g>
<!-- route_12_5 -->
<g id="node881" class="node">
<title>route_12_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3510" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3510" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3510" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 394,395</text>
<text text-anchor="middle" x="3510" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3510" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_5 -->
<g id="edge1067" class="edge">
<title>gate_12&#45;&gt;route_12_5</title>
<path fill="none" stroke="black" d="M4651.61,-2555.49C4443.74,-2539.64 4148.59,-2517.05 3890,-2496.89 3826.88,-2491.96 3757.86,-2486.52 3696.17,-2481.62"/>
<polygon fill="black" stroke="black" points="3696.18,-2478.11 3685.94,-2480.81 3695.63,-2485.09 3696.18,-2478.11"/>
</g>
<!-- route_12_6 -->
<g id="node885" class="node">
<title>route_12_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4100" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4100" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4100" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 396,397</text>
<text text-anchor="middle" x="4100" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4100" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_6 -->
<g id="edge1072" class="edge">
<title>gate_12&#45;&gt;route_12_6</title>
<path fill="none" stroke="black" d="M4625.41,-2536.69C4501.84,-2520.24 4363.04,-2501.77 4259.15,-2487.95"/>
<polygon fill="black" stroke="black" points="4259.58,-2484.48 4249.2,-2486.63 4258.65,-2491.42 4259.58,-2484.48"/>
</g>
<!-- route_12_7 -->
<g id="node889" class="node">
<title>route_12_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4627" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4627" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4627" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 398,399</text>
<text text-anchor="middle" x="4627" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4627" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_7 -->
<g id="edge1077" class="edge">
<title>gate_12&#45;&gt;route_12_7</title>
<path fill="none" stroke="black" d="M4804.2,-2532.76C4773.3,-2521.26 4740.49,-2509.04 4711.62,-2498.29"/>
<polygon fill="black" stroke="black" points="4712.58,-2494.91 4701.99,-2494.7 4710.14,-2501.47 4712.58,-2494.91"/>
</g>
<!-- route_12_8 -->
<g id="node893" class="node">
<title>route_12_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5047" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5047" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5047" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="5047" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5047" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_8 -->
<g id="edge1082" class="edge">
<title>gate_12&#45;&gt;route_12_8</title>
<path fill="none" stroke="black" d="M4970.19,-2532.76C4981.58,-2522.98 4993.55,-2512.69 5004.58,-2503.22"/>
<polygon fill="black" stroke="black" points="5007.11,-2505.66 5012.41,-2496.49 5002.55,-2500.35 5007.11,-2505.66"/>
</g>
<!-- route_12_9 -->
<g id="node897" class="node">
<title>route_12_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5575" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5575" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5575" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 418,419</text>
<text text-anchor="middle" x="5575" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5575" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_9 -->
<g id="edge1087" class="edge">
<title>gate_12&#45;&gt;route_12_9</title>
<path fill="none" stroke="black" d="M5112.54,-2543.81C5214.5,-2526.83 5337.62,-2506.32 5431.18,-2490.73"/>
<polygon fill="black" stroke="black" points="5432,-2494.14 5441.28,-2489.05 5430.85,-2487.24 5432,-2494.14"/>
</g>
<!-- route_12_10 -->
<g id="node901" class="node">
<title>route_12_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6165" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6165" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6165" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 420,421</text>
<text text-anchor="middle" x="6165" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6165" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_10 -->
<g id="edge1092" class="edge">
<title>gate_12&#45;&gt;route_12_10</title>
<path fill="none" stroke="black" d="M5131.55,-2557.35C5370.87,-2536.37 5756.68,-2502.56 5983.04,-2482.72"/>
<polygon fill="black" stroke="black" points="5983.38,-2486.2 5993.03,-2481.85 5982.77,-2479.23 5983.38,-2486.2"/>
</g>
<!-- route_12_11 -->
<g id="node905" class="node">
<title>route_12_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6755" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6755" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6755" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 422,423</text>
<text text-anchor="middle" x="6755" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6755" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_11 -->
<g id="edge1097" class="edge">
<title>gate_12&#45;&gt;route_12_11</title>
<path fill="none" stroke="black" d="M5142.57,-2565.52C5428.11,-2551.83 5938.64,-2526.02 6375,-2496.89 6438.8,-2492.63 6508.57,-2487.29 6570.72,-2482.3"/>
<polygon fill="black" stroke="black" points="6571.34,-2485.76 6581.03,-2481.47 6570.78,-2478.79 6571.34,-2485.76"/>
</g>
<!-- route_12_12 -->
<g id="node909" class="node">
<title>route_12_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7345" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7345" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7345" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 424,425</text>
<text text-anchor="middle" x="7345" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7345" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_12 -->
<g id="edge1102" class="edge">
<title>gate_12&#45;&gt;route_12_12</title>
<path fill="none" stroke="black" d="M5149.01,-2570.06C5527.3,-2559.76 6306.4,-2535.69 6965,-2496.89 7029.59,-2493.08 7100.27,-2487.79 7162.97,-2482.7"/>
<polygon fill="black" stroke="black" points="7163.28,-2486.19 7172.96,-2481.89 7162.71,-2479.21 7163.28,-2486.19"/>
</g>
<!-- route_12_13 -->
<g id="node913" class="node">
<title>route_12_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7935" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7935" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7935" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 426,427</text>
<text text-anchor="middle" x="7935" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7935" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_13 -->
<g id="edge1107" class="edge">
<title>gate_12&#45;&gt;route_12_13</title>
<path fill="none" stroke="black" d="M5152.8,-2572.74C5612.34,-2565.69 6668.44,-2545.27 7555,-2496.89 7619.92,-2493.34 7690.98,-2488.08 7753.9,-2482.95"/>
<polygon fill="black" stroke="black" points="7754.25,-2486.43 7763.93,-2482.13 7753.67,-2479.46 7754.25,-2486.43"/>
</g>
<!-- route_12_14 -->
<g id="node917" class="node">
<title>route_12_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8525" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8525" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8525" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 428,429</text>
<text text-anchor="middle" x="8525" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8525" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_14 -->
<g id="edge1112" class="edge">
<title>gate_12&#45;&gt;route_12_14</title>
<path fill="none" stroke="black" d="M5155.36,-2574.52C5688.05,-2570.46 7026.72,-2554.85 8145,-2496.89 8210.09,-2493.51 8281.33,-2488.28 8344.37,-2483.11"/>
<polygon fill="black" stroke="black" points="8344.73,-2486.6 8354.41,-2482.29 8344.16,-2479.62 8344.73,-2486.6"/>
</g>
<!-- route_12_15 -->
<g id="node921" class="node">
<title>route_12_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9115" cy="-2465.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9115" y="-2478.57" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9115" y="-2468.57" font-family="Times,serif" font-size="9.00">GPU: 430,431</text>
<text text-anchor="middle" x="9115" y="-2458.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9115" y="-2448.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_15 -->
<g id="edge1117" class="edge">
<title>gate_12&#45;&gt;route_12_15</title>
<path fill="none" stroke="black" d="M5157.06,-2575.78C5756.65,-2574.48 7382.14,-2564.44 8735,-2496.89 8800.25,-2493.63 8871.68,-2488.41 8934.83,-2483.22"/>
<polygon fill="black" stroke="black" points="8935.21,-2486.7 8944.89,-2482.38 8934.64,-2479.72 8935.21,-2486.7"/>
</g>
<!-- expert_12_0_0 -->
<g id="node862" class="node">
<title>expert_12_0_0</title>
<polygon fill="lightgreen" stroke="black" points="403.5,-2398.66 126.5,-2398.66 126.5,-2354.66 403.5,-2354.66 403.5,-2398.66"/>
<text text-anchor="middle" x="265" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L12</text>
<text text-anchor="middle" x="265" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="265" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="265" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_0&#45;&gt;expert_12_0_0 -->
<g id="edge1043" class="edge">
<title>route_12_0&#45;&gt;expert_12_0_0</title>
<path fill="none" stroke="black" d="M469.08,-2437.93C429.92,-2426.36 384.49,-2412.94 346.44,-2401.71"/>
<polygon fill="black" stroke="black" points="347.01,-2398.23 336.43,-2398.75 345.03,-2404.94 347.01,-2398.23"/>
</g>
<!-- expert_12_0_1 -->
<g id="node863" class="node">
<title>expert_12_0_1</title>
<polygon fill="lightgreen" stroke="black" points="698.5,-2398.66 421.5,-2398.66 421.5,-2354.66 698.5,-2354.66 698.5,-2398.66"/>
<text text-anchor="middle" x="560" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L12</text>
<text text-anchor="middle" x="560" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="560" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="560" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_0&#45;&gt;expert_12_0_1 -->
<g id="edge1044" class="edge">
<title>route_12_0&#45;&gt;expert_12_0_1</title>
<path fill="none" stroke="black" d="M560,-2434.31C560,-2426.03 560,-2417.05 560,-2408.74"/>
<polygon fill="black" stroke="black" points="563.5,-2408.67 560,-2398.67 556.5,-2408.67 563.5,-2408.67"/>
</g>
<!-- tp_12_0 -->
<g id="node864" class="node">
<title>tp_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="2962" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2962" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L12</text>
<text text-anchor="middle" x="2962" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="2962" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2962" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_0_0&#45;&gt;tp_12_0 -->
<g id="edge1045" class="edge">
<title>expert_12_0_0&#45;&gt;tp_12_0</title>
<path fill="none" stroke="black" d="M403.84,-2355.39C406.58,-2355.13 409.3,-2354.89 412,-2354.66 890.88,-2314.38 2390.56,-2294.88 2836.02,-2289.88"/>
<polygon fill="black" stroke="black" points="2836.07,-2293.38 2846.03,-2289.77 2835.99,-2286.38 2836.07,-2293.38"/>
</g>
<!-- expert_12_0_1&#45;&gt;tp_12_0 -->
<g id="edge1046" class="edge">
<title>expert_12_0_1&#45;&gt;tp_12_0</title>
<path fill="none" stroke="black" d="M698.6,-2355.52C701.76,-2355.21 704.9,-2354.93 708,-2354.66 1126.26,-2318.97 2425.54,-2296.68 2836.23,-2290.39"/>
<polygon fill="black" stroke="black" points="2836.41,-2293.88 2846.35,-2290.23 2836.3,-2286.89 2836.41,-2293.88"/>
</g>
<!-- q_proj_13 -->
<g id="node925" class="node">
<title>q_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="4985,-2220.44 4689,-2220.44 4689,-2176.44 4985,-2176.44 4985,-2220.44"/>
<text text-anchor="middle" x="4837" y="-2211.24" font-family="Times,serif" font-size="9.00">Q Projection L13</text>
<text text-anchor="middle" x="4837" y="-2201.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4837" y="-2191.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-2181.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_12_0&#45;&gt;q_proj_13 -->
<g id="edge1956" class="edge">
<title>tp_12_0&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M3041.21,-2264.78C3056.31,-2261.39 3072.06,-2258.38 3087,-2256.44 3434.87,-2211.13 4310.53,-2247.27 4678.51,-2220.48"/>
<polygon fill="black" stroke="black" points="4679,-2223.96 4688.71,-2219.71 4678.48,-2216.98 4679,-2223.96"/>
</g>
<!-- k_proj_13 -->
<g id="node926" class="node">
<title>k_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="5299,-2220.44 5003,-2220.44 5003,-2176.44 5299,-2176.44 5299,-2220.44"/>
<text text-anchor="middle" x="5151" y="-2211.24" font-family="Times,serif" font-size="9.00">K Projection L13</text>
<text text-anchor="middle" x="5151" y="-2201.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="5151" y="-2191.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5151" y="-2181.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_12_0&#45;&gt;k_proj_13 -->
<g id="edge1957" class="edge">
<title>tp_12_0&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M3041.2,-2264.73C3056.3,-2261.35 3072.06,-2258.35 3087,-2256.44 3504.12,-2202.9 4554.78,-2251.81 4992.49,-2220.48"/>
<polygon fill="black" stroke="black" points="4993,-2223.96 5002.71,-2219.73 4992.48,-2216.97 4993,-2223.96"/>
</g>
<!-- v_proj_13 -->
<g id="node927" class="node">
<title>v_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="4671,-2220.44 4375,-2220.44 4375,-2176.44 4671,-2176.44 4671,-2220.44"/>
<text text-anchor="middle" x="4523" y="-2211.24" font-family="Times,serif" font-size="9.00">V Projection L13</text>
<text text-anchor="middle" x="4523" y="-2201.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4523" y="-2191.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4523" y="-2181.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_12_0&#45;&gt;v_proj_13 -->
<g id="edge1958" class="edge">
<title>tp_12_0&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M3041.57,-2264.91C3056.56,-2261.54 3072.19,-2258.49 3087,-2256.44 3329.49,-2222.75 4044.06,-2207.21 4364.44,-2201.8"/>
<polygon fill="black" stroke="black" points="4364.79,-2205.29 4374.73,-2201.62 4364.68,-2198.29 4364.79,-2205.29"/>
</g>
<!-- expert_12_1_0 -->
<g id="node866" class="node">
<title>expert_12_1_0</title>
<polygon fill="lightgreen" stroke="black" points="993.5,-2398.66 716.5,-2398.66 716.5,-2354.66 993.5,-2354.66 993.5,-2398.66"/>
<text text-anchor="middle" x="855" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L12</text>
<text text-anchor="middle" x="855" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 386</text>
<text text-anchor="middle" x="855" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="855" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_1&#45;&gt;expert_12_1_0 -->
<g id="edge1048" class="edge">
<title>route_12_1&#45;&gt;expert_12_1_0</title>
<path fill="none" stroke="black" d="M1059.08,-2437.93C1019.92,-2426.36 974.49,-2412.94 936.44,-2401.71"/>
<polygon fill="black" stroke="black" points="937.01,-2398.23 926.43,-2398.75 935.03,-2404.94 937.01,-2398.23"/>
</g>
<!-- expert_12_1_1 -->
<g id="node867" class="node">
<title>expert_12_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1288.5,-2398.66 1011.5,-2398.66 1011.5,-2354.66 1288.5,-2354.66 1288.5,-2398.66"/>
<text text-anchor="middle" x="1150" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L12</text>
<text text-anchor="middle" x="1150" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 387</text>
<text text-anchor="middle" x="1150" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1150" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_1&#45;&gt;expert_12_1_1 -->
<g id="edge1049" class="edge">
<title>route_12_1&#45;&gt;expert_12_1_1</title>
<path fill="none" stroke="black" d="M1150,-2434.31C1150,-2426.03 1150,-2417.05 1150,-2408.74"/>
<polygon fill="black" stroke="black" points="1153.5,-2408.67 1150,-2398.67 1146.5,-2408.67 1153.5,-2408.67"/>
</g>
<!-- tp_12_1 -->
<g id="node868" class="node">
<title>tp_12_1</title>
<ellipse fill="lightblue" stroke="black" cx="3212" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3212" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L12</text>
<text text-anchor="middle" x="3212" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 386↔387</text>
<text text-anchor="middle" x="3212" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3212" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_1_0&#45;&gt;tp_12_1 -->
<g id="edge1050" class="edge">
<title>expert_12_1_0&#45;&gt;tp_12_1</title>
<path fill="none" stroke="black" d="M993.59,-2355.47C996.76,-2355.18 999.9,-2354.91 1003,-2354.66 1464.73,-2318.06 2627.54,-2377.25 3087,-2318.66 3098.68,-2317.17 3110.85,-2315.02 3122.81,-2312.54"/>
<polygon fill="black" stroke="black" points="3123.76,-2315.91 3132.8,-2310.38 3122.29,-2309.07 3123.76,-2315.91"/>
</g>
<!-- expert_12_1_1&#45;&gt;tp_12_1 -->
<g id="edge1051" class="edge">
<title>expert_12_1_1&#45;&gt;tp_12_1</title>
<path fill="none" stroke="black" d="M1288.6,-2355.48C1291.76,-2355.18 1294.9,-2354.91 1298,-2354.66 1694.35,-2322.67 2692.63,-2369.52 3087,-2318.66 3098.67,-2317.16 3110.84,-2314.99 3122.81,-2312.51"/>
<polygon fill="black" stroke="black" points="3123.76,-2315.88 3132.79,-2310.35 3122.28,-2309.04 3123.76,-2315.88"/>
</g>
<!-- tp_12_1&#45;&gt;q_proj_13 -->
<g id="edge1959" class="edge">
<title>tp_12_1&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M3291.55,-2264.75C3306.55,-2261.4 3322.17,-2258.4 3337,-2256.44 3925.62,-2178.52 4083.04,-2267.08 4678.58,-2220.5"/>
<polygon fill="black" stroke="black" points="4679.02,-2223.98 4688.71,-2219.7 4678.47,-2217 4679.02,-2223.98"/>
</g>
<!-- tp_12_1&#45;&gt;k_proj_13 -->
<g id="edge1960" class="edge">
<title>tp_12_1&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M3291.21,-2264.77C3306.3,-2261.38 3322.06,-2258.37 3337,-2256.44 3699.04,-2209.45 4610.58,-2248.2 4992.67,-2220.47"/>
<polygon fill="black" stroke="black" points="4993,-2223.96 5002.71,-2219.72 4992.48,-2216.98 4993,-2223.96"/>
</g>
<!-- tp_12_1&#45;&gt;v_proj_13 -->
<g id="edge1961" class="edge">
<title>tp_12_1&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M3291.92,-2264.93C3306.81,-2261.58 3322.31,-2258.54 3337,-2256.44 3530.63,-2228.71 4088.96,-2210.77 4364.85,-2203.34"/>
<polygon fill="black" stroke="black" points="4365.05,-2206.84 4374.95,-2203.07 4364.86,-2199.84 4365.05,-2206.84"/>
</g>
<!-- expert_12_2_0 -->
<g id="node870" class="node">
<title>expert_12_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1583.5,-2398.66 1306.5,-2398.66 1306.5,-2354.66 1583.5,-2354.66 1583.5,-2398.66"/>
<text text-anchor="middle" x="1445" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L12</text>
<text text-anchor="middle" x="1445" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 388</text>
<text text-anchor="middle" x="1445" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1445" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_2&#45;&gt;expert_12_2_0 -->
<g id="edge1053" class="edge">
<title>route_12_2&#45;&gt;expert_12_2_0</title>
<path fill="none" stroke="black" d="M1649.08,-2437.93C1609.92,-2426.36 1564.49,-2412.94 1526.44,-2401.71"/>
<polygon fill="black" stroke="black" points="1527.01,-2398.23 1516.43,-2398.75 1525.03,-2404.94 1527.01,-2398.23"/>
</g>
<!-- expert_12_2_1 -->
<g id="node871" class="node">
<title>expert_12_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1878.5,-2398.66 1601.5,-2398.66 1601.5,-2354.66 1878.5,-2354.66 1878.5,-2398.66"/>
<text text-anchor="middle" x="1740" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L12</text>
<text text-anchor="middle" x="1740" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 389</text>
<text text-anchor="middle" x="1740" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1740" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_2&#45;&gt;expert_12_2_1 -->
<g id="edge1054" class="edge">
<title>route_12_2&#45;&gt;expert_12_2_1</title>
<path fill="none" stroke="black" d="M1740,-2434.31C1740,-2426.03 1740,-2417.05 1740,-2408.74"/>
<polygon fill="black" stroke="black" points="1743.5,-2408.67 1740,-2398.67 1736.5,-2408.67 1743.5,-2408.67"/>
</g>
<!-- tp_12_2 -->
<g id="node872" class="node">
<title>tp_12_2</title>
<ellipse fill="lightblue" stroke="black" cx="3462" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3462" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L12</text>
<text text-anchor="middle" x="3462" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 388↔389</text>
<text text-anchor="middle" x="3462" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3462" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_2_0&#45;&gt;tp_12_2 -->
<g id="edge1055" class="edge">
<title>expert_12_2_0&#45;&gt;tp_12_2</title>
<path fill="none" stroke="black" d="M1583.6,-2355.48C1586.76,-2355.19 1589.9,-2354.91 1593,-2354.66 1979.37,-2323.38 2952.56,-2368.34 3337,-2318.66 3348.67,-2317.15 3360.84,-2314.99 3372.81,-2312.5"/>
<polygon fill="black" stroke="black" points="3373.76,-2315.88 3382.79,-2310.34 3372.28,-2309.03 3373.76,-2315.88"/>
</g>
<!-- expert_12_2_1&#45;&gt;tp_12_2 -->
<g id="edge1056" class="edge">
<title>expert_12_2_1&#45;&gt;tp_12_2</title>
<path fill="none" stroke="black" d="M1878.6,-2355.5C1881.76,-2355.2 1884.9,-2354.92 1888,-2354.66 2529.99,-2301.32 2698.29,-2402.57 3337,-2318.66 3348.67,-2317.13 3360.84,-2314.95 3372.8,-2312.45"/>
<polygon fill="black" stroke="black" points="3373.75,-2315.83 3382.79,-2310.29 3372.27,-2308.99 3373.75,-2315.83"/>
</g>
<!-- tp_12_2&#45;&gt;q_proj_13 -->
<g id="edge1962" class="edge">
<title>tp_12_2&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M3541.56,-2264.83C3556.55,-2261.46 3572.18,-2258.44 3587,-2256.44 4065.35,-2191.63 4193.88,-2259.76 4678.65,-2220.5"/>
<polygon fill="black" stroke="black" points="4679.03,-2223.98 4688.71,-2219.67 4678.46,-2217 4679.03,-2223.98"/>
</g>
<!-- tp_12_2&#45;&gt;k_proj_13 -->
<g id="edge1963" class="edge">
<title>tp_12_2&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M3541.21,-2264.81C3556.31,-2261.43 3572.06,-2258.4 3587,-2256.44 4203.85,-2175.17 4368.66,-2268.96 4992.56,-2220.5"/>
<polygon fill="black" stroke="black" points="4993.02,-2223.97 5002.71,-2219.7 4992.47,-2217 4993.02,-2223.97"/>
</g>
<!-- tp_12_2&#45;&gt;v_proj_13 -->
<g id="edge1964" class="edge">
<title>tp_12_2&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M3542.28,-2265.01C3557.06,-2261.68 3572.43,-2258.62 3587,-2256.44 3858.14,-2215.84 4177.59,-2203.99 4364.46,-2200.63"/>
<polygon fill="black" stroke="black" points="4364.7,-2204.13 4374.64,-2200.45 4364.58,-2197.13 4364.7,-2204.13"/>
</g>
<!-- expert_12_3_0 -->
<g id="node874" class="node">
<title>expert_12_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2173.5,-2398.66 1896.5,-2398.66 1896.5,-2354.66 2173.5,-2354.66 2173.5,-2398.66"/>
<text text-anchor="middle" x="2035" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L12</text>
<text text-anchor="middle" x="2035" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 390</text>
<text text-anchor="middle" x="2035" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2035" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_3&#45;&gt;expert_12_3_0 -->
<g id="edge1058" class="edge">
<title>route_12_3&#45;&gt;expert_12_3_0</title>
<path fill="none" stroke="black" d="M2239.08,-2437.93C2199.92,-2426.36 2154.49,-2412.94 2116.44,-2401.71"/>
<polygon fill="black" stroke="black" points="2117.01,-2398.23 2106.43,-2398.75 2115.03,-2404.94 2117.01,-2398.23"/>
</g>
<!-- expert_12_3_1 -->
<g id="node875" class="node">
<title>expert_12_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2468.5,-2398.66 2191.5,-2398.66 2191.5,-2354.66 2468.5,-2354.66 2468.5,-2398.66"/>
<text text-anchor="middle" x="2330" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L12</text>
<text text-anchor="middle" x="2330" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 391</text>
<text text-anchor="middle" x="2330" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2330" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_3&#45;&gt;expert_12_3_1 -->
<g id="edge1059" class="edge">
<title>route_12_3&#45;&gt;expert_12_3_1</title>
<path fill="none" stroke="black" d="M2330,-2434.31C2330,-2426.03 2330,-2417.05 2330,-2408.74"/>
<polygon fill="black" stroke="black" points="2333.5,-2408.67 2330,-2398.67 2326.5,-2408.67 2333.5,-2408.67"/>
</g>
<!-- tp_12_3 -->
<g id="node876" class="node">
<title>tp_12_3</title>
<ellipse fill="lightblue" stroke="black" cx="3712" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3712" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L12</text>
<text text-anchor="middle" x="3712" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 390↔391</text>
<text text-anchor="middle" x="3712" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3712" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_3_0&#45;&gt;tp_12_3 -->
<g id="edge1060" class="edge">
<title>expert_12_3_0&#45;&gt;tp_12_3</title>
<path fill="none" stroke="black" d="M2173.6,-2355.5C2176.76,-2355.2 2179.9,-2354.92 2183,-2354.66 2805.04,-2302.73 2968.14,-2400.21 3587,-2318.66 3598.67,-2317.12 3610.84,-2314.94 3622.8,-2312.45"/>
<polygon fill="black" stroke="black" points="3623.75,-2315.82 3632.79,-2310.28 3622.27,-2308.98 3623.75,-2315.82"/>
</g>
<!-- expert_12_3_1&#45;&gt;tp_12_3 -->
<g id="edge1061" class="edge">
<title>expert_12_3_1&#45;&gt;tp_12_3</title>
<path fill="none" stroke="black" d="M2468.6,-2355.53C2471.76,-2355.22 2474.9,-2354.93 2478,-2354.66 2969.3,-2311.96 3098.3,-2384.75 3587,-2318.66 3598.58,-2317.1 3610.65,-2314.91 3622.52,-2312.43"/>
<polygon fill="black" stroke="black" points="3623.41,-2315.82 3632.44,-2310.28 3621.92,-2308.97 3623.41,-2315.82"/>
</g>
<!-- tp_12_3&#45;&gt;q_proj_13 -->
<g id="edge1965" class="edge">
<title>tp_12_3&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M3791.91,-2264.87C3806.8,-2261.52 3822.3,-2258.5 3837,-2256.44 4205.1,-2204.74 4304.69,-2252.47 4678.69,-2220.5"/>
<polygon fill="black" stroke="black" points="4679.05,-2223.99 4688.71,-2219.63 4678.44,-2217.01 4679.05,-2223.99"/>
</g>
<!-- tp_12_3&#45;&gt;k_proj_13 -->
<g id="edge1966" class="edge">
<title>tp_12_3&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M3791.56,-2264.81C3806.55,-2261.44 3822.18,-2258.43 3837,-2256.44 4343.52,-2188.28 4479.47,-2261.61 4992.45,-2220.51"/>
<polygon fill="black" stroke="black" points="4993.03,-2223.98 5002.71,-2219.68 4992.46,-2217 4993.03,-2223.98"/>
</g>
<!-- tp_12_3&#45;&gt;v_proj_13 -->
<g id="edge1967" class="edge">
<title>tp_12_3&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M3792.99,-2265.13C3807.57,-2261.82 3822.68,-2258.74 3837,-2256.44 4016.42,-2227.55 4224.75,-2212.86 4364.32,-2205.71"/>
<polygon fill="black" stroke="black" points="4364.86,-2209.18 4374.67,-2205.18 4364.51,-2202.19 4364.86,-2209.18"/>
</g>
<!-- expert_12_4_0 -->
<g id="node878" class="node">
<title>expert_12_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2763.5,-2398.66 2486.5,-2398.66 2486.5,-2354.66 2763.5,-2354.66 2763.5,-2398.66"/>
<text text-anchor="middle" x="2625" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L12</text>
<text text-anchor="middle" x="2625" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 392</text>
<text text-anchor="middle" x="2625" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2625" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_4&#45;&gt;expert_12_4_0 -->
<g id="edge1063" class="edge">
<title>route_12_4&#45;&gt;expert_12_4_0</title>
<path fill="none" stroke="black" d="M2829.08,-2437.93C2789.92,-2426.36 2744.49,-2412.94 2706.44,-2401.71"/>
<polygon fill="black" stroke="black" points="2707.01,-2398.23 2696.43,-2398.75 2705.03,-2404.94 2707.01,-2398.23"/>
</g>
<!-- expert_12_4_1 -->
<g id="node879" class="node">
<title>expert_12_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3058.5,-2398.66 2781.5,-2398.66 2781.5,-2354.66 3058.5,-2354.66 3058.5,-2398.66"/>
<text text-anchor="middle" x="2920" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L12</text>
<text text-anchor="middle" x="2920" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 393</text>
<text text-anchor="middle" x="2920" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2920" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_4&#45;&gt;expert_12_4_1 -->
<g id="edge1064" class="edge">
<title>route_12_4&#45;&gt;expert_12_4_1</title>
<path fill="none" stroke="black" d="M2920,-2434.31C2920,-2426.03 2920,-2417.05 2920,-2408.74"/>
<polygon fill="black" stroke="black" points="2923.5,-2408.67 2920,-2398.67 2916.5,-2408.67 2923.5,-2408.67"/>
</g>
<!-- tp_12_4 -->
<g id="node880" class="node">
<title>tp_12_4</title>
<ellipse fill="lightblue" stroke="black" cx="3962" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3962" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L12</text>
<text text-anchor="middle" x="3962" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 392↔393</text>
<text text-anchor="middle" x="3962" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3962" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_4_0&#45;&gt;tp_12_4 -->
<g id="edge1065" class="edge">
<title>expert_12_4_0&#45;&gt;tp_12_4</title>
<path fill="none" stroke="black" d="M2763.6,-2355.54C2766.76,-2355.23 2769.9,-2354.93 2773,-2354.66 3244.35,-2313.37 3368.15,-2382.4 3837,-2318.66 3848.58,-2317.09 3860.65,-2314.9 3872.52,-2312.41"/>
<polygon fill="black" stroke="black" points="3873.41,-2315.8 3882.44,-2310.26 3871.92,-2308.96 3873.41,-2315.8"/>
</g>
<!-- expert_12_4_1&#45;&gt;tp_12_4 -->
<g id="edge1066" class="edge">
<title>expert_12_4_1&#45;&gt;tp_12_4</title>
<path fill="none" stroke="black" d="M3058.6,-2355.59C3061.76,-2355.26 3064.9,-2354.95 3068,-2354.66 3408.65,-2322.59 3498.27,-2366.94 3837,-2318.66 3848.48,-2317.02 3860.45,-2314.81 3872.24,-2312.32"/>
<polygon fill="black" stroke="black" points="3873.06,-2315.73 3882.08,-2310.18 3871.56,-2308.89 3873.06,-2315.73"/>
</g>
<!-- tp_12_4&#45;&gt;q_proj_13 -->
<g id="edge1968" class="edge">
<title>tp_12_4&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M4042.28,-2265.01C4057.06,-2261.67 4072.43,-2258.62 4087,-2256.44 4344.82,-2217.86 4415.41,-2245.24 4678.46,-2220.54"/>
<polygon fill="black" stroke="black" points="4679.08,-2224 4688.7,-2219.56 4678.41,-2217.03 4679.08,-2224"/>
</g>
<!-- tp_12_4&#45;&gt;k_proj_13 -->
<g id="edge1969" class="edge">
<title>tp_12_4&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M4041.57,-2264.91C4056.56,-2261.54 4072.19,-2258.49 4087,-2256.44 4483.27,-2201.39 4590.3,-2254.32 4992.54,-2220.51"/>
<polygon fill="black" stroke="black" points="4993.04,-2223.98 5002.71,-2219.65 4992.45,-2217.01 4993.04,-2223.98"/>
</g>
<!-- tp_12_4&#45;&gt;v_proj_13 -->
<g id="edge1970" class="edge">
<title>tp_12_4&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M4044.1,-2265.46C4058.35,-2262.17 4073.06,-2259.02 4087,-2256.44 4178.51,-2239.48 4281.75,-2225.75 4364.79,-2216.01"/>
<polygon fill="black" stroke="black" points="4365.28,-2219.48 4374.81,-2214.84 4364.47,-2212.52 4365.28,-2219.48"/>
</g>
<!-- expert_12_5_0 -->
<g id="node882" class="node">
<title>expert_12_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3353.5,-2398.66 3076.5,-2398.66 3076.5,-2354.66 3353.5,-2354.66 3353.5,-2398.66"/>
<text text-anchor="middle" x="3215" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L12</text>
<text text-anchor="middle" x="3215" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 394</text>
<text text-anchor="middle" x="3215" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3215" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_5&#45;&gt;expert_12_5_0 -->
<g id="edge1068" class="edge">
<title>route_12_5&#45;&gt;expert_12_5_0</title>
<path fill="none" stroke="black" d="M3419.08,-2437.93C3379.92,-2426.36 3334.49,-2412.94 3296.44,-2401.71"/>
<polygon fill="black" stroke="black" points="3297.01,-2398.23 3286.43,-2398.75 3295.03,-2404.94 3297.01,-2398.23"/>
</g>
<!-- expert_12_5_1 -->
<g id="node883" class="node">
<title>expert_12_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3648.5,-2398.66 3371.5,-2398.66 3371.5,-2354.66 3648.5,-2354.66 3648.5,-2398.66"/>
<text text-anchor="middle" x="3510" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L12</text>
<text text-anchor="middle" x="3510" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 395</text>
<text text-anchor="middle" x="3510" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3510" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_5&#45;&gt;expert_12_5_1 -->
<g id="edge1069" class="edge">
<title>route_12_5&#45;&gt;expert_12_5_1</title>
<path fill="none" stroke="black" d="M3510,-2434.31C3510,-2426.03 3510,-2417.05 3510,-2408.74"/>
<polygon fill="black" stroke="black" points="3513.5,-2408.67 3510,-2398.67 3506.5,-2408.67 3513.5,-2408.67"/>
</g>
<!-- tp_12_5 -->
<g id="node884" class="node">
<title>tp_12_5</title>
<ellipse fill="lightblue" stroke="black" cx="4212" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4212" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L12</text>
<text text-anchor="middle" x="4212" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 394↔395</text>
<text text-anchor="middle" x="4212" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4212" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_5_0&#45;&gt;tp_12_5 -->
<g id="edge1070" class="edge">
<title>expert_12_5_0&#45;&gt;tp_12_5</title>
<path fill="none" stroke="black" d="M3353.61,-2355.6C3356.77,-2355.27 3359.9,-2354.96 3363,-2354.66 3683.71,-2324 3768.11,-2364.59 4087,-2318.66 4098.48,-2317.01 4110.45,-2314.79 4122.23,-2312.29"/>
<polygon fill="black" stroke="black" points="4123.05,-2315.7 4132.07,-2310.14 4121.56,-2308.86 4123.05,-2315.7"/>
</g>
<!-- expert_12_5_1&#45;&gt;tp_12_5 -->
<g id="edge1071" class="edge">
<title>expert_12_5_1&#45;&gt;tp_12_5</title>
<path fill="none" stroke="black" d="M3648.62,-2355.75C3651.78,-2355.37 3654.91,-2355.01 3658,-2354.66 3848.13,-2333.21 3898.11,-2349.16 4087,-2318.66 4098.08,-2316.87 4109.63,-2314.63 4121.03,-2312.17"/>
<polygon fill="black" stroke="black" points="4122,-2315.54 4131,-2309.96 4120.48,-2308.7 4122,-2315.54"/>
</g>
<!-- tp_12_5&#45;&gt;q_proj_13 -->
<g id="edge1971" class="edge">
<title>tp_12_5&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M4293.37,-2265.31C4307.84,-2262 4322.81,-2258.88 4337,-2256.44 4484.81,-2230.99 4526.04,-2238.26 4678.48,-2220.59"/>
<polygon fill="black" stroke="black" points="4679.16,-2224.03 4688.68,-2219.39 4678.34,-2217.08 4679.16,-2224.03"/>
</g>
<!-- tp_12_5&#45;&gt;k_proj_13 -->
<g id="edge1972" class="edge">
<title>tp_12_5&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M4292.27,-2264.94C4307.05,-2261.61 4322.42,-2258.57 4337,-2256.44 4623.1,-2214.49 4701.1,-2247.09 4992.68,-2220.51"/>
<polygon fill="black" stroke="black" points="4993.07,-2223.99 5002.7,-2219.59 4992.42,-2217.02 4993.07,-2223.99"/>
</g>
<!-- tp_12_5&#45;&gt;v_proj_13 -->
<g id="edge1973" class="edge">
<title>tp_12_5&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M4290.48,-2264.57C4335.5,-2251.96 4392.05,-2236.12 4438.1,-2223.22"/>
<polygon fill="black" stroke="black" points="4439.08,-2226.58 4447.77,-2220.51 4437.19,-2219.84 4439.08,-2226.58"/>
</g>
<!-- expert_12_6_0 -->
<g id="node886" class="node">
<title>expert_12_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3943.5,-2398.66 3666.5,-2398.66 3666.5,-2354.66 3943.5,-2354.66 3943.5,-2398.66"/>
<text text-anchor="middle" x="3805" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L12</text>
<text text-anchor="middle" x="3805" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 396</text>
<text text-anchor="middle" x="3805" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3805" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_6&#45;&gt;expert_12_6_0 -->
<g id="edge1073" class="edge">
<title>route_12_6&#45;&gt;expert_12_6_0</title>
<path fill="none" stroke="black" d="M4009.08,-2437.93C3969.92,-2426.36 3924.49,-2412.94 3886.44,-2401.71"/>
<polygon fill="black" stroke="black" points="3887.01,-2398.23 3876.43,-2398.75 3885.03,-2404.94 3887.01,-2398.23"/>
</g>
<!-- expert_12_6_1 -->
<g id="node887" class="node">
<title>expert_12_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4238.5,-2398.66 3961.5,-2398.66 3961.5,-2354.66 4238.5,-2354.66 4238.5,-2398.66"/>
<text text-anchor="middle" x="4100" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L12</text>
<text text-anchor="middle" x="4100" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 397</text>
<text text-anchor="middle" x="4100" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4100" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_6&#45;&gt;expert_12_6_1 -->
<g id="edge1074" class="edge">
<title>route_12_6&#45;&gt;expert_12_6_1</title>
<path fill="none" stroke="black" d="M4100,-2434.31C4100,-2426.03 4100,-2417.05 4100,-2408.74"/>
<polygon fill="black" stroke="black" points="4103.5,-2408.67 4100,-2398.67 4096.5,-2408.67 4103.5,-2408.67"/>
</g>
<!-- tp_12_6 -->
<g id="node888" class="node">
<title>tp_12_6</title>
<ellipse fill="lightblue" stroke="black" cx="4462" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4462" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L12</text>
<text text-anchor="middle" x="4462" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 396↔397</text>
<text text-anchor="middle" x="4462" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4462" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_6_0&#45;&gt;tp_12_6 -->
<g id="edge1075" class="edge">
<title>expert_12_6_0&#45;&gt;tp_12_6</title>
<path fill="none" stroke="black" d="M3943.63,-2355.79C3946.78,-2355.4 3949.91,-2355.03 3953,-2354.66 4123.24,-2334.61 4167.91,-2346.81 4337,-2318.66 4348.07,-2316.82 4359.61,-2314.54 4371.02,-2312.06"/>
<polygon fill="black" stroke="black" points="4371.98,-2315.43 4380.98,-2309.84 4370.46,-2308.6 4371.98,-2315.43"/>
</g>
<!-- expert_12_6_1&#45;&gt;tp_12_6 -->
<g id="edge1076" class="edge">
<title>expert_12_6_1&#45;&gt;tp_12_6</title>
<path fill="none" stroke="black" d="M4187.51,-2354.62C4232.24,-2343.87 4287.52,-2330.57 4337,-2318.66 4346.87,-2316.29 4357.17,-2313.8 4367.45,-2311.33"/>
<polygon fill="black" stroke="black" points="4368.38,-2314.71 4377.28,-2308.96 4366.74,-2307.9 4368.38,-2314.71"/>
</g>
<!-- tp_12_6&#45;&gt;q_proj_13 -->
<g id="edge1974" class="edge">
<title>tp_12_6&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M4546.35,-2266.08C4559.94,-2262.83 4573.85,-2259.52 4587,-2256.44 4635.15,-2245.15 4688.59,-2232.92 4733.67,-2222.7"/>
<polygon fill="black" stroke="black" points="4734.47,-2226.1 4743.45,-2220.48 4732.92,-2219.28 4734.47,-2226.1"/>
</g>
<!-- tp_12_6&#45;&gt;k_proj_13 -->
<g id="edge1975" class="edge">
<title>tp_12_6&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M4543,-2265.19C4557.58,-2261.88 4572.68,-2258.78 4587,-2256.44 4762.97,-2227.62 4811.76,-2240.01 4992.57,-2220.56"/>
<polygon fill="black" stroke="black" points="4993.13,-2224.02 5002.69,-2219.45 4992.37,-2217.06 4993.13,-2224.02"/>
</g>
<!-- tp_12_6&#45;&gt;v_proj_13 -->
<g id="edge1976" class="edge">
<title>tp_12_6&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M4482.99,-2256.57C4489.26,-2247.62 4496.12,-2237.82 4502.37,-2228.9"/>
<polygon fill="black" stroke="black" points="4505.26,-2230.88 4508.13,-2220.68 4499.52,-2226.86 4505.26,-2230.88"/>
</g>
<!-- expert_12_7_0 -->
<g id="node890" class="node">
<title>expert_12_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4533.5,-2398.66 4256.5,-2398.66 4256.5,-2354.66 4533.5,-2354.66 4533.5,-2398.66"/>
<text text-anchor="middle" x="4395" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L12</text>
<text text-anchor="middle" x="4395" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 398</text>
<text text-anchor="middle" x="4395" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4395" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_7&#45;&gt;expert_12_7_0 -->
<g id="edge1078" class="edge">
<title>route_12_7&#45;&gt;expert_12_7_0</title>
<path fill="none" stroke="black" d="M4552.64,-2436.85C4523.11,-2425.76 4489.42,-2413.12 4460.8,-2402.37"/>
<polygon fill="black" stroke="black" points="4461.89,-2399.04 4451.29,-2398.8 4459.43,-2405.59 4461.89,-2399.04"/>
</g>
<!-- expert_12_7_1 -->
<g id="node891" class="node">
<title>expert_12_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4828.5,-2398.66 4551.5,-2398.66 4551.5,-2354.66 4828.5,-2354.66 4828.5,-2398.66"/>
<text text-anchor="middle" x="4690" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L12</text>
<text text-anchor="middle" x="4690" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 399</text>
<text text-anchor="middle" x="4690" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4690" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_7&#45;&gt;expert_12_7_1 -->
<g id="edge1079" class="edge">
<title>route_12_7&#45;&gt;expert_12_7_1</title>
<path fill="none" stroke="black" d="M4648.68,-2434.79C4655.15,-2425.84 4662.24,-2416.04 4668.69,-2407.12"/>
<polygon fill="black" stroke="black" points="4671.61,-2409.06 4674.64,-2398.9 4665.94,-2404.95 4671.61,-2409.06"/>
</g>
<!-- tp_12_7 -->
<g id="node892" class="node">
<title>tp_12_7</title>
<ellipse fill="lightblue" stroke="black" cx="4712" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4712" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L12</text>
<text text-anchor="middle" x="4712" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 398↔399</text>
<text text-anchor="middle" x="4712" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4712" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_7_0&#45;&gt;tp_12_7 -->
<g id="edge1080" class="edge">
<title>expert_12_7_0&#45;&gt;tp_12_7</title>
<path fill="none" stroke="black" d="M4471.74,-2354.57C4517.34,-2342.04 4575.37,-2326.1 4622.98,-2313.01"/>
<polygon fill="black" stroke="black" points="4623.94,-2316.38 4632.66,-2310.35 4622.09,-2309.63 4623.94,-2316.38"/>
</g>
<!-- expert_12_7_1&#45;&gt;tp_12_7 -->
<g id="edge1081" class="edge">
<title>expert_12_7_1&#45;&gt;tp_12_7</title>
<path fill="none" stroke="black" d="M4695.33,-2354.57C4697.3,-2346.74 4699.62,-2337.58 4701.88,-2328.62"/>
<polygon fill="black" stroke="black" points="4705.34,-2329.21 4704.4,-2318.66 4698.55,-2327.5 4705.34,-2329.21"/>
</g>
<!-- tp_12_7&#45;&gt;q_proj_13 -->
<g id="edge1977" class="edge">
<title>tp_12_7&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M4752.58,-2258.27C4767.24,-2248.05 4783.74,-2236.55 4798.24,-2226.44"/>
<polygon fill="black" stroke="black" points="4800.32,-2229.27 4806.52,-2220.68 4796.31,-2223.52 4800.32,-2229.27"/>
</g>
<!-- tp_12_7&#45;&gt;k_proj_13 -->
<g id="edge1978" class="edge">
<title>tp_12_7&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M4795.23,-2265.8C4809.14,-2262.53 4823.46,-2259.29 4837,-2256.44 4895.43,-2244.11 4960.31,-2232.05 5015.87,-2222.23"/>
<polygon fill="black" stroke="black" points="5016.53,-2225.67 5025.77,-2220.49 5015.31,-2218.78 5016.53,-2225.67"/>
</g>
<!-- tp_12_7&#45;&gt;v_proj_13 -->
<g id="edge1979" class="edge">
<title>tp_12_7&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M4655.04,-2260.29C4630.67,-2249.06 4602.32,-2235.99 4578.15,-2224.85"/>
<polygon fill="black" stroke="black" points="4579.31,-2221.54 4568.76,-2220.53 4576.38,-2227.89 4579.31,-2221.54"/>
</g>
<!-- expert_12_8_0 -->
<g id="node894" class="node">
<title>expert_12_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5123.5,-2398.66 4846.5,-2398.66 4846.5,-2354.66 5123.5,-2354.66 5123.5,-2398.66"/>
<text text-anchor="middle" x="4985" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L12</text>
<text text-anchor="middle" x="4985" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="4985" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4985" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_8&#45;&gt;expert_12_8_0 -->
<g id="edge1083" class="edge">
<title>route_12_8&#45;&gt;expert_12_8_0</title>
<path fill="none" stroke="black" d="M5025.66,-2434.79C5019.29,-2425.84 5012.32,-2416.04 5005.97,-2407.12"/>
<polygon fill="black" stroke="black" points="5008.77,-2405.02 5000.12,-2398.9 5003.06,-2409.08 5008.77,-2405.02"/>
</g>
<!-- expert_12_8_1 -->
<g id="node895" class="node">
<title>expert_12_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5418.5,-2398.66 5141.5,-2398.66 5141.5,-2354.66 5418.5,-2354.66 5418.5,-2398.66"/>
<text text-anchor="middle" x="5280" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L12</text>
<text text-anchor="middle" x="5280" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="5280" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5280" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_8&#45;&gt;expert_12_8_1 -->
<g id="edge1084" class="edge">
<title>route_12_8&#45;&gt;expert_12_8_1</title>
<path fill="none" stroke="black" d="M5121.68,-2436.85C5151.34,-2425.76 5185.17,-2413.12 5213.92,-2402.37"/>
<polygon fill="black" stroke="black" points="5215.32,-2405.58 5223.46,-2398.8 5212.87,-2399.02 5215.32,-2405.58"/>
</g>
<!-- tp_12_8 -->
<g id="node896" class="node">
<title>tp_12_8</title>
<ellipse fill="lightblue" stroke="black" cx="4962" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4962" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L12</text>
<text text-anchor="middle" x="4962" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="4962" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4962" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_8_0&#45;&gt;tp_12_8 -->
<g id="edge1085" class="edge">
<title>expert_12_8_0&#45;&gt;tp_12_8</title>
<path fill="none" stroke="black" d="M4979.43,-2354.57C4977.37,-2346.74 4974.95,-2337.58 4972.58,-2328.62"/>
<polygon fill="black" stroke="black" points="4975.89,-2327.44 4969.95,-2318.66 4969.12,-2329.22 4975.89,-2327.44"/>
</g>
<!-- expert_12_8_1&#45;&gt;tp_12_8 -->
<g id="edge1086" class="edge">
<title>expert_12_8_1&#45;&gt;tp_12_8</title>
<path fill="none" stroke="black" d="M5203.02,-2354.57C5157.19,-2342.02 5098.84,-2326.04 5051.04,-2312.94"/>
<polygon fill="black" stroke="black" points="5051.88,-2309.54 5041.31,-2310.28 5050.03,-2316.29 5051.88,-2309.54"/>
</g>
<!-- tp_12_8&#45;&gt;q_proj_13 -->
<g id="edge1980" class="edge">
<title>tp_12_8&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M4921.42,-2258.27C4906.76,-2248.05 4890.26,-2236.55 4875.76,-2226.44"/>
<polygon fill="black" stroke="black" points="4877.69,-2223.52 4867.48,-2220.68 4873.68,-2229.27 4877.69,-2223.52"/>
</g>
<!-- tp_12_8&#45;&gt;k_proj_13 -->
<g id="edge1981" class="edge">
<title>tp_12_8&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M5018.96,-2260.29C5043.33,-2249.06 5071.68,-2235.99 5095.85,-2224.85"/>
<polygon fill="black" stroke="black" points="5097.62,-2227.89 5105.24,-2220.53 5094.69,-2221.54 5097.62,-2227.89"/>
</g>
<!-- tp_12_8&#45;&gt;v_proj_13 -->
<g id="edge1982" class="edge">
<title>tp_12_8&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M4878.77,-2265.8C4864.86,-2262.53 4850.54,-2259.29 4837,-2256.44 4778.57,-2244.11 4713.69,-2232.05 4658.13,-2222.23"/>
<polygon fill="black" stroke="black" points="4658.69,-2218.78 4648.23,-2220.49 4657.47,-2225.67 4658.69,-2218.78"/>
</g>
<!-- expert_12_9_0 -->
<g id="node898" class="node">
<title>expert_12_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5713.5,-2398.66 5436.5,-2398.66 5436.5,-2354.66 5713.5,-2354.66 5713.5,-2398.66"/>
<text text-anchor="middle" x="5575" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L12</text>
<text text-anchor="middle" x="5575" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 418</text>
<text text-anchor="middle" x="5575" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5575" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_9&#45;&gt;expert_12_9_0 -->
<g id="edge1088" class="edge">
<title>route_12_9&#45;&gt;expert_12_9_0</title>
<path fill="none" stroke="black" d="M5575,-2434.31C5575,-2426.03 5575,-2417.05 5575,-2408.74"/>
<polygon fill="black" stroke="black" points="5578.5,-2408.67 5575,-2398.67 5571.5,-2408.67 5578.5,-2408.67"/>
</g>
<!-- expert_12_9_1 -->
<g id="node899" class="node">
<title>expert_12_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6008.5,-2398.66 5731.5,-2398.66 5731.5,-2354.66 6008.5,-2354.66 6008.5,-2398.66"/>
<text text-anchor="middle" x="5870" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L12</text>
<text text-anchor="middle" x="5870" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 419</text>
<text text-anchor="middle" x="5870" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5870" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_9&#45;&gt;expert_12_9_1 -->
<g id="edge1089" class="edge">
<title>route_12_9&#45;&gt;expert_12_9_1</title>
<path fill="none" stroke="black" d="M5665.92,-2437.93C5705.08,-2426.36 5750.51,-2412.94 5788.56,-2401.71"/>
<polygon fill="black" stroke="black" points="5789.97,-2404.94 5798.57,-2398.75 5787.99,-2398.23 5789.97,-2404.94"/>
</g>
<!-- tp_12_9 -->
<g id="node900" class="node">
<title>tp_12_9</title>
<ellipse fill="lightblue" stroke="black" cx="5212" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5212" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L12</text>
<text text-anchor="middle" x="5212" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 418↔419</text>
<text text-anchor="middle" x="5212" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5212" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_9_0&#45;&gt;tp_12_9 -->
<g id="edge1090" class="edge">
<title>expert_12_9_0&#45;&gt;tp_12_9</title>
<path fill="none" stroke="black" d="M5487.11,-2354.64C5442.2,-2343.89 5386.68,-2330.59 5337,-2318.66 5327.05,-2316.27 5316.65,-2313.77 5306.29,-2311.28"/>
<polygon fill="black" stroke="black" points="5306.92,-2307.83 5296.38,-2308.89 5305.28,-2314.64 5306.92,-2307.83"/>
</g>
<!-- expert_12_9_1&#45;&gt;tp_12_9 -->
<g id="edge1091" class="edge">
<title>expert_12_9_1&#45;&gt;tp_12_9</title>
<path fill="none" stroke="black" d="M5731.14,-2355.64C5728.4,-2355.3 5725.69,-2354.98 5723,-2354.66 5551.89,-2334.47 5506.97,-2346.91 5337,-2318.66 5325.93,-2316.82 5314.39,-2314.54 5302.98,-2312.07"/>
<polygon fill="black" stroke="black" points="5303.54,-2308.61 5293.01,-2309.85 5302.02,-2315.44 5303.54,-2308.61"/>
</g>
<!-- tp_12_9&#45;&gt;q_proj_13 -->
<g id="edge1983" class="edge">
<title>tp_12_9&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M5127.65,-2266.08C5114.06,-2262.83 5100.15,-2259.52 5087,-2256.44 5038.85,-2245.15 4985.41,-2232.92 4940.33,-2222.7"/>
<polygon fill="black" stroke="black" points="4941.08,-2219.28 4930.55,-2220.48 4939.53,-2226.1 4941.08,-2219.28"/>
</g>
<!-- tp_12_9&#45;&gt;k_proj_13 -->
<g id="edge1984" class="edge">
<title>tp_12_9&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M5191.01,-2256.57C5184.74,-2247.62 5177.88,-2237.82 5171.63,-2228.9"/>
<polygon fill="black" stroke="black" points="5174.48,-2226.86 5165.87,-2220.68 5168.74,-2230.88 5174.48,-2226.86"/>
</g>
<!-- tp_12_9&#45;&gt;v_proj_13 -->
<g id="edge1985" class="edge">
<title>tp_12_9&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M5131,-2265.19C5116.42,-2261.88 5101.32,-2258.78 5087,-2256.44 4911.03,-2227.62 4862.24,-2240.01 4681.43,-2220.56"/>
<polygon fill="black" stroke="black" points="4681.63,-2217.06 4671.31,-2219.45 4680.87,-2224.02 4681.63,-2217.06"/>
</g>
<!-- expert_12_10_0 -->
<g id="node902" class="node">
<title>expert_12_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6303.5,-2398.66 6026.5,-2398.66 6026.5,-2354.66 6303.5,-2354.66 6303.5,-2398.66"/>
<text text-anchor="middle" x="6165" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L12</text>
<text text-anchor="middle" x="6165" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 420</text>
<text text-anchor="middle" x="6165" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6165" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_10&#45;&gt;expert_12_10_0 -->
<g id="edge1093" class="edge">
<title>route_12_10&#45;&gt;expert_12_10_0</title>
<path fill="none" stroke="black" d="M6165,-2434.31C6165,-2426.03 6165,-2417.05 6165,-2408.74"/>
<polygon fill="black" stroke="black" points="6168.5,-2408.67 6165,-2398.67 6161.5,-2408.67 6168.5,-2408.67"/>
</g>
<!-- expert_12_10_1 -->
<g id="node903" class="node">
<title>expert_12_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6598.5,-2398.66 6321.5,-2398.66 6321.5,-2354.66 6598.5,-2354.66 6598.5,-2398.66"/>
<text text-anchor="middle" x="6460" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L12</text>
<text text-anchor="middle" x="6460" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 421</text>
<text text-anchor="middle" x="6460" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6460" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_10&#45;&gt;expert_12_10_1 -->
<g id="edge1094" class="edge">
<title>route_12_10&#45;&gt;expert_12_10_1</title>
<path fill="none" stroke="black" d="M6255.92,-2437.93C6295.08,-2426.36 6340.51,-2412.94 6378.56,-2401.71"/>
<polygon fill="black" stroke="black" points="6379.97,-2404.94 6388.57,-2398.75 6377.99,-2398.23 6379.97,-2404.94"/>
</g>
<!-- tp_12_10 -->
<g id="node904" class="node">
<title>tp_12_10</title>
<ellipse fill="lightblue" stroke="black" cx="5462" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5462" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L12</text>
<text text-anchor="middle" x="5462" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 420↔421</text>
<text text-anchor="middle" x="5462" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5462" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_10_0&#45;&gt;tp_12_10 -->
<g id="edge1095" class="edge">
<title>expert_12_10_0&#45;&gt;tp_12_10</title>
<path fill="none" stroke="black" d="M6026.14,-2355.6C6023.41,-2355.28 6020.69,-2354.97 6018,-2354.66 5827,-2333.06 5776.77,-2349.26 5587,-2318.66 5575.92,-2316.87 5564.37,-2314.63 5552.97,-2312.17"/>
<polygon fill="black" stroke="black" points="5553.52,-2308.71 5543,-2309.97 5552,-2315.54 5553.52,-2308.71"/>
</g>
<!-- expert_12_10_1&#45;&gt;tp_12_10 -->
<g id="edge1096" class="edge">
<title>expert_12_10_1&#45;&gt;tp_12_10</title>
<path fill="none" stroke="black" d="M6321.16,-2355.48C6318.42,-2355.19 6315.69,-2354.92 6313,-2354.66 5991.42,-2323.78 5906.77,-2364.69 5587,-2318.66 5575.52,-2317.01 5563.55,-2314.79 5551.77,-2312.29"/>
<polygon fill="black" stroke="black" points="5552.44,-2308.86 5541.93,-2310.14 5550.95,-2315.7 5552.44,-2308.86"/>
</g>
<!-- tp_12_10&#45;&gt;q_proj_13 -->
<g id="edge1986" class="edge">
<title>tp_12_10&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M5380.63,-2265.31C5366.16,-2262 5351.19,-2258.88 5337,-2256.44 5189.19,-2230.99 5147.96,-2238.26 4995.52,-2220.59"/>
<polygon fill="black" stroke="black" points="4995.66,-2217.08 4985.32,-2219.39 4994.84,-2224.03 4995.66,-2217.08"/>
</g>
<!-- tp_12_10&#45;&gt;k_proj_13 -->
<g id="edge1987" class="edge">
<title>tp_12_10&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M5383.52,-2264.57C5338.5,-2251.96 5281.95,-2236.12 5235.9,-2223.22"/>
<polygon fill="black" stroke="black" points="5236.81,-2219.84 5226.23,-2220.51 5234.92,-2226.58 5236.81,-2219.84"/>
</g>
<!-- tp_12_10&#45;&gt;v_proj_13 -->
<g id="edge1988" class="edge">
<title>tp_12_10&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M5381.73,-2264.94C5366.95,-2261.61 5351.58,-2258.57 5337,-2256.44 5050.9,-2214.49 4972.9,-2247.09 4681.32,-2220.51"/>
<polygon fill="black" stroke="black" points="4681.58,-2217.02 4671.3,-2219.59 4680.93,-2223.99 4681.58,-2217.02"/>
</g>
<!-- expert_12_11_0 -->
<g id="node906" class="node">
<title>expert_12_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6893.5,-2398.66 6616.5,-2398.66 6616.5,-2354.66 6893.5,-2354.66 6893.5,-2398.66"/>
<text text-anchor="middle" x="6755" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L12</text>
<text text-anchor="middle" x="6755" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 422</text>
<text text-anchor="middle" x="6755" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6755" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_11&#45;&gt;expert_12_11_0 -->
<g id="edge1098" class="edge">
<title>route_12_11&#45;&gt;expert_12_11_0</title>
<path fill="none" stroke="black" d="M6755,-2434.31C6755,-2426.03 6755,-2417.05 6755,-2408.74"/>
<polygon fill="black" stroke="black" points="6758.5,-2408.67 6755,-2398.67 6751.5,-2408.67 6758.5,-2408.67"/>
</g>
<!-- expert_12_11_1 -->
<g id="node907" class="node">
<title>expert_12_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7188.5,-2398.66 6911.5,-2398.66 6911.5,-2354.66 7188.5,-2354.66 7188.5,-2398.66"/>
<text text-anchor="middle" x="7050" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L12</text>
<text text-anchor="middle" x="7050" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 423</text>
<text text-anchor="middle" x="7050" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7050" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_11&#45;&gt;expert_12_11_1 -->
<g id="edge1099" class="edge">
<title>route_12_11&#45;&gt;expert_12_11_1</title>
<path fill="none" stroke="black" d="M6845.92,-2437.93C6885.08,-2426.36 6930.51,-2412.94 6968.56,-2401.71"/>
<polygon fill="black" stroke="black" points="6969.97,-2404.94 6978.57,-2398.75 6967.99,-2398.23 6969.97,-2404.94"/>
</g>
<!-- tp_12_11 -->
<g id="node908" class="node">
<title>tp_12_11</title>
<ellipse fill="lightblue" stroke="black" cx="5712" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5712" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L12</text>
<text text-anchor="middle" x="5712" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 422↔423</text>
<text text-anchor="middle" x="5712" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5712" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_11_0&#45;&gt;tp_12_11 -->
<g id="edge1100" class="edge">
<title>expert_12_11_0&#45;&gt;tp_12_11</title>
<path fill="none" stroke="black" d="M6616.16,-2355.47C6613.42,-2355.19 6610.69,-2354.92 6608,-2354.66 6266.48,-2322.37 6176.61,-2367.05 5837,-2318.66 5825.52,-2317.03 5813.55,-2314.81 5801.76,-2312.33"/>
<polygon fill="black" stroke="black" points="5802.44,-2308.89 5791.92,-2310.18 5800.94,-2315.73 5802.44,-2308.89"/>
</g>
<!-- expert_12_11_1&#45;&gt;tp_12_11 -->
<g id="edge1101" class="edge">
<title>expert_12_11_1&#45;&gt;tp_12_11</title>
<path fill="none" stroke="black" d="M6911.16,-2355.42C6908.42,-2355.15 6905.7,-2354.9 6903,-2354.66 6430.78,-2313.08 6306.73,-2382.5 5837,-2318.66 5825.42,-2317.09 5813.35,-2314.9 5801.48,-2312.41"/>
<polygon fill="black" stroke="black" points="5802.08,-2308.96 5791.56,-2310.26 5800.59,-2315.8 5802.08,-2308.96"/>
</g>
<!-- tp_12_11&#45;&gt;q_proj_13 -->
<g id="edge1989" class="edge">
<title>tp_12_11&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M5631.72,-2265.01C5616.94,-2261.67 5601.57,-2258.62 5587,-2256.44 5329.18,-2217.86 5258.59,-2245.24 4995.54,-2220.54"/>
<polygon fill="black" stroke="black" points="4995.59,-2217.03 4985.3,-2219.56 4994.92,-2224 4995.59,-2217.03"/>
</g>
<!-- tp_12_11&#45;&gt;k_proj_13 -->
<g id="edge1990" class="edge">
<title>tp_12_11&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M5629.9,-2265.46C5615.65,-2262.17 5600.94,-2259.02 5587,-2256.44 5495.49,-2239.48 5392.25,-2225.75 5309.21,-2216.01"/>
<polygon fill="black" stroke="black" points="5309.53,-2212.52 5299.19,-2214.84 5308.72,-2219.48 5309.53,-2212.52"/>
</g>
<!-- tp_12_11&#45;&gt;v_proj_13 -->
<g id="edge1991" class="edge">
<title>tp_12_11&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M5632.43,-2264.91C5617.44,-2261.54 5601.81,-2258.49 5587,-2256.44 5190.73,-2201.39 5083.7,-2254.32 4681.46,-2220.51"/>
<polygon fill="black" stroke="black" points="4681.55,-2217.01 4671.29,-2219.65 4680.96,-2223.98 4681.55,-2217.01"/>
</g>
<!-- expert_12_12_0 -->
<g id="node910" class="node">
<title>expert_12_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7483.5,-2398.66 7206.5,-2398.66 7206.5,-2354.66 7483.5,-2354.66 7483.5,-2398.66"/>
<text text-anchor="middle" x="7345" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L12</text>
<text text-anchor="middle" x="7345" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 424</text>
<text text-anchor="middle" x="7345" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7345" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_12&#45;&gt;expert_12_12_0 -->
<g id="edge1103" class="edge">
<title>route_12_12&#45;&gt;expert_12_12_0</title>
<path fill="none" stroke="black" d="M7345,-2434.31C7345,-2426.03 7345,-2417.05 7345,-2408.74"/>
<polygon fill="black" stroke="black" points="7348.5,-2408.67 7345,-2398.67 7341.5,-2408.67 7348.5,-2408.67"/>
</g>
<!-- expert_12_12_1 -->
<g id="node911" class="node">
<title>expert_12_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7778.5,-2398.66 7501.5,-2398.66 7501.5,-2354.66 7778.5,-2354.66 7778.5,-2398.66"/>
<text text-anchor="middle" x="7640" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L12</text>
<text text-anchor="middle" x="7640" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 425</text>
<text text-anchor="middle" x="7640" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7640" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_12&#45;&gt;expert_12_12_1 -->
<g id="edge1104" class="edge">
<title>route_12_12&#45;&gt;expert_12_12_1</title>
<path fill="none" stroke="black" d="M7435.92,-2437.93C7475.08,-2426.36 7520.51,-2412.94 7558.56,-2401.71"/>
<polygon fill="black" stroke="black" points="7559.97,-2404.94 7568.57,-2398.75 7557.99,-2398.23 7559.97,-2404.94"/>
</g>
<!-- tp_12_12 -->
<g id="node912" class="node">
<title>tp_12_12</title>
<ellipse fill="lightblue" stroke="black" cx="5962" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5962" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L12</text>
<text text-anchor="middle" x="5962" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 424↔425</text>
<text text-anchor="middle" x="5962" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5962" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_12_0&#45;&gt;tp_12_12 -->
<g id="edge1105" class="edge">
<title>expert_12_12_0&#45;&gt;tp_12_12</title>
<path fill="none" stroke="black" d="M7206.16,-2355.41C7203.42,-2355.15 7200.7,-2354.9 7198,-2354.66 6705.84,-2311.66 6576.58,-2384.86 6087,-2318.66 6075.42,-2317.1 6063.35,-2314.91 6051.48,-2312.43"/>
<polygon fill="black" stroke="black" points="6052.08,-2308.98 6041.56,-2310.28 6050.59,-2315.82 6052.08,-2308.98"/>
</g>
<!-- expert_12_12_1&#45;&gt;tp_12_12 -->
<g id="edge1106" class="edge">
<title>expert_12_12_1&#45;&gt;tp_12_12</title>
<path fill="none" stroke="black" d="M7501.16,-2355.39C7498.42,-2355.13 7495.7,-2354.89 7493,-2354.66 6870.1,-2302.37 6706.74,-2400.31 6087,-2318.66 6075.33,-2317.12 6063.16,-2314.94 6051.2,-2312.45"/>
<polygon fill="black" stroke="black" points="6051.73,-2308.98 6041.21,-2310.28 6050.25,-2315.82 6051.73,-2308.98"/>
</g>
<!-- tp_12_12&#45;&gt;q_proj_13 -->
<g id="edge1992" class="edge">
<title>tp_12_12&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M5882.09,-2264.87C5867.2,-2261.52 5851.7,-2258.5 5837,-2256.44 5468.9,-2204.74 5369.31,-2252.47 4995.31,-2220.5"/>
<polygon fill="black" stroke="black" points="4995.56,-2217.01 4985.29,-2219.63 4994.95,-2223.99 4995.56,-2217.01"/>
</g>
<!-- tp_12_12&#45;&gt;k_proj_13 -->
<g id="edge1993" class="edge">
<title>tp_12_12&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M5881.01,-2265.13C5866.43,-2261.82 5851.32,-2258.74 5837,-2256.44 5657.58,-2227.55 5449.25,-2212.86 5309.68,-2205.71"/>
<polygon fill="black" stroke="black" points="5309.49,-2202.19 5299.33,-2205.18 5309.14,-2209.18 5309.49,-2202.19"/>
</g>
<!-- tp_12_12&#45;&gt;v_proj_13 -->
<g id="edge1994" class="edge">
<title>tp_12_12&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M5882.44,-2264.81C5867.45,-2261.44 5851.82,-2258.43 5837,-2256.44 5330.48,-2188.28 5194.53,-2261.61 4681.55,-2220.51"/>
<polygon fill="black" stroke="black" points="4681.54,-2217 4671.29,-2219.68 4680.97,-2223.98 4681.54,-2217"/>
</g>
<!-- expert_12_13_0 -->
<g id="node914" class="node">
<title>expert_12_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8073.5,-2398.66 7796.5,-2398.66 7796.5,-2354.66 8073.5,-2354.66 8073.5,-2398.66"/>
<text text-anchor="middle" x="7935" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L12</text>
<text text-anchor="middle" x="7935" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 426</text>
<text text-anchor="middle" x="7935" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7935" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_13&#45;&gt;expert_12_13_0 -->
<g id="edge1108" class="edge">
<title>route_12_13&#45;&gt;expert_12_13_0</title>
<path fill="none" stroke="black" d="M7935,-2434.31C7935,-2426.03 7935,-2417.05 7935,-2408.74"/>
<polygon fill="black" stroke="black" points="7938.5,-2408.67 7935,-2398.67 7931.5,-2408.67 7938.5,-2408.67"/>
</g>
<!-- expert_12_13_1 -->
<g id="node915" class="node">
<title>expert_12_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8368.5,-2398.66 8091.5,-2398.66 8091.5,-2354.66 8368.5,-2354.66 8368.5,-2398.66"/>
<text text-anchor="middle" x="8230" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L12</text>
<text text-anchor="middle" x="8230" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 427</text>
<text text-anchor="middle" x="8230" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8230" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_13&#45;&gt;expert_12_13_1 -->
<g id="edge1109" class="edge">
<title>route_12_13&#45;&gt;expert_12_13_1</title>
<path fill="none" stroke="black" d="M8025.92,-2437.93C8065.08,-2426.36 8110.51,-2412.94 8148.56,-2401.71"/>
<polygon fill="black" stroke="black" points="8149.97,-2404.94 8158.57,-2398.75 8147.99,-2398.23 8149.97,-2404.94"/>
</g>
<!-- tp_12_13 -->
<g id="node916" class="node">
<title>tp_12_13</title>
<ellipse fill="lightblue" stroke="black" cx="6212" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6212" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L12</text>
<text text-anchor="middle" x="6212" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 426↔427</text>
<text text-anchor="middle" x="6212" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6212" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_13_0&#45;&gt;tp_12_13 -->
<g id="edge1110" class="edge">
<title>expert_12_13_0&#45;&gt;tp_12_13</title>
<path fill="none" stroke="black" d="M7796.16,-2355.39C7793.42,-2355.13 7790.7,-2354.89 7788,-2354.66 7145.15,-2300.95 6976.59,-2402.67 6337,-2318.66 6325.33,-2317.13 6313.16,-2314.95 6301.2,-2312.45"/>
<polygon fill="black" stroke="black" points="6301.73,-2308.99 6291.21,-2310.29 6300.25,-2315.83 6301.73,-2308.99"/>
</g>
<!-- expert_12_13_1&#45;&gt;tp_12_13 -->
<g id="edge1111" class="edge">
<title>expert_12_13_1&#45;&gt;tp_12_13</title>
<path fill="none" stroke="black" d="M8091.17,-2355.37C8088.42,-2355.12 8085.7,-2354.88 8083,-2354.66 7696.2,-2323.16 6721.88,-2368.39 6337,-2318.66 6325.33,-2317.15 6313.16,-2314.99 6301.19,-2312.5"/>
<polygon fill="black" stroke="black" points="6301.72,-2309.03 6291.21,-2310.34 6300.24,-2315.88 6301.72,-2309.03"/>
</g>
<!-- tp_12_13&#45;&gt;q_proj_13 -->
<g id="edge1995" class="edge">
<title>tp_12_13&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M6132.44,-2264.83C6117.45,-2261.46 6101.82,-2258.44 6087,-2256.44 5608.65,-2191.63 5480.12,-2259.76 4995.35,-2220.5"/>
<polygon fill="black" stroke="black" points="4995.54,-2217 4985.29,-2219.67 4994.97,-2223.98 4995.54,-2217"/>
</g>
<!-- tp_12_13&#45;&gt;k_proj_13 -->
<g id="edge1996" class="edge">
<title>tp_12_13&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M6131.72,-2265.01C6116.94,-2261.68 6101.57,-2258.62 6087,-2256.44 5815.86,-2215.84 5496.41,-2203.99 5309.54,-2200.63"/>
<polygon fill="black" stroke="black" points="5309.42,-2197.13 5299.36,-2200.45 5309.3,-2204.13 5309.42,-2197.13"/>
</g>
<!-- tp_12_13&#45;&gt;v_proj_13 -->
<g id="edge1997" class="edge">
<title>tp_12_13&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M6132.79,-2264.81C6117.69,-2261.43 6101.94,-2258.4 6087,-2256.44 5470.15,-2175.17 5305.34,-2268.96 4681.44,-2220.5"/>
<polygon fill="black" stroke="black" points="4681.53,-2217 4671.29,-2219.7 4680.98,-2223.97 4681.53,-2217"/>
</g>
<!-- expert_12_14_0 -->
<g id="node918" class="node">
<title>expert_12_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8663.5,-2398.66 8386.5,-2398.66 8386.5,-2354.66 8663.5,-2354.66 8663.5,-2398.66"/>
<text text-anchor="middle" x="8525" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L12</text>
<text text-anchor="middle" x="8525" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 428</text>
<text text-anchor="middle" x="8525" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8525" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_14&#45;&gt;expert_12_14_0 -->
<g id="edge1113" class="edge">
<title>route_12_14&#45;&gt;expert_12_14_0</title>
<path fill="none" stroke="black" d="M8525,-2434.31C8525,-2426.03 8525,-2417.05 8525,-2408.74"/>
<polygon fill="black" stroke="black" points="8528.5,-2408.67 8525,-2398.67 8521.5,-2408.67 8528.5,-2408.67"/>
</g>
<!-- expert_12_14_1 -->
<g id="node919" class="node">
<title>expert_12_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8958.5,-2398.66 8681.5,-2398.66 8681.5,-2354.66 8958.5,-2354.66 8958.5,-2398.66"/>
<text text-anchor="middle" x="8820" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L12</text>
<text text-anchor="middle" x="8820" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 429</text>
<text text-anchor="middle" x="8820" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8820" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_14&#45;&gt;expert_12_14_1 -->
<g id="edge1114" class="edge">
<title>route_12_14&#45;&gt;expert_12_14_1</title>
<path fill="none" stroke="black" d="M8615.92,-2437.93C8655.08,-2426.36 8700.51,-2412.94 8738.56,-2401.71"/>
<polygon fill="black" stroke="black" points="8739.97,-2404.94 8748.57,-2398.75 8737.99,-2398.23 8739.97,-2404.94"/>
</g>
<!-- tp_12_14 -->
<g id="node920" class="node">
<title>tp_12_14</title>
<ellipse fill="lightblue" stroke="black" cx="6462" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6462" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L12</text>
<text text-anchor="middle" x="6462" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 428↔429</text>
<text text-anchor="middle" x="6462" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6462" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_14_0&#45;&gt;tp_12_14 -->
<g id="edge1115" class="edge">
<title>expert_12_14_0&#45;&gt;tp_12_14</title>
<path fill="none" stroke="black" d="M8386.17,-2355.37C8383.42,-2355.12 8380.7,-2354.88 8378,-2354.66 7981.22,-2322.45 6981.81,-2369.57 6587,-2318.66 6575.33,-2317.16 6563.16,-2314.99 6551.19,-2312.51"/>
<polygon fill="black" stroke="black" points="6551.72,-2309.04 6541.21,-2310.35 6550.24,-2315.88 6551.72,-2309.04"/>
</g>
<!-- expert_12_14_1&#45;&gt;tp_12_14 -->
<g id="edge1116" class="edge">
<title>expert_12_14_1&#45;&gt;tp_12_14</title>
<path fill="none" stroke="black" d="M8681.17,-2355.36C8678.42,-2355.11 8675.7,-2354.88 8673,-2354.66 8210.84,-2317.81 7046.9,-2377.3 6587,-2318.66 6575.32,-2317.17 6563.15,-2315.02 6551.19,-2312.54"/>
<polygon fill="black" stroke="black" points="6551.71,-2309.07 6541.2,-2310.38 6550.24,-2315.91 6551.71,-2309.07"/>
</g>
<!-- tp_12_14&#45;&gt;q_proj_13 -->
<g id="edge1998" class="edge">
<title>tp_12_14&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M6382.45,-2264.75C6367.45,-2261.4 6351.83,-2258.4 6337,-2256.44 5748.38,-2178.52 5590.96,-2267.08 4995.42,-2220.5"/>
<polygon fill="black" stroke="black" points="4995.53,-2217 4985.29,-2219.7 4994.98,-2223.98 4995.53,-2217"/>
</g>
<!-- tp_12_14&#45;&gt;k_proj_13 -->
<g id="edge1999" class="edge">
<title>tp_12_14&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M6382.08,-2264.93C6367.19,-2261.58 6351.69,-2258.54 6337,-2256.44 6143.37,-2228.71 5585.04,-2210.77 5309.15,-2203.34"/>
<polygon fill="black" stroke="black" points="5309.14,-2199.84 5299.05,-2203.07 5308.95,-2206.84 5309.14,-2199.84"/>
</g>
<!-- tp_12_14&#45;&gt;v_proj_13 -->
<g id="edge2000" class="edge">
<title>tp_12_14&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M6382.79,-2264.77C6367.7,-2261.38 6351.94,-2258.37 6337,-2256.44 5974.96,-2209.45 5063.42,-2248.2 4681.33,-2220.47"/>
<polygon fill="black" stroke="black" points="4681.52,-2216.98 4671.29,-2219.72 4681,-2223.96 4681.52,-2216.98"/>
</g>
<!-- expert_12_15_0 -->
<g id="node922" class="node">
<title>expert_12_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9253.5,-2398.66 8976.5,-2398.66 8976.5,-2354.66 9253.5,-2354.66 9253.5,-2398.66"/>
<text text-anchor="middle" x="9115" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L12</text>
<text text-anchor="middle" x="9115" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 430</text>
<text text-anchor="middle" x="9115" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9115" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_15&#45;&gt;expert_12_15_0 -->
<g id="edge1118" class="edge">
<title>route_12_15&#45;&gt;expert_12_15_0</title>
<path fill="none" stroke="black" d="M9115,-2434.31C9115,-2426.03 9115,-2417.05 9115,-2408.74"/>
<polygon fill="black" stroke="black" points="9118.5,-2408.67 9115,-2398.67 9111.5,-2408.67 9118.5,-2408.67"/>
</g>
<!-- expert_12_15_1 -->
<g id="node923" class="node">
<title>expert_12_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9548.5,-2398.66 9271.5,-2398.66 9271.5,-2354.66 9548.5,-2354.66 9548.5,-2398.66"/>
<text text-anchor="middle" x="9410" y="-2389.46" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L12</text>
<text text-anchor="middle" x="9410" y="-2379.46" font-family="Times,serif" font-size="9.00">GPU: 431</text>
<text text-anchor="middle" x="9410" y="-2369.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9410" y="-2359.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_15&#45;&gt;expert_12_15_1 -->
<g id="edge1119" class="edge">
<title>route_12_15&#45;&gt;expert_12_15_1</title>
<path fill="none" stroke="black" d="M9205.92,-2437.93C9245.08,-2426.36 9290.51,-2412.94 9328.56,-2401.71"/>
<polygon fill="black" stroke="black" points="9329.97,-2404.94 9338.57,-2398.75 9327.99,-2398.23 9329.97,-2404.94"/>
</g>
<!-- tp_12_15 -->
<g id="node924" class="node">
<title>tp_12_15</title>
<ellipse fill="lightblue" stroke="black" cx="6712" cy="-2287.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6712" y="-2300.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L12</text>
<text text-anchor="middle" x="6712" y="-2290.35" font-family="Times,serif" font-size="9.00">GPU: 430↔431</text>
<text text-anchor="middle" x="6712" y="-2280.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6712" y="-2270.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_15_0&#45;&gt;tp_12_15 -->
<g id="edge1120" class="edge">
<title>expert_12_15_0&#45;&gt;tp_12_15</title>
<path fill="none" stroke="black" d="M8976.16,-2355.4C8973.42,-2355.14 8970.7,-2354.89 8968,-2354.66 8549.38,-2318.74 7248.95,-2296.61 6837.89,-2290.37"/>
<polygon fill="black" stroke="black" points="6837.8,-2286.87 6827.75,-2290.22 6837.7,-2293.87 6837.8,-2286.87"/>
</g>
<!-- expert_12_15_1&#45;&gt;tp_12_15 -->
<g id="edge1121" class="edge">
<title>expert_12_15_1&#45;&gt;tp_12_15</title>
<path fill="none" stroke="black" d="M9271.16,-2355.39C9268.42,-2355.13 9265.7,-2354.89 9263,-2354.66 8783.93,-2314.37 7283.66,-2294.88 6838.03,-2289.88"/>
<polygon fill="black" stroke="black" points="6838.05,-2286.38 6828.02,-2289.77 6837.98,-2293.38 6838.05,-2286.38"/>
</g>
<!-- tp_12_15&#45;&gt;q_proj_13 -->
<g id="edge2001" class="edge">
<title>tp_12_15&#45;&gt;q_proj_13</title>
<path fill="none" stroke="black" d="M6632.79,-2264.78C6617.69,-2261.39 6601.94,-2258.38 6587,-2256.44 6239.13,-2211.13 5363.47,-2247.27 4995.49,-2220.48"/>
<polygon fill="black" stroke="black" points="4995.52,-2216.98 4985.29,-2219.71 4995,-2223.96 4995.52,-2216.98"/>
</g>
<!-- tp_12_15&#45;&gt;k_proj_13 -->
<g id="edge2002" class="edge">
<title>tp_12_15&#45;&gt;k_proj_13</title>
<path fill="none" stroke="black" d="M6632.43,-2264.91C6617.44,-2261.54 6601.81,-2258.49 6587,-2256.44 6344.51,-2222.75 5629.94,-2207.21 5309.56,-2201.8"/>
<polygon fill="black" stroke="black" points="5309.32,-2198.29 5299.27,-2201.62 5309.21,-2205.29 5309.32,-2198.29"/>
</g>
<!-- tp_12_15&#45;&gt;v_proj_13 -->
<g id="edge2003" class="edge">
<title>tp_12_15&#45;&gt;v_proj_13</title>
<path fill="none" stroke="black" d="M6632.8,-2264.73C6617.7,-2261.35 6601.94,-2258.35 6587,-2256.44 6169.88,-2202.9 5119.22,-2251.81 4681.51,-2220.48"/>
<polygon fill="black" stroke="black" points="4681.52,-2216.97 4671.29,-2219.73 4681,-2223.96 4681.52,-2216.97"/>
</g>
<!-- attn_scores_13 -->
<g id="node928" class="node">
<title>attn_scores_13</title>
<polygon fill="lightgreen" stroke="black" points="5003.5,-2140.44 4670.5,-2140.44 4670.5,-2096.44 5003.5,-2096.44 5003.5,-2140.44"/>
<text text-anchor="middle" x="4837" y="-2131.24" font-family="Times,serif" font-size="9.00">Attention Scores L13</text>
<text text-anchor="middle" x="4837" y="-2121.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4837" y="-2111.24" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-2101.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_13&#45;&gt;attn_scores_13 -->
<g id="edge1122" class="edge">
<title>q_proj_13&#45;&gt;attn_scores_13</title>
<path fill="none" stroke="black" d="M4837,-2176.12C4837,-2168.23 4837,-2159.12 4837,-2150.54"/>
<polygon fill="black" stroke="black" points="4840.5,-2150.45 4837,-2140.45 4833.5,-2150.45 4840.5,-2150.45"/>
</g>
<!-- k_proj_13&#45;&gt;attn_scores_13 -->
<g id="edge1123" class="edge">
<title>k_proj_13&#45;&gt;attn_scores_13</title>
<path fill="none" stroke="black" d="M5066.44,-2176.43C5024.82,-2166.09 4974.49,-2153.59 4931.59,-2142.93"/>
<polygon fill="black" stroke="black" points="4932.26,-2139.49 4921.71,-2140.48 4930.57,-2146.29 4932.26,-2139.49"/>
</g>
<!-- v_proj_13&#45;&gt;attn_scores_13 -->
<g id="edge1124" class="edge">
<title>v_proj_13&#45;&gt;attn_scores_13</title>
<path fill="none" stroke="black" d="M4607.56,-2176.43C4649.18,-2166.09 4699.51,-2153.59 4742.41,-2142.93"/>
<polygon fill="black" stroke="black" points="4743.43,-2146.29 4752.29,-2140.48 4741.74,-2139.49 4743.43,-2146.29"/>
</g>
<!-- softmax_13 -->
<g id="node929" class="node">
<title>softmax_13</title>
<polygon fill="lightgreen" stroke="black" points="5003.5,-2060.44 4670.5,-2060.44 4670.5,-2016.44 5003.5,-2016.44 5003.5,-2060.44"/>
<text text-anchor="middle" x="4837" y="-2051.24" font-family="Times,serif" font-size="9.00">Softmax L13</text>
<text text-anchor="middle" x="4837" y="-2041.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4837" y="-2031.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4837" y="-2021.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_13&#45;&gt;softmax_13 -->
<g id="edge1125" class="edge">
<title>attn_scores_13&#45;&gt;softmax_13</title>
<path fill="none" stroke="black" d="M4837,-2096.12C4837,-2088.23 4837,-2079.12 4837,-2070.54"/>
<polygon fill="black" stroke="black" points="4840.5,-2070.45 4837,-2060.45 4833.5,-2070.45 4840.5,-2070.45"/>
</g>
<!-- attn_out_13 -->
<g id="node930" class="node">
<title>attn_out_13</title>
<polygon fill="lightgreen" stroke="black" points="4985,-1980.44 4689,-1980.44 4689,-1936.44 4985,-1936.44 4985,-1980.44"/>
<text text-anchor="middle" x="4837" y="-1971.24" font-family="Times,serif" font-size="9.00">Attention Output L13</text>
<text text-anchor="middle" x="4837" y="-1961.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="4837" y="-1951.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-1941.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_13&#45;&gt;attn_out_13 -->
<g id="edge1126" class="edge">
<title>softmax_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M4837,-2016.12C4837,-2008.23 4837,-1999.12 4837,-1990.54"/>
<polygon fill="black" stroke="black" points="4840.5,-1990.45 4837,-1980.45 4833.5,-1990.45 4840.5,-1990.45"/>
</g>
<!-- gate_13 -->
<g id="node931" class="node">
<title>gate_13</title>
<polygon fill="lightyellow" stroke="black" points="5136.74,-1900.44 4659.92,-1900.44 4537.26,-1812.44 5014.08,-1812.44 5136.74,-1900.44"/>
<text text-anchor="middle" x="4837" y="-1869.24" font-family="Times,serif" font-size="9.00">Gate L13</text>
<text text-anchor="middle" x="4837" y="-1859.24" font-family="Times,serif" font-size="9.00">GPU: 384&#45;447</text>
<text text-anchor="middle" x="4837" y="-1849.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-1839.24" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_13&#45;&gt;gate_13 -->
<g id="edge1127" class="edge">
<title>attn_out_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M4837,-1936.23C4837,-1928.73 4837,-1919.92 4837,-1910.96"/>
<polygon fill="black" stroke="black" points="4840.5,-1910.84 4837,-1900.84 4833.5,-1910.84 4840.5,-1910.84"/>
</g>
<!-- route_13_0 -->
<g id="node932" class="node">
<title>route_13_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="560" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="560" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="560" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="560" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="560" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_0 -->
<g id="edge1128" class="edge">
<title>gate_13&#45;&gt;route_13_0</title>
<path fill="none" stroke="black" d="M4597.09,-1855.48C3986.43,-1854.51 2323.63,-1845.22 940,-1776.44 874.75,-1773.19 803.32,-1767.97 740.17,-1762.78"/>
<polygon fill="black" stroke="black" points="740.36,-1759.29 730.11,-1761.95 739.79,-1766.26 740.36,-1759.29"/>
</g>
<!-- route_13_1 -->
<g id="node936" class="node">
<title>route_13_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1150" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1150" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1150" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 386,387</text>
<text text-anchor="middle" x="1150" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1150" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_1 -->
<g id="edge1133" class="edge">
<title>gate_13&#45;&gt;route_13_1</title>
<path fill="none" stroke="black" d="M4595.4,-1854.23C4048.99,-1850.5 2676.53,-1835.51 1530,-1776.44 1464.91,-1773.08 1393.67,-1767.85 1330.63,-1762.69"/>
<polygon fill="black" stroke="black" points="1330.84,-1759.19 1320.59,-1761.86 1330.27,-1766.17 1330.84,-1759.19"/>
</g>
<!-- route_13_2 -->
<g id="node940" class="node">
<title>route_13_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1740" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1740" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1740" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 388,389</text>
<text text-anchor="middle" x="1740" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1740" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_2 -->
<g id="edge1138" class="edge">
<title>gate_13&#45;&gt;route_13_2</title>
<path fill="none" stroke="black" d="M4592.82,-1852.43C4116.8,-1845.65 3031.5,-1825.77 2120,-1776.44 2055.08,-1772.92 1984.02,-1767.67 1921.1,-1762.53"/>
<polygon fill="black" stroke="black" points="1921.32,-1759.04 1911.07,-1761.71 1920.75,-1766.02 1921.32,-1759.04"/>
</g>
<!-- route_13_3 -->
<g id="node944" class="node">
<title>route_13_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2330" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2330" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2330" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 390,391</text>
<text text-anchor="middle" x="2330" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2330" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_3 -->
<g id="edge1143" class="edge">
<title>gate_13&#45;&gt;route_13_3</title>
<path fill="none" stroke="black" d="M4588.78,-1849.59C4191.71,-1839.49 3389.24,-1815.95 2710,-1776.44 2645.41,-1772.68 2574.73,-1767.4 2512.03,-1762.31"/>
<polygon fill="black" stroke="black" points="2512.29,-1758.82 2502.04,-1761.49 2511.72,-1765.79 2512.29,-1758.82"/>
</g>
<!-- route_13_4 -->
<g id="node948" class="node">
<title>route_13_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2920" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2920" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2920" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 392,393</text>
<text text-anchor="middle" x="2920" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2920" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_4 -->
<g id="edge1148" class="edge">
<title>gate_13&#45;&gt;route_13_4</title>
<path fill="none" stroke="black" d="M4581.91,-1844.49C4276.88,-1830.9 3750.93,-1805.89 3300,-1776.44 3236.04,-1772.26 3166.08,-1766.93 3103.82,-1761.92"/>
<polygon fill="black" stroke="black" points="3103.74,-1758.41 3093.49,-1761.09 3103.18,-1765.38 3103.74,-1758.41"/>
</g>
<!-- route_13_5 -->
<g id="node952" class="node">
<title>route_13_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3510" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3510" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3510" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 394,395</text>
<text text-anchor="middle" x="3510" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3510" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_5 -->
<g id="edge1153" class="edge">
<title>gate_13&#45;&gt;route_13_5</title>
<path fill="none" stroke="black" d="M4566.06,-1833.16C4306.32,-1811.8 3921.23,-1780.14 3694.92,-1761.53"/>
<polygon fill="black" stroke="black" points="3695.18,-1758.04 3684.93,-1760.71 3694.61,-1765.01 3695.18,-1758.04"/>
</g>
<!-- route_13_6 -->
<g id="node956" class="node">
<title>route_13_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4100" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4100" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4100" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 396,397</text>
<text text-anchor="middle" x="4100" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4100" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_6 -->
<g id="edge1158" class="edge">
<title>gate_13&#45;&gt;route_13_6</title>
<path fill="none" stroke="black" d="M4546.51,-1812.43C4445.8,-1797.52 4336.94,-1781.4 4251.92,-1768.81"/>
<polygon fill="black" stroke="black" points="4252.34,-1765.34 4241.93,-1767.34 4251.31,-1772.26 4252.34,-1765.34"/>
</g>
<!-- route_13_7 -->
<g id="node960" class="node">
<title>route_13_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4628" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4628" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4628" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 398,399</text>
<text text-anchor="middle" x="4628" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4628" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_7 -->
<g id="edge1163" class="edge">
<title>gate_13&#45;&gt;route_13_7</title>
<path fill="none" stroke="black" d="M4754.4,-1812.31C4733.91,-1801.62 4712.25,-1790.31 4692.75,-1780.13"/>
<polygon fill="black" stroke="black" points="4694.15,-1776.91 4683.67,-1775.38 4690.91,-1783.11 4694.15,-1776.91"/>
</g>
<!-- route_13_8 -->
<g id="node964" class="node">
<title>route_13_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5048" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5048" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5048" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="5048" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5048" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_8 -->
<g id="edge1168" class="edge">
<title>gate_13&#45;&gt;route_13_8</title>
<path fill="none" stroke="black" d="M4920.39,-1812.31C4941.27,-1801.52 4963.36,-1790.09 4983.18,-1779.84"/>
<polygon fill="black" stroke="black" points="4984.84,-1782.92 4992.12,-1775.22 4981.63,-1776.71 4984.84,-1782.92"/>
</g>
<!-- route_13_9 -->
<g id="node968" class="node">
<title>route_13_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5575" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5575" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5575" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 418,419</text>
<text text-anchor="middle" x="5575" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5575" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_9 -->
<g id="edge1173" class="edge">
<title>gate_13&#45;&gt;route_13_9</title>
<path fill="none" stroke="black" d="M5033.8,-1826.34C5155.76,-1808.31 5310.08,-1785.49 5422.69,-1768.84"/>
<polygon fill="black" stroke="black" points="5423.39,-1772.28 5432.77,-1767.35 5422.37,-1765.35 5423.39,-1772.28"/>
</g>
<!-- route_13_10 -->
<g id="node972" class="node">
<title>route_13_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6165" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6165" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6165" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 420,421</text>
<text text-anchor="middle" x="6165" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6165" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_10 -->
<g id="edge1178" class="edge">
<title>gate_13&#45;&gt;route_13_10</title>
<path fill="none" stroke="black" d="M5050,-1837.94C5307.37,-1816.79 5736.14,-1781.56 5980.18,-1761.51"/>
<polygon fill="black" stroke="black" points="5980.54,-1764.99 5990.22,-1760.68 5979.96,-1758.01 5980.54,-1764.99"/>
</g>
<!-- route_13_11 -->
<g id="node976" class="node">
<title>route_13_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6755" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6755" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6755" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 422,423</text>
<text text-anchor="middle" x="6755" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6755" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_11 -->
<g id="edge1183" class="edge">
<title>gate_13&#45;&gt;route_13_11</title>
<path fill="none" stroke="black" d="M5060.94,-1845.88C5360.44,-1832.66 5907.94,-1806.93 6375,-1776.44 6438.96,-1772.26 6508.92,-1766.93 6571.18,-1761.92"/>
<polygon fill="black" stroke="black" points="6571.82,-1765.38 6581.51,-1761.09 6571.26,-1758.41 6571.82,-1765.38"/>
</g>
<!-- route_13_12 -->
<g id="node980" class="node">
<title>route_13_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7345" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7345" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7345" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 424,425</text>
<text text-anchor="middle" x="7345" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7345" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_12 -->
<g id="edge1188" class="edge">
<title>gate_13&#45;&gt;route_13_12</title>
<path fill="none" stroke="black" d="M5066.64,-1850.07C5456.94,-1840.24 6274.6,-1816.59 6965,-1776.44 7029.59,-1772.68 7100.27,-1767.4 7162.97,-1762.31"/>
<polygon fill="black" stroke="black" points="7163.28,-1765.79 7172.96,-1761.49 7162.71,-1758.82 7163.28,-1765.79"/>
</g>
<!-- route_13_13 -->
<g id="node984" class="node">
<title>route_13_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7935" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7935" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7935" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 426,427</text>
<text text-anchor="middle" x="7935" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7935" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_13 -->
<g id="edge1193" class="edge">
<title>gate_13&#45;&gt;route_13_13</title>
<path fill="none" stroke="black" d="M5070.3,-1852.58C5540.62,-1845.97 6636.09,-1826.17 7555,-1776.44 7619.92,-1772.92 7690.98,-1767.67 7753.9,-1762.53"/>
<polygon fill="black" stroke="black" points="7754.25,-1766.02 7763.93,-1761.71 7753.68,-1759.04 7754.25,-1766.02"/>
</g>
<!-- route_13_14 -->
<g id="node988" class="node">
<title>route_13_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8525" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8525" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8525" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 428,429</text>
<text text-anchor="middle" x="8525" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8525" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_14 -->
<g id="edge1198" class="edge">
<title>gate_13&#45;&gt;route_13_14</title>
<path fill="none" stroke="black" d="M5072.56,-1854.27C5614.95,-1850.62 6993.82,-1835.75 8145,-1776.44 8210.09,-1773.08 8281.33,-1767.85 8344.37,-1762.69"/>
<polygon fill="black" stroke="black" points="8344.73,-1766.17 8354.41,-1761.86 8344.16,-1759.19 8344.73,-1766.17"/>
</g>
<!-- route_13_15 -->
<g id="node992" class="node">
<title>route_13_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9115" cy="-1745.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9115" y="-1758.12" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9115" y="-1748.12" font-family="Times,serif" font-size="9.00">GPU: 430,431</text>
<text text-anchor="middle" x="9115" y="-1738.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9115" y="-1728.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_15 -->
<g id="edge1203" class="edge">
<title>gate_13&#45;&gt;route_13_15</title>
<path fill="none" stroke="black" d="M5074.19,-1855.48C5682.71,-1854.55 7348.91,-1845.34 8735,-1776.44 8800.25,-1773.19 8871.68,-1767.97 8934.83,-1762.78"/>
<polygon fill="black" stroke="black" points="8935.21,-1766.26 8944.89,-1761.95 8934.64,-1759.29 8935.21,-1766.26"/>
</g>
<!-- expert_13_0_0 -->
<g id="node933" class="node">
<title>expert_13_0_0</title>
<polygon fill="lightgreen" stroke="black" points="403.5,-1678.21 126.5,-1678.21 126.5,-1634.21 403.5,-1634.21 403.5,-1678.21"/>
<text text-anchor="middle" x="265" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L13</text>
<text text-anchor="middle" x="265" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="265" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="265" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_0&#45;&gt;expert_13_0_0 -->
<g id="edge1129" class="edge">
<title>route_13_0&#45;&gt;expert_13_0_0</title>
<path fill="none" stroke="black" d="M469.08,-1717.48C429.92,-1705.91 384.49,-1692.49 346.44,-1681.26"/>
<polygon fill="black" stroke="black" points="347.01,-1677.78 336.43,-1678.3 345.03,-1684.49 347.01,-1677.78"/>
</g>
<!-- expert_13_0_1 -->
<g id="node934" class="node">
<title>expert_13_0_1</title>
<polygon fill="lightgreen" stroke="black" points="698.5,-1678.21 421.5,-1678.21 421.5,-1634.21 698.5,-1634.21 698.5,-1678.21"/>
<text text-anchor="middle" x="560" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L13</text>
<text text-anchor="middle" x="560" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="560" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="560" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_0&#45;&gt;expert_13_0_1 -->
<g id="edge1130" class="edge">
<title>route_13_0&#45;&gt;expert_13_0_1</title>
<path fill="none" stroke="black" d="M560,-1713.86C560,-1705.58 560,-1696.6 560,-1688.29"/>
<polygon fill="black" stroke="black" points="563.5,-1688.21 560,-1678.21 556.5,-1688.21 563.5,-1688.21"/>
</g>
<!-- tp_13_0 -->
<g id="node935" class="node">
<title>tp_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="2962" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2962" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L13</text>
<text text-anchor="middle" x="2962" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="2962" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2962" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_0_0&#45;&gt;tp_13_0 -->
<g id="edge1131" class="edge">
<title>expert_13_0_0&#45;&gt;tp_13_0</title>
<path fill="none" stroke="black" d="M403.84,-1634.94C406.58,-1634.68 409.3,-1634.44 412,-1634.21 890.88,-1593.93 2390.56,-1574.43 2836.02,-1569.43"/>
<polygon fill="black" stroke="black" points="2836.07,-1572.93 2846.03,-1569.32 2835.99,-1565.93 2836.07,-1572.93"/>
</g>
<!-- expert_13_0_1&#45;&gt;tp_13_0 -->
<g id="edge1132" class="edge">
<title>expert_13_0_1&#45;&gt;tp_13_0</title>
<path fill="none" stroke="black" d="M698.6,-1635.07C701.76,-1634.76 704.9,-1634.48 708,-1634.21 1126.26,-1598.51 2425.54,-1576.23 2836.23,-1569.94"/>
<polygon fill="black" stroke="black" points="2836.41,-1573.43 2846.35,-1569.78 2836.3,-1566.43 2836.41,-1573.43"/>
</g>
<!-- q_proj_14 -->
<g id="node996" class="node">
<title>q_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="4671,-1488.98 4375,-1488.98 4375,-1444.98 4671,-1444.98 4671,-1488.98"/>
<text text-anchor="middle" x="4523" y="-1479.78" font-family="Times,serif" font-size="9.00">Q Projection L14</text>
<text text-anchor="middle" x="4523" y="-1469.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4523" y="-1459.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4523" y="-1449.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_13_0&#45;&gt;q_proj_14 -->
<g id="edge2004" class="edge">
<title>tp_13_0&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M3030.34,-1541.84C3048.53,-1536.33 3068.33,-1531.17 3087,-1527.98 3328.43,-1486.83 4043.98,-1473.51 4364.56,-1469.54"/>
<polygon fill="black" stroke="black" points="4364.9,-1473.03 4374.86,-1469.41 4364.82,-1466.03 4364.9,-1473.03"/>
</g>
<!-- k_proj_14 -->
<g id="node997" class="node">
<title>k_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="5299,-1488.98 5003,-1488.98 5003,-1444.98 5299,-1444.98 5299,-1488.98"/>
<text text-anchor="middle" x="5151" y="-1479.78" font-family="Times,serif" font-size="9.00">K Projection L14</text>
<text text-anchor="middle" x="5151" y="-1469.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="5151" y="-1459.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5151" y="-1449.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_13_0&#45;&gt;k_proj_14 -->
<g id="edge2005" class="edge">
<title>tp_13_0&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M3029.29,-1541.66C3047.75,-1536.04 3067.93,-1530.87 3087,-1527.98 3191.75,-1512.15 4889.44,-1537.07 4994,-1519.98 5027.1,-1514.58 5062.67,-1503.28 5091.58,-1492.59"/>
<polygon fill="black" stroke="black" points="5092.99,-1495.8 5101.11,-1489 5090.52,-1489.25 5092.99,-1495.8"/>
</g>
<!-- v_proj_14 -->
<g id="node998" class="node">
<title>v_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="4985,-1488.98 4689,-1488.98 4689,-1444.98 4985,-1444.98 4985,-1488.98"/>
<text text-anchor="middle" x="4837" y="-1479.78" font-family="Times,serif" font-size="9.00">V Projection L14</text>
<text text-anchor="middle" x="4837" y="-1469.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4837" y="-1459.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-1449.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_13_0&#45;&gt;v_proj_14 -->
<g id="edge2006" class="edge">
<title>tp_13_0&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M3029.29,-1541.67C3047.75,-1536.05 3067.93,-1530.88 3087,-1527.98 3174.5,-1514.72 4592.66,-1534.3 4680,-1519.98 4713.09,-1514.56 4748.67,-1503.26 4777.58,-1492.58"/>
<polygon fill="black" stroke="black" points="4778.99,-1495.79 4787.11,-1488.99 4776.52,-1489.24 4778.99,-1495.79"/>
</g>
<!-- expert_13_1_0 -->
<g id="node937" class="node">
<title>expert_13_1_0</title>
<polygon fill="lightgreen" stroke="black" points="993.5,-1678.21 716.5,-1678.21 716.5,-1634.21 993.5,-1634.21 993.5,-1678.21"/>
<text text-anchor="middle" x="855" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L13</text>
<text text-anchor="middle" x="855" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 386</text>
<text text-anchor="middle" x="855" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="855" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_1&#45;&gt;expert_13_1_0 -->
<g id="edge1134" class="edge">
<title>route_13_1&#45;&gt;expert_13_1_0</title>
<path fill="none" stroke="black" d="M1059.08,-1717.48C1019.92,-1705.91 974.49,-1692.49 936.44,-1681.26"/>
<polygon fill="black" stroke="black" points="937.01,-1677.78 926.43,-1678.3 935.03,-1684.49 937.01,-1677.78"/>
</g>
<!-- expert_13_1_1 -->
<g id="node938" class="node">
<title>expert_13_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1288.5,-1678.21 1011.5,-1678.21 1011.5,-1634.21 1288.5,-1634.21 1288.5,-1678.21"/>
<text text-anchor="middle" x="1150" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L13</text>
<text text-anchor="middle" x="1150" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 387</text>
<text text-anchor="middle" x="1150" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1150" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_1&#45;&gt;expert_13_1_1 -->
<g id="edge1135" class="edge">
<title>route_13_1&#45;&gt;expert_13_1_1</title>
<path fill="none" stroke="black" d="M1150,-1713.86C1150,-1705.58 1150,-1696.6 1150,-1688.29"/>
<polygon fill="black" stroke="black" points="1153.5,-1688.21 1150,-1678.21 1146.5,-1688.21 1153.5,-1688.21"/>
</g>
<!-- tp_13_1 -->
<g id="node939" class="node">
<title>tp_13_1</title>
<ellipse fill="lightblue" stroke="black" cx="3212" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3212" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L13</text>
<text text-anchor="middle" x="3212" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 386↔387</text>
<text text-anchor="middle" x="3212" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3212" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_1_0&#45;&gt;tp_13_1 -->
<g id="edge1136" class="edge">
<title>expert_13_1_0&#45;&gt;tp_13_1</title>
<path fill="none" stroke="black" d="M993.59,-1635.02C996.76,-1634.73 999.9,-1634.46 1003,-1634.21 1464.73,-1597.61 2627.54,-1656.8 3087,-1598.21 3098.68,-1596.72 3110.85,-1594.57 3122.81,-1592.09"/>
<polygon fill="black" stroke="black" points="3123.76,-1595.46 3132.8,-1589.93 3122.29,-1588.62 3123.76,-1595.46"/>
</g>
<!-- expert_13_1_1&#45;&gt;tp_13_1 -->
<g id="edge1137" class="edge">
<title>expert_13_1_1&#45;&gt;tp_13_1</title>
<path fill="none" stroke="black" d="M1288.6,-1635.03C1291.76,-1634.73 1294.9,-1634.46 1298,-1634.21 1694.35,-1602.22 2692.63,-1649.07 3087,-1598.21 3098.67,-1596.7 3110.84,-1594.54 3122.81,-1592.06"/>
<polygon fill="black" stroke="black" points="3123.76,-1595.43 3132.79,-1589.9 3122.28,-1588.59 3123.76,-1595.43"/>
</g>
<!-- tp_13_1&#45;&gt;q_proj_14 -->
<g id="edge2007" class="edge">
<title>tp_13_1&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M3280.36,-1541.95C3298.55,-1536.44 3318.34,-1531.25 3337,-1527.98 3529.7,-1494.26 4088.48,-1477.56 4364.67,-1471.18"/>
<polygon fill="black" stroke="black" points="4364.86,-1474.68 4374.77,-1470.95 4364.7,-1467.68 4364.86,-1474.68"/>
</g>
<!-- tp_13_1&#45;&gt;k_proj_14 -->
<g id="edge2008" class="edge">
<title>tp_13_1&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M3279.29,-1541.67C3297.75,-1536.05 3317.93,-1530.87 3337,-1527.98 3428.02,-1514.19 4903.15,-1534.86 4994,-1519.98 5027.1,-1514.56 5062.67,-1503.27 5091.58,-1492.58"/>
<polygon fill="black" stroke="black" points="5092.99,-1495.79 5101.11,-1488.99 5090.52,-1489.24 5092.99,-1495.79"/>
</g>
<!-- tp_13_1&#45;&gt;v_proj_14 -->
<g id="edge2009" class="edge">
<title>tp_13_1&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M3279.29,-1541.68C3297.75,-1536.06 3317.93,-1530.88 3337,-1527.98 3410.76,-1516.76 4606.38,-1532.09 4680,-1519.98 4712.96,-1514.57 4748.39,-1503.33 4777.24,-1492.69"/>
<polygon fill="black" stroke="black" points="4778.63,-1495.91 4786.76,-1489.11 4776.16,-1489.35 4778.63,-1495.91"/>
</g>
<!-- expert_13_2_0 -->
<g id="node941" class="node">
<title>expert_13_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1583.5,-1678.21 1306.5,-1678.21 1306.5,-1634.21 1583.5,-1634.21 1583.5,-1678.21"/>
<text text-anchor="middle" x="1445" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L13</text>
<text text-anchor="middle" x="1445" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 388</text>
<text text-anchor="middle" x="1445" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1445" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_2&#45;&gt;expert_13_2_0 -->
<g id="edge1139" class="edge">
<title>route_13_2&#45;&gt;expert_13_2_0</title>
<path fill="none" stroke="black" d="M1649.08,-1717.48C1609.92,-1705.91 1564.49,-1692.49 1526.44,-1681.26"/>
<polygon fill="black" stroke="black" points="1527.01,-1677.78 1516.43,-1678.3 1525.03,-1684.49 1527.01,-1677.78"/>
</g>
<!-- expert_13_2_1 -->
<g id="node942" class="node">
<title>expert_13_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1878.5,-1678.21 1601.5,-1678.21 1601.5,-1634.21 1878.5,-1634.21 1878.5,-1678.21"/>
<text text-anchor="middle" x="1740" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L13</text>
<text text-anchor="middle" x="1740" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 389</text>
<text text-anchor="middle" x="1740" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1740" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_2&#45;&gt;expert_13_2_1 -->
<g id="edge1140" class="edge">
<title>route_13_2&#45;&gt;expert_13_2_1</title>
<path fill="none" stroke="black" d="M1740,-1713.86C1740,-1705.58 1740,-1696.6 1740,-1688.29"/>
<polygon fill="black" stroke="black" points="1743.5,-1688.21 1740,-1678.21 1736.5,-1688.21 1743.5,-1688.21"/>
</g>
<!-- tp_13_2 -->
<g id="node943" class="node">
<title>tp_13_2</title>
<ellipse fill="lightblue" stroke="black" cx="3462" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3462" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L13</text>
<text text-anchor="middle" x="3462" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 388↔389</text>
<text text-anchor="middle" x="3462" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3462" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_2_0&#45;&gt;tp_13_2 -->
<g id="edge1141" class="edge">
<title>expert_13_2_0&#45;&gt;tp_13_2</title>
<path fill="none" stroke="black" d="M1583.6,-1635.03C1586.76,-1634.74 1589.9,-1634.46 1593,-1634.21 1979.37,-1602.93 2952.56,-1647.89 3337,-1598.21 3348.67,-1596.7 3360.84,-1594.54 3372.81,-1592.05"/>
<polygon fill="black" stroke="black" points="3373.76,-1595.43 3382.79,-1589.89 3372.28,-1588.58 3373.76,-1595.43"/>
</g>
<!-- expert_13_2_1&#45;&gt;tp_13_2 -->
<g id="edge1142" class="edge">
<title>expert_13_2_1&#45;&gt;tp_13_2</title>
<path fill="none" stroke="black" d="M1878.6,-1635.05C1881.76,-1634.75 1884.9,-1634.47 1888,-1634.21 2529.99,-1580.87 2698.29,-1682.12 3337,-1598.21 3348.67,-1596.68 3360.84,-1594.5 3372.8,-1592"/>
<polygon fill="black" stroke="black" points="3373.75,-1595.38 3382.79,-1589.84 3372.27,-1588.54 3373.75,-1595.38"/>
</g>
<!-- tp_13_2&#45;&gt;q_proj_14 -->
<g id="edge2010" class="edge">
<title>tp_13_2&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M3530.72,-1542.02C3548.82,-1536.55 3568.47,-1531.36 3587,-1527.98 3731.64,-1501.67 4137.9,-1482.63 4364.76,-1473.69"/>
<polygon fill="black" stroke="black" points="4364.9,-1477.19 4374.76,-1473.3 4364.63,-1470.19 4364.9,-1477.19"/>
</g>
<!-- tp_13_2&#45;&gt;k_proj_14 -->
<g id="edge2011" class="edge">
<title>tp_13_2&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M3529.29,-1541.68C3547.75,-1536.06 3567.93,-1530.88 3587,-1527.98 3664.28,-1516.24 4916.87,-1532.65 4994,-1519.98 5026.97,-1514.57 5062.4,-1503.34 5091.24,-1492.69"/>
<polygon fill="black" stroke="black" points="5092.63,-1495.91 5100.76,-1489.11 5090.17,-1489.36 5092.63,-1495.91"/>
</g>
<!-- tp_13_2&#45;&gt;v_proj_14 -->
<g id="edge2012" class="edge">
<title>tp_13_2&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M3529.29,-1541.7C3547.75,-1536.08 3567.94,-1530.9 3587,-1527.98 3707.05,-1509.64 4560.17,-1539.76 4680,-1519.98 4712.96,-1514.54 4748.39,-1503.31 4777.24,-1492.67"/>
<polygon fill="black" stroke="black" points="4778.62,-1495.89 4786.75,-1489.09 4776.16,-1489.33 4778.62,-1495.89"/>
</g>
<!-- expert_13_3_0 -->
<g id="node945" class="node">
<title>expert_13_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2173.5,-1678.21 1896.5,-1678.21 1896.5,-1634.21 2173.5,-1634.21 2173.5,-1678.21"/>
<text text-anchor="middle" x="2035" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L13</text>
<text text-anchor="middle" x="2035" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 390</text>
<text text-anchor="middle" x="2035" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2035" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_3&#45;&gt;expert_13_3_0 -->
<g id="edge1144" class="edge">
<title>route_13_3&#45;&gt;expert_13_3_0</title>
<path fill="none" stroke="black" d="M2239.08,-1717.48C2199.92,-1705.91 2154.49,-1692.49 2116.44,-1681.26"/>
<polygon fill="black" stroke="black" points="2117.01,-1677.78 2106.43,-1678.3 2115.03,-1684.49 2117.01,-1677.78"/>
</g>
<!-- expert_13_3_1 -->
<g id="node946" class="node">
<title>expert_13_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2468.5,-1678.21 2191.5,-1678.21 2191.5,-1634.21 2468.5,-1634.21 2468.5,-1678.21"/>
<text text-anchor="middle" x="2330" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L13</text>
<text text-anchor="middle" x="2330" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 391</text>
<text text-anchor="middle" x="2330" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2330" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_3&#45;&gt;expert_13_3_1 -->
<g id="edge1145" class="edge">
<title>route_13_3&#45;&gt;expert_13_3_1</title>
<path fill="none" stroke="black" d="M2330,-1713.86C2330,-1705.58 2330,-1696.6 2330,-1688.29"/>
<polygon fill="black" stroke="black" points="2333.5,-1688.21 2330,-1678.21 2326.5,-1688.21 2333.5,-1688.21"/>
</g>
<!-- tp_13_3 -->
<g id="node947" class="node">
<title>tp_13_3</title>
<ellipse fill="lightblue" stroke="black" cx="3712" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3712" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L13</text>
<text text-anchor="middle" x="3712" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 390↔391</text>
<text text-anchor="middle" x="3712" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3712" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_3_0&#45;&gt;tp_13_3 -->
<g id="edge1146" class="edge">
<title>expert_13_3_0&#45;&gt;tp_13_3</title>
<path fill="none" stroke="black" d="M2173.6,-1635.05C2176.76,-1634.75 2179.9,-1634.47 2183,-1634.21 2805.04,-1582.28 2968.14,-1679.76 3587,-1598.21 3598.67,-1596.67 3610.84,-1594.49 3622.8,-1591.99"/>
<polygon fill="black" stroke="black" points="3623.75,-1595.37 3632.79,-1589.83 3622.27,-1588.53 3623.75,-1595.37"/>
</g>
<!-- expert_13_3_1&#45;&gt;tp_13_3 -->
<g id="edge1147" class="edge">
<title>expert_13_3_1&#45;&gt;tp_13_3</title>
<path fill="none" stroke="black" d="M2468.6,-1635.08C2471.76,-1634.77 2474.9,-1634.48 2478,-1634.21 2969.3,-1591.51 3098.3,-1664.3 3587,-1598.21 3598.58,-1596.64 3610.65,-1594.46 3622.52,-1591.98"/>
<polygon fill="black" stroke="black" points="3623.41,-1595.36 3632.44,-1589.82 3621.92,-1588.52 3623.41,-1595.36"/>
</g>
<!-- tp_13_3&#45;&gt;q_proj_14 -->
<g id="edge2013" class="edge">
<title>tp_13_3&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M3781.43,-1542.12C3799.35,-1536.71 3818.74,-1531.53 3837,-1527.98 4015.76,-1493.31 4224.65,-1478.66 4364.53,-1472.48"/>
<polygon fill="black" stroke="black" points="4365.06,-1475.96 4374.9,-1472.03 4364.76,-1468.96 4365.06,-1475.96"/>
</g>
<!-- tp_13_3&#45;&gt;k_proj_14 -->
<g id="edge2014" class="edge">
<title>tp_13_3&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M3779.29,-1541.69C3797.75,-1536.07 3817.94,-1530.89 3837,-1527.98 3964.09,-1508.59 4867.15,-1540.89 4994,-1519.98 5026.96,-1514.55 5062.39,-1503.32 5091.24,-1492.67"/>
<polygon fill="black" stroke="black" points="5092.63,-1495.89 5100.75,-1489.1 5090.16,-1489.34 5092.63,-1495.89"/>
</g>
<!-- tp_13_3&#45;&gt;v_proj_14 -->
<g id="edge2015" class="edge">
<title>tp_13_3&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M3779.3,-1541.73C3797.76,-1536.11 3817.94,-1530.92 3837,-1527.98 3929.58,-1513.74 4587.6,-1535.34 4680,-1519.98 4712.96,-1514.51 4748.38,-1503.27 4777.23,-1492.64"/>
<polygon fill="black" stroke="black" points="4778.62,-1495.85 4786.75,-1489.06 4776.16,-1489.3 4778.62,-1495.85"/>
</g>
<!-- expert_13_4_0 -->
<g id="node949" class="node">
<title>expert_13_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2763.5,-1678.21 2486.5,-1678.21 2486.5,-1634.21 2763.5,-1634.21 2763.5,-1678.21"/>
<text text-anchor="middle" x="2625" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L13</text>
<text text-anchor="middle" x="2625" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 392</text>
<text text-anchor="middle" x="2625" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2625" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_4&#45;&gt;expert_13_4_0 -->
<g id="edge1149" class="edge">
<title>route_13_4&#45;&gt;expert_13_4_0</title>
<path fill="none" stroke="black" d="M2829.08,-1717.48C2789.92,-1705.91 2744.49,-1692.49 2706.44,-1681.26"/>
<polygon fill="black" stroke="black" points="2707.01,-1677.78 2696.43,-1678.3 2705.03,-1684.49 2707.01,-1677.78"/>
</g>
<!-- expert_13_4_1 -->
<g id="node950" class="node">
<title>expert_13_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3058.5,-1678.21 2781.5,-1678.21 2781.5,-1634.21 3058.5,-1634.21 3058.5,-1678.21"/>
<text text-anchor="middle" x="2920" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L13</text>
<text text-anchor="middle" x="2920" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 393</text>
<text text-anchor="middle" x="2920" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2920" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_4&#45;&gt;expert_13_4_1 -->
<g id="edge1150" class="edge">
<title>route_13_4&#45;&gt;expert_13_4_1</title>
<path fill="none" stroke="black" d="M2920,-1713.86C2920,-1705.58 2920,-1696.6 2920,-1688.29"/>
<polygon fill="black" stroke="black" points="2923.5,-1688.21 2920,-1678.21 2916.5,-1688.21 2923.5,-1688.21"/>
</g>
<!-- tp_13_4 -->
<g id="node951" class="node">
<title>tp_13_4</title>
<ellipse fill="lightblue" stroke="black" cx="3962" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3962" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L13</text>
<text text-anchor="middle" x="3962" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 392↔393</text>
<text text-anchor="middle" x="3962" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3962" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_4_0&#45;&gt;tp_13_4 -->
<g id="edge1151" class="edge">
<title>expert_13_4_0&#45;&gt;tp_13_4</title>
<path fill="none" stroke="black" d="M2763.6,-1635.09C2766.76,-1634.77 2769.9,-1634.48 2773,-1634.21 3244.35,-1592.92 3368.15,-1661.94 3837,-1598.21 3848.58,-1596.64 3860.65,-1594.45 3872.52,-1591.96"/>
<polygon fill="black" stroke="black" points="3873.41,-1595.35 3882.44,-1589.81 3871.92,-1588.51 3873.41,-1595.35"/>
</g>
<!-- expert_13_4_1&#45;&gt;tp_13_4 -->
<g id="edge1152" class="edge">
<title>expert_13_4_1&#45;&gt;tp_13_4</title>
<path fill="none" stroke="black" d="M3058.6,-1635.14C3061.76,-1634.81 3064.9,-1634.5 3068,-1634.21 3408.65,-1602.14 3498.27,-1646.49 3837,-1598.21 3848.48,-1596.57 3860.45,-1594.36 3872.24,-1591.87"/>
<polygon fill="black" stroke="black" points="3873.06,-1595.28 3882.08,-1589.73 3871.56,-1588.44 3873.06,-1595.28"/>
</g>
<!-- tp_13_4&#45;&gt;q_proj_14 -->
<g id="edge2016" class="edge">
<title>tp_13_4&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M4032.87,-1542.35C4050.42,-1537.06 4069.27,-1531.88 4087,-1527.98 4178.16,-1507.95 4281.6,-1493.37 4364.84,-1483.61"/>
<polygon fill="black" stroke="black" points="4365.36,-1487.07 4374.89,-1482.44 4364.56,-1480.12 4365.36,-1487.07"/>
</g>
<!-- tp_13_4&#45;&gt;k_proj_14 -->
<g id="edge2017" class="edge">
<title>tp_13_4&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M4029.3,-1541.72C4047.75,-1536.1 4067.94,-1530.91 4087,-1527.98 4186.61,-1512.69 4894.58,-1536.47 4994,-1519.98 5026.96,-1514.52 5062.39,-1503.28 5091.23,-1492.65"/>
<polygon fill="black" stroke="black" points="5092.62,-1495.86 5100.75,-1489.07 5090.16,-1489.31 5092.62,-1495.86"/>
</g>
<!-- tp_13_4&#45;&gt;v_proj_14 -->
<g id="edge2018" class="edge">
<title>tp_13_4&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M4029.63,-1541.68C4048,-1536.1 4068.06,-1530.94 4087,-1527.98 4217.22,-1507.68 4550.04,-1541.85 4680,-1519.98 4712.94,-1514.44 4748.37,-1503.2 4777.22,-1492.58"/>
<polygon fill="black" stroke="black" points="4778.61,-1495.8 4786.74,-1489.01 4776.15,-1489.24 4778.61,-1495.8"/>
</g>
<!-- expert_13_5_0 -->
<g id="node953" class="node">
<title>expert_13_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3353.5,-1678.21 3076.5,-1678.21 3076.5,-1634.21 3353.5,-1634.21 3353.5,-1678.21"/>
<text text-anchor="middle" x="3215" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L13</text>
<text text-anchor="middle" x="3215" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 394</text>
<text text-anchor="middle" x="3215" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3215" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_5&#45;&gt;expert_13_5_0 -->
<g id="edge1154" class="edge">
<title>route_13_5&#45;&gt;expert_13_5_0</title>
<path fill="none" stroke="black" d="M3419.08,-1717.48C3379.92,-1705.91 3334.49,-1692.49 3296.44,-1681.26"/>
<polygon fill="black" stroke="black" points="3297.01,-1677.78 3286.43,-1678.3 3295.03,-1684.49 3297.01,-1677.78"/>
</g>
<!-- expert_13_5_1 -->
<g id="node954" class="node">
<title>expert_13_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3648.5,-1678.21 3371.5,-1678.21 3371.5,-1634.21 3648.5,-1634.21 3648.5,-1678.21"/>
<text text-anchor="middle" x="3510" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L13</text>
<text text-anchor="middle" x="3510" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 395</text>
<text text-anchor="middle" x="3510" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3510" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_5&#45;&gt;expert_13_5_1 -->
<g id="edge1155" class="edge">
<title>route_13_5&#45;&gt;expert_13_5_1</title>
<path fill="none" stroke="black" d="M3510,-1713.86C3510,-1705.58 3510,-1696.6 3510,-1688.29"/>
<polygon fill="black" stroke="black" points="3513.5,-1688.21 3510,-1678.21 3506.5,-1688.21 3513.5,-1688.21"/>
</g>
<!-- tp_13_5 -->
<g id="node955" class="node">
<title>tp_13_5</title>
<ellipse fill="lightblue" stroke="black" cx="4212" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4212" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L13</text>
<text text-anchor="middle" x="4212" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 394↔395</text>
<text text-anchor="middle" x="4212" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4212" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_5_0&#45;&gt;tp_13_5 -->
<g id="edge1156" class="edge">
<title>expert_13_5_0&#45;&gt;tp_13_5</title>
<path fill="none" stroke="black" d="M3353.61,-1635.15C3356.77,-1634.82 3359.9,-1634.51 3363,-1634.21 3683.71,-1603.55 3768.11,-1644.14 4087,-1598.21 4098.48,-1596.56 4110.45,-1594.33 4122.23,-1591.84"/>
<polygon fill="black" stroke="black" points="4123.05,-1595.25 4132.07,-1589.69 4121.56,-1588.41 4123.05,-1595.25"/>
</g>
<!-- expert_13_5_1&#45;&gt;tp_13_5 -->
<g id="edge1157" class="edge">
<title>expert_13_5_1&#45;&gt;tp_13_5</title>
<path fill="none" stroke="black" d="M3648.62,-1635.3C3651.78,-1634.92 3654.91,-1634.56 3658,-1634.21 3848.13,-1612.76 3898.11,-1628.7 4087,-1598.21 4098.08,-1596.42 4109.63,-1594.17 4121.03,-1591.72"/>
<polygon fill="black" stroke="black" points="4122,-1595.09 4131,-1589.51 4120.48,-1588.25 4122,-1595.09"/>
</g>
<!-- tp_13_5&#45;&gt;q_proj_14 -->
<g id="edge2019" class="edge">
<title>tp_13_5&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M4285.31,-1542.97C4333.88,-1527.65 4397.46,-1507.59 4446.65,-1492.07"/>
<polygon fill="black" stroke="black" points="4447.8,-1495.38 4456.28,-1489.03 4445.69,-1488.7 4447.8,-1495.38"/>
</g>
<!-- tp_13_5&#45;&gt;k_proj_14 -->
<g id="edge2020" class="edge">
<title>tp_13_5&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M4279.63,-1541.66C4298,-1536.08 4318.06,-1530.93 4337,-1527.98 4409.14,-1516.78 4922,-1532.05 4994,-1519.98 5026.95,-1514.46 5062.38,-1503.22 5091.23,-1492.6"/>
<polygon fill="black" stroke="black" points="5092.61,-1495.82 5100.74,-1489.03 5090.15,-1489.26 5092.61,-1495.82"/>
</g>
<!-- tp_13_5&#45;&gt;v_proj_14 -->
<g id="edge2021" class="edge">
<title>tp_13_5&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M4279.65,-1541.8C4298.02,-1536.22 4318.07,-1531.03 4337,-1527.98 4412.27,-1515.87 4604.88,-1533 4680,-1519.98 4712.79,-1514.3 4748.07,-1503.11 4776.86,-1492.56"/>
<polygon fill="black" stroke="black" points="4778.22,-1495.79 4786.37,-1489.01 4775.77,-1489.23 4778.22,-1495.79"/>
</g>
<!-- expert_13_6_0 -->
<g id="node957" class="node">
<title>expert_13_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3943.5,-1678.21 3666.5,-1678.21 3666.5,-1634.21 3943.5,-1634.21 3943.5,-1678.21"/>
<text text-anchor="middle" x="3805" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L13</text>
<text text-anchor="middle" x="3805" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 396</text>
<text text-anchor="middle" x="3805" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3805" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_6&#45;&gt;expert_13_6_0 -->
<g id="edge1159" class="edge">
<title>route_13_6&#45;&gt;expert_13_6_0</title>
<path fill="none" stroke="black" d="M4009.08,-1717.48C3969.92,-1705.91 3924.49,-1692.49 3886.44,-1681.26"/>
<polygon fill="black" stroke="black" points="3887.01,-1677.78 3876.43,-1678.3 3885.03,-1684.49 3887.01,-1677.78"/>
</g>
<!-- expert_13_6_1 -->
<g id="node958" class="node">
<title>expert_13_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4238.5,-1678.21 3961.5,-1678.21 3961.5,-1634.21 4238.5,-1634.21 4238.5,-1678.21"/>
<text text-anchor="middle" x="4100" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L13</text>
<text text-anchor="middle" x="4100" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 397</text>
<text text-anchor="middle" x="4100" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4100" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_6&#45;&gt;expert_13_6_1 -->
<g id="edge1160" class="edge">
<title>route_13_6&#45;&gt;expert_13_6_1</title>
<path fill="none" stroke="black" d="M4100,-1713.86C4100,-1705.58 4100,-1696.6 4100,-1688.29"/>
<polygon fill="black" stroke="black" points="4103.5,-1688.21 4100,-1678.21 4096.5,-1688.21 4103.5,-1688.21"/>
</g>
<!-- tp_13_6 -->
<g id="node959" class="node">
<title>tp_13_6</title>
<ellipse fill="lightblue" stroke="black" cx="4462" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4462" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L13</text>
<text text-anchor="middle" x="4462" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 396↔397</text>
<text text-anchor="middle" x="4462" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4462" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_6_0&#45;&gt;tp_13_6 -->
<g id="edge1161" class="edge">
<title>expert_13_6_0&#45;&gt;tp_13_6</title>
<path fill="none" stroke="black" d="M3943.63,-1635.34C3946.78,-1634.95 3949.91,-1634.57 3953,-1634.21 4123.24,-1614.16 4167.91,-1626.35 4337,-1598.21 4348.07,-1596.37 4359.61,-1594.09 4371.02,-1591.61"/>
<polygon fill="black" stroke="black" points="4371.98,-1594.98 4380.98,-1589.39 4370.46,-1588.15 4371.98,-1594.98"/>
</g>
<!-- expert_13_6_1&#45;&gt;tp_13_6 -->
<g id="edge1162" class="edge">
<title>expert_13_6_1&#45;&gt;tp_13_6</title>
<path fill="none" stroke="black" d="M4187.51,-1634.17C4232.24,-1623.42 4287.52,-1610.12 4337,-1598.21 4346.87,-1595.84 4357.17,-1593.35 4367.45,-1590.88"/>
<polygon fill="black" stroke="black" points="4368.38,-1594.26 4377.28,-1588.51 4366.74,-1587.45 4368.38,-1594.26"/>
</g>
<!-- tp_13_6&#45;&gt;q_proj_14 -->
<g id="edge2022" class="edge">
<title>tp_13_6&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M4480.63,-1536.13C4488.17,-1524 4496.86,-1510.03 4504.39,-1497.91"/>
<polygon fill="black" stroke="black" points="4507.59,-1499.41 4509.89,-1489.07 4501.64,-1495.71 4507.59,-1499.41"/>
</g>
<!-- tp_13_6&#45;&gt;k_proj_14 -->
<g id="edge2023" class="edge">
<title>tp_13_6&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M4529.64,-1541.76C4548.01,-1536.17 4568.07,-1531 4587,-1527.98 4676.34,-1513.77 4904.84,-1535.27 4994,-1519.98 5026.8,-1514.36 5062.08,-1503.17 5090.87,-1492.61"/>
<polygon fill="black" stroke="black" points="5092.23,-1495.84 5100.37,-1489.06 5089.78,-1489.28 5092.23,-1495.84"/>
</g>
<!-- tp_13_6&#45;&gt;v_proj_14 -->
<g id="edge2024" class="edge">
<title>tp_13_6&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M4531.43,-1542.1C4549.34,-1536.69 4568.73,-1531.51 4587,-1527.98 4627.73,-1520.11 4639.36,-1528.34 4680,-1519.98 4711.57,-1513.49 4745.65,-1502.69 4773.96,-1492.61"/>
<polygon fill="black" stroke="black" points="4775.5,-1495.78 4783.72,-1489.09 4773.12,-1489.19 4775.5,-1495.78"/>
</g>
<!-- expert_13_7_0 -->
<g id="node961" class="node">
<title>expert_13_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4533.5,-1678.21 4256.5,-1678.21 4256.5,-1634.21 4533.5,-1634.21 4533.5,-1678.21"/>
<text text-anchor="middle" x="4395" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L13</text>
<text text-anchor="middle" x="4395" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 398</text>
<text text-anchor="middle" x="4395" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4395" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_7&#45;&gt;expert_13_7_0 -->
<g id="edge1164" class="edge">
<title>route_13_7&#45;&gt;expert_13_7_0</title>
<path fill="none" stroke="black" d="M4553.32,-1716.4C4523.66,-1705.31 4489.83,-1692.66 4461.08,-1681.92"/>
<polygon fill="black" stroke="black" points="4462.13,-1678.57 4451.54,-1678.35 4459.68,-1685.13 4462.13,-1678.57"/>
</g>
<!-- expert_13_7_1 -->
<g id="node962" class="node">
<title>expert_13_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4828.5,-1678.21 4551.5,-1678.21 4551.5,-1634.21 4828.5,-1634.21 4828.5,-1678.21"/>
<text text-anchor="middle" x="4690" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L13</text>
<text text-anchor="middle" x="4690" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 399</text>
<text text-anchor="middle" x="4690" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4690" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_7&#45;&gt;expert_13_7_1 -->
<g id="edge1165" class="edge">
<title>route_13_7&#45;&gt;expert_13_7_1</title>
<path fill="none" stroke="black" d="M4649.34,-1714.34C4655.71,-1705.39 4662.68,-1695.59 4669.03,-1686.67"/>
<polygon fill="black" stroke="black" points="4671.94,-1688.63 4674.88,-1678.45 4666.23,-1684.57 4671.94,-1688.63"/>
</g>
<!-- tp_13_7 -->
<g id="node963" class="node">
<title>tp_13_7</title>
<ellipse fill="lightblue" stroke="black" cx="4712" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4712" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L13</text>
<text text-anchor="middle" x="4712" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 398↔399</text>
<text text-anchor="middle" x="4712" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4712" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_7_0&#45;&gt;tp_13_7 -->
<g id="edge1166" class="edge">
<title>expert_13_7_0&#45;&gt;tp_13_7</title>
<path fill="none" stroke="black" d="M4471.74,-1634.12C4517.34,-1621.59 4575.37,-1605.64 4622.98,-1592.56"/>
<polygon fill="black" stroke="black" points="4623.94,-1595.93 4632.66,-1589.9 4622.09,-1589.18 4623.94,-1595.93"/>
</g>
<!-- expert_13_7_1&#45;&gt;tp_13_7 -->
<g id="edge1167" class="edge">
<title>expert_13_7_1&#45;&gt;tp_13_7</title>
<path fill="none" stroke="black" d="M4695.33,-1634.12C4697.3,-1626.29 4699.62,-1617.13 4701.88,-1608.17"/>
<polygon fill="black" stroke="black" points="4705.34,-1608.76 4704.4,-1598.21 4698.55,-1607.05 4705.34,-1608.76"/>
</g>
<!-- tp_13_7&#45;&gt;q_proj_14 -->
<g id="edge2025" class="edge">
<title>tp_13_7&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M4660.1,-1539.16C4632.81,-1524.99 4599.52,-1507.71 4572.58,-1493.72"/>
<polygon fill="black" stroke="black" points="4574.19,-1490.61 4563.7,-1489.11 4570.96,-1496.83 4574.19,-1490.61"/>
</g>
<!-- tp_13_7&#45;&gt;k_proj_14 -->
<g id="edge2026" class="edge">
<title>tp_13_7&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M4780.36,-1541.96C4798.55,-1536.45 4818.34,-1531.25 4837,-1527.98 4905.82,-1515.93 4925.33,-1532.86 4994,-1519.98 5026.33,-1513.92 5061.16,-1502.87 5089.78,-1492.52"/>
<polygon fill="black" stroke="black" points="5091.06,-1495.77 5099.24,-1489.04 5088.64,-1489.2 5091.06,-1495.77"/>
</g>
<!-- tp_13_7&#45;&gt;v_proj_14 -->
<g id="edge2027" class="edge">
<title>tp_13_7&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M4748.49,-1537.46C4765.46,-1524.14 4785.54,-1508.38 4802.28,-1495.23"/>
<polygon fill="black" stroke="black" points="4804.5,-1497.94 4810.2,-1489.02 4800.18,-1492.44 4804.5,-1497.94"/>
</g>
<!-- expert_13_8_0 -->
<g id="node965" class="node">
<title>expert_13_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5123.5,-1678.21 4846.5,-1678.21 4846.5,-1634.21 5123.5,-1634.21 5123.5,-1678.21"/>
<text text-anchor="middle" x="4985" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L13</text>
<text text-anchor="middle" x="4985" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="4985" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4985" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_8&#45;&gt;expert_13_8_0 -->
<g id="edge1169" class="edge">
<title>route_13_8&#45;&gt;expert_13_8_0</title>
<path fill="none" stroke="black" d="M5026.32,-1714.34C5019.85,-1705.39 5012.76,-1695.59 5006.31,-1686.67"/>
<polygon fill="black" stroke="black" points="5009.06,-1684.5 5000.36,-1678.45 5003.39,-1688.6 5009.06,-1684.5"/>
</g>
<!-- expert_13_8_1 -->
<g id="node966" class="node">
<title>expert_13_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5418.5,-1678.21 5141.5,-1678.21 5141.5,-1634.21 5418.5,-1634.21 5418.5,-1678.21"/>
<text text-anchor="middle" x="5280" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L13</text>
<text text-anchor="middle" x="5280" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="5280" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5280" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_8&#45;&gt;expert_13_8_1 -->
<g id="edge1170" class="edge">
<title>route_13_8&#45;&gt;expert_13_8_1</title>
<path fill="none" stroke="black" d="M5122.36,-1716.4C5151.89,-1705.31 5185.58,-1692.66 5214.2,-1681.92"/>
<polygon fill="black" stroke="black" points="5215.57,-1685.14 5223.71,-1678.35 5213.11,-1678.59 5215.57,-1685.14"/>
</g>
<!-- tp_13_8 -->
<g id="node967" class="node">
<title>tp_13_8</title>
<ellipse fill="lightblue" stroke="black" cx="4962" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4962" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L13</text>
<text text-anchor="middle" x="4962" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="4962" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4962" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_8_0&#45;&gt;tp_13_8 -->
<g id="edge1171" class="edge">
<title>expert_13_8_0&#45;&gt;tp_13_8</title>
<path fill="none" stroke="black" d="M4979.43,-1634.12C4977.37,-1626.29 4974.95,-1617.13 4972.58,-1608.17"/>
<polygon fill="black" stroke="black" points="4975.89,-1606.99 4969.95,-1598.21 4969.12,-1608.77 4975.89,-1606.99"/>
</g>
<!-- expert_13_8_1&#45;&gt;tp_13_8 -->
<g id="edge1172" class="edge">
<title>expert_13_8_1&#45;&gt;tp_13_8</title>
<path fill="none" stroke="black" d="M5203.02,-1634.12C5157.19,-1621.57 5098.84,-1605.58 5051.04,-1592.49"/>
<polygon fill="black" stroke="black" points="5051.88,-1589.09 5041.31,-1589.82 5050.03,-1595.84 5051.88,-1589.09"/>
</g>
<!-- tp_13_8&#45;&gt;q_proj_14 -->
<g id="edge2028" class="edge">
<title>tp_13_8&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M4893.64,-1541.96C4875.45,-1536.45 4855.66,-1531.25 4837,-1527.98 4768.18,-1515.93 4748.67,-1532.86 4680,-1519.98 4647.67,-1513.92 4612.84,-1502.87 4584.22,-1492.52"/>
<polygon fill="black" stroke="black" points="4585.36,-1489.2 4574.76,-1489.04 4582.94,-1495.77 4585.36,-1489.2"/>
</g>
<!-- tp_13_8&#45;&gt;k_proj_14 -->
<g id="edge2029" class="edge">
<title>tp_13_8&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M5013.9,-1539.16C5041.19,-1524.99 5074.48,-1507.71 5101.42,-1493.72"/>
<polygon fill="black" stroke="black" points="5103.04,-1496.83 5110.3,-1489.11 5099.81,-1490.61 5103.04,-1496.83"/>
</g>
<!-- tp_13_8&#45;&gt;v_proj_14 -->
<g id="edge2030" class="edge">
<title>tp_13_8&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M4925.51,-1537.46C4908.54,-1524.14 4888.46,-1508.38 4871.72,-1495.23"/>
<polygon fill="black" stroke="black" points="4873.82,-1492.44 4863.8,-1489.02 4869.5,-1497.94 4873.82,-1492.44"/>
</g>
<!-- expert_13_9_0 -->
<g id="node969" class="node">
<title>expert_13_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5713.5,-1678.21 5436.5,-1678.21 5436.5,-1634.21 5713.5,-1634.21 5713.5,-1678.21"/>
<text text-anchor="middle" x="5575" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L13</text>
<text text-anchor="middle" x="5575" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 418</text>
<text text-anchor="middle" x="5575" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5575" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_9&#45;&gt;expert_13_9_0 -->
<g id="edge1174" class="edge">
<title>route_13_9&#45;&gt;expert_13_9_0</title>
<path fill="none" stroke="black" d="M5575,-1713.86C5575,-1705.58 5575,-1696.6 5575,-1688.29"/>
<polygon fill="black" stroke="black" points="5578.5,-1688.21 5575,-1678.21 5571.5,-1688.21 5578.5,-1688.21"/>
</g>
<!-- expert_13_9_1 -->
<g id="node970" class="node">
<title>expert_13_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6008.5,-1678.21 5731.5,-1678.21 5731.5,-1634.21 6008.5,-1634.21 6008.5,-1678.21"/>
<text text-anchor="middle" x="5870" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L13</text>
<text text-anchor="middle" x="5870" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 419</text>
<text text-anchor="middle" x="5870" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5870" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_9&#45;&gt;expert_13_9_1 -->
<g id="edge1175" class="edge">
<title>route_13_9&#45;&gt;expert_13_9_1</title>
<path fill="none" stroke="black" d="M5665.92,-1717.48C5705.08,-1705.91 5750.51,-1692.49 5788.56,-1681.26"/>
<polygon fill="black" stroke="black" points="5789.97,-1684.49 5798.57,-1678.3 5787.99,-1677.78 5789.97,-1684.49"/>
</g>
<!-- tp_13_9 -->
<g id="node971" class="node">
<title>tp_13_9</title>
<ellipse fill="lightblue" stroke="black" cx="5212" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5212" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L13</text>
<text text-anchor="middle" x="5212" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 418↔419</text>
<text text-anchor="middle" x="5212" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5212" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_9_0&#45;&gt;tp_13_9 -->
<g id="edge1176" class="edge">
<title>expert_13_9_0&#45;&gt;tp_13_9</title>
<path fill="none" stroke="black" d="M5487.11,-1634.19C5442.2,-1623.44 5386.68,-1610.14 5337,-1598.21 5327.05,-1595.82 5316.65,-1593.32 5306.29,-1590.83"/>
<polygon fill="black" stroke="black" points="5306.92,-1587.38 5296.38,-1588.44 5305.28,-1594.18 5306.92,-1587.38"/>
</g>
<!-- expert_13_9_1&#45;&gt;tp_13_9 -->
<g id="edge1177" class="edge">
<title>expert_13_9_1&#45;&gt;tp_13_9</title>
<path fill="none" stroke="black" d="M5731.14,-1635.19C5728.4,-1634.85 5725.69,-1634.53 5723,-1634.21 5551.89,-1614.02 5506.97,-1626.46 5337,-1598.21 5325.93,-1596.37 5314.39,-1594.09 5302.98,-1591.62"/>
<polygon fill="black" stroke="black" points="5303.54,-1588.16 5293.01,-1589.4 5302.02,-1594.99 5303.54,-1588.16"/>
</g>
<!-- tp_13_9&#45;&gt;q_proj_14 -->
<g id="edge2031" class="edge">
<title>tp_13_9&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M5144.36,-1541.76C5125.99,-1536.17 5105.93,-1531 5087,-1527.98 4997.66,-1513.77 4769.16,-1535.27 4680,-1519.98 4647.2,-1514.36 4611.92,-1503.17 4583.13,-1492.61"/>
<polygon fill="black" stroke="black" points="4584.22,-1489.28 4573.63,-1489.06 4581.77,-1495.84 4584.22,-1489.28"/>
</g>
<!-- tp_13_9&#45;&gt;k_proj_14 -->
<g id="edge2032" class="edge">
<title>tp_13_9&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M5193.37,-1536.13C5185.83,-1524 5177.14,-1510.03 5169.61,-1497.91"/>
<polygon fill="black" stroke="black" points="5172.36,-1495.71 5164.11,-1489.07 5166.41,-1499.41 5172.36,-1495.71"/>
</g>
<!-- tp_13_9&#45;&gt;v_proj_14 -->
<g id="edge2033" class="edge">
<title>tp_13_9&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M5142.57,-1542.1C5124.66,-1536.69 5105.27,-1531.51 5087,-1527.98 5046.27,-1520.11 5034.64,-1528.34 4994,-1519.98 4962.43,-1513.49 4928.35,-1502.69 4900.04,-1492.61"/>
<polygon fill="black" stroke="black" points="4900.88,-1489.19 4890.28,-1489.09 4898.5,-1495.78 4900.88,-1489.19"/>
</g>
<!-- expert_13_10_0 -->
<g id="node973" class="node">
<title>expert_13_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6303.5,-1678.21 6026.5,-1678.21 6026.5,-1634.21 6303.5,-1634.21 6303.5,-1678.21"/>
<text text-anchor="middle" x="6165" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L13</text>
<text text-anchor="middle" x="6165" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 420</text>
<text text-anchor="middle" x="6165" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6165" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_10&#45;&gt;expert_13_10_0 -->
<g id="edge1179" class="edge">
<title>route_13_10&#45;&gt;expert_13_10_0</title>
<path fill="none" stroke="black" d="M6165,-1713.86C6165,-1705.58 6165,-1696.6 6165,-1688.29"/>
<polygon fill="black" stroke="black" points="6168.5,-1688.21 6165,-1678.21 6161.5,-1688.21 6168.5,-1688.21"/>
</g>
<!-- expert_13_10_1 -->
<g id="node974" class="node">
<title>expert_13_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6598.5,-1678.21 6321.5,-1678.21 6321.5,-1634.21 6598.5,-1634.21 6598.5,-1678.21"/>
<text text-anchor="middle" x="6460" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L13</text>
<text text-anchor="middle" x="6460" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 421</text>
<text text-anchor="middle" x="6460" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6460" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_10&#45;&gt;expert_13_10_1 -->
<g id="edge1180" class="edge">
<title>route_13_10&#45;&gt;expert_13_10_1</title>
<path fill="none" stroke="black" d="M6255.92,-1717.48C6295.08,-1705.91 6340.51,-1692.49 6378.56,-1681.26"/>
<polygon fill="black" stroke="black" points="6379.97,-1684.49 6388.57,-1678.3 6377.99,-1677.78 6379.97,-1684.49"/>
</g>
<!-- tp_13_10 -->
<g id="node975" class="node">
<title>tp_13_10</title>
<ellipse fill="lightblue" stroke="black" cx="5462" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5462" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L13</text>
<text text-anchor="middle" x="5462" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 420↔421</text>
<text text-anchor="middle" x="5462" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5462" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_10_0&#45;&gt;tp_13_10 -->
<g id="edge1181" class="edge">
<title>expert_13_10_0&#45;&gt;tp_13_10</title>
<path fill="none" stroke="black" d="M6026.14,-1635.15C6023.41,-1634.83 6020.69,-1634.51 6018,-1634.21 5827,-1612.61 5776.77,-1628.81 5587,-1598.21 5575.92,-1596.42 5564.37,-1594.18 5552.97,-1591.72"/>
<polygon fill="black" stroke="black" points="5553.52,-1588.26 5543,-1589.52 5552,-1595.09 5553.52,-1588.26"/>
</g>
<!-- expert_13_10_1&#45;&gt;tp_13_10 -->
<g id="edge1182" class="edge">
<title>expert_13_10_1&#45;&gt;tp_13_10</title>
<path fill="none" stroke="black" d="M6321.16,-1635.03C6318.42,-1634.74 6315.69,-1634.47 6313,-1634.21 5991.42,-1603.33 5906.77,-1644.24 5587,-1598.21 5575.52,-1596.56 5563.55,-1594.34 5551.77,-1591.84"/>
<polygon fill="black" stroke="black" points="5552.44,-1588.41 5541.93,-1589.69 5550.95,-1595.25 5552.44,-1588.41"/>
</g>
<!-- tp_13_10&#45;&gt;q_proj_14 -->
<g id="edge2034" class="edge">
<title>tp_13_10&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M5394.37,-1541.66C5376,-1536.08 5355.94,-1530.93 5337,-1527.98 5264.86,-1516.78 4752,-1532.05 4680,-1519.98 4647.05,-1514.46 4611.62,-1503.22 4582.77,-1492.6"/>
<polygon fill="black" stroke="black" points="4583.85,-1489.26 4573.26,-1489.03 4581.39,-1495.82 4583.85,-1489.26"/>
</g>
<!-- tp_13_10&#45;&gt;k_proj_14 -->
<g id="edge2035" class="edge">
<title>tp_13_10&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M5388.69,-1542.97C5340.12,-1527.65 5276.54,-1507.59 5227.35,-1492.07"/>
<polygon fill="black" stroke="black" points="5228.31,-1488.7 5217.72,-1489.03 5226.2,-1495.38 5228.31,-1488.7"/>
</g>
<!-- tp_13_10&#45;&gt;v_proj_14 -->
<g id="edge2036" class="edge">
<title>tp_13_10&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M5394.35,-1541.8C5375.98,-1536.22 5355.93,-1531.03 5337,-1527.98 5261.73,-1515.87 5069.12,-1533 4994,-1519.98 4961.21,-1514.3 4925.93,-1503.11 4897.14,-1492.56"/>
<polygon fill="black" stroke="black" points="4898.23,-1489.23 4887.63,-1489.01 4895.78,-1495.79 4898.23,-1489.23"/>
</g>
<!-- expert_13_11_0 -->
<g id="node977" class="node">
<title>expert_13_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6893.5,-1678.21 6616.5,-1678.21 6616.5,-1634.21 6893.5,-1634.21 6893.5,-1678.21"/>
<text text-anchor="middle" x="6755" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L13</text>
<text text-anchor="middle" x="6755" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 422</text>
<text text-anchor="middle" x="6755" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6755" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_11&#45;&gt;expert_13_11_0 -->
<g id="edge1184" class="edge">
<title>route_13_11&#45;&gt;expert_13_11_0</title>
<path fill="none" stroke="black" d="M6755,-1713.86C6755,-1705.58 6755,-1696.6 6755,-1688.29"/>
<polygon fill="black" stroke="black" points="6758.5,-1688.21 6755,-1678.21 6751.5,-1688.21 6758.5,-1688.21"/>
</g>
<!-- expert_13_11_1 -->
<g id="node978" class="node">
<title>expert_13_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7188.5,-1678.21 6911.5,-1678.21 6911.5,-1634.21 7188.5,-1634.21 7188.5,-1678.21"/>
<text text-anchor="middle" x="7050" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L13</text>
<text text-anchor="middle" x="7050" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 423</text>
<text text-anchor="middle" x="7050" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7050" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_11&#45;&gt;expert_13_11_1 -->
<g id="edge1185" class="edge">
<title>route_13_11&#45;&gt;expert_13_11_1</title>
<path fill="none" stroke="black" d="M6845.92,-1717.48C6885.08,-1705.91 6930.51,-1692.49 6968.56,-1681.26"/>
<polygon fill="black" stroke="black" points="6969.97,-1684.49 6978.57,-1678.3 6967.99,-1677.78 6969.97,-1684.49"/>
</g>
<!-- tp_13_11 -->
<g id="node979" class="node">
<title>tp_13_11</title>
<ellipse fill="lightblue" stroke="black" cx="5712" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5712" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L13</text>
<text text-anchor="middle" x="5712" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 422↔423</text>
<text text-anchor="middle" x="5712" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5712" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_11_0&#45;&gt;tp_13_11 -->
<g id="edge1186" class="edge">
<title>expert_13_11_0&#45;&gt;tp_13_11</title>
<path fill="none" stroke="black" d="M6616.16,-1635.02C6613.42,-1634.73 6610.69,-1634.47 6608,-1634.21 6266.48,-1601.92 6176.61,-1646.6 5837,-1598.21 5825.52,-1596.57 5813.55,-1594.36 5801.76,-1591.88"/>
<polygon fill="black" stroke="black" points="5802.44,-1588.44 5791.92,-1589.73 5800.94,-1595.28 5802.44,-1588.44"/>
</g>
<!-- expert_13_11_1&#45;&gt;tp_13_11 -->
<g id="edge1187" class="edge">
<title>expert_13_11_1&#45;&gt;tp_13_11</title>
<path fill="none" stroke="black" d="M6911.16,-1634.97C6908.42,-1634.7 6905.7,-1634.45 6903,-1634.21 6430.78,-1592.63 6306.73,-1662.05 5837,-1598.21 5825.42,-1596.64 5813.35,-1594.45 5801.48,-1591.96"/>
<polygon fill="black" stroke="black" points="5802.08,-1588.51 5791.56,-1589.81 5800.59,-1595.35 5802.08,-1588.51"/>
</g>
<!-- tp_13_11&#45;&gt;q_proj_14 -->
<g id="edge2037" class="edge">
<title>tp_13_11&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M5644.7,-1541.72C5626.25,-1536.1 5606.06,-1530.91 5587,-1527.98 5487.39,-1512.69 4779.42,-1536.47 4680,-1519.98 4647.04,-1514.52 4611.61,-1503.28 4582.77,-1492.65"/>
<polygon fill="black" stroke="black" points="4583.84,-1489.31 4573.25,-1489.07 4581.38,-1495.86 4583.84,-1489.31"/>
</g>
<!-- tp_13_11&#45;&gt;k_proj_14 -->
<g id="edge2038" class="edge">
<title>tp_13_11&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M5641.13,-1542.35C5623.58,-1537.06 5604.73,-1531.88 5587,-1527.98 5495.84,-1507.95 5392.4,-1493.37 5309.16,-1483.61"/>
<polygon fill="black" stroke="black" points="5309.44,-1480.12 5299.11,-1482.44 5308.64,-1487.07 5309.44,-1480.12"/>
</g>
<!-- tp_13_11&#45;&gt;v_proj_14 -->
<g id="edge2039" class="edge">
<title>tp_13_11&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M5644.37,-1541.68C5626,-1536.1 5605.94,-1530.94 5587,-1527.98 5456.78,-1507.68 5123.96,-1541.85 4994,-1519.98 4961.06,-1514.44 4925.63,-1503.2 4896.78,-1492.58"/>
<polygon fill="black" stroke="black" points="4897.85,-1489.24 4887.26,-1489.01 4895.39,-1495.8 4897.85,-1489.24"/>
</g>
<!-- expert_13_12_0 -->
<g id="node981" class="node">
<title>expert_13_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7483.5,-1678.21 7206.5,-1678.21 7206.5,-1634.21 7483.5,-1634.21 7483.5,-1678.21"/>
<text text-anchor="middle" x="7345" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L13</text>
<text text-anchor="middle" x="7345" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 424</text>
<text text-anchor="middle" x="7345" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7345" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_12&#45;&gt;expert_13_12_0 -->
<g id="edge1189" class="edge">
<title>route_13_12&#45;&gt;expert_13_12_0</title>
<path fill="none" stroke="black" d="M7345,-1713.86C7345,-1705.58 7345,-1696.6 7345,-1688.29"/>
<polygon fill="black" stroke="black" points="7348.5,-1688.21 7345,-1678.21 7341.5,-1688.21 7348.5,-1688.21"/>
</g>
<!-- expert_13_12_1 -->
<g id="node982" class="node">
<title>expert_13_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7778.5,-1678.21 7501.5,-1678.21 7501.5,-1634.21 7778.5,-1634.21 7778.5,-1678.21"/>
<text text-anchor="middle" x="7640" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L13</text>
<text text-anchor="middle" x="7640" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 425</text>
<text text-anchor="middle" x="7640" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7640" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_12&#45;&gt;expert_13_12_1 -->
<g id="edge1190" class="edge">
<title>route_13_12&#45;&gt;expert_13_12_1</title>
<path fill="none" stroke="black" d="M7435.92,-1717.48C7475.08,-1705.91 7520.51,-1692.49 7558.56,-1681.26"/>
<polygon fill="black" stroke="black" points="7559.97,-1684.49 7568.57,-1678.3 7557.99,-1677.78 7559.97,-1684.49"/>
</g>
<!-- tp_13_12 -->
<g id="node983" class="node">
<title>tp_13_12</title>
<ellipse fill="lightblue" stroke="black" cx="5962" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5962" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L13</text>
<text text-anchor="middle" x="5962" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 424↔425</text>
<text text-anchor="middle" x="5962" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5962" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_12_0&#45;&gt;tp_13_12 -->
<g id="edge1191" class="edge">
<title>expert_13_12_0&#45;&gt;tp_13_12</title>
<path fill="none" stroke="black" d="M7206.16,-1634.96C7203.42,-1634.7 7200.7,-1634.45 7198,-1634.21 6705.84,-1591.21 6576.58,-1664.41 6087,-1598.21 6075.42,-1596.64 6063.35,-1594.46 6051.48,-1591.98"/>
<polygon fill="black" stroke="black" points="6052.08,-1588.52 6041.56,-1589.83 6050.59,-1595.37 6052.08,-1588.52"/>
</g>
<!-- expert_13_12_1&#45;&gt;tp_13_12 -->
<g id="edge1192" class="edge">
<title>expert_13_12_1&#45;&gt;tp_13_12</title>
<path fill="none" stroke="black" d="M7501.16,-1634.94C7498.42,-1634.68 7495.7,-1634.44 7493,-1634.21 6870.1,-1581.92 6706.74,-1679.86 6087,-1598.21 6075.33,-1596.67 6063.16,-1594.49 6051.2,-1592"/>
<polygon fill="black" stroke="black" points="6051.73,-1588.53 6041.21,-1589.83 6050.25,-1595.37 6051.73,-1588.53"/>
</g>
<!-- tp_13_12&#45;&gt;q_proj_14 -->
<g id="edge2040" class="edge">
<title>tp_13_12&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M5894.71,-1541.69C5876.25,-1536.07 5856.06,-1530.89 5837,-1527.98 5709.91,-1508.59 4806.85,-1540.89 4680,-1519.98 4647.04,-1514.55 4611.61,-1503.32 4582.76,-1492.67"/>
<polygon fill="black" stroke="black" points="4583.84,-1489.34 4573.25,-1489.1 4581.37,-1495.89 4583.84,-1489.34"/>
</g>
<!-- tp_13_12&#45;&gt;k_proj_14 -->
<g id="edge2041" class="edge">
<title>tp_13_12&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M5892.57,-1542.12C5874.65,-1536.71 5855.26,-1531.53 5837,-1527.98 5658.24,-1493.31 5449.35,-1478.66 5309.47,-1472.48"/>
<polygon fill="black" stroke="black" points="5309.24,-1468.96 5299.1,-1472.03 5308.94,-1475.96 5309.24,-1468.96"/>
</g>
<!-- tp_13_12&#45;&gt;v_proj_14 -->
<g id="edge2042" class="edge">
<title>tp_13_12&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M5894.7,-1541.73C5876.24,-1536.11 5856.06,-1530.92 5837,-1527.98 5744.42,-1513.74 5086.4,-1535.34 4994,-1519.98 4961.04,-1514.51 4925.62,-1503.27 4896.77,-1492.64"/>
<polygon fill="black" stroke="black" points="4897.84,-1489.3 4887.25,-1489.06 4895.38,-1495.85 4897.84,-1489.3"/>
</g>
<!-- expert_13_13_0 -->
<g id="node985" class="node">
<title>expert_13_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8073.5,-1678.21 7796.5,-1678.21 7796.5,-1634.21 8073.5,-1634.21 8073.5,-1678.21"/>
<text text-anchor="middle" x="7935" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L13</text>
<text text-anchor="middle" x="7935" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 426</text>
<text text-anchor="middle" x="7935" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7935" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_13&#45;&gt;expert_13_13_0 -->
<g id="edge1194" class="edge">
<title>route_13_13&#45;&gt;expert_13_13_0</title>
<path fill="none" stroke="black" d="M7935,-1713.86C7935,-1705.58 7935,-1696.6 7935,-1688.29"/>
<polygon fill="black" stroke="black" points="7938.5,-1688.21 7935,-1678.21 7931.5,-1688.21 7938.5,-1688.21"/>
</g>
<!-- expert_13_13_1 -->
<g id="node986" class="node">
<title>expert_13_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8368.5,-1678.21 8091.5,-1678.21 8091.5,-1634.21 8368.5,-1634.21 8368.5,-1678.21"/>
<text text-anchor="middle" x="8230" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L13</text>
<text text-anchor="middle" x="8230" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 427</text>
<text text-anchor="middle" x="8230" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8230" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_13&#45;&gt;expert_13_13_1 -->
<g id="edge1195" class="edge">
<title>route_13_13&#45;&gt;expert_13_13_1</title>
<path fill="none" stroke="black" d="M8025.92,-1717.48C8065.08,-1705.91 8110.51,-1692.49 8148.56,-1681.26"/>
<polygon fill="black" stroke="black" points="8149.97,-1684.49 8158.57,-1678.3 8147.99,-1677.78 8149.97,-1684.49"/>
</g>
<!-- tp_13_13 -->
<g id="node987" class="node">
<title>tp_13_13</title>
<ellipse fill="lightblue" stroke="black" cx="6212" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6212" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L13</text>
<text text-anchor="middle" x="6212" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 426↔427</text>
<text text-anchor="middle" x="6212" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6212" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_13_0&#45;&gt;tp_13_13 -->
<g id="edge1196" class="edge">
<title>expert_13_13_0&#45;&gt;tp_13_13</title>
<path fill="none" stroke="black" d="M7796.16,-1634.94C7793.42,-1634.68 7790.7,-1634.44 7788,-1634.21 7145.15,-1580.5 6976.59,-1682.22 6337,-1598.21 6325.33,-1596.68 6313.16,-1594.5 6301.2,-1592"/>
<polygon fill="black" stroke="black" points="6301.73,-1588.54 6291.21,-1589.84 6300.25,-1595.38 6301.73,-1588.54"/>
</g>
<!-- expert_13_13_1&#45;&gt;tp_13_13 -->
<g id="edge1197" class="edge">
<title>expert_13_13_1&#45;&gt;tp_13_13</title>
<path fill="none" stroke="black" d="M8091.17,-1634.92C8088.42,-1634.67 8085.7,-1634.43 8083,-1634.21 7696.2,-1602.71 6721.88,-1647.94 6337,-1598.21 6325.33,-1596.7 6313.16,-1594.54 6301.19,-1592.05"/>
<polygon fill="black" stroke="black" points="6301.72,-1588.58 6291.21,-1589.89 6300.24,-1595.43 6301.72,-1588.58"/>
</g>
<!-- tp_13_13&#45;&gt;q_proj_14 -->
<g id="edge2043" class="edge">
<title>tp_13_13&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M6144.71,-1541.68C6126.25,-1536.06 6106.07,-1530.88 6087,-1527.98 6009.72,-1516.24 4757.13,-1532.65 4680,-1519.98 4647.03,-1514.57 4611.6,-1503.34 4582.76,-1492.69"/>
<polygon fill="black" stroke="black" points="4583.83,-1489.36 4573.24,-1489.11 4581.37,-1495.91 4583.83,-1489.36"/>
</g>
<!-- tp_13_13&#45;&gt;k_proj_14 -->
<g id="edge2044" class="edge">
<title>tp_13_13&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M6143.28,-1542.02C6125.18,-1536.55 6105.53,-1531.36 6087,-1527.98 5942.36,-1501.67 5536.1,-1482.63 5309.24,-1473.69"/>
<polygon fill="black" stroke="black" points="5309.37,-1470.19 5299.24,-1473.3 5309.1,-1477.19 5309.37,-1470.19"/>
</g>
<!-- tp_13_13&#45;&gt;v_proj_14 -->
<g id="edge2045" class="edge">
<title>tp_13_13&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M6144.71,-1541.7C6126.25,-1536.08 6106.06,-1530.9 6087,-1527.98 5966.95,-1509.64 5113.83,-1539.76 4994,-1519.98 4961.04,-1514.54 4925.61,-1503.31 4896.76,-1492.67"/>
<polygon fill="black" stroke="black" points="4897.84,-1489.33 4887.25,-1489.09 4895.38,-1495.89 4897.84,-1489.33"/>
</g>
<!-- expert_13_14_0 -->
<g id="node989" class="node">
<title>expert_13_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8663.5,-1678.21 8386.5,-1678.21 8386.5,-1634.21 8663.5,-1634.21 8663.5,-1678.21"/>
<text text-anchor="middle" x="8525" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L13</text>
<text text-anchor="middle" x="8525" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 428</text>
<text text-anchor="middle" x="8525" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8525" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_14&#45;&gt;expert_13_14_0 -->
<g id="edge1199" class="edge">
<title>route_13_14&#45;&gt;expert_13_14_0</title>
<path fill="none" stroke="black" d="M8525,-1713.86C8525,-1705.58 8525,-1696.6 8525,-1688.29"/>
<polygon fill="black" stroke="black" points="8528.5,-1688.21 8525,-1678.21 8521.5,-1688.21 8528.5,-1688.21"/>
</g>
<!-- expert_13_14_1 -->
<g id="node990" class="node">
<title>expert_13_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8958.5,-1678.21 8681.5,-1678.21 8681.5,-1634.21 8958.5,-1634.21 8958.5,-1678.21"/>
<text text-anchor="middle" x="8820" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L13</text>
<text text-anchor="middle" x="8820" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 429</text>
<text text-anchor="middle" x="8820" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8820" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_14&#45;&gt;expert_13_14_1 -->
<g id="edge1200" class="edge">
<title>route_13_14&#45;&gt;expert_13_14_1</title>
<path fill="none" stroke="black" d="M8615.92,-1717.48C8655.08,-1705.91 8700.51,-1692.49 8738.56,-1681.26"/>
<polygon fill="black" stroke="black" points="8739.97,-1684.49 8748.57,-1678.3 8737.99,-1677.78 8739.97,-1684.49"/>
</g>
<!-- tp_13_14 -->
<g id="node991" class="node">
<title>tp_13_14</title>
<ellipse fill="lightblue" stroke="black" cx="6462" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6462" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L13</text>
<text text-anchor="middle" x="6462" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 428↔429</text>
<text text-anchor="middle" x="6462" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6462" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_14_0&#45;&gt;tp_13_14 -->
<g id="edge1201" class="edge">
<title>expert_13_14_0&#45;&gt;tp_13_14</title>
<path fill="none" stroke="black" d="M8386.17,-1634.92C8383.42,-1634.67 8380.7,-1634.43 8378,-1634.21 7981.22,-1602 6981.81,-1649.12 6587,-1598.21 6575.33,-1596.7 6563.16,-1594.54 6551.19,-1592.06"/>
<polygon fill="black" stroke="black" points="6551.72,-1588.59 6541.21,-1589.9 6550.24,-1595.43 6551.72,-1588.59"/>
</g>
<!-- expert_13_14_1&#45;&gt;tp_13_14 -->
<g id="edge1202" class="edge">
<title>expert_13_14_1&#45;&gt;tp_13_14</title>
<path fill="none" stroke="black" d="M8681.17,-1634.91C8678.42,-1634.66 8675.7,-1634.43 8673,-1634.21 8210.84,-1597.36 7046.9,-1656.85 6587,-1598.21 6575.32,-1596.72 6563.15,-1594.57 6551.19,-1592.09"/>
<polygon fill="black" stroke="black" points="6551.71,-1588.62 6541.2,-1589.93 6550.24,-1595.46 6551.71,-1588.62"/>
</g>
<!-- tp_13_14&#45;&gt;q_proj_14 -->
<g id="edge2046" class="edge">
<title>tp_13_14&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M6394.71,-1541.67C6376.25,-1536.05 6356.07,-1530.87 6337,-1527.98 6245.98,-1514.19 4770.85,-1534.86 4680,-1519.98 4646.9,-1514.56 4611.33,-1503.27 4582.42,-1492.58"/>
<polygon fill="black" stroke="black" points="4583.48,-1489.24 4572.89,-1488.99 4581.01,-1495.79 4583.48,-1489.24"/>
</g>
<!-- tp_13_14&#45;&gt;k_proj_14 -->
<g id="edge2047" class="edge">
<title>tp_13_14&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M6393.64,-1541.95C6375.45,-1536.44 6355.66,-1531.25 6337,-1527.98 6144.3,-1494.26 5585.52,-1477.56 5309.33,-1471.18"/>
<polygon fill="black" stroke="black" points="5309.3,-1467.68 5299.23,-1470.95 5309.14,-1474.68 5309.3,-1467.68"/>
</g>
<!-- tp_13_14&#45;&gt;v_proj_14 -->
<g id="edge2048" class="edge">
<title>tp_13_14&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M6394.71,-1541.68C6376.25,-1536.06 6356.07,-1530.88 6337,-1527.98 6263.24,-1516.76 5067.62,-1532.09 4994,-1519.98 4961.04,-1514.57 4925.61,-1503.33 4896.76,-1492.69"/>
<polygon fill="black" stroke="black" points="4897.84,-1489.35 4887.24,-1489.11 4895.37,-1495.91 4897.84,-1489.35"/>
</g>
<!-- expert_13_15_0 -->
<g id="node993" class="node">
<title>expert_13_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9253.5,-1678.21 8976.5,-1678.21 8976.5,-1634.21 9253.5,-1634.21 9253.5,-1678.21"/>
<text text-anchor="middle" x="9115" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L13</text>
<text text-anchor="middle" x="9115" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 430</text>
<text text-anchor="middle" x="9115" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9115" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_15&#45;&gt;expert_13_15_0 -->
<g id="edge1204" class="edge">
<title>route_13_15&#45;&gt;expert_13_15_0</title>
<path fill="none" stroke="black" d="M9115,-1713.86C9115,-1705.58 9115,-1696.6 9115,-1688.29"/>
<polygon fill="black" stroke="black" points="9118.5,-1688.21 9115,-1678.21 9111.5,-1688.21 9118.5,-1688.21"/>
</g>
<!-- expert_13_15_1 -->
<g id="node994" class="node">
<title>expert_13_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9548.5,-1678.21 9271.5,-1678.21 9271.5,-1634.21 9548.5,-1634.21 9548.5,-1678.21"/>
<text text-anchor="middle" x="9410" y="-1669.01" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L13</text>
<text text-anchor="middle" x="9410" y="-1659.01" font-family="Times,serif" font-size="9.00">GPU: 431</text>
<text text-anchor="middle" x="9410" y="-1649.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9410" y="-1639.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_15&#45;&gt;expert_13_15_1 -->
<g id="edge1205" class="edge">
<title>route_13_15&#45;&gt;expert_13_15_1</title>
<path fill="none" stroke="black" d="M9205.92,-1717.48C9245.08,-1705.91 9290.51,-1692.49 9328.56,-1681.26"/>
<polygon fill="black" stroke="black" points="9329.97,-1684.49 9338.57,-1678.3 9327.99,-1677.78 9329.97,-1684.49"/>
</g>
<!-- tp_13_15 -->
<g id="node995" class="node">
<title>tp_13_15</title>
<ellipse fill="lightblue" stroke="black" cx="6712" cy="-1567.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6712" y="-1579.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L13</text>
<text text-anchor="middle" x="6712" y="-1569.9" font-family="Times,serif" font-size="9.00">GPU: 430↔431</text>
<text text-anchor="middle" x="6712" y="-1559.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6712" y="-1549.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_15_0&#45;&gt;tp_13_15 -->
<g id="edge1206" class="edge">
<title>expert_13_15_0&#45;&gt;tp_13_15</title>
<path fill="none" stroke="black" d="M8976.16,-1634.95C8973.42,-1634.69 8970.7,-1634.44 8968,-1634.21 8549.38,-1598.29 7248.95,-1576.16 6837.89,-1569.92"/>
<polygon fill="black" stroke="black" points="6837.8,-1566.42 6827.75,-1569.76 6837.7,-1573.42 6837.8,-1566.42"/>
</g>
<!-- expert_13_15_1&#45;&gt;tp_13_15 -->
<g id="edge1207" class="edge">
<title>expert_13_15_1&#45;&gt;tp_13_15</title>
<path fill="none" stroke="black" d="M9271.16,-1634.94C9268.42,-1634.68 9265.7,-1634.44 9263,-1634.21 8783.93,-1593.92 7283.66,-1574.43 6838.03,-1569.43"/>
<polygon fill="black" stroke="black" points="6838.05,-1565.93 6828.02,-1569.31 6837.98,-1572.93 6838.05,-1565.93"/>
</g>
<!-- tp_13_15&#45;&gt;q_proj_14 -->
<g id="edge2049" class="edge">
<title>tp_13_15&#45;&gt;q_proj_14</title>
<path fill="none" stroke="black" d="M6644.71,-1541.66C6626.25,-1536.04 6606.07,-1530.87 6587,-1527.98 6482.25,-1512.15 4784.56,-1537.07 4680,-1519.98 4646.9,-1514.58 4611.33,-1503.28 4582.42,-1492.59"/>
<polygon fill="black" stroke="black" points="4583.48,-1489.25 4572.89,-1489 4581.01,-1495.8 4583.48,-1489.25"/>
</g>
<!-- tp_13_15&#45;&gt;k_proj_14 -->
<g id="edge2050" class="edge">
<title>tp_13_15&#45;&gt;k_proj_14</title>
<path fill="none" stroke="black" d="M6643.66,-1541.84C6625.47,-1536.33 6605.67,-1531.17 6587,-1527.98 6345.57,-1486.83 5630.02,-1473.51 5309.44,-1469.54"/>
<polygon fill="black" stroke="black" points="5309.18,-1466.03 5299.14,-1469.41 5309.1,-1473.03 5309.18,-1466.03"/>
</g>
<!-- tp_13_15&#45;&gt;v_proj_14 -->
<g id="edge2051" class="edge">
<title>tp_13_15&#45;&gt;v_proj_14</title>
<path fill="none" stroke="black" d="M6644.71,-1541.67C6626.25,-1536.05 6606.07,-1530.88 6587,-1527.98 6499.5,-1514.72 5081.34,-1534.3 4994,-1519.98 4960.91,-1514.56 4925.33,-1503.26 4896.42,-1492.58"/>
<polygon fill="black" stroke="black" points="4897.48,-1489.24 4886.89,-1488.99 4895.01,-1495.79 4897.48,-1489.24"/>
</g>
<!-- attn_scores_14 -->
<g id="node999" class="node">
<title>attn_scores_14</title>
<polygon fill="lightgreen" stroke="black" points="5003.5,-1408.98 4670.5,-1408.98 4670.5,-1364.98 5003.5,-1364.98 5003.5,-1408.98"/>
<text text-anchor="middle" x="4837" y="-1399.78" font-family="Times,serif" font-size="9.00">Attention Scores L14</text>
<text text-anchor="middle" x="4837" y="-1389.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4837" y="-1379.78" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-1369.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_14&#45;&gt;attn_scores_14 -->
<g id="edge1208" class="edge">
<title>q_proj_14&#45;&gt;attn_scores_14</title>
<path fill="none" stroke="black" d="M4607.56,-1444.98C4649.18,-1434.64 4699.51,-1422.14 4742.41,-1411.48"/>
<polygon fill="black" stroke="black" points="4743.43,-1414.84 4752.29,-1409.03 4741.74,-1408.04 4743.43,-1414.84"/>
</g>
<!-- k_proj_14&#45;&gt;attn_scores_14 -->
<g id="edge1209" class="edge">
<title>k_proj_14&#45;&gt;attn_scores_14</title>
<path fill="none" stroke="black" d="M5066.44,-1444.98C5024.82,-1434.64 4974.49,-1422.14 4931.59,-1411.48"/>
<polygon fill="black" stroke="black" points="4932.26,-1408.04 4921.71,-1409.03 4930.57,-1414.84 4932.26,-1408.04"/>
</g>
<!-- v_proj_14&#45;&gt;attn_scores_14 -->
<g id="edge1210" class="edge">
<title>v_proj_14&#45;&gt;attn_scores_14</title>
<path fill="none" stroke="black" d="M4837,-1444.67C4837,-1436.78 4837,-1427.67 4837,-1419.09"/>
<polygon fill="black" stroke="black" points="4840.5,-1419 4837,-1409 4833.5,-1419 4840.5,-1419"/>
</g>
<!-- softmax_14 -->
<g id="node1000" class="node">
<title>softmax_14</title>
<polygon fill="lightgreen" stroke="black" points="5003.5,-1328.98 4670.5,-1328.98 4670.5,-1284.98 5003.5,-1284.98 5003.5,-1328.98"/>
<text text-anchor="middle" x="4837" y="-1319.78" font-family="Times,serif" font-size="9.00">Softmax L14</text>
<text text-anchor="middle" x="4837" y="-1309.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4837" y="-1299.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4837" y="-1289.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_14&#45;&gt;softmax_14 -->
<g id="edge1211" class="edge">
<title>attn_scores_14&#45;&gt;softmax_14</title>
<path fill="none" stroke="black" d="M4837,-1364.67C4837,-1356.78 4837,-1347.67 4837,-1339.09"/>
<polygon fill="black" stroke="black" points="4840.5,-1339 4837,-1329 4833.5,-1339 4840.5,-1339"/>
</g>
<!-- attn_out_14 -->
<g id="node1001" class="node">
<title>attn_out_14</title>
<polygon fill="lightgreen" stroke="black" points="4985,-1248.98 4689,-1248.98 4689,-1204.98 4985,-1204.98 4985,-1248.98"/>
<text text-anchor="middle" x="4837" y="-1239.78" font-family="Times,serif" font-size="9.00">Attention Output L14</text>
<text text-anchor="middle" x="4837" y="-1229.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4837" y="-1219.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-1209.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_14&#45;&gt;attn_out_14 -->
<g id="edge1212" class="edge">
<title>softmax_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M4837,-1284.67C4837,-1276.78 4837,-1267.67 4837,-1259.09"/>
<polygon fill="black" stroke="black" points="4840.5,-1259 4837,-1249 4833.5,-1259 4840.5,-1259"/>
</g>
<!-- gate_14 -->
<g id="node1002" class="node">
<title>gate_14</title>
<polygon fill="lightyellow" stroke="black" points="5136.74,-1168.98 4659.92,-1168.98 4537.26,-1080.98 5014.08,-1080.98 5136.74,-1168.98"/>
<text text-anchor="middle" x="4837" y="-1137.78" font-family="Times,serif" font-size="9.00">Gate L14</text>
<text text-anchor="middle" x="4837" y="-1127.78" font-family="Times,serif" font-size="9.00">GPU: 448&#45;511</text>
<text text-anchor="middle" x="4837" y="-1117.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4837" y="-1107.78" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_14&#45;&gt;gate_14 -->
<g id="edge1213" class="edge">
<title>attn_out_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M4837,-1204.78C4837,-1197.28 4837,-1188.47 4837,-1179.51"/>
<polygon fill="black" stroke="black" points="4840.5,-1179.39 4837,-1169.39 4833.5,-1179.39 4840.5,-1179.39"/>
</g>
<!-- route_14_0 -->
<g id="node1003" class="node">
<title>route_14_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="644" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="644" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="644" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="644" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="644" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_0 -->
<g id="edge1214" class="edge">
<title>gate_14&#45;&gt;route_14_0</title>
<path fill="none" stroke="black" d="M4597.03,-1123.87C3995.33,-1122.53 2373.87,-1112.4 1024,-1044.98 958.75,-1041.73 887.32,-1036.5 824.17,-1031.31"/>
<polygon fill="black" stroke="black" points="824.36,-1027.82 814.11,-1030.48 823.79,-1034.8 824.36,-1027.82"/>
</g>
<!-- route_14_1 -->
<g id="node1007" class="node">
<title>route_14_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1234" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1234" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1234" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 450,451</text>
<text text-anchor="middle" x="1234" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1234" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_1 -->
<g id="edge1219" class="edge">
<title>gate_14&#45;&gt;route_14_1</title>
<path fill="none" stroke="black" d="M4595,-1122.56C4058.13,-1118.41 2726.87,-1102.67 1614,-1044.98 1548.91,-1041.61 1477.67,-1036.38 1414.63,-1031.21"/>
<polygon fill="black" stroke="black" points="1414.84,-1027.72 1404.59,-1030.38 1414.27,-1034.69 1414.84,-1027.72"/>
</g>
<!-- route_14_2 -->
<g id="node1011" class="node">
<title>route_14_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1824" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1824" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1824" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 452,453</text>
<text text-anchor="middle" x="1824" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1824" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_2 -->
<g id="edge1224" class="edge">
<title>gate_14&#45;&gt;route_14_2</title>
<path fill="none" stroke="black" d="M4592.26,-1120.65C4126.84,-1113.42 3082.18,-1092.93 2204,-1044.98 2139.08,-1041.44 2068.02,-1036.18 2005.1,-1031.05"/>
<polygon fill="black" stroke="black" points="2005.33,-1027.55 1995.07,-1030.22 2004.75,-1034.53 2005.33,-1027.55"/>
</g>
<!-- route_14_3 -->
<g id="node1015" class="node">
<title>route_14_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2414" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2414" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2414" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 454,455</text>
<text text-anchor="middle" x="2414" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2414" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_3 -->
<g id="edge1229" class="edge">
<title>gate_14&#45;&gt;route_14_3</title>
<path fill="none" stroke="black" d="M4588,-1117.6C4203.08,-1107 3440.45,-1083.08 2794,-1044.98 2729.41,-1041.18 2658.73,-1035.89 2596.03,-1030.8"/>
<polygon fill="black" stroke="black" points="2596.29,-1027.31 2586.04,-1029.99 2595.72,-1034.29 2596.29,-1027.31"/>
</g>
<!-- route_14_4 -->
<g id="node1019" class="node">
<title>route_14_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3004" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3004" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="3004" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 456,457</text>
<text text-anchor="middle" x="3004" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3004" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_4 -->
<g id="edge1234" class="edge">
<title>gate_14&#45;&gt;route_14_4</title>
<path fill="none" stroke="black" d="M4580.32,-1111.95C4289.89,-1097.89 3802.75,-1072.96 3384,-1044.98 3320.2,-1040.72 3250.43,-1035.39 3188.28,-1030.4"/>
<polygon fill="black" stroke="black" points="3188.22,-1026.88 3177.97,-1029.57 3187.66,-1033.86 3188.22,-1026.88"/>
</g>
<!-- route_14_5 -->
<g id="node1023" class="node">
<title>route_14_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3594" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3594" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3594" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 458,459</text>
<text text-anchor="middle" x="3594" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3594" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_5 -->
<g id="edge1239" class="edge">
<title>gate_14&#45;&gt;route_14_5</title>
<path fill="none" stroke="black" d="M4563.45,-1099.97C4324.16,-1078.97 3983.34,-1049.05 3776.05,-1030.85"/>
<polygon fill="black" stroke="black" points="3776.24,-1027.36 3765.98,-1029.97 3775.63,-1034.33 3776.24,-1027.36"/>
</g>
<!-- route_14_6 -->
<g id="node1027" class="node">
<title>route_14_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4184" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4184" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4184" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 460,461</text>
<text text-anchor="middle" x="4184" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4184" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_6 -->
<g id="edge1244" class="edge">
<title>gate_14&#45;&gt;route_14_6</title>
<path fill="none" stroke="black" d="M4579.39,-1080.94C4493.88,-1066.65 4401.76,-1051.26 4327.97,-1038.93"/>
<polygon fill="black" stroke="black" points="4328.13,-1035.41 4317.69,-1037.21 4326.97,-1042.31 4328.13,-1035.41"/>
</g>
<!-- route_14_7 -->
<g id="node1031" class="node">
<title>route_14_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4712" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4712" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4712" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 462,463</text>
<text text-anchor="middle" x="4712" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4712" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_7 -->
<g id="edge1249" class="edge">
<title>gate_14&#45;&gt;route_14_7</title>
<path fill="none" stroke="black" d="M4787.6,-1080.86C4776.39,-1071.08 4764.6,-1060.79 4753.76,-1051.32"/>
<polygon fill="black" stroke="black" points="4755.88,-1048.53 4746.04,-1044.59 4751.28,-1053.8 4755.88,-1048.53"/>
</g>
<!-- route_14_8 -->
<g id="node1035" class="node">
<title>route_14_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5132" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5132" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5132" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="5132" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5132" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_8 -->
<g id="edge1254" class="edge">
<title>gate_14&#45;&gt;route_14_8</title>
<path fill="none" stroke="black" d="M4953.59,-1080.86C4984.7,-1069.35 5017.73,-1057.14 5046.8,-1046.38"/>
<polygon fill="black" stroke="black" points="5048.34,-1049.55 5056.5,-1042.8 5045.91,-1042.98 5048.34,-1049.55"/>
</g>
<!-- route_14_9 -->
<g id="node1039" class="node">
<title>route_14_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5659" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5659" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5659" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 482,483</text>
<text text-anchor="middle" x="5659" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5659" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_9 -->
<g id="edge1259" class="edge">
<title>gate_14&#45;&gt;route_14_9</title>
<path fill="none" stroke="black" d="M5037.03,-1097.43C5179.11,-1078.57 5367.32,-1053.59 5499.36,-1036.06"/>
<polygon fill="black" stroke="black" points="5500.11,-1039.49 5509.56,-1034.71 5499.19,-1032.56 5500.11,-1039.49"/>
</g>
<!-- route_14_10 -->
<g id="node1043" class="node">
<title>route_14_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6249" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6249" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6249" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 484,485</text>
<text text-anchor="middle" x="6249" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6249" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_10 -->
<g id="edge1264" class="edge">
<title>gate_14&#45;&gt;route_14_10</title>
<path fill="none" stroke="black" d="M5051.47,-1107.74C5260.21,-1091.88 5586.39,-1067 5869,-1044.98 5932.12,-1040.07 6001.14,-1034.62 6062.83,-1029.73"/>
<polygon fill="black" stroke="black" points="6063.37,-1033.19 6073.06,-1028.91 6062.82,-1026.22 6063.37,-1033.19"/>
</g>
<!-- route_14_11 -->
<g id="node1047" class="node">
<title>route_14_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6839" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6839" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6839" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 486,487</text>
<text text-anchor="middle" x="6839" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6839" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_11 -->
<g id="edge1269" class="edge">
<title>gate_14&#45;&gt;route_14_11</title>
<path fill="none" stroke="black" d="M5061.79,-1115.2C5375.02,-1102.46 5960.47,-1076.87 6459,-1044.98 6523.13,-1040.88 6593.27,-1035.56 6655.65,-1030.53"/>
<polygon fill="black" stroke="black" points="6656.3,-1033.99 6665.99,-1029.7 6655.74,-1027.02 6656.3,-1033.99"/>
</g>
<!-- route_14_12 -->
<g id="node1051" class="node">
<title>route_14_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7429" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7429" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7429" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 488,489</text>
<text text-anchor="middle" x="7429" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7429" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_12 -->
<g id="edge1274" class="edge">
<title>gate_14&#45;&gt;route_14_12</title>
<path fill="none" stroke="black" d="M5067.23,-1119.05C5469.48,-1109.7 6326.32,-1086.5 7049,-1044.98 7113.75,-1041.26 7184.62,-1035.98 7247.43,-1030.87"/>
<polygon fill="black" stroke="black" points="7247.76,-1034.36 7257.44,-1030.05 7247.19,-1027.38 7247.76,-1034.36"/>
</g>
<!-- route_14_13 -->
<g id="node1055" class="node">
<title>route_14_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8019" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8019" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="8019" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 490,491</text>
<text text-anchor="middle" x="8019" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8019" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_13 -->
<g id="edge1279" class="edge">
<title>gate_14&#45;&gt;route_14_13</title>
<path fill="none" stroke="black" d="M5070.56,-1121.41C5551.5,-1115.24 6687.14,-1096.08 7639,-1044.98 7703.92,-1041.5 7774.98,-1036.25 7837.9,-1031.11"/>
<polygon fill="black" stroke="black" points="7838.25,-1034.6 7847.93,-1030.29 7837.68,-1027.62 7838.25,-1034.6"/>
</g>
<!-- route_14_14 -->
<g id="node1059" class="node">
<title>route_14_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8609" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8609" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8609" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 492,493</text>
<text text-anchor="middle" x="8609" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8609" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_14 -->
<g id="edge1284" class="edge">
<title>gate_14&#45;&gt;route_14_14</title>
<path fill="none" stroke="black" d="M5072.86,-1123.02C5625.01,-1119.76 7044.54,-1105.66 8229,-1044.98 8294.09,-1041.65 8365.33,-1036.43 8428.37,-1031.26"/>
<polygon fill="black" stroke="black" points="8428.73,-1034.74 8438.41,-1030.43 8428.16,-1027.76 8428.73,-1034.74"/>
</g>
<!-- route_14_15 -->
<g id="node1063" class="node">
<title>route_14_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9199" cy="-1013.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9199" y="-1026.67" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9199" y="-1016.67" font-family="Times,serif" font-size="9.00">GPU: 494,495</text>
<text text-anchor="middle" x="9199" y="-1006.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9199" y="-996.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_15 -->
<g id="edge1289" class="edge">
<title>gate_14&#45;&gt;route_14_15</title>
<path fill="none" stroke="black" d="M5074.49,-1124.18C5692.11,-1123.61 7399.36,-1115.25 8819,-1044.98 8884.25,-1041.76 8955.69,-1036.54 9018.83,-1031.35"/>
<polygon fill="black" stroke="black" points="9019.21,-1034.83 9028.89,-1030.51 9018.64,-1027.85 9019.21,-1034.83"/>
</g>
<!-- expert_14_0_0 -->
<g id="node1004" class="node">
<title>expert_14_0_0</title>
<polygon fill="lightgreen" stroke="black" points="487.5,-946.76 210.5,-946.76 210.5,-902.76 487.5,-902.76 487.5,-946.76"/>
<text text-anchor="middle" x="349" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L14</text>
<text text-anchor="middle" x="349" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="349" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="349" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_0&#45;&gt;expert_14_0_0 -->
<g id="edge1215" class="edge">
<title>route_14_0&#45;&gt;expert_14_0_0</title>
<path fill="none" stroke="black" d="M553.08,-986.02C513.92,-974.46 468.49,-961.04 430.44,-949.81"/>
<polygon fill="black" stroke="black" points="431.01,-946.33 420.43,-946.85 429.03,-953.04 431.01,-946.33"/>
</g>
<!-- expert_14_0_1 -->
<g id="node1005" class="node">
<title>expert_14_0_1</title>
<polygon fill="lightgreen" stroke="black" points="782.5,-946.76 505.5,-946.76 505.5,-902.76 782.5,-902.76 782.5,-946.76"/>
<text text-anchor="middle" x="644" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L14</text>
<text text-anchor="middle" x="644" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="644" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="644" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_0&#45;&gt;expert_14_0_1 -->
<g id="edge1216" class="edge">
<title>route_14_0&#45;&gt;expert_14_0_1</title>
<path fill="none" stroke="black" d="M644,-982.4C644,-974.12 644,-965.15 644,-956.84"/>
<polygon fill="black" stroke="black" points="647.5,-956.76 644,-946.76 640.5,-956.76 647.5,-956.76"/>
</g>
<!-- tp_14_0 -->
<g id="node1006" class="node">
<title>tp_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="3046" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3046" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L14</text>
<text text-anchor="middle" x="3046" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="3046" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3046" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_0_0&#45;&gt;tp_14_0 -->
<g id="edge1217" class="edge">
<title>expert_14_0_0&#45;&gt;tp_14_0</title>
<path fill="none" stroke="black" d="M487.6,-903.6C490.76,-903.3 493.9,-903.02 497,-902.76 975.71,-862.72 2474.79,-843.05 2920.07,-837.99"/>
<polygon fill="black" stroke="black" points="2920.12,-841.49 2930.08,-837.88 2920.04,-834.49 2920.12,-841.49"/>
</g>
<!-- expert_14_0_1&#45;&gt;tp_14_0 -->
<g id="edge1218" class="edge">
<title>expert_14_0_1&#45;&gt;tp_14_0</title>
<path fill="none" stroke="black" d="M782.6,-903.62C785.76,-903.31 788.9,-903.02 792,-902.76 1210.26,-867.06 2509.54,-844.78 2920.23,-838.48"/>
<polygon fill="black" stroke="black" points="2920.41,-841.98 2930.35,-838.33 2920.3,-834.98 2920.41,-841.98"/>
</g>
<!-- q_proj_15 -->
<g id="node1067" class="node">
<title>q_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="5069,-768.53 4773,-768.53 4773,-724.53 5069,-724.53 5069,-768.53"/>
<text text-anchor="middle" x="4921" y="-759.33" font-family="Times,serif" font-size="9.00">Q Projection L15</text>
<text text-anchor="middle" x="4921" y="-749.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4921" y="-739.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4921" y="-729.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_14_0&#45;&gt;q_proj_15 -->
<g id="edge2052" class="edge">
<title>tp_14_0&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M3125.21,-812.88C3140.31,-809.49 3156.06,-806.48 3171,-804.53 3518.87,-759.23 4394.53,-795.36 4762.51,-768.58"/>
<polygon fill="black" stroke="black" points="4763,-772.05 4772.71,-767.81 4762.48,-765.07 4763,-772.05"/>
</g>
<!-- k_proj_15 -->
<g id="node1068" class="node">
<title>k_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="5383,-768.53 5087,-768.53 5087,-724.53 5383,-724.53 5383,-768.53"/>
<text text-anchor="middle" x="5235" y="-759.33" font-family="Times,serif" font-size="9.00">K Projection L15</text>
<text text-anchor="middle" x="5235" y="-749.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="5235" y="-739.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5235" y="-729.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_14_0&#45;&gt;k_proj_15 -->
<g id="edge2053" class="edge">
<title>tp_14_0&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M3125.2,-812.83C3140.3,-809.45 3156.06,-806.45 3171,-804.53 3588.12,-751 4638.78,-799.91 5076.49,-768.58"/>
<polygon fill="black" stroke="black" points="5077,-772.05 5086.71,-767.83 5076.48,-765.07 5077,-772.05"/>
</g>
<!-- v_proj_15 -->
<g id="node1069" class="node">
<title>v_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="4755,-768.53 4459,-768.53 4459,-724.53 4755,-724.53 4755,-768.53"/>
<text text-anchor="middle" x="4607" y="-759.33" font-family="Times,serif" font-size="9.00">V Projection L15</text>
<text text-anchor="middle" x="4607" y="-749.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4607" y="-739.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4607" y="-729.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_14_0&#45;&gt;v_proj_15 -->
<g id="edge2054" class="edge">
<title>tp_14_0&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M3125.57,-813.01C3140.56,-809.64 3156.19,-806.59 3171,-804.53 3413.49,-770.85 4128.06,-755.31 4448.44,-749.9"/>
<polygon fill="black" stroke="black" points="4448.79,-753.39 4458.73,-749.72 4448.68,-746.39 4448.79,-753.39"/>
</g>
<!-- expert_14_1_0 -->
<g id="node1008" class="node">
<title>expert_14_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1077.5,-946.76 800.5,-946.76 800.5,-902.76 1077.5,-902.76 1077.5,-946.76"/>
<text text-anchor="middle" x="939" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L14</text>
<text text-anchor="middle" x="939" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 450</text>
<text text-anchor="middle" x="939" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="939" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_1&#45;&gt;expert_14_1_0 -->
<g id="edge1220" class="edge">
<title>route_14_1&#45;&gt;expert_14_1_0</title>
<path fill="none" stroke="black" d="M1143.08,-986.02C1103.92,-974.46 1058.49,-961.04 1020.44,-949.81"/>
<polygon fill="black" stroke="black" points="1021.01,-946.33 1010.43,-946.85 1019.03,-953.04 1021.01,-946.33"/>
</g>
<!-- expert_14_1_1 -->
<g id="node1009" class="node">
<title>expert_14_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1372.5,-946.76 1095.5,-946.76 1095.5,-902.76 1372.5,-902.76 1372.5,-946.76"/>
<text text-anchor="middle" x="1234" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L14</text>
<text text-anchor="middle" x="1234" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 451</text>
<text text-anchor="middle" x="1234" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1234" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_1&#45;&gt;expert_14_1_1 -->
<g id="edge1221" class="edge">
<title>route_14_1&#45;&gt;expert_14_1_1</title>
<path fill="none" stroke="black" d="M1234,-982.4C1234,-974.12 1234,-965.15 1234,-956.84"/>
<polygon fill="black" stroke="black" points="1237.5,-956.76 1234,-946.76 1230.5,-956.76 1237.5,-956.76"/>
</g>
<!-- tp_14_1 -->
<g id="node1010" class="node">
<title>tp_14_1</title>
<ellipse fill="lightblue" stroke="black" cx="3296" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3296" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L14</text>
<text text-anchor="middle" x="3296" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 450↔451</text>
<text text-anchor="middle" x="3296" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3296" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_1_0&#45;&gt;tp_14_1 -->
<g id="edge1222" class="edge">
<title>expert_14_1_0&#45;&gt;tp_14_1</title>
<path fill="none" stroke="black" d="M1077.59,-903.56C1080.76,-903.27 1083.9,-903.01 1087,-902.76 1548.73,-866.15 2711.54,-925.35 3171,-866.76 3182.68,-865.27 3194.85,-863.12 3206.81,-860.64"/>
<polygon fill="black" stroke="black" points="3207.76,-864.01 3216.8,-858.48 3206.29,-857.17 3207.76,-864.01"/>
</g>
<!-- expert_14_1_1&#45;&gt;tp_14_1 -->
<g id="edge1223" class="edge">
<title>expert_14_1_1&#45;&gt;tp_14_1</title>
<path fill="none" stroke="black" d="M1372.6,-903.58C1375.76,-903.28 1378.9,-903.01 1382,-902.76 1778.35,-870.77 2776.63,-917.62 3171,-866.76 3182.67,-865.25 3194.84,-863.09 3206.81,-860.6"/>
<polygon fill="black" stroke="black" points="3207.76,-863.98 3216.79,-858.45 3206.28,-857.14 3207.76,-863.98"/>
</g>
<!-- tp_14_1&#45;&gt;q_proj_15 -->
<g id="edge2055" class="edge">
<title>tp_14_1&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M3375.55,-812.85C3390.55,-809.49 3406.17,-806.5 3421,-804.53 4009.62,-726.62 4167.04,-815.18 4762.58,-768.6"/>
<polygon fill="black" stroke="black" points="4763.02,-772.07 4772.71,-767.8 4762.47,-765.1 4763.02,-772.07"/>
</g>
<!-- tp_14_1&#45;&gt;k_proj_15 -->
<g id="edge2056" class="edge">
<title>tp_14_1&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M3375.21,-812.86C3390.3,-809.48 3406.06,-806.47 3421,-804.53 3783.04,-757.55 4694.58,-796.3 5076.67,-768.57"/>
<polygon fill="black" stroke="black" points="5077,-772.05 5086.71,-767.82 5076.48,-765.07 5077,-772.05"/>
</g>
<!-- tp_14_1&#45;&gt;v_proj_15 -->
<g id="edge2057" class="edge">
<title>tp_14_1&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M3375.92,-813.03C3390.81,-809.68 3406.31,-806.64 3421,-804.53 3614.63,-776.81 4172.96,-758.87 4448.85,-751.44"/>
<polygon fill="black" stroke="black" points="4449.05,-754.93 4458.95,-751.17 4448.86,-747.94 4449.05,-754.93"/>
</g>
<!-- expert_14_2_0 -->
<g id="node1012" class="node">
<title>expert_14_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1667.5,-946.76 1390.5,-946.76 1390.5,-902.76 1667.5,-902.76 1667.5,-946.76"/>
<text text-anchor="middle" x="1529" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L14</text>
<text text-anchor="middle" x="1529" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 452</text>
<text text-anchor="middle" x="1529" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1529" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_2&#45;&gt;expert_14_2_0 -->
<g id="edge1225" class="edge">
<title>route_14_2&#45;&gt;expert_14_2_0</title>
<path fill="none" stroke="black" d="M1733.08,-986.02C1693.92,-974.46 1648.49,-961.04 1610.44,-949.81"/>
<polygon fill="black" stroke="black" points="1611.01,-946.33 1600.43,-946.85 1609.03,-953.04 1611.01,-946.33"/>
</g>
<!-- expert_14_2_1 -->
<g id="node1013" class="node">
<title>expert_14_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1962.5,-946.76 1685.5,-946.76 1685.5,-902.76 1962.5,-902.76 1962.5,-946.76"/>
<text text-anchor="middle" x="1824" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L14</text>
<text text-anchor="middle" x="1824" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 453</text>
<text text-anchor="middle" x="1824" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1824" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_2&#45;&gt;expert_14_2_1 -->
<g id="edge1226" class="edge">
<title>route_14_2&#45;&gt;expert_14_2_1</title>
<path fill="none" stroke="black" d="M1824,-982.4C1824,-974.12 1824,-965.15 1824,-956.84"/>
<polygon fill="black" stroke="black" points="1827.5,-956.76 1824,-946.76 1820.5,-956.76 1827.5,-956.76"/>
</g>
<!-- tp_14_2 -->
<g id="node1014" class="node">
<title>tp_14_2</title>
<ellipse fill="lightblue" stroke="black" cx="3546" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3546" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L14</text>
<text text-anchor="middle" x="3546" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 452↔453</text>
<text text-anchor="middle" x="3546" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3546" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_2_0&#45;&gt;tp_14_2 -->
<g id="edge1227" class="edge">
<title>expert_14_2_0&#45;&gt;tp_14_2</title>
<path fill="none" stroke="black" d="M1667.6,-903.58C1670.76,-903.28 1673.9,-903.01 1677,-902.76 2063.37,-871.47 3036.56,-916.44 3421,-866.76 3432.67,-865.25 3444.84,-863.09 3456.81,-860.6"/>
<polygon fill="black" stroke="black" points="3457.76,-863.97 3466.79,-858.44 3456.28,-857.13 3457.76,-863.97"/>
</g>
<!-- expert_14_2_1&#45;&gt;tp_14_2 -->
<g id="edge1228" class="edge">
<title>expert_14_2_1&#45;&gt;tp_14_2</title>
<path fill="none" stroke="black" d="M1962.6,-903.6C1965.76,-903.3 1968.9,-903.02 1972,-902.76 2613.99,-849.42 2782.29,-950.66 3421,-866.76 3432.67,-865.23 3444.84,-863.05 3456.8,-860.55"/>
<polygon fill="black" stroke="black" points="3457.75,-863.93 3466.79,-858.39 3456.27,-857.09 3457.75,-863.93"/>
</g>
<!-- tp_14_2&#45;&gt;q_proj_15 -->
<g id="edge2058" class="edge">
<title>tp_14_2&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M3625.56,-812.93C3640.55,-809.56 3656.18,-806.54 3671,-804.53 4149.35,-739.73 4277.88,-807.86 4762.65,-768.6"/>
<polygon fill="black" stroke="black" points="4763.03,-772.08 4772.71,-767.77 4762.46,-765.1 4763.03,-772.08"/>
</g>
<!-- tp_14_2&#45;&gt;k_proj_15 -->
<g id="edge2059" class="edge">
<title>tp_14_2&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M3625.21,-812.91C3640.31,-809.53 3656.06,-806.5 3671,-804.53 4287.85,-723.27 4452.66,-817.05 5076.56,-768.6"/>
<polygon fill="black" stroke="black" points="5077.02,-772.07 5086.71,-767.8 5076.47,-765.09 5077.02,-772.07"/>
</g>
<!-- tp_14_2&#45;&gt;v_proj_15 -->
<g id="edge2060" class="edge">
<title>tp_14_2&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M3626.28,-813.11C3641.06,-809.77 3656.43,-806.72 3671,-804.53 3942.14,-763.94 4261.59,-752.09 4448.46,-748.73"/>
<polygon fill="black" stroke="black" points="4448.7,-752.23 4458.64,-748.55 4448.58,-745.23 4448.7,-752.23"/>
</g>
<!-- expert_14_3_0 -->
<g id="node1016" class="node">
<title>expert_14_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2257.5,-946.76 1980.5,-946.76 1980.5,-902.76 2257.5,-902.76 2257.5,-946.76"/>
<text text-anchor="middle" x="2119" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L14</text>
<text text-anchor="middle" x="2119" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 454</text>
<text text-anchor="middle" x="2119" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2119" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_3&#45;&gt;expert_14_3_0 -->
<g id="edge1230" class="edge">
<title>route_14_3&#45;&gt;expert_14_3_0</title>
<path fill="none" stroke="black" d="M2323.08,-986.02C2283.92,-974.46 2238.49,-961.04 2200.44,-949.81"/>
<polygon fill="black" stroke="black" points="2201.01,-946.33 2190.43,-946.85 2199.03,-953.04 2201.01,-946.33"/>
</g>
<!-- expert_14_3_1 -->
<g id="node1017" class="node">
<title>expert_14_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2552.5,-946.76 2275.5,-946.76 2275.5,-902.76 2552.5,-902.76 2552.5,-946.76"/>
<text text-anchor="middle" x="2414" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L14</text>
<text text-anchor="middle" x="2414" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 455</text>
<text text-anchor="middle" x="2414" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2414" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_3&#45;&gt;expert_14_3_1 -->
<g id="edge1231" class="edge">
<title>route_14_3&#45;&gt;expert_14_3_1</title>
<path fill="none" stroke="black" d="M2414,-982.4C2414,-974.12 2414,-965.15 2414,-956.84"/>
<polygon fill="black" stroke="black" points="2417.5,-956.76 2414,-946.76 2410.5,-956.76 2417.5,-956.76"/>
</g>
<!-- tp_14_3 -->
<g id="node1018" class="node">
<title>tp_14_3</title>
<ellipse fill="lightblue" stroke="black" cx="3796" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3796" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L14</text>
<text text-anchor="middle" x="3796" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 454↔455</text>
<text text-anchor="middle" x="3796" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3796" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_3_0&#45;&gt;tp_14_3 -->
<g id="edge1232" class="edge">
<title>expert_14_3_0&#45;&gt;tp_14_3</title>
<path fill="none" stroke="black" d="M2257.6,-903.6C2260.76,-903.3 2263.9,-903.02 2267,-902.76 2889.04,-850.83 3052.14,-948.31 3671,-866.76 3682.67,-865.22 3694.84,-863.04 3706.8,-860.54"/>
<polygon fill="black" stroke="black" points="3707.75,-863.92 3716.79,-858.38 3706.27,-857.08 3707.75,-863.92"/>
</g>
<!-- expert_14_3_1&#45;&gt;tp_14_3 -->
<g id="edge1233" class="edge">
<title>expert_14_3_1&#45;&gt;tp_14_3</title>
<path fill="none" stroke="black" d="M2552.6,-903.63C2555.76,-903.32 2558.9,-903.03 2562,-902.76 3053.3,-860.06 3182.3,-932.85 3671,-866.76 3682.58,-865.19 3694.65,-863.01 3706.52,-860.52"/>
<polygon fill="black" stroke="black" points="3707.41,-863.91 3716.44,-858.37 3705.92,-857.07 3707.41,-863.91"/>
</g>
<!-- tp_14_3&#45;&gt;q_proj_15 -->
<g id="edge2061" class="edge">
<title>tp_14_3&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M3875.91,-812.97C3890.8,-809.62 3906.3,-806.6 3921,-804.53 4289.1,-752.83 4388.69,-800.57 4762.69,-768.6"/>
<polygon fill="black" stroke="black" points="4763.05,-772.08 4772.71,-767.73 4762.44,-765.11 4763.05,-772.08"/>
</g>
<!-- tp_14_3&#45;&gt;k_proj_15 -->
<g id="edge2062" class="edge">
<title>tp_14_3&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M3875.56,-812.9C3890.55,-809.54 3906.18,-806.53 3921,-804.53 4427.52,-736.38 4563.47,-809.71 5076.45,-768.61"/>
<polygon fill="black" stroke="black" points="5077.03,-772.08 5086.71,-767.78 5076.46,-765.1 5077.03,-772.08"/>
</g>
<!-- tp_14_3&#45;&gt;v_proj_15 -->
<g id="edge2063" class="edge">
<title>tp_14_3&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M3876.99,-813.22C3891.57,-809.92 3906.68,-806.84 3921,-804.53 4100.42,-775.64 4308.75,-760.96 4448.32,-753.8"/>
<polygon fill="black" stroke="black" points="4448.86,-757.28 4458.67,-753.28 4448.51,-750.29 4448.86,-757.28"/>
</g>
<!-- expert_14_4_0 -->
<g id="node1020" class="node">
<title>expert_14_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2847.5,-946.76 2570.5,-946.76 2570.5,-902.76 2847.5,-902.76 2847.5,-946.76"/>
<text text-anchor="middle" x="2709" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L14</text>
<text text-anchor="middle" x="2709" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 456</text>
<text text-anchor="middle" x="2709" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2709" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_4&#45;&gt;expert_14_4_0 -->
<g id="edge1235" class="edge">
<title>route_14_4&#45;&gt;expert_14_4_0</title>
<path fill="none" stroke="black" d="M2913.08,-986.02C2873.92,-974.46 2828.49,-961.04 2790.44,-949.81"/>
<polygon fill="black" stroke="black" points="2791.01,-946.33 2780.43,-946.85 2789.03,-953.04 2791.01,-946.33"/>
</g>
<!-- expert_14_4_1 -->
<g id="node1021" class="node">
<title>expert_14_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3142.5,-946.76 2865.5,-946.76 2865.5,-902.76 3142.5,-902.76 3142.5,-946.76"/>
<text text-anchor="middle" x="3004" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L14</text>
<text text-anchor="middle" x="3004" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 457</text>
<text text-anchor="middle" x="3004" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3004" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_4&#45;&gt;expert_14_4_1 -->
<g id="edge1236" class="edge">
<title>route_14_4&#45;&gt;expert_14_4_1</title>
<path fill="none" stroke="black" d="M3004,-982.4C3004,-974.12 3004,-965.15 3004,-956.84"/>
<polygon fill="black" stroke="black" points="3007.5,-956.76 3004,-946.76 3000.5,-956.76 3007.5,-956.76"/>
</g>
<!-- tp_14_4 -->
<g id="node1022" class="node">
<title>tp_14_4</title>
<ellipse fill="lightblue" stroke="black" cx="4046" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4046" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L14</text>
<text text-anchor="middle" x="4046" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 456↔457</text>
<text text-anchor="middle" x="4046" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4046" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_4_0&#45;&gt;tp_14_4 -->
<g id="edge1237" class="edge">
<title>expert_14_4_0&#45;&gt;tp_14_4</title>
<path fill="none" stroke="black" d="M2847.6,-903.63C2850.76,-903.32 2853.9,-903.03 2857,-902.76 3328.35,-861.46 3452.15,-930.49 3921,-866.76 3932.58,-865.19 3944.65,-863 3956.52,-860.51"/>
<polygon fill="black" stroke="black" points="3957.41,-863.9 3966.44,-858.36 3955.92,-857.06 3957.41,-863.9"/>
</g>
<!-- expert_14_4_1&#45;&gt;tp_14_4 -->
<g id="edge1238" class="edge">
<title>expert_14_4_1&#45;&gt;tp_14_4</title>
<path fill="none" stroke="black" d="M3142.6,-903.69C3145.76,-903.36 3148.9,-903.05 3152,-902.76 3492.65,-870.69 3582.27,-915.04 3921,-866.76 3932.48,-865.12 3944.45,-862.91 3956.24,-860.42"/>
<polygon fill="black" stroke="black" points="3957.06,-863.83 3966.08,-858.28 3955.56,-856.99 3957.06,-863.83"/>
</g>
<!-- tp_14_4&#45;&gt;q_proj_15 -->
<g id="edge2064" class="edge">
<title>tp_14_4&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M4126.28,-813.11C4141.06,-809.77 4156.43,-806.71 4171,-804.53 4428.82,-765.96 4499.41,-793.34 4762.46,-768.64"/>
<polygon fill="black" stroke="black" points="4763.08,-772.1 4772.7,-767.66 4762.41,-765.13 4763.08,-772.1"/>
</g>
<!-- tp_14_4&#45;&gt;k_proj_15 -->
<g id="edge2065" class="edge">
<title>tp_14_4&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M4125.57,-813.01C4140.56,-809.64 4156.19,-806.59 4171,-804.53 4567.27,-749.48 4674.3,-802.42 5076.54,-768.61"/>
<polygon fill="black" stroke="black" points="5077.04,-772.08 5086.71,-767.74 5076.45,-765.11 5077.04,-772.08"/>
</g>
<!-- tp_14_4&#45;&gt;v_proj_15 -->
<g id="edge2066" class="edge">
<title>tp_14_4&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M4128.1,-813.55C4142.35,-810.27 4157.06,-807.12 4171,-804.53 4262.51,-787.58 4365.75,-773.85 4448.79,-764.11"/>
<polygon fill="black" stroke="black" points="4449.28,-767.58 4458.81,-762.94 4448.47,-760.62 4449.28,-767.58"/>
</g>
<!-- expert_14_5_0 -->
<g id="node1024" class="node">
<title>expert_14_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3437.5,-946.76 3160.5,-946.76 3160.5,-902.76 3437.5,-902.76 3437.5,-946.76"/>
<text text-anchor="middle" x="3299" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L14</text>
<text text-anchor="middle" x="3299" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 458</text>
<text text-anchor="middle" x="3299" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3299" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_5&#45;&gt;expert_14_5_0 -->
<g id="edge1240" class="edge">
<title>route_14_5&#45;&gt;expert_14_5_0</title>
<path fill="none" stroke="black" d="M3503.08,-986.02C3463.92,-974.46 3418.49,-961.04 3380.44,-949.81"/>
<polygon fill="black" stroke="black" points="3381.01,-946.33 3370.43,-946.85 3379.03,-953.04 3381.01,-946.33"/>
</g>
<!-- expert_14_5_1 -->
<g id="node1025" class="node">
<title>expert_14_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3732.5,-946.76 3455.5,-946.76 3455.5,-902.76 3732.5,-902.76 3732.5,-946.76"/>
<text text-anchor="middle" x="3594" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L14</text>
<text text-anchor="middle" x="3594" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 459</text>
<text text-anchor="middle" x="3594" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3594" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_5&#45;&gt;expert_14_5_1 -->
<g id="edge1241" class="edge">
<title>route_14_5&#45;&gt;expert_14_5_1</title>
<path fill="none" stroke="black" d="M3594,-982.4C3594,-974.12 3594,-965.15 3594,-956.84"/>
<polygon fill="black" stroke="black" points="3597.5,-956.76 3594,-946.76 3590.5,-956.76 3597.5,-956.76"/>
</g>
<!-- tp_14_5 -->
<g id="node1026" class="node">
<title>tp_14_5</title>
<ellipse fill="lightblue" stroke="black" cx="4296" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4296" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L14</text>
<text text-anchor="middle" x="4296" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 458↔459</text>
<text text-anchor="middle" x="4296" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4296" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_5_0&#45;&gt;tp_14_5 -->
<g id="edge1242" class="edge">
<title>expert_14_5_0&#45;&gt;tp_14_5</title>
<path fill="none" stroke="black" d="M3437.61,-903.7C3440.77,-903.37 3443.9,-903.06 3447,-902.76 3767.71,-872.1 3852.11,-912.69 4171,-866.76 4182.48,-865.11 4194.45,-862.88 4206.23,-860.39"/>
<polygon fill="black" stroke="black" points="4207.05,-863.79 4216.07,-858.24 4205.56,-856.96 4207.05,-863.79"/>
</g>
<!-- expert_14_5_1&#45;&gt;tp_14_5 -->
<g id="edge1243" class="edge">
<title>expert_14_5_1&#45;&gt;tp_14_5</title>
<path fill="none" stroke="black" d="M3732.62,-903.84C3735.78,-903.47 3738.91,-903.11 3742,-902.76 3932.13,-881.31 3982.11,-897.25 4171,-866.76 4182.08,-864.97 4193.63,-862.72 4205.03,-860.27"/>
<polygon fill="black" stroke="black" points="4206,-863.64 4215,-858.06 4204.48,-856.8 4206,-863.64"/>
</g>
<!-- tp_14_5&#45;&gt;q_proj_15 -->
<g id="edge2067" class="edge">
<title>tp_14_5&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M4377.37,-813.41C4391.84,-810.1 4406.81,-806.98 4421,-804.53 4568.81,-779.09 4610.04,-786.36 4762.48,-768.69"/>
<polygon fill="black" stroke="black" points="4763.16,-772.13 4772.68,-767.49 4762.34,-765.18 4763.16,-772.13"/>
</g>
<!-- tp_14_5&#45;&gt;k_proj_15 -->
<g id="edge2068" class="edge">
<title>tp_14_5&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M4376.27,-813.04C4391.05,-809.71 4406.42,-806.67 4421,-804.53 4707.1,-762.59 4785.1,-795.19 5076.68,-768.61"/>
<polygon fill="black" stroke="black" points="5077.07,-772.09 5086.7,-767.68 5076.42,-765.12 5077.07,-772.09"/>
</g>
<!-- tp_14_5&#45;&gt;v_proj_15 -->
<g id="edge2069" class="edge">
<title>tp_14_5&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M4374.48,-812.66C4419.5,-800.05 4476.05,-784.21 4522.1,-771.31"/>
<polygon fill="black" stroke="black" points="4523.08,-774.68 4531.77,-768.61 4521.19,-767.93 4523.08,-774.68"/>
</g>
<!-- expert_14_6_0 -->
<g id="node1028" class="node">
<title>expert_14_6_0</title>
<polygon fill="lightgreen" stroke="black" points="4027.5,-946.76 3750.5,-946.76 3750.5,-902.76 4027.5,-902.76 4027.5,-946.76"/>
<text text-anchor="middle" x="3889" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L14</text>
<text text-anchor="middle" x="3889" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 460</text>
<text text-anchor="middle" x="3889" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3889" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_6&#45;&gt;expert_14_6_0 -->
<g id="edge1245" class="edge">
<title>route_14_6&#45;&gt;expert_14_6_0</title>
<path fill="none" stroke="black" d="M4093.08,-986.02C4053.92,-974.46 4008.49,-961.04 3970.44,-949.81"/>
<polygon fill="black" stroke="black" points="3971.01,-946.33 3960.43,-946.85 3969.03,-953.04 3971.01,-946.33"/>
</g>
<!-- expert_14_6_1 -->
<g id="node1029" class="node">
<title>expert_14_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4322.5,-946.76 4045.5,-946.76 4045.5,-902.76 4322.5,-902.76 4322.5,-946.76"/>
<text text-anchor="middle" x="4184" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L14</text>
<text text-anchor="middle" x="4184" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 461</text>
<text text-anchor="middle" x="4184" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4184" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_6&#45;&gt;expert_14_6_1 -->
<g id="edge1246" class="edge">
<title>route_14_6&#45;&gt;expert_14_6_1</title>
<path fill="none" stroke="black" d="M4184,-982.4C4184,-974.12 4184,-965.15 4184,-956.84"/>
<polygon fill="black" stroke="black" points="4187.5,-956.76 4184,-946.76 4180.5,-956.76 4187.5,-956.76"/>
</g>
<!-- tp_14_6 -->
<g id="node1030" class="node">
<title>tp_14_6</title>
<ellipse fill="lightblue" stroke="black" cx="4546" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4546" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L14</text>
<text text-anchor="middle" x="4546" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 460↔461</text>
<text text-anchor="middle" x="4546" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4546" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_6_0&#45;&gt;tp_14_6 -->
<g id="edge1247" class="edge">
<title>expert_14_6_0&#45;&gt;tp_14_6</title>
<path fill="none" stroke="black" d="M4027.63,-903.89C4030.78,-903.5 4033.91,-903.12 4037,-902.76 4207.24,-882.71 4251.91,-894.9 4421,-866.76 4432.07,-864.92 4443.61,-862.64 4455.02,-860.16"/>
<polygon fill="black" stroke="black" points="4455.98,-863.53 4464.98,-857.94 4454.46,-856.7 4455.98,-863.53"/>
</g>
<!-- expert_14_6_1&#45;&gt;tp_14_6 -->
<g id="edge1248" class="edge">
<title>expert_14_6_1&#45;&gt;tp_14_6</title>
<path fill="none" stroke="black" d="M4271.51,-902.72C4316.24,-891.97 4371.52,-878.67 4421,-866.76 4430.87,-864.38 4441.17,-861.9 4451.45,-859.43"/>
<polygon fill="black" stroke="black" points="4452.38,-862.8 4461.28,-857.06 4450.74,-856 4452.38,-862.8"/>
</g>
<!-- tp_14_6&#45;&gt;q_proj_15 -->
<g id="edge2070" class="edge">
<title>tp_14_6&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M4630.35,-814.18C4643.94,-810.92 4657.85,-807.62 4671,-804.53 4719.15,-793.25 4772.59,-781.02 4817.67,-770.8"/>
<polygon fill="black" stroke="black" points="4818.47,-774.2 4827.45,-768.58 4816.92,-767.38 4818.47,-774.2"/>
</g>
<!-- tp_14_6&#45;&gt;k_proj_15 -->
<g id="edge2071" class="edge">
<title>tp_14_6&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M4627,-813.29C4641.58,-809.97 4656.68,-806.88 4671,-804.53 4846.97,-775.72 4895.76,-788.11 5076.57,-768.66"/>
<polygon fill="black" stroke="black" points="5077.13,-772.12 5086.69,-767.55 5076.37,-765.16 5077.13,-772.12"/>
</g>
<!-- tp_14_6&#45;&gt;v_proj_15 -->
<g id="edge2072" class="edge">
<title>tp_14_6&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M4566.99,-804.67C4573.26,-795.72 4580.12,-785.92 4586.37,-777"/>
<polygon fill="black" stroke="black" points="4589.26,-778.97 4592.13,-768.77 4583.52,-774.96 4589.26,-778.97"/>
</g>
<!-- expert_14_7_0 -->
<g id="node1032" class="node">
<title>expert_14_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4617.5,-946.76 4340.5,-946.76 4340.5,-902.76 4617.5,-902.76 4617.5,-946.76"/>
<text text-anchor="middle" x="4479" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L14</text>
<text text-anchor="middle" x="4479" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 462</text>
<text text-anchor="middle" x="4479" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4479" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_7&#45;&gt;expert_14_7_0 -->
<g id="edge1250" class="edge">
<title>route_14_7&#45;&gt;expert_14_7_0</title>
<path fill="none" stroke="black" d="M4637.32,-984.95C4607.66,-973.86 4573.83,-961.21 4545.08,-950.46"/>
<polygon fill="black" stroke="black" points="4546.13,-947.12 4535.54,-946.9 4543.68,-953.68 4546.13,-947.12"/>
</g>
<!-- expert_14_7_1 -->
<g id="node1033" class="node">
<title>expert_14_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4912.5,-946.76 4635.5,-946.76 4635.5,-902.76 4912.5,-902.76 4912.5,-946.76"/>
<text text-anchor="middle" x="4774" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L14</text>
<text text-anchor="middle" x="4774" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 463</text>
<text text-anchor="middle" x="4774" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4774" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_7&#45;&gt;expert_14_7_1 -->
<g id="edge1251" class="edge">
<title>route_14_7&#45;&gt;expert_14_7_1</title>
<path fill="none" stroke="black" d="M4733.34,-982.89C4739.71,-973.94 4746.68,-964.14 4753.03,-955.22"/>
<polygon fill="black" stroke="black" points="4755.94,-957.18 4758.88,-947 4750.23,-953.12 4755.94,-957.18"/>
</g>
<!-- tp_14_7 -->
<g id="node1034" class="node">
<title>tp_14_7</title>
<ellipse fill="lightblue" stroke="black" cx="4796" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4796" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L14</text>
<text text-anchor="middle" x="4796" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 462↔463</text>
<text text-anchor="middle" x="4796" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4796" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_7_0&#45;&gt;tp_14_7 -->
<g id="edge1252" class="edge">
<title>expert_14_7_0&#45;&gt;tp_14_7</title>
<path fill="none" stroke="black" d="M4555.74,-902.67C4601.34,-890.14 4659.37,-874.19 4706.98,-861.11"/>
<polygon fill="black" stroke="black" points="4707.94,-864.47 4716.66,-858.45 4706.09,-857.72 4707.94,-864.47"/>
</g>
<!-- expert_14_7_1&#45;&gt;tp_14_7 -->
<g id="edge1253" class="edge">
<title>expert_14_7_1&#45;&gt;tp_14_7</title>
<path fill="none" stroke="black" d="M4779.33,-902.67C4781.3,-894.84 4783.62,-885.68 4785.88,-876.71"/>
<polygon fill="black" stroke="black" points="4789.34,-877.31 4788.4,-866.76 4782.55,-875.6 4789.34,-877.31"/>
</g>
<!-- tp_14_7&#45;&gt;q_proj_15 -->
<g id="edge2073" class="edge">
<title>tp_14_7&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M4836.58,-806.36C4851.24,-796.15 4867.74,-784.65 4882.24,-774.54"/>
<polygon fill="black" stroke="black" points="4884.32,-777.36 4890.52,-768.78 4880.31,-771.62 4884.32,-777.36"/>
</g>
<!-- tp_14_7&#45;&gt;k_proj_15 -->
<g id="edge2074" class="edge">
<title>tp_14_7&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M4879.23,-813.9C4893.14,-810.63 4907.46,-807.39 4921,-804.53 4979.43,-792.2 5044.31,-780.15 5099.87,-770.33"/>
<polygon fill="black" stroke="black" points="5100.53,-773.77 5109.77,-768.59 5099.31,-766.87 5100.53,-773.77"/>
</g>
<!-- tp_14_7&#45;&gt;v_proj_15 -->
<g id="edge2075" class="edge">
<title>tp_14_7&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M4739.04,-808.39C4714.67,-797.16 4686.32,-784.09 4662.15,-772.95"/>
<polygon fill="black" stroke="black" points="4663.31,-769.63 4652.76,-768.63 4660.38,-775.99 4663.31,-769.63"/>
</g>
<!-- expert_14_8_0 -->
<g id="node1036" class="node">
<title>expert_14_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5207.5,-946.76 4930.5,-946.76 4930.5,-902.76 5207.5,-902.76 5207.5,-946.76"/>
<text text-anchor="middle" x="5069" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L14</text>
<text text-anchor="middle" x="5069" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="5069" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5069" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_8&#45;&gt;expert_14_8_0 -->
<g id="edge1255" class="edge">
<title>route_14_8&#45;&gt;expert_14_8_0</title>
<path fill="none" stroke="black" d="M5110.32,-982.89C5103.85,-973.94 5096.76,-964.14 5090.31,-955.22"/>
<polygon fill="black" stroke="black" points="5093.06,-953.05 5084.36,-947 5087.39,-957.15 5093.06,-953.05"/>
</g>
<!-- expert_14_8_1 -->
<g id="node1037" class="node">
<title>expert_14_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5502.5,-946.76 5225.5,-946.76 5225.5,-902.76 5502.5,-902.76 5502.5,-946.76"/>
<text text-anchor="middle" x="5364" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L14</text>
<text text-anchor="middle" x="5364" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="5364" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5364" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_8&#45;&gt;expert_14_8_1 -->
<g id="edge1256" class="edge">
<title>route_14_8&#45;&gt;expert_14_8_1</title>
<path fill="none" stroke="black" d="M5206.36,-984.95C5235.89,-973.86 5269.58,-961.21 5298.2,-950.46"/>
<polygon fill="black" stroke="black" points="5299.57,-953.69 5307.71,-946.9 5297.11,-947.14 5299.57,-953.69"/>
</g>
<!-- tp_14_8 -->
<g id="node1038" class="node">
<title>tp_14_8</title>
<ellipse fill="lightblue" stroke="black" cx="5046" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5046" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L14</text>
<text text-anchor="middle" x="5046" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="5046" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5046" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_8_0&#45;&gt;tp_14_8 -->
<g id="edge1257" class="edge">
<title>expert_14_8_0&#45;&gt;tp_14_8</title>
<path fill="none" stroke="black" d="M5063.43,-902.67C5061.37,-894.84 5058.95,-885.68 5056.58,-876.71"/>
<polygon fill="black" stroke="black" points="5059.89,-875.53 5053.95,-866.76 5053.12,-877.32 5059.89,-875.53"/>
</g>
<!-- expert_14_8_1&#45;&gt;tp_14_8 -->
<g id="edge1258" class="edge">
<title>expert_14_8_1&#45;&gt;tp_14_8</title>
<path fill="none" stroke="black" d="M5287.02,-902.67C5241.19,-890.12 5182.84,-874.13 5135.04,-861.04"/>
<polygon fill="black" stroke="black" points="5135.88,-857.64 5125.31,-858.37 5134.03,-864.39 5135.88,-857.64"/>
</g>
<!-- tp_14_8&#45;&gt;q_proj_15 -->
<g id="edge2076" class="edge">
<title>tp_14_8&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M5005.42,-806.36C4990.76,-796.15 4974.26,-784.65 4959.76,-774.54"/>
<polygon fill="black" stroke="black" points="4961.69,-771.62 4951.48,-768.78 4957.68,-777.36 4961.69,-771.62"/>
</g>
<!-- tp_14_8&#45;&gt;k_proj_15 -->
<g id="edge2077" class="edge">
<title>tp_14_8&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M5102.96,-808.39C5127.33,-797.16 5155.68,-784.09 5179.85,-772.95"/>
<polygon fill="black" stroke="black" points="5181.62,-775.99 5189.24,-768.63 5178.69,-769.63 5181.62,-775.99"/>
</g>
<!-- tp_14_8&#45;&gt;v_proj_15 -->
<g id="edge2078" class="edge">
<title>tp_14_8&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M4962.77,-813.9C4948.86,-810.63 4934.54,-807.39 4921,-804.53 4862.57,-792.2 4797.69,-780.15 4742.13,-770.33"/>
<polygon fill="black" stroke="black" points="4742.69,-766.87 4732.23,-768.59 4741.47,-773.77 4742.69,-766.87"/>
</g>
<!-- expert_14_9_0 -->
<g id="node1040" class="node">
<title>expert_14_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5797.5,-946.76 5520.5,-946.76 5520.5,-902.76 5797.5,-902.76 5797.5,-946.76"/>
<text text-anchor="middle" x="5659" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L14</text>
<text text-anchor="middle" x="5659" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 482</text>
<text text-anchor="middle" x="5659" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5659" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_9&#45;&gt;expert_14_9_0 -->
<g id="edge1260" class="edge">
<title>route_14_9&#45;&gt;expert_14_9_0</title>
<path fill="none" stroke="black" d="M5659,-982.4C5659,-974.12 5659,-965.15 5659,-956.84"/>
<polygon fill="black" stroke="black" points="5662.5,-956.76 5659,-946.76 5655.5,-956.76 5662.5,-956.76"/>
</g>
<!-- expert_14_9_1 -->
<g id="node1041" class="node">
<title>expert_14_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6092.5,-946.76 5815.5,-946.76 5815.5,-902.76 6092.5,-902.76 6092.5,-946.76"/>
<text text-anchor="middle" x="5954" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L14</text>
<text text-anchor="middle" x="5954" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 483</text>
<text text-anchor="middle" x="5954" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5954" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_9&#45;&gt;expert_14_9_1 -->
<g id="edge1261" class="edge">
<title>route_14_9&#45;&gt;expert_14_9_1</title>
<path fill="none" stroke="black" d="M5749.92,-986.02C5789.08,-974.46 5834.51,-961.04 5872.56,-949.81"/>
<polygon fill="black" stroke="black" points="5873.97,-953.04 5882.57,-946.85 5871.99,-946.33 5873.97,-953.04"/>
</g>
<!-- tp_14_9 -->
<g id="node1042" class="node">
<title>tp_14_9</title>
<ellipse fill="lightblue" stroke="black" cx="5296" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5296" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L14</text>
<text text-anchor="middle" x="5296" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 482↔483</text>
<text text-anchor="middle" x="5296" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5296" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_9_0&#45;&gt;tp_14_9 -->
<g id="edge1262" class="edge">
<title>expert_14_9_0&#45;&gt;tp_14_9</title>
<path fill="none" stroke="black" d="M5571.11,-902.74C5526.2,-891.99 5470.68,-878.69 5421,-866.76 5411.05,-864.37 5400.65,-861.87 5390.29,-859.38"/>
<polygon fill="black" stroke="black" points="5390.92,-855.93 5380.38,-856.99 5389.28,-862.73 5390.92,-855.93"/>
</g>
<!-- expert_14_9_1&#45;&gt;tp_14_9 -->
<g id="edge1263" class="edge">
<title>expert_14_9_1&#45;&gt;tp_14_9</title>
<path fill="none" stroke="black" d="M5815.14,-903.74C5812.4,-903.4 5809.69,-903.08 5807,-902.76 5635.89,-882.57 5590.97,-895.01 5421,-866.76 5409.93,-864.92 5398.39,-862.64 5386.98,-860.17"/>
<polygon fill="black" stroke="black" points="5387.54,-856.7 5377.01,-857.95 5386.02,-863.54 5387.54,-856.7"/>
</g>
<!-- tp_14_9&#45;&gt;q_proj_15 -->
<g id="edge2079" class="edge">
<title>tp_14_9&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M5211.65,-814.18C5198.06,-810.92 5184.15,-807.62 5171,-804.53 5122.85,-793.25 5069.41,-781.02 5024.33,-770.8"/>
<polygon fill="black" stroke="black" points="5025.08,-767.38 5014.55,-768.58 5023.53,-774.2 5025.08,-767.38"/>
</g>
<!-- tp_14_9&#45;&gt;k_proj_15 -->
<g id="edge2080" class="edge">
<title>tp_14_9&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M5275.01,-804.67C5268.74,-795.72 5261.88,-785.92 5255.63,-777"/>
<polygon fill="black" stroke="black" points="5258.48,-774.96 5249.87,-768.77 5252.74,-778.97 5258.48,-774.96"/>
</g>
<!-- tp_14_9&#45;&gt;v_proj_15 -->
<g id="edge2081" class="edge">
<title>tp_14_9&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M5215,-813.29C5200.42,-809.97 5185.32,-806.88 5171,-804.53 4995.03,-775.72 4946.24,-788.11 4765.43,-768.66"/>
<polygon fill="black" stroke="black" points="4765.63,-765.16 4755.31,-767.55 4764.87,-772.12 4765.63,-765.16"/>
</g>
<!-- expert_14_10_0 -->
<g id="node1044" class="node">
<title>expert_14_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6387.5,-946.76 6110.5,-946.76 6110.5,-902.76 6387.5,-902.76 6387.5,-946.76"/>
<text text-anchor="middle" x="6249" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L14</text>
<text text-anchor="middle" x="6249" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 484</text>
<text text-anchor="middle" x="6249" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6249" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_10&#45;&gt;expert_14_10_0 -->
<g id="edge1265" class="edge">
<title>route_14_10&#45;&gt;expert_14_10_0</title>
<path fill="none" stroke="black" d="M6249,-982.4C6249,-974.12 6249,-965.15 6249,-956.84"/>
<polygon fill="black" stroke="black" points="6252.5,-956.76 6249,-946.76 6245.5,-956.76 6252.5,-956.76"/>
</g>
<!-- expert_14_10_1 -->
<g id="node1045" class="node">
<title>expert_14_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6682.5,-946.76 6405.5,-946.76 6405.5,-902.76 6682.5,-902.76 6682.5,-946.76"/>
<text text-anchor="middle" x="6544" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L14</text>
<text text-anchor="middle" x="6544" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 485</text>
<text text-anchor="middle" x="6544" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6544" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_10&#45;&gt;expert_14_10_1 -->
<g id="edge1266" class="edge">
<title>route_14_10&#45;&gt;expert_14_10_1</title>
<path fill="none" stroke="black" d="M6339.92,-986.02C6379.08,-974.46 6424.51,-961.04 6462.56,-949.81"/>
<polygon fill="black" stroke="black" points="6463.97,-953.04 6472.57,-946.85 6461.99,-946.33 6463.97,-953.04"/>
</g>
<!-- tp_14_10 -->
<g id="node1046" class="node">
<title>tp_14_10</title>
<ellipse fill="lightblue" stroke="black" cx="5546" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5546" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L14</text>
<text text-anchor="middle" x="5546" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 484↔485</text>
<text text-anchor="middle" x="5546" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5546" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_10_0&#45;&gt;tp_14_10 -->
<g id="edge1267" class="edge">
<title>expert_14_10_0&#45;&gt;tp_14_10</title>
<path fill="none" stroke="black" d="M6110.14,-903.7C6107.41,-903.38 6104.69,-903.06 6102,-902.76 5911,-881.16 5860.77,-897.36 5671,-866.76 5659.92,-864.97 5648.37,-862.73 5636.97,-860.27"/>
<polygon fill="black" stroke="black" points="5637.52,-856.81 5627,-858.06 5636,-863.64 5637.52,-856.81"/>
</g>
<!-- expert_14_10_1&#45;&gt;tp_14_10 -->
<g id="edge1268" class="edge">
<title>expert_14_10_1&#45;&gt;tp_14_10</title>
<path fill="none" stroke="black" d="M6405.16,-903.58C6402.42,-903.29 6399.69,-903.02 6397,-902.76 6075.42,-871.88 5990.77,-912.79 5671,-866.76 5659.52,-865.11 5647.55,-862.89 5635.77,-860.39"/>
<polygon fill="black" stroke="black" points="5636.44,-856.96 5625.93,-858.24 5634.95,-863.8 5636.44,-856.96"/>
</g>
<!-- tp_14_10&#45;&gt;q_proj_15 -->
<g id="edge2082" class="edge">
<title>tp_14_10&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M5464.63,-813.41C5450.16,-810.1 5435.19,-806.98 5421,-804.53 5273.19,-779.09 5231.96,-786.36 5079.52,-768.69"/>
<polygon fill="black" stroke="black" points="5079.66,-765.18 5069.32,-767.49 5078.84,-772.13 5079.66,-765.18"/>
</g>
<!-- tp_14_10&#45;&gt;k_proj_15 -->
<g id="edge2083" class="edge">
<title>tp_14_10&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M5467.52,-812.66C5422.5,-800.05 5365.95,-784.21 5319.9,-771.31"/>
<polygon fill="black" stroke="black" points="5320.81,-767.93 5310.23,-768.61 5318.92,-774.68 5320.81,-767.93"/>
</g>
<!-- tp_14_10&#45;&gt;v_proj_15 -->
<g id="edge2084" class="edge">
<title>tp_14_10&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M5465.73,-813.04C5450.95,-809.71 5435.58,-806.67 5421,-804.53 5134.9,-762.59 5056.9,-795.19 4765.32,-768.61"/>
<polygon fill="black" stroke="black" points="4765.58,-765.12 4755.3,-767.68 4764.93,-772.09 4765.58,-765.12"/>
</g>
<!-- expert_14_11_0 -->
<g id="node1048" class="node">
<title>expert_14_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6977.5,-946.76 6700.5,-946.76 6700.5,-902.76 6977.5,-902.76 6977.5,-946.76"/>
<text text-anchor="middle" x="6839" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L14</text>
<text text-anchor="middle" x="6839" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 486</text>
<text text-anchor="middle" x="6839" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6839" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_11&#45;&gt;expert_14_11_0 -->
<g id="edge1270" class="edge">
<title>route_14_11&#45;&gt;expert_14_11_0</title>
<path fill="none" stroke="black" d="M6839,-982.4C6839,-974.12 6839,-965.15 6839,-956.84"/>
<polygon fill="black" stroke="black" points="6842.5,-956.76 6839,-946.76 6835.5,-956.76 6842.5,-956.76"/>
</g>
<!-- expert_14_11_1 -->
<g id="node1049" class="node">
<title>expert_14_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7272.5,-946.76 6995.5,-946.76 6995.5,-902.76 7272.5,-902.76 7272.5,-946.76"/>
<text text-anchor="middle" x="7134" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L14</text>
<text text-anchor="middle" x="7134" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 487</text>
<text text-anchor="middle" x="7134" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7134" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_11&#45;&gt;expert_14_11_1 -->
<g id="edge1271" class="edge">
<title>route_14_11&#45;&gt;expert_14_11_1</title>
<path fill="none" stroke="black" d="M6929.92,-986.02C6969.08,-974.46 7014.51,-961.04 7052.56,-949.81"/>
<polygon fill="black" stroke="black" points="7053.97,-953.04 7062.57,-946.85 7051.99,-946.33 7053.97,-953.04"/>
</g>
<!-- tp_14_11 -->
<g id="node1050" class="node">
<title>tp_14_11</title>
<ellipse fill="lightblue" stroke="black" cx="5796" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5796" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L14</text>
<text text-anchor="middle" x="5796" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 486↔487</text>
<text text-anchor="middle" x="5796" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5796" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_11_0&#45;&gt;tp_14_11 -->
<g id="edge1272" class="edge">
<title>expert_14_11_0&#45;&gt;tp_14_11</title>
<path fill="none" stroke="black" d="M6700.16,-903.57C6697.42,-903.28 6694.69,-903.01 6692,-902.76 6350.48,-870.47 6260.61,-915.15 5921,-866.76 5909.52,-865.12 5897.55,-862.91 5885.76,-860.42"/>
<polygon fill="black" stroke="black" points="5886.44,-856.99 5875.92,-858.28 5884.94,-863.83 5886.44,-856.99"/>
</g>
<!-- expert_14_11_1&#45;&gt;tp_14_11 -->
<g id="edge1273" class="edge">
<title>expert_14_11_1&#45;&gt;tp_14_11</title>
<path fill="none" stroke="black" d="M6995.16,-903.52C6992.42,-903.25 6989.7,-903 6987,-902.76 6514.78,-861.18 6390.73,-930.6 5921,-866.76 5909.42,-865.19 5897.35,-863 5885.48,-860.51"/>
<polygon fill="black" stroke="black" points="5886.08,-857.06 5875.56,-858.36 5884.59,-863.9 5886.08,-857.06"/>
</g>
<!-- tp_14_11&#45;&gt;q_proj_15 -->
<g id="edge2085" class="edge">
<title>tp_14_11&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M5715.72,-813.11C5700.94,-809.77 5685.57,-806.71 5671,-804.53 5413.18,-765.96 5342.59,-793.34 5079.54,-768.64"/>
<polygon fill="black" stroke="black" points="5079.59,-765.13 5069.3,-767.66 5078.92,-772.1 5079.59,-765.13"/>
</g>
<!-- tp_14_11&#45;&gt;k_proj_15 -->
<g id="edge2086" class="edge">
<title>tp_14_11&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M5713.9,-813.55C5699.65,-810.27 5684.94,-807.12 5671,-804.53 5579.49,-787.58 5476.25,-773.85 5393.21,-764.11"/>
<polygon fill="black" stroke="black" points="5393.53,-760.62 5383.19,-762.94 5392.72,-767.58 5393.53,-760.62"/>
</g>
<!-- tp_14_11&#45;&gt;v_proj_15 -->
<g id="edge2087" class="edge">
<title>tp_14_11&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M5716.43,-813.01C5701.44,-809.64 5685.81,-806.59 5671,-804.53 5274.73,-749.48 5167.7,-802.42 4765.46,-768.61"/>
<polygon fill="black" stroke="black" points="4765.55,-765.11 4755.29,-767.74 4764.96,-772.08 4765.55,-765.11"/>
</g>
<!-- expert_14_12_0 -->
<g id="node1052" class="node">
<title>expert_14_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7567.5,-946.76 7290.5,-946.76 7290.5,-902.76 7567.5,-902.76 7567.5,-946.76"/>
<text text-anchor="middle" x="7429" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L14</text>
<text text-anchor="middle" x="7429" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 488</text>
<text text-anchor="middle" x="7429" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7429" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_12&#45;&gt;expert_14_12_0 -->
<g id="edge1275" class="edge">
<title>route_14_12&#45;&gt;expert_14_12_0</title>
<path fill="none" stroke="black" d="M7429,-982.4C7429,-974.12 7429,-965.15 7429,-956.84"/>
<polygon fill="black" stroke="black" points="7432.5,-956.76 7429,-946.76 7425.5,-956.76 7432.5,-956.76"/>
</g>
<!-- expert_14_12_1 -->
<g id="node1053" class="node">
<title>expert_14_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7862.5,-946.76 7585.5,-946.76 7585.5,-902.76 7862.5,-902.76 7862.5,-946.76"/>
<text text-anchor="middle" x="7724" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L14</text>
<text text-anchor="middle" x="7724" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 489</text>
<text text-anchor="middle" x="7724" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7724" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_12&#45;&gt;expert_14_12_1 -->
<g id="edge1276" class="edge">
<title>route_14_12&#45;&gt;expert_14_12_1</title>
<path fill="none" stroke="black" d="M7519.92,-986.02C7559.08,-974.46 7604.51,-961.04 7642.56,-949.81"/>
<polygon fill="black" stroke="black" points="7643.97,-953.04 7652.57,-946.85 7641.99,-946.33 7643.97,-953.04"/>
</g>
<!-- tp_14_12 -->
<g id="node1054" class="node">
<title>tp_14_12</title>
<ellipse fill="lightblue" stroke="black" cx="6046" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6046" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L14</text>
<text text-anchor="middle" x="6046" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 488↔489</text>
<text text-anchor="middle" x="6046" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6046" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_12_0&#45;&gt;tp_14_12 -->
<g id="edge1277" class="edge">
<title>expert_14_12_0&#45;&gt;tp_14_12</title>
<path fill="none" stroke="black" d="M7290.16,-903.51C7287.42,-903.25 7284.7,-903 7282,-902.76 6789.84,-859.76 6660.58,-932.96 6171,-866.76 6159.42,-865.19 6147.35,-863.01 6135.48,-860.53"/>
<polygon fill="black" stroke="black" points="6136.08,-857.07 6125.56,-858.37 6134.59,-863.91 6136.08,-857.07"/>
</g>
<!-- expert_14_12_1&#45;&gt;tp_14_12 -->
<g id="edge1278" class="edge">
<title>expert_14_12_1&#45;&gt;tp_14_12</title>
<path fill="none" stroke="black" d="M7585.16,-903.49C7582.42,-903.23 7579.7,-902.99 7577,-902.76 6954.1,-850.47 6790.74,-948.41 6171,-866.76 6159.33,-865.22 6147.16,-863.04 6135.2,-860.54"/>
<polygon fill="black" stroke="black" points="6135.73,-857.08 6125.21,-858.38 6134.25,-863.92 6135.73,-857.08"/>
</g>
<!-- tp_14_12&#45;&gt;q_proj_15 -->
<g id="edge2088" class="edge">
<title>tp_14_12&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M5966.09,-812.97C5951.2,-809.62 5935.7,-806.6 5921,-804.53 5552.9,-752.83 5453.31,-800.57 5079.31,-768.6"/>
<polygon fill="black" stroke="black" points="5079.56,-765.11 5069.29,-767.73 5078.95,-772.08 5079.56,-765.11"/>
</g>
<!-- tp_14_12&#45;&gt;k_proj_15 -->
<g id="edge2089" class="edge">
<title>tp_14_12&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M5965.01,-813.22C5950.43,-809.92 5935.32,-806.84 5921,-804.53 5741.58,-775.64 5533.25,-760.96 5393.68,-753.8"/>
<polygon fill="black" stroke="black" points="5393.49,-750.29 5383.33,-753.28 5393.14,-757.28 5393.49,-750.29"/>
</g>
<!-- tp_14_12&#45;&gt;v_proj_15 -->
<g id="edge2090" class="edge">
<title>tp_14_12&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M5966.44,-812.9C5951.45,-809.54 5935.82,-806.53 5921,-804.53 5414.48,-736.38 5278.53,-809.71 4765.55,-768.61"/>
<polygon fill="black" stroke="black" points="4765.54,-765.1 4755.29,-767.78 4764.97,-772.08 4765.54,-765.1"/>
</g>
<!-- expert_14_13_0 -->
<g id="node1056" class="node">
<title>expert_14_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8157.5,-946.76 7880.5,-946.76 7880.5,-902.76 8157.5,-902.76 8157.5,-946.76"/>
<text text-anchor="middle" x="8019" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L14</text>
<text text-anchor="middle" x="8019" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 490</text>
<text text-anchor="middle" x="8019" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8019" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_13&#45;&gt;expert_14_13_0 -->
<g id="edge1280" class="edge">
<title>route_14_13&#45;&gt;expert_14_13_0</title>
<path fill="none" stroke="black" d="M8019,-982.4C8019,-974.12 8019,-965.15 8019,-956.84"/>
<polygon fill="black" stroke="black" points="8022.5,-956.76 8019,-946.76 8015.5,-956.76 8022.5,-956.76"/>
</g>
<!-- expert_14_13_1 -->
<g id="node1057" class="node">
<title>expert_14_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8452.5,-946.76 8175.5,-946.76 8175.5,-902.76 8452.5,-902.76 8452.5,-946.76"/>
<text text-anchor="middle" x="8314" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L14</text>
<text text-anchor="middle" x="8314" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 491</text>
<text text-anchor="middle" x="8314" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8314" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_13&#45;&gt;expert_14_13_1 -->
<g id="edge1281" class="edge">
<title>route_14_13&#45;&gt;expert_14_13_1</title>
<path fill="none" stroke="black" d="M8109.92,-986.02C8149.08,-974.46 8194.51,-961.04 8232.56,-949.81"/>
<polygon fill="black" stroke="black" points="8233.97,-953.04 8242.57,-946.85 8231.99,-946.33 8233.97,-953.04"/>
</g>
<!-- tp_14_13 -->
<g id="node1058" class="node">
<title>tp_14_13</title>
<ellipse fill="lightblue" stroke="black" cx="6296" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6296" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L14</text>
<text text-anchor="middle" x="6296" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 490↔491</text>
<text text-anchor="middle" x="6296" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6296" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_13_0&#45;&gt;tp_14_13 -->
<g id="edge1282" class="edge">
<title>expert_14_13_0&#45;&gt;tp_14_13</title>
<path fill="none" stroke="black" d="M7880.16,-903.48C7877.42,-903.23 7874.7,-902.98 7872,-902.76 7229.15,-849.05 7060.59,-950.77 6421,-866.76 6409.33,-865.23 6397.16,-863.05 6385.2,-860.55"/>
<polygon fill="black" stroke="black" points="6385.73,-857.09 6375.21,-858.39 6384.25,-863.93 6385.73,-857.09"/>
</g>
<!-- expert_14_13_1&#45;&gt;tp_14_13 -->
<g id="edge1283" class="edge">
<title>expert_14_13_1&#45;&gt;tp_14_13</title>
<path fill="none" stroke="black" d="M8175.17,-903.47C8172.42,-903.22 8169.7,-902.98 8167,-902.76 7780.2,-871.26 6805.88,-916.49 6421,-866.76 6409.33,-865.25 6397.16,-863.09 6385.19,-860.6"/>
<polygon fill="black" stroke="black" points="6385.72,-857.13 6375.21,-858.44 6384.24,-863.97 6385.72,-857.13"/>
</g>
<!-- tp_14_13&#45;&gt;q_proj_15 -->
<g id="edge2091" class="edge">
<title>tp_14_13&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M6216.44,-812.93C6201.45,-809.56 6185.82,-806.54 6171,-804.53 5692.65,-739.73 5564.12,-807.86 5079.35,-768.6"/>
<polygon fill="black" stroke="black" points="5079.54,-765.1 5069.29,-767.77 5078.97,-772.08 5079.54,-765.1"/>
</g>
<!-- tp_14_13&#45;&gt;k_proj_15 -->
<g id="edge2092" class="edge">
<title>tp_14_13&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M6215.72,-813.11C6200.94,-809.77 6185.57,-806.72 6171,-804.53 5899.86,-763.94 5580.41,-752.09 5393.54,-748.73"/>
<polygon fill="black" stroke="black" points="5393.42,-745.23 5383.36,-748.55 5393.3,-752.23 5393.42,-745.23"/>
</g>
<!-- tp_14_13&#45;&gt;v_proj_15 -->
<g id="edge2093" class="edge">
<title>tp_14_13&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M6216.79,-812.91C6201.69,-809.53 6185.94,-806.5 6171,-804.53 5554.15,-723.27 5389.34,-817.05 4765.44,-768.6"/>
<polygon fill="black" stroke="black" points="4765.53,-765.09 4755.29,-767.8 4764.98,-772.07 4765.53,-765.09"/>
</g>
<!-- expert_14_14_0 -->
<g id="node1060" class="node">
<title>expert_14_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8747.5,-946.76 8470.5,-946.76 8470.5,-902.76 8747.5,-902.76 8747.5,-946.76"/>
<text text-anchor="middle" x="8609" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L14</text>
<text text-anchor="middle" x="8609" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 492</text>
<text text-anchor="middle" x="8609" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8609" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_14&#45;&gt;expert_14_14_0 -->
<g id="edge1285" class="edge">
<title>route_14_14&#45;&gt;expert_14_14_0</title>
<path fill="none" stroke="black" d="M8609,-982.4C8609,-974.12 8609,-965.15 8609,-956.84"/>
<polygon fill="black" stroke="black" points="8612.5,-956.76 8609,-946.76 8605.5,-956.76 8612.5,-956.76"/>
</g>
<!-- expert_14_14_1 -->
<g id="node1061" class="node">
<title>expert_14_14_1</title>
<polygon fill="lightgreen" stroke="black" points="9042.5,-946.76 8765.5,-946.76 8765.5,-902.76 9042.5,-902.76 9042.5,-946.76"/>
<text text-anchor="middle" x="8904" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L14</text>
<text text-anchor="middle" x="8904" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 493</text>
<text text-anchor="middle" x="8904" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8904" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_14&#45;&gt;expert_14_14_1 -->
<g id="edge1286" class="edge">
<title>route_14_14&#45;&gt;expert_14_14_1</title>
<path fill="none" stroke="black" d="M8699.92,-986.02C8739.08,-974.46 8784.51,-961.04 8822.56,-949.81"/>
<polygon fill="black" stroke="black" points="8823.97,-953.04 8832.57,-946.85 8821.99,-946.33 8823.97,-953.04"/>
</g>
<!-- tp_14_14 -->
<g id="node1062" class="node">
<title>tp_14_14</title>
<ellipse fill="lightblue" stroke="black" cx="6546" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6546" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L14</text>
<text text-anchor="middle" x="6546" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 492↔493</text>
<text text-anchor="middle" x="6546" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6546" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_14_0&#45;&gt;tp_14_14 -->
<g id="edge1287" class="edge">
<title>expert_14_14_0&#45;&gt;tp_14_14</title>
<path fill="none" stroke="black" d="M8470.17,-903.47C8467.42,-903.21 8464.7,-902.98 8462,-902.76 8065.22,-870.55 7065.81,-917.67 6671,-866.76 6659.33,-865.25 6647.16,-863.09 6635.19,-860.61"/>
<polygon fill="black" stroke="black" points="6635.72,-857.14 6625.21,-858.45 6634.24,-863.98 6635.72,-857.14"/>
</g>
<!-- expert_14_14_1&#45;&gt;tp_14_14 -->
<g id="edge1288" class="edge">
<title>expert_14_14_1&#45;&gt;tp_14_14</title>
<path fill="none" stroke="black" d="M8765.17,-903.46C8762.42,-903.21 8759.7,-902.97 8757,-902.76 8294.84,-865.9 7130.9,-925.4 6671,-866.76 6659.32,-865.27 6647.15,-863.12 6635.19,-860.64"/>
<polygon fill="black" stroke="black" points="6635.71,-857.17 6625.2,-858.48 6634.24,-864.01 6635.71,-857.17"/>
</g>
<!-- tp_14_14&#45;&gt;q_proj_15 -->
<g id="edge2094" class="edge">
<title>tp_14_14&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M6466.45,-812.85C6451.45,-809.49 6435.83,-806.5 6421,-804.53 5832.38,-726.62 5674.96,-815.18 5079.42,-768.6"/>
<polygon fill="black" stroke="black" points="5079.53,-765.1 5069.29,-767.8 5078.98,-772.07 5079.53,-765.1"/>
</g>
<!-- tp_14_14&#45;&gt;k_proj_15 -->
<g id="edge2095" class="edge">
<title>tp_14_14&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M6466.08,-813.03C6451.19,-809.68 6435.69,-806.64 6421,-804.53 6227.37,-776.81 5669.04,-758.87 5393.15,-751.44"/>
<polygon fill="black" stroke="black" points="5393.14,-747.94 5383.05,-751.17 5392.95,-754.93 5393.14,-747.94"/>
</g>
<!-- tp_14_14&#45;&gt;v_proj_15 -->
<g id="edge2096" class="edge">
<title>tp_14_14&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M6466.79,-812.86C6451.7,-809.48 6435.94,-806.47 6421,-804.53 6058.96,-757.55 5147.42,-796.3 4765.33,-768.57"/>
<polygon fill="black" stroke="black" points="4765.52,-765.07 4755.29,-767.82 4765,-772.05 4765.52,-765.07"/>
</g>
<!-- expert_14_15_0 -->
<g id="node1064" class="node">
<title>expert_14_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9337.5,-946.76 9060.5,-946.76 9060.5,-902.76 9337.5,-902.76 9337.5,-946.76"/>
<text text-anchor="middle" x="9199" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L14</text>
<text text-anchor="middle" x="9199" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 494</text>
<text text-anchor="middle" x="9199" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9199" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_15&#45;&gt;expert_14_15_0 -->
<g id="edge1290" class="edge">
<title>route_14_15&#45;&gt;expert_14_15_0</title>
<path fill="none" stroke="black" d="M9199,-982.4C9199,-974.12 9199,-965.15 9199,-956.84"/>
<polygon fill="black" stroke="black" points="9202.5,-956.76 9199,-946.76 9195.5,-956.76 9202.5,-956.76"/>
</g>
<!-- expert_14_15_1 -->
<g id="node1065" class="node">
<title>expert_14_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9632.5,-946.76 9355.5,-946.76 9355.5,-902.76 9632.5,-902.76 9632.5,-946.76"/>
<text text-anchor="middle" x="9494" y="-937.56" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L14</text>
<text text-anchor="middle" x="9494" y="-927.56" font-family="Times,serif" font-size="9.00">GPU: 495</text>
<text text-anchor="middle" x="9494" y="-917.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9494" y="-907.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_15&#45;&gt;expert_14_15_1 -->
<g id="edge1291" class="edge">
<title>route_14_15&#45;&gt;expert_14_15_1</title>
<path fill="none" stroke="black" d="M9289.92,-986.02C9329.08,-974.46 9374.51,-961.04 9412.56,-949.81"/>
<polygon fill="black" stroke="black" points="9413.97,-953.04 9422.57,-946.85 9411.99,-946.33 9413.97,-953.04"/>
</g>
<!-- tp_14_15 -->
<g id="node1066" class="node">
<title>tp_14_15</title>
<ellipse fill="lightblue" stroke="black" cx="6796" cy="-835.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6796" y="-848.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L14</text>
<text text-anchor="middle" x="6796" y="-838.45" font-family="Times,serif" font-size="9.00">GPU: 494↔495</text>
<text text-anchor="middle" x="6796" y="-828.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6796" y="-818.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_15_0&#45;&gt;tp_14_15 -->
<g id="edge1292" class="edge">
<title>expert_14_15_0&#45;&gt;tp_14_15</title>
<path fill="none" stroke="black" d="M9060.16,-903.5C9057.42,-903.24 9054.7,-902.99 9052,-902.76 8633.38,-866.84 7332.95,-844.71 6921.89,-838.47"/>
<polygon fill="black" stroke="black" points="6921.8,-834.97 6911.75,-838.31 6921.7,-841.96 6921.8,-834.97"/>
</g>
<!-- expert_14_15_1&#45;&gt;tp_14_15 -->
<g id="edge1293" class="edge">
<title>expert_14_15_1&#45;&gt;tp_14_15</title>
<path fill="none" stroke="black" d="M9355.16,-903.49C9352.42,-903.23 9349.7,-902.99 9347,-902.76 8867.93,-862.47 7367.66,-842.98 6922.03,-837.98"/>
<polygon fill="black" stroke="black" points="6922.05,-834.48 6912.02,-837.86 6921.98,-841.48 6922.05,-834.48"/>
</g>
<!-- tp_14_15&#45;&gt;q_proj_15 -->
<g id="edge2097" class="edge">
<title>tp_14_15&#45;&gt;q_proj_15</title>
<path fill="none" stroke="black" d="M6716.79,-812.88C6701.69,-809.49 6685.94,-806.48 6671,-804.53 6323.13,-759.23 5447.47,-795.36 5079.49,-768.58"/>
<polygon fill="black" stroke="black" points="5079.52,-765.07 5069.29,-767.81 5079,-772.05 5079.52,-765.07"/>
</g>
<!-- tp_14_15&#45;&gt;k_proj_15 -->
<g id="edge2098" class="edge">
<title>tp_14_15&#45;&gt;k_proj_15</title>
<path fill="none" stroke="black" d="M6716.43,-813.01C6701.44,-809.64 6685.81,-806.59 6671,-804.53 6428.51,-770.85 5713.94,-755.31 5393.56,-749.9"/>
<polygon fill="black" stroke="black" points="5393.32,-746.39 5383.27,-749.72 5393.21,-753.39 5393.32,-746.39"/>
</g>
<!-- tp_14_15&#45;&gt;v_proj_15 -->
<g id="edge2099" class="edge">
<title>tp_14_15&#45;&gt;v_proj_15</title>
<path fill="none" stroke="black" d="M6716.8,-812.83C6701.7,-809.45 6685.94,-806.45 6671,-804.53 6253.88,-751 5203.22,-799.91 4765.51,-768.58"/>
<polygon fill="black" stroke="black" points="4765.52,-765.07 4755.29,-767.83 4765,-772.05 4765.52,-765.07"/>
</g>
<!-- attn_scores_15 -->
<g id="node1070" class="node">
<title>attn_scores_15</title>
<polygon fill="lightgreen" stroke="black" points="5087.5,-688.53 4754.5,-688.53 4754.5,-644.53 5087.5,-644.53 5087.5,-688.53"/>
<text text-anchor="middle" x="4921" y="-679.33" font-family="Times,serif" font-size="9.00">Attention Scores L15</text>
<text text-anchor="middle" x="4921" y="-669.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4921" y="-659.33" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4921" y="-649.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_15&#45;&gt;attn_scores_15 -->
<g id="edge1294" class="edge">
<title>q_proj_15&#45;&gt;attn_scores_15</title>
<path fill="none" stroke="black" d="M4921,-724.22C4921,-716.33 4921,-707.22 4921,-698.64"/>
<polygon fill="black" stroke="black" points="4924.5,-698.55 4921,-688.55 4917.5,-698.55 4924.5,-698.55"/>
</g>
<!-- k_proj_15&#45;&gt;attn_scores_15 -->
<g id="edge1295" class="edge">
<title>k_proj_15&#45;&gt;attn_scores_15</title>
<path fill="none" stroke="black" d="M5150.44,-724.53C5108.82,-714.19 5058.49,-701.69 5015.59,-691.03"/>
<polygon fill="black" stroke="black" points="5016.26,-687.59 5005.71,-688.58 5014.57,-694.38 5016.26,-687.59"/>
</g>
<!-- v_proj_15&#45;&gt;attn_scores_15 -->
<g id="edge1296" class="edge">
<title>v_proj_15&#45;&gt;attn_scores_15</title>
<path fill="none" stroke="black" d="M4691.56,-724.53C4733.18,-714.19 4783.51,-701.69 4826.41,-691.03"/>
<polygon fill="black" stroke="black" points="4827.43,-694.38 4836.29,-688.58 4825.74,-687.59 4827.43,-694.38"/>
</g>
<!-- softmax_15 -->
<g id="node1071" class="node">
<title>softmax_15</title>
<polygon fill="lightgreen" stroke="black" points="5087.5,-608.53 4754.5,-608.53 4754.5,-564.53 5087.5,-564.53 5087.5,-608.53"/>
<text text-anchor="middle" x="4921" y="-599.33" font-family="Times,serif" font-size="9.00">Softmax L15</text>
<text text-anchor="middle" x="4921" y="-589.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4921" y="-579.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="4921" y="-569.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_15&#45;&gt;softmax_15 -->
<g id="edge1297" class="edge">
<title>attn_scores_15&#45;&gt;softmax_15</title>
<path fill="none" stroke="black" d="M4921,-644.22C4921,-636.33 4921,-627.22 4921,-618.64"/>
<polygon fill="black" stroke="black" points="4924.5,-618.55 4921,-608.55 4917.5,-618.55 4924.5,-618.55"/>
</g>
<!-- attn_out_15 -->
<g id="node1072" class="node">
<title>attn_out_15</title>
<polygon fill="lightgreen" stroke="black" points="5069,-528.53 4773,-528.53 4773,-484.53 5069,-484.53 5069,-528.53"/>
<text text-anchor="middle" x="4921" y="-519.33" font-family="Times,serif" font-size="9.00">Attention Output L15</text>
<text text-anchor="middle" x="4921" y="-509.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="4921" y="-499.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4921" y="-489.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_15&#45;&gt;attn_out_15 -->
<g id="edge1298" class="edge">
<title>softmax_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M4921,-564.22C4921,-556.33 4921,-547.22 4921,-538.64"/>
<polygon fill="black" stroke="black" points="4924.5,-538.55 4921,-528.55 4917.5,-538.55 4924.5,-538.55"/>
</g>
<!-- gate_15 -->
<g id="node1073" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="5220.74,-448.53 4743.92,-448.53 4621.26,-360.53 5098.08,-360.53 5220.74,-448.53"/>
<text text-anchor="middle" x="4921" y="-417.33" font-family="Times,serif" font-size="9.00">Gate L15</text>
<text text-anchor="middle" x="4921" y="-407.33" font-family="Times,serif" font-size="9.00">GPU: 448&#45;511</text>
<text text-anchor="middle" x="4921" y="-397.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4921" y="-387.33" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_15&#45;&gt;gate_15 -->
<g id="edge1299" class="edge">
<title>attn_out_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M4921,-484.33C4921,-476.83 4921,-468.02 4921,-459.06"/>
<polygon fill="black" stroke="black" points="4924.5,-458.94 4921,-448.94 4917.5,-458.94 4924.5,-458.94"/>
</g>
<!-- route_15_0 -->
<g id="node1074" class="node">
<title>route_15_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="644" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="644" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="644" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="644" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="644" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_0 -->
<g id="edge1300" class="edge">
<title>gate_15&#45;&gt;route_15_0</title>
<path fill="none" stroke="black" d="M4681.09,-403.57C4070.43,-402.61 2407.63,-393.32 1024,-324.53 958.75,-321.29 887.32,-316.07 824.17,-310.88"/>
<polygon fill="black" stroke="black" points="824.36,-307.38 814.11,-310.05 823.79,-314.36 824.36,-307.38"/>
</g>
<!-- route_15_1 -->
<g id="node1078" class="node">
<title>route_15_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1234" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1234" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1234" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 450,451</text>
<text text-anchor="middle" x="1234" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1234" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_1 -->
<g id="edge1305" class="edge">
<title>gate_15&#45;&gt;route_15_1</title>
<path fill="none" stroke="black" d="M4679.4,-402.33C4132.99,-398.6 2760.53,-383.61 1614,-324.53 1548.91,-321.18 1477.67,-315.95 1414.63,-310.78"/>
<polygon fill="black" stroke="black" points="1414.84,-307.29 1404.59,-309.96 1414.27,-314.27 1414.84,-307.29"/>
</g>
<!-- route_15_2 -->
<g id="node1082" class="node">
<title>route_15_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1824" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1824" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1824" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 452,453</text>
<text text-anchor="middle" x="1824" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1824" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_2 -->
<g id="edge1310" class="edge">
<title>gate_15&#45;&gt;route_15_2</title>
<path fill="none" stroke="black" d="M4676.82,-400.53C4200.8,-393.75 3115.5,-373.87 2204,-324.53 2139.08,-321.02 2068.02,-315.77 2005.1,-310.63"/>
<polygon fill="black" stroke="black" points="2005.32,-307.14 1995.07,-309.81 2004.75,-314.11 2005.32,-307.14"/>
</g>
<!-- route_15_3 -->
<g id="node1086" class="node">
<title>route_15_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2414" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2414" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2414" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 454,455</text>
<text text-anchor="middle" x="2414" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2414" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_3 -->
<g id="edge1315" class="edge">
<title>gate_15&#45;&gt;route_15_3</title>
<path fill="none" stroke="black" d="M4672.78,-397.69C4275.71,-387.59 3473.24,-364.04 2794,-324.53 2729.41,-320.78 2658.73,-315.5 2596.03,-310.41"/>
<polygon fill="black" stroke="black" points="2596.29,-306.92 2586.04,-309.59 2595.72,-313.89 2596.29,-306.92"/>
</g>
<!-- route_15_4 -->
<g id="node1090" class="node">
<title>route_15_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3004" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3004" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="3004" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 456,457</text>
<text text-anchor="middle" x="3004" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3004" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_4 -->
<g id="edge1320" class="edge">
<title>gate_15&#45;&gt;route_15_4</title>
<path fill="none" stroke="black" d="M4665.91,-392.59C4360.88,-379 3834.93,-353.98 3384,-324.53 3320.04,-320.36 3250.08,-315.03 3187.82,-310.02"/>
<polygon fill="black" stroke="black" points="3187.74,-306.5 3177.49,-309.19 3187.18,-313.48 3187.74,-306.5"/>
</g>
<!-- route_15_5 -->
<g id="node1094" class="node">
<title>route_15_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3594" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3594" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3594" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 458,459</text>
<text text-anchor="middle" x="3594" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3594" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_5 -->
<g id="edge1325" class="edge">
<title>gate_15&#45;&gt;route_15_5</title>
<path fill="none" stroke="black" d="M4650.06,-381.26C4390.32,-359.9 4005.23,-328.24 3778.92,-309.63"/>
<polygon fill="black" stroke="black" points="3779.18,-306.14 3768.93,-308.81 3778.61,-313.11 3779.18,-306.14"/>
</g>
<!-- route_15_6 -->
<g id="node1098" class="node">
<title>route_15_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4184" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4184" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4184" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 460,461</text>
<text text-anchor="middle" x="4184" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4184" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_6 -->
<g id="edge1330" class="edge">
<title>gate_15&#45;&gt;route_15_6</title>
<path fill="none" stroke="black" d="M4630.51,-360.53C4529.8,-345.62 4420.94,-329.5 4335.92,-316.91"/>
<polygon fill="black" stroke="black" points="4336.34,-313.44 4325.93,-315.43 4335.31,-320.36 4336.34,-313.44"/>
</g>
<!-- route_15_7 -->
<g id="node1102" class="node">
<title>route_15_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4712" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4712" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4712" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 462,463</text>
<text text-anchor="middle" x="4712" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4712" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_7 -->
<g id="edge1335" class="edge">
<title>gate_15&#45;&gt;route_15_7</title>
<path fill="none" stroke="black" d="M4838.4,-360.41C4817.91,-349.71 4796.25,-338.4 4776.75,-328.23"/>
<polygon fill="black" stroke="black" points="4778.15,-325.01 4767.67,-323.48 4774.91,-331.21 4778.15,-325.01"/>
</g>
<!-- route_15_8 -->
<g id="node1106" class="node">
<title>route_15_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5132" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5132" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5132" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="5132" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5132" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_8 -->
<g id="edge1340" class="edge">
<title>gate_15&#45;&gt;route_15_8</title>
<path fill="none" stroke="black" d="M5004.39,-360.41C5025.27,-349.61 5047.36,-338.19 5067.18,-327.94"/>
<polygon fill="black" stroke="black" points="5068.84,-331.02 5076.12,-323.32 5065.63,-324.8 5068.84,-331.02"/>
</g>
<!-- route_15_9 -->
<g id="node1110" class="node">
<title>route_15_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5659" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5659" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5659" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 482,483</text>
<text text-anchor="middle" x="5659" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5659" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_9 -->
<g id="edge1345" class="edge">
<title>gate_15&#45;&gt;route_15_9</title>
<path fill="none" stroke="black" d="M5117.8,-374.44C5239.76,-356.41 5394.08,-333.59 5506.69,-316.94"/>
<polygon fill="black" stroke="black" points="5507.39,-320.37 5516.77,-315.45 5506.37,-313.45 5507.39,-320.37"/>
</g>
<!-- route_15_10 -->
<g id="node1114" class="node">
<title>route_15_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6249" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6249" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6249" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 484,485</text>
<text text-anchor="middle" x="6249" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6249" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_10 -->
<g id="edge1350" class="edge">
<title>gate_15&#45;&gt;route_15_10</title>
<path fill="none" stroke="black" d="M5134,-386.03C5391.37,-364.89 5820.14,-329.66 6064.18,-309.61"/>
<polygon fill="black" stroke="black" points="6064.54,-313.09 6074.22,-308.78 6063.96,-306.11 6064.54,-313.09"/>
</g>
<!-- route_15_11 -->
<g id="node1118" class="node">
<title>route_15_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6839" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6839" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6839" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 486,487</text>
<text text-anchor="middle" x="6839" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6839" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_11 -->
<g id="edge1355" class="edge">
<title>gate_15&#45;&gt;route_15_11</title>
<path fill="none" stroke="black" d="M5144.94,-393.98C5444.44,-380.76 5991.94,-355.03 6459,-324.53 6522.96,-320.36 6592.92,-315.03 6655.18,-310.02"/>
<polygon fill="black" stroke="black" points="6655.82,-313.48 6665.51,-309.19 6655.26,-306.5 6655.82,-313.48"/>
</g>
<!-- route_15_12 -->
<g id="node1122" class="node">
<title>route_15_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7429" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7429" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7429" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 488,489</text>
<text text-anchor="middle" x="7429" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7429" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_12 -->
<g id="edge1360" class="edge">
<title>gate_15&#45;&gt;route_15_12</title>
<path fill="none" stroke="black" d="M5150.64,-398.17C5540.94,-388.34 6358.6,-364.69 7049,-324.53 7113.59,-320.78 7184.27,-315.5 7246.97,-310.41"/>
<polygon fill="black" stroke="black" points="7247.28,-313.89 7256.96,-309.59 7246.71,-306.92 7247.28,-313.89"/>
</g>
<!-- route_15_13 -->
<g id="node1126" class="node">
<title>route_15_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8019" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8019" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="8019" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 490,491</text>
<text text-anchor="middle" x="8019" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8019" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_13 -->
<g id="edge1365" class="edge">
<title>gate_15&#45;&gt;route_15_13</title>
<path fill="none" stroke="black" d="M5154.3,-400.68C5624.62,-394.07 6720.09,-374.27 7639,-324.53 7703.92,-321.02 7774.98,-315.77 7837.9,-310.63"/>
<polygon fill="black" stroke="black" points="7838.25,-314.11 7847.93,-309.81 7837.68,-307.14 7838.25,-314.11"/>
</g>
<!-- route_15_14 -->
<g id="node1130" class="node">
<title>route_15_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8609" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8609" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8609" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 492,493</text>
<text text-anchor="middle" x="8609" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8609" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_14 -->
<g id="edge1370" class="edge">
<title>gate_15&#45;&gt;route_15_14</title>
<path fill="none" stroke="black" d="M5156.56,-402.37C5698.95,-398.71 7077.82,-383.85 8229,-324.53 8294.09,-321.18 8365.33,-315.95 8428.37,-310.78"/>
<polygon fill="black" stroke="black" points="8428.73,-314.27 8438.41,-309.96 8428.16,-307.29 8428.73,-314.27"/>
</g>
<!-- route_15_15 -->
<g id="node1134" class="node">
<title>route_15_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9199" cy="-293.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9199" y="-306.22" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9199" y="-296.22" font-family="Times,serif" font-size="9.00">GPU: 494,495</text>
<text text-anchor="middle" x="9199" y="-286.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9199" y="-276.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_15 -->
<g id="edge1375" class="edge">
<title>gate_15&#45;&gt;route_15_15</title>
<path fill="none" stroke="black" d="M5158.19,-403.58C5766.71,-402.65 7432.91,-393.44 8819,-324.53 8884.25,-321.29 8955.68,-316.07 9018.83,-310.88"/>
<polygon fill="black" stroke="black" points="9019.21,-314.36 9028.89,-310.05 9018.64,-307.38 9019.21,-314.36"/>
</g>
<!-- expert_15_0_0 -->
<g id="node1075" class="node">
<title>expert_15_0_0</title>
<polygon fill="lightgreen" stroke="black" points="487.5,-226.31 210.5,-226.31 210.5,-182.31 487.5,-182.31 487.5,-226.31"/>
<text text-anchor="middle" x="349" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L15</text>
<text text-anchor="middle" x="349" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="349" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="349" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_0&#45;&gt;expert_15_0_0 -->
<g id="edge1301" class="edge">
<title>route_15_0&#45;&gt;expert_15_0_0</title>
<path fill="none" stroke="black" d="M553.08,-265.57C513.92,-254.01 468.49,-240.59 430.44,-229.36"/>
<polygon fill="black" stroke="black" points="431.01,-225.88 420.43,-226.4 429.03,-232.59 431.01,-225.88"/>
</g>
<!-- expert_15_0_1 -->
<g id="node1076" class="node">
<title>expert_15_0_1</title>
<polygon fill="lightgreen" stroke="black" points="782.5,-226.31 505.5,-226.31 505.5,-182.31 782.5,-182.31 782.5,-226.31"/>
<text text-anchor="middle" x="644" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L15</text>
<text text-anchor="middle" x="644" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="644" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="644" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_0&#45;&gt;expert_15_0_1 -->
<g id="edge1302" class="edge">
<title>route_15_0&#45;&gt;expert_15_0_1</title>
<path fill="none" stroke="black" d="M644,-261.95C644,-253.67 644,-244.7 644,-236.39"/>
<polygon fill="black" stroke="black" points="647.5,-236.31 644,-226.31 640.5,-236.31 647.5,-236.31"/>
</g>
<!-- tp_15_0 -->
<g id="node1077" class="node">
<title>tp_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="644" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="644" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L15</text>
<text text-anchor="middle" x="644" y="-118" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="644" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="644" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_0_0&#45;&gt;tp_15_0 -->
<g id="edge1303" class="edge">
<title>expert_15_0_0&#45;&gt;tp_15_0</title>
<path fill="none" stroke="black" d="M420.41,-182.22C461.87,-169.98 514.36,-154.48 558.07,-141.57"/>
<polygon fill="black" stroke="black" points="559.23,-144.88 567.83,-138.69 557.25,-138.16 559.23,-144.88"/>
</g>
<!-- expert_15_0_1&#45;&gt;tp_15_0 -->
<g id="edge1304" class="edge">
<title>expert_15_0_1&#45;&gt;tp_15_0</title>
<path fill="none" stroke="black" d="M644,-182.22C644,-174.55 644,-165.59 644,-156.8"/>
<polygon fill="black" stroke="black" points="647.5,-156.64 644,-146.64 640.5,-156.64 647.5,-156.64"/>
</g>
<!-- output -->
<g id="node1138" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="4921" cy="-24.04" rx="209.11" ry="24.08"/>
<text text-anchor="middle" x="4921" y="-31.84" font-family="Times,serif" font-size="9.00">Output</text>
<text text-anchor="middle" x="4921" y="-21.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4921" y="-11.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_15_0&#45;&gt;output -->
<g id="edge2100" class="edge">
<title>tp_15_0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M751.45,-103.29C845.61,-94.24 986.22,-81.93 1109,-76.08 1815.72,-42.43 4000.71,-29.39 4701.96,-26"/>
<polygon fill="black" stroke="black" points="4702.19,-29.5 4712.17,-25.95 4702.15,-22.5 4702.19,-29.5"/>
</g>
<!-- expert_15_1_0 -->
<g id="node1079" class="node">
<title>expert_15_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1077.5,-226.31 800.5,-226.31 800.5,-182.31 1077.5,-182.31 1077.5,-226.31"/>
<text text-anchor="middle" x="939" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L15</text>
<text text-anchor="middle" x="939" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 450</text>
<text text-anchor="middle" x="939" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="939" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_1&#45;&gt;expert_15_1_0 -->
<g id="edge1306" class="edge">
<title>route_15_1&#45;&gt;expert_15_1_0</title>
<path fill="none" stroke="black" d="M1143.08,-265.57C1103.92,-254.01 1058.49,-240.59 1020.44,-229.36"/>
<polygon fill="black" stroke="black" points="1021.01,-225.88 1010.43,-226.4 1019.03,-232.59 1021.01,-225.88"/>
</g>
<!-- expert_15_1_1 -->
<g id="node1080" class="node">
<title>expert_15_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1372.5,-226.31 1095.5,-226.31 1095.5,-182.31 1372.5,-182.31 1372.5,-226.31"/>
<text text-anchor="middle" x="1234" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L15</text>
<text text-anchor="middle" x="1234" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 451</text>
<text text-anchor="middle" x="1234" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1234" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_1&#45;&gt;expert_15_1_1 -->
<g id="edge1307" class="edge">
<title>route_15_1&#45;&gt;expert_15_1_1</title>
<path fill="none" stroke="black" d="M1234,-261.95C1234,-253.67 1234,-244.7 1234,-236.39"/>
<polygon fill="black" stroke="black" points="1237.5,-236.31 1234,-226.31 1230.5,-236.31 1237.5,-236.31"/>
</g>
<!-- tp_15_1 -->
<g id="node1081" class="node">
<title>tp_15_1</title>
<ellipse fill="lightblue" stroke="black" cx="1234" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1234" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L15</text>
<text text-anchor="middle" x="1234" y="-118" font-family="Times,serif" font-size="9.00">GPU: 450↔451</text>
<text text-anchor="middle" x="1234" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1234" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_1_0&#45;&gt;tp_15_1 -->
<g id="edge1308" class="edge">
<title>expert_15_1_0&#45;&gt;tp_15_1</title>
<path fill="none" stroke="black" d="M1010.41,-182.22C1051.87,-169.98 1104.36,-154.48 1148.07,-141.57"/>
<polygon fill="black" stroke="black" points="1149.23,-144.88 1157.83,-138.69 1147.25,-138.16 1149.23,-144.88"/>
</g>
<!-- expert_15_1_1&#45;&gt;tp_15_1 -->
<g id="edge1309" class="edge">
<title>expert_15_1_1&#45;&gt;tp_15_1</title>
<path fill="none" stroke="black" d="M1234,-182.22C1234,-174.55 1234,-165.59 1234,-156.8"/>
<polygon fill="black" stroke="black" points="1237.5,-156.64 1234,-146.64 1230.5,-156.64 1237.5,-156.64"/>
</g>
<!-- tp_15_1&#45;&gt;output -->
<g id="edge2101" class="edge">
<title>tp_15_1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1341.45,-103.37C1435.62,-94.36 1576.23,-82.08 1699,-76.08 2285.61,-47.43 4077.29,-31.44 4702.77,-26.62"/>
<polygon fill="black" stroke="black" points="4702.83,-30.12 4712.8,-26.54 4702.77,-23.12 4702.83,-30.12"/>
</g>
<!-- expert_15_2_0 -->
<g id="node1083" class="node">
<title>expert_15_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1667.5,-226.31 1390.5,-226.31 1390.5,-182.31 1667.5,-182.31 1667.5,-226.31"/>
<text text-anchor="middle" x="1529" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L15</text>
<text text-anchor="middle" x="1529" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 452</text>
<text text-anchor="middle" x="1529" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1529" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_2&#45;&gt;expert_15_2_0 -->
<g id="edge1311" class="edge">
<title>route_15_2&#45;&gt;expert_15_2_0</title>
<path fill="none" stroke="black" d="M1733.08,-265.57C1693.92,-254.01 1648.49,-240.59 1610.44,-229.36"/>
<polygon fill="black" stroke="black" points="1611.01,-225.88 1600.43,-226.4 1609.03,-232.59 1611.01,-225.88"/>
</g>
<!-- expert_15_2_1 -->
<g id="node1084" class="node">
<title>expert_15_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1962.5,-226.31 1685.5,-226.31 1685.5,-182.31 1962.5,-182.31 1962.5,-226.31"/>
<text text-anchor="middle" x="1824" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L15</text>
<text text-anchor="middle" x="1824" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 453</text>
<text text-anchor="middle" x="1824" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1824" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_2&#45;&gt;expert_15_2_1 -->
<g id="edge1312" class="edge">
<title>route_15_2&#45;&gt;expert_15_2_1</title>
<path fill="none" stroke="black" d="M1824,-261.95C1824,-253.67 1824,-244.7 1824,-236.39"/>
<polygon fill="black" stroke="black" points="1827.5,-236.31 1824,-226.31 1820.5,-236.31 1827.5,-236.31"/>
</g>
<!-- tp_15_2 -->
<g id="node1085" class="node">
<title>tp_15_2</title>
<ellipse fill="lightblue" stroke="black" cx="1824" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1824" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L15</text>
<text text-anchor="middle" x="1824" y="-118" font-family="Times,serif" font-size="9.00">GPU: 452↔453</text>
<text text-anchor="middle" x="1824" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1824" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_2_0&#45;&gt;tp_15_2 -->
<g id="edge1313" class="edge">
<title>expert_15_2_0&#45;&gt;tp_15_2</title>
<path fill="none" stroke="black" d="M1600.41,-182.22C1641.87,-169.98 1694.36,-154.48 1738.07,-141.57"/>
<polygon fill="black" stroke="black" points="1739.23,-144.88 1747.83,-138.69 1737.25,-138.16 1739.23,-144.88"/>
</g>
<!-- expert_15_2_1&#45;&gt;tp_15_2 -->
<g id="edge1314" class="edge">
<title>expert_15_2_1&#45;&gt;tp_15_2</title>
<path fill="none" stroke="black" d="M1824,-182.22C1824,-174.55 1824,-165.59 1824,-156.8"/>
<polygon fill="black" stroke="black" points="1827.5,-156.64 1824,-146.64 1820.5,-156.64 1827.5,-156.64"/>
</g>
<!-- tp_15_2&#45;&gt;output -->
<g id="edge2102" class="edge">
<title>tp_15_2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1931.46,-103.47C2025.63,-94.54 2166.24,-82.3 2289,-76.08 3182.81,-30.83 4249.22,-24.94 4701.21,-24.68"/>
<polygon fill="black" stroke="black" points="4701.45,-28.18 4711.45,-24.67 4701.44,-21.18 4701.45,-28.18"/>
</g>
<!-- expert_15_3_0 -->
<g id="node1087" class="node">
<title>expert_15_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2257.5,-226.31 1980.5,-226.31 1980.5,-182.31 2257.5,-182.31 2257.5,-226.31"/>
<text text-anchor="middle" x="2119" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L15</text>
<text text-anchor="middle" x="2119" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 454</text>
<text text-anchor="middle" x="2119" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2119" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_3&#45;&gt;expert_15_3_0 -->
<g id="edge1316" class="edge">
<title>route_15_3&#45;&gt;expert_15_3_0</title>
<path fill="none" stroke="black" d="M2323.08,-265.57C2283.92,-254.01 2238.49,-240.59 2200.44,-229.36"/>
<polygon fill="black" stroke="black" points="2201.01,-225.88 2190.43,-226.4 2199.03,-232.59 2201.01,-225.88"/>
</g>
<!-- expert_15_3_1 -->
<g id="node1088" class="node">
<title>expert_15_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2552.5,-226.31 2275.5,-226.31 2275.5,-182.31 2552.5,-182.31 2552.5,-226.31"/>
<text text-anchor="middle" x="2414" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L15</text>
<text text-anchor="middle" x="2414" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 455</text>
<text text-anchor="middle" x="2414" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2414" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_3&#45;&gt;expert_15_3_1 -->
<g id="edge1317" class="edge">
<title>route_15_3&#45;&gt;expert_15_3_1</title>
<path fill="none" stroke="black" d="M2414,-261.95C2414,-253.67 2414,-244.7 2414,-236.39"/>
<polygon fill="black" stroke="black" points="2417.5,-236.31 2414,-226.31 2410.5,-236.31 2417.5,-236.31"/>
</g>
<!-- tp_15_3 -->
<g id="node1089" class="node">
<title>tp_15_3</title>
<ellipse fill="lightblue" stroke="black" cx="2414" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2414" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L15</text>
<text text-anchor="middle" x="2414" y="-118" font-family="Times,serif" font-size="9.00">GPU: 454↔455</text>
<text text-anchor="middle" x="2414" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2414" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_3_0&#45;&gt;tp_15_3 -->
<g id="edge1318" class="edge">
<title>expert_15_3_0&#45;&gt;tp_15_3</title>
<path fill="none" stroke="black" d="M2190.41,-182.22C2231.87,-169.98 2284.36,-154.48 2328.07,-141.57"/>
<polygon fill="black" stroke="black" points="2329.23,-144.88 2337.83,-138.69 2327.25,-138.16 2329.23,-144.88"/>
</g>
<!-- expert_15_3_1&#45;&gt;tp_15_3 -->
<g id="edge1319" class="edge">
<title>expert_15_3_1&#45;&gt;tp_15_3</title>
<path fill="none" stroke="black" d="M2414,-182.22C2414,-174.55 2414,-165.59 2414,-156.8"/>
<polygon fill="black" stroke="black" points="2417.5,-156.64 2414,-146.64 2410.5,-156.64 2417.5,-156.64"/>
</g>
<!-- tp_15_3&#45;&gt;output -->
<g id="edge2103" class="edge">
<title>tp_15_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2521.93,-103.6C2616.1,-94.78 2756.46,-82.63 2879,-76.08 3542.46,-40.63 4328.52,-29.73 4702.38,-26.44"/>
<polygon fill="black" stroke="black" points="4702.53,-29.93 4712.5,-26.35 4702.47,-22.94 4702.53,-29.93"/>
</g>
<!-- expert_15_4_0 -->
<g id="node1091" class="node">
<title>expert_15_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2847.5,-226.31 2570.5,-226.31 2570.5,-182.31 2847.5,-182.31 2847.5,-226.31"/>
<text text-anchor="middle" x="2709" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L15</text>
<text text-anchor="middle" x="2709" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 456</text>
<text text-anchor="middle" x="2709" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2709" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_4&#45;&gt;expert_15_4_0 -->
<g id="edge1321" class="edge">
<title>route_15_4&#45;&gt;expert_15_4_0</title>
<path fill="none" stroke="black" d="M2913.08,-265.57C2873.92,-254.01 2828.49,-240.59 2790.44,-229.36"/>
<polygon fill="black" stroke="black" points="2791.01,-225.88 2780.43,-226.4 2789.03,-232.59 2791.01,-225.88"/>
</g>
<!-- expert_15_4_1 -->
<g id="node1092" class="node">
<title>expert_15_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3142.5,-226.31 2865.5,-226.31 2865.5,-182.31 3142.5,-182.31 3142.5,-226.31"/>
<text text-anchor="middle" x="3004" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L15</text>
<text text-anchor="middle" x="3004" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 457</text>
<text text-anchor="middle" x="3004" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3004" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_4&#45;&gt;expert_15_4_1 -->
<g id="edge1322" class="edge">
<title>route_15_4&#45;&gt;expert_15_4_1</title>
<path fill="none" stroke="black" d="M3004,-261.95C3004,-253.67 3004,-244.7 3004,-236.39"/>
<polygon fill="black" stroke="black" points="3007.5,-236.31 3004,-226.31 3000.5,-236.31 3007.5,-236.31"/>
</g>
<!-- tp_15_4 -->
<g id="node1093" class="node">
<title>tp_15_4</title>
<ellipse fill="lightblue" stroke="black" cx="3004" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3004" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L15</text>
<text text-anchor="middle" x="3004" y="-118" font-family="Times,serif" font-size="9.00">GPU: 456↔457</text>
<text text-anchor="middle" x="3004" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3004" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_4_0&#45;&gt;tp_15_4 -->
<g id="edge1323" class="edge">
<title>expert_15_4_0&#45;&gt;tp_15_4</title>
<path fill="none" stroke="black" d="M2780.41,-182.22C2821.87,-169.98 2874.36,-154.48 2918.07,-141.57"/>
<polygon fill="black" stroke="black" points="2919.23,-144.88 2927.83,-138.69 2917.25,-138.16 2919.23,-144.88"/>
</g>
<!-- expert_15_4_1&#45;&gt;tp_15_4 -->
<g id="edge1324" class="edge">
<title>expert_15_4_1&#45;&gt;tp_15_4</title>
<path fill="none" stroke="black" d="M3004,-182.22C3004,-174.55 3004,-165.59 3004,-156.8"/>
<polygon fill="black" stroke="black" points="3007.5,-156.64 3004,-146.64 3000.5,-156.64 3007.5,-156.64"/>
</g>
<!-- tp_15_4&#45;&gt;output -->
<g id="edge2104" class="edge">
<title>tp_15_4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3112.42,-103.87C3206.6,-95.24 3346.7,-83.24 3469,-76.08 3908.02,-50.39 4422.51,-36.02 4706.06,-29.47"/>
<polygon fill="black" stroke="black" points="4706.55,-32.96 4716.47,-29.23 4706.39,-25.96 4706.55,-32.96"/>
</g>
<!-- expert_15_5_0 -->
<g id="node1095" class="node">
<title>expert_15_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3437.5,-226.31 3160.5,-226.31 3160.5,-182.31 3437.5,-182.31 3437.5,-226.31"/>
<text text-anchor="middle" x="3299" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L15</text>
<text text-anchor="middle" x="3299" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 458</text>
<text text-anchor="middle" x="3299" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3299" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_5&#45;&gt;expert_15_5_0 -->
<g id="edge1326" class="edge">
<title>route_15_5&#45;&gt;expert_15_5_0</title>
<path fill="none" stroke="black" d="M3503.08,-265.57C3463.92,-254.01 3418.49,-240.59 3380.44,-229.36"/>
<polygon fill="black" stroke="black" points="3381.01,-225.88 3370.43,-226.4 3379.03,-232.59 3381.01,-225.88"/>
</g>
<!-- expert_15_5_1 -->
<g id="node1096" class="node">
<title>expert_15_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3732.5,-226.31 3455.5,-226.31 3455.5,-182.31 3732.5,-182.31 3732.5,-226.31"/>
<text text-anchor="middle" x="3594" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L15</text>
<text text-anchor="middle" x="3594" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 459</text>
<text text-anchor="middle" x="3594" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3594" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_5&#45;&gt;expert_15_5_1 -->
<g id="edge1327" class="edge">
<title>route_15_5&#45;&gt;expert_15_5_1</title>
<path fill="none" stroke="black" d="M3594,-261.95C3594,-253.67 3594,-244.7 3594,-236.39"/>
<polygon fill="black" stroke="black" points="3597.5,-236.31 3594,-226.31 3590.5,-236.31 3597.5,-236.31"/>
</g>
<!-- tp_15_5 -->
<g id="node1097" class="node">
<title>tp_15_5</title>
<ellipse fill="lightblue" stroke="black" cx="3594" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3594" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L15</text>
<text text-anchor="middle" x="3594" y="-118" font-family="Times,serif" font-size="9.00">GPU: 458↔459</text>
<text text-anchor="middle" x="3594" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3594" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_5_0&#45;&gt;tp_15_5 -->
<g id="edge1328" class="edge">
<title>expert_15_5_0&#45;&gt;tp_15_5</title>
<path fill="none" stroke="black" d="M3370.41,-182.22C3411.87,-169.98 3464.36,-154.48 3508.07,-141.57"/>
<polygon fill="black" stroke="black" points="3509.23,-144.88 3517.83,-138.69 3507.25,-138.16 3509.23,-144.88"/>
</g>
<!-- expert_15_5_1&#45;&gt;tp_15_5 -->
<g id="edge1329" class="edge">
<title>expert_15_5_1&#45;&gt;tp_15_5</title>
<path fill="none" stroke="black" d="M3594,-182.22C3594,-174.55 3594,-165.59 3594,-156.8"/>
<polygon fill="black" stroke="black" points="3597.5,-156.64 3594,-146.64 3590.5,-156.64 3597.5,-156.64"/>
</g>
<!-- tp_15_5&#45;&gt;output -->
<g id="edge2105" class="edge">
<title>tp_15_5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3703.4,-104.53C3797.6,-96.37 3937.2,-84.68 4059,-76.08 4286.93,-60 4549.01,-44.97 4723.77,-35.45"/>
<polygon fill="black" stroke="black" points="4724.06,-38.94 4733.85,-34.9 4723.68,-31.95 4724.06,-38.94"/>
</g>
<!-- expert_15_6_0 -->
<g id="node1099" class="node">
<title>expert_15_6_0</title>
<polygon fill="lightgreen" stroke="black" points="4027.5,-226.31 3750.5,-226.31 3750.5,-182.31 4027.5,-182.31 4027.5,-226.31"/>
<text text-anchor="middle" x="3889" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L15</text>
<text text-anchor="middle" x="3889" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 460</text>
<text text-anchor="middle" x="3889" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3889" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_6&#45;&gt;expert_15_6_0 -->
<g id="edge1331" class="edge">
<title>route_15_6&#45;&gt;expert_15_6_0</title>
<path fill="none" stroke="black" d="M4093.08,-265.57C4053.92,-254.01 4008.49,-240.59 3970.44,-229.36"/>
<polygon fill="black" stroke="black" points="3971.01,-225.88 3960.43,-226.4 3969.03,-232.59 3971.01,-225.88"/>
</g>
<!-- expert_15_6_1 -->
<g id="node1100" class="node">
<title>expert_15_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4322.5,-226.31 4045.5,-226.31 4045.5,-182.31 4322.5,-182.31 4322.5,-226.31"/>
<text text-anchor="middle" x="4184" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L15</text>
<text text-anchor="middle" x="4184" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 461</text>
<text text-anchor="middle" x="4184" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4184" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_6&#45;&gt;expert_15_6_1 -->
<g id="edge1332" class="edge">
<title>route_15_6&#45;&gt;expert_15_6_1</title>
<path fill="none" stroke="black" d="M4184,-261.95C4184,-253.67 4184,-244.7 4184,-236.39"/>
<polygon fill="black" stroke="black" points="4187.5,-236.31 4184,-226.31 4180.5,-236.31 4187.5,-236.31"/>
</g>
<!-- tp_15_6 -->
<g id="node1101" class="node">
<title>tp_15_6</title>
<ellipse fill="lightblue" stroke="black" cx="4184" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4184" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L15</text>
<text text-anchor="middle" x="4184" y="-118" font-family="Times,serif" font-size="9.00">GPU: 460↔461</text>
<text text-anchor="middle" x="4184" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4184" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_6_0&#45;&gt;tp_15_6 -->
<g id="edge1333" class="edge">
<title>expert_15_6_0&#45;&gt;tp_15_6</title>
<path fill="none" stroke="black" d="M3960.41,-182.22C4001.87,-169.98 4054.36,-154.48 4098.07,-141.57"/>
<polygon fill="black" stroke="black" points="4099.23,-144.88 4107.83,-138.69 4097.25,-138.16 4099.23,-144.88"/>
</g>
<!-- expert_15_6_1&#45;&gt;tp_15_6 -->
<g id="edge1334" class="edge">
<title>expert_15_6_1&#45;&gt;tp_15_6</title>
<path fill="none" stroke="black" d="M4184,-182.22C4184,-174.55 4184,-165.59 4184,-156.8"/>
<polygon fill="black" stroke="black" points="4187.5,-156.64 4184,-146.64 4180.5,-156.64 4187.5,-156.64"/>
</g>
<!-- tp_15_6&#45;&gt;output -->
<g id="edge2106" class="edge">
<title>tp_15_6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4288.42,-101.56C4414.45,-86.32 4627.31,-60.57 4770.92,-43.2"/>
<polygon fill="black" stroke="black" points="4771.63,-46.64 4781.14,-41.96 4770.79,-39.69 4771.63,-46.64"/>
</g>
<!-- expert_15_7_0 -->
<g id="node1103" class="node">
<title>expert_15_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4617.5,-226.31 4340.5,-226.31 4340.5,-182.31 4617.5,-182.31 4617.5,-226.31"/>
<text text-anchor="middle" x="4479" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L15</text>
<text text-anchor="middle" x="4479" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 462</text>
<text text-anchor="middle" x="4479" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4479" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_7&#45;&gt;expert_15_7_0 -->
<g id="edge1336" class="edge">
<title>route_15_7&#45;&gt;expert_15_7_0</title>
<path fill="none" stroke="black" d="M4637.32,-264.5C4607.66,-253.41 4573.83,-240.76 4545.08,-230.01"/>
<polygon fill="black" stroke="black" points="4546.13,-226.67 4535.54,-226.45 4543.68,-233.23 4546.13,-226.67"/>
</g>
<!-- expert_15_7_1 -->
<g id="node1104" class="node">
<title>expert_15_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4912.5,-226.31 4635.5,-226.31 4635.5,-182.31 4912.5,-182.31 4912.5,-226.31"/>
<text text-anchor="middle" x="4774" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L15</text>
<text text-anchor="middle" x="4774" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 463</text>
<text text-anchor="middle" x="4774" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4774" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_7&#45;&gt;expert_15_7_1 -->
<g id="edge1337" class="edge">
<title>route_15_7&#45;&gt;expert_15_7_1</title>
<path fill="none" stroke="black" d="M4733.34,-262.44C4739.71,-253.49 4746.68,-243.69 4753.03,-234.77"/>
<polygon fill="black" stroke="black" points="4755.94,-236.73 4758.88,-226.55 4750.23,-232.67 4755.94,-236.73"/>
</g>
<!-- tp_15_7 -->
<g id="node1105" class="node">
<title>tp_15_7</title>
<ellipse fill="lightblue" stroke="black" cx="4774" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4774" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L15</text>
<text text-anchor="middle" x="4774" y="-118" font-family="Times,serif" font-size="9.00">GPU: 462↔463</text>
<text text-anchor="middle" x="4774" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4774" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_7_0&#45;&gt;tp_15_7 -->
<g id="edge1338" class="edge">
<title>expert_15_7_0&#45;&gt;tp_15_7</title>
<path fill="none" stroke="black" d="M4550.41,-182.22C4591.87,-169.98 4644.36,-154.48 4688.07,-141.57"/>
<polygon fill="black" stroke="black" points="4689.23,-144.88 4697.83,-138.69 4687.25,-138.16 4689.23,-144.88"/>
</g>
<!-- expert_15_7_1&#45;&gt;tp_15_7 -->
<g id="edge1339" class="edge">
<title>expert_15_7_1&#45;&gt;tp_15_7</title>
<path fill="none" stroke="black" d="M4774,-182.22C4774,-174.55 4774,-165.59 4774,-156.8"/>
<polygon fill="black" stroke="black" points="4777.5,-156.64 4774,-146.64 4770.5,-156.64 4777.5,-156.64"/>
</g>
<!-- tp_15_7&#45;&gt;output -->
<g id="edge2107" class="edge">
<title>tp_15_7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4819.71,-86.48C4837.07,-75.94 4856.87,-63.94 4874.33,-53.35"/>
<polygon fill="black" stroke="black" points="4876.48,-56.13 4883.22,-47.96 4872.85,-50.15 4876.48,-56.13"/>
</g>
<!-- expert_15_8_0 -->
<g id="node1107" class="node">
<title>expert_15_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5207.5,-226.31 4930.5,-226.31 4930.5,-182.31 5207.5,-182.31 5207.5,-226.31"/>
<text text-anchor="middle" x="5069" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L15</text>
<text text-anchor="middle" x="5069" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="5069" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5069" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_8&#45;&gt;expert_15_8_0 -->
<g id="edge1341" class="edge">
<title>route_15_8&#45;&gt;expert_15_8_0</title>
<path fill="none" stroke="black" d="M5110.32,-262.44C5103.85,-253.49 5096.76,-243.69 5090.31,-234.77"/>
<polygon fill="black" stroke="black" points="5093.06,-232.6 5084.36,-226.55 5087.39,-236.7 5093.06,-232.6"/>
</g>
<!-- expert_15_8_1 -->
<g id="node1108" class="node">
<title>expert_15_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5502.5,-226.31 5225.5,-226.31 5225.5,-182.31 5502.5,-182.31 5502.5,-226.31"/>
<text text-anchor="middle" x="5364" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L15</text>
<text text-anchor="middle" x="5364" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="5364" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5364" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_8&#45;&gt;expert_15_8_1 -->
<g id="edge1342" class="edge">
<title>route_15_8&#45;&gt;expert_15_8_1</title>
<path fill="none" stroke="black" d="M5206.36,-264.5C5235.89,-253.41 5269.58,-240.76 5298.2,-230.01"/>
<polygon fill="black" stroke="black" points="5299.57,-233.24 5307.71,-226.45 5297.11,-226.69 5299.57,-233.24"/>
</g>
<!-- tp_15_8 -->
<g id="node1109" class="node">
<title>tp_15_8</title>
<ellipse fill="lightblue" stroke="black" cx="5069" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5069" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L15</text>
<text text-anchor="middle" x="5069" y="-118" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="5069" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5069" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_8_0&#45;&gt;tp_15_8 -->
<g id="edge1343" class="edge">
<title>expert_15_8_0&#45;&gt;tp_15_8</title>
<path fill="none" stroke="black" d="M5069,-182.22C5069,-174.55 5069,-165.59 5069,-156.8"/>
<polygon fill="black" stroke="black" points="5072.5,-156.64 5069,-146.64 5065.5,-156.64 5072.5,-156.64"/>
</g>
<!-- expert_15_8_1&#45;&gt;tp_15_8 -->
<g id="edge1344" class="edge">
<title>expert_15_8_1&#45;&gt;tp_15_8</title>
<path fill="none" stroke="black" d="M5292.59,-182.22C5251.13,-169.98 5198.64,-154.48 5154.93,-141.57"/>
<polygon fill="black" stroke="black" points="5155.75,-138.16 5145.17,-138.69 5153.77,-144.88 5155.75,-138.16"/>
</g>
<!-- tp_15_8&#45;&gt;output -->
<g id="edge2108" class="edge">
<title>tp_15_8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5022.98,-86.48C5005.5,-75.94 4985.56,-63.94 4967.99,-53.35"/>
<polygon fill="black" stroke="black" points="4969.41,-50.12 4959.04,-47.96 4965.8,-56.11 4969.41,-50.12"/>
</g>
<!-- expert_15_9_0 -->
<g id="node1111" class="node">
<title>expert_15_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5797.5,-226.31 5520.5,-226.31 5520.5,-182.31 5797.5,-182.31 5797.5,-226.31"/>
<text text-anchor="middle" x="5659" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L15</text>
<text text-anchor="middle" x="5659" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 482</text>
<text text-anchor="middle" x="5659" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5659" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_9&#45;&gt;expert_15_9_0 -->
<g id="edge1346" class="edge">
<title>route_15_9&#45;&gt;expert_15_9_0</title>
<path fill="none" stroke="black" d="M5659,-261.95C5659,-253.67 5659,-244.7 5659,-236.39"/>
<polygon fill="black" stroke="black" points="5662.5,-236.31 5659,-226.31 5655.5,-236.31 5662.5,-236.31"/>
</g>
<!-- expert_15_9_1 -->
<g id="node1112" class="node">
<title>expert_15_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6092.5,-226.31 5815.5,-226.31 5815.5,-182.31 6092.5,-182.31 6092.5,-226.31"/>
<text text-anchor="middle" x="5954" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L15</text>
<text text-anchor="middle" x="5954" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 483</text>
<text text-anchor="middle" x="5954" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5954" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_9&#45;&gt;expert_15_9_1 -->
<g id="edge1347" class="edge">
<title>route_15_9&#45;&gt;expert_15_9_1</title>
<path fill="none" stroke="black" d="M5749.92,-265.57C5789.08,-254.01 5834.51,-240.59 5872.56,-229.36"/>
<polygon fill="black" stroke="black" points="5873.97,-232.59 5882.57,-226.4 5871.99,-225.88 5873.97,-232.59"/>
</g>
<!-- tp_15_9 -->
<g id="node1113" class="node">
<title>tp_15_9</title>
<ellipse fill="lightblue" stroke="black" cx="5659" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5659" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L15</text>
<text text-anchor="middle" x="5659" y="-118" font-family="Times,serif" font-size="9.00">GPU: 482↔483</text>
<text text-anchor="middle" x="5659" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5659" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_9_0&#45;&gt;tp_15_9 -->
<g id="edge1348" class="edge">
<title>expert_15_9_0&#45;&gt;tp_15_9</title>
<path fill="none" stroke="black" d="M5659,-182.22C5659,-174.55 5659,-165.59 5659,-156.8"/>
<polygon fill="black" stroke="black" points="5662.5,-156.64 5659,-146.64 5655.5,-156.64 5662.5,-156.64"/>
</g>
<!-- expert_15_9_1&#45;&gt;tp_15_9 -->
<g id="edge1349" class="edge">
<title>expert_15_9_1&#45;&gt;tp_15_9</title>
<path fill="none" stroke="black" d="M5882.59,-182.22C5841.13,-169.98 5788.64,-154.48 5744.93,-141.57"/>
<polygon fill="black" stroke="black" points="5745.75,-138.16 5735.17,-138.69 5743.77,-144.88 5745.75,-138.16"/>
</g>
<!-- tp_15_9&#45;&gt;output -->
<g id="edge2109" class="edge">
<title>tp_15_9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5554.44,-101.56C5428.23,-86.32 5215.09,-60.57 5071.29,-43.2"/>
<polygon fill="black" stroke="black" points="5071.4,-39.69 5061.05,-41.96 5070.56,-46.64 5071.4,-39.69"/>
</g>
<!-- expert_15_10_0 -->
<g id="node1115" class="node">
<title>expert_15_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6387.5,-226.31 6110.5,-226.31 6110.5,-182.31 6387.5,-182.31 6387.5,-226.31"/>
<text text-anchor="middle" x="6249" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L15</text>
<text text-anchor="middle" x="6249" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 484</text>
<text text-anchor="middle" x="6249" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6249" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_10&#45;&gt;expert_15_10_0 -->
<g id="edge1351" class="edge">
<title>route_15_10&#45;&gt;expert_15_10_0</title>
<path fill="none" stroke="black" d="M6249,-261.95C6249,-253.67 6249,-244.7 6249,-236.39"/>
<polygon fill="black" stroke="black" points="6252.5,-236.31 6249,-226.31 6245.5,-236.31 6252.5,-236.31"/>
</g>
<!-- expert_15_10_1 -->
<g id="node1116" class="node">
<title>expert_15_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6682.5,-226.31 6405.5,-226.31 6405.5,-182.31 6682.5,-182.31 6682.5,-226.31"/>
<text text-anchor="middle" x="6544" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L15</text>
<text text-anchor="middle" x="6544" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 485</text>
<text text-anchor="middle" x="6544" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6544" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_10&#45;&gt;expert_15_10_1 -->
<g id="edge1352" class="edge">
<title>route_15_10&#45;&gt;expert_15_10_1</title>
<path fill="none" stroke="black" d="M6339.92,-265.57C6379.08,-254.01 6424.51,-240.59 6462.56,-229.36"/>
<polygon fill="black" stroke="black" points="6463.97,-232.59 6472.57,-226.4 6461.99,-225.88 6463.97,-232.59"/>
</g>
<!-- tp_15_10 -->
<g id="node1117" class="node">
<title>tp_15_10</title>
<ellipse fill="lightblue" stroke="black" cx="6249" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6249" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L15</text>
<text text-anchor="middle" x="6249" y="-118" font-family="Times,serif" font-size="9.00">GPU: 484↔485</text>
<text text-anchor="middle" x="6249" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6249" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_10_0&#45;&gt;tp_15_10 -->
<g id="edge1353" class="edge">
<title>expert_15_10_0&#45;&gt;tp_15_10</title>
<path fill="none" stroke="black" d="M6249,-182.22C6249,-174.55 6249,-165.59 6249,-156.8"/>
<polygon fill="black" stroke="black" points="6252.5,-156.64 6249,-146.64 6245.5,-156.64 6252.5,-156.64"/>
</g>
<!-- expert_15_10_1&#45;&gt;tp_15_10 -->
<g id="edge1354" class="edge">
<title>expert_15_10_1&#45;&gt;tp_15_10</title>
<path fill="none" stroke="black" d="M6472.59,-182.22C6431.13,-169.98 6378.64,-154.48 6334.93,-141.57"/>
<polygon fill="black" stroke="black" points="6335.75,-138.16 6325.17,-138.69 6333.77,-144.88 6335.75,-138.16"/>
</g>
<!-- tp_15_10&#45;&gt;output -->
<g id="edge2110" class="edge">
<title>tp_15_10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6139.6,-104.52C6045.4,-96.36 5905.8,-84.68 5784,-76.08 5555.62,-59.97 5293,-44.94 5118.03,-35.42"/>
<polygon fill="black" stroke="black" points="5118.12,-31.92 5107.94,-34.87 5117.74,-38.91 5118.12,-31.92"/>
</g>
<!-- expert_15_11_0 -->
<g id="node1119" class="node">
<title>expert_15_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6977.5,-226.31 6700.5,-226.31 6700.5,-182.31 6977.5,-182.31 6977.5,-226.31"/>
<text text-anchor="middle" x="6839" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L15</text>
<text text-anchor="middle" x="6839" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 486</text>
<text text-anchor="middle" x="6839" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6839" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_11&#45;&gt;expert_15_11_0 -->
<g id="edge1356" class="edge">
<title>route_15_11&#45;&gt;expert_15_11_0</title>
<path fill="none" stroke="black" d="M6839,-261.95C6839,-253.67 6839,-244.7 6839,-236.39"/>
<polygon fill="black" stroke="black" points="6842.5,-236.31 6839,-226.31 6835.5,-236.31 6842.5,-236.31"/>
</g>
<!-- expert_15_11_1 -->
<g id="node1120" class="node">
<title>expert_15_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7272.5,-226.31 6995.5,-226.31 6995.5,-182.31 7272.5,-182.31 7272.5,-226.31"/>
<text text-anchor="middle" x="7134" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L15</text>
<text text-anchor="middle" x="7134" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 487</text>
<text text-anchor="middle" x="7134" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7134" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_11&#45;&gt;expert_15_11_1 -->
<g id="edge1357" class="edge">
<title>route_15_11&#45;&gt;expert_15_11_1</title>
<path fill="none" stroke="black" d="M6929.92,-265.57C6969.08,-254.01 7014.51,-240.59 7052.56,-229.36"/>
<polygon fill="black" stroke="black" points="7053.97,-232.59 7062.57,-226.4 7051.99,-225.88 7053.97,-232.59"/>
</g>
<!-- tp_15_11 -->
<g id="node1121" class="node">
<title>tp_15_11</title>
<ellipse fill="lightblue" stroke="black" cx="6839" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6839" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L15</text>
<text text-anchor="middle" x="6839" y="-118" font-family="Times,serif" font-size="9.00">GPU: 486↔487</text>
<text text-anchor="middle" x="6839" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6839" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_11_0&#45;&gt;tp_15_11 -->
<g id="edge1358" class="edge">
<title>expert_15_11_0&#45;&gt;tp_15_11</title>
<path fill="none" stroke="black" d="M6839,-182.22C6839,-174.55 6839,-165.59 6839,-156.8"/>
<polygon fill="black" stroke="black" points="6842.5,-156.64 6839,-146.64 6835.5,-156.64 6842.5,-156.64"/>
</g>
<!-- expert_15_11_1&#45;&gt;tp_15_11 -->
<g id="edge1359" class="edge">
<title>expert_15_11_1&#45;&gt;tp_15_11</title>
<path fill="none" stroke="black" d="M7062.59,-182.22C7021.13,-169.98 6968.64,-154.48 6924.93,-141.57"/>
<polygon fill="black" stroke="black" points="6925.75,-138.16 6915.17,-138.69 6923.77,-144.88 6925.75,-138.16"/>
</g>
<!-- tp_15_11&#45;&gt;output -->
<g id="edge2111" class="edge">
<title>tp_15_11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6730.58,-103.87C6636.4,-95.24 6496.3,-83.24 6374,-76.08 5934.68,-50.38 5419.83,-36.01 5136.09,-29.46"/>
<polygon fill="black" stroke="black" points="5135.75,-25.95 5125.67,-29.22 5135.59,-32.95 5135.75,-25.95"/>
</g>
<!-- expert_15_12_0 -->
<g id="node1123" class="node">
<title>expert_15_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7567.5,-226.31 7290.5,-226.31 7290.5,-182.31 7567.5,-182.31 7567.5,-226.31"/>
<text text-anchor="middle" x="7429" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L15</text>
<text text-anchor="middle" x="7429" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 488</text>
<text text-anchor="middle" x="7429" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7429" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_12&#45;&gt;expert_15_12_0 -->
<g id="edge1361" class="edge">
<title>route_15_12&#45;&gt;expert_15_12_0</title>
<path fill="none" stroke="black" d="M7429,-261.95C7429,-253.67 7429,-244.7 7429,-236.39"/>
<polygon fill="black" stroke="black" points="7432.5,-236.31 7429,-226.31 7425.5,-236.31 7432.5,-236.31"/>
</g>
<!-- expert_15_12_1 -->
<g id="node1124" class="node">
<title>expert_15_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7862.5,-226.31 7585.5,-226.31 7585.5,-182.31 7862.5,-182.31 7862.5,-226.31"/>
<text text-anchor="middle" x="7724" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L15</text>
<text text-anchor="middle" x="7724" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 489</text>
<text text-anchor="middle" x="7724" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7724" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_12&#45;&gt;expert_15_12_1 -->
<g id="edge1362" class="edge">
<title>route_15_12&#45;&gt;expert_15_12_1</title>
<path fill="none" stroke="black" d="M7519.92,-265.57C7559.08,-254.01 7604.51,-240.59 7642.56,-229.36"/>
<polygon fill="black" stroke="black" points="7643.97,-232.59 7652.57,-226.4 7641.99,-225.88 7643.97,-232.59"/>
</g>
<!-- tp_15_12 -->
<g id="node1125" class="node">
<title>tp_15_12</title>
<ellipse fill="lightblue" stroke="black" cx="7429" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7429" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L15</text>
<text text-anchor="middle" x="7429" y="-118" font-family="Times,serif" font-size="9.00">GPU: 488↔489</text>
<text text-anchor="middle" x="7429" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7429" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_12_0&#45;&gt;tp_15_12 -->
<g id="edge1363" class="edge">
<title>expert_15_12_0&#45;&gt;tp_15_12</title>
<path fill="none" stroke="black" d="M7429,-182.22C7429,-174.55 7429,-165.59 7429,-156.8"/>
<polygon fill="black" stroke="black" points="7432.5,-156.64 7429,-146.64 7425.5,-156.64 7432.5,-156.64"/>
</g>
<!-- expert_15_12_1&#45;&gt;tp_15_12 -->
<g id="edge1364" class="edge">
<title>expert_15_12_1&#45;&gt;tp_15_12</title>
<path fill="none" stroke="black" d="M7652.59,-182.22C7611.13,-169.98 7558.64,-154.48 7514.93,-141.57"/>
<polygon fill="black" stroke="black" points="7515.75,-138.16 7505.17,-138.69 7513.77,-144.88 7515.75,-138.16"/>
</g>
<!-- tp_15_12&#45;&gt;output -->
<g id="edge2112" class="edge">
<title>tp_15_12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7321.07,-103.6C7226.9,-94.78 7086.54,-82.63 6964,-76.08 6300.22,-40.62 5513.77,-29.72 5139.73,-26.43"/>
<polygon fill="black" stroke="black" points="5139.63,-22.93 5129.6,-26.35 5139.57,-29.93 5139.63,-22.93"/>
</g>
<!-- expert_15_13_0 -->
<g id="node1127" class="node">
<title>expert_15_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8157.5,-226.31 7880.5,-226.31 7880.5,-182.31 8157.5,-182.31 8157.5,-226.31"/>
<text text-anchor="middle" x="8019" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L15</text>
<text text-anchor="middle" x="8019" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 490</text>
<text text-anchor="middle" x="8019" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8019" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_13&#45;&gt;expert_15_13_0 -->
<g id="edge1366" class="edge">
<title>route_15_13&#45;&gt;expert_15_13_0</title>
<path fill="none" stroke="black" d="M8019,-261.95C8019,-253.67 8019,-244.7 8019,-236.39"/>
<polygon fill="black" stroke="black" points="8022.5,-236.31 8019,-226.31 8015.5,-236.31 8022.5,-236.31"/>
</g>
<!-- expert_15_13_1 -->
<g id="node1128" class="node">
<title>expert_15_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8452.5,-226.31 8175.5,-226.31 8175.5,-182.31 8452.5,-182.31 8452.5,-226.31"/>
<text text-anchor="middle" x="8314" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L15</text>
<text text-anchor="middle" x="8314" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 491</text>
<text text-anchor="middle" x="8314" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8314" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_13&#45;&gt;expert_15_13_1 -->
<g id="edge1367" class="edge">
<title>route_15_13&#45;&gt;expert_15_13_1</title>
<path fill="none" stroke="black" d="M8109.92,-265.57C8149.08,-254.01 8194.51,-240.59 8232.56,-229.36"/>
<polygon fill="black" stroke="black" points="8233.97,-232.59 8242.57,-226.4 8231.99,-225.88 8233.97,-232.59"/>
</g>
<!-- tp_15_13 -->
<g id="node1129" class="node">
<title>tp_15_13</title>
<ellipse fill="lightblue" stroke="black" cx="8019" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8019" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L15</text>
<text text-anchor="middle" x="8019" y="-118" font-family="Times,serif" font-size="9.00">GPU: 490↔491</text>
<text text-anchor="middle" x="8019" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8019" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_13_0&#45;&gt;tp_15_13 -->
<g id="edge1368" class="edge">
<title>expert_15_13_0&#45;&gt;tp_15_13</title>
<path fill="none" stroke="black" d="M8019,-182.22C8019,-174.55 8019,-165.59 8019,-156.8"/>
<polygon fill="black" stroke="black" points="8022.5,-156.64 8019,-146.64 8015.5,-156.64 8022.5,-156.64"/>
</g>
<!-- expert_15_13_1&#45;&gt;tp_15_13 -->
<g id="edge1369" class="edge">
<title>expert_15_13_1&#45;&gt;tp_15_13</title>
<path fill="none" stroke="black" d="M8242.59,-182.22C8201.13,-169.98 8148.64,-154.48 8104.93,-141.57"/>
<polygon fill="black" stroke="black" points="8105.75,-138.16 8095.17,-138.69 8103.77,-144.88 8105.75,-138.16"/>
</g>
<!-- tp_15_13&#45;&gt;output -->
<g id="edge2113" class="edge">
<title>tp_15_13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7911.54,-103.47C7817.37,-94.54 7676.76,-82.3 7554,-76.08 6659.85,-30.82 5593.04,-24.94 5140.87,-24.67"/>
<polygon fill="black" stroke="black" points="5140.64,-21.17 5130.63,-24.67 5140.63,-28.17 5140.64,-21.17"/>
</g>
<!-- expert_15_14_0 -->
<g id="node1131" class="node">
<title>expert_15_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8747.5,-226.31 8470.5,-226.31 8470.5,-182.31 8747.5,-182.31 8747.5,-226.31"/>
<text text-anchor="middle" x="8609" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L15</text>
<text text-anchor="middle" x="8609" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 492</text>
<text text-anchor="middle" x="8609" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8609" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_14&#45;&gt;expert_15_14_0 -->
<g id="edge1371" class="edge">
<title>route_15_14&#45;&gt;expert_15_14_0</title>
<path fill="none" stroke="black" d="M8609,-261.95C8609,-253.67 8609,-244.7 8609,-236.39"/>
<polygon fill="black" stroke="black" points="8612.5,-236.31 8609,-226.31 8605.5,-236.31 8612.5,-236.31"/>
</g>
<!-- expert_15_14_1 -->
<g id="node1132" class="node">
<title>expert_15_14_1</title>
<polygon fill="lightgreen" stroke="black" points="9042.5,-226.31 8765.5,-226.31 8765.5,-182.31 9042.5,-182.31 9042.5,-226.31"/>
<text text-anchor="middle" x="8904" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L15</text>
<text text-anchor="middle" x="8904" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 493</text>
<text text-anchor="middle" x="8904" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8904" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_14&#45;&gt;expert_15_14_1 -->
<g id="edge1372" class="edge">
<title>route_15_14&#45;&gt;expert_15_14_1</title>
<path fill="none" stroke="black" d="M8699.92,-265.57C8739.08,-254.01 8784.51,-240.59 8822.56,-229.36"/>
<polygon fill="black" stroke="black" points="8823.97,-232.59 8832.57,-226.4 8821.99,-225.88 8823.97,-232.59"/>
</g>
<!-- tp_15_14 -->
<g id="node1133" class="node">
<title>tp_15_14</title>
<ellipse fill="lightblue" stroke="black" cx="8609" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8609" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L15</text>
<text text-anchor="middle" x="8609" y="-118" font-family="Times,serif" font-size="9.00">GPU: 492↔493</text>
<text text-anchor="middle" x="8609" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8609" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_14_0&#45;&gt;tp_15_14 -->
<g id="edge1373" class="edge">
<title>expert_15_14_0&#45;&gt;tp_15_14</title>
<path fill="none" stroke="black" d="M8609,-182.22C8609,-174.55 8609,-165.59 8609,-156.8"/>
<polygon fill="black" stroke="black" points="8612.5,-156.64 8609,-146.64 8605.5,-156.64 8612.5,-156.64"/>
</g>
<!-- expert_15_14_1&#45;&gt;tp_15_14 -->
<g id="edge1374" class="edge">
<title>expert_15_14_1&#45;&gt;tp_15_14</title>
<path fill="none" stroke="black" d="M8832.59,-182.22C8791.13,-169.98 8738.64,-154.48 8694.93,-141.57"/>
<polygon fill="black" stroke="black" points="8695.75,-138.16 8685.17,-138.69 8693.77,-144.88 8695.75,-138.16"/>
</g>
<!-- tp_15_14&#45;&gt;output -->
<g id="edge2114" class="edge">
<title>tp_15_14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8501.55,-103.37C8407.38,-94.36 8266.77,-82.08 8144,-76.08 7557.21,-47.42 5764.97,-31.44 5139.3,-26.62"/>
<polygon fill="black" stroke="black" points="5139.29,-23.12 5129.27,-26.54 5139.24,-30.12 5139.29,-23.12"/>
</g>
<!-- expert_15_15_0 -->
<g id="node1135" class="node">
<title>expert_15_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9337.5,-226.31 9060.5,-226.31 9060.5,-182.31 9337.5,-182.31 9337.5,-226.31"/>
<text text-anchor="middle" x="9199" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L15</text>
<text text-anchor="middle" x="9199" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 494</text>
<text text-anchor="middle" x="9199" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9199" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_15&#45;&gt;expert_15_15_0 -->
<g id="edge1376" class="edge">
<title>route_15_15&#45;&gt;expert_15_15_0</title>
<path fill="none" stroke="black" d="M9199,-261.95C9199,-253.67 9199,-244.7 9199,-236.39"/>
<polygon fill="black" stroke="black" points="9202.5,-236.31 9199,-226.31 9195.5,-236.31 9202.5,-236.31"/>
</g>
<!-- expert_15_15_1 -->
<g id="node1136" class="node">
<title>expert_15_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9632.5,-226.31 9355.5,-226.31 9355.5,-182.31 9632.5,-182.31 9632.5,-226.31"/>
<text text-anchor="middle" x="9494" y="-217.11" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L15</text>
<text text-anchor="middle" x="9494" y="-207.11" font-family="Times,serif" font-size="9.00">GPU: 495</text>
<text text-anchor="middle" x="9494" y="-197.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9494" y="-187.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_15&#45;&gt;expert_15_15_1 -->
<g id="edge1377" class="edge">
<title>route_15_15&#45;&gt;expert_15_15_1</title>
<path fill="none" stroke="black" d="M9289.92,-265.57C9329.08,-254.01 9374.51,-240.59 9412.56,-229.36"/>
<polygon fill="black" stroke="black" points="9413.97,-232.59 9422.57,-226.4 9411.99,-225.88 9413.97,-232.59"/>
</g>
<!-- tp_15_15 -->
<g id="node1137" class="node">
<title>tp_15_15</title>
<ellipse fill="lightblue" stroke="black" cx="9199" cy="-115.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9199" y="-128" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L15</text>
<text text-anchor="middle" x="9199" y="-118" font-family="Times,serif" font-size="9.00">GPU: 494↔495</text>
<text text-anchor="middle" x="9199" y="-108" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9199" y="-98" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_15_0&#45;&gt;tp_15_15 -->
<g id="edge1378" class="edge">
<title>expert_15_15_0&#45;&gt;tp_15_15</title>
<path fill="none" stroke="black" d="M9199,-182.22C9199,-174.55 9199,-165.59 9199,-156.8"/>
<polygon fill="black" stroke="black" points="9202.5,-156.64 9199,-146.64 9195.5,-156.64 9202.5,-156.64"/>
</g>
<!-- expert_15_15_1&#45;&gt;tp_15_15 -->
<g id="edge1379" class="edge">
<title>expert_15_15_1&#45;&gt;tp_15_15</title>
<path fill="none" stroke="black" d="M9422.59,-182.22C9381.13,-169.98 9328.64,-154.48 9284.93,-141.57"/>
<polygon fill="black" stroke="black" points="9285.75,-138.16 9275.17,-138.69 9283.77,-144.88 9285.75,-138.16"/>
</g>
<!-- tp_15_15&#45;&gt;output -->
<g id="edge2115" class="edge">
<title>tp_15_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9091.55,-103.29C8997.39,-94.24 8856.78,-81.93 8734,-76.08 8027.1,-42.42 5841.53,-29.38 5140.1,-26"/>
<polygon fill="black" stroke="black" points="5139.9,-22.5 5129.88,-25.95 5139.87,-29.5 5139.9,-22.5"/>
</g>
</g>
</svg>
