<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="91pt"
 viewBox="0.00 0.00 1440.00 91.07" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 1225.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1225.91 19443.72,-1225.91 19443.72,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="9385.86,-1221.91 9130.86,-1221.91 9130.86,-1180.91 9385.86,-1180.91 9385.86,-1221.91"/>
<text text-anchor="middle" x="9258.36" y="-1209.91" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="9258.36" y="-1198.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9258.36" y="-1187.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- embed_gpu0 -->
<g id="node2" class="node">
<title>embed_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="9291.86,-1143.91 9036.86,-1143.91 9036.86,-1102.91 9291.86,-1102.91 9291.86,-1143.91"/>
<text text-anchor="middle" x="9164.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU0: Token Embedding</text>
<text text-anchor="middle" x="9164.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9164.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_gpu0</title>
<path fill="none" stroke="black" d="M9234.16,-1180.84C9222.64,-1171.53 9208.72,-1160.28 9196.35,-1150.28"/>
<polygon fill="black" stroke="black" points="9198.46,-1147.48 9188.49,-1143.92 9194.06,-1152.93 9198.46,-1147.48"/>
</g>
<!-- embed_gpu1 -->
<g id="node3" class="node">
<title>embed_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="8028.86,-1143.91 7773.86,-1143.91 7773.86,-1102.91 8028.86,-1102.91 8028.86,-1143.91"/>
<text text-anchor="middle" x="7901.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU1: Token Embedding</text>
<text text-anchor="middle" x="7901.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7901.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;embed_gpu1</title>
<path fill="none" stroke="black" d="M9130.7,-1193.26C8875.19,-1178.95 8302.88,-1146.9 8039.2,-1132.13"/>
<polygon fill="black" stroke="black" points="8039.36,-1128.64 8029.18,-1131.57 8038.97,-1135.63 8039.36,-1128.64"/>
</g>
<!-- embed_gpu2 -->
<g id="node4" class="node">
<title>embed_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="8570.86,-1143.91 8315.86,-1143.91 8315.86,-1102.91 8570.86,-1102.91 8570.86,-1143.91"/>
<text text-anchor="middle" x="8443.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU2: Token Embedding</text>
<text text-anchor="middle" x="8443.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8443.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;embed_gpu2</title>
<path fill="none" stroke="black" d="M9130.57,-1188.5C8981.09,-1174.56 8734.57,-1151.57 8580.98,-1137.25"/>
<polygon fill="black" stroke="black" points="8581.29,-1133.76 8571,-1136.32 8580.64,-1140.73 8581.29,-1133.76"/>
</g>
<!-- embed_gpu3 -->
<g id="node5" class="node">
<title>embed_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="8943.86,-1143.91 8688.86,-1143.91 8688.86,-1102.91 8943.86,-1102.91 8943.86,-1143.91"/>
<text text-anchor="middle" x="8816.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU3: Token Embedding</text>
<text text-anchor="middle" x="8816.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8816.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;embed_gpu3</title>
<path fill="none" stroke="black" d="M9144.82,-1180.89C9082.18,-1170.12 9004.32,-1156.73 8940.13,-1145.69"/>
<polygon fill="black" stroke="black" points="8940.39,-1142.19 8929.95,-1143.94 8939.21,-1149.09 8940.39,-1142.19"/>
</g>
<!-- embed_gpu4 -->
<g id="node6" class="node">
<title>embed_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="9604.86,-1143.91 9349.86,-1143.91 9349.86,-1102.91 9604.86,-1102.91 9604.86,-1143.91"/>
<text text-anchor="middle" x="9477.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU4: Token Embedding</text>
<text text-anchor="middle" x="9477.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9477.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;embed_gpu4</title>
<path fill="none" stroke="black" d="M9314.76,-1180.84C9344.26,-1170.6 9380.56,-1158.01 9411.36,-1147.32"/>
<polygon fill="black" stroke="black" points="9412.86,-1150.5 9421.16,-1143.92 9410.56,-1143.89 9412.86,-1150.5"/>
</g>
<!-- embed_gpu5 -->
<g id="node7" class="node">
<title>embed_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9897.86,-1143.91 9642.86,-1143.91 9642.86,-1102.91 9897.86,-1102.91 9897.86,-1143.91"/>
<text text-anchor="middle" x="9770.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU5: Token Embedding</text>
<text text-anchor="middle" x="9770.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9770.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;embed_gpu5</title>
<path fill="none" stroke="black" d="M9385.91,-1181.48C9460.88,-1170.35 9555.7,-1156.28 9632.41,-1144.89"/>
<polygon fill="black" stroke="black" points="9633.25,-1148.31 9642.62,-1143.37 9632.22,-1141.38 9633.25,-1148.31"/>
</g>
<!-- embed_gpu6 -->
<g id="node8" class="node">
<title>embed_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10787.86,-1143.91 10532.86,-1143.91 10532.86,-1102.91 10787.86,-1102.91 10787.86,-1143.91"/>
<text text-anchor="middle" x="10660.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU6: Token Embedding</text>
<text text-anchor="middle" x="10660.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10660.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;embed_gpu6</title>
<path fill="none" stroke="black" d="M9385.87,-1193.5C9649.04,-1179.24 10250.38,-1146.64 10522.31,-1131.9"/>
<polygon fill="black" stroke="black" points="10522.84,-1135.37 10532.64,-1131.34 10522.46,-1128.38 10522.84,-1135.37"/>
</g>
<!-- embed_gpu7 -->
<g id="node9" class="node">
<title>embed_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="10180.86,-1143.91 9925.86,-1143.91 9925.86,-1102.91 10180.86,-1102.91 10180.86,-1143.91"/>
<text text-anchor="middle" x="10053.36" y="-1131.91" font-family="Arial" font-size="10.00">GPU7: Token Embedding</text>
<text text-anchor="middle" x="10053.36" y="-1120.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10053.36" y="-1109.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;embed_gpu7</title>
<path fill="none" stroke="black" d="M9385.99,-1191.04C9516.99,-1181.02 9726.65,-1163.84 9907.36,-1143.91 9910.07,-1143.62 9912.8,-1143.31 9915.56,-1142.99"/>
<polygon fill="black" stroke="black" points="9916.08,-1146.46 9925.61,-1141.82 9915.27,-1139.5 9916.08,-1146.46"/>
</g>
<!-- attn_qkv_gpu0_layer1 -->
<g id="node10" class="node">
<title>attn_qkv_gpu0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9248.86,-1065.91 8973.86,-1065.91 8973.86,-1024.91 9248.86,-1024.91 9248.86,-1065.91"/>
<text text-anchor="middle" x="9111.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU0: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="9111.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9111.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu0&#45;&gt;attn_qkv_gpu0_layer1 -->
<g id="edge9" class="edge">
<title>embed_gpu0&#45;&gt;attn_qkv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9150.71,-1102.84C9144.66,-1094.15 9137.41,-1083.77 9130.81,-1074.29"/>
<polygon fill="black" stroke="black" points="9133.56,-1072.12 9124.97,-1065.92 9127.81,-1076.12 9133.56,-1072.12"/>
</g>
<!-- attn_qkv_gpu1_layer1 -->
<g id="node14" class="node">
<title>attn_qkv_gpu1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="7687.86,-1065.91 7412.86,-1065.91 7412.86,-1024.91 7687.86,-1024.91 7687.86,-1065.91"/>
<text text-anchor="middle" x="7550.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU1: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="7550.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7550.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu1&#45;&gt;attn_qkv_gpu1_layer1 -->
<g id="edge13" class="edge">
<title>embed_gpu1&#45;&gt;attn_qkv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M7810.97,-1102.84C7761.84,-1092.2 7700.97,-1079.02 7650.41,-1068.08"/>
<polygon fill="black" stroke="black" points="7650.96,-1064.61 7640.45,-1065.92 7649.48,-1071.46 7650.96,-1064.61"/>
</g>
<!-- attn_qkv_gpu2_layer1 -->
<g id="node18" class="node">
<title>attn_qkv_gpu2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8405.86,-1065.91 8130.86,-1065.91 8130.86,-1024.91 8405.86,-1024.91 8405.86,-1065.91"/>
<text text-anchor="middle" x="8268.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU2: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="8268.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8268.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu2&#45;&gt;attn_qkv_gpu2_layer1 -->
<g id="edge17" class="edge">
<title>embed_gpu2&#45;&gt;attn_qkv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8398.3,-1102.84C8375.23,-1092.82 8346.97,-1080.55 8322.71,-1070.01"/>
<polygon fill="black" stroke="black" points="8323.84,-1066.69 8313.28,-1065.92 8321.05,-1073.11 8323.84,-1066.69"/>
</g>
<!-- attn_qkv_gpu3_layer1 -->
<g id="node22" class="node">
<title>attn_qkv_gpu3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8869.86,-1065.91 8594.86,-1065.91 8594.86,-1024.91 8869.86,-1024.91 8869.86,-1065.91"/>
<text text-anchor="middle" x="8732.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU3: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="8732.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8732.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu3&#45;&gt;attn_qkv_gpu3_layer1 -->
<g id="edge21" class="edge">
<title>embed_gpu3&#45;&gt;attn_qkv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8794.73,-1102.84C8784.64,-1093.71 8772.48,-1082.71 8761.58,-1072.85"/>
<polygon fill="black" stroke="black" points="8763.68,-1070.03 8753.92,-1065.92 8758.99,-1075.22 8763.68,-1070.03"/>
</g>
<!-- attn_qkv_gpu4_layer1 -->
<g id="node26" class="node">
<title>attn_qkv_gpu4_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9705.86,-1065.91 9430.86,-1065.91 9430.86,-1024.91 9705.86,-1024.91 9705.86,-1065.91"/>
<text text-anchor="middle" x="9568.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU4: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="9568.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9568.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu4&#45;&gt;attn_qkv_gpu4_layer1 -->
<g id="edge25" class="edge">
<title>embed_gpu4&#45;&gt;attn_qkv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M9500.8,-1102.84C9511.84,-1093.62 9525.16,-1082.49 9537.05,-1072.56"/>
<polygon fill="black" stroke="black" points="9539.58,-1075.02 9545.01,-1065.92 9535.09,-1069.64 9539.58,-1075.02"/>
</g>
<!-- attn_qkv_gpu5_layer1 -->
<g id="node30" class="node">
<title>attn_qkv_gpu5_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10112.86,-1065.91 9837.86,-1065.91 9837.86,-1024.91 10112.86,-1024.91 10112.86,-1065.91"/>
<text text-anchor="middle" x="9975.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU5: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="9975.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9975.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu5&#45;&gt;attn_qkv_gpu5_layer1 -->
<g id="edge29" class="edge">
<title>embed_gpu5&#45;&gt;attn_qkv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M9823.16,-1102.84C9850.65,-1092.65 9884.45,-1080.12 9913.21,-1069.46"/>
<polygon fill="black" stroke="black" points="9914.59,-1072.68 9922.75,-1065.92 9912.16,-1066.11 9914.59,-1072.68"/>
</g>
<!-- attn_qkv_gpu6_layer1 -->
<g id="node34" class="node">
<title>attn_qkv_gpu6_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11136.86,-1065.91 10861.86,-1065.91 10861.86,-1024.91 11136.86,-1024.91 11136.86,-1065.91"/>
<text text-anchor="middle" x="10999.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU6: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="10999.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10999.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu6&#45;&gt;attn_qkv_gpu6_layer1 -->
<g id="edge33" class="edge">
<title>embed_gpu6&#45;&gt;attn_qkv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M10747.66,-1102.84C10795.02,-1092.23 10853.66,-1079.08 10902.43,-1068.15"/>
<polygon fill="black" stroke="black" points="10903.37,-1071.52 10912.36,-1065.92 10901.83,-1064.69 10903.37,-1071.52"/>
</g>
<!-- attn_qkv_gpu7_layer1 -->
<g id="node38" class="node">
<title>attn_qkv_gpu7_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10429.86,-1065.91 10154.86,-1065.91 10154.86,-1024.91 10429.86,-1024.91 10429.86,-1065.91"/>
<text text-anchor="middle" x="10292.36" y="-1053.91" font-family="Arial" font-size="10.00">GPU7: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="10292.36" y="-1042.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10292.36" y="-1031.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu7&#45;&gt;attn_qkv_gpu7_layer1 -->
<g id="edge37" class="edge">
<title>embed_gpu7&#45;&gt;attn_qkv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M10114.91,-1102.84C10147.39,-1092.51 10187.4,-1079.79 10221.21,-1069.04"/>
<polygon fill="black" stroke="black" points="10222.55,-1072.29 10231.02,-1065.92 10220.43,-1065.61 10222.55,-1072.29"/>
</g>
<!-- comm_qkv_gpu0_layer1 -->
<g id="node11" class="node">
<title>comm_qkv_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9079.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9079.36" y="-967.42" font-family="Arial" font-size="10.00">GPU0: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="9079.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9079.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu0_layer1&#45;&gt;comm_qkv_gpu0_layer1 -->
<g id="edge10" class="edge">
<title>attn_qkv_gpu0_layer1&#45;&gt;comm_qkv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9103.94,-1024.82C9100.87,-1016.71 9097.2,-1007.03 9093.65,-997.65"/>
<polygon fill="black" stroke="black" points="9096.83,-996.17 9090.02,-988.06 9090.29,-998.65 9096.83,-996.17"/>
</g>
<!-- attn_comp_gpu0_layer1 -->
<g id="node12" class="node">
<title>attn_comp_gpu0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9215.86,-892.93 8940.86,-892.93 8940.86,-851.93 9215.86,-851.93 9215.86,-892.93"/>
<text text-anchor="middle" x="9078.36" y="-880.93" font-family="Arial" font-size="10.00">GPU0: Layer1 Attention Compute</text>
<text text-anchor="middle" x="9078.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9078.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu0_layer1&#45;&gt;attn_comp_gpu0_layer1 -->
<g id="edge11" class="edge">
<title>comm_qkv_gpu0_layer1&#45;&gt;attn_comp_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9079.03,-929.79C9078.93,-921.26 9078.82,-911.86 9078.72,-903.22"/>
<polygon fill="black" stroke="black" points="9082.21,-903.13 9078.6,-893.17 9075.21,-903.21 9082.21,-903.13"/>
</g>
<!-- comm_attn_out_gpu0_layer1 -->
<g id="node13" class="node">
<title>comm_attn_out_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8949.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="8949.36" y="-794.44" font-family="Arial" font-size="10.00">GPU0: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="8949.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8949.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu0_layer1&#45;&gt;comm_attn_out_gpu0_layer1 -->
<g id="edge12" class="edge">
<title>attn_comp_gpu0_layer1&#45;&gt;comm_attn_out_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9048.44,-851.83C9033.99,-842.37 9016.25,-830.75 8999.8,-819.97"/>
<polygon fill="black" stroke="black" points="9001.62,-816.98 8991.33,-814.43 8997.78,-822.84 9001.62,-816.98"/>
</g>
<!-- gate_gpu0_layer1 -->
<g id="node42" class="node">
<title>gate_gpu0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="9142.59,-719.95 8733.4,-719.95 8628.13,-637.95 9037.33,-637.95 9142.59,-719.95"/>
<text text-anchor="middle" x="8885.36" y="-687.45" font-family="Arial" font-size="10.00">GPU0: Layer1 Gate Routing</text>
<text text-anchor="middle" x="8885.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8885.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu0_layer1&#45;&gt;gate_gpu0_layer1 -->
<g id="edge41" class="edge">
<title>comm_attn_out_gpu0_layer1&#45;&gt;gate_gpu0_layer1</title>
<path fill="none" stroke="black" d="M8932.21,-756.8C8926.94,-748.15 8920.97,-738.37 8915.11,-728.75"/>
<polygon fill="black" stroke="black" points="8917.97,-726.72 8909.78,-720 8912,-730.36 8917.97,-726.72"/>
</g>
<!-- comm_qkv_gpu1_layer1 -->
<g id="node15" class="node">
<title>comm_qkv_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="7407.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="7407.36" y="-967.42" font-family="Arial" font-size="10.00">GPU1: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="7407.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7407.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu1_layer1&#45;&gt;comm_qkv_gpu1_layer1 -->
<g id="edge14" class="edge">
<title>attn_qkv_gpu1_layer1&#45;&gt;comm_qkv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M7517.2,-1024.82C7500.81,-1015.14 7480.62,-1003.21 7462.03,-992.23"/>
<polygon fill="black" stroke="black" points="7463.74,-989.17 7453.35,-987.09 7460.18,-995.19 7463.74,-989.17"/>
</g>
<!-- attn_comp_gpu1_layer1 -->
<g id="node16" class="node">
<title>attn_comp_gpu1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="7213.86,-892.93 6938.86,-892.93 6938.86,-851.93 7213.86,-851.93 7213.86,-892.93"/>
<text text-anchor="middle" x="7076.36" y="-880.93" font-family="Arial" font-size="10.00">GPU1: Layer1 Attention Compute</text>
<text text-anchor="middle" x="7076.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7076.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu1_layer1&#45;&gt;attn_comp_gpu1_layer1 -->
<g id="edge15" class="edge">
<title>comm_qkv_gpu1_layer1&#45;&gt;attn_comp_gpu1_layer1</title>
<path fill="none" stroke="black" d="M7312.07,-933.6C7265.01,-921.58 7208.65,-907.2 7162.84,-895.51"/>
<polygon fill="black" stroke="black" points="7163.49,-892.06 7152.94,-892.98 7161.76,-898.84 7163.49,-892.06"/>
</g>
<!-- comm_attn_out_gpu1_layer1 -->
<g id="node17" class="node">
<title>comm_attn_out_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="7037.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="7037.36" y="-794.44" font-family="Arial" font-size="10.00">GPU1: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="7037.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7037.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu1_layer1&#45;&gt;comm_attn_out_gpu1_layer1 -->
<g id="edge16" class="edge">
<title>attn_comp_gpu1_layer1&#45;&gt;comm_attn_out_gpu1_layer1</title>
<path fill="none" stroke="black" d="M7067.32,-851.83C7063.54,-843.64 7059.01,-833.84 7054.64,-824.37"/>
<polygon fill="black" stroke="black" points="7057.72,-822.69 7050.35,-815.07 7051.36,-825.62 7057.72,-822.69"/>
</g>
<!-- gate_gpu1_layer1 -->
<g id="node43" class="node">
<title>gate_gpu1_layer1</title>
<polygon fill="lightyellow" stroke="black" points="6939.59,-719.95 6530.4,-719.95 6425.13,-637.95 6834.33,-637.95 6939.59,-719.95"/>
<text text-anchor="middle" x="6682.36" y="-687.45" font-family="Arial" font-size="10.00">GPU1: Layer1 Gate Routing</text>
<text text-anchor="middle" x="6682.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="6682.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu1_layer1&#45;&gt;gate_gpu1_layer1 -->
<g id="edge42" class="edge">
<title>comm_attn_out_gpu1_layer1&#45;&gt;gate_gpu1_layer1</title>
<path fill="none" stroke="black" d="M6952.78,-759.92C6915.32,-748.84 6870.16,-735.49 6827.57,-722.89"/>
<polygon fill="black" stroke="black" points="6828.54,-719.53 6817.96,-720.05 6826.55,-726.24 6828.54,-719.53"/>
</g>
<!-- comm_qkv_gpu2_layer1 -->
<g id="node19" class="node">
<title>comm_qkv_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8121.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8121.36" y="-967.42" font-family="Arial" font-size="10.00">GPU2: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="8121.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8121.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu2_layer1&#45;&gt;comm_qkv_gpu2_layer1 -->
<g id="edge18" class="edge">
<title>attn_qkv_gpu2_layer1&#45;&gt;comm_qkv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8234.27,-1024.82C8217.35,-1015.09 8196.48,-1003.1 8177.3,-992.08"/>
<polygon fill="black" stroke="black" points="8179.05,-989.04 8168.63,-987.09 8175.56,-995.11 8179.05,-989.04"/>
</g>
<!-- attn_comp_gpu2_layer1 -->
<g id="node20" class="node">
<title>attn_comp_gpu2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8124.86,-892.93 7849.86,-892.93 7849.86,-851.93 8124.86,-851.93 8124.86,-892.93"/>
<text text-anchor="middle" x="7987.36" y="-880.93" font-family="Arial" font-size="10.00">GPU2: Layer1 Attention Compute</text>
<text text-anchor="middle" x="7987.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7987.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu2_layer1&#45;&gt;attn_comp_gpu2_layer1 -->
<g id="edge19" class="edge">
<title>comm_qkv_gpu2_layer1&#45;&gt;attn_comp_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8077.86,-930.49C8061.48,-920.16 8042.96,-908.48 8026.95,-898.4"/>
<polygon fill="black" stroke="black" points="8028.68,-895.34 8018.35,-892.97 8024.95,-901.27 8028.68,-895.34"/>
</g>
<!-- comm_attn_out_gpu2_layer1 -->
<g id="node21" class="node">
<title>comm_attn_out_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="7717.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="7717.36" y="-794.44" font-family="Arial" font-size="10.00">GPU2: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="7717.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7717.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu2_layer1&#45;&gt;comm_attn_out_gpu2_layer1 -->
<g id="edge20" class="edge">
<title>attn_comp_gpu2_layer1&#45;&gt;comm_attn_out_gpu2_layer1</title>
<path fill="none" stroke="black" d="M7924.74,-851.83C7889.99,-840.96 7846.15,-827.24 7807.74,-815.22"/>
<polygon fill="black" stroke="black" points="7808.69,-811.85 7798.1,-812.2 7806.6,-818.53 7808.69,-811.85"/>
</g>
<!-- gate_gpu2_layer1 -->
<g id="node44" class="node">
<title>gate_gpu2_layer1</title>
<polygon fill="lightyellow" stroke="black" points="7746.59,-719.95 7337.4,-719.95 7232.13,-637.95 7641.33,-637.95 7746.59,-719.95"/>
<text text-anchor="middle" x="7489.36" y="-687.45" font-family="Arial" font-size="10.00">GPU2: Layer1 Gate Routing</text>
<text text-anchor="middle" x="7489.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7489.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu2_layer1&#45;&gt;gate_gpu2_layer1 -->
<g id="edge43" class="edge">
<title>comm_attn_out_gpu2_layer1&#45;&gt;gate_gpu2_layer1</title>
<path fill="none" stroke="black" d="M7659.53,-758.31C7637.09,-747.98 7610.78,-735.86 7585.64,-724.28"/>
<polygon fill="black" stroke="black" points="7586.99,-721.05 7576.44,-720.05 7584.06,-727.41 7586.99,-721.05"/>
</g>
<!-- comm_qkv_gpu3_layer1 -->
<g id="node23" class="node">
<title>comm_qkv_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8624.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8624.36" y="-967.42" font-family="Arial" font-size="10.00">GPU3: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="8624.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8624.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu3_layer1&#45;&gt;comm_qkv_gpu3_layer1 -->
<g id="edge22" class="edge">
<title>attn_qkv_gpu3_layer1&#45;&gt;comm_qkv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8707.31,-1024.82C8695.65,-1015.69 8681.43,-1004.57 8668.08,-994.13"/>
<polygon fill="black" stroke="black" points="8669.95,-991.14 8659.91,-987.73 8665.63,-996.65 8669.95,-991.14"/>
</g>
<!-- attn_comp_gpu3_layer1 -->
<g id="node24" class="node">
<title>attn_comp_gpu3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8469.86,-892.93 8194.86,-892.93 8194.86,-851.93 8469.86,-851.93 8469.86,-892.93"/>
<text text-anchor="middle" x="8332.36" y="-880.93" font-family="Arial" font-size="10.00">GPU3: Layer1 Attention Compute</text>
<text text-anchor="middle" x="8332.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8332.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu3_layer1&#45;&gt;attn_comp_gpu3_layer1 -->
<g id="edge23" class="edge">
<title>comm_qkv_gpu3_layer1&#45;&gt;attn_comp_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8537.94,-932.92C8497.32,-921.16 8449.28,-907.26 8409.85,-895.85"/>
<polygon fill="black" stroke="black" points="8410.6,-892.43 8400.02,-893.01 8408.66,-899.15 8410.6,-892.43"/>
</g>
<!-- comm_attn_out_gpu3_layer1 -->
<g id="node25" class="node">
<title>comm_attn_out_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8256.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="8256.36" y="-794.44" font-family="Arial" font-size="10.00">GPU3: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="8256.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8256.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu3_layer1&#45;&gt;comm_attn_out_gpu3_layer1 -->
<g id="edge24" class="edge">
<title>attn_comp_gpu3_layer1&#45;&gt;comm_attn_out_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8314.74,-851.83C8306.84,-843.06 8297.27,-832.42 8288.19,-822.33"/>
<polygon fill="black" stroke="black" points="8290.67,-819.85 8281.38,-814.75 8285.46,-824.53 8290.67,-819.85"/>
</g>
<!-- gate_gpu3_layer1 -->
<g id="node45" class="node">
<title>gate_gpu3_layer1</title>
<polygon fill="lightyellow" stroke="black" points="8482.59,-719.95 8073.4,-719.95 7968.13,-637.95 8377.33,-637.95 8482.59,-719.95"/>
<text text-anchor="middle" x="8225.36" y="-687.45" font-family="Arial" font-size="10.00">GPU3: Layer1 Gate Routing</text>
<text text-anchor="middle" x="8225.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8225.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu3_layer1&#45;&gt;gate_gpu3_layer1 -->
<g id="edge44" class="edge">
<title>comm_attn_out_gpu3_layer1&#45;&gt;gate_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8248.06,-756.8C8245.58,-748.42 8242.79,-738.97 8240.03,-729.64"/>
<polygon fill="black" stroke="black" points="8243.38,-728.6 8237.19,-720 8236.66,-730.59 8243.38,-728.6"/>
</g>
<!-- comm_qkv_gpu4_layer1 -->
<g id="node27" class="node">
<title>comm_qkv_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9782.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9782.36" y="-967.42" font-family="Arial" font-size="10.00">GPU4: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="9782.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9782.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu4_layer1&#45;&gt;comm_qkv_gpu4_layer1 -->
<g id="edge26" class="edge">
<title>attn_qkv_gpu4_layer1&#45;&gt;comm_qkv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M9618,-1024.82C9644.18,-1014.48 9676.87,-1001.57 9706.18,-990"/>
<polygon fill="black" stroke="black" points="9707.55,-993.22 9715.57,-986.29 9704.98,-986.71 9707.55,-993.22"/>
</g>
<!-- attn_comp_gpu4_layer1 -->
<g id="node28" class="node">
<title>attn_comp_gpu4_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10033.86,-892.93 9758.86,-892.93 9758.86,-851.93 10033.86,-851.93 10033.86,-892.93"/>
<text text-anchor="middle" x="9896.36" y="-880.93" font-family="Arial" font-size="10.00">GPU4: Layer1 Attention Compute</text>
<text text-anchor="middle" x="9896.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9896.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu4_layer1&#45;&gt;attn_comp_gpu4_layer1 -->
<g id="edge27" class="edge">
<title>comm_qkv_gpu4_layer1&#45;&gt;attn_comp_gpu4_layer1</title>
<path fill="none" stroke="black" d="M9819.69,-930.26C9833.11,-920.31 9848.2,-909.13 9861.41,-899.34"/>
<polygon fill="black" stroke="black" points="9863.84,-901.89 9869.79,-893.13 9859.67,-896.27 9863.84,-901.89"/>
</g>
<!-- comm_attn_out_gpu4_layer1 -->
<g id="node29" class="node">
<title>comm_attn_out_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10073.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="10073.36" y="-794.44" font-family="Arial" font-size="10.00">GPU4: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="10073.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10073.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu4_layer1&#45;&gt;comm_attn_out_gpu4_layer1 -->
<g id="edge28" class="edge">
<title>attn_comp_gpu4_layer1&#45;&gt;comm_attn_out_gpu4_layer1</title>
<path fill="none" stroke="black" d="M9937.41,-851.83C9958.33,-841.85 9984.27,-829.47 10007.86,-818.21"/>
<polygon fill="black" stroke="black" points="10009.6,-821.26 10017.12,-813.79 10006.58,-814.94 10009.6,-821.26"/>
</g>
<!-- gate_gpu4_layer1 -->
<g id="node46" class="node">
<title>gate_gpu4_layer1</title>
<polygon fill="lightyellow" stroke="black" points="11399.59,-719.95 10990.4,-719.95 10885.13,-637.95 11294.33,-637.95 11399.59,-719.95"/>
<text text-anchor="middle" x="11142.36" y="-687.45" font-family="Arial" font-size="10.00">GPU4: Layer1 Gate Routing</text>
<text text-anchor="middle" x="11142.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="11142.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu4_layer1&#45;&gt;gate_gpu4_layer1 -->
<g id="edge45" class="edge">
<title>comm_attn_out_gpu4_layer1&#45;&gt;gate_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10229.95,-769.56C10421.52,-750.75 10745.71,-718.91 10951.64,-698.68"/>
<polygon fill="black" stroke="black" points="10952.05,-702.16 10961.66,-697.7 10951.36,-695.19 10952.05,-702.16"/>
</g>
<!-- comm_qkv_gpu5_layer1 -->
<g id="node31" class="node">
<title>comm_qkv_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10266.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="10266.36" y="-967.42" font-family="Arial" font-size="10.00">GPU5: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="10266.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10266.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu5_layer1&#45;&gt;comm_qkv_gpu5_layer1 -->
<g id="edge30" class="edge">
<title>attn_qkv_gpu5_layer1&#45;&gt;comm_qkv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10042.86,-1024.82C10080.78,-1013.8 10128.75,-999.88 10170.52,-987.75"/>
<polygon fill="black" stroke="black" points="10171.53,-991.1 10180.16,-984.95 10169.58,-984.38 10171.53,-991.1"/>
</g>
<!-- attn_comp_gpu5_layer1 -->
<g id="node32" class="node">
<title>attn_comp_gpu5_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10980.86,-892.93 10705.86,-892.93 10705.86,-851.93 10980.86,-851.93 10980.86,-892.93"/>
<text text-anchor="middle" x="10843.36" y="-880.93" font-family="Arial" font-size="10.00">GPU5: Layer1 Attention Compute</text>
<text text-anchor="middle" x="10843.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10843.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu5_layer1&#45;&gt;attn_comp_gpu5_layer1 -->
<g id="edge31" class="edge">
<title>comm_qkv_gpu5_layer1&#45;&gt;attn_comp_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10402.01,-938.06C10491.59,-924.94 10608.83,-907.77 10699.96,-894.43"/>
<polygon fill="black" stroke="black" points="10700.7,-897.86 10710.09,-892.95 10699.69,-890.93 10700.7,-897.86"/>
</g>
<!-- comm_attn_out_gpu5_layer1 -->
<g id="node33" class="node">
<title>comm_attn_out_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="11149.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="11149.36" y="-794.44" font-family="Arial" font-size="10.00">GPU5: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="11149.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11149.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu5_layer1&#45;&gt;comm_attn_out_gpu5_layer1 -->
<g id="edge32" class="edge">
<title>attn_comp_gpu5_layer1&#45;&gt;comm_attn_out_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10914.33,-851.83C10954.8,-840.66 11006.13,-826.49 11050.49,-814.24"/>
<polygon fill="black" stroke="black" points="11051.43,-817.61 11060.13,-811.58 11049.56,-810.86 11051.43,-817.61"/>
</g>
<!-- gate_gpu5_layer1 -->
<g id="node47" class="node">
<title>gate_gpu5_layer1</title>
<polygon fill="lightyellow" stroke="black" points="12674.59,-719.95 12265.4,-719.95 12160.13,-637.95 12569.33,-637.95 12674.59,-719.95"/>
<text text-anchor="middle" x="12417.36" y="-687.45" font-family="Arial" font-size="10.00">GPU5: Layer1 Gate Routing</text>
<text text-anchor="middle" x="12417.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12417.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu5_layer1&#45;&gt;gate_gpu5_layer1 -->
<g id="edge46" class="edge">
<title>comm_attn_out_gpu5_layer1&#45;&gt;gate_gpu5_layer1</title>
<path fill="none" stroke="black" d="M11313.51,-771.35C11547.04,-752.01 11974.42,-716.62 12223.32,-696.01"/>
<polygon fill="black" stroke="black" points="12223.89,-699.48 12233.57,-695.17 12223.32,-692.5 12223.89,-699.48"/>
</g>
<!-- comm_qkv_gpu6_layer1 -->
<g id="node35" class="node">
<title>comm_qkv_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="11423.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="11423.36" y="-967.42" font-family="Arial" font-size="10.00">GPU6: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="11423.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11423.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu6_layer1&#45;&gt;comm_qkv_gpu6_layer1 -->
<g id="edge34" class="edge">
<title>attn_qkv_gpu6_layer1&#45;&gt;comm_qkv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M11097.44,-1024.87C11157.81,-1012.84 11235.72,-997.31 11300.23,-984.46"/>
<polygon fill="black" stroke="black" points="11300.93,-987.89 11310.05,-982.5 11299.56,-981.02 11300.93,-987.89"/>
</g>
<!-- attn_comp_gpu6_layer1 -->
<g id="node36" class="node">
<title>attn_comp_gpu6_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11737.86,-892.93 11462.86,-892.93 11462.86,-851.93 11737.86,-851.93 11737.86,-892.93"/>
<text text-anchor="middle" x="11600.36" y="-880.93" font-family="Arial" font-size="10.00">GPU6: Layer1 Attention Compute</text>
<text text-anchor="middle" x="11600.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11600.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu6_layer1&#45;&gt;attn_comp_gpu6_layer1 -->
<g id="edge35" class="edge">
<title>comm_qkv_gpu6_layer1&#45;&gt;attn_comp_gpu6_layer1</title>
<path fill="none" stroke="black" d="M11479.85,-930.96C11502.43,-920.18 11528.21,-907.87 11550.12,-897.41"/>
<polygon fill="black" stroke="black" points="11551.74,-900.52 11559.26,-893.05 11548.72,-894.2 11551.74,-900.52"/>
</g>
<!-- comm_attn_out_gpu6_layer1 -->
<g id="node37" class="node">
<title>comm_attn_out_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="13022.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="13022.36" y="-794.44" font-family="Arial" font-size="10.00">GPU6: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="13022.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13022.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu6_layer1&#45;&gt;comm_attn_out_gpu6_layer1 -->
<g id="edge36" class="edge">
<title>attn_comp_gpu6_layer1&#45;&gt;comm_attn_out_gpu6_layer1</title>
<path fill="none" stroke="black" d="M11738,-863.25C11995.11,-847.98 12548.41,-815.1 12837.66,-797.91"/>
<polygon fill="black" stroke="black" points="12838.06,-801.4 12847.84,-797.31 12837.65,-794.41 12838.06,-801.4"/>
</g>
<!-- gate_gpu6_layer1 -->
<g id="node48" class="node">
<title>gate_gpu6_layer1</title>
<polygon fill="lightyellow" stroke="black" points="16349.59,-719.95 15940.4,-719.95 15835.13,-637.95 16244.33,-637.95 16349.59,-719.95"/>
<text text-anchor="middle" x="16092.36" y="-687.45" font-family="Arial" font-size="10.00">GPU6: Layer1 Gate Routing</text>
<text text-anchor="middle" x="16092.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="16092.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu6_layer1&#45;&gt;gate_gpu6_layer1 -->
<g id="edge47" class="edge">
<title>comm_attn_out_gpu6_layer1&#45;&gt;gate_gpu6_layer1</title>
<path fill="none" stroke="black" d="M13206.06,-778.66C13745.29,-760.22 15321.2,-706.32 15887.08,-686.97"/>
<polygon fill="black" stroke="black" points="15887.51,-690.46 15897.39,-686.62 15887.27,-683.46 15887.51,-690.46"/>
</g>
<!-- comm_qkv_gpu7_layer1 -->
<g id="node39" class="node">
<title>comm_qkv_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10902.36" cy="-958.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="10902.36" y="-967.42" font-family="Arial" font-size="10.00">GPU7: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="10902.36" y="-956.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10902.36" y="-945.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu7_layer1&#45;&gt;comm_qkv_gpu7_layer1 -->
<g id="edge38" class="edge">
<title>attn_qkv_gpu7_layer1&#45;&gt;comm_qkv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M10430.02,-1025.35C10526.16,-1012.03 10654.43,-994.26 10753.04,-980.6"/>
<polygon fill="black" stroke="black" points="10753.67,-984.05 10763.1,-979.21 10752.71,-977.12 10753.67,-984.05"/>
</g>
<!-- attn_comp_gpu7_layer1 -->
<g id="node40" class="node">
<title>attn_comp_gpu7_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11387.86,-892.93 11112.86,-892.93 11112.86,-851.93 11387.86,-851.93 11387.86,-892.93"/>
<text text-anchor="middle" x="11250.36" y="-880.93" font-family="Arial" font-size="10.00">GPU7: Layer1 Attention Compute</text>
<text text-anchor="middle" x="11250.36" y="-869.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11250.36" y="-858.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu7_layer1&#45;&gt;attn_comp_gpu7_layer1 -->
<g id="edge39" class="edge">
<title>comm_qkv_gpu7_layer1&#45;&gt;attn_comp_gpu7_layer1</title>
<path fill="none" stroke="black" d="M11001.15,-933.94C11051.07,-921.82 11111.2,-907.22 11159.9,-895.4"/>
<polygon fill="black" stroke="black" points="11160.9,-898.75 11169.79,-892.99 11159.25,-891.95 11160.9,-898.75"/>
</g>
<!-- comm_attn_out_gpu7_layer1 -->
<g id="node41" class="node">
<title>comm_attn_out_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="12265.36" cy="-785.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="12265.36" y="-794.44" font-family="Arial" font-size="10.00">GPU7: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="12265.36" y="-783.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="12265.36" y="-772.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu7_layer1&#45;&gt;comm_attn_out_gpu7_layer1 -->
<g id="edge40" class="edge">
<title>attn_comp_gpu7_layer1&#45;&gt;comm_attn_out_gpu7_layer1</title>
<path fill="none" stroke="black" d="M11387.94,-854.26C11448.97,-847.02 11521.68,-838.91 11587.36,-832.93 11753.43,-817.82 11942.79,-805.38 12079.1,-797.26"/>
<polygon fill="black" stroke="black" points="12079.46,-800.75 12089.23,-796.66 12079.04,-793.76 12079.46,-800.75"/>
</g>
<!-- gate_gpu7_layer1 -->
<g id="node49" class="node">
<title>gate_gpu7_layer1</title>
<polygon fill="lightyellow" stroke="black" points="13242.59,-719.95 12833.4,-719.95 12728.13,-637.95 13137.33,-637.95 13242.59,-719.95"/>
<text text-anchor="middle" x="12985.36" y="-687.45" font-family="Arial" font-size="10.00">GPU7: Layer1 Gate Routing</text>
<text text-anchor="middle" x="12985.36" y="-676.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12985.36" y="-665.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu7_layer1&#45;&gt;gate_gpu7_layer1 -->
<g id="edge48" class="edge">
<title>comm_attn_out_gpu7_layer1&#45;&gt;gate_gpu7_layer1</title>
<path fill="none" stroke="black" d="M12399.52,-765.38C12513.51,-748.75 12678.16,-724.74 12803.9,-706.41"/>
<polygon fill="black" stroke="black" points="12804.64,-709.84 12814.03,-704.93 12803.63,-702.91 12804.64,-709.84"/>
</g>
<!-- expert_gpu0_exp0_layer1 -->
<g id="node50" class="node">
<title>expert_gpu0_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8589.86,-505.97 8360.86,-505.97 8360.86,-464.97 8589.86,-464.97 8589.86,-505.97"/>
<text text-anchor="middle" x="8475.36" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 0</text>
<text text-anchor="middle" x="8475.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="8475.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge121" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8645.91,-651.93C8594.93,-646.87 8541.4,-641.92 8491.36,-637.95 8419.58,-632.25 7893.8,-653.3 7844.36,-600.95 7826.67,-582.21 7826.97,-561.98 7844.36,-542.97 7877.79,-506.41 8176.58,-493.33 8350.75,-488.78"/>
<polygon fill="red" stroke="red" points="8350.84,-492.28 8360.75,-488.53 8350.66,-485.28 8350.84,-492.28"/>
<text text-anchor="middle" x="7955.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU0</text>
</g>
<!-- expert_gpu1_exp0_layer1 -->
<g id="node54" class="node">
<title>expert_gpu1_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="1152.86,-505.97 923.86,-505.97 923.86,-464.97 1152.86,-464.97 1152.86,-505.97"/>
<text text-anchor="middle" x="1038.36" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 0</text>
<text text-anchor="middle" x="1038.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="1038.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge122" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8642.9,-649.54C8592.86,-644.74 8540.46,-640.5 8491.36,-637.95 7704.97,-597.13 2191.1,-653.39 1404.36,-619.95 1301.88,-615.59 1261.87,-654.46 1174.36,-600.95 1148.48,-585.12 1160.25,-563.97 1138.36,-542.97 1125.25,-530.39 1108.81,-519.6 1093.06,-510.93"/>
<polygon fill="red" stroke="red" points="1094.37,-507.67 1083.9,-506.07 1091.09,-513.85 1094.37,-507.67"/>
<text text-anchor="middle" x="1285.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU1</text>
</g>
<!-- expert_gpu2_exp0_layer1 -->
<g id="node58" class="node">
<title>expert_gpu2_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="3590.86,-505.97 3361.86,-505.97 3361.86,-464.97 3590.86,-464.97 3590.86,-505.97"/>
<text text-anchor="middle" x="3476.36" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 0</text>
<text text-anchor="middle" x="3476.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="3476.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge123" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8642.89,-649.59C8592.86,-644.79 8540.45,-640.53 8491.36,-637.95 7974.85,-610.8 4353.11,-642.26 3836.36,-619.95 3733.89,-615.52 3693.87,-654.46 3606.36,-600.95 3580.48,-585.12 3591.97,-564.26 3570.36,-542.97 3557.78,-530.56 3541.97,-519.73 3526.92,-510.95"/>
<polygon fill="red" stroke="red" points="3528.61,-507.89 3518.18,-506.03 3525.18,-513.99 3528.61,-507.89"/>
<text text-anchor="middle" x="3717.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU2</text>
</g>
<!-- expert_gpu3_exp0_layer1 -->
<g id="node62" class="node">
<title>expert_gpu3_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="6022.86,-505.97 5793.86,-505.97 5793.86,-464.97 6022.86,-464.97 6022.86,-505.97"/>
<text text-anchor="middle" x="5908.36" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 0</text>
<text text-anchor="middle" x="5908.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="5908.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge124" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8643.15,-649.77C8593.03,-644.95 8540.53,-640.64 8491.36,-637.95 7998.75,-611 6764.22,-642.01 6271.36,-619.95 6167.57,-615.3 6127.03,-655.1 6038.36,-600.95 6012.48,-585.14 6023.97,-564.26 6002.36,-542.97 5989.78,-530.56 5973.97,-519.73 5958.92,-510.95"/>
<polygon fill="red" stroke="red" points="5960.61,-507.89 5950.18,-506.03 5957.18,-513.99 5960.61,-507.89"/>
<text text-anchor="middle" x="6149.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU3</text>
</g>
<!-- expert_gpu4_exp0_layer1 -->
<g id="node66" class="node">
<title>expert_gpu4_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11046.86,-505.97 10817.86,-505.97 10817.86,-464.97 11046.86,-464.97 11046.86,-505.97"/>
<text text-anchor="middle" x="10932.36" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 0</text>
<text text-anchor="middle" x="10932.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="10932.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge125" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9084.54,-674.71C9624.86,-665.46 11080.31,-637.23 11115.36,-600.95 11133.27,-582.41 11130.66,-563.7 11115.36,-542.97 11100.87,-523.33 11079.65,-510.31 11056.75,-501.72"/>
<polygon fill="red" stroke="red" points="11057.8,-498.38 11047.2,-498.42 11055.51,-505 11057.8,-498.38"/>
<text text-anchor="middle" x="11238.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU4</text>
</g>
<!-- expert_gpu5_exp0_layer1 -->
<g id="node70" class="node">
<title>expert_gpu5_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="13196.86,-505.97 12967.86,-505.97 12967.86,-464.97 13196.86,-464.97 13196.86,-505.97"/>
<text text-anchor="middle" x="13082.36" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 0</text>
<text text-anchor="middle" x="13082.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="13082.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge126" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9083.5,-673.91C9861.31,-658.06 12663.36,-600.95 12663.36,-600.95 12688.56,-585.73 12671.17,-559.72 12695.36,-542.97 12736.87,-514.21 12860.79,-499.8 12957.34,-492.77"/>
<polygon fill="red" stroke="red" points="12957.75,-496.25 12967.48,-492.05 12957.26,-489.27 12957.75,-496.25"/>
<text text-anchor="middle" x="12806.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU5</text>
</g>
<!-- expert_gpu6_exp0_layer1 -->
<g id="node74" class="node">
<title>expert_gpu6_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="18318.86,-505.97 18089.86,-505.97 18089.86,-464.97 18318.86,-464.97 18318.86,-505.97"/>
<text text-anchor="middle" x="18204.36" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 0</text>
<text text-anchor="middle" x="18204.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="18204.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge127" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9082.46,-672.92C9439.93,-664.04 10219.09,-645.77 10876.36,-637.95 13023.78,-612.38 13560.89,-640.47 15708.36,-619.95 15737.25,-619.67 15744.47,-619.3 15773.36,-618.95 15801.31,-618.61 17761.36,-615.26 17785.36,-600.95 17810.64,-585.87 17793.17,-559.72 17817.36,-542.97 17858.87,-514.21 17982.79,-499.8 18079.34,-492.77"/>
<polygon fill="red" stroke="red" points="18079.75,-496.25 18089.48,-492.05 18079.26,-489.27 18079.75,-496.25"/>
<text text-anchor="middle" x="17928.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU6</text>
</g>
<!-- expert_gpu7_exp0_layer1 -->
<g id="node78" class="node">
<title>expert_gpu7_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="15886.86,-505.97 15657.86,-505.97 15657.86,-464.97 15886.86,-464.97 15886.86,-505.97"/>
<text text-anchor="middle" x="15772.36" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 0</text>
<text text-anchor="middle" x="15772.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="15772.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge128" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9082.81,-673.21C9440.45,-664.79 10219.33,-647.26 10876.36,-637.95 10938.54,-637.07 15299.94,-632.78 15353.36,-600.95 15378.65,-585.88 15361.17,-559.72 15385.36,-542.97 15426.87,-514.21 15550.79,-499.8 15647.34,-492.77"/>
<polygon fill="red" stroke="red" points="15647.75,-496.25 15657.48,-492.05 15647.26,-489.27 15647.75,-496.25"/>
<text text-anchor="middle" x="15496.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu0_layer1 -->
<g id="node82" class="node">
<title>comm_expert_send_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9535.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="9535.36" y="-580.46" font-family="Arial" font-size="10.00">GPU0: Send Tokens to Experts</text>
<text text-anchor="middle" x="9535.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9535.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;comm_expert_send_gpu0_layer1 -->
<g id="edge49" class="edge">
<title>gate_gpu0_layer1&#45;&gt;comm_expert_send_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9054.02,-650.71C9162.78,-633.14 9302.19,-610.62 9402.97,-594.34"/>
<polygon fill="black" stroke="black" points="9403.59,-597.79 9412.9,-592.74 9402.47,-590.88 9403.59,-597.79"/>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge129" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6727.23,-637.61C6740,-625.92 6753.84,-613.04 6766.36,-600.95 6792.36,-575.85 6790.47,-557.93 6823.36,-542.97 6951.84,-484.52 6999.36,-530.17 7140.36,-523.97 7585.38,-504.38 8114.31,-493.07 8350.59,-488.65"/>
<polygon fill="red" stroke="red" points="8350.65,-492.15 8360.58,-488.46 8350.52,-485.15 8350.65,-492.15"/>
<text text-anchor="middle" x="6934.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU0</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge130" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6475.68,-677.44C5396.2,-674.54 453.01,-658.12 400.36,-600.95 382.91,-581.99 382.96,-561.97 400.36,-542.97 404.66,-538.27 729.29,-511.38 913.76,-496.45"/>
<polygon fill="red" stroke="red" points="914.11,-499.93 923.79,-495.64 913.54,-492.96 914.11,-499.93"/>
<text text-anchor="middle" x="511.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU1</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge131" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6476.04,-677.82C5686.05,-676.81 2894.55,-668.48 2832.36,-600.95 2814.91,-581.99 2814.95,-561.97 2832.36,-542.97 2836.71,-538.22 3165.71,-511.25 3351.71,-496.35"/>
<polygon fill="red" stroke="red" points="3352.14,-499.83 3361.82,-495.54 3351.58,-492.85 3352.14,-499.83"/>
<text text-anchor="middle" x="2943.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU2</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge132" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6471.44,-674.04C6086.39,-665.85 5305.16,-644.02 5264.36,-600.95 5246.64,-582.24 5246.95,-561.97 5264.36,-542.97 5268.71,-538.22 5597.71,-511.25 5783.71,-496.35"/>
<polygon fill="red" stroke="red" points="5784.14,-499.83 5793.82,-495.54 5783.58,-492.85 5784.14,-499.83"/>
<text text-anchor="middle" x="5375.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU3</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge133" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6865,-661.66C6969.79,-653.02 7103.87,-643.13 7223.36,-637.95 7302.88,-634.5 10021.53,-644.16 10088.36,-600.95 10112.23,-585.51 10091.93,-559.06 10115.36,-542.97 10143.39,-523.71 10585.79,-501.68 10807.59,-491.78"/>
<polygon fill="red" stroke="red" points="10807.82,-495.27 10817.66,-491.33 10807.51,-488.28 10807.82,-495.27"/>
<text text-anchor="middle" x="10226.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU4</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge134" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6864.68,-661.41C6969.51,-652.67 7103.73,-642.78 7223.36,-637.95 7805.35,-614.46 9261.95,-627.36 9844.36,-619.95 9958.04,-618.5 10774.4,-666.39 10867.36,-600.95 10889.9,-585.08 10866.88,-558.91 10889.36,-542.97 10931.78,-512.88 12498.78,-493 12957.45,-487.81"/>
<polygon fill="red" stroke="red" points="12957.79,-491.31 12967.75,-487.7 12957.71,-484.31 12957.79,-491.31"/>
<text text-anchor="middle" x="11000.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU5</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge135" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6864.37,-661.3C6969.24,-652.5 7103.61,-642.59 7223.36,-637.95 7760.74,-617.11 11525.58,-621.98 12063.36,-619.95 12097.76,-619.82 16987.39,-619.49 17016.36,-600.95 17040.3,-585.62 17019.85,-558.94 17043.36,-542.97 17085.64,-514.23 17788.57,-495.58 18079.66,-489.06"/>
<polygon fill="red" stroke="red" points="18079.92,-492.55 18089.84,-488.83 18079.77,-485.56 18079.92,-492.55"/>
<text text-anchor="middle" x="17154.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU6</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge136" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6864.68,-661.33C6969.5,-652.56 7103.73,-642.67 7223.36,-637.95 7248.9,-636.94 14562.84,-614.74 14584.36,-600.95 14608.3,-585.61 14587.85,-558.94 14611.36,-542.97 14653.64,-514.23 15356.57,-495.58 15647.66,-489.06"/>
<polygon fill="red" stroke="red" points="15647.92,-492.55 15657.84,-488.83 15647.77,-485.56 15647.92,-492.55"/>
<text text-anchor="middle" x="14722.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu1_layer1 -->
<g id="node84" class="node">
<title>comm_expert_send_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="175.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="175.36" y="-580.46" font-family="Arial" font-size="10.00">GPU1: Send Tokens to Experts</text>
<text text-anchor="middle" x="175.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="175.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;comm_expert_send_gpu1_layer1 -->
<g id="edge50" class="edge">
<title>gate_gpu1_layer1&#45;&gt;comm_expert_send_gpu1_layer1</title>
<path fill="none" stroke="black" d="M6475.35,-677.35C5420.55,-674.16 681.47,-657.75 372.36,-619.95 338.36,-615.79 301.71,-607.99 269.35,-599.93"/>
<polygon fill="black" stroke="black" points="270,-596.48 259.45,-597.42 268.28,-603.27 270,-596.48"/>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge137" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7270.82,-668.19C7133.29,-654.43 6994.92,-621.5 7070.36,-542.97 7114.34,-497.18 8014.65,-488.5 8350.5,-486.85"/>
<polygon fill="red" stroke="red" points="8350.77,-490.35 8360.75,-486.8 8350.73,-483.35 8350.77,-490.35"/>
<text text-anchor="middle" x="7181.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU0</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge138" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7256.56,-657.11C7161.13,-649.51 7049.53,-641.83 6948.36,-637.95 6275.52,-612.11 1561.09,-648.69 888.36,-619.95 837.12,-617.76 693.1,-638.68 658.36,-600.95 640.91,-581.99 641.53,-562.48 658.36,-542.97 675.14,-523.51 809.29,-507.02 913.51,-496.96"/>
<polygon fill="red" stroke="red" points="913.87,-500.44 923.49,-496.01 913.21,-493.47 913.87,-500.44"/>
<text text-anchor="middle" x="769.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU1</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge139" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7256.89,-657.24C7161.39,-649.64 7049.65,-641.94 6948.36,-637.95 6142.76,-606.21 4125.83,-655.16 3320.36,-619.95 3269.13,-617.71 3125.1,-638.68 3090.36,-600.95 3072.91,-581.99 3073.51,-562.46 3090.36,-542.97 3107.52,-523.11 3245.41,-506.59 3351.54,-496.64"/>
<polygon fill="red" stroke="red" points="3352.07,-500.1 3361.7,-495.7 3351.42,-493.13 3352.07,-500.1"/>
<text text-anchor="middle" x="3201.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU2</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge140" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7258.17,-658.41C7162.37,-650.95 7050.07,-643.02 6948.36,-637.95 6908.79,-635.97 5550.02,-629.33 5522.36,-600.95 5504.38,-582.49 5505.51,-562.46 5522.36,-542.97 5539.52,-523.11 5677.41,-506.59 5783.54,-496.64"/>
<polygon fill="red" stroke="red" points="5784.07,-500.1 5793.7,-495.7 5783.42,-493.13 5784.07,-500.1"/>
<text text-anchor="middle" x="5633.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU3</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge141" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7669.39,-659.68C7756.82,-651.56 7863.46,-642.77 7959.36,-637.95 8025.45,-634.63 10284.64,-635.03 10341.36,-600.95 10366.59,-585.79 10348.8,-559.19 10373.36,-542.97 10442.32,-497.43 10664.87,-487.42 10807.49,-485.86"/>
<polygon fill="red" stroke="red" points="10807.65,-489.36 10817.62,-485.76 10807.58,-482.36 10807.65,-489.36"/>
<text text-anchor="middle" x="10484.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU4</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge142" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7668.81,-659.34C7756.34,-651.11 7863.24,-642.33 7959.36,-637.95 8612.92,-608.19 10249.17,-626.9 10903.36,-619.95 10920.78,-619.76 12143.1,-610.95 12157.36,-600.95 12179.93,-585.12 12157.18,-559.32 12179.36,-542.97 12240.44,-497.93 12723.89,-488.69 12957.21,-486.87"/>
<polygon fill="red" stroke="red" points="12957.48,-490.37 12967.45,-486.79 12957.43,-483.37 12957.48,-490.37"/>
<text text-anchor="middle" x="12290.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU5</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge143" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7668.8,-659.18C7756.33,-650.92 7863.23,-642.14 7959.36,-637.95 8814,-600.65 14803.07,-636.22 15658.36,-619.95 15670.81,-619.71 15673.91,-619.24 15686.36,-618.95 15730.33,-617.91 17231.62,-623.52 17269.36,-600.95 17294.62,-585.84 17276.49,-558.71 17301.36,-542.97 17365.44,-502.39 17846.76,-490.88 18079.32,-487.67"/>
<polygon fill="red" stroke="red" points="18079.57,-491.17 18089.52,-487.54 18079.47,-484.17 18079.57,-491.17"/>
<text text-anchor="middle" x="17412.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU6</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge144" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7668.8,-659.23C7756.33,-650.98 7863.23,-642.21 7959.36,-637.95 8503.83,-613.82 12319.37,-623.57 12864.36,-619.95 12919.17,-619.58 14790.3,-629.04 14837.36,-600.95 14862.64,-585.86 14844.49,-558.71 14869.36,-542.97 14933.44,-502.39 15414.76,-490.88 15647.32,-487.67"/>
<polygon fill="red" stroke="red" points="15647.57,-491.17 15657.52,-487.54 15647.47,-484.17 15647.57,-491.17"/>
<text text-anchor="middle" x="14980.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu2_layer1 -->
<g id="node86" class="node">
<title>comm_expert_send_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="2607.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="2607.36" y="-580.46" font-family="Arial" font-size="10.00">GPU2: Send Tokens to Experts</text>
<text text-anchor="middle" x="2607.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="2607.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;comm_expert_send_gpu2_layer1 -->
<g id="edge51" class="edge">
<title>gate_gpu2_layer1&#45;&gt;comm_expert_send_gpu2_layer1</title>
<path fill="none" stroke="black" d="M7256.56,-657.19C7161.13,-649.61 7049.53,-641.92 6948.36,-637.95 6085.46,-604.09 3925.3,-652.73 3062.36,-619.95 2943.92,-615.45 2914.18,-613.86 2796.36,-600.95 2778.33,-598.97 2759.39,-596.56 2740.73,-594"/>
<polygon fill="black" stroke="black" points="2741.1,-590.51 2730.71,-592.6 2740.13,-597.45 2741.1,-590.51"/>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge145" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7992.8,-657.17C7815.81,-640.21 7600.22,-616.57 7586.36,-600.95 7569.26,-581.67 7568.91,-561.92 7586.36,-542.97 7611.83,-515.31 8111.55,-497.07 8350.35,-489.9"/>
<polygon fill="red" stroke="red" points="8350.58,-493.39 8360.47,-489.59 8350.37,-486.39 8350.58,-493.39"/>
<text text-anchor="middle" x="7697.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU0</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge146" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7988.62,-653.98C7914.06,-647.46 7831.35,-641.28 7755.36,-637.95 7021.73,-605.79 1880.03,-651.2 1146.36,-619.95 1095.12,-617.77 951.1,-638.68 916.36,-600.95 898.91,-581.99 902.49,-564.68 916.36,-542.97 925.21,-529.12 938.41,-518.62 952.91,-510.66"/>
<polygon fill="red" stroke="red" points="954.73,-513.67 962.08,-506.04 951.57,-507.42 954.73,-513.67"/>
<text text-anchor="middle" x="1027.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU1</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge147" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7988.61,-654.05C7914.06,-647.54 7831.34,-641.34 7755.36,-637.95 6828.05,-596.56 4505.72,-660.19 3578.36,-619.95 3527.13,-617.72 3383.1,-638.68 3348.36,-600.95 3330.91,-581.99 3334.29,-564.56 3348.36,-542.97 3357.42,-529.06 3370.76,-518.56 3385.46,-510.62"/>
<polygon fill="red" stroke="red" points="3387.35,-513.59 3394.75,-506.01 3384.24,-507.32 3387.35,-513.59"/>
<text text-anchor="middle" x="3459.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU2</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge148" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7989.2,-654.46C7914.48,-647.94 7831.54,-641.64 7755.36,-637.95 7700.56,-635.29 5818.36,-640.53 5780.36,-600.95 5762.52,-582.36 5766.29,-564.56 5780.36,-542.97 5789.42,-529.06 5802.76,-518.56 5817.46,-510.62"/>
<polygon fill="red" stroke="red" points="5819.35,-513.59 5826.75,-506.01 5816.24,-507.32 5819.35,-513.59"/>
<text text-anchor="middle" x="5891.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU3</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge149" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8402.12,-656.87C8469.95,-649.6 8548.16,-642.22 8619.36,-637.95 8729.18,-631.36 10500.75,-649.73 10599.36,-600.95 10628.85,-586.36 10617.27,-560.08 10645.36,-542.97 10693.74,-513.49 10754.46,-498.97 10807.57,-491.97"/>
<polygon fill="red" stroke="red" points="10808.25,-495.42 10817.74,-490.71 10807.39,-488.47 10808.25,-495.42"/>
<text text-anchor="middle" x="10756.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU4</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge150" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8401.61,-656.49C8469.55,-649.15 8547.96,-641.82 8619.36,-637.95 9171.68,-607.98 10555.27,-626 11108.36,-619.95 11144.39,-619.55 12374.47,-619.49 12405.36,-600.95 12430.6,-585.8 12412.69,-559.02 12437.36,-542.97 12479.82,-515.34 12782.25,-498.6 12957.52,-491.12"/>
<polygon fill="red" stroke="red" points="12957.73,-494.62 12967.58,-490.7 12957.44,-487.62 12957.73,-494.62"/>
<text text-anchor="middle" x="12548.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU5</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge151" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8401.11,-656.36C8469.16,-648.99 8547.78,-641.66 8619.36,-637.95 9011.28,-617.6 15290.99,-627.45 15683.36,-619.95 15695.81,-619.71 15698.91,-619.23 15711.36,-618.95 15736.58,-618.37 17505.7,-613.88 17527.36,-600.95 17552.64,-585.86 17534.69,-559.02 17559.36,-542.97 17601.82,-515.34 17904.25,-498.6 18079.52,-491.12"/>
<polygon fill="red" stroke="red" points="18079.73,-494.62 18089.58,-490.7 18079.44,-487.62 18079.73,-494.62"/>
<text text-anchor="middle" x="17670.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU6</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge152" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8401.11,-656.43C8469.17,-649.06 8547.79,-641.72 8619.36,-637.95 8709.18,-633.21 15018.1,-647 15095.36,-600.95 15120.65,-585.88 15102.69,-559.02 15127.36,-542.97 15169.82,-515.34 15472.25,-498.6 15647.52,-491.12"/>
<polygon fill="red" stroke="red" points="15647.73,-494.62 15657.58,-490.7 15647.44,-487.62 15647.73,-494.62"/>
<text text-anchor="middle" x="15238.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu3_layer1 -->
<g id="node88" class="node">
<title>comm_expert_send_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="5039.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="5039.36" y="-580.46" font-family="Arial" font-size="10.00">GPU3: Send Tokens to Experts</text>
<text text-anchor="middle" x="5039.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="5039.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;comm_expert_send_gpu3_layer1 -->
<g id="edge52" class="edge">
<title>gate_gpu3_layer1&#45;&gt;comm_expert_send_gpu3_layer1</title>
<path fill="none" stroke="black" d="M7989.2,-654.45C7914.48,-647.93 7831.54,-641.63 7755.36,-637.95 7073,-604.96 6901.44,-630.5 6218.36,-619.95 5778.33,-613.15 5666.92,-637.48 5228.36,-600.95 5209.27,-599.36 5189.18,-597.06 5169.51,-594.46"/>
<polygon fill="black" stroke="black" points="5169.96,-590.99 5159.58,-593.11 5169.02,-597.92 5169.96,-590.99"/>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge153" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10931.19,-674.04C10285.97,-661.84 8382.74,-623.95 8360.36,-600.95 8342.39,-582.48 8346.74,-564.84 8360.36,-542.97 8368.93,-529.21 8381.94,-518.7 8396.17,-510.71"/>
<polygon fill="red" stroke="red" points="8397.89,-513.77 8405.16,-506.06 8394.67,-507.55 8397.89,-513.77"/>
<text text-anchor="middle" x="8471.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU0</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge154" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10929.13,-672.43C10564.77,-663.27 9798.92,-645.23 9151.36,-637.95 8735.33,-633.27 2078.05,-637.59 1662.36,-619.95 1559.88,-615.6 1519.87,-654.46 1432.36,-600.95 1406.48,-585.12 1421.64,-559.74 1396.36,-542.97 1358.75,-518.01 1250.86,-503.28 1163.27,-495.15"/>
<polygon fill="red" stroke="red" points="1163.51,-491.66 1153.24,-494.24 1162.88,-498.63 1163.51,-491.66"/>
<text text-anchor="middle" x="1543.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU1</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge155" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10929.5,-672.52C10565.28,-663.48 9799.13,-645.61 9151.36,-637.95 8589.51,-631.3 4655.74,-644.1 4094.36,-619.95 3991.89,-615.54 3951.87,-654.46 3864.36,-600.95 3838.48,-585.12 3853.62,-559.77 3828.36,-542.97 3791.68,-518.56 3686.94,-503.82 3601.18,-495.55"/>
<polygon fill="red" stroke="red" points="3601.37,-492.06 3591.09,-494.6 3600.72,-499.02 3601.37,-492.06"/>
<text text-anchor="middle" x="3975.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU2</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge156" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10930.21,-673.19C10566.28,-665.14 9799.52,-648.66 9151.36,-637.95 9072.06,-636.64 6365.42,-639.95 6296.36,-600.95 6269.95,-586.03 6285.62,-559.77 6260.36,-542.97 6223.68,-518.56 6118.94,-503.82 6033.18,-495.55"/>
<polygon fill="red" stroke="red" points="6033.37,-492.06 6023.09,-494.6 6032.72,-499.02 6033.37,-492.06"/>
<text text-anchor="middle" x="6407.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU3</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge157" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11310.28,-650.15C11335.02,-638.81 11357.48,-622.98 11373.36,-600.95 11388.43,-580.04 11390.39,-562.31 11373.36,-542.97 11352.62,-519.4 11180.16,-502.97 11057.18,-494.12"/>
<polygon fill="red" stroke="red" points="11057.15,-490.61 11046.93,-493.39 11056.66,-497.59 11057.15,-490.61"/>
<text text-anchor="middle" x="11496.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU4</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge158" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11335.93,-670.18C11795.16,-651.67 12913.01,-606.12 12921.36,-600.95 12946.38,-585.44 12931.62,-562.81 12953.36,-542.97 12968.57,-529.09 12987.74,-518.22 13006.61,-509.9"/>
<polygon fill="red" stroke="red" points="13007.97,-513.12 13015.83,-506.01 13005.25,-506.67 13007.97,-513.12"/>
<text text-anchor="middle" x="13064.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU5</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge159" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11333.86,-668.45C11536.77,-658.84 11866.56,-644.49 12151.36,-637.95 12171.82,-637.48 18025.78,-611.4 18043.36,-600.95 18068.66,-585.91 18053.62,-562.81 18075.36,-542.97 18090.57,-529.09 18109.74,-518.22 18128.61,-509.9"/>
<polygon fill="red" stroke="red" points="18129.97,-513.12 18137.83,-506.01 18127.25,-506.67 18129.97,-513.12"/>
<text text-anchor="middle" x="18186.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU6</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge160" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11333.86,-668.71C11536.78,-659.3 11866.57,-645.11 12151.36,-637.95 12199.41,-636.74 15570.11,-625.6 15611.36,-600.95 15636.63,-585.85 15621.62,-562.81 15643.36,-542.97 15658.57,-529.09 15677.74,-518.22 15696.61,-509.9"/>
<polygon fill="red" stroke="red" points="15697.97,-513.12 15705.83,-506.01 15695.25,-506.67 15697.97,-513.12"/>
<text text-anchor="middle" x="15754.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu4_layer1 -->
<g id="node90" class="node">
<title>comm_expert_send_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9904.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="9904.36" y="-580.46" font-family="Arial" font-size="10.00">GPU4: Send Tokens to Experts</text>
<text text-anchor="middle" x="9904.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9904.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;comm_expert_send_gpu4_layer1 -->
<g id="edge53" class="edge">
<title>gate_gpu4_layer1&#45;&gt;comm_expert_send_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10921.67,-666.49C10709.09,-654.34 10378.66,-632.5 10093.36,-600.95 10075.34,-598.95 10056.39,-596.54 10037.74,-593.96"/>
<polygon fill="black" stroke="black" points="10038.1,-590.48 10027.72,-592.56 10037.14,-597.41 10038.1,-590.48"/>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge161" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12197.96,-667.58C11993.6,-658.32 11680.44,-645.14 11408.36,-637.95 11330.88,-635.9 8685.85,-639.07 8618.36,-600.95 8591.95,-586.03 8604.55,-563.65 8582.36,-542.97 8568.49,-530.03 8551.1,-519.19 8534.39,-510.58"/>
<polygon fill="red" stroke="red" points="8535.72,-507.33 8525.2,-506.03 8532.61,-513.6 8535.72,-507.33"/>
<text text-anchor="middle" x="8729.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU0</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge162" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12196.98,-666.82C11992.62,-657.06 11680.04,-643.59 11408.36,-637.95 10881.36,-627.01 2447.01,-642.16 1920.36,-619.95 1817.88,-615.63 1777.87,-654.46 1690.36,-600.95 1664.48,-585.12 1680.17,-558.91 1654.36,-542.97 1613.65,-517.82 1331.03,-500.3 1163.09,-491.98"/>
<polygon fill="red" stroke="red" points="1163.1,-488.47 1152.94,-491.48 1162.76,-495.47 1163.1,-488.47"/>
<text text-anchor="middle" x="1801.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU1</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge163" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12196.98,-666.86C11992.62,-657.13 11680.03,-643.68 11408.36,-637.95 10624.53,-621.42 5135.66,-653.25 4352.36,-619.95 4249.88,-615.59 4209.87,-654.46 4122.36,-600.95 4096.48,-585.12 4112.16,-558.92 4086.36,-542.97 4046.19,-518.12 3768,-500.55 3601.5,-492.12"/>
<polygon fill="red" stroke="red" points="3601.35,-488.61 3591.19,-491.6 3601,-495.6 3601.35,-488.61"/>
<text text-anchor="middle" x="4233.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU2</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge164" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12197.47,-667.1C11993.12,-657.52 11680.24,-644.15 11408.36,-637.95 10065.13,-607.33 9728.9,-630.87 8385.36,-619.95 8282.86,-619.12 6624.43,-659.61 6540.36,-600.95 6517.76,-585.18 6540.3,-559.65 6518.36,-542.97 6480.69,-514.32 6200.53,-498.19 6033.28,-491.03"/>
<polygon fill="red" stroke="red" points="6033.31,-487.52 6023.18,-490.6 6033.02,-494.52 6033.31,-487.52"/>
<text text-anchor="middle" x="6651.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU3</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge165" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12201.05,-669.95C12016.96,-660.5 11768.34,-640.73 11677.36,-600.95 11641.59,-585.3 11647.3,-558.24 11611.36,-542.97 11514.68,-501.87 11225.29,-490.6 11057.14,-487.55"/>
<polygon fill="red" stroke="red" points="11057.05,-484.05 11046.99,-487.38 11056.93,-491.05 11057.05,-484.05"/>
<text text-anchor="middle" x="11788.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU4</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge166" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12589.22,-653.19C12631.69,-647.63 12677.13,-642.13 12719.36,-637.95 12770.39,-632.89 13144.99,-638.99 13179.36,-600.95 13196.64,-581.83 13192.2,-565.31 13179.36,-542.97 13171.71,-529.66 13159.59,-519.19 13146.47,-511.08"/>
<polygon fill="red" stroke="red" points="13148.16,-508.01 13137.75,-506.08 13144.68,-514.09 13148.16,-508.01"/>
<text text-anchor="middle" x="13301.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU5</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge167" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12587.08,-651.64C12630.13,-646.02 12676.36,-640.9 12719.36,-637.95 12912.19,-624.73 16005.09,-621.32 16198.36,-619.95 16227.57,-619.74 18280.8,-621.7 18301.36,-600.95 18319.5,-582.64 18314.2,-565.31 18301.36,-542.97 18293.71,-529.66 18281.59,-519.19 18268.47,-511.08"/>
<polygon fill="red" stroke="red" points="18270.16,-508.01 18259.75,-506.08 18266.68,-514.09 18270.16,-508.01"/>
<text text-anchor="middle" x="18423.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU6</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge168" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12587.49,-651.78C12630.43,-646.18 12676.5,-641.03 12719.36,-637.95 12763,-634.81 15838.61,-632.07 15869.36,-600.95 15887.48,-582.62 15882.2,-565.31 15869.36,-542.97 15861.71,-529.66 15849.59,-519.19 15836.47,-511.08"/>
<polygon fill="red" stroke="red" points="15838.16,-508.01 15827.75,-506.08 15834.68,-514.09 15838.16,-508.01"/>
<text text-anchor="middle" x="15991.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu5_layer1 -->
<g id="node92" class="node">
<title>comm_expert_send_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="14400.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="14400.36" y="-580.46" font-family="Arial" font-size="10.00">GPU5: Send Tokens to Experts</text>
<text text-anchor="middle" x="14400.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="14400.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;comm_expert_send_gpu5_layer1 -->
<g id="edge54" class="edge">
<title>gate_gpu5_layer1&#45;&gt;comm_expert_send_gpu5_layer1</title>
<path fill="none" stroke="black" d="M12587.92,-652.12C12630.74,-646.53 12676.65,-641.3 12719.36,-637.95 13050.01,-612.03 13880.93,-629.41 14211.36,-600.95 14230.29,-599.32 14250.2,-597.02 14269.72,-594.43"/>
<polygon fill="black" stroke="black" points="14270.45,-597.86 14279.88,-593.05 14269.5,-590.92 14270.45,-597.86"/>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge169" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15879.76,-672.76C15383.14,-660.87 14108.13,-631.71 13042.36,-618.95 13015.19,-618.62 9152.64,-614.97 9129.36,-600.95 9104.33,-585.87 9122.72,-559.11 9098.36,-542.97 9057.89,-516.15 8770,-499.23 8600.08,-491.46"/>
<polygon fill="red" stroke="red" points="8600.22,-487.97 8590.07,-491.01 8599.9,-494.96 8600.22,-487.97"/>
<text text-anchor="middle" x="9240.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU0</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge170" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15881.21,-674.11C15409.61,-665.74 14234.8,-645.92 13251.36,-637.95 9511.03,-607.62 8575.77,-637.44 4835.36,-619.95 4798.78,-619.78 2232.67,-619.87 2201.36,-600.95 2176.35,-585.84 2194.96,-558.74 2170.36,-542.97 2052.28,-467.28 1995.42,-531.4 1855.36,-523.97 1610.31,-510.95 1323.76,-498.42 1163.43,-491.65"/>
<polygon fill="red" stroke="red" points="1163.2,-488.13 1153.06,-491.21 1162.9,-495.13 1163.2,-488.13"/>
<text text-anchor="middle" x="2312.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU1</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge171" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15881.65,-674.27C15410.34,-666.21 14235.1,-646.97 13251.36,-637.95 11377.2,-620.76 10908.58,-627.99 9034.36,-619.95 8912.11,-619.42 4738.09,-664.02 4633.36,-600.95 4608.33,-585.87 4626.97,-558.73 4602.36,-542.97 4519.79,-490.08 3876.5,-485.37 3600.95,-485.82"/>
<polygon fill="red" stroke="red" points="3600.9,-482.32 3590.91,-485.84 3600.91,-489.32 3600.9,-482.32"/>
<text text-anchor="middle" x="4744.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU2</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge172" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15881.65,-674.49C15410.33,-666.85 14235.09,-648.42 13251.36,-637.95 13180.13,-637.19 8187.84,-629.02 8122.36,-600.95 8089.43,-586.83 8099.16,-557.39 8066.36,-542.97 7973.06,-501.91 6479.34,-489.83 6033.22,-487.13"/>
<polygon fill="red" stroke="red" points="6033.22,-483.63 6023.2,-487.07 6033.18,-490.63 6033.22,-483.63"/>
<text text-anchor="middle" x="8233.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU3</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge173" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15958.46,-637.91C15926.9,-630.1 15893.18,-623.07 15861.36,-618.95 15795.47,-610.41 13530.06,-627.98 13469.36,-600.95 13437.47,-586.75 13448.15,-557.41 13416.36,-542.97 13308.22,-493.82 11546.63,-487.42 11057.47,-486.59"/>
<polygon fill="red" stroke="red" points="11057.21,-483.09 11047.2,-486.57 11057.2,-490.09 11057.21,-483.09"/>
<text text-anchor="middle" x="13580.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU4</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge174" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M16253,-644.36C16258.81,-637.4 16258.35,-629.02 16248.36,-618.95 16226.31,-596.72 14023.39,-612.68 13994.36,-600.95 13959.68,-586.93 13967.59,-558.05 13933.36,-542.97 13868.72,-514.48 13427.64,-497.07 13207.21,-490.05"/>
<polygon fill="red" stroke="red" points="13207.31,-486.55 13197.2,-489.73 13207.09,-493.55 13207.31,-486.55"/>
<text text-anchor="middle" x="14105.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU5</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge175" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M16293.19,-675.99C16915.61,-669.44 18773.44,-646.13 18817.36,-600.95 18835.33,-582.47 18834.73,-562.01 18817.36,-542.97 18785.17,-507.67 18498.87,-494.11 18329.16,-489.15"/>
<polygon fill="red" stroke="red" points="18329.25,-485.65 18319.16,-488.86 18329.05,-492.65 18329.25,-485.65"/>
<text text-anchor="middle" x="18941.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU6</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge176" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M16277.26,-663.31C16333.75,-654.74 16385.68,-641.23 16403.36,-619.95 16425.82,-592.92 16411.89,-566 16385.36,-542.97 16349.36,-511.7 16065.6,-496.57 15897.05,-490.27"/>
<polygon fill="red" stroke="red" points="15896.99,-486.76 15886.86,-489.89 15896.73,-493.76 15896.99,-486.76"/>
<text text-anchor="middle" x="16525.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu6_layer1 -->
<g id="node94" class="node">
<title>comm_expert_send_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="19264.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="19264.36" y="-580.46" font-family="Arial" font-size="10.00">GPU6: Send Tokens to Experts</text>
<text text-anchor="middle" x="19264.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="19264.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;comm_expert_send_gpu6_layer1 -->
<g id="edge55" class="edge">
<title>gate_gpu6_layer1&#45;&gt;comm_expert_send_gpu6_layer1</title>
<path fill="none" stroke="black" d="M16296.35,-678.45C16755.28,-678.54 17903.96,-672.92 18863.36,-619.95 18957.82,-614.73 18981.42,-612.1 19075.36,-600.95 19093.01,-598.85 19111.55,-596.41 19129.83,-593.85"/>
<polygon fill="black" stroke="black" points="19130.55,-597.29 19139.96,-592.42 19129.57,-590.35 19130.55,-597.29"/>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge177" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12733.48,-642.25C12716.54,-640.57 12699.72,-639.11 12683.36,-637.95 12577.87,-630.48 8968.53,-652.8 8876.36,-600.95 8849.93,-586.08 8865.66,-559.7 8840.36,-542.97 8801.64,-517.35 8689.92,-502.64 8600.18,-494.69"/>
<polygon fill="red" stroke="red" points="8600.45,-491.2 8590.19,-493.82 8599.85,-498.17 8600.45,-491.2"/>
<text text-anchor="middle" x="8987.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU0</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge178" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12733.08,-642.07C12716.28,-640.44 12699.59,-639.04 12683.36,-637.95 12465.02,-623.3 5024.19,-620.93 4805.36,-619.95 4726,-619.59 2017.59,-639.75 1948.36,-600.95 1921.9,-586.12 1938.38,-558.56 1912.36,-542.97 1849.78,-505.46 1389.79,-492.44 1163.45,-488.26"/>
<polygon fill="red" stroke="red" points="1163.24,-484.76 1153.18,-488.08 1163.12,-491.76 1163.24,-484.76"/>
<text text-anchor="middle" x="2059.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU1</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge179" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12733.48,-642.13C12716.55,-640.48 12699.72,-639.06 12683.36,-637.95 12568.31,-630.16 4480.98,-657.3 4380.36,-600.95 4353.9,-586.13 4370.38,-558.56 4344.36,-542.97 4282.3,-505.75 3826.56,-492.59 3601.46,-488.33"/>
<polygon fill="red" stroke="red" points="3601.31,-484.82 3591.25,-488.14 3601.18,-491.82 3601.31,-484.82"/>
<text text-anchor="middle" x="4491.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU2</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge180" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12733.48,-642.16C12716.54,-640.5 12699.72,-639.07 12683.36,-637.95 12485.32,-624.39 9308.86,-621.52 9110.36,-619.95 9012.47,-619.17 7438.27,-639.68 7348.36,-600.95 7315.46,-586.77 7325.05,-557.63 7292.36,-542.97 7179.36,-492.26 6351.95,-486.57 6033.13,-486.29"/>
<polygon fill="red" stroke="red" points="6032.93,-482.79 6022.93,-486.28 6032.93,-489.79 6032.93,-482.79"/>
<text text-anchor="middle" x="7459.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU3</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge181" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12734.64,-643.14C12717.31,-641.22 12700.09,-639.47 12683.36,-637.95 12600.49,-630.42 12007.06,-643.18 11935.36,-600.95 11909.23,-585.55 11925.43,-558.48 11899.36,-542.97 11828.76,-500.95 11302.48,-490.16 11057.34,-487.4"/>
<polygon fill="red" stroke="red" points="11057.35,-483.9 11047.31,-487.29 11057.27,-490.9 11057.35,-483.9"/>
<text text-anchor="middle" x="12046.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU4</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge182" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13178.68,-670.06C13376.99,-659.93 13661.25,-638.95 13695.36,-600.95 13712.57,-581.77 13712.73,-562.01 13695.36,-542.97 13663.17,-507.67 13376.87,-494.11 13207.16,-489.15"/>
<polygon fill="red" stroke="red" points="13207.25,-485.65 13197.16,-488.86 13207.05,-492.65 13207.25,-485.65"/>
<text text-anchor="middle" x="13818.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU5</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge183" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13185.14,-675.1C13648.98,-668.49 14834.97,-651.64 15826.36,-637.95 15864.32,-637.42 18532.7,-627.97 18559.36,-600.95 18635.66,-523.61 18459.52,-498.47 18329.03,-490.33"/>
<polygon fill="red" stroke="red" points="18329.12,-486.83 18318.92,-489.73 18328.7,-493.82 18329.12,-486.83"/>
<text text-anchor="middle" x="18688.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU6</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge184" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13187.15,-676.76C13873.18,-672.25 16075.9,-653.69 16127.36,-600.95 16203.18,-523.25 16027.48,-498.22 15897.16,-490.2"/>
<polygon fill="red" stroke="red" points="15897.26,-486.7 15887.07,-489.61 15896.85,-493.69 15897.26,-486.7"/>
<text text-anchor="middle" x="16256.36" y="-568.26" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu7_layer1 -->
<g id="node96" class="node">
<title>comm_expert_send_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="16832.36" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="16832.36" y="-580.46" font-family="Arial" font-size="10.00">GPU7: Send Tokens to Experts</text>
<text text-anchor="middle" x="16832.36" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="16832.36" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;comm_expert_send_gpu7_layer1 -->
<g id="edge56" class="edge">
<title>gate_gpu7_layer1&#45;&gt;comm_expert_send_gpu7_layer1</title>
<path fill="none" stroke="black" d="M13186.35,-675.84C13689.55,-670.23 15044.23,-653.04 16173.36,-619.95 16382.33,-613.82 16435.22,-620.51 16643.36,-600.95 16661.99,-599.2 16681.59,-596.86 16700.83,-594.28"/>
<polygon fill="black" stroke="black" points="16701.41,-597.73 16710.84,-592.91 16700.46,-590.79 16701.41,-597.73"/>
</g>
<!-- comm_expert_recv_gpu0_layer1 -->
<g id="node83" class="node">
<title>comm_expert_recv_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9352.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="9352.36" y="-407.47" font-family="Arial" font-size="10.00">GPU0: Receive from Experts</text>
<text text-anchor="middle" x="9352.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="9352.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp0_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge61" class="edge">
<title>expert_gpu0_exp0_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M8590.01,-473.42C8743.28,-458.65 9015.79,-432.4 9190.09,-415.61"/>
<polygon fill="black" stroke="black" points="9190.51,-419.08 9200.13,-414.64 9189.84,-412.12 9190.51,-419.08"/>
</g>
<!-- expert_gpu0_exp1_layer1 -->
<g id="node51" class="node">
<title>expert_gpu0_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9219.86,-505.97 8990.86,-505.97 8990.86,-464.97 9219.86,-464.97 9219.86,-505.97"/>
<text text-anchor="middle" x="9105.36" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 1</text>
<text text-anchor="middle" x="9105.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="9105.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp1_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge62" class="edge">
<title>expert_gpu0_exp1_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9162.65,-464.87C9194.04,-454.13 9233.54,-440.62 9268.36,-428.71"/>
<polygon fill="black" stroke="black" points="9269.72,-431.94 9278.05,-425.4 9267.45,-425.32 9269.72,-431.94"/>
</g>
<!-- expert_gpu0_exp2_layer1 -->
<g id="node52" class="node">
<title>expert_gpu0_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9466.86,-505.97 9237.86,-505.97 9237.86,-464.97 9466.86,-464.97 9466.86,-505.97"/>
<text text-anchor="middle" x="9352.36" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 2</text>
<text text-anchor="middle" x="9352.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="9352.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp2_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge63" class="edge">
<title>expert_gpu0_exp2_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9352.36,-464.87C9352.36,-456.94 9352.36,-447.49 9352.36,-438.29"/>
<polygon fill="black" stroke="black" points="9355.86,-438.11 9352.36,-428.11 9348.86,-438.11 9355.86,-438.11"/>
</g>
<!-- expert_gpu0_exp3_layer1 -->
<g id="node53" class="node">
<title>expert_gpu0_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9713.86,-505.97 9484.86,-505.97 9484.86,-464.97 9713.86,-464.97 9713.86,-505.97"/>
<text text-anchor="middle" x="9599.36" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 3</text>
<text text-anchor="middle" x="9599.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="9599.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp3_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge64" class="edge">
<title>expert_gpu0_exp3_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9542.07,-464.87C9510.68,-454.13 9471.18,-440.62 9436.37,-428.71"/>
<polygon fill="black" stroke="black" points="9437.27,-425.32 9426.68,-425.4 9435.01,-431.94 9437.27,-425.32"/>
</g>
<!-- comm_expert_recv_gpu1_layer1 -->
<g id="node85" class="node">
<title>comm_expert_recv_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="669.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="669.36" y="-407.47" font-family="Arial" font-size="10.00">GPU1: Receive from Experts</text>
<text text-anchor="middle" x="669.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="669.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp0_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge69" class="edge">
<title>expert_gpu1_exp0_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M952.78,-464.87C901.36,-453.1 835.4,-437.99 780.04,-425.32"/>
<polygon fill="black" stroke="black" points="780.72,-421.88 770.19,-423.06 779.16,-428.71 780.72,-421.88"/>
</g>
<!-- expert_gpu1_exp1_layer1 -->
<g id="node55" class="node">
<title>expert_gpu1_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="783.86,-505.97 554.86,-505.97 554.86,-464.97 783.86,-464.97 783.86,-505.97"/>
<text text-anchor="middle" x="669.36" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 1</text>
<text text-anchor="middle" x="669.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="669.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp1_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge70" class="edge">
<title>expert_gpu1_exp1_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M669.36,-464.87C669.36,-456.94 669.36,-447.49 669.36,-438.29"/>
<polygon fill="black" stroke="black" points="672.86,-438.11 669.36,-428.11 665.86,-438.11 672.86,-438.11"/>
</g>
<!-- expert_gpu1_exp2_layer1 -->
<g id="node56" class="node">
<title>expert_gpu1_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="289.86,-505.97 60.86,-505.97 60.86,-464.97 289.86,-464.97 289.86,-505.97"/>
<text text-anchor="middle" x="175.36" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 2</text>
<text text-anchor="middle" x="175.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="175.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp2_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge71" class="edge">
<title>expert_gpu1_exp2_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M289.63,-464.92C363.95,-452.21 461.08,-435.6 538.5,-422.36"/>
<polygon fill="black" stroke="black" points="539.54,-425.73 548.8,-420.59 538.36,-418.83 539.54,-425.73"/>
</g>
<!-- expert_gpu1_exp3_layer1 -->
<g id="node57" class="node">
<title>expert_gpu1_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="536.86,-505.97 307.86,-505.97 307.86,-464.97 536.86,-464.97 536.86,-505.97"/>
<text text-anchor="middle" x="422.36" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 3</text>
<text text-anchor="middle" x="422.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="422.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp3_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge72" class="edge">
<title>expert_gpu1_exp3_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M479.65,-464.87C511.04,-454.13 550.54,-440.62 585.36,-428.71"/>
<polygon fill="black" stroke="black" points="586.72,-431.94 595.05,-425.4 584.45,-425.32 586.72,-431.94"/>
</g>
<!-- comm_expert_recv_gpu2_layer1 -->
<g id="node87" class="node">
<title>comm_expert_recv_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="3101.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="3101.36" y="-407.47" font-family="Arial" font-size="10.00">GPU2: Receive from Experts</text>
<text text-anchor="middle" x="3101.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="3101.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp0_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge77" class="edge">
<title>expert_gpu2_exp0_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M3389.39,-464.87C3336.93,-453.05 3269.57,-437.87 3213.18,-425.17"/>
<polygon fill="black" stroke="black" points="3213.68,-421.69 3203.15,-422.91 3212.14,-428.52 3213.68,-421.69"/>
</g>
<!-- expert_gpu2_exp1_layer1 -->
<g id="node59" class="node">
<title>expert_gpu2_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="2968.86,-505.97 2739.86,-505.97 2739.86,-464.97 2968.86,-464.97 2968.86,-505.97"/>
<text text-anchor="middle" x="2854.36" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 1</text>
<text text-anchor="middle" x="2854.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="2854.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp1_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge78" class="edge">
<title>expert_gpu2_exp1_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2911.65,-464.87C2943.04,-454.13 2982.54,-440.62 3017.36,-428.71"/>
<polygon fill="black" stroke="black" points="3018.72,-431.94 3027.05,-425.4 3016.45,-425.32 3018.72,-431.94"/>
</g>
<!-- expert_gpu2_exp2_layer1 -->
<g id="node60" class="node">
<title>expert_gpu2_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="3215.86,-505.97 2986.86,-505.97 2986.86,-464.97 3215.86,-464.97 3215.86,-505.97"/>
<text text-anchor="middle" x="3101.36" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 2</text>
<text text-anchor="middle" x="3101.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="3101.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp2_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge79" class="edge">
<title>expert_gpu2_exp2_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M3101.36,-464.87C3101.36,-456.94 3101.36,-447.49 3101.36,-438.29"/>
<polygon fill="black" stroke="black" points="3104.86,-438.11 3101.36,-428.11 3097.86,-438.11 3104.86,-438.11"/>
</g>
<!-- expert_gpu2_exp3_layer1 -->
<g id="node61" class="node">
<title>expert_gpu2_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="2721.86,-505.97 2492.86,-505.97 2492.86,-464.97 2721.86,-464.97 2721.86,-505.97"/>
<text text-anchor="middle" x="2607.36" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 3</text>
<text text-anchor="middle" x="2607.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="2607.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp3_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge80" class="edge">
<title>expert_gpu2_exp3_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2721.63,-464.92C2795.95,-452.21 2893.08,-435.6 2970.5,-422.36"/>
<polygon fill="black" stroke="black" points="2971.54,-425.73 2980.8,-420.59 2970.36,-418.83 2971.54,-425.73"/>
</g>
<!-- comm_expert_recv_gpu3_layer1 -->
<g id="node89" class="node">
<title>comm_expert_recv_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="5533.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="5533.36" y="-407.47" font-family="Arial" font-size="10.00">GPU3: Receive from Experts</text>
<text text-anchor="middle" x="5533.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="5533.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp0_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge85" class="edge">
<title>expert_gpu3_exp0_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M5821.39,-464.87C5768.93,-453.05 5701.57,-437.87 5645.18,-425.17"/>
<polygon fill="black" stroke="black" points="5645.68,-421.69 5635.15,-422.91 5644.14,-428.52 5645.68,-421.69"/>
</g>
<!-- expert_gpu3_exp1_layer1 -->
<g id="node63" class="node">
<title>expert_gpu3_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="5153.86,-505.97 4924.86,-505.97 4924.86,-464.97 5153.86,-464.97 5153.86,-505.97"/>
<text text-anchor="middle" x="5039.36" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 1</text>
<text text-anchor="middle" x="5039.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="5039.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp1_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge86" class="edge">
<title>expert_gpu3_exp1_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M5153.63,-464.92C5227.95,-452.21 5325.08,-435.6 5402.5,-422.36"/>
<polygon fill="black" stroke="black" points="5403.54,-425.73 5412.8,-420.59 5402.36,-418.83 5403.54,-425.73"/>
</g>
<!-- expert_gpu3_exp2_layer1 -->
<g id="node64" class="node">
<title>expert_gpu3_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="5400.86,-505.97 5171.86,-505.97 5171.86,-464.97 5400.86,-464.97 5400.86,-505.97"/>
<text text-anchor="middle" x="5286.36" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 2</text>
<text text-anchor="middle" x="5286.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="5286.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp2_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge87" class="edge">
<title>expert_gpu3_exp2_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M5343.65,-464.87C5375.04,-454.13 5414.54,-440.62 5449.36,-428.71"/>
<polygon fill="black" stroke="black" points="5450.72,-431.94 5459.05,-425.4 5448.45,-425.32 5450.72,-431.94"/>
</g>
<!-- expert_gpu3_exp3_layer1 -->
<g id="node65" class="node">
<title>expert_gpu3_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="5647.86,-505.97 5418.86,-505.97 5418.86,-464.97 5647.86,-464.97 5647.86,-505.97"/>
<text text-anchor="middle" x="5533.36" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 3</text>
<text text-anchor="middle" x="5533.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="5533.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp3_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge88" class="edge">
<title>expert_gpu3_exp3_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M5533.36,-464.87C5533.36,-456.94 5533.36,-447.49 5533.36,-438.29"/>
<polygon fill="black" stroke="black" points="5536.86,-438.11 5533.36,-428.11 5529.86,-438.11 5536.86,-438.11"/>
</g>
<!-- comm_expert_recv_gpu4_layer1 -->
<g id="node91" class="node">
<title>comm_expert_recv_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10093.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="10093.36" y="-407.47" font-family="Arial" font-size="10.00">GPU4: Receive from Experts</text>
<text text-anchor="middle" x="10093.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="10093.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp0_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge93" class="edge">
<title>expert_gpu4_exp0_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10817.46,-472.89C10671.52,-458.2 10418.86,-432.75 10253.92,-416.14"/>
<polygon fill="black" stroke="black" points="10253.98,-412.63 10243.68,-415.11 10253.28,-419.6 10253.98,-412.63"/>
</g>
<!-- expert_gpu4_exp1_layer1 -->
<g id="node67" class="node">
<title>expert_gpu4_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10454.86,-505.97 10225.86,-505.97 10225.86,-464.97 10454.86,-464.97 10454.86,-505.97"/>
<text text-anchor="middle" x="10340.36" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 1</text>
<text text-anchor="middle" x="10340.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="10340.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp1_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge94" class="edge">
<title>expert_gpu4_exp1_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10283.07,-464.87C10251.68,-454.13 10212.18,-440.62 10177.37,-428.71"/>
<polygon fill="black" stroke="black" points="10178.27,-425.32 10167.68,-425.4 10176.01,-431.94 10178.27,-425.32"/>
</g>
<!-- expert_gpu4_exp2_layer1 -->
<g id="node68" class="node">
<title>expert_gpu4_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9960.86,-505.97 9731.86,-505.97 9731.86,-464.97 9960.86,-464.97 9960.86,-505.97"/>
<text text-anchor="middle" x="9846.36" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 2</text>
<text text-anchor="middle" x="9846.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="9846.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp2_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge95" class="edge">
<title>expert_gpu4_exp2_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M9903.65,-464.87C9935.04,-454.13 9974.54,-440.62 10009.36,-428.71"/>
<polygon fill="black" stroke="black" points="10010.72,-431.94 10019.05,-425.4 10008.45,-425.32 10010.72,-431.94"/>
</g>
<!-- expert_gpu4_exp3_layer1 -->
<g id="node69" class="node">
<title>expert_gpu4_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10207.86,-505.97 9978.86,-505.97 9978.86,-464.97 10207.86,-464.97 10207.86,-505.97"/>
<text text-anchor="middle" x="10093.36" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 3</text>
<text text-anchor="middle" x="10093.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="10093.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp3_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge96" class="edge">
<title>expert_gpu4_exp3_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10093.36,-464.87C10093.36,-456.94 10093.36,-447.49 10093.36,-438.29"/>
<polygon fill="black" stroke="black" points="10096.86,-438.11 10093.36,-428.11 10089.86,-438.11 10096.86,-438.11"/>
</g>
<!-- comm_expert_recv_gpu5_layer1 -->
<g id="node93" class="node">
<title>comm_expert_recv_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="13906.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="13906.36" y="-407.47" font-family="Arial" font-size="10.00">GPU5: Receive from Experts</text>
<text text-anchor="middle" x="13906.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="13906.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp0_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge101" class="edge">
<title>expert_gpu5_exp0_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M13196.94,-472.72C13340.09,-458.04 13585.82,-432.84 13747.19,-416.29"/>
<polygon fill="black" stroke="black" points="13747.63,-419.77 13757.22,-415.27 13746.91,-412.81 13747.63,-419.77"/>
</g>
<!-- expert_gpu5_exp1_layer1 -->
<g id="node71" class="node">
<title>expert_gpu5_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="14514.86,-505.97 14285.86,-505.97 14285.86,-464.97 14514.86,-464.97 14514.86,-505.97"/>
<text text-anchor="middle" x="14400.36" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 1</text>
<text text-anchor="middle" x="14400.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="14400.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp1_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge102" class="edge">
<title>expert_gpu5_exp1_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M14286.1,-464.92C14211.78,-452.21 14114.65,-435.6 14037.23,-422.36"/>
<polygon fill="black" stroke="black" points="14037.37,-418.83 14026.92,-420.59 14036.19,-425.73 14037.37,-418.83"/>
</g>
<!-- expert_gpu5_exp2_layer1 -->
<g id="node72" class="node">
<title>expert_gpu5_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="14020.86,-505.97 13791.86,-505.97 13791.86,-464.97 14020.86,-464.97 14020.86,-505.97"/>
<text text-anchor="middle" x="13906.36" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 2</text>
<text text-anchor="middle" x="13906.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="13906.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp2_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge103" class="edge">
<title>expert_gpu5_exp2_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M13906.36,-464.87C13906.36,-456.94 13906.36,-447.49 13906.36,-438.29"/>
<polygon fill="black" stroke="black" points="13909.86,-438.11 13906.36,-428.11 13902.86,-438.11 13909.86,-438.11"/>
</g>
<!-- expert_gpu5_exp3_layer1 -->
<g id="node73" class="node">
<title>expert_gpu5_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="14267.86,-505.97 14038.86,-505.97 14038.86,-464.97 14267.86,-464.97 14267.86,-505.97"/>
<text text-anchor="middle" x="14153.36" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 3</text>
<text text-anchor="middle" x="14153.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="14153.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp3_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge104" class="edge">
<title>expert_gpu5_exp3_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M14096.07,-464.87C14064.68,-454.13 14025.18,-440.62 13990.37,-428.71"/>
<polygon fill="black" stroke="black" points="13991.27,-425.32 13980.68,-425.4 13989.01,-431.94 13991.27,-425.32"/>
</g>
<!-- comm_expert_recv_gpu6_layer1 -->
<g id="node95" class="node">
<title>comm_expert_recv_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="18770.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="18770.36" y="-407.47" font-family="Arial" font-size="10.00">GPU6: Receive from Experts</text>
<text text-anchor="middle" x="18770.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="18770.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp0_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge109" class="edge">
<title>expert_gpu6_exp0_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M18318.9,-467.37C18409.06,-453.91 18535.09,-435.09 18631.09,-420.76"/>
<polygon fill="black" stroke="black" points="18631.79,-424.2 18641.16,-419.26 18630.76,-417.28 18631.79,-424.2"/>
</g>
<!-- expert_gpu6_exp1_layer1 -->
<g id="node75" class="node">
<title>expert_gpu6_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="19131.86,-505.97 18902.86,-505.97 18902.86,-464.97 19131.86,-464.97 19131.86,-505.97"/>
<text text-anchor="middle" x="19017.36" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 1</text>
<text text-anchor="middle" x="19017.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="19017.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp1_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge110" class="edge">
<title>expert_gpu6_exp1_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M18960.07,-464.87C18928.68,-454.13 18889.18,-440.62 18854.37,-428.71"/>
<polygon fill="black" stroke="black" points="18855.27,-425.32 18844.68,-425.4 18853.01,-431.94 18855.27,-425.32"/>
</g>
<!-- expert_gpu6_exp2_layer1 -->
<g id="node76" class="node">
<title>expert_gpu6_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="19378.86,-505.97 19149.86,-505.97 19149.86,-464.97 19378.86,-464.97 19378.86,-505.97"/>
<text text-anchor="middle" x="19264.36" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 2</text>
<text text-anchor="middle" x="19264.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="19264.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp2_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge111" class="edge">
<title>expert_gpu6_exp2_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M19150.1,-464.92C19075.78,-452.21 18978.65,-435.6 18901.23,-422.36"/>
<polygon fill="black" stroke="black" points="18901.37,-418.83 18890.92,-420.59 18900.19,-425.73 18901.37,-418.83"/>
</g>
<!-- expert_gpu6_exp3_layer1 -->
<g id="node77" class="node">
<title>expert_gpu6_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="18884.86,-505.97 18655.86,-505.97 18655.86,-464.97 18884.86,-464.97 18884.86,-505.97"/>
<text text-anchor="middle" x="18770.36" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 3</text>
<text text-anchor="middle" x="18770.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="18770.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp3_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge112" class="edge">
<title>expert_gpu6_exp3_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M18770.36,-464.87C18770.36,-456.94 18770.36,-447.49 18770.36,-438.29"/>
<polygon fill="black" stroke="black" points="18773.86,-438.11 18770.36,-428.11 18766.86,-438.11 18773.86,-438.11"/>
</g>
<!-- comm_expert_recv_gpu7_layer1 -->
<g id="node97" class="node">
<title>comm_expert_recv_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="16338.36" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="16338.36" y="-407.47" font-family="Arial" font-size="10.00">GPU7: Receive from Experts</text>
<text text-anchor="middle" x="16338.36" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="16338.36" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp0_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge117" class="edge">
<title>expert_gpu7_exp0_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M15886.9,-467.37C15977.06,-453.91 16103.09,-435.09 16199.09,-420.76"/>
<polygon fill="black" stroke="black" points="16199.79,-424.2 16209.16,-419.26 16198.76,-417.28 16199.79,-424.2"/>
</g>
<!-- expert_gpu7_exp1_layer1 -->
<g id="node79" class="node">
<title>expert_gpu7_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16452.86,-505.97 16223.86,-505.97 16223.86,-464.97 16452.86,-464.97 16452.86,-505.97"/>
<text text-anchor="middle" x="16338.36" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 1</text>
<text text-anchor="middle" x="16338.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16338.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp1_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge118" class="edge">
<title>expert_gpu7_exp1_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M16338.36,-464.87C16338.36,-456.94 16338.36,-447.49 16338.36,-438.29"/>
<polygon fill="black" stroke="black" points="16341.86,-438.11 16338.36,-428.11 16334.86,-438.11 16341.86,-438.11"/>
</g>
<!-- expert_gpu7_exp2_layer1 -->
<g id="node80" class="node">
<title>expert_gpu7_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16699.86,-505.97 16470.86,-505.97 16470.86,-464.97 16699.86,-464.97 16699.86,-505.97"/>
<text text-anchor="middle" x="16585.36" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 2</text>
<text text-anchor="middle" x="16585.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16585.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp2_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge119" class="edge">
<title>expert_gpu7_exp2_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M16528.07,-464.87C16496.68,-454.13 16457.18,-440.62 16422.37,-428.71"/>
<polygon fill="black" stroke="black" points="16423.27,-425.32 16412.68,-425.4 16421.01,-431.94 16423.27,-425.32"/>
</g>
<!-- expert_gpu7_exp3_layer1 -->
<g id="node81" class="node">
<title>expert_gpu7_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16946.86,-505.97 16717.86,-505.97 16717.86,-464.97 16946.86,-464.97 16946.86,-505.97"/>
<text text-anchor="middle" x="16832.36" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 3</text>
<text text-anchor="middle" x="16832.36" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16832.36" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp3_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge120" class="edge">
<title>expert_gpu7_exp3_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M16718.1,-464.92C16643.78,-452.21 16546.65,-435.6 16469.23,-422.36"/>
<polygon fill="black" stroke="black" points="16469.37,-418.83 16458.92,-420.59 16468.19,-425.73 16469.37,-418.83"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge57" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="black" d="M9410.96,-551.49C9389.45,-548.42 9367.28,-545.45 9346.36,-542.97 9081.85,-511.55 8769.92,-496.64 8600.41,-490.38"/>
<polygon fill="black" stroke="black" points="8600.32,-486.87 8590.2,-490.01 8600.07,-493.87 8600.32,-486.87"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp1_layer1 -->
<g id="edge58" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp1_layer1</title>
<path fill="none" stroke="black" d="M9426.24,-549.23C9386.05,-541.25 9340.14,-532.17 9298.36,-523.97 9271.93,-518.78 9243.45,-513.22 9216.7,-508.02"/>
<polygon fill="black" stroke="black" points="9217.03,-504.52 9206.54,-506.05 9215.69,-511.39 9217.03,-504.52"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp2_layer1 -->
<g id="edge59" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp2_layer1</title>
<path fill="none" stroke="black" d="M9477.96,-544.46C9454.29,-533.52 9427.05,-520.95 9404.01,-510.31"/>
<polygon fill="black" stroke="black" points="9405.29,-507.05 9394.75,-506.03 9402.36,-513.4 9405.29,-507.05"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp3_layer1 -->
<g id="edge60" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp3_layer1</title>
<path fill="none" stroke="black" d="M9556.67,-542.82C9563.63,-533.63 9571.36,-523.44 9578.3,-514.27"/>
<polygon fill="black" stroke="black" points="9581.16,-516.29 9584.41,-506.21 9575.58,-512.06 9581.16,-516.29"/>
</g>
<!-- expert_agg_gpu0_layer1 -->
<g id="node98" class="node">
<title>expert_agg_gpu0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="9700.19,-332.98 9210.5,-332.98 9084.53,-250.98 9574.22,-250.98 9700.19,-332.98"/>
<text text-anchor="middle" x="9392.36" y="-300.48" font-family="Arial" font-size="10.00">GPU0: Expert Aggregation</text>
<text text-anchor="middle" x="9392.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="9392.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu0_layer1&#45;&gt;expert_agg_gpu0_layer1 -->
<g id="edge185" class="edge">
<title>comm_expert_recv_gpu0_layer1&#45;&gt;expert_agg_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9363.08,-369.84C9366.28,-361.45 9369.88,-352 9373.43,-342.67"/>
<polygon fill="black" stroke="black" points="9376.81,-343.63 9377.1,-333.04 9370.27,-341.14 9376.81,-343.63"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge65" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="black" d="M261.47,-546.64C295.71,-537.97 335.62,-529.09 372.36,-523.97 557.41,-498.17 605.87,-517.35 792.36,-505.97 831.72,-503.56 874.56,-500.37 913.31,-497.26"/>
<polygon fill="black" stroke="black" points="913.91,-500.72 923.59,-496.43 913.35,-493.75 913.91,-500.72"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp1_layer1 -->
<g id="edge66" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp1_layer1</title>
<path fill="none" stroke="black" d="M249.34,-545.55C275.59,-537.45 305.52,-529.23 333.36,-523.97 423.19,-506.98 449.74,-516.62 544.54,-505.98"/>
<polygon fill="black" stroke="black" points="545.03,-509.45 554.55,-504.82 544.22,-502.5 545.03,-509.45"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp2_layer1 -->
<g id="edge67" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp2_layer1</title>
<path fill="none" stroke="black" d="M175.36,-542.82C175.36,-534.29 175.36,-524.89 175.36,-516.25"/>
<polygon fill="black" stroke="black" points="178.86,-516.21 175.36,-506.21 171.86,-516.21 178.86,-516.21"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp3_layer1 -->
<g id="edge68" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp3_layer1</title>
<path fill="none" stroke="black" d="M230.26,-544.37C246.2,-537.2 263.79,-529.82 280.36,-523.97 296.04,-518.43 312.94,-513.28 329.43,-508.68"/>
<polygon fill="black" stroke="black" points="330.36,-512.06 339.08,-506.04 328.51,-505.3 330.36,-512.06"/>
</g>
<!-- expert_agg_gpu1_layer1 -->
<g id="node101" class="node">
<title>expert_agg_gpu1_layer1</title>
<polygon fill="lightyellow" stroke="black" points="4937.19,-332.98 4447.5,-332.98 4321.53,-250.98 4811.22,-250.98 4937.19,-332.98"/>
<text text-anchor="middle" x="4629.36" y="-300.48" font-family="Arial" font-size="10.00">GPU1: Expert Aggregation</text>
<text text-anchor="middle" x="4629.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="4629.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu1_layer1&#45;&gt;expert_agg_gpu1_layer1 -->
<g id="edge188" class="edge">
<title>comm_expert_recv_gpu1_layer1&#45;&gt;expert_agg_gpu1_layer1</title>
<path fill="none" stroke="black" d="M846.24,-393.28C1481.97,-376.43 3652.16,-318.89 4385.2,-299.46"/>
<polygon fill="black" stroke="black" points="4385.45,-302.95 4395.36,-299.19 4385.27,-295.95 4385.45,-302.95"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge73" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="black" d="M2693.47,-546.64C2727.71,-537.97 2767.62,-529.09 2804.36,-523.97 2989.41,-498.17 3037.86,-517.17 3224.36,-505.97 3265.75,-503.48 3310.92,-500.17 3351.44,-496.99"/>
<polygon fill="black" stroke="black" points="3351.94,-500.46 3361.63,-496.18 3351.39,-493.48 3351.94,-500.46"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp1_layer1 -->
<g id="edge74" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp1_layer1</title>
<path fill="none" stroke="black" d="M2670.27,-544.88C2688.26,-537.76 2707.98,-530.27 2726.36,-523.97 2741.51,-518.77 2757.81,-513.64 2773.54,-508.93"/>
<polygon fill="black" stroke="black" points="2774.65,-512.25 2783.24,-506.05 2772.66,-505.54 2774.65,-512.25"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp2_layer1 -->
<g id="edge75" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp2_layer1</title>
<path fill="none" stroke="black" d="M2681.34,-545.55C2707.59,-537.45 2737.52,-529.23 2765.36,-523.97 2855.19,-506.98 2881.74,-516.62 2976.54,-505.98"/>
<polygon fill="black" stroke="black" points="2977.03,-509.45 2986.55,-504.82 2976.22,-502.5 2977.03,-509.45"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp3_layer1 -->
<g id="edge76" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp3_layer1</title>
<path fill="none" stroke="black" d="M2607.36,-542.82C2607.36,-534.29 2607.36,-524.89 2607.36,-516.25"/>
<polygon fill="black" stroke="black" points="2610.86,-516.21 2607.36,-506.21 2603.86,-516.21 2610.86,-516.21"/>
</g>
<!-- expert_agg_gpu2_layer1 -->
<g id="node104" class="node">
<title>expert_agg_gpu2_layer1</title>
<polygon fill="lightyellow" stroke="black" points="6365.19,-332.98 5875.5,-332.98 5749.53,-250.98 6239.22,-250.98 6365.19,-332.98"/>
<text text-anchor="middle" x="6057.36" y="-300.48" font-family="Arial" font-size="10.00">GPU2: Expert Aggregation</text>
<text text-anchor="middle" x="6057.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="6057.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu2_layer1&#45;&gt;expert_agg_gpu2_layer1 -->
<g id="edge191" class="edge">
<title>comm_expert_recv_gpu2_layer1&#45;&gt;expert_agg_gpu2_layer1</title>
<path fill="none" stroke="black" d="M3276.25,-391.86C3603.91,-380.39 4332.57,-354.84 4946.36,-332.98 5246.15,-322.31 5591.44,-309.85 5816.47,-301.71"/>
<polygon fill="black" stroke="black" points="5816.89,-305.2 5826.76,-301.34 5816.64,-298.2 5816.89,-305.2"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge81" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="black" d="M5125.47,-546.64C5159.71,-537.97 5199.62,-529.09 5236.36,-523.97 5421.41,-498.17 5469.86,-517.17 5656.36,-505.97 5697.75,-503.48 5742.92,-500.17 5783.44,-496.99"/>
<polygon fill="black" stroke="black" points="5783.94,-500.46 5793.63,-496.18 5783.39,-493.48 5783.94,-500.46"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp1_layer1 -->
<g id="edge82" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp1_layer1</title>
<path fill="none" stroke="black" d="M5039.36,-542.82C5039.36,-534.29 5039.36,-524.89 5039.36,-516.25"/>
<polygon fill="black" stroke="black" points="5042.86,-516.21 5039.36,-506.21 5035.86,-516.21 5042.86,-516.21"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp2_layer1 -->
<g id="edge83" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp2_layer1</title>
<path fill="none" stroke="black" d="M5094.26,-544.37C5110.2,-537.2 5127.79,-529.82 5144.36,-523.97 5160.04,-518.43 5176.94,-513.28 5193.43,-508.68"/>
<polygon fill="black" stroke="black" points="5194.36,-512.06 5203.08,-506.04 5192.51,-505.3 5194.36,-512.06"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp3_layer1 -->
<g id="edge84" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp3_layer1</title>
<path fill="none" stroke="black" d="M5107.33,-545.13C5131.07,-537.09 5158.09,-529.02 5183.36,-523.97 5279.08,-504.82 5307.53,-516.98 5408.55,-505.98"/>
<polygon fill="black" stroke="black" points="5409.02,-509.45 5418.56,-504.84 5408.23,-502.49 5409.02,-509.45"/>
</g>
<!-- expert_agg_gpu3_layer1 -->
<g id="node107" class="node">
<title>expert_agg_gpu3_layer1</title>
<polygon fill="lightyellow" stroke="black" points="7688.19,-332.98 7198.5,-332.98 7072.53,-250.98 7562.22,-250.98 7688.19,-332.98"/>
<text text-anchor="middle" x="7380.36" y="-300.48" font-family="Arial" font-size="10.00">GPU3: Expert Aggregation</text>
<text text-anchor="middle" x="7380.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="7380.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu3_layer1&#45;&gt;expert_agg_gpu3_layer1 -->
<g id="edge194" class="edge">
<title>comm_expert_recv_gpu3_layer1&#45;&gt;expert_agg_gpu3_layer1</title>
<path fill="none" stroke="black" d="M5701.35,-388.43C6032.03,-369.63 6768.05,-327.79 7146.18,-306.29"/>
<polygon fill="black" stroke="black" points="7146.65,-309.77 7156.43,-305.71 7146.25,-302.79 7146.65,-309.77"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge89" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="black" d="M9990.48,-546.68C10024.71,-538.02 10064.63,-529.13 10101.36,-523.97 10118.57,-521.55 10579.84,-501.56 10807.56,-491.79"/>
<polygon fill="black" stroke="black" points="10807.72,-495.29 10817.56,-491.37 10807.42,-488.3 10807.72,-495.29"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp1_layer1 -->
<g id="edge90" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp1_layer1</title>
<path fill="none" stroke="black" d="M9978.16,-545.61C10003.63,-537.66 10032.51,-529.52 10059.36,-523.97 10125.47,-510.3 10145.55,-515.02 10215.59,-506.14"/>
<polygon fill="black" stroke="black" points="10216.35,-509.57 10225.81,-504.79 10215.44,-502.63 10216.35,-509.57"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp2_layer1 -->
<g id="edge91" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp2_layer1</title>
<path fill="none" stroke="black" d="M9885.05,-542.82C9878.81,-533.73 9871.89,-523.65 9865.65,-514.56"/>
<polygon fill="black" stroke="black" points="9868.46,-512.47 9859.91,-506.21 9862.69,-516.43 9868.46,-512.47"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp3_layer1 -->
<g id="edge92" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp3_layer1</title>
<path fill="none" stroke="black" d="M9957.11,-544.29C9971.08,-537.46 9986.21,-530.27 10000.36,-523.97 10010.94,-519.25 10022.3,-514.46 10033.32,-509.94"/>
<polygon fill="black" stroke="black" points="10034.94,-513.06 10042.89,-506.05 10032.31,-506.57 10034.94,-513.06"/>
</g>
<!-- expert_agg_gpu4_layer1 -->
<g id="node110" class="node">
<title>expert_agg_gpu4_layer1</title>
<polygon fill="lightyellow" stroke="black" points="10387.19,-332.98 9897.5,-332.98 9771.53,-250.98 10261.22,-250.98 10387.19,-332.98"/>
<text text-anchor="middle" x="10079.36" y="-300.48" font-family="Arial" font-size="10.00">GPU4: Expert Aggregation</text>
<text text-anchor="middle" x="10079.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="10079.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu4_layer1&#45;&gt;expert_agg_gpu4_layer1 -->
<g id="edge197" class="edge">
<title>comm_expert_recv_gpu4_layer1&#45;&gt;expert_agg_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10089.61,-369.84C10088.5,-361.54 10087.26,-352.2 10086.03,-342.97"/>
<polygon fill="black" stroke="black" points="10089.49,-342.49 10084.7,-333.04 10082.56,-343.41 10089.49,-342.49"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge97" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="black" d="M14275.96,-551.49C14254.45,-548.42 14232.28,-545.45 14211.36,-542.97 13848.25,-499.84 13415.64,-489.56 13207.04,-487.16"/>
<polygon fill="black" stroke="black" points="13207.01,-483.66 13196.98,-487.05 13206.94,-490.66 13207.01,-483.66"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp1_layer1 -->
<g id="edge98" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp1_layer1</title>
<path fill="none" stroke="black" d="M14400.36,-542.82C14400.36,-534.29 14400.36,-524.89 14400.36,-516.25"/>
<polygon fill="black" stroke="black" points="14403.86,-516.21 14400.36,-506.21 14396.86,-516.21 14403.86,-516.21"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp2_layer1 -->
<g id="edge99" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp2_layer1</title>
<path fill="none" stroke="black" d="M14281.41,-550.61C14205.59,-537.64 14107.52,-520.87 14030.68,-507.73"/>
<polygon fill="black" stroke="black" points="14030.91,-504.22 14020.46,-505.98 14029.73,-511.12 14030.91,-504.22"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp3_layer1 -->
<g id="edge100" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp3_layer1</title>
<path fill="none" stroke="black" d="M14326.25,-545.61C14292.5,-534.06 14252.85,-520.5 14220.04,-509.27"/>
<polygon fill="black" stroke="black" points="14221.13,-505.95 14210.54,-506.02 14218.86,-512.57 14221.13,-505.95"/>
</g>
<!-- expert_agg_gpu5_layer1 -->
<g id="node113" class="node">
<title>expert_agg_gpu5_layer1</title>
<polygon fill="lightyellow" stroke="black" points="12669.19,-332.98 12179.5,-332.98 12053.53,-250.98 12543.22,-250.98 12669.19,-332.98"/>
<text text-anchor="middle" x="12361.36" y="-300.48" font-family="Arial" font-size="10.00">GPU5: Expert Aggregation</text>
<text text-anchor="middle" x="12361.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="12361.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu5_layer1&#45;&gt;expert_agg_gpu5_layer1 -->
<g id="edge200" class="edge">
<title>comm_expert_recv_gpu5_layer1&#45;&gt;expert_agg_gpu5_layer1</title>
<path fill="none" stroke="black" d="M13742.48,-386.84C13481.75,-369.12 12969.11,-334.28 12647.04,-312.4"/>
<polygon fill="black" stroke="black" points="12646.83,-308.87 12636.61,-311.69 12646.35,-315.86 12646.83,-308.87"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge105" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="black" d="M19139.96,-551.49C19118.45,-548.42 19096.28,-545.45 19075.36,-542.97 18810.85,-511.55 18498.92,-496.64 18329.41,-490.38"/>
<polygon fill="black" stroke="black" points="18329.32,-486.87 18319.2,-490.01 18329.07,-493.87 18329.32,-486.87"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp1_layer1 -->
<g id="edge106" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp1_layer1</title>
<path fill="none" stroke="black" d="M19190.25,-545.61C19156.5,-534.06 19116.85,-520.5 19084.04,-509.27"/>
<polygon fill="black" stroke="black" points="19085.13,-505.95 19074.54,-506.02 19082.86,-512.57 19085.13,-505.95"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp2_layer1 -->
<g id="edge107" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp2_layer1</title>
<path fill="none" stroke="black" d="M19264.36,-542.82C19264.36,-534.29 19264.36,-524.89 19264.36,-516.25"/>
<polygon fill="black" stroke="black" points="19267.86,-516.21 19264.36,-506.21 19260.86,-516.21 19267.86,-516.21"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp3_layer1 -->
<g id="edge108" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp3_layer1</title>
<path fill="none" stroke="black" d="M19145.41,-550.61C19069.59,-537.64 18971.52,-520.87 18894.68,-507.73"/>
<polygon fill="black" stroke="black" points="18894.91,-504.22 18884.46,-505.98 18893.73,-511.12 18894.91,-504.22"/>
</g>
<!-- expert_agg_gpu6_layer1 -->
<g id="node116" class="node">
<title>expert_agg_gpu6_layer1</title>
<polygon fill="lightyellow" stroke="black" points="16065.19,-332.98 15575.5,-332.98 15449.53,-250.98 15939.22,-250.98 16065.19,-332.98"/>
<text text-anchor="middle" x="15757.36" y="-300.48" font-family="Arial" font-size="10.00">GPU6: Expert Aggregation</text>
<text text-anchor="middle" x="15757.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="15757.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu6_layer1&#45;&gt;expert_agg_gpu6_layer1 -->
<g id="edge203" class="edge">
<title>comm_expert_recv_gpu6_layer1&#45;&gt;expert_agg_gpu6_layer1</title>
<path fill="none" stroke="black" d="M18595.35,-391.88C18091.49,-374.32 16634.88,-323.56 16027.89,-302.41"/>
<polygon fill="black" stroke="black" points="16027.81,-298.9 16017.69,-302.05 16027.56,-305.9 16027.81,-298.9"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge113" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="black" d="M16707.96,-551.49C16686.45,-548.42 16664.28,-545.45 16643.36,-542.97 16378.85,-511.55 16066.92,-496.64 15897.41,-490.38"/>
<polygon fill="black" stroke="black" points="15897.32,-486.87 15887.2,-490.01 15897.07,-493.87 15897.32,-486.87"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp1_layer1 -->
<g id="edge114" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp1_layer1</title>
<path fill="none" stroke="black" d="M16713.41,-550.61C16637.59,-537.64 16539.52,-520.87 16462.68,-507.73"/>
<polygon fill="black" stroke="black" points="16462.91,-504.22 16452.46,-505.98 16461.73,-511.12 16462.91,-504.22"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp2_layer1 -->
<g id="edge115" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp2_layer1</title>
<path fill="none" stroke="black" d="M16758.25,-545.61C16724.5,-534.06 16684.85,-520.5 16652.04,-509.27"/>
<polygon fill="black" stroke="black" points="16653.13,-505.95 16642.54,-506.02 16650.86,-512.57 16653.13,-505.95"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp3_layer1 -->
<g id="edge116" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp3_layer1</title>
<path fill="none" stroke="black" d="M16832.36,-542.82C16832.36,-534.29 16832.36,-524.89 16832.36,-516.25"/>
<polygon fill="black" stroke="black" points="16835.86,-516.21 16832.36,-506.21 16828.86,-516.21 16835.86,-516.21"/>
</g>
<!-- expert_agg_gpu7_layer1 -->
<g id="node119" class="node">
<title>expert_agg_gpu7_layer1</title>
<polygon fill="lightyellow" stroke="black" points="14722.19,-332.98 14232.5,-332.98 14106.53,-250.98 14596.22,-250.98 14722.19,-332.98"/>
<text text-anchor="middle" x="14414.36" y="-300.48" font-family="Arial" font-size="10.00">GPU7: Expert Aggregation</text>
<text text-anchor="middle" x="14414.36" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="14414.36" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu7_layer1&#45;&gt;expert_agg_gpu7_layer1 -->
<g id="edge206" class="edge">
<title>comm_expert_recv_gpu7_layer1&#45;&gt;expert_agg_gpu7_layer1</title>
<path fill="none" stroke="black" d="M16169.31,-388.75C15837.62,-370.65 15098.66,-330.32 14693.45,-308.21"/>
<polygon fill="black" stroke="black" points="14693.52,-304.71 14683.34,-307.66 14693.14,-311.7 14693.52,-304.71"/>
</g>
<!-- mlp_gpu0_layer1 -->
<g id="node99" class="node">
<title>mlp_gpu0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9589.86,-213.98 9334.86,-213.98 9334.86,-172.98 9589.86,-172.98 9589.86,-213.98"/>
<text text-anchor="middle" x="9462.36" y="-201.98" font-family="Arial" font-size="10.00">GPU0: MLP Compute</text>
<text text-anchor="middle" x="9462.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9462.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu0_layer1&#45;&gt;mlp_gpu0_layer1 -->
<g id="edge186" class="edge">
<title>expert_agg_gpu0_layer1&#45;&gt;mlp_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9421.44,-250.9C9428.44,-241.24 9435.77,-231.14 9442.26,-222.2"/>
<polygon fill="black" stroke="black" points="9445.15,-224.18 9448.19,-214.03 9439.48,-220.07 9445.15,-224.18"/>
</g>
<!-- mlp_agg_gpu0_layer1 -->
<g id="node100" class="node">
<title>mlp_agg_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9494.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="9494.36" y="-115.49" font-family="Arial" font-size="10.00">GPU0: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="9494.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9494.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu0_layer1&#45;&gt;mlp_agg_gpu0_layer1 -->
<g id="edge187" class="edge">
<title>mlp_gpu0_layer1&#45;&gt;mlp_agg_gpu0_layer1</title>
<path fill="none" stroke="black" d="M9469.78,-172.89C9472.85,-164.78 9476.52,-155.1 9480.07,-145.72"/>
<polygon fill="black" stroke="black" points="9483.44,-146.72 9483.71,-136.13 9476.89,-144.24 9483.44,-146.72"/>
</g>
<!-- output -->
<g id="node122" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="9785.86,-41 9530.86,-41 9530.86,0 9785.86,0 9785.86,-41"/>
<text text-anchor="middle" x="9658.36" y="-29" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="9658.36" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9658.36" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_agg_gpu0_layer1&#45;&gt;output -->
<g id="edge209" class="edge">
<title>mlp_agg_gpu0_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9546.7,-79.03C9567.43,-68.35 9591.09,-56.16 9611.27,-45.76"/>
<polygon fill="black" stroke="black" points="9612.99,-48.81 9620.27,-41.12 9609.78,-42.59 9612.99,-48.81"/>
</g>
<!-- mlp_gpu1_layer1 -->
<g id="node102" class="node">
<title>mlp_gpu1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8443.86,-213.98 8188.86,-213.98 8188.86,-172.98 8443.86,-172.98 8443.86,-213.98"/>
<text text-anchor="middle" x="8316.36" y="-201.98" font-family="Arial" font-size="10.00">GPU1: MLP Compute</text>
<text text-anchor="middle" x="8316.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8316.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu1_layer1&#45;&gt;mlp_gpu1_layer1 -->
<g id="edge189" class="edge">
<title>expert_agg_gpu1_layer1&#45;&gt;mlp_gpu1_layer1</title>
<path fill="none" stroke="black" d="M4858.6,-281.79C5083.22,-273 5435.3,-259.82 5740.36,-250.98 6671.94,-224 7793.36,-203.51 8178.62,-196.82"/>
<polygon fill="black" stroke="black" points="8178.76,-200.32 8188.69,-196.65 8178.64,-193.32 8178.76,-200.32"/>
</g>
<!-- mlp_agg_gpu1_layer1 -->
<g id="node103" class="node">
<title>mlp_agg_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8348.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="8348.36" y="-115.49" font-family="Arial" font-size="10.00">GPU1: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="8348.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8348.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu1_layer1&#45;&gt;mlp_agg_gpu1_layer1 -->
<g id="edge190" class="edge">
<title>mlp_gpu1_layer1&#45;&gt;mlp_agg_gpu1_layer1</title>
<path fill="none" stroke="black" d="M8323.78,-172.89C8326.85,-164.78 8330.52,-155.1 8334.07,-145.72"/>
<polygon fill="black" stroke="black" points="8337.44,-146.72 8337.71,-136.13 8330.89,-144.24 8337.44,-146.72"/>
</g>
<!-- mlp_agg_gpu1_layer1&#45;&gt;output -->
<g id="edge210" class="edge">
<title>mlp_agg_gpu1_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8474.3,-86.18C8497.23,-83.07 8520.98,-80.17 8543.36,-78 8894.28,-44 9309.43,-29.79 9520.38,-24.41"/>
<polygon fill="black" stroke="black" points="9520.67,-27.91 9530.58,-24.16 9520.49,-20.91 9520.67,-27.91"/>
</g>
<!-- mlp_gpu2_layer1 -->
<g id="node105" class="node">
<title>mlp_gpu2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8779.86,-213.98 8524.86,-213.98 8524.86,-172.98 8779.86,-172.98 8779.86,-213.98"/>
<text text-anchor="middle" x="8652.36" y="-201.98" font-family="Arial" font-size="10.00">GPU2: MLP Compute</text>
<text text-anchor="middle" x="8652.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8652.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu2_layer1&#45;&gt;mlp_gpu2_layer1 -->
<g id="edge192" class="edge">
<title>expert_agg_gpu2_layer1&#45;&gt;mlp_gpu2_layer1</title>
<path fill="none" stroke="black" d="M6285.57,-281.05C6489.45,-272.39 6796.3,-259.85 7063.36,-250.98 7681.02,-230.48 7836.56,-252.36 8453.36,-213.98 8473.24,-212.75 8494.2,-211.08 8514.76,-209.25"/>
<polygon fill="black" stroke="black" points="8515.17,-212.73 8524.81,-208.34 8514.54,-205.76 8515.17,-212.73"/>
</g>
<!-- mlp_agg_gpu2_layer1 -->
<g id="node106" class="node">
<title>mlp_agg_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8732.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="8732.36" y="-115.49" font-family="Arial" font-size="10.00">GPU2: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="8732.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8732.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu2_layer1&#45;&gt;mlp_agg_gpu2_layer1 -->
<g id="edge193" class="edge">
<title>mlp_gpu2_layer1&#45;&gt;mlp_agg_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8670.92,-172.89C8679.31,-164.02 8689.49,-153.27 8699.14,-143.08"/>
<polygon fill="black" stroke="black" points="8701.7,-145.47 8706.03,-135.8 8696.61,-140.66 8701.7,-145.47"/>
</g>
<!-- mlp_agg_gpu2_layer1&#45;&gt;output -->
<g id="edge211" class="edge">
<title>mlp_agg_gpu2_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8859.12,-86.37C8881.17,-83.31 8903.91,-80.38 8925.36,-78 9132.3,-55.04 9373.14,-38.4 9520.65,-29.35"/>
<polygon fill="black" stroke="black" points="9520.9,-32.84 9530.67,-28.74 9520.47,-25.85 9520.9,-32.84"/>
</g>
<!-- mlp_gpu3_layer1 -->
<g id="node108" class="node">
<title>mlp_gpu3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9083.86,-213.98 8828.86,-213.98 8828.86,-172.98 9083.86,-172.98 9083.86,-213.98"/>
<text text-anchor="middle" x="8956.36" y="-201.98" font-family="Arial" font-size="10.00">GPU3: MLP Compute</text>
<text text-anchor="middle" x="8956.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8956.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu3_layer1&#45;&gt;mlp_gpu3_layer1 -->
<g id="edge195" class="edge">
<title>expert_agg_gpu3_layer1&#45;&gt;mlp_gpu3_layer1</title>
<path fill="none" stroke="black" d="M7611.31,-282.73C7890.65,-271.74 8375.02,-249.46 8789.36,-213.98 8798.96,-213.16 8808.86,-212.23 8818.82,-211.22"/>
<polygon fill="black" stroke="black" points="8819.2,-214.7 8828.79,-210.2 8818.49,-207.74 8819.2,-214.7"/>
</g>
<!-- mlp_agg_gpu3_layer1 -->
<g id="node109" class="node">
<title>mlp_agg_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9114.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="9114.36" y="-115.49" font-family="Arial" font-size="10.00">GPU3: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="9114.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9114.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu3_layer1&#45;&gt;mlp_agg_gpu3_layer1 -->
<g id="edge196" class="edge">
<title>mlp_gpu3_layer1&#45;&gt;mlp_agg_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8993.01,-172.89C9011.51,-162.99 9034.42,-150.74 9055.33,-139.56"/>
<polygon fill="black" stroke="black" points="9056.99,-142.64 9064.15,-134.84 9053.68,-136.47 9056.99,-142.64"/>
</g>
<!-- mlp_agg_gpu3_layer1&#45;&gt;output -->
<g id="edge212" class="edge">
<title>mlp_agg_gpu3_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9241.22,-86.29C9325.63,-73.18 9436.41,-55.97 9522.6,-42.59"/>
<polygon fill="black" stroke="black" points="9523.37,-46.01 9532.72,-41.01 9522.3,-39.09 9523.37,-46.01"/>
</g>
<!-- mlp_gpu4_layer1 -->
<g id="node111" class="node">
<title>mlp_gpu4_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10191.86,-213.98 9936.86,-213.98 9936.86,-172.98 10191.86,-172.98 10191.86,-213.98"/>
<text text-anchor="middle" x="10064.36" y="-201.98" font-family="Arial" font-size="10.00">GPU4: MLP Compute</text>
<text text-anchor="middle" x="10064.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10064.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu4_layer1&#45;&gt;mlp_gpu4_layer1 -->
<g id="edge198" class="edge">
<title>expert_agg_gpu4_layer1&#45;&gt;mlp_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10073.13,-250.9C10071.74,-241.94 10070.29,-232.6 10068.97,-224.15"/>
<polygon fill="black" stroke="black" points="10072.39,-223.37 10067.4,-214.03 10065.48,-224.45 10072.39,-223.37"/>
</g>
<!-- mlp_agg_gpu4_layer1 -->
<g id="node112" class="node">
<title>mlp_agg_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10000.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="10000.36" y="-115.49" font-family="Arial" font-size="10.00">GPU4: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="10000.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10000.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu4_layer1&#45;&gt;mlp_agg_gpu4_layer1 -->
<g id="edge199" class="edge">
<title>mlp_gpu4_layer1&#45;&gt;mlp_agg_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10049.52,-172.89C10043,-164.28 10035.13,-153.89 10027.62,-143.97"/>
<polygon fill="black" stroke="black" points="10030.26,-141.66 10021.43,-135.8 10024.68,-145.89 10030.26,-141.66"/>
</g>
<!-- mlp_agg_gpu4_layer1&#45;&gt;output -->
<g id="edge213" class="edge">
<title>mlp_agg_gpu4_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9904.64,-82.34C9855.28,-70.15 9795.46,-55.37 9747.14,-43.43"/>
<polygon fill="black" stroke="black" points="9747.87,-40.01 9737.33,-41.01 9746.2,-46.8 9747.87,-40.01"/>
</g>
<!-- mlp_gpu5_layer1 -->
<g id="node114" class="node">
<title>mlp_gpu5_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11548.86,-213.98 11293.86,-213.98 11293.86,-172.98 11548.86,-172.98 11548.86,-213.98"/>
<text text-anchor="middle" x="11421.36" y="-201.98" font-family="Arial" font-size="10.00">GPU5: MLP Compute</text>
<text text-anchor="middle" x="11421.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="11421.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu5_layer1&#45;&gt;mlp_gpu5_layer1 -->
<g id="edge201" class="edge">
<title>expert_agg_gpu5_layer1&#45;&gt;mlp_gpu5_layer1</title>
<path fill="none" stroke="black" d="M12068.77,-260.95C11898.87,-243.5 11692.72,-222.34 11559.39,-208.65"/>
<polygon fill="black" stroke="black" points="11559.42,-205.14 11549.12,-207.6 11558.71,-212.1 11559.42,-205.14"/>
</g>
<!-- mlp_agg_gpu5_layer1 -->
<g id="node115" class="node">
<title>mlp_agg_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10464.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="10464.36" y="-115.49" font-family="Arial" font-size="10.00">GPU5: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="10464.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10464.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu5_layer1&#45;&gt;mlp_agg_gpu5_layer1 -->
<g id="edge202" class="edge">
<title>mlp_gpu5_layer1&#45;&gt;mlp_agg_gpu5_layer1</title>
<path fill="none" stroke="black" d="M11293.71,-184.14C11148.95,-174.3 10905.94,-156.64 10697.36,-135.98 10670.1,-133.28 10641.08,-130.07 10613.12,-126.8"/>
<polygon fill="black" stroke="black" points="10613.21,-123.29 10602.87,-125.59 10612.39,-130.24 10613.21,-123.29"/>
</g>
<!-- mlp_agg_gpu5_layer1&#45;&gt;output -->
<g id="edge214" class="edge">
<title>mlp_agg_gpu5_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10316.06,-90.45C10167.65,-74.89 9941.15,-51.14 9796.46,-35.98"/>
<polygon fill="black" stroke="black" points="9796.49,-32.46 9786.18,-34.9 9795.76,-39.42 9796.49,-32.46"/>
</g>
<!-- mlp_gpu6_layer1 -->
<g id="node117" class="node">
<title>mlp_gpu6_layer1</title>
<polygon fill="lightgreen" stroke="black" points="12199.86,-213.98 11944.86,-213.98 11944.86,-172.98 12199.86,-172.98 12199.86,-213.98"/>
<text text-anchor="middle" x="12072.36" y="-201.98" font-family="Arial" font-size="10.00">GPU6: MLP Compute</text>
<text text-anchor="middle" x="12072.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12072.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu6_layer1&#45;&gt;mlp_gpu6_layer1 -->
<g id="edge204" class="edge">
<title>expert_agg_gpu6_layer1&#45;&gt;mlp_gpu6_layer1</title>
<path fill="none" stroke="black" d="M15493.02,-279.39C15285.84,-270.61 14990.28,-258.78 14731.36,-250.98 13766.15,-221.92 12603.4,-202.63 12210.03,-196.55"/>
<polygon fill="black" stroke="black" points="12210.08,-193.05 12200.03,-196.39 12209.97,-200.05 12210.08,-193.05"/>
</g>
<!-- mlp_agg_gpu6_layer1 -->
<g id="node118" class="node">
<title>mlp_agg_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="11286.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="11286.36" y="-115.49" font-family="Arial" font-size="10.00">GPU6: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="11286.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="11286.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu6_layer1&#45;&gt;mlp_agg_gpu6_layer1 -->
<g id="edge205" class="edge">
<title>mlp_gpu6_layer1&#45;&gt;mlp_agg_gpu6_layer1</title>
<path fill="none" stroke="black" d="M11944.45,-177.78C11929.92,-176.14 11915.32,-174.52 11901.36,-172.98 11746.41,-155.96 11569.39,-137.34 11445.19,-124.41"/>
<polygon fill="black" stroke="black" points="11445.52,-120.93 11435.21,-123.37 11444.8,-127.89 11445.52,-120.93"/>
</g>
<!-- mlp_agg_gpu6_layer1&#45;&gt;output -->
<g id="edge215" class="edge">
<title>mlp_agg_gpu6_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11156.57,-86.86C11129.77,-83.45 11101.69,-80.27 11075.36,-78 10607.28,-37.71 10049.68,-26.09 9796.11,-22.79"/>
<polygon fill="black" stroke="black" points="9796.15,-19.29 9786.11,-22.66 9796.06,-26.29 9796.15,-19.29"/>
</g>
<!-- mlp_gpu7_layer1 -->
<g id="node120" class="node">
<title>mlp_gpu7_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11891.86,-213.98 11636.86,-213.98 11636.86,-172.98 11891.86,-172.98 11891.86,-213.98"/>
<text text-anchor="middle" x="11764.36" y="-201.98" font-family="Arial" font-size="10.00">GPU7: MLP Compute</text>
<text text-anchor="middle" x="11764.36" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="11764.36" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu7_layer1&#45;&gt;mlp_gpu7_layer1 -->
<g id="edge207" class="edge">
<title>expert_agg_gpu7_layer1&#45;&gt;mlp_gpu7_layer1</title>
<path fill="none" stroke="black" d="M14159.71,-285.72C13617.22,-274.07 12362.38,-244.7 11936.36,-213.98 11925.23,-213.18 11913.72,-212.2 11902.16,-211.11"/>
<polygon fill="black" stroke="black" points="11902.29,-207.61 11891.99,-210.13 11901.61,-214.58 11902.29,-207.61"/>
</g>
<!-- mlp_agg_gpu7_layer1 -->
<g id="node121" class="node">
<title>mlp_agg_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10886.36" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="10886.36" y="-115.49" font-family="Arial" font-size="10.00">GPU7: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="10886.36" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10886.36" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu7_layer1&#45;&gt;mlp_agg_gpu7_layer1 -->
<g id="edge208" class="edge">
<title>mlp_gpu7_layer1&#45;&gt;mlp_agg_gpu7_layer1</title>
<path fill="none" stroke="black" d="M11636.64,-180.11C11610.74,-177.68 11583.68,-175.2 11558.36,-172.98 11353.6,-155.07 11301.76,-157.73 11097.36,-135.98 11075.28,-133.63 11051.93,-130.84 11029.13,-127.95"/>
<polygon fill="black" stroke="black" points="11029.42,-124.46 11019.05,-126.66 11028.53,-131.4 11029.42,-124.46"/>
</g>
<!-- mlp_agg_gpu7_layer1&#45;&gt;output -->
<g id="edge216" class="edge">
<title>mlp_agg_gpu7_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10749.45,-88.09C10717.92,-84.37 10684.51,-80.75 10653.36,-78 10347.95,-51.01 9988.6,-34.31 9796.33,-26.59"/>
<polygon fill="black" stroke="black" points="9796.3,-23.09 9786.17,-26.19 9796.02,-30.08 9796.3,-23.09"/>
</g>
</g>
</svg>
