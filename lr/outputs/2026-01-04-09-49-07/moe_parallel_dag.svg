<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="96pt"
 viewBox="0.00 0.00 1440.00 95.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.08 0.08) rotate(0) translate(4 1239.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1239.91 18745,-1239.91 18745,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="9361,-1235.91 9106,-1235.91 9106,-1194.91 9361,-1194.91 9361,-1235.91"/>
<text text-anchor="middle" x="9233.5" y="-1223.91" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="9233.5" y="-1212.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9233.5" y="-1201.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- embed_gpu0 -->
<g id="node2" class="node">
<title>embed_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="8387,-1157.91 8132,-1157.91 8132,-1116.91 8387,-1116.91 8387,-1157.91"/>
<text text-anchor="middle" x="8259.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU0: Token Embedding</text>
<text text-anchor="middle" x="8259.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8259.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_gpu0</title>
<path fill="none" stroke="black" d="M9105.67,-1206.81C8948.5,-1197.12 8673.64,-1179.07 8438.5,-1157.91 8425.1,-1156.71 8411.14,-1155.36 8397.19,-1153.94"/>
<polygon fill="black" stroke="black" points="8397.35,-1150.44 8387.05,-1152.9 8396.64,-1157.4 8397.35,-1150.44"/>
</g>
<!-- embed_gpu1 -->
<g id="node3" class="node">
<title>embed_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="8703,-1157.91 8448,-1157.91 8448,-1116.91 8703,-1116.91 8703,-1157.91"/>
<text text-anchor="middle" x="8575.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU1: Token Embedding</text>
<text text-anchor="middle" x="8575.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8575.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;embed_gpu1</title>
<path fill="none" stroke="black" d="M9105.78,-1200.28C9004.95,-1189.05 8860.7,-1172.8 8734.5,-1157.91 8727.47,-1157.09 8720.27,-1156.23 8713.01,-1155.36"/>
<polygon fill="black" stroke="black" points="8713.41,-1151.88 8703.06,-1154.16 8712.57,-1158.83 8713.41,-1151.88"/>
</g>
<!-- embed_gpu2 -->
<g id="node4" class="node">
<title>embed_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="8998,-1157.91 8743,-1157.91 8743,-1116.91 8998,-1116.91 8998,-1157.91"/>
<text text-anchor="middle" x="8870.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU2: Token Embedding</text>
<text text-anchor="middle" x="8870.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8870.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;embed_gpu2</title>
<path fill="none" stroke="black" d="M9140.02,-1194.84C9089.1,-1184.18 9025.99,-1170.97 8973.65,-1160.01"/>
<polygon fill="black" stroke="black" points="8974.17,-1156.54 8963.66,-1157.92 8972.74,-1163.39 8974.17,-1156.54"/>
</g>
<!-- embed_gpu3 -->
<g id="node5" class="node">
<title>embed_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="9282,-1157.91 9027,-1157.91 9027,-1116.91 9282,-1116.91 9282,-1157.91"/>
<text text-anchor="middle" x="9154.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU3: Token Embedding</text>
<text text-anchor="middle" x="9154.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9154.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;embed_gpu3</title>
<path fill="none" stroke="black" d="M9213.16,-1194.84C9203.76,-1185.8 9192.45,-1174.92 9182.28,-1165.14"/>
<polygon fill="black" stroke="black" points="9184.41,-1162.33 9174.78,-1157.92 9179.56,-1167.37 9184.41,-1162.33"/>
</g>
<!-- embed_gpu4 -->
<g id="node6" class="node">
<title>embed_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="10143,-1157.91 9888,-1157.91 9888,-1116.91 10143,-1116.91 10143,-1157.91"/>
<text text-anchor="middle" x="10015.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU4: Token Embedding</text>
<text text-anchor="middle" x="10015.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10015.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;embed_gpu4</title>
<path fill="none" stroke="black" d="M9361.04,-1204.36C9488.21,-1194 9689.05,-1176.75 9862.5,-1157.91 9867.53,-1157.37 9872.65,-1156.8 9877.82,-1156.21"/>
<polygon fill="black" stroke="black" points="9878.28,-1159.68 9887.81,-1155.05 9877.48,-1152.72 9878.28,-1159.68"/>
</g>
<!-- embed_gpu5 -->
<g id="node7" class="node">
<title>embed_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9853,-1157.91 9598,-1157.91 9598,-1116.91 9853,-1116.91 9853,-1157.91"/>
<text text-anchor="middle" x="9725.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU5: Token Embedding</text>
<text text-anchor="middle" x="9725.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9725.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;embed_gpu5</title>
<path fill="none" stroke="black" d="M9359.88,-1194.89C9430.04,-1184.05 9517.35,-1170.57 9589.06,-1159.49"/>
<polygon fill="black" stroke="black" points="9589.72,-1162.93 9599.07,-1157.94 9588.65,-1156.01 9589.72,-1162.93"/>
</g>
<!-- embed_gpu6 -->
<g id="node8" class="node">
<title>embed_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9565,-1157.91 9310,-1157.91 9310,-1116.91 9565,-1116.91 9565,-1157.91"/>
<text text-anchor="middle" x="9437.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU6: Token Embedding</text>
<text text-anchor="middle" x="9437.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9437.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;embed_gpu6</title>
<path fill="none" stroke="black" d="M9286.04,-1194.84C9313.4,-1184.65 9347.03,-1172.12 9375.65,-1161.46"/>
<polygon fill="black" stroke="black" points="9376.99,-1164.69 9385.14,-1157.92 9374.55,-1158.13 9376.99,-1164.69"/>
</g>
<!-- embed_gpu7 -->
<g id="node9" class="node">
<title>embed_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="10435,-1157.91 10180,-1157.91 10180,-1116.91 10435,-1116.91 10435,-1157.91"/>
<text text-anchor="middle" x="10307.5" y="-1145.91" font-family="Arial" font-size="10.00">GPU7: Token Embedding</text>
<text text-anchor="middle" x="10307.5" y="-1134.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10307.5" y="-1123.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_gpu7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;embed_gpu7</title>
<path fill="none" stroke="black" d="M9361.18,-1209.14C9538.85,-1201.21 9870.6,-1184.29 10152.5,-1157.91 10158.07,-1157.39 10163.75,-1156.83 10169.48,-1156.23"/>
<polygon fill="black" stroke="black" points="10170.28,-1159.67 10179.85,-1155.13 10169.53,-1152.71 10170.28,-1159.67"/>
</g>
<!-- attn_qkv_gpu0_layer1 -->
<g id="node10" class="node">
<title>attn_qkv_gpu0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8224,-1079.91 7949,-1079.91 7949,-1038.91 8224,-1038.91 8224,-1079.91"/>
<text text-anchor="middle" x="8086.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU0: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="8086.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8086.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu0&#45;&gt;attn_qkv_gpu0_layer1 -->
<g id="edge9" class="edge">
<title>embed_gpu0&#45;&gt;attn_qkv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M8214.95,-1116.84C8192.15,-1106.82 8164.21,-1094.55 8140.22,-1084.01"/>
<polygon fill="black" stroke="black" points="8141.46,-1080.74 8130.9,-1079.92 8138.65,-1087.15 8141.46,-1080.74"/>
</g>
<!-- attn_qkv_gpu1_layer1 -->
<g id="node14" class="node">
<title>attn_qkv_gpu1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8574,-1079.91 8299,-1079.91 8299,-1038.91 8574,-1038.91 8574,-1079.91"/>
<text text-anchor="middle" x="8436.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU1: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="8436.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8436.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu1&#45;&gt;attn_qkv_gpu1_layer1 -->
<g id="edge13" class="edge">
<title>embed_gpu1&#45;&gt;attn_qkv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M8539.7,-1116.84C8521.79,-1107.05 8499.93,-1095.09 8480.95,-1084.72"/>
<polygon fill="black" stroke="black" points="8482.63,-1081.65 8472.17,-1079.92 8479.27,-1087.79 8482.63,-1081.65"/>
</g>
<!-- attn_qkv_gpu2_layer1 -->
<g id="node18" class="node">
<title>attn_qkv_gpu2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8895,-1079.91 8620,-1079.91 8620,-1038.91 8895,-1038.91 8895,-1079.91"/>
<text text-anchor="middle" x="8757.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU2: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="8757.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8757.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu2&#45;&gt;attn_qkv_gpu2_layer1 -->
<g id="edge17" class="edge">
<title>embed_gpu2&#45;&gt;attn_qkv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8841.4,-1116.84C8827.3,-1107.36 8810.19,-1095.85 8795.11,-1085.71"/>
<polygon fill="black" stroke="black" points="8796.75,-1082.6 8786.5,-1079.92 8792.85,-1088.4 8796.75,-1082.6"/>
</g>
<!-- attn_qkv_gpu3_layer1 -->
<g id="node22" class="node">
<title>attn_qkv_gpu3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9279,-1079.91 9004,-1079.91 9004,-1038.91 9279,-1038.91 9279,-1079.91"/>
<text text-anchor="middle" x="9141.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU3: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="9141.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9141.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu3&#45;&gt;attn_qkv_gpu3_layer1 -->
<g id="edge21" class="edge">
<title>embed_gpu3&#45;&gt;attn_qkv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9151.15,-1116.84C9149.76,-1108.69 9148.11,-1099.04 9146.57,-1090.04"/>
<polygon fill="black" stroke="black" points="9149.97,-1089.19 9144.84,-1079.92 9143.07,-1090.37 9149.97,-1089.19"/>
</g>
<!-- attn_qkv_gpu4_layer1 -->
<g id="node26" class="node">
<title>attn_qkv_gpu4_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10220,-1079.91 9945,-1079.91 9945,-1038.91 10220,-1038.91 10220,-1079.91"/>
<text text-anchor="middle" x="10082.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU4: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="10082.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10082.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu4&#45;&gt;attn_qkv_gpu4_layer1 -->
<g id="edge25" class="edge">
<title>embed_gpu4&#45;&gt;attn_qkv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10032.75,-1116.84C10040.65,-1107.89 10050.13,-1097.13 10058.69,-1087.43"/>
<polygon fill="black" stroke="black" points="10061.32,-1089.74 10065.3,-1079.92 10056.07,-1085.11 10061.32,-1089.74"/>
</g>
<!-- attn_qkv_gpu5_layer1 -->
<g id="node30" class="node">
<title>attn_qkv_gpu5_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9916,-1079.91 9641,-1079.91 9641,-1038.91 9916,-1038.91 9916,-1079.91"/>
<text text-anchor="middle" x="9778.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU5: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="9778.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9778.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu5&#45;&gt;attn_qkv_gpu5_layer1 -->
<g id="edge29" class="edge">
<title>embed_gpu5&#45;&gt;attn_qkv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M9739.15,-1116.84C9745.21,-1108.15 9752.45,-1097.77 9759.06,-1088.29"/>
<polygon fill="black" stroke="black" points="9762.05,-1090.12 9764.9,-1079.92 9756.31,-1086.12 9762.05,-1090.12"/>
</g>
<!-- attn_qkv_gpu6_layer1 -->
<g id="node34" class="node">
<title>attn_qkv_gpu6_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9600,-1079.91 9325,-1079.91 9325,-1038.91 9600,-1038.91 9600,-1079.91"/>
<text text-anchor="middle" x="9462.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU6: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="9462.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9462.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu6&#45;&gt;attn_qkv_gpu6_layer1 -->
<g id="edge33" class="edge">
<title>embed_gpu6&#45;&gt;attn_qkv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M9443.94,-1116.84C9446.68,-1108.51 9449.93,-1098.62 9452.95,-1089.46"/>
<polygon fill="black" stroke="black" points="9456.28,-1090.51 9456.08,-1079.92 9449.63,-1088.32 9456.28,-1090.51"/>
</g>
<!-- attn_qkv_gpu7_layer1 -->
<g id="node38" class="node">
<title>attn_qkv_gpu7_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10519,-1079.91 10244,-1079.91 10244,-1038.91 10519,-1038.91 10519,-1079.91"/>
<text text-anchor="middle" x="10381.5" y="-1067.91" font-family="Arial" font-size="10.00">GPU7: Layer1 Attention QKV Proj</text>
<text text-anchor="middle" x="10381.5" y="-1056.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10381.5" y="-1045.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- embed_gpu7&#45;&gt;attn_qkv_gpu7_layer1 -->
<g id="edge37" class="edge">
<title>embed_gpu7&#45;&gt;attn_qkv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M10326.56,-1116.84C10335.36,-1107.8 10345.95,-1096.92 10355.48,-1087.14"/>
<polygon fill="black" stroke="black" points="10358.04,-1089.53 10362.51,-1079.92 10353.02,-1084.64 10358.04,-1089.53"/>
</g>
<!-- comm_qkv_gpu0_layer1 -->
<g id="node11" class="node">
<title>comm_qkv_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="7858.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="7858.5" y="-981.42" font-family="Arial" font-size="10.00">GPU0: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="7858.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7858.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu0_layer1&#45;&gt;comm_qkv_gpu0_layer1 -->
<g id="edge10" class="edge">
<title>attn_qkv_gpu0_layer1&#45;&gt;comm_qkv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M8033.62,-1038.82C8005.36,-1028.35 7970,-1015.24 7938.46,-1003.55"/>
<polygon fill="black" stroke="black" points="7939.4,-1000.17 7928.81,-999.98 7936.97,-1006.73 7939.4,-1000.17"/>
</g>
<!-- attn_comp_gpu0_layer1 -->
<g id="node12" class="node">
<title>attn_comp_gpu0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="7855,-906.93 7580,-906.93 7580,-865.93 7855,-865.93 7855,-906.93"/>
<text text-anchor="middle" x="7717.5" y="-894.93" font-family="Arial" font-size="10.00">GPU0: Layer1 Attention Compute</text>
<text text-anchor="middle" x="7717.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7717.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu0_layer1&#45;&gt;attn_comp_gpu0_layer1 -->
<g id="edge11" class="edge">
<title>comm_qkv_gpu0_layer1&#45;&gt;attn_comp_gpu0_layer1</title>
<path fill="none" stroke="black" d="M7813.11,-944.72C7795.7,-934.29 7775.93,-922.45 7758.91,-912.25"/>
<polygon fill="black" stroke="black" points="7760.67,-909.22 7750.29,-907.08 7757.07,-915.22 7760.67,-909.22"/>
</g>
<!-- comm_attn_out_gpu0_layer1 -->
<g id="node13" class="node">
<title>comm_attn_out_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="7584.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="7584.5" y="-808.44" font-family="Arial" font-size="10.00">GPU0: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="7584.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7584.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu0_layer1&#45;&gt;comm_attn_out_gpu0_layer1 -->
<g id="edge12" class="edge">
<title>attn_comp_gpu0_layer1&#45;&gt;comm_attn_out_gpu0_layer1</title>
<path fill="none" stroke="black" d="M7686.65,-865.83C7671.69,-856.33 7653.3,-844.65 7636.28,-833.83"/>
<polygon fill="black" stroke="black" points="7637.84,-830.68 7627.52,-828.27 7634.08,-836.59 7637.84,-830.68"/>
</g>
<!-- gate_gpu0_layer1 -->
<g id="node42" class="node">
<title>gate_gpu0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="7639.73,-733.95 7230.53,-733.95 7125.27,-651.95 7534.47,-651.95 7639.73,-733.95"/>
<text text-anchor="middle" x="7382.5" y="-701.45" font-family="Arial" font-size="10.00">GPU0: Layer1 Gate Routing</text>
<text text-anchor="middle" x="7382.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7382.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu0_layer1&#45;&gt;gate_gpu0_layer1 -->
<g id="edge41" class="edge">
<title>comm_attn_out_gpu0_layer1&#45;&gt;gate_gpu0_layer1</title>
<path fill="none" stroke="black" d="M7532.74,-772.04C7513.22,-761.89 7490.45,-750.06 7468.63,-738.72"/>
<polygon fill="black" stroke="black" points="7470.16,-735.57 7459.67,-734.06 7466.93,-741.78 7470.16,-735.57"/>
</g>
<!-- comm_qkv_gpu1_layer1 -->
<g id="node15" class="node">
<title>comm_qkv_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8265.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8265.5" y="-981.42" font-family="Arial" font-size="10.00">GPU1: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="8265.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8265.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu1_layer1&#45;&gt;comm_qkv_gpu1_layer1 -->
<g id="edge14" class="edge">
<title>attn_qkv_gpu1_layer1&#45;&gt;comm_qkv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M8396.84,-1038.82C8376.72,-1028.88 8351.8,-1016.56 8329.08,-1005.34"/>
<polygon fill="black" stroke="black" points="8330.36,-1002.06 8319.84,-1000.77 8327.26,-1008.34 8330.36,-1002.06"/>
</g>
<!-- attn_comp_gpu1_layer1 -->
<g id="node16" class="node">
<title>attn_comp_gpu1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8194,-906.93 7919,-906.93 7919,-865.93 8194,-865.93 8194,-906.93"/>
<text text-anchor="middle" x="8056.5" y="-894.93" font-family="Arial" font-size="10.00">GPU1: Layer1 Attention Compute</text>
<text text-anchor="middle" x="8056.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8056.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu1_layer1&#45;&gt;attn_comp_gpu1_layer1 -->
<g id="edge15" class="edge">
<title>comm_qkv_gpu1_layer1&#45;&gt;attn_comp_gpu1_layer1</title>
<path fill="none" stroke="black" d="M8200.23,-945.54C8172.82,-934.45 8141.19,-921.67 8114.59,-910.92"/>
<polygon fill="black" stroke="black" points="8115.62,-907.56 8105.04,-907.05 8113,-914.05 8115.62,-907.56"/>
</g>
<!-- comm_attn_out_gpu1_layer1 -->
<g id="node17" class="node">
<title>comm_attn_out_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8024.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="8024.5" y="-808.44" font-family="Arial" font-size="10.00">GPU1: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="8024.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8024.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu1_layer1&#45;&gt;comm_attn_out_gpu1_layer1 -->
<g id="edge16" class="edge">
<title>attn_comp_gpu1_layer1&#45;&gt;comm_attn_out_gpu1_layer1</title>
<path fill="none" stroke="black" d="M8049.08,-865.83C8046.01,-857.73 8042.34,-848.05 8038.79,-838.66"/>
<polygon fill="black" stroke="black" points="8041.97,-837.19 8035.16,-829.07 8035.42,-839.67 8041.97,-837.19"/>
</g>
<!-- gate_gpu1_layer1 -->
<g id="node43" class="node">
<title>gate_gpu1_layer1</title>
<polygon fill="lightyellow" stroke="black" points="8174.73,-733.95 7765.53,-733.95 7660.27,-651.95 8069.47,-651.95 8174.73,-733.95"/>
<text text-anchor="middle" x="7917.5" y="-701.45" font-family="Arial" font-size="10.00">GPU1: Layer1 Gate Routing</text>
<text text-anchor="middle" x="7917.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7917.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu1_layer1&#45;&gt;gate_gpu1_layer1 -->
<g id="edge42" class="edge">
<title>comm_attn_out_gpu1_layer1&#45;&gt;gate_gpu1_layer1</title>
<path fill="none" stroke="black" d="M7996.11,-771.08C7986.75,-761.9 7976.07,-751.42 7965.66,-741.2"/>
<polygon fill="black" stroke="black" points="7968.11,-738.7 7958.52,-734.19 7963.2,-743.7 7968.11,-738.7"/>
</g>
<!-- comm_qkv_gpu2_layer1 -->
<g id="node19" class="node">
<title>comm_qkv_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8672.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8672.5" y="-981.42" font-family="Arial" font-size="10.00">GPU2: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="8672.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8672.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu2_layer1&#45;&gt;comm_qkv_gpu2_layer1 -->
<g id="edge18" class="edge">
<title>attn_qkv_gpu2_layer1&#45;&gt;comm_qkv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8737.79,-1038.82C8728.87,-1029.95 8718.05,-1019.2 8707.8,-1009.01"/>
<polygon fill="black" stroke="black" points="8710.04,-1006.3 8700.48,-1001.73 8705.1,-1011.27 8710.04,-1006.3"/>
</g>
<!-- attn_comp_gpu2_layer1 -->
<g id="node20" class="node">
<title>attn_comp_gpu2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="8689,-906.93 8414,-906.93 8414,-865.93 8689,-865.93 8689,-906.93"/>
<text text-anchor="middle" x="8551.5" y="-894.93" font-family="Arial" font-size="10.00">GPU2: Layer1 Attention Compute</text>
<text text-anchor="middle" x="8551.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8551.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu2_layer1&#45;&gt;attn_comp_gpu2_layer1 -->
<g id="edge19" class="edge">
<title>comm_qkv_gpu2_layer1&#45;&gt;attn_comp_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8633.21,-944.49C8618.7,-934.35 8602.32,-922.92 8588.06,-912.96"/>
<polygon fill="black" stroke="black" points="8589.69,-909.83 8579.48,-906.97 8585.68,-915.57 8589.69,-909.83"/>
</g>
<!-- comm_attn_out_gpu2_layer1 -->
<g id="node21" class="node">
<title>comm_attn_out_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="8460.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="8460.5" y="-808.44" font-family="Arial" font-size="10.00">GPU2: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="8460.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8460.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu2_layer1&#45;&gt;comm_attn_out_gpu2_layer1 -->
<g id="edge20" class="edge">
<title>attn_comp_gpu2_layer1&#45;&gt;comm_attn_out_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8530.39,-865.83C8520.75,-856.88 8509.04,-846.01 8497.97,-835.73"/>
<polygon fill="black" stroke="black" points="8500.16,-832.99 8490.45,-828.75 8495.4,-838.12 8500.16,-832.99"/>
</g>
<!-- gate_gpu2_layer1 -->
<g id="node44" class="node">
<title>gate_gpu2_layer1</title>
<polygon fill="lightyellow" stroke="black" points="8707.73,-733.95 8298.53,-733.95 8193.27,-651.95 8602.47,-651.95 8707.73,-733.95"/>
<text text-anchor="middle" x="8450.5" y="-701.45" font-family="Arial" font-size="10.00">GPU2: Layer1 Gate Routing</text>
<text text-anchor="middle" x="8450.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8450.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu2_layer1&#45;&gt;gate_gpu2_layer1 -->
<g id="edge43" class="edge">
<title>comm_attn_out_gpu2_layer1&#45;&gt;gate_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8457.82,-770.8C8457.04,-762.6 8456.16,-753.37 8455.29,-744.23"/>
<polygon fill="black" stroke="black" points="8458.75,-743.63 8454.32,-734 8451.78,-744.29 8458.75,-743.63"/>
</g>
<!-- comm_qkv_gpu3_layer1 -->
<g id="node23" class="node">
<title>comm_qkv_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9094.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9094.5" y="-981.42" font-family="Arial" font-size="10.00">GPU3: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="9094.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9094.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu3_layer1&#45;&gt;comm_qkv_gpu3_layer1 -->
<g id="edge22" class="edge">
<title>attn_qkv_gpu3_layer1&#45;&gt;comm_qkv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9130.6,-1038.82C9126,-1030.54 9120.48,-1020.62 9115.16,-1011.05"/>
<polygon fill="black" stroke="black" points="9118.07,-1009.09 9110.15,-1002.06 9111.95,-1012.5 9118.07,-1009.09"/>
</g>
<!-- attn_comp_gpu3_layer1 -->
<g id="node24" class="node">
<title>attn_comp_gpu3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9228,-906.93 8953,-906.93 8953,-865.93 9228,-865.93 9228,-906.93"/>
<text text-anchor="middle" x="9090.5" y="-894.93" font-family="Arial" font-size="10.00">GPU3: Layer1 Attention Compute</text>
<text text-anchor="middle" x="9090.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9090.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu3_layer1&#45;&gt;attn_comp_gpu3_layer1 -->
<g id="edge23" class="edge">
<title>comm_qkv_gpu3_layer1&#45;&gt;attn_comp_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9093.17,-943.79C9092.76,-935.26 9092.32,-925.86 9091.91,-917.22"/>
<polygon fill="black" stroke="black" points="9095.4,-917 9091.43,-907.17 9088.41,-917.33 9095.4,-917"/>
</g>
<!-- comm_attn_out_gpu3_layer1 -->
<g id="node25" class="node">
<title>comm_attn_out_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9030.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="9030.5" y="-808.44" font-family="Arial" font-size="10.00">GPU3: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="9030.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9030.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu3_layer1&#45;&gt;comm_attn_out_gpu3_layer1 -->
<g id="edge24" class="edge">
<title>attn_comp_gpu3_layer1&#45;&gt;comm_attn_out_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9076.58,-865.83C9070.59,-857.39 9063.37,-847.23 9056.45,-837.48"/>
<polygon fill="black" stroke="black" points="9059.12,-835.2 9050.48,-829.07 9053.42,-839.25 9059.12,-835.2"/>
</g>
<!-- gate_gpu3_layer1 -->
<g id="node45" class="node">
<title>gate_gpu3_layer1</title>
<polygon fill="lightyellow" stroke="black" points="9244.73,-733.95 8835.53,-733.95 8730.27,-651.95 9139.47,-651.95 9244.73,-733.95"/>
<text text-anchor="middle" x="8987.5" y="-701.45" font-family="Arial" font-size="10.00">GPU3: Layer1 Gate Routing</text>
<text text-anchor="middle" x="8987.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="8987.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu3_layer1&#45;&gt;gate_gpu3_layer1 -->
<g id="edge44" class="edge">
<title>comm_attn_out_gpu3_layer1&#45;&gt;gate_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9018.98,-770.8C9015.51,-762.33 9011.59,-752.77 9007.73,-743.34"/>
<polygon fill="black" stroke="black" points="9010.93,-741.93 9003.91,-734 9004.46,-744.58 9010.93,-741.93"/>
</g>
<!-- comm_qkv_gpu4_layer1 -->
<g id="node27" class="node">
<title>comm_qkv_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10424.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="10424.5" y="-981.42" font-family="Arial" font-size="10.00">GPU4: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="10424.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10424.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu4_layer1&#45;&gt;comm_qkv_gpu4_layer1 -->
<g id="edge26" class="edge">
<title>attn_qkv_gpu4_layer1&#45;&gt;comm_qkv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10161.82,-1038.82C10207.98,-1027.41 10266.78,-1012.89 10317.05,-1000.47"/>
<polygon fill="black" stroke="black" points="10318.11,-1003.81 10326.98,-998.01 10316.44,-997.01 10318.11,-1003.81"/>
</g>
<!-- attn_comp_gpu4_layer1 -->
<g id="node28" class="node">
<title>attn_comp_gpu4_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10620,-906.93 10345,-906.93 10345,-865.93 10620,-865.93 10620,-906.93"/>
<text text-anchor="middle" x="10482.5" y="-894.93" font-family="Arial" font-size="10.00">GPU4: Layer1 Attention Compute</text>
<text text-anchor="middle" x="10482.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10482.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu4_layer1&#45;&gt;attn_comp_gpu4_layer1 -->
<g id="edge27" class="edge">
<title>comm_qkv_gpu4_layer1&#45;&gt;attn_comp_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10443.81,-943.79C10450.06,-934.69 10456.98,-924.61 10463.22,-915.52"/>
<polygon fill="black" stroke="black" points="10466.17,-917.4 10468.95,-907.17 10460.4,-913.44 10466.17,-917.4"/>
</g>
<!-- comm_attn_out_gpu4_layer1 -->
<g id="node29" class="node">
<title>comm_attn_out_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10676.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="10676.5" y="-808.44" font-family="Arial" font-size="10.00">GPU4: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="10676.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10676.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu4_layer1&#45;&gt;comm_attn_out_gpu4_layer1 -->
<g id="edge28" class="edge">
<title>attn_comp_gpu4_layer1&#45;&gt;comm_attn_out_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10527.5,-865.83C10550.92,-855.63 10580.1,-842.92 10606.41,-831.47"/>
<polygon fill="black" stroke="black" points="10607.81,-834.67 10615.58,-827.47 10605.02,-828.25 10607.81,-834.67"/>
</g>
<!-- gate_gpu4_layer1 -->
<g id="node46" class="node">
<title>gate_gpu4_layer1</title>
<polygon fill="lightyellow" stroke="black" points="11058.73,-733.95 10649.53,-733.95 10544.27,-651.95 10953.47,-651.95 11058.73,-733.95"/>
<text text-anchor="middle" x="10801.5" y="-701.45" font-family="Arial" font-size="10.00">GPU4: Layer1 Gate Routing</text>
<text text-anchor="middle" x="10801.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10801.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu4_layer1&#45;&gt;gate_gpu4_layer1 -->
<g id="edge45" class="edge">
<title>comm_attn_out_gpu4_layer1&#45;&gt;gate_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10709.34,-771.35C10720.6,-761.9 10733.54,-751.03 10746.09,-740.49"/>
<polygon fill="black" stroke="black" points="10748.42,-743.1 10753.83,-733.99 10743.92,-737.74 10748.42,-743.1"/>
</g>
<!-- comm_qkv_gpu5_layer1 -->
<g id="node31" class="node">
<title>comm_qkv_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10001.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="10001.5" y="-981.42" font-family="Arial" font-size="10.00">GPU5: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="10001.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10001.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu5_layer1&#45;&gt;comm_qkv_gpu5_layer1 -->
<g id="edge30" class="edge">
<title>attn_qkv_gpu5_layer1&#45;&gt;comm_qkv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M9830.22,-1038.82C9857.74,-1028.39 9892.15,-1015.35 9922.9,-1003.7"/>
<polygon fill="black" stroke="black" points="9924.21,-1006.95 9932.32,-1000.14 9921.72,-1000.41 9924.21,-1006.95"/>
</g>
<!-- attn_comp_gpu5_layer1 -->
<g id="node32" class="node">
<title>attn_comp_gpu5_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10301,-906.93 10026,-906.93 10026,-865.93 10301,-865.93 10301,-906.93"/>
<text text-anchor="middle" x="10163.5" y="-894.93" font-family="Arial" font-size="10.00">GPU5: Layer1 Attention Compute</text>
<text text-anchor="middle" x="10163.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10163.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu5_layer1&#45;&gt;attn_comp_gpu5_layer1 -->
<g id="edge31" class="edge">
<title>comm_qkv_gpu5_layer1&#45;&gt;attn_comp_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10053.2,-944.96C10073.68,-934.28 10097.04,-922.09 10116.98,-911.69"/>
<polygon fill="black" stroke="black" points="10118.63,-914.78 10125.88,-907.05 10115.39,-908.57 10118.63,-914.78"/>
</g>
<!-- comm_attn_out_gpu5_layer1 -->
<g id="node33" class="node">
<title>comm_attn_out_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10178.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="10178.5" y="-808.44" font-family="Arial" font-size="10.00">GPU5: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="10178.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10178.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu5_layer1&#45;&gt;comm_attn_out_gpu5_layer1 -->
<g id="edge32" class="edge">
<title>attn_comp_gpu5_layer1&#45;&gt;comm_attn_out_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10166.98,-865.83C10168.4,-857.82 10170.1,-848.25 10171.75,-838.96"/>
<polygon fill="black" stroke="black" points="10175.2,-839.53 10173.51,-829.07 10168.31,-838.31 10175.2,-839.53"/>
</g>
<!-- gate_gpu5_layer1 -->
<g id="node47" class="node">
<title>gate_gpu5_layer1</title>
<polygon fill="lightyellow" stroke="black" points="10526.73,-733.95 10117.53,-733.95 10012.27,-651.95 10421.47,-651.95 10526.73,-733.95"/>
<text text-anchor="middle" x="10269.5" y="-701.45" font-family="Arial" font-size="10.00">GPU5: Layer1 Gate Routing</text>
<text text-anchor="middle" x="10269.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10269.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu5_layer1&#45;&gt;gate_gpu5_layer1 -->
<g id="edge46" class="edge">
<title>comm_attn_out_gpu5_layer1&#45;&gt;gate_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10202.65,-771.08C10210.45,-762.08 10219.34,-751.82 10228.03,-741.79"/>
<polygon fill="black" stroke="black" points="10230.71,-744.04 10234.62,-734.19 10225.42,-739.46 10230.71,-744.04"/>
</g>
<!-- comm_qkv_gpu6_layer1 -->
<g id="node35" class="node">
<title>comm_qkv_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9563.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9563.5" y="-981.42" font-family="Arial" font-size="10.00">GPU6: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="9563.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9563.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu6_layer1&#45;&gt;comm_qkv_gpu6_layer1 -->
<g id="edge34" class="edge">
<title>attn_qkv_gpu6_layer1&#45;&gt;comm_qkv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M9485.93,-1038.82C9496.73,-1029.78 9509.88,-1018.78 9522.26,-1008.42"/>
<polygon fill="black" stroke="black" points="9524.83,-1010.84 9530.25,-1001.73 9520.34,-1005.47 9524.83,-1010.84"/>
</g>
<!-- attn_comp_gpu6_layer1 -->
<g id="node36" class="node">
<title>attn_comp_gpu6_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9851,-906.93 9576,-906.93 9576,-865.93 9851,-865.93 9851,-906.93"/>
<text text-anchor="middle" x="9713.5" y="-894.93" font-family="Arial" font-size="10.00">GPU6: Layer1 Attention Compute</text>
<text text-anchor="middle" x="9713.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9713.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu6_layer1&#45;&gt;attn_comp_gpu6_layer1 -->
<g id="edge35" class="edge">
<title>comm_qkv_gpu6_layer1&#45;&gt;attn_comp_gpu6_layer1</title>
<path fill="none" stroke="black" d="M9611.79,-944.72C9630.31,-934.29 9651.34,-922.45 9669.44,-912.25"/>
<polygon fill="black" stroke="black" points="9671.62,-915.04 9678.62,-907.08 9668.19,-908.94 9671.62,-915.04"/>
</g>
<!-- comm_attn_out_gpu6_layer1 -->
<g id="node37" class="node">
<title>comm_attn_out_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9714.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="9714.5" y="-808.44" font-family="Arial" font-size="10.00">GPU6: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="9714.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9714.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu6_layer1&#45;&gt;comm_attn_out_gpu6_layer1 -->
<g id="edge36" class="edge">
<title>attn_comp_gpu6_layer1&#45;&gt;comm_attn_out_gpu6_layer1</title>
<path fill="none" stroke="black" d="M9713.73,-865.83C9713.83,-857.9 9713.94,-848.45 9714.05,-839.26"/>
<polygon fill="black" stroke="black" points="9717.55,-839.11 9714.17,-829.07 9710.55,-839.03 9717.55,-839.11"/>
</g>
<!-- gate_gpu6_layer1 -->
<g id="node48" class="node">
<title>gate_gpu6_layer1</title>
<polygon fill="lightyellow" stroke="black" points="9993.73,-733.95 9584.53,-733.95 9479.27,-651.95 9888.47,-651.95 9993.73,-733.95"/>
<text text-anchor="middle" x="9736.5" y="-701.45" font-family="Arial" font-size="10.00">GPU6: Layer1 Gate Routing</text>
<text text-anchor="middle" x="9736.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9736.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu6_layer1&#45;&gt;gate_gpu6_layer1 -->
<g id="edge47" class="edge">
<title>comm_attn_out_gpu6_layer1&#45;&gt;gate_gpu6_layer1</title>
<path fill="none" stroke="black" d="M9720.4,-770.8C9722.13,-762.51 9724.09,-753.17 9726.03,-743.93"/>
<polygon fill="black" stroke="black" points="9729.48,-744.51 9728.11,-734 9722.63,-743.07 9729.48,-744.51"/>
</g>
<!-- comm_qkv_gpu7_layer1 -->
<g id="node39" class="node">
<title>comm_qkv_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10839.5" cy="-972.92" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="10839.5" y="-981.42" font-family="Arial" font-size="10.00">GPU7: All&#45;Reduce QKV</text>
<text text-anchor="middle" x="10839.5" y="-970.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10839.5" y="-959.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- attn_qkv_gpu7_layer1&#45;&gt;comm_qkv_gpu7_layer1 -->
<g id="edge38" class="edge">
<title>attn_qkv_gpu7_layer1&#45;&gt;comm_qkv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M10487.44,-1038.87C10553.79,-1026.63 10639.76,-1010.77 10710.14,-997.79"/>
<polygon fill="black" stroke="black" points="10711.2,-1001.15 10720.4,-995.89 10709.93,-994.27 10711.2,-1001.15"/>
</g>
<!-- attn_comp_gpu7_layer1 -->
<g id="node40" class="node">
<title>attn_comp_gpu7_layer1</title>
<polygon fill="lightgreen" stroke="black" points="11004,-906.93 10729,-906.93 10729,-865.93 11004,-865.93 11004,-906.93"/>
<text text-anchor="middle" x="10866.5" y="-894.93" font-family="Arial" font-size="10.00">GPU7: Layer1 Attention Compute</text>
<text text-anchor="middle" x="10866.5" y="-883.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10866.5" y="-872.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
</g>
<!-- comm_qkv_gpu7_layer1&#45;&gt;attn_comp_gpu7_layer1 -->
<g id="edge39" class="edge">
<title>comm_qkv_gpu7_layer1&#45;&gt;attn_comp_gpu7_layer1</title>
<path fill="none" stroke="black" d="M10848.49,-943.79C10851.25,-935.16 10854.29,-925.65 10857.07,-916.93"/>
<polygon fill="black" stroke="black" points="10860.48,-917.76 10860.19,-907.17 10853.81,-915.63 10860.48,-917.76"/>
</g>
<!-- comm_attn_out_gpu7_layer1 -->
<g id="node41" class="node">
<title>comm_attn_out_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="11191.5" cy="-799.94" rx="189.51" ry="28.98"/>
<text text-anchor="middle" x="11191.5" y="-808.44" font-family="Arial" font-size="10.00">GPU7: All&#45;Reduce Attention Output</text>
<text text-anchor="middle" x="11191.5" y="-797.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11191.5" y="-786.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- attn_comp_gpu7_layer1&#45;&gt;comm_attn_out_gpu7_layer1 -->
<g id="edge40" class="edge">
<title>attn_comp_gpu7_layer1&#45;&gt;comm_attn_out_gpu7_layer1</title>
<path fill="none" stroke="black" d="M10941.88,-865.83C10985.47,-854.5 11040.94,-840.08 11088.52,-827.71"/>
<polygon fill="black" stroke="black" points="11089.43,-831.09 11098.23,-825.19 11087.67,-824.32 11089.43,-831.09"/>
</g>
<!-- gate_gpu7_layer1 -->
<g id="node49" class="node">
<title>gate_gpu7_layer1</title>
<polygon fill="lightyellow" stroke="black" points="12426.73,-733.95 12017.53,-733.95 11912.27,-651.95 12321.47,-651.95 12426.73,-733.95"/>
<text text-anchor="middle" x="12169.5" y="-701.45" font-family="Arial" font-size="10.00">GPU7: Layer1 Gate Routing</text>
<text text-anchor="middle" x="12169.5" y="-690.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12169.5" y="-679.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=8]</text>
</g>
<!-- comm_attn_out_gpu7_layer1&#45;&gt;gate_gpu7_layer1 -->
<g id="edge48" class="edge">
<title>comm_attn_out_gpu7_layer1&#45;&gt;gate_gpu7_layer1</title>
<path fill="none" stroke="black" d="M11343.51,-782.62C11515.18,-764.19 11794.73,-734.18 11980.37,-714.25"/>
<polygon fill="black" stroke="black" points="11980.95,-717.71 11990.52,-713.16 11980.2,-710.75 11980.95,-717.71"/>
</g>
<!-- expert_gpu0_0_layer1 -->
<g id="node50" class="node">
<title>expert_gpu0_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="12245.33,-589.96 12091.29,-589.96 12051.67,-553.96 12205.71,-553.96 12245.33,-589.96"/>
<text text-anchor="middle" x="12148.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu0_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge49" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7549.25,-663.37C7583,-658.66 7618.31,-654.49 7651.5,-651.95 7701.6,-648.12 11222.07,-650.55 11269.5,-633.95 11279.65,-630.39 11278.43,-622.75 11288.5,-618.95 11359.69,-592.08 11861.44,-578.86 12064,-574.57"/>
<polygon fill="red" stroke="red" points="12064.07,-578.07 12074,-574.36 12063.93,-571.07 12064.07,-578.07"/>
<text text-anchor="middle" x="11399.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU0</text>
</g>
<!-- expert_gpu1_0_layer1 -->
<g id="node51" class="node">
<title>expert_gpu1_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="3064.33,-589.96 2910.29,-589.96 2870.67,-553.96 3024.71,-553.96 3064.33,-589.96"/>
<text text-anchor="middle" x="2967.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu1_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge50" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7176.35,-691.79C6163.55,-690.77 1761.52,-683.48 1712.5,-633.95 1707.81,-629.21 1707.82,-623.7 1712.5,-618.95 1734.89,-596.2 2829.88,-605.31 2861.5,-600.95 2875.23,-599.06 2889.73,-595.98 2903.44,-592.54"/>
<polygon fill="red" stroke="red" points="2904.47,-595.88 2913.27,-589.98 2902.71,-589.11 2904.47,-595.88"/>
<text text-anchor="middle" x="1823.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU1</text>
</g>
<!-- expert_gpu2_0_layer1 -->
<g id="node52" class="node">
<title>expert_gpu2_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="6365.33,-589.96 6211.29,-589.96 6171.67,-553.96 6325.71,-553.96 6365.33,-589.96"/>
<text text-anchor="middle" x="6268.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu2_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge51" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7173.14,-689.59C6672.04,-683.44 5442.84,-665.2 5412.5,-633.95 5407.86,-629.17 5407.91,-623.79 5412.5,-618.95 5438.75,-591.25 5972.59,-578.41 6183.67,-574.4"/>
<polygon fill="red" stroke="red" points="6183.85,-577.9 6193.78,-574.21 6183.72,-570.9 6183.85,-577.9"/>
<text text-anchor="middle" x="5523.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU2</text>
</g>
<!-- expert_gpu3_0_layer1 -->
<g id="node53" class="node">
<title>expert_gpu3_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="8325.33,-589.96 8171.29,-589.96 8131.67,-553.96 8285.71,-553.96 8325.33,-589.96"/>
<text text-anchor="middle" x="8228.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu3_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge52" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7384.01,-651.76C7386.56,-639.42 7391.67,-626.99 7401.5,-618.95 7429.92,-595.69 7939.68,-580.26 8144.42,-574.98"/>
<polygon fill="red" stroke="red" points="8144.61,-578.48 8154.52,-574.72 8144.43,-571.48 8144.61,-578.48"/>
<text text-anchor="middle" x="7512.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU3</text>
</g>
<!-- expert_gpu4_0_layer1 -->
<g id="node54" class="node">
<title>expert_gpu4_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="10285.33,-589.96 10131.29,-589.96 10091.67,-553.96 10245.71,-553.96 10285.33,-589.96"/>
<text text-anchor="middle" x="10188.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu4_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge53" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7549.63,-663.48C7583.26,-658.77 7618.44,-654.57 7651.5,-651.95 7743.33,-644.66 9222.64,-664.63 9309.5,-633.95 9319.64,-630.36 9318.43,-622.75 9328.5,-618.95 9399.69,-592.08 9901.44,-578.86 10104,-574.57"/>
<polygon fill="red" stroke="red" points="10104.07,-578.07 10114,-574.36 10103.93,-571.07 10104.07,-578.07"/>
<text text-anchor="middle" x="9439.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU4</text>
</g>
<!-- expert_gpu5_0_layer1 -->
<g id="node55" class="node">
<title>expert_gpu5_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="4405.33,-589.96 4251.29,-589.96 4211.67,-553.96 4365.71,-553.96 4405.33,-589.96"/>
<text text-anchor="middle" x="4308.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu5_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge54" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7174.88,-690.82C6368.26,-686.21 3485.45,-667.39 3452.5,-633.95 3447.82,-629.2 3447.91,-623.79 3452.5,-618.95 3478.75,-591.25 4012.59,-578.41 4223.67,-574.4"/>
<polygon fill="red" stroke="red" points="4223.85,-577.9 4233.78,-574.21 4223.72,-570.9 4223.85,-577.9"/>
<text text-anchor="middle" x="3563.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU5</text>
</g>
<!-- expert_gpu6_0_layer1 -->
<g id="node56" class="node">
<title>expert_gpu6_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="15798.33,-589.96 15644.29,-589.96 15604.67,-553.96 15758.71,-553.96 15798.33,-589.96"/>
<text text-anchor="middle" x="15701.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu6_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge55" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7549.25,-663.31C7583,-658.6 7618.31,-654.44 7651.5,-651.95 7755.68,-644.12 15071.19,-655.08 15173.5,-633.95 15190.07,-630.53 15192.1,-623.12 15208.5,-618.95 15347.84,-583.52 15515.55,-574.76 15615.08,-572.93"/>
<polygon fill="red" stroke="red" points="15615.15,-576.43 15625.09,-572.77 15615.03,-569.43 15615.15,-576.43"/>
<text text-anchor="middle" x="15319.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU6</text>
</g>
<!-- expert_gpu7_0_layer1 -->
<g id="node57" class="node">
<title>expert_gpu7_0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="14206.33,-589.96 14052.29,-589.96 14012.67,-553.96 14166.71,-553.96 14206.33,-589.96"/>
<text text-anchor="middle" x="14109.5" y="-569.46" font-family="Arial" font-size="10.00">expert_gpu7_0_layer1</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge56" class="edge">
<title>gate_gpu0_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7549.25,-663.33C7583,-658.62 7618.31,-654.46 7651.5,-651.95 7805.12,-640.34 13045.05,-656.15 13197.5,-633.95 13220.88,-630.54 13225.21,-622.94 13248.5,-618.95 13396.09,-593.66 13838.87,-579.81 14025.3,-574.96"/>
<polygon fill="red" stroke="red" points="14025.42,-578.46 14035.32,-574.7 14025.24,-571.46 14025.42,-578.46"/>
<text text-anchor="middle" x="13359.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU0 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu0_layer1 -->
<g id="node90" class="node">
<title>comm_expert_send_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="608.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="608.5" y="-580.46" font-family="Arial" font-size="10.00">GPU0: Send Tokens to Experts</text>
<text text-anchor="middle" x="608.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="608.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu0_layer1&#45;&gt;comm_expert_send_gpu0_layer1 -->
<g id="edge113" class="edge">
<title>gate_gpu0_layer1&#45;&gt;comm_expert_send_gpu0_layer1</title>
<path fill="none" stroke="black" d="M7175.42,-691.18C6283.65,-687.66 2766.13,-671.64 1659.5,-633.95 1347.68,-623.33 984.39,-599.75 776.93,-585.22"/>
<polygon fill="black" stroke="black" points="777.08,-581.72 766.86,-584.51 776.59,-588.71 777.08,-581.72"/>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge57" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8084.08,-663.23C8117.25,-658.58 8151.9,-654.46 8184.5,-651.95 8276.73,-644.83 11427.2,-664.52 11514.5,-633.95 11524.65,-630.39 11523.47,-622.85 11533.5,-618.95 11627.52,-582.32 11916.45,-574.7 12062.33,-573.22"/>
<polygon fill="red" stroke="red" points="12062.62,-576.72 12072.59,-573.13 12062.55,-569.72 12062.62,-576.72"/>
<text text-anchor="middle" x="11644.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU0</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge58" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7661.31,-652.99C7657.01,-652.62 7652.74,-652.27 7648.5,-651.95 7628.8,-650.46 1971.45,-647.94 1957.5,-633.95 1952.79,-629.23 1952.83,-623.71 1957.5,-618.95 1975.08,-601.01 2836.63,-604.43 2861.5,-600.95 2875.15,-599.04 2889.56,-595.97 2903.21,-592.55"/>
<polygon fill="red" stroke="red" points="2904.19,-595.91 2912.99,-590.01 2902.43,-589.13 2904.19,-595.91"/>
<text text-anchor="middle" x="2068.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU1</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge59" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7661.66,-653.05C7657.24,-652.66 7652.85,-652.29 7648.5,-651.95 7620.93,-649.78 5676.97,-653.59 5657.5,-633.95 5652.81,-629.21 5652.97,-623.84 5657.5,-618.95 5692.43,-581.29 6022.42,-574.28 6182.38,-573.1"/>
<polygon fill="red" stroke="red" points="6182.69,-576.6 6192.66,-573.03 6182.64,-569.6 6182.69,-576.6"/>
<text text-anchor="middle" x="5768.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU2</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge60" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7660.94,-651.93C7633.87,-642.55 7619.84,-631.54 7631.5,-618.95 7665.47,-582.26 7985.59,-574.74 8142.56,-573.27"/>
<polygon fill="red" stroke="red" points="8142.69,-576.77 8152.66,-573.18 8142.63,-569.77 8142.69,-576.77"/>
<text text-anchor="middle" x="7742.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU3</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge61" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8084.45,-663.38C8117.51,-658.73 8152.03,-654.58 8184.5,-651.95 8260.37,-645.8 9482.76,-659.38 9554.5,-633.95 9564.64,-630.35 9563.47,-622.85 9573.5,-618.95 9667.52,-582.32 9956.45,-574.7 10102.33,-573.22"/>
<polygon fill="red" stroke="red" points="10102.62,-576.72 10112.59,-573.13 10102.55,-569.72 10102.62,-576.72"/>
<text text-anchor="middle" x="9684.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU4</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge62" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7661.31,-653C7657.01,-652.62 7652.74,-652.27 7648.5,-651.95 7621.14,-649.86 3716.86,-653.39 3697.5,-633.95 3692.8,-629.22 3692.97,-623.84 3697.5,-618.95 3732.43,-581.29 4062.42,-574.28 4222.38,-573.1"/>
<polygon fill="red" stroke="red" points="4222.69,-576.6 4232.66,-573.03 4222.64,-569.6 4222.69,-576.6"/>
<text text-anchor="middle" x="3808.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU5</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge63" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8084.07,-663.16C8117.24,-658.51 8151.9,-654.42 8184.5,-651.95 8234.7,-648.15 15386.96,-650.52 15434.5,-633.95 15444.66,-630.41 15443.7,-623.39 15453.5,-618.95 15505.92,-595.17 15569.89,-583.69 15619.73,-578.14"/>
<polygon fill="red" stroke="red" points="15620.24,-581.6 15629.82,-577.08 15619.51,-574.64 15620.24,-581.6"/>
<text text-anchor="middle" x="15564.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU6</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge64" class="edge">
<title>gate_gpu1_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8084.07,-663.18C8117.25,-658.53 8151.9,-654.43 8184.5,-651.95 8257.76,-646.37 13405.13,-658.16 13474.5,-633.95 13484.66,-630.4 13483.47,-622.85 13493.5,-618.95 13587.73,-582.25 13877.45,-574.66 14023.48,-573.21"/>
<polygon fill="red" stroke="red" points="14023.77,-576.71 14033.74,-573.12 14023.71,-569.71 14023.77,-576.71"/>
<text text-anchor="middle" x="13604.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU1 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu1_layer1 -->
<g id="node92" class="node">
<title>comm_expert_send_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="1596.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="1596.5" y="-580.46" font-family="Arial" font-size="10.00">GPU1: Send Tokens to Experts</text>
<text text-anchor="middle" x="1596.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="1596.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu1_layer1&#45;&gt;comm_expert_send_gpu1_layer1 -->
<g id="edge122" class="edge">
<title>gate_gpu1_layer1&#45;&gt;comm_expert_send_gpu1_layer1</title>
<path fill="none" stroke="black" d="M7661.31,-652.99C7657.01,-652.61 7652.74,-652.27 7648.5,-651.95 7566.1,-645.73 1778.12,-656.07 1698.5,-633.95 1678.02,-628.26 1657.5,-617.27 1640.29,-606.17"/>
<polygon fill="black" stroke="black" points="1641.87,-603.01 1631.61,-600.38 1637.99,-608.84 1641.87,-603.01"/>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge65" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8617.42,-663.55C8651.74,-658.77 8687.71,-654.53 8721.5,-651.95 8805.65,-645.52 11679.86,-661.86 11759.5,-633.95 11769.65,-630.39 11768.57,-623.1 11778.5,-618.95 11828.94,-597.86 11973.91,-584.58 12066.7,-577.98"/>
<polygon fill="red" stroke="red" points="12067.17,-581.46 12076.9,-577.27 12066.68,-574.47 12067.17,-581.46"/>
<text text-anchor="middle" x="11889.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU0</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge66" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8194.08,-652.8C8190.53,-652.5 8187.01,-652.21 8183.5,-651.95 8162.88,-650.38 2242.1,-648.59 2227.5,-633.95 2222.79,-629.23 2222.85,-623.73 2227.5,-618.95 2252.06,-593.68 2826.62,-605.98 2861.5,-600.95 2875.07,-598.99 2889.39,-595.92 2902.97,-592.52"/>
<polygon fill="red" stroke="red" points="2903.9,-595.89 2912.71,-589.99 2902.15,-589.11 2903.9,-595.89"/>
<text text-anchor="middle" x="2338.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU1</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge67" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8194.44,-652.86C8190.77,-652.54 8187.12,-652.23 8183.5,-651.95 8151.92,-649.47 5924.81,-656.44 5902.5,-633.95 5861.23,-592.35 6063.5,-579.07 6183.98,-574.87"/>
<polygon fill="red" stroke="red" points="6184.42,-578.36 6194.3,-574.53 6184.19,-571.36 6184.42,-578.36"/>
<text text-anchor="middle" x="6013.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU2</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge68" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8194.77,-653.14C8190.99,-652.73 8187.23,-652.33 8183.5,-651.95 8147.96,-648.3 7887.04,-659.91 7862.5,-633.95 7822.29,-591.42 8023.55,-578.54 8143.75,-574.64"/>
<polygon fill="red" stroke="red" points="8144.16,-578.13 8154.05,-574.32 8143.94,-571.13 8144.16,-578.13"/>
<text text-anchor="middle" x="7973.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU3</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge69" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8617.8,-663.78C8652.01,-659 8687.85,-654.7 8721.5,-651.95 8781.2,-647.06 9743.08,-654.06 9799.5,-633.95 9809.63,-630.34 9808.57,-623.1 9818.5,-618.95 9868.94,-597.86 10013.91,-584.58 10106.7,-577.98"/>
<polygon fill="red" stroke="red" points="10107.17,-581.46 10116.9,-577.27 10106.68,-574.47 10107.17,-581.46"/>
<text text-anchor="middle" x="9929.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU4</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge70" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8194.08,-652.81C8190.53,-652.5 8187.01,-652.22 8183.5,-651.95 8154.13,-649.7 3963.28,-654.82 3942.5,-633.95 3901.15,-592.42 4103.46,-579.11 4223.96,-574.89"/>
<polygon fill="red" stroke="red" points="4224.4,-578.38 4234.28,-574.54 4224.17,-571.38 4224.4,-578.38"/>
<text text-anchor="middle" x="4053.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU5</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge71" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8617.41,-663.46C8651.73,-658.69 8687.71,-654.47 8721.5,-651.95 8745.59,-650.15 15659.75,-647.86 15679.5,-633.95 15690.43,-626.25 15695.95,-612.57 15698.73,-600.12"/>
<polygon fill="red" stroke="red" points="15702.21,-600.55 15700.48,-590.1 15695.31,-599.35 15702.21,-600.55"/>
<text text-anchor="middle" x="15802.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU6</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge72" class="edge">
<title>gate_gpu2_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8617.41,-663.49C8651.74,-658.72 8687.71,-654.49 8721.5,-651.95 8790.72,-646.74 13653.96,-656.83 13719.5,-633.95 13729.66,-630.4 13728.57,-623.1 13738.5,-618.95 13789.15,-597.78 13934.85,-584.51 14027.87,-577.94"/>
<polygon fill="red" stroke="red" points="14028.37,-581.41 14038.11,-577.23 14027.89,-574.43 14028.37,-581.41"/>
<text text-anchor="middle" x="13849.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU2 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu2_layer1 -->
<g id="node94" class="node">
<title>comm_expert_send_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="2308.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="2308.5" y="-580.46" font-family="Arial" font-size="10.00">GPU2: Send Tokens to Experts</text>
<text text-anchor="middle" x="2308.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="2308.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu2_layer1&#45;&gt;comm_expert_send_gpu2_layer1 -->
<g id="edge131" class="edge">
<title>gate_gpu2_layer1&#45;&gt;comm_expert_send_gpu2_layer1</title>
<path fill="none" stroke="black" d="M8194.08,-652.8C8190.53,-652.5 8187.01,-652.21 8183.5,-651.95 8161.07,-650.25 1721.38,-649.88 1705.5,-633.95 1700.79,-629.23 1700.97,-623.84 1705.5,-618.95 1719.94,-603.36 1957.29,-589.1 2129.83,-580.71"/>
<polygon fill="black" stroke="black" points="2130.24,-584.2 2140.06,-580.22 2129.9,-577.21 2130.24,-584.2"/>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge73" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9167.63,-673.78C9258.37,-665.45 9370.16,-656.45 9470.5,-651.95 9540.82,-648.79 11938.08,-657.27 12004.5,-633.95 12014.65,-630.38 12014.11,-624.2 12023.5,-618.95 12041.45,-608.9 12062.02,-600.28 12081.22,-593.31"/>
<polygon fill="red" stroke="red" points="12082.56,-596.55 12090.82,-589.92 12080.23,-589.95 12082.56,-596.55"/>
<text text-anchor="middle" x="12134.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU0</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge74" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8731.57,-653.17C8726.51,-652.73 8721.48,-652.32 8716.5,-651.95 8694.88,-650.33 2487.81,-649.3 2472.5,-633.95 2467.79,-629.23 2467.9,-623.77 2472.5,-618.95 2487.44,-603.3 2840.12,-604.23 2861.5,-600.95 2874.69,-598.92 2888.61,-595.91 2901.87,-592.6"/>
<polygon fill="red" stroke="red" points="2903.05,-595.91 2911.86,-590.02 2901.3,-589.13 2903.05,-595.91"/>
<text text-anchor="middle" x="2583.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU1</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge75" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8731.57,-653.2C8726.51,-652.75 8721.48,-652.33 8716.5,-651.95 8680.92,-649.21 6172.64,-659.27 6147.5,-633.95 6125.74,-612.04 6158.11,-596.56 6194.82,-586.68"/>
<polygon fill="red" stroke="red" points="6195.9,-590.02 6204.73,-584.16 6194.18,-583.23 6195.9,-590.02"/>
<text text-anchor="middle" x="6258.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU2</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge76" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8731.92,-653.39C8726.74,-652.88 8721.59,-652.4 8716.5,-651.95 8682.78,-648.97 8131.08,-658.23 8107.5,-633.95 8086.06,-611.87 8118.13,-596.43 8154.61,-586.61"/>
<polygon fill="red" stroke="red" points="8155.63,-589.96 8164.47,-584.11 8153.91,-583.18 8155.63,-589.96"/>
<text text-anchor="middle" x="8218.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU3</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge77" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9168.83,-674.72C9259.37,-666.68 9370.64,-657.65 9470.5,-651.95 9534.21,-648.31 9984.56,-655.82 10044.5,-633.95 10054.61,-630.26 10054.11,-624.2 10063.5,-618.95 10081.45,-608.9 10102.02,-600.28 10121.22,-593.31"/>
<polygon fill="red" stroke="red" points="10122.56,-596.55 10130.82,-589.92 10120.23,-589.95 10122.56,-596.55"/>
<text text-anchor="middle" x="10174.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU4</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge78" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8731.57,-653.18C8726.51,-652.74 8721.48,-652.32 8716.5,-651.95 8685.14,-649.58 4209.7,-656.23 4187.5,-633.95 4165.71,-612.07 4198.08,-596.59 4234.8,-586.7"/>
<polygon fill="red" stroke="red" points="4235.88,-590.04 4244.71,-584.18 4234.16,-583.25 4235.88,-590.04"/>
<text text-anchor="middle" x="4298.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU5</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge79" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9167.34,-673.62C9258.13,-665.24 9370.04,-656.24 9470.5,-651.95 9492.89,-650.99 15908.68,-649.82 15924.5,-633.95 15929.21,-629.23 15928.84,-624.01 15924.5,-618.95 15907.37,-598.98 15833.25,-606.31 15807.5,-600.95 15795.78,-598.51 15783.42,-595.58 15771.45,-592.54"/>
<polygon fill="red" stroke="red" points="15772.06,-589.09 15761.5,-589.98 15770.31,-595.86 15772.06,-589.09"/>
<text text-anchor="middle" x="16038.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU6</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge80" class="edge">
<title>gate_gpu3_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9167.63,-673.65C9258.36,-665.29 9370.15,-656.3 9470.5,-651.95 9532.86,-649.25 13905.58,-654.54 13964.5,-633.95 13974.66,-630.4 13974.11,-624.19 13983.5,-618.95 14001.76,-608.75 14022.71,-600.05 14042.23,-593.05"/>
<polygon fill="red" stroke="red" points="14043.38,-596.35 14051.67,-589.75 14041.08,-589.75 14043.38,-596.35"/>
<text text-anchor="middle" x="14094.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU3 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu3_layer1 -->
<g id="node96" class="node">
<title>comm_expert_send_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="2677.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="2677.5" y="-580.46" font-family="Arial" font-size="10.00">GPU3: Send Tokens to Experts</text>
<text text-anchor="middle" x="2677.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="2677.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu3_layer1&#45;&gt;comm_expert_send_gpu3_layer1 -->
<g id="edge140" class="edge">
<title>gate_gpu3_layer1&#45;&gt;comm_expert_send_gpu3_layer1</title>
<path fill="none" stroke="black" d="M8731.57,-653.17C8726.51,-652.73 8721.48,-652.32 8716.5,-651.95 8694.86,-650.33 2480.83,-649.32 2465.5,-633.95 2460.79,-629.23 2461.32,-624.14 2465.5,-618.95 2474.92,-607.26 2499.05,-598.39 2527.79,-591.72"/>
<polygon fill="black" stroke="black" points="2528.69,-595.1 2537.7,-589.54 2527.19,-588.27 2528.69,-595.1"/>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge81" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10995.06,-684.06C11215.11,-675.29 11585.12,-661.15 11903.5,-651.95 11926.72,-651.28 12723.25,-650.55 12739.5,-633.95 12744.16,-629.18 12744.03,-623.84 12739.5,-618.95 12706.14,-582.89 12393.79,-575.04 12237.16,-573.37"/>
<polygon fill="red" stroke="red" points="12237.11,-569.87 12227.08,-573.27 12237.04,-576.87 12237.11,-569.87"/>
<text text-anchor="middle" x="12853.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU0</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge82" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10544.98,-652.71C10541.81,-652.44 10538.64,-652.19 10535.5,-651.95 10434.24,-644.25 3323.33,-652.61 3223.5,-633.95 3205.25,-630.54 3202.31,-624.22 3184.5,-618.95 3148.89,-608.4 3109.32,-599.27 3073.82,-591.99"/>
<polygon fill="red" stroke="red" points="3074.42,-588.54 3063.92,-589.99 3073.03,-595.4 3074.42,-588.54"/>
<text text-anchor="middle" x="3334.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU1</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge83" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10544.98,-652.72C10541.8,-652.45 10538.64,-652.19 10535.5,-651.95 10434.33,-644.13 6979.7,-663.1 6882.5,-633.95 6870.81,-630.44 6871.05,-622.88 6859.5,-618.95 6769.32,-588.28 6500.53,-577.92 6358.59,-574.53"/>
<polygon fill="red" stroke="red" points="6358.26,-571.02 6348.18,-574.29 6358.1,-578.02 6358.26,-571.02"/>
<text text-anchor="middle" x="6993.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU2</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge84" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10545.33,-652.78C10542.04,-652.49 10538.76,-652.21 10535.5,-651.95 10441.74,-644.44 8932.52,-661.23 8842.5,-633.95 8830.82,-630.41 8831.05,-622.88 8819.5,-618.95 8729.32,-588.28 8460.53,-577.92 8318.59,-574.53"/>
<polygon fill="red" stroke="red" points="8318.26,-571.02 8308.18,-574.29 8318.1,-578.02 8318.26,-571.02"/>
<text text-anchor="middle" x="8953.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU3</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge85" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10789.28,-651.69C10783.48,-639.19 10775.17,-626.68 10763.5,-618.95 10724.18,-592.89 10431.25,-580.27 10279.33,-575.43"/>
<polygon fill="red" stroke="red" points="10279.19,-571.93 10269.09,-575.11 10278.97,-578.92 10279.19,-571.93"/>
<text text-anchor="middle" x="10888.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU4</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge86" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10544.98,-652.71C10541.81,-652.44 10538.64,-652.19 10535.5,-651.95 10457.77,-646.01 4997.19,-656.28 4922.5,-633.95 4910.81,-630.45 4911.05,-622.88 4899.5,-618.95 4809.32,-588.28 4540.53,-577.92 4398.59,-574.53"/>
<polygon fill="red" stroke="red" points="4398.26,-571.02 4388.18,-574.29 4398.1,-578.02 4398.26,-571.02"/>
<text text-anchor="middle" x="5033.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU5</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge87" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10993.55,-683.08C11213.4,-673.38 11584.33,-658.34 11903.5,-651.95 11920.01,-651.62 16647.84,-645.65 16659.5,-633.95 16664.21,-629.23 16664.16,-623.71 16659.5,-618.95 16642.94,-602.03 15830.94,-604.24 15807.5,-600.95 15793.85,-599.03 15779.44,-595.96 15765.79,-592.54"/>
<polygon fill="red" stroke="red" points="15766.57,-589.12 15756.01,-589.99 15764.81,-595.9 15766.57,-589.12"/>
<text text-anchor="middle" x="16773.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU6</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge88" class="edge">
<title>gate_gpu4_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10994.05,-683.22C11213.96,-673.65 11584.58,-658.76 11903.5,-651.95 11922.91,-651.53 14685.81,-647.72 14699.5,-633.95 14704.2,-629.22 14704.03,-623.84 14699.5,-618.95 14666.22,-582.97 14354.77,-575.07 14198.32,-573.39"/>
<polygon fill="red" stroke="red" points="14198.27,-569.89 14188.24,-573.28 14198.2,-576.89 14198.27,-569.89"/>
<text text-anchor="middle" x="14813.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU4 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu4_layer1 -->
<g id="node98" class="node">
<title>comm_expert_send_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="17213.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="17213.5" y="-580.46" font-family="Arial" font-size="10.00">GPU4: Send Tokens to Experts</text>
<text text-anchor="middle" x="17213.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="17213.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu4_layer1&#45;&gt;comm_expert_send_gpu4_layer1 -->
<g id="edge149" class="edge">
<title>gate_gpu4_layer1&#45;&gt;comm_expert_send_gpu4_layer1</title>
<path fill="none" stroke="black" d="M10993.55,-683.06C11213.4,-673.34 11584.33,-658.28 11903.5,-651.95 11940.2,-651.22 17159.2,-654.67 17189.5,-633.95 17197.59,-628.42 17202.95,-619.71 17206.5,-610.59"/>
<polygon fill="black" stroke="black" points="17209.84,-611.64 17209.59,-601.04 17203.18,-609.48 17209.84,-611.64"/>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge89" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10436.17,-663.23C10469,-658.61 10503.26,-654.51 10535.5,-651.95 10562.62,-649.79 12475.35,-653.28 12494.5,-633.95 12532.27,-595.83 12354.69,-581.3 12239.93,-575.94"/>
<polygon fill="red" stroke="red" points="12239.87,-572.43 12229.72,-575.48 12239.56,-579.42 12239.87,-572.43"/>
<text text-anchor="middle" x="12610.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU0</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge90" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10013.08,-652.8C10009.53,-652.5 10006.01,-652.21 10002.5,-651.95 9978.13,-650.1 2979.76,-651.26 2962.5,-633.95 2953.77,-625.19 2954.01,-611.79 2956.87,-599.77"/>
<polygon fill="red" stroke="red" points="2960.24,-600.72 2959.75,-590.14 2953.53,-598.72 2960.24,-600.72"/>
<text text-anchor="middle" x="3073.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU1</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge91" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10013.08,-652.81C10009.53,-652.51 10006,-652.22 10002.5,-651.95 9909.3,-644.76 6727.03,-660.82 6637.5,-633.95 6625.81,-630.44 6625.94,-623.19 6614.5,-618.95 6530.97,-587.98 6429.26,-577.41 6357.81,-574.03"/>
<polygon fill="red" stroke="red" points="6357.63,-570.52 6347.49,-573.58 6357.33,-577.51 6357.63,-570.52"/>
<text text-anchor="middle" x="6748.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU2</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge92" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10013.43,-652.88C10009.77,-652.55 10006.12,-652.24 10002.5,-651.95 9924.69,-645.65 8672.18,-656.67 8597.5,-633.95 8585.82,-630.4 8585.94,-623.19 8574.5,-618.95 8490.97,-587.98 8389.26,-577.41 8317.81,-574.03"/>
<polygon fill="red" stroke="red" points="8317.63,-570.52 8307.49,-573.58 8317.33,-577.51 8317.63,-570.52"/>
<text text-anchor="middle" x="8708.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU3</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge93" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10442.22,-667.97C10502.93,-655.76 10552.23,-639.19 10534.5,-618.95 10518.06,-600.18 10379.61,-586.53 10282.91,-579.18"/>
<polygon fill="red" stroke="red" points="10283.04,-575.68 10272.81,-578.42 10282.52,-582.66 10283.04,-575.68"/>
<text text-anchor="middle" x="10648.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU4</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge94" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10013.08,-652.8C10009.53,-652.5 10006.01,-652.22 10002.5,-651.95 9928.75,-646.33 4748.36,-655.14 4677.5,-633.95 4665.81,-630.45 4665.94,-623.19 4654.5,-618.95 4570.97,-587.98 4469.26,-577.41 4397.81,-574.03"/>
<polygon fill="red" stroke="red" points="4397.63,-570.52 4387.49,-573.58 4397.33,-577.51 4397.63,-570.52"/>
<text text-anchor="middle" x="4788.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU5</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge95" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10436.16,-663.07C10468.99,-658.47 10503.25,-654.41 10535.5,-651.95 10555.85,-650.4 16400.09,-648.4 16414.5,-633.95 16419.21,-629.23 16419.14,-623.73 16414.5,-618.95 16391,-594.74 15840.89,-605.79 15807.5,-600.95 15793.93,-598.98 15779.61,-595.91 15766.03,-592.5"/>
<polygon fill="red" stroke="red" points="15766.86,-589.1 15756.3,-589.98 15765.1,-595.88 15766.86,-589.1"/>
<text text-anchor="middle" x="16528.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU6</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge96" class="edge">
<title>gate_gpu5_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10436.16,-663.11C10468.99,-658.5 10503.26,-654.43 10535.5,-651.95 10562.64,-649.86 14435.3,-653.24 14454.5,-633.95 14492.25,-596.03 14315.16,-581.42 14200.7,-575.99"/>
<polygon fill="red" stroke="red" points="14200.66,-572.49 14190.51,-575.53 14200.34,-579.48 14200.66,-572.49"/>
<text text-anchor="middle" x="14570.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU5 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu5_layer1 -->
<g id="node100" class="node">
<title>comm_expert_send_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="16403.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="16403.5" y="-580.46" font-family="Arial" font-size="10.00">GPU5: Send Tokens to Experts</text>
<text text-anchor="middle" x="16403.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="16403.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu5_layer1&#45;&gt;comm_expert_send_gpu5_layer1 -->
<g id="edge158" class="edge">
<title>gate_gpu5_layer1&#45;&gt;comm_expert_send_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10435.8,-663.11C10468.74,-658.49 10503.14,-654.41 10535.5,-651.95 10558.49,-650.2 17158.22,-650.27 17174.5,-633.95 17179.21,-629.23 17179.07,-623.8 17174.5,-618.95 17164.43,-608.25 16806.6,-590.64 16582.02,-580.6"/>
<polygon fill="black" stroke="black" points="16581.91,-577.09 16571.76,-580.14 16581.59,-584.08 16581.91,-577.09"/>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge97" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9903.08,-663.3C9936.25,-658.64 9970.91,-654.51 10003.5,-651.95 10034.6,-649.51 12227.53,-656.09 12249.5,-633.95 12265.69,-617.63 12248.28,-603.9 12223.61,-593.62"/>
<polygon fill="red" stroke="red" points="12224.83,-590.34 12214.25,-589.99 12222.31,-596.87 12224.83,-590.34"/>
<text text-anchor="middle" x="12366.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU0</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge98" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9500.59,-668.62C9422.07,-661.87 9334.1,-655.39 9253.5,-651.95 9230.83,-650.98 2733.53,-650.02 2717.5,-633.95 2712.79,-629.23 2713.09,-623.95 2717.5,-618.95 2738.84,-594.77 2829.84,-607.08 2861.5,-600.95 2873.96,-598.54 2887.12,-595.48 2899.77,-592.28"/>
<polygon fill="red" stroke="red" points="2900.98,-595.59 2909.78,-589.7 2899.22,-588.81 2900.98,-595.59"/>
<text text-anchor="middle" x="2828.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU1</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge99" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9500.89,-668.81C9422.29,-662.06 9334.2,-655.54 9253.5,-651.95 9174.1,-648.42 6468.61,-656.83 6392.5,-633.95 6380.81,-630.43 6380.19,-624.83 6369.5,-618.95 6353.55,-610.18 6335.62,-601.62 6319.34,-594.31"/>
<polygon fill="red" stroke="red" points="6320.54,-591.01 6309.98,-590.16 6317.7,-597.41 6320.54,-591.01"/>
<text text-anchor="middle" x="6503.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU2</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge100" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9501.78,-669.54C9422.95,-662.8 9334.48,-656.11 9253.5,-651.95 9203.5,-649.38 8400.35,-648.69 8352.5,-633.95 8340.84,-630.35 8340.19,-624.83 8329.5,-618.95 8313.55,-610.18 8295.62,-601.62 8279.34,-594.31"/>
<polygon fill="red" stroke="red" points="8280.54,-591.01 8269.98,-590.16 8277.7,-597.41 8280.54,-591.01"/>
<text text-anchor="middle" x="8463.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU3</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge101" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9904.64,-664.51C9937.37,-659.81 9971.46,-655.35 10003.5,-651.95 10035.16,-648.59 10267.7,-657.16 10289.5,-633.95 10304.98,-617.46 10288.33,-603.85 10264.37,-593.71"/>
<polygon fill="red" stroke="red" points="10265.48,-590.38 10254.89,-589.99 10262.92,-596.9 10265.48,-590.38"/>
<text text-anchor="middle" x="10405.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU4</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge102" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9500.59,-668.66C9422.07,-661.91 9334.1,-655.43 9253.5,-651.95 9186.6,-649.06 4496.65,-653.15 4432.5,-633.95 4420.81,-630.45 4420.19,-624.83 4409.5,-618.95 4393.55,-610.18 4375.62,-601.62 4359.34,-594.31"/>
<polygon fill="red" stroke="red" points="4360.54,-591.01 4349.98,-590.16 4357.7,-597.41 4360.54,-591.01"/>
<text text-anchor="middle" x="4543.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU5</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge103" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9903.07,-663.17C9936.25,-658.52 9970.9,-654.42 10003.5,-651.95 10024.85,-650.33 16154.38,-649.11 16169.5,-633.95 16174.21,-629.23 16174.1,-623.78 16169.5,-618.95 16141.74,-589.77 15847.3,-607.12 15807.5,-600.95 15794.31,-598.9 15780.39,-595.88 15767.14,-592.56"/>
<polygon fill="red" stroke="red" points="15767.71,-589.09 15757.15,-589.98 15765.96,-595.87 15767.71,-589.09"/>
<text text-anchor="middle" x="16283.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU6</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge104" class="edge">
<title>gate_gpu6_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9903.08,-663.21C9936.25,-658.55 9970.9,-654.45 10003.5,-651.95 10032.62,-649.72 14188.89,-654.65 14209.5,-633.95 14225.67,-617.71 14208.23,-603.96 14183.65,-593.64"/>
<polygon fill="red" stroke="red" points="14184.9,-590.37 14174.31,-589.99 14182.36,-596.89 14184.9,-590.37"/>
<text text-anchor="middle" x="14326.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU6 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu6_layer1 -->
<g id="node102" class="node">
<title>comm_expert_send_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="15991.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="15991.5" y="-580.46" font-family="Arial" font-size="10.00">GPU6: Send Tokens to Experts</text>
<text text-anchor="middle" x="15991.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="15991.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu6_layer1&#45;&gt;comm_expert_send_gpu6_layer1 -->
<g id="edge167" class="edge">
<title>gate_gpu6_layer1&#45;&gt;comm_expert_send_gpu6_layer1</title>
<path fill="none" stroke="black" d="M9903.07,-663.16C9936.24,-658.51 9970.9,-654.42 10003.5,-651.95 10028.19,-650.08 17116.02,-651.48 17133.5,-633.95 17138.21,-629.23 17138.17,-623.71 17133.5,-618.95 17115.72,-600.82 16244.83,-602.75 16219.5,-600.95 16191.21,-598.94 16161.04,-595.89 16132.23,-592.52"/>
<polygon fill="black" stroke="black" points="16132.44,-589.02 16122.09,-591.32 16131.61,-595.98 16132.44,-589.02"/>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu0_0_layer1 -->
<g id="edge105" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu0_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12372.33,-691.47C13004.47,-689.52 14899.57,-679.83 14944.5,-633.95 14949.16,-629.19 14949.18,-623.7 14944.5,-618.95 14941.46,-615.86 12717.46,-581.66 12238.64,-574.33"/>
<polygon fill="red" stroke="red" points="12238.38,-570.83 12228.32,-574.18 12238.27,-577.83 12238.38,-570.83"/>
<text text-anchor="middle" x="15058.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU0</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu1_0_layer1 -->
<g id="edge106" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu1_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11950.54,-681.86C11728.21,-672.11 11373.99,-657.98 11067.5,-651.95 10985.79,-650.34 5263.83,-648.99 5183.5,-633.95 5165.25,-630.53 5162.73,-622.51 5144.5,-618.95 5041.76,-598.85 4307.16,-603.13 4202.5,-600.95 3774.19,-592 3262.37,-579.97 3058.13,-575.12"/>
<polygon fill="red" stroke="red" points="3058.13,-571.62 3048.05,-574.88 3057.97,-578.62 3058.13,-571.62"/>
<text text-anchor="middle" x="5294.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU1</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu2_0_layer1 -->
<g id="edge107" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu2_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11951.05,-682.27C11728.75,-672.83 11374.21,-658.9 11067.5,-651.95 11012.4,-650.7 9135.48,-652.26 9083.5,-633.95 9073.35,-630.37 9074.63,-622.56 9064.5,-618.95 9056.34,-616.04 6836.36,-581.7 6358.46,-574.34"/>
<polygon fill="red" stroke="red" points="6358.22,-570.84 6348.17,-574.18 6358.11,-577.84 6358.22,-570.84"/>
<text text-anchor="middle" x="9194.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU2</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu3_0_layer1 -->
<g id="edge108" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu3_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11958.36,-687.99C11682.83,-681.62 11215.99,-666.37 11047.5,-633.95 11027.21,-630.04 11023.85,-622.5 11003.5,-618.95 10969.65,-613.05 8791.28,-581.12 8318.42,-574.26"/>
<polygon fill="red" stroke="red" points="8318.29,-570.76 8308.24,-574.11 8318.18,-577.76 8318.29,-570.76"/>
<text text-anchor="middle" x="11158.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU3</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu4_0_layer1 -->
<g id="edge109" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu4_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12372.23,-691.28C12595.57,-688.39 12928.63,-676.82 12968.5,-633.95 12973.04,-629.07 12973.17,-623.7 12968.5,-618.95 12965.48,-615.88 10755.41,-581.68 10278.51,-574.34"/>
<polygon fill="red" stroke="red" points="10278.29,-570.84 10268.24,-574.18 10278.18,-577.84 10278.29,-570.84"/>
<text text-anchor="middle" x="13082.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU4</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu5_0_layer1 -->
<g id="edge110" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu5_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11950.8,-681.97C11728.48,-672.3 11374.11,-658.22 11067.5,-651.95 10850.71,-647.51 7379.65,-660.94 7164.5,-633.95 7137.23,-630.53 7131.75,-622.53 7104.5,-618.95 7070.16,-614.43 4873.11,-581.39 4398.32,-574.3"/>
<polygon fill="red" stroke="red" points="4398.14,-570.79 4388.09,-574.14 4398.04,-577.79 4398.14,-570.79"/>
<text text-anchor="middle" x="7275.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU5</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu6_0_layer1 -->
<g id="edge111" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu6_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12372.61,-691.49C13300.22,-689.15 17090.97,-676.98 17133.5,-633.95 17138.19,-629.21 17138.18,-623.69 17133.5,-618.95 17107.63,-592.72 15844,-605.94 15807.5,-600.95 15793.77,-599.07 15779.27,-596 15765.55,-592.56"/>
<polygon fill="red" stroke="red" points="15766.29,-589.13 15755.73,-590 15764.52,-595.91 15766.29,-589.13"/>
<text text-anchor="middle" x="17247.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU6</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;expert_gpu7_0_layer1 -->
<g id="edge112" class="edge">
<title>gate_gpu7_layer1&#45;&gt;expert_gpu7_0_layer1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12372.19,-691.37C13272.16,-688.58 16864.07,-674.87 16904.5,-633.95 16909.19,-629.21 16909.18,-623.69 16904.5,-618.95 16891.73,-606 15613.68,-601.24 15595.5,-600.95 15066.41,-592.33 14431.4,-579.56 14199.7,-574.82"/>
<polygon fill="red" stroke="red" points="14199.71,-571.32 14189.64,-574.61 14199.56,-578.31 14199.71,-571.32"/>
<text text-anchor="middle" x="17018.5" y="-622.75" font-family="Times,serif" font-size="14.00">GPU7 selects experts on GPU7</text>
</g>
<!-- comm_expert_send_gpu7_layer1 -->
<g id="node104" class="node">
<title>comm_expert_send_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="18132.5" cy="-571.96" rx="175.23" ry="28.98"/>
<text text-anchor="middle" x="18132.5" y="-580.46" font-family="Arial" font-size="10.00">GPU7: Send Tokens to Experts</text>
<text text-anchor="middle" x="18132.5" y="-569.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="18132.5" y="-558.46" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=4096]</text>
</g>
<!-- gate_gpu7_layer1&#45;&gt;comm_expert_send_gpu7_layer1 -->
<g id="edge176" class="edge">
<title>gate_gpu7_layer1&#45;&gt;comm_expert_send_gpu7_layer1</title>
<path fill="none" stroke="black" d="M12372.32,-691.53C13205.11,-689.51 16364.83,-678.98 17362.5,-633.95 17574.69,-624.37 17819.09,-603.3 17974.6,-588.62"/>
<polygon fill="black" stroke="black" points="17975.09,-592.09 17984.71,-587.66 17974.43,-585.12 17975.09,-592.09"/>
</g>
<!-- expert_gpu0_exp0_layer1 -->
<g id="node58" class="node">
<title>expert_gpu0_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="229,-505.97 0,-505.97 0,-464.97 229,-464.97 229,-505.97"/>
<text text-anchor="middle" x="114.5" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 0</text>
<text text-anchor="middle" x="114.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="114.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu0_layer1 -->
<g id="node91" class="node">
<title>comm_expert_recv_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="608.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="608.5" y="-407.47" font-family="Arial" font-size="10.00">GPU0: Receive from Experts</text>
<text text-anchor="middle" x="608.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="608.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp0_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge115" class="edge">
<title>expert_gpu0_exp0_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M228.76,-464.92C303.09,-452.21 400.22,-435.6 477.64,-422.36"/>
<polygon fill="black" stroke="black" points="478.67,-425.73 487.94,-420.59 477.49,-418.83 478.67,-425.73"/>
</g>
<!-- expert_gpu0_exp1_layer1 -->
<g id="node59" class="node">
<title>expert_gpu0_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="476,-505.97 247,-505.97 247,-464.97 476,-464.97 476,-505.97"/>
<text text-anchor="middle" x="361.5" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 1</text>
<text text-anchor="middle" x="361.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="361.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp1_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge117" class="edge">
<title>expert_gpu0_exp1_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M418.79,-464.87C450.18,-454.13 489.68,-440.62 524.5,-428.71"/>
<polygon fill="black" stroke="black" points="525.85,-431.94 534.18,-425.4 523.59,-425.32 525.85,-431.94"/>
</g>
<!-- expert_gpu0_exp2_layer1 -->
<g id="node60" class="node">
<title>expert_gpu0_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="723,-505.97 494,-505.97 494,-464.97 723,-464.97 723,-505.97"/>
<text text-anchor="middle" x="608.5" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 2</text>
<text text-anchor="middle" x="608.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="608.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp2_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge119" class="edge">
<title>expert_gpu0_exp2_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M608.5,-464.87C608.5,-456.94 608.5,-447.49 608.5,-438.29"/>
<polygon fill="black" stroke="black" points="612,-438.11 608.5,-428.11 605,-438.11 612,-438.11"/>
</g>
<!-- expert_gpu0_exp3_layer1 -->
<g id="node61" class="node">
<title>expert_gpu0_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="970,-505.97 741,-505.97 741,-464.97 970,-464.97 970,-505.97"/>
<text text-anchor="middle" x="855.5" y="-493.97" font-family="Arial" font-size="10.00">GPU0: Expert 3</text>
<text text-anchor="middle" x="855.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="855.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu0_exp3_layer1&#45;&gt;comm_expert_recv_gpu0_layer1 -->
<g id="edge121" class="edge">
<title>expert_gpu0_exp3_layer1&#45;&gt;comm_expert_recv_gpu0_layer1</title>
<path fill="none" stroke="black" d="M798.21,-464.87C766.82,-454.13 727.32,-440.62 692.5,-428.71"/>
<polygon fill="black" stroke="black" points="693.41,-425.32 682.82,-425.4 691.15,-431.94 693.41,-425.32"/>
</g>
<!-- expert_gpu1_exp0_layer1 -->
<g id="node62" class="node">
<title>expert_gpu1_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="1217,-505.97 988,-505.97 988,-464.97 1217,-464.97 1217,-505.97"/>
<text text-anchor="middle" x="1102.5" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 0</text>
<text text-anchor="middle" x="1102.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="1102.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu1_layer1 -->
<g id="node93" class="node">
<title>comm_expert_recv_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="1596.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="1596.5" y="-407.47" font-family="Arial" font-size="10.00">GPU1: Receive from Experts</text>
<text text-anchor="middle" x="1596.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="1596.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp0_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge124" class="edge">
<title>expert_gpu1_exp0_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M1216.76,-464.92C1291.09,-452.21 1388.22,-435.6 1465.64,-422.36"/>
<polygon fill="black" stroke="black" points="1466.67,-425.73 1475.94,-420.59 1465.49,-418.83 1466.67,-425.73"/>
</g>
<!-- expert_gpu1_exp1_layer1 -->
<g id="node63" class="node">
<title>expert_gpu1_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="1464,-505.97 1235,-505.97 1235,-464.97 1464,-464.97 1464,-505.97"/>
<text text-anchor="middle" x="1349.5" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 1</text>
<text text-anchor="middle" x="1349.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="1349.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp1_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge126" class="edge">
<title>expert_gpu1_exp1_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M1406.79,-464.87C1438.18,-454.13 1477.68,-440.62 1512.5,-428.71"/>
<polygon fill="black" stroke="black" points="1513.85,-431.94 1522.18,-425.4 1511.59,-425.32 1513.85,-431.94"/>
</g>
<!-- expert_gpu1_exp2_layer1 -->
<g id="node64" class="node">
<title>expert_gpu1_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="1711,-505.97 1482,-505.97 1482,-464.97 1711,-464.97 1711,-505.97"/>
<text text-anchor="middle" x="1596.5" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 2</text>
<text text-anchor="middle" x="1596.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="1596.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp2_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge128" class="edge">
<title>expert_gpu1_exp2_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M1596.5,-464.87C1596.5,-456.94 1596.5,-447.49 1596.5,-438.29"/>
<polygon fill="black" stroke="black" points="1600,-438.11 1596.5,-428.11 1593,-438.11 1600,-438.11"/>
</g>
<!-- expert_gpu1_exp3_layer1 -->
<g id="node65" class="node">
<title>expert_gpu1_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="1958,-505.97 1729,-505.97 1729,-464.97 1958,-464.97 1958,-505.97"/>
<text text-anchor="middle" x="1843.5" y="-493.97" font-family="Arial" font-size="10.00">GPU1: Expert 3</text>
<text text-anchor="middle" x="1843.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="1843.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu1_exp3_layer1&#45;&gt;comm_expert_recv_gpu1_layer1 -->
<g id="edge130" class="edge">
<title>expert_gpu1_exp3_layer1&#45;&gt;comm_expert_recv_gpu1_layer1</title>
<path fill="none" stroke="black" d="M1786.21,-464.87C1754.82,-454.13 1715.32,-440.62 1680.5,-428.71"/>
<polygon fill="black" stroke="black" points="1681.41,-425.32 1670.82,-425.4 1679.15,-431.94 1681.41,-425.32"/>
</g>
<!-- expert_gpu2_exp0_layer1 -->
<g id="node66" class="node">
<title>expert_gpu2_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="2205,-505.97 1976,-505.97 1976,-464.97 2205,-464.97 2205,-505.97"/>
<text text-anchor="middle" x="2090.5" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 0</text>
<text text-anchor="middle" x="2090.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="2090.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu2_layer1 -->
<g id="node95" class="node">
<title>comm_expert_recv_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="2584.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="2584.5" y="-407.47" font-family="Arial" font-size="10.00">GPU2: Receive from Experts</text>
<text text-anchor="middle" x="2584.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="2584.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp0_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge133" class="edge">
<title>expert_gpu2_exp0_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2204.76,-464.92C2279.09,-452.21 2376.22,-435.6 2453.64,-422.36"/>
<polygon fill="black" stroke="black" points="2454.67,-425.73 2463.94,-420.59 2453.49,-418.83 2454.67,-425.73"/>
</g>
<!-- expert_gpu2_exp1_layer1 -->
<g id="node67" class="node">
<title>expert_gpu2_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="2452,-505.97 2223,-505.97 2223,-464.97 2452,-464.97 2452,-505.97"/>
<text text-anchor="middle" x="2337.5" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 1</text>
<text text-anchor="middle" x="2337.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="2337.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp1_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge135" class="edge">
<title>expert_gpu2_exp1_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2394.79,-464.87C2426.18,-454.13 2465.68,-440.62 2500.5,-428.71"/>
<polygon fill="black" stroke="black" points="2501.85,-431.94 2510.18,-425.4 2499.59,-425.32 2501.85,-431.94"/>
</g>
<!-- expert_gpu2_exp2_layer1 -->
<g id="node68" class="node">
<title>expert_gpu2_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="2699,-505.97 2470,-505.97 2470,-464.97 2699,-464.97 2699,-505.97"/>
<text text-anchor="middle" x="2584.5" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 2</text>
<text text-anchor="middle" x="2584.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="2584.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp2_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge137" class="edge">
<title>expert_gpu2_exp2_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2584.5,-464.87C2584.5,-456.94 2584.5,-447.49 2584.5,-438.29"/>
<polygon fill="black" stroke="black" points="2588,-438.11 2584.5,-428.11 2581,-438.11 2588,-438.11"/>
</g>
<!-- expert_gpu2_exp3_layer1 -->
<g id="node69" class="node">
<title>expert_gpu2_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="2946,-505.97 2717,-505.97 2717,-464.97 2946,-464.97 2946,-505.97"/>
<text text-anchor="middle" x="2831.5" y="-493.97" font-family="Arial" font-size="10.00">GPU2: Expert 3</text>
<text text-anchor="middle" x="2831.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="2831.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu2_exp3_layer1&#45;&gt;comm_expert_recv_gpu2_layer1 -->
<g id="edge139" class="edge">
<title>expert_gpu2_exp3_layer1&#45;&gt;comm_expert_recv_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2774.21,-464.87C2742.82,-454.13 2703.32,-440.62 2668.5,-428.71"/>
<polygon fill="black" stroke="black" points="2669.41,-425.32 2658.82,-425.4 2667.15,-431.94 2669.41,-425.32"/>
</g>
<!-- expert_gpu3_exp0_layer1 -->
<g id="node70" class="node">
<title>expert_gpu3_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="3193,-505.97 2964,-505.97 2964,-464.97 3193,-464.97 3193,-505.97"/>
<text text-anchor="middle" x="3078.5" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 0</text>
<text text-anchor="middle" x="3078.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="3078.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu3_layer1 -->
<g id="node97" class="node">
<title>comm_expert_recv_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="3572.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="3572.5" y="-407.47" font-family="Arial" font-size="10.00">GPU3: Receive from Experts</text>
<text text-anchor="middle" x="3572.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="3572.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp0_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge142" class="edge">
<title>expert_gpu3_exp0_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M3192.76,-464.92C3267.09,-452.21 3364.22,-435.6 3441.64,-422.36"/>
<polygon fill="black" stroke="black" points="3442.67,-425.73 3451.94,-420.59 3441.49,-418.83 3442.67,-425.73"/>
</g>
<!-- expert_gpu3_exp1_layer1 -->
<g id="node71" class="node">
<title>expert_gpu3_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="3440,-505.97 3211,-505.97 3211,-464.97 3440,-464.97 3440,-505.97"/>
<text text-anchor="middle" x="3325.5" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 1</text>
<text text-anchor="middle" x="3325.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="3325.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp1_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge144" class="edge">
<title>expert_gpu3_exp1_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M3382.79,-464.87C3414.18,-454.13 3453.68,-440.62 3488.5,-428.71"/>
<polygon fill="black" stroke="black" points="3489.85,-431.94 3498.18,-425.4 3487.59,-425.32 3489.85,-431.94"/>
</g>
<!-- expert_gpu3_exp2_layer1 -->
<g id="node72" class="node">
<title>expert_gpu3_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="3687,-505.97 3458,-505.97 3458,-464.97 3687,-464.97 3687,-505.97"/>
<text text-anchor="middle" x="3572.5" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 2</text>
<text text-anchor="middle" x="3572.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="3572.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp2_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge146" class="edge">
<title>expert_gpu3_exp2_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M3572.5,-464.87C3572.5,-456.94 3572.5,-447.49 3572.5,-438.29"/>
<polygon fill="black" stroke="black" points="3576,-438.11 3572.5,-428.11 3569,-438.11 3576,-438.11"/>
</g>
<!-- expert_gpu3_exp3_layer1 -->
<g id="node73" class="node">
<title>expert_gpu3_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="3934,-505.97 3705,-505.97 3705,-464.97 3934,-464.97 3934,-505.97"/>
<text text-anchor="middle" x="3819.5" y="-493.97" font-family="Arial" font-size="10.00">GPU3: Expert 3</text>
<text text-anchor="middle" x="3819.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="3819.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu3_exp3_layer1&#45;&gt;comm_expert_recv_gpu3_layer1 -->
<g id="edge148" class="edge">
<title>expert_gpu3_exp3_layer1&#45;&gt;comm_expert_recv_gpu3_layer1</title>
<path fill="none" stroke="black" d="M3762.21,-464.87C3730.82,-454.13 3691.32,-440.62 3656.5,-428.71"/>
<polygon fill="black" stroke="black" points="3657.41,-425.32 3646.82,-425.4 3655.15,-431.94 3657.41,-425.32"/>
</g>
<!-- expert_gpu4_exp0_layer1 -->
<g id="node74" class="node">
<title>expert_gpu4_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="17012,-505.97 16783,-505.97 16783,-464.97 17012,-464.97 17012,-505.97"/>
<text text-anchor="middle" x="16897.5" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 0</text>
<text text-anchor="middle" x="16897.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16897.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu4_layer1 -->
<g id="node99" class="node">
<title>comm_expert_recv_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="17144.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="17144.5" y="-407.47" font-family="Arial" font-size="10.00">GPU4: Receive from Experts</text>
<text text-anchor="middle" x="17144.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="17144.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp0_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge151" class="edge">
<title>expert_gpu4_exp0_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M16954.79,-464.87C16986.18,-454.13 17025.68,-440.62 17060.5,-428.71"/>
<polygon fill="black" stroke="black" points="17061.85,-431.94 17070.18,-425.4 17059.59,-425.32 17061.85,-431.94"/>
</g>
<!-- expert_gpu4_exp1_layer1 -->
<g id="node75" class="node">
<title>expert_gpu4_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="17259,-505.97 17030,-505.97 17030,-464.97 17259,-464.97 17259,-505.97"/>
<text text-anchor="middle" x="17144.5" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 1</text>
<text text-anchor="middle" x="17144.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="17144.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp1_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge153" class="edge">
<title>expert_gpu4_exp1_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M17144.5,-464.87C17144.5,-456.94 17144.5,-447.49 17144.5,-438.29"/>
<polygon fill="black" stroke="black" points="17148,-438.11 17144.5,-428.11 17141,-438.11 17148,-438.11"/>
</g>
<!-- expert_gpu4_exp2_layer1 -->
<g id="node76" class="node">
<title>expert_gpu4_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="17506,-505.97 17277,-505.97 17277,-464.97 17506,-464.97 17506,-505.97"/>
<text text-anchor="middle" x="17391.5" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 2</text>
<text text-anchor="middle" x="17391.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="17391.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp2_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge155" class="edge">
<title>expert_gpu4_exp2_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M17334.21,-464.87C17302.82,-454.13 17263.32,-440.62 17228.5,-428.71"/>
<polygon fill="black" stroke="black" points="17229.41,-425.32 17218.82,-425.4 17227.15,-431.94 17229.41,-425.32"/>
</g>
<!-- expert_gpu4_exp3_layer1 -->
<g id="node77" class="node">
<title>expert_gpu4_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="17753,-505.97 17524,-505.97 17524,-464.97 17753,-464.97 17753,-505.97"/>
<text text-anchor="middle" x="17638.5" y="-493.97" font-family="Arial" font-size="10.00">GPU4: Expert 3</text>
<text text-anchor="middle" x="17638.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="17638.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu4_exp3_layer1&#45;&gt;comm_expert_recv_gpu4_layer1 -->
<g id="edge157" class="edge">
<title>expert_gpu4_exp3_layer1&#45;&gt;comm_expert_recv_gpu4_layer1</title>
<path fill="none" stroke="black" d="M17524.24,-464.92C17449.91,-452.21 17352.78,-435.6 17275.36,-422.36"/>
<polygon fill="black" stroke="black" points="17275.51,-418.83 17265.06,-420.59 17274.33,-425.73 17275.51,-418.83"/>
</g>
<!-- expert_gpu5_exp0_layer1 -->
<g id="node78" class="node">
<title>expert_gpu5_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16024,-505.97 15795,-505.97 15795,-464.97 16024,-464.97 16024,-505.97"/>
<text text-anchor="middle" x="15909.5" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 0</text>
<text text-anchor="middle" x="15909.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="15909.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu5_layer1 -->
<g id="node101" class="node">
<title>comm_expert_recv_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="16156.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="16156.5" y="-407.47" font-family="Arial" font-size="10.00">GPU5: Receive from Experts</text>
<text text-anchor="middle" x="16156.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="16156.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp0_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge160" class="edge">
<title>expert_gpu5_exp0_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M15966.79,-464.87C15998.18,-454.13 16037.68,-440.62 16072.5,-428.71"/>
<polygon fill="black" stroke="black" points="16073.85,-431.94 16082.18,-425.4 16071.59,-425.32 16073.85,-431.94"/>
</g>
<!-- expert_gpu5_exp1_layer1 -->
<g id="node79" class="node">
<title>expert_gpu5_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16271,-505.97 16042,-505.97 16042,-464.97 16271,-464.97 16271,-505.97"/>
<text text-anchor="middle" x="16156.5" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 1</text>
<text text-anchor="middle" x="16156.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16156.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp1_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge162" class="edge">
<title>expert_gpu5_exp1_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M16156.5,-464.87C16156.5,-456.94 16156.5,-447.49 16156.5,-438.29"/>
<polygon fill="black" stroke="black" points="16160,-438.11 16156.5,-428.11 16153,-438.11 16160,-438.11"/>
</g>
<!-- expert_gpu5_exp2_layer1 -->
<g id="node80" class="node">
<title>expert_gpu5_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16518,-505.97 16289,-505.97 16289,-464.97 16518,-464.97 16518,-505.97"/>
<text text-anchor="middle" x="16403.5" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 2</text>
<text text-anchor="middle" x="16403.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16403.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp2_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge164" class="edge">
<title>expert_gpu5_exp2_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M16346.21,-464.87C16314.82,-454.13 16275.32,-440.62 16240.5,-428.71"/>
<polygon fill="black" stroke="black" points="16241.41,-425.32 16230.82,-425.4 16239.15,-431.94 16241.41,-425.32"/>
</g>
<!-- expert_gpu5_exp3_layer1 -->
<g id="node81" class="node">
<title>expert_gpu5_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16765,-505.97 16536,-505.97 16536,-464.97 16765,-464.97 16765,-505.97"/>
<text text-anchor="middle" x="16650.5" y="-493.97" font-family="Arial" font-size="10.00">GPU5: Expert 3</text>
<text text-anchor="middle" x="16650.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="16650.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu5_exp3_layer1&#45;&gt;comm_expert_recv_gpu5_layer1 -->
<g id="edge166" class="edge">
<title>expert_gpu5_exp3_layer1&#45;&gt;comm_expert_recv_gpu5_layer1</title>
<path fill="none" stroke="black" d="M16536.24,-464.92C16461.91,-452.21 16364.78,-435.6 16287.36,-422.36"/>
<polygon fill="black" stroke="black" points="16287.51,-418.83 16277.06,-420.59 16286.33,-425.73 16287.51,-418.83"/>
</g>
<!-- expert_gpu6_exp0_layer1 -->
<g id="node82" class="node">
<title>expert_gpu6_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="15036,-505.97 14807,-505.97 14807,-464.97 15036,-464.97 15036,-505.97"/>
<text text-anchor="middle" x="14921.5" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 0</text>
<text text-anchor="middle" x="14921.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="14921.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu6_layer1 -->
<g id="node103" class="node">
<title>comm_expert_recv_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="15168.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="15168.5" y="-407.47" font-family="Arial" font-size="10.00">GPU6: Receive from Experts</text>
<text text-anchor="middle" x="15168.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="15168.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp0_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge169" class="edge">
<title>expert_gpu6_exp0_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M14978.79,-464.87C15010.18,-454.13 15049.68,-440.62 15084.5,-428.71"/>
<polygon fill="black" stroke="black" points="15085.85,-431.94 15094.18,-425.4 15083.59,-425.32 15085.85,-431.94"/>
</g>
<!-- expert_gpu6_exp1_layer1 -->
<g id="node83" class="node">
<title>expert_gpu6_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="15283,-505.97 15054,-505.97 15054,-464.97 15283,-464.97 15283,-505.97"/>
<text text-anchor="middle" x="15168.5" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 1</text>
<text text-anchor="middle" x="15168.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="15168.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp1_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge171" class="edge">
<title>expert_gpu6_exp1_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M15168.5,-464.87C15168.5,-456.94 15168.5,-447.49 15168.5,-438.29"/>
<polygon fill="black" stroke="black" points="15172,-438.11 15168.5,-428.11 15165,-438.11 15172,-438.11"/>
</g>
<!-- expert_gpu6_exp2_layer1 -->
<g id="node84" class="node">
<title>expert_gpu6_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="15530,-505.97 15301,-505.97 15301,-464.97 15530,-464.97 15530,-505.97"/>
<text text-anchor="middle" x="15415.5" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 2</text>
<text text-anchor="middle" x="15415.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="15415.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp2_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge173" class="edge">
<title>expert_gpu6_exp2_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M15358.21,-464.87C15326.82,-454.13 15287.32,-440.62 15252.5,-428.71"/>
<polygon fill="black" stroke="black" points="15253.41,-425.32 15242.82,-425.4 15251.15,-431.94 15253.41,-425.32"/>
</g>
<!-- expert_gpu6_exp3_layer1 -->
<g id="node85" class="node">
<title>expert_gpu6_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="15777,-505.97 15548,-505.97 15548,-464.97 15777,-464.97 15777,-505.97"/>
<text text-anchor="middle" x="15662.5" y="-493.97" font-family="Arial" font-size="10.00">GPU6: Expert 3</text>
<text text-anchor="middle" x="15662.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="15662.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu6_exp3_layer1&#45;&gt;comm_expert_recv_gpu6_layer1 -->
<g id="edge175" class="edge">
<title>expert_gpu6_exp3_layer1&#45;&gt;comm_expert_recv_gpu6_layer1</title>
<path fill="none" stroke="black" d="M15548.24,-464.92C15473.91,-452.21 15376.78,-435.6 15299.36,-422.36"/>
<polygon fill="black" stroke="black" points="15299.51,-418.83 15289.06,-420.59 15298.33,-425.73 15299.51,-418.83"/>
</g>
<!-- expert_gpu7_exp0_layer1 -->
<g id="node86" class="node">
<title>expert_gpu7_exp0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="18000,-505.97 17771,-505.97 17771,-464.97 18000,-464.97 18000,-505.97"/>
<text text-anchor="middle" x="17885.5" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 0</text>
<text text-anchor="middle" x="17885.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="17885.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- comm_expert_recv_gpu7_layer1 -->
<g id="node105" class="node">
<title>comm_expert_recv_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="18132.5" cy="-398.97" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="18132.5" y="-407.47" font-family="Arial" font-size="10.00">GPU7: Receive from Experts</text>
<text text-anchor="middle" x="18132.5" y="-396.47" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=1536]</text>
<text text-anchor="middle" x="18132.5" y="-385.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp0_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge178" class="edge">
<title>expert_gpu7_exp0_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M17942.79,-464.87C17974.18,-454.13 18013.68,-440.62 18048.5,-428.71"/>
<polygon fill="black" stroke="black" points="18049.85,-431.94 18058.18,-425.4 18047.59,-425.32 18049.85,-431.94"/>
</g>
<!-- expert_gpu7_exp1_layer1 -->
<g id="node87" class="node">
<title>expert_gpu7_exp1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="18247,-505.97 18018,-505.97 18018,-464.97 18247,-464.97 18247,-505.97"/>
<text text-anchor="middle" x="18132.5" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 1</text>
<text text-anchor="middle" x="18132.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="18132.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp1_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge180" class="edge">
<title>expert_gpu7_exp1_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M18132.5,-464.87C18132.5,-456.94 18132.5,-447.49 18132.5,-438.29"/>
<polygon fill="black" stroke="black" points="18136,-438.11 18132.5,-428.11 18129,-438.11 18136,-438.11"/>
</g>
<!-- expert_gpu7_exp2_layer1 -->
<g id="node88" class="node">
<title>expert_gpu7_exp2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="18494,-505.97 18265,-505.97 18265,-464.97 18494,-464.97 18494,-505.97"/>
<text text-anchor="middle" x="18379.5" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 2</text>
<text text-anchor="middle" x="18379.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="18379.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp2_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge182" class="edge">
<title>expert_gpu7_exp2_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M18322.21,-464.87C18290.82,-454.13 18251.32,-440.62 18216.5,-428.71"/>
<polygon fill="black" stroke="black" points="18217.41,-425.32 18206.82,-425.4 18215.15,-431.94 18217.41,-425.32"/>
</g>
<!-- expert_gpu7_exp3_layer1 -->
<g id="node89" class="node">
<title>expert_gpu7_exp3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="18741,-505.97 18512,-505.97 18512,-464.97 18741,-464.97 18741,-505.97"/>
<text text-anchor="middle" x="18626.5" y="-493.97" font-family="Arial" font-size="10.00">GPU7: Expert 3</text>
<text text-anchor="middle" x="18626.5" y="-482.97" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=4096]</text>
<text text-anchor="middle" x="18626.5" y="-471.97" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=1536]</text>
</g>
<!-- expert_gpu7_exp3_layer1&#45;&gt;comm_expert_recv_gpu7_layer1 -->
<g id="edge184" class="edge">
<title>expert_gpu7_exp3_layer1&#45;&gt;comm_expert_recv_gpu7_layer1</title>
<path fill="none" stroke="black" d="M18512.24,-464.92C18437.91,-452.21 18340.78,-435.6 18263.36,-422.36"/>
<polygon fill="black" stroke="black" points="18263.51,-418.83 18253.06,-420.59 18262.33,-425.73 18263.51,-418.83"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp0_layer1 -->
<g id="edge114" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp0_layer1</title>
<path fill="none" stroke="black" d="M489.55,-550.61C413.73,-537.64 315.65,-520.87 238.81,-507.73"/>
<polygon fill="black" stroke="black" points="239.04,-504.22 228.6,-505.98 237.86,-511.12 239.04,-504.22"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp1_layer1 -->
<g id="edge116" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp1_layer1</title>
<path fill="none" stroke="black" d="M534.39,-545.61C500.64,-534.06 460.99,-520.5 428.18,-509.27"/>
<polygon fill="black" stroke="black" points="429.27,-505.95 418.67,-506.02 427,-512.57 429.27,-505.95"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp2_layer1 -->
<g id="edge118" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp2_layer1</title>
<path fill="none" stroke="black" d="M608.5,-542.82C608.5,-534.29 608.5,-524.89 608.5,-516.25"/>
<polygon fill="black" stroke="black" points="612,-516.21 608.5,-506.21 605,-516.21 612,-516.21"/>
</g>
<!-- comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp3_layer1 -->
<g id="edge120" class="edge">
<title>comm_expert_send_gpu0_layer1&#45;&gt;expert_gpu0_exp3_layer1</title>
<path fill="none" stroke="black" d="M682.61,-545.61C716.36,-534.06 756.01,-520.5 788.82,-509.27"/>
<polygon fill="black" stroke="black" points="790,-512.57 798.33,-506.02 787.73,-505.95 790,-512.57"/>
</g>
<!-- expert_agg_gpu0_layer1 -->
<g id="node106" class="node">
<title>expert_agg_gpu0_layer1</title>
<polygon fill="lightyellow" stroke="black" points="1575.33,-332.98 1085.64,-332.98 959.67,-250.98 1449.36,-250.98 1575.33,-332.98"/>
<text text-anchor="middle" x="1267.5" y="-300.48" font-family="Arial" font-size="10.00">GPU0: Expert Aggregation</text>
<text text-anchor="middle" x="1267.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="1267.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu0_layer1&#45;&gt;expert_agg_gpu0_layer1 -->
<g id="edge185" class="edge">
<title>comm_expert_recv_gpu0_layer1&#45;&gt;expert_agg_gpu0_layer1</title>
<path fill="none" stroke="black" d="M733.62,-378.04C826.2,-363.29 954.35,-342.87 1061.9,-325.74"/>
<polygon fill="black" stroke="black" points="1062.58,-329.17 1071.91,-324.14 1061.48,-322.26 1062.58,-329.17"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp0_layer1 -->
<g id="edge123" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp0_layer1</title>
<path fill="none" stroke="black" d="M1477.55,-550.61C1401.73,-537.64 1303.65,-520.87 1226.81,-507.73"/>
<polygon fill="black" stroke="black" points="1227.04,-504.22 1216.6,-505.98 1225.86,-511.12 1227.04,-504.22"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp1_layer1 -->
<g id="edge125" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp1_layer1</title>
<path fill="none" stroke="black" d="M1522.39,-545.61C1488.64,-534.06 1448.99,-520.5 1416.18,-509.27"/>
<polygon fill="black" stroke="black" points="1417.27,-505.95 1406.67,-506.02 1415,-512.57 1417.27,-505.95"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp2_layer1 -->
<g id="edge127" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp2_layer1</title>
<path fill="none" stroke="black" d="M1596.5,-542.82C1596.5,-534.29 1596.5,-524.89 1596.5,-516.25"/>
<polygon fill="black" stroke="black" points="1600,-516.21 1596.5,-506.21 1593,-516.21 1600,-516.21"/>
</g>
<!-- comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp3_layer1 -->
<g id="edge129" class="edge">
<title>comm_expert_send_gpu1_layer1&#45;&gt;expert_gpu1_exp3_layer1</title>
<path fill="none" stroke="black" d="M1670.61,-545.61C1704.36,-534.06 1744.01,-520.5 1776.82,-509.27"/>
<polygon fill="black" stroke="black" points="1778,-512.57 1786.33,-506.02 1775.73,-505.95 1778,-512.57"/>
</g>
<!-- expert_agg_gpu1_layer1 -->
<g id="node109" class="node">
<title>expert_agg_gpu1_layer1</title>
<polygon fill="lightyellow" stroke="black" points="2474.33,-332.98 1984.64,-332.98 1858.67,-250.98 2348.36,-250.98 2474.33,-332.98"/>
<text text-anchor="middle" x="2166.5" y="-300.48" font-family="Arial" font-size="10.00">GPU1: Expert Aggregation</text>
<text text-anchor="middle" x="2166.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="2166.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu1_layer1&#45;&gt;expert_agg_gpu1_layer1 -->
<g id="edge188" class="edge">
<title>comm_expert_recv_gpu1_layer1&#45;&gt;expert_agg_gpu1_layer1</title>
<path fill="none" stroke="black" d="M1712.19,-376.66C1785.2,-363.22 1881.47,-345.48 1966.58,-329.81"/>
<polygon fill="black" stroke="black" points="1967.44,-333.21 1976.64,-327.95 1966.17,-326.32 1967.44,-333.21"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp0_layer1 -->
<g id="edge132" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp0_layer1</title>
<path fill="none" stroke="black" d="M2241.61,-545.03C2212.49,-533.74 2178.62,-520.62 2150.34,-509.66"/>
<polygon fill="black" stroke="black" points="2151.57,-506.38 2140.98,-506.03 2149.04,-512.91 2151.57,-506.38"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp1_layer1 -->
<g id="edge134" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp1_layer1</title>
<path fill="none" stroke="black" d="M2318.16,-542.82C2321.15,-534.1 2324.45,-524.48 2327.47,-515.69"/>
<polygon fill="black" stroke="black" points="2330.79,-516.8 2330.72,-506.21 2324.17,-514.53 2330.79,-516.8"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp2_layer1 -->
<g id="edge136" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp2_layer1</title>
<path fill="none" stroke="black" d="M2389.44,-546.18C2427.85,-534.42 2473.4,-520.48 2510.83,-509.02"/>
<polygon fill="black" stroke="black" points="2512.12,-512.28 2520.65,-506.01 2510.07,-505.59 2512.12,-512.28"/>
</g>
<!-- comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp3_layer1 -->
<g id="edge138" class="edge">
<title>comm_expert_send_gpu2_layer1&#45;&gt;expert_gpu2_exp3_layer1</title>
<path fill="none" stroke="black" d="M2431.12,-551.15C2514.1,-537.74 2623.35,-520.09 2706.77,-506.62"/>
<polygon fill="black" stroke="black" points="2707.5,-510.04 2716.81,-504.99 2706.38,-503.13 2707.5,-510.04"/>
</g>
<!-- expert_agg_gpu2_layer1 -->
<g id="node112" class="node">
<title>expert_agg_gpu2_layer1</title>
<polygon fill="lightyellow" stroke="black" points="3241.33,-332.98 2751.64,-332.98 2625.67,-250.98 3115.36,-250.98 3241.33,-332.98"/>
<text text-anchor="middle" x="2933.5" y="-300.48" font-family="Arial" font-size="10.00">GPU2: Expert Aggregation</text>
<text text-anchor="middle" x="2933.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="2933.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu2_layer1&#45;&gt;expert_agg_gpu2_layer1 -->
<g id="edge191" class="edge">
<title>comm_expert_recv_gpu2_layer1&#45;&gt;expert_agg_gpu2_layer1</title>
<path fill="none" stroke="black" d="M2667.21,-373.09C2704.05,-362.01 2748.52,-348.63 2790.48,-336.01"/>
<polygon fill="black" stroke="black" points="2791.66,-339.31 2800.23,-333.07 2789.65,-332.6 2791.66,-339.31"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp0_layer1 -->
<g id="edge141" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp0_layer1</title>
<path fill="none" stroke="black" d="M2782.86,-548.76C2842.41,-536.21 2916.55,-520.59 2975.68,-508.13"/>
<polygon fill="black" stroke="black" points="2976.73,-511.49 2985.79,-506 2975.28,-504.64 2976.73,-511.49"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp1_layer1 -->
<g id="edge143" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp1_layer1</title>
<path fill="none" stroke="black" d="M2801.61,-551.34C2821.62,-548.39 2842.12,-545.49 2861.5,-542.97 3008.99,-523.73 3049.11,-525.89 3200.54,-506.06"/>
<polygon fill="black" stroke="black" points="3201.22,-509.5 3210.68,-504.72 3200.31,-502.56 3201.22,-509.5"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp2_layer1 -->
<g id="edge145" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp2_layer1</title>
<path fill="none" stroke="black" d="M2799.04,-550.92C2819.84,-547.94 2841.26,-545.14 2861.5,-542.97 3118.11,-515.41 3186.92,-534.04 3447.55,-506.01"/>
<polygon fill="black" stroke="black" points="3448.14,-509.46 3457.7,-504.9 3447.38,-502.51 3448.14,-509.46"/>
</g>
<!-- comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp3_layer1 -->
<g id="edge147" class="edge">
<title>comm_expert_send_gpu3_layer1&#45;&gt;expert_gpu3_exp3_layer1</title>
<path fill="none" stroke="black" d="M2797.52,-550.81C2818.79,-547.78 2840.76,-545 2861.5,-542.97 3227.43,-507.12 3324.58,-542.42 3694.52,-505.99"/>
<polygon fill="black" stroke="black" points="3695.11,-509.45 3704.71,-504.98 3694.41,-502.49 3695.11,-509.45"/>
</g>
<!-- expert_agg_gpu3_layer1 -->
<g id="node115" class="node">
<title>expert_agg_gpu3_layer1</title>
<polygon fill="lightyellow" stroke="black" points="9181.33,-332.98 8691.64,-332.98 8565.67,-250.98 9055.36,-250.98 9181.33,-332.98"/>
<text text-anchor="middle" x="8873.5" y="-300.48" font-family="Arial" font-size="10.00">GPU3: Expert Aggregation</text>
<text text-anchor="middle" x="8873.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="8873.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu3_layer1&#45;&gt;expert_agg_gpu3_layer1 -->
<g id="edge194" class="edge">
<title>comm_expert_recv_gpu3_layer1&#45;&gt;expert_agg_gpu3_layer1</title>
<path fill="none" stroke="black" d="M3750.77,-394.44C4539.19,-378.83 7713.99,-315.95 8626.86,-297.87"/>
<polygon fill="black" stroke="black" points="8627.24,-301.36 8637.16,-297.66 8627.1,-294.36 8627.24,-301.36"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp0_layer1 -->
<g id="edge150" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp0_layer1</title>
<path fill="none" stroke="black" d="M17123.79,-546.97C17078.75,-534.93 17024.55,-520.44 16980.48,-508.65"/>
<polygon fill="black" stroke="black" points="16981.23,-505.23 16970.66,-506.03 16979.42,-511.99 16981.23,-505.23"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp1_layer1 -->
<g id="edge152" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp1_layer1</title>
<path fill="none" stroke="black" d="M17190.52,-542.82C17182.94,-533.54 17174.52,-523.23 17166.98,-513.99"/>
<polygon fill="black" stroke="black" points="17169.66,-511.74 17160.62,-506.21 17164.24,-516.17 17169.66,-511.74"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp2_layer1 -->
<g id="edge154" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp2_layer1</title>
<path fill="none" stroke="black" d="M17269.33,-544.46C17292.26,-533.57 17318.61,-521.06 17340.96,-510.45"/>
<polygon fill="black" stroke="black" points="17342.74,-513.48 17350.27,-506.03 17339.74,-507.16 17342.74,-513.48"/>
</g>
<!-- comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp3_layer1 -->
<g id="edge156" class="edge">
<title>comm_expert_send_gpu4_layer1&#45;&gt;expert_gpu4_exp3_layer1</title>
<path fill="none" stroke="black" d="M17322.67,-549.25C17386.41,-536.58 17466.53,-520.65 17530.12,-508.01"/>
<polygon fill="black" stroke="black" points="17531.06,-511.39 17540.18,-506.01 17529.69,-504.53 17531.06,-511.39"/>
</g>
<!-- expert_agg_gpu4_layer1 -->
<g id="node118" class="node">
<title>expert_agg_gpu4_layer1</title>
<polygon fill="lightyellow" stroke="black" points="16582.33,-332.98 16092.64,-332.98 15966.67,-250.98 16456.36,-250.98 16582.33,-332.98"/>
<text text-anchor="middle" x="16274.5" y="-300.48" font-family="Arial" font-size="10.00">GPU4: Expert Aggregation</text>
<text text-anchor="middle" x="16274.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="16274.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu4_layer1&#45;&gt;expert_agg_gpu4_layer1 -->
<g id="edge197" class="edge">
<title>comm_expert_recv_gpu4_layer1&#45;&gt;expert_agg_gpu4_layer1</title>
<path fill="none" stroke="black" d="M17003.27,-380.93C16890.96,-367.38 16729.6,-347.9 16587.25,-330.73"/>
<polygon fill="black" stroke="black" points="16587.38,-327.22 16577.03,-329.49 16586.54,-334.17 16587.38,-327.22"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp0_layer1 -->
<g id="edge159" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp0_layer1</title>
<path fill="none" stroke="black" d="M16284.55,-550.61C16208.73,-537.64 16110.65,-520.87 16033.81,-507.73"/>
<polygon fill="black" stroke="black" points="16034.04,-504.22 16023.6,-505.98 16032.86,-511.12 16034.04,-504.22"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp1_layer1 -->
<g id="edge161" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp1_layer1</title>
<path fill="none" stroke="black" d="M16329.39,-545.61C16295.64,-534.06 16255.99,-520.5 16223.18,-509.27"/>
<polygon fill="black" stroke="black" points="16224.27,-505.95 16213.67,-506.02 16222,-512.57 16224.27,-505.95"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp2_layer1 -->
<g id="edge163" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp2_layer1</title>
<path fill="none" stroke="black" d="M16403.5,-542.82C16403.5,-534.29 16403.5,-524.89 16403.5,-516.25"/>
<polygon fill="black" stroke="black" points="16407,-516.21 16403.5,-506.21 16400,-516.21 16407,-516.21"/>
</g>
<!-- comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp3_layer1 -->
<g id="edge165" class="edge">
<title>comm_expert_send_gpu5_layer1&#45;&gt;expert_gpu5_exp3_layer1</title>
<path fill="none" stroke="black" d="M16477.61,-545.61C16511.36,-534.06 16551.01,-520.5 16583.82,-509.27"/>
<polygon fill="black" stroke="black" points="16585,-512.57 16593.33,-506.02 16582.73,-505.95 16585,-512.57"/>
</g>
<!-- expert_agg_gpu5_layer1 -->
<g id="node121" class="node">
<title>expert_agg_gpu5_layer1</title>
<polygon fill="lightyellow" stroke="black" points="14547.33,-332.98 14057.64,-332.98 13931.67,-250.98 14421.36,-250.98 14547.33,-332.98"/>
<text text-anchor="middle" x="14239.5" y="-300.48" font-family="Arial" font-size="10.00">GPU5: Expert Aggregation</text>
<text text-anchor="middle" x="14239.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="14239.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu5_layer1&#45;&gt;expert_agg_gpu5_layer1 -->
<g id="edge200" class="edge">
<title>comm_expert_recv_gpu5_layer1&#45;&gt;expert_agg_gpu5_layer1</title>
<path fill="none" stroke="black" d="M15987.64,-388.73C15657.25,-370.63 14922.47,-330.39 14518.67,-308.27"/>
<polygon fill="black" stroke="black" points="14518.77,-304.77 14508.6,-307.72 14518.39,-311.76 14518.77,-304.77"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp0_layer1 -->
<g id="edge168" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp0_layer1</title>
<path fill="none" stroke="black" d="M15870.97,-550.81C15849.87,-547.8 15828.08,-545.02 15807.5,-542.97 15473.41,-509.53 15384.52,-539.97 15046.37,-505.99"/>
<polygon fill="black" stroke="black" points="15046.59,-502.49 15036.29,-504.96 15045.89,-509.46 15046.59,-502.49"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp1_layer1 -->
<g id="edge170" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp1_layer1</title>
<path fill="none" stroke="black" d="M15869.45,-551C15848.81,-548.03 15827.57,-545.21 15807.5,-542.97 15582.67,-517.83 15522.2,-531.63 15293.27,-506"/>
<polygon fill="black" stroke="black" points="15293.63,-502.52 15283.3,-504.87 15292.84,-509.47 15293.63,-502.52"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp2_layer1 -->
<g id="edge172" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp2_layer1</title>
<path fill="none" stroke="black" d="M15865.83,-551.6C15846.31,-548.67 15826.37,-545.7 15807.5,-542.97 15691.64,-526.16 15660.1,-523.65 15539.96,-506.02"/>
<polygon fill="black" stroke="black" points="15540.41,-502.55 15530.01,-504.55 15539.39,-509.47 15540.41,-502.55"/>
</g>
<!-- comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp3_layer1 -->
<g id="edge174" class="edge">
<title>comm_expert_send_gpu6_layer1&#45;&gt;expert_gpu6_exp3_layer1</title>
<path fill="none" stroke="black" d="M15898.98,-547.2C15851.69,-535.05 15794.52,-520.37 15748.24,-508.48"/>
<polygon fill="black" stroke="black" points="15749.09,-505.09 15738.53,-505.99 15747.35,-511.87 15749.09,-505.09"/>
</g>
<!-- expert_agg_gpu6_layer1 -->
<g id="node124" class="node">
<title>expert_agg_gpu6_layer1</title>
<polygon fill="lightyellow" stroke="black" points="11112.33,-332.98 10622.64,-332.98 10496.67,-250.98 10986.36,-250.98 11112.33,-332.98"/>
<text text-anchor="middle" x="10804.5" y="-300.48" font-family="Arial" font-size="10.00">GPU6: Expert Aggregation</text>
<text text-anchor="middle" x="10804.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="10804.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu6_layer1&#45;&gt;expert_agg_gpu6_layer1 -->
<g id="edge203" class="edge">
<title>comm_expert_recv_gpu6_layer1&#45;&gt;expert_agg_gpu6_layer1</title>
<path fill="none" stroke="black" d="M14991,-393.7C14312.74,-377.39 11882.22,-318.91 11070.55,-299.38"/>
<polygon fill="black" stroke="black" points="11070.57,-295.88 11060.49,-299.14 11070.4,-302.88 11070.57,-295.88"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp0_layer1 -->
<g id="edge177" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp0_layer1</title>
<path fill="none" stroke="black" d="M18058.39,-545.61C18024.64,-534.06 17984.99,-520.5 17952.18,-509.27"/>
<polygon fill="black" stroke="black" points="17953.27,-505.95 17942.67,-506.02 17951,-512.57 17953.27,-505.95"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp1_layer1 -->
<g id="edge179" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp1_layer1</title>
<path fill="none" stroke="black" d="M18132.5,-542.82C18132.5,-534.29 18132.5,-524.89 18132.5,-516.25"/>
<polygon fill="black" stroke="black" points="18136,-516.21 18132.5,-506.21 18129,-516.21 18136,-516.21"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp2_layer1 -->
<g id="edge181" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp2_layer1</title>
<path fill="none" stroke="black" d="M18206.61,-545.61C18240.36,-534.06 18280.01,-520.5 18312.82,-509.27"/>
<polygon fill="black" stroke="black" points="18314,-512.57 18322.33,-506.02 18311.73,-505.95 18314,-512.57"/>
</g>
<!-- comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp3_layer1 -->
<g id="edge183" class="edge">
<title>comm_expert_send_gpu7_layer1&#45;&gt;expert_gpu7_exp3_layer1</title>
<path fill="none" stroke="black" d="M18251.45,-550.61C18327.27,-537.64 18425.35,-520.87 18502.19,-507.73"/>
<polygon fill="black" stroke="black" points="18503.14,-511.12 18512.4,-505.98 18501.96,-504.22 18503.14,-511.12"/>
</g>
<!-- expert_agg_gpu7_layer1 -->
<g id="node127" class="node">
<title>expert_agg_gpu7_layer1</title>
<polygon fill="lightyellow" stroke="black" points="18423.33,-332.98 17933.64,-332.98 17807.67,-250.98 18297.36,-250.98 18423.33,-332.98"/>
<text text-anchor="middle" x="18115.5" y="-300.48" font-family="Arial" font-size="10.00">GPU7: Expert Aggregation</text>
<text text-anchor="middle" x="18115.5" y="-289.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=8, hidden=1536]</text>
<text text-anchor="middle" x="18115.5" y="-278.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- comm_expert_recv_gpu7_layer1&#45;&gt;expert_agg_gpu7_layer1 -->
<g id="edge206" class="edge">
<title>comm_expert_recv_gpu7_layer1&#45;&gt;expert_agg_gpu7_layer1</title>
<path fill="none" stroke="black" d="M18127.94,-369.84C18126.6,-361.54 18125.09,-352.2 18123.59,-342.97"/>
<polygon fill="black" stroke="black" points="18127.04,-342.35 18121.99,-333.04 18120.13,-343.47 18127.04,-342.35"/>
</g>
<!-- mlp_gpu0_layer1 -->
<g id="node107" class="node">
<title>mlp_gpu0_layer1</title>
<polygon fill="lightgreen" stroke="black" points="4020,-213.98 3765,-213.98 3765,-172.98 4020,-172.98 4020,-213.98"/>
<text text-anchor="middle" x="3892.5" y="-201.98" font-family="Arial" font-size="10.00">GPU0: MLP Compute</text>
<text text-anchor="middle" x="3892.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="3892.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu0_layer1&#45;&gt;mlp_gpu0_layer1 -->
<g id="edge186" class="edge">
<title>expert_agg_gpu0_layer1&#45;&gt;mlp_gpu0_layer1</title>
<path fill="none" stroke="black" d="M1484.68,-273.96C1594.05,-265.92 1728.74,-256.83 1849.5,-250.98 2566.17,-216.27 3425.38,-201.14 3754.77,-196.32"/>
<polygon fill="black" stroke="black" points="3754.89,-199.82 3764.83,-196.17 3754.78,-192.82 3754.89,-199.82"/>
</g>
<!-- mlp_agg_gpu0_layer1 -->
<g id="node108" class="node">
<title>mlp_agg_gpu0_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="3897.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="3897.5" y="-115.49" font-family="Arial" font-size="10.00">GPU0: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="3897.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="3897.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu0_layer1&#45;&gt;mlp_agg_gpu0_layer1 -->
<g id="edge187" class="edge">
<title>mlp_gpu0_layer1&#45;&gt;mlp_agg_gpu0_layer1</title>
<path fill="none" stroke="black" d="M3893.66,-172.89C3894.13,-164.95 3894.69,-155.51 3895.23,-146.31"/>
<polygon fill="black" stroke="black" points="3898.74,-146.32 3895.84,-136.13 3891.75,-145.9 3898.74,-146.32"/>
</g>
<!-- output -->
<g id="node130" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="10210,-41 9955,-41 9955,0 10210,0 10210,-41"/>
<text text-anchor="middle" x="10082.5" y="-29" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="10082.5" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10082.5" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_agg_gpu0_layer1&#45;&gt;output -->
<g id="edge209" class="edge">
<title>mlp_agg_gpu0_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4076.47,-103.28C4414.52,-98.18 5170.16,-86.87 5806.5,-78 7434.84,-55.3 9412.02,-30.02 9944.79,-23.25"/>
<polygon fill="black" stroke="black" points="9944.87,-26.75 9954.82,-23.12 9944.78,-19.75 9944.87,-26.75"/>
</g>
<!-- mlp_gpu1_layer1 -->
<g id="node110" class="node">
<title>mlp_gpu1_layer1</title>
<polygon fill="lightgreen" stroke="black" points="5944,-213.98 5689,-213.98 5689,-172.98 5944,-172.98 5944,-213.98"/>
<text text-anchor="middle" x="5816.5" y="-201.98" font-family="Arial" font-size="10.00">GPU1: MLP Compute</text>
<text text-anchor="middle" x="5816.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="5816.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu1_layer1&#45;&gt;mlp_gpu1_layer1 -->
<g id="edge189" class="edge">
<title>expert_agg_gpu1_layer1&#45;&gt;mlp_gpu1_layer1</title>
<path fill="none" stroke="black" d="M2376.62,-269.19C2452.17,-262.18 2538.08,-255.16 2616.5,-250.98 3226.07,-218.55 5146.57,-200.17 5678.65,-195.61"/>
<polygon fill="black" stroke="black" points="5678.7,-199.11 5688.67,-195.53 5678.64,-192.11 5678.7,-199.11"/>
</g>
<!-- mlp_agg_gpu1_layer1 -->
<g id="node111" class="node">
<title>mlp_agg_gpu1_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="5995.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="5995.5" y="-115.49" font-family="Arial" font-size="10.00">GPU1: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="5995.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="5995.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu1_layer1&#45;&gt;mlp_agg_gpu1_layer1 -->
<g id="edge190" class="edge">
<title>mlp_gpu1_layer1&#45;&gt;mlp_agg_gpu1_layer1</title>
<path fill="none" stroke="black" d="M5858.02,-172.89C5879.35,-162.81 5905.86,-150.3 5929.88,-138.96"/>
<polygon fill="black" stroke="black" points="5931.41,-142.12 5938.96,-134.68 5928.42,-135.78 5931.41,-142.12"/>
</g>
<!-- mlp_agg_gpu1_layer1&#45;&gt;output -->
<g id="edge210" class="edge">
<title>mlp_agg_gpu1_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6173.74,-102.31C6861.23,-88.09 9332.64,-37 9944.66,-24.35"/>
<polygon fill="black" stroke="black" points="9944.92,-27.85 9954.85,-24.14 9944.77,-20.85 9944.92,-27.85"/>
</g>
<!-- mlp_gpu2_layer1 -->
<g id="node113" class="node">
<title>mlp_gpu2_layer1</title>
<polygon fill="lightgreen" stroke="black" points="6218,-213.98 5963,-213.98 5963,-172.98 6218,-172.98 6218,-213.98"/>
<text text-anchor="middle" x="6090.5" y="-201.98" font-family="Arial" font-size="10.00">GPU2: MLP Compute</text>
<text text-anchor="middle" x="6090.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="6090.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu2_layer1&#45;&gt;mlp_gpu2_layer1 -->
<g id="edge192" class="edge">
<title>expert_agg_gpu2_layer1&#45;&gt;mlp_gpu2_layer1</title>
<path fill="none" stroke="black" d="M3172.98,-288.43C3788.39,-281.3 5414.49,-258.71 5952.5,-213.98 5952.61,-213.97 5952.71,-213.97 5952.82,-213.96"/>
<polygon fill="black" stroke="black" points="5953.1,-217.45 5962.74,-213.06 5952.47,-210.47 5953.1,-217.45"/>
</g>
<!-- mlp_agg_gpu2_layer1 -->
<g id="node114" class="node">
<title>mlp_agg_gpu2_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="7620.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="7620.5" y="-115.49" font-family="Arial" font-size="10.00">GPU2: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="7620.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7620.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu2_layer1&#45;&gt;mlp_agg_gpu2_layer1 -->
<g id="edge193" class="edge">
<title>mlp_gpu2_layer1&#45;&gt;mlp_agg_gpu2_layer1</title>
<path fill="none" stroke="black" d="M6218.32,-185.42C6490.79,-170.38 7129.33,-135.12 7441.85,-117.86"/>
<polygon fill="black" stroke="black" points="7442.12,-121.35 7451.91,-117.3 7441.74,-114.36 7442.12,-121.35"/>
</g>
<!-- mlp_agg_gpu2_layer1&#45;&gt;output -->
<g id="edge211" class="edge">
<title>mlp_agg_gpu2_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7795.59,-99.98C8261.58,-83.99 9525.12,-40.63 9944.86,-26.22"/>
<polygon fill="black" stroke="black" points="9945.05,-29.72 9954.92,-25.88 9944.81,-22.72 9945.05,-29.72"/>
</g>
<!-- mlp_gpu3_layer1 -->
<g id="node116" class="node">
<title>mlp_gpu3_layer1</title>
<polygon fill="lightgreen" stroke="black" points="9611,-213.98 9356,-213.98 9356,-172.98 9611,-172.98 9611,-213.98"/>
<text text-anchor="middle" x="9483.5" y="-201.98" font-family="Arial" font-size="10.00">GPU3: MLP Compute</text>
<text text-anchor="middle" x="9483.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9483.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu3_layer1&#45;&gt;mlp_gpu3_layer1 -->
<g id="edge195" class="edge">
<title>expert_agg_gpu3_layer1&#45;&gt;mlp_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9069.45,-259.98C9161.17,-245.47 9268.06,-228.57 9350.25,-215.56"/>
<polygon fill="black" stroke="black" points="9350.82,-219.02 9360.15,-214 9349.73,-212.1 9350.82,-219.02"/>
</g>
<!-- mlp_agg_gpu3_layer1 -->
<g id="node117" class="node">
<title>mlp_agg_gpu3_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="9861.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="9861.5" y="-115.49" font-family="Arial" font-size="10.00">GPU3: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="9861.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="9861.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu3_layer1&#45;&gt;mlp_agg_gpu3_layer1 -->
<g id="edge196" class="edge">
<title>mlp_gpu3_layer1&#45;&gt;mlp_agg_gpu3_layer1</title>
<path fill="none" stroke="black" d="M9571.17,-172.89C9624.16,-161.04 9692.23,-145.83 9749.14,-133.11"/>
<polygon fill="black" stroke="black" points="9749.9,-136.52 9758.9,-130.93 9748.37,-129.69 9749.9,-136.52"/>
</g>
<!-- mlp_agg_gpu3_layer1&#45;&gt;output -->
<g id="edge212" class="edge">
<title>mlp_agg_gpu3_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9929.31,-80.07C9958.83,-68.78 9993.16,-55.65 10021.83,-44.69"/>
<polygon fill="black" stroke="black" points="10023.23,-47.91 10031.32,-41.07 10020.73,-41.37 10023.23,-47.91"/>
</g>
<!-- mlp_gpu4_layer1 -->
<g id="node119" class="node">
<title>mlp_gpu4_layer1</title>
<polygon fill="lightgreen" stroke="black" points="13092,-213.98 12837,-213.98 12837,-172.98 13092,-172.98 13092,-213.98"/>
<text text-anchor="middle" x="12964.5" y="-201.98" font-family="Arial" font-size="10.00">GPU4: MLP Compute</text>
<text text-anchor="middle" x="12964.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12964.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu4_layer1&#45;&gt;mlp_gpu4_layer1 -->
<g id="edge198" class="edge">
<title>expert_agg_gpu4_layer1&#45;&gt;mlp_gpu4_layer1</title>
<path fill="none" stroke="black" d="M16016.49,-283.46C15353.4,-264.13 13606.47,-213.2 13102.45,-198.5"/>
<polygon fill="black" stroke="black" points="13102.32,-195 13092.22,-198.21 13102.11,-202 13102.32,-195"/>
</g>
<!-- mlp_agg_gpu4_layer1 -->
<g id="node120" class="node">
<title>mlp_agg_gpu4_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="12344.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="12344.5" y="-115.49" font-family="Arial" font-size="10.00">GPU4: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="12344.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="12344.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu4_layer1&#45;&gt;mlp_agg_gpu4_layer1 -->
<g id="edge199" class="edge">
<title>mlp_gpu4_layer1&#45;&gt;mlp_agg_gpu4_layer1</title>
<path fill="none" stroke="black" d="M12836.79,-175.08C12735.65,-161.3 12594.37,-142.04 12489.09,-127.7"/>
<polygon fill="black" stroke="black" points="12489.4,-124.21 12479.02,-126.32 12488.45,-131.14 12489.4,-124.21"/>
</g>
<!-- mlp_agg_gpu4_layer1&#45;&gt;output -->
<g id="edge213" class="edge">
<title>mlp_agg_gpu4_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12170.29,-99.48C11736.17,-83.27 10612.96,-41.31 10220.39,-26.65"/>
<polygon fill="black" stroke="black" points="10220.25,-23.14 10210.12,-26.27 10219.98,-30.14 10220.25,-23.14"/>
</g>
<!-- mlp_gpu5_layer1 -->
<g id="node122" class="node">
<title>mlp_gpu5_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10898,-213.98 10643,-213.98 10643,-172.98 10898,-172.98 10898,-213.98"/>
<text text-anchor="middle" x="10770.5" y="-201.98" font-family="Arial" font-size="10.00">GPU5: MLP Compute</text>
<text text-anchor="middle" x="10770.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10770.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu5_layer1&#45;&gt;mlp_gpu5_layer1 -->
<g id="edge201" class="edge">
<title>expert_agg_gpu5_layer1&#45;&gt;mlp_gpu5_layer1</title>
<path fill="none" stroke="black" d="M13981.95,-283.82C13294.16,-264.69 11431.16,-212.86 10908.5,-198.32"/>
<polygon fill="black" stroke="black" points="10908.37,-194.82 10898.28,-198.04 10908.18,-201.81 10908.37,-194.82"/>
</g>
<!-- mlp_agg_gpu5_layer1 -->
<g id="node123" class="node">
<title>mlp_agg_gpu5_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10715.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="10715.5" y="-115.49" font-family="Arial" font-size="10.00">GPU5: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="10715.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10715.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu5_layer1&#45;&gt;mlp_agg_gpu5_layer1 -->
<g id="edge202" class="edge">
<title>mlp_gpu5_layer1&#45;&gt;mlp_agg_gpu5_layer1</title>
<path fill="none" stroke="black" d="M10757.74,-172.89C10752.25,-164.44 10745.63,-154.28 10739.29,-144.53"/>
<polygon fill="black" stroke="black" points="10742.2,-142.6 10733.81,-136.13 10736.34,-146.42 10742.2,-142.6"/>
</g>
<!-- mlp_agg_gpu5_layer1&#45;&gt;output -->
<g id="edge214" class="edge">
<title>mlp_agg_gpu5_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10579.71,-87.87C10473.69,-73.72 10326.99,-54.13 10220.43,-39.91"/>
<polygon fill="black" stroke="black" points="10220.62,-36.41 10210.25,-38.55 10219.7,-43.34 10220.62,-36.41"/>
</g>
<!-- mlp_gpu6_layer1 -->
<g id="node125" class="node">
<title>mlp_gpu6_layer1</title>
<polygon fill="lightgreen" stroke="black" points="10572,-213.98 10317,-213.98 10317,-172.98 10572,-172.98 10572,-213.98"/>
<text text-anchor="middle" x="10444.5" y="-201.98" font-family="Arial" font-size="10.00">GPU6: MLP Compute</text>
<text text-anchor="middle" x="10444.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10444.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu6_layer1&#45;&gt;mlp_gpu6_layer1 -->
<g id="edge204" class="edge">
<title>expert_agg_gpu6_layer1&#45;&gt;mlp_gpu6_layer1</title>
<path fill="none" stroke="black" d="M10655.22,-250.97C10611.56,-239.26 10565.43,-226.9 10527.49,-216.73"/>
<polygon fill="black" stroke="black" points="10528.09,-213.27 10517.52,-214.06 10526.27,-220.03 10528.09,-213.27"/>
</g>
<!-- mlp_agg_gpu6_layer1 -->
<g id="node126" class="node">
<title>mlp_agg_gpu6_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="10304.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="10304.5" y="-115.49" font-family="Arial" font-size="10.00">GPU6: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="10304.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10304.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu6_layer1&#45;&gt;mlp_agg_gpu6_layer1 -->
<g id="edge205" class="edge">
<title>mlp_gpu6_layer1&#45;&gt;mlp_agg_gpu6_layer1</title>
<path fill="none" stroke="black" d="M10412.03,-172.89C10396.06,-163.25 10376.4,-151.38 10358.27,-140.44"/>
<polygon fill="black" stroke="black" points="10359.89,-137.33 10349.52,-135.16 10356.27,-143.32 10359.89,-137.33"/>
</g>
<!-- mlp_agg_gpu6_layer1&#45;&gt;output -->
<g id="edge215" class="edge">
<title>mlp_agg_gpu6_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10236.38,-80.07C10206.73,-68.78 10172.24,-55.65 10143.44,-44.69"/>
<polygon fill="black" stroke="black" points="10144.5,-41.35 10133.91,-41.07 10142.01,-47.89 10144.5,-41.35"/>
</g>
<!-- mlp_gpu7_layer1 -->
<g id="node128" class="node">
<title>mlp_gpu7_layer1</title>
<polygon fill="lightgreen" stroke="black" points="16132,-213.98 15877,-213.98 15877,-172.98 16132,-172.98 16132,-213.98"/>
<text text-anchor="middle" x="16004.5" y="-201.98" font-family="Arial" font-size="10.00">GPU7: MLP Compute</text>
<text text-anchor="middle" x="16004.5" y="-190.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="16004.5" y="-179.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_agg_gpu7_layer1&#45;&gt;mlp_gpu7_layer1 -->
<g id="edge207" class="edge">
<title>expert_agg_gpu7_layer1&#45;&gt;mlp_gpu7_layer1</title>
<path fill="none" stroke="black" d="M17850.28,-278.86C17396.72,-258.13 16487.61,-216.57 16142.07,-200.77"/>
<polygon fill="black" stroke="black" points="16142.16,-197.27 16132.01,-200.31 16141.84,-204.26 16142.16,-197.27"/>
</g>
<!-- mlp_agg_gpu7_layer1 -->
<g id="node129" class="node">
<title>mlp_agg_gpu7_layer1</title>
<ellipse fill="lightblue" stroke="black" cx="13348.5" cy="-106.99" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="13348.5" y="-115.49" font-family="Arial" font-size="10.00">GPU7: MLP All&#45;Reduce</text>
<text text-anchor="middle" x="13348.5" y="-104.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="13348.5" y="-93.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- mlp_gpu7_layer1&#45;&gt;mlp_agg_gpu7_layer1 -->
<g id="edge208" class="edge">
<title>mlp_gpu7_layer1&#45;&gt;mlp_agg_gpu7_layer1</title>
<path fill="none" stroke="black" d="M15876.84,-188.42C15445.8,-174.71 14042.88,-130.08 13534.56,-113.91"/>
<polygon fill="black" stroke="black" points="13534.3,-110.4 13524.19,-113.58 13534.07,-117.4 13534.3,-110.4"/>
</g>
<!-- mlp_agg_gpu7_layer1&#45;&gt;output -->
<g id="edge216" class="edge">
<title>mlp_agg_gpu7_layer1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13174.03,-99.43C13009.02,-93.36 12754.45,-84.34 12533.5,-78 11652.32,-52.71 10592.69,-31.36 10220.11,-24.13"/>
<polygon fill="black" stroke="black" points="10220.16,-20.63 10210.09,-23.93 10220.02,-27.63 10220.16,-20.63"/>
</g>
</g>
</svg>
