<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Qwen3&#45;235B Parallel Strategy Deployment DAG Pages: 1 -->
<svg width="1932pt" height="3065pt"
 viewBox="0.00 0.00 1932.00 3064.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3060.91)">
<title>Qwen3&#45;235B Parallel Strategy Deployment DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3060.91 1928,-3060.91 1928,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightblue" stroke="black" d="M20,-2188.95C20,-2188.95 1863,-2188.95 1863,-2188.95 1869,-2188.95 1875,-2194.95 1875,-2200.95 1875,-2200.95 1875,-2942.95 1875,-2942.95 1875,-2948.95 1869,-2954.95 1863,-2954.95 1863,-2954.95 20,-2954.95 20,-2954.95 14,-2954.95 8,-2948.95 8,-2942.95 8,-2942.95 8,-2200.95 8,-2200.95 8,-2194.95 14,-2188.95 20,-2188.95"/>
<text text-anchor="middle" x="941.5" y="-2939.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 0: GPUs 0&#45;7 (Layers 0&#45;22)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgreen" stroke="black" d="M20,-1493.95C20,-1493.95 1863,-1493.95 1863,-1493.95 1869,-1493.95 1875,-1499.95 1875,-1505.95 1875,-1505.95 1875,-2157.95 1875,-2157.95 1875,-2163.95 1869,-2169.95 1863,-2169.95 1863,-2169.95 20,-2169.95 20,-2169.95 14,-2169.95 8,-2163.95 8,-2157.95 8,-2157.95 8,-1505.95 8,-1505.95 8,-1499.95 14,-1493.95 20,-1493.95"/>
<text text-anchor="middle" x="941.5" y="-2154.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 1: GPUs 8&#45;15 (Layers 23&#45;46)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="lightyellow" stroke="black" d="M61,-798.95C61,-798.95 1904,-798.95 1904,-798.95 1910,-798.95 1916,-804.95 1916,-810.95 1916,-810.95 1916,-1462.95 1916,-1462.95 1916,-1468.95 1910,-1474.95 1904,-1474.95 1904,-1474.95 61,-1474.95 61,-1474.95 55,-1474.95 49,-1468.95 49,-1462.95 49,-1462.95 49,-810.95 49,-810.95 49,-804.95 55,-798.95 61,-798.95"/>
<text text-anchor="middle" x="982.5" y="-1459.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 2: GPUs 16&#45;23 (Layers 47&#45;69)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="lightcoral" stroke="black" d="M40,-103.95C40,-103.95 1883,-103.95 1883,-103.95 1889,-103.95 1895,-109.95 1895,-115.95 1895,-115.95 1895,-767.95 1895,-767.95 1895,-773.95 1889,-779.95 1883,-779.95 1883,-779.95 40,-779.95 40,-779.95 34,-779.95 28,-773.95 28,-767.95 28,-767.95 28,-115.95 28,-115.95 28,-109.95 34,-103.95 40,-103.95"/>
<text text-anchor="middle" x="961.5" y="-764.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 3: GPUs 24&#45;31 (Layers 70&#45;93)</text>
</g>
<!-- embed_0 -->
<g id="node1" class="node">
<title>embed_0</title>
<polygon fill="lightblue" stroke="black" points="1281.5,-2923.95 832.5,-2923.95 832.5,-2870.95 1281.5,-2870.95 1281.5,-2923.95"/>
<text text-anchor="middle" x="1057" y="-2908.75" font-family="Times,serif" font-size="14.00">Embedding (GPU&#45;0)</text>
<text text-anchor="middle" x="1057" y="-2893.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048]</text>
<text text-anchor="middle" x="1057" y="-2878.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_qkv_0_0 -->
<g id="node2" class="node">
<title>attn_qkv_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1048,-2833.95 594,-2833.95 594,-2780.95 1048,-2780.95 1048,-2833.95"/>
<text text-anchor="middle" x="821" y="-2818.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;0)</text>
<text text-anchor="middle" x="821" y="-2803.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="821" y="-2788.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- embed_0&#45;&gt;attn_qkv_0_0 -->
<g id="edge2" class="edge">
<title>embed_0&#45;&gt;attn_qkv_0_0</title>
<path fill="none" stroke="black" d="M988.42,-2870.88C960.54,-2860.49 928.17,-2848.42 899.37,-2837.68"/>
<polygon fill="black" stroke="black" points="900.34,-2834.3 889.75,-2834.09 897.9,-2840.86 900.34,-2834.3"/>
</g>
<!-- attn_qkv_0_1 -->
<g id="node3" class="node">
<title>attn_qkv_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1520,-2833.95 1066,-2833.95 1066,-2780.95 1520,-2780.95 1520,-2833.95"/>
<text text-anchor="middle" x="1293" y="-2818.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;1)</text>
<text text-anchor="middle" x="1293" y="-2803.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1293" y="-2788.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- embed_0&#45;&gt;attn_qkv_0_1 -->
<g id="edge3" class="edge">
<title>embed_0&#45;&gt;attn_qkv_0_1</title>
<path fill="none" stroke="black" d="M1125.58,-2870.88C1153.46,-2860.49 1185.83,-2848.42 1214.63,-2837.68"/>
<polygon fill="black" stroke="black" points="1216.1,-2840.86 1224.25,-2834.09 1213.66,-2834.3 1216.1,-2840.86"/>
</g>
<!-- attn_score_0_0 -->
<g id="node4" class="node">
<title>attn_score_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1048,-2729.95 594,-2729.95 594,-2676.95 1048,-2676.95 1048,-2729.95"/>
<text text-anchor="middle" x="821" y="-2714.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;0)</text>
<text text-anchor="middle" x="821" y="-2699.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="821" y="-2684.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_0_0&#45;&gt;attn_score_0_0 -->
<g id="edge4" class="edge">
<title>attn_qkv_0_0&#45;&gt;attn_score_0_0</title>
<path fill="none" stroke="black" d="M821,-2780.71C821,-2768.51 821,-2753.73 821,-2740.44"/>
<polygon fill="black" stroke="black" points="824.5,-2740.18 821,-2730.18 817.5,-2740.18 824.5,-2740.18"/>
</g>
<!-- attn_score_0_1 -->
<g id="node5" class="node">
<title>attn_score_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1520,-2729.95 1066,-2729.95 1066,-2676.95 1520,-2676.95 1520,-2729.95"/>
<text text-anchor="middle" x="1293" y="-2714.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;1)</text>
<text text-anchor="middle" x="1293" y="-2699.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1293" y="-2684.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_0_0&#45;&gt;attn_score_0_1 -->
<g id="edge8" class="edge">
<title>attn_qkv_0_0&#45;&gt;attn_score_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M917.16,-2780.93C959.32,-2770.13 1009.47,-2757.8 1055,-2747.95 1080.87,-2742.36 1108.42,-2736.89 1135.27,-2731.81"/>
<polygon fill="red" stroke="red" points="1135.94,-2735.25 1145.12,-2729.96 1134.64,-2728.37 1135.94,-2735.25"/>
<text text-anchor="middle" x="1090" y="-2751.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_0_1&#45;&gt;attn_score_0_0 -->
<g id="edge9" class="edge">
<title>attn_qkv_0_1&#45;&gt;attn_score_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1228.85,-2780.85C1197.89,-2769.34 1159.96,-2756.46 1125,-2747.95 1099.74,-2741.81 1073.06,-2736.43 1046.44,-2731.74"/>
<polygon fill="red" stroke="red" points="1046.69,-2728.23 1036.24,-2729.98 1045.5,-2735.13 1046.69,-2728.23"/>
<text text-anchor="middle" x="1211" y="-2751.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_0_1&#45;&gt;attn_score_0_1 -->
<g id="edge5" class="edge">
<title>attn_qkv_0_1&#45;&gt;attn_score_0_1</title>
<path fill="none" stroke="black" d="M1293,-2780.71C1293,-2768.51 1293,-2753.73 1293,-2740.44"/>
<polygon fill="black" stroke="black" points="1296.5,-2740.18 1293,-2730.18 1289.5,-2740.18 1296.5,-2740.18"/>
</g>
<!-- attn_out_0_0 -->
<g id="node6" class="node">
<title>attn_out_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1047.5,-2639.95 598.5,-2639.95 598.5,-2586.95 1047.5,-2586.95 1047.5,-2639.95"/>
<text text-anchor="middle" x="823" y="-2624.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;0)</text>
<text text-anchor="middle" x="823" y="-2609.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="823" y="-2594.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_0_0&#45;&gt;attn_out_0_0 -->
<g id="edge6" class="edge">
<title>attn_score_0_0&#45;&gt;attn_out_0_0</title>
<path fill="none" stroke="black" d="M821.59,-2676.53C821.78,-2668.29 821.99,-2659.03 822.19,-2650.23"/>
<polygon fill="black" stroke="black" points="825.69,-2650.27 822.41,-2640.19 818.69,-2650.11 825.69,-2650.27"/>
</g>
<!-- attn_out_0_1 -->
<g id="node7" class="node">
<title>attn_out_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1515.5,-2639.95 1066.5,-2639.95 1066.5,-2586.95 1515.5,-2586.95 1515.5,-2639.95"/>
<text text-anchor="middle" x="1291" y="-2624.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;1)</text>
<text text-anchor="middle" x="1291" y="-2609.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1291" y="-2594.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_0_1&#45;&gt;attn_out_0_1 -->
<g id="edge7" class="edge">
<title>attn_score_0_1&#45;&gt;attn_out_0_1</title>
<path fill="none" stroke="black" d="M1292.41,-2676.53C1292.22,-2668.29 1292.01,-2659.03 1291.81,-2650.23"/>
<polygon fill="black" stroke="black" points="1295.31,-2650.11 1291.59,-2640.19 1288.31,-2650.27 1295.31,-2650.11"/>
</g>
<!-- gate_0 -->
<g id="node8" class="node">
<title>gate_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1408.58,-2549.95 666.36,-2549.95 475.42,-2443.95 1217.64,-2443.95 1408.58,-2549.95"/>
<text text-anchor="middle" x="942" y="-2508.25" font-family="Times,serif" font-size="14.00">Gate Routing (GPU&#45;2)</text>
<text text-anchor="middle" x="942" y="-2493.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="942" y="-2478.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, num_experts=128]</text>
</g>
<!-- attn_out_0_0&#45;&gt;gate_0 -->
<g id="edge10" class="edge">
<title>attn_out_0_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M849.71,-2586.76C858.84,-2577.97 869.47,-2567.74 880.2,-2557.42"/>
<polygon fill="black" stroke="black" points="882.84,-2559.73 887.62,-2550.27 877.99,-2554.69 882.84,-2559.73"/>
</g>
<!-- attn_out_0_1&#45;&gt;gate_0 -->
<g id="edge11" class="edge">
<title>attn_out_0_1&#45;&gt;gate_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1213.11,-2586.9C1182.59,-2576.89 1146.31,-2564.98 1110.38,-2553.2"/>
<polygon fill="black" stroke="black" points="1111.35,-2549.83 1100.76,-2550.04 1109.17,-2556.48 1111.35,-2549.83"/>
</g>
<!-- expert_0_0 -->
<g id="node9" class="node">
<title>expert_0_0</title>
<polygon fill="lightcoral" stroke="black" points="465.5,-2392.95 16.5,-2392.95 16.5,-2339.95 465.5,-2339.95 465.5,-2392.95"/>
<text text-anchor="middle" x="241" y="-2377.75" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;0)</text>
<text text-anchor="middle" x="241" y="-2362.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="241" y="-2347.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_0&#45;&gt;expert_0_0 -->
<g id="edge12" class="edge">
<title>gate_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M658.14,-2443.92C566.39,-2427.1 468.32,-2409.12 390.34,-2394.83"/>
<polygon fill="blue" stroke="blue" points="390.91,-2391.38 380.45,-2393.02 389.65,-2398.26 390.91,-2391.38"/>
<text text-anchor="middle" x="575.5" y="-2414.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_0_1 -->
<g id="node10" class="node">
<title>expert_0_1</title>
<polygon fill="lightcoral" stroke="black" points="932.5,-2392.95 483.5,-2392.95 483.5,-2339.95 932.5,-2339.95 932.5,-2392.95"/>
<text text-anchor="middle" x="708" y="-2377.75" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;1)</text>
<text text-anchor="middle" x="708" y="-2362.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="708" y="-2347.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_0&#45;&gt;expert_0_1 -->
<g id="edge13" class="edge">
<title>gate_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M847.16,-2443.87C818.73,-2428.26 788.48,-2411.65 763.48,-2397.92"/>
<polygon fill="blue" stroke="blue" points="764.96,-2394.74 754.51,-2393 761.59,-2400.88 764.96,-2394.74"/>
<text text-anchor="middle" x="836.5" y="-2414.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_0_2 -->
<g id="node11" class="node">
<title>expert_0_2</title>
<polygon fill="lightcoral" stroke="black" points="1399.5,-2392.95 950.5,-2392.95 950.5,-2339.95 1399.5,-2339.95 1399.5,-2392.95"/>
<text text-anchor="middle" x="1175" y="-2377.75" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;2)</text>
<text text-anchor="middle" x="1175" y="-2362.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1175" y="-2347.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_0&#45;&gt;expert_0_2 -->
<g id="edge14" class="edge">
<title>gate_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1036.43,-2443.87C1064.75,-2428.26 1094.86,-2411.65 1119.76,-2397.92"/>
<polygon fill="blue" stroke="blue" points="1121.62,-2400.89 1128.69,-2393 1118.24,-2394.76 1121.62,-2400.89"/>
<text text-anchor="middle" x="1118.5" y="-2414.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_0_3 -->
<g id="node12" class="node">
<title>expert_0_3</title>
<polygon fill="lightcoral" stroke="black" points="1866.5,-2392.95 1417.5,-2392.95 1417.5,-2339.95 1866.5,-2339.95 1866.5,-2392.95"/>
<text text-anchor="middle" x="1642" y="-2377.75" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;3)</text>
<text text-anchor="middle" x="1642" y="-2362.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1642" y="-2347.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_0&#45;&gt;expert_0_3 -->
<g id="edge15" class="edge">
<title>gate_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1219.66,-2444.98C1312.82,-2427.88 1413.14,-2409.47 1492.61,-2394.88"/>
<polygon fill="blue" stroke="blue" points="1493.49,-2398.27 1502.69,-2393.03 1492.22,-2391.39 1493.49,-2398.27"/>
<text text-anchor="middle" x="1421.5" y="-2414.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_agg_0 -->
<g id="node13" class="node">
<title>expert_agg_0</title>
<polygon fill="lightyellow" stroke="black" points="1301.5,-2302.95 560.99,-2302.95 370.5,-2196.95 1111.01,-2196.95 1301.5,-2302.95"/>
<text text-anchor="middle" x="836" y="-2261.25" font-family="Times,serif" font-size="14.00">Expert Aggregation (GPU&#45;4)</text>
<text text-anchor="middle" x="836" y="-2246.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="836" y="-2231.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_0_0&#45;&gt;expert_agg_0 -->
<g id="edge16" class="edge">
<title>expert_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M373.79,-2339.9C427.68,-2329.53 492.09,-2317.13 555.47,-2304.94"/>
<polygon fill="black" stroke="black" points="556.48,-2308.31 565.64,-2302.98 555.15,-2301.43 556.48,-2308.31"/>
</g>
<!-- expert_0_1&#45;&gt;expert_agg_0 -->
<g id="edge17" class="edge">
<title>expert_0_1&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M736.73,-2339.76C746.7,-2330.83 758.34,-2320.42 770.07,-2309.93"/>
<polygon fill="black" stroke="black" points="772.65,-2312.32 777.77,-2303.04 767.98,-2307.1 772.65,-2312.32"/>
</g>
<!-- expert_0_2&#45;&gt;expert_agg_0 -->
<g id="edge18" class="edge">
<title>expert_0_2&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1099.34,-2339.9C1069.82,-2329.93 1034.76,-2318.09 1000,-2306.35"/>
<polygon fill="black" stroke="black" points="1000.81,-2302.92 990.21,-2303.04 998.57,-2309.56 1000.81,-2302.92"/>
</g>
<!-- expert_0_3&#45;&gt;expert_agg_0 -->
<g id="edge19" class="edge">
<title>expert_0_3&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1462.37,-2339.94C1388.33,-2329.42 1299.59,-2316.81 1212.5,-2304.44"/>
<polygon fill="black" stroke="black" points="1212.83,-2300.95 1202.44,-2303.01 1211.85,-2307.88 1212.83,-2300.95"/>
</g>
<!-- attn_qkv_23_0 -->
<g id="node14" class="node">
<title>attn_qkv_23_0</title>
<polygon fill="lightgreen" stroke="black" points="912,-2138.95 458,-2138.95 458,-2085.95 912,-2085.95 912,-2138.95"/>
<text text-anchor="middle" x="685" y="-2123.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;8)</text>
<text text-anchor="middle" x="685" y="-2108.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="685" y="-2093.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- expert_agg_0&#45;&gt;attn_qkv_23_0 -->
<g id="edge20" class="edge">
<title>expert_agg_0&#45;&gt;attn_qkv_23_0</title>
<path fill="none" stroke="black" d="M778.05,-2196.95C758.87,-2179.74 738.08,-2161.09 721.03,-2145.79"/>
<polygon fill="black" stroke="black" points="723.26,-2143.08 713.48,-2139.01 718.58,-2148.29 723.26,-2143.08"/>
</g>
<!-- attn_qkv_23_1 -->
<g id="node15" class="node">
<title>attn_qkv_23_1</title>
<polygon fill="lightgreen" stroke="black" points="1384,-2138.95 930,-2138.95 930,-2085.95 1384,-2085.95 1384,-2138.95"/>
<text text-anchor="middle" x="1157" y="-2123.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;9)</text>
<text text-anchor="middle" x="1157" y="-2108.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1157" y="-2093.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- expert_agg_0&#45;&gt;attn_qkv_23_1 -->
<g id="edge21" class="edge">
<title>expert_agg_0&#45;&gt;attn_qkv_23_1</title>
<path fill="none" stroke="black" d="M959.19,-2196.95C1002.54,-2178.65 1049.75,-2158.73 1087.16,-2142.93"/>
<polygon fill="black" stroke="black" points="1088.61,-2146.12 1096.46,-2139.01 1085.88,-2139.67 1088.61,-2146.12"/>
</g>
<!-- attn_score_23_0 -->
<g id="node16" class="node">
<title>attn_score_23_0</title>
<polygon fill="lightgreen" stroke="black" points="912,-2034.95 458,-2034.95 458,-1981.95 912,-1981.95 912,-2034.95"/>
<text text-anchor="middle" x="685" y="-2019.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;8)</text>
<text text-anchor="middle" x="685" y="-2004.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="685" y="-1989.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_23_0&#45;&gt;attn_score_23_0 -->
<g id="edge22" class="edge">
<title>attn_qkv_23_0&#45;&gt;attn_score_23_0</title>
<path fill="none" stroke="black" d="M685,-2085.71C685,-2073.51 685,-2058.73 685,-2045.44"/>
<polygon fill="black" stroke="black" points="688.5,-2045.18 685,-2035.18 681.5,-2045.18 688.5,-2045.18"/>
</g>
<!-- attn_score_23_1 -->
<g id="node17" class="node">
<title>attn_score_23_1</title>
<polygon fill="lightgreen" stroke="black" points="1384,-2034.95 930,-2034.95 930,-1981.95 1384,-1981.95 1384,-2034.95"/>
<text text-anchor="middle" x="1157" y="-2019.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;9)</text>
<text text-anchor="middle" x="1157" y="-2004.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1157" y="-1989.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_23_0&#45;&gt;attn_score_23_1 -->
<g id="edge26" class="edge">
<title>attn_qkv_23_0&#45;&gt;attn_score_23_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M781.16,-2085.93C823.32,-2075.13 873.47,-2062.8 919,-2052.95 944.87,-2047.36 972.42,-2041.89 999.27,-2036.81"/>
<polygon fill="red" stroke="red" points="999.94,-2040.25 1009.12,-2034.96 998.64,-2033.37 999.94,-2040.25"/>
<text text-anchor="middle" x="954" y="-2056.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_23_1&#45;&gt;attn_score_23_0 -->
<g id="edge27" class="edge">
<title>attn_qkv_23_1&#45;&gt;attn_score_23_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1092.85,-2085.85C1061.89,-2074.34 1023.96,-2061.46 989,-2052.95 963.74,-2046.81 937.06,-2041.43 910.44,-2036.74"/>
<polygon fill="red" stroke="red" points="910.69,-2033.23 900.24,-2034.98 909.5,-2040.13 910.69,-2033.23"/>
<text text-anchor="middle" x="1075" y="-2056.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_23_1&#45;&gt;attn_score_23_1 -->
<g id="edge23" class="edge">
<title>attn_qkv_23_1&#45;&gt;attn_score_23_1</title>
<path fill="none" stroke="black" d="M1157,-2085.71C1157,-2073.51 1157,-2058.73 1157,-2045.44"/>
<polygon fill="black" stroke="black" points="1160.5,-2045.18 1157,-2035.18 1153.5,-2045.18 1160.5,-2045.18"/>
</g>
<!-- attn_out_23_0 -->
<g id="node18" class="node">
<title>attn_out_23_0</title>
<polygon fill="lightgreen" stroke="black" points="911.5,-1944.95 462.5,-1944.95 462.5,-1891.95 911.5,-1891.95 911.5,-1944.95"/>
<text text-anchor="middle" x="687" y="-1929.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;8)</text>
<text text-anchor="middle" x="687" y="-1914.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="687" y="-1899.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_23_0&#45;&gt;attn_out_23_0 -->
<g id="edge24" class="edge">
<title>attn_score_23_0&#45;&gt;attn_out_23_0</title>
<path fill="none" stroke="black" d="M685.59,-1981.53C685.78,-1973.29 685.99,-1964.03 686.19,-1955.23"/>
<polygon fill="black" stroke="black" points="689.69,-1955.27 686.41,-1945.19 682.69,-1955.11 689.69,-1955.27"/>
</g>
<!-- attn_out_23_1 -->
<g id="node19" class="node">
<title>attn_out_23_1</title>
<polygon fill="lightgreen" stroke="black" points="1379.5,-1944.95 930.5,-1944.95 930.5,-1891.95 1379.5,-1891.95 1379.5,-1944.95"/>
<text text-anchor="middle" x="1155" y="-1929.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;9)</text>
<text text-anchor="middle" x="1155" y="-1914.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1155" y="-1899.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_23_1&#45;&gt;attn_out_23_1 -->
<g id="edge25" class="edge">
<title>attn_score_23_1&#45;&gt;attn_out_23_1</title>
<path fill="none" stroke="black" d="M1156.41,-1981.53C1156.22,-1973.29 1156.01,-1964.03 1155.81,-1955.23"/>
<polygon fill="black" stroke="black" points="1159.31,-1955.11 1155.59,-1945.19 1152.31,-1955.27 1159.31,-1955.11"/>
</g>
<!-- gate_23 -->
<g id="node20" class="node">
<title>gate_23</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1338.58,-1854.95 596.36,-1854.95 405.42,-1748.95 1147.64,-1748.95 1338.58,-1854.95"/>
<text text-anchor="middle" x="872" y="-1813.25" font-family="Times,serif" font-size="14.00">Gate Routing (GPU&#45;10)</text>
<text text-anchor="middle" x="872" y="-1798.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="872" y="-1783.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, num_experts=128]</text>
</g>
<!-- attn_out_23_0&#45;&gt;gate_23 -->
<g id="edge28" class="edge">
<title>attn_out_23_0&#45;&gt;gate_23</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M728.52,-1891.76C743.62,-1882.41 761.37,-1871.43 779.13,-1860.43"/>
<polygon fill="black" stroke="black" points="781.18,-1863.28 787.84,-1855.04 777.49,-1857.33 781.18,-1863.28"/>
</g>
<!-- attn_out_23_1&#45;&gt;gate_23 -->
<g id="edge29" class="edge">
<title>attn_out_23_1&#45;&gt;gate_23</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1091.84,-1891.9C1067.51,-1882.06 1038.67,-1870.39 1010.03,-1858.8"/>
<polygon fill="black" stroke="black" points="1011.32,-1855.55 1000.74,-1855.04 1008.69,-1862.03 1011.32,-1855.55"/>
</g>
<!-- expert_23_0 -->
<g id="node21" class="node">
<title>expert_23_0</title>
<polygon fill="lightcoral" stroke="black" points="465.5,-1697.95 16.5,-1697.95 16.5,-1644.95 465.5,-1644.95 465.5,-1697.95"/>
<text text-anchor="middle" x="241" y="-1682.75" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;8)</text>
<text text-anchor="middle" x="241" y="-1667.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="241" y="-1652.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_23&#45;&gt;expert_23_0 -->
<g id="edge30" class="edge">
<title>gate_23&#45;&gt;expert_23_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M616.26,-1748.87C534.2,-1732.16 446.55,-1714.31 376.61,-1700.07"/>
<polygon fill="blue" stroke="blue" points="376.92,-1696.56 366.43,-1698 375.53,-1703.42 376.92,-1696.56"/>
<text text-anchor="middle" x="544.5" y="-1719.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_23_1 -->
<g id="node22" class="node">
<title>expert_23_1</title>
<polygon fill="lightcoral" stroke="black" points="932.5,-1697.95 483.5,-1697.95 483.5,-1644.95 932.5,-1644.95 932.5,-1697.95"/>
<text text-anchor="middle" x="708" y="-1682.75" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;9)</text>
<text text-anchor="middle" x="708" y="-1667.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="708" y="-1652.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_23&#45;&gt;expert_23_1 -->
<g id="edge31" class="edge">
<title>gate_23&#45;&gt;expert_23_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M805.29,-1748.69C786.24,-1733.76 766.05,-1717.94 749.02,-1704.6"/>
<polygon fill="blue" stroke="blue" points="750.97,-1701.68 740.94,-1698.26 746.65,-1707.19 750.97,-1701.68"/>
<text text-anchor="middle" x="806.5" y="-1719.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_23_2 -->
<g id="node23" class="node">
<title>expert_23_2</title>
<polygon fill="lightcoral" stroke="black" points="1399.5,-1697.95 950.5,-1697.95 950.5,-1644.95 1399.5,-1644.95 1399.5,-1697.95"/>
<text text-anchor="middle" x="1175" y="-1682.75" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;10)</text>
<text text-anchor="middle" x="1175" y="-1667.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1175" y="-1652.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_23&#45;&gt;expert_23_2 -->
<g id="edge32" class="edge">
<title>gate_23&#45;&gt;expert_23_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M994.8,-1748.87C1032.43,-1732.92 1072.51,-1715.92 1105.29,-1702.02"/>
<polygon fill="blue" stroke="blue" points="1106.93,-1705.12 1114.77,-1698 1104.2,-1698.68 1106.93,-1705.12"/>
<text text-anchor="middle" x="1094.5" y="-1719.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_23_3 -->
<g id="node24" class="node">
<title>expert_23_3</title>
<polygon fill="lightcoral" stroke="black" points="1866.5,-1697.95 1417.5,-1697.95 1417.5,-1644.95 1866.5,-1644.95 1866.5,-1697.95"/>
<text text-anchor="middle" x="1642" y="-1682.75" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;11)</text>
<text text-anchor="middle" x="1642" y="-1667.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1642" y="-1652.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_23&#45;&gt;expert_23_3 -->
<g id="edge33" class="edge">
<title>gate_23&#45;&gt;expert_23_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1155.99,-1753.56C1264.75,-1735.41 1385.08,-1715.33 1478.8,-1699.69"/>
<polygon fill="blue" stroke="blue" points="1479.65,-1703.09 1488.94,-1698 1478.5,-1696.19 1479.65,-1703.09"/>
<text text-anchor="middle" x="1396.5" y="-1719.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_agg_23 -->
<g id="node25" class="node">
<title>expert_agg_23</title>
<polygon fill="lightyellow" stroke="black" points="1362.5,-1607.95 621.99,-1607.95 431.5,-1501.95 1172.01,-1501.95 1362.5,-1607.95"/>
<text text-anchor="middle" x="897" y="-1566.25" font-family="Times,serif" font-size="14.00">Expert Aggregation (GPU&#45;12)</text>
<text text-anchor="middle" x="897" y="-1551.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="897" y="-1536.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_23_0&#45;&gt;expert_agg_23 -->
<g id="edge34" class="edge">
<title>expert_23_0&#45;&gt;expert_agg_23</title>
<path fill="none" stroke="black" d="M387.4,-1644.9C452.09,-1633.61 530.54,-1619.92 606.3,-1606.69"/>
<polygon fill="black" stroke="black" points="607.24,-1610.08 616.49,-1604.91 606.03,-1603.19 607.24,-1610.08"/>
</g>
<!-- expert_23_1&#45;&gt;expert_agg_23 -->
<g id="edge35" class="edge">
<title>expert_23_1&#45;&gt;expert_agg_23</title>
<path fill="none" stroke="black" d="M750.42,-1644.76C765.85,-1635.41 783.98,-1624.43 802.12,-1613.43"/>
<polygon fill="black" stroke="black" points="804.28,-1616.22 811.02,-1608.04 800.65,-1610.23 804.28,-1616.22"/>
</g>
<!-- expert_23_2&#45;&gt;expert_agg_23 -->
<g id="edge36" class="edge">
<title>expert_23_2&#45;&gt;expert_agg_23</title>
<path fill="none" stroke="black" d="M1112.96,-1644.9C1089.16,-1635.1 1060.98,-1623.49 1032.95,-1611.95"/>
<polygon fill="black" stroke="black" points="1034.04,-1608.61 1023.46,-1608.04 1031.38,-1615.08 1034.04,-1608.61"/>
</g>
<!-- expert_23_3&#45;&gt;expert_agg_23 -->
<g id="edge37" class="edge">
<title>expert_23_3&#45;&gt;expert_agg_23</title>
<path fill="none" stroke="black" d="M1475.73,-1644.9C1407.57,-1634.42 1325.95,-1621.88 1245.8,-1609.56"/>
<polygon fill="black" stroke="black" points="1245.94,-1606.04 1235.52,-1607.98 1244.88,-1612.96 1245.94,-1606.04"/>
</g>
<!-- attn_qkv_47_0 -->
<g id="node26" class="node">
<title>attn_qkv_47_0</title>
<polygon fill="lightgreen" stroke="black" points="855,-1443.95 401,-1443.95 401,-1390.95 855,-1390.95 855,-1443.95"/>
<text text-anchor="middle" x="628" y="-1428.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;16)</text>
<text text-anchor="middle" x="628" y="-1413.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="628" y="-1398.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- expert_agg_23&#45;&gt;attn_qkv_47_0 -->
<g id="edge38" class="edge">
<title>expert_agg_23&#45;&gt;attn_qkv_47_0</title>
<path fill="none" stroke="black" d="M793.77,-1501.95C757.9,-1483.88 718.88,-1464.23 687.72,-1448.54"/>
<polygon fill="black" stroke="black" points="689.24,-1445.38 678.74,-1444.01 686.09,-1451.63 689.24,-1445.38"/>
</g>
<!-- attn_qkv_47_1 -->
<g id="node27" class="node">
<title>attn_qkv_47_1</title>
<polygon fill="lightgreen" stroke="black" points="1327,-1443.95 873,-1443.95 873,-1390.95 1327,-1390.95 1327,-1443.95"/>
<text text-anchor="middle" x="1100" y="-1428.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;17)</text>
<text text-anchor="middle" x="1100" y="-1413.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1100" y="-1398.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- expert_agg_23&#45;&gt;attn_qkv_47_1 -->
<g id="edge39" class="edge">
<title>expert_agg_23&#45;&gt;attn_qkv_47_1</title>
<path fill="none" stroke="black" d="M974.9,-1501.95C1001.28,-1484.35 1029.9,-1465.24 1053.1,-1449.76"/>
<polygon fill="black" stroke="black" points="1055.34,-1452.47 1061.71,-1444.01 1051.45,-1446.65 1055.34,-1452.47"/>
</g>
<!-- attn_score_47_0 -->
<g id="node28" class="node">
<title>attn_score_47_0</title>
<polygon fill="lightgreen" stroke="black" points="855,-1339.95 401,-1339.95 401,-1286.95 855,-1286.95 855,-1339.95"/>
<text text-anchor="middle" x="628" y="-1324.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;16)</text>
<text text-anchor="middle" x="628" y="-1309.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="628" y="-1294.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_47_0&#45;&gt;attn_score_47_0 -->
<g id="edge40" class="edge">
<title>attn_qkv_47_0&#45;&gt;attn_score_47_0</title>
<path fill="none" stroke="black" d="M628,-1390.71C628,-1378.51 628,-1363.73 628,-1350.44"/>
<polygon fill="black" stroke="black" points="631.5,-1350.18 628,-1340.18 624.5,-1350.18 631.5,-1350.18"/>
</g>
<!-- attn_score_47_1 -->
<g id="node29" class="node">
<title>attn_score_47_1</title>
<polygon fill="lightgreen" stroke="black" points="1327,-1339.95 873,-1339.95 873,-1286.95 1327,-1286.95 1327,-1339.95"/>
<text text-anchor="middle" x="1100" y="-1324.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;17)</text>
<text text-anchor="middle" x="1100" y="-1309.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1100" y="-1294.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_47_0&#45;&gt;attn_score_47_1 -->
<g id="edge44" class="edge">
<title>attn_qkv_47_0&#45;&gt;attn_score_47_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M724.16,-1390.93C766.32,-1380.13 816.47,-1367.8 862,-1357.95 887.87,-1352.36 915.42,-1346.89 942.27,-1341.81"/>
<polygon fill="red" stroke="red" points="942.94,-1345.25 952.12,-1339.96 941.64,-1338.37 942.94,-1345.25"/>
<text text-anchor="middle" x="897" y="-1361.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_47_1&#45;&gt;attn_score_47_0 -->
<g id="edge45" class="edge">
<title>attn_qkv_47_1&#45;&gt;attn_score_47_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1035.85,-1390.85C1004.89,-1379.34 966.96,-1366.46 932,-1357.95 906.74,-1351.81 880.06,-1346.43 853.44,-1341.74"/>
<polygon fill="red" stroke="red" points="853.69,-1338.23 843.24,-1339.98 852.5,-1345.13 853.69,-1338.23"/>
<text text-anchor="middle" x="1018" y="-1361.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_47_1&#45;&gt;attn_score_47_1 -->
<g id="edge41" class="edge">
<title>attn_qkv_47_1&#45;&gt;attn_score_47_1</title>
<path fill="none" stroke="black" d="M1100,-1390.71C1100,-1378.51 1100,-1363.73 1100,-1350.44"/>
<polygon fill="black" stroke="black" points="1103.5,-1350.18 1100,-1340.18 1096.5,-1350.18 1103.5,-1350.18"/>
</g>
<!-- attn_out_47_0 -->
<g id="node30" class="node">
<title>attn_out_47_0</title>
<polygon fill="lightgreen" stroke="black" points="854.5,-1249.95 405.5,-1249.95 405.5,-1196.95 854.5,-1196.95 854.5,-1249.95"/>
<text text-anchor="middle" x="630" y="-1234.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;16)</text>
<text text-anchor="middle" x="630" y="-1219.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="630" y="-1204.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_47_0&#45;&gt;attn_out_47_0 -->
<g id="edge42" class="edge">
<title>attn_score_47_0&#45;&gt;attn_out_47_0</title>
<path fill="none" stroke="black" d="M628.59,-1286.53C628.78,-1278.29 628.99,-1269.03 629.19,-1260.23"/>
<polygon fill="black" stroke="black" points="632.69,-1260.27 629.41,-1250.19 625.69,-1260.11 632.69,-1260.27"/>
</g>
<!-- attn_out_47_1 -->
<g id="node31" class="node">
<title>attn_out_47_1</title>
<polygon fill="lightgreen" stroke="black" points="1322.5,-1249.95 873.5,-1249.95 873.5,-1196.95 1322.5,-1196.95 1322.5,-1249.95"/>
<text text-anchor="middle" x="1098" y="-1234.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;17)</text>
<text text-anchor="middle" x="1098" y="-1219.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1098" y="-1204.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_47_1&#45;&gt;attn_out_47_1 -->
<g id="edge43" class="edge">
<title>attn_score_47_1&#45;&gt;attn_out_47_1</title>
<path fill="none" stroke="black" d="M1099.41,-1286.53C1099.22,-1278.29 1099.01,-1269.03 1098.81,-1260.23"/>
<polygon fill="black" stroke="black" points="1102.31,-1260.11 1098.59,-1250.19 1095.31,-1260.27 1102.31,-1260.11"/>
</g>
<!-- gate_47 -->
<g id="node32" class="node">
<title>gate_47</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1296.58,-1159.95 554.36,-1159.95 363.42,-1053.95 1105.64,-1053.95 1296.58,-1159.95"/>
<text text-anchor="middle" x="830" y="-1118.25" font-family="Times,serif" font-size="14.00">Gate Routing (GPU&#45;18)</text>
<text text-anchor="middle" x="830" y="-1103.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="830" y="-1088.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, num_experts=128]</text>
</g>
<!-- attn_out_47_0&#45;&gt;gate_47 -->
<g id="edge46" class="edge">
<title>attn_out_47_0&#45;&gt;gate_47</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M674.88,-1196.76C691.36,-1187.32 710.75,-1176.23 730.12,-1165.13"/>
<polygon fill="black" stroke="black" points="732.08,-1168.05 739.02,-1160.04 728.6,-1161.97 732.08,-1168.05"/>
</g>
<!-- attn_out_47_1&#45;&gt;gate_47 -->
<g id="edge47" class="edge">
<title>attn_out_47_1&#45;&gt;gate_47</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1038.19,-1196.9C1015.35,-1187.14 988.31,-1175.59 961.41,-1164.1"/>
<polygon fill="black" stroke="black" points="962.48,-1160.75 951.91,-1160.04 959.73,-1167.19 962.48,-1160.75"/>
</g>
<!-- expert_47_0 -->
<g id="node33" class="node">
<title>expert_47_0</title>
<polygon fill="lightcoral" stroke="black" points="506.5,-1002.95 57.5,-1002.95 57.5,-949.95 506.5,-949.95 506.5,-1002.95"/>
<text text-anchor="middle" x="282" y="-987.75" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;16)</text>
<text text-anchor="middle" x="282" y="-972.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="282" y="-957.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_47&#45;&gt;expert_47_0 -->
<g id="edge48" class="edge">
<title>gate_47&#45;&gt;expert_47_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M607.9,-1053.87C537.07,-1037.27 461.45,-1019.53 400.9,-1005.33"/>
<polygon fill="blue" stroke="blue" points="401.46,-1001.87 390.93,-1003 399.86,-1008.69 401.46,-1001.87"/>
<text text-anchor="middle" x="549.5" y="-1024.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_47_1 -->
<g id="node34" class="node">
<title>expert_47_1</title>
<polygon fill="lightcoral" stroke="black" points="973.5,-1002.95 524.5,-1002.95 524.5,-949.95 973.5,-949.95 973.5,-1002.95"/>
<text text-anchor="middle" x="749" y="-987.75" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;17)</text>
<text text-anchor="middle" x="749" y="-972.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="749" y="-957.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_47&#45;&gt;expert_47_1 -->
<g id="edge49" class="edge">
<title>gate_47&#45;&gt;expert_47_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M797.05,-1053.69C788.16,-1039.57 778.76,-1024.66 770.65,-1011.8"/>
<polygon fill="blue" stroke="blue" points="773.56,-1009.86 765.27,-1003.26 767.64,-1013.59 773.56,-1009.86"/>
<text text-anchor="middle" x="810.5" y="-1024.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_47_2 -->
<g id="node35" class="node">
<title>expert_47_2</title>
<polygon fill="lightcoral" stroke="black" points="1440.5,-1002.95 991.5,-1002.95 991.5,-949.95 1440.5,-949.95 1440.5,-1002.95"/>
<text text-anchor="middle" x="1216" y="-987.75" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;18)</text>
<text text-anchor="middle" x="1216" y="-972.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1216" y="-957.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_47&#45;&gt;expert_47_2 -->
<g id="edge50" class="edge">
<title>gate_47&#45;&gt;expert_47_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M986.44,-1053.87C1035.3,-1037.61 1087.4,-1020.26 1129.6,-1006.22"/>
<polygon fill="blue" stroke="blue" points="1130.89,-1009.48 1139.27,-1003 1128.68,-1002.83 1130.89,-1009.48"/>
<text text-anchor="middle" x="1106.5" y="-1024.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_47_3 -->
<g id="node36" class="node">
<title>expert_47_3</title>
<polygon fill="lightcoral" stroke="black" points="1907.5,-1002.95 1458.5,-1002.95 1458.5,-949.95 1907.5,-949.95 1907.5,-1002.95"/>
<text text-anchor="middle" x="1683" y="-987.75" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;19)</text>
<text text-anchor="middle" x="1683" y="-972.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1683" y="-957.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_47&#45;&gt;expert_47_3 -->
<g id="edge51" class="edge">
<title>gate_47&#45;&gt;expert_47_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1120.57,-1062.18C1247.58,-1043.05 1392.55,-1021.21 1503.49,-1004.5"/>
<polygon fill="blue" stroke="blue" points="1504.07,-1007.95 1513.44,-1003 1503.03,-1001.03 1504.07,-1007.95"/>
<text text-anchor="middle" x="1408.5" y="-1024.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_agg_47 -->
<g id="node37" class="node">
<title>expert_agg_47</title>
<polygon fill="lightyellow" stroke="black" points="1291.5,-912.95 550.99,-912.95 360.5,-806.95 1101.01,-806.95 1291.5,-912.95"/>
<text text-anchor="middle" x="826" y="-871.25" font-family="Times,serif" font-size="14.00">Expert Aggregation (GPU&#45;20)</text>
<text text-anchor="middle" x="826" y="-856.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="826" y="-841.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_47_0&#45;&gt;expert_agg_47 -->
<g id="edge52" class="edge">
<title>expert_47_0&#45;&gt;expert_agg_47</title>
<path fill="none" stroke="black" d="M403.41,-949.9C452.47,-939.57 511.08,-927.24 568.8,-915.09"/>
<polygon fill="black" stroke="black" points="569.75,-918.47 578.81,-912.98 568.3,-911.62 569.75,-918.47"/>
</g>
<!-- expert_47_1&#45;&gt;expert_agg_47 -->
<g id="edge53" class="edge">
<title>expert_47_1&#45;&gt;expert_agg_47</title>
<path fill="none" stroke="black" d="M766.28,-949.76C771.96,-941.31 778.54,-931.53 785.21,-921.61"/>
<polygon fill="black" stroke="black" points="788.14,-923.53 790.81,-913.27 782.33,-919.62 788.14,-923.53"/>
</g>
<!-- expert_47_2&#45;&gt;expert_agg_47 -->
<g id="edge54" class="edge">
<title>expert_47_2&#45;&gt;expert_agg_47</title>
<path fill="none" stroke="black" d="M1128.96,-949.9C1094.57,-939.8 1053.62,-927.78 1013.14,-915.89"/>
<polygon fill="black" stroke="black" points="1013.99,-912.5 1003.41,-913.04 1012.02,-919.21 1013.99,-912.5"/>
</g>
<!-- expert_47_3&#45;&gt;expert_agg_47 -->
<g id="edge55" class="edge">
<title>expert_47_3&#45;&gt;expert_agg_47</title>
<path fill="none" stroke="black" d="M1492.01,-949.94C1413.12,-939.4 1318.54,-926.76 1225.76,-914.36"/>
<polygon fill="black" stroke="black" points="1226,-910.86 1215.63,-913.01 1225.08,-917.8 1226,-910.86"/>
</g>
<!-- attn_qkv_70_0 -->
<g id="node38" class="node">
<title>attn_qkv_70_0</title>
<polygon fill="lightgreen" stroke="black" points="902,-748.95 448,-748.95 448,-695.95 902,-695.95 902,-748.95"/>
<text text-anchor="middle" x="675" y="-733.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;24)</text>
<text text-anchor="middle" x="675" y="-718.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="675" y="-703.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- expert_agg_47&#45;&gt;attn_qkv_70_0 -->
<g id="edge56" class="edge">
<title>expert_agg_47&#45;&gt;attn_qkv_70_0</title>
<path fill="none" stroke="black" d="M768.05,-806.95C748.87,-789.74 728.08,-771.09 711.03,-755.79"/>
<polygon fill="black" stroke="black" points="713.26,-753.08 703.48,-749.01 708.58,-758.29 713.26,-753.08"/>
</g>
<!-- attn_qkv_70_1 -->
<g id="node39" class="node">
<title>attn_qkv_70_1</title>
<polygon fill="lightgreen" stroke="black" points="1374,-748.95 920,-748.95 920,-695.95 1374,-695.95 1374,-748.95"/>
<text text-anchor="middle" x="1147" y="-733.75" font-family="Times,serif" font-size="14.00">Attention QKV Proj (GPU&#45;25)</text>
<text text-anchor="middle" x="1147" y="-718.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1147" y="-703.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- expert_agg_47&#45;&gt;attn_qkv_70_1 -->
<g id="edge57" class="edge">
<title>expert_agg_47&#45;&gt;attn_qkv_70_1</title>
<path fill="none" stroke="black" d="M949.19,-806.95C992.54,-788.65 1039.75,-768.73 1077.16,-752.93"/>
<polygon fill="black" stroke="black" points="1078.61,-756.12 1086.46,-749.01 1075.88,-749.67 1078.61,-756.12"/>
</g>
<!-- attn_score_70_0 -->
<g id="node40" class="node">
<title>attn_score_70_0</title>
<polygon fill="lightgreen" stroke="black" points="902,-644.95 448,-644.95 448,-591.95 902,-591.95 902,-644.95"/>
<text text-anchor="middle" x="675" y="-629.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;24)</text>
<text text-anchor="middle" x="675" y="-614.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="675" y="-599.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_70_0&#45;&gt;attn_score_70_0 -->
<g id="edge58" class="edge">
<title>attn_qkv_70_0&#45;&gt;attn_score_70_0</title>
<path fill="none" stroke="black" d="M675,-695.71C675,-683.51 675,-668.73 675,-655.44"/>
<polygon fill="black" stroke="black" points="678.5,-655.18 675,-645.18 671.5,-655.18 678.5,-655.18"/>
</g>
<!-- attn_score_70_1 -->
<g id="node41" class="node">
<title>attn_score_70_1</title>
<polygon fill="lightgreen" stroke="black" points="1374,-644.95 920,-644.95 920,-591.95 1374,-591.95 1374,-644.95"/>
<text text-anchor="middle" x="1147" y="-629.75" font-family="Times,serif" font-size="14.00">Attention Scores (GPU&#45;25)</text>
<text text-anchor="middle" x="1147" y="-614.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1147" y="-599.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
</g>
<!-- attn_qkv_70_0&#45;&gt;attn_score_70_1 -->
<g id="edge62" class="edge">
<title>attn_qkv_70_0&#45;&gt;attn_score_70_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M771.16,-695.93C813.32,-685.13 863.47,-672.8 909,-662.95 934.87,-657.36 962.42,-651.89 989.27,-646.81"/>
<polygon fill="red" stroke="red" points="989.94,-650.25 999.12,-644.96 988.64,-643.37 989.94,-650.25"/>
<text text-anchor="middle" x="944" y="-666.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_70_1&#45;&gt;attn_score_70_0 -->
<g id="edge63" class="edge">
<title>attn_qkv_70_1&#45;&gt;attn_score_70_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1082.85,-695.85C1051.89,-684.34 1013.96,-671.46 979,-662.95 953.74,-656.81 927.06,-651.43 900.44,-646.74"/>
<polygon fill="red" stroke="red" points="900.69,-643.23 890.24,-644.98 899.5,-650.13 900.69,-643.23"/>
<text text-anchor="middle" x="1065" y="-666.75" font-family="Times,serif" font-size="14.00">TP Comm</text>
</g>
<!-- attn_qkv_70_1&#45;&gt;attn_score_70_1 -->
<g id="edge59" class="edge">
<title>attn_qkv_70_1&#45;&gt;attn_score_70_1</title>
<path fill="none" stroke="black" d="M1147,-695.71C1147,-683.51 1147,-668.73 1147,-655.44"/>
<polygon fill="black" stroke="black" points="1150.5,-655.18 1147,-645.18 1143.5,-655.18 1150.5,-655.18"/>
</g>
<!-- attn_out_70_0 -->
<g id="node42" class="node">
<title>attn_out_70_0</title>
<polygon fill="lightgreen" stroke="black" points="900.5,-554.95 451.5,-554.95 451.5,-501.95 900.5,-501.95 900.5,-554.95"/>
<text text-anchor="middle" x="676" y="-539.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;24)</text>
<text text-anchor="middle" x="676" y="-524.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="676" y="-509.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_70_0&#45;&gt;attn_out_70_0 -->
<g id="edge60" class="edge">
<title>attn_score_70_0&#45;&gt;attn_out_70_0</title>
<path fill="none" stroke="black" d="M675.29,-591.53C675.39,-583.29 675.49,-574.03 675.59,-565.23"/>
<polygon fill="black" stroke="black" points="679.09,-565.23 675.71,-555.19 672.09,-565.15 679.09,-565.23"/>
</g>
<!-- attn_out_70_1 -->
<g id="node43" class="node">
<title>attn_out_70_1</title>
<polygon fill="lightgreen" stroke="black" points="1368.5,-554.95 919.5,-554.95 919.5,-501.95 1368.5,-501.95 1368.5,-554.95"/>
<text text-anchor="middle" x="1144" y="-539.75" font-family="Times,serif" font-size="14.00">Attention Output Proj (GPU&#45;25)</text>
<text text-anchor="middle" x="1144" y="-524.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=32, d_k=64]</text>
<text text-anchor="middle" x="1144" y="-509.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- attn_score_70_1&#45;&gt;attn_out_70_1 -->
<g id="edge61" class="edge">
<title>attn_score_70_1&#45;&gt;attn_out_70_1</title>
<path fill="none" stroke="black" d="M1146.12,-591.53C1145.84,-583.29 1145.52,-574.03 1145.22,-565.23"/>
<polygon fill="black" stroke="black" points="1148.72,-565.07 1144.88,-555.19 1141.72,-565.31 1148.72,-565.07"/>
</g>
<!-- gate_70 -->
<g id="node44" class="node">
<title>gate_70</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1358.58,-464.95 616.36,-464.95 425.42,-358.95 1167.64,-358.95 1358.58,-464.95"/>
<text text-anchor="middle" x="892" y="-423.25" font-family="Times,serif" font-size="14.00">Gate Routing (GPU&#45;26)</text>
<text text-anchor="middle" x="892" y="-408.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="892" y="-393.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, num_experts=128]</text>
</g>
<!-- attn_out_70_0&#45;&gt;gate_70 -->
<g id="edge64" class="edge">
<title>attn_out_70_0&#45;&gt;gate_70</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M724.21,-501.9C742.16,-492.38 763.33,-481.16 784.47,-469.95"/>
<polygon fill="black" stroke="black" points="786.33,-472.93 793.52,-465.16 783.05,-466.75 786.33,-472.93"/>
</g>
<!-- attn_out_70_1&#45;&gt;gate_70 -->
<g id="edge65" class="edge">
<title>attn_out_70_1&#45;&gt;gate_70</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1087.76,-501.9C1066.38,-492.18 1041.08,-480.69 1015.9,-469.25"/>
<polygon fill="black" stroke="black" points="1017.19,-465.99 1006.63,-465.04 1014.29,-472.36 1017.19,-465.99"/>
</g>
<!-- expert_70_0 -->
<g id="node45" class="node">
<title>expert_70_0</title>
<polygon fill="lightcoral" stroke="black" points="485.5,-307.95 36.5,-307.95 36.5,-254.95 485.5,-254.95 485.5,-307.95"/>
<text text-anchor="middle" x="261" y="-292.75" font-family="Times,serif" font-size="14.00">Expert 0 (GPU&#45;24)</text>
<text text-anchor="middle" x="261" y="-277.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="261" y="-262.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_70&#45;&gt;expert_70_0 -->
<g id="edge66" class="edge">
<title>gate_70&#45;&gt;expert_70_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M636.26,-358.87C554.2,-342.16 466.55,-324.31 396.61,-310.07"/>
<polygon fill="blue" stroke="blue" points="396.92,-306.56 386.43,-308 395.53,-313.42 396.92,-306.56"/>
<text text-anchor="middle" x="564.5" y="-329.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_70_1 -->
<g id="node46" class="node">
<title>expert_70_1</title>
<polygon fill="lightcoral" stroke="black" points="952.5,-307.95 503.5,-307.95 503.5,-254.95 952.5,-254.95 952.5,-307.95"/>
<text text-anchor="middle" x="728" y="-292.75" font-family="Times,serif" font-size="14.00">Expert 1 (GPU&#45;25)</text>
<text text-anchor="middle" x="728" y="-277.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="728" y="-262.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_70&#45;&gt;expert_70_1 -->
<g id="edge67" class="edge">
<title>gate_70&#45;&gt;expert_70_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M825.29,-358.69C806.24,-343.76 786.05,-327.94 769.02,-314.6"/>
<polygon fill="blue" stroke="blue" points="770.97,-311.68 760.94,-308.26 766.65,-317.19 770.97,-311.68"/>
<text text-anchor="middle" x="826.5" y="-329.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_70_2 -->
<g id="node47" class="node">
<title>expert_70_2</title>
<polygon fill="lightcoral" stroke="black" points="1419.5,-307.95 970.5,-307.95 970.5,-254.95 1419.5,-254.95 1419.5,-307.95"/>
<text text-anchor="middle" x="1195" y="-292.75" font-family="Times,serif" font-size="14.00">Expert 2 (GPU&#45;26)</text>
<text text-anchor="middle" x="1195" y="-277.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1195" y="-262.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_70&#45;&gt;expert_70_2 -->
<g id="edge68" class="edge">
<title>gate_70&#45;&gt;expert_70_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1014.8,-358.87C1052.43,-342.92 1092.51,-325.92 1125.29,-312.02"/>
<polygon fill="blue" stroke="blue" points="1126.93,-315.12 1134.77,-308 1124.2,-308.68 1126.93,-315.12"/>
<text text-anchor="middle" x="1114.5" y="-329.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_70_3 -->
<g id="node48" class="node">
<title>expert_70_3</title>
<polygon fill="lightcoral" stroke="black" points="1886.5,-307.95 1437.5,-307.95 1437.5,-254.95 1886.5,-254.95 1886.5,-307.95"/>
<text text-anchor="middle" x="1662" y="-292.75" font-family="Times,serif" font-size="14.00">Expert 3 (GPU&#45;27)</text>
<text text-anchor="middle" x="1662" y="-277.75" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1662" y="-262.75" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- gate_70&#45;&gt;expert_70_3 -->
<g id="edge69" class="edge">
<title>gate_70&#45;&gt;expert_70_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1175.99,-363.56C1284.75,-345.41 1405.08,-325.33 1498.8,-309.69"/>
<polygon fill="blue" stroke="blue" points="1499.65,-313.09 1508.94,-308 1498.5,-306.19 1499.65,-313.09"/>
<text text-anchor="middle" x="1416.5" y="-329.75" font-family="Times,serif" font-size="14.00">routing</text>
</g>
<!-- expert_agg_70 -->
<g id="node49" class="node">
<title>expert_agg_70</title>
<polygon fill="lightyellow" stroke="black" points="1427.5,-217.95 686.99,-217.95 496.5,-111.95 1237.01,-111.95 1427.5,-217.95"/>
<text text-anchor="middle" x="962" y="-176.25" font-family="Times,serif" font-size="14.00">Expert Aggregation (GPU&#45;28)</text>
<text text-anchor="middle" x="962" y="-161.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="962" y="-146.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_70_0&#45;&gt;expert_agg_70 -->
<g id="edge70" class="edge">
<title>expert_70_0&#45;&gt;expert_agg_70</title>
<path fill="none" stroke="black" d="M417.45,-254.9C491.07,-242.87 581.39,-228.12 667.14,-214.12"/>
<polygon fill="black" stroke="black" points="667.73,-217.57 677.03,-212.5 666.6,-210.66 667.73,-217.57"/>
</g>
<!-- expert_70_1&#45;&gt;expert_agg_70 -->
<g id="edge71" class="edge">
<title>expert_70_1&#45;&gt;expert_agg_70</title>
<path fill="none" stroke="black" d="M780.22,-254.9C799.84,-245.3 823.01,-233.96 846.12,-222.65"/>
<polygon fill="black" stroke="black" points="847.87,-225.69 855.32,-218.16 844.8,-219.41 847.87,-225.69"/>
</g>
<!-- expert_70_2&#45;&gt;expert_agg_70 -->
<g id="edge72" class="edge">
<title>expert_70_2&#45;&gt;expert_agg_70</title>
<path fill="none" stroke="black" d="M1143,-254.9C1123.46,-245.3 1100.39,-233.96 1077.38,-222.65"/>
<polygon fill="black" stroke="black" points="1078.75,-219.42 1068.23,-218.16 1075.66,-225.71 1078.75,-219.42"/>
</g>
<!-- expert_70_3&#45;&gt;expert_agg_70 -->
<g id="edge73" class="edge">
<title>expert_70_3&#45;&gt;expert_agg_70</title>
<path fill="none" stroke="black" d="M1505.78,-254.9C1441.86,-244.44 1365.35,-231.93 1290.19,-219.64"/>
<polygon fill="black" stroke="black" points="1290.51,-216.14 1280.08,-217.98 1289.38,-223.05 1290.51,-216.14"/>
</g>
<!-- output -->
<g id="node51" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="962" cy="-37.48" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="962" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="962" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="962" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- expert_agg_70&#45;&gt;output -->
<g id="edge74" class="edge">
<title>expert_agg_70&#45;&gt;output</title>
<path fill="none" stroke="black" d="M962,-111.83C962,-102.93 962,-93.73 962,-84.98"/>
<polygon fill="black" stroke="black" points="965.5,-84.96 962,-74.96 958.5,-84.96 965.5,-84.96"/>
</g>
<!-- input -->
<g id="node50" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="1057" cy="-3019.43" rx="317.48" ry="37.45"/>
<text text-anchor="middle" x="1057" y="-3030.73" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1057" y="-3015.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1057" y="-3000.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- input&#45;&gt;embed_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M1057,-2981.78C1057,-2966.81 1057,-2949.54 1057,-2934.62"/>
<polygon fill="black" stroke="black" points="1060.5,-2934.23 1057,-2924.23 1053.5,-2934.23 1060.5,-2934.23"/>
</g>
</g>
</svg>
