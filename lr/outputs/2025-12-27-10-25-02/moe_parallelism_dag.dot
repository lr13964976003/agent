// MOE Model Parallelism Strategy DAG
digraph {
	dpi=300 rankdir=TB size="20,30"
	node [fontsize=10]
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rect style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	subgraph cluster_input {
		fillcolor=lightgray label="Input Layer (Batch Size=128, Seq Len=10240)" style="rounded,filled"
		input [label="Input Tokens
Input: [batch=128, seq=10240, dim=512]
Output: [batch=128, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 0-1)" style="rounded,filled"
		ln1_dp0_ep0_tp0 [label="Layer Norm 1
GPU 0
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep0_tp0 [label="MHA (16 heads)
GPU 0
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep0_tp0 [label="MOE Gate
GPU 0
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep0_tp0 [label="Expert 1 (FC)
GPU 0
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep0_tp0 [label="Expert 2 (FC)
GPU 0
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep0_tp0 [label="Expert Aggregation
GPU 0
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep0_tp0 [label="Layer Norm 2
GPU 0
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep0_tp1 [label="Layer Norm 1
GPU 1
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep0_tp1 [label="MHA (16 heads)
GPU 1
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep0_tp1 [label="MOE Gate
GPU 1
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep0_tp1 [label="Expert 1 (FC)
GPU 1
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep0_tp1 [label="Expert 2 (FC)
GPU 1
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep0_tp1 [label="Expert Aggregation
GPU 1
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep0_tp1 [label="Layer Norm 2
GPU 1
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 2-3)" style="rounded,filled"
		ln1_dp0_ep1_tp0 [label="Layer Norm 1
GPU 2
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep1_tp0 [label="MHA (16 heads)
GPU 2
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep1_tp0 [label="MOE Gate
GPU 2
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep1_tp0 [label="Expert 1 (FC)
GPU 2
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep1_tp0 [label="Expert 2 (FC)
GPU 2
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep1_tp0 [label="Expert Aggregation
GPU 2
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep1_tp0 [label="Layer Norm 2
GPU 2
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep1_tp1 [label="Layer Norm 1
GPU 3
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep1_tp1 [label="MHA (16 heads)
GPU 3
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep1_tp1 [label="MOE Gate
GPU 3
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep1_tp1 [label="Expert 1 (FC)
GPU 3
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep1_tp1 [label="Expert 2 (FC)
GPU 3
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep1_tp1 [label="Expert Aggregation
GPU 3
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep1_tp1 [label="Layer Norm 2
GPU 3
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 4-5)" style="rounded,filled"
		ln1_dp0_ep2_tp0 [label="Layer Norm 1
GPU 4
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep2_tp0 [label="MHA (16 heads)
GPU 4
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep2_tp0 [label="MOE Gate
GPU 4
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep2_tp0 [label="Expert 1 (FC)
GPU 4
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep2_tp0 [label="Expert 2 (FC)
GPU 4
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep2_tp0 [label="Expert Aggregation
GPU 4
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep2_tp0 [label="Layer Norm 2
GPU 4
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep2_tp1 [label="Layer Norm 1
GPU 5
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep2_tp1 [label="MHA (16 heads)
GPU 5
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep2_tp1 [label="MOE Gate
GPU 5
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep2_tp1 [label="Expert 1 (FC)
GPU 5
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep2_tp1 [label="Expert 2 (FC)
GPU 5
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep2_tp1 [label="Expert Aggregation
GPU 5
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep2_tp1 [label="Layer Norm 2
GPU 5
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 6-7)" style="rounded,filled"
		ln1_dp0_ep3_tp0 [label="Layer Norm 1
GPU 6
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep3_tp0 [label="MHA (16 heads)
GPU 6
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep3_tp0 [label="MOE Gate
GPU 6
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep3_tp0 [label="Expert 1 (FC)
GPU 6
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep3_tp0 [label="Expert 2 (FC)
GPU 6
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep3_tp0 [label="Expert Aggregation
GPU 6
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep3_tp0 [label="Layer Norm 2
GPU 6
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep3_tp1 [label="Layer Norm 1
GPU 7
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep3_tp1 [label="MHA (16 heads)
GPU 7
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep3_tp1 [label="MOE Gate
GPU 7
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep3_tp1 [label="Expert 1 (FC)
GPU 7
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep3_tp1 [label="Expert 2 (FC)
GPU 7
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep3_tp1 [label="Expert Aggregation
GPU 7
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep3_tp1 [label="Layer Norm 2
GPU 7
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 8-9)" style="rounded,filled"
		ln1_dp0_ep4_tp0 [label="Layer Norm 1
GPU 8
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep4_tp0 [label="MHA (16 heads)
GPU 8
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep4_tp0 [label="MOE Gate
GPU 8
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep4_tp0 [label="Expert 1 (FC)
GPU 8
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep4_tp0 [label="Expert 2 (FC)
GPU 8
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep4_tp0 [label="Expert Aggregation
GPU 8
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep4_tp0 [label="Layer Norm 2
GPU 8
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep4_tp1 [label="Layer Norm 1
GPU 9
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep4_tp1 [label="MHA (16 heads)
GPU 9
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep4_tp1 [label="MOE Gate
GPU 9
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep4_tp1 [label="Expert 1 (FC)
GPU 9
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep4_tp1 [label="Expert 2 (FC)
GPU 9
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep4_tp1 [label="Expert Aggregation
GPU 9
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep4_tp1 [label="Layer Norm 2
GPU 9
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 10-11)" style="rounded,filled"
		ln1_dp0_ep5_tp0 [label="Layer Norm 1
GPU 10
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep5_tp0 [label="MHA (16 heads)
GPU 10
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep5_tp0 [label="MOE Gate
GPU 10
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep5_tp0 [label="Expert 1 (FC)
GPU 10
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep5_tp0 [label="Expert 2 (FC)
GPU 10
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep5_tp0 [label="Expert Aggregation
GPU 10
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep5_tp0 [label="Layer Norm 2
GPU 10
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep5_tp1 [label="Layer Norm 1
GPU 11
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep5_tp1 [label="MHA (16 heads)
GPU 11
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep5_tp1 [label="MOE Gate
GPU 11
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep5_tp1 [label="Expert 1 (FC)
GPU 11
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep5_tp1 [label="Expert 2 (FC)
GPU 11
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep5_tp1 [label="Expert Aggregation
GPU 11
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep5_tp1 [label="Layer Norm 2
GPU 11
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 12-13)" style="rounded,filled"
		ln1_dp0_ep6_tp0 [label="Layer Norm 1
GPU 12
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep6_tp0 [label="MHA (16 heads)
GPU 12
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep6_tp0 [label="MOE Gate
GPU 12
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep6_tp0 [label="Expert 1 (FC)
GPU 12
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep6_tp0 [label="Expert 2 (FC)
GPU 12
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep6_tp0 [label="Expert Aggregation
GPU 12
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep6_tp0 [label="Layer Norm 2
GPU 12
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep6_tp1 [label="Layer Norm 1
GPU 13
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep6_tp1 [label="MHA (16 heads)
GPU 13
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep6_tp1 [label="MOE Gate
GPU 13
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep6_tp1 [label="Expert 1 (FC)
GPU 13
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep6_tp1 [label="Expert 2 (FC)
GPU 13
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep6_tp1 [label="Expert Aggregation
GPU 13
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep6_tp1 [label="Layer Norm 2
GPU 13
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 14-15)" style="rounded,filled"
		ln1_dp0_ep7_tp0 [label="Layer Norm 1
GPU 14
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep7_tp0 [label="MHA (16 heads)
GPU 14
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep7_tp0 [label="MOE Gate
GPU 14
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep7_tp0 [label="Expert 1 (FC)
GPU 14
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep7_tp0 [label="Expert 2 (FC)
GPU 14
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep7_tp0 [label="Expert Aggregation
GPU 14
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep7_tp0 [label="Layer Norm 2
GPU 14
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp0_ep7_tp1 [label="Layer Norm 1
GPU 15
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp0_ep7_tp1 [label="MHA (16 heads)
GPU 15
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp0_ep7_tp1 [label="MOE Gate
GPU 15
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp0_ep7_tp1 [label="Expert 1 (FC)
GPU 15
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp0_ep7_tp1 [label="Expert 2 (FC)
GPU 15
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp0_ep7_tp1 [label="Expert Aggregation
GPU 15
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp0_ep7_tp1 [label="Layer Norm 2
GPU 15
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage1 {
		fillcolor=lightpink label="Pipeline Stage 1 (Layers 0-7)" style="rounded,filled"
	}
	subgraph cluster_dp_0_stage2_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 16-17)" style="rounded,filled"
		stage2_ln1_dp0_ep0_tp0 [label="Layer Norm 1
GPU 16
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep0_tp0 [label="MHA (16 heads)
GPU 16
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep0_tp0 [label="MOE Gate
GPU 16
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep0_tp0 [label="Expert 1 (FC)
GPU 16
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep0_tp0 [label="Expert 2 (FC)
GPU 16
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep0_tp0 [label="Expert Aggregation
GPU 16
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep0_tp0 [label="Layer Norm 2
GPU 16
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep0_tp1 [label="Layer Norm 1
GPU 17
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep0_tp1 [label="MHA (16 heads)
GPU 17
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep0_tp1 [label="MOE Gate
GPU 17
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep0_tp1 [label="Expert 1 (FC)
GPU 17
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep0_tp1 [label="Expert 2 (FC)
GPU 17
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep0_tp1 [label="Expert Aggregation
GPU 17
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep0_tp1 [label="Layer Norm 2
GPU 17
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 18-19)" style="rounded,filled"
		stage2_ln1_dp0_ep1_tp0 [label="Layer Norm 1
GPU 18
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep1_tp0 [label="MHA (16 heads)
GPU 18
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep1_tp0 [label="MOE Gate
GPU 18
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep1_tp0 [label="Expert 1 (FC)
GPU 18
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep1_tp0 [label="Expert 2 (FC)
GPU 18
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep1_tp0 [label="Expert Aggregation
GPU 18
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep1_tp0 [label="Layer Norm 2
GPU 18
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep1_tp1 [label="Layer Norm 1
GPU 19
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep1_tp1 [label="MHA (16 heads)
GPU 19
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep1_tp1 [label="MOE Gate
GPU 19
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep1_tp1 [label="Expert 1 (FC)
GPU 19
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep1_tp1 [label="Expert 2 (FC)
GPU 19
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep1_tp1 [label="Expert Aggregation
GPU 19
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep1_tp1 [label="Layer Norm 2
GPU 19
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 20-21)" style="rounded,filled"
		stage2_ln1_dp0_ep2_tp0 [label="Layer Norm 1
GPU 20
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep2_tp0 [label="MHA (16 heads)
GPU 20
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep2_tp0 [label="MOE Gate
GPU 20
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep2_tp0 [label="Expert 1 (FC)
GPU 20
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep2_tp0 [label="Expert 2 (FC)
GPU 20
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep2_tp0 [label="Expert Aggregation
GPU 20
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep2_tp0 [label="Layer Norm 2
GPU 20
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep2_tp1 [label="Layer Norm 1
GPU 21
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep2_tp1 [label="MHA (16 heads)
GPU 21
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep2_tp1 [label="MOE Gate
GPU 21
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep2_tp1 [label="Expert 1 (FC)
GPU 21
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep2_tp1 [label="Expert 2 (FC)
GPU 21
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep2_tp1 [label="Expert Aggregation
GPU 21
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep2_tp1 [label="Layer Norm 2
GPU 21
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 22-23)" style="rounded,filled"
		stage2_ln1_dp0_ep3_tp0 [label="Layer Norm 1
GPU 22
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep3_tp0 [label="MHA (16 heads)
GPU 22
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep3_tp0 [label="MOE Gate
GPU 22
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep3_tp0 [label="Expert 1 (FC)
GPU 22
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep3_tp0 [label="Expert 2 (FC)
GPU 22
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep3_tp0 [label="Expert Aggregation
GPU 22
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep3_tp0 [label="Layer Norm 2
GPU 22
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep3_tp1 [label="Layer Norm 1
GPU 23
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep3_tp1 [label="MHA (16 heads)
GPU 23
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep3_tp1 [label="MOE Gate
GPU 23
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep3_tp1 [label="Expert 1 (FC)
GPU 23
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep3_tp1 [label="Expert 2 (FC)
GPU 23
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep3_tp1 [label="Expert Aggregation
GPU 23
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep3_tp1 [label="Layer Norm 2
GPU 23
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 24-25)" style="rounded,filled"
		stage2_ln1_dp0_ep4_tp0 [label="Layer Norm 1
GPU 24
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep4_tp0 [label="MHA (16 heads)
GPU 24
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep4_tp0 [label="MOE Gate
GPU 24
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep4_tp0 [label="Expert 1 (FC)
GPU 24
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep4_tp0 [label="Expert 2 (FC)
GPU 24
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep4_tp0 [label="Expert Aggregation
GPU 24
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep4_tp0 [label="Layer Norm 2
GPU 24
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep4_tp1 [label="Layer Norm 1
GPU 25
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep4_tp1 [label="MHA (16 heads)
GPU 25
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep4_tp1 [label="MOE Gate
GPU 25
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep4_tp1 [label="Expert 1 (FC)
GPU 25
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep4_tp1 [label="Expert 2 (FC)
GPU 25
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep4_tp1 [label="Expert Aggregation
GPU 25
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep4_tp1 [label="Layer Norm 2
GPU 25
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 26-27)" style="rounded,filled"
		stage2_ln1_dp0_ep5_tp0 [label="Layer Norm 1
GPU 26
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep5_tp0 [label="MHA (16 heads)
GPU 26
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep5_tp0 [label="MOE Gate
GPU 26
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep5_tp0 [label="Expert 1 (FC)
GPU 26
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep5_tp0 [label="Expert 2 (FC)
GPU 26
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep5_tp0 [label="Expert Aggregation
GPU 26
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep5_tp0 [label="Layer Norm 2
GPU 26
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep5_tp1 [label="Layer Norm 1
GPU 27
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep5_tp1 [label="MHA (16 heads)
GPU 27
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep5_tp1 [label="MOE Gate
GPU 27
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep5_tp1 [label="Expert 1 (FC)
GPU 27
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep5_tp1 [label="Expert 2 (FC)
GPU 27
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep5_tp1 [label="Expert Aggregation
GPU 27
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep5_tp1 [label="Layer Norm 2
GPU 27
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 28-29)" style="rounded,filled"
		stage2_ln1_dp0_ep6_tp0 [label="Layer Norm 1
GPU 28
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep6_tp0 [label="MHA (16 heads)
GPU 28
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep6_tp0 [label="MOE Gate
GPU 28
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep6_tp0 [label="Expert 1 (FC)
GPU 28
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep6_tp0 [label="Expert 2 (FC)
GPU 28
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep6_tp0 [label="Expert Aggregation
GPU 28
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep6_tp0 [label="Layer Norm 2
GPU 28
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep6_tp1 [label="Layer Norm 1
GPU 29
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep6_tp1 [label="MHA (16 heads)
GPU 29
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep6_tp1 [label="MOE Gate
GPU 29
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep6_tp1 [label="Expert 1 (FC)
GPU 29
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep6_tp1 [label="Expert 2 (FC)
GPU 29
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep6_tp1 [label="Expert Aggregation
GPU 29
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep6_tp1 [label="Layer Norm 2
GPU 29
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 30-31)" style="rounded,filled"
		stage2_ln1_dp0_ep7_tp0 [label="Layer Norm 1
GPU 30
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep7_tp0 [label="MHA (16 heads)
GPU 30
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep7_tp0 [label="MOE Gate
GPU 30
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep7_tp0 [label="Expert 1 (FC)
GPU 30
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep7_tp0 [label="Expert 2 (FC)
GPU 30
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep7_tp0 [label="Expert Aggregation
GPU 30
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep7_tp0 [label="Layer Norm 2
GPU 30
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp0_ep7_tp1 [label="Layer Norm 1
GPU 31
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp0_ep7_tp1 [label="MHA (16 heads)
GPU 31
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp0_ep7_tp1 [label="MOE Gate
GPU 31
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp0_ep7_tp1 [label="Expert 1 (FC)
GPU 31
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp0_ep7_tp1 [label="Expert 2 (FC)
GPU 31
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp0_ep7_tp1 [label="Expert Aggregation
GPU 31
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp0_ep7_tp1 [label="Layer Norm 2
GPU 31
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_0_stage2 {
		fillcolor=lightpink label="Pipeline Stage 2 (Layers 8-15)" style="rounded,filled"
	}
	subgraph cluster_dp_0 {
		fillcolor=lightcyan label="Data Parallel Group 0 (Batch=32)" style="rounded,filled"
	}
	subgraph cluster_dp_1_stage1_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 64-65)" style="rounded,filled"
		ln1_dp1_ep0_tp0 [label="Layer Norm 1
GPU 64
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep0_tp0 [label="MHA (16 heads)
GPU 64
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep0_tp0 [label="MOE Gate
GPU 64
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep0_tp0 [label="Expert 1 (FC)
GPU 64
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep0_tp0 [label="Expert 2 (FC)
GPU 64
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep0_tp0 [label="Expert Aggregation
GPU 64
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep0_tp0 [label="Layer Norm 2
GPU 64
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep0_tp1 [label="Layer Norm 1
GPU 65
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep0_tp1 [label="MHA (16 heads)
GPU 65
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep0_tp1 [label="MOE Gate
GPU 65
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep0_tp1 [label="Expert 1 (FC)
GPU 65
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep0_tp1 [label="Expert 2 (FC)
GPU 65
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep0_tp1 [label="Expert Aggregation
GPU 65
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep0_tp1 [label="Layer Norm 2
GPU 65
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 66-67)" style="rounded,filled"
		ln1_dp1_ep1_tp0 [label="Layer Norm 1
GPU 66
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep1_tp0 [label="MHA (16 heads)
GPU 66
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep1_tp0 [label="MOE Gate
GPU 66
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep1_tp0 [label="Expert 1 (FC)
GPU 66
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep1_tp0 [label="Expert 2 (FC)
GPU 66
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep1_tp0 [label="Expert Aggregation
GPU 66
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep1_tp0 [label="Layer Norm 2
GPU 66
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep1_tp1 [label="Layer Norm 1
GPU 67
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep1_tp1 [label="MHA (16 heads)
GPU 67
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep1_tp1 [label="MOE Gate
GPU 67
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep1_tp1 [label="Expert 1 (FC)
GPU 67
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep1_tp1 [label="Expert 2 (FC)
GPU 67
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep1_tp1 [label="Expert Aggregation
GPU 67
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep1_tp1 [label="Layer Norm 2
GPU 67
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 68-69)" style="rounded,filled"
		ln1_dp1_ep2_tp0 [label="Layer Norm 1
GPU 68
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep2_tp0 [label="MHA (16 heads)
GPU 68
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep2_tp0 [label="MOE Gate
GPU 68
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep2_tp0 [label="Expert 1 (FC)
GPU 68
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep2_tp0 [label="Expert 2 (FC)
GPU 68
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep2_tp0 [label="Expert Aggregation
GPU 68
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep2_tp0 [label="Layer Norm 2
GPU 68
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep2_tp1 [label="Layer Norm 1
GPU 69
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep2_tp1 [label="MHA (16 heads)
GPU 69
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep2_tp1 [label="MOE Gate
GPU 69
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep2_tp1 [label="Expert 1 (FC)
GPU 69
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep2_tp1 [label="Expert 2 (FC)
GPU 69
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep2_tp1 [label="Expert Aggregation
GPU 69
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep2_tp1 [label="Layer Norm 2
GPU 69
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 70-71)" style="rounded,filled"
		ln1_dp1_ep3_tp0 [label="Layer Norm 1
GPU 70
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep3_tp0 [label="MHA (16 heads)
GPU 70
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep3_tp0 [label="MOE Gate
GPU 70
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep3_tp0 [label="Expert 1 (FC)
GPU 70
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep3_tp0 [label="Expert 2 (FC)
GPU 70
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep3_tp0 [label="Expert Aggregation
GPU 70
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep3_tp0 [label="Layer Norm 2
GPU 70
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep3_tp1 [label="Layer Norm 1
GPU 71
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep3_tp1 [label="MHA (16 heads)
GPU 71
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep3_tp1 [label="MOE Gate
GPU 71
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep3_tp1 [label="Expert 1 (FC)
GPU 71
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep3_tp1 [label="Expert 2 (FC)
GPU 71
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep3_tp1 [label="Expert Aggregation
GPU 71
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep3_tp1 [label="Layer Norm 2
GPU 71
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 72-73)" style="rounded,filled"
		ln1_dp1_ep4_tp0 [label="Layer Norm 1
GPU 72
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep4_tp0 [label="MHA (16 heads)
GPU 72
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep4_tp0 [label="MOE Gate
GPU 72
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep4_tp0 [label="Expert 1 (FC)
GPU 72
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep4_tp0 [label="Expert 2 (FC)
GPU 72
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep4_tp0 [label="Expert Aggregation
GPU 72
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep4_tp0 [label="Layer Norm 2
GPU 72
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep4_tp1 [label="Layer Norm 1
GPU 73
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep4_tp1 [label="MHA (16 heads)
GPU 73
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep4_tp1 [label="MOE Gate
GPU 73
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep4_tp1 [label="Expert 1 (FC)
GPU 73
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep4_tp1 [label="Expert 2 (FC)
GPU 73
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep4_tp1 [label="Expert Aggregation
GPU 73
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep4_tp1 [label="Layer Norm 2
GPU 73
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 74-75)" style="rounded,filled"
		ln1_dp1_ep5_tp0 [label="Layer Norm 1
GPU 74
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep5_tp0 [label="MHA (16 heads)
GPU 74
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep5_tp0 [label="MOE Gate
GPU 74
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep5_tp0 [label="Expert 1 (FC)
GPU 74
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep5_tp0 [label="Expert 2 (FC)
GPU 74
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep5_tp0 [label="Expert Aggregation
GPU 74
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep5_tp0 [label="Layer Norm 2
GPU 74
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep5_tp1 [label="Layer Norm 1
GPU 75
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep5_tp1 [label="MHA (16 heads)
GPU 75
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep5_tp1 [label="MOE Gate
GPU 75
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep5_tp1 [label="Expert 1 (FC)
GPU 75
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep5_tp1 [label="Expert 2 (FC)
GPU 75
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep5_tp1 [label="Expert Aggregation
GPU 75
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep5_tp1 [label="Layer Norm 2
GPU 75
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 76-77)" style="rounded,filled"
		ln1_dp1_ep6_tp0 [label="Layer Norm 1
GPU 76
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep6_tp0 [label="MHA (16 heads)
GPU 76
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep6_tp0 [label="MOE Gate
GPU 76
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep6_tp0 [label="Expert 1 (FC)
GPU 76
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep6_tp0 [label="Expert 2 (FC)
GPU 76
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep6_tp0 [label="Expert Aggregation
GPU 76
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep6_tp0 [label="Layer Norm 2
GPU 76
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep6_tp1 [label="Layer Norm 1
GPU 77
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep6_tp1 [label="MHA (16 heads)
GPU 77
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep6_tp1 [label="MOE Gate
GPU 77
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep6_tp1 [label="Expert 1 (FC)
GPU 77
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep6_tp1 [label="Expert 2 (FC)
GPU 77
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep6_tp1 [label="Expert Aggregation
GPU 77
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep6_tp1 [label="Layer Norm 2
GPU 77
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 78-79)" style="rounded,filled"
		ln1_dp1_ep7_tp0 [label="Layer Norm 1
GPU 78
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep7_tp0 [label="MHA (16 heads)
GPU 78
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep7_tp0 [label="MOE Gate
GPU 78
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep7_tp0 [label="Expert 1 (FC)
GPU 78
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep7_tp0 [label="Expert 2 (FC)
GPU 78
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep7_tp0 [label="Expert Aggregation
GPU 78
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep7_tp0 [label="Layer Norm 2
GPU 78
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp1_ep7_tp1 [label="Layer Norm 1
GPU 79
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp1_ep7_tp1 [label="MHA (16 heads)
GPU 79
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp1_ep7_tp1 [label="MOE Gate
GPU 79
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp1_ep7_tp1 [label="Expert 1 (FC)
GPU 79
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp1_ep7_tp1 [label="Expert 2 (FC)
GPU 79
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp1_ep7_tp1 [label="Expert Aggregation
GPU 79
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp1_ep7_tp1 [label="Layer Norm 2
GPU 79
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage1 {
		fillcolor=lightpink label="Pipeline Stage 1 (Layers 0-7)" style="rounded,filled"
	}
	subgraph cluster_dp_1_stage2_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 80-81)" style="rounded,filled"
		stage2_ln1_dp1_ep0_tp0 [label="Layer Norm 1
GPU 80
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep0_tp0 [label="MHA (16 heads)
GPU 80
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep0_tp0 [label="MOE Gate
GPU 80
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep0_tp0 [label="Expert 1 (FC)
GPU 80
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep0_tp0 [label="Expert 2 (FC)
GPU 80
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep0_tp0 [label="Expert Aggregation
GPU 80
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep0_tp0 [label="Layer Norm 2
GPU 80
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep0_tp1 [label="Layer Norm 1
GPU 81
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep0_tp1 [label="MHA (16 heads)
GPU 81
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep0_tp1 [label="MOE Gate
GPU 81
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep0_tp1 [label="Expert 1 (FC)
GPU 81
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep0_tp1 [label="Expert 2 (FC)
GPU 81
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep0_tp1 [label="Expert Aggregation
GPU 81
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep0_tp1 [label="Layer Norm 2
GPU 81
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 82-83)" style="rounded,filled"
		stage2_ln1_dp1_ep1_tp0 [label="Layer Norm 1
GPU 82
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep1_tp0 [label="MHA (16 heads)
GPU 82
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep1_tp0 [label="MOE Gate
GPU 82
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep1_tp0 [label="Expert 1 (FC)
GPU 82
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep1_tp0 [label="Expert 2 (FC)
GPU 82
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep1_tp0 [label="Expert Aggregation
GPU 82
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep1_tp0 [label="Layer Norm 2
GPU 82
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep1_tp1 [label="Layer Norm 1
GPU 83
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep1_tp1 [label="MHA (16 heads)
GPU 83
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep1_tp1 [label="MOE Gate
GPU 83
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep1_tp1 [label="Expert 1 (FC)
GPU 83
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep1_tp1 [label="Expert 2 (FC)
GPU 83
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep1_tp1 [label="Expert Aggregation
GPU 83
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep1_tp1 [label="Layer Norm 2
GPU 83
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 84-85)" style="rounded,filled"
		stage2_ln1_dp1_ep2_tp0 [label="Layer Norm 1
GPU 84
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep2_tp0 [label="MHA (16 heads)
GPU 84
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep2_tp0 [label="MOE Gate
GPU 84
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep2_tp0 [label="Expert 1 (FC)
GPU 84
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep2_tp0 [label="Expert 2 (FC)
GPU 84
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep2_tp0 [label="Expert Aggregation
GPU 84
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep2_tp0 [label="Layer Norm 2
GPU 84
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep2_tp1 [label="Layer Norm 1
GPU 85
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep2_tp1 [label="MHA (16 heads)
GPU 85
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep2_tp1 [label="MOE Gate
GPU 85
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep2_tp1 [label="Expert 1 (FC)
GPU 85
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep2_tp1 [label="Expert 2 (FC)
GPU 85
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep2_tp1 [label="Expert Aggregation
GPU 85
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep2_tp1 [label="Layer Norm 2
GPU 85
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 86-87)" style="rounded,filled"
		stage2_ln1_dp1_ep3_tp0 [label="Layer Norm 1
GPU 86
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep3_tp0 [label="MHA (16 heads)
GPU 86
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep3_tp0 [label="MOE Gate
GPU 86
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep3_tp0 [label="Expert 1 (FC)
GPU 86
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep3_tp0 [label="Expert 2 (FC)
GPU 86
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep3_tp0 [label="Expert Aggregation
GPU 86
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep3_tp0 [label="Layer Norm 2
GPU 86
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep3_tp1 [label="Layer Norm 1
GPU 87
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep3_tp1 [label="MHA (16 heads)
GPU 87
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep3_tp1 [label="MOE Gate
GPU 87
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep3_tp1 [label="Expert 1 (FC)
GPU 87
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep3_tp1 [label="Expert 2 (FC)
GPU 87
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep3_tp1 [label="Expert Aggregation
GPU 87
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep3_tp1 [label="Layer Norm 2
GPU 87
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 88-89)" style="rounded,filled"
		stage2_ln1_dp1_ep4_tp0 [label="Layer Norm 1
GPU 88
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep4_tp0 [label="MHA (16 heads)
GPU 88
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep4_tp0 [label="MOE Gate
GPU 88
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep4_tp0 [label="Expert 1 (FC)
GPU 88
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep4_tp0 [label="Expert 2 (FC)
GPU 88
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep4_tp0 [label="Expert Aggregation
GPU 88
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep4_tp0 [label="Layer Norm 2
GPU 88
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep4_tp1 [label="Layer Norm 1
GPU 89
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep4_tp1 [label="MHA (16 heads)
GPU 89
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep4_tp1 [label="MOE Gate
GPU 89
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep4_tp1 [label="Expert 1 (FC)
GPU 89
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep4_tp1 [label="Expert 2 (FC)
GPU 89
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep4_tp1 [label="Expert Aggregation
GPU 89
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep4_tp1 [label="Layer Norm 2
GPU 89
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 90-91)" style="rounded,filled"
		stage2_ln1_dp1_ep5_tp0 [label="Layer Norm 1
GPU 90
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep5_tp0 [label="MHA (16 heads)
GPU 90
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep5_tp0 [label="MOE Gate
GPU 90
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep5_tp0 [label="Expert 1 (FC)
GPU 90
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep5_tp0 [label="Expert 2 (FC)
GPU 90
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep5_tp0 [label="Expert Aggregation
GPU 90
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep5_tp0 [label="Layer Norm 2
GPU 90
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep5_tp1 [label="Layer Norm 1
GPU 91
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep5_tp1 [label="MHA (16 heads)
GPU 91
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep5_tp1 [label="MOE Gate
GPU 91
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep5_tp1 [label="Expert 1 (FC)
GPU 91
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep5_tp1 [label="Expert 2 (FC)
GPU 91
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep5_tp1 [label="Expert Aggregation
GPU 91
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep5_tp1 [label="Layer Norm 2
GPU 91
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 92-93)" style="rounded,filled"
		stage2_ln1_dp1_ep6_tp0 [label="Layer Norm 1
GPU 92
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep6_tp0 [label="MHA (16 heads)
GPU 92
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep6_tp0 [label="MOE Gate
GPU 92
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep6_tp0 [label="Expert 1 (FC)
GPU 92
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep6_tp0 [label="Expert 2 (FC)
GPU 92
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep6_tp0 [label="Expert Aggregation
GPU 92
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep6_tp0 [label="Layer Norm 2
GPU 92
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep6_tp1 [label="Layer Norm 1
GPU 93
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep6_tp1 [label="MHA (16 heads)
GPU 93
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep6_tp1 [label="MOE Gate
GPU 93
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep6_tp1 [label="Expert 1 (FC)
GPU 93
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep6_tp1 [label="Expert 2 (FC)
GPU 93
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep6_tp1 [label="Expert Aggregation
GPU 93
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep6_tp1 [label="Layer Norm 2
GPU 93
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 94-95)" style="rounded,filled"
		stage2_ln1_dp1_ep7_tp0 [label="Layer Norm 1
GPU 94
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep7_tp0 [label="MHA (16 heads)
GPU 94
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep7_tp0 [label="MOE Gate
GPU 94
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep7_tp0 [label="Expert 1 (FC)
GPU 94
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep7_tp0 [label="Expert 2 (FC)
GPU 94
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep7_tp0 [label="Expert Aggregation
GPU 94
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep7_tp0 [label="Layer Norm 2
GPU 94
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp1_ep7_tp1 [label="Layer Norm 1
GPU 95
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp1_ep7_tp1 [label="MHA (16 heads)
GPU 95
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp1_ep7_tp1 [label="MOE Gate
GPU 95
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp1_ep7_tp1 [label="Expert 1 (FC)
GPU 95
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp1_ep7_tp1 [label="Expert 2 (FC)
GPU 95
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp1_ep7_tp1 [label="Expert Aggregation
GPU 95
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp1_ep7_tp1 [label="Layer Norm 2
GPU 95
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_1_stage2 {
		fillcolor=lightpink label="Pipeline Stage 2 (Layers 8-15)" style="rounded,filled"
	}
	subgraph cluster_dp_1 {
		fillcolor=lightcyan label="Data Parallel Group 1 (Batch=32)" style="rounded,filled"
	}
	subgraph cluster_dp_2_stage1_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 128-129)" style="rounded,filled"
		ln1_dp2_ep0_tp0 [label="Layer Norm 1
GPU 128
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep0_tp0 [label="MHA (16 heads)
GPU 128
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep0_tp0 [label="MOE Gate
GPU 128
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep0_tp0 [label="Expert 1 (FC)
GPU 128
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep0_tp0 [label="Expert 2 (FC)
GPU 128
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep0_tp0 [label="Expert Aggregation
GPU 128
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep0_tp0 [label="Layer Norm 2
GPU 128
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep0_tp1 [label="Layer Norm 1
GPU 129
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep0_tp1 [label="MHA (16 heads)
GPU 129
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep0_tp1 [label="MOE Gate
GPU 129
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep0_tp1 [label="Expert 1 (FC)
GPU 129
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep0_tp1 [label="Expert 2 (FC)
GPU 129
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep0_tp1 [label="Expert Aggregation
GPU 129
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep0_tp1 [label="Layer Norm 2
GPU 129
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 130-131)" style="rounded,filled"
		ln1_dp2_ep1_tp0 [label="Layer Norm 1
GPU 130
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep1_tp0 [label="MHA (16 heads)
GPU 130
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep1_tp0 [label="MOE Gate
GPU 130
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep1_tp0 [label="Expert 1 (FC)
GPU 130
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep1_tp0 [label="Expert 2 (FC)
GPU 130
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep1_tp0 [label="Expert Aggregation
GPU 130
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep1_tp0 [label="Layer Norm 2
GPU 130
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep1_tp1 [label="Layer Norm 1
GPU 131
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep1_tp1 [label="MHA (16 heads)
GPU 131
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep1_tp1 [label="MOE Gate
GPU 131
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep1_tp1 [label="Expert 1 (FC)
GPU 131
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep1_tp1 [label="Expert 2 (FC)
GPU 131
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep1_tp1 [label="Expert Aggregation
GPU 131
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep1_tp1 [label="Layer Norm 2
GPU 131
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 132-133)" style="rounded,filled"
		ln1_dp2_ep2_tp0 [label="Layer Norm 1
GPU 132
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep2_tp0 [label="MHA (16 heads)
GPU 132
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep2_tp0 [label="MOE Gate
GPU 132
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep2_tp0 [label="Expert 1 (FC)
GPU 132
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep2_tp0 [label="Expert 2 (FC)
GPU 132
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep2_tp0 [label="Expert Aggregation
GPU 132
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep2_tp0 [label="Layer Norm 2
GPU 132
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep2_tp1 [label="Layer Norm 1
GPU 133
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep2_tp1 [label="MHA (16 heads)
GPU 133
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep2_tp1 [label="MOE Gate
GPU 133
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep2_tp1 [label="Expert 1 (FC)
GPU 133
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep2_tp1 [label="Expert 2 (FC)
GPU 133
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep2_tp1 [label="Expert Aggregation
GPU 133
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep2_tp1 [label="Layer Norm 2
GPU 133
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 134-135)" style="rounded,filled"
		ln1_dp2_ep3_tp0 [label="Layer Norm 1
GPU 134
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep3_tp0 [label="MHA (16 heads)
GPU 134
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep3_tp0 [label="MOE Gate
GPU 134
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep3_tp0 [label="Expert 1 (FC)
GPU 134
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep3_tp0 [label="Expert 2 (FC)
GPU 134
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep3_tp0 [label="Expert Aggregation
GPU 134
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep3_tp0 [label="Layer Norm 2
GPU 134
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep3_tp1 [label="Layer Norm 1
GPU 135
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep3_tp1 [label="MHA (16 heads)
GPU 135
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep3_tp1 [label="MOE Gate
GPU 135
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep3_tp1 [label="Expert 1 (FC)
GPU 135
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep3_tp1 [label="Expert 2 (FC)
GPU 135
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep3_tp1 [label="Expert Aggregation
GPU 135
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep3_tp1 [label="Layer Norm 2
GPU 135
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 136-137)" style="rounded,filled"
		ln1_dp2_ep4_tp0 [label="Layer Norm 1
GPU 136
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep4_tp0 [label="MHA (16 heads)
GPU 136
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep4_tp0 [label="MOE Gate
GPU 136
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep4_tp0 [label="Expert 1 (FC)
GPU 136
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep4_tp0 [label="Expert 2 (FC)
GPU 136
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep4_tp0 [label="Expert Aggregation
GPU 136
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep4_tp0 [label="Layer Norm 2
GPU 136
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep4_tp1 [label="Layer Norm 1
GPU 137
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep4_tp1 [label="MHA (16 heads)
GPU 137
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep4_tp1 [label="MOE Gate
GPU 137
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep4_tp1 [label="Expert 1 (FC)
GPU 137
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep4_tp1 [label="Expert 2 (FC)
GPU 137
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep4_tp1 [label="Expert Aggregation
GPU 137
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep4_tp1 [label="Layer Norm 2
GPU 137
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 138-139)" style="rounded,filled"
		ln1_dp2_ep5_tp0 [label="Layer Norm 1
GPU 138
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep5_tp0 [label="MHA (16 heads)
GPU 138
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep5_tp0 [label="MOE Gate
GPU 138
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep5_tp0 [label="Expert 1 (FC)
GPU 138
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep5_tp0 [label="Expert 2 (FC)
GPU 138
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep5_tp0 [label="Expert Aggregation
GPU 138
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep5_tp0 [label="Layer Norm 2
GPU 138
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep5_tp1 [label="Layer Norm 1
GPU 139
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep5_tp1 [label="MHA (16 heads)
GPU 139
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep5_tp1 [label="MOE Gate
GPU 139
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep5_tp1 [label="Expert 1 (FC)
GPU 139
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep5_tp1 [label="Expert 2 (FC)
GPU 139
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep5_tp1 [label="Expert Aggregation
GPU 139
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep5_tp1 [label="Layer Norm 2
GPU 139
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 140-141)" style="rounded,filled"
		ln1_dp2_ep6_tp0 [label="Layer Norm 1
GPU 140
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep6_tp0 [label="MHA (16 heads)
GPU 140
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep6_tp0 [label="MOE Gate
GPU 140
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep6_tp0 [label="Expert 1 (FC)
GPU 140
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep6_tp0 [label="Expert 2 (FC)
GPU 140
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep6_tp0 [label="Expert Aggregation
GPU 140
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep6_tp0 [label="Layer Norm 2
GPU 140
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep6_tp1 [label="Layer Norm 1
GPU 141
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep6_tp1 [label="MHA (16 heads)
GPU 141
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep6_tp1 [label="MOE Gate
GPU 141
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep6_tp1 [label="Expert 1 (FC)
GPU 141
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep6_tp1 [label="Expert 2 (FC)
GPU 141
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep6_tp1 [label="Expert Aggregation
GPU 141
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep6_tp1 [label="Layer Norm 2
GPU 141
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 142-143)" style="rounded,filled"
		ln1_dp2_ep7_tp0 [label="Layer Norm 1
GPU 142
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep7_tp0 [label="MHA (16 heads)
GPU 142
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep7_tp0 [label="MOE Gate
GPU 142
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep7_tp0 [label="Expert 1 (FC)
GPU 142
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep7_tp0 [label="Expert 2 (FC)
GPU 142
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep7_tp0 [label="Expert Aggregation
GPU 142
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep7_tp0 [label="Layer Norm 2
GPU 142
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp2_ep7_tp1 [label="Layer Norm 1
GPU 143
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp2_ep7_tp1 [label="MHA (16 heads)
GPU 143
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp2_ep7_tp1 [label="MOE Gate
GPU 143
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp2_ep7_tp1 [label="Expert 1 (FC)
GPU 143
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp2_ep7_tp1 [label="Expert 2 (FC)
GPU 143
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp2_ep7_tp1 [label="Expert Aggregation
GPU 143
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp2_ep7_tp1 [label="Layer Norm 2
GPU 143
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage1 {
		fillcolor=lightpink label="Pipeline Stage 1 (Layers 0-7)" style="rounded,filled"
	}
	subgraph cluster_dp_2_stage2_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 144-145)" style="rounded,filled"
		stage2_ln1_dp2_ep0_tp0 [label="Layer Norm 1
GPU 144
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep0_tp0 [label="MHA (16 heads)
GPU 144
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep0_tp0 [label="MOE Gate
GPU 144
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep0_tp0 [label="Expert 1 (FC)
GPU 144
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep0_tp0 [label="Expert 2 (FC)
GPU 144
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep0_tp0 [label="Expert Aggregation
GPU 144
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep0_tp0 [label="Layer Norm 2
GPU 144
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep0_tp1 [label="Layer Norm 1
GPU 145
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep0_tp1 [label="MHA (16 heads)
GPU 145
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep0_tp1 [label="MOE Gate
GPU 145
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep0_tp1 [label="Expert 1 (FC)
GPU 145
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep0_tp1 [label="Expert 2 (FC)
GPU 145
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep0_tp1 [label="Expert Aggregation
GPU 145
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep0_tp1 [label="Layer Norm 2
GPU 145
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 146-147)" style="rounded,filled"
		stage2_ln1_dp2_ep1_tp0 [label="Layer Norm 1
GPU 146
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep1_tp0 [label="MHA (16 heads)
GPU 146
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep1_tp0 [label="MOE Gate
GPU 146
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep1_tp0 [label="Expert 1 (FC)
GPU 146
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep1_tp0 [label="Expert 2 (FC)
GPU 146
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep1_tp0 [label="Expert Aggregation
GPU 146
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep1_tp0 [label="Layer Norm 2
GPU 146
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep1_tp1 [label="Layer Norm 1
GPU 147
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep1_tp1 [label="MHA (16 heads)
GPU 147
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep1_tp1 [label="MOE Gate
GPU 147
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep1_tp1 [label="Expert 1 (FC)
GPU 147
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep1_tp1 [label="Expert 2 (FC)
GPU 147
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep1_tp1 [label="Expert Aggregation
GPU 147
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep1_tp1 [label="Layer Norm 2
GPU 147
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 148-149)" style="rounded,filled"
		stage2_ln1_dp2_ep2_tp0 [label="Layer Norm 1
GPU 148
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep2_tp0 [label="MHA (16 heads)
GPU 148
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep2_tp0 [label="MOE Gate
GPU 148
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep2_tp0 [label="Expert 1 (FC)
GPU 148
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep2_tp0 [label="Expert 2 (FC)
GPU 148
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep2_tp0 [label="Expert Aggregation
GPU 148
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep2_tp0 [label="Layer Norm 2
GPU 148
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep2_tp1 [label="Layer Norm 1
GPU 149
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep2_tp1 [label="MHA (16 heads)
GPU 149
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep2_tp1 [label="MOE Gate
GPU 149
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep2_tp1 [label="Expert 1 (FC)
GPU 149
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep2_tp1 [label="Expert 2 (FC)
GPU 149
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep2_tp1 [label="Expert Aggregation
GPU 149
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep2_tp1 [label="Layer Norm 2
GPU 149
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 150-151)" style="rounded,filled"
		stage2_ln1_dp2_ep3_tp0 [label="Layer Norm 1
GPU 150
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep3_tp0 [label="MHA (16 heads)
GPU 150
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep3_tp0 [label="MOE Gate
GPU 150
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep3_tp0 [label="Expert 1 (FC)
GPU 150
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep3_tp0 [label="Expert 2 (FC)
GPU 150
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep3_tp0 [label="Expert Aggregation
GPU 150
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep3_tp0 [label="Layer Norm 2
GPU 150
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep3_tp1 [label="Layer Norm 1
GPU 151
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep3_tp1 [label="MHA (16 heads)
GPU 151
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep3_tp1 [label="MOE Gate
GPU 151
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep3_tp1 [label="Expert 1 (FC)
GPU 151
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep3_tp1 [label="Expert 2 (FC)
GPU 151
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep3_tp1 [label="Expert Aggregation
GPU 151
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep3_tp1 [label="Layer Norm 2
GPU 151
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 152-153)" style="rounded,filled"
		stage2_ln1_dp2_ep4_tp0 [label="Layer Norm 1
GPU 152
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep4_tp0 [label="MHA (16 heads)
GPU 152
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep4_tp0 [label="MOE Gate
GPU 152
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep4_tp0 [label="Expert 1 (FC)
GPU 152
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep4_tp0 [label="Expert 2 (FC)
GPU 152
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep4_tp0 [label="Expert Aggregation
GPU 152
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep4_tp0 [label="Layer Norm 2
GPU 152
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep4_tp1 [label="Layer Norm 1
GPU 153
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep4_tp1 [label="MHA (16 heads)
GPU 153
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep4_tp1 [label="MOE Gate
GPU 153
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep4_tp1 [label="Expert 1 (FC)
GPU 153
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep4_tp1 [label="Expert 2 (FC)
GPU 153
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep4_tp1 [label="Expert Aggregation
GPU 153
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep4_tp1 [label="Layer Norm 2
GPU 153
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 154-155)" style="rounded,filled"
		stage2_ln1_dp2_ep5_tp0 [label="Layer Norm 1
GPU 154
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep5_tp0 [label="MHA (16 heads)
GPU 154
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep5_tp0 [label="MOE Gate
GPU 154
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep5_tp0 [label="Expert 1 (FC)
GPU 154
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep5_tp0 [label="Expert 2 (FC)
GPU 154
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep5_tp0 [label="Expert Aggregation
GPU 154
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep5_tp0 [label="Layer Norm 2
GPU 154
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep5_tp1 [label="Layer Norm 1
GPU 155
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep5_tp1 [label="MHA (16 heads)
GPU 155
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep5_tp1 [label="MOE Gate
GPU 155
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep5_tp1 [label="Expert 1 (FC)
GPU 155
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep5_tp1 [label="Expert 2 (FC)
GPU 155
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep5_tp1 [label="Expert Aggregation
GPU 155
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep5_tp1 [label="Layer Norm 2
GPU 155
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 156-157)" style="rounded,filled"
		stage2_ln1_dp2_ep6_tp0 [label="Layer Norm 1
GPU 156
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep6_tp0 [label="MHA (16 heads)
GPU 156
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep6_tp0 [label="MOE Gate
GPU 156
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep6_tp0 [label="Expert 1 (FC)
GPU 156
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep6_tp0 [label="Expert 2 (FC)
GPU 156
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep6_tp0 [label="Expert Aggregation
GPU 156
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep6_tp0 [label="Layer Norm 2
GPU 156
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep6_tp1 [label="Layer Norm 1
GPU 157
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep6_tp1 [label="MHA (16 heads)
GPU 157
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep6_tp1 [label="MOE Gate
GPU 157
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep6_tp1 [label="Expert 1 (FC)
GPU 157
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep6_tp1 [label="Expert 2 (FC)
GPU 157
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep6_tp1 [label="Expert Aggregation
GPU 157
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep6_tp1 [label="Layer Norm 2
GPU 157
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 158-159)" style="rounded,filled"
		stage2_ln1_dp2_ep7_tp0 [label="Layer Norm 1
GPU 158
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep7_tp0 [label="MHA (16 heads)
GPU 158
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep7_tp0 [label="MOE Gate
GPU 158
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep7_tp0 [label="Expert 1 (FC)
GPU 158
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep7_tp0 [label="Expert 2 (FC)
GPU 158
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep7_tp0 [label="Expert Aggregation
GPU 158
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep7_tp0 [label="Layer Norm 2
GPU 158
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp2_ep7_tp1 [label="Layer Norm 1
GPU 159
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp2_ep7_tp1 [label="MHA (16 heads)
GPU 159
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp2_ep7_tp1 [label="MOE Gate
GPU 159
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp2_ep7_tp1 [label="Expert 1 (FC)
GPU 159
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp2_ep7_tp1 [label="Expert 2 (FC)
GPU 159
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp2_ep7_tp1 [label="Expert Aggregation
GPU 159
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp2_ep7_tp1 [label="Layer Norm 2
GPU 159
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_2_stage2 {
		fillcolor=lightpink label="Pipeline Stage 2 (Layers 8-15)" style="rounded,filled"
	}
	subgraph cluster_dp_2 {
		fillcolor=lightcyan label="Data Parallel Group 2 (Batch=32)" style="rounded,filled"
	}
	subgraph cluster_dp_3_stage1_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 192-193)" style="rounded,filled"
		ln1_dp3_ep0_tp0 [label="Layer Norm 1
GPU 192
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep0_tp0 [label="MHA (16 heads)
GPU 192
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep0_tp0 [label="MOE Gate
GPU 192
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep0_tp0 [label="Expert 1 (FC)
GPU 192
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep0_tp0 [label="Expert 2 (FC)
GPU 192
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep0_tp0 [label="Expert Aggregation
GPU 192
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep0_tp0 [label="Layer Norm 2
GPU 192
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep0_tp1 [label="Layer Norm 1
GPU 193
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep0_tp1 [label="MHA (16 heads)
GPU 193
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep0_tp1 [label="MOE Gate
GPU 193
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep0_tp1 [label="Expert 1 (FC)
GPU 193
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep0_tp1 [label="Expert 2 (FC)
GPU 193
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep0_tp1 [label="Expert Aggregation
GPU 193
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep0_tp1 [label="Layer Norm 2
GPU 193
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 194-195)" style="rounded,filled"
		ln1_dp3_ep1_tp0 [label="Layer Norm 1
GPU 194
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep1_tp0 [label="MHA (16 heads)
GPU 194
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep1_tp0 [label="MOE Gate
GPU 194
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep1_tp0 [label="Expert 1 (FC)
GPU 194
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep1_tp0 [label="Expert 2 (FC)
GPU 194
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep1_tp0 [label="Expert Aggregation
GPU 194
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep1_tp0 [label="Layer Norm 2
GPU 194
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep1_tp1 [label="Layer Norm 1
GPU 195
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep1_tp1 [label="MHA (16 heads)
GPU 195
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep1_tp1 [label="MOE Gate
GPU 195
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep1_tp1 [label="Expert 1 (FC)
GPU 195
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep1_tp1 [label="Expert 2 (FC)
GPU 195
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep1_tp1 [label="Expert Aggregation
GPU 195
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep1_tp1 [label="Layer Norm 2
GPU 195
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 196-197)" style="rounded,filled"
		ln1_dp3_ep2_tp0 [label="Layer Norm 1
GPU 196
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep2_tp0 [label="MHA (16 heads)
GPU 196
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep2_tp0 [label="MOE Gate
GPU 196
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep2_tp0 [label="Expert 1 (FC)
GPU 196
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep2_tp0 [label="Expert 2 (FC)
GPU 196
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep2_tp0 [label="Expert Aggregation
GPU 196
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep2_tp0 [label="Layer Norm 2
GPU 196
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep2_tp1 [label="Layer Norm 1
GPU 197
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep2_tp1 [label="MHA (16 heads)
GPU 197
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep2_tp1 [label="MOE Gate
GPU 197
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep2_tp1 [label="Expert 1 (FC)
GPU 197
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep2_tp1 [label="Expert 2 (FC)
GPU 197
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep2_tp1 [label="Expert Aggregation
GPU 197
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep2_tp1 [label="Layer Norm 2
GPU 197
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 198-199)" style="rounded,filled"
		ln1_dp3_ep3_tp0 [label="Layer Norm 1
GPU 198
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep3_tp0 [label="MHA (16 heads)
GPU 198
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep3_tp0 [label="MOE Gate
GPU 198
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep3_tp0 [label="Expert 1 (FC)
GPU 198
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep3_tp0 [label="Expert 2 (FC)
GPU 198
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep3_tp0 [label="Expert Aggregation
GPU 198
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep3_tp0 [label="Layer Norm 2
GPU 198
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep3_tp1 [label="Layer Norm 1
GPU 199
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep3_tp1 [label="MHA (16 heads)
GPU 199
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep3_tp1 [label="MOE Gate
GPU 199
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep3_tp1 [label="Expert 1 (FC)
GPU 199
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep3_tp1 [label="Expert 2 (FC)
GPU 199
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep3_tp1 [label="Expert Aggregation
GPU 199
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep3_tp1 [label="Layer Norm 2
GPU 199
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 200-201)" style="rounded,filled"
		ln1_dp3_ep4_tp0 [label="Layer Norm 1
GPU 200
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep4_tp0 [label="MHA (16 heads)
GPU 200
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep4_tp0 [label="MOE Gate
GPU 200
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep4_tp0 [label="Expert 1 (FC)
GPU 200
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep4_tp0 [label="Expert 2 (FC)
GPU 200
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep4_tp0 [label="Expert Aggregation
GPU 200
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep4_tp0 [label="Layer Norm 2
GPU 200
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep4_tp1 [label="Layer Norm 1
GPU 201
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep4_tp1 [label="MHA (16 heads)
GPU 201
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep4_tp1 [label="MOE Gate
GPU 201
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep4_tp1 [label="Expert 1 (FC)
GPU 201
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep4_tp1 [label="Expert 2 (FC)
GPU 201
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep4_tp1 [label="Expert Aggregation
GPU 201
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep4_tp1 [label="Layer Norm 2
GPU 201
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 202-203)" style="rounded,filled"
		ln1_dp3_ep5_tp0 [label="Layer Norm 1
GPU 202
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep5_tp0 [label="MHA (16 heads)
GPU 202
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep5_tp0 [label="MOE Gate
GPU 202
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep5_tp0 [label="Expert 1 (FC)
GPU 202
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep5_tp0 [label="Expert 2 (FC)
GPU 202
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep5_tp0 [label="Expert Aggregation
GPU 202
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep5_tp0 [label="Layer Norm 2
GPU 202
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep5_tp1 [label="Layer Norm 1
GPU 203
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep5_tp1 [label="MHA (16 heads)
GPU 203
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep5_tp1 [label="MOE Gate
GPU 203
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep5_tp1 [label="Expert 1 (FC)
GPU 203
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep5_tp1 [label="Expert 2 (FC)
GPU 203
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep5_tp1 [label="Expert Aggregation
GPU 203
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep5_tp1 [label="Layer Norm 2
GPU 203
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 204-205)" style="rounded,filled"
		ln1_dp3_ep6_tp0 [label="Layer Norm 1
GPU 204
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep6_tp0 [label="MHA (16 heads)
GPU 204
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep6_tp0 [label="MOE Gate
GPU 204
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep6_tp0 [label="Expert 1 (FC)
GPU 204
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep6_tp0 [label="Expert 2 (FC)
GPU 204
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep6_tp0 [label="Expert Aggregation
GPU 204
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep6_tp0 [label="Layer Norm 2
GPU 204
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep6_tp1 [label="Layer Norm 1
GPU 205
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep6_tp1 [label="MHA (16 heads)
GPU 205
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep6_tp1 [label="MOE Gate
GPU 205
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep6_tp1 [label="Expert 1 (FC)
GPU 205
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep6_tp1 [label="Expert 2 (FC)
GPU 205
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep6_tp1 [label="Expert Aggregation
GPU 205
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep6_tp1 [label="Layer Norm 2
GPU 205
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 206-207)" style="rounded,filled"
		ln1_dp3_ep7_tp0 [label="Layer Norm 1
GPU 206
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep7_tp0 [label="MHA (16 heads)
GPU 206
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep7_tp0 [label="MOE Gate
GPU 206
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep7_tp0 [label="Expert 1 (FC)
GPU 206
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep7_tp0 [label="Expert 2 (FC)
GPU 206
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep7_tp0 [label="Expert Aggregation
GPU 206
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep7_tp0 [label="Layer Norm 2
GPU 206
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		ln1_dp3_ep7_tp1 [label="Layer Norm 1
GPU 207
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		mha_dp3_ep7_tp1 [label="MHA (16 heads)
GPU 207
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		moe_gate_dp3_ep7_tp1 [label="MOE Gate
GPU 207
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		expert1_dp3_ep7_tp1 [label="Expert 1 (FC)
GPU 207
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert2_dp3_ep7_tp1 [label="Expert 2 (FC)
GPU 207
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		expert_agg_dp3_ep7_tp1 [label="Expert Aggregation
GPU 207
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		ln2_dp3_ep7_tp1 [label="Layer Norm 2
GPU 207
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage1 {
		fillcolor=lightpink label="Pipeline Stage 1 (Layers 0-7)" style="rounded,filled"
	}
	subgraph cluster_dp_3_stage2_ep_0 {
		fillcolor=lightsteelblue label="Expert Parallel Group 0 (GPU 208-209)" style="rounded,filled"
		stage2_ln1_dp3_ep0_tp0 [label="Layer Norm 1
GPU 208
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep0_tp0 [label="MHA (16 heads)
GPU 208
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep0_tp0 [label="MOE Gate
GPU 208
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep0_tp0 [label="Expert 1 (FC)
GPU 208
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep0_tp0 [label="Expert 2 (FC)
GPU 208
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep0_tp0 [label="Expert Aggregation
GPU 208
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep0_tp0 [label="Layer Norm 2
GPU 208
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep0_tp1 [label="Layer Norm 1
GPU 209
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep0_tp1 [label="MHA (16 heads)
GPU 209
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep0_tp1 [label="MOE Gate
GPU 209
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep0_tp1 [label="Expert 1 (FC)
GPU 209
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep0_tp1 [label="Expert 2 (FC)
GPU 209
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep0_tp1 [label="Expert Aggregation
GPU 209
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep0_tp1 [label="Layer Norm 2
GPU 209
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_1 {
		fillcolor=lightsteelblue label="Expert Parallel Group 1 (GPU 210-211)" style="rounded,filled"
		stage2_ln1_dp3_ep1_tp0 [label="Layer Norm 1
GPU 210
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep1_tp0 [label="MHA (16 heads)
GPU 210
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep1_tp0 [label="MOE Gate
GPU 210
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep1_tp0 [label="Expert 1 (FC)
GPU 210
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep1_tp0 [label="Expert 2 (FC)
GPU 210
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep1_tp0 [label="Expert Aggregation
GPU 210
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep1_tp0 [label="Layer Norm 2
GPU 210
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep1_tp1 [label="Layer Norm 1
GPU 211
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep1_tp1 [label="MHA (16 heads)
GPU 211
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep1_tp1 [label="MOE Gate
GPU 211
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep1_tp1 [label="Expert 1 (FC)
GPU 211
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep1_tp1 [label="Expert 2 (FC)
GPU 211
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep1_tp1 [label="Expert Aggregation
GPU 211
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep1_tp1 [label="Layer Norm 2
GPU 211
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_2 {
		fillcolor=lightsteelblue label="Expert Parallel Group 2 (GPU 212-213)" style="rounded,filled"
		stage2_ln1_dp3_ep2_tp0 [label="Layer Norm 1
GPU 212
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep2_tp0 [label="MHA (16 heads)
GPU 212
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep2_tp0 [label="MOE Gate
GPU 212
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep2_tp0 [label="Expert 1 (FC)
GPU 212
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep2_tp0 [label="Expert 2 (FC)
GPU 212
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep2_tp0 [label="Expert Aggregation
GPU 212
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep2_tp0 [label="Layer Norm 2
GPU 212
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep2_tp1 [label="Layer Norm 1
GPU 213
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep2_tp1 [label="MHA (16 heads)
GPU 213
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep2_tp1 [label="MOE Gate
GPU 213
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep2_tp1 [label="Expert 1 (FC)
GPU 213
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep2_tp1 [label="Expert 2 (FC)
GPU 213
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep2_tp1 [label="Expert Aggregation
GPU 213
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep2_tp1 [label="Layer Norm 2
GPU 213
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_3 {
		fillcolor=lightsteelblue label="Expert Parallel Group 3 (GPU 214-215)" style="rounded,filled"
		stage2_ln1_dp3_ep3_tp0 [label="Layer Norm 1
GPU 214
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep3_tp0 [label="MHA (16 heads)
GPU 214
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep3_tp0 [label="MOE Gate
GPU 214
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep3_tp0 [label="Expert 1 (FC)
GPU 214
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep3_tp0 [label="Expert 2 (FC)
GPU 214
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep3_tp0 [label="Expert Aggregation
GPU 214
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep3_tp0 [label="Layer Norm 2
GPU 214
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep3_tp1 [label="Layer Norm 1
GPU 215
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep3_tp1 [label="MHA (16 heads)
GPU 215
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep3_tp1 [label="MOE Gate
GPU 215
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep3_tp1 [label="Expert 1 (FC)
GPU 215
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep3_tp1 [label="Expert 2 (FC)
GPU 215
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep3_tp1 [label="Expert Aggregation
GPU 215
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep3_tp1 [label="Layer Norm 2
GPU 215
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_4 {
		fillcolor=lightsteelblue label="Expert Parallel Group 4 (GPU 216-217)" style="rounded,filled"
		stage2_ln1_dp3_ep4_tp0 [label="Layer Norm 1
GPU 216
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep4_tp0 [label="MHA (16 heads)
GPU 216
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep4_tp0 [label="MOE Gate
GPU 216
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep4_tp0 [label="Expert 1 (FC)
GPU 216
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep4_tp0 [label="Expert 2 (FC)
GPU 216
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep4_tp0 [label="Expert Aggregation
GPU 216
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep4_tp0 [label="Layer Norm 2
GPU 216
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep4_tp1 [label="Layer Norm 1
GPU 217
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep4_tp1 [label="MHA (16 heads)
GPU 217
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep4_tp1 [label="MOE Gate
GPU 217
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep4_tp1 [label="Expert 1 (FC)
GPU 217
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep4_tp1 [label="Expert 2 (FC)
GPU 217
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep4_tp1 [label="Expert Aggregation
GPU 217
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep4_tp1 [label="Layer Norm 2
GPU 217
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_5 {
		fillcolor=lightsteelblue label="Expert Parallel Group 5 (GPU 218-219)" style="rounded,filled"
		stage2_ln1_dp3_ep5_tp0 [label="Layer Norm 1
GPU 218
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep5_tp0 [label="MHA (16 heads)
GPU 218
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep5_tp0 [label="MOE Gate
GPU 218
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep5_tp0 [label="Expert 1 (FC)
GPU 218
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep5_tp0 [label="Expert 2 (FC)
GPU 218
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep5_tp0 [label="Expert Aggregation
GPU 218
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep5_tp0 [label="Layer Norm 2
GPU 218
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep5_tp1 [label="Layer Norm 1
GPU 219
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep5_tp1 [label="MHA (16 heads)
GPU 219
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep5_tp1 [label="MOE Gate
GPU 219
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep5_tp1 [label="Expert 1 (FC)
GPU 219
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep5_tp1 [label="Expert 2 (FC)
GPU 219
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep5_tp1 [label="Expert Aggregation
GPU 219
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep5_tp1 [label="Layer Norm 2
GPU 219
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_6 {
		fillcolor=lightsteelblue label="Expert Parallel Group 6 (GPU 220-221)" style="rounded,filled"
		stage2_ln1_dp3_ep6_tp0 [label="Layer Norm 1
GPU 220
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep6_tp0 [label="MHA (16 heads)
GPU 220
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep6_tp0 [label="MOE Gate
GPU 220
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep6_tp0 [label="Expert 1 (FC)
GPU 220
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep6_tp0 [label="Expert 2 (FC)
GPU 220
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep6_tp0 [label="Expert Aggregation
GPU 220
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep6_tp0 [label="Layer Norm 2
GPU 220
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep6_tp1 [label="Layer Norm 1
GPU 221
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep6_tp1 [label="MHA (16 heads)
GPU 221
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep6_tp1 [label="MOE Gate
GPU 221
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep6_tp1 [label="Expert 1 (FC)
GPU 221
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep6_tp1 [label="Expert 2 (FC)
GPU 221
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep6_tp1 [label="Expert Aggregation
GPU 221
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep6_tp1 [label="Layer Norm 2
GPU 221
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2_ep_7 {
		fillcolor=lightsteelblue label="Expert Parallel Group 7 (GPU 222-223)" style="rounded,filled"
		stage2_ln1_dp3_ep7_tp0 [label="Layer Norm 1
GPU 222
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep7_tp0 [label="MHA (16 heads)
GPU 222
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep7_tp0 [label="MOE Gate
GPU 222
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep7_tp0 [label="Expert 1 (FC)
GPU 222
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep7_tp0 [label="Expert 2 (FC)
GPU 222
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep7_tp0 [label="Expert Aggregation
GPU 222
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep7_tp0 [label="Layer Norm 2
GPU 222
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_ln1_dp3_ep7_tp1 [label="Layer Norm 1
GPU 223
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_mha_dp3_ep7_tp1 [label="MHA (16 heads)
GPU 223
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
		stage2_moe_gate_dp3_ep7_tp1 [label="MOE Gate
GPU 223
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, experts=2]" fillcolor=lightyellow shape=parallelogram]
		stage2_expert1_dp3_ep7_tp1 [label="Expert 1 (FC)
GPU 223
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert2_dp3_ep7_tp1 [label="Expert 2 (FC)
GPU 223
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=1024]" fillcolor=lightgreen shape=rect]
		stage2_expert_agg_dp3_ep7_tp1 [label="Expert Aggregation
GPU 223
Input: [batch=32, seq=10240, dim=1024]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightyellow shape=parallelogram]
		stage2_ln2_dp3_ep7_tp1 [label="Layer Norm 2
GPU 223
Input: [batch=32, seq=10240, dim=512]
Output: [batch=32, seq=10240, dim=512]" fillcolor=lightgreen shape=rect]
	}
	subgraph cluster_dp_3_stage2 {
		fillcolor=lightpink label="Pipeline Stage 2 (Layers 8-15)" style="rounded,filled"
	}
	subgraph cluster_dp_3 {
		fillcolor=lightcyan label="Data Parallel Group 3 (Batch=32)" style="rounded,filled"
	}
	subgraph cluster_output {
		fillcolor=lightgray label="Output Layer" style="rounded,filled"
		output [label="Output Projection
Input: [batch=128, seq=10240, dim=512]
Output: [batch=128, seq=10240, vocab=50000]" fillcolor=lightgreen shape=rect]
	}
	comm_gate_dp0_ep0_tp0 [label="Gate Communication
GPU 0
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep0_tp0 [label="Expert Output Comm
GPU 0
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep0_tp1 [label="Gate Communication
GPU 1
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep0_tp1 [label="Expert Output Comm
GPU 1
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep1_tp0 [label="Gate Communication
GPU 2
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep1_tp0 [label="Expert Output Comm
GPU 2
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep1_tp1 [label="Gate Communication
GPU 3
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep1_tp1 [label="Expert Output Comm
GPU 3
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep2_tp0 [label="Gate Communication
GPU 4
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep2_tp0 [label="Expert Output Comm
GPU 4
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep2_tp1 [label="Gate Communication
GPU 5
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep2_tp1 [label="Expert Output Comm
GPU 5
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep3_tp0 [label="Gate Communication
GPU 6
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep3_tp0 [label="Expert Output Comm
GPU 6
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep3_tp1 [label="Gate Communication
GPU 7
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep3_tp1 [label="Expert Output Comm
GPU 7
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep4_tp0 [label="Gate Communication
GPU 8
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep4_tp0 [label="Expert Output Comm
GPU 8
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep4_tp1 [label="Gate Communication
GPU 9
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep4_tp1 [label="Expert Output Comm
GPU 9
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep5_tp0 [label="Gate Communication
GPU 10
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep5_tp0 [label="Expert Output Comm
GPU 10
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep5_tp1 [label="Gate Communication
GPU 11
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep5_tp1 [label="Expert Output Comm
GPU 11
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep6_tp0 [label="Gate Communication
GPU 12
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep6_tp0 [label="Expert Output Comm
GPU 12
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep6_tp1 [label="Gate Communication
GPU 13
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep6_tp1 [label="Expert Output Comm
GPU 13
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep7_tp0 [label="Gate Communication
GPU 14
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep7_tp0 [label="Expert Output Comm
GPU 14
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp0_ep7_tp1 [label="Gate Communication
GPU 15
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp0_ep7_tp1 [label="Expert Output Comm
GPU 15
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep0_tp0 [label="Gate Communication
GPU 64
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep0_tp0 [label="Expert Output Comm
GPU 64
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep0_tp1 [label="Gate Communication
GPU 65
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep0_tp1 [label="Expert Output Comm
GPU 65
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep1_tp0 [label="Gate Communication
GPU 66
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep1_tp0 [label="Expert Output Comm
GPU 66
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep1_tp1 [label="Gate Communication
GPU 67
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep1_tp1 [label="Expert Output Comm
GPU 67
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep2_tp0 [label="Gate Communication
GPU 68
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep2_tp0 [label="Expert Output Comm
GPU 68
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep2_tp1 [label="Gate Communication
GPU 69
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep2_tp1 [label="Expert Output Comm
GPU 69
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep3_tp0 [label="Gate Communication
GPU 70
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep3_tp0 [label="Expert Output Comm
GPU 70
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep3_tp1 [label="Gate Communication
GPU 71
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep3_tp1 [label="Expert Output Comm
GPU 71
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep4_tp0 [label="Gate Communication
GPU 72
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep4_tp0 [label="Expert Output Comm
GPU 72
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep4_tp1 [label="Gate Communication
GPU 73
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep4_tp1 [label="Expert Output Comm
GPU 73
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep5_tp0 [label="Gate Communication
GPU 74
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep5_tp0 [label="Expert Output Comm
GPU 74
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep5_tp1 [label="Gate Communication
GPU 75
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep5_tp1 [label="Expert Output Comm
GPU 75
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep6_tp0 [label="Gate Communication
GPU 76
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep6_tp0 [label="Expert Output Comm
GPU 76
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep6_tp1 [label="Gate Communication
GPU 77
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep6_tp1 [label="Expert Output Comm
GPU 77
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep7_tp0 [label="Gate Communication
GPU 78
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep7_tp0 [label="Expert Output Comm
GPU 78
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp1_ep7_tp1 [label="Gate Communication
GPU 79
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp1_ep7_tp1 [label="Expert Output Comm
GPU 79
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep0_tp0 [label="Gate Communication
GPU 128
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep0_tp0 [label="Expert Output Comm
GPU 128
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep0_tp1 [label="Gate Communication
GPU 129
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep0_tp1 [label="Expert Output Comm
GPU 129
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep1_tp0 [label="Gate Communication
GPU 130
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep1_tp0 [label="Expert Output Comm
GPU 130
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep1_tp1 [label="Gate Communication
GPU 131
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep1_tp1 [label="Expert Output Comm
GPU 131
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep2_tp0 [label="Gate Communication
GPU 132
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep2_tp0 [label="Expert Output Comm
GPU 132
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep2_tp1 [label="Gate Communication
GPU 133
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep2_tp1 [label="Expert Output Comm
GPU 133
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep3_tp0 [label="Gate Communication
GPU 134
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep3_tp0 [label="Expert Output Comm
GPU 134
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep3_tp1 [label="Gate Communication
GPU 135
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep3_tp1 [label="Expert Output Comm
GPU 135
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep4_tp0 [label="Gate Communication
GPU 136
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep4_tp0 [label="Expert Output Comm
GPU 136
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep4_tp1 [label="Gate Communication
GPU 137
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep4_tp1 [label="Expert Output Comm
GPU 137
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep5_tp0 [label="Gate Communication
GPU 138
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep5_tp0 [label="Expert Output Comm
GPU 138
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep5_tp1 [label="Gate Communication
GPU 139
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep5_tp1 [label="Expert Output Comm
GPU 139
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep6_tp0 [label="Gate Communication
GPU 140
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep6_tp0 [label="Expert Output Comm
GPU 140
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep6_tp1 [label="Gate Communication
GPU 141
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep6_tp1 [label="Expert Output Comm
GPU 141
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep7_tp0 [label="Gate Communication
GPU 142
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep7_tp0 [label="Expert Output Comm
GPU 142
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp2_ep7_tp1 [label="Gate Communication
GPU 143
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp2_ep7_tp1 [label="Expert Output Comm
GPU 143
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep0_tp0 [label="Gate Communication
GPU 192
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep0_tp0 [label="Expert Output Comm
GPU 192
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep0_tp1 [label="Gate Communication
GPU 193
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep0_tp1 [label="Expert Output Comm
GPU 193
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep1_tp0 [label="Gate Communication
GPU 194
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep1_tp0 [label="Expert Output Comm
GPU 194
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep1_tp1 [label="Gate Communication
GPU 195
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep1_tp1 [label="Expert Output Comm
GPU 195
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep2_tp0 [label="Gate Communication
GPU 196
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep2_tp0 [label="Expert Output Comm
GPU 196
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep2_tp1 [label="Gate Communication
GPU 197
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep2_tp1 [label="Expert Output Comm
GPU 197
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep3_tp0 [label="Gate Communication
GPU 198
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep3_tp0 [label="Expert Output Comm
GPU 198
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep3_tp1 [label="Gate Communication
GPU 199
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep3_tp1 [label="Expert Output Comm
GPU 199
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep4_tp0 [label="Gate Communication
GPU 200
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep4_tp0 [label="Expert Output Comm
GPU 200
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep4_tp1 [label="Gate Communication
GPU 201
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep4_tp1 [label="Expert Output Comm
GPU 201
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep5_tp0 [label="Gate Communication
GPU 202
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep5_tp0 [label="Expert Output Comm
GPU 202
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep5_tp1 [label="Gate Communication
GPU 203
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep5_tp1 [label="Expert Output Comm
GPU 203
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep6_tp0 [label="Gate Communication
GPU 204
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep6_tp0 [label="Expert Output Comm
GPU 204
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep6_tp1 [label="Gate Communication
GPU 205
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep6_tp1 [label="Expert Output Comm
GPU 205
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep7_tp0 [label="Gate Communication
GPU 206
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep7_tp0 [label="Expert Output Comm
GPU 206
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_gate_dp3_ep7_tp1 [label="Gate Communication
GPU 207
Expert Selection Routing" fillcolor=lightblue shape=ellipse style=dashed]
	comm_expert_dp3_ep7_tp1 [label="Expert Output Comm
GPU 207
Aggregation Communication" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep0_tp0 [label="Pipeline Comm
GPU 016
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep0_tp1 [label="Pipeline Comm
GPU 117
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep1_tp0 [label="Pipeline Comm
GPU 218
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep1_tp1 [label="Pipeline Comm
GPU 319
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep2_tp0 [label="Pipeline Comm
GPU 420
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep2_tp1 [label="Pipeline Comm
GPU 521
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep3_tp0 [label="Pipeline Comm
GPU 622
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep3_tp1 [label="Pipeline Comm
GPU 723
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep4_tp0 [label="Pipeline Comm
GPU 824
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep4_tp1 [label="Pipeline Comm
GPU 925
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep5_tp0 [label="Pipeline Comm
GPU 1026
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep5_tp1 [label="Pipeline Comm
GPU 1127
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep6_tp0 [label="Pipeline Comm
GPU 1228
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep6_tp1 [label="Pipeline Comm
GPU 1329
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep7_tp0 [label="Pipeline Comm
GPU 1430
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp0_ep7_tp1 [label="Pipeline Comm
GPU 1531
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep0_tp0 [label="Pipeline Comm
GPU 6480
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep0_tp1 [label="Pipeline Comm
GPU 6581
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep1_tp0 [label="Pipeline Comm
GPU 6682
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep1_tp1 [label="Pipeline Comm
GPU 6783
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep2_tp0 [label="Pipeline Comm
GPU 6884
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep2_tp1 [label="Pipeline Comm
GPU 6985
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep3_tp0 [label="Pipeline Comm
GPU 7086
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep3_tp1 [label="Pipeline Comm
GPU 7187
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep4_tp0 [label="Pipeline Comm
GPU 7288
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep4_tp1 [label="Pipeline Comm
GPU 7389
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep5_tp0 [label="Pipeline Comm
GPU 7490
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep5_tp1 [label="Pipeline Comm
GPU 7591
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep6_tp0 [label="Pipeline Comm
GPU 7692
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep6_tp1 [label="Pipeline Comm
GPU 7793
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep7_tp0 [label="Pipeline Comm
GPU 7894
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp1_ep7_tp1 [label="Pipeline Comm
GPU 7995
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep0_tp0 [label="Pipeline Comm
GPU 128144
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep0_tp1 [label="Pipeline Comm
GPU 129145
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep1_tp0 [label="Pipeline Comm
GPU 130146
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep1_tp1 [label="Pipeline Comm
GPU 131147
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep2_tp0 [label="Pipeline Comm
GPU 132148
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep2_tp1 [label="Pipeline Comm
GPU 133149
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep3_tp0 [label="Pipeline Comm
GPU 134150
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep3_tp1 [label="Pipeline Comm
GPU 135151
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep4_tp0 [label="Pipeline Comm
GPU 136152
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep4_tp1 [label="Pipeline Comm
GPU 137153
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep5_tp0 [label="Pipeline Comm
GPU 138154
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep5_tp1 [label="Pipeline Comm
GPU 139155
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep6_tp0 [label="Pipeline Comm
GPU 140156
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep6_tp1 [label="Pipeline Comm
GPU 141157
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep7_tp0 [label="Pipeline Comm
GPU 142158
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp2_ep7_tp1 [label="Pipeline Comm
GPU 143159
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep0_tp0 [label="Pipeline Comm
GPU 192208
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep0_tp1 [label="Pipeline Comm
GPU 193209
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep1_tp0 [label="Pipeline Comm
GPU 194210
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep1_tp1 [label="Pipeline Comm
GPU 195211
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep2_tp0 [label="Pipeline Comm
GPU 196212
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep2_tp1 [label="Pipeline Comm
GPU 197213
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep3_tp0 [label="Pipeline Comm
GPU 198214
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep3_tp1 [label="Pipeline Comm
GPU 199215
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep4_tp0 [label="Pipeline Comm
GPU 200216
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep4_tp1 [label="Pipeline Comm
GPU 201217
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep5_tp0 [label="Pipeline Comm
GPU 202218
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep5_tp1 [label="Pipeline Comm
GPU 203219
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep6_tp0 [label="Pipeline Comm
GPU 204220
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep6_tp1 [label="Pipeline Comm
GPU 205221
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep7_tp0 [label="Pipeline Comm
GPU 206222
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	comm_pipeline_dp3_ep7_tp1 [label="Pipeline Comm
GPU 207223
Stage 12 Transfer" fillcolor=lightblue shape=ellipse]
	input -> ln1_dp0_ep0_tp0 [label="batch=12832x4"]
	ln1_dp0_ep0_tp0 -> mha_dp0_ep0_tp0
	mha_dp0_ep0_tp0 -> moe_gate_dp0_ep0_tp0
	moe_gate_dp0_ep0_tp0 -> expert1_dp0_ep0_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep0_tp0 -> expert2_dp0_ep0_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep0_tp0 -> expert_agg_dp0_ep0_tp0
	expert2_dp0_ep0_tp0 -> expert_agg_dp0_ep0_tp0
	expert_agg_dp0_ep0_tp0 -> ln2_dp0_ep0_tp0
	ln2_dp0_ep0_tp0 -> ln1_dp0_ep1_tp0
	ln1_dp0_ep0_tp1 -> mha_dp0_ep0_tp1
	mha_dp0_ep0_tp1 -> moe_gate_dp0_ep0_tp1
	moe_gate_dp0_ep0_tp1 -> expert1_dp0_ep0_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep0_tp1 -> expert2_dp0_ep0_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep0_tp1 -> expert_agg_dp0_ep0_tp1
	expert2_dp0_ep0_tp1 -> expert_agg_dp0_ep0_tp1
	expert_agg_dp0_ep0_tp1 -> ln2_dp0_ep0_tp1
	ln2_dp0_ep0_tp1 -> ln1_dp0_ep1_tp1
	ln1_dp0_ep1_tp0 -> mha_dp0_ep1_tp0
	mha_dp0_ep1_tp0 -> moe_gate_dp0_ep1_tp0
	moe_gate_dp0_ep1_tp0 -> expert1_dp0_ep1_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep1_tp0 -> expert2_dp0_ep1_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep1_tp0 -> expert_agg_dp0_ep1_tp0
	expert2_dp0_ep1_tp0 -> expert_agg_dp0_ep1_tp0
	expert_agg_dp0_ep1_tp0 -> ln2_dp0_ep1_tp0
	ln2_dp0_ep1_tp0 -> ln1_dp0_ep2_tp0
	ln1_dp0_ep1_tp1 -> mha_dp0_ep1_tp1
	mha_dp0_ep1_tp1 -> moe_gate_dp0_ep1_tp1
	moe_gate_dp0_ep1_tp1 -> expert1_dp0_ep1_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep1_tp1 -> expert2_dp0_ep1_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep1_tp1 -> expert_agg_dp0_ep1_tp1
	expert2_dp0_ep1_tp1 -> expert_agg_dp0_ep1_tp1
	expert_agg_dp0_ep1_tp1 -> ln2_dp0_ep1_tp1
	ln2_dp0_ep1_tp1 -> ln1_dp0_ep2_tp1
	ln1_dp0_ep2_tp0 -> mha_dp0_ep2_tp0
	mha_dp0_ep2_tp0 -> moe_gate_dp0_ep2_tp0
	moe_gate_dp0_ep2_tp0 -> expert1_dp0_ep2_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep2_tp0 -> expert2_dp0_ep2_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep2_tp0 -> expert_agg_dp0_ep2_tp0
	expert2_dp0_ep2_tp0 -> expert_agg_dp0_ep2_tp0
	expert_agg_dp0_ep2_tp0 -> ln2_dp0_ep2_tp0
	ln2_dp0_ep2_tp0 -> ln1_dp0_ep3_tp0
	ln1_dp0_ep2_tp1 -> mha_dp0_ep2_tp1
	mha_dp0_ep2_tp1 -> moe_gate_dp0_ep2_tp1
	moe_gate_dp0_ep2_tp1 -> expert1_dp0_ep2_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep2_tp1 -> expert2_dp0_ep2_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep2_tp1 -> expert_agg_dp0_ep2_tp1
	expert2_dp0_ep2_tp1 -> expert_agg_dp0_ep2_tp1
	expert_agg_dp0_ep2_tp1 -> ln2_dp0_ep2_tp1
	ln2_dp0_ep2_tp1 -> ln1_dp0_ep3_tp1
	ln1_dp0_ep3_tp0 -> mha_dp0_ep3_tp0
	mha_dp0_ep3_tp0 -> moe_gate_dp0_ep3_tp0
	moe_gate_dp0_ep3_tp0 -> expert1_dp0_ep3_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep3_tp0 -> expert2_dp0_ep3_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep3_tp0 -> expert_agg_dp0_ep3_tp0
	expert2_dp0_ep3_tp0 -> expert_agg_dp0_ep3_tp0
	expert_agg_dp0_ep3_tp0 -> ln2_dp0_ep3_tp0
	ln2_dp0_ep3_tp0 -> ln1_dp0_ep4_tp0
	ln1_dp0_ep3_tp1 -> mha_dp0_ep3_tp1
	mha_dp0_ep3_tp1 -> moe_gate_dp0_ep3_tp1
	moe_gate_dp0_ep3_tp1 -> expert1_dp0_ep3_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep3_tp1 -> expert2_dp0_ep3_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep3_tp1 -> expert_agg_dp0_ep3_tp1
	expert2_dp0_ep3_tp1 -> expert_agg_dp0_ep3_tp1
	expert_agg_dp0_ep3_tp1 -> ln2_dp0_ep3_tp1
	ln2_dp0_ep3_tp1 -> ln1_dp0_ep4_tp1
	ln1_dp0_ep4_tp0 -> mha_dp0_ep4_tp0
	mha_dp0_ep4_tp0 -> moe_gate_dp0_ep4_tp0
	moe_gate_dp0_ep4_tp0 -> expert1_dp0_ep4_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep4_tp0 -> expert2_dp0_ep4_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep4_tp0 -> expert_agg_dp0_ep4_tp0
	expert2_dp0_ep4_tp0 -> expert_agg_dp0_ep4_tp0
	expert_agg_dp0_ep4_tp0 -> ln2_dp0_ep4_tp0
	ln2_dp0_ep4_tp0 -> ln1_dp0_ep5_tp0
	ln1_dp0_ep4_tp1 -> mha_dp0_ep4_tp1
	mha_dp0_ep4_tp1 -> moe_gate_dp0_ep4_tp1
	moe_gate_dp0_ep4_tp1 -> expert1_dp0_ep4_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep4_tp1 -> expert2_dp0_ep4_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep4_tp1 -> expert_agg_dp0_ep4_tp1
	expert2_dp0_ep4_tp1 -> expert_agg_dp0_ep4_tp1
	expert_agg_dp0_ep4_tp1 -> ln2_dp0_ep4_tp1
	ln2_dp0_ep4_tp1 -> ln1_dp0_ep5_tp1
	ln1_dp0_ep5_tp0 -> mha_dp0_ep5_tp0
	mha_dp0_ep5_tp0 -> moe_gate_dp0_ep5_tp0
	moe_gate_dp0_ep5_tp0 -> expert1_dp0_ep5_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep5_tp0 -> expert2_dp0_ep5_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep5_tp0 -> expert_agg_dp0_ep5_tp0
	expert2_dp0_ep5_tp0 -> expert_agg_dp0_ep5_tp0
	expert_agg_dp0_ep5_tp0 -> ln2_dp0_ep5_tp0
	ln2_dp0_ep5_tp0 -> ln1_dp0_ep6_tp0
	ln1_dp0_ep5_tp1 -> mha_dp0_ep5_tp1
	mha_dp0_ep5_tp1 -> moe_gate_dp0_ep5_tp1
	moe_gate_dp0_ep5_tp1 -> expert1_dp0_ep5_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep5_tp1 -> expert2_dp0_ep5_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep5_tp1 -> expert_agg_dp0_ep5_tp1
	expert2_dp0_ep5_tp1 -> expert_agg_dp0_ep5_tp1
	expert_agg_dp0_ep5_tp1 -> ln2_dp0_ep5_tp1
	ln2_dp0_ep5_tp1 -> ln1_dp0_ep6_tp1
	ln1_dp0_ep6_tp0 -> mha_dp0_ep6_tp0
	mha_dp0_ep6_tp0 -> moe_gate_dp0_ep6_tp0
	moe_gate_dp0_ep6_tp0 -> expert1_dp0_ep6_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep6_tp0 -> expert2_dp0_ep6_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep6_tp0 -> expert_agg_dp0_ep6_tp0
	expert2_dp0_ep6_tp0 -> expert_agg_dp0_ep6_tp0
	expert_agg_dp0_ep6_tp0 -> ln2_dp0_ep6_tp0
	ln2_dp0_ep6_tp0 -> ln1_dp0_ep7_tp0
	ln1_dp0_ep6_tp1 -> mha_dp0_ep6_tp1
	mha_dp0_ep6_tp1 -> moe_gate_dp0_ep6_tp1
	moe_gate_dp0_ep6_tp1 -> expert1_dp0_ep6_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep6_tp1 -> expert2_dp0_ep6_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep6_tp1 -> expert_agg_dp0_ep6_tp1
	expert2_dp0_ep6_tp1 -> expert_agg_dp0_ep6_tp1
	expert_agg_dp0_ep6_tp1 -> ln2_dp0_ep6_tp1
	ln2_dp0_ep6_tp1 -> ln1_dp0_ep7_tp1
	ln1_dp0_ep7_tp0 -> mha_dp0_ep7_tp0
	mha_dp0_ep7_tp0 -> moe_gate_dp0_ep7_tp0
	moe_gate_dp0_ep7_tp0 -> expert1_dp0_ep7_tp0 [label="expert selection" style=dashed]
	moe_gate_dp0_ep7_tp0 -> expert2_dp0_ep7_tp0 [label="expert selection" style=dashed]
	expert1_dp0_ep7_tp0 -> expert_agg_dp0_ep7_tp0
	expert2_dp0_ep7_tp0 -> expert_agg_dp0_ep7_tp0
	expert_agg_dp0_ep7_tp0 -> ln2_dp0_ep7_tp0
	ln2_dp0_ep7_tp0 -> comm_pipeline_dp0_ep7_tp0
	comm_pipeline_dp0_ep7_tp0 -> stage2_ln1_dp0_ep7_tp0
	ln1_dp0_ep7_tp1 -> mha_dp0_ep7_tp1
	mha_dp0_ep7_tp1 -> moe_gate_dp0_ep7_tp1
	moe_gate_dp0_ep7_tp1 -> expert1_dp0_ep7_tp1 [label="expert selection" style=dashed]
	moe_gate_dp0_ep7_tp1 -> expert2_dp0_ep7_tp1 [label="expert selection" style=dashed]
	expert1_dp0_ep7_tp1 -> expert_agg_dp0_ep7_tp1
	expert2_dp0_ep7_tp1 -> expert_agg_dp0_ep7_tp1
	expert_agg_dp0_ep7_tp1 -> ln2_dp0_ep7_tp1
	ln2_dp0_ep7_tp1 -> comm_pipeline_dp0_ep7_tp1
	comm_pipeline_dp0_ep7_tp1 -> stage2_ln1_dp0_ep7_tp1
	stage2_ln1_dp0_ep0_tp0 -> stage2_mha_dp0_ep0_tp0
	stage2_mha_dp0_ep0_tp0 -> stage2_moe_gate_dp0_ep0_tp0
	stage2_moe_gate_dp0_ep0_tp0 -> stage2_expert1_dp0_ep0_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep0_tp0 -> stage2_expert2_dp0_ep0_tp0 [style=dashed]
	stage2_expert1_dp0_ep0_tp0 -> stage2_expert_agg_dp0_ep0_tp0
	stage2_expert2_dp0_ep0_tp0 -> stage2_expert_agg_dp0_ep0_tp0
	stage2_expert_agg_dp0_ep0_tp0 -> stage2_ln2_dp0_ep0_tp0
	stage2_ln2_dp0_ep0_tp0 -> stage2_ln1_dp0_ep1_tp0
	stage2_ln1_dp0_ep0_tp1 -> stage2_mha_dp0_ep0_tp1
	stage2_mha_dp0_ep0_tp1 -> stage2_moe_gate_dp0_ep0_tp1
	stage2_moe_gate_dp0_ep0_tp1 -> stage2_expert1_dp0_ep0_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep0_tp1 -> stage2_expert2_dp0_ep0_tp1 [style=dashed]
	stage2_expert1_dp0_ep0_tp1 -> stage2_expert_agg_dp0_ep0_tp1
	stage2_expert2_dp0_ep0_tp1 -> stage2_expert_agg_dp0_ep0_tp1
	stage2_expert_agg_dp0_ep0_tp1 -> stage2_ln2_dp0_ep0_tp1
	stage2_ln2_dp0_ep0_tp1 -> stage2_ln1_dp0_ep1_tp1
	stage2_ln1_dp0_ep1_tp0 -> stage2_mha_dp0_ep1_tp0
	stage2_mha_dp0_ep1_tp0 -> stage2_moe_gate_dp0_ep1_tp0
	stage2_moe_gate_dp0_ep1_tp0 -> stage2_expert1_dp0_ep1_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep1_tp0 -> stage2_expert2_dp0_ep1_tp0 [style=dashed]
	stage2_expert1_dp0_ep1_tp0 -> stage2_expert_agg_dp0_ep1_tp0
	stage2_expert2_dp0_ep1_tp0 -> stage2_expert_agg_dp0_ep1_tp0
	stage2_expert_agg_dp0_ep1_tp0 -> stage2_ln2_dp0_ep1_tp0
	stage2_ln2_dp0_ep1_tp0 -> stage2_ln1_dp0_ep2_tp0
	stage2_ln1_dp0_ep1_tp1 -> stage2_mha_dp0_ep1_tp1
	stage2_mha_dp0_ep1_tp1 -> stage2_moe_gate_dp0_ep1_tp1
	stage2_moe_gate_dp0_ep1_tp1 -> stage2_expert1_dp0_ep1_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep1_tp1 -> stage2_expert2_dp0_ep1_tp1 [style=dashed]
	stage2_expert1_dp0_ep1_tp1 -> stage2_expert_agg_dp0_ep1_tp1
	stage2_expert2_dp0_ep1_tp1 -> stage2_expert_agg_dp0_ep1_tp1
	stage2_expert_agg_dp0_ep1_tp1 -> stage2_ln2_dp0_ep1_tp1
	stage2_ln2_dp0_ep1_tp1 -> stage2_ln1_dp0_ep2_tp1
	stage2_ln1_dp0_ep2_tp0 -> stage2_mha_dp0_ep2_tp0
	stage2_mha_dp0_ep2_tp0 -> stage2_moe_gate_dp0_ep2_tp0
	stage2_moe_gate_dp0_ep2_tp0 -> stage2_expert1_dp0_ep2_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep2_tp0 -> stage2_expert2_dp0_ep2_tp0 [style=dashed]
	stage2_expert1_dp0_ep2_tp0 -> stage2_expert_agg_dp0_ep2_tp0
	stage2_expert2_dp0_ep2_tp0 -> stage2_expert_agg_dp0_ep2_tp0
	stage2_expert_agg_dp0_ep2_tp0 -> stage2_ln2_dp0_ep2_tp0
	stage2_ln2_dp0_ep2_tp0 -> stage2_ln1_dp0_ep3_tp0
	stage2_ln1_dp0_ep2_tp1 -> stage2_mha_dp0_ep2_tp1
	stage2_mha_dp0_ep2_tp1 -> stage2_moe_gate_dp0_ep2_tp1
	stage2_moe_gate_dp0_ep2_tp1 -> stage2_expert1_dp0_ep2_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep2_tp1 -> stage2_expert2_dp0_ep2_tp1 [style=dashed]
	stage2_expert1_dp0_ep2_tp1 -> stage2_expert_agg_dp0_ep2_tp1
	stage2_expert2_dp0_ep2_tp1 -> stage2_expert_agg_dp0_ep2_tp1
	stage2_expert_agg_dp0_ep2_tp1 -> stage2_ln2_dp0_ep2_tp1
	stage2_ln2_dp0_ep2_tp1 -> stage2_ln1_dp0_ep3_tp1
	stage2_ln1_dp0_ep3_tp0 -> stage2_mha_dp0_ep3_tp0
	stage2_mha_dp0_ep3_tp0 -> stage2_moe_gate_dp0_ep3_tp0
	stage2_moe_gate_dp0_ep3_tp0 -> stage2_expert1_dp0_ep3_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep3_tp0 -> stage2_expert2_dp0_ep3_tp0 [style=dashed]
	stage2_expert1_dp0_ep3_tp0 -> stage2_expert_agg_dp0_ep3_tp0
	stage2_expert2_dp0_ep3_tp0 -> stage2_expert_agg_dp0_ep3_tp0
	stage2_expert_agg_dp0_ep3_tp0 -> stage2_ln2_dp0_ep3_tp0
	stage2_ln2_dp0_ep3_tp0 -> stage2_ln1_dp0_ep4_tp0
	stage2_ln1_dp0_ep3_tp1 -> stage2_mha_dp0_ep3_tp1
	stage2_mha_dp0_ep3_tp1 -> stage2_moe_gate_dp0_ep3_tp1
	stage2_moe_gate_dp0_ep3_tp1 -> stage2_expert1_dp0_ep3_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep3_tp1 -> stage2_expert2_dp0_ep3_tp1 [style=dashed]
	stage2_expert1_dp0_ep3_tp1 -> stage2_expert_agg_dp0_ep3_tp1
	stage2_expert2_dp0_ep3_tp1 -> stage2_expert_agg_dp0_ep3_tp1
	stage2_expert_agg_dp0_ep3_tp1 -> stage2_ln2_dp0_ep3_tp1
	stage2_ln2_dp0_ep3_tp1 -> stage2_ln1_dp0_ep4_tp1
	stage2_ln1_dp0_ep4_tp0 -> stage2_mha_dp0_ep4_tp0
	stage2_mha_dp0_ep4_tp0 -> stage2_moe_gate_dp0_ep4_tp0
	stage2_moe_gate_dp0_ep4_tp0 -> stage2_expert1_dp0_ep4_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep4_tp0 -> stage2_expert2_dp0_ep4_tp0 [style=dashed]
	stage2_expert1_dp0_ep4_tp0 -> stage2_expert_agg_dp0_ep4_tp0
	stage2_expert2_dp0_ep4_tp0 -> stage2_expert_agg_dp0_ep4_tp0
	stage2_expert_agg_dp0_ep4_tp0 -> stage2_ln2_dp0_ep4_tp0
	stage2_ln2_dp0_ep4_tp0 -> stage2_ln1_dp0_ep5_tp0
	stage2_ln1_dp0_ep4_tp1 -> stage2_mha_dp0_ep4_tp1
	stage2_mha_dp0_ep4_tp1 -> stage2_moe_gate_dp0_ep4_tp1
	stage2_moe_gate_dp0_ep4_tp1 -> stage2_expert1_dp0_ep4_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep4_tp1 -> stage2_expert2_dp0_ep4_tp1 [style=dashed]
	stage2_expert1_dp0_ep4_tp1 -> stage2_expert_agg_dp0_ep4_tp1
	stage2_expert2_dp0_ep4_tp1 -> stage2_expert_agg_dp0_ep4_tp1
	stage2_expert_agg_dp0_ep4_tp1 -> stage2_ln2_dp0_ep4_tp1
	stage2_ln2_dp0_ep4_tp1 -> stage2_ln1_dp0_ep5_tp1
	stage2_ln1_dp0_ep5_tp0 -> stage2_mha_dp0_ep5_tp0
	stage2_mha_dp0_ep5_tp0 -> stage2_moe_gate_dp0_ep5_tp0
	stage2_moe_gate_dp0_ep5_tp0 -> stage2_expert1_dp0_ep5_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep5_tp0 -> stage2_expert2_dp0_ep5_tp0 [style=dashed]
	stage2_expert1_dp0_ep5_tp0 -> stage2_expert_agg_dp0_ep5_tp0
	stage2_expert2_dp0_ep5_tp0 -> stage2_expert_agg_dp0_ep5_tp0
	stage2_expert_agg_dp0_ep5_tp0 -> stage2_ln2_dp0_ep5_tp0
	stage2_ln2_dp0_ep5_tp0 -> stage2_ln1_dp0_ep6_tp0
	stage2_ln1_dp0_ep5_tp1 -> stage2_mha_dp0_ep5_tp1
	stage2_mha_dp0_ep5_tp1 -> stage2_moe_gate_dp0_ep5_tp1
	stage2_moe_gate_dp0_ep5_tp1 -> stage2_expert1_dp0_ep5_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep5_tp1 -> stage2_expert2_dp0_ep5_tp1 [style=dashed]
	stage2_expert1_dp0_ep5_tp1 -> stage2_expert_agg_dp0_ep5_tp1
	stage2_expert2_dp0_ep5_tp1 -> stage2_expert_agg_dp0_ep5_tp1
	stage2_expert_agg_dp0_ep5_tp1 -> stage2_ln2_dp0_ep5_tp1
	stage2_ln2_dp0_ep5_tp1 -> stage2_ln1_dp0_ep6_tp1
	stage2_ln1_dp0_ep6_tp0 -> stage2_mha_dp0_ep6_tp0
	stage2_mha_dp0_ep6_tp0 -> stage2_moe_gate_dp0_ep6_tp0
	stage2_moe_gate_dp0_ep6_tp0 -> stage2_expert1_dp0_ep6_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep6_tp0 -> stage2_expert2_dp0_ep6_tp0 [style=dashed]
	stage2_expert1_dp0_ep6_tp0 -> stage2_expert_agg_dp0_ep6_tp0
	stage2_expert2_dp0_ep6_tp0 -> stage2_expert_agg_dp0_ep6_tp0
	stage2_expert_agg_dp0_ep6_tp0 -> stage2_ln2_dp0_ep6_tp0
	stage2_ln2_dp0_ep6_tp0 -> stage2_ln1_dp0_ep7_tp0
	stage2_ln1_dp0_ep6_tp1 -> stage2_mha_dp0_ep6_tp1
	stage2_mha_dp0_ep6_tp1 -> stage2_moe_gate_dp0_ep6_tp1
	stage2_moe_gate_dp0_ep6_tp1 -> stage2_expert1_dp0_ep6_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep6_tp1 -> stage2_expert2_dp0_ep6_tp1 [style=dashed]
	stage2_expert1_dp0_ep6_tp1 -> stage2_expert_agg_dp0_ep6_tp1
	stage2_expert2_dp0_ep6_tp1 -> stage2_expert_agg_dp0_ep6_tp1
	stage2_expert_agg_dp0_ep6_tp1 -> stage2_ln2_dp0_ep6_tp1
	stage2_ln2_dp0_ep6_tp1 -> stage2_ln1_dp0_ep7_tp1
	stage2_ln1_dp0_ep7_tp0 -> stage2_mha_dp0_ep7_tp0
	stage2_mha_dp0_ep7_tp0 -> stage2_moe_gate_dp0_ep7_tp0
	stage2_moe_gate_dp0_ep7_tp0 -> stage2_expert1_dp0_ep7_tp0 [style=dashed]
	stage2_moe_gate_dp0_ep7_tp0 -> stage2_expert2_dp0_ep7_tp0 [style=dashed]
	stage2_expert1_dp0_ep7_tp0 -> stage2_expert_agg_dp0_ep7_tp0
	stage2_expert2_dp0_ep7_tp0 -> stage2_expert_agg_dp0_ep7_tp0
	stage2_expert_agg_dp0_ep7_tp0 -> stage2_ln2_dp0_ep7_tp0
	stage2_ln2_dp0_ep7_tp0 -> stage2_ln1_dp1_ep0_tp0
	stage2_ln1_dp0_ep7_tp1 -> stage2_mha_dp0_ep7_tp1
	stage2_mha_dp0_ep7_tp1 -> stage2_moe_gate_dp0_ep7_tp1
	stage2_moe_gate_dp0_ep7_tp1 -> stage2_expert1_dp0_ep7_tp1 [style=dashed]
	stage2_moe_gate_dp0_ep7_tp1 -> stage2_expert2_dp0_ep7_tp1 [style=dashed]
	stage2_expert1_dp0_ep7_tp1 -> stage2_expert_agg_dp0_ep7_tp1
	stage2_expert2_dp0_ep7_tp1 -> stage2_expert_agg_dp0_ep7_tp1
	stage2_expert_agg_dp0_ep7_tp1 -> stage2_ln2_dp0_ep7_tp1
	stage2_ln2_dp0_ep7_tp1 -> stage2_ln1_dp1_ep0_tp1
	ln1_dp1_ep0_tp0 -> mha_dp1_ep0_tp0
	mha_dp1_ep0_tp0 -> moe_gate_dp1_ep0_tp0
	moe_gate_dp1_ep0_tp0 -> expert1_dp1_ep0_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep0_tp0 -> expert2_dp1_ep0_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep0_tp0 -> expert_agg_dp1_ep0_tp0
	expert2_dp1_ep0_tp0 -> expert_agg_dp1_ep0_tp0
	expert_agg_dp1_ep0_tp0 -> ln2_dp1_ep0_tp0
	ln2_dp1_ep0_tp0 -> ln1_dp1_ep1_tp0
	ln1_dp1_ep0_tp1 -> mha_dp1_ep0_tp1
	mha_dp1_ep0_tp1 -> moe_gate_dp1_ep0_tp1
	moe_gate_dp1_ep0_tp1 -> expert1_dp1_ep0_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep0_tp1 -> expert2_dp1_ep0_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep0_tp1 -> expert_agg_dp1_ep0_tp1
	expert2_dp1_ep0_tp1 -> expert_agg_dp1_ep0_tp1
	expert_agg_dp1_ep0_tp1 -> ln2_dp1_ep0_tp1
	ln2_dp1_ep0_tp1 -> ln1_dp1_ep1_tp1
	ln1_dp1_ep1_tp0 -> mha_dp1_ep1_tp0
	mha_dp1_ep1_tp0 -> moe_gate_dp1_ep1_tp0
	moe_gate_dp1_ep1_tp0 -> expert1_dp1_ep1_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep1_tp0 -> expert2_dp1_ep1_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep1_tp0 -> expert_agg_dp1_ep1_tp0
	expert2_dp1_ep1_tp0 -> expert_agg_dp1_ep1_tp0
	expert_agg_dp1_ep1_tp0 -> ln2_dp1_ep1_tp0
	ln2_dp1_ep1_tp0 -> ln1_dp1_ep2_tp0
	ln1_dp1_ep1_tp1 -> mha_dp1_ep1_tp1
	mha_dp1_ep1_tp1 -> moe_gate_dp1_ep1_tp1
	moe_gate_dp1_ep1_tp1 -> expert1_dp1_ep1_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep1_tp1 -> expert2_dp1_ep1_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep1_tp1 -> expert_agg_dp1_ep1_tp1
	expert2_dp1_ep1_tp1 -> expert_agg_dp1_ep1_tp1
	expert_agg_dp1_ep1_tp1 -> ln2_dp1_ep1_tp1
	ln2_dp1_ep1_tp1 -> ln1_dp1_ep2_tp1
	ln1_dp1_ep2_tp0 -> mha_dp1_ep2_tp0
	mha_dp1_ep2_tp0 -> moe_gate_dp1_ep2_tp0
	moe_gate_dp1_ep2_tp0 -> expert1_dp1_ep2_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep2_tp0 -> expert2_dp1_ep2_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep2_tp0 -> expert_agg_dp1_ep2_tp0
	expert2_dp1_ep2_tp0 -> expert_agg_dp1_ep2_tp0
	expert_agg_dp1_ep2_tp0 -> ln2_dp1_ep2_tp0
	ln2_dp1_ep2_tp0 -> ln1_dp1_ep3_tp0
	ln1_dp1_ep2_tp1 -> mha_dp1_ep2_tp1
	mha_dp1_ep2_tp1 -> moe_gate_dp1_ep2_tp1
	moe_gate_dp1_ep2_tp1 -> expert1_dp1_ep2_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep2_tp1 -> expert2_dp1_ep2_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep2_tp1 -> expert_agg_dp1_ep2_tp1
	expert2_dp1_ep2_tp1 -> expert_agg_dp1_ep2_tp1
	expert_agg_dp1_ep2_tp1 -> ln2_dp1_ep2_tp1
	ln2_dp1_ep2_tp1 -> ln1_dp1_ep3_tp1
	ln1_dp1_ep3_tp0 -> mha_dp1_ep3_tp0
	mha_dp1_ep3_tp0 -> moe_gate_dp1_ep3_tp0
	moe_gate_dp1_ep3_tp0 -> expert1_dp1_ep3_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep3_tp0 -> expert2_dp1_ep3_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep3_tp0 -> expert_agg_dp1_ep3_tp0
	expert2_dp1_ep3_tp0 -> expert_agg_dp1_ep3_tp0
	expert_agg_dp1_ep3_tp0 -> ln2_dp1_ep3_tp0
	ln2_dp1_ep3_tp0 -> ln1_dp1_ep4_tp0
	ln1_dp1_ep3_tp1 -> mha_dp1_ep3_tp1
	mha_dp1_ep3_tp1 -> moe_gate_dp1_ep3_tp1
	moe_gate_dp1_ep3_tp1 -> expert1_dp1_ep3_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep3_tp1 -> expert2_dp1_ep3_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep3_tp1 -> expert_agg_dp1_ep3_tp1
	expert2_dp1_ep3_tp1 -> expert_agg_dp1_ep3_tp1
	expert_agg_dp1_ep3_tp1 -> ln2_dp1_ep3_tp1
	ln2_dp1_ep3_tp1 -> ln1_dp1_ep4_tp1
	ln1_dp1_ep4_tp0 -> mha_dp1_ep4_tp0
	mha_dp1_ep4_tp0 -> moe_gate_dp1_ep4_tp0
	moe_gate_dp1_ep4_tp0 -> expert1_dp1_ep4_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep4_tp0 -> expert2_dp1_ep4_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep4_tp0 -> expert_agg_dp1_ep4_tp0
	expert2_dp1_ep4_tp0 -> expert_agg_dp1_ep4_tp0
	expert_agg_dp1_ep4_tp0 -> ln2_dp1_ep4_tp0
	ln2_dp1_ep4_tp0 -> ln1_dp1_ep5_tp0
	ln1_dp1_ep4_tp1 -> mha_dp1_ep4_tp1
	mha_dp1_ep4_tp1 -> moe_gate_dp1_ep4_tp1
	moe_gate_dp1_ep4_tp1 -> expert1_dp1_ep4_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep4_tp1 -> expert2_dp1_ep4_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep4_tp1 -> expert_agg_dp1_ep4_tp1
	expert2_dp1_ep4_tp1 -> expert_agg_dp1_ep4_tp1
	expert_agg_dp1_ep4_tp1 -> ln2_dp1_ep4_tp1
	ln2_dp1_ep4_tp1 -> ln1_dp1_ep5_tp1
	ln1_dp1_ep5_tp0 -> mha_dp1_ep5_tp0
	mha_dp1_ep5_tp0 -> moe_gate_dp1_ep5_tp0
	moe_gate_dp1_ep5_tp0 -> expert1_dp1_ep5_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep5_tp0 -> expert2_dp1_ep5_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep5_tp0 -> expert_agg_dp1_ep5_tp0
	expert2_dp1_ep5_tp0 -> expert_agg_dp1_ep5_tp0
	expert_agg_dp1_ep5_tp0 -> ln2_dp1_ep5_tp0
	ln2_dp1_ep5_tp0 -> ln1_dp1_ep6_tp0
	ln1_dp1_ep5_tp1 -> mha_dp1_ep5_tp1
	mha_dp1_ep5_tp1 -> moe_gate_dp1_ep5_tp1
	moe_gate_dp1_ep5_tp1 -> expert1_dp1_ep5_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep5_tp1 -> expert2_dp1_ep5_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep5_tp1 -> expert_agg_dp1_ep5_tp1
	expert2_dp1_ep5_tp1 -> expert_agg_dp1_ep5_tp1
	expert_agg_dp1_ep5_tp1 -> ln2_dp1_ep5_tp1
	ln2_dp1_ep5_tp1 -> ln1_dp1_ep6_tp1
	ln1_dp1_ep6_tp0 -> mha_dp1_ep6_tp0
	mha_dp1_ep6_tp0 -> moe_gate_dp1_ep6_tp0
	moe_gate_dp1_ep6_tp0 -> expert1_dp1_ep6_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep6_tp0 -> expert2_dp1_ep6_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep6_tp0 -> expert_agg_dp1_ep6_tp0
	expert2_dp1_ep6_tp0 -> expert_agg_dp1_ep6_tp0
	expert_agg_dp1_ep6_tp0 -> ln2_dp1_ep6_tp0
	ln2_dp1_ep6_tp0 -> ln1_dp1_ep7_tp0
	ln1_dp1_ep6_tp1 -> mha_dp1_ep6_tp1
	mha_dp1_ep6_tp1 -> moe_gate_dp1_ep6_tp1
	moe_gate_dp1_ep6_tp1 -> expert1_dp1_ep6_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep6_tp1 -> expert2_dp1_ep6_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep6_tp1 -> expert_agg_dp1_ep6_tp1
	expert2_dp1_ep6_tp1 -> expert_agg_dp1_ep6_tp1
	expert_agg_dp1_ep6_tp1 -> ln2_dp1_ep6_tp1
	ln2_dp1_ep6_tp1 -> ln1_dp1_ep7_tp1
	ln1_dp1_ep7_tp0 -> mha_dp1_ep7_tp0
	mha_dp1_ep7_tp0 -> moe_gate_dp1_ep7_tp0
	moe_gate_dp1_ep7_tp0 -> expert1_dp1_ep7_tp0 [label="expert selection" style=dashed]
	moe_gate_dp1_ep7_tp0 -> expert2_dp1_ep7_tp0 [label="expert selection" style=dashed]
	expert1_dp1_ep7_tp0 -> expert_agg_dp1_ep7_tp0
	expert2_dp1_ep7_tp0 -> expert_agg_dp1_ep7_tp0
	expert_agg_dp1_ep7_tp0 -> ln2_dp1_ep7_tp0
	ln2_dp1_ep7_tp0 -> comm_pipeline_dp1_ep7_tp0
	comm_pipeline_dp1_ep7_tp0 -> stage2_ln1_dp1_ep7_tp0
	ln1_dp1_ep7_tp1 -> mha_dp1_ep7_tp1
	mha_dp1_ep7_tp1 -> moe_gate_dp1_ep7_tp1
	moe_gate_dp1_ep7_tp1 -> expert1_dp1_ep7_tp1 [label="expert selection" style=dashed]
	moe_gate_dp1_ep7_tp1 -> expert2_dp1_ep7_tp1 [label="expert selection" style=dashed]
	expert1_dp1_ep7_tp1 -> expert_agg_dp1_ep7_tp1
	expert2_dp1_ep7_tp1 -> expert_agg_dp1_ep7_tp1
	expert_agg_dp1_ep7_tp1 -> ln2_dp1_ep7_tp1
	ln2_dp1_ep7_tp1 -> comm_pipeline_dp1_ep7_tp1
	comm_pipeline_dp1_ep7_tp1 -> stage2_ln1_dp1_ep7_tp1
	stage2_ln1_dp1_ep0_tp0 -> stage2_mha_dp1_ep0_tp0
	stage2_mha_dp1_ep0_tp0 -> stage2_moe_gate_dp1_ep0_tp0
	stage2_moe_gate_dp1_ep0_tp0 -> stage2_expert1_dp1_ep0_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep0_tp0 -> stage2_expert2_dp1_ep0_tp0 [style=dashed]
	stage2_expert1_dp1_ep0_tp0 -> stage2_expert_agg_dp1_ep0_tp0
	stage2_expert2_dp1_ep0_tp0 -> stage2_expert_agg_dp1_ep0_tp0
	stage2_expert_agg_dp1_ep0_tp0 -> stage2_ln2_dp1_ep0_tp0
	stage2_ln2_dp1_ep0_tp0 -> stage2_ln1_dp1_ep1_tp0
	stage2_ln1_dp1_ep0_tp1 -> stage2_mha_dp1_ep0_tp1
	stage2_mha_dp1_ep0_tp1 -> stage2_moe_gate_dp1_ep0_tp1
	stage2_moe_gate_dp1_ep0_tp1 -> stage2_expert1_dp1_ep0_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep0_tp1 -> stage2_expert2_dp1_ep0_tp1 [style=dashed]
	stage2_expert1_dp1_ep0_tp1 -> stage2_expert_agg_dp1_ep0_tp1
	stage2_expert2_dp1_ep0_tp1 -> stage2_expert_agg_dp1_ep0_tp1
	stage2_expert_agg_dp1_ep0_tp1 -> stage2_ln2_dp1_ep0_tp1
	stage2_ln2_dp1_ep0_tp1 -> stage2_ln1_dp1_ep1_tp1
	stage2_ln1_dp1_ep1_tp0 -> stage2_mha_dp1_ep1_tp0
	stage2_mha_dp1_ep1_tp0 -> stage2_moe_gate_dp1_ep1_tp0
	stage2_moe_gate_dp1_ep1_tp0 -> stage2_expert1_dp1_ep1_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep1_tp0 -> stage2_expert2_dp1_ep1_tp0 [style=dashed]
	stage2_expert1_dp1_ep1_tp0 -> stage2_expert_agg_dp1_ep1_tp0
	stage2_expert2_dp1_ep1_tp0 -> stage2_expert_agg_dp1_ep1_tp0
	stage2_expert_agg_dp1_ep1_tp0 -> stage2_ln2_dp1_ep1_tp0
	stage2_ln2_dp1_ep1_tp0 -> stage2_ln1_dp1_ep2_tp0
	stage2_ln1_dp1_ep1_tp1 -> stage2_mha_dp1_ep1_tp1
	stage2_mha_dp1_ep1_tp1 -> stage2_moe_gate_dp1_ep1_tp1
	stage2_moe_gate_dp1_ep1_tp1 -> stage2_expert1_dp1_ep1_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep1_tp1 -> stage2_expert2_dp1_ep1_tp1 [style=dashed]
	stage2_expert1_dp1_ep1_tp1 -> stage2_expert_agg_dp1_ep1_tp1
	stage2_expert2_dp1_ep1_tp1 -> stage2_expert_agg_dp1_ep1_tp1
	stage2_expert_agg_dp1_ep1_tp1 -> stage2_ln2_dp1_ep1_tp1
	stage2_ln2_dp1_ep1_tp1 -> stage2_ln1_dp1_ep2_tp1
	stage2_ln1_dp1_ep2_tp0 -> stage2_mha_dp1_ep2_tp0
	stage2_mha_dp1_ep2_tp0 -> stage2_moe_gate_dp1_ep2_tp0
	stage2_moe_gate_dp1_ep2_tp0 -> stage2_expert1_dp1_ep2_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep2_tp0 -> stage2_expert2_dp1_ep2_tp0 [style=dashed]
	stage2_expert1_dp1_ep2_tp0 -> stage2_expert_agg_dp1_ep2_tp0
	stage2_expert2_dp1_ep2_tp0 -> stage2_expert_agg_dp1_ep2_tp0
	stage2_expert_agg_dp1_ep2_tp0 -> stage2_ln2_dp1_ep2_tp0
	stage2_ln2_dp1_ep2_tp0 -> stage2_ln1_dp1_ep3_tp0
	stage2_ln1_dp1_ep2_tp1 -> stage2_mha_dp1_ep2_tp1
	stage2_mha_dp1_ep2_tp1 -> stage2_moe_gate_dp1_ep2_tp1
	stage2_moe_gate_dp1_ep2_tp1 -> stage2_expert1_dp1_ep2_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep2_tp1 -> stage2_expert2_dp1_ep2_tp1 [style=dashed]
	stage2_expert1_dp1_ep2_tp1 -> stage2_expert_agg_dp1_ep2_tp1
	stage2_expert2_dp1_ep2_tp1 -> stage2_expert_agg_dp1_ep2_tp1
	stage2_expert_agg_dp1_ep2_tp1 -> stage2_ln2_dp1_ep2_tp1
	stage2_ln2_dp1_ep2_tp1 -> stage2_ln1_dp1_ep3_tp1
	stage2_ln1_dp1_ep3_tp0 -> stage2_mha_dp1_ep3_tp0
	stage2_mha_dp1_ep3_tp0 -> stage2_moe_gate_dp1_ep3_tp0
	stage2_moe_gate_dp1_ep3_tp0 -> stage2_expert1_dp1_ep3_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep3_tp0 -> stage2_expert2_dp1_ep3_tp0 [style=dashed]
	stage2_expert1_dp1_ep3_tp0 -> stage2_expert_agg_dp1_ep3_tp0
	stage2_expert2_dp1_ep3_tp0 -> stage2_expert_agg_dp1_ep3_tp0
	stage2_expert_agg_dp1_ep3_tp0 -> stage2_ln2_dp1_ep3_tp0
	stage2_ln2_dp1_ep3_tp0 -> stage2_ln1_dp1_ep4_tp0
	stage2_ln1_dp1_ep3_tp1 -> stage2_mha_dp1_ep3_tp1
	stage2_mha_dp1_ep3_tp1 -> stage2_moe_gate_dp1_ep3_tp1
	stage2_moe_gate_dp1_ep3_tp1 -> stage2_expert1_dp1_ep3_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep3_tp1 -> stage2_expert2_dp1_ep3_tp1 [style=dashed]
	stage2_expert1_dp1_ep3_tp1 -> stage2_expert_agg_dp1_ep3_tp1
	stage2_expert2_dp1_ep3_tp1 -> stage2_expert_agg_dp1_ep3_tp1
	stage2_expert_agg_dp1_ep3_tp1 -> stage2_ln2_dp1_ep3_tp1
	stage2_ln2_dp1_ep3_tp1 -> stage2_ln1_dp1_ep4_tp1
	stage2_ln1_dp1_ep4_tp0 -> stage2_mha_dp1_ep4_tp0
	stage2_mha_dp1_ep4_tp0 -> stage2_moe_gate_dp1_ep4_tp0
	stage2_moe_gate_dp1_ep4_tp0 -> stage2_expert1_dp1_ep4_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep4_tp0 -> stage2_expert2_dp1_ep4_tp0 [style=dashed]
	stage2_expert1_dp1_ep4_tp0 -> stage2_expert_agg_dp1_ep4_tp0
	stage2_expert2_dp1_ep4_tp0 -> stage2_expert_agg_dp1_ep4_tp0
	stage2_expert_agg_dp1_ep4_tp0 -> stage2_ln2_dp1_ep4_tp0
	stage2_ln2_dp1_ep4_tp0 -> stage2_ln1_dp1_ep5_tp0
	stage2_ln1_dp1_ep4_tp1 -> stage2_mha_dp1_ep4_tp1
	stage2_mha_dp1_ep4_tp1 -> stage2_moe_gate_dp1_ep4_tp1
	stage2_moe_gate_dp1_ep4_tp1 -> stage2_expert1_dp1_ep4_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep4_tp1 -> stage2_expert2_dp1_ep4_tp1 [style=dashed]
	stage2_expert1_dp1_ep4_tp1 -> stage2_expert_agg_dp1_ep4_tp1
	stage2_expert2_dp1_ep4_tp1 -> stage2_expert_agg_dp1_ep4_tp1
	stage2_expert_agg_dp1_ep4_tp1 -> stage2_ln2_dp1_ep4_tp1
	stage2_ln2_dp1_ep4_tp1 -> stage2_ln1_dp1_ep5_tp1
	stage2_ln1_dp1_ep5_tp0 -> stage2_mha_dp1_ep5_tp0
	stage2_mha_dp1_ep5_tp0 -> stage2_moe_gate_dp1_ep5_tp0
	stage2_moe_gate_dp1_ep5_tp0 -> stage2_expert1_dp1_ep5_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep5_tp0 -> stage2_expert2_dp1_ep5_tp0 [style=dashed]
	stage2_expert1_dp1_ep5_tp0 -> stage2_expert_agg_dp1_ep5_tp0
	stage2_expert2_dp1_ep5_tp0 -> stage2_expert_agg_dp1_ep5_tp0
	stage2_expert_agg_dp1_ep5_tp0 -> stage2_ln2_dp1_ep5_tp0
	stage2_ln2_dp1_ep5_tp0 -> stage2_ln1_dp1_ep6_tp0
	stage2_ln1_dp1_ep5_tp1 -> stage2_mha_dp1_ep5_tp1
	stage2_mha_dp1_ep5_tp1 -> stage2_moe_gate_dp1_ep5_tp1
	stage2_moe_gate_dp1_ep5_tp1 -> stage2_expert1_dp1_ep5_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep5_tp1 -> stage2_expert2_dp1_ep5_tp1 [style=dashed]
	stage2_expert1_dp1_ep5_tp1 -> stage2_expert_agg_dp1_ep5_tp1
	stage2_expert2_dp1_ep5_tp1 -> stage2_expert_agg_dp1_ep5_tp1
	stage2_expert_agg_dp1_ep5_tp1 -> stage2_ln2_dp1_ep5_tp1
	stage2_ln2_dp1_ep5_tp1 -> stage2_ln1_dp1_ep6_tp1
	stage2_ln1_dp1_ep6_tp0 -> stage2_mha_dp1_ep6_tp0
	stage2_mha_dp1_ep6_tp0 -> stage2_moe_gate_dp1_ep6_tp0
	stage2_moe_gate_dp1_ep6_tp0 -> stage2_expert1_dp1_ep6_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep6_tp0 -> stage2_expert2_dp1_ep6_tp0 [style=dashed]
	stage2_expert1_dp1_ep6_tp0 -> stage2_expert_agg_dp1_ep6_tp0
	stage2_expert2_dp1_ep6_tp0 -> stage2_expert_agg_dp1_ep6_tp0
	stage2_expert_agg_dp1_ep6_tp0 -> stage2_ln2_dp1_ep6_tp0
	stage2_ln2_dp1_ep6_tp0 -> stage2_ln1_dp1_ep7_tp0
	stage2_ln1_dp1_ep6_tp1 -> stage2_mha_dp1_ep6_tp1
	stage2_mha_dp1_ep6_tp1 -> stage2_moe_gate_dp1_ep6_tp1
	stage2_moe_gate_dp1_ep6_tp1 -> stage2_expert1_dp1_ep6_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep6_tp1 -> stage2_expert2_dp1_ep6_tp1 [style=dashed]
	stage2_expert1_dp1_ep6_tp1 -> stage2_expert_agg_dp1_ep6_tp1
	stage2_expert2_dp1_ep6_tp1 -> stage2_expert_agg_dp1_ep6_tp1
	stage2_expert_agg_dp1_ep6_tp1 -> stage2_ln2_dp1_ep6_tp1
	stage2_ln2_dp1_ep6_tp1 -> stage2_ln1_dp1_ep7_tp1
	stage2_ln1_dp1_ep7_tp0 -> stage2_mha_dp1_ep7_tp0
	stage2_mha_dp1_ep7_tp0 -> stage2_moe_gate_dp1_ep7_tp0
	stage2_moe_gate_dp1_ep7_tp0 -> stage2_expert1_dp1_ep7_tp0 [style=dashed]
	stage2_moe_gate_dp1_ep7_tp0 -> stage2_expert2_dp1_ep7_tp0 [style=dashed]
	stage2_expert1_dp1_ep7_tp0 -> stage2_expert_agg_dp1_ep7_tp0
	stage2_expert2_dp1_ep7_tp0 -> stage2_expert_agg_dp1_ep7_tp0
	stage2_expert_agg_dp1_ep7_tp0 -> stage2_ln2_dp1_ep7_tp0
	stage2_ln2_dp1_ep7_tp0 -> stage2_ln1_dp2_ep0_tp0
	stage2_ln1_dp1_ep7_tp1 -> stage2_mha_dp1_ep7_tp1
	stage2_mha_dp1_ep7_tp1 -> stage2_moe_gate_dp1_ep7_tp1
	stage2_moe_gate_dp1_ep7_tp1 -> stage2_expert1_dp1_ep7_tp1 [style=dashed]
	stage2_moe_gate_dp1_ep7_tp1 -> stage2_expert2_dp1_ep7_tp1 [style=dashed]
	stage2_expert1_dp1_ep7_tp1 -> stage2_expert_agg_dp1_ep7_tp1
	stage2_expert2_dp1_ep7_tp1 -> stage2_expert_agg_dp1_ep7_tp1
	stage2_expert_agg_dp1_ep7_tp1 -> stage2_ln2_dp1_ep7_tp1
	stage2_ln2_dp1_ep7_tp1 -> stage2_ln1_dp2_ep0_tp1
	ln1_dp2_ep0_tp0 -> mha_dp2_ep0_tp0
	mha_dp2_ep0_tp0 -> moe_gate_dp2_ep0_tp0
	moe_gate_dp2_ep0_tp0 -> expert1_dp2_ep0_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep0_tp0 -> expert2_dp2_ep0_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep0_tp0 -> expert_agg_dp2_ep0_tp0
	expert2_dp2_ep0_tp0 -> expert_agg_dp2_ep0_tp0
	expert_agg_dp2_ep0_tp0 -> ln2_dp2_ep0_tp0
	ln2_dp2_ep0_tp0 -> ln1_dp2_ep1_tp0
	ln1_dp2_ep0_tp1 -> mha_dp2_ep0_tp1
	mha_dp2_ep0_tp1 -> moe_gate_dp2_ep0_tp1
	moe_gate_dp2_ep0_tp1 -> expert1_dp2_ep0_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep0_tp1 -> expert2_dp2_ep0_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep0_tp1 -> expert_agg_dp2_ep0_tp1
	expert2_dp2_ep0_tp1 -> expert_agg_dp2_ep0_tp1
	expert_agg_dp2_ep0_tp1 -> ln2_dp2_ep0_tp1
	ln2_dp2_ep0_tp1 -> ln1_dp2_ep1_tp1
	ln1_dp2_ep1_tp0 -> mha_dp2_ep1_tp0
	mha_dp2_ep1_tp0 -> moe_gate_dp2_ep1_tp0
	moe_gate_dp2_ep1_tp0 -> expert1_dp2_ep1_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep1_tp0 -> expert2_dp2_ep1_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep1_tp0 -> expert_agg_dp2_ep1_tp0
	expert2_dp2_ep1_tp0 -> expert_agg_dp2_ep1_tp0
	expert_agg_dp2_ep1_tp0 -> ln2_dp2_ep1_tp0
	ln2_dp2_ep1_tp0 -> ln1_dp2_ep2_tp0
	ln1_dp2_ep1_tp1 -> mha_dp2_ep1_tp1
	mha_dp2_ep1_tp1 -> moe_gate_dp2_ep1_tp1
	moe_gate_dp2_ep1_tp1 -> expert1_dp2_ep1_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep1_tp1 -> expert2_dp2_ep1_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep1_tp1 -> expert_agg_dp2_ep1_tp1
	expert2_dp2_ep1_tp1 -> expert_agg_dp2_ep1_tp1
	expert_agg_dp2_ep1_tp1 -> ln2_dp2_ep1_tp1
	ln2_dp2_ep1_tp1 -> ln1_dp2_ep2_tp1
	ln1_dp2_ep2_tp0 -> mha_dp2_ep2_tp0
	mha_dp2_ep2_tp0 -> moe_gate_dp2_ep2_tp0
	moe_gate_dp2_ep2_tp0 -> expert1_dp2_ep2_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep2_tp0 -> expert2_dp2_ep2_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep2_tp0 -> expert_agg_dp2_ep2_tp0
	expert2_dp2_ep2_tp0 -> expert_agg_dp2_ep2_tp0
	expert_agg_dp2_ep2_tp0 -> ln2_dp2_ep2_tp0
	ln2_dp2_ep2_tp0 -> ln1_dp2_ep3_tp0
	ln1_dp2_ep2_tp1 -> mha_dp2_ep2_tp1
	mha_dp2_ep2_tp1 -> moe_gate_dp2_ep2_tp1
	moe_gate_dp2_ep2_tp1 -> expert1_dp2_ep2_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep2_tp1 -> expert2_dp2_ep2_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep2_tp1 -> expert_agg_dp2_ep2_tp1
	expert2_dp2_ep2_tp1 -> expert_agg_dp2_ep2_tp1
	expert_agg_dp2_ep2_tp1 -> ln2_dp2_ep2_tp1
	ln2_dp2_ep2_tp1 -> ln1_dp2_ep3_tp1
	ln1_dp2_ep3_tp0 -> mha_dp2_ep3_tp0
	mha_dp2_ep3_tp0 -> moe_gate_dp2_ep3_tp0
	moe_gate_dp2_ep3_tp0 -> expert1_dp2_ep3_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep3_tp0 -> expert2_dp2_ep3_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep3_tp0 -> expert_agg_dp2_ep3_tp0
	expert2_dp2_ep3_tp0 -> expert_agg_dp2_ep3_tp0
	expert_agg_dp2_ep3_tp0 -> ln2_dp2_ep3_tp0
	ln2_dp2_ep3_tp0 -> ln1_dp2_ep4_tp0
	ln1_dp2_ep3_tp1 -> mha_dp2_ep3_tp1
	mha_dp2_ep3_tp1 -> moe_gate_dp2_ep3_tp1
	moe_gate_dp2_ep3_tp1 -> expert1_dp2_ep3_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep3_tp1 -> expert2_dp2_ep3_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep3_tp1 -> expert_agg_dp2_ep3_tp1
	expert2_dp2_ep3_tp1 -> expert_agg_dp2_ep3_tp1
	expert_agg_dp2_ep3_tp1 -> ln2_dp2_ep3_tp1
	ln2_dp2_ep3_tp1 -> ln1_dp2_ep4_tp1
	ln1_dp2_ep4_tp0 -> mha_dp2_ep4_tp0
	mha_dp2_ep4_tp0 -> moe_gate_dp2_ep4_tp0
	moe_gate_dp2_ep4_tp0 -> expert1_dp2_ep4_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep4_tp0 -> expert2_dp2_ep4_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep4_tp0 -> expert_agg_dp2_ep4_tp0
	expert2_dp2_ep4_tp0 -> expert_agg_dp2_ep4_tp0
	expert_agg_dp2_ep4_tp0 -> ln2_dp2_ep4_tp0
	ln2_dp2_ep4_tp0 -> ln1_dp2_ep5_tp0
	ln1_dp2_ep4_tp1 -> mha_dp2_ep4_tp1
	mha_dp2_ep4_tp1 -> moe_gate_dp2_ep4_tp1
	moe_gate_dp2_ep4_tp1 -> expert1_dp2_ep4_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep4_tp1 -> expert2_dp2_ep4_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep4_tp1 -> expert_agg_dp2_ep4_tp1
	expert2_dp2_ep4_tp1 -> expert_agg_dp2_ep4_tp1
	expert_agg_dp2_ep4_tp1 -> ln2_dp2_ep4_tp1
	ln2_dp2_ep4_tp1 -> ln1_dp2_ep5_tp1
	ln1_dp2_ep5_tp0 -> mha_dp2_ep5_tp0
	mha_dp2_ep5_tp0 -> moe_gate_dp2_ep5_tp0
	moe_gate_dp2_ep5_tp0 -> expert1_dp2_ep5_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep5_tp0 -> expert2_dp2_ep5_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep5_tp0 -> expert_agg_dp2_ep5_tp0
	expert2_dp2_ep5_tp0 -> expert_agg_dp2_ep5_tp0
	expert_agg_dp2_ep5_tp0 -> ln2_dp2_ep5_tp0
	ln2_dp2_ep5_tp0 -> ln1_dp2_ep6_tp0
	ln1_dp2_ep5_tp1 -> mha_dp2_ep5_tp1
	mha_dp2_ep5_tp1 -> moe_gate_dp2_ep5_tp1
	moe_gate_dp2_ep5_tp1 -> expert1_dp2_ep5_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep5_tp1 -> expert2_dp2_ep5_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep5_tp1 -> expert_agg_dp2_ep5_tp1
	expert2_dp2_ep5_tp1 -> expert_agg_dp2_ep5_tp1
	expert_agg_dp2_ep5_tp1 -> ln2_dp2_ep5_tp1
	ln2_dp2_ep5_tp1 -> ln1_dp2_ep6_tp1
	ln1_dp2_ep6_tp0 -> mha_dp2_ep6_tp0
	mha_dp2_ep6_tp0 -> moe_gate_dp2_ep6_tp0
	moe_gate_dp2_ep6_tp0 -> expert1_dp2_ep6_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep6_tp0 -> expert2_dp2_ep6_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep6_tp0 -> expert_agg_dp2_ep6_tp0
	expert2_dp2_ep6_tp0 -> expert_agg_dp2_ep6_tp0
	expert_agg_dp2_ep6_tp0 -> ln2_dp2_ep6_tp0
	ln2_dp2_ep6_tp0 -> ln1_dp2_ep7_tp0
	ln1_dp2_ep6_tp1 -> mha_dp2_ep6_tp1
	mha_dp2_ep6_tp1 -> moe_gate_dp2_ep6_tp1
	moe_gate_dp2_ep6_tp1 -> expert1_dp2_ep6_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep6_tp1 -> expert2_dp2_ep6_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep6_tp1 -> expert_agg_dp2_ep6_tp1
	expert2_dp2_ep6_tp1 -> expert_agg_dp2_ep6_tp1
	expert_agg_dp2_ep6_tp1 -> ln2_dp2_ep6_tp1
	ln2_dp2_ep6_tp1 -> ln1_dp2_ep7_tp1
	ln1_dp2_ep7_tp0 -> mha_dp2_ep7_tp0
	mha_dp2_ep7_tp0 -> moe_gate_dp2_ep7_tp0
	moe_gate_dp2_ep7_tp0 -> expert1_dp2_ep7_tp0 [label="expert selection" style=dashed]
	moe_gate_dp2_ep7_tp0 -> expert2_dp2_ep7_tp0 [label="expert selection" style=dashed]
	expert1_dp2_ep7_tp0 -> expert_agg_dp2_ep7_tp0
	expert2_dp2_ep7_tp0 -> expert_agg_dp2_ep7_tp0
	expert_agg_dp2_ep7_tp0 -> ln2_dp2_ep7_tp0
	ln2_dp2_ep7_tp0 -> comm_pipeline_dp2_ep7_tp0
	comm_pipeline_dp2_ep7_tp0 -> stage2_ln1_dp2_ep7_tp0
	ln1_dp2_ep7_tp1 -> mha_dp2_ep7_tp1
	mha_dp2_ep7_tp1 -> moe_gate_dp2_ep7_tp1
	moe_gate_dp2_ep7_tp1 -> expert1_dp2_ep7_tp1 [label="expert selection" style=dashed]
	moe_gate_dp2_ep7_tp1 -> expert2_dp2_ep7_tp1 [label="expert selection" style=dashed]
	expert1_dp2_ep7_tp1 -> expert_agg_dp2_ep7_tp1
	expert2_dp2_ep7_tp1 -> expert_agg_dp2_ep7_tp1
	expert_agg_dp2_ep7_tp1 -> ln2_dp2_ep7_tp1
	ln2_dp2_ep7_tp1 -> comm_pipeline_dp2_ep7_tp1
	comm_pipeline_dp2_ep7_tp1 -> stage2_ln1_dp2_ep7_tp1
	stage2_ln1_dp2_ep0_tp0 -> stage2_mha_dp2_ep0_tp0
	stage2_mha_dp2_ep0_tp0 -> stage2_moe_gate_dp2_ep0_tp0
	stage2_moe_gate_dp2_ep0_tp0 -> stage2_expert1_dp2_ep0_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep0_tp0 -> stage2_expert2_dp2_ep0_tp0 [style=dashed]
	stage2_expert1_dp2_ep0_tp0 -> stage2_expert_agg_dp2_ep0_tp0
	stage2_expert2_dp2_ep0_tp0 -> stage2_expert_agg_dp2_ep0_tp0
	stage2_expert_agg_dp2_ep0_tp0 -> stage2_ln2_dp2_ep0_tp0
	stage2_ln2_dp2_ep0_tp0 -> stage2_ln1_dp2_ep1_tp0
	stage2_ln1_dp2_ep0_tp1 -> stage2_mha_dp2_ep0_tp1
	stage2_mha_dp2_ep0_tp1 -> stage2_moe_gate_dp2_ep0_tp1
	stage2_moe_gate_dp2_ep0_tp1 -> stage2_expert1_dp2_ep0_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep0_tp1 -> stage2_expert2_dp2_ep0_tp1 [style=dashed]
	stage2_expert1_dp2_ep0_tp1 -> stage2_expert_agg_dp2_ep0_tp1
	stage2_expert2_dp2_ep0_tp1 -> stage2_expert_agg_dp2_ep0_tp1
	stage2_expert_agg_dp2_ep0_tp1 -> stage2_ln2_dp2_ep0_tp1
	stage2_ln2_dp2_ep0_tp1 -> stage2_ln1_dp2_ep1_tp1
	stage2_ln1_dp2_ep1_tp0 -> stage2_mha_dp2_ep1_tp0
	stage2_mha_dp2_ep1_tp0 -> stage2_moe_gate_dp2_ep1_tp0
	stage2_moe_gate_dp2_ep1_tp0 -> stage2_expert1_dp2_ep1_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep1_tp0 -> stage2_expert2_dp2_ep1_tp0 [style=dashed]
	stage2_expert1_dp2_ep1_tp0 -> stage2_expert_agg_dp2_ep1_tp0
	stage2_expert2_dp2_ep1_tp0 -> stage2_expert_agg_dp2_ep1_tp0
	stage2_expert_agg_dp2_ep1_tp0 -> stage2_ln2_dp2_ep1_tp0
	stage2_ln2_dp2_ep1_tp0 -> stage2_ln1_dp2_ep2_tp0
	stage2_ln1_dp2_ep1_tp1 -> stage2_mha_dp2_ep1_tp1
	stage2_mha_dp2_ep1_tp1 -> stage2_moe_gate_dp2_ep1_tp1
	stage2_moe_gate_dp2_ep1_tp1 -> stage2_expert1_dp2_ep1_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep1_tp1 -> stage2_expert2_dp2_ep1_tp1 [style=dashed]
	stage2_expert1_dp2_ep1_tp1 -> stage2_expert_agg_dp2_ep1_tp1
	stage2_expert2_dp2_ep1_tp1 -> stage2_expert_agg_dp2_ep1_tp1
	stage2_expert_agg_dp2_ep1_tp1 -> stage2_ln2_dp2_ep1_tp1
	stage2_ln2_dp2_ep1_tp1 -> stage2_ln1_dp2_ep2_tp1
	stage2_ln1_dp2_ep2_tp0 -> stage2_mha_dp2_ep2_tp0
	stage2_mha_dp2_ep2_tp0 -> stage2_moe_gate_dp2_ep2_tp0
	stage2_moe_gate_dp2_ep2_tp0 -> stage2_expert1_dp2_ep2_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep2_tp0 -> stage2_expert2_dp2_ep2_tp0 [style=dashed]
	stage2_expert1_dp2_ep2_tp0 -> stage2_expert_agg_dp2_ep2_tp0
	stage2_expert2_dp2_ep2_tp0 -> stage2_expert_agg_dp2_ep2_tp0
	stage2_expert_agg_dp2_ep2_tp0 -> stage2_ln2_dp2_ep2_tp0
	stage2_ln2_dp2_ep2_tp0 -> stage2_ln1_dp2_ep3_tp0
	stage2_ln1_dp2_ep2_tp1 -> stage2_mha_dp2_ep2_tp1
	stage2_mha_dp2_ep2_tp1 -> stage2_moe_gate_dp2_ep2_tp1
	stage2_moe_gate_dp2_ep2_tp1 -> stage2_expert1_dp2_ep2_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep2_tp1 -> stage2_expert2_dp2_ep2_tp1 [style=dashed]
	stage2_expert1_dp2_ep2_tp1 -> stage2_expert_agg_dp2_ep2_tp1
	stage2_expert2_dp2_ep2_tp1 -> stage2_expert_agg_dp2_ep2_tp1
	stage2_expert_agg_dp2_ep2_tp1 -> stage2_ln2_dp2_ep2_tp1
	stage2_ln2_dp2_ep2_tp1 -> stage2_ln1_dp2_ep3_tp1
	stage2_ln1_dp2_ep3_tp0 -> stage2_mha_dp2_ep3_tp0
	stage2_mha_dp2_ep3_tp0 -> stage2_moe_gate_dp2_ep3_tp0
	stage2_moe_gate_dp2_ep3_tp0 -> stage2_expert1_dp2_ep3_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep3_tp0 -> stage2_expert2_dp2_ep3_tp0 [style=dashed]
	stage2_expert1_dp2_ep3_tp0 -> stage2_expert_agg_dp2_ep3_tp0
	stage2_expert2_dp2_ep3_tp0 -> stage2_expert_agg_dp2_ep3_tp0
	stage2_expert_agg_dp2_ep3_tp0 -> stage2_ln2_dp2_ep3_tp0
	stage2_ln2_dp2_ep3_tp0 -> stage2_ln1_dp2_ep4_tp0
	stage2_ln1_dp2_ep3_tp1 -> stage2_mha_dp2_ep3_tp1
	stage2_mha_dp2_ep3_tp1 -> stage2_moe_gate_dp2_ep3_tp1
	stage2_moe_gate_dp2_ep3_tp1 -> stage2_expert1_dp2_ep3_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep3_tp1 -> stage2_expert2_dp2_ep3_tp1 [style=dashed]
	stage2_expert1_dp2_ep3_tp1 -> stage2_expert_agg_dp2_ep3_tp1
	stage2_expert2_dp2_ep3_tp1 -> stage2_expert_agg_dp2_ep3_tp1
	stage2_expert_agg_dp2_ep3_tp1 -> stage2_ln2_dp2_ep3_tp1
	stage2_ln2_dp2_ep3_tp1 -> stage2_ln1_dp2_ep4_tp1
	stage2_ln1_dp2_ep4_tp0 -> stage2_mha_dp2_ep4_tp0
	stage2_mha_dp2_ep4_tp0 -> stage2_moe_gate_dp2_ep4_tp0
	stage2_moe_gate_dp2_ep4_tp0 -> stage2_expert1_dp2_ep4_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep4_tp0 -> stage2_expert2_dp2_ep4_tp0 [style=dashed]
	stage2_expert1_dp2_ep4_tp0 -> stage2_expert_agg_dp2_ep4_tp0
	stage2_expert2_dp2_ep4_tp0 -> stage2_expert_agg_dp2_ep4_tp0
	stage2_expert_agg_dp2_ep4_tp0 -> stage2_ln2_dp2_ep4_tp0
	stage2_ln2_dp2_ep4_tp0 -> stage2_ln1_dp2_ep5_tp0
	stage2_ln1_dp2_ep4_tp1 -> stage2_mha_dp2_ep4_tp1
	stage2_mha_dp2_ep4_tp1 -> stage2_moe_gate_dp2_ep4_tp1
	stage2_moe_gate_dp2_ep4_tp1 -> stage2_expert1_dp2_ep4_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep4_tp1 -> stage2_expert2_dp2_ep4_tp1 [style=dashed]
	stage2_expert1_dp2_ep4_tp1 -> stage2_expert_agg_dp2_ep4_tp1
	stage2_expert2_dp2_ep4_tp1 -> stage2_expert_agg_dp2_ep4_tp1
	stage2_expert_agg_dp2_ep4_tp1 -> stage2_ln2_dp2_ep4_tp1
	stage2_ln2_dp2_ep4_tp1 -> stage2_ln1_dp2_ep5_tp1
	stage2_ln1_dp2_ep5_tp0 -> stage2_mha_dp2_ep5_tp0
	stage2_mha_dp2_ep5_tp0 -> stage2_moe_gate_dp2_ep5_tp0
	stage2_moe_gate_dp2_ep5_tp0 -> stage2_expert1_dp2_ep5_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep5_tp0 -> stage2_expert2_dp2_ep5_tp0 [style=dashed]
	stage2_expert1_dp2_ep5_tp0 -> stage2_expert_agg_dp2_ep5_tp0
	stage2_expert2_dp2_ep5_tp0 -> stage2_expert_agg_dp2_ep5_tp0
	stage2_expert_agg_dp2_ep5_tp0 -> stage2_ln2_dp2_ep5_tp0
	stage2_ln2_dp2_ep5_tp0 -> stage2_ln1_dp2_ep6_tp0
	stage2_ln1_dp2_ep5_tp1 -> stage2_mha_dp2_ep5_tp1
	stage2_mha_dp2_ep5_tp1 -> stage2_moe_gate_dp2_ep5_tp1
	stage2_moe_gate_dp2_ep5_tp1 -> stage2_expert1_dp2_ep5_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep5_tp1 -> stage2_expert2_dp2_ep5_tp1 [style=dashed]
	stage2_expert1_dp2_ep5_tp1 -> stage2_expert_agg_dp2_ep5_tp1
	stage2_expert2_dp2_ep5_tp1 -> stage2_expert_agg_dp2_ep5_tp1
	stage2_expert_agg_dp2_ep5_tp1 -> stage2_ln2_dp2_ep5_tp1
	stage2_ln2_dp2_ep5_tp1 -> stage2_ln1_dp2_ep6_tp1
	stage2_ln1_dp2_ep6_tp0 -> stage2_mha_dp2_ep6_tp0
	stage2_mha_dp2_ep6_tp0 -> stage2_moe_gate_dp2_ep6_tp0
	stage2_moe_gate_dp2_ep6_tp0 -> stage2_expert1_dp2_ep6_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep6_tp0 -> stage2_expert2_dp2_ep6_tp0 [style=dashed]
	stage2_expert1_dp2_ep6_tp0 -> stage2_expert_agg_dp2_ep6_tp0
	stage2_expert2_dp2_ep6_tp0 -> stage2_expert_agg_dp2_ep6_tp0
	stage2_expert_agg_dp2_ep6_tp0 -> stage2_ln2_dp2_ep6_tp0
	stage2_ln2_dp2_ep6_tp0 -> stage2_ln1_dp2_ep7_tp0
	stage2_ln1_dp2_ep6_tp1 -> stage2_mha_dp2_ep6_tp1
	stage2_mha_dp2_ep6_tp1 -> stage2_moe_gate_dp2_ep6_tp1
	stage2_moe_gate_dp2_ep6_tp1 -> stage2_expert1_dp2_ep6_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep6_tp1 -> stage2_expert2_dp2_ep6_tp1 [style=dashed]
	stage2_expert1_dp2_ep6_tp1 -> stage2_expert_agg_dp2_ep6_tp1
	stage2_expert2_dp2_ep6_tp1 -> stage2_expert_agg_dp2_ep6_tp1
	stage2_expert_agg_dp2_ep6_tp1 -> stage2_ln2_dp2_ep6_tp1
	stage2_ln2_dp2_ep6_tp1 -> stage2_ln1_dp2_ep7_tp1
	stage2_ln1_dp2_ep7_tp0 -> stage2_mha_dp2_ep7_tp0
	stage2_mha_dp2_ep7_tp0 -> stage2_moe_gate_dp2_ep7_tp0
	stage2_moe_gate_dp2_ep7_tp0 -> stage2_expert1_dp2_ep7_tp0 [style=dashed]
	stage2_moe_gate_dp2_ep7_tp0 -> stage2_expert2_dp2_ep7_tp0 [style=dashed]
	stage2_expert1_dp2_ep7_tp0 -> stage2_expert_agg_dp2_ep7_tp0
	stage2_expert2_dp2_ep7_tp0 -> stage2_expert_agg_dp2_ep7_tp0
	stage2_expert_agg_dp2_ep7_tp0 -> stage2_ln2_dp2_ep7_tp0
	stage2_ln2_dp2_ep7_tp0 -> stage2_ln1_dp3_ep0_tp0
	stage2_ln1_dp2_ep7_tp1 -> stage2_mha_dp2_ep7_tp1
	stage2_mha_dp2_ep7_tp1 -> stage2_moe_gate_dp2_ep7_tp1
	stage2_moe_gate_dp2_ep7_tp1 -> stage2_expert1_dp2_ep7_tp1 [style=dashed]
	stage2_moe_gate_dp2_ep7_tp1 -> stage2_expert2_dp2_ep7_tp1 [style=dashed]
	stage2_expert1_dp2_ep7_tp1 -> stage2_expert_agg_dp2_ep7_tp1
	stage2_expert2_dp2_ep7_tp1 -> stage2_expert_agg_dp2_ep7_tp1
	stage2_expert_agg_dp2_ep7_tp1 -> stage2_ln2_dp2_ep7_tp1
	stage2_ln2_dp2_ep7_tp1 -> stage2_ln1_dp3_ep0_tp1
	ln1_dp3_ep0_tp0 -> mha_dp3_ep0_tp0
	mha_dp3_ep0_tp0 -> moe_gate_dp3_ep0_tp0
	moe_gate_dp3_ep0_tp0 -> expert1_dp3_ep0_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep0_tp0 -> expert2_dp3_ep0_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep0_tp0 -> expert_agg_dp3_ep0_tp0
	expert2_dp3_ep0_tp0 -> expert_agg_dp3_ep0_tp0
	expert_agg_dp3_ep0_tp0 -> ln2_dp3_ep0_tp0
	ln2_dp3_ep0_tp0 -> ln1_dp3_ep1_tp0
	ln1_dp3_ep0_tp1 -> mha_dp3_ep0_tp1
	mha_dp3_ep0_tp1 -> moe_gate_dp3_ep0_tp1
	moe_gate_dp3_ep0_tp1 -> expert1_dp3_ep0_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep0_tp1 -> expert2_dp3_ep0_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep0_tp1 -> expert_agg_dp3_ep0_tp1
	expert2_dp3_ep0_tp1 -> expert_agg_dp3_ep0_tp1
	expert_agg_dp3_ep0_tp1 -> ln2_dp3_ep0_tp1
	ln2_dp3_ep0_tp1 -> ln1_dp3_ep1_tp1
	ln1_dp3_ep1_tp0 -> mha_dp3_ep1_tp0
	mha_dp3_ep1_tp0 -> moe_gate_dp3_ep1_tp0
	moe_gate_dp3_ep1_tp0 -> expert1_dp3_ep1_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep1_tp0 -> expert2_dp3_ep1_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep1_tp0 -> expert_agg_dp3_ep1_tp0
	expert2_dp3_ep1_tp0 -> expert_agg_dp3_ep1_tp0
	expert_agg_dp3_ep1_tp0 -> ln2_dp3_ep1_tp0
	ln2_dp3_ep1_tp0 -> ln1_dp3_ep2_tp0
	ln1_dp3_ep1_tp1 -> mha_dp3_ep1_tp1
	mha_dp3_ep1_tp1 -> moe_gate_dp3_ep1_tp1
	moe_gate_dp3_ep1_tp1 -> expert1_dp3_ep1_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep1_tp1 -> expert2_dp3_ep1_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep1_tp1 -> expert_agg_dp3_ep1_tp1
	expert2_dp3_ep1_tp1 -> expert_agg_dp3_ep1_tp1
	expert_agg_dp3_ep1_tp1 -> ln2_dp3_ep1_tp1
	ln2_dp3_ep1_tp1 -> ln1_dp3_ep2_tp1
	ln1_dp3_ep2_tp0 -> mha_dp3_ep2_tp0
	mha_dp3_ep2_tp0 -> moe_gate_dp3_ep2_tp0
	moe_gate_dp3_ep2_tp0 -> expert1_dp3_ep2_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep2_tp0 -> expert2_dp3_ep2_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep2_tp0 -> expert_agg_dp3_ep2_tp0
	expert2_dp3_ep2_tp0 -> expert_agg_dp3_ep2_tp0
	expert_agg_dp3_ep2_tp0 -> ln2_dp3_ep2_tp0
	ln2_dp3_ep2_tp0 -> ln1_dp3_ep3_tp0
	ln1_dp3_ep2_tp1 -> mha_dp3_ep2_tp1
	mha_dp3_ep2_tp1 -> moe_gate_dp3_ep2_tp1
	moe_gate_dp3_ep2_tp1 -> expert1_dp3_ep2_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep2_tp1 -> expert2_dp3_ep2_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep2_tp1 -> expert_agg_dp3_ep2_tp1
	expert2_dp3_ep2_tp1 -> expert_agg_dp3_ep2_tp1
	expert_agg_dp3_ep2_tp1 -> ln2_dp3_ep2_tp1
	ln2_dp3_ep2_tp1 -> ln1_dp3_ep3_tp1
	ln1_dp3_ep3_tp0 -> mha_dp3_ep3_tp0
	mha_dp3_ep3_tp0 -> moe_gate_dp3_ep3_tp0
	moe_gate_dp3_ep3_tp0 -> expert1_dp3_ep3_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep3_tp0 -> expert2_dp3_ep3_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep3_tp0 -> expert_agg_dp3_ep3_tp0
	expert2_dp3_ep3_tp0 -> expert_agg_dp3_ep3_tp0
	expert_agg_dp3_ep3_tp0 -> ln2_dp3_ep3_tp0
	ln2_dp3_ep3_tp0 -> ln1_dp3_ep4_tp0
	ln1_dp3_ep3_tp1 -> mha_dp3_ep3_tp1
	mha_dp3_ep3_tp1 -> moe_gate_dp3_ep3_tp1
	moe_gate_dp3_ep3_tp1 -> expert1_dp3_ep3_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep3_tp1 -> expert2_dp3_ep3_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep3_tp1 -> expert_agg_dp3_ep3_tp1
	expert2_dp3_ep3_tp1 -> expert_agg_dp3_ep3_tp1
	expert_agg_dp3_ep3_tp1 -> ln2_dp3_ep3_tp1
	ln2_dp3_ep3_tp1 -> ln1_dp3_ep4_tp1
	ln1_dp3_ep4_tp0 -> mha_dp3_ep4_tp0
	mha_dp3_ep4_tp0 -> moe_gate_dp3_ep4_tp0
	moe_gate_dp3_ep4_tp0 -> expert1_dp3_ep4_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep4_tp0 -> expert2_dp3_ep4_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep4_tp0 -> expert_agg_dp3_ep4_tp0
	expert2_dp3_ep4_tp0 -> expert_agg_dp3_ep4_tp0
	expert_agg_dp3_ep4_tp0 -> ln2_dp3_ep4_tp0
	ln2_dp3_ep4_tp0 -> ln1_dp3_ep5_tp0
	ln1_dp3_ep4_tp1 -> mha_dp3_ep4_tp1
	mha_dp3_ep4_tp1 -> moe_gate_dp3_ep4_tp1
	moe_gate_dp3_ep4_tp1 -> expert1_dp3_ep4_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep4_tp1 -> expert2_dp3_ep4_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep4_tp1 -> expert_agg_dp3_ep4_tp1
	expert2_dp3_ep4_tp1 -> expert_agg_dp3_ep4_tp1
	expert_agg_dp3_ep4_tp1 -> ln2_dp3_ep4_tp1
	ln2_dp3_ep4_tp1 -> ln1_dp3_ep5_tp1
	ln1_dp3_ep5_tp0 -> mha_dp3_ep5_tp0
	mha_dp3_ep5_tp0 -> moe_gate_dp3_ep5_tp0
	moe_gate_dp3_ep5_tp0 -> expert1_dp3_ep5_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep5_tp0 -> expert2_dp3_ep5_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep5_tp0 -> expert_agg_dp3_ep5_tp0
	expert2_dp3_ep5_tp0 -> expert_agg_dp3_ep5_tp0
	expert_agg_dp3_ep5_tp0 -> ln2_dp3_ep5_tp0
	ln2_dp3_ep5_tp0 -> ln1_dp3_ep6_tp0
	ln1_dp3_ep5_tp1 -> mha_dp3_ep5_tp1
	mha_dp3_ep5_tp1 -> moe_gate_dp3_ep5_tp1
	moe_gate_dp3_ep5_tp1 -> expert1_dp3_ep5_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep5_tp1 -> expert2_dp3_ep5_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep5_tp1 -> expert_agg_dp3_ep5_tp1
	expert2_dp3_ep5_tp1 -> expert_agg_dp3_ep5_tp1
	expert_agg_dp3_ep5_tp1 -> ln2_dp3_ep5_tp1
	ln2_dp3_ep5_tp1 -> ln1_dp3_ep6_tp1
	ln1_dp3_ep6_tp0 -> mha_dp3_ep6_tp0
	mha_dp3_ep6_tp0 -> moe_gate_dp3_ep6_tp0
	moe_gate_dp3_ep6_tp0 -> expert1_dp3_ep6_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep6_tp0 -> expert2_dp3_ep6_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep6_tp0 -> expert_agg_dp3_ep6_tp0
	expert2_dp3_ep6_tp0 -> expert_agg_dp3_ep6_tp0
	expert_agg_dp3_ep6_tp0 -> ln2_dp3_ep6_tp0
	ln2_dp3_ep6_tp0 -> ln1_dp3_ep7_tp0
	ln1_dp3_ep6_tp1 -> mha_dp3_ep6_tp1
	mha_dp3_ep6_tp1 -> moe_gate_dp3_ep6_tp1
	moe_gate_dp3_ep6_tp1 -> expert1_dp3_ep6_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep6_tp1 -> expert2_dp3_ep6_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep6_tp1 -> expert_agg_dp3_ep6_tp1
	expert2_dp3_ep6_tp1 -> expert_agg_dp3_ep6_tp1
	expert_agg_dp3_ep6_tp1 -> ln2_dp3_ep6_tp1
	ln2_dp3_ep6_tp1 -> ln1_dp3_ep7_tp1
	ln1_dp3_ep7_tp0 -> mha_dp3_ep7_tp0
	mha_dp3_ep7_tp0 -> moe_gate_dp3_ep7_tp0
	moe_gate_dp3_ep7_tp0 -> expert1_dp3_ep7_tp0 [label="expert selection" style=dashed]
	moe_gate_dp3_ep7_tp0 -> expert2_dp3_ep7_tp0 [label="expert selection" style=dashed]
	expert1_dp3_ep7_tp0 -> expert_agg_dp3_ep7_tp0
	expert2_dp3_ep7_tp0 -> expert_agg_dp3_ep7_tp0
	expert_agg_dp3_ep7_tp0 -> ln2_dp3_ep7_tp0
	ln2_dp3_ep7_tp0 -> comm_pipeline_dp3_ep7_tp0
	comm_pipeline_dp3_ep7_tp0 -> stage2_ln1_dp3_ep7_tp0
	ln1_dp3_ep7_tp1 -> mha_dp3_ep7_tp1
	mha_dp3_ep7_tp1 -> moe_gate_dp3_ep7_tp1
	moe_gate_dp3_ep7_tp1 -> expert1_dp3_ep7_tp1 [label="expert selection" style=dashed]
	moe_gate_dp3_ep7_tp1 -> expert2_dp3_ep7_tp1 [label="expert selection" style=dashed]
	expert1_dp3_ep7_tp1 -> expert_agg_dp3_ep7_tp1
	expert2_dp3_ep7_tp1 -> expert_agg_dp3_ep7_tp1
	expert_agg_dp3_ep7_tp1 -> ln2_dp3_ep7_tp1
	ln2_dp3_ep7_tp1 -> comm_pipeline_dp3_ep7_tp1
	comm_pipeline_dp3_ep7_tp1 -> stage2_ln1_dp3_ep7_tp1
	stage2_ln1_dp3_ep0_tp0 -> stage2_mha_dp3_ep0_tp0
	stage2_mha_dp3_ep0_tp0 -> stage2_moe_gate_dp3_ep0_tp0
	stage2_moe_gate_dp3_ep0_tp0 -> stage2_expert1_dp3_ep0_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep0_tp0 -> stage2_expert2_dp3_ep0_tp0 [style=dashed]
	stage2_expert1_dp3_ep0_tp0 -> stage2_expert_agg_dp3_ep0_tp0
	stage2_expert2_dp3_ep0_tp0 -> stage2_expert_agg_dp3_ep0_tp0
	stage2_expert_agg_dp3_ep0_tp0 -> stage2_ln2_dp3_ep0_tp0
	stage2_ln2_dp3_ep0_tp0 -> stage2_ln1_dp3_ep1_tp0
	stage2_ln1_dp3_ep0_tp1 -> stage2_mha_dp3_ep0_tp1
	stage2_mha_dp3_ep0_tp1 -> stage2_moe_gate_dp3_ep0_tp1
	stage2_moe_gate_dp3_ep0_tp1 -> stage2_expert1_dp3_ep0_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep0_tp1 -> stage2_expert2_dp3_ep0_tp1 [style=dashed]
	stage2_expert1_dp3_ep0_tp1 -> stage2_expert_agg_dp3_ep0_tp1
	stage2_expert2_dp3_ep0_tp1 -> stage2_expert_agg_dp3_ep0_tp1
	stage2_expert_agg_dp3_ep0_tp1 -> stage2_ln2_dp3_ep0_tp1
	stage2_ln2_dp3_ep0_tp1 -> stage2_ln1_dp3_ep1_tp1
	stage2_ln1_dp3_ep1_tp0 -> stage2_mha_dp3_ep1_tp0
	stage2_mha_dp3_ep1_tp0 -> stage2_moe_gate_dp3_ep1_tp0
	stage2_moe_gate_dp3_ep1_tp0 -> stage2_expert1_dp3_ep1_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep1_tp0 -> stage2_expert2_dp3_ep1_tp0 [style=dashed]
	stage2_expert1_dp3_ep1_tp0 -> stage2_expert_agg_dp3_ep1_tp0
	stage2_expert2_dp3_ep1_tp0 -> stage2_expert_agg_dp3_ep1_tp0
	stage2_expert_agg_dp3_ep1_tp0 -> stage2_ln2_dp3_ep1_tp0
	stage2_ln2_dp3_ep1_tp0 -> stage2_ln1_dp3_ep2_tp0
	stage2_ln1_dp3_ep1_tp1 -> stage2_mha_dp3_ep1_tp1
	stage2_mha_dp3_ep1_tp1 -> stage2_moe_gate_dp3_ep1_tp1
	stage2_moe_gate_dp3_ep1_tp1 -> stage2_expert1_dp3_ep1_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep1_tp1 -> stage2_expert2_dp3_ep1_tp1 [style=dashed]
	stage2_expert1_dp3_ep1_tp1 -> stage2_expert_agg_dp3_ep1_tp1
	stage2_expert2_dp3_ep1_tp1 -> stage2_expert_agg_dp3_ep1_tp1
	stage2_expert_agg_dp3_ep1_tp1 -> stage2_ln2_dp3_ep1_tp1
	stage2_ln2_dp3_ep1_tp1 -> stage2_ln1_dp3_ep2_tp1
	stage2_ln1_dp3_ep2_tp0 -> stage2_mha_dp3_ep2_tp0
	stage2_mha_dp3_ep2_tp0 -> stage2_moe_gate_dp3_ep2_tp0
	stage2_moe_gate_dp3_ep2_tp0 -> stage2_expert1_dp3_ep2_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep2_tp0 -> stage2_expert2_dp3_ep2_tp0 [style=dashed]
	stage2_expert1_dp3_ep2_tp0 -> stage2_expert_agg_dp3_ep2_tp0
	stage2_expert2_dp3_ep2_tp0 -> stage2_expert_agg_dp3_ep2_tp0
	stage2_expert_agg_dp3_ep2_tp0 -> stage2_ln2_dp3_ep2_tp0
	stage2_ln2_dp3_ep2_tp0 -> stage2_ln1_dp3_ep3_tp0
	stage2_ln1_dp3_ep2_tp1 -> stage2_mha_dp3_ep2_tp1
	stage2_mha_dp3_ep2_tp1 -> stage2_moe_gate_dp3_ep2_tp1
	stage2_moe_gate_dp3_ep2_tp1 -> stage2_expert1_dp3_ep2_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep2_tp1 -> stage2_expert2_dp3_ep2_tp1 [style=dashed]
	stage2_expert1_dp3_ep2_tp1 -> stage2_expert_agg_dp3_ep2_tp1
	stage2_expert2_dp3_ep2_tp1 -> stage2_expert_agg_dp3_ep2_tp1
	stage2_expert_agg_dp3_ep2_tp1 -> stage2_ln2_dp3_ep2_tp1
	stage2_ln2_dp3_ep2_tp1 -> stage2_ln1_dp3_ep3_tp1
	stage2_ln1_dp3_ep3_tp0 -> stage2_mha_dp3_ep3_tp0
	stage2_mha_dp3_ep3_tp0 -> stage2_moe_gate_dp3_ep3_tp0
	stage2_moe_gate_dp3_ep3_tp0 -> stage2_expert1_dp3_ep3_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep3_tp0 -> stage2_expert2_dp3_ep3_tp0 [style=dashed]
	stage2_expert1_dp3_ep3_tp0 -> stage2_expert_agg_dp3_ep3_tp0
	stage2_expert2_dp3_ep3_tp0 -> stage2_expert_agg_dp3_ep3_tp0
	stage2_expert_agg_dp3_ep3_tp0 -> stage2_ln2_dp3_ep3_tp0
	stage2_ln2_dp3_ep3_tp0 -> stage2_ln1_dp3_ep4_tp0
	stage2_ln1_dp3_ep3_tp1 -> stage2_mha_dp3_ep3_tp1
	stage2_mha_dp3_ep3_tp1 -> stage2_moe_gate_dp3_ep3_tp1
	stage2_moe_gate_dp3_ep3_tp1 -> stage2_expert1_dp3_ep3_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep3_tp1 -> stage2_expert2_dp3_ep3_tp1 [style=dashed]
	stage2_expert1_dp3_ep3_tp1 -> stage2_expert_agg_dp3_ep3_tp1
	stage2_expert2_dp3_ep3_tp1 -> stage2_expert_agg_dp3_ep3_tp1
	stage2_expert_agg_dp3_ep3_tp1 -> stage2_ln2_dp3_ep3_tp1
	stage2_ln2_dp3_ep3_tp1 -> stage2_ln1_dp3_ep4_tp1
	stage2_ln1_dp3_ep4_tp0 -> stage2_mha_dp3_ep4_tp0
	stage2_mha_dp3_ep4_tp0 -> stage2_moe_gate_dp3_ep4_tp0
	stage2_moe_gate_dp3_ep4_tp0 -> stage2_expert1_dp3_ep4_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep4_tp0 -> stage2_expert2_dp3_ep4_tp0 [style=dashed]
	stage2_expert1_dp3_ep4_tp0 -> stage2_expert_agg_dp3_ep4_tp0
	stage2_expert2_dp3_ep4_tp0 -> stage2_expert_agg_dp3_ep4_tp0
	stage2_expert_agg_dp3_ep4_tp0 -> stage2_ln2_dp3_ep4_tp0
	stage2_ln2_dp3_ep4_tp0 -> stage2_ln1_dp3_ep5_tp0
	stage2_ln1_dp3_ep4_tp1 -> stage2_mha_dp3_ep4_tp1
	stage2_mha_dp3_ep4_tp1 -> stage2_moe_gate_dp3_ep4_tp1
	stage2_moe_gate_dp3_ep4_tp1 -> stage2_expert1_dp3_ep4_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep4_tp1 -> stage2_expert2_dp3_ep4_tp1 [style=dashed]
	stage2_expert1_dp3_ep4_tp1 -> stage2_expert_agg_dp3_ep4_tp1
	stage2_expert2_dp3_ep4_tp1 -> stage2_expert_agg_dp3_ep4_tp1
	stage2_expert_agg_dp3_ep4_tp1 -> stage2_ln2_dp3_ep4_tp1
	stage2_ln2_dp3_ep4_tp1 -> stage2_ln1_dp3_ep5_tp1
	stage2_ln1_dp3_ep5_tp0 -> stage2_mha_dp3_ep5_tp0
	stage2_mha_dp3_ep5_tp0 -> stage2_moe_gate_dp3_ep5_tp0
	stage2_moe_gate_dp3_ep5_tp0 -> stage2_expert1_dp3_ep5_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep5_tp0 -> stage2_expert2_dp3_ep5_tp0 [style=dashed]
	stage2_expert1_dp3_ep5_tp0 -> stage2_expert_agg_dp3_ep5_tp0
	stage2_expert2_dp3_ep5_tp0 -> stage2_expert_agg_dp3_ep5_tp0
	stage2_expert_agg_dp3_ep5_tp0 -> stage2_ln2_dp3_ep5_tp0
	stage2_ln2_dp3_ep5_tp0 -> stage2_ln1_dp3_ep6_tp0
	stage2_ln1_dp3_ep5_tp1 -> stage2_mha_dp3_ep5_tp1
	stage2_mha_dp3_ep5_tp1 -> stage2_moe_gate_dp3_ep5_tp1
	stage2_moe_gate_dp3_ep5_tp1 -> stage2_expert1_dp3_ep5_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep5_tp1 -> stage2_expert2_dp3_ep5_tp1 [style=dashed]
	stage2_expert1_dp3_ep5_tp1 -> stage2_expert_agg_dp3_ep5_tp1
	stage2_expert2_dp3_ep5_tp1 -> stage2_expert_agg_dp3_ep5_tp1
	stage2_expert_agg_dp3_ep5_tp1 -> stage2_ln2_dp3_ep5_tp1
	stage2_ln2_dp3_ep5_tp1 -> stage2_ln1_dp3_ep6_tp1
	stage2_ln1_dp3_ep6_tp0 -> stage2_mha_dp3_ep6_tp0
	stage2_mha_dp3_ep6_tp0 -> stage2_moe_gate_dp3_ep6_tp0
	stage2_moe_gate_dp3_ep6_tp0 -> stage2_expert1_dp3_ep6_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep6_tp0 -> stage2_expert2_dp3_ep6_tp0 [style=dashed]
	stage2_expert1_dp3_ep6_tp0 -> stage2_expert_agg_dp3_ep6_tp0
	stage2_expert2_dp3_ep6_tp0 -> stage2_expert_agg_dp3_ep6_tp0
	stage2_expert_agg_dp3_ep6_tp0 -> stage2_ln2_dp3_ep6_tp0
	stage2_ln2_dp3_ep6_tp0 -> stage2_ln1_dp3_ep7_tp0
	stage2_ln1_dp3_ep6_tp1 -> stage2_mha_dp3_ep6_tp1
	stage2_mha_dp3_ep6_tp1 -> stage2_moe_gate_dp3_ep6_tp1
	stage2_moe_gate_dp3_ep6_tp1 -> stage2_expert1_dp3_ep6_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep6_tp1 -> stage2_expert2_dp3_ep6_tp1 [style=dashed]
	stage2_expert1_dp3_ep6_tp1 -> stage2_expert_agg_dp3_ep6_tp1
	stage2_expert2_dp3_ep6_tp1 -> stage2_expert_agg_dp3_ep6_tp1
	stage2_expert_agg_dp3_ep6_tp1 -> stage2_ln2_dp3_ep6_tp1
	stage2_ln2_dp3_ep6_tp1 -> stage2_ln1_dp3_ep7_tp1
	stage2_ln1_dp3_ep7_tp0 -> stage2_mha_dp3_ep7_tp0
	stage2_mha_dp3_ep7_tp0 -> stage2_moe_gate_dp3_ep7_tp0
	stage2_moe_gate_dp3_ep7_tp0 -> stage2_expert1_dp3_ep7_tp0 [style=dashed]
	stage2_moe_gate_dp3_ep7_tp0 -> stage2_expert2_dp3_ep7_tp0 [style=dashed]
	stage2_expert1_dp3_ep7_tp0 -> stage2_expert_agg_dp3_ep7_tp0
	stage2_expert2_dp3_ep7_tp0 -> stage2_expert_agg_dp3_ep7_tp0
	stage2_expert_agg_dp3_ep7_tp0 -> stage2_ln2_dp3_ep7_tp0
	stage2_ln2_dp3_ep7_tp0 -> output
	stage2_ln1_dp3_ep7_tp1 -> stage2_mha_dp3_ep7_tp1
	stage2_mha_dp3_ep7_tp1 -> stage2_moe_gate_dp3_ep7_tp1
	stage2_moe_gate_dp3_ep7_tp1 -> stage2_expert1_dp3_ep7_tp1 [style=dashed]
	stage2_moe_gate_dp3_ep7_tp1 -> stage2_expert2_dp3_ep7_tp1 [style=dashed]
	stage2_expert1_dp3_ep7_tp1 -> stage2_expert_agg_dp3_ep7_tp1
	stage2_expert2_dp3_ep7_tp1 -> stage2_expert_agg_dp3_ep7_tp1
	stage2_expert_agg_dp3_ep7_tp1 -> stage2_ln2_dp3_ep7_tp1
	stage2_ln2_dp3_ep7_tp1 -> output
}
