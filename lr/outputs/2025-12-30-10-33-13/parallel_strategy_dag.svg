<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9000pt" height="19pt"
 viewBox="0.00 0.00 2160.00 4.47" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.03 0.03) rotate(0) translate(4 662.06)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-662.06 321846,-662.06 321846,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_dp_0</title>
<path fill="lightgray" stroke="black" d="M514,-179.52C514,-179.52 80802,-179.52 80802,-179.52 80808,-179.52 80814,-185.52 80814,-191.52 80814,-191.52 80814,-638.06 80814,-638.06 80814,-644.06 80808,-650.06 80802,-650.06 80802,-650.06 514,-650.06 514,-650.06 508,-650.06 502,-644.06 502,-638.06 502,-638.06 502,-191.52 502,-191.52 502,-185.52 508,-179.52 514,-179.52"/>
<text text-anchor="middle" x="40658" y="-634.86" font-family="Times,serif" font-size="14.00">DP Replica 0 (GPUs 0&#45;31)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pp1_dp0</title>
<path fill="lightcyan" stroke="black" d="M40674,-187.52C40674,-187.52 80794,-187.52 80794,-187.52 80800,-187.52 80806,-193.52 80806,-199.52 80806,-199.52 80806,-607.06 80806,-607.06 80806,-613.06 80800,-619.06 80794,-619.06 80794,-619.06 40674,-619.06 40674,-619.06 40668,-619.06 40662,-613.06 40662,-607.06 40662,-607.06 40662,-199.52 40662,-199.52 40662,-193.52 40668,-187.52 40674,-187.52"/>
<text text-anchor="middle" x="60734" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 1: Layers 1&#45;8 (GPUs 0&#45;15)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_dp0_pp1_layer1_attn</title>
<path fill="lightpink" stroke="black" d="M79679,-335.52C79679,-335.52 80786,-335.52 80786,-335.52 80792,-335.52 80798,-341.52 80798,-347.52 80798,-347.52 80798,-550.06 80798,-550.06 80798,-556.06 80792,-562.06 80786,-562.06 80786,-562.06 79679,-562.06 79679,-562.06 79673,-562.06 79667,-556.06 79667,-550.06 79667,-550.06 79667,-347.52 79667,-347.52 79667,-341.52 79673,-335.52 79679,-335.52"/>
<text text-anchor="middle" x="80232.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 1 Attention (TP=4)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_dp0_pp1_layer1_moe</title>
<path fill="lightyellow" stroke="black" d="M75801,-195.52C75801,-195.52 79647,-195.52 79647,-195.52 79653,-195.52 79659,-201.52 79659,-207.52 79659,-207.52 79659,-576.06 79659,-576.06 79659,-582.06 79653,-588.06 79647,-588.06 79647,-588.06 75801,-588.06 75801,-588.06 75795,-588.06 75789,-582.06 75789,-576.06 75789,-576.06 75789,-207.52 75789,-207.52 75789,-201.52 75795,-195.52 75801,-195.52"/>
<text text-anchor="middle" x="77724" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 1 MoE (EP=16)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_dp0_pp1_layer2_attn</title>
<path fill="lightpink" stroke="black" d="M74662,-335.52C74662,-335.52 75769,-335.52 75769,-335.52 75775,-335.52 75781,-341.52 75781,-347.52 75781,-347.52 75781,-550.06 75781,-550.06 75781,-556.06 75775,-562.06 75769,-562.06 75769,-562.06 74662,-562.06 74662,-562.06 74656,-562.06 74650,-556.06 74650,-550.06 74650,-550.06 74650,-347.52 74650,-347.52 74650,-341.52 74656,-335.52 74662,-335.52"/>
<text text-anchor="middle" x="75215.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 2 Attention (TP=4)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_dp0_pp1_layer2_moe</title>
<path fill="lightyellow" stroke="black" d="M70784,-195.52C70784,-195.52 74630,-195.52 74630,-195.52 74636,-195.52 74642,-201.52 74642,-207.52 74642,-207.52 74642,-576.06 74642,-576.06 74642,-582.06 74636,-588.06 74630,-588.06 74630,-588.06 70784,-588.06 70784,-588.06 70778,-588.06 70772,-582.06 70772,-576.06 70772,-576.06 70772,-207.52 70772,-207.52 70772,-201.52 70778,-195.52 70784,-195.52"/>
<text text-anchor="middle" x="72707" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 2 MoE (EP=16)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_dp0_pp1_layer3_attn</title>
<path fill="lightpink" stroke="black" d="M69645,-335.52C69645,-335.52 70752,-335.52 70752,-335.52 70758,-335.52 70764,-341.52 70764,-347.52 70764,-347.52 70764,-550.06 70764,-550.06 70764,-556.06 70758,-562.06 70752,-562.06 70752,-562.06 69645,-562.06 69645,-562.06 69639,-562.06 69633,-556.06 69633,-550.06 69633,-550.06 69633,-347.52 69633,-347.52 69633,-341.52 69639,-335.52 69645,-335.52"/>
<text text-anchor="middle" x="70198.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 3 Attention (TP=4)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_dp0_pp1_layer3_moe</title>
<path fill="lightyellow" stroke="black" d="M65767,-195.52C65767,-195.52 69613,-195.52 69613,-195.52 69619,-195.52 69625,-201.52 69625,-207.52 69625,-207.52 69625,-576.06 69625,-576.06 69625,-582.06 69619,-588.06 69613,-588.06 69613,-588.06 65767,-588.06 65767,-588.06 65761,-588.06 65755,-582.06 65755,-576.06 65755,-576.06 65755,-207.52 65755,-207.52 65755,-201.52 65761,-195.52 65767,-195.52"/>
<text text-anchor="middle" x="67690" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 3 MoE (EP=16)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_dp0_pp1_layer4_attn</title>
<path fill="lightpink" stroke="black" d="M64628,-335.52C64628,-335.52 65735,-335.52 65735,-335.52 65741,-335.52 65747,-341.52 65747,-347.52 65747,-347.52 65747,-550.06 65747,-550.06 65747,-556.06 65741,-562.06 65735,-562.06 65735,-562.06 64628,-562.06 64628,-562.06 64622,-562.06 64616,-556.06 64616,-550.06 64616,-550.06 64616,-347.52 64616,-347.52 64616,-341.52 64622,-335.52 64628,-335.52"/>
<text text-anchor="middle" x="65181.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 4 Attention (TP=4)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_dp0_pp1_layer4_moe</title>
<path fill="lightyellow" stroke="black" d="M60750,-195.52C60750,-195.52 64596,-195.52 64596,-195.52 64602,-195.52 64608,-201.52 64608,-207.52 64608,-207.52 64608,-576.06 64608,-576.06 64608,-582.06 64602,-588.06 64596,-588.06 64596,-588.06 60750,-588.06 60750,-588.06 60744,-588.06 60738,-582.06 60738,-576.06 60738,-576.06 60738,-207.52 60738,-207.52 60738,-201.52 60744,-195.52 60750,-195.52"/>
<text text-anchor="middle" x="62673" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 4 MoE (EP=16)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_dp0_pp1_layer5_attn</title>
<path fill="lightpink" stroke="black" d="M59611,-335.52C59611,-335.52 60718,-335.52 60718,-335.52 60724,-335.52 60730,-341.52 60730,-347.52 60730,-347.52 60730,-550.06 60730,-550.06 60730,-556.06 60724,-562.06 60718,-562.06 60718,-562.06 59611,-562.06 59611,-562.06 59605,-562.06 59599,-556.06 59599,-550.06 59599,-550.06 59599,-347.52 59599,-347.52 59599,-341.52 59605,-335.52 59611,-335.52"/>
<text text-anchor="middle" x="60164.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 5 Attention (TP=4)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_dp0_pp1_layer5_moe</title>
<path fill="lightyellow" stroke="black" d="M55733,-195.52C55733,-195.52 59579,-195.52 59579,-195.52 59585,-195.52 59591,-201.52 59591,-207.52 59591,-207.52 59591,-576.06 59591,-576.06 59591,-582.06 59585,-588.06 59579,-588.06 59579,-588.06 55733,-588.06 55733,-588.06 55727,-588.06 55721,-582.06 55721,-576.06 55721,-576.06 55721,-207.52 55721,-207.52 55721,-201.52 55727,-195.52 55733,-195.52"/>
<text text-anchor="middle" x="57656" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 5 MoE (EP=16)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_dp0_pp1_layer6_attn</title>
<path fill="lightpink" stroke="black" d="M54594,-335.52C54594,-335.52 55701,-335.52 55701,-335.52 55707,-335.52 55713,-341.52 55713,-347.52 55713,-347.52 55713,-550.06 55713,-550.06 55713,-556.06 55707,-562.06 55701,-562.06 55701,-562.06 54594,-562.06 54594,-562.06 54588,-562.06 54582,-556.06 54582,-550.06 54582,-550.06 54582,-347.52 54582,-347.52 54582,-341.52 54588,-335.52 54594,-335.52"/>
<text text-anchor="middle" x="55147.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 6 Attention (TP=4)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_dp0_pp1_layer6_moe</title>
<path fill="lightyellow" stroke="black" d="M50716,-195.52C50716,-195.52 54562,-195.52 54562,-195.52 54568,-195.52 54574,-201.52 54574,-207.52 54574,-207.52 54574,-576.06 54574,-576.06 54574,-582.06 54568,-588.06 54562,-588.06 54562,-588.06 50716,-588.06 50716,-588.06 50710,-588.06 50704,-582.06 50704,-576.06 50704,-576.06 50704,-207.52 50704,-207.52 50704,-201.52 50710,-195.52 50716,-195.52"/>
<text text-anchor="middle" x="52639" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 6 MoE (EP=16)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_dp0_pp1_layer7_attn</title>
<path fill="lightpink" stroke="black" d="M49577,-335.52C49577,-335.52 50684,-335.52 50684,-335.52 50690,-335.52 50696,-341.52 50696,-347.52 50696,-347.52 50696,-550.06 50696,-550.06 50696,-556.06 50690,-562.06 50684,-562.06 50684,-562.06 49577,-562.06 49577,-562.06 49571,-562.06 49565,-556.06 49565,-550.06 49565,-550.06 49565,-347.52 49565,-347.52 49565,-341.52 49571,-335.52 49577,-335.52"/>
<text text-anchor="middle" x="50130.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 7 Attention (TP=4)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_dp0_pp1_layer7_moe</title>
<path fill="lightyellow" stroke="black" d="M45699,-195.52C45699,-195.52 49545,-195.52 49545,-195.52 49551,-195.52 49557,-201.52 49557,-207.52 49557,-207.52 49557,-576.06 49557,-576.06 49557,-582.06 49551,-588.06 49545,-588.06 49545,-588.06 45699,-588.06 45699,-588.06 45693,-588.06 45687,-582.06 45687,-576.06 45687,-576.06 45687,-207.52 45687,-207.52 45687,-201.52 45693,-195.52 45699,-195.52"/>
<text text-anchor="middle" x="47622" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 7 MoE (EP=16)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_dp0_pp1_layer8_attn</title>
<path fill="lightpink" stroke="black" d="M44560,-335.52C44560,-335.52 45667,-335.52 45667,-335.52 45673,-335.52 45679,-341.52 45679,-347.52 45679,-347.52 45679,-550.06 45679,-550.06 45679,-556.06 45673,-562.06 45667,-562.06 45667,-562.06 44560,-562.06 44560,-562.06 44554,-562.06 44548,-556.06 44548,-550.06 44548,-550.06 44548,-347.52 44548,-347.52 44548,-341.52 44554,-335.52 44560,-335.52"/>
<text text-anchor="middle" x="45113.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 8 Attention (TP=4)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_dp0_pp1_layer8_moe</title>
<path fill="lightyellow" stroke="black" d="M40682,-195.52C40682,-195.52 44528,-195.52 44528,-195.52 44534,-195.52 44540,-201.52 44540,-207.52 44540,-207.52 44540,-576.06 44540,-576.06 44540,-582.06 44534,-588.06 44528,-588.06 44528,-588.06 40682,-588.06 40682,-588.06 40676,-588.06 40670,-582.06 40670,-576.06 40670,-576.06 40670,-207.52 40670,-207.52 40670,-201.52 40676,-195.52 40682,-195.52"/>
<text text-anchor="middle" x="42605" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 8 MoE (EP=16)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_pp2_dp0</title>
<path fill="lightcyan" stroke="black" d="M522,-187.52C522,-187.52 40642,-187.52 40642,-187.52 40648,-187.52 40654,-193.52 40654,-199.52 40654,-199.52 40654,-607.06 40654,-607.06 40654,-613.06 40648,-619.06 40642,-619.06 40642,-619.06 522,-619.06 522,-619.06 516,-619.06 510,-613.06 510,-607.06 510,-607.06 510,-199.52 510,-199.52 510,-193.52 516,-187.52 522,-187.52"/>
<text text-anchor="middle" x="20582" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 2: Layers 9&#45;16 (GPUs 16&#45;31)</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_dp0_pp2_layer9_attn</title>
<path fill="lightpink" stroke="black" d="M39527,-335.52C39527,-335.52 40634,-335.52 40634,-335.52 40640,-335.52 40646,-341.52 40646,-347.52 40646,-347.52 40646,-550.06 40646,-550.06 40646,-556.06 40640,-562.06 40634,-562.06 40634,-562.06 39527,-562.06 39527,-562.06 39521,-562.06 39515,-556.06 39515,-550.06 39515,-550.06 39515,-347.52 39515,-347.52 39515,-341.52 39521,-335.52 39527,-335.52"/>
<text text-anchor="middle" x="40080.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 9 Attention (TP=4)</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_dp0_pp2_layer9_moe</title>
<path fill="lightyellow" stroke="black" d="M35649,-195.52C35649,-195.52 39495,-195.52 39495,-195.52 39501,-195.52 39507,-201.52 39507,-207.52 39507,-207.52 39507,-576.06 39507,-576.06 39507,-582.06 39501,-588.06 39495,-588.06 39495,-588.06 35649,-588.06 35649,-588.06 35643,-588.06 35637,-582.06 35637,-576.06 35637,-576.06 35637,-207.52 35637,-207.52 35637,-201.52 35643,-195.52 35649,-195.52"/>
<text text-anchor="middle" x="37572" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 9 MoE (EP=16)</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_dp0_pp2_layer10_attn</title>
<path fill="lightpink" stroke="black" d="M34510,-335.52C34510,-335.52 35617,-335.52 35617,-335.52 35623,-335.52 35629,-341.52 35629,-347.52 35629,-347.52 35629,-550.06 35629,-550.06 35629,-556.06 35623,-562.06 35617,-562.06 35617,-562.06 34510,-562.06 34510,-562.06 34504,-562.06 34498,-556.06 34498,-550.06 34498,-550.06 34498,-347.52 34498,-347.52 34498,-341.52 34504,-335.52 34510,-335.52"/>
<text text-anchor="middle" x="35063.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 10 Attention (TP=4)</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_dp0_pp2_layer10_moe</title>
<path fill="lightyellow" stroke="black" d="M30632,-195.52C30632,-195.52 34478,-195.52 34478,-195.52 34484,-195.52 34490,-201.52 34490,-207.52 34490,-207.52 34490,-576.06 34490,-576.06 34490,-582.06 34484,-588.06 34478,-588.06 34478,-588.06 30632,-588.06 30632,-588.06 30626,-588.06 30620,-582.06 30620,-576.06 30620,-576.06 30620,-207.52 30620,-207.52 30620,-201.52 30626,-195.52 30632,-195.52"/>
<text text-anchor="middle" x="32555" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 10 MoE (EP=16)</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_dp0_pp2_layer11_attn</title>
<path fill="lightpink" stroke="black" d="M29493,-335.52C29493,-335.52 30600,-335.52 30600,-335.52 30606,-335.52 30612,-341.52 30612,-347.52 30612,-347.52 30612,-550.06 30612,-550.06 30612,-556.06 30606,-562.06 30600,-562.06 30600,-562.06 29493,-562.06 29493,-562.06 29487,-562.06 29481,-556.06 29481,-550.06 29481,-550.06 29481,-347.52 29481,-347.52 29481,-341.52 29487,-335.52 29493,-335.52"/>
<text text-anchor="middle" x="30046.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 11 Attention (TP=4)</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_dp0_pp2_layer11_moe</title>
<path fill="lightyellow" stroke="black" d="M25615,-195.52C25615,-195.52 29461,-195.52 29461,-195.52 29467,-195.52 29473,-201.52 29473,-207.52 29473,-207.52 29473,-576.06 29473,-576.06 29473,-582.06 29467,-588.06 29461,-588.06 29461,-588.06 25615,-588.06 25615,-588.06 25609,-588.06 25603,-582.06 25603,-576.06 25603,-576.06 25603,-207.52 25603,-207.52 25603,-201.52 25609,-195.52 25615,-195.52"/>
<text text-anchor="middle" x="27538" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 11 MoE (EP=16)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_dp0_pp2_layer12_attn</title>
<path fill="lightpink" stroke="black" d="M24476,-335.52C24476,-335.52 25583,-335.52 25583,-335.52 25589,-335.52 25595,-341.52 25595,-347.52 25595,-347.52 25595,-550.06 25595,-550.06 25595,-556.06 25589,-562.06 25583,-562.06 25583,-562.06 24476,-562.06 24476,-562.06 24470,-562.06 24464,-556.06 24464,-550.06 24464,-550.06 24464,-347.52 24464,-347.52 24464,-341.52 24470,-335.52 24476,-335.52"/>
<text text-anchor="middle" x="25029.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 12 Attention (TP=4)</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_dp0_pp2_layer12_moe</title>
<path fill="lightyellow" stroke="black" d="M20598,-195.52C20598,-195.52 24444,-195.52 24444,-195.52 24450,-195.52 24456,-201.52 24456,-207.52 24456,-207.52 24456,-576.06 24456,-576.06 24456,-582.06 24450,-588.06 24444,-588.06 24444,-588.06 20598,-588.06 20598,-588.06 20592,-588.06 20586,-582.06 20586,-576.06 20586,-576.06 20586,-207.52 20586,-207.52 20586,-201.52 20592,-195.52 20598,-195.52"/>
<text text-anchor="middle" x="22521" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 12 MoE (EP=16)</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_dp0_pp2_layer13_attn</title>
<path fill="lightpink" stroke="black" d="M19459,-335.52C19459,-335.52 20566,-335.52 20566,-335.52 20572,-335.52 20578,-341.52 20578,-347.52 20578,-347.52 20578,-550.06 20578,-550.06 20578,-556.06 20572,-562.06 20566,-562.06 20566,-562.06 19459,-562.06 19459,-562.06 19453,-562.06 19447,-556.06 19447,-550.06 19447,-550.06 19447,-347.52 19447,-347.52 19447,-341.52 19453,-335.52 19459,-335.52"/>
<text text-anchor="middle" x="20012.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 13 Attention (TP=4)</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_dp0_pp2_layer13_moe</title>
<path fill="lightyellow" stroke="black" d="M15581,-195.52C15581,-195.52 19427,-195.52 19427,-195.52 19433,-195.52 19439,-201.52 19439,-207.52 19439,-207.52 19439,-576.06 19439,-576.06 19439,-582.06 19433,-588.06 19427,-588.06 19427,-588.06 15581,-588.06 15581,-588.06 15575,-588.06 15569,-582.06 15569,-576.06 15569,-576.06 15569,-207.52 15569,-207.52 15569,-201.52 15575,-195.52 15581,-195.52"/>
<text text-anchor="middle" x="17504" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 13 MoE (EP=16)</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_dp0_pp2_layer14_attn</title>
<path fill="lightpink" stroke="black" d="M14442,-335.52C14442,-335.52 15549,-335.52 15549,-335.52 15555,-335.52 15561,-341.52 15561,-347.52 15561,-347.52 15561,-550.06 15561,-550.06 15561,-556.06 15555,-562.06 15549,-562.06 15549,-562.06 14442,-562.06 14442,-562.06 14436,-562.06 14430,-556.06 14430,-550.06 14430,-550.06 14430,-347.52 14430,-347.52 14430,-341.52 14436,-335.52 14442,-335.52"/>
<text text-anchor="middle" x="14995.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 14 Attention (TP=4)</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_dp0_pp2_layer14_moe</title>
<path fill="lightyellow" stroke="black" d="M10564,-195.52C10564,-195.52 14410,-195.52 14410,-195.52 14416,-195.52 14422,-201.52 14422,-207.52 14422,-207.52 14422,-576.06 14422,-576.06 14422,-582.06 14416,-588.06 14410,-588.06 14410,-588.06 10564,-588.06 10564,-588.06 10558,-588.06 10552,-582.06 10552,-576.06 10552,-576.06 10552,-207.52 10552,-207.52 10552,-201.52 10558,-195.52 10564,-195.52"/>
<text text-anchor="middle" x="12487" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 14 MoE (EP=16)</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_dp0_pp2_layer15_attn</title>
<path fill="lightpink" stroke="black" d="M9425,-335.52C9425,-335.52 10532,-335.52 10532,-335.52 10538,-335.52 10544,-341.52 10544,-347.52 10544,-347.52 10544,-550.06 10544,-550.06 10544,-556.06 10538,-562.06 10532,-562.06 10532,-562.06 9425,-562.06 9425,-562.06 9419,-562.06 9413,-556.06 9413,-550.06 9413,-550.06 9413,-347.52 9413,-347.52 9413,-341.52 9419,-335.52 9425,-335.52"/>
<text text-anchor="middle" x="9978.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 15 Attention (TP=4)</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_dp0_pp2_layer15_moe</title>
<path fill="lightyellow" stroke="black" d="M5547,-195.52C5547,-195.52 9393,-195.52 9393,-195.52 9399,-195.52 9405,-201.52 9405,-207.52 9405,-207.52 9405,-576.06 9405,-576.06 9405,-582.06 9399,-588.06 9393,-588.06 9393,-588.06 5547,-588.06 5547,-588.06 5541,-588.06 5535,-582.06 5535,-576.06 5535,-576.06 5535,-207.52 5535,-207.52 5535,-201.52 5541,-195.52 5547,-195.52"/>
<text text-anchor="middle" x="7470" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 15 MoE (EP=16)</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_dp0_pp2_layer16_attn</title>
<path fill="lightpink" stroke="black" d="M4408,-335.52C4408,-335.52 5515,-335.52 5515,-335.52 5521,-335.52 5527,-341.52 5527,-347.52 5527,-347.52 5527,-550.06 5527,-550.06 5527,-556.06 5521,-562.06 5515,-562.06 5515,-562.06 4408,-562.06 4408,-562.06 4402,-562.06 4396,-556.06 4396,-550.06 4396,-550.06 4396,-347.52 4396,-347.52 4396,-341.52 4402,-335.52 4408,-335.52"/>
<text text-anchor="middle" x="4961.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 16 Attention (TP=4)</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_dp0_pp2_layer16_moe</title>
<path fill="lightyellow" stroke="black" d="M530,-195.52C530,-195.52 4376,-195.52 4376,-195.52 4382,-195.52 4388,-201.52 4388,-207.52 4388,-207.52 4388,-576.06 4388,-576.06 4388,-582.06 4382,-588.06 4376,-588.06 4376,-588.06 530,-588.06 530,-588.06 524,-588.06 518,-582.06 518,-576.06 518,-576.06 518,-207.52 518,-207.52 518,-201.52 524,-195.52 530,-195.52"/>
<text text-anchor="middle" x="2453" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 16 MoE (EP=16)</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_dp_1</title>
<path fill="lightgray" stroke="black" d="M80854,-179.52C80854,-179.52 161142,-179.52 161142,-179.52 161148,-179.52 161154,-185.52 161154,-191.52 161154,-191.52 161154,-638.06 161154,-638.06 161154,-644.06 161148,-650.06 161142,-650.06 161142,-650.06 80854,-650.06 80854,-650.06 80848,-650.06 80842,-644.06 80842,-638.06 80842,-638.06 80842,-191.52 80842,-191.52 80842,-185.52 80848,-179.52 80854,-179.52"/>
<text text-anchor="middle" x="120998" y="-634.86" font-family="Times,serif" font-size="14.00">DP Replica 1 (GPUs 32&#45;63)</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_pp1_dp1</title>
<path fill="lightcyan" stroke="black" d="M121014,-187.52C121014,-187.52 161134,-187.52 161134,-187.52 161140,-187.52 161146,-193.52 161146,-199.52 161146,-199.52 161146,-607.06 161146,-607.06 161146,-613.06 161140,-619.06 161134,-619.06 161134,-619.06 121014,-619.06 121014,-619.06 121008,-619.06 121002,-613.06 121002,-607.06 121002,-607.06 121002,-199.52 121002,-199.52 121002,-193.52 121008,-187.52 121014,-187.52"/>
<text text-anchor="middle" x="141074" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 1: Layers 1&#45;8 (GPUs 32&#45;47)</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_dp1_pp1_layer1_attn</title>
<path fill="lightpink" stroke="black" d="M160019,-335.52C160019,-335.52 161126,-335.52 161126,-335.52 161132,-335.52 161138,-341.52 161138,-347.52 161138,-347.52 161138,-550.06 161138,-550.06 161138,-556.06 161132,-562.06 161126,-562.06 161126,-562.06 160019,-562.06 160019,-562.06 160013,-562.06 160007,-556.06 160007,-550.06 160007,-550.06 160007,-347.52 160007,-347.52 160007,-341.52 160013,-335.52 160019,-335.52"/>
<text text-anchor="middle" x="160572.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 1 Attention (TP=4)</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_dp1_pp1_layer1_moe</title>
<path fill="lightyellow" stroke="black" d="M156141,-195.52C156141,-195.52 159987,-195.52 159987,-195.52 159993,-195.52 159999,-201.52 159999,-207.52 159999,-207.52 159999,-576.06 159999,-576.06 159999,-582.06 159993,-588.06 159987,-588.06 159987,-588.06 156141,-588.06 156141,-588.06 156135,-588.06 156129,-582.06 156129,-576.06 156129,-576.06 156129,-207.52 156129,-207.52 156129,-201.52 156135,-195.52 156141,-195.52"/>
<text text-anchor="middle" x="158064" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 1 MoE (EP=16)</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_dp1_pp1_layer2_attn</title>
<path fill="lightpink" stroke="black" d="M155002,-335.52C155002,-335.52 156109,-335.52 156109,-335.52 156115,-335.52 156121,-341.52 156121,-347.52 156121,-347.52 156121,-550.06 156121,-550.06 156121,-556.06 156115,-562.06 156109,-562.06 156109,-562.06 155002,-562.06 155002,-562.06 154996,-562.06 154990,-556.06 154990,-550.06 154990,-550.06 154990,-347.52 154990,-347.52 154990,-341.52 154996,-335.52 155002,-335.52"/>
<text text-anchor="middle" x="155555.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 2 Attention (TP=4)</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_dp1_pp1_layer2_moe</title>
<path fill="lightyellow" stroke="black" d="M151124,-195.52C151124,-195.52 154970,-195.52 154970,-195.52 154976,-195.52 154982,-201.52 154982,-207.52 154982,-207.52 154982,-576.06 154982,-576.06 154982,-582.06 154976,-588.06 154970,-588.06 154970,-588.06 151124,-588.06 151124,-588.06 151118,-588.06 151112,-582.06 151112,-576.06 151112,-576.06 151112,-207.52 151112,-207.52 151112,-201.52 151118,-195.52 151124,-195.52"/>
<text text-anchor="middle" x="153047" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 2 MoE (EP=16)</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_dp1_pp1_layer3_attn</title>
<path fill="lightpink" stroke="black" d="M149985,-335.52C149985,-335.52 151092,-335.52 151092,-335.52 151098,-335.52 151104,-341.52 151104,-347.52 151104,-347.52 151104,-550.06 151104,-550.06 151104,-556.06 151098,-562.06 151092,-562.06 151092,-562.06 149985,-562.06 149985,-562.06 149979,-562.06 149973,-556.06 149973,-550.06 149973,-550.06 149973,-347.52 149973,-347.52 149973,-341.52 149979,-335.52 149985,-335.52"/>
<text text-anchor="middle" x="150538.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 3 Attention (TP=4)</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_dp1_pp1_layer3_moe</title>
<path fill="lightyellow" stroke="black" d="M146107,-195.52C146107,-195.52 149953,-195.52 149953,-195.52 149959,-195.52 149965,-201.52 149965,-207.52 149965,-207.52 149965,-576.06 149965,-576.06 149965,-582.06 149959,-588.06 149953,-588.06 149953,-588.06 146107,-588.06 146107,-588.06 146101,-588.06 146095,-582.06 146095,-576.06 146095,-576.06 146095,-207.52 146095,-207.52 146095,-201.52 146101,-195.52 146107,-195.52"/>
<text text-anchor="middle" x="148030" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 3 MoE (EP=16)</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_dp1_pp1_layer4_attn</title>
<path fill="lightpink" stroke="black" d="M144968,-335.52C144968,-335.52 146075,-335.52 146075,-335.52 146081,-335.52 146087,-341.52 146087,-347.52 146087,-347.52 146087,-550.06 146087,-550.06 146087,-556.06 146081,-562.06 146075,-562.06 146075,-562.06 144968,-562.06 144968,-562.06 144962,-562.06 144956,-556.06 144956,-550.06 144956,-550.06 144956,-347.52 144956,-347.52 144956,-341.52 144962,-335.52 144968,-335.52"/>
<text text-anchor="middle" x="145521.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 4 Attention (TP=4)</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_dp1_pp1_layer4_moe</title>
<path fill="lightyellow" stroke="black" d="M141090,-195.52C141090,-195.52 144936,-195.52 144936,-195.52 144942,-195.52 144948,-201.52 144948,-207.52 144948,-207.52 144948,-576.06 144948,-576.06 144948,-582.06 144942,-588.06 144936,-588.06 144936,-588.06 141090,-588.06 141090,-588.06 141084,-588.06 141078,-582.06 141078,-576.06 141078,-576.06 141078,-207.52 141078,-207.52 141078,-201.52 141084,-195.52 141090,-195.52"/>
<text text-anchor="middle" x="143013" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 4 MoE (EP=16)</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_dp1_pp1_layer5_attn</title>
<path fill="lightpink" stroke="black" d="M139951,-335.52C139951,-335.52 141058,-335.52 141058,-335.52 141064,-335.52 141070,-341.52 141070,-347.52 141070,-347.52 141070,-550.06 141070,-550.06 141070,-556.06 141064,-562.06 141058,-562.06 141058,-562.06 139951,-562.06 139951,-562.06 139945,-562.06 139939,-556.06 139939,-550.06 139939,-550.06 139939,-347.52 139939,-347.52 139939,-341.52 139945,-335.52 139951,-335.52"/>
<text text-anchor="middle" x="140504.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 5 Attention (TP=4)</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_dp1_pp1_layer5_moe</title>
<path fill="lightyellow" stroke="black" d="M136073,-195.52C136073,-195.52 139919,-195.52 139919,-195.52 139925,-195.52 139931,-201.52 139931,-207.52 139931,-207.52 139931,-576.06 139931,-576.06 139931,-582.06 139925,-588.06 139919,-588.06 139919,-588.06 136073,-588.06 136073,-588.06 136067,-588.06 136061,-582.06 136061,-576.06 136061,-576.06 136061,-207.52 136061,-207.52 136061,-201.52 136067,-195.52 136073,-195.52"/>
<text text-anchor="middle" x="137996" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 5 MoE (EP=16)</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_dp1_pp1_layer6_attn</title>
<path fill="lightpink" stroke="black" d="M134934,-335.52C134934,-335.52 136041,-335.52 136041,-335.52 136047,-335.52 136053,-341.52 136053,-347.52 136053,-347.52 136053,-550.06 136053,-550.06 136053,-556.06 136047,-562.06 136041,-562.06 136041,-562.06 134934,-562.06 134934,-562.06 134928,-562.06 134922,-556.06 134922,-550.06 134922,-550.06 134922,-347.52 134922,-347.52 134922,-341.52 134928,-335.52 134934,-335.52"/>
<text text-anchor="middle" x="135487.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 6 Attention (TP=4)</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_dp1_pp1_layer6_moe</title>
<path fill="lightyellow" stroke="black" d="M131056,-195.52C131056,-195.52 134902,-195.52 134902,-195.52 134908,-195.52 134914,-201.52 134914,-207.52 134914,-207.52 134914,-576.06 134914,-576.06 134914,-582.06 134908,-588.06 134902,-588.06 134902,-588.06 131056,-588.06 131056,-588.06 131050,-588.06 131044,-582.06 131044,-576.06 131044,-576.06 131044,-207.52 131044,-207.52 131044,-201.52 131050,-195.52 131056,-195.52"/>
<text text-anchor="middle" x="132979" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 6 MoE (EP=16)</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_dp1_pp1_layer7_attn</title>
<path fill="lightpink" stroke="black" d="M129917,-335.52C129917,-335.52 131024,-335.52 131024,-335.52 131030,-335.52 131036,-341.52 131036,-347.52 131036,-347.52 131036,-550.06 131036,-550.06 131036,-556.06 131030,-562.06 131024,-562.06 131024,-562.06 129917,-562.06 129917,-562.06 129911,-562.06 129905,-556.06 129905,-550.06 129905,-550.06 129905,-347.52 129905,-347.52 129905,-341.52 129911,-335.52 129917,-335.52"/>
<text text-anchor="middle" x="130470.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 7 Attention (TP=4)</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_dp1_pp1_layer7_moe</title>
<path fill="lightyellow" stroke="black" d="M126039,-195.52C126039,-195.52 129885,-195.52 129885,-195.52 129891,-195.52 129897,-201.52 129897,-207.52 129897,-207.52 129897,-576.06 129897,-576.06 129897,-582.06 129891,-588.06 129885,-588.06 129885,-588.06 126039,-588.06 126039,-588.06 126033,-588.06 126027,-582.06 126027,-576.06 126027,-576.06 126027,-207.52 126027,-207.52 126027,-201.52 126033,-195.52 126039,-195.52"/>
<text text-anchor="middle" x="127962" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 7 MoE (EP=16)</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_dp1_pp1_layer8_attn</title>
<path fill="lightpink" stroke="black" d="M124900,-335.52C124900,-335.52 126007,-335.52 126007,-335.52 126013,-335.52 126019,-341.52 126019,-347.52 126019,-347.52 126019,-550.06 126019,-550.06 126019,-556.06 126013,-562.06 126007,-562.06 126007,-562.06 124900,-562.06 124900,-562.06 124894,-562.06 124888,-556.06 124888,-550.06 124888,-550.06 124888,-347.52 124888,-347.52 124888,-341.52 124894,-335.52 124900,-335.52"/>
<text text-anchor="middle" x="125453.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 8 Attention (TP=4)</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_dp1_pp1_layer8_moe</title>
<path fill="lightyellow" stroke="black" d="M121022,-195.52C121022,-195.52 124868,-195.52 124868,-195.52 124874,-195.52 124880,-201.52 124880,-207.52 124880,-207.52 124880,-576.06 124880,-576.06 124880,-582.06 124874,-588.06 124868,-588.06 124868,-588.06 121022,-588.06 121022,-588.06 121016,-588.06 121010,-582.06 121010,-576.06 121010,-576.06 121010,-207.52 121010,-207.52 121010,-201.52 121016,-195.52 121022,-195.52"/>
<text text-anchor="middle" x="122945" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 8 MoE (EP=16)</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_pp2_dp1</title>
<path fill="lightcyan" stroke="black" d="M80862,-187.52C80862,-187.52 120982,-187.52 120982,-187.52 120988,-187.52 120994,-193.52 120994,-199.52 120994,-199.52 120994,-607.06 120994,-607.06 120994,-613.06 120988,-619.06 120982,-619.06 120982,-619.06 80862,-619.06 80862,-619.06 80856,-619.06 80850,-613.06 80850,-607.06 80850,-607.06 80850,-199.52 80850,-199.52 80850,-193.52 80856,-187.52 80862,-187.52"/>
<text text-anchor="middle" x="100922" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 2: Layers 9&#45;16 (GPUs 48&#45;63)</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_dp1_pp2_layer9_attn</title>
<path fill="lightpink" stroke="black" d="M119867,-335.52C119867,-335.52 120974,-335.52 120974,-335.52 120980,-335.52 120986,-341.52 120986,-347.52 120986,-347.52 120986,-550.06 120986,-550.06 120986,-556.06 120980,-562.06 120974,-562.06 120974,-562.06 119867,-562.06 119867,-562.06 119861,-562.06 119855,-556.06 119855,-550.06 119855,-550.06 119855,-347.52 119855,-347.52 119855,-341.52 119861,-335.52 119867,-335.52"/>
<text text-anchor="middle" x="120420.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 9 Attention (TP=4)</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_dp1_pp2_layer9_moe</title>
<path fill="lightyellow" stroke="black" d="M115989,-195.52C115989,-195.52 119835,-195.52 119835,-195.52 119841,-195.52 119847,-201.52 119847,-207.52 119847,-207.52 119847,-576.06 119847,-576.06 119847,-582.06 119841,-588.06 119835,-588.06 119835,-588.06 115989,-588.06 115989,-588.06 115983,-588.06 115977,-582.06 115977,-576.06 115977,-576.06 115977,-207.52 115977,-207.52 115977,-201.52 115983,-195.52 115989,-195.52"/>
<text text-anchor="middle" x="117912" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 9 MoE (EP=16)</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_dp1_pp2_layer10_attn</title>
<path fill="lightpink" stroke="black" d="M114850,-335.52C114850,-335.52 115957,-335.52 115957,-335.52 115963,-335.52 115969,-341.52 115969,-347.52 115969,-347.52 115969,-550.06 115969,-550.06 115969,-556.06 115963,-562.06 115957,-562.06 115957,-562.06 114850,-562.06 114850,-562.06 114844,-562.06 114838,-556.06 114838,-550.06 114838,-550.06 114838,-347.52 114838,-347.52 114838,-341.52 114844,-335.52 114850,-335.52"/>
<text text-anchor="middle" x="115403.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 10 Attention (TP=4)</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_dp1_pp2_layer10_moe</title>
<path fill="lightyellow" stroke="black" d="M110972,-195.52C110972,-195.52 114818,-195.52 114818,-195.52 114824,-195.52 114830,-201.52 114830,-207.52 114830,-207.52 114830,-576.06 114830,-576.06 114830,-582.06 114824,-588.06 114818,-588.06 114818,-588.06 110972,-588.06 110972,-588.06 110966,-588.06 110960,-582.06 110960,-576.06 110960,-576.06 110960,-207.52 110960,-207.52 110960,-201.52 110966,-195.52 110972,-195.52"/>
<text text-anchor="middle" x="112895" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 10 MoE (EP=16)</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_dp1_pp2_layer11_attn</title>
<path fill="lightpink" stroke="black" d="M109833,-335.52C109833,-335.52 110940,-335.52 110940,-335.52 110946,-335.52 110952,-341.52 110952,-347.52 110952,-347.52 110952,-550.06 110952,-550.06 110952,-556.06 110946,-562.06 110940,-562.06 110940,-562.06 109833,-562.06 109833,-562.06 109827,-562.06 109821,-556.06 109821,-550.06 109821,-550.06 109821,-347.52 109821,-347.52 109821,-341.52 109827,-335.52 109833,-335.52"/>
<text text-anchor="middle" x="110386.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 11 Attention (TP=4)</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_dp1_pp2_layer11_moe</title>
<path fill="lightyellow" stroke="black" d="M105955,-195.52C105955,-195.52 109801,-195.52 109801,-195.52 109807,-195.52 109813,-201.52 109813,-207.52 109813,-207.52 109813,-576.06 109813,-576.06 109813,-582.06 109807,-588.06 109801,-588.06 109801,-588.06 105955,-588.06 105955,-588.06 105949,-588.06 105943,-582.06 105943,-576.06 105943,-576.06 105943,-207.52 105943,-207.52 105943,-201.52 105949,-195.52 105955,-195.52"/>
<text text-anchor="middle" x="107878" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 11 MoE (EP=16)</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_dp1_pp2_layer12_attn</title>
<path fill="lightpink" stroke="black" d="M104816,-335.52C104816,-335.52 105923,-335.52 105923,-335.52 105929,-335.52 105935,-341.52 105935,-347.52 105935,-347.52 105935,-550.06 105935,-550.06 105935,-556.06 105929,-562.06 105923,-562.06 105923,-562.06 104816,-562.06 104816,-562.06 104810,-562.06 104804,-556.06 104804,-550.06 104804,-550.06 104804,-347.52 104804,-347.52 104804,-341.52 104810,-335.52 104816,-335.52"/>
<text text-anchor="middle" x="105369.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 12 Attention (TP=4)</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_dp1_pp2_layer12_moe</title>
<path fill="lightyellow" stroke="black" d="M100938,-195.52C100938,-195.52 104784,-195.52 104784,-195.52 104790,-195.52 104796,-201.52 104796,-207.52 104796,-207.52 104796,-576.06 104796,-576.06 104796,-582.06 104790,-588.06 104784,-588.06 104784,-588.06 100938,-588.06 100938,-588.06 100932,-588.06 100926,-582.06 100926,-576.06 100926,-576.06 100926,-207.52 100926,-207.52 100926,-201.52 100932,-195.52 100938,-195.52"/>
<text text-anchor="middle" x="102861" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 12 MoE (EP=16)</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_dp1_pp2_layer13_attn</title>
<path fill="lightpink" stroke="black" d="M99799,-335.52C99799,-335.52 100906,-335.52 100906,-335.52 100912,-335.52 100918,-341.52 100918,-347.52 100918,-347.52 100918,-550.06 100918,-550.06 100918,-556.06 100912,-562.06 100906,-562.06 100906,-562.06 99799,-562.06 99799,-562.06 99793,-562.06 99787,-556.06 99787,-550.06 99787,-550.06 99787,-347.52 99787,-347.52 99787,-341.52 99793,-335.52 99799,-335.52"/>
<text text-anchor="middle" x="100352.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 13 Attention (TP=4)</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_dp1_pp2_layer13_moe</title>
<path fill="lightyellow" stroke="black" d="M95921,-195.52C95921,-195.52 99767,-195.52 99767,-195.52 99773,-195.52 99779,-201.52 99779,-207.52 99779,-207.52 99779,-576.06 99779,-576.06 99779,-582.06 99773,-588.06 99767,-588.06 99767,-588.06 95921,-588.06 95921,-588.06 95915,-588.06 95909,-582.06 95909,-576.06 95909,-576.06 95909,-207.52 95909,-207.52 95909,-201.52 95915,-195.52 95921,-195.52"/>
<text text-anchor="middle" x="97844" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 13 MoE (EP=16)</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_dp1_pp2_layer14_attn</title>
<path fill="lightpink" stroke="black" d="M94782,-335.52C94782,-335.52 95889,-335.52 95889,-335.52 95895,-335.52 95901,-341.52 95901,-347.52 95901,-347.52 95901,-550.06 95901,-550.06 95901,-556.06 95895,-562.06 95889,-562.06 95889,-562.06 94782,-562.06 94782,-562.06 94776,-562.06 94770,-556.06 94770,-550.06 94770,-550.06 94770,-347.52 94770,-347.52 94770,-341.52 94776,-335.52 94782,-335.52"/>
<text text-anchor="middle" x="95335.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 14 Attention (TP=4)</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_dp1_pp2_layer14_moe</title>
<path fill="lightyellow" stroke="black" d="M90904,-195.52C90904,-195.52 94750,-195.52 94750,-195.52 94756,-195.52 94762,-201.52 94762,-207.52 94762,-207.52 94762,-576.06 94762,-576.06 94762,-582.06 94756,-588.06 94750,-588.06 94750,-588.06 90904,-588.06 90904,-588.06 90898,-588.06 90892,-582.06 90892,-576.06 90892,-576.06 90892,-207.52 90892,-207.52 90892,-201.52 90898,-195.52 90904,-195.52"/>
<text text-anchor="middle" x="92827" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 14 MoE (EP=16)</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_dp1_pp2_layer15_attn</title>
<path fill="lightpink" stroke="black" d="M89765,-335.52C89765,-335.52 90872,-335.52 90872,-335.52 90878,-335.52 90884,-341.52 90884,-347.52 90884,-347.52 90884,-550.06 90884,-550.06 90884,-556.06 90878,-562.06 90872,-562.06 90872,-562.06 89765,-562.06 89765,-562.06 89759,-562.06 89753,-556.06 89753,-550.06 89753,-550.06 89753,-347.52 89753,-347.52 89753,-341.52 89759,-335.52 89765,-335.52"/>
<text text-anchor="middle" x="90318.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 15 Attention (TP=4)</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_dp1_pp2_layer15_moe</title>
<path fill="lightyellow" stroke="black" d="M85887,-195.52C85887,-195.52 89733,-195.52 89733,-195.52 89739,-195.52 89745,-201.52 89745,-207.52 89745,-207.52 89745,-576.06 89745,-576.06 89745,-582.06 89739,-588.06 89733,-588.06 89733,-588.06 85887,-588.06 85887,-588.06 85881,-588.06 85875,-582.06 85875,-576.06 85875,-576.06 85875,-207.52 85875,-207.52 85875,-201.52 85881,-195.52 85887,-195.52"/>
<text text-anchor="middle" x="87810" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 15 MoE (EP=16)</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_dp1_pp2_layer16_attn</title>
<path fill="lightpink" stroke="black" d="M84748,-335.52C84748,-335.52 85855,-335.52 85855,-335.52 85861,-335.52 85867,-341.52 85867,-347.52 85867,-347.52 85867,-550.06 85867,-550.06 85867,-556.06 85861,-562.06 85855,-562.06 85855,-562.06 84748,-562.06 84748,-562.06 84742,-562.06 84736,-556.06 84736,-550.06 84736,-550.06 84736,-347.52 84736,-347.52 84736,-341.52 84742,-335.52 84748,-335.52"/>
<text text-anchor="middle" x="85301.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 16 Attention (TP=4)</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_dp1_pp2_layer16_moe</title>
<path fill="lightyellow" stroke="black" d="M80870,-195.52C80870,-195.52 84716,-195.52 84716,-195.52 84722,-195.52 84728,-201.52 84728,-207.52 84728,-207.52 84728,-576.06 84728,-576.06 84728,-582.06 84722,-588.06 84716,-588.06 84716,-588.06 80870,-588.06 80870,-588.06 80864,-588.06 80858,-582.06 80858,-576.06 80858,-576.06 80858,-207.52 80858,-207.52 80858,-201.52 80864,-195.52 80870,-195.52"/>
<text text-anchor="middle" x="82793" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 16 MoE (EP=16)</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_dp_2</title>
<path fill="lightgray" stroke="black" d="M161194,-179.52C161194,-179.52 241482,-179.52 241482,-179.52 241488,-179.52 241494,-185.52 241494,-191.52 241494,-191.52 241494,-638.06 241494,-638.06 241494,-644.06 241488,-650.06 241482,-650.06 241482,-650.06 161194,-650.06 161194,-650.06 161188,-650.06 161182,-644.06 161182,-638.06 161182,-638.06 161182,-191.52 161182,-191.52 161182,-185.52 161188,-179.52 161194,-179.52"/>
<text text-anchor="middle" x="201338" y="-634.86" font-family="Times,serif" font-size="14.00">DP Replica 2 (GPUs 64&#45;95)</text>
</g>
<g id="clust72" class="cluster">
<title>cluster_pp1_dp2</title>
<path fill="lightcyan" stroke="black" d="M201354,-187.52C201354,-187.52 241474,-187.52 241474,-187.52 241480,-187.52 241486,-193.52 241486,-199.52 241486,-199.52 241486,-607.06 241486,-607.06 241486,-613.06 241480,-619.06 241474,-619.06 241474,-619.06 201354,-619.06 201354,-619.06 201348,-619.06 201342,-613.06 201342,-607.06 201342,-607.06 201342,-199.52 201342,-199.52 201342,-193.52 201348,-187.52 201354,-187.52"/>
<text text-anchor="middle" x="221414" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 1: Layers 1&#45;8 (GPUs 64&#45;79)</text>
</g>
<g id="clust73" class="cluster">
<title>cluster_dp2_pp1_layer1_attn</title>
<path fill="lightpink" stroke="black" d="M240359,-335.52C240359,-335.52 241466,-335.52 241466,-335.52 241472,-335.52 241478,-341.52 241478,-347.52 241478,-347.52 241478,-550.06 241478,-550.06 241478,-556.06 241472,-562.06 241466,-562.06 241466,-562.06 240359,-562.06 240359,-562.06 240353,-562.06 240347,-556.06 240347,-550.06 240347,-550.06 240347,-347.52 240347,-347.52 240347,-341.52 240353,-335.52 240359,-335.52"/>
<text text-anchor="middle" x="240912.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 1 Attention (TP=4)</text>
</g>
<g id="clust74" class="cluster">
<title>cluster_dp2_pp1_layer1_moe</title>
<path fill="lightyellow" stroke="black" d="M236481,-195.52C236481,-195.52 240327,-195.52 240327,-195.52 240333,-195.52 240339,-201.52 240339,-207.52 240339,-207.52 240339,-576.06 240339,-576.06 240339,-582.06 240333,-588.06 240327,-588.06 240327,-588.06 236481,-588.06 236481,-588.06 236475,-588.06 236469,-582.06 236469,-576.06 236469,-576.06 236469,-207.52 236469,-207.52 236469,-201.52 236475,-195.52 236481,-195.52"/>
<text text-anchor="middle" x="238404" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 1 MoE (EP=16)</text>
</g>
<g id="clust75" class="cluster">
<title>cluster_dp2_pp1_layer2_attn</title>
<path fill="lightpink" stroke="black" d="M235342,-335.52C235342,-335.52 236449,-335.52 236449,-335.52 236455,-335.52 236461,-341.52 236461,-347.52 236461,-347.52 236461,-550.06 236461,-550.06 236461,-556.06 236455,-562.06 236449,-562.06 236449,-562.06 235342,-562.06 235342,-562.06 235336,-562.06 235330,-556.06 235330,-550.06 235330,-550.06 235330,-347.52 235330,-347.52 235330,-341.52 235336,-335.52 235342,-335.52"/>
<text text-anchor="middle" x="235895.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 2 Attention (TP=4)</text>
</g>
<g id="clust76" class="cluster">
<title>cluster_dp2_pp1_layer2_moe</title>
<path fill="lightyellow" stroke="black" d="M231464,-195.52C231464,-195.52 235310,-195.52 235310,-195.52 235316,-195.52 235322,-201.52 235322,-207.52 235322,-207.52 235322,-576.06 235322,-576.06 235322,-582.06 235316,-588.06 235310,-588.06 235310,-588.06 231464,-588.06 231464,-588.06 231458,-588.06 231452,-582.06 231452,-576.06 231452,-576.06 231452,-207.52 231452,-207.52 231452,-201.52 231458,-195.52 231464,-195.52"/>
<text text-anchor="middle" x="233387" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 2 MoE (EP=16)</text>
</g>
<g id="clust77" class="cluster">
<title>cluster_dp2_pp1_layer3_attn</title>
<path fill="lightpink" stroke="black" d="M230325,-335.52C230325,-335.52 231432,-335.52 231432,-335.52 231438,-335.52 231444,-341.52 231444,-347.52 231444,-347.52 231444,-550.06 231444,-550.06 231444,-556.06 231438,-562.06 231432,-562.06 231432,-562.06 230325,-562.06 230325,-562.06 230319,-562.06 230313,-556.06 230313,-550.06 230313,-550.06 230313,-347.52 230313,-347.52 230313,-341.52 230319,-335.52 230325,-335.52"/>
<text text-anchor="middle" x="230878.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 3 Attention (TP=4)</text>
</g>
<g id="clust78" class="cluster">
<title>cluster_dp2_pp1_layer3_moe</title>
<path fill="lightyellow" stroke="black" d="M226447,-195.52C226447,-195.52 230293,-195.52 230293,-195.52 230299,-195.52 230305,-201.52 230305,-207.52 230305,-207.52 230305,-576.06 230305,-576.06 230305,-582.06 230299,-588.06 230293,-588.06 230293,-588.06 226447,-588.06 226447,-588.06 226441,-588.06 226435,-582.06 226435,-576.06 226435,-576.06 226435,-207.52 226435,-207.52 226435,-201.52 226441,-195.52 226447,-195.52"/>
<text text-anchor="middle" x="228370" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 3 MoE (EP=16)</text>
</g>
<g id="clust79" class="cluster">
<title>cluster_dp2_pp1_layer4_attn</title>
<path fill="lightpink" stroke="black" d="M225308,-335.52C225308,-335.52 226415,-335.52 226415,-335.52 226421,-335.52 226427,-341.52 226427,-347.52 226427,-347.52 226427,-550.06 226427,-550.06 226427,-556.06 226421,-562.06 226415,-562.06 226415,-562.06 225308,-562.06 225308,-562.06 225302,-562.06 225296,-556.06 225296,-550.06 225296,-550.06 225296,-347.52 225296,-347.52 225296,-341.52 225302,-335.52 225308,-335.52"/>
<text text-anchor="middle" x="225861.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 4 Attention (TP=4)</text>
</g>
<g id="clust80" class="cluster">
<title>cluster_dp2_pp1_layer4_moe</title>
<path fill="lightyellow" stroke="black" d="M221430,-195.52C221430,-195.52 225276,-195.52 225276,-195.52 225282,-195.52 225288,-201.52 225288,-207.52 225288,-207.52 225288,-576.06 225288,-576.06 225288,-582.06 225282,-588.06 225276,-588.06 225276,-588.06 221430,-588.06 221430,-588.06 221424,-588.06 221418,-582.06 221418,-576.06 221418,-576.06 221418,-207.52 221418,-207.52 221418,-201.52 221424,-195.52 221430,-195.52"/>
<text text-anchor="middle" x="223353" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 4 MoE (EP=16)</text>
</g>
<g id="clust81" class="cluster">
<title>cluster_dp2_pp1_layer5_attn</title>
<path fill="lightpink" stroke="black" d="M220291,-335.52C220291,-335.52 221398,-335.52 221398,-335.52 221404,-335.52 221410,-341.52 221410,-347.52 221410,-347.52 221410,-550.06 221410,-550.06 221410,-556.06 221404,-562.06 221398,-562.06 221398,-562.06 220291,-562.06 220291,-562.06 220285,-562.06 220279,-556.06 220279,-550.06 220279,-550.06 220279,-347.52 220279,-347.52 220279,-341.52 220285,-335.52 220291,-335.52"/>
<text text-anchor="middle" x="220844.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 5 Attention (TP=4)</text>
</g>
<g id="clust82" class="cluster">
<title>cluster_dp2_pp1_layer5_moe</title>
<path fill="lightyellow" stroke="black" d="M216413,-195.52C216413,-195.52 220259,-195.52 220259,-195.52 220265,-195.52 220271,-201.52 220271,-207.52 220271,-207.52 220271,-576.06 220271,-576.06 220271,-582.06 220265,-588.06 220259,-588.06 220259,-588.06 216413,-588.06 216413,-588.06 216407,-588.06 216401,-582.06 216401,-576.06 216401,-576.06 216401,-207.52 216401,-207.52 216401,-201.52 216407,-195.52 216413,-195.52"/>
<text text-anchor="middle" x="218336" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 5 MoE (EP=16)</text>
</g>
<g id="clust83" class="cluster">
<title>cluster_dp2_pp1_layer6_attn</title>
<path fill="lightpink" stroke="black" d="M215274,-335.52C215274,-335.52 216381,-335.52 216381,-335.52 216387,-335.52 216393,-341.52 216393,-347.52 216393,-347.52 216393,-550.06 216393,-550.06 216393,-556.06 216387,-562.06 216381,-562.06 216381,-562.06 215274,-562.06 215274,-562.06 215268,-562.06 215262,-556.06 215262,-550.06 215262,-550.06 215262,-347.52 215262,-347.52 215262,-341.52 215268,-335.52 215274,-335.52"/>
<text text-anchor="middle" x="215827.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 6 Attention (TP=4)</text>
</g>
<g id="clust84" class="cluster">
<title>cluster_dp2_pp1_layer6_moe</title>
<path fill="lightyellow" stroke="black" d="M211396,-195.52C211396,-195.52 215242,-195.52 215242,-195.52 215248,-195.52 215254,-201.52 215254,-207.52 215254,-207.52 215254,-576.06 215254,-576.06 215254,-582.06 215248,-588.06 215242,-588.06 215242,-588.06 211396,-588.06 211396,-588.06 211390,-588.06 211384,-582.06 211384,-576.06 211384,-576.06 211384,-207.52 211384,-207.52 211384,-201.52 211390,-195.52 211396,-195.52"/>
<text text-anchor="middle" x="213319" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 6 MoE (EP=16)</text>
</g>
<g id="clust85" class="cluster">
<title>cluster_dp2_pp1_layer7_attn</title>
<path fill="lightpink" stroke="black" d="M210257,-335.52C210257,-335.52 211364,-335.52 211364,-335.52 211370,-335.52 211376,-341.52 211376,-347.52 211376,-347.52 211376,-550.06 211376,-550.06 211376,-556.06 211370,-562.06 211364,-562.06 211364,-562.06 210257,-562.06 210257,-562.06 210251,-562.06 210245,-556.06 210245,-550.06 210245,-550.06 210245,-347.52 210245,-347.52 210245,-341.52 210251,-335.52 210257,-335.52"/>
<text text-anchor="middle" x="210810.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 7 Attention (TP=4)</text>
</g>
<g id="clust86" class="cluster">
<title>cluster_dp2_pp1_layer7_moe</title>
<path fill="lightyellow" stroke="black" d="M206379,-195.52C206379,-195.52 210225,-195.52 210225,-195.52 210231,-195.52 210237,-201.52 210237,-207.52 210237,-207.52 210237,-576.06 210237,-576.06 210237,-582.06 210231,-588.06 210225,-588.06 210225,-588.06 206379,-588.06 206379,-588.06 206373,-588.06 206367,-582.06 206367,-576.06 206367,-576.06 206367,-207.52 206367,-207.52 206367,-201.52 206373,-195.52 206379,-195.52"/>
<text text-anchor="middle" x="208302" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 7 MoE (EP=16)</text>
</g>
<g id="clust87" class="cluster">
<title>cluster_dp2_pp1_layer8_attn</title>
<path fill="lightpink" stroke="black" d="M205240,-335.52C205240,-335.52 206347,-335.52 206347,-335.52 206353,-335.52 206359,-341.52 206359,-347.52 206359,-347.52 206359,-550.06 206359,-550.06 206359,-556.06 206353,-562.06 206347,-562.06 206347,-562.06 205240,-562.06 205240,-562.06 205234,-562.06 205228,-556.06 205228,-550.06 205228,-550.06 205228,-347.52 205228,-347.52 205228,-341.52 205234,-335.52 205240,-335.52"/>
<text text-anchor="middle" x="205793.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 8 Attention (TP=4)</text>
</g>
<g id="clust88" class="cluster">
<title>cluster_dp2_pp1_layer8_moe</title>
<path fill="lightyellow" stroke="black" d="M201362,-195.52C201362,-195.52 205208,-195.52 205208,-195.52 205214,-195.52 205220,-201.52 205220,-207.52 205220,-207.52 205220,-576.06 205220,-576.06 205220,-582.06 205214,-588.06 205208,-588.06 205208,-588.06 201362,-588.06 201362,-588.06 201356,-588.06 201350,-582.06 201350,-576.06 201350,-576.06 201350,-207.52 201350,-207.52 201350,-201.52 201356,-195.52 201362,-195.52"/>
<text text-anchor="middle" x="203285" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 8 MoE (EP=16)</text>
</g>
<g id="clust89" class="cluster">
<title>cluster_pp2_dp2</title>
<path fill="lightcyan" stroke="black" d="M161202,-187.52C161202,-187.52 201322,-187.52 201322,-187.52 201328,-187.52 201334,-193.52 201334,-199.52 201334,-199.52 201334,-607.06 201334,-607.06 201334,-613.06 201328,-619.06 201322,-619.06 201322,-619.06 161202,-619.06 161202,-619.06 161196,-619.06 161190,-613.06 161190,-607.06 161190,-607.06 161190,-199.52 161190,-199.52 161190,-193.52 161196,-187.52 161202,-187.52"/>
<text text-anchor="middle" x="181262" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 2: Layers 9&#45;16 (GPUs 80&#45;95)</text>
</g>
<g id="clust90" class="cluster">
<title>cluster_dp2_pp2_layer9_attn</title>
<path fill="lightpink" stroke="black" d="M200207,-335.52C200207,-335.52 201314,-335.52 201314,-335.52 201320,-335.52 201326,-341.52 201326,-347.52 201326,-347.52 201326,-550.06 201326,-550.06 201326,-556.06 201320,-562.06 201314,-562.06 201314,-562.06 200207,-562.06 200207,-562.06 200201,-562.06 200195,-556.06 200195,-550.06 200195,-550.06 200195,-347.52 200195,-347.52 200195,-341.52 200201,-335.52 200207,-335.52"/>
<text text-anchor="middle" x="200760.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 9 Attention (TP=4)</text>
</g>
<g id="clust91" class="cluster">
<title>cluster_dp2_pp2_layer9_moe</title>
<path fill="lightyellow" stroke="black" d="M196329,-195.52C196329,-195.52 200175,-195.52 200175,-195.52 200181,-195.52 200187,-201.52 200187,-207.52 200187,-207.52 200187,-576.06 200187,-576.06 200187,-582.06 200181,-588.06 200175,-588.06 200175,-588.06 196329,-588.06 196329,-588.06 196323,-588.06 196317,-582.06 196317,-576.06 196317,-576.06 196317,-207.52 196317,-207.52 196317,-201.52 196323,-195.52 196329,-195.52"/>
<text text-anchor="middle" x="198252" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 9 MoE (EP=16)</text>
</g>
<g id="clust92" class="cluster">
<title>cluster_dp2_pp2_layer10_attn</title>
<path fill="lightpink" stroke="black" d="M195190,-335.52C195190,-335.52 196297,-335.52 196297,-335.52 196303,-335.52 196309,-341.52 196309,-347.52 196309,-347.52 196309,-550.06 196309,-550.06 196309,-556.06 196303,-562.06 196297,-562.06 196297,-562.06 195190,-562.06 195190,-562.06 195184,-562.06 195178,-556.06 195178,-550.06 195178,-550.06 195178,-347.52 195178,-347.52 195178,-341.52 195184,-335.52 195190,-335.52"/>
<text text-anchor="middle" x="195743.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 10 Attention (TP=4)</text>
</g>
<g id="clust93" class="cluster">
<title>cluster_dp2_pp2_layer10_moe</title>
<path fill="lightyellow" stroke="black" d="M191312,-195.52C191312,-195.52 195158,-195.52 195158,-195.52 195164,-195.52 195170,-201.52 195170,-207.52 195170,-207.52 195170,-576.06 195170,-576.06 195170,-582.06 195164,-588.06 195158,-588.06 195158,-588.06 191312,-588.06 191312,-588.06 191306,-588.06 191300,-582.06 191300,-576.06 191300,-576.06 191300,-207.52 191300,-207.52 191300,-201.52 191306,-195.52 191312,-195.52"/>
<text text-anchor="middle" x="193235" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 10 MoE (EP=16)</text>
</g>
<g id="clust94" class="cluster">
<title>cluster_dp2_pp2_layer11_attn</title>
<path fill="lightpink" stroke="black" d="M190173,-335.52C190173,-335.52 191280,-335.52 191280,-335.52 191286,-335.52 191292,-341.52 191292,-347.52 191292,-347.52 191292,-550.06 191292,-550.06 191292,-556.06 191286,-562.06 191280,-562.06 191280,-562.06 190173,-562.06 190173,-562.06 190167,-562.06 190161,-556.06 190161,-550.06 190161,-550.06 190161,-347.52 190161,-347.52 190161,-341.52 190167,-335.52 190173,-335.52"/>
<text text-anchor="middle" x="190726.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 11 Attention (TP=4)</text>
</g>
<g id="clust95" class="cluster">
<title>cluster_dp2_pp2_layer11_moe</title>
<path fill="lightyellow" stroke="black" d="M186295,-195.52C186295,-195.52 190141,-195.52 190141,-195.52 190147,-195.52 190153,-201.52 190153,-207.52 190153,-207.52 190153,-576.06 190153,-576.06 190153,-582.06 190147,-588.06 190141,-588.06 190141,-588.06 186295,-588.06 186295,-588.06 186289,-588.06 186283,-582.06 186283,-576.06 186283,-576.06 186283,-207.52 186283,-207.52 186283,-201.52 186289,-195.52 186295,-195.52"/>
<text text-anchor="middle" x="188218" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 11 MoE (EP=16)</text>
</g>
<g id="clust96" class="cluster">
<title>cluster_dp2_pp2_layer12_attn</title>
<path fill="lightpink" stroke="black" d="M185156,-335.52C185156,-335.52 186263,-335.52 186263,-335.52 186269,-335.52 186275,-341.52 186275,-347.52 186275,-347.52 186275,-550.06 186275,-550.06 186275,-556.06 186269,-562.06 186263,-562.06 186263,-562.06 185156,-562.06 185156,-562.06 185150,-562.06 185144,-556.06 185144,-550.06 185144,-550.06 185144,-347.52 185144,-347.52 185144,-341.52 185150,-335.52 185156,-335.52"/>
<text text-anchor="middle" x="185709.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 12 Attention (TP=4)</text>
</g>
<g id="clust97" class="cluster">
<title>cluster_dp2_pp2_layer12_moe</title>
<path fill="lightyellow" stroke="black" d="M181278,-195.52C181278,-195.52 185124,-195.52 185124,-195.52 185130,-195.52 185136,-201.52 185136,-207.52 185136,-207.52 185136,-576.06 185136,-576.06 185136,-582.06 185130,-588.06 185124,-588.06 185124,-588.06 181278,-588.06 181278,-588.06 181272,-588.06 181266,-582.06 181266,-576.06 181266,-576.06 181266,-207.52 181266,-207.52 181266,-201.52 181272,-195.52 181278,-195.52"/>
<text text-anchor="middle" x="183201" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 12 MoE (EP=16)</text>
</g>
<g id="clust98" class="cluster">
<title>cluster_dp2_pp2_layer13_attn</title>
<path fill="lightpink" stroke="black" d="M180139,-335.52C180139,-335.52 181246,-335.52 181246,-335.52 181252,-335.52 181258,-341.52 181258,-347.52 181258,-347.52 181258,-550.06 181258,-550.06 181258,-556.06 181252,-562.06 181246,-562.06 181246,-562.06 180139,-562.06 180139,-562.06 180133,-562.06 180127,-556.06 180127,-550.06 180127,-550.06 180127,-347.52 180127,-347.52 180127,-341.52 180133,-335.52 180139,-335.52"/>
<text text-anchor="middle" x="180692.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 13 Attention (TP=4)</text>
</g>
<g id="clust99" class="cluster">
<title>cluster_dp2_pp2_layer13_moe</title>
<path fill="lightyellow" stroke="black" d="M176261,-195.52C176261,-195.52 180107,-195.52 180107,-195.52 180113,-195.52 180119,-201.52 180119,-207.52 180119,-207.52 180119,-576.06 180119,-576.06 180119,-582.06 180113,-588.06 180107,-588.06 180107,-588.06 176261,-588.06 176261,-588.06 176255,-588.06 176249,-582.06 176249,-576.06 176249,-576.06 176249,-207.52 176249,-207.52 176249,-201.52 176255,-195.52 176261,-195.52"/>
<text text-anchor="middle" x="178184" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 13 MoE (EP=16)</text>
</g>
<g id="clust100" class="cluster">
<title>cluster_dp2_pp2_layer14_attn</title>
<path fill="lightpink" stroke="black" d="M175122,-335.52C175122,-335.52 176229,-335.52 176229,-335.52 176235,-335.52 176241,-341.52 176241,-347.52 176241,-347.52 176241,-550.06 176241,-550.06 176241,-556.06 176235,-562.06 176229,-562.06 176229,-562.06 175122,-562.06 175122,-562.06 175116,-562.06 175110,-556.06 175110,-550.06 175110,-550.06 175110,-347.52 175110,-347.52 175110,-341.52 175116,-335.52 175122,-335.52"/>
<text text-anchor="middle" x="175675.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 14 Attention (TP=4)</text>
</g>
<g id="clust101" class="cluster">
<title>cluster_dp2_pp2_layer14_moe</title>
<path fill="lightyellow" stroke="black" d="M171244,-195.52C171244,-195.52 175090,-195.52 175090,-195.52 175096,-195.52 175102,-201.52 175102,-207.52 175102,-207.52 175102,-576.06 175102,-576.06 175102,-582.06 175096,-588.06 175090,-588.06 175090,-588.06 171244,-588.06 171244,-588.06 171238,-588.06 171232,-582.06 171232,-576.06 171232,-576.06 171232,-207.52 171232,-207.52 171232,-201.52 171238,-195.52 171244,-195.52"/>
<text text-anchor="middle" x="173167" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 14 MoE (EP=16)</text>
</g>
<g id="clust102" class="cluster">
<title>cluster_dp2_pp2_layer15_attn</title>
<path fill="lightpink" stroke="black" d="M170105,-335.52C170105,-335.52 171212,-335.52 171212,-335.52 171218,-335.52 171224,-341.52 171224,-347.52 171224,-347.52 171224,-550.06 171224,-550.06 171224,-556.06 171218,-562.06 171212,-562.06 171212,-562.06 170105,-562.06 170105,-562.06 170099,-562.06 170093,-556.06 170093,-550.06 170093,-550.06 170093,-347.52 170093,-347.52 170093,-341.52 170099,-335.52 170105,-335.52"/>
<text text-anchor="middle" x="170658.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 15 Attention (TP=4)</text>
</g>
<g id="clust103" class="cluster">
<title>cluster_dp2_pp2_layer15_moe</title>
<path fill="lightyellow" stroke="black" d="M166227,-195.52C166227,-195.52 170073,-195.52 170073,-195.52 170079,-195.52 170085,-201.52 170085,-207.52 170085,-207.52 170085,-576.06 170085,-576.06 170085,-582.06 170079,-588.06 170073,-588.06 170073,-588.06 166227,-588.06 166227,-588.06 166221,-588.06 166215,-582.06 166215,-576.06 166215,-576.06 166215,-207.52 166215,-207.52 166215,-201.52 166221,-195.52 166227,-195.52"/>
<text text-anchor="middle" x="168150" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 15 MoE (EP=16)</text>
</g>
<g id="clust104" class="cluster">
<title>cluster_dp2_pp2_layer16_attn</title>
<path fill="lightpink" stroke="black" d="M165088,-335.52C165088,-335.52 166195,-335.52 166195,-335.52 166201,-335.52 166207,-341.52 166207,-347.52 166207,-347.52 166207,-550.06 166207,-550.06 166207,-556.06 166201,-562.06 166195,-562.06 166195,-562.06 165088,-562.06 165088,-562.06 165082,-562.06 165076,-556.06 165076,-550.06 165076,-550.06 165076,-347.52 165076,-347.52 165076,-341.52 165082,-335.52 165088,-335.52"/>
<text text-anchor="middle" x="165641.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 16 Attention (TP=4)</text>
</g>
<g id="clust105" class="cluster">
<title>cluster_dp2_pp2_layer16_moe</title>
<path fill="lightyellow" stroke="black" d="M161210,-195.52C161210,-195.52 165056,-195.52 165056,-195.52 165062,-195.52 165068,-201.52 165068,-207.52 165068,-207.52 165068,-576.06 165068,-576.06 165068,-582.06 165062,-588.06 165056,-588.06 165056,-588.06 161210,-588.06 161210,-588.06 161204,-588.06 161198,-582.06 161198,-576.06 161198,-576.06 161198,-207.52 161198,-207.52 161198,-201.52 161204,-195.52 161210,-195.52"/>
<text text-anchor="middle" x="163133" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 16 MoE (EP=16)</text>
</g>
<g id="clust106" class="cluster">
<title>cluster_dp_3</title>
<path fill="lightgray" stroke="black" d="M241534,-179.52C241534,-179.52 321822,-179.52 321822,-179.52 321828,-179.52 321834,-185.52 321834,-191.52 321834,-191.52 321834,-638.06 321834,-638.06 321834,-644.06 321828,-650.06 321822,-650.06 321822,-650.06 241534,-650.06 241534,-650.06 241528,-650.06 241522,-644.06 241522,-638.06 241522,-638.06 241522,-191.52 241522,-191.52 241522,-185.52 241528,-179.52 241534,-179.52"/>
<text text-anchor="middle" x="281678" y="-634.86" font-family="Times,serif" font-size="14.00">DP Replica 3 (GPUs 96&#45;127)</text>
</g>
<g id="clust107" class="cluster">
<title>cluster_pp1_dp3</title>
<path fill="lightcyan" stroke="black" d="M281694,-187.52C281694,-187.52 321814,-187.52 321814,-187.52 321820,-187.52 321826,-193.52 321826,-199.52 321826,-199.52 321826,-607.06 321826,-607.06 321826,-613.06 321820,-619.06 321814,-619.06 321814,-619.06 281694,-619.06 281694,-619.06 281688,-619.06 281682,-613.06 281682,-607.06 281682,-607.06 281682,-199.52 281682,-199.52 281682,-193.52 281688,-187.52 281694,-187.52"/>
<text text-anchor="middle" x="301754" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 1: Layers 1&#45;8 (GPUs 96&#45;111)</text>
</g>
<g id="clust108" class="cluster">
<title>cluster_dp3_pp1_layer1_attn</title>
<path fill="lightpink" stroke="black" d="M320699,-335.52C320699,-335.52 321806,-335.52 321806,-335.52 321812,-335.52 321818,-341.52 321818,-347.52 321818,-347.52 321818,-550.06 321818,-550.06 321818,-556.06 321812,-562.06 321806,-562.06 321806,-562.06 320699,-562.06 320699,-562.06 320693,-562.06 320687,-556.06 320687,-550.06 320687,-550.06 320687,-347.52 320687,-347.52 320687,-341.52 320693,-335.52 320699,-335.52"/>
<text text-anchor="middle" x="321252.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 1 Attention (TP=4)</text>
</g>
<g id="clust109" class="cluster">
<title>cluster_dp3_pp1_layer1_moe</title>
<path fill="lightyellow" stroke="black" d="M316821,-195.52C316821,-195.52 320667,-195.52 320667,-195.52 320673,-195.52 320679,-201.52 320679,-207.52 320679,-207.52 320679,-576.06 320679,-576.06 320679,-582.06 320673,-588.06 320667,-588.06 320667,-588.06 316821,-588.06 316821,-588.06 316815,-588.06 316809,-582.06 316809,-576.06 316809,-576.06 316809,-207.52 316809,-207.52 316809,-201.52 316815,-195.52 316821,-195.52"/>
<text text-anchor="middle" x="318744" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 1 MoE (EP=16)</text>
</g>
<g id="clust110" class="cluster">
<title>cluster_dp3_pp1_layer2_attn</title>
<path fill="lightpink" stroke="black" d="M315682,-335.52C315682,-335.52 316789,-335.52 316789,-335.52 316795,-335.52 316801,-341.52 316801,-347.52 316801,-347.52 316801,-550.06 316801,-550.06 316801,-556.06 316795,-562.06 316789,-562.06 316789,-562.06 315682,-562.06 315682,-562.06 315676,-562.06 315670,-556.06 315670,-550.06 315670,-550.06 315670,-347.52 315670,-347.52 315670,-341.52 315676,-335.52 315682,-335.52"/>
<text text-anchor="middle" x="316235.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 2 Attention (TP=4)</text>
</g>
<g id="clust111" class="cluster">
<title>cluster_dp3_pp1_layer2_moe</title>
<path fill="lightyellow" stroke="black" d="M311804,-195.52C311804,-195.52 315650,-195.52 315650,-195.52 315656,-195.52 315662,-201.52 315662,-207.52 315662,-207.52 315662,-576.06 315662,-576.06 315662,-582.06 315656,-588.06 315650,-588.06 315650,-588.06 311804,-588.06 311804,-588.06 311798,-588.06 311792,-582.06 311792,-576.06 311792,-576.06 311792,-207.52 311792,-207.52 311792,-201.52 311798,-195.52 311804,-195.52"/>
<text text-anchor="middle" x="313727" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 2 MoE (EP=16)</text>
</g>
<g id="clust112" class="cluster">
<title>cluster_dp3_pp1_layer3_attn</title>
<path fill="lightpink" stroke="black" d="M310665,-335.52C310665,-335.52 311772,-335.52 311772,-335.52 311778,-335.52 311784,-341.52 311784,-347.52 311784,-347.52 311784,-550.06 311784,-550.06 311784,-556.06 311778,-562.06 311772,-562.06 311772,-562.06 310665,-562.06 310665,-562.06 310659,-562.06 310653,-556.06 310653,-550.06 310653,-550.06 310653,-347.52 310653,-347.52 310653,-341.52 310659,-335.52 310665,-335.52"/>
<text text-anchor="middle" x="311218.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 3 Attention (TP=4)</text>
</g>
<g id="clust113" class="cluster">
<title>cluster_dp3_pp1_layer3_moe</title>
<path fill="lightyellow" stroke="black" d="M306787,-195.52C306787,-195.52 310633,-195.52 310633,-195.52 310639,-195.52 310645,-201.52 310645,-207.52 310645,-207.52 310645,-576.06 310645,-576.06 310645,-582.06 310639,-588.06 310633,-588.06 310633,-588.06 306787,-588.06 306787,-588.06 306781,-588.06 306775,-582.06 306775,-576.06 306775,-576.06 306775,-207.52 306775,-207.52 306775,-201.52 306781,-195.52 306787,-195.52"/>
<text text-anchor="middle" x="308710" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 3 MoE (EP=16)</text>
</g>
<g id="clust114" class="cluster">
<title>cluster_dp3_pp1_layer4_attn</title>
<path fill="lightpink" stroke="black" d="M305648,-335.52C305648,-335.52 306755,-335.52 306755,-335.52 306761,-335.52 306767,-341.52 306767,-347.52 306767,-347.52 306767,-550.06 306767,-550.06 306767,-556.06 306761,-562.06 306755,-562.06 306755,-562.06 305648,-562.06 305648,-562.06 305642,-562.06 305636,-556.06 305636,-550.06 305636,-550.06 305636,-347.52 305636,-347.52 305636,-341.52 305642,-335.52 305648,-335.52"/>
<text text-anchor="middle" x="306201.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 4 Attention (TP=4)</text>
</g>
<g id="clust115" class="cluster">
<title>cluster_dp3_pp1_layer4_moe</title>
<path fill="lightyellow" stroke="black" d="M301770,-195.52C301770,-195.52 305616,-195.52 305616,-195.52 305622,-195.52 305628,-201.52 305628,-207.52 305628,-207.52 305628,-576.06 305628,-576.06 305628,-582.06 305622,-588.06 305616,-588.06 305616,-588.06 301770,-588.06 301770,-588.06 301764,-588.06 301758,-582.06 301758,-576.06 301758,-576.06 301758,-207.52 301758,-207.52 301758,-201.52 301764,-195.52 301770,-195.52"/>
<text text-anchor="middle" x="303693" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 4 MoE (EP=16)</text>
</g>
<g id="clust116" class="cluster">
<title>cluster_dp3_pp1_layer5_attn</title>
<path fill="lightpink" stroke="black" d="M300631,-335.52C300631,-335.52 301738,-335.52 301738,-335.52 301744,-335.52 301750,-341.52 301750,-347.52 301750,-347.52 301750,-550.06 301750,-550.06 301750,-556.06 301744,-562.06 301738,-562.06 301738,-562.06 300631,-562.06 300631,-562.06 300625,-562.06 300619,-556.06 300619,-550.06 300619,-550.06 300619,-347.52 300619,-347.52 300619,-341.52 300625,-335.52 300631,-335.52"/>
<text text-anchor="middle" x="301184.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 5 Attention (TP=4)</text>
</g>
<g id="clust117" class="cluster">
<title>cluster_dp3_pp1_layer5_moe</title>
<path fill="lightyellow" stroke="black" d="M296753,-195.52C296753,-195.52 300599,-195.52 300599,-195.52 300605,-195.52 300611,-201.52 300611,-207.52 300611,-207.52 300611,-576.06 300611,-576.06 300611,-582.06 300605,-588.06 300599,-588.06 300599,-588.06 296753,-588.06 296753,-588.06 296747,-588.06 296741,-582.06 296741,-576.06 296741,-576.06 296741,-207.52 296741,-207.52 296741,-201.52 296747,-195.52 296753,-195.52"/>
<text text-anchor="middle" x="298676" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 5 MoE (EP=16)</text>
</g>
<g id="clust118" class="cluster">
<title>cluster_dp3_pp1_layer6_attn</title>
<path fill="lightpink" stroke="black" d="M295614,-335.52C295614,-335.52 296721,-335.52 296721,-335.52 296727,-335.52 296733,-341.52 296733,-347.52 296733,-347.52 296733,-550.06 296733,-550.06 296733,-556.06 296727,-562.06 296721,-562.06 296721,-562.06 295614,-562.06 295614,-562.06 295608,-562.06 295602,-556.06 295602,-550.06 295602,-550.06 295602,-347.52 295602,-347.52 295602,-341.52 295608,-335.52 295614,-335.52"/>
<text text-anchor="middle" x="296167.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 6 Attention (TP=4)</text>
</g>
<g id="clust119" class="cluster">
<title>cluster_dp3_pp1_layer6_moe</title>
<path fill="lightyellow" stroke="black" d="M291736,-195.52C291736,-195.52 295582,-195.52 295582,-195.52 295588,-195.52 295594,-201.52 295594,-207.52 295594,-207.52 295594,-576.06 295594,-576.06 295594,-582.06 295588,-588.06 295582,-588.06 295582,-588.06 291736,-588.06 291736,-588.06 291730,-588.06 291724,-582.06 291724,-576.06 291724,-576.06 291724,-207.52 291724,-207.52 291724,-201.52 291730,-195.52 291736,-195.52"/>
<text text-anchor="middle" x="293659" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 6 MoE (EP=16)</text>
</g>
<g id="clust120" class="cluster">
<title>cluster_dp3_pp1_layer7_attn</title>
<path fill="lightpink" stroke="black" d="M290597,-335.52C290597,-335.52 291704,-335.52 291704,-335.52 291710,-335.52 291716,-341.52 291716,-347.52 291716,-347.52 291716,-550.06 291716,-550.06 291716,-556.06 291710,-562.06 291704,-562.06 291704,-562.06 290597,-562.06 290597,-562.06 290591,-562.06 290585,-556.06 290585,-550.06 290585,-550.06 290585,-347.52 290585,-347.52 290585,-341.52 290591,-335.52 290597,-335.52"/>
<text text-anchor="middle" x="291150.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 7 Attention (TP=4)</text>
</g>
<g id="clust121" class="cluster">
<title>cluster_dp3_pp1_layer7_moe</title>
<path fill="lightyellow" stroke="black" d="M286719,-195.52C286719,-195.52 290565,-195.52 290565,-195.52 290571,-195.52 290577,-201.52 290577,-207.52 290577,-207.52 290577,-576.06 290577,-576.06 290577,-582.06 290571,-588.06 290565,-588.06 290565,-588.06 286719,-588.06 286719,-588.06 286713,-588.06 286707,-582.06 286707,-576.06 286707,-576.06 286707,-207.52 286707,-207.52 286707,-201.52 286713,-195.52 286719,-195.52"/>
<text text-anchor="middle" x="288642" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 7 MoE (EP=16)</text>
</g>
<g id="clust122" class="cluster">
<title>cluster_dp3_pp1_layer8_attn</title>
<path fill="lightpink" stroke="black" d="M285580,-335.52C285580,-335.52 286687,-335.52 286687,-335.52 286693,-335.52 286699,-341.52 286699,-347.52 286699,-347.52 286699,-550.06 286699,-550.06 286699,-556.06 286693,-562.06 286687,-562.06 286687,-562.06 285580,-562.06 285580,-562.06 285574,-562.06 285568,-556.06 285568,-550.06 285568,-550.06 285568,-347.52 285568,-347.52 285568,-341.52 285574,-335.52 285580,-335.52"/>
<text text-anchor="middle" x="286133.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 8 Attention (TP=4)</text>
</g>
<g id="clust123" class="cluster">
<title>cluster_dp3_pp1_layer8_moe</title>
<path fill="lightyellow" stroke="black" d="M281702,-195.52C281702,-195.52 285548,-195.52 285548,-195.52 285554,-195.52 285560,-201.52 285560,-207.52 285560,-207.52 285560,-576.06 285560,-576.06 285560,-582.06 285554,-588.06 285548,-588.06 285548,-588.06 281702,-588.06 281702,-588.06 281696,-588.06 281690,-582.06 281690,-576.06 281690,-576.06 281690,-207.52 281690,-207.52 281690,-201.52 281696,-195.52 281702,-195.52"/>
<text text-anchor="middle" x="283625" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 8 MoE (EP=16)</text>
</g>
<g id="clust124" class="cluster">
<title>cluster_pp2_dp3</title>
<path fill="lightcyan" stroke="black" d="M241542,-187.52C241542,-187.52 281662,-187.52 281662,-187.52 281668,-187.52 281674,-193.52 281674,-199.52 281674,-199.52 281674,-607.06 281674,-607.06 281674,-613.06 281668,-619.06 281662,-619.06 281662,-619.06 241542,-619.06 241542,-619.06 241536,-619.06 241530,-613.06 241530,-607.06 241530,-607.06 241530,-199.52 241530,-199.52 241530,-193.52 241536,-187.52 241542,-187.52"/>
<text text-anchor="middle" x="261602" y="-603.86" font-family="Times,serif" font-size="14.00">PP Stage 2: Layers 9&#45;16 (GPUs 112&#45;127)</text>
</g>
<g id="clust125" class="cluster">
<title>cluster_dp3_pp2_layer9_attn</title>
<path fill="lightpink" stroke="black" d="M280547,-335.52C280547,-335.52 281654,-335.52 281654,-335.52 281660,-335.52 281666,-341.52 281666,-347.52 281666,-347.52 281666,-550.06 281666,-550.06 281666,-556.06 281660,-562.06 281654,-562.06 281654,-562.06 280547,-562.06 280547,-562.06 280541,-562.06 280535,-556.06 280535,-550.06 280535,-550.06 280535,-347.52 280535,-347.52 280535,-341.52 280541,-335.52 280547,-335.52"/>
<text text-anchor="middle" x="281100.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 9 Attention (TP=4)</text>
</g>
<g id="clust126" class="cluster">
<title>cluster_dp3_pp2_layer9_moe</title>
<path fill="lightyellow" stroke="black" d="M276669,-195.52C276669,-195.52 280515,-195.52 280515,-195.52 280521,-195.52 280527,-201.52 280527,-207.52 280527,-207.52 280527,-576.06 280527,-576.06 280527,-582.06 280521,-588.06 280515,-588.06 280515,-588.06 276669,-588.06 276669,-588.06 276663,-588.06 276657,-582.06 276657,-576.06 276657,-576.06 276657,-207.52 276657,-207.52 276657,-201.52 276663,-195.52 276669,-195.52"/>
<text text-anchor="middle" x="278592" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 9 MoE (EP=16)</text>
</g>
<g id="clust127" class="cluster">
<title>cluster_dp3_pp2_layer10_attn</title>
<path fill="lightpink" stroke="black" d="M275530,-335.52C275530,-335.52 276637,-335.52 276637,-335.52 276643,-335.52 276649,-341.52 276649,-347.52 276649,-347.52 276649,-550.06 276649,-550.06 276649,-556.06 276643,-562.06 276637,-562.06 276637,-562.06 275530,-562.06 275530,-562.06 275524,-562.06 275518,-556.06 275518,-550.06 275518,-550.06 275518,-347.52 275518,-347.52 275518,-341.52 275524,-335.52 275530,-335.52"/>
<text text-anchor="middle" x="276083.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 10 Attention (TP=4)</text>
</g>
<g id="clust128" class="cluster">
<title>cluster_dp3_pp2_layer10_moe</title>
<path fill="lightyellow" stroke="black" d="M271652,-195.52C271652,-195.52 275498,-195.52 275498,-195.52 275504,-195.52 275510,-201.52 275510,-207.52 275510,-207.52 275510,-576.06 275510,-576.06 275510,-582.06 275504,-588.06 275498,-588.06 275498,-588.06 271652,-588.06 271652,-588.06 271646,-588.06 271640,-582.06 271640,-576.06 271640,-576.06 271640,-207.52 271640,-207.52 271640,-201.52 271646,-195.52 271652,-195.52"/>
<text text-anchor="middle" x="273575" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 10 MoE (EP=16)</text>
</g>
<g id="clust129" class="cluster">
<title>cluster_dp3_pp2_layer11_attn</title>
<path fill="lightpink" stroke="black" d="M270513,-335.52C270513,-335.52 271620,-335.52 271620,-335.52 271626,-335.52 271632,-341.52 271632,-347.52 271632,-347.52 271632,-550.06 271632,-550.06 271632,-556.06 271626,-562.06 271620,-562.06 271620,-562.06 270513,-562.06 270513,-562.06 270507,-562.06 270501,-556.06 270501,-550.06 270501,-550.06 270501,-347.52 270501,-347.52 270501,-341.52 270507,-335.52 270513,-335.52"/>
<text text-anchor="middle" x="271066.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 11 Attention (TP=4)</text>
</g>
<g id="clust130" class="cluster">
<title>cluster_dp3_pp2_layer11_moe</title>
<path fill="lightyellow" stroke="black" d="M266635,-195.52C266635,-195.52 270481,-195.52 270481,-195.52 270487,-195.52 270493,-201.52 270493,-207.52 270493,-207.52 270493,-576.06 270493,-576.06 270493,-582.06 270487,-588.06 270481,-588.06 270481,-588.06 266635,-588.06 266635,-588.06 266629,-588.06 266623,-582.06 266623,-576.06 266623,-576.06 266623,-207.52 266623,-207.52 266623,-201.52 266629,-195.52 266635,-195.52"/>
<text text-anchor="middle" x="268558" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 11 MoE (EP=16)</text>
</g>
<g id="clust131" class="cluster">
<title>cluster_dp3_pp2_layer12_attn</title>
<path fill="lightpink" stroke="black" d="M265496,-335.52C265496,-335.52 266603,-335.52 266603,-335.52 266609,-335.52 266615,-341.52 266615,-347.52 266615,-347.52 266615,-550.06 266615,-550.06 266615,-556.06 266609,-562.06 266603,-562.06 266603,-562.06 265496,-562.06 265496,-562.06 265490,-562.06 265484,-556.06 265484,-550.06 265484,-550.06 265484,-347.52 265484,-347.52 265484,-341.52 265490,-335.52 265496,-335.52"/>
<text text-anchor="middle" x="266049.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 12 Attention (TP=4)</text>
</g>
<g id="clust132" class="cluster">
<title>cluster_dp3_pp2_layer12_moe</title>
<path fill="lightyellow" stroke="black" d="M261618,-195.52C261618,-195.52 265464,-195.52 265464,-195.52 265470,-195.52 265476,-201.52 265476,-207.52 265476,-207.52 265476,-576.06 265476,-576.06 265476,-582.06 265470,-588.06 265464,-588.06 265464,-588.06 261618,-588.06 261618,-588.06 261612,-588.06 261606,-582.06 261606,-576.06 261606,-576.06 261606,-207.52 261606,-207.52 261606,-201.52 261612,-195.52 261618,-195.52"/>
<text text-anchor="middle" x="263541" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 12 MoE (EP=16)</text>
</g>
<g id="clust133" class="cluster">
<title>cluster_dp3_pp2_layer13_attn</title>
<path fill="lightpink" stroke="black" d="M260479,-335.52C260479,-335.52 261586,-335.52 261586,-335.52 261592,-335.52 261598,-341.52 261598,-347.52 261598,-347.52 261598,-550.06 261598,-550.06 261598,-556.06 261592,-562.06 261586,-562.06 261586,-562.06 260479,-562.06 260479,-562.06 260473,-562.06 260467,-556.06 260467,-550.06 260467,-550.06 260467,-347.52 260467,-347.52 260467,-341.52 260473,-335.52 260479,-335.52"/>
<text text-anchor="middle" x="261032.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 13 Attention (TP=4)</text>
</g>
<g id="clust134" class="cluster">
<title>cluster_dp3_pp2_layer13_moe</title>
<path fill="lightyellow" stroke="black" d="M256601,-195.52C256601,-195.52 260447,-195.52 260447,-195.52 260453,-195.52 260459,-201.52 260459,-207.52 260459,-207.52 260459,-576.06 260459,-576.06 260459,-582.06 260453,-588.06 260447,-588.06 260447,-588.06 256601,-588.06 256601,-588.06 256595,-588.06 256589,-582.06 256589,-576.06 256589,-576.06 256589,-207.52 256589,-207.52 256589,-201.52 256595,-195.52 256601,-195.52"/>
<text text-anchor="middle" x="258524" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 13 MoE (EP=16)</text>
</g>
<g id="clust135" class="cluster">
<title>cluster_dp3_pp2_layer14_attn</title>
<path fill="lightpink" stroke="black" d="M255462,-335.52C255462,-335.52 256569,-335.52 256569,-335.52 256575,-335.52 256581,-341.52 256581,-347.52 256581,-347.52 256581,-550.06 256581,-550.06 256581,-556.06 256575,-562.06 256569,-562.06 256569,-562.06 255462,-562.06 255462,-562.06 255456,-562.06 255450,-556.06 255450,-550.06 255450,-550.06 255450,-347.52 255450,-347.52 255450,-341.52 255456,-335.52 255462,-335.52"/>
<text text-anchor="middle" x="256015.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 14 Attention (TP=4)</text>
</g>
<g id="clust136" class="cluster">
<title>cluster_dp3_pp2_layer14_moe</title>
<path fill="lightyellow" stroke="black" d="M251584,-195.52C251584,-195.52 255430,-195.52 255430,-195.52 255436,-195.52 255442,-201.52 255442,-207.52 255442,-207.52 255442,-576.06 255442,-576.06 255442,-582.06 255436,-588.06 255430,-588.06 255430,-588.06 251584,-588.06 251584,-588.06 251578,-588.06 251572,-582.06 251572,-576.06 251572,-576.06 251572,-207.52 251572,-207.52 251572,-201.52 251578,-195.52 251584,-195.52"/>
<text text-anchor="middle" x="253507" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 14 MoE (EP=16)</text>
</g>
<g id="clust137" class="cluster">
<title>cluster_dp3_pp2_layer15_attn</title>
<path fill="lightpink" stroke="black" d="M250445,-335.52C250445,-335.52 251552,-335.52 251552,-335.52 251558,-335.52 251564,-341.52 251564,-347.52 251564,-347.52 251564,-550.06 251564,-550.06 251564,-556.06 251558,-562.06 251552,-562.06 251552,-562.06 250445,-562.06 250445,-562.06 250439,-562.06 250433,-556.06 250433,-550.06 250433,-550.06 250433,-347.52 250433,-347.52 250433,-341.52 250439,-335.52 250445,-335.52"/>
<text text-anchor="middle" x="250998.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 15 Attention (TP=4)</text>
</g>
<g id="clust138" class="cluster">
<title>cluster_dp3_pp2_layer15_moe</title>
<path fill="lightyellow" stroke="black" d="M246567,-195.52C246567,-195.52 250413,-195.52 250413,-195.52 250419,-195.52 250425,-201.52 250425,-207.52 250425,-207.52 250425,-576.06 250425,-576.06 250425,-582.06 250419,-588.06 250413,-588.06 250413,-588.06 246567,-588.06 246567,-588.06 246561,-588.06 246555,-582.06 246555,-576.06 246555,-576.06 246555,-207.52 246555,-207.52 246555,-201.52 246561,-195.52 246567,-195.52"/>
<text text-anchor="middle" x="248490" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 15 MoE (EP=16)</text>
</g>
<g id="clust139" class="cluster">
<title>cluster_dp3_pp2_layer16_attn</title>
<path fill="lightpink" stroke="black" d="M245428,-335.52C245428,-335.52 246535,-335.52 246535,-335.52 246541,-335.52 246547,-341.52 246547,-347.52 246547,-347.52 246547,-550.06 246547,-550.06 246547,-556.06 246541,-562.06 246535,-562.06 246535,-562.06 245428,-562.06 245428,-562.06 245422,-562.06 245416,-556.06 245416,-550.06 245416,-550.06 245416,-347.52 245416,-347.52 245416,-341.52 245422,-335.52 245428,-335.52"/>
<text text-anchor="middle" x="245981.5" y="-546.86" font-family="Times,serif" font-size="14.00">Layer 16 Attention (TP=4)</text>
</g>
<g id="clust140" class="cluster">
<title>cluster_dp3_pp2_layer16_moe</title>
<path fill="lightyellow" stroke="black" d="M241550,-195.52C241550,-195.52 245396,-195.52 245396,-195.52 245402,-195.52 245408,-201.52 245408,-207.52 245408,-207.52 245408,-576.06 245408,-576.06 245408,-582.06 245402,-588.06 245396,-588.06 245396,-588.06 241550,-588.06 241550,-588.06 241544,-588.06 241538,-582.06 241538,-576.06 241538,-576.06 241538,-207.52 241538,-207.52 241538,-201.52 241544,-195.52 241550,-195.52"/>
<text text-anchor="middle" x="243473" y="-572.86" font-family="Times,serif" font-size="14.00">Layer 16 MoE (EP=16)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="169" cy="-505.06" rx="169" ry="28.98"/>
<text text-anchor="middle" x="169" y="-513.56" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="169" y="-502.56" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="169" y="-491.56" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- input_dp0_pp1 -->
<g id="node2" class="node">
<title>input_dp0_pp1</title>
<polygon fill="lightyellow" stroke="black" points="494.09,-523.06 384.18,-523.06 355.9,-487.06 465.82,-487.06 494.09,-523.06"/>
<text text-anchor="middle" x="425" y="-502.56" font-family="Arial" font-size="10.00">input_dp0_pp1</text>
</g>
<!-- input&#45;&gt;input_dp0_pp1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;input_dp0_pp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M338,-505.06C345.15,-505.06 352.31,-505.06 359.46,-505.06"/>
<polygon fill="black" stroke="black" points="359.94,-508.56 369.94,-505.06 359.94,-501.56 359.94,-508.56"/>
</g>
<!-- dp0_pp1_layer1_attn_tp0 -->
<g id="node3" class="node">
<title>dp0_pp1_layer1_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="80223.5,-531.06 79958.5,-531.06 79958.5,-479.06 80223.5,-479.06 80223.5,-531.06"/>
<text text-anchor="middle" x="80091" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="80091" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="80091" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="80091" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer1_attn_allreduce -->
<g id="node4" class="node">
<title>dp0_pp1_layer1_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="80232" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="80232" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="80232" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="80232" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="80232" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_attn_tp0&#45;&gt;dp0_pp1_layer1_attn_allreduce -->
<g id="edge2" class="edge">
<title>dp0_pp1_layer1_attn_tp0&#45;&gt;dp0_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M80119.87,-478.92C80138.39,-462.8 80162.87,-441.49 80184.23,-422.89"/>
<polygon fill="black" stroke="black" points="80186.7,-425.38 80191.94,-416.17 80182.1,-420.1 80186.7,-425.38"/>
</g>
<!-- dp0_pp1_layer1_router -->
<g id="node8" class="node">
<title>dp0_pp1_layer1_router</title>
<polygon fill="lightyellow" stroke="black" points="77971.57,-557.06 77577.74,-557.06 77476.43,-453.06 77870.26,-453.06 77971.57,-557.06"/>
<text text-anchor="middle" x="77724" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="77724" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="77724" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="77724" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_attn_allreduce&#45;&gt;dp0_pp1_layer1_router -->
<g id="edge38" class="edge">
<title>dp0_pp1_layer1_attn_allreduce&#45;&gt;dp0_pp1_layer1_router</title>
<path fill="none" stroke="black" d="M80071.7,-392.14C79957.73,-399.66 79801,-409.63 79663,-417.06 79027.48,-451.29 78274.27,-482.37 77922.96,-496.31"/>
<polygon fill="black" stroke="black" points="77922.79,-492.82 77912.94,-496.71 77923.07,-499.81 77922.79,-492.82"/>
</g>
<!-- dp0_pp1_layer1_attn_tp1 -->
<g id="node5" class="node">
<title>dp0_pp1_layer1_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="80506.5,-531.06 80241.5,-531.06 80241.5,-479.06 80506.5,-479.06 80506.5,-531.06"/>
<text text-anchor="middle" x="80374" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="80374" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="80374" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="80374" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer1_attn_tp1&#45;&gt;dp0_pp1_layer1_attn_allreduce -->
<g id="edge3" class="edge">
<title>dp0_pp1_layer1_attn_tp1&#45;&gt;dp0_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M80344.92,-478.92C80326.28,-462.8 80301.62,-441.49 80280.11,-422.89"/>
<polygon fill="black" stroke="black" points="80282.2,-420.06 80272.34,-416.17 80277.62,-425.36 80282.2,-420.06"/>
</g>
<!-- dp0_pp1_layer1_attn_tp2 -->
<g id="node6" class="node">
<title>dp0_pp1_layer1_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="79940.5,-531.06 79675.5,-531.06 79675.5,-479.06 79940.5,-479.06 79940.5,-531.06"/>
<text text-anchor="middle" x="79808" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="79808" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="79808" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="79808" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer1_attn_tp2&#45;&gt;dp0_pp1_layer1_attn_allreduce -->
<g id="edge4" class="edge">
<title>dp0_pp1_layer1_attn_tp2&#45;&gt;dp0_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M79873.66,-479C79897.53,-470.28 79924.83,-460.77 79950,-453.06 80001.51,-437.29 80059.04,-422.21 80108.64,-409.97"/>
<polygon fill="black" stroke="black" points="80109.57,-413.35 80118.45,-407.57 80107.9,-406.55 80109.57,-413.35"/>
</g>
<!-- dp0_pp1_layer1_attn_tp3 -->
<g id="node7" class="node">
<title>dp0_pp1_layer1_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="80789.5,-531.06 80524.5,-531.06 80524.5,-479.06 80789.5,-479.06 80789.5,-531.06"/>
<text text-anchor="middle" x="80657" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="80657" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="80657" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="80657" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer1_attn_tp3&#45;&gt;dp0_pp1_layer1_attn_allreduce -->
<g id="edge5" class="edge">
<title>dp0_pp1_layer1_attn_tp3&#45;&gt;dp0_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M80591.82,-478.95C80568.12,-470.23 80541.01,-460.72 80516,-453.06 80464.14,-437.17 80406.21,-422.07 80356.26,-409.85"/>
<polygon fill="black" stroke="black" points="80356.92,-406.41 80346.38,-407.45 80355.27,-413.21 80356.92,-406.41"/>
</g>
<!-- dp0_pp1_layer1_expert0 -->
<g id="node9" class="node">
<title>dp0_pp1_layer1_expert0</title>
<polygon fill="lightgreen" stroke="black" points="76021,-406.29 75797,-406.29 75797,-354.29 76021,-354.29 76021,-406.29"/>
<text text-anchor="middle" x="75909" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="75909" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="75909" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="75909" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert0 -->
<g id="edge6" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77521.73,-499.65C77136.55,-490.26 76311.11,-465.13 76030,-417.06 76017.99,-415.01 76005.48,-412.16 75993.27,-408.95"/>
<polygon fill="black" stroke="black" points="75994.11,-405.56 75983.54,-406.32 75992.28,-412.31 75994.11,-405.56"/>
</g>
<!-- dp0_pp1_layer1_expert1 -->
<g id="node10" class="node">
<title>dp0_pp1_layer1_expert1</title>
<polygon fill="lightgreen" stroke="black" points="76263,-406.29 76039,-406.29 76039,-354.29 76263,-354.29 76263,-406.29"/>
<text text-anchor="middle" x="76151" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="76151" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="76151" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="76151" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert1 -->
<g id="edge7" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77519.55,-497.55C77177.94,-485.71 76505.58,-458.03 76272,-417.06 76260.08,-414.97 76247.67,-412.12 76235.54,-408.93"/>
<polygon fill="black" stroke="black" points="76236.45,-405.55 76225.89,-406.3 76234.62,-412.3 76236.45,-405.55"/>
</g>
<!-- dp0_pp1_layer1_expert2 -->
<g id="node11" class="node">
<title>dp0_pp1_layer1_expert2</title>
<polygon fill="lightgreen" stroke="black" points="76505,-406.29 76281,-406.29 76281,-354.29 76505,-354.29 76505,-406.29"/>
<text text-anchor="middle" x="76393" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="76393" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="76393" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="76393" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert2 -->
<g id="edge8" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77524.82,-502.85C77283.66,-498.37 76866.02,-480.97 76514,-417.06 76502.38,-414.95 76490.29,-412.14 76478.44,-409.03"/>
<polygon fill="black" stroke="black" points="76479.13,-405.59 76468.56,-406.34 76477.29,-412.34 76479.13,-405.59"/>
</g>
<!-- dp0_pp1_layer1_expert3 -->
<g id="node12" class="node">
<title>dp0_pp1_layer1_expert3</title>
<polygon fill="lightgreen" stroke="black" points="76747,-406.29 76523,-406.29 76523,-354.29 76747,-354.29 76747,-406.29"/>
<text text-anchor="middle" x="76635" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="76635" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="76635" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="76635" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert3 -->
<g id="edge9" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77519.36,-497.41C77322.31,-488.25 77016.63,-466.79 76756,-417.06 76744.57,-414.88 76732.67,-412.06 76720.99,-408.97"/>
<polygon fill="black" stroke="black" points="76721.82,-405.57 76711.25,-406.31 76719.98,-412.32 76721.82,-405.57"/>
</g>
<!-- dp0_pp1_layer1_expert4 -->
<g id="node13" class="node">
<title>dp0_pp1_layer1_expert4</title>
<polygon fill="lightgreen" stroke="black" points="76989,-406.29 76765,-406.29 76765,-354.29 76989,-354.29 76989,-406.29"/>
<text text-anchor="middle" x="76877" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="76877" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="76877" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="76877" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert4 -->
<g id="edge10" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77510.43,-487.98C77364.99,-474.71 77168.64,-452.25 76998,-417.06 76987.05,-414.8 76975.65,-412.02 76964.43,-409.02"/>
<polygon fill="black" stroke="black" points="76965.19,-405.6 76954.62,-406.33 76963.34,-412.35 76965.19,-405.6"/>
</g>
<!-- dp0_pp1_layer1_expert5 -->
<g id="node14" class="node">
<title>dp0_pp1_layer1_expert5</title>
<polygon fill="lightgreen" stroke="black" points="77231,-406.29 77007,-406.29 77007,-354.29 77231,-354.29 77231,-406.29"/>
<text text-anchor="middle" x="77119" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="77119" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="77119" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="77119" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert5 -->
<g id="edge11" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77490.29,-467.38C77410.5,-453.44 77321,-436.25 77240,-417.06 77229.9,-414.67 77219.4,-411.94 77208.99,-409.07"/>
<polygon fill="black" stroke="black" points="77209.62,-405.62 77199.05,-406.3 77207.74,-412.36 77209.62,-405.62"/>
</g>
<!-- dp0_pp1_layer1_expert6 -->
<g id="node15" class="node">
<title>dp0_pp1_layer1_expert6</title>
<polygon fill="lightgreen" stroke="black" points="77473,-406.29 77249,-406.29 77249,-354.29 77473,-354.29 77473,-406.29"/>
<text text-anchor="middle" x="77361" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="77361" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="77361" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="77361" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert6 -->
<g id="edge12" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77572.94,-452.97C77529.16,-438.16 77482.94,-422.53 77444.87,-409.66"/>
<polygon fill="black" stroke="black" points="77445.97,-406.33 77435.38,-406.45 77443.73,-412.97 77445.97,-406.33"/>
</g>
<!-- dp0_pp1_layer1_expert7 -->
<g id="node16" class="node">
<title>dp0_pp1_layer1_expert7</title>
<polygon fill="lightgreen" stroke="black" points="77715,-406.29 77491,-406.29 77491,-354.29 77715,-354.29 77715,-406.29"/>
<text text-anchor="middle" x="77603" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="77603" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="77603" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="77603" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert7 -->
<g id="edge13" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77673.38,-452.71C77660.3,-439.43 77646.58,-425.51 77634.76,-413.52"/>
<polygon fill="black" stroke="black" points="77637.19,-411 77627.68,-406.33 77632.2,-415.91 77637.19,-411"/>
</g>
<!-- dp0_pp1_layer1_expert8 -->
<g id="node17" class="node">
<title>dp0_pp1_layer1_expert8</title>
<polygon fill="lightgreen" stroke="black" points="77957,-406.29 77733,-406.29 77733,-354.29 77957,-354.29 77957,-406.29"/>
<text text-anchor="middle" x="77845" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="77845" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="77845" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="77845" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert8 -->
<g id="edge14" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77774.61,-452.71C77787.7,-439.43 77801.42,-425.51 77813.23,-413.52"/>
<polygon fill="black" stroke="black" points="77815.79,-415.91 77820.32,-406.33 77810.81,-411 77815.79,-415.91"/>
</g>
<!-- dp0_pp1_layer1_expert9 -->
<g id="node18" class="node">
<title>dp0_pp1_layer1_expert9</title>
<polygon fill="lightgreen" stroke="black" points="78199,-406.29 77975,-406.29 77975,-354.29 78199,-354.29 78199,-406.29"/>
<text text-anchor="middle" x="78087" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="78087" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="78087" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="78087" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert9 -->
<g id="edge15" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77871.38,-454.21C77916.29,-439.03 77964.08,-422.86 78003.23,-409.62"/>
<polygon fill="black" stroke="black" points="78004.64,-412.84 78012.99,-406.32 78002.4,-406.21 78004.64,-412.84"/>
</g>
<!-- dp0_pp1_layer1_expert10 -->
<g id="node19" class="node">
<title>dp0_pp1_layer1_expert10</title>
<polygon fill="lightgreen" stroke="black" points="78441,-406.29 78217,-406.29 78217,-354.29 78441,-354.29 78441,-406.29"/>
<text text-anchor="middle" x="78329" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="78329" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="78329" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="78329" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert10 -->
<g id="edge16" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77894.89,-478.04C77987.98,-462.69 78104.88,-441.49 78208,-417.06 78218.09,-414.67 78228.6,-411.94 78239.01,-409.07"/>
<polygon fill="black" stroke="black" points="78240.26,-412.36 78248.95,-406.3 78238.37,-405.62 78240.26,-412.36"/>
</g>
<!-- dp0_pp1_layer1_expert11 -->
<g id="node20" class="node">
<title>dp0_pp1_layer1_expert11</title>
<polygon fill="lightgreen" stroke="black" points="78683,-406.29 78459,-406.29 78459,-354.29 78683,-354.29 78683,-406.29"/>
<text text-anchor="middle" x="78571" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="78571" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="78571" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="78571" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert11 -->
<g id="edge17" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77906.99,-490.7C78054.62,-477.88 78267.08,-454.78 78450,-417.06 78460.95,-414.8 78472.35,-412.02 78483.57,-409.02"/>
<polygon fill="black" stroke="black" points="78484.66,-412.35 78493.38,-406.33 78482.81,-405.6 78484.66,-412.35"/>
</g>
<!-- dp0_pp1_layer1_expert12 -->
<g id="node21" class="node">
<title>dp0_pp1_layer1_expert12</title>
<polygon fill="lightgreen" stroke="black" points="78925,-406.29 78701,-406.29 78701,-354.29 78925,-354.29 78925,-406.29"/>
<text text-anchor="middle" x="78813" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="78813" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="78813" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="78813" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert12 -->
<g id="edge18" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77914.27,-498.07C78110.59,-489.29 78424.95,-468.01 78692,-417.06 78703.43,-414.88 78715.33,-412.06 78727.01,-408.97"/>
<polygon fill="black" stroke="black" points="78728.02,-412.32 78736.75,-406.31 78726.18,-405.57 78728.02,-412.32"/>
</g>
<!-- dp0_pp1_layer1_expert13 -->
<g id="node22" class="node">
<title>dp0_pp1_layer1_expert13</title>
<polygon fill="lightgreen" stroke="black" points="79167,-406.29 78943,-406.29 78943,-354.29 79167,-354.29 79167,-406.29"/>
<text text-anchor="middle" x="79055" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="79055" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="79055" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="79055" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert13 -->
<g id="edge19" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77918.93,-502.93C78159.42,-498.58 78579.9,-481.35 78934,-417.06 78945.62,-414.95 78957.71,-412.14 78969.56,-409.03"/>
<polygon fill="black" stroke="black" points="78970.7,-412.34 78979.44,-406.34 78968.87,-405.59 78970.7,-412.34"/>
</g>
<!-- dp0_pp1_layer1_expert14 -->
<g id="node23" class="node">
<title>dp0_pp1_layer1_expert14</title>
<polygon fill="lightgreen" stroke="black" points="79409,-406.29 79185,-406.29 79185,-354.29 79409,-354.29 79409,-406.29"/>
<text text-anchor="middle" x="79297" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="79297" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="79297" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="79297" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert14 -->
<g id="edge20" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77914.32,-498.04C78251.17,-486.48 78939.15,-458.6 79176,-417.06 79187.92,-414.97 79200.32,-412.12 79212.46,-408.93"/>
<polygon fill="black" stroke="black" points="79213.38,-412.3 79222.11,-406.3 79211.54,-405.55 79213.38,-412.3"/>
</g>
<!-- dp0_pp1_layer1_expert15 -->
<g id="node24" class="node">
<title>dp0_pp1_layer1_expert15</title>
<polygon fill="lightgreen" stroke="black" points="79651,-406.29 79427,-406.29 79427,-354.29 79651,-354.29 79651,-406.29"/>
<text text-anchor="middle" x="79539" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="79539" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="79539" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="79539" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert15 -->
<g id="edge21" class="edge">
<title>dp0_pp1_layer1_router&#45;&gt;dp0_pp1_layer1_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77915.94,-499.9C78296.49,-490.72 79134.35,-465.57 79418,-417.06 79430.01,-415.01 79442.51,-412.16 79454.73,-408.95"/>
<polygon fill="black" stroke="black" points="79455.72,-412.31 79464.45,-406.32 79453.88,-405.56 79455.72,-412.31"/>
</g>
<!-- dp0_pp1_layer1_expert_agg -->
<g id="node25" class="node">
<title>dp0_pp1_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="77971.57,-307.52 77577.74,-307.52 77476.43,-203.52 77870.26,-203.52 77971.57,-307.52"/>
<text text-anchor="middle" x="77724" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="77724" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="77724" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="77724" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer1_expert0&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge22" class="edge">
<title>dp0_pp1_layer1_expert0&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M75967.07,-354.29C75986.69,-346.92 76008.97,-339.72 76030,-335.52 76309.13,-279.86 77132.93,-263.21 77519.43,-258.4"/>
<polygon fill="black" stroke="black" points="77519.65,-261.9 77529.61,-258.27 77519.57,-254.9 77519.65,-261.9"/>
</g>
<!-- dp0_pp1_layer1_expert1&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge23" class="edge">
<title>dp0_pp1_layer1_expert1&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M76209.39,-354.27C76228.95,-346.95 76251.09,-339.78 76272,-335.52 76504.8,-288.16 77180.09,-267.74 77521.43,-260.24"/>
<polygon fill="black" stroke="black" points="77521.51,-263.74 77531.43,-260.03 77521.35,-256.74 77521.51,-263.74"/>
</g>
<!-- dp0_pp1_layer1_expert2&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge24" class="edge">
<title>dp0_pp1_layer1_expert2&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M76451.73,-354.29C76471.21,-347.01 76493.23,-339.87 76514,-335.52 76700.91,-296.44 77230.54,-273.07 77523.3,-262.78"/>
<polygon fill="black" stroke="black" points="77523.74,-266.27 77533.61,-262.42 77523.5,-259.27 77523.74,-266.27"/>
</g>
<!-- dp0_pp1_layer1_expert3&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge25" class="edge">
<title>dp0_pp1_layer1_expert3&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M76694.39,-354.26C76713.72,-347.07 76735.48,-339.99 76756,-335.52 77014.91,-279.18 77320.7,-262.24 77518.26,-257.56"/>
<polygon fill="black" stroke="black" points="77518.55,-261.06 77528.47,-257.33 77518.39,-254.06 77518.55,-261.06"/>
</g>
<!-- dp0_pp1_layer1_expert4&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge26" class="edge">
<title>dp0_pp1_layer1_expert4&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M76937.39,-354.24C76956.49,-347.2 76977.87,-340.19 76998,-335.52 77173.82,-294.77 77378.6,-274.91 77525.75,-265.31"/>
<polygon fill="black" stroke="black" points="77526.05,-268.8 77535.81,-264.67 77525.6,-261.82 77526.05,-268.8"/>
</g>
<!-- dp0_pp1_layer1_expert5&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge27" class="edge">
<title>dp0_pp1_layer1_expert5&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M77181.42,-354.22C77200.04,-347.42 77220.65,-340.55 77240,-335.52 77337.09,-310.27 77447.34,-291.53 77538.07,-278.65"/>
<polygon fill="black" stroke="black" points="77538.78,-282.09 77548.19,-277.23 77537.8,-275.16 77538.78,-282.09"/>
</g>
<!-- dp0_pp1_layer1_expert6&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge28" class="edge">
<title>dp0_pp1_layer1_expert6&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M77429.02,-354.26C77446.26,-348.03 77464.78,-341.44 77482,-335.52 77508.73,-326.33 77537.21,-316.8 77564.89,-307.67"/>
<polygon fill="black" stroke="black" points="77566.24,-310.91 77574.65,-304.46 77564.06,-304.26 77566.24,-310.91"/>
</g>
<!-- dp0_pp1_layer1_expert7&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge29" class="edge">
<title>dp0_pp1_layer1_expert7&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M77627.78,-354.15C77639.02,-342.74 77652.83,-328.73 77666.45,-314.92"/>
<polygon fill="black" stroke="black" points="77669,-317.31 77673.53,-307.73 77664.02,-312.39 77669,-317.31"/>
</g>
<!-- dp0_pp1_layer1_expert8&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge30" class="edge">
<title>dp0_pp1_layer1_expert8&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M77820.22,-354.15C77808.97,-342.74 77795.16,-328.73 77781.55,-314.92"/>
<polygon fill="black" stroke="black" points="77783.98,-312.39 77774.47,-307.73 77778.99,-317.31 77783.98,-312.39"/>
</g>
<!-- dp0_pp1_layer1_expert9&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge31" class="edge">
<title>dp0_pp1_layer1_expert9&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M78018.98,-354.26C78001.73,-348.03 77983.21,-341.44 77966,-335.52 77942.29,-327.37 77917.21,-318.95 77892.53,-310.78"/>
<polygon fill="black" stroke="black" points="77893.32,-307.36 77882.73,-307.54 77891.12,-314 77893.32,-307.36"/>
</g>
<!-- dp0_pp1_layer1_expert10&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge32" class="edge">
<title>dp0_pp1_layer1_expert10&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M78266.58,-354.22C78247.96,-347.42 78227.35,-340.55 78208,-335.52 78127.99,-314.71 78039.05,-298.33 77959.46,-286"/>
<polygon fill="black" stroke="black" points="77959.71,-282.5 77949.3,-284.44 77958.65,-289.41 77959.71,-282.5"/>
</g>
<!-- dp0_pp1_layer1_expert11&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge33" class="edge">
<title>dp0_pp1_layer1_expert11&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M78510.61,-354.24C78491.51,-347.2 78470.13,-340.19 78450,-335.52 78281.74,-296.53 78086.97,-276.66 77941.55,-266.61"/>
<polygon fill="black" stroke="black" points="77941.38,-263.09 77931.16,-265.9 77940.9,-270.07 77941.38,-263.09"/>
</g>
<!-- dp0_pp1_layer1_expert12&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge34" class="edge">
<title>dp0_pp1_layer1_expert12&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M78753.61,-354.26C78734.28,-347.07 78712.52,-339.99 78692,-335.52 78434.51,-279.49 78130.64,-262.43 77932.99,-257.64"/>
<polygon fill="black" stroke="black" points="77932.86,-254.14 77922.78,-257.4 77932.69,-261.13 77932.86,-254.14"/>
</g>
<!-- dp0_pp1_layer1_expert13&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge35" class="edge">
<title>dp0_pp1_layer1_expert13&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M78996.27,-354.29C78976.79,-347.01 78954.77,-339.87 78934,-335.52 78750.02,-297.05 78233.97,-273.81 77938.63,-263.27"/>
<polygon fill="black" stroke="black" points="77938.33,-259.76 77928.21,-262.9 77938.08,-266.76 77938.33,-259.76"/>
</g>
<!-- dp0_pp1_layer1_expert14&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge36" class="edge">
<title>dp0_pp1_layer1_expert14&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M79238.6,-354.27C79219.05,-346.95 79196.9,-339.78 79176,-335.52 78945.27,-288.58 78279.86,-268.1 77935.74,-260.45"/>
<polygon fill="black" stroke="black" points="77935.73,-256.94 77925.65,-260.22 77935.57,-263.94 77935.73,-256.94"/>
</g>
<!-- dp0_pp1_layer1_expert15&#45;&gt;dp0_pp1_layer1_expert_agg -->
<g id="edge37" class="edge">
<title>dp0_pp1_layer1_expert15&#45;&gt;dp0_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M79480.93,-354.29C79461.3,-346.92 79439.03,-339.72 79418,-335.52 79140.21,-280.12 78322.98,-263.37 77934.17,-258.47"/>
<polygon fill="black" stroke="black" points="77933.97,-254.97 77923.93,-258.34 77933.88,-261.97 77933.97,-254.97"/>
</g>
<!-- dp0_pp1_layer2_attn_tp0 -->
<g id="node26" class="node">
<title>dp0_pp1_layer2_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="75206.5,-531.06 74941.5,-531.06 74941.5,-479.06 75206.5,-479.06 75206.5,-531.06"/>
<text text-anchor="middle" x="75074" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="75074" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="75074" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="75074" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer1_expert_agg&#45;&gt;dp0_pp1_layer2_attn_tp0 -->
<g id="edge39" class="edge">
<title>dp0_pp1_layer1_expert_agg&#45;&gt;dp0_pp1_layer2_attn_tp0</title>
<path fill="none" stroke="black" d="M77531.78,-260.41C77111.38,-269.54 76121.17,-294.77 75788,-335.52 75755.8,-339.46 75247.23,-444.29 75216,-453.06 75193.37,-459.41 75169.16,-467.58 75147.26,-475.5"/>
<polygon fill="black" stroke="black" points="75145.89,-472.28 75137.7,-479 75148.29,-478.85 75145.89,-472.28"/>
</g>
<!-- dp0_pp1_layer2_attn_allreduce -->
<g id="node27" class="node">
<title>dp0_pp1_layer2_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="75203" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="75203" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="75203" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="75203" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="75203" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_attn_tp0&#45;&gt;dp0_pp1_layer2_attn_allreduce -->
<g id="edge40" class="edge">
<title>dp0_pp1_layer2_attn_tp0&#45;&gt;dp0_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M75100.41,-478.92C75117.15,-463 75139.21,-442 75158.58,-423.56"/>
<polygon fill="black" stroke="black" points="75161.03,-426.07 75165.86,-416.64 75156.2,-421 75161.03,-426.07"/>
</g>
<!-- dp0_pp1_layer2_router -->
<g id="node31" class="node">
<title>dp0_pp1_layer2_router</title>
<polygon fill="lightyellow" stroke="black" points="72954.57,-557.06 72560.74,-557.06 72459.43,-453.06 72853.26,-453.06 72954.57,-557.06"/>
<text text-anchor="middle" x="72707" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="72707" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="72707" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="72707" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_attn_allreduce&#45;&gt;dp0_pp1_layer2_router -->
<g id="edge76" class="edge">
<title>dp0_pp1_layer2_attn_allreduce&#45;&gt;dp0_pp1_layer2_router</title>
<path fill="none" stroke="black" d="M75043.08,-392.38C74931.77,-399.9 74779.89,-409.76 74646,-417.06 74010.5,-451.72 73257.28,-482.59 72905.96,-496.4"/>
<polygon fill="black" stroke="black" points="72905.8,-492.91 72895.94,-496.79 72906.07,-499.9 72905.8,-492.91"/>
</g>
<!-- dp0_pp1_layer2_attn_tp1 -->
<g id="node28" class="node">
<title>dp0_pp1_layer2_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="75489.5,-531.06 75224.5,-531.06 75224.5,-479.06 75489.5,-479.06 75489.5,-531.06"/>
<text text-anchor="middle" x="75357" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="75357" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="75357" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="75357" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer2_attn_tp1&#45;&gt;dp0_pp1_layer2_attn_allreduce -->
<g id="edge41" class="edge">
<title>dp0_pp1_layer2_attn_tp1&#45;&gt;dp0_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M75325.46,-478.92C75304.99,-462.6 75277.83,-440.94 75254.29,-422.18"/>
<polygon fill="black" stroke="black" points="75256.46,-419.44 75246.46,-415.94 75252.1,-424.91 75256.46,-419.44"/>
</g>
<!-- dp0_pp1_layer2_attn_tp2 -->
<g id="node29" class="node">
<title>dp0_pp1_layer2_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="74923.5,-531.06 74658.5,-531.06 74658.5,-479.06 74923.5,-479.06 74923.5,-531.06"/>
<text text-anchor="middle" x="74791" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="74791" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="74791" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="74791" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer2_attn_tp2&#45;&gt;dp0_pp1_layer2_attn_allreduce -->
<g id="edge42" class="edge">
<title>dp0_pp1_layer2_attn_tp2&#45;&gt;dp0_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M74857.07,-479.02C74880.85,-470.35 74907.99,-460.86 74933,-453.06 74981.74,-437.86 75036.05,-423.03 75083.1,-410.83"/>
<polygon fill="black" stroke="black" points="75084.22,-414.15 75093.03,-408.26 75082.47,-407.38 75084.22,-414.15"/>
</g>
<!-- dp0_pp1_layer2_attn_tp3 -->
<g id="node30" class="node">
<title>dp0_pp1_layer2_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="75772.5,-531.06 75507.5,-531.06 75507.5,-479.06 75772.5,-479.06 75772.5,-531.06"/>
<text text-anchor="middle" x="75640" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="75640" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="75640" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="75640" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer2_attn_tp3&#45;&gt;dp0_pp1_layer2_attn_allreduce -->
<g id="edge43" class="edge">
<title>dp0_pp1_layer2_attn_tp3&#45;&gt;dp0_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M75575.21,-478.95C75551.43,-470.18 75524.17,-460.64 75499,-453.06 75444.42,-436.63 75383.31,-421.31 75330.86,-409.08"/>
<polygon fill="black" stroke="black" points="75331.37,-405.6 75320.83,-406.75 75329.78,-412.42 75331.37,-405.6"/>
</g>
<!-- dp0_pp1_layer2_expert0 -->
<g id="node32" class="node">
<title>dp0_pp1_layer2_expert0</title>
<polygon fill="lightgreen" stroke="black" points="71004,-406.29 70780,-406.29 70780,-354.29 71004,-354.29 71004,-406.29"/>
<text text-anchor="middle" x="70892" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="70892" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="70892" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="70892" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert0 -->
<g id="edge44" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72504.73,-499.65C72119.55,-490.26 71294.11,-465.13 71013,-417.06 71000.99,-415.01 70988.48,-412.16 70976.27,-408.95"/>
<polygon fill="black" stroke="black" points="70977.11,-405.56 70966.54,-406.32 70975.28,-412.31 70977.11,-405.56"/>
</g>
<!-- dp0_pp1_layer2_expert1 -->
<g id="node33" class="node">
<title>dp0_pp1_layer2_expert1</title>
<polygon fill="lightgreen" stroke="black" points="71246,-406.29 71022,-406.29 71022,-354.29 71246,-354.29 71246,-406.29"/>
<text text-anchor="middle" x="71134" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="71134" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="71134" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="71134" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert1 -->
<g id="edge45" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72502.55,-497.55C72160.94,-485.71 71488.58,-458.03 71255,-417.06 71243.08,-414.97 71230.67,-412.12 71218.54,-408.93"/>
<polygon fill="black" stroke="black" points="71219.45,-405.55 71208.89,-406.3 71217.62,-412.3 71219.45,-405.55"/>
</g>
<!-- dp0_pp1_layer2_expert2 -->
<g id="node34" class="node">
<title>dp0_pp1_layer2_expert2</title>
<polygon fill="lightgreen" stroke="black" points="71488,-406.29 71264,-406.29 71264,-354.29 71488,-354.29 71488,-406.29"/>
<text text-anchor="middle" x="71376" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="71376" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="71376" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="71376" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert2 -->
<g id="edge46" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72507.82,-502.85C72266.66,-498.37 71849.02,-480.97 71497,-417.06 71485.38,-414.95 71473.29,-412.14 71461.44,-409.03"/>
<polygon fill="black" stroke="black" points="71462.13,-405.59 71451.56,-406.34 71460.29,-412.34 71462.13,-405.59"/>
</g>
<!-- dp0_pp1_layer2_expert3 -->
<g id="node35" class="node">
<title>dp0_pp1_layer2_expert3</title>
<polygon fill="lightgreen" stroke="black" points="71730,-406.29 71506,-406.29 71506,-354.29 71730,-354.29 71730,-406.29"/>
<text text-anchor="middle" x="71618" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="71618" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="71618" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="71618" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert3 -->
<g id="edge47" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72502.36,-497.41C72305.31,-488.25 71999.63,-466.79 71739,-417.06 71727.57,-414.88 71715.67,-412.06 71703.99,-408.97"/>
<polygon fill="black" stroke="black" points="71704.82,-405.57 71694.25,-406.31 71702.98,-412.32 71704.82,-405.57"/>
</g>
<!-- dp0_pp1_layer2_expert4 -->
<g id="node36" class="node">
<title>dp0_pp1_layer2_expert4</title>
<polygon fill="lightgreen" stroke="black" points="71972,-406.29 71748,-406.29 71748,-354.29 71972,-354.29 71972,-406.29"/>
<text text-anchor="middle" x="71860" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="71860" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="71860" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="71860" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert4 -->
<g id="edge48" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72493.43,-487.98C72347.99,-474.71 72151.64,-452.25 71981,-417.06 71970.05,-414.8 71958.65,-412.02 71947.43,-409.02"/>
<polygon fill="black" stroke="black" points="71948.19,-405.6 71937.62,-406.33 71946.34,-412.35 71948.19,-405.6"/>
</g>
<!-- dp0_pp1_layer2_expert5 -->
<g id="node37" class="node">
<title>dp0_pp1_layer2_expert5</title>
<polygon fill="lightgreen" stroke="black" points="72214,-406.29 71990,-406.29 71990,-354.29 72214,-354.29 72214,-406.29"/>
<text text-anchor="middle" x="72102" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="72102" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="72102" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="72102" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert5 -->
<g id="edge49" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72473.29,-467.38C72393.5,-453.44 72304,-436.25 72223,-417.06 72212.9,-414.67 72202.4,-411.94 72191.99,-409.07"/>
<polygon fill="black" stroke="black" points="72192.62,-405.62 72182.05,-406.3 72190.74,-412.36 72192.62,-405.62"/>
</g>
<!-- dp0_pp1_layer2_expert6 -->
<g id="node38" class="node">
<title>dp0_pp1_layer2_expert6</title>
<polygon fill="lightgreen" stroke="black" points="72456,-406.29 72232,-406.29 72232,-354.29 72456,-354.29 72456,-406.29"/>
<text text-anchor="middle" x="72344" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="72344" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="72344" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="72344" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert6 -->
<g id="edge50" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72555.94,-452.97C72512.16,-438.16 72465.94,-422.53 72427.87,-409.66"/>
<polygon fill="black" stroke="black" points="72428.97,-406.33 72418.38,-406.45 72426.73,-412.97 72428.97,-406.33"/>
</g>
<!-- dp0_pp1_layer2_expert7 -->
<g id="node39" class="node">
<title>dp0_pp1_layer2_expert7</title>
<polygon fill="lightgreen" stroke="black" points="72698,-406.29 72474,-406.29 72474,-354.29 72698,-354.29 72698,-406.29"/>
<text text-anchor="middle" x="72586" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="72586" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="72586" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="72586" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert7 -->
<g id="edge51" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72656.38,-452.71C72643.3,-439.43 72629.58,-425.51 72617.76,-413.52"/>
<polygon fill="black" stroke="black" points="72620.19,-411 72610.68,-406.33 72615.2,-415.91 72620.19,-411"/>
</g>
<!-- dp0_pp1_layer2_expert8 -->
<g id="node40" class="node">
<title>dp0_pp1_layer2_expert8</title>
<polygon fill="lightgreen" stroke="black" points="72940,-406.29 72716,-406.29 72716,-354.29 72940,-354.29 72940,-406.29"/>
<text text-anchor="middle" x="72828" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="72828" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="72828" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="72828" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert8 -->
<g id="edge52" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72757.61,-452.71C72770.7,-439.43 72784.42,-425.51 72796.23,-413.52"/>
<polygon fill="black" stroke="black" points="72798.79,-415.91 72803.32,-406.33 72793.81,-411 72798.79,-415.91"/>
</g>
<!-- dp0_pp1_layer2_expert9 -->
<g id="node41" class="node">
<title>dp0_pp1_layer2_expert9</title>
<polygon fill="lightgreen" stroke="black" points="73182,-406.29 72958,-406.29 72958,-354.29 73182,-354.29 73182,-406.29"/>
<text text-anchor="middle" x="73070" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="73070" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="73070" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="73070" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert9 -->
<g id="edge53" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72854.38,-454.21C72899.29,-439.03 72947.08,-422.86 72986.23,-409.62"/>
<polygon fill="black" stroke="black" points="72987.64,-412.84 72995.99,-406.32 72985.4,-406.21 72987.64,-412.84"/>
</g>
<!-- dp0_pp1_layer2_expert10 -->
<g id="node42" class="node">
<title>dp0_pp1_layer2_expert10</title>
<polygon fill="lightgreen" stroke="black" points="73424,-406.29 73200,-406.29 73200,-354.29 73424,-354.29 73424,-406.29"/>
<text text-anchor="middle" x="73312" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="73312" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="73312" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="73312" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert10 -->
<g id="edge54" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72877.89,-478.04C72970.98,-462.69 73087.88,-441.49 73191,-417.06 73201.09,-414.67 73211.6,-411.94 73222.01,-409.07"/>
<polygon fill="black" stroke="black" points="73223.26,-412.36 73231.95,-406.3 73221.37,-405.62 73223.26,-412.36"/>
</g>
<!-- dp0_pp1_layer2_expert11 -->
<g id="node43" class="node">
<title>dp0_pp1_layer2_expert11</title>
<polygon fill="lightgreen" stroke="black" points="73666,-406.29 73442,-406.29 73442,-354.29 73666,-354.29 73666,-406.29"/>
<text text-anchor="middle" x="73554" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="73554" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="73554" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="73554" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert11 -->
<g id="edge55" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72889.99,-490.7C73037.62,-477.88 73250.08,-454.78 73433,-417.06 73443.95,-414.8 73455.35,-412.02 73466.57,-409.02"/>
<polygon fill="black" stroke="black" points="73467.66,-412.35 73476.38,-406.33 73465.81,-405.6 73467.66,-412.35"/>
</g>
<!-- dp0_pp1_layer2_expert12 -->
<g id="node44" class="node">
<title>dp0_pp1_layer2_expert12</title>
<polygon fill="lightgreen" stroke="black" points="73908,-406.29 73684,-406.29 73684,-354.29 73908,-354.29 73908,-406.29"/>
<text text-anchor="middle" x="73796" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="73796" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="73796" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="73796" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert12 -->
<g id="edge56" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72897.27,-498.07C73093.59,-489.29 73407.95,-468.01 73675,-417.06 73686.43,-414.88 73698.33,-412.06 73710.01,-408.97"/>
<polygon fill="black" stroke="black" points="73711.02,-412.32 73719.75,-406.31 73709.18,-405.57 73711.02,-412.32"/>
</g>
<!-- dp0_pp1_layer2_expert13 -->
<g id="node45" class="node">
<title>dp0_pp1_layer2_expert13</title>
<polygon fill="lightgreen" stroke="black" points="74150,-406.29 73926,-406.29 73926,-354.29 74150,-354.29 74150,-406.29"/>
<text text-anchor="middle" x="74038" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="74038" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="74038" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="74038" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert13 -->
<g id="edge57" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72901.93,-502.93C73142.42,-498.58 73562.9,-481.35 73917,-417.06 73928.62,-414.95 73940.71,-412.14 73952.56,-409.03"/>
<polygon fill="black" stroke="black" points="73953.7,-412.34 73962.44,-406.34 73951.87,-405.59 73953.7,-412.34"/>
</g>
<!-- dp0_pp1_layer2_expert14 -->
<g id="node46" class="node">
<title>dp0_pp1_layer2_expert14</title>
<polygon fill="lightgreen" stroke="black" points="74392,-406.29 74168,-406.29 74168,-354.29 74392,-354.29 74392,-406.29"/>
<text text-anchor="middle" x="74280" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="74280" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="74280" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="74280" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert14 -->
<g id="edge58" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72897.32,-498.04C73234.17,-486.48 73922.15,-458.6 74159,-417.06 74170.92,-414.97 74183.32,-412.12 74195.46,-408.93"/>
<polygon fill="black" stroke="black" points="74196.38,-412.3 74205.11,-406.3 74194.54,-405.55 74196.38,-412.3"/>
</g>
<!-- dp0_pp1_layer2_expert15 -->
<g id="node47" class="node">
<title>dp0_pp1_layer2_expert15</title>
<polygon fill="lightgreen" stroke="black" points="74634,-406.29 74410,-406.29 74410,-354.29 74634,-354.29 74634,-406.29"/>
<text text-anchor="middle" x="74522" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="74522" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="74522" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="74522" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert15 -->
<g id="edge59" class="edge">
<title>dp0_pp1_layer2_router&#45;&gt;dp0_pp1_layer2_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M72898.94,-499.9C73279.49,-490.72 74117.35,-465.57 74401,-417.06 74413.01,-415.01 74425.51,-412.16 74437.73,-408.95"/>
<polygon fill="black" stroke="black" points="74438.72,-412.31 74447.45,-406.32 74436.88,-405.56 74438.72,-412.31"/>
</g>
<!-- dp0_pp1_layer2_expert_agg -->
<g id="node48" class="node">
<title>dp0_pp1_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="72954.57,-307.52 72560.74,-307.52 72459.43,-203.52 72853.26,-203.52 72954.57,-307.52"/>
<text text-anchor="middle" x="72707" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="72707" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="72707" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="72707" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer2_expert0&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge60" class="edge">
<title>dp0_pp1_layer2_expert0&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M70950.07,-354.29C70969.69,-346.92 70991.97,-339.72 71013,-335.52 71292.13,-279.86 72115.93,-263.21 72502.43,-258.4"/>
<polygon fill="black" stroke="black" points="72502.65,-261.9 72512.61,-258.27 72502.57,-254.9 72502.65,-261.9"/>
</g>
<!-- dp0_pp1_layer2_expert1&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge61" class="edge">
<title>dp0_pp1_layer2_expert1&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M71192.39,-354.27C71211.95,-346.95 71234.09,-339.78 71255,-335.52 71487.8,-288.16 72163.09,-267.74 72504.43,-260.24"/>
<polygon fill="black" stroke="black" points="72504.51,-263.74 72514.43,-260.03 72504.35,-256.74 72504.51,-263.74"/>
</g>
<!-- dp0_pp1_layer2_expert2&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge62" class="edge">
<title>dp0_pp1_layer2_expert2&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M71434.73,-354.29C71454.21,-347.01 71476.23,-339.87 71497,-335.52 71683.91,-296.44 72213.54,-273.07 72506.3,-262.78"/>
<polygon fill="black" stroke="black" points="72506.74,-266.27 72516.61,-262.42 72506.5,-259.27 72506.74,-266.27"/>
</g>
<!-- dp0_pp1_layer2_expert3&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge63" class="edge">
<title>dp0_pp1_layer2_expert3&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M71677.39,-354.26C71696.72,-347.07 71718.48,-339.99 71739,-335.52 71997.91,-279.18 72303.7,-262.24 72501.26,-257.56"/>
<polygon fill="black" stroke="black" points="72501.55,-261.06 72511.47,-257.33 72501.39,-254.06 72501.55,-261.06"/>
</g>
<!-- dp0_pp1_layer2_expert4&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge64" class="edge">
<title>dp0_pp1_layer2_expert4&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M71920.39,-354.24C71939.49,-347.2 71960.87,-340.19 71981,-335.52 72156.82,-294.77 72361.6,-274.91 72508.75,-265.31"/>
<polygon fill="black" stroke="black" points="72509.05,-268.8 72518.81,-264.67 72508.6,-261.82 72509.05,-268.8"/>
</g>
<!-- dp0_pp1_layer2_expert5&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge65" class="edge">
<title>dp0_pp1_layer2_expert5&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M72164.42,-354.22C72183.04,-347.42 72203.65,-340.55 72223,-335.52 72320.09,-310.27 72430.34,-291.53 72521.07,-278.65"/>
<polygon fill="black" stroke="black" points="72521.78,-282.09 72531.19,-277.23 72520.8,-275.16 72521.78,-282.09"/>
</g>
<!-- dp0_pp1_layer2_expert6&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge66" class="edge">
<title>dp0_pp1_layer2_expert6&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M72412.02,-354.26C72429.26,-348.03 72447.78,-341.44 72465,-335.52 72491.73,-326.33 72520.21,-316.8 72547.89,-307.67"/>
<polygon fill="black" stroke="black" points="72549.24,-310.91 72557.65,-304.46 72547.06,-304.26 72549.24,-310.91"/>
</g>
<!-- dp0_pp1_layer2_expert7&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge67" class="edge">
<title>dp0_pp1_layer2_expert7&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M72610.78,-354.15C72622.02,-342.74 72635.83,-328.73 72649.45,-314.92"/>
<polygon fill="black" stroke="black" points="72652,-317.31 72656.53,-307.73 72647.02,-312.39 72652,-317.31"/>
</g>
<!-- dp0_pp1_layer2_expert8&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge68" class="edge">
<title>dp0_pp1_layer2_expert8&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M72803.22,-354.15C72791.97,-342.74 72778.16,-328.73 72764.55,-314.92"/>
<polygon fill="black" stroke="black" points="72766.98,-312.39 72757.47,-307.73 72761.99,-317.31 72766.98,-312.39"/>
</g>
<!-- dp0_pp1_layer2_expert9&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge69" class="edge">
<title>dp0_pp1_layer2_expert9&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M73001.98,-354.26C72984.73,-348.03 72966.21,-341.44 72949,-335.52 72925.29,-327.37 72900.21,-318.95 72875.53,-310.78"/>
<polygon fill="black" stroke="black" points="72876.32,-307.36 72865.73,-307.54 72874.12,-314 72876.32,-307.36"/>
</g>
<!-- dp0_pp1_layer2_expert10&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge70" class="edge">
<title>dp0_pp1_layer2_expert10&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M73249.58,-354.22C73230.96,-347.42 73210.35,-340.55 73191,-335.52 73110.99,-314.71 73022.05,-298.33 72942.46,-286"/>
<polygon fill="black" stroke="black" points="72942.71,-282.5 72932.3,-284.44 72941.65,-289.41 72942.71,-282.5"/>
</g>
<!-- dp0_pp1_layer2_expert11&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge71" class="edge">
<title>dp0_pp1_layer2_expert11&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M73493.61,-354.24C73474.51,-347.2 73453.13,-340.19 73433,-335.52 73264.74,-296.53 73069.97,-276.66 72924.55,-266.61"/>
<polygon fill="black" stroke="black" points="72924.38,-263.09 72914.16,-265.9 72923.9,-270.07 72924.38,-263.09"/>
</g>
<!-- dp0_pp1_layer2_expert12&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge72" class="edge">
<title>dp0_pp1_layer2_expert12&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M73736.61,-354.26C73717.28,-347.07 73695.52,-339.99 73675,-335.52 73417.51,-279.49 73113.64,-262.43 72915.99,-257.64"/>
<polygon fill="black" stroke="black" points="72915.86,-254.14 72905.78,-257.4 72915.69,-261.13 72915.86,-254.14"/>
</g>
<!-- dp0_pp1_layer2_expert13&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge73" class="edge">
<title>dp0_pp1_layer2_expert13&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M73979.27,-354.29C73959.79,-347.01 73937.77,-339.87 73917,-335.52 73733.02,-297.05 73216.97,-273.81 72921.63,-263.27"/>
<polygon fill="black" stroke="black" points="72921.33,-259.76 72911.21,-262.9 72921.08,-266.76 72921.33,-259.76"/>
</g>
<!-- dp0_pp1_layer2_expert14&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge74" class="edge">
<title>dp0_pp1_layer2_expert14&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M74221.6,-354.27C74202.05,-346.95 74179.9,-339.78 74159,-335.52 73928.27,-288.58 73262.86,-268.1 72918.74,-260.45"/>
<polygon fill="black" stroke="black" points="72918.73,-256.94 72908.65,-260.22 72918.57,-263.94 72918.73,-256.94"/>
</g>
<!-- dp0_pp1_layer2_expert15&#45;&gt;dp0_pp1_layer2_expert_agg -->
<g id="edge75" class="edge">
<title>dp0_pp1_layer2_expert15&#45;&gt;dp0_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M74463.93,-354.29C74444.3,-346.92 74422.03,-339.72 74401,-335.52 74123.21,-280.12 73305.98,-263.37 72917.17,-258.47"/>
<polygon fill="black" stroke="black" points="72916.97,-254.97 72906.93,-258.34 72916.88,-261.97 72916.97,-254.97"/>
</g>
<!-- dp0_pp1_layer3_attn_tp0 -->
<g id="node49" class="node">
<title>dp0_pp1_layer3_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="70189.5,-531.06 69924.5,-531.06 69924.5,-479.06 70189.5,-479.06 70189.5,-531.06"/>
<text text-anchor="middle" x="70057" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="70057" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="70057" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="70057" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer2_expert_agg&#45;&gt;dp0_pp1_layer3_attn_tp0 -->
<g id="edge77" class="edge">
<title>dp0_pp1_layer2_expert_agg&#45;&gt;dp0_pp1_layer3_attn_tp0</title>
<path fill="none" stroke="black" d="M72514.78,-260.41C72094.38,-269.54 71104.17,-294.77 70771,-335.52 70738.8,-339.46 70230.23,-444.29 70199,-453.06 70176.37,-459.41 70152.16,-467.58 70130.26,-475.5"/>
<polygon fill="black" stroke="black" points="70128.89,-472.28 70120.7,-479 70131.29,-478.85 70128.89,-472.28"/>
</g>
<!-- dp0_pp1_layer3_attn_allreduce -->
<g id="node50" class="node">
<title>dp0_pp1_layer3_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="70186" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="70186" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="70186" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="70186" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="70186" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_attn_tp0&#45;&gt;dp0_pp1_layer3_attn_allreduce -->
<g id="edge78" class="edge">
<title>dp0_pp1_layer3_attn_tp0&#45;&gt;dp0_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M70083.41,-478.92C70100.15,-463 70122.21,-442 70141.58,-423.56"/>
<polygon fill="black" stroke="black" points="70144.03,-426.07 70148.86,-416.64 70139.2,-421 70144.03,-426.07"/>
</g>
<!-- dp0_pp1_layer3_router -->
<g id="node54" class="node">
<title>dp0_pp1_layer3_router</title>
<polygon fill="lightyellow" stroke="black" points="67937.57,-557.06 67543.74,-557.06 67442.43,-453.06 67836.26,-453.06 67937.57,-557.06"/>
<text text-anchor="middle" x="67690" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="67690" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="67690" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="67690" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_attn_allreduce&#45;&gt;dp0_pp1_layer3_router -->
<g id="edge114" class="edge">
<title>dp0_pp1_layer3_attn_allreduce&#45;&gt;dp0_pp1_layer3_router</title>
<path fill="none" stroke="black" d="M70026.08,-392.38C69914.77,-399.9 69762.89,-409.76 69629,-417.06 68993.5,-451.72 68240.28,-482.59 67888.96,-496.4"/>
<polygon fill="black" stroke="black" points="67888.8,-492.91 67878.94,-496.79 67889.07,-499.9 67888.8,-492.91"/>
</g>
<!-- dp0_pp1_layer3_attn_tp1 -->
<g id="node51" class="node">
<title>dp0_pp1_layer3_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="70472.5,-531.06 70207.5,-531.06 70207.5,-479.06 70472.5,-479.06 70472.5,-531.06"/>
<text text-anchor="middle" x="70340" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="70340" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="70340" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="70340" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer3_attn_tp1&#45;&gt;dp0_pp1_layer3_attn_allreduce -->
<g id="edge79" class="edge">
<title>dp0_pp1_layer3_attn_tp1&#45;&gt;dp0_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M70308.46,-478.92C70287.99,-462.6 70260.83,-440.94 70237.29,-422.18"/>
<polygon fill="black" stroke="black" points="70239.46,-419.44 70229.46,-415.94 70235.1,-424.91 70239.46,-419.44"/>
</g>
<!-- dp0_pp1_layer3_attn_tp2 -->
<g id="node52" class="node">
<title>dp0_pp1_layer3_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="69906.5,-531.06 69641.5,-531.06 69641.5,-479.06 69906.5,-479.06 69906.5,-531.06"/>
<text text-anchor="middle" x="69774" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="69774" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="69774" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="69774" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer3_attn_tp2&#45;&gt;dp0_pp1_layer3_attn_allreduce -->
<g id="edge80" class="edge">
<title>dp0_pp1_layer3_attn_tp2&#45;&gt;dp0_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M69840.07,-479.02C69863.85,-470.35 69890.99,-460.86 69916,-453.06 69964.74,-437.86 70019.05,-423.03 70066.1,-410.83"/>
<polygon fill="black" stroke="black" points="70067.22,-414.15 70076.03,-408.26 70065.47,-407.38 70067.22,-414.15"/>
</g>
<!-- dp0_pp1_layer3_attn_tp3 -->
<g id="node53" class="node">
<title>dp0_pp1_layer3_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="70755.5,-531.06 70490.5,-531.06 70490.5,-479.06 70755.5,-479.06 70755.5,-531.06"/>
<text text-anchor="middle" x="70623" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="70623" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="70623" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="70623" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer3_attn_tp3&#45;&gt;dp0_pp1_layer3_attn_allreduce -->
<g id="edge81" class="edge">
<title>dp0_pp1_layer3_attn_tp3&#45;&gt;dp0_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M70558.21,-478.95C70534.43,-470.18 70507.17,-460.64 70482,-453.06 70427.42,-436.63 70366.31,-421.31 70313.86,-409.08"/>
<polygon fill="black" stroke="black" points="70314.37,-405.6 70303.83,-406.75 70312.78,-412.42 70314.37,-405.6"/>
</g>
<!-- dp0_pp1_layer3_expert0 -->
<g id="node55" class="node">
<title>dp0_pp1_layer3_expert0</title>
<polygon fill="lightgreen" stroke="black" points="65987,-406.29 65763,-406.29 65763,-354.29 65987,-354.29 65987,-406.29"/>
<text text-anchor="middle" x="65875" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="65875" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="65875" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="65875" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert0 -->
<g id="edge82" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67487.73,-499.65C67102.55,-490.26 66277.11,-465.13 65996,-417.06 65983.99,-415.01 65971.48,-412.16 65959.27,-408.95"/>
<polygon fill="black" stroke="black" points="65960.11,-405.56 65949.54,-406.32 65958.28,-412.31 65960.11,-405.56"/>
</g>
<!-- dp0_pp1_layer3_expert1 -->
<g id="node56" class="node">
<title>dp0_pp1_layer3_expert1</title>
<polygon fill="lightgreen" stroke="black" points="66229,-406.29 66005,-406.29 66005,-354.29 66229,-354.29 66229,-406.29"/>
<text text-anchor="middle" x="66117" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="66117" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="66117" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="66117" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert1 -->
<g id="edge83" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67485.55,-497.55C67143.94,-485.71 66471.58,-458.03 66238,-417.06 66226.08,-414.97 66213.67,-412.12 66201.54,-408.93"/>
<polygon fill="black" stroke="black" points="66202.45,-405.55 66191.89,-406.3 66200.62,-412.3 66202.45,-405.55"/>
</g>
<!-- dp0_pp1_layer3_expert2 -->
<g id="node57" class="node">
<title>dp0_pp1_layer3_expert2</title>
<polygon fill="lightgreen" stroke="black" points="66471,-406.29 66247,-406.29 66247,-354.29 66471,-354.29 66471,-406.29"/>
<text text-anchor="middle" x="66359" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="66359" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="66359" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="66359" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert2 -->
<g id="edge84" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67490.82,-502.85C67249.66,-498.37 66832.02,-480.97 66480,-417.06 66468.38,-414.95 66456.29,-412.14 66444.44,-409.03"/>
<polygon fill="black" stroke="black" points="66445.13,-405.59 66434.56,-406.34 66443.29,-412.34 66445.13,-405.59"/>
</g>
<!-- dp0_pp1_layer3_expert3 -->
<g id="node58" class="node">
<title>dp0_pp1_layer3_expert3</title>
<polygon fill="lightgreen" stroke="black" points="66713,-406.29 66489,-406.29 66489,-354.29 66713,-354.29 66713,-406.29"/>
<text text-anchor="middle" x="66601" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="66601" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="66601" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="66601" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert3 -->
<g id="edge85" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67485.36,-497.41C67288.31,-488.25 66982.63,-466.79 66722,-417.06 66710.57,-414.88 66698.67,-412.06 66686.99,-408.97"/>
<polygon fill="black" stroke="black" points="66687.82,-405.57 66677.25,-406.31 66685.98,-412.32 66687.82,-405.57"/>
</g>
<!-- dp0_pp1_layer3_expert4 -->
<g id="node59" class="node">
<title>dp0_pp1_layer3_expert4</title>
<polygon fill="lightgreen" stroke="black" points="66955,-406.29 66731,-406.29 66731,-354.29 66955,-354.29 66955,-406.29"/>
<text text-anchor="middle" x="66843" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="66843" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="66843" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="66843" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert4 -->
<g id="edge86" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67476.43,-487.98C67330.99,-474.71 67134.64,-452.25 66964,-417.06 66953.05,-414.8 66941.65,-412.02 66930.43,-409.02"/>
<polygon fill="black" stroke="black" points="66931.19,-405.6 66920.62,-406.33 66929.34,-412.35 66931.19,-405.6"/>
</g>
<!-- dp0_pp1_layer3_expert5 -->
<g id="node60" class="node">
<title>dp0_pp1_layer3_expert5</title>
<polygon fill="lightgreen" stroke="black" points="67197,-406.29 66973,-406.29 66973,-354.29 67197,-354.29 67197,-406.29"/>
<text text-anchor="middle" x="67085" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="67085" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="67085" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="67085" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert5 -->
<g id="edge87" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67456.29,-467.38C67376.5,-453.44 67287,-436.25 67206,-417.06 67195.9,-414.67 67185.4,-411.94 67174.99,-409.07"/>
<polygon fill="black" stroke="black" points="67175.62,-405.62 67165.05,-406.3 67173.74,-412.36 67175.62,-405.62"/>
</g>
<!-- dp0_pp1_layer3_expert6 -->
<g id="node61" class="node">
<title>dp0_pp1_layer3_expert6</title>
<polygon fill="lightgreen" stroke="black" points="67439,-406.29 67215,-406.29 67215,-354.29 67439,-354.29 67439,-406.29"/>
<text text-anchor="middle" x="67327" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="67327" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67327" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="67327" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert6 -->
<g id="edge88" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67538.94,-452.97C67495.16,-438.16 67448.94,-422.53 67410.87,-409.66"/>
<polygon fill="black" stroke="black" points="67411.97,-406.33 67401.38,-406.45 67409.73,-412.97 67411.97,-406.33"/>
</g>
<!-- dp0_pp1_layer3_expert7 -->
<g id="node62" class="node">
<title>dp0_pp1_layer3_expert7</title>
<polygon fill="lightgreen" stroke="black" points="67681,-406.29 67457,-406.29 67457,-354.29 67681,-354.29 67681,-406.29"/>
<text text-anchor="middle" x="67569" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="67569" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="67569" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="67569" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert7 -->
<g id="edge89" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67639.38,-452.71C67626.3,-439.43 67612.58,-425.51 67600.76,-413.52"/>
<polygon fill="black" stroke="black" points="67603.19,-411 67593.68,-406.33 67598.2,-415.91 67603.19,-411"/>
</g>
<!-- dp0_pp1_layer3_expert8 -->
<g id="node63" class="node">
<title>dp0_pp1_layer3_expert8</title>
<polygon fill="lightgreen" stroke="black" points="67923,-406.29 67699,-406.29 67699,-354.29 67923,-354.29 67923,-406.29"/>
<text text-anchor="middle" x="67811" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="67811" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="67811" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="67811" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert8 -->
<g id="edge90" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67740.61,-452.71C67753.7,-439.43 67767.42,-425.51 67779.23,-413.52"/>
<polygon fill="black" stroke="black" points="67781.79,-415.91 67786.32,-406.33 67776.81,-411 67781.79,-415.91"/>
</g>
<!-- dp0_pp1_layer3_expert9 -->
<g id="node64" class="node">
<title>dp0_pp1_layer3_expert9</title>
<polygon fill="lightgreen" stroke="black" points="68165,-406.29 67941,-406.29 67941,-354.29 68165,-354.29 68165,-406.29"/>
<text text-anchor="middle" x="68053" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="68053" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="68053" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="68053" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert9 -->
<g id="edge91" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67837.38,-454.21C67882.29,-439.03 67930.08,-422.86 67969.23,-409.62"/>
<polygon fill="black" stroke="black" points="67970.64,-412.84 67978.99,-406.32 67968.4,-406.21 67970.64,-412.84"/>
</g>
<!-- dp0_pp1_layer3_expert10 -->
<g id="node65" class="node">
<title>dp0_pp1_layer3_expert10</title>
<polygon fill="lightgreen" stroke="black" points="68407,-406.29 68183,-406.29 68183,-354.29 68407,-354.29 68407,-406.29"/>
<text text-anchor="middle" x="68295" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="68295" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="68295" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="68295" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert10 -->
<g id="edge92" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67860.89,-478.04C67953.98,-462.69 68070.88,-441.49 68174,-417.06 68184.09,-414.67 68194.6,-411.94 68205.01,-409.07"/>
<polygon fill="black" stroke="black" points="68206.26,-412.36 68214.95,-406.3 68204.37,-405.62 68206.26,-412.36"/>
</g>
<!-- dp0_pp1_layer3_expert11 -->
<g id="node66" class="node">
<title>dp0_pp1_layer3_expert11</title>
<polygon fill="lightgreen" stroke="black" points="68649,-406.29 68425,-406.29 68425,-354.29 68649,-354.29 68649,-406.29"/>
<text text-anchor="middle" x="68537" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="68537" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="68537" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="68537" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert11 -->
<g id="edge93" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67872.99,-490.7C68020.62,-477.88 68233.08,-454.78 68416,-417.06 68426.95,-414.8 68438.35,-412.02 68449.57,-409.02"/>
<polygon fill="black" stroke="black" points="68450.66,-412.35 68459.38,-406.33 68448.81,-405.6 68450.66,-412.35"/>
</g>
<!-- dp0_pp1_layer3_expert12 -->
<g id="node67" class="node">
<title>dp0_pp1_layer3_expert12</title>
<polygon fill="lightgreen" stroke="black" points="68891,-406.29 68667,-406.29 68667,-354.29 68891,-354.29 68891,-406.29"/>
<text text-anchor="middle" x="68779" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="68779" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="68779" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="68779" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert12 -->
<g id="edge94" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67880.27,-498.07C68076.59,-489.29 68390.95,-468.01 68658,-417.06 68669.43,-414.88 68681.33,-412.06 68693.01,-408.97"/>
<polygon fill="black" stroke="black" points="68694.02,-412.32 68702.75,-406.31 68692.18,-405.57 68694.02,-412.32"/>
</g>
<!-- dp0_pp1_layer3_expert13 -->
<g id="node68" class="node">
<title>dp0_pp1_layer3_expert13</title>
<polygon fill="lightgreen" stroke="black" points="69133,-406.29 68909,-406.29 68909,-354.29 69133,-354.29 69133,-406.29"/>
<text text-anchor="middle" x="69021" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="69021" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="69021" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="69021" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert13 -->
<g id="edge95" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67884.93,-502.93C68125.42,-498.58 68545.9,-481.35 68900,-417.06 68911.62,-414.95 68923.71,-412.14 68935.56,-409.03"/>
<polygon fill="black" stroke="black" points="68936.7,-412.34 68945.44,-406.34 68934.87,-405.59 68936.7,-412.34"/>
</g>
<!-- dp0_pp1_layer3_expert14 -->
<g id="node69" class="node">
<title>dp0_pp1_layer3_expert14</title>
<polygon fill="lightgreen" stroke="black" points="69375,-406.29 69151,-406.29 69151,-354.29 69375,-354.29 69375,-406.29"/>
<text text-anchor="middle" x="69263" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="69263" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="69263" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="69263" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert14 -->
<g id="edge96" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67880.32,-498.04C68217.17,-486.48 68905.15,-458.6 69142,-417.06 69153.92,-414.97 69166.32,-412.12 69178.46,-408.93"/>
<polygon fill="black" stroke="black" points="69179.38,-412.3 69188.11,-406.3 69177.54,-405.55 69179.38,-412.3"/>
</g>
<!-- dp0_pp1_layer3_expert15 -->
<g id="node70" class="node">
<title>dp0_pp1_layer3_expert15</title>
<polygon fill="lightgreen" stroke="black" points="69617,-406.29 69393,-406.29 69393,-354.29 69617,-354.29 69617,-406.29"/>
<text text-anchor="middle" x="69505" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="69505" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="69505" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="69505" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert15 -->
<g id="edge97" class="edge">
<title>dp0_pp1_layer3_router&#45;&gt;dp0_pp1_layer3_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67881.94,-499.9C68262.49,-490.72 69100.35,-465.57 69384,-417.06 69396.01,-415.01 69408.51,-412.16 69420.73,-408.95"/>
<polygon fill="black" stroke="black" points="69421.72,-412.31 69430.45,-406.32 69419.88,-405.56 69421.72,-412.31"/>
</g>
<!-- dp0_pp1_layer3_expert_agg -->
<g id="node71" class="node">
<title>dp0_pp1_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="67937.57,-307.52 67543.74,-307.52 67442.43,-203.52 67836.26,-203.52 67937.57,-307.52"/>
<text text-anchor="middle" x="67690" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="67690" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="67690" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="67690" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer3_expert0&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge98" class="edge">
<title>dp0_pp1_layer3_expert0&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M65933.07,-354.29C65952.69,-346.92 65974.97,-339.72 65996,-335.52 66275.13,-279.86 67098.93,-263.21 67485.43,-258.4"/>
<polygon fill="black" stroke="black" points="67485.65,-261.9 67495.61,-258.27 67485.57,-254.9 67485.65,-261.9"/>
</g>
<!-- dp0_pp1_layer3_expert1&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge99" class="edge">
<title>dp0_pp1_layer3_expert1&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M66175.39,-354.27C66194.95,-346.95 66217.09,-339.78 66238,-335.52 66470.8,-288.16 67146.09,-267.74 67487.43,-260.24"/>
<polygon fill="black" stroke="black" points="67487.51,-263.74 67497.43,-260.03 67487.35,-256.74 67487.51,-263.74"/>
</g>
<!-- dp0_pp1_layer3_expert2&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge100" class="edge">
<title>dp0_pp1_layer3_expert2&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M66417.73,-354.29C66437.21,-347.01 66459.23,-339.87 66480,-335.52 66666.91,-296.44 67196.54,-273.07 67489.3,-262.78"/>
<polygon fill="black" stroke="black" points="67489.74,-266.27 67499.61,-262.42 67489.5,-259.27 67489.74,-266.27"/>
</g>
<!-- dp0_pp1_layer3_expert3&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge101" class="edge">
<title>dp0_pp1_layer3_expert3&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M66660.39,-354.26C66679.72,-347.07 66701.48,-339.99 66722,-335.52 66980.91,-279.18 67286.7,-262.24 67484.26,-257.56"/>
<polygon fill="black" stroke="black" points="67484.55,-261.06 67494.47,-257.33 67484.39,-254.06 67484.55,-261.06"/>
</g>
<!-- dp0_pp1_layer3_expert4&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge102" class="edge">
<title>dp0_pp1_layer3_expert4&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M66903.39,-354.24C66922.49,-347.2 66943.87,-340.19 66964,-335.52 67139.82,-294.77 67344.6,-274.91 67491.75,-265.31"/>
<polygon fill="black" stroke="black" points="67492.05,-268.8 67501.81,-264.67 67491.6,-261.82 67492.05,-268.8"/>
</g>
<!-- dp0_pp1_layer3_expert5&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge103" class="edge">
<title>dp0_pp1_layer3_expert5&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M67147.42,-354.22C67166.04,-347.42 67186.65,-340.55 67206,-335.52 67303.09,-310.27 67413.34,-291.53 67504.07,-278.65"/>
<polygon fill="black" stroke="black" points="67504.78,-282.09 67514.19,-277.23 67503.8,-275.16 67504.78,-282.09"/>
</g>
<!-- dp0_pp1_layer3_expert6&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge104" class="edge">
<title>dp0_pp1_layer3_expert6&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M67395.02,-354.26C67412.26,-348.03 67430.78,-341.44 67448,-335.52 67474.73,-326.33 67503.21,-316.8 67530.89,-307.67"/>
<polygon fill="black" stroke="black" points="67532.24,-310.91 67540.65,-304.46 67530.06,-304.26 67532.24,-310.91"/>
</g>
<!-- dp0_pp1_layer3_expert7&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge105" class="edge">
<title>dp0_pp1_layer3_expert7&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M67593.78,-354.15C67605.02,-342.74 67618.83,-328.73 67632.45,-314.92"/>
<polygon fill="black" stroke="black" points="67635,-317.31 67639.53,-307.73 67630.02,-312.39 67635,-317.31"/>
</g>
<!-- dp0_pp1_layer3_expert8&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge106" class="edge">
<title>dp0_pp1_layer3_expert8&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M67786.22,-354.15C67774.97,-342.74 67761.16,-328.73 67747.55,-314.92"/>
<polygon fill="black" stroke="black" points="67749.98,-312.39 67740.47,-307.73 67744.99,-317.31 67749.98,-312.39"/>
</g>
<!-- dp0_pp1_layer3_expert9&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge107" class="edge">
<title>dp0_pp1_layer3_expert9&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M67984.98,-354.26C67967.73,-348.03 67949.21,-341.44 67932,-335.52 67908.29,-327.37 67883.21,-318.95 67858.53,-310.78"/>
<polygon fill="black" stroke="black" points="67859.32,-307.36 67848.73,-307.54 67857.12,-314 67859.32,-307.36"/>
</g>
<!-- dp0_pp1_layer3_expert10&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge108" class="edge">
<title>dp0_pp1_layer3_expert10&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M68232.58,-354.22C68213.96,-347.42 68193.35,-340.55 68174,-335.52 68093.99,-314.71 68005.05,-298.33 67925.46,-286"/>
<polygon fill="black" stroke="black" points="67925.71,-282.5 67915.3,-284.44 67924.65,-289.41 67925.71,-282.5"/>
</g>
<!-- dp0_pp1_layer3_expert11&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge109" class="edge">
<title>dp0_pp1_layer3_expert11&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M68476.61,-354.24C68457.51,-347.2 68436.13,-340.19 68416,-335.52 68247.74,-296.53 68052.97,-276.66 67907.55,-266.61"/>
<polygon fill="black" stroke="black" points="67907.38,-263.09 67897.16,-265.9 67906.9,-270.07 67907.38,-263.09"/>
</g>
<!-- dp0_pp1_layer3_expert12&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge110" class="edge">
<title>dp0_pp1_layer3_expert12&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M68719.61,-354.26C68700.28,-347.07 68678.52,-339.99 68658,-335.52 68400.51,-279.49 68096.64,-262.43 67898.99,-257.64"/>
<polygon fill="black" stroke="black" points="67898.86,-254.14 67888.78,-257.4 67898.69,-261.13 67898.86,-254.14"/>
</g>
<!-- dp0_pp1_layer3_expert13&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge111" class="edge">
<title>dp0_pp1_layer3_expert13&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M68962.27,-354.29C68942.79,-347.01 68920.77,-339.87 68900,-335.52 68716.02,-297.05 68199.97,-273.81 67904.63,-263.27"/>
<polygon fill="black" stroke="black" points="67904.33,-259.76 67894.21,-262.9 67904.08,-266.76 67904.33,-259.76"/>
</g>
<!-- dp0_pp1_layer3_expert14&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge112" class="edge">
<title>dp0_pp1_layer3_expert14&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M69204.6,-354.27C69185.05,-346.95 69162.9,-339.78 69142,-335.52 68911.27,-288.58 68245.86,-268.1 67901.74,-260.45"/>
<polygon fill="black" stroke="black" points="67901.73,-256.94 67891.65,-260.22 67901.57,-263.94 67901.73,-256.94"/>
</g>
<!-- dp0_pp1_layer3_expert15&#45;&gt;dp0_pp1_layer3_expert_agg -->
<g id="edge113" class="edge">
<title>dp0_pp1_layer3_expert15&#45;&gt;dp0_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M69446.93,-354.29C69427.3,-346.92 69405.03,-339.72 69384,-335.52 69106.21,-280.12 68288.98,-263.37 67900.17,-258.47"/>
<polygon fill="black" stroke="black" points="67899.97,-254.97 67889.93,-258.34 67899.88,-261.97 67899.97,-254.97"/>
</g>
<!-- dp0_pp1_layer4_attn_tp0 -->
<g id="node72" class="node">
<title>dp0_pp1_layer4_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="65172.5,-531.06 64907.5,-531.06 64907.5,-479.06 65172.5,-479.06 65172.5,-531.06"/>
<text text-anchor="middle" x="65040" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="65040" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="65040" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65040" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer3_expert_agg&#45;&gt;dp0_pp1_layer4_attn_tp0 -->
<g id="edge115" class="edge">
<title>dp0_pp1_layer3_expert_agg&#45;&gt;dp0_pp1_layer4_attn_tp0</title>
<path fill="none" stroke="black" d="M67497.78,-260.41C67077.38,-269.54 66087.17,-294.77 65754,-335.52 65721.8,-339.46 65213.23,-444.29 65182,-453.06 65159.37,-459.41 65135.16,-467.58 65113.26,-475.5"/>
<polygon fill="black" stroke="black" points="65111.89,-472.28 65103.7,-479 65114.29,-478.85 65111.89,-472.28"/>
</g>
<!-- dp0_pp1_layer4_attn_allreduce -->
<g id="node73" class="node">
<title>dp0_pp1_layer4_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="65169" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="65169" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="65169" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="65169" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="65169" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_attn_tp0&#45;&gt;dp0_pp1_layer4_attn_allreduce -->
<g id="edge116" class="edge">
<title>dp0_pp1_layer4_attn_tp0&#45;&gt;dp0_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M65066.41,-478.92C65083.15,-463 65105.21,-442 65124.58,-423.56"/>
<polygon fill="black" stroke="black" points="65127.03,-426.07 65131.86,-416.64 65122.2,-421 65127.03,-426.07"/>
</g>
<!-- dp0_pp1_layer4_router -->
<g id="node77" class="node">
<title>dp0_pp1_layer4_router</title>
<polygon fill="lightyellow" stroke="black" points="62920.57,-557.06 62526.74,-557.06 62425.43,-453.06 62819.26,-453.06 62920.57,-557.06"/>
<text text-anchor="middle" x="62673" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="62673" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="62673" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="62673" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_attn_allreduce&#45;&gt;dp0_pp1_layer4_router -->
<g id="edge152" class="edge">
<title>dp0_pp1_layer4_attn_allreduce&#45;&gt;dp0_pp1_layer4_router</title>
<path fill="none" stroke="black" d="M65009.08,-392.38C64897.77,-399.9 64745.89,-409.76 64612,-417.06 63976.5,-451.72 63223.28,-482.59 62871.96,-496.4"/>
<polygon fill="black" stroke="black" points="62871.8,-492.91 62861.94,-496.79 62872.07,-499.9 62871.8,-492.91"/>
</g>
<!-- dp0_pp1_layer4_attn_tp1 -->
<g id="node74" class="node">
<title>dp0_pp1_layer4_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="65455.5,-531.06 65190.5,-531.06 65190.5,-479.06 65455.5,-479.06 65455.5,-531.06"/>
<text text-anchor="middle" x="65323" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="65323" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="65323" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65323" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer4_attn_tp1&#45;&gt;dp0_pp1_layer4_attn_allreduce -->
<g id="edge117" class="edge">
<title>dp0_pp1_layer4_attn_tp1&#45;&gt;dp0_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M65291.46,-478.92C65270.99,-462.6 65243.83,-440.94 65220.29,-422.18"/>
<polygon fill="black" stroke="black" points="65222.46,-419.44 65212.46,-415.94 65218.1,-424.91 65222.46,-419.44"/>
</g>
<!-- dp0_pp1_layer4_attn_tp2 -->
<g id="node75" class="node">
<title>dp0_pp1_layer4_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="64889.5,-531.06 64624.5,-531.06 64624.5,-479.06 64889.5,-479.06 64889.5,-531.06"/>
<text text-anchor="middle" x="64757" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="64757" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="64757" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="64757" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer4_attn_tp2&#45;&gt;dp0_pp1_layer4_attn_allreduce -->
<g id="edge118" class="edge">
<title>dp0_pp1_layer4_attn_tp2&#45;&gt;dp0_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M64823.07,-479.02C64846.85,-470.35 64873.99,-460.86 64899,-453.06 64947.74,-437.86 65002.05,-423.03 65049.1,-410.83"/>
<polygon fill="black" stroke="black" points="65050.22,-414.15 65059.03,-408.26 65048.47,-407.38 65050.22,-414.15"/>
</g>
<!-- dp0_pp1_layer4_attn_tp3 -->
<g id="node76" class="node">
<title>dp0_pp1_layer4_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="65738.5,-531.06 65473.5,-531.06 65473.5,-479.06 65738.5,-479.06 65738.5,-531.06"/>
<text text-anchor="middle" x="65606" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="65606" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="65606" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65606" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer4_attn_tp3&#45;&gt;dp0_pp1_layer4_attn_allreduce -->
<g id="edge119" class="edge">
<title>dp0_pp1_layer4_attn_tp3&#45;&gt;dp0_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M65541.21,-478.95C65517.43,-470.18 65490.17,-460.64 65465,-453.06 65410.42,-436.63 65349.31,-421.31 65296.86,-409.08"/>
<polygon fill="black" stroke="black" points="65297.37,-405.6 65286.83,-406.75 65295.78,-412.42 65297.37,-405.6"/>
</g>
<!-- dp0_pp1_layer4_expert0 -->
<g id="node78" class="node">
<title>dp0_pp1_layer4_expert0</title>
<polygon fill="lightgreen" stroke="black" points="60970,-406.29 60746,-406.29 60746,-354.29 60970,-354.29 60970,-406.29"/>
<text text-anchor="middle" x="60858" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="60858" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="60858" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="60858" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert0 -->
<g id="edge120" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62470.73,-499.65C62085.55,-490.26 61260.11,-465.13 60979,-417.06 60966.99,-415.01 60954.48,-412.16 60942.27,-408.95"/>
<polygon fill="black" stroke="black" points="60943.11,-405.56 60932.54,-406.32 60941.28,-412.31 60943.11,-405.56"/>
</g>
<!-- dp0_pp1_layer4_expert1 -->
<g id="node79" class="node">
<title>dp0_pp1_layer4_expert1</title>
<polygon fill="lightgreen" stroke="black" points="61212,-406.29 60988,-406.29 60988,-354.29 61212,-354.29 61212,-406.29"/>
<text text-anchor="middle" x="61100" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="61100" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="61100" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="61100" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert1 -->
<g id="edge121" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62468.55,-497.55C62126.94,-485.71 61454.58,-458.03 61221,-417.06 61209.08,-414.97 61196.67,-412.12 61184.54,-408.93"/>
<polygon fill="black" stroke="black" points="61185.45,-405.55 61174.89,-406.3 61183.62,-412.3 61185.45,-405.55"/>
</g>
<!-- dp0_pp1_layer4_expert2 -->
<g id="node80" class="node">
<title>dp0_pp1_layer4_expert2</title>
<polygon fill="lightgreen" stroke="black" points="61454,-406.29 61230,-406.29 61230,-354.29 61454,-354.29 61454,-406.29"/>
<text text-anchor="middle" x="61342" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="61342" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="61342" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="61342" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert2 -->
<g id="edge122" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62473.82,-502.85C62232.66,-498.37 61815.02,-480.97 61463,-417.06 61451.38,-414.95 61439.29,-412.14 61427.44,-409.03"/>
<polygon fill="black" stroke="black" points="61428.13,-405.59 61417.56,-406.34 61426.29,-412.34 61428.13,-405.59"/>
</g>
<!-- dp0_pp1_layer4_expert3 -->
<g id="node81" class="node">
<title>dp0_pp1_layer4_expert3</title>
<polygon fill="lightgreen" stroke="black" points="61696,-406.29 61472,-406.29 61472,-354.29 61696,-354.29 61696,-406.29"/>
<text text-anchor="middle" x="61584" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="61584" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="61584" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="61584" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert3 -->
<g id="edge123" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62468.36,-497.41C62271.31,-488.25 61965.63,-466.79 61705,-417.06 61693.57,-414.88 61681.67,-412.06 61669.99,-408.97"/>
<polygon fill="black" stroke="black" points="61670.82,-405.57 61660.25,-406.31 61668.98,-412.32 61670.82,-405.57"/>
</g>
<!-- dp0_pp1_layer4_expert4 -->
<g id="node82" class="node">
<title>dp0_pp1_layer4_expert4</title>
<polygon fill="lightgreen" stroke="black" points="61938,-406.29 61714,-406.29 61714,-354.29 61938,-354.29 61938,-406.29"/>
<text text-anchor="middle" x="61826" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="61826" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="61826" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="61826" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert4 -->
<g id="edge124" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62459.43,-487.98C62313.99,-474.71 62117.64,-452.25 61947,-417.06 61936.05,-414.8 61924.65,-412.02 61913.43,-409.02"/>
<polygon fill="black" stroke="black" points="61914.19,-405.6 61903.62,-406.33 61912.34,-412.35 61914.19,-405.6"/>
</g>
<!-- dp0_pp1_layer4_expert5 -->
<g id="node83" class="node">
<title>dp0_pp1_layer4_expert5</title>
<polygon fill="lightgreen" stroke="black" points="62180,-406.29 61956,-406.29 61956,-354.29 62180,-354.29 62180,-406.29"/>
<text text-anchor="middle" x="62068" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="62068" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="62068" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="62068" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert5 -->
<g id="edge125" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62439.29,-467.38C62359.5,-453.44 62270,-436.25 62189,-417.06 62178.9,-414.67 62168.4,-411.94 62157.99,-409.07"/>
<polygon fill="black" stroke="black" points="62158.62,-405.62 62148.05,-406.3 62156.74,-412.36 62158.62,-405.62"/>
</g>
<!-- dp0_pp1_layer4_expert6 -->
<g id="node84" class="node">
<title>dp0_pp1_layer4_expert6</title>
<polygon fill="lightgreen" stroke="black" points="62422,-406.29 62198,-406.29 62198,-354.29 62422,-354.29 62422,-406.29"/>
<text text-anchor="middle" x="62310" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="62310" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="62310" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="62310" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert6 -->
<g id="edge126" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62521.94,-452.97C62478.16,-438.16 62431.94,-422.53 62393.87,-409.66"/>
<polygon fill="black" stroke="black" points="62394.97,-406.33 62384.38,-406.45 62392.73,-412.97 62394.97,-406.33"/>
</g>
<!-- dp0_pp1_layer4_expert7 -->
<g id="node85" class="node">
<title>dp0_pp1_layer4_expert7</title>
<polygon fill="lightgreen" stroke="black" points="62664,-406.29 62440,-406.29 62440,-354.29 62664,-354.29 62664,-406.29"/>
<text text-anchor="middle" x="62552" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="62552" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="62552" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="62552" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert7 -->
<g id="edge127" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62622.38,-452.71C62609.3,-439.43 62595.58,-425.51 62583.76,-413.52"/>
<polygon fill="black" stroke="black" points="62586.19,-411 62576.68,-406.33 62581.2,-415.91 62586.19,-411"/>
</g>
<!-- dp0_pp1_layer4_expert8 -->
<g id="node86" class="node">
<title>dp0_pp1_layer4_expert8</title>
<polygon fill="lightgreen" stroke="black" points="62906,-406.29 62682,-406.29 62682,-354.29 62906,-354.29 62906,-406.29"/>
<text text-anchor="middle" x="62794" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="62794" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="62794" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="62794" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert8 -->
<g id="edge128" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62723.61,-452.71C62736.7,-439.43 62750.42,-425.51 62762.23,-413.52"/>
<polygon fill="black" stroke="black" points="62764.79,-415.91 62769.32,-406.33 62759.81,-411 62764.79,-415.91"/>
</g>
<!-- dp0_pp1_layer4_expert9 -->
<g id="node87" class="node">
<title>dp0_pp1_layer4_expert9</title>
<polygon fill="lightgreen" stroke="black" points="63148,-406.29 62924,-406.29 62924,-354.29 63148,-354.29 63148,-406.29"/>
<text text-anchor="middle" x="63036" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="63036" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="63036" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="63036" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert9 -->
<g id="edge129" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62820.38,-454.21C62865.29,-439.03 62913.08,-422.86 62952.23,-409.62"/>
<polygon fill="black" stroke="black" points="62953.64,-412.84 62961.99,-406.32 62951.4,-406.21 62953.64,-412.84"/>
</g>
<!-- dp0_pp1_layer4_expert10 -->
<g id="node88" class="node">
<title>dp0_pp1_layer4_expert10</title>
<polygon fill="lightgreen" stroke="black" points="63390,-406.29 63166,-406.29 63166,-354.29 63390,-354.29 63390,-406.29"/>
<text text-anchor="middle" x="63278" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="63278" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="63278" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="63278" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert10 -->
<g id="edge130" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62843.89,-478.04C62936.98,-462.69 63053.88,-441.49 63157,-417.06 63167.09,-414.67 63177.6,-411.94 63188.01,-409.07"/>
<polygon fill="black" stroke="black" points="63189.26,-412.36 63197.95,-406.3 63187.37,-405.62 63189.26,-412.36"/>
</g>
<!-- dp0_pp1_layer4_expert11 -->
<g id="node89" class="node">
<title>dp0_pp1_layer4_expert11</title>
<polygon fill="lightgreen" stroke="black" points="63632,-406.29 63408,-406.29 63408,-354.29 63632,-354.29 63632,-406.29"/>
<text text-anchor="middle" x="63520" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="63520" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="63520" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="63520" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert11 -->
<g id="edge131" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62855.99,-490.7C63003.62,-477.88 63216.08,-454.78 63399,-417.06 63409.95,-414.8 63421.35,-412.02 63432.57,-409.02"/>
<polygon fill="black" stroke="black" points="63433.66,-412.35 63442.38,-406.33 63431.81,-405.6 63433.66,-412.35"/>
</g>
<!-- dp0_pp1_layer4_expert12 -->
<g id="node90" class="node">
<title>dp0_pp1_layer4_expert12</title>
<polygon fill="lightgreen" stroke="black" points="63874,-406.29 63650,-406.29 63650,-354.29 63874,-354.29 63874,-406.29"/>
<text text-anchor="middle" x="63762" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="63762" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="63762" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="63762" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert12 -->
<g id="edge132" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62863.27,-498.07C63059.59,-489.29 63373.95,-468.01 63641,-417.06 63652.43,-414.88 63664.33,-412.06 63676.01,-408.97"/>
<polygon fill="black" stroke="black" points="63677.02,-412.32 63685.75,-406.31 63675.18,-405.57 63677.02,-412.32"/>
</g>
<!-- dp0_pp1_layer4_expert13 -->
<g id="node91" class="node">
<title>dp0_pp1_layer4_expert13</title>
<polygon fill="lightgreen" stroke="black" points="64116,-406.29 63892,-406.29 63892,-354.29 64116,-354.29 64116,-406.29"/>
<text text-anchor="middle" x="64004" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="64004" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="64004" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="64004" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert13 -->
<g id="edge133" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62867.93,-502.93C63108.42,-498.58 63528.9,-481.35 63883,-417.06 63894.62,-414.95 63906.71,-412.14 63918.56,-409.03"/>
<polygon fill="black" stroke="black" points="63919.7,-412.34 63928.44,-406.34 63917.87,-405.59 63919.7,-412.34"/>
</g>
<!-- dp0_pp1_layer4_expert14 -->
<g id="node92" class="node">
<title>dp0_pp1_layer4_expert14</title>
<polygon fill="lightgreen" stroke="black" points="64358,-406.29 64134,-406.29 64134,-354.29 64358,-354.29 64358,-406.29"/>
<text text-anchor="middle" x="64246" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="64246" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="64246" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="64246" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert14 -->
<g id="edge134" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62863.32,-498.04C63200.17,-486.48 63888.15,-458.6 64125,-417.06 64136.92,-414.97 64149.32,-412.12 64161.46,-408.93"/>
<polygon fill="black" stroke="black" points="64162.38,-412.3 64171.11,-406.3 64160.54,-405.55 64162.38,-412.3"/>
</g>
<!-- dp0_pp1_layer4_expert15 -->
<g id="node93" class="node">
<title>dp0_pp1_layer4_expert15</title>
<polygon fill="lightgreen" stroke="black" points="64600,-406.29 64376,-406.29 64376,-354.29 64600,-354.29 64600,-406.29"/>
<text text-anchor="middle" x="64488" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="64488" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="64488" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="64488" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert15 -->
<g id="edge135" class="edge">
<title>dp0_pp1_layer4_router&#45;&gt;dp0_pp1_layer4_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62864.94,-499.9C63245.49,-490.72 64083.35,-465.57 64367,-417.06 64379.01,-415.01 64391.51,-412.16 64403.73,-408.95"/>
<polygon fill="black" stroke="black" points="64404.72,-412.31 64413.45,-406.32 64402.88,-405.56 64404.72,-412.31"/>
</g>
<!-- dp0_pp1_layer4_expert_agg -->
<g id="node94" class="node">
<title>dp0_pp1_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="62920.57,-307.52 62526.74,-307.52 62425.43,-203.52 62819.26,-203.52 62920.57,-307.52"/>
<text text-anchor="middle" x="62673" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="62673" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="62673" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="62673" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer4_expert0&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge136" class="edge">
<title>dp0_pp1_layer4_expert0&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M60916.07,-354.29C60935.69,-346.92 60957.97,-339.72 60979,-335.52 61258.13,-279.86 62081.93,-263.21 62468.43,-258.4"/>
<polygon fill="black" stroke="black" points="62468.65,-261.9 62478.61,-258.27 62468.57,-254.9 62468.65,-261.9"/>
</g>
<!-- dp0_pp1_layer4_expert1&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge137" class="edge">
<title>dp0_pp1_layer4_expert1&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M61158.39,-354.27C61177.95,-346.95 61200.09,-339.78 61221,-335.52 61453.8,-288.16 62129.09,-267.74 62470.43,-260.24"/>
<polygon fill="black" stroke="black" points="62470.51,-263.74 62480.43,-260.03 62470.35,-256.74 62470.51,-263.74"/>
</g>
<!-- dp0_pp1_layer4_expert2&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge138" class="edge">
<title>dp0_pp1_layer4_expert2&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M61400.73,-354.29C61420.21,-347.01 61442.23,-339.87 61463,-335.52 61649.91,-296.44 62179.54,-273.07 62472.3,-262.78"/>
<polygon fill="black" stroke="black" points="62472.74,-266.27 62482.61,-262.42 62472.5,-259.27 62472.74,-266.27"/>
</g>
<!-- dp0_pp1_layer4_expert3&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge139" class="edge">
<title>dp0_pp1_layer4_expert3&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M61643.39,-354.26C61662.72,-347.07 61684.48,-339.99 61705,-335.52 61963.91,-279.18 62269.7,-262.24 62467.26,-257.56"/>
<polygon fill="black" stroke="black" points="62467.55,-261.06 62477.47,-257.33 62467.39,-254.06 62467.55,-261.06"/>
</g>
<!-- dp0_pp1_layer4_expert4&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge140" class="edge">
<title>dp0_pp1_layer4_expert4&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M61886.39,-354.24C61905.49,-347.2 61926.87,-340.19 61947,-335.52 62122.82,-294.77 62327.6,-274.91 62474.75,-265.31"/>
<polygon fill="black" stroke="black" points="62475.05,-268.8 62484.81,-264.67 62474.6,-261.82 62475.05,-268.8"/>
</g>
<!-- dp0_pp1_layer4_expert5&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge141" class="edge">
<title>dp0_pp1_layer4_expert5&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M62130.42,-354.22C62149.04,-347.42 62169.65,-340.55 62189,-335.52 62286.09,-310.27 62396.34,-291.53 62487.07,-278.65"/>
<polygon fill="black" stroke="black" points="62487.78,-282.09 62497.19,-277.23 62486.8,-275.16 62487.78,-282.09"/>
</g>
<!-- dp0_pp1_layer4_expert6&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge142" class="edge">
<title>dp0_pp1_layer4_expert6&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M62378.02,-354.26C62395.26,-348.03 62413.78,-341.44 62431,-335.52 62457.73,-326.33 62486.21,-316.8 62513.89,-307.67"/>
<polygon fill="black" stroke="black" points="62515.24,-310.91 62523.65,-304.46 62513.06,-304.26 62515.24,-310.91"/>
</g>
<!-- dp0_pp1_layer4_expert7&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge143" class="edge">
<title>dp0_pp1_layer4_expert7&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M62576.78,-354.15C62588.02,-342.74 62601.83,-328.73 62615.45,-314.92"/>
<polygon fill="black" stroke="black" points="62618,-317.31 62622.53,-307.73 62613.02,-312.39 62618,-317.31"/>
</g>
<!-- dp0_pp1_layer4_expert8&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge144" class="edge">
<title>dp0_pp1_layer4_expert8&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M62769.22,-354.15C62757.97,-342.74 62744.16,-328.73 62730.55,-314.92"/>
<polygon fill="black" stroke="black" points="62732.98,-312.39 62723.47,-307.73 62727.99,-317.31 62732.98,-312.39"/>
</g>
<!-- dp0_pp1_layer4_expert9&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge145" class="edge">
<title>dp0_pp1_layer4_expert9&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M62967.98,-354.26C62950.73,-348.03 62932.21,-341.44 62915,-335.52 62891.29,-327.37 62866.21,-318.95 62841.53,-310.78"/>
<polygon fill="black" stroke="black" points="62842.32,-307.36 62831.73,-307.54 62840.12,-314 62842.32,-307.36"/>
</g>
<!-- dp0_pp1_layer4_expert10&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge146" class="edge">
<title>dp0_pp1_layer4_expert10&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M63215.58,-354.22C63196.96,-347.42 63176.35,-340.55 63157,-335.52 63076.99,-314.71 62988.05,-298.33 62908.46,-286"/>
<polygon fill="black" stroke="black" points="62908.71,-282.5 62898.3,-284.44 62907.65,-289.41 62908.71,-282.5"/>
</g>
<!-- dp0_pp1_layer4_expert11&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge147" class="edge">
<title>dp0_pp1_layer4_expert11&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M63459.61,-354.24C63440.51,-347.2 63419.13,-340.19 63399,-335.52 63230.74,-296.53 63035.97,-276.66 62890.55,-266.61"/>
<polygon fill="black" stroke="black" points="62890.38,-263.09 62880.16,-265.9 62889.9,-270.07 62890.38,-263.09"/>
</g>
<!-- dp0_pp1_layer4_expert12&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge148" class="edge">
<title>dp0_pp1_layer4_expert12&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M63702.61,-354.26C63683.28,-347.07 63661.52,-339.99 63641,-335.52 63383.51,-279.49 63079.64,-262.43 62881.99,-257.64"/>
<polygon fill="black" stroke="black" points="62881.86,-254.14 62871.78,-257.4 62881.69,-261.13 62881.86,-254.14"/>
</g>
<!-- dp0_pp1_layer4_expert13&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge149" class="edge">
<title>dp0_pp1_layer4_expert13&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M63945.27,-354.29C63925.79,-347.01 63903.77,-339.87 63883,-335.52 63699.02,-297.05 63182.97,-273.81 62887.63,-263.27"/>
<polygon fill="black" stroke="black" points="62887.33,-259.76 62877.21,-262.9 62887.08,-266.76 62887.33,-259.76"/>
</g>
<!-- dp0_pp1_layer4_expert14&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge150" class="edge">
<title>dp0_pp1_layer4_expert14&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M64187.6,-354.27C64168.05,-346.95 64145.9,-339.78 64125,-335.52 63894.27,-288.58 63228.86,-268.1 62884.74,-260.45"/>
<polygon fill="black" stroke="black" points="62884.73,-256.94 62874.65,-260.22 62884.57,-263.94 62884.73,-256.94"/>
</g>
<!-- dp0_pp1_layer4_expert15&#45;&gt;dp0_pp1_layer4_expert_agg -->
<g id="edge151" class="edge">
<title>dp0_pp1_layer4_expert15&#45;&gt;dp0_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M64429.93,-354.29C64410.3,-346.92 64388.03,-339.72 64367,-335.52 64089.21,-280.12 63271.98,-263.37 62883.17,-258.47"/>
<polygon fill="black" stroke="black" points="62882.97,-254.97 62872.93,-258.34 62882.88,-261.97 62882.97,-254.97"/>
</g>
<!-- dp0_pp1_layer5_attn_tp0 -->
<g id="node95" class="node">
<title>dp0_pp1_layer5_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="60155.5,-531.06 59890.5,-531.06 59890.5,-479.06 60155.5,-479.06 60155.5,-531.06"/>
<text text-anchor="middle" x="60023" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="60023" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="60023" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="60023" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer4_expert_agg&#45;&gt;dp0_pp1_layer5_attn_tp0 -->
<g id="edge153" class="edge">
<title>dp0_pp1_layer4_expert_agg&#45;&gt;dp0_pp1_layer5_attn_tp0</title>
<path fill="none" stroke="black" d="M62480.78,-260.41C62060.38,-269.54 61070.17,-294.77 60737,-335.52 60704.8,-339.46 60196.23,-444.29 60165,-453.06 60142.37,-459.41 60118.16,-467.58 60096.26,-475.5"/>
<polygon fill="black" stroke="black" points="60094.89,-472.28 60086.7,-479 60097.29,-478.85 60094.89,-472.28"/>
</g>
<!-- dp0_pp1_layer5_attn_allreduce -->
<g id="node96" class="node">
<title>dp0_pp1_layer5_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="60152" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="60152" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="60152" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="60152" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="60152" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_attn_tp0&#45;&gt;dp0_pp1_layer5_attn_allreduce -->
<g id="edge154" class="edge">
<title>dp0_pp1_layer5_attn_tp0&#45;&gt;dp0_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M60049.41,-478.92C60066.15,-463 60088.21,-442 60107.58,-423.56"/>
<polygon fill="black" stroke="black" points="60110.03,-426.07 60114.86,-416.64 60105.2,-421 60110.03,-426.07"/>
</g>
<!-- dp0_pp1_layer5_router -->
<g id="node100" class="node">
<title>dp0_pp1_layer5_router</title>
<polygon fill="lightyellow" stroke="black" points="57903.57,-557.06 57509.74,-557.06 57408.43,-453.06 57802.26,-453.06 57903.57,-557.06"/>
<text text-anchor="middle" x="57656" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="57656" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="57656" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="57656" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_attn_allreduce&#45;&gt;dp0_pp1_layer5_router -->
<g id="edge190" class="edge">
<title>dp0_pp1_layer5_attn_allreduce&#45;&gt;dp0_pp1_layer5_router</title>
<path fill="none" stroke="black" d="M59992.08,-392.38C59880.77,-399.9 59728.89,-409.76 59595,-417.06 58959.5,-451.72 58206.28,-482.59 57854.96,-496.4"/>
<polygon fill="black" stroke="black" points="57854.8,-492.91 57844.94,-496.79 57855.07,-499.9 57854.8,-492.91"/>
</g>
<!-- dp0_pp1_layer5_attn_tp1 -->
<g id="node97" class="node">
<title>dp0_pp1_layer5_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="60438.5,-531.06 60173.5,-531.06 60173.5,-479.06 60438.5,-479.06 60438.5,-531.06"/>
<text text-anchor="middle" x="60306" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="60306" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="60306" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="60306" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer5_attn_tp1&#45;&gt;dp0_pp1_layer5_attn_allreduce -->
<g id="edge155" class="edge">
<title>dp0_pp1_layer5_attn_tp1&#45;&gt;dp0_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M60274.46,-478.92C60253.99,-462.6 60226.83,-440.94 60203.29,-422.18"/>
<polygon fill="black" stroke="black" points="60205.46,-419.44 60195.46,-415.94 60201.1,-424.91 60205.46,-419.44"/>
</g>
<!-- dp0_pp1_layer5_attn_tp2 -->
<g id="node98" class="node">
<title>dp0_pp1_layer5_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="59872.5,-531.06 59607.5,-531.06 59607.5,-479.06 59872.5,-479.06 59872.5,-531.06"/>
<text text-anchor="middle" x="59740" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="59740" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="59740" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="59740" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer5_attn_tp2&#45;&gt;dp0_pp1_layer5_attn_allreduce -->
<g id="edge156" class="edge">
<title>dp0_pp1_layer5_attn_tp2&#45;&gt;dp0_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M59806.07,-479.02C59829.85,-470.35 59856.99,-460.86 59882,-453.06 59930.74,-437.86 59985.05,-423.03 60032.1,-410.83"/>
<polygon fill="black" stroke="black" points="60033.22,-414.15 60042.03,-408.26 60031.47,-407.38 60033.22,-414.15"/>
</g>
<!-- dp0_pp1_layer5_attn_tp3 -->
<g id="node99" class="node">
<title>dp0_pp1_layer5_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="60721.5,-531.06 60456.5,-531.06 60456.5,-479.06 60721.5,-479.06 60721.5,-531.06"/>
<text text-anchor="middle" x="60589" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="60589" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="60589" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="60589" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer5_attn_tp3&#45;&gt;dp0_pp1_layer5_attn_allreduce -->
<g id="edge157" class="edge">
<title>dp0_pp1_layer5_attn_tp3&#45;&gt;dp0_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M60524.21,-478.95C60500.43,-470.18 60473.17,-460.64 60448,-453.06 60393.42,-436.63 60332.31,-421.31 60279.86,-409.08"/>
<polygon fill="black" stroke="black" points="60280.37,-405.6 60269.83,-406.75 60278.78,-412.42 60280.37,-405.6"/>
</g>
<!-- dp0_pp1_layer5_expert0 -->
<g id="node101" class="node">
<title>dp0_pp1_layer5_expert0</title>
<polygon fill="lightgreen" stroke="black" points="55953,-406.29 55729,-406.29 55729,-354.29 55953,-354.29 55953,-406.29"/>
<text text-anchor="middle" x="55841" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="55841" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="55841" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="55841" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert0 -->
<g id="edge158" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57453.73,-499.65C57068.55,-490.26 56243.11,-465.13 55962,-417.06 55949.99,-415.01 55937.48,-412.16 55925.27,-408.95"/>
<polygon fill="black" stroke="black" points="55926.11,-405.56 55915.54,-406.32 55924.28,-412.31 55926.11,-405.56"/>
</g>
<!-- dp0_pp1_layer5_expert1 -->
<g id="node102" class="node">
<title>dp0_pp1_layer5_expert1</title>
<polygon fill="lightgreen" stroke="black" points="56195,-406.29 55971,-406.29 55971,-354.29 56195,-354.29 56195,-406.29"/>
<text text-anchor="middle" x="56083" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="56083" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="56083" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="56083" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert1 -->
<g id="edge159" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57451.55,-497.55C57109.94,-485.71 56437.58,-458.03 56204,-417.06 56192.08,-414.97 56179.67,-412.12 56167.54,-408.93"/>
<polygon fill="black" stroke="black" points="56168.45,-405.55 56157.89,-406.3 56166.62,-412.3 56168.45,-405.55"/>
</g>
<!-- dp0_pp1_layer5_expert2 -->
<g id="node103" class="node">
<title>dp0_pp1_layer5_expert2</title>
<polygon fill="lightgreen" stroke="black" points="56437,-406.29 56213,-406.29 56213,-354.29 56437,-354.29 56437,-406.29"/>
<text text-anchor="middle" x="56325" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="56325" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="56325" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="56325" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert2 -->
<g id="edge160" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57456.82,-502.85C57215.66,-498.37 56798.02,-480.97 56446,-417.06 56434.38,-414.95 56422.29,-412.14 56410.44,-409.03"/>
<polygon fill="black" stroke="black" points="56411.13,-405.59 56400.56,-406.34 56409.29,-412.34 56411.13,-405.59"/>
</g>
<!-- dp0_pp1_layer5_expert3 -->
<g id="node104" class="node">
<title>dp0_pp1_layer5_expert3</title>
<polygon fill="lightgreen" stroke="black" points="56679,-406.29 56455,-406.29 56455,-354.29 56679,-354.29 56679,-406.29"/>
<text text-anchor="middle" x="56567" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="56567" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="56567" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="56567" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert3 -->
<g id="edge161" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57451.36,-497.41C57254.31,-488.25 56948.63,-466.79 56688,-417.06 56676.57,-414.88 56664.67,-412.06 56652.99,-408.97"/>
<polygon fill="black" stroke="black" points="56653.82,-405.57 56643.25,-406.31 56651.98,-412.32 56653.82,-405.57"/>
</g>
<!-- dp0_pp1_layer5_expert4 -->
<g id="node105" class="node">
<title>dp0_pp1_layer5_expert4</title>
<polygon fill="lightgreen" stroke="black" points="56921,-406.29 56697,-406.29 56697,-354.29 56921,-354.29 56921,-406.29"/>
<text text-anchor="middle" x="56809" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="56809" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="56809" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="56809" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert4 -->
<g id="edge162" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57442.43,-487.98C57296.99,-474.71 57100.64,-452.25 56930,-417.06 56919.05,-414.8 56907.65,-412.02 56896.43,-409.02"/>
<polygon fill="black" stroke="black" points="56897.19,-405.6 56886.62,-406.33 56895.34,-412.35 56897.19,-405.6"/>
</g>
<!-- dp0_pp1_layer5_expert5 -->
<g id="node106" class="node">
<title>dp0_pp1_layer5_expert5</title>
<polygon fill="lightgreen" stroke="black" points="57163,-406.29 56939,-406.29 56939,-354.29 57163,-354.29 57163,-406.29"/>
<text text-anchor="middle" x="57051" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="57051" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="57051" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="57051" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert5 -->
<g id="edge163" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57422.29,-467.38C57342.5,-453.44 57253,-436.25 57172,-417.06 57161.9,-414.67 57151.4,-411.94 57140.99,-409.07"/>
<polygon fill="black" stroke="black" points="57141.62,-405.62 57131.05,-406.3 57139.74,-412.36 57141.62,-405.62"/>
</g>
<!-- dp0_pp1_layer5_expert6 -->
<g id="node107" class="node">
<title>dp0_pp1_layer5_expert6</title>
<polygon fill="lightgreen" stroke="black" points="57405,-406.29 57181,-406.29 57181,-354.29 57405,-354.29 57405,-406.29"/>
<text text-anchor="middle" x="57293" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="57293" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="57293" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="57293" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert6 -->
<g id="edge164" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57504.94,-452.97C57461.16,-438.16 57414.94,-422.53 57376.87,-409.66"/>
<polygon fill="black" stroke="black" points="57377.97,-406.33 57367.38,-406.45 57375.73,-412.97 57377.97,-406.33"/>
</g>
<!-- dp0_pp1_layer5_expert7 -->
<g id="node108" class="node">
<title>dp0_pp1_layer5_expert7</title>
<polygon fill="lightgreen" stroke="black" points="57647,-406.29 57423,-406.29 57423,-354.29 57647,-354.29 57647,-406.29"/>
<text text-anchor="middle" x="57535" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="57535" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="57535" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="57535" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert7 -->
<g id="edge165" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57605.38,-452.71C57592.3,-439.43 57578.58,-425.51 57566.76,-413.52"/>
<polygon fill="black" stroke="black" points="57569.19,-411 57559.68,-406.33 57564.2,-415.91 57569.19,-411"/>
</g>
<!-- dp0_pp1_layer5_expert8 -->
<g id="node109" class="node">
<title>dp0_pp1_layer5_expert8</title>
<polygon fill="lightgreen" stroke="black" points="57889,-406.29 57665,-406.29 57665,-354.29 57889,-354.29 57889,-406.29"/>
<text text-anchor="middle" x="57777" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="57777" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="57777" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="57777" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert8 -->
<g id="edge166" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57706.61,-452.71C57719.7,-439.43 57733.42,-425.51 57745.23,-413.52"/>
<polygon fill="black" stroke="black" points="57747.79,-415.91 57752.32,-406.33 57742.81,-411 57747.79,-415.91"/>
</g>
<!-- dp0_pp1_layer5_expert9 -->
<g id="node110" class="node">
<title>dp0_pp1_layer5_expert9</title>
<polygon fill="lightgreen" stroke="black" points="58131,-406.29 57907,-406.29 57907,-354.29 58131,-354.29 58131,-406.29"/>
<text text-anchor="middle" x="58019" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="58019" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="58019" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="58019" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert9 -->
<g id="edge167" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57803.38,-454.21C57848.29,-439.03 57896.08,-422.86 57935.23,-409.62"/>
<polygon fill="black" stroke="black" points="57936.64,-412.84 57944.99,-406.32 57934.4,-406.21 57936.64,-412.84"/>
</g>
<!-- dp0_pp1_layer5_expert10 -->
<g id="node111" class="node">
<title>dp0_pp1_layer5_expert10</title>
<polygon fill="lightgreen" stroke="black" points="58373,-406.29 58149,-406.29 58149,-354.29 58373,-354.29 58373,-406.29"/>
<text text-anchor="middle" x="58261" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="58261" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="58261" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="58261" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert10 -->
<g id="edge168" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57826.89,-478.04C57919.98,-462.69 58036.88,-441.49 58140,-417.06 58150.09,-414.67 58160.6,-411.94 58171.01,-409.07"/>
<polygon fill="black" stroke="black" points="58172.26,-412.36 58180.95,-406.3 58170.37,-405.62 58172.26,-412.36"/>
</g>
<!-- dp0_pp1_layer5_expert11 -->
<g id="node112" class="node">
<title>dp0_pp1_layer5_expert11</title>
<polygon fill="lightgreen" stroke="black" points="58615,-406.29 58391,-406.29 58391,-354.29 58615,-354.29 58615,-406.29"/>
<text text-anchor="middle" x="58503" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="58503" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="58503" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="58503" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert11 -->
<g id="edge169" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57838.99,-490.7C57986.62,-477.88 58199.08,-454.78 58382,-417.06 58392.95,-414.8 58404.35,-412.02 58415.57,-409.02"/>
<polygon fill="black" stroke="black" points="58416.66,-412.35 58425.38,-406.33 58414.81,-405.6 58416.66,-412.35"/>
</g>
<!-- dp0_pp1_layer5_expert12 -->
<g id="node113" class="node">
<title>dp0_pp1_layer5_expert12</title>
<polygon fill="lightgreen" stroke="black" points="58857,-406.29 58633,-406.29 58633,-354.29 58857,-354.29 58857,-406.29"/>
<text text-anchor="middle" x="58745" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="58745" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="58745" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="58745" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert12 -->
<g id="edge170" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57846.27,-498.07C58042.59,-489.29 58356.95,-468.01 58624,-417.06 58635.43,-414.88 58647.33,-412.06 58659.01,-408.97"/>
<polygon fill="black" stroke="black" points="58660.02,-412.32 58668.75,-406.31 58658.18,-405.57 58660.02,-412.32"/>
</g>
<!-- dp0_pp1_layer5_expert13 -->
<g id="node114" class="node">
<title>dp0_pp1_layer5_expert13</title>
<polygon fill="lightgreen" stroke="black" points="59099,-406.29 58875,-406.29 58875,-354.29 59099,-354.29 59099,-406.29"/>
<text text-anchor="middle" x="58987" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="58987" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="58987" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="58987" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert13 -->
<g id="edge171" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57850.93,-502.93C58091.42,-498.58 58511.9,-481.35 58866,-417.06 58877.62,-414.95 58889.71,-412.14 58901.56,-409.03"/>
<polygon fill="black" stroke="black" points="58902.7,-412.34 58911.44,-406.34 58900.87,-405.59 58902.7,-412.34"/>
</g>
<!-- dp0_pp1_layer5_expert14 -->
<g id="node115" class="node">
<title>dp0_pp1_layer5_expert14</title>
<polygon fill="lightgreen" stroke="black" points="59341,-406.29 59117,-406.29 59117,-354.29 59341,-354.29 59341,-406.29"/>
<text text-anchor="middle" x="59229" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="59229" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="59229" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="59229" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert14 -->
<g id="edge172" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57846.32,-498.04C58183.17,-486.48 58871.15,-458.6 59108,-417.06 59119.92,-414.97 59132.32,-412.12 59144.46,-408.93"/>
<polygon fill="black" stroke="black" points="59145.38,-412.3 59154.11,-406.3 59143.54,-405.55 59145.38,-412.3"/>
</g>
<!-- dp0_pp1_layer5_expert15 -->
<g id="node116" class="node">
<title>dp0_pp1_layer5_expert15</title>
<polygon fill="lightgreen" stroke="black" points="59583,-406.29 59359,-406.29 59359,-354.29 59583,-354.29 59583,-406.29"/>
<text text-anchor="middle" x="59471" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="59471" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="59471" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="59471" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert15 -->
<g id="edge173" class="edge">
<title>dp0_pp1_layer5_router&#45;&gt;dp0_pp1_layer5_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M57847.94,-499.9C58228.49,-490.72 59066.35,-465.57 59350,-417.06 59362.01,-415.01 59374.51,-412.16 59386.73,-408.95"/>
<polygon fill="black" stroke="black" points="59387.72,-412.31 59396.45,-406.32 59385.88,-405.56 59387.72,-412.31"/>
</g>
<!-- dp0_pp1_layer5_expert_agg -->
<g id="node117" class="node">
<title>dp0_pp1_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="57903.57,-307.52 57509.74,-307.52 57408.43,-203.52 57802.26,-203.52 57903.57,-307.52"/>
<text text-anchor="middle" x="57656" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="57656" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="57656" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="57656" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer5_expert0&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge174" class="edge">
<title>dp0_pp1_layer5_expert0&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M55899.07,-354.29C55918.69,-346.92 55940.97,-339.72 55962,-335.52 56241.13,-279.86 57064.93,-263.21 57451.43,-258.4"/>
<polygon fill="black" stroke="black" points="57451.65,-261.9 57461.61,-258.27 57451.57,-254.9 57451.65,-261.9"/>
</g>
<!-- dp0_pp1_layer5_expert1&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge175" class="edge">
<title>dp0_pp1_layer5_expert1&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M56141.39,-354.27C56160.95,-346.95 56183.09,-339.78 56204,-335.52 56436.8,-288.16 57112.09,-267.74 57453.43,-260.24"/>
<polygon fill="black" stroke="black" points="57453.51,-263.74 57463.43,-260.03 57453.35,-256.74 57453.51,-263.74"/>
</g>
<!-- dp0_pp1_layer5_expert2&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge176" class="edge">
<title>dp0_pp1_layer5_expert2&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M56383.73,-354.29C56403.21,-347.01 56425.23,-339.87 56446,-335.52 56632.91,-296.44 57162.54,-273.07 57455.3,-262.78"/>
<polygon fill="black" stroke="black" points="57455.74,-266.27 57465.61,-262.42 57455.5,-259.27 57455.74,-266.27"/>
</g>
<!-- dp0_pp1_layer5_expert3&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge177" class="edge">
<title>dp0_pp1_layer5_expert3&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M56626.39,-354.26C56645.72,-347.07 56667.48,-339.99 56688,-335.52 56946.91,-279.18 57252.7,-262.24 57450.26,-257.56"/>
<polygon fill="black" stroke="black" points="57450.55,-261.06 57460.47,-257.33 57450.39,-254.06 57450.55,-261.06"/>
</g>
<!-- dp0_pp1_layer5_expert4&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge178" class="edge">
<title>dp0_pp1_layer5_expert4&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M56869.39,-354.24C56888.49,-347.2 56909.87,-340.19 56930,-335.52 57105.82,-294.77 57310.6,-274.91 57457.75,-265.31"/>
<polygon fill="black" stroke="black" points="57458.05,-268.8 57467.81,-264.67 57457.6,-261.82 57458.05,-268.8"/>
</g>
<!-- dp0_pp1_layer5_expert5&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge179" class="edge">
<title>dp0_pp1_layer5_expert5&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M57113.42,-354.22C57132.04,-347.42 57152.65,-340.55 57172,-335.52 57269.09,-310.27 57379.34,-291.53 57470.07,-278.65"/>
<polygon fill="black" stroke="black" points="57470.78,-282.09 57480.19,-277.23 57469.8,-275.16 57470.78,-282.09"/>
</g>
<!-- dp0_pp1_layer5_expert6&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge180" class="edge">
<title>dp0_pp1_layer5_expert6&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M57361.02,-354.26C57378.26,-348.03 57396.78,-341.44 57414,-335.52 57440.73,-326.33 57469.21,-316.8 57496.89,-307.67"/>
<polygon fill="black" stroke="black" points="57498.24,-310.91 57506.65,-304.46 57496.06,-304.26 57498.24,-310.91"/>
</g>
<!-- dp0_pp1_layer5_expert7&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge181" class="edge">
<title>dp0_pp1_layer5_expert7&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M57559.78,-354.15C57571.02,-342.74 57584.83,-328.73 57598.45,-314.92"/>
<polygon fill="black" stroke="black" points="57601,-317.31 57605.53,-307.73 57596.02,-312.39 57601,-317.31"/>
</g>
<!-- dp0_pp1_layer5_expert8&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge182" class="edge">
<title>dp0_pp1_layer5_expert8&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M57752.22,-354.15C57740.97,-342.74 57727.16,-328.73 57713.55,-314.92"/>
<polygon fill="black" stroke="black" points="57715.98,-312.39 57706.47,-307.73 57710.99,-317.31 57715.98,-312.39"/>
</g>
<!-- dp0_pp1_layer5_expert9&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge183" class="edge">
<title>dp0_pp1_layer5_expert9&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M57950.98,-354.26C57933.73,-348.03 57915.21,-341.44 57898,-335.52 57874.29,-327.37 57849.21,-318.95 57824.53,-310.78"/>
<polygon fill="black" stroke="black" points="57825.32,-307.36 57814.73,-307.54 57823.12,-314 57825.32,-307.36"/>
</g>
<!-- dp0_pp1_layer5_expert10&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge184" class="edge">
<title>dp0_pp1_layer5_expert10&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M58198.58,-354.22C58179.96,-347.42 58159.35,-340.55 58140,-335.52 58059.99,-314.71 57971.05,-298.33 57891.46,-286"/>
<polygon fill="black" stroke="black" points="57891.71,-282.5 57881.3,-284.44 57890.65,-289.41 57891.71,-282.5"/>
</g>
<!-- dp0_pp1_layer5_expert11&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge185" class="edge">
<title>dp0_pp1_layer5_expert11&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M58442.61,-354.24C58423.51,-347.2 58402.13,-340.19 58382,-335.52 58213.74,-296.53 58018.97,-276.66 57873.55,-266.61"/>
<polygon fill="black" stroke="black" points="57873.38,-263.09 57863.16,-265.9 57872.9,-270.07 57873.38,-263.09"/>
</g>
<!-- dp0_pp1_layer5_expert12&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge186" class="edge">
<title>dp0_pp1_layer5_expert12&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M58685.61,-354.26C58666.28,-347.07 58644.52,-339.99 58624,-335.52 58366.51,-279.49 58062.64,-262.43 57864.99,-257.64"/>
<polygon fill="black" stroke="black" points="57864.86,-254.14 57854.78,-257.4 57864.69,-261.13 57864.86,-254.14"/>
</g>
<!-- dp0_pp1_layer5_expert13&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge187" class="edge">
<title>dp0_pp1_layer5_expert13&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M58928.27,-354.29C58908.79,-347.01 58886.77,-339.87 58866,-335.52 58682.02,-297.05 58165.97,-273.81 57870.63,-263.27"/>
<polygon fill="black" stroke="black" points="57870.33,-259.76 57860.21,-262.9 57870.08,-266.76 57870.33,-259.76"/>
</g>
<!-- dp0_pp1_layer5_expert14&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge188" class="edge">
<title>dp0_pp1_layer5_expert14&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M59170.6,-354.27C59151.05,-346.95 59128.9,-339.78 59108,-335.52 58877.27,-288.58 58211.86,-268.1 57867.74,-260.45"/>
<polygon fill="black" stroke="black" points="57867.73,-256.94 57857.65,-260.22 57867.57,-263.94 57867.73,-256.94"/>
</g>
<!-- dp0_pp1_layer5_expert15&#45;&gt;dp0_pp1_layer5_expert_agg -->
<g id="edge189" class="edge">
<title>dp0_pp1_layer5_expert15&#45;&gt;dp0_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M59412.93,-354.29C59393.3,-346.92 59371.03,-339.72 59350,-335.52 59072.21,-280.12 58254.98,-263.37 57866.17,-258.47"/>
<polygon fill="black" stroke="black" points="57865.97,-254.97 57855.93,-258.34 57865.88,-261.97 57865.97,-254.97"/>
</g>
<!-- dp0_pp1_layer6_attn_tp0 -->
<g id="node118" class="node">
<title>dp0_pp1_layer6_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="55138.5,-531.06 54873.5,-531.06 54873.5,-479.06 55138.5,-479.06 55138.5,-531.06"/>
<text text-anchor="middle" x="55006" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="55006" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="55006" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="55006" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer5_expert_agg&#45;&gt;dp0_pp1_layer6_attn_tp0 -->
<g id="edge191" class="edge">
<title>dp0_pp1_layer5_expert_agg&#45;&gt;dp0_pp1_layer6_attn_tp0</title>
<path fill="none" stroke="black" d="M57463.78,-260.41C57043.38,-269.54 56053.17,-294.77 55720,-335.52 55687.8,-339.46 55179.23,-444.29 55148,-453.06 55125.37,-459.41 55101.16,-467.58 55079.26,-475.5"/>
<polygon fill="black" stroke="black" points="55077.89,-472.28 55069.7,-479 55080.29,-478.85 55077.89,-472.28"/>
</g>
<!-- dp0_pp1_layer6_attn_allreduce -->
<g id="node119" class="node">
<title>dp0_pp1_layer6_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="55135" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="55135" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="55135" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="55135" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="55135" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_attn_tp0&#45;&gt;dp0_pp1_layer6_attn_allreduce -->
<g id="edge192" class="edge">
<title>dp0_pp1_layer6_attn_tp0&#45;&gt;dp0_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M55032.41,-478.92C55049.15,-463 55071.21,-442 55090.58,-423.56"/>
<polygon fill="black" stroke="black" points="55093.03,-426.07 55097.86,-416.64 55088.2,-421 55093.03,-426.07"/>
</g>
<!-- dp0_pp1_layer6_router -->
<g id="node123" class="node">
<title>dp0_pp1_layer6_router</title>
<polygon fill="lightyellow" stroke="black" points="52886.57,-557.06 52492.74,-557.06 52391.43,-453.06 52785.26,-453.06 52886.57,-557.06"/>
<text text-anchor="middle" x="52639" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="52639" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="52639" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="52639" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_attn_allreduce&#45;&gt;dp0_pp1_layer6_router -->
<g id="edge228" class="edge">
<title>dp0_pp1_layer6_attn_allreduce&#45;&gt;dp0_pp1_layer6_router</title>
<path fill="none" stroke="black" d="M54975.08,-392.38C54863.77,-399.9 54711.89,-409.76 54578,-417.06 53942.5,-451.72 53189.28,-482.59 52837.96,-496.4"/>
<polygon fill="black" stroke="black" points="52837.8,-492.91 52827.94,-496.79 52838.07,-499.9 52837.8,-492.91"/>
</g>
<!-- dp0_pp1_layer6_attn_tp1 -->
<g id="node120" class="node">
<title>dp0_pp1_layer6_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="55421.5,-531.06 55156.5,-531.06 55156.5,-479.06 55421.5,-479.06 55421.5,-531.06"/>
<text text-anchor="middle" x="55289" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="55289" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="55289" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="55289" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer6_attn_tp1&#45;&gt;dp0_pp1_layer6_attn_allreduce -->
<g id="edge193" class="edge">
<title>dp0_pp1_layer6_attn_tp1&#45;&gt;dp0_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M55257.46,-478.92C55236.99,-462.6 55209.83,-440.94 55186.29,-422.18"/>
<polygon fill="black" stroke="black" points="55188.46,-419.44 55178.46,-415.94 55184.1,-424.91 55188.46,-419.44"/>
</g>
<!-- dp0_pp1_layer6_attn_tp2 -->
<g id="node121" class="node">
<title>dp0_pp1_layer6_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="54855.5,-531.06 54590.5,-531.06 54590.5,-479.06 54855.5,-479.06 54855.5,-531.06"/>
<text text-anchor="middle" x="54723" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="54723" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="54723" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="54723" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer6_attn_tp2&#45;&gt;dp0_pp1_layer6_attn_allreduce -->
<g id="edge194" class="edge">
<title>dp0_pp1_layer6_attn_tp2&#45;&gt;dp0_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M54789.07,-479.02C54812.85,-470.35 54839.99,-460.86 54865,-453.06 54913.74,-437.86 54968.05,-423.03 55015.1,-410.83"/>
<polygon fill="black" stroke="black" points="55016.22,-414.15 55025.03,-408.26 55014.47,-407.38 55016.22,-414.15"/>
</g>
<!-- dp0_pp1_layer6_attn_tp3 -->
<g id="node122" class="node">
<title>dp0_pp1_layer6_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="55704.5,-531.06 55439.5,-531.06 55439.5,-479.06 55704.5,-479.06 55704.5,-531.06"/>
<text text-anchor="middle" x="55572" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="55572" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="55572" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="55572" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer6_attn_tp3&#45;&gt;dp0_pp1_layer6_attn_allreduce -->
<g id="edge195" class="edge">
<title>dp0_pp1_layer6_attn_tp3&#45;&gt;dp0_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M55507.21,-478.95C55483.43,-470.18 55456.17,-460.64 55431,-453.06 55376.42,-436.63 55315.31,-421.31 55262.86,-409.08"/>
<polygon fill="black" stroke="black" points="55263.37,-405.6 55252.83,-406.75 55261.78,-412.42 55263.37,-405.6"/>
</g>
<!-- dp0_pp1_layer6_expert0 -->
<g id="node124" class="node">
<title>dp0_pp1_layer6_expert0</title>
<polygon fill="lightgreen" stroke="black" points="50936,-406.29 50712,-406.29 50712,-354.29 50936,-354.29 50936,-406.29"/>
<text text-anchor="middle" x="50824" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="50824" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="50824" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="50824" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert0 -->
<g id="edge196" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52436.73,-499.65C52051.55,-490.26 51226.11,-465.13 50945,-417.06 50932.99,-415.01 50920.48,-412.16 50908.27,-408.95"/>
<polygon fill="black" stroke="black" points="50909.11,-405.56 50898.54,-406.32 50907.28,-412.31 50909.11,-405.56"/>
</g>
<!-- dp0_pp1_layer6_expert1 -->
<g id="node125" class="node">
<title>dp0_pp1_layer6_expert1</title>
<polygon fill="lightgreen" stroke="black" points="51178,-406.29 50954,-406.29 50954,-354.29 51178,-354.29 51178,-406.29"/>
<text text-anchor="middle" x="51066" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="51066" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="51066" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="51066" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert1 -->
<g id="edge197" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52434.55,-497.55C52092.94,-485.71 51420.58,-458.03 51187,-417.06 51175.08,-414.97 51162.67,-412.12 51150.54,-408.93"/>
<polygon fill="black" stroke="black" points="51151.45,-405.55 51140.89,-406.3 51149.62,-412.3 51151.45,-405.55"/>
</g>
<!-- dp0_pp1_layer6_expert2 -->
<g id="node126" class="node">
<title>dp0_pp1_layer6_expert2</title>
<polygon fill="lightgreen" stroke="black" points="51420,-406.29 51196,-406.29 51196,-354.29 51420,-354.29 51420,-406.29"/>
<text text-anchor="middle" x="51308" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="51308" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="51308" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="51308" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert2 -->
<g id="edge198" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52439.82,-502.85C52198.66,-498.37 51781.02,-480.97 51429,-417.06 51417.38,-414.95 51405.29,-412.14 51393.44,-409.03"/>
<polygon fill="black" stroke="black" points="51394.13,-405.59 51383.56,-406.34 51392.29,-412.34 51394.13,-405.59"/>
</g>
<!-- dp0_pp1_layer6_expert3 -->
<g id="node127" class="node">
<title>dp0_pp1_layer6_expert3</title>
<polygon fill="lightgreen" stroke="black" points="51662,-406.29 51438,-406.29 51438,-354.29 51662,-354.29 51662,-406.29"/>
<text text-anchor="middle" x="51550" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="51550" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="51550" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="51550" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert3 -->
<g id="edge199" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52434.36,-497.41C52237.31,-488.25 51931.63,-466.79 51671,-417.06 51659.57,-414.88 51647.67,-412.06 51635.99,-408.97"/>
<polygon fill="black" stroke="black" points="51636.82,-405.57 51626.25,-406.31 51634.98,-412.32 51636.82,-405.57"/>
</g>
<!-- dp0_pp1_layer6_expert4 -->
<g id="node128" class="node">
<title>dp0_pp1_layer6_expert4</title>
<polygon fill="lightgreen" stroke="black" points="51904,-406.29 51680,-406.29 51680,-354.29 51904,-354.29 51904,-406.29"/>
<text text-anchor="middle" x="51792" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="51792" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="51792" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="51792" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert4 -->
<g id="edge200" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52425.43,-487.98C52279.99,-474.71 52083.64,-452.25 51913,-417.06 51902.05,-414.8 51890.65,-412.02 51879.43,-409.02"/>
<polygon fill="black" stroke="black" points="51880.19,-405.6 51869.62,-406.33 51878.34,-412.35 51880.19,-405.6"/>
</g>
<!-- dp0_pp1_layer6_expert5 -->
<g id="node129" class="node">
<title>dp0_pp1_layer6_expert5</title>
<polygon fill="lightgreen" stroke="black" points="52146,-406.29 51922,-406.29 51922,-354.29 52146,-354.29 52146,-406.29"/>
<text text-anchor="middle" x="52034" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="52034" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="52034" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="52034" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert5 -->
<g id="edge201" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52405.29,-467.38C52325.5,-453.44 52236,-436.25 52155,-417.06 52144.9,-414.67 52134.4,-411.94 52123.99,-409.07"/>
<polygon fill="black" stroke="black" points="52124.62,-405.62 52114.05,-406.3 52122.74,-412.36 52124.62,-405.62"/>
</g>
<!-- dp0_pp1_layer6_expert6 -->
<g id="node130" class="node">
<title>dp0_pp1_layer6_expert6</title>
<polygon fill="lightgreen" stroke="black" points="52388,-406.29 52164,-406.29 52164,-354.29 52388,-354.29 52388,-406.29"/>
<text text-anchor="middle" x="52276" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="52276" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="52276" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="52276" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert6 -->
<g id="edge202" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52487.94,-452.97C52444.16,-438.16 52397.94,-422.53 52359.87,-409.66"/>
<polygon fill="black" stroke="black" points="52360.97,-406.33 52350.38,-406.45 52358.73,-412.97 52360.97,-406.33"/>
</g>
<!-- dp0_pp1_layer6_expert7 -->
<g id="node131" class="node">
<title>dp0_pp1_layer6_expert7</title>
<polygon fill="lightgreen" stroke="black" points="52630,-406.29 52406,-406.29 52406,-354.29 52630,-354.29 52630,-406.29"/>
<text text-anchor="middle" x="52518" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="52518" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="52518" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="52518" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert7 -->
<g id="edge203" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52588.38,-452.71C52575.3,-439.43 52561.58,-425.51 52549.76,-413.52"/>
<polygon fill="black" stroke="black" points="52552.19,-411 52542.68,-406.33 52547.2,-415.91 52552.19,-411"/>
</g>
<!-- dp0_pp1_layer6_expert8 -->
<g id="node132" class="node">
<title>dp0_pp1_layer6_expert8</title>
<polygon fill="lightgreen" stroke="black" points="52872,-406.29 52648,-406.29 52648,-354.29 52872,-354.29 52872,-406.29"/>
<text text-anchor="middle" x="52760" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="52760" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="52760" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="52760" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert8 -->
<g id="edge204" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52689.61,-452.71C52702.7,-439.43 52716.42,-425.51 52728.23,-413.52"/>
<polygon fill="black" stroke="black" points="52730.79,-415.91 52735.32,-406.33 52725.81,-411 52730.79,-415.91"/>
</g>
<!-- dp0_pp1_layer6_expert9 -->
<g id="node133" class="node">
<title>dp0_pp1_layer6_expert9</title>
<polygon fill="lightgreen" stroke="black" points="53114,-406.29 52890,-406.29 52890,-354.29 53114,-354.29 53114,-406.29"/>
<text text-anchor="middle" x="53002" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="53002" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="53002" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="53002" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert9 -->
<g id="edge205" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52786.38,-454.21C52831.29,-439.03 52879.08,-422.86 52918.23,-409.62"/>
<polygon fill="black" stroke="black" points="52919.64,-412.84 52927.99,-406.32 52917.4,-406.21 52919.64,-412.84"/>
</g>
<!-- dp0_pp1_layer6_expert10 -->
<g id="node134" class="node">
<title>dp0_pp1_layer6_expert10</title>
<polygon fill="lightgreen" stroke="black" points="53356,-406.29 53132,-406.29 53132,-354.29 53356,-354.29 53356,-406.29"/>
<text text-anchor="middle" x="53244" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="53244" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="53244" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="53244" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert10 -->
<g id="edge206" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52809.89,-478.04C52902.98,-462.69 53019.88,-441.49 53123,-417.06 53133.09,-414.67 53143.6,-411.94 53154.01,-409.07"/>
<polygon fill="black" stroke="black" points="53155.26,-412.36 53163.95,-406.3 53153.37,-405.62 53155.26,-412.36"/>
</g>
<!-- dp0_pp1_layer6_expert11 -->
<g id="node135" class="node">
<title>dp0_pp1_layer6_expert11</title>
<polygon fill="lightgreen" stroke="black" points="53598,-406.29 53374,-406.29 53374,-354.29 53598,-354.29 53598,-406.29"/>
<text text-anchor="middle" x="53486" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="53486" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="53486" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="53486" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert11 -->
<g id="edge207" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52821.99,-490.7C52969.62,-477.88 53182.08,-454.78 53365,-417.06 53375.95,-414.8 53387.35,-412.02 53398.57,-409.02"/>
<polygon fill="black" stroke="black" points="53399.66,-412.35 53408.38,-406.33 53397.81,-405.6 53399.66,-412.35"/>
</g>
<!-- dp0_pp1_layer6_expert12 -->
<g id="node136" class="node">
<title>dp0_pp1_layer6_expert12</title>
<polygon fill="lightgreen" stroke="black" points="53840,-406.29 53616,-406.29 53616,-354.29 53840,-354.29 53840,-406.29"/>
<text text-anchor="middle" x="53728" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="53728" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="53728" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="53728" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert12 -->
<g id="edge208" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52829.27,-498.07C53025.59,-489.29 53339.95,-468.01 53607,-417.06 53618.43,-414.88 53630.33,-412.06 53642.01,-408.97"/>
<polygon fill="black" stroke="black" points="53643.02,-412.32 53651.75,-406.31 53641.18,-405.57 53643.02,-412.32"/>
</g>
<!-- dp0_pp1_layer6_expert13 -->
<g id="node137" class="node">
<title>dp0_pp1_layer6_expert13</title>
<polygon fill="lightgreen" stroke="black" points="54082,-406.29 53858,-406.29 53858,-354.29 54082,-354.29 54082,-406.29"/>
<text text-anchor="middle" x="53970" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="53970" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="53970" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="53970" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert13 -->
<g id="edge209" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52833.93,-502.93C53074.42,-498.58 53494.9,-481.35 53849,-417.06 53860.62,-414.95 53872.71,-412.14 53884.56,-409.03"/>
<polygon fill="black" stroke="black" points="53885.7,-412.34 53894.44,-406.34 53883.87,-405.59 53885.7,-412.34"/>
</g>
<!-- dp0_pp1_layer6_expert14 -->
<g id="node138" class="node">
<title>dp0_pp1_layer6_expert14</title>
<polygon fill="lightgreen" stroke="black" points="54324,-406.29 54100,-406.29 54100,-354.29 54324,-354.29 54324,-406.29"/>
<text text-anchor="middle" x="54212" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="54212" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="54212" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="54212" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert14 -->
<g id="edge210" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52829.32,-498.04C53166.17,-486.48 53854.15,-458.6 54091,-417.06 54102.92,-414.97 54115.32,-412.12 54127.46,-408.93"/>
<polygon fill="black" stroke="black" points="54128.38,-412.3 54137.11,-406.3 54126.54,-405.55 54128.38,-412.3"/>
</g>
<!-- dp0_pp1_layer6_expert15 -->
<g id="node139" class="node">
<title>dp0_pp1_layer6_expert15</title>
<polygon fill="lightgreen" stroke="black" points="54566,-406.29 54342,-406.29 54342,-354.29 54566,-354.29 54566,-406.29"/>
<text text-anchor="middle" x="54454" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="54454" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="54454" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="54454" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert15 -->
<g id="edge211" class="edge">
<title>dp0_pp1_layer6_router&#45;&gt;dp0_pp1_layer6_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M52830.94,-499.9C53211.49,-490.72 54049.35,-465.57 54333,-417.06 54345.01,-415.01 54357.51,-412.16 54369.73,-408.95"/>
<polygon fill="black" stroke="black" points="54370.72,-412.31 54379.45,-406.32 54368.88,-405.56 54370.72,-412.31"/>
</g>
<!-- dp0_pp1_layer6_expert_agg -->
<g id="node140" class="node">
<title>dp0_pp1_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="52886.57,-307.52 52492.74,-307.52 52391.43,-203.52 52785.26,-203.52 52886.57,-307.52"/>
<text text-anchor="middle" x="52639" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="52639" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="52639" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="52639" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer6_expert0&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge212" class="edge">
<title>dp0_pp1_layer6_expert0&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M50882.07,-354.29C50901.69,-346.92 50923.97,-339.72 50945,-335.52 51224.13,-279.86 52047.93,-263.21 52434.43,-258.4"/>
<polygon fill="black" stroke="black" points="52434.65,-261.9 52444.61,-258.27 52434.57,-254.9 52434.65,-261.9"/>
</g>
<!-- dp0_pp1_layer6_expert1&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge213" class="edge">
<title>dp0_pp1_layer6_expert1&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M51124.39,-354.27C51143.95,-346.95 51166.09,-339.78 51187,-335.52 51419.8,-288.16 52095.09,-267.74 52436.43,-260.24"/>
<polygon fill="black" stroke="black" points="52436.51,-263.74 52446.43,-260.03 52436.35,-256.74 52436.51,-263.74"/>
</g>
<!-- dp0_pp1_layer6_expert2&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge214" class="edge">
<title>dp0_pp1_layer6_expert2&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M51366.73,-354.29C51386.21,-347.01 51408.23,-339.87 51429,-335.52 51615.91,-296.44 52145.54,-273.07 52438.3,-262.78"/>
<polygon fill="black" stroke="black" points="52438.74,-266.27 52448.61,-262.42 52438.5,-259.27 52438.74,-266.27"/>
</g>
<!-- dp0_pp1_layer6_expert3&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge215" class="edge">
<title>dp0_pp1_layer6_expert3&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M51609.39,-354.26C51628.72,-347.07 51650.48,-339.99 51671,-335.52 51929.91,-279.18 52235.7,-262.24 52433.26,-257.56"/>
<polygon fill="black" stroke="black" points="52433.55,-261.06 52443.47,-257.33 52433.39,-254.06 52433.55,-261.06"/>
</g>
<!-- dp0_pp1_layer6_expert4&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge216" class="edge">
<title>dp0_pp1_layer6_expert4&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M51852.39,-354.24C51871.49,-347.2 51892.87,-340.19 51913,-335.52 52088.82,-294.77 52293.6,-274.91 52440.75,-265.31"/>
<polygon fill="black" stroke="black" points="52441.05,-268.8 52450.81,-264.67 52440.6,-261.82 52441.05,-268.8"/>
</g>
<!-- dp0_pp1_layer6_expert5&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge217" class="edge">
<title>dp0_pp1_layer6_expert5&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M52096.42,-354.22C52115.04,-347.42 52135.65,-340.55 52155,-335.52 52252.09,-310.27 52362.34,-291.53 52453.07,-278.65"/>
<polygon fill="black" stroke="black" points="52453.78,-282.09 52463.19,-277.23 52452.8,-275.16 52453.78,-282.09"/>
</g>
<!-- dp0_pp1_layer6_expert6&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge218" class="edge">
<title>dp0_pp1_layer6_expert6&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M52344.02,-354.26C52361.26,-348.03 52379.78,-341.44 52397,-335.52 52423.73,-326.33 52452.21,-316.8 52479.89,-307.67"/>
<polygon fill="black" stroke="black" points="52481.24,-310.91 52489.65,-304.46 52479.06,-304.26 52481.24,-310.91"/>
</g>
<!-- dp0_pp1_layer6_expert7&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge219" class="edge">
<title>dp0_pp1_layer6_expert7&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M52542.78,-354.15C52554.02,-342.74 52567.83,-328.73 52581.45,-314.92"/>
<polygon fill="black" stroke="black" points="52584,-317.31 52588.53,-307.73 52579.02,-312.39 52584,-317.31"/>
</g>
<!-- dp0_pp1_layer6_expert8&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge220" class="edge">
<title>dp0_pp1_layer6_expert8&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M52735.22,-354.15C52723.97,-342.74 52710.16,-328.73 52696.55,-314.92"/>
<polygon fill="black" stroke="black" points="52698.98,-312.39 52689.47,-307.73 52693.99,-317.31 52698.98,-312.39"/>
</g>
<!-- dp0_pp1_layer6_expert9&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge221" class="edge">
<title>dp0_pp1_layer6_expert9&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M52933.98,-354.26C52916.73,-348.03 52898.21,-341.44 52881,-335.52 52857.29,-327.37 52832.21,-318.95 52807.53,-310.78"/>
<polygon fill="black" stroke="black" points="52808.32,-307.36 52797.73,-307.54 52806.12,-314 52808.32,-307.36"/>
</g>
<!-- dp0_pp1_layer6_expert10&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge222" class="edge">
<title>dp0_pp1_layer6_expert10&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M53181.58,-354.22C53162.96,-347.42 53142.35,-340.55 53123,-335.52 53042.99,-314.71 52954.05,-298.33 52874.46,-286"/>
<polygon fill="black" stroke="black" points="52874.71,-282.5 52864.3,-284.44 52873.65,-289.41 52874.71,-282.5"/>
</g>
<!-- dp0_pp1_layer6_expert11&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge223" class="edge">
<title>dp0_pp1_layer6_expert11&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M53425.61,-354.24C53406.51,-347.2 53385.13,-340.19 53365,-335.52 53196.74,-296.53 53001.97,-276.66 52856.55,-266.61"/>
<polygon fill="black" stroke="black" points="52856.38,-263.09 52846.16,-265.9 52855.9,-270.07 52856.38,-263.09"/>
</g>
<!-- dp0_pp1_layer6_expert12&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge224" class="edge">
<title>dp0_pp1_layer6_expert12&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M53668.61,-354.26C53649.28,-347.07 53627.52,-339.99 53607,-335.52 53349.51,-279.49 53045.64,-262.43 52847.99,-257.64"/>
<polygon fill="black" stroke="black" points="52847.86,-254.14 52837.78,-257.4 52847.69,-261.13 52847.86,-254.14"/>
</g>
<!-- dp0_pp1_layer6_expert13&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge225" class="edge">
<title>dp0_pp1_layer6_expert13&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M53911.27,-354.29C53891.79,-347.01 53869.77,-339.87 53849,-335.52 53665.02,-297.05 53148.97,-273.81 52853.63,-263.27"/>
<polygon fill="black" stroke="black" points="52853.33,-259.76 52843.21,-262.9 52853.08,-266.76 52853.33,-259.76"/>
</g>
<!-- dp0_pp1_layer6_expert14&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge226" class="edge">
<title>dp0_pp1_layer6_expert14&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M54153.6,-354.27C54134.05,-346.95 54111.9,-339.78 54091,-335.52 53860.27,-288.58 53194.86,-268.1 52850.74,-260.45"/>
<polygon fill="black" stroke="black" points="52850.73,-256.94 52840.65,-260.22 52850.57,-263.94 52850.73,-256.94"/>
</g>
<!-- dp0_pp1_layer6_expert15&#45;&gt;dp0_pp1_layer6_expert_agg -->
<g id="edge227" class="edge">
<title>dp0_pp1_layer6_expert15&#45;&gt;dp0_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M54395.93,-354.29C54376.3,-346.92 54354.03,-339.72 54333,-335.52 54055.21,-280.12 53237.98,-263.37 52849.17,-258.47"/>
<polygon fill="black" stroke="black" points="52848.97,-254.97 52838.93,-258.34 52848.88,-261.97 52848.97,-254.97"/>
</g>
<!-- dp0_pp1_layer7_attn_tp0 -->
<g id="node141" class="node">
<title>dp0_pp1_layer7_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="50121.5,-531.06 49856.5,-531.06 49856.5,-479.06 50121.5,-479.06 50121.5,-531.06"/>
<text text-anchor="middle" x="49989" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="49989" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="49989" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="49989" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer6_expert_agg&#45;&gt;dp0_pp1_layer7_attn_tp0 -->
<g id="edge229" class="edge">
<title>dp0_pp1_layer6_expert_agg&#45;&gt;dp0_pp1_layer7_attn_tp0</title>
<path fill="none" stroke="black" d="M52446.78,-260.41C52026.38,-269.54 51036.17,-294.77 50703,-335.52 50670.8,-339.46 50162.23,-444.29 50131,-453.06 50108.37,-459.41 50084.16,-467.58 50062.26,-475.5"/>
<polygon fill="black" stroke="black" points="50060.89,-472.28 50052.7,-479 50063.29,-478.85 50060.89,-472.28"/>
</g>
<!-- dp0_pp1_layer7_attn_allreduce -->
<g id="node142" class="node">
<title>dp0_pp1_layer7_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="50118" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="50118" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="50118" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="50118" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="50118" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_attn_tp0&#45;&gt;dp0_pp1_layer7_attn_allreduce -->
<g id="edge230" class="edge">
<title>dp0_pp1_layer7_attn_tp0&#45;&gt;dp0_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M50015.41,-478.92C50032.15,-463 50054.21,-442 50073.58,-423.56"/>
<polygon fill="black" stroke="black" points="50076.03,-426.07 50080.86,-416.64 50071.2,-421 50076.03,-426.07"/>
</g>
<!-- dp0_pp1_layer7_router -->
<g id="node146" class="node">
<title>dp0_pp1_layer7_router</title>
<polygon fill="lightyellow" stroke="black" points="47869.57,-557.06 47475.74,-557.06 47374.43,-453.06 47768.26,-453.06 47869.57,-557.06"/>
<text text-anchor="middle" x="47622" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="47622" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="47622" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="47622" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_attn_allreduce&#45;&gt;dp0_pp1_layer7_router -->
<g id="edge266" class="edge">
<title>dp0_pp1_layer7_attn_allreduce&#45;&gt;dp0_pp1_layer7_router</title>
<path fill="none" stroke="black" d="M49958.08,-392.38C49846.77,-399.9 49694.89,-409.76 49561,-417.06 48925.5,-451.72 48172.28,-482.59 47820.96,-496.4"/>
<polygon fill="black" stroke="black" points="47820.8,-492.91 47810.94,-496.79 47821.07,-499.9 47820.8,-492.91"/>
</g>
<!-- dp0_pp1_layer7_attn_tp1 -->
<g id="node143" class="node">
<title>dp0_pp1_layer7_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="50404.5,-531.06 50139.5,-531.06 50139.5,-479.06 50404.5,-479.06 50404.5,-531.06"/>
<text text-anchor="middle" x="50272" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="50272" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="50272" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="50272" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer7_attn_tp1&#45;&gt;dp0_pp1_layer7_attn_allreduce -->
<g id="edge231" class="edge">
<title>dp0_pp1_layer7_attn_tp1&#45;&gt;dp0_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M50240.46,-478.92C50219.99,-462.6 50192.83,-440.94 50169.29,-422.18"/>
<polygon fill="black" stroke="black" points="50171.46,-419.44 50161.46,-415.94 50167.1,-424.91 50171.46,-419.44"/>
</g>
<!-- dp0_pp1_layer7_attn_tp2 -->
<g id="node144" class="node">
<title>dp0_pp1_layer7_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="49838.5,-531.06 49573.5,-531.06 49573.5,-479.06 49838.5,-479.06 49838.5,-531.06"/>
<text text-anchor="middle" x="49706" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="49706" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="49706" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="49706" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer7_attn_tp2&#45;&gt;dp0_pp1_layer7_attn_allreduce -->
<g id="edge232" class="edge">
<title>dp0_pp1_layer7_attn_tp2&#45;&gt;dp0_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M49772.07,-479.02C49795.85,-470.35 49822.99,-460.86 49848,-453.06 49896.74,-437.86 49951.05,-423.03 49998.1,-410.83"/>
<polygon fill="black" stroke="black" points="49999.22,-414.15 50008.03,-408.26 49997.47,-407.38 49999.22,-414.15"/>
</g>
<!-- dp0_pp1_layer7_attn_tp3 -->
<g id="node145" class="node">
<title>dp0_pp1_layer7_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="50687.5,-531.06 50422.5,-531.06 50422.5,-479.06 50687.5,-479.06 50687.5,-531.06"/>
<text text-anchor="middle" x="50555" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="50555" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="50555" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="50555" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer7_attn_tp3&#45;&gt;dp0_pp1_layer7_attn_allreduce -->
<g id="edge233" class="edge">
<title>dp0_pp1_layer7_attn_tp3&#45;&gt;dp0_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M50490.21,-478.95C50466.43,-470.18 50439.17,-460.64 50414,-453.06 50359.42,-436.63 50298.31,-421.31 50245.86,-409.08"/>
<polygon fill="black" stroke="black" points="50246.37,-405.6 50235.83,-406.75 50244.78,-412.42 50246.37,-405.6"/>
</g>
<!-- dp0_pp1_layer7_expert0 -->
<g id="node147" class="node">
<title>dp0_pp1_layer7_expert0</title>
<polygon fill="lightgreen" stroke="black" points="45919,-406.29 45695,-406.29 45695,-354.29 45919,-354.29 45919,-406.29"/>
<text text-anchor="middle" x="45807" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="45807" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="45807" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="45807" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert0 -->
<g id="edge234" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47419.73,-499.65C47034.55,-490.26 46209.11,-465.13 45928,-417.06 45915.99,-415.01 45903.48,-412.16 45891.27,-408.95"/>
<polygon fill="black" stroke="black" points="45892.11,-405.56 45881.54,-406.32 45890.28,-412.31 45892.11,-405.56"/>
</g>
<!-- dp0_pp1_layer7_expert1 -->
<g id="node148" class="node">
<title>dp0_pp1_layer7_expert1</title>
<polygon fill="lightgreen" stroke="black" points="46161,-406.29 45937,-406.29 45937,-354.29 46161,-354.29 46161,-406.29"/>
<text text-anchor="middle" x="46049" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="46049" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="46049" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="46049" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert1 -->
<g id="edge235" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47417.55,-497.55C47075.94,-485.71 46403.58,-458.03 46170,-417.06 46158.08,-414.97 46145.67,-412.12 46133.54,-408.93"/>
<polygon fill="black" stroke="black" points="46134.45,-405.55 46123.89,-406.3 46132.62,-412.3 46134.45,-405.55"/>
</g>
<!-- dp0_pp1_layer7_expert2 -->
<g id="node149" class="node">
<title>dp0_pp1_layer7_expert2</title>
<polygon fill="lightgreen" stroke="black" points="46403,-406.29 46179,-406.29 46179,-354.29 46403,-354.29 46403,-406.29"/>
<text text-anchor="middle" x="46291" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="46291" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="46291" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="46291" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert2 -->
<g id="edge236" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47422.82,-502.85C47181.66,-498.37 46764.02,-480.97 46412,-417.06 46400.38,-414.95 46388.29,-412.14 46376.44,-409.03"/>
<polygon fill="black" stroke="black" points="46377.13,-405.59 46366.56,-406.34 46375.29,-412.34 46377.13,-405.59"/>
</g>
<!-- dp0_pp1_layer7_expert3 -->
<g id="node150" class="node">
<title>dp0_pp1_layer7_expert3</title>
<polygon fill="lightgreen" stroke="black" points="46645,-406.29 46421,-406.29 46421,-354.29 46645,-354.29 46645,-406.29"/>
<text text-anchor="middle" x="46533" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="46533" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="46533" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="46533" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert3 -->
<g id="edge237" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47417.36,-497.41C47220.31,-488.25 46914.63,-466.79 46654,-417.06 46642.57,-414.88 46630.67,-412.06 46618.99,-408.97"/>
<polygon fill="black" stroke="black" points="46619.82,-405.57 46609.25,-406.31 46617.98,-412.32 46619.82,-405.57"/>
</g>
<!-- dp0_pp1_layer7_expert4 -->
<g id="node151" class="node">
<title>dp0_pp1_layer7_expert4</title>
<polygon fill="lightgreen" stroke="black" points="46887,-406.29 46663,-406.29 46663,-354.29 46887,-354.29 46887,-406.29"/>
<text text-anchor="middle" x="46775" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="46775" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="46775" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="46775" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert4 -->
<g id="edge238" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47408.43,-487.98C47262.99,-474.71 47066.64,-452.25 46896,-417.06 46885.05,-414.8 46873.65,-412.02 46862.43,-409.02"/>
<polygon fill="black" stroke="black" points="46863.19,-405.6 46852.62,-406.33 46861.34,-412.35 46863.19,-405.6"/>
</g>
<!-- dp0_pp1_layer7_expert5 -->
<g id="node152" class="node">
<title>dp0_pp1_layer7_expert5</title>
<polygon fill="lightgreen" stroke="black" points="47129,-406.29 46905,-406.29 46905,-354.29 47129,-354.29 47129,-406.29"/>
<text text-anchor="middle" x="47017" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="47017" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="47017" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="47017" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert5 -->
<g id="edge239" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47388.29,-467.38C47308.5,-453.44 47219,-436.25 47138,-417.06 47127.9,-414.67 47117.4,-411.94 47106.99,-409.07"/>
<polygon fill="black" stroke="black" points="47107.62,-405.62 47097.05,-406.3 47105.74,-412.36 47107.62,-405.62"/>
</g>
<!-- dp0_pp1_layer7_expert6 -->
<g id="node153" class="node">
<title>dp0_pp1_layer7_expert6</title>
<polygon fill="lightgreen" stroke="black" points="47371,-406.29 47147,-406.29 47147,-354.29 47371,-354.29 47371,-406.29"/>
<text text-anchor="middle" x="47259" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="47259" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="47259" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="47259" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert6 -->
<g id="edge240" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47470.94,-452.97C47427.16,-438.16 47380.94,-422.53 47342.87,-409.66"/>
<polygon fill="black" stroke="black" points="47343.97,-406.33 47333.38,-406.45 47341.73,-412.97 47343.97,-406.33"/>
</g>
<!-- dp0_pp1_layer7_expert7 -->
<g id="node154" class="node">
<title>dp0_pp1_layer7_expert7</title>
<polygon fill="lightgreen" stroke="black" points="47613,-406.29 47389,-406.29 47389,-354.29 47613,-354.29 47613,-406.29"/>
<text text-anchor="middle" x="47501" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="47501" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="47501" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="47501" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert7 -->
<g id="edge241" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47571.38,-452.71C47558.3,-439.43 47544.58,-425.51 47532.76,-413.52"/>
<polygon fill="black" stroke="black" points="47535.19,-411 47525.68,-406.33 47530.2,-415.91 47535.19,-411"/>
</g>
<!-- dp0_pp1_layer7_expert8 -->
<g id="node155" class="node">
<title>dp0_pp1_layer7_expert8</title>
<polygon fill="lightgreen" stroke="black" points="47855,-406.29 47631,-406.29 47631,-354.29 47855,-354.29 47855,-406.29"/>
<text text-anchor="middle" x="47743" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="47743" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="47743" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="47743" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert8 -->
<g id="edge242" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47672.61,-452.71C47685.7,-439.43 47699.42,-425.51 47711.23,-413.52"/>
<polygon fill="black" stroke="black" points="47713.79,-415.91 47718.32,-406.33 47708.81,-411 47713.79,-415.91"/>
</g>
<!-- dp0_pp1_layer7_expert9 -->
<g id="node156" class="node">
<title>dp0_pp1_layer7_expert9</title>
<polygon fill="lightgreen" stroke="black" points="48097,-406.29 47873,-406.29 47873,-354.29 48097,-354.29 48097,-406.29"/>
<text text-anchor="middle" x="47985" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="47985" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="47985" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="47985" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert9 -->
<g id="edge243" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47769.38,-454.21C47814.29,-439.03 47862.08,-422.86 47901.23,-409.62"/>
<polygon fill="black" stroke="black" points="47902.64,-412.84 47910.99,-406.32 47900.4,-406.21 47902.64,-412.84"/>
</g>
<!-- dp0_pp1_layer7_expert10 -->
<g id="node157" class="node">
<title>dp0_pp1_layer7_expert10</title>
<polygon fill="lightgreen" stroke="black" points="48339,-406.29 48115,-406.29 48115,-354.29 48339,-354.29 48339,-406.29"/>
<text text-anchor="middle" x="48227" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="48227" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="48227" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="48227" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert10 -->
<g id="edge244" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47792.89,-478.04C47885.98,-462.69 48002.88,-441.49 48106,-417.06 48116.09,-414.67 48126.6,-411.94 48137.01,-409.07"/>
<polygon fill="black" stroke="black" points="48138.26,-412.36 48146.95,-406.3 48136.37,-405.62 48138.26,-412.36"/>
</g>
<!-- dp0_pp1_layer7_expert11 -->
<g id="node158" class="node">
<title>dp0_pp1_layer7_expert11</title>
<polygon fill="lightgreen" stroke="black" points="48581,-406.29 48357,-406.29 48357,-354.29 48581,-354.29 48581,-406.29"/>
<text text-anchor="middle" x="48469" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="48469" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="48469" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="48469" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert11 -->
<g id="edge245" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47804.99,-490.7C47952.62,-477.88 48165.08,-454.78 48348,-417.06 48358.95,-414.8 48370.35,-412.02 48381.57,-409.02"/>
<polygon fill="black" stroke="black" points="48382.66,-412.35 48391.38,-406.33 48380.81,-405.6 48382.66,-412.35"/>
</g>
<!-- dp0_pp1_layer7_expert12 -->
<g id="node159" class="node">
<title>dp0_pp1_layer7_expert12</title>
<polygon fill="lightgreen" stroke="black" points="48823,-406.29 48599,-406.29 48599,-354.29 48823,-354.29 48823,-406.29"/>
<text text-anchor="middle" x="48711" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="48711" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="48711" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="48711" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert12 -->
<g id="edge246" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47812.27,-498.07C48008.59,-489.29 48322.95,-468.01 48590,-417.06 48601.43,-414.88 48613.33,-412.06 48625.01,-408.97"/>
<polygon fill="black" stroke="black" points="48626.02,-412.32 48634.75,-406.31 48624.18,-405.57 48626.02,-412.32"/>
</g>
<!-- dp0_pp1_layer7_expert13 -->
<g id="node160" class="node">
<title>dp0_pp1_layer7_expert13</title>
<polygon fill="lightgreen" stroke="black" points="49065,-406.29 48841,-406.29 48841,-354.29 49065,-354.29 49065,-406.29"/>
<text text-anchor="middle" x="48953" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="48953" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="48953" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="48953" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert13 -->
<g id="edge247" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47816.93,-502.93C48057.42,-498.58 48477.9,-481.35 48832,-417.06 48843.62,-414.95 48855.71,-412.14 48867.56,-409.03"/>
<polygon fill="black" stroke="black" points="48868.7,-412.34 48877.44,-406.34 48866.87,-405.59 48868.7,-412.34"/>
</g>
<!-- dp0_pp1_layer7_expert14 -->
<g id="node161" class="node">
<title>dp0_pp1_layer7_expert14</title>
<polygon fill="lightgreen" stroke="black" points="49307,-406.29 49083,-406.29 49083,-354.29 49307,-354.29 49307,-406.29"/>
<text text-anchor="middle" x="49195" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="49195" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="49195" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="49195" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert14 -->
<g id="edge248" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47812.32,-498.04C48149.17,-486.48 48837.15,-458.6 49074,-417.06 49085.92,-414.97 49098.32,-412.12 49110.46,-408.93"/>
<polygon fill="black" stroke="black" points="49111.38,-412.3 49120.11,-406.3 49109.54,-405.55 49111.38,-412.3"/>
</g>
<!-- dp0_pp1_layer7_expert15 -->
<g id="node162" class="node">
<title>dp0_pp1_layer7_expert15</title>
<polygon fill="lightgreen" stroke="black" points="49549,-406.29 49325,-406.29 49325,-354.29 49549,-354.29 49549,-406.29"/>
<text text-anchor="middle" x="49437" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="49437" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="49437" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="49437" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert15 -->
<g id="edge249" class="edge">
<title>dp0_pp1_layer7_router&#45;&gt;dp0_pp1_layer7_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M47813.94,-499.9C48194.49,-490.72 49032.35,-465.57 49316,-417.06 49328.01,-415.01 49340.51,-412.16 49352.73,-408.95"/>
<polygon fill="black" stroke="black" points="49353.72,-412.31 49362.45,-406.32 49351.88,-405.56 49353.72,-412.31"/>
</g>
<!-- dp0_pp1_layer7_expert_agg -->
<g id="node163" class="node">
<title>dp0_pp1_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="47869.57,-307.52 47475.74,-307.52 47374.43,-203.52 47768.26,-203.52 47869.57,-307.52"/>
<text text-anchor="middle" x="47622" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="47622" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="47622" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="47622" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer7_expert0&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge250" class="edge">
<title>dp0_pp1_layer7_expert0&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M45865.07,-354.29C45884.69,-346.92 45906.97,-339.72 45928,-335.52 46207.13,-279.86 47030.93,-263.21 47417.43,-258.4"/>
<polygon fill="black" stroke="black" points="47417.65,-261.9 47427.61,-258.27 47417.57,-254.9 47417.65,-261.9"/>
</g>
<!-- dp0_pp1_layer7_expert1&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge251" class="edge">
<title>dp0_pp1_layer7_expert1&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M46107.39,-354.27C46126.95,-346.95 46149.09,-339.78 46170,-335.52 46402.8,-288.16 47078.09,-267.74 47419.43,-260.24"/>
<polygon fill="black" stroke="black" points="47419.51,-263.74 47429.43,-260.03 47419.35,-256.74 47419.51,-263.74"/>
</g>
<!-- dp0_pp1_layer7_expert2&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge252" class="edge">
<title>dp0_pp1_layer7_expert2&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M46349.73,-354.29C46369.21,-347.01 46391.23,-339.87 46412,-335.52 46598.91,-296.44 47128.54,-273.07 47421.3,-262.78"/>
<polygon fill="black" stroke="black" points="47421.74,-266.27 47431.61,-262.42 47421.5,-259.27 47421.74,-266.27"/>
</g>
<!-- dp0_pp1_layer7_expert3&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge253" class="edge">
<title>dp0_pp1_layer7_expert3&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M46592.39,-354.26C46611.72,-347.07 46633.48,-339.99 46654,-335.52 46912.91,-279.18 47218.7,-262.24 47416.26,-257.56"/>
<polygon fill="black" stroke="black" points="47416.55,-261.06 47426.47,-257.33 47416.39,-254.06 47416.55,-261.06"/>
</g>
<!-- dp0_pp1_layer7_expert4&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge254" class="edge">
<title>dp0_pp1_layer7_expert4&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M46835.39,-354.24C46854.49,-347.2 46875.87,-340.19 46896,-335.52 47071.82,-294.77 47276.6,-274.91 47423.75,-265.31"/>
<polygon fill="black" stroke="black" points="47424.05,-268.8 47433.81,-264.67 47423.6,-261.82 47424.05,-268.8"/>
</g>
<!-- dp0_pp1_layer7_expert5&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge255" class="edge">
<title>dp0_pp1_layer7_expert5&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M47079.42,-354.22C47098.04,-347.42 47118.65,-340.55 47138,-335.52 47235.09,-310.27 47345.34,-291.53 47436.07,-278.65"/>
<polygon fill="black" stroke="black" points="47436.78,-282.09 47446.19,-277.23 47435.8,-275.16 47436.78,-282.09"/>
</g>
<!-- dp0_pp1_layer7_expert6&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge256" class="edge">
<title>dp0_pp1_layer7_expert6&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M47327.02,-354.26C47344.26,-348.03 47362.78,-341.44 47380,-335.52 47406.73,-326.33 47435.21,-316.8 47462.89,-307.67"/>
<polygon fill="black" stroke="black" points="47464.24,-310.91 47472.65,-304.46 47462.06,-304.26 47464.24,-310.91"/>
</g>
<!-- dp0_pp1_layer7_expert7&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge257" class="edge">
<title>dp0_pp1_layer7_expert7&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M47525.78,-354.15C47537.02,-342.74 47550.83,-328.73 47564.45,-314.92"/>
<polygon fill="black" stroke="black" points="47567,-317.31 47571.53,-307.73 47562.02,-312.39 47567,-317.31"/>
</g>
<!-- dp0_pp1_layer7_expert8&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge258" class="edge">
<title>dp0_pp1_layer7_expert8&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M47718.22,-354.15C47706.97,-342.74 47693.16,-328.73 47679.55,-314.92"/>
<polygon fill="black" stroke="black" points="47681.98,-312.39 47672.47,-307.73 47676.99,-317.31 47681.98,-312.39"/>
</g>
<!-- dp0_pp1_layer7_expert9&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge259" class="edge">
<title>dp0_pp1_layer7_expert9&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M47916.98,-354.26C47899.73,-348.03 47881.21,-341.44 47864,-335.52 47840.29,-327.37 47815.21,-318.95 47790.53,-310.78"/>
<polygon fill="black" stroke="black" points="47791.32,-307.36 47780.73,-307.54 47789.12,-314 47791.32,-307.36"/>
</g>
<!-- dp0_pp1_layer7_expert10&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge260" class="edge">
<title>dp0_pp1_layer7_expert10&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M48164.58,-354.22C48145.96,-347.42 48125.35,-340.55 48106,-335.52 48025.99,-314.71 47937.05,-298.33 47857.46,-286"/>
<polygon fill="black" stroke="black" points="47857.71,-282.5 47847.3,-284.44 47856.65,-289.41 47857.71,-282.5"/>
</g>
<!-- dp0_pp1_layer7_expert11&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge261" class="edge">
<title>dp0_pp1_layer7_expert11&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M48408.61,-354.24C48389.51,-347.2 48368.13,-340.19 48348,-335.52 48179.74,-296.53 47984.97,-276.66 47839.55,-266.61"/>
<polygon fill="black" stroke="black" points="47839.38,-263.09 47829.16,-265.9 47838.9,-270.07 47839.38,-263.09"/>
</g>
<!-- dp0_pp1_layer7_expert12&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge262" class="edge">
<title>dp0_pp1_layer7_expert12&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M48651.61,-354.26C48632.28,-347.07 48610.52,-339.99 48590,-335.52 48332.51,-279.49 48028.64,-262.43 47830.99,-257.64"/>
<polygon fill="black" stroke="black" points="47830.86,-254.14 47820.78,-257.4 47830.69,-261.13 47830.86,-254.14"/>
</g>
<!-- dp0_pp1_layer7_expert13&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge263" class="edge">
<title>dp0_pp1_layer7_expert13&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M48894.27,-354.29C48874.79,-347.01 48852.77,-339.87 48832,-335.52 48648.02,-297.05 48131.97,-273.81 47836.63,-263.27"/>
<polygon fill="black" stroke="black" points="47836.33,-259.76 47826.21,-262.9 47836.08,-266.76 47836.33,-259.76"/>
</g>
<!-- dp0_pp1_layer7_expert14&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge264" class="edge">
<title>dp0_pp1_layer7_expert14&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M49136.6,-354.27C49117.05,-346.95 49094.9,-339.78 49074,-335.52 48843.27,-288.58 48177.86,-268.1 47833.74,-260.45"/>
<polygon fill="black" stroke="black" points="47833.73,-256.94 47823.65,-260.22 47833.57,-263.94 47833.73,-256.94"/>
</g>
<!-- dp0_pp1_layer7_expert15&#45;&gt;dp0_pp1_layer7_expert_agg -->
<g id="edge265" class="edge">
<title>dp0_pp1_layer7_expert15&#45;&gt;dp0_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M49378.93,-354.29C49359.3,-346.92 49337.03,-339.72 49316,-335.52 49038.21,-280.12 48220.98,-263.37 47832.17,-258.47"/>
<polygon fill="black" stroke="black" points="47831.97,-254.97 47821.93,-258.34 47831.88,-261.97 47831.97,-254.97"/>
</g>
<!-- dp0_pp1_layer8_attn_tp0 -->
<g id="node164" class="node">
<title>dp0_pp1_layer8_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="45104.5,-531.06 44839.5,-531.06 44839.5,-479.06 45104.5,-479.06 45104.5,-531.06"/>
<text text-anchor="middle" x="44972" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="44972" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="44972" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="44972" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer7_expert_agg&#45;&gt;dp0_pp1_layer8_attn_tp0 -->
<g id="edge267" class="edge">
<title>dp0_pp1_layer7_expert_agg&#45;&gt;dp0_pp1_layer8_attn_tp0</title>
<path fill="none" stroke="black" d="M47429.78,-260.41C47009.38,-269.54 46019.17,-294.77 45686,-335.52 45653.8,-339.46 45145.23,-444.29 45114,-453.06 45091.37,-459.41 45067.16,-467.58 45045.26,-475.5"/>
<polygon fill="black" stroke="black" points="45043.89,-472.28 45035.7,-479 45046.29,-478.85 45043.89,-472.28"/>
</g>
<!-- dp0_pp1_layer8_attn_allreduce -->
<g id="node165" class="node">
<title>dp0_pp1_layer8_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="45101" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="45101" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="45101" y="-383.29" font-family="Arial" font-size="10.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="45101" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="45101" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_attn_tp0&#45;&gt;dp0_pp1_layer8_attn_allreduce -->
<g id="edge268" class="edge">
<title>dp0_pp1_layer8_attn_tp0&#45;&gt;dp0_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M44998.41,-478.92C45015.15,-463 45037.21,-442 45056.58,-423.56"/>
<polygon fill="black" stroke="black" points="45059.03,-426.07 45063.86,-416.64 45054.2,-421 45059.03,-426.07"/>
</g>
<!-- dp0_pp1_layer8_router -->
<g id="node169" class="node">
<title>dp0_pp1_layer8_router</title>
<polygon fill="lightyellow" stroke="black" points="42852.57,-557.06 42458.74,-557.06 42357.43,-453.06 42751.26,-453.06 42852.57,-557.06"/>
<text text-anchor="middle" x="42605" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="42605" y="-508.06" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="42605" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="42605" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_attn_allreduce&#45;&gt;dp0_pp1_layer8_router -->
<g id="edge304" class="edge">
<title>dp0_pp1_layer8_attn_allreduce&#45;&gt;dp0_pp1_layer8_router</title>
<path fill="none" stroke="black" d="M44941.08,-392.38C44829.77,-399.9 44677.89,-409.76 44544,-417.06 43908.5,-451.72 43155.28,-482.59 42803.96,-496.4"/>
<polygon fill="black" stroke="black" points="42803.8,-492.91 42793.94,-496.79 42804.07,-499.9 42803.8,-492.91"/>
</g>
<!-- dp0_pp1_layer8_attn_tp1 -->
<g id="node166" class="node">
<title>dp0_pp1_layer8_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="45387.5,-531.06 45122.5,-531.06 45122.5,-479.06 45387.5,-479.06 45387.5,-531.06"/>
<text text-anchor="middle" x="45255" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="45255" y="-508.06" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="45255" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="45255" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer8_attn_tp1&#45;&gt;dp0_pp1_layer8_attn_allreduce -->
<g id="edge269" class="edge">
<title>dp0_pp1_layer8_attn_tp1&#45;&gt;dp0_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M45223.46,-478.92C45202.99,-462.6 45175.83,-440.94 45152.29,-422.18"/>
<polygon fill="black" stroke="black" points="45154.46,-419.44 45144.46,-415.94 45150.1,-424.91 45154.46,-419.44"/>
</g>
<!-- dp0_pp1_layer8_attn_tp2 -->
<g id="node167" class="node">
<title>dp0_pp1_layer8_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="44821.5,-531.06 44556.5,-531.06 44556.5,-479.06 44821.5,-479.06 44821.5,-531.06"/>
<text text-anchor="middle" x="44689" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="44689" y="-508.06" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="44689" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="44689" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer8_attn_tp2&#45;&gt;dp0_pp1_layer8_attn_allreduce -->
<g id="edge270" class="edge">
<title>dp0_pp1_layer8_attn_tp2&#45;&gt;dp0_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M44755.07,-479.02C44778.85,-470.35 44805.99,-460.86 44831,-453.06 44879.74,-437.86 44934.05,-423.03 44981.1,-410.83"/>
<polygon fill="black" stroke="black" points="44982.22,-414.15 44991.03,-408.26 44980.47,-407.38 44982.22,-414.15"/>
</g>
<!-- dp0_pp1_layer8_attn_tp3 -->
<g id="node168" class="node">
<title>dp0_pp1_layer8_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="45670.5,-531.06 45405.5,-531.06 45405.5,-479.06 45670.5,-479.06 45670.5,-531.06"/>
<text text-anchor="middle" x="45538" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="45538" y="-508.06" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="45538" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="45538" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp1_layer8_attn_tp3&#45;&gt;dp0_pp1_layer8_attn_allreduce -->
<g id="edge271" class="edge">
<title>dp0_pp1_layer8_attn_tp3&#45;&gt;dp0_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M45473.21,-478.95C45449.43,-470.18 45422.17,-460.64 45397,-453.06 45342.42,-436.63 45281.31,-421.31 45228.86,-409.08"/>
<polygon fill="black" stroke="black" points="45229.37,-405.6 45218.83,-406.75 45227.78,-412.42 45229.37,-405.6"/>
</g>
<!-- dp0_pp1_layer8_expert0 -->
<g id="node170" class="node">
<title>dp0_pp1_layer8_expert0</title>
<polygon fill="lightgreen" stroke="black" points="40902,-406.29 40678,-406.29 40678,-354.29 40902,-354.29 40902,-406.29"/>
<text text-anchor="middle" x="40790" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="40790" y="-383.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="40790" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="40790" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert0 -->
<g id="edge272" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42402.73,-499.65C42017.55,-490.26 41192.11,-465.13 40911,-417.06 40898.99,-415.01 40886.48,-412.16 40874.27,-408.95"/>
<polygon fill="black" stroke="black" points="40875.11,-405.56 40864.54,-406.32 40873.28,-412.31 40875.11,-405.56"/>
</g>
<!-- dp0_pp1_layer8_expert1 -->
<g id="node171" class="node">
<title>dp0_pp1_layer8_expert1</title>
<polygon fill="lightgreen" stroke="black" points="41144,-406.29 40920,-406.29 40920,-354.29 41144,-354.29 41144,-406.29"/>
<text text-anchor="middle" x="41032" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="41032" y="-383.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="41032" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="41032" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert1 -->
<g id="edge273" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42400.55,-497.55C42058.94,-485.71 41386.58,-458.03 41153,-417.06 41141.08,-414.97 41128.67,-412.12 41116.54,-408.93"/>
<polygon fill="black" stroke="black" points="41117.45,-405.55 41106.89,-406.3 41115.62,-412.3 41117.45,-405.55"/>
</g>
<!-- dp0_pp1_layer8_expert2 -->
<g id="node172" class="node">
<title>dp0_pp1_layer8_expert2</title>
<polygon fill="lightgreen" stroke="black" points="41386,-406.29 41162,-406.29 41162,-354.29 41386,-354.29 41386,-406.29"/>
<text text-anchor="middle" x="41274" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="41274" y="-383.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="41274" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="41274" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert2 -->
<g id="edge274" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42405.82,-502.85C42164.66,-498.37 41747.02,-480.97 41395,-417.06 41383.38,-414.95 41371.29,-412.14 41359.44,-409.03"/>
<polygon fill="black" stroke="black" points="41360.13,-405.59 41349.56,-406.34 41358.29,-412.34 41360.13,-405.59"/>
</g>
<!-- dp0_pp1_layer8_expert3 -->
<g id="node173" class="node">
<title>dp0_pp1_layer8_expert3</title>
<polygon fill="lightgreen" stroke="black" points="41628,-406.29 41404,-406.29 41404,-354.29 41628,-354.29 41628,-406.29"/>
<text text-anchor="middle" x="41516" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="41516" y="-383.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="41516" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="41516" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert3 -->
<g id="edge275" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42400.36,-497.41C42203.31,-488.25 41897.63,-466.79 41637,-417.06 41625.57,-414.88 41613.67,-412.06 41601.99,-408.97"/>
<polygon fill="black" stroke="black" points="41602.82,-405.57 41592.25,-406.31 41600.98,-412.32 41602.82,-405.57"/>
</g>
<!-- dp0_pp1_layer8_expert4 -->
<g id="node174" class="node">
<title>dp0_pp1_layer8_expert4</title>
<polygon fill="lightgreen" stroke="black" points="41870,-406.29 41646,-406.29 41646,-354.29 41870,-354.29 41870,-406.29"/>
<text text-anchor="middle" x="41758" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="41758" y="-383.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="41758" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="41758" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert4 -->
<g id="edge276" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42391.43,-487.98C42245.99,-474.71 42049.64,-452.25 41879,-417.06 41868.05,-414.8 41856.65,-412.02 41845.43,-409.02"/>
<polygon fill="black" stroke="black" points="41846.19,-405.6 41835.62,-406.33 41844.34,-412.35 41846.19,-405.6"/>
</g>
<!-- dp0_pp1_layer8_expert5 -->
<g id="node175" class="node">
<title>dp0_pp1_layer8_expert5</title>
<polygon fill="lightgreen" stroke="black" points="42112,-406.29 41888,-406.29 41888,-354.29 42112,-354.29 42112,-406.29"/>
<text text-anchor="middle" x="42000" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="42000" y="-383.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="42000" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="42000" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert5 -->
<g id="edge277" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42371.29,-467.38C42291.5,-453.44 42202,-436.25 42121,-417.06 42110.9,-414.67 42100.4,-411.94 42089.99,-409.07"/>
<polygon fill="black" stroke="black" points="42090.62,-405.62 42080.05,-406.3 42088.74,-412.36 42090.62,-405.62"/>
</g>
<!-- dp0_pp1_layer8_expert6 -->
<g id="node176" class="node">
<title>dp0_pp1_layer8_expert6</title>
<polygon fill="lightgreen" stroke="black" points="42354,-406.29 42130,-406.29 42130,-354.29 42354,-354.29 42354,-406.29"/>
<text text-anchor="middle" x="42242" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="42242" y="-383.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="42242" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="42242" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert6 -->
<g id="edge278" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42453.94,-452.97C42410.16,-438.16 42363.94,-422.53 42325.87,-409.66"/>
<polygon fill="black" stroke="black" points="42326.97,-406.33 42316.38,-406.45 42324.73,-412.97 42326.97,-406.33"/>
</g>
<!-- dp0_pp1_layer8_expert7 -->
<g id="node177" class="node">
<title>dp0_pp1_layer8_expert7</title>
<polygon fill="lightgreen" stroke="black" points="42596,-406.29 42372,-406.29 42372,-354.29 42596,-354.29 42596,-406.29"/>
<text text-anchor="middle" x="42484" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="42484" y="-383.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="42484" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="42484" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert7 -->
<g id="edge279" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42554.38,-452.71C42541.3,-439.43 42527.58,-425.51 42515.76,-413.52"/>
<polygon fill="black" stroke="black" points="42518.19,-411 42508.68,-406.33 42513.2,-415.91 42518.19,-411"/>
</g>
<!-- dp0_pp1_layer8_expert8 -->
<g id="node178" class="node">
<title>dp0_pp1_layer8_expert8</title>
<polygon fill="lightgreen" stroke="black" points="42838,-406.29 42614,-406.29 42614,-354.29 42838,-354.29 42838,-406.29"/>
<text text-anchor="middle" x="42726" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="42726" y="-383.29" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="42726" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="42726" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert8 -->
<g id="edge280" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42655.61,-452.71C42668.7,-439.43 42682.42,-425.51 42694.23,-413.52"/>
<polygon fill="black" stroke="black" points="42696.79,-415.91 42701.32,-406.33 42691.81,-411 42696.79,-415.91"/>
</g>
<!-- dp0_pp1_layer8_expert9 -->
<g id="node179" class="node">
<title>dp0_pp1_layer8_expert9</title>
<polygon fill="lightgreen" stroke="black" points="43080,-406.29 42856,-406.29 42856,-354.29 43080,-354.29 43080,-406.29"/>
<text text-anchor="middle" x="42968" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="42968" y="-383.29" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="42968" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="42968" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert9 -->
<g id="edge281" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42752.38,-454.21C42797.29,-439.03 42845.08,-422.86 42884.23,-409.62"/>
<polygon fill="black" stroke="black" points="42885.64,-412.84 42893.99,-406.32 42883.4,-406.21 42885.64,-412.84"/>
</g>
<!-- dp0_pp1_layer8_expert10 -->
<g id="node180" class="node">
<title>dp0_pp1_layer8_expert10</title>
<polygon fill="lightgreen" stroke="black" points="43322,-406.29 43098,-406.29 43098,-354.29 43322,-354.29 43322,-406.29"/>
<text text-anchor="middle" x="43210" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="43210" y="-383.29" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="43210" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="43210" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert10 -->
<g id="edge282" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42775.89,-478.04C42868.98,-462.69 42985.88,-441.49 43089,-417.06 43099.09,-414.67 43109.6,-411.94 43120.01,-409.07"/>
<polygon fill="black" stroke="black" points="43121.26,-412.36 43129.95,-406.3 43119.37,-405.62 43121.26,-412.36"/>
</g>
<!-- dp0_pp1_layer8_expert11 -->
<g id="node181" class="node">
<title>dp0_pp1_layer8_expert11</title>
<polygon fill="lightgreen" stroke="black" points="43564,-406.29 43340,-406.29 43340,-354.29 43564,-354.29 43564,-406.29"/>
<text text-anchor="middle" x="43452" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="43452" y="-383.29" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="43452" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="43452" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert11 -->
<g id="edge283" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42787.99,-490.7C42935.62,-477.88 43148.08,-454.78 43331,-417.06 43341.95,-414.8 43353.35,-412.02 43364.57,-409.02"/>
<polygon fill="black" stroke="black" points="43365.66,-412.35 43374.38,-406.33 43363.81,-405.6 43365.66,-412.35"/>
</g>
<!-- dp0_pp1_layer8_expert12 -->
<g id="node182" class="node">
<title>dp0_pp1_layer8_expert12</title>
<polygon fill="lightgreen" stroke="black" points="43806,-406.29 43582,-406.29 43582,-354.29 43806,-354.29 43806,-406.29"/>
<text text-anchor="middle" x="43694" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="43694" y="-383.29" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="43694" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="43694" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert12 -->
<g id="edge284" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42795.27,-498.07C42991.59,-489.29 43305.95,-468.01 43573,-417.06 43584.43,-414.88 43596.33,-412.06 43608.01,-408.97"/>
<polygon fill="black" stroke="black" points="43609.02,-412.32 43617.75,-406.31 43607.18,-405.57 43609.02,-412.32"/>
</g>
<!-- dp0_pp1_layer8_expert13 -->
<g id="node183" class="node">
<title>dp0_pp1_layer8_expert13</title>
<polygon fill="lightgreen" stroke="black" points="44048,-406.29 43824,-406.29 43824,-354.29 44048,-354.29 44048,-406.29"/>
<text text-anchor="middle" x="43936" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="43936" y="-383.29" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="43936" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="43936" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert13 -->
<g id="edge285" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42799.93,-502.93C43040.42,-498.58 43460.9,-481.35 43815,-417.06 43826.62,-414.95 43838.71,-412.14 43850.56,-409.03"/>
<polygon fill="black" stroke="black" points="43851.7,-412.34 43860.44,-406.34 43849.87,-405.59 43851.7,-412.34"/>
</g>
<!-- dp0_pp1_layer8_expert14 -->
<g id="node184" class="node">
<title>dp0_pp1_layer8_expert14</title>
<polygon fill="lightgreen" stroke="black" points="44290,-406.29 44066,-406.29 44066,-354.29 44290,-354.29 44290,-406.29"/>
<text text-anchor="middle" x="44178" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="44178" y="-383.29" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="44178" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="44178" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert14 -->
<g id="edge286" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42795.32,-498.04C43132.17,-486.48 43820.15,-458.6 44057,-417.06 44068.92,-414.97 44081.32,-412.12 44093.46,-408.93"/>
<polygon fill="black" stroke="black" points="44094.38,-412.3 44103.11,-406.3 44092.54,-405.55 44094.38,-412.3"/>
</g>
<!-- dp0_pp1_layer8_expert15 -->
<g id="node185" class="node">
<title>dp0_pp1_layer8_expert15</title>
<polygon fill="lightgreen" stroke="black" points="44532,-406.29 44308,-406.29 44308,-354.29 44532,-354.29 44532,-406.29"/>
<text text-anchor="middle" x="44420" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="44420" y="-383.29" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="44420" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="44420" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert15 -->
<g id="edge287" class="edge">
<title>dp0_pp1_layer8_router&#45;&gt;dp0_pp1_layer8_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42796.94,-499.9C43177.49,-490.72 44015.35,-465.57 44299,-417.06 44311.01,-415.01 44323.51,-412.16 44335.73,-408.95"/>
<polygon fill="black" stroke="black" points="44336.72,-412.31 44345.45,-406.32 44334.88,-405.56 44336.72,-412.31"/>
</g>
<!-- dp0_pp1_layer8_expert_agg -->
<g id="node186" class="node">
<title>dp0_pp1_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="42973.57,-307.52 42579.74,-307.52 42478.43,-203.52 42872.26,-203.52 42973.57,-307.52"/>
<text text-anchor="middle" x="42726" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="42726" y="-258.52" font-family="Arial" font-size="10.00">GPUs 0&#45;15</text>
<text text-anchor="middle" x="42726" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="42726" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_expert0&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge288" class="edge">
<title>dp0_pp1_layer8_expert0&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M40848.06,-354.25C40867.69,-346.88 40889.96,-339.68 40911,-335.52 41213.52,-275.68 42112.92,-261.16 42520.8,-257.65"/>
<polygon fill="black" stroke="black" points="42520.96,-261.14 42530.93,-257.56 42520.9,-254.15 42520.96,-261.14"/>
</g>
<!-- dp0_pp1_layer8_expert1&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge289" class="edge">
<title>dp0_pp1_layer8_expert1&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M41090.38,-354.21C41109.94,-346.89 41132.08,-339.73 41153,-335.52 41408.86,-284.02 42157.83,-265.4 42522.21,-259.26"/>
<polygon fill="black" stroke="black" points="42522.4,-262.76 42532.34,-259.09 42522.28,-255.76 42522.4,-262.76"/>
</g>
<!-- dp0_pp1_layer8_expert2&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge290" class="edge">
<title>dp0_pp1_layer8_expert2&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M41332.71,-354.21C41352.19,-346.94 41374.21,-339.8 41395,-335.52 41604.71,-292.32 42206.36,-270.3 42524,-261.41"/>
<polygon fill="black" stroke="black" points="42524.34,-264.9 42534.24,-261.13 42524.15,-257.91 42524.34,-264.9"/>
</g>
<!-- dp0_pp1_layer8_expert3&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge291" class="edge">
<title>dp0_pp1_layer8_expert3&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M41575.05,-354.26C41594.46,-347.03 41616.35,-339.92 41637,-335.52 41801.34,-300.54 42260.32,-276.12 42527.04,-264.41"/>
<polygon fill="black" stroke="black" points="42527.4,-267.9 42537.24,-263.97 42527.09,-260.91 42527.4,-267.9"/>
</g>
<!-- dp0_pp1_layer8_expert4&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge292" class="edge">
<title>dp0_pp1_layer8_expert4&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M41817.73,-354.28C41836.98,-347.15 41858.62,-340.08 41879,-335.52 42095.91,-287.01 42350.52,-268.23 42523.54,-261"/>
<polygon fill="black" stroke="black" points="42523.93,-264.48 42533.78,-260.58 42523.64,-257.49 42523.93,-264.48"/>
</g>
<!-- dp0_pp1_layer8_expert5&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge293" class="edge">
<title>dp0_pp1_layer8_expert5&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M42061.07,-354.28C42080.02,-347.32 42101.14,-340.35 42121,-335.52 42256.78,-302.51 42413.27,-282.55 42533.08,-270.95"/>
<polygon fill="black" stroke="black" points="42533.47,-274.42 42543.09,-269.99 42532.8,-267.46 42533.47,-274.42"/>
</g>
<!-- dp0_pp1_layer8_expert6&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge294" class="edge">
<title>dp0_pp1_layer8_expert6&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M42306.16,-354.29C42324.37,-347.69 42344.32,-340.91 42363,-335.52 42423.46,-318.09 42490.57,-302.47 42550.47,-289.81"/>
<polygon fill="black" stroke="black" points="42551.33,-293.21 42560.4,-287.73 42549.9,-286.36 42551.33,-293.21"/>
</g>
<!-- dp0_pp1_layer8_expert7&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge295" class="edge">
<title>dp0_pp1_layer8_expert7&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M42533.55,-354.15C42557.49,-342.01 42587.24,-326.92 42616.13,-312.26"/>
<polygon fill="black" stroke="black" points="42617.73,-315.37 42625.06,-307.73 42614.56,-309.13 42617.73,-315.37"/>
</g>
<!-- dp0_pp1_layer8_expert8&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge296" class="edge">
<title>dp0_pp1_layer8_expert8&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M42726,-354.15C42726,-343.58 42726,-330.77 42726,-317.96"/>
<polygon fill="black" stroke="black" points="42729.5,-317.73 42726,-307.73 42722.5,-317.73 42729.5,-317.73"/>
</g>
<!-- dp0_pp1_layer8_expert9&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge297" class="edge">
<title>dp0_pp1_layer8_expert9&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M42918.44,-354.15C42894.51,-342.01 42864.76,-326.92 42835.87,-312.26"/>
<polygon fill="black" stroke="black" points="42837.44,-309.13 42826.93,-307.73 42834.27,-315.37 42837.44,-309.13"/>
</g>
<!-- dp0_pp1_layer8_expert10&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge298" class="edge">
<title>dp0_pp1_layer8_expert10&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M43145.84,-354.29C43127.63,-347.69 43107.67,-340.91 43089,-335.52 43054.59,-325.6 43018.02,-316.27 42981.86,-307.73"/>
<polygon fill="black" stroke="black" points="42982.21,-304.22 42971.68,-305.35 42980.61,-311.03 42982.21,-304.22"/>
</g>
<!-- dp0_pp1_layer8_expert11&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge299" class="edge">
<title>dp0_pp1_layer8_expert11&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M43390.93,-354.28C43371.98,-347.32 43350.86,-340.35 43331,-335.52 43206.73,-305.31 43065.11,-286.03 42950.15,-274.08"/>
<polygon fill="black" stroke="black" points="42950.47,-270.6 42940.17,-273.05 42949.76,-277.56 42950.47,-270.6"/>
</g>
<!-- dp0_pp1_layer8_expert12&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge300" class="edge">
<title>dp0_pp1_layer8_expert12&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M43634.27,-354.28C43615.02,-347.15 43593.38,-340.08 43573,-335.52 43360.33,-287.95 43111.41,-268.98 42938.7,-261.43"/>
<polygon fill="black" stroke="black" points="42938.61,-257.93 42928.47,-261 42938.31,-264.92 42938.61,-257.93"/>
</g>
<!-- dp0_pp1_layer8_expert13&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge301" class="edge">
<title>dp0_pp1_layer8_expert13&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M43876.94,-354.26C43857.54,-347.03 43835.65,-339.92 43815,-335.52 43654.14,-301.28 43211.03,-277.16 42942.2,-265.18"/>
<polygon fill="black" stroke="black" points="42942.06,-261.67 42931.92,-264.72 42941.75,-268.66 42942.06,-261.67"/>
</g>
<!-- dp0_pp1_layer8_expert14&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge302" class="edge">
<title>dp0_pp1_layer8_expert14&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M44119.28,-354.21C44099.81,-346.94 44077.78,-339.8 44057,-335.52 43849.74,-292.82 43259.66,-270.82 42939.26,-261.73"/>
<polygon fill="black" stroke="black" points="42939.02,-258.22 42928.92,-261.44 42938.82,-265.22 42939.02,-258.22"/>
</g>
<!-- dp0_pp1_layer8_expert15&#45;&gt;dp0_pp1_layer8_expert_agg -->
<g id="edge303" class="edge">
<title>dp0_pp1_layer8_expert15&#45;&gt;dp0_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M44361.61,-354.21C44342.06,-346.89 44319.91,-339.73 44299,-335.52 44044.8,-284.35 43303.86,-265.64 42936.93,-259.38"/>
<polygon fill="black" stroke="black" points="42936.78,-255.88 42926.72,-259.21 42936.66,-262.88 42936.78,-255.88"/>
</g>
<!-- dp0_pp1_to_pp2 -->
<g id="node1475" class="node">
<title>dp0_pp1_to_pp2</title>
<ellipse fill="lightblue" stroke="black" cx="61775" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="61775" y="-144.75" font-family="Arial" font-size="10.00">PP Stage Transition</text>
<text text-anchor="middle" x="61775" y="-133.75" font-family="Arial" font-size="10.00">GPU 15  GPU 16</text>
<text text-anchor="middle" x="61775" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="61775" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp1_layer8_expert_agg&#45;&gt;dp0_pp1_to_pp2 -->
<g id="edge2426" class="edge">
<title>dp0_pp1_layer8_expert_agg&#45;&gt;dp0_pp1_to_pp2</title>
<path fill="none" stroke="black" d="M42916.24,-248.22C43385.88,-232.99 44638.06,-194.32 45683,-179.52 49006.47,-132.45 60053.96,-131.61 61595.75,-131.73"/>
<polygon fill="black" stroke="black" points="61595.8,-135.23 61605.8,-131.73 61595.8,-128.23 61595.8,-135.23"/>
</g>
<!-- dp0_pp2_layer9_attn_tp0 -->
<g id="node187" class="node">
<title>dp0_pp2_layer9_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="40637.5,-531.06 40372.5,-531.06 40372.5,-479.06 40637.5,-479.06 40637.5,-531.06"/>
<text text-anchor="middle" x="40505" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="40505" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="40505" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="40505" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer9_attn_allreduce -->
<g id="node188" class="node">
<title>dp0_pp2_layer9_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="40080" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="40080" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="40080" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="40080" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="40080" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_attn_tp0&#45;&gt;dp0_pp2_layer9_attn_allreduce -->
<g id="edge305" class="edge">
<title>dp0_pp2_layer9_attn_tp0&#45;&gt;dp0_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M40439.82,-478.95C40416.12,-470.23 40389.01,-460.72 40364,-453.06 40312.14,-437.17 40254.21,-422.07 40204.26,-409.85"/>
<polygon fill="black" stroke="black" points="40204.92,-406.41 40194.38,-407.45 40203.27,-413.21 40204.92,-406.41"/>
</g>
<!-- dp0_pp2_layer9_router -->
<g id="node192" class="node">
<title>dp0_pp2_layer9_router</title>
<polygon fill="lightyellow" stroke="black" points="37819.57,-557.06 37425.74,-557.06 37324.43,-453.06 37718.26,-453.06 37819.57,-557.06"/>
<text text-anchor="middle" x="37572" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="37572" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="37572" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="37572" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_attn_allreduce&#45;&gt;dp0_pp2_layer9_router -->
<g id="edge341" class="edge">
<title>dp0_pp2_layer9_attn_allreduce&#45;&gt;dp0_pp2_layer9_router</title>
<path fill="none" stroke="black" d="M39919.7,-392.14C39805.73,-399.66 39649,-409.63 39511,-417.06 38875.48,-451.29 38122.27,-482.37 37770.96,-496.31"/>
<polygon fill="black" stroke="black" points="37770.79,-492.82 37760.94,-496.71 37771.07,-499.81 37770.79,-492.82"/>
</g>
<!-- dp0_pp2_layer9_attn_tp1 -->
<g id="node189" class="node">
<title>dp0_pp2_layer9_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="39788.5,-531.06 39523.5,-531.06 39523.5,-479.06 39788.5,-479.06 39788.5,-531.06"/>
<text text-anchor="middle" x="39656" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="39656" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="39656" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="39656" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer9_attn_tp1&#45;&gt;dp0_pp2_layer9_attn_allreduce -->
<g id="edge306" class="edge">
<title>dp0_pp2_layer9_attn_tp1&#45;&gt;dp0_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M39721.66,-479C39745.53,-470.28 39772.83,-460.77 39798,-453.06 39849.51,-437.29 39907.04,-422.21 39956.64,-409.97"/>
<polygon fill="black" stroke="black" points="39957.57,-413.35 39966.45,-407.57 39955.9,-406.55 39957.57,-413.35"/>
</g>
<!-- dp0_pp2_layer9_attn_tp2 -->
<g id="node190" class="node">
<title>dp0_pp2_layer9_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="40354.5,-531.06 40089.5,-531.06 40089.5,-479.06 40354.5,-479.06 40354.5,-531.06"/>
<text text-anchor="middle" x="40222" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="40222" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="40222" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="40222" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer9_attn_tp2&#45;&gt;dp0_pp2_layer9_attn_allreduce -->
<g id="edge307" class="edge">
<title>dp0_pp2_layer9_attn_tp2&#45;&gt;dp0_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M40192.92,-478.92C40174.28,-462.8 40149.62,-441.49 40128.11,-422.89"/>
<polygon fill="black" stroke="black" points="40130.2,-420.06 40120.34,-416.17 40125.62,-425.36 40130.2,-420.06"/>
</g>
<!-- dp0_pp2_layer9_attn_tp3 -->
<g id="node191" class="node">
<title>dp0_pp2_layer9_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="40071.5,-531.06 39806.5,-531.06 39806.5,-479.06 40071.5,-479.06 40071.5,-531.06"/>
<text text-anchor="middle" x="39939" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="39939" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="39939" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="39939" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer9_attn_tp3&#45;&gt;dp0_pp2_layer9_attn_allreduce -->
<g id="edge308" class="edge">
<title>dp0_pp2_layer9_attn_tp3&#45;&gt;dp0_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M39967.87,-478.92C39986.39,-462.8 40010.87,-441.49 40032.23,-422.89"/>
<polygon fill="black" stroke="black" points="40034.7,-425.38 40039.94,-416.17 40030.1,-420.1 40034.7,-425.38"/>
</g>
<!-- dp0_pp2_layer9_expert0 -->
<g id="node193" class="node">
<title>dp0_pp2_layer9_expert0</title>
<polygon fill="lightgreen" stroke="black" points="35869,-406.29 35645,-406.29 35645,-354.29 35869,-354.29 35869,-406.29"/>
<text text-anchor="middle" x="35757" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="35757" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="35757" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="35757" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert0 -->
<g id="edge309" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37369.73,-499.65C36984.55,-490.26 36159.11,-465.13 35878,-417.06 35865.99,-415.01 35853.48,-412.16 35841.27,-408.95"/>
<polygon fill="black" stroke="black" points="35842.11,-405.56 35831.54,-406.32 35840.28,-412.31 35842.11,-405.56"/>
</g>
<!-- dp0_pp2_layer9_expert1 -->
<g id="node194" class="node">
<title>dp0_pp2_layer9_expert1</title>
<polygon fill="lightgreen" stroke="black" points="36111,-406.29 35887,-406.29 35887,-354.29 36111,-354.29 36111,-406.29"/>
<text text-anchor="middle" x="35999" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="35999" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="35999" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="35999" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert1 -->
<g id="edge310" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37367.55,-497.55C37025.94,-485.71 36353.58,-458.03 36120,-417.06 36108.08,-414.97 36095.67,-412.12 36083.54,-408.93"/>
<polygon fill="black" stroke="black" points="36084.45,-405.55 36073.89,-406.3 36082.62,-412.3 36084.45,-405.55"/>
</g>
<!-- dp0_pp2_layer9_expert2 -->
<g id="node195" class="node">
<title>dp0_pp2_layer9_expert2</title>
<polygon fill="lightgreen" stroke="black" points="36353,-406.29 36129,-406.29 36129,-354.29 36353,-354.29 36353,-406.29"/>
<text text-anchor="middle" x="36241" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="36241" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="36241" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="36241" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert2 -->
<g id="edge311" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37372.82,-502.85C37131.66,-498.37 36714.02,-480.97 36362,-417.06 36350.38,-414.95 36338.29,-412.14 36326.44,-409.03"/>
<polygon fill="black" stroke="black" points="36327.13,-405.59 36316.56,-406.34 36325.29,-412.34 36327.13,-405.59"/>
</g>
<!-- dp0_pp2_layer9_expert3 -->
<g id="node196" class="node">
<title>dp0_pp2_layer9_expert3</title>
<polygon fill="lightgreen" stroke="black" points="36595,-406.29 36371,-406.29 36371,-354.29 36595,-354.29 36595,-406.29"/>
<text text-anchor="middle" x="36483" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="36483" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="36483" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="36483" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert3 -->
<g id="edge312" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37367.36,-497.41C37170.31,-488.25 36864.63,-466.79 36604,-417.06 36592.57,-414.88 36580.67,-412.06 36568.99,-408.97"/>
<polygon fill="black" stroke="black" points="36569.82,-405.57 36559.25,-406.31 36567.98,-412.32 36569.82,-405.57"/>
</g>
<!-- dp0_pp2_layer9_expert4 -->
<g id="node197" class="node">
<title>dp0_pp2_layer9_expert4</title>
<polygon fill="lightgreen" stroke="black" points="36837,-406.29 36613,-406.29 36613,-354.29 36837,-354.29 36837,-406.29"/>
<text text-anchor="middle" x="36725" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="36725" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="36725" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="36725" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert4 -->
<g id="edge313" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37358.43,-487.98C37212.99,-474.71 37016.64,-452.25 36846,-417.06 36835.05,-414.8 36823.65,-412.02 36812.43,-409.02"/>
<polygon fill="black" stroke="black" points="36813.19,-405.6 36802.62,-406.33 36811.34,-412.35 36813.19,-405.6"/>
</g>
<!-- dp0_pp2_layer9_expert5 -->
<g id="node198" class="node">
<title>dp0_pp2_layer9_expert5</title>
<polygon fill="lightgreen" stroke="black" points="37079,-406.29 36855,-406.29 36855,-354.29 37079,-354.29 37079,-406.29"/>
<text text-anchor="middle" x="36967" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="36967" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="36967" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="36967" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert5 -->
<g id="edge314" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37338.29,-467.38C37258.5,-453.44 37169,-436.25 37088,-417.06 37077.9,-414.67 37067.4,-411.94 37056.99,-409.07"/>
<polygon fill="black" stroke="black" points="37057.62,-405.62 37047.05,-406.3 37055.74,-412.36 37057.62,-405.62"/>
</g>
<!-- dp0_pp2_layer9_expert6 -->
<g id="node199" class="node">
<title>dp0_pp2_layer9_expert6</title>
<polygon fill="lightgreen" stroke="black" points="37321,-406.29 37097,-406.29 37097,-354.29 37321,-354.29 37321,-406.29"/>
<text text-anchor="middle" x="37209" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="37209" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="37209" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="37209" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert6 -->
<g id="edge315" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37420.94,-452.97C37377.16,-438.16 37330.94,-422.53 37292.87,-409.66"/>
<polygon fill="black" stroke="black" points="37293.97,-406.33 37283.38,-406.45 37291.73,-412.97 37293.97,-406.33"/>
</g>
<!-- dp0_pp2_layer9_expert7 -->
<g id="node200" class="node">
<title>dp0_pp2_layer9_expert7</title>
<polygon fill="lightgreen" stroke="black" points="37563,-406.29 37339,-406.29 37339,-354.29 37563,-354.29 37563,-406.29"/>
<text text-anchor="middle" x="37451" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="37451" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="37451" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="37451" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert7 -->
<g id="edge316" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37521.38,-452.71C37508.3,-439.43 37494.58,-425.51 37482.76,-413.52"/>
<polygon fill="black" stroke="black" points="37485.19,-411 37475.68,-406.33 37480.2,-415.91 37485.19,-411"/>
</g>
<!-- dp0_pp2_layer9_expert8 -->
<g id="node201" class="node">
<title>dp0_pp2_layer9_expert8</title>
<polygon fill="lightgreen" stroke="black" points="37805,-406.29 37581,-406.29 37581,-354.29 37805,-354.29 37805,-406.29"/>
<text text-anchor="middle" x="37693" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="37693" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="37693" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="37693" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert8 -->
<g id="edge317" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37622.61,-452.71C37635.7,-439.43 37649.42,-425.51 37661.23,-413.52"/>
<polygon fill="black" stroke="black" points="37663.79,-415.91 37668.32,-406.33 37658.81,-411 37663.79,-415.91"/>
</g>
<!-- dp0_pp2_layer9_expert9 -->
<g id="node202" class="node">
<title>dp0_pp2_layer9_expert9</title>
<polygon fill="lightgreen" stroke="black" points="38047,-406.29 37823,-406.29 37823,-354.29 38047,-354.29 38047,-406.29"/>
<text text-anchor="middle" x="37935" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="37935" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="37935" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="37935" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert9 -->
<g id="edge318" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37719.38,-454.21C37764.29,-439.03 37812.08,-422.86 37851.23,-409.62"/>
<polygon fill="black" stroke="black" points="37852.64,-412.84 37860.99,-406.32 37850.4,-406.21 37852.64,-412.84"/>
</g>
<!-- dp0_pp2_layer9_expert10 -->
<g id="node203" class="node">
<title>dp0_pp2_layer9_expert10</title>
<polygon fill="lightgreen" stroke="black" points="38289,-406.29 38065,-406.29 38065,-354.29 38289,-354.29 38289,-406.29"/>
<text text-anchor="middle" x="38177" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="38177" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="38177" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="38177" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert10 -->
<g id="edge319" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37742.89,-478.04C37835.98,-462.69 37952.88,-441.49 38056,-417.06 38066.09,-414.67 38076.6,-411.94 38087.01,-409.07"/>
<polygon fill="black" stroke="black" points="38088.26,-412.36 38096.95,-406.3 38086.37,-405.62 38088.26,-412.36"/>
</g>
<!-- dp0_pp2_layer9_expert11 -->
<g id="node204" class="node">
<title>dp0_pp2_layer9_expert11</title>
<polygon fill="lightgreen" stroke="black" points="38531,-406.29 38307,-406.29 38307,-354.29 38531,-354.29 38531,-406.29"/>
<text text-anchor="middle" x="38419" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="38419" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="38419" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="38419" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert11 -->
<g id="edge320" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37754.99,-490.7C37902.62,-477.88 38115.08,-454.78 38298,-417.06 38308.95,-414.8 38320.35,-412.02 38331.57,-409.02"/>
<polygon fill="black" stroke="black" points="38332.66,-412.35 38341.38,-406.33 38330.81,-405.6 38332.66,-412.35"/>
</g>
<!-- dp0_pp2_layer9_expert12 -->
<g id="node205" class="node">
<title>dp0_pp2_layer9_expert12</title>
<polygon fill="lightgreen" stroke="black" points="38773,-406.29 38549,-406.29 38549,-354.29 38773,-354.29 38773,-406.29"/>
<text text-anchor="middle" x="38661" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="38661" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="38661" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="38661" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert12 -->
<g id="edge321" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37762.27,-498.07C37958.59,-489.29 38272.95,-468.01 38540,-417.06 38551.43,-414.88 38563.33,-412.06 38575.01,-408.97"/>
<polygon fill="black" stroke="black" points="38576.02,-412.32 38584.75,-406.31 38574.18,-405.57 38576.02,-412.32"/>
</g>
<!-- dp0_pp2_layer9_expert13 -->
<g id="node206" class="node">
<title>dp0_pp2_layer9_expert13</title>
<polygon fill="lightgreen" stroke="black" points="39015,-406.29 38791,-406.29 38791,-354.29 39015,-354.29 39015,-406.29"/>
<text text-anchor="middle" x="38903" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="38903" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="38903" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="38903" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert13 -->
<g id="edge322" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37766.93,-502.93C38007.42,-498.58 38427.9,-481.35 38782,-417.06 38793.62,-414.95 38805.71,-412.14 38817.56,-409.03"/>
<polygon fill="black" stroke="black" points="38818.7,-412.34 38827.44,-406.34 38816.87,-405.59 38818.7,-412.34"/>
</g>
<!-- dp0_pp2_layer9_expert14 -->
<g id="node207" class="node">
<title>dp0_pp2_layer9_expert14</title>
<polygon fill="lightgreen" stroke="black" points="39257,-406.29 39033,-406.29 39033,-354.29 39257,-354.29 39257,-406.29"/>
<text text-anchor="middle" x="39145" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="39145" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="39145" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="39145" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert14 -->
<g id="edge323" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37762.32,-498.04C38099.17,-486.48 38787.15,-458.6 39024,-417.06 39035.92,-414.97 39048.32,-412.12 39060.46,-408.93"/>
<polygon fill="black" stroke="black" points="39061.38,-412.3 39070.11,-406.3 39059.54,-405.55 39061.38,-412.3"/>
</g>
<!-- dp0_pp2_layer9_expert15 -->
<g id="node208" class="node">
<title>dp0_pp2_layer9_expert15</title>
<polygon fill="lightgreen" stroke="black" points="39499,-406.29 39275,-406.29 39275,-354.29 39499,-354.29 39499,-406.29"/>
<text text-anchor="middle" x="39387" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="39387" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="39387" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="39387" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert15 -->
<g id="edge324" class="edge">
<title>dp0_pp2_layer9_router&#45;&gt;dp0_pp2_layer9_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37763.94,-499.9C38144.49,-490.72 38982.35,-465.57 39266,-417.06 39278.01,-415.01 39290.51,-412.16 39302.73,-408.95"/>
<polygon fill="black" stroke="black" points="39303.72,-412.31 39312.45,-406.32 39301.88,-405.56 39303.72,-412.31"/>
</g>
<!-- dp0_pp2_layer9_expert_agg -->
<g id="node209" class="node">
<title>dp0_pp2_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="37819.57,-307.52 37425.74,-307.52 37324.43,-203.52 37718.26,-203.52 37819.57,-307.52"/>
<text text-anchor="middle" x="37572" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="37572" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="37572" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="37572" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer9_expert0&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge325" class="edge">
<title>dp0_pp2_layer9_expert0&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M35815.07,-354.29C35834.69,-346.92 35856.97,-339.72 35878,-335.52 36157.13,-279.86 36980.93,-263.21 37367.43,-258.4"/>
<polygon fill="black" stroke="black" points="37367.65,-261.9 37377.61,-258.27 37367.57,-254.9 37367.65,-261.9"/>
</g>
<!-- dp0_pp2_layer9_expert1&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge326" class="edge">
<title>dp0_pp2_layer9_expert1&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M36057.39,-354.27C36076.95,-346.95 36099.09,-339.78 36120,-335.52 36352.8,-288.16 37028.09,-267.74 37369.43,-260.24"/>
<polygon fill="black" stroke="black" points="37369.51,-263.74 37379.43,-260.03 37369.35,-256.74 37369.51,-263.74"/>
</g>
<!-- dp0_pp2_layer9_expert2&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge327" class="edge">
<title>dp0_pp2_layer9_expert2&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M36299.73,-354.29C36319.21,-347.01 36341.23,-339.87 36362,-335.52 36548.91,-296.44 37078.54,-273.07 37371.3,-262.78"/>
<polygon fill="black" stroke="black" points="37371.74,-266.27 37381.61,-262.42 37371.5,-259.27 37371.74,-266.27"/>
</g>
<!-- dp0_pp2_layer9_expert3&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge328" class="edge">
<title>dp0_pp2_layer9_expert3&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M36542.39,-354.26C36561.72,-347.07 36583.48,-339.99 36604,-335.52 36862.91,-279.18 37168.7,-262.24 37366.26,-257.56"/>
<polygon fill="black" stroke="black" points="37366.55,-261.06 37376.47,-257.33 37366.39,-254.06 37366.55,-261.06"/>
</g>
<!-- dp0_pp2_layer9_expert4&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge329" class="edge">
<title>dp0_pp2_layer9_expert4&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M36785.39,-354.24C36804.49,-347.2 36825.87,-340.19 36846,-335.52 37021.82,-294.77 37226.6,-274.91 37373.75,-265.31"/>
<polygon fill="black" stroke="black" points="37374.05,-268.8 37383.81,-264.67 37373.6,-261.82 37374.05,-268.8"/>
</g>
<!-- dp0_pp2_layer9_expert5&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge330" class="edge">
<title>dp0_pp2_layer9_expert5&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M37029.42,-354.22C37048.04,-347.42 37068.65,-340.55 37088,-335.52 37185.09,-310.27 37295.34,-291.53 37386.07,-278.65"/>
<polygon fill="black" stroke="black" points="37386.78,-282.09 37396.19,-277.23 37385.8,-275.16 37386.78,-282.09"/>
</g>
<!-- dp0_pp2_layer9_expert6&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge331" class="edge">
<title>dp0_pp2_layer9_expert6&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M37277.02,-354.26C37294.26,-348.03 37312.78,-341.44 37330,-335.52 37356.73,-326.33 37385.21,-316.8 37412.89,-307.67"/>
<polygon fill="black" stroke="black" points="37414.24,-310.91 37422.65,-304.46 37412.06,-304.26 37414.24,-310.91"/>
</g>
<!-- dp0_pp2_layer9_expert7&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge332" class="edge">
<title>dp0_pp2_layer9_expert7&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M37475.78,-354.15C37487.02,-342.74 37500.83,-328.73 37514.45,-314.92"/>
<polygon fill="black" stroke="black" points="37517,-317.31 37521.53,-307.73 37512.02,-312.39 37517,-317.31"/>
</g>
<!-- dp0_pp2_layer9_expert8&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge333" class="edge">
<title>dp0_pp2_layer9_expert8&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M37668.22,-354.15C37656.97,-342.74 37643.16,-328.73 37629.55,-314.92"/>
<polygon fill="black" stroke="black" points="37631.98,-312.39 37622.47,-307.73 37626.99,-317.31 37631.98,-312.39"/>
</g>
<!-- dp0_pp2_layer9_expert9&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge334" class="edge">
<title>dp0_pp2_layer9_expert9&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M37866.98,-354.26C37849.73,-348.03 37831.21,-341.44 37814,-335.52 37790.29,-327.37 37765.21,-318.95 37740.53,-310.78"/>
<polygon fill="black" stroke="black" points="37741.32,-307.36 37730.73,-307.54 37739.12,-314 37741.32,-307.36"/>
</g>
<!-- dp0_pp2_layer9_expert10&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge335" class="edge">
<title>dp0_pp2_layer9_expert10&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M38114.58,-354.22C38095.96,-347.42 38075.35,-340.55 38056,-335.52 37975.99,-314.71 37887.05,-298.33 37807.46,-286"/>
<polygon fill="black" stroke="black" points="37807.71,-282.5 37797.3,-284.44 37806.65,-289.41 37807.71,-282.5"/>
</g>
<!-- dp0_pp2_layer9_expert11&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge336" class="edge">
<title>dp0_pp2_layer9_expert11&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M38358.61,-354.24C38339.51,-347.2 38318.13,-340.19 38298,-335.52 38129.74,-296.53 37934.97,-276.66 37789.55,-266.61"/>
<polygon fill="black" stroke="black" points="37789.38,-263.09 37779.16,-265.9 37788.9,-270.07 37789.38,-263.09"/>
</g>
<!-- dp0_pp2_layer9_expert12&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge337" class="edge">
<title>dp0_pp2_layer9_expert12&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M38601.61,-354.26C38582.28,-347.07 38560.52,-339.99 38540,-335.52 38282.51,-279.49 37978.64,-262.43 37780.99,-257.64"/>
<polygon fill="black" stroke="black" points="37780.86,-254.14 37770.78,-257.4 37780.69,-261.13 37780.86,-254.14"/>
</g>
<!-- dp0_pp2_layer9_expert13&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge338" class="edge">
<title>dp0_pp2_layer9_expert13&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M38844.27,-354.29C38824.79,-347.01 38802.77,-339.87 38782,-335.52 38598.02,-297.05 38081.97,-273.81 37786.63,-263.27"/>
<polygon fill="black" stroke="black" points="37786.33,-259.76 37776.21,-262.9 37786.08,-266.76 37786.33,-259.76"/>
</g>
<!-- dp0_pp2_layer9_expert14&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge339" class="edge">
<title>dp0_pp2_layer9_expert14&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M39086.6,-354.27C39067.05,-346.95 39044.9,-339.78 39024,-335.52 38793.27,-288.58 38127.86,-268.1 37783.74,-260.45"/>
<polygon fill="black" stroke="black" points="37783.73,-256.94 37773.65,-260.22 37783.57,-263.94 37783.73,-256.94"/>
</g>
<!-- dp0_pp2_layer9_expert15&#45;&gt;dp0_pp2_layer9_expert_agg -->
<g id="edge340" class="edge">
<title>dp0_pp2_layer9_expert15&#45;&gt;dp0_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M39328.93,-354.29C39309.3,-346.92 39287.03,-339.72 39266,-335.52 38988.21,-280.12 38170.98,-263.37 37782.17,-258.47"/>
<polygon fill="black" stroke="black" points="37781.97,-254.97 37771.93,-258.34 37781.88,-261.97 37781.97,-254.97"/>
</g>
<!-- dp0_pp2_layer10_attn_tp0 -->
<g id="node210" class="node">
<title>dp0_pp2_layer10_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="35054.5,-531.06 34789.5,-531.06 34789.5,-479.06 35054.5,-479.06 35054.5,-531.06"/>
<text text-anchor="middle" x="34922" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="34922" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="34922" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="34922" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer9_expert_agg&#45;&gt;dp0_pp2_layer10_attn_tp0 -->
<g id="edge342" class="edge">
<title>dp0_pp2_layer9_expert_agg&#45;&gt;dp0_pp2_layer10_attn_tp0</title>
<path fill="none" stroke="black" d="M37379.78,-260.41C36959.38,-269.54 35969.17,-294.77 35636,-335.52 35603.8,-339.46 35095.23,-444.29 35064,-453.06 35041.37,-459.41 35017.16,-467.58 34995.26,-475.5"/>
<polygon fill="black" stroke="black" points="34993.89,-472.28 34985.7,-479 34996.29,-478.85 34993.89,-472.28"/>
</g>
<!-- dp0_pp2_layer10_attn_allreduce -->
<g id="node211" class="node">
<title>dp0_pp2_layer10_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="35051" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="35051" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="35051" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="35051" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="35051" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_attn_tp0&#45;&gt;dp0_pp2_layer10_attn_allreduce -->
<g id="edge343" class="edge">
<title>dp0_pp2_layer10_attn_tp0&#45;&gt;dp0_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M34948.41,-478.92C34965.15,-463 34987.21,-442 35006.58,-423.56"/>
<polygon fill="black" stroke="black" points="35009.03,-426.07 35013.86,-416.64 35004.2,-421 35009.03,-426.07"/>
</g>
<!-- dp0_pp2_layer10_router -->
<g id="node215" class="node">
<title>dp0_pp2_layer10_router</title>
<polygon fill="lightyellow" stroke="black" points="32802.57,-557.06 32408.74,-557.06 32307.43,-453.06 32701.26,-453.06 32802.57,-557.06"/>
<text text-anchor="middle" x="32555" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="32555" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="32555" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="32555" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_attn_allreduce&#45;&gt;dp0_pp2_layer10_router -->
<g id="edge379" class="edge">
<title>dp0_pp2_layer10_attn_allreduce&#45;&gt;dp0_pp2_layer10_router</title>
<path fill="none" stroke="black" d="M34891.08,-392.38C34779.77,-399.9 34627.89,-409.76 34494,-417.06 33858.5,-451.72 33105.28,-482.59 32753.96,-496.4"/>
<polygon fill="black" stroke="black" points="32753.8,-492.91 32743.94,-496.79 32754.07,-499.9 32753.8,-492.91"/>
</g>
<!-- dp0_pp2_layer10_attn_tp1 -->
<g id="node212" class="node">
<title>dp0_pp2_layer10_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="35337.5,-531.06 35072.5,-531.06 35072.5,-479.06 35337.5,-479.06 35337.5,-531.06"/>
<text text-anchor="middle" x="35205" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="35205" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="35205" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="35205" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer10_attn_tp1&#45;&gt;dp0_pp2_layer10_attn_allreduce -->
<g id="edge344" class="edge">
<title>dp0_pp2_layer10_attn_tp1&#45;&gt;dp0_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M35173.46,-478.92C35152.99,-462.6 35125.83,-440.94 35102.29,-422.18"/>
<polygon fill="black" stroke="black" points="35104.46,-419.44 35094.46,-415.94 35100.1,-424.91 35104.46,-419.44"/>
</g>
<!-- dp0_pp2_layer10_attn_tp2 -->
<g id="node213" class="node">
<title>dp0_pp2_layer10_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="34771.5,-531.06 34506.5,-531.06 34506.5,-479.06 34771.5,-479.06 34771.5,-531.06"/>
<text text-anchor="middle" x="34639" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="34639" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="34639" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="34639" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer10_attn_tp2&#45;&gt;dp0_pp2_layer10_attn_allreduce -->
<g id="edge345" class="edge">
<title>dp0_pp2_layer10_attn_tp2&#45;&gt;dp0_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M34705.07,-479.02C34728.85,-470.35 34755.99,-460.86 34781,-453.06 34829.74,-437.86 34884.05,-423.03 34931.1,-410.83"/>
<polygon fill="black" stroke="black" points="34932.22,-414.15 34941.03,-408.26 34930.47,-407.38 34932.22,-414.15"/>
</g>
<!-- dp0_pp2_layer10_attn_tp3 -->
<g id="node214" class="node">
<title>dp0_pp2_layer10_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="35620.5,-531.06 35355.5,-531.06 35355.5,-479.06 35620.5,-479.06 35620.5,-531.06"/>
<text text-anchor="middle" x="35488" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="35488" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="35488" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="35488" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer10_attn_tp3&#45;&gt;dp0_pp2_layer10_attn_allreduce -->
<g id="edge346" class="edge">
<title>dp0_pp2_layer10_attn_tp3&#45;&gt;dp0_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M35423.21,-478.95C35399.43,-470.18 35372.17,-460.64 35347,-453.06 35292.42,-436.63 35231.31,-421.31 35178.86,-409.08"/>
<polygon fill="black" stroke="black" points="35179.37,-405.6 35168.83,-406.75 35177.78,-412.42 35179.37,-405.6"/>
</g>
<!-- dp0_pp2_layer10_expert0 -->
<g id="node216" class="node">
<title>dp0_pp2_layer10_expert0</title>
<polygon fill="lightgreen" stroke="black" points="30852,-406.29 30628,-406.29 30628,-354.29 30852,-354.29 30852,-406.29"/>
<text text-anchor="middle" x="30740" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="30740" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="30740" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="30740" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert0 -->
<g id="edge347" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32352.73,-499.65C31967.55,-490.26 31142.11,-465.13 30861,-417.06 30848.99,-415.01 30836.48,-412.16 30824.27,-408.95"/>
<polygon fill="black" stroke="black" points="30825.11,-405.56 30814.54,-406.32 30823.28,-412.31 30825.11,-405.56"/>
</g>
<!-- dp0_pp2_layer10_expert1 -->
<g id="node217" class="node">
<title>dp0_pp2_layer10_expert1</title>
<polygon fill="lightgreen" stroke="black" points="31094,-406.29 30870,-406.29 30870,-354.29 31094,-354.29 31094,-406.29"/>
<text text-anchor="middle" x="30982" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="30982" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="30982" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="30982" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert1 -->
<g id="edge348" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32350.55,-497.55C32008.94,-485.71 31336.58,-458.03 31103,-417.06 31091.08,-414.97 31078.67,-412.12 31066.54,-408.93"/>
<polygon fill="black" stroke="black" points="31067.45,-405.55 31056.89,-406.3 31065.62,-412.3 31067.45,-405.55"/>
</g>
<!-- dp0_pp2_layer10_expert2 -->
<g id="node218" class="node">
<title>dp0_pp2_layer10_expert2</title>
<polygon fill="lightgreen" stroke="black" points="31336,-406.29 31112,-406.29 31112,-354.29 31336,-354.29 31336,-406.29"/>
<text text-anchor="middle" x="31224" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="31224" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="31224" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="31224" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert2 -->
<g id="edge349" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32355.82,-502.85C32114.66,-498.37 31697.02,-480.97 31345,-417.06 31333.38,-414.95 31321.29,-412.14 31309.44,-409.03"/>
<polygon fill="black" stroke="black" points="31310.13,-405.59 31299.56,-406.34 31308.29,-412.34 31310.13,-405.59"/>
</g>
<!-- dp0_pp2_layer10_expert3 -->
<g id="node219" class="node">
<title>dp0_pp2_layer10_expert3</title>
<polygon fill="lightgreen" stroke="black" points="31578,-406.29 31354,-406.29 31354,-354.29 31578,-354.29 31578,-406.29"/>
<text text-anchor="middle" x="31466" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="31466" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="31466" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="31466" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert3 -->
<g id="edge350" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32350.36,-497.41C32153.31,-488.25 31847.63,-466.79 31587,-417.06 31575.57,-414.88 31563.67,-412.06 31551.99,-408.97"/>
<polygon fill="black" stroke="black" points="31552.82,-405.57 31542.25,-406.31 31550.98,-412.32 31552.82,-405.57"/>
</g>
<!-- dp0_pp2_layer10_expert4 -->
<g id="node220" class="node">
<title>dp0_pp2_layer10_expert4</title>
<polygon fill="lightgreen" stroke="black" points="31820,-406.29 31596,-406.29 31596,-354.29 31820,-354.29 31820,-406.29"/>
<text text-anchor="middle" x="31708" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="31708" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="31708" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="31708" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert4 -->
<g id="edge351" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32341.43,-487.98C32195.99,-474.71 31999.64,-452.25 31829,-417.06 31818.05,-414.8 31806.65,-412.02 31795.43,-409.02"/>
<polygon fill="black" stroke="black" points="31796.19,-405.6 31785.62,-406.33 31794.34,-412.35 31796.19,-405.6"/>
</g>
<!-- dp0_pp2_layer10_expert5 -->
<g id="node221" class="node">
<title>dp0_pp2_layer10_expert5</title>
<polygon fill="lightgreen" stroke="black" points="32062,-406.29 31838,-406.29 31838,-354.29 32062,-354.29 32062,-406.29"/>
<text text-anchor="middle" x="31950" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="31950" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="31950" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="31950" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert5 -->
<g id="edge352" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32321.29,-467.38C32241.5,-453.44 32152,-436.25 32071,-417.06 32060.9,-414.67 32050.4,-411.94 32039.99,-409.07"/>
<polygon fill="black" stroke="black" points="32040.62,-405.62 32030.05,-406.3 32038.74,-412.36 32040.62,-405.62"/>
</g>
<!-- dp0_pp2_layer10_expert6 -->
<g id="node222" class="node">
<title>dp0_pp2_layer10_expert6</title>
<polygon fill="lightgreen" stroke="black" points="32304,-406.29 32080,-406.29 32080,-354.29 32304,-354.29 32304,-406.29"/>
<text text-anchor="middle" x="32192" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="32192" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="32192" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="32192" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert6 -->
<g id="edge353" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32403.94,-452.97C32360.16,-438.16 32313.94,-422.53 32275.87,-409.66"/>
<polygon fill="black" stroke="black" points="32276.97,-406.33 32266.38,-406.45 32274.73,-412.97 32276.97,-406.33"/>
</g>
<!-- dp0_pp2_layer10_expert7 -->
<g id="node223" class="node">
<title>dp0_pp2_layer10_expert7</title>
<polygon fill="lightgreen" stroke="black" points="32546,-406.29 32322,-406.29 32322,-354.29 32546,-354.29 32546,-406.29"/>
<text text-anchor="middle" x="32434" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="32434" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="32434" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="32434" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert7 -->
<g id="edge354" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32504.38,-452.71C32491.3,-439.43 32477.58,-425.51 32465.76,-413.52"/>
<polygon fill="black" stroke="black" points="32468.19,-411 32458.68,-406.33 32463.2,-415.91 32468.19,-411"/>
</g>
<!-- dp0_pp2_layer10_expert8 -->
<g id="node224" class="node">
<title>dp0_pp2_layer10_expert8</title>
<polygon fill="lightgreen" stroke="black" points="32788,-406.29 32564,-406.29 32564,-354.29 32788,-354.29 32788,-406.29"/>
<text text-anchor="middle" x="32676" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="32676" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="32676" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="32676" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert8 -->
<g id="edge355" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32605.61,-452.71C32618.7,-439.43 32632.42,-425.51 32644.23,-413.52"/>
<polygon fill="black" stroke="black" points="32646.79,-415.91 32651.32,-406.33 32641.81,-411 32646.79,-415.91"/>
</g>
<!-- dp0_pp2_layer10_expert9 -->
<g id="node225" class="node">
<title>dp0_pp2_layer10_expert9</title>
<polygon fill="lightgreen" stroke="black" points="33030,-406.29 32806,-406.29 32806,-354.29 33030,-354.29 33030,-406.29"/>
<text text-anchor="middle" x="32918" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="32918" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="32918" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="32918" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert9 -->
<g id="edge356" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32702.38,-454.21C32747.29,-439.03 32795.08,-422.86 32834.23,-409.62"/>
<polygon fill="black" stroke="black" points="32835.64,-412.84 32843.99,-406.32 32833.4,-406.21 32835.64,-412.84"/>
</g>
<!-- dp0_pp2_layer10_expert10 -->
<g id="node226" class="node">
<title>dp0_pp2_layer10_expert10</title>
<polygon fill="lightgreen" stroke="black" points="33272,-406.29 33048,-406.29 33048,-354.29 33272,-354.29 33272,-406.29"/>
<text text-anchor="middle" x="33160" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="33160" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="33160" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="33160" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert10 -->
<g id="edge357" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32725.89,-478.04C32818.98,-462.69 32935.88,-441.49 33039,-417.06 33049.09,-414.67 33059.6,-411.94 33070.01,-409.07"/>
<polygon fill="black" stroke="black" points="33071.26,-412.36 33079.95,-406.3 33069.37,-405.62 33071.26,-412.36"/>
</g>
<!-- dp0_pp2_layer10_expert11 -->
<g id="node227" class="node">
<title>dp0_pp2_layer10_expert11</title>
<polygon fill="lightgreen" stroke="black" points="33514,-406.29 33290,-406.29 33290,-354.29 33514,-354.29 33514,-406.29"/>
<text text-anchor="middle" x="33402" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="33402" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="33402" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="33402" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert11 -->
<g id="edge358" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32737.99,-490.7C32885.62,-477.88 33098.08,-454.78 33281,-417.06 33291.95,-414.8 33303.35,-412.02 33314.57,-409.02"/>
<polygon fill="black" stroke="black" points="33315.66,-412.35 33324.38,-406.33 33313.81,-405.6 33315.66,-412.35"/>
</g>
<!-- dp0_pp2_layer10_expert12 -->
<g id="node228" class="node">
<title>dp0_pp2_layer10_expert12</title>
<polygon fill="lightgreen" stroke="black" points="33756,-406.29 33532,-406.29 33532,-354.29 33756,-354.29 33756,-406.29"/>
<text text-anchor="middle" x="33644" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="33644" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="33644" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="33644" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert12 -->
<g id="edge359" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32745.27,-498.07C32941.59,-489.29 33255.95,-468.01 33523,-417.06 33534.43,-414.88 33546.33,-412.06 33558.01,-408.97"/>
<polygon fill="black" stroke="black" points="33559.02,-412.32 33567.75,-406.31 33557.18,-405.57 33559.02,-412.32"/>
</g>
<!-- dp0_pp2_layer10_expert13 -->
<g id="node229" class="node">
<title>dp0_pp2_layer10_expert13</title>
<polygon fill="lightgreen" stroke="black" points="33998,-406.29 33774,-406.29 33774,-354.29 33998,-354.29 33998,-406.29"/>
<text text-anchor="middle" x="33886" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="33886" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="33886" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="33886" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert13 -->
<g id="edge360" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32749.93,-502.93C32990.42,-498.58 33410.9,-481.35 33765,-417.06 33776.62,-414.95 33788.71,-412.14 33800.56,-409.03"/>
<polygon fill="black" stroke="black" points="33801.7,-412.34 33810.44,-406.34 33799.87,-405.59 33801.7,-412.34"/>
</g>
<!-- dp0_pp2_layer10_expert14 -->
<g id="node230" class="node">
<title>dp0_pp2_layer10_expert14</title>
<polygon fill="lightgreen" stroke="black" points="34240,-406.29 34016,-406.29 34016,-354.29 34240,-354.29 34240,-406.29"/>
<text text-anchor="middle" x="34128" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="34128" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="34128" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="34128" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert14 -->
<g id="edge361" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32745.32,-498.04C33082.17,-486.48 33770.15,-458.6 34007,-417.06 34018.92,-414.97 34031.32,-412.12 34043.46,-408.93"/>
<polygon fill="black" stroke="black" points="34044.38,-412.3 34053.11,-406.3 34042.54,-405.55 34044.38,-412.3"/>
</g>
<!-- dp0_pp2_layer10_expert15 -->
<g id="node231" class="node">
<title>dp0_pp2_layer10_expert15</title>
<polygon fill="lightgreen" stroke="black" points="34482,-406.29 34258,-406.29 34258,-354.29 34482,-354.29 34482,-406.29"/>
<text text-anchor="middle" x="34370" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="34370" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="34370" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="34370" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert15 -->
<g id="edge362" class="edge">
<title>dp0_pp2_layer10_router&#45;&gt;dp0_pp2_layer10_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32746.94,-499.9C33127.49,-490.72 33965.35,-465.57 34249,-417.06 34261.01,-415.01 34273.51,-412.16 34285.73,-408.95"/>
<polygon fill="black" stroke="black" points="34286.72,-412.31 34295.45,-406.32 34284.88,-405.56 34286.72,-412.31"/>
</g>
<!-- dp0_pp2_layer10_expert_agg -->
<g id="node232" class="node">
<title>dp0_pp2_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="32802.57,-307.52 32408.74,-307.52 32307.43,-203.52 32701.26,-203.52 32802.57,-307.52"/>
<text text-anchor="middle" x="32555" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="32555" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="32555" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="32555" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer10_expert0&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge363" class="edge">
<title>dp0_pp2_layer10_expert0&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M30798.07,-354.29C30817.69,-346.92 30839.97,-339.72 30861,-335.52 31140.13,-279.86 31963.93,-263.21 32350.43,-258.4"/>
<polygon fill="black" stroke="black" points="32350.65,-261.9 32360.61,-258.27 32350.57,-254.9 32350.65,-261.9"/>
</g>
<!-- dp0_pp2_layer10_expert1&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge364" class="edge">
<title>dp0_pp2_layer10_expert1&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M31040.39,-354.27C31059.95,-346.95 31082.09,-339.78 31103,-335.52 31335.8,-288.16 32011.09,-267.74 32352.43,-260.24"/>
<polygon fill="black" stroke="black" points="32352.51,-263.74 32362.43,-260.03 32352.35,-256.74 32352.51,-263.74"/>
</g>
<!-- dp0_pp2_layer10_expert2&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge365" class="edge">
<title>dp0_pp2_layer10_expert2&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M31282.73,-354.29C31302.21,-347.01 31324.23,-339.87 31345,-335.52 31531.91,-296.44 32061.54,-273.07 32354.3,-262.78"/>
<polygon fill="black" stroke="black" points="32354.74,-266.27 32364.61,-262.42 32354.5,-259.27 32354.74,-266.27"/>
</g>
<!-- dp0_pp2_layer10_expert3&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge366" class="edge">
<title>dp0_pp2_layer10_expert3&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M31525.39,-354.26C31544.72,-347.07 31566.48,-339.99 31587,-335.52 31845.91,-279.18 32151.7,-262.24 32349.26,-257.56"/>
<polygon fill="black" stroke="black" points="32349.55,-261.06 32359.47,-257.33 32349.39,-254.06 32349.55,-261.06"/>
</g>
<!-- dp0_pp2_layer10_expert4&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge367" class="edge">
<title>dp0_pp2_layer10_expert4&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M31768.39,-354.24C31787.49,-347.2 31808.87,-340.19 31829,-335.52 32004.82,-294.77 32209.6,-274.91 32356.75,-265.31"/>
<polygon fill="black" stroke="black" points="32357.05,-268.8 32366.81,-264.67 32356.6,-261.82 32357.05,-268.8"/>
</g>
<!-- dp0_pp2_layer10_expert5&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge368" class="edge">
<title>dp0_pp2_layer10_expert5&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M32012.42,-354.22C32031.04,-347.42 32051.65,-340.55 32071,-335.52 32168.09,-310.27 32278.34,-291.53 32369.07,-278.65"/>
<polygon fill="black" stroke="black" points="32369.78,-282.09 32379.19,-277.23 32368.8,-275.16 32369.78,-282.09"/>
</g>
<!-- dp0_pp2_layer10_expert6&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge369" class="edge">
<title>dp0_pp2_layer10_expert6&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M32260.02,-354.26C32277.26,-348.03 32295.78,-341.44 32313,-335.52 32339.73,-326.33 32368.21,-316.8 32395.89,-307.67"/>
<polygon fill="black" stroke="black" points="32397.24,-310.91 32405.65,-304.46 32395.06,-304.26 32397.24,-310.91"/>
</g>
<!-- dp0_pp2_layer10_expert7&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge370" class="edge">
<title>dp0_pp2_layer10_expert7&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M32458.78,-354.15C32470.02,-342.74 32483.83,-328.73 32497.45,-314.92"/>
<polygon fill="black" stroke="black" points="32500,-317.31 32504.53,-307.73 32495.02,-312.39 32500,-317.31"/>
</g>
<!-- dp0_pp2_layer10_expert8&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge371" class="edge">
<title>dp0_pp2_layer10_expert8&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M32651.22,-354.15C32639.97,-342.74 32626.16,-328.73 32612.55,-314.92"/>
<polygon fill="black" stroke="black" points="32614.98,-312.39 32605.47,-307.73 32609.99,-317.31 32614.98,-312.39"/>
</g>
<!-- dp0_pp2_layer10_expert9&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge372" class="edge">
<title>dp0_pp2_layer10_expert9&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M32849.98,-354.26C32832.73,-348.03 32814.21,-341.44 32797,-335.52 32773.29,-327.37 32748.21,-318.95 32723.53,-310.78"/>
<polygon fill="black" stroke="black" points="32724.32,-307.36 32713.73,-307.54 32722.12,-314 32724.32,-307.36"/>
</g>
<!-- dp0_pp2_layer10_expert10&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge373" class="edge">
<title>dp0_pp2_layer10_expert10&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M33097.58,-354.22C33078.96,-347.42 33058.35,-340.55 33039,-335.52 32958.99,-314.71 32870.05,-298.33 32790.46,-286"/>
<polygon fill="black" stroke="black" points="32790.71,-282.5 32780.3,-284.44 32789.65,-289.41 32790.71,-282.5"/>
</g>
<!-- dp0_pp2_layer10_expert11&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge374" class="edge">
<title>dp0_pp2_layer10_expert11&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M33341.61,-354.24C33322.51,-347.2 33301.13,-340.19 33281,-335.52 33112.74,-296.53 32917.97,-276.66 32772.55,-266.61"/>
<polygon fill="black" stroke="black" points="32772.38,-263.09 32762.16,-265.9 32771.9,-270.07 32772.38,-263.09"/>
</g>
<!-- dp0_pp2_layer10_expert12&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge375" class="edge">
<title>dp0_pp2_layer10_expert12&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M33584.61,-354.26C33565.28,-347.07 33543.52,-339.99 33523,-335.52 33265.51,-279.49 32961.64,-262.43 32763.99,-257.64"/>
<polygon fill="black" stroke="black" points="32763.86,-254.14 32753.78,-257.4 32763.69,-261.13 32763.86,-254.14"/>
</g>
<!-- dp0_pp2_layer10_expert13&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge376" class="edge">
<title>dp0_pp2_layer10_expert13&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M33827.27,-354.29C33807.79,-347.01 33785.77,-339.87 33765,-335.52 33581.02,-297.05 33064.97,-273.81 32769.63,-263.27"/>
<polygon fill="black" stroke="black" points="32769.33,-259.76 32759.21,-262.9 32769.08,-266.76 32769.33,-259.76"/>
</g>
<!-- dp0_pp2_layer10_expert14&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge377" class="edge">
<title>dp0_pp2_layer10_expert14&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M34069.6,-354.27C34050.05,-346.95 34027.9,-339.78 34007,-335.52 33776.27,-288.58 33110.86,-268.1 32766.74,-260.45"/>
<polygon fill="black" stroke="black" points="32766.73,-256.94 32756.65,-260.22 32766.57,-263.94 32766.73,-256.94"/>
</g>
<!-- dp0_pp2_layer10_expert15&#45;&gt;dp0_pp2_layer10_expert_agg -->
<g id="edge378" class="edge">
<title>dp0_pp2_layer10_expert15&#45;&gt;dp0_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M34311.93,-354.29C34292.3,-346.92 34270.03,-339.72 34249,-335.52 33971.21,-280.12 33153.98,-263.37 32765.17,-258.47"/>
<polygon fill="black" stroke="black" points="32764.97,-254.97 32754.93,-258.34 32764.88,-261.97 32764.97,-254.97"/>
</g>
<!-- dp0_pp2_layer11_attn_tp0 -->
<g id="node233" class="node">
<title>dp0_pp2_layer11_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="30037.5,-531.06 29772.5,-531.06 29772.5,-479.06 30037.5,-479.06 30037.5,-531.06"/>
<text text-anchor="middle" x="29905" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="29905" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="29905" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="29905" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer10_expert_agg&#45;&gt;dp0_pp2_layer11_attn_tp0 -->
<g id="edge380" class="edge">
<title>dp0_pp2_layer10_expert_agg&#45;&gt;dp0_pp2_layer11_attn_tp0</title>
<path fill="none" stroke="black" d="M32362.78,-260.41C31942.38,-269.54 30952.17,-294.77 30619,-335.52 30586.8,-339.46 30078.23,-444.29 30047,-453.06 30024.37,-459.41 30000.16,-467.58 29978.26,-475.5"/>
<polygon fill="black" stroke="black" points="29976.89,-472.28 29968.7,-479 29979.29,-478.85 29976.89,-472.28"/>
</g>
<!-- dp0_pp2_layer11_attn_allreduce -->
<g id="node234" class="node">
<title>dp0_pp2_layer11_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="30034" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="30034" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="30034" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="30034" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="30034" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_attn_tp0&#45;&gt;dp0_pp2_layer11_attn_allreduce -->
<g id="edge381" class="edge">
<title>dp0_pp2_layer11_attn_tp0&#45;&gt;dp0_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M29931.41,-478.92C29948.15,-463 29970.21,-442 29989.58,-423.56"/>
<polygon fill="black" stroke="black" points="29992.03,-426.07 29996.86,-416.64 29987.2,-421 29992.03,-426.07"/>
</g>
<!-- dp0_pp2_layer11_router -->
<g id="node238" class="node">
<title>dp0_pp2_layer11_router</title>
<polygon fill="lightyellow" stroke="black" points="27785.57,-557.06 27391.74,-557.06 27290.43,-453.06 27684.26,-453.06 27785.57,-557.06"/>
<text text-anchor="middle" x="27538" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="27538" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="27538" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="27538" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_attn_allreduce&#45;&gt;dp0_pp2_layer11_router -->
<g id="edge417" class="edge">
<title>dp0_pp2_layer11_attn_allreduce&#45;&gt;dp0_pp2_layer11_router</title>
<path fill="none" stroke="black" d="M29874.08,-392.38C29762.77,-399.9 29610.89,-409.76 29477,-417.06 28841.5,-451.72 28088.28,-482.59 27736.96,-496.4"/>
<polygon fill="black" stroke="black" points="27736.8,-492.91 27726.94,-496.79 27737.07,-499.9 27736.8,-492.91"/>
</g>
<!-- dp0_pp2_layer11_attn_tp1 -->
<g id="node235" class="node">
<title>dp0_pp2_layer11_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="30320.5,-531.06 30055.5,-531.06 30055.5,-479.06 30320.5,-479.06 30320.5,-531.06"/>
<text text-anchor="middle" x="30188" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="30188" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="30188" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="30188" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer11_attn_tp1&#45;&gt;dp0_pp2_layer11_attn_allreduce -->
<g id="edge382" class="edge">
<title>dp0_pp2_layer11_attn_tp1&#45;&gt;dp0_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M30156.46,-478.92C30135.99,-462.6 30108.83,-440.94 30085.29,-422.18"/>
<polygon fill="black" stroke="black" points="30087.46,-419.44 30077.46,-415.94 30083.1,-424.91 30087.46,-419.44"/>
</g>
<!-- dp0_pp2_layer11_attn_tp2 -->
<g id="node236" class="node">
<title>dp0_pp2_layer11_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="29754.5,-531.06 29489.5,-531.06 29489.5,-479.06 29754.5,-479.06 29754.5,-531.06"/>
<text text-anchor="middle" x="29622" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="29622" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="29622" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="29622" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer11_attn_tp2&#45;&gt;dp0_pp2_layer11_attn_allreduce -->
<g id="edge383" class="edge">
<title>dp0_pp2_layer11_attn_tp2&#45;&gt;dp0_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M29688.07,-479.02C29711.85,-470.35 29738.99,-460.86 29764,-453.06 29812.74,-437.86 29867.05,-423.03 29914.1,-410.83"/>
<polygon fill="black" stroke="black" points="29915.22,-414.15 29924.03,-408.26 29913.47,-407.38 29915.22,-414.15"/>
</g>
<!-- dp0_pp2_layer11_attn_tp3 -->
<g id="node237" class="node">
<title>dp0_pp2_layer11_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="30603.5,-531.06 30338.5,-531.06 30338.5,-479.06 30603.5,-479.06 30603.5,-531.06"/>
<text text-anchor="middle" x="30471" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="30471" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="30471" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="30471" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer11_attn_tp3&#45;&gt;dp0_pp2_layer11_attn_allreduce -->
<g id="edge384" class="edge">
<title>dp0_pp2_layer11_attn_tp3&#45;&gt;dp0_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M30406.21,-478.95C30382.43,-470.18 30355.17,-460.64 30330,-453.06 30275.42,-436.63 30214.31,-421.31 30161.86,-409.08"/>
<polygon fill="black" stroke="black" points="30162.37,-405.6 30151.83,-406.75 30160.78,-412.42 30162.37,-405.6"/>
</g>
<!-- dp0_pp2_layer11_expert0 -->
<g id="node239" class="node">
<title>dp0_pp2_layer11_expert0</title>
<polygon fill="lightgreen" stroke="black" points="25835,-406.29 25611,-406.29 25611,-354.29 25835,-354.29 25835,-406.29"/>
<text text-anchor="middle" x="25723" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="25723" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="25723" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="25723" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert0 -->
<g id="edge385" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27335.73,-499.65C26950.55,-490.26 26125.11,-465.13 25844,-417.06 25831.99,-415.01 25819.48,-412.16 25807.27,-408.95"/>
<polygon fill="black" stroke="black" points="25808.11,-405.56 25797.54,-406.32 25806.28,-412.31 25808.11,-405.56"/>
</g>
<!-- dp0_pp2_layer11_expert1 -->
<g id="node240" class="node">
<title>dp0_pp2_layer11_expert1</title>
<polygon fill="lightgreen" stroke="black" points="26077,-406.29 25853,-406.29 25853,-354.29 26077,-354.29 26077,-406.29"/>
<text text-anchor="middle" x="25965" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="25965" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="25965" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="25965" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert1 -->
<g id="edge386" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27333.55,-497.55C26991.94,-485.71 26319.58,-458.03 26086,-417.06 26074.08,-414.97 26061.67,-412.12 26049.54,-408.93"/>
<polygon fill="black" stroke="black" points="26050.45,-405.55 26039.89,-406.3 26048.62,-412.3 26050.45,-405.55"/>
</g>
<!-- dp0_pp2_layer11_expert2 -->
<g id="node241" class="node">
<title>dp0_pp2_layer11_expert2</title>
<polygon fill="lightgreen" stroke="black" points="26319,-406.29 26095,-406.29 26095,-354.29 26319,-354.29 26319,-406.29"/>
<text text-anchor="middle" x="26207" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="26207" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="26207" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="26207" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert2 -->
<g id="edge387" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27338.82,-502.85C27097.66,-498.37 26680.02,-480.97 26328,-417.06 26316.38,-414.95 26304.29,-412.14 26292.44,-409.03"/>
<polygon fill="black" stroke="black" points="26293.13,-405.59 26282.56,-406.34 26291.29,-412.34 26293.13,-405.59"/>
</g>
<!-- dp0_pp2_layer11_expert3 -->
<g id="node242" class="node">
<title>dp0_pp2_layer11_expert3</title>
<polygon fill="lightgreen" stroke="black" points="26561,-406.29 26337,-406.29 26337,-354.29 26561,-354.29 26561,-406.29"/>
<text text-anchor="middle" x="26449" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="26449" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="26449" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="26449" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert3 -->
<g id="edge388" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27333.36,-497.41C27136.31,-488.25 26830.63,-466.79 26570,-417.06 26558.57,-414.88 26546.67,-412.06 26534.99,-408.97"/>
<polygon fill="black" stroke="black" points="26535.82,-405.57 26525.25,-406.31 26533.98,-412.32 26535.82,-405.57"/>
</g>
<!-- dp0_pp2_layer11_expert4 -->
<g id="node243" class="node">
<title>dp0_pp2_layer11_expert4</title>
<polygon fill="lightgreen" stroke="black" points="26803,-406.29 26579,-406.29 26579,-354.29 26803,-354.29 26803,-406.29"/>
<text text-anchor="middle" x="26691" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="26691" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="26691" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="26691" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert4 -->
<g id="edge389" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27324.43,-487.98C27178.99,-474.71 26982.64,-452.25 26812,-417.06 26801.05,-414.8 26789.65,-412.02 26778.43,-409.02"/>
<polygon fill="black" stroke="black" points="26779.19,-405.6 26768.62,-406.33 26777.34,-412.35 26779.19,-405.6"/>
</g>
<!-- dp0_pp2_layer11_expert5 -->
<g id="node244" class="node">
<title>dp0_pp2_layer11_expert5</title>
<polygon fill="lightgreen" stroke="black" points="27045,-406.29 26821,-406.29 26821,-354.29 27045,-354.29 27045,-406.29"/>
<text text-anchor="middle" x="26933" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="26933" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="26933" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="26933" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert5 -->
<g id="edge390" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27304.29,-467.38C27224.5,-453.44 27135,-436.25 27054,-417.06 27043.9,-414.67 27033.4,-411.94 27022.99,-409.07"/>
<polygon fill="black" stroke="black" points="27023.62,-405.62 27013.05,-406.3 27021.74,-412.36 27023.62,-405.62"/>
</g>
<!-- dp0_pp2_layer11_expert6 -->
<g id="node245" class="node">
<title>dp0_pp2_layer11_expert6</title>
<polygon fill="lightgreen" stroke="black" points="27287,-406.29 27063,-406.29 27063,-354.29 27287,-354.29 27287,-406.29"/>
<text text-anchor="middle" x="27175" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="27175" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="27175" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="27175" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert6 -->
<g id="edge391" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27386.94,-452.97C27343.16,-438.16 27296.94,-422.53 27258.87,-409.66"/>
<polygon fill="black" stroke="black" points="27259.97,-406.33 27249.38,-406.45 27257.73,-412.97 27259.97,-406.33"/>
</g>
<!-- dp0_pp2_layer11_expert7 -->
<g id="node246" class="node">
<title>dp0_pp2_layer11_expert7</title>
<polygon fill="lightgreen" stroke="black" points="27529,-406.29 27305,-406.29 27305,-354.29 27529,-354.29 27529,-406.29"/>
<text text-anchor="middle" x="27417" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="27417" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="27417" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="27417" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert7 -->
<g id="edge392" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27487.38,-452.71C27474.3,-439.43 27460.58,-425.51 27448.76,-413.52"/>
<polygon fill="black" stroke="black" points="27451.19,-411 27441.68,-406.33 27446.2,-415.91 27451.19,-411"/>
</g>
<!-- dp0_pp2_layer11_expert8 -->
<g id="node247" class="node">
<title>dp0_pp2_layer11_expert8</title>
<polygon fill="lightgreen" stroke="black" points="27771,-406.29 27547,-406.29 27547,-354.29 27771,-354.29 27771,-406.29"/>
<text text-anchor="middle" x="27659" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="27659" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="27659" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="27659" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert8 -->
<g id="edge393" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27588.61,-452.71C27601.7,-439.43 27615.42,-425.51 27627.23,-413.52"/>
<polygon fill="black" stroke="black" points="27629.79,-415.91 27634.32,-406.33 27624.81,-411 27629.79,-415.91"/>
</g>
<!-- dp0_pp2_layer11_expert9 -->
<g id="node248" class="node">
<title>dp0_pp2_layer11_expert9</title>
<polygon fill="lightgreen" stroke="black" points="28013,-406.29 27789,-406.29 27789,-354.29 28013,-354.29 28013,-406.29"/>
<text text-anchor="middle" x="27901" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="27901" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="27901" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="27901" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert9 -->
<g id="edge394" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27685.38,-454.21C27730.29,-439.03 27778.08,-422.86 27817.23,-409.62"/>
<polygon fill="black" stroke="black" points="27818.64,-412.84 27826.99,-406.32 27816.4,-406.21 27818.64,-412.84"/>
</g>
<!-- dp0_pp2_layer11_expert10 -->
<g id="node249" class="node">
<title>dp0_pp2_layer11_expert10</title>
<polygon fill="lightgreen" stroke="black" points="28255,-406.29 28031,-406.29 28031,-354.29 28255,-354.29 28255,-406.29"/>
<text text-anchor="middle" x="28143" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="28143" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="28143" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="28143" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert10 -->
<g id="edge395" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27708.89,-478.04C27801.98,-462.69 27918.88,-441.49 28022,-417.06 28032.09,-414.67 28042.6,-411.94 28053.01,-409.07"/>
<polygon fill="black" stroke="black" points="28054.26,-412.36 28062.95,-406.3 28052.37,-405.62 28054.26,-412.36"/>
</g>
<!-- dp0_pp2_layer11_expert11 -->
<g id="node250" class="node">
<title>dp0_pp2_layer11_expert11</title>
<polygon fill="lightgreen" stroke="black" points="28497,-406.29 28273,-406.29 28273,-354.29 28497,-354.29 28497,-406.29"/>
<text text-anchor="middle" x="28385" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="28385" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="28385" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="28385" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert11 -->
<g id="edge396" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27720.99,-490.7C27868.62,-477.88 28081.08,-454.78 28264,-417.06 28274.95,-414.8 28286.35,-412.02 28297.57,-409.02"/>
<polygon fill="black" stroke="black" points="28298.66,-412.35 28307.38,-406.33 28296.81,-405.6 28298.66,-412.35"/>
</g>
<!-- dp0_pp2_layer11_expert12 -->
<g id="node251" class="node">
<title>dp0_pp2_layer11_expert12</title>
<polygon fill="lightgreen" stroke="black" points="28739,-406.29 28515,-406.29 28515,-354.29 28739,-354.29 28739,-406.29"/>
<text text-anchor="middle" x="28627" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="28627" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="28627" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="28627" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert12 -->
<g id="edge397" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27728.27,-498.07C27924.59,-489.29 28238.95,-468.01 28506,-417.06 28517.43,-414.88 28529.33,-412.06 28541.01,-408.97"/>
<polygon fill="black" stroke="black" points="28542.02,-412.32 28550.75,-406.31 28540.18,-405.57 28542.02,-412.32"/>
</g>
<!-- dp0_pp2_layer11_expert13 -->
<g id="node252" class="node">
<title>dp0_pp2_layer11_expert13</title>
<polygon fill="lightgreen" stroke="black" points="28981,-406.29 28757,-406.29 28757,-354.29 28981,-354.29 28981,-406.29"/>
<text text-anchor="middle" x="28869" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="28869" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="28869" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="28869" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert13 -->
<g id="edge398" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27732.93,-502.93C27973.42,-498.58 28393.9,-481.35 28748,-417.06 28759.62,-414.95 28771.71,-412.14 28783.56,-409.03"/>
<polygon fill="black" stroke="black" points="28784.7,-412.34 28793.44,-406.34 28782.87,-405.59 28784.7,-412.34"/>
</g>
<!-- dp0_pp2_layer11_expert14 -->
<g id="node253" class="node">
<title>dp0_pp2_layer11_expert14</title>
<polygon fill="lightgreen" stroke="black" points="29223,-406.29 28999,-406.29 28999,-354.29 29223,-354.29 29223,-406.29"/>
<text text-anchor="middle" x="29111" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="29111" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="29111" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="29111" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert14 -->
<g id="edge399" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27728.32,-498.04C28065.17,-486.48 28753.15,-458.6 28990,-417.06 29001.92,-414.97 29014.32,-412.12 29026.46,-408.93"/>
<polygon fill="black" stroke="black" points="29027.38,-412.3 29036.11,-406.3 29025.54,-405.55 29027.38,-412.3"/>
</g>
<!-- dp0_pp2_layer11_expert15 -->
<g id="node254" class="node">
<title>dp0_pp2_layer11_expert15</title>
<polygon fill="lightgreen" stroke="black" points="29465,-406.29 29241,-406.29 29241,-354.29 29465,-354.29 29465,-406.29"/>
<text text-anchor="middle" x="29353" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="29353" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="29353" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="29353" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert15 -->
<g id="edge400" class="edge">
<title>dp0_pp2_layer11_router&#45;&gt;dp0_pp2_layer11_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27729.94,-499.9C28110.49,-490.72 28948.35,-465.57 29232,-417.06 29244.01,-415.01 29256.51,-412.16 29268.73,-408.95"/>
<polygon fill="black" stroke="black" points="29269.72,-412.31 29278.45,-406.32 29267.88,-405.56 29269.72,-412.31"/>
</g>
<!-- dp0_pp2_layer11_expert_agg -->
<g id="node255" class="node">
<title>dp0_pp2_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="27785.57,-307.52 27391.74,-307.52 27290.43,-203.52 27684.26,-203.52 27785.57,-307.52"/>
<text text-anchor="middle" x="27538" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="27538" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="27538" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="27538" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer11_expert0&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge401" class="edge">
<title>dp0_pp2_layer11_expert0&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M25781.07,-354.29C25800.69,-346.92 25822.97,-339.72 25844,-335.52 26123.13,-279.86 26946.93,-263.21 27333.43,-258.4"/>
<polygon fill="black" stroke="black" points="27333.65,-261.9 27343.61,-258.27 27333.57,-254.9 27333.65,-261.9"/>
</g>
<!-- dp0_pp2_layer11_expert1&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge402" class="edge">
<title>dp0_pp2_layer11_expert1&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M26023.39,-354.27C26042.95,-346.95 26065.09,-339.78 26086,-335.52 26318.8,-288.16 26994.09,-267.74 27335.43,-260.24"/>
<polygon fill="black" stroke="black" points="27335.51,-263.74 27345.43,-260.03 27335.35,-256.74 27335.51,-263.74"/>
</g>
<!-- dp0_pp2_layer11_expert2&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge403" class="edge">
<title>dp0_pp2_layer11_expert2&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M26265.73,-354.29C26285.21,-347.01 26307.23,-339.87 26328,-335.52 26514.91,-296.44 27044.54,-273.07 27337.3,-262.78"/>
<polygon fill="black" stroke="black" points="27337.74,-266.27 27347.61,-262.42 27337.5,-259.27 27337.74,-266.27"/>
</g>
<!-- dp0_pp2_layer11_expert3&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge404" class="edge">
<title>dp0_pp2_layer11_expert3&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M26508.39,-354.26C26527.72,-347.07 26549.48,-339.99 26570,-335.52 26828.91,-279.18 27134.7,-262.24 27332.26,-257.56"/>
<polygon fill="black" stroke="black" points="27332.55,-261.06 27342.47,-257.33 27332.39,-254.06 27332.55,-261.06"/>
</g>
<!-- dp0_pp2_layer11_expert4&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge405" class="edge">
<title>dp0_pp2_layer11_expert4&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M26751.39,-354.24C26770.49,-347.2 26791.87,-340.19 26812,-335.52 26987.82,-294.77 27192.6,-274.91 27339.75,-265.31"/>
<polygon fill="black" stroke="black" points="27340.05,-268.8 27349.81,-264.67 27339.6,-261.82 27340.05,-268.8"/>
</g>
<!-- dp0_pp2_layer11_expert5&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge406" class="edge">
<title>dp0_pp2_layer11_expert5&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M26995.42,-354.22C27014.04,-347.42 27034.65,-340.55 27054,-335.52 27151.09,-310.27 27261.34,-291.53 27352.07,-278.65"/>
<polygon fill="black" stroke="black" points="27352.78,-282.09 27362.19,-277.23 27351.8,-275.16 27352.78,-282.09"/>
</g>
<!-- dp0_pp2_layer11_expert6&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge407" class="edge">
<title>dp0_pp2_layer11_expert6&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M27243.02,-354.26C27260.26,-348.03 27278.78,-341.44 27296,-335.52 27322.73,-326.33 27351.21,-316.8 27378.89,-307.67"/>
<polygon fill="black" stroke="black" points="27380.24,-310.91 27388.65,-304.46 27378.06,-304.26 27380.24,-310.91"/>
</g>
<!-- dp0_pp2_layer11_expert7&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge408" class="edge">
<title>dp0_pp2_layer11_expert7&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M27441.78,-354.15C27453.02,-342.74 27466.83,-328.73 27480.45,-314.92"/>
<polygon fill="black" stroke="black" points="27483,-317.31 27487.53,-307.73 27478.02,-312.39 27483,-317.31"/>
</g>
<!-- dp0_pp2_layer11_expert8&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge409" class="edge">
<title>dp0_pp2_layer11_expert8&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M27634.22,-354.15C27622.97,-342.74 27609.16,-328.73 27595.55,-314.92"/>
<polygon fill="black" stroke="black" points="27597.98,-312.39 27588.47,-307.73 27592.99,-317.31 27597.98,-312.39"/>
</g>
<!-- dp0_pp2_layer11_expert9&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge410" class="edge">
<title>dp0_pp2_layer11_expert9&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M27832.98,-354.26C27815.73,-348.03 27797.21,-341.44 27780,-335.52 27756.29,-327.37 27731.21,-318.95 27706.53,-310.78"/>
<polygon fill="black" stroke="black" points="27707.32,-307.36 27696.73,-307.54 27705.12,-314 27707.32,-307.36"/>
</g>
<!-- dp0_pp2_layer11_expert10&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge411" class="edge">
<title>dp0_pp2_layer11_expert10&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M28080.58,-354.22C28061.96,-347.42 28041.35,-340.55 28022,-335.52 27941.99,-314.71 27853.05,-298.33 27773.46,-286"/>
<polygon fill="black" stroke="black" points="27773.71,-282.5 27763.3,-284.44 27772.65,-289.41 27773.71,-282.5"/>
</g>
<!-- dp0_pp2_layer11_expert11&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge412" class="edge">
<title>dp0_pp2_layer11_expert11&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M28324.61,-354.24C28305.51,-347.2 28284.13,-340.19 28264,-335.52 28095.74,-296.53 27900.97,-276.66 27755.55,-266.61"/>
<polygon fill="black" stroke="black" points="27755.38,-263.09 27745.16,-265.9 27754.9,-270.07 27755.38,-263.09"/>
</g>
<!-- dp0_pp2_layer11_expert12&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge413" class="edge">
<title>dp0_pp2_layer11_expert12&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M28567.61,-354.26C28548.28,-347.07 28526.52,-339.99 28506,-335.52 28248.51,-279.49 27944.64,-262.43 27746.99,-257.64"/>
<polygon fill="black" stroke="black" points="27746.86,-254.14 27736.78,-257.4 27746.69,-261.13 27746.86,-254.14"/>
</g>
<!-- dp0_pp2_layer11_expert13&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge414" class="edge">
<title>dp0_pp2_layer11_expert13&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M28810.27,-354.29C28790.79,-347.01 28768.77,-339.87 28748,-335.52 28564.02,-297.05 28047.97,-273.81 27752.63,-263.27"/>
<polygon fill="black" stroke="black" points="27752.33,-259.76 27742.21,-262.9 27752.08,-266.76 27752.33,-259.76"/>
</g>
<!-- dp0_pp2_layer11_expert14&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge415" class="edge">
<title>dp0_pp2_layer11_expert14&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M29052.6,-354.27C29033.05,-346.95 29010.9,-339.78 28990,-335.52 28759.27,-288.58 28093.86,-268.1 27749.74,-260.45"/>
<polygon fill="black" stroke="black" points="27749.73,-256.94 27739.65,-260.22 27749.57,-263.94 27749.73,-256.94"/>
</g>
<!-- dp0_pp2_layer11_expert15&#45;&gt;dp0_pp2_layer11_expert_agg -->
<g id="edge416" class="edge">
<title>dp0_pp2_layer11_expert15&#45;&gt;dp0_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M29294.93,-354.29C29275.3,-346.92 29253.03,-339.72 29232,-335.52 28954.21,-280.12 28136.98,-263.37 27748.17,-258.47"/>
<polygon fill="black" stroke="black" points="27747.97,-254.97 27737.93,-258.34 27747.88,-261.97 27747.97,-254.97"/>
</g>
<!-- dp0_pp2_layer12_attn_tp0 -->
<g id="node256" class="node">
<title>dp0_pp2_layer12_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="25020.5,-531.06 24755.5,-531.06 24755.5,-479.06 25020.5,-479.06 25020.5,-531.06"/>
<text text-anchor="middle" x="24888" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="24888" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="24888" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="24888" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer11_expert_agg&#45;&gt;dp0_pp2_layer12_attn_tp0 -->
<g id="edge418" class="edge">
<title>dp0_pp2_layer11_expert_agg&#45;&gt;dp0_pp2_layer12_attn_tp0</title>
<path fill="none" stroke="black" d="M27345.78,-260.41C26925.38,-269.54 25935.17,-294.77 25602,-335.52 25569.8,-339.46 25061.23,-444.29 25030,-453.06 25007.37,-459.41 24983.16,-467.58 24961.26,-475.5"/>
<polygon fill="black" stroke="black" points="24959.89,-472.28 24951.7,-479 24962.29,-478.85 24959.89,-472.28"/>
</g>
<!-- dp0_pp2_layer12_attn_allreduce -->
<g id="node257" class="node">
<title>dp0_pp2_layer12_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="25017" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="25017" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="25017" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="25017" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="25017" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_attn_tp0&#45;&gt;dp0_pp2_layer12_attn_allreduce -->
<g id="edge419" class="edge">
<title>dp0_pp2_layer12_attn_tp0&#45;&gt;dp0_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M24914.41,-478.92C24931.15,-463 24953.21,-442 24972.58,-423.56"/>
<polygon fill="black" stroke="black" points="24975.03,-426.07 24979.86,-416.64 24970.2,-421 24975.03,-426.07"/>
</g>
<!-- dp0_pp2_layer12_router -->
<g id="node261" class="node">
<title>dp0_pp2_layer12_router</title>
<polygon fill="lightyellow" stroke="black" points="22768.57,-557.06 22374.74,-557.06 22273.43,-453.06 22667.26,-453.06 22768.57,-557.06"/>
<text text-anchor="middle" x="22521" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="22521" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="22521" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="22521" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_attn_allreduce&#45;&gt;dp0_pp2_layer12_router -->
<g id="edge455" class="edge">
<title>dp0_pp2_layer12_attn_allreduce&#45;&gt;dp0_pp2_layer12_router</title>
<path fill="none" stroke="black" d="M24857.08,-392.38C24745.77,-399.9 24593.89,-409.76 24460,-417.06 23824.5,-451.72 23071.28,-482.59 22719.96,-496.4"/>
<polygon fill="black" stroke="black" points="22719.8,-492.91 22709.94,-496.79 22720.07,-499.9 22719.8,-492.91"/>
</g>
<!-- dp0_pp2_layer12_attn_tp1 -->
<g id="node258" class="node">
<title>dp0_pp2_layer12_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="25303.5,-531.06 25038.5,-531.06 25038.5,-479.06 25303.5,-479.06 25303.5,-531.06"/>
<text text-anchor="middle" x="25171" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="25171" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="25171" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="25171" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer12_attn_tp1&#45;&gt;dp0_pp2_layer12_attn_allreduce -->
<g id="edge420" class="edge">
<title>dp0_pp2_layer12_attn_tp1&#45;&gt;dp0_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M25139.46,-478.92C25118.99,-462.6 25091.83,-440.94 25068.29,-422.18"/>
<polygon fill="black" stroke="black" points="25070.46,-419.44 25060.46,-415.94 25066.1,-424.91 25070.46,-419.44"/>
</g>
<!-- dp0_pp2_layer12_attn_tp2 -->
<g id="node259" class="node">
<title>dp0_pp2_layer12_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="24737.5,-531.06 24472.5,-531.06 24472.5,-479.06 24737.5,-479.06 24737.5,-531.06"/>
<text text-anchor="middle" x="24605" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="24605" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="24605" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="24605" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer12_attn_tp2&#45;&gt;dp0_pp2_layer12_attn_allreduce -->
<g id="edge421" class="edge">
<title>dp0_pp2_layer12_attn_tp2&#45;&gt;dp0_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M24671.07,-479.02C24694.85,-470.35 24721.99,-460.86 24747,-453.06 24795.74,-437.86 24850.05,-423.03 24897.1,-410.83"/>
<polygon fill="black" stroke="black" points="24898.22,-414.15 24907.03,-408.26 24896.47,-407.38 24898.22,-414.15"/>
</g>
<!-- dp0_pp2_layer12_attn_tp3 -->
<g id="node260" class="node">
<title>dp0_pp2_layer12_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="25586.5,-531.06 25321.5,-531.06 25321.5,-479.06 25586.5,-479.06 25586.5,-531.06"/>
<text text-anchor="middle" x="25454" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="25454" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="25454" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="25454" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer12_attn_tp3&#45;&gt;dp0_pp2_layer12_attn_allreduce -->
<g id="edge422" class="edge">
<title>dp0_pp2_layer12_attn_tp3&#45;&gt;dp0_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M25389.21,-478.95C25365.43,-470.18 25338.17,-460.64 25313,-453.06 25258.42,-436.63 25197.31,-421.31 25144.86,-409.08"/>
<polygon fill="black" stroke="black" points="25145.37,-405.6 25134.83,-406.75 25143.78,-412.42 25145.37,-405.6"/>
</g>
<!-- dp0_pp2_layer12_expert0 -->
<g id="node262" class="node">
<title>dp0_pp2_layer12_expert0</title>
<polygon fill="lightgreen" stroke="black" points="20818,-406.29 20594,-406.29 20594,-354.29 20818,-354.29 20818,-406.29"/>
<text text-anchor="middle" x="20706" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="20706" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="20706" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="20706" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert0 -->
<g id="edge423" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22318.73,-499.65C21933.55,-490.26 21108.11,-465.13 20827,-417.06 20814.99,-415.01 20802.48,-412.16 20790.27,-408.95"/>
<polygon fill="black" stroke="black" points="20791.11,-405.56 20780.54,-406.32 20789.28,-412.31 20791.11,-405.56"/>
</g>
<!-- dp0_pp2_layer12_expert1 -->
<g id="node263" class="node">
<title>dp0_pp2_layer12_expert1</title>
<polygon fill="lightgreen" stroke="black" points="21060,-406.29 20836,-406.29 20836,-354.29 21060,-354.29 21060,-406.29"/>
<text text-anchor="middle" x="20948" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="20948" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="20948" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="20948" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert1 -->
<g id="edge424" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22316.55,-497.55C21974.94,-485.71 21302.58,-458.03 21069,-417.06 21057.08,-414.97 21044.67,-412.12 21032.54,-408.93"/>
<polygon fill="black" stroke="black" points="21033.45,-405.55 21022.89,-406.3 21031.62,-412.3 21033.45,-405.55"/>
</g>
<!-- dp0_pp2_layer12_expert2 -->
<g id="node264" class="node">
<title>dp0_pp2_layer12_expert2</title>
<polygon fill="lightgreen" stroke="black" points="21302,-406.29 21078,-406.29 21078,-354.29 21302,-354.29 21302,-406.29"/>
<text text-anchor="middle" x="21190" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="21190" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="21190" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="21190" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert2 -->
<g id="edge425" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22321.82,-502.85C22080.66,-498.37 21663.02,-480.97 21311,-417.06 21299.38,-414.95 21287.29,-412.14 21275.44,-409.03"/>
<polygon fill="black" stroke="black" points="21276.13,-405.59 21265.56,-406.34 21274.29,-412.34 21276.13,-405.59"/>
</g>
<!-- dp0_pp2_layer12_expert3 -->
<g id="node265" class="node">
<title>dp0_pp2_layer12_expert3</title>
<polygon fill="lightgreen" stroke="black" points="21544,-406.29 21320,-406.29 21320,-354.29 21544,-354.29 21544,-406.29"/>
<text text-anchor="middle" x="21432" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="21432" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="21432" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="21432" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert3 -->
<g id="edge426" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22316.36,-497.41C22119.31,-488.25 21813.63,-466.79 21553,-417.06 21541.57,-414.88 21529.67,-412.06 21517.99,-408.97"/>
<polygon fill="black" stroke="black" points="21518.82,-405.57 21508.25,-406.31 21516.98,-412.32 21518.82,-405.57"/>
</g>
<!-- dp0_pp2_layer12_expert4 -->
<g id="node266" class="node">
<title>dp0_pp2_layer12_expert4</title>
<polygon fill="lightgreen" stroke="black" points="21786,-406.29 21562,-406.29 21562,-354.29 21786,-354.29 21786,-406.29"/>
<text text-anchor="middle" x="21674" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="21674" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="21674" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="21674" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert4 -->
<g id="edge427" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22307.43,-487.98C22161.99,-474.71 21965.64,-452.25 21795,-417.06 21784.05,-414.8 21772.65,-412.02 21761.43,-409.02"/>
<polygon fill="black" stroke="black" points="21762.19,-405.6 21751.62,-406.33 21760.34,-412.35 21762.19,-405.6"/>
</g>
<!-- dp0_pp2_layer12_expert5 -->
<g id="node267" class="node">
<title>dp0_pp2_layer12_expert5</title>
<polygon fill="lightgreen" stroke="black" points="22028,-406.29 21804,-406.29 21804,-354.29 22028,-354.29 22028,-406.29"/>
<text text-anchor="middle" x="21916" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="21916" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="21916" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="21916" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert5 -->
<g id="edge428" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22287.29,-467.38C22207.5,-453.44 22118,-436.25 22037,-417.06 22026.9,-414.67 22016.4,-411.94 22005.99,-409.07"/>
<polygon fill="black" stroke="black" points="22006.62,-405.62 21996.05,-406.3 22004.74,-412.36 22006.62,-405.62"/>
</g>
<!-- dp0_pp2_layer12_expert6 -->
<g id="node268" class="node">
<title>dp0_pp2_layer12_expert6</title>
<polygon fill="lightgreen" stroke="black" points="22270,-406.29 22046,-406.29 22046,-354.29 22270,-354.29 22270,-406.29"/>
<text text-anchor="middle" x="22158" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="22158" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="22158" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="22158" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert6 -->
<g id="edge429" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22369.94,-452.97C22326.16,-438.16 22279.94,-422.53 22241.87,-409.66"/>
<polygon fill="black" stroke="black" points="22242.97,-406.33 22232.38,-406.45 22240.73,-412.97 22242.97,-406.33"/>
</g>
<!-- dp0_pp2_layer12_expert7 -->
<g id="node269" class="node">
<title>dp0_pp2_layer12_expert7</title>
<polygon fill="lightgreen" stroke="black" points="22512,-406.29 22288,-406.29 22288,-354.29 22512,-354.29 22512,-406.29"/>
<text text-anchor="middle" x="22400" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="22400" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="22400" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="22400" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert7 -->
<g id="edge430" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22470.38,-452.71C22457.3,-439.43 22443.58,-425.51 22431.76,-413.52"/>
<polygon fill="black" stroke="black" points="22434.19,-411 22424.68,-406.33 22429.2,-415.91 22434.19,-411"/>
</g>
<!-- dp0_pp2_layer12_expert8 -->
<g id="node270" class="node">
<title>dp0_pp2_layer12_expert8</title>
<polygon fill="lightgreen" stroke="black" points="22754,-406.29 22530,-406.29 22530,-354.29 22754,-354.29 22754,-406.29"/>
<text text-anchor="middle" x="22642" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="22642" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="22642" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="22642" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert8 -->
<g id="edge431" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22571.61,-452.71C22584.7,-439.43 22598.42,-425.51 22610.23,-413.52"/>
<polygon fill="black" stroke="black" points="22612.79,-415.91 22617.32,-406.33 22607.81,-411 22612.79,-415.91"/>
</g>
<!-- dp0_pp2_layer12_expert9 -->
<g id="node271" class="node">
<title>dp0_pp2_layer12_expert9</title>
<polygon fill="lightgreen" stroke="black" points="22996,-406.29 22772,-406.29 22772,-354.29 22996,-354.29 22996,-406.29"/>
<text text-anchor="middle" x="22884" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="22884" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="22884" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="22884" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert9 -->
<g id="edge432" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22668.38,-454.21C22713.29,-439.03 22761.08,-422.86 22800.23,-409.62"/>
<polygon fill="black" stroke="black" points="22801.64,-412.84 22809.99,-406.32 22799.4,-406.21 22801.64,-412.84"/>
</g>
<!-- dp0_pp2_layer12_expert10 -->
<g id="node272" class="node">
<title>dp0_pp2_layer12_expert10</title>
<polygon fill="lightgreen" stroke="black" points="23238,-406.29 23014,-406.29 23014,-354.29 23238,-354.29 23238,-406.29"/>
<text text-anchor="middle" x="23126" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="23126" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="23126" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="23126" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert10 -->
<g id="edge433" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22691.89,-478.04C22784.98,-462.69 22901.88,-441.49 23005,-417.06 23015.09,-414.67 23025.6,-411.94 23036.01,-409.07"/>
<polygon fill="black" stroke="black" points="23037.26,-412.36 23045.95,-406.3 23035.37,-405.62 23037.26,-412.36"/>
</g>
<!-- dp0_pp2_layer12_expert11 -->
<g id="node273" class="node">
<title>dp0_pp2_layer12_expert11</title>
<polygon fill="lightgreen" stroke="black" points="23480,-406.29 23256,-406.29 23256,-354.29 23480,-354.29 23480,-406.29"/>
<text text-anchor="middle" x="23368" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="23368" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="23368" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="23368" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert11 -->
<g id="edge434" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22703.99,-490.7C22851.62,-477.88 23064.08,-454.78 23247,-417.06 23257.95,-414.8 23269.35,-412.02 23280.57,-409.02"/>
<polygon fill="black" stroke="black" points="23281.66,-412.35 23290.38,-406.33 23279.81,-405.6 23281.66,-412.35"/>
</g>
<!-- dp0_pp2_layer12_expert12 -->
<g id="node274" class="node">
<title>dp0_pp2_layer12_expert12</title>
<polygon fill="lightgreen" stroke="black" points="23722,-406.29 23498,-406.29 23498,-354.29 23722,-354.29 23722,-406.29"/>
<text text-anchor="middle" x="23610" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="23610" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="23610" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="23610" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert12 -->
<g id="edge435" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22711.27,-498.07C22907.59,-489.29 23221.95,-468.01 23489,-417.06 23500.43,-414.88 23512.33,-412.06 23524.01,-408.97"/>
<polygon fill="black" stroke="black" points="23525.02,-412.32 23533.75,-406.31 23523.18,-405.57 23525.02,-412.32"/>
</g>
<!-- dp0_pp2_layer12_expert13 -->
<g id="node275" class="node">
<title>dp0_pp2_layer12_expert13</title>
<polygon fill="lightgreen" stroke="black" points="23964,-406.29 23740,-406.29 23740,-354.29 23964,-354.29 23964,-406.29"/>
<text text-anchor="middle" x="23852" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="23852" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="23852" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="23852" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert13 -->
<g id="edge436" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22715.93,-502.93C22956.42,-498.58 23376.9,-481.35 23731,-417.06 23742.62,-414.95 23754.71,-412.14 23766.56,-409.03"/>
<polygon fill="black" stroke="black" points="23767.7,-412.34 23776.44,-406.34 23765.87,-405.59 23767.7,-412.34"/>
</g>
<!-- dp0_pp2_layer12_expert14 -->
<g id="node276" class="node">
<title>dp0_pp2_layer12_expert14</title>
<polygon fill="lightgreen" stroke="black" points="24206,-406.29 23982,-406.29 23982,-354.29 24206,-354.29 24206,-406.29"/>
<text text-anchor="middle" x="24094" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="24094" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="24094" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="24094" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert14 -->
<g id="edge437" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22711.32,-498.04C23048.17,-486.48 23736.15,-458.6 23973,-417.06 23984.92,-414.97 23997.32,-412.12 24009.46,-408.93"/>
<polygon fill="black" stroke="black" points="24010.38,-412.3 24019.11,-406.3 24008.54,-405.55 24010.38,-412.3"/>
</g>
<!-- dp0_pp2_layer12_expert15 -->
<g id="node277" class="node">
<title>dp0_pp2_layer12_expert15</title>
<polygon fill="lightgreen" stroke="black" points="24448,-406.29 24224,-406.29 24224,-354.29 24448,-354.29 24448,-406.29"/>
<text text-anchor="middle" x="24336" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="24336" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="24336" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="24336" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert15 -->
<g id="edge438" class="edge">
<title>dp0_pp2_layer12_router&#45;&gt;dp0_pp2_layer12_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22712.94,-499.9C23093.49,-490.72 23931.35,-465.57 24215,-417.06 24227.01,-415.01 24239.51,-412.16 24251.73,-408.95"/>
<polygon fill="black" stroke="black" points="24252.72,-412.31 24261.45,-406.32 24250.88,-405.56 24252.72,-412.31"/>
</g>
<!-- dp0_pp2_layer12_expert_agg -->
<g id="node278" class="node">
<title>dp0_pp2_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="22768.57,-307.52 22374.74,-307.52 22273.43,-203.52 22667.26,-203.52 22768.57,-307.52"/>
<text text-anchor="middle" x="22521" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="22521" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="22521" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="22521" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer12_expert0&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge439" class="edge">
<title>dp0_pp2_layer12_expert0&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M20764.07,-354.29C20783.69,-346.92 20805.97,-339.72 20827,-335.52 21106.13,-279.86 21929.93,-263.21 22316.43,-258.4"/>
<polygon fill="black" stroke="black" points="22316.65,-261.9 22326.61,-258.27 22316.57,-254.9 22316.65,-261.9"/>
</g>
<!-- dp0_pp2_layer12_expert1&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge440" class="edge">
<title>dp0_pp2_layer12_expert1&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M21006.39,-354.27C21025.95,-346.95 21048.09,-339.78 21069,-335.52 21301.8,-288.16 21977.09,-267.74 22318.43,-260.24"/>
<polygon fill="black" stroke="black" points="22318.51,-263.74 22328.43,-260.03 22318.35,-256.74 22318.51,-263.74"/>
</g>
<!-- dp0_pp2_layer12_expert2&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge441" class="edge">
<title>dp0_pp2_layer12_expert2&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M21248.73,-354.29C21268.21,-347.01 21290.23,-339.87 21311,-335.52 21497.91,-296.44 22027.54,-273.07 22320.3,-262.78"/>
<polygon fill="black" stroke="black" points="22320.74,-266.27 22330.61,-262.42 22320.5,-259.27 22320.74,-266.27"/>
</g>
<!-- dp0_pp2_layer12_expert3&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge442" class="edge">
<title>dp0_pp2_layer12_expert3&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M21491.39,-354.26C21510.72,-347.07 21532.48,-339.99 21553,-335.52 21811.91,-279.18 22117.7,-262.24 22315.26,-257.56"/>
<polygon fill="black" stroke="black" points="22315.55,-261.06 22325.47,-257.33 22315.39,-254.06 22315.55,-261.06"/>
</g>
<!-- dp0_pp2_layer12_expert4&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge443" class="edge">
<title>dp0_pp2_layer12_expert4&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M21734.39,-354.24C21753.49,-347.2 21774.87,-340.19 21795,-335.52 21970.82,-294.77 22175.6,-274.91 22322.75,-265.31"/>
<polygon fill="black" stroke="black" points="22323.05,-268.8 22332.81,-264.67 22322.6,-261.82 22323.05,-268.8"/>
</g>
<!-- dp0_pp2_layer12_expert5&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge444" class="edge">
<title>dp0_pp2_layer12_expert5&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M21978.42,-354.22C21997.04,-347.42 22017.65,-340.55 22037,-335.52 22134.09,-310.27 22244.34,-291.53 22335.07,-278.65"/>
<polygon fill="black" stroke="black" points="22335.78,-282.09 22345.19,-277.23 22334.8,-275.16 22335.78,-282.09"/>
</g>
<!-- dp0_pp2_layer12_expert6&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge445" class="edge">
<title>dp0_pp2_layer12_expert6&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M22226.02,-354.26C22243.26,-348.03 22261.78,-341.44 22279,-335.52 22305.73,-326.33 22334.21,-316.8 22361.89,-307.67"/>
<polygon fill="black" stroke="black" points="22363.24,-310.91 22371.65,-304.46 22361.06,-304.26 22363.24,-310.91"/>
</g>
<!-- dp0_pp2_layer12_expert7&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge446" class="edge">
<title>dp0_pp2_layer12_expert7&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M22424.78,-354.15C22436.02,-342.74 22449.83,-328.73 22463.45,-314.92"/>
<polygon fill="black" stroke="black" points="22466,-317.31 22470.53,-307.73 22461.02,-312.39 22466,-317.31"/>
</g>
<!-- dp0_pp2_layer12_expert8&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge447" class="edge">
<title>dp0_pp2_layer12_expert8&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M22617.22,-354.15C22605.97,-342.74 22592.16,-328.73 22578.55,-314.92"/>
<polygon fill="black" stroke="black" points="22580.98,-312.39 22571.47,-307.73 22575.99,-317.31 22580.98,-312.39"/>
</g>
<!-- dp0_pp2_layer12_expert9&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge448" class="edge">
<title>dp0_pp2_layer12_expert9&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M22815.98,-354.26C22798.73,-348.03 22780.21,-341.44 22763,-335.52 22739.29,-327.37 22714.21,-318.95 22689.53,-310.78"/>
<polygon fill="black" stroke="black" points="22690.32,-307.36 22679.73,-307.54 22688.12,-314 22690.32,-307.36"/>
</g>
<!-- dp0_pp2_layer12_expert10&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge449" class="edge">
<title>dp0_pp2_layer12_expert10&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M23063.58,-354.22C23044.96,-347.42 23024.35,-340.55 23005,-335.52 22924.99,-314.71 22836.05,-298.33 22756.46,-286"/>
<polygon fill="black" stroke="black" points="22756.71,-282.5 22746.3,-284.44 22755.65,-289.41 22756.71,-282.5"/>
</g>
<!-- dp0_pp2_layer12_expert11&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge450" class="edge">
<title>dp0_pp2_layer12_expert11&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M23307.61,-354.24C23288.51,-347.2 23267.13,-340.19 23247,-335.52 23078.74,-296.53 22883.97,-276.66 22738.55,-266.61"/>
<polygon fill="black" stroke="black" points="22738.38,-263.09 22728.16,-265.9 22737.9,-270.07 22738.38,-263.09"/>
</g>
<!-- dp0_pp2_layer12_expert12&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge451" class="edge">
<title>dp0_pp2_layer12_expert12&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M23550.61,-354.26C23531.28,-347.07 23509.52,-339.99 23489,-335.52 23231.51,-279.49 22927.64,-262.43 22729.99,-257.64"/>
<polygon fill="black" stroke="black" points="22729.86,-254.14 22719.78,-257.4 22729.69,-261.13 22729.86,-254.14"/>
</g>
<!-- dp0_pp2_layer12_expert13&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge452" class="edge">
<title>dp0_pp2_layer12_expert13&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M23793.27,-354.29C23773.79,-347.01 23751.77,-339.87 23731,-335.52 23547.02,-297.05 23030.97,-273.81 22735.63,-263.27"/>
<polygon fill="black" stroke="black" points="22735.33,-259.76 22725.21,-262.9 22735.08,-266.76 22735.33,-259.76"/>
</g>
<!-- dp0_pp2_layer12_expert14&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge453" class="edge">
<title>dp0_pp2_layer12_expert14&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M24035.6,-354.27C24016.05,-346.95 23993.9,-339.78 23973,-335.52 23742.27,-288.58 23076.86,-268.1 22732.74,-260.45"/>
<polygon fill="black" stroke="black" points="22732.73,-256.94 22722.65,-260.22 22732.57,-263.94 22732.73,-256.94"/>
</g>
<!-- dp0_pp2_layer12_expert15&#45;&gt;dp0_pp2_layer12_expert_agg -->
<g id="edge454" class="edge">
<title>dp0_pp2_layer12_expert15&#45;&gt;dp0_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M24277.93,-354.29C24258.3,-346.92 24236.03,-339.72 24215,-335.52 23937.21,-280.12 23119.98,-263.37 22731.17,-258.47"/>
<polygon fill="black" stroke="black" points="22730.97,-254.97 22720.93,-258.34 22730.88,-261.97 22730.97,-254.97"/>
</g>
<!-- dp0_pp2_layer13_attn_tp0 -->
<g id="node279" class="node">
<title>dp0_pp2_layer13_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="20003.5,-531.06 19738.5,-531.06 19738.5,-479.06 20003.5,-479.06 20003.5,-531.06"/>
<text text-anchor="middle" x="19871" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="19871" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="19871" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="19871" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer12_expert_agg&#45;&gt;dp0_pp2_layer13_attn_tp0 -->
<g id="edge456" class="edge">
<title>dp0_pp2_layer12_expert_agg&#45;&gt;dp0_pp2_layer13_attn_tp0</title>
<path fill="none" stroke="black" d="M22328.78,-260.41C21908.38,-269.54 20918.17,-294.77 20585,-335.52 20552.8,-339.46 20044.23,-444.29 20013,-453.06 19990.37,-459.41 19966.16,-467.58 19944.26,-475.5"/>
<polygon fill="black" stroke="black" points="19942.89,-472.28 19934.7,-479 19945.29,-478.85 19942.89,-472.28"/>
</g>
<!-- dp0_pp2_layer13_attn_allreduce -->
<g id="node280" class="node">
<title>dp0_pp2_layer13_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="20000" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="20000" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="20000" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="20000" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="20000" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_attn_tp0&#45;&gt;dp0_pp2_layer13_attn_allreduce -->
<g id="edge457" class="edge">
<title>dp0_pp2_layer13_attn_tp0&#45;&gt;dp0_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M19897.41,-478.92C19914.15,-463 19936.21,-442 19955.58,-423.56"/>
<polygon fill="black" stroke="black" points="19958.03,-426.07 19962.86,-416.64 19953.2,-421 19958.03,-426.07"/>
</g>
<!-- dp0_pp2_layer13_router -->
<g id="node284" class="node">
<title>dp0_pp2_layer13_router</title>
<polygon fill="lightyellow" stroke="black" points="17751.57,-557.06 17357.74,-557.06 17256.43,-453.06 17650.26,-453.06 17751.57,-557.06"/>
<text text-anchor="middle" x="17504" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="17504" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="17504" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="17504" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_attn_allreduce&#45;&gt;dp0_pp2_layer13_router -->
<g id="edge493" class="edge">
<title>dp0_pp2_layer13_attn_allreduce&#45;&gt;dp0_pp2_layer13_router</title>
<path fill="none" stroke="black" d="M19840.08,-392.38C19728.77,-399.9 19576.89,-409.76 19443,-417.06 18807.5,-451.72 18054.28,-482.59 17702.96,-496.4"/>
<polygon fill="black" stroke="black" points="17702.8,-492.91 17692.94,-496.79 17703.07,-499.9 17702.8,-492.91"/>
</g>
<!-- dp0_pp2_layer13_attn_tp1 -->
<g id="node281" class="node">
<title>dp0_pp2_layer13_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="20286.5,-531.06 20021.5,-531.06 20021.5,-479.06 20286.5,-479.06 20286.5,-531.06"/>
<text text-anchor="middle" x="20154" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="20154" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="20154" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="20154" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer13_attn_tp1&#45;&gt;dp0_pp2_layer13_attn_allreduce -->
<g id="edge458" class="edge">
<title>dp0_pp2_layer13_attn_tp1&#45;&gt;dp0_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M20122.46,-478.92C20101.99,-462.6 20074.83,-440.94 20051.29,-422.18"/>
<polygon fill="black" stroke="black" points="20053.46,-419.44 20043.46,-415.94 20049.1,-424.91 20053.46,-419.44"/>
</g>
<!-- dp0_pp2_layer13_attn_tp2 -->
<g id="node282" class="node">
<title>dp0_pp2_layer13_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="19720.5,-531.06 19455.5,-531.06 19455.5,-479.06 19720.5,-479.06 19720.5,-531.06"/>
<text text-anchor="middle" x="19588" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="19588" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="19588" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="19588" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer13_attn_tp2&#45;&gt;dp0_pp2_layer13_attn_allreduce -->
<g id="edge459" class="edge">
<title>dp0_pp2_layer13_attn_tp2&#45;&gt;dp0_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M19654.07,-479.02C19677.85,-470.35 19704.99,-460.86 19730,-453.06 19778.74,-437.86 19833.05,-423.03 19880.1,-410.83"/>
<polygon fill="black" stroke="black" points="19881.22,-414.15 19890.03,-408.26 19879.47,-407.38 19881.22,-414.15"/>
</g>
<!-- dp0_pp2_layer13_attn_tp3 -->
<g id="node283" class="node">
<title>dp0_pp2_layer13_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="20569.5,-531.06 20304.5,-531.06 20304.5,-479.06 20569.5,-479.06 20569.5,-531.06"/>
<text text-anchor="middle" x="20437" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="20437" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="20437" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="20437" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer13_attn_tp3&#45;&gt;dp0_pp2_layer13_attn_allreduce -->
<g id="edge460" class="edge">
<title>dp0_pp2_layer13_attn_tp3&#45;&gt;dp0_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M20372.21,-478.95C20348.43,-470.18 20321.17,-460.64 20296,-453.06 20241.42,-436.63 20180.31,-421.31 20127.86,-409.08"/>
<polygon fill="black" stroke="black" points="20128.37,-405.6 20117.83,-406.75 20126.78,-412.42 20128.37,-405.6"/>
</g>
<!-- dp0_pp2_layer13_expert0 -->
<g id="node285" class="node">
<title>dp0_pp2_layer13_expert0</title>
<polygon fill="lightgreen" stroke="black" points="15801,-406.29 15577,-406.29 15577,-354.29 15801,-354.29 15801,-406.29"/>
<text text-anchor="middle" x="15689" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="15689" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="15689" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="15689" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert0 -->
<g id="edge461" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17301.73,-499.65C16916.55,-490.26 16091.11,-465.13 15810,-417.06 15797.99,-415.01 15785.48,-412.16 15773.27,-408.95"/>
<polygon fill="black" stroke="black" points="15774.11,-405.56 15763.54,-406.32 15772.28,-412.31 15774.11,-405.56"/>
</g>
<!-- dp0_pp2_layer13_expert1 -->
<g id="node286" class="node">
<title>dp0_pp2_layer13_expert1</title>
<polygon fill="lightgreen" stroke="black" points="16043,-406.29 15819,-406.29 15819,-354.29 16043,-354.29 16043,-406.29"/>
<text text-anchor="middle" x="15931" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="15931" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="15931" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="15931" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert1 -->
<g id="edge462" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17299.55,-497.55C16957.94,-485.71 16285.58,-458.03 16052,-417.06 16040.08,-414.97 16027.67,-412.12 16015.54,-408.93"/>
<polygon fill="black" stroke="black" points="16016.45,-405.55 16005.89,-406.3 16014.62,-412.3 16016.45,-405.55"/>
</g>
<!-- dp0_pp2_layer13_expert2 -->
<g id="node287" class="node">
<title>dp0_pp2_layer13_expert2</title>
<polygon fill="lightgreen" stroke="black" points="16285,-406.29 16061,-406.29 16061,-354.29 16285,-354.29 16285,-406.29"/>
<text text-anchor="middle" x="16173" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="16173" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="16173" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="16173" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert2 -->
<g id="edge463" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17304.82,-502.85C17063.66,-498.37 16646.02,-480.97 16294,-417.06 16282.38,-414.95 16270.29,-412.14 16258.44,-409.03"/>
<polygon fill="black" stroke="black" points="16259.13,-405.59 16248.56,-406.34 16257.29,-412.34 16259.13,-405.59"/>
</g>
<!-- dp0_pp2_layer13_expert3 -->
<g id="node288" class="node">
<title>dp0_pp2_layer13_expert3</title>
<polygon fill="lightgreen" stroke="black" points="16527,-406.29 16303,-406.29 16303,-354.29 16527,-354.29 16527,-406.29"/>
<text text-anchor="middle" x="16415" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="16415" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="16415" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="16415" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert3 -->
<g id="edge464" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17299.36,-497.41C17102.31,-488.25 16796.63,-466.79 16536,-417.06 16524.57,-414.88 16512.67,-412.06 16500.99,-408.97"/>
<polygon fill="black" stroke="black" points="16501.82,-405.57 16491.25,-406.31 16499.98,-412.32 16501.82,-405.57"/>
</g>
<!-- dp0_pp2_layer13_expert4 -->
<g id="node289" class="node">
<title>dp0_pp2_layer13_expert4</title>
<polygon fill="lightgreen" stroke="black" points="16769,-406.29 16545,-406.29 16545,-354.29 16769,-354.29 16769,-406.29"/>
<text text-anchor="middle" x="16657" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="16657" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="16657" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="16657" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert4 -->
<g id="edge465" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17290.43,-487.98C17144.99,-474.71 16948.64,-452.25 16778,-417.06 16767.05,-414.8 16755.65,-412.02 16744.43,-409.02"/>
<polygon fill="black" stroke="black" points="16745.19,-405.6 16734.62,-406.33 16743.34,-412.35 16745.19,-405.6"/>
</g>
<!-- dp0_pp2_layer13_expert5 -->
<g id="node290" class="node">
<title>dp0_pp2_layer13_expert5</title>
<polygon fill="lightgreen" stroke="black" points="17011,-406.29 16787,-406.29 16787,-354.29 17011,-354.29 17011,-406.29"/>
<text text-anchor="middle" x="16899" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="16899" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="16899" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="16899" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert5 -->
<g id="edge466" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17270.29,-467.38C17190.5,-453.44 17101,-436.25 17020,-417.06 17009.9,-414.67 16999.4,-411.94 16988.99,-409.07"/>
<polygon fill="black" stroke="black" points="16989.62,-405.62 16979.05,-406.3 16987.74,-412.36 16989.62,-405.62"/>
</g>
<!-- dp0_pp2_layer13_expert6 -->
<g id="node291" class="node">
<title>dp0_pp2_layer13_expert6</title>
<polygon fill="lightgreen" stroke="black" points="17253,-406.29 17029,-406.29 17029,-354.29 17253,-354.29 17253,-406.29"/>
<text text-anchor="middle" x="17141" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="17141" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="17141" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="17141" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert6 -->
<g id="edge467" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17352.94,-452.97C17309.16,-438.16 17262.94,-422.53 17224.87,-409.66"/>
<polygon fill="black" stroke="black" points="17225.97,-406.33 17215.38,-406.45 17223.73,-412.97 17225.97,-406.33"/>
</g>
<!-- dp0_pp2_layer13_expert7 -->
<g id="node292" class="node">
<title>dp0_pp2_layer13_expert7</title>
<polygon fill="lightgreen" stroke="black" points="17495,-406.29 17271,-406.29 17271,-354.29 17495,-354.29 17495,-406.29"/>
<text text-anchor="middle" x="17383" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="17383" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="17383" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="17383" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert7 -->
<g id="edge468" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17453.38,-452.71C17440.3,-439.43 17426.58,-425.51 17414.76,-413.52"/>
<polygon fill="black" stroke="black" points="17417.19,-411 17407.68,-406.33 17412.2,-415.91 17417.19,-411"/>
</g>
<!-- dp0_pp2_layer13_expert8 -->
<g id="node293" class="node">
<title>dp0_pp2_layer13_expert8</title>
<polygon fill="lightgreen" stroke="black" points="17737,-406.29 17513,-406.29 17513,-354.29 17737,-354.29 17737,-406.29"/>
<text text-anchor="middle" x="17625" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="17625" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="17625" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="17625" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert8 -->
<g id="edge469" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17554.61,-452.71C17567.7,-439.43 17581.42,-425.51 17593.23,-413.52"/>
<polygon fill="black" stroke="black" points="17595.79,-415.91 17600.32,-406.33 17590.81,-411 17595.79,-415.91"/>
</g>
<!-- dp0_pp2_layer13_expert9 -->
<g id="node294" class="node">
<title>dp0_pp2_layer13_expert9</title>
<polygon fill="lightgreen" stroke="black" points="17979,-406.29 17755,-406.29 17755,-354.29 17979,-354.29 17979,-406.29"/>
<text text-anchor="middle" x="17867" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="17867" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="17867" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="17867" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert9 -->
<g id="edge470" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17651.38,-454.21C17696.29,-439.03 17744.08,-422.86 17783.23,-409.62"/>
<polygon fill="black" stroke="black" points="17784.64,-412.84 17792.99,-406.32 17782.4,-406.21 17784.64,-412.84"/>
</g>
<!-- dp0_pp2_layer13_expert10 -->
<g id="node295" class="node">
<title>dp0_pp2_layer13_expert10</title>
<polygon fill="lightgreen" stroke="black" points="18221,-406.29 17997,-406.29 17997,-354.29 18221,-354.29 18221,-406.29"/>
<text text-anchor="middle" x="18109" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="18109" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="18109" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="18109" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert10 -->
<g id="edge471" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17674.89,-478.04C17767.98,-462.69 17884.88,-441.49 17988,-417.06 17998.09,-414.67 18008.6,-411.94 18019.01,-409.07"/>
<polygon fill="black" stroke="black" points="18020.26,-412.36 18028.95,-406.3 18018.37,-405.62 18020.26,-412.36"/>
</g>
<!-- dp0_pp2_layer13_expert11 -->
<g id="node296" class="node">
<title>dp0_pp2_layer13_expert11</title>
<polygon fill="lightgreen" stroke="black" points="18463,-406.29 18239,-406.29 18239,-354.29 18463,-354.29 18463,-406.29"/>
<text text-anchor="middle" x="18351" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="18351" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="18351" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="18351" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert11 -->
<g id="edge472" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17686.99,-490.7C17834.62,-477.88 18047.08,-454.78 18230,-417.06 18240.95,-414.8 18252.35,-412.02 18263.57,-409.02"/>
<polygon fill="black" stroke="black" points="18264.66,-412.35 18273.38,-406.33 18262.81,-405.6 18264.66,-412.35"/>
</g>
<!-- dp0_pp2_layer13_expert12 -->
<g id="node297" class="node">
<title>dp0_pp2_layer13_expert12</title>
<polygon fill="lightgreen" stroke="black" points="18705,-406.29 18481,-406.29 18481,-354.29 18705,-354.29 18705,-406.29"/>
<text text-anchor="middle" x="18593" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="18593" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="18593" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="18593" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert12 -->
<g id="edge473" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17694.27,-498.07C17890.59,-489.29 18204.95,-468.01 18472,-417.06 18483.43,-414.88 18495.33,-412.06 18507.01,-408.97"/>
<polygon fill="black" stroke="black" points="18508.02,-412.32 18516.75,-406.31 18506.18,-405.57 18508.02,-412.32"/>
</g>
<!-- dp0_pp2_layer13_expert13 -->
<g id="node298" class="node">
<title>dp0_pp2_layer13_expert13</title>
<polygon fill="lightgreen" stroke="black" points="18947,-406.29 18723,-406.29 18723,-354.29 18947,-354.29 18947,-406.29"/>
<text text-anchor="middle" x="18835" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="18835" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="18835" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="18835" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert13 -->
<g id="edge474" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17698.93,-502.93C17939.42,-498.58 18359.9,-481.35 18714,-417.06 18725.62,-414.95 18737.71,-412.14 18749.56,-409.03"/>
<polygon fill="black" stroke="black" points="18750.7,-412.34 18759.44,-406.34 18748.87,-405.59 18750.7,-412.34"/>
</g>
<!-- dp0_pp2_layer13_expert14 -->
<g id="node299" class="node">
<title>dp0_pp2_layer13_expert14</title>
<polygon fill="lightgreen" stroke="black" points="19189,-406.29 18965,-406.29 18965,-354.29 19189,-354.29 19189,-406.29"/>
<text text-anchor="middle" x="19077" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="19077" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="19077" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="19077" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert14 -->
<g id="edge475" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17694.32,-498.04C18031.17,-486.48 18719.15,-458.6 18956,-417.06 18967.92,-414.97 18980.32,-412.12 18992.46,-408.93"/>
<polygon fill="black" stroke="black" points="18993.38,-412.3 19002.11,-406.3 18991.54,-405.55 18993.38,-412.3"/>
</g>
<!-- dp0_pp2_layer13_expert15 -->
<g id="node300" class="node">
<title>dp0_pp2_layer13_expert15</title>
<polygon fill="lightgreen" stroke="black" points="19431,-406.29 19207,-406.29 19207,-354.29 19431,-354.29 19431,-406.29"/>
<text text-anchor="middle" x="19319" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="19319" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="19319" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="19319" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert15 -->
<g id="edge476" class="edge">
<title>dp0_pp2_layer13_router&#45;&gt;dp0_pp2_layer13_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17695.94,-499.9C18076.49,-490.72 18914.35,-465.57 19198,-417.06 19210.01,-415.01 19222.51,-412.16 19234.73,-408.95"/>
<polygon fill="black" stroke="black" points="19235.72,-412.31 19244.45,-406.32 19233.88,-405.56 19235.72,-412.31"/>
</g>
<!-- dp0_pp2_layer13_expert_agg -->
<g id="node301" class="node">
<title>dp0_pp2_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="17751.57,-307.52 17357.74,-307.52 17256.43,-203.52 17650.26,-203.52 17751.57,-307.52"/>
<text text-anchor="middle" x="17504" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="17504" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="17504" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="17504" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer13_expert0&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge477" class="edge">
<title>dp0_pp2_layer13_expert0&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M15747.07,-354.29C15766.69,-346.92 15788.97,-339.72 15810,-335.52 16089.13,-279.86 16912.93,-263.21 17299.43,-258.4"/>
<polygon fill="black" stroke="black" points="17299.65,-261.9 17309.61,-258.27 17299.57,-254.9 17299.65,-261.9"/>
</g>
<!-- dp0_pp2_layer13_expert1&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge478" class="edge">
<title>dp0_pp2_layer13_expert1&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M15989.39,-354.27C16008.95,-346.95 16031.09,-339.78 16052,-335.52 16284.8,-288.16 16960.09,-267.74 17301.43,-260.24"/>
<polygon fill="black" stroke="black" points="17301.51,-263.74 17311.43,-260.03 17301.35,-256.74 17301.51,-263.74"/>
</g>
<!-- dp0_pp2_layer13_expert2&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge479" class="edge">
<title>dp0_pp2_layer13_expert2&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M16231.73,-354.29C16251.21,-347.01 16273.23,-339.87 16294,-335.52 16480.91,-296.44 17010.54,-273.07 17303.3,-262.78"/>
<polygon fill="black" stroke="black" points="17303.74,-266.27 17313.61,-262.42 17303.5,-259.27 17303.74,-266.27"/>
</g>
<!-- dp0_pp2_layer13_expert3&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge480" class="edge">
<title>dp0_pp2_layer13_expert3&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M16474.39,-354.26C16493.72,-347.07 16515.48,-339.99 16536,-335.52 16794.91,-279.18 17100.7,-262.24 17298.26,-257.56"/>
<polygon fill="black" stroke="black" points="17298.55,-261.06 17308.47,-257.33 17298.39,-254.06 17298.55,-261.06"/>
</g>
<!-- dp0_pp2_layer13_expert4&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge481" class="edge">
<title>dp0_pp2_layer13_expert4&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M16717.39,-354.24C16736.49,-347.2 16757.87,-340.19 16778,-335.52 16953.82,-294.77 17158.6,-274.91 17305.75,-265.31"/>
<polygon fill="black" stroke="black" points="17306.05,-268.8 17315.81,-264.67 17305.6,-261.82 17306.05,-268.8"/>
</g>
<!-- dp0_pp2_layer13_expert5&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge482" class="edge">
<title>dp0_pp2_layer13_expert5&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M16961.42,-354.22C16980.04,-347.42 17000.65,-340.55 17020,-335.52 17117.09,-310.27 17227.34,-291.53 17318.07,-278.65"/>
<polygon fill="black" stroke="black" points="17318.78,-282.09 17328.19,-277.23 17317.8,-275.16 17318.78,-282.09"/>
</g>
<!-- dp0_pp2_layer13_expert6&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge483" class="edge">
<title>dp0_pp2_layer13_expert6&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M17209.02,-354.26C17226.26,-348.03 17244.78,-341.44 17262,-335.52 17288.73,-326.33 17317.21,-316.8 17344.89,-307.67"/>
<polygon fill="black" stroke="black" points="17346.24,-310.91 17354.65,-304.46 17344.06,-304.26 17346.24,-310.91"/>
</g>
<!-- dp0_pp2_layer13_expert7&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge484" class="edge">
<title>dp0_pp2_layer13_expert7&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M17407.78,-354.15C17419.02,-342.74 17432.83,-328.73 17446.45,-314.92"/>
<polygon fill="black" stroke="black" points="17449,-317.31 17453.53,-307.73 17444.02,-312.39 17449,-317.31"/>
</g>
<!-- dp0_pp2_layer13_expert8&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge485" class="edge">
<title>dp0_pp2_layer13_expert8&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M17600.22,-354.15C17588.97,-342.74 17575.16,-328.73 17561.55,-314.92"/>
<polygon fill="black" stroke="black" points="17563.98,-312.39 17554.47,-307.73 17558.99,-317.31 17563.98,-312.39"/>
</g>
<!-- dp0_pp2_layer13_expert9&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge486" class="edge">
<title>dp0_pp2_layer13_expert9&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M17798.98,-354.26C17781.73,-348.03 17763.21,-341.44 17746,-335.52 17722.29,-327.37 17697.21,-318.95 17672.53,-310.78"/>
<polygon fill="black" stroke="black" points="17673.32,-307.36 17662.73,-307.54 17671.12,-314 17673.32,-307.36"/>
</g>
<!-- dp0_pp2_layer13_expert10&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge487" class="edge">
<title>dp0_pp2_layer13_expert10&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M18046.58,-354.22C18027.96,-347.42 18007.35,-340.55 17988,-335.52 17907.99,-314.71 17819.05,-298.33 17739.46,-286"/>
<polygon fill="black" stroke="black" points="17739.71,-282.5 17729.3,-284.44 17738.65,-289.41 17739.71,-282.5"/>
</g>
<!-- dp0_pp2_layer13_expert11&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge488" class="edge">
<title>dp0_pp2_layer13_expert11&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M18290.61,-354.24C18271.51,-347.2 18250.13,-340.19 18230,-335.52 18061.74,-296.53 17866.97,-276.66 17721.55,-266.61"/>
<polygon fill="black" stroke="black" points="17721.38,-263.09 17711.16,-265.9 17720.9,-270.07 17721.38,-263.09"/>
</g>
<!-- dp0_pp2_layer13_expert12&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge489" class="edge">
<title>dp0_pp2_layer13_expert12&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M18533.61,-354.26C18514.28,-347.07 18492.52,-339.99 18472,-335.52 18214.51,-279.49 17910.64,-262.43 17712.99,-257.64"/>
<polygon fill="black" stroke="black" points="17712.86,-254.14 17702.78,-257.4 17712.69,-261.13 17712.86,-254.14"/>
</g>
<!-- dp0_pp2_layer13_expert13&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge490" class="edge">
<title>dp0_pp2_layer13_expert13&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M18776.27,-354.29C18756.79,-347.01 18734.77,-339.87 18714,-335.52 18530.02,-297.05 18013.97,-273.81 17718.63,-263.27"/>
<polygon fill="black" stroke="black" points="17718.33,-259.76 17708.21,-262.9 17718.08,-266.76 17718.33,-259.76"/>
</g>
<!-- dp0_pp2_layer13_expert14&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge491" class="edge">
<title>dp0_pp2_layer13_expert14&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M19018.6,-354.27C18999.05,-346.95 18976.9,-339.78 18956,-335.52 18725.27,-288.58 18059.86,-268.1 17715.74,-260.45"/>
<polygon fill="black" stroke="black" points="17715.73,-256.94 17705.65,-260.22 17715.57,-263.94 17715.73,-256.94"/>
</g>
<!-- dp0_pp2_layer13_expert15&#45;&gt;dp0_pp2_layer13_expert_agg -->
<g id="edge492" class="edge">
<title>dp0_pp2_layer13_expert15&#45;&gt;dp0_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M19260.93,-354.29C19241.3,-346.92 19219.03,-339.72 19198,-335.52 18920.21,-280.12 18102.98,-263.37 17714.17,-258.47"/>
<polygon fill="black" stroke="black" points="17713.97,-254.97 17703.93,-258.34 17713.88,-261.97 17713.97,-254.97"/>
</g>
<!-- dp0_pp2_layer14_attn_tp0 -->
<g id="node302" class="node">
<title>dp0_pp2_layer14_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="14986.5,-531.06 14721.5,-531.06 14721.5,-479.06 14986.5,-479.06 14986.5,-531.06"/>
<text text-anchor="middle" x="14854" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="14854" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="14854" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="14854" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer13_expert_agg&#45;&gt;dp0_pp2_layer14_attn_tp0 -->
<g id="edge494" class="edge">
<title>dp0_pp2_layer13_expert_agg&#45;&gt;dp0_pp2_layer14_attn_tp0</title>
<path fill="none" stroke="black" d="M17311.78,-260.41C16891.38,-269.54 15901.17,-294.77 15568,-335.52 15535.8,-339.46 15027.23,-444.29 14996,-453.06 14973.37,-459.41 14949.16,-467.58 14927.26,-475.5"/>
<polygon fill="black" stroke="black" points="14925.89,-472.28 14917.7,-479 14928.29,-478.85 14925.89,-472.28"/>
</g>
<!-- dp0_pp2_layer14_attn_allreduce -->
<g id="node303" class="node">
<title>dp0_pp2_layer14_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="14983" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="14983" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="14983" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="14983" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="14983" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_attn_tp0&#45;&gt;dp0_pp2_layer14_attn_allreduce -->
<g id="edge495" class="edge">
<title>dp0_pp2_layer14_attn_tp0&#45;&gt;dp0_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M14880.41,-478.92C14897.15,-463 14919.21,-442 14938.58,-423.56"/>
<polygon fill="black" stroke="black" points="14941.03,-426.07 14945.86,-416.64 14936.2,-421 14941.03,-426.07"/>
</g>
<!-- dp0_pp2_layer14_router -->
<g id="node307" class="node">
<title>dp0_pp2_layer14_router</title>
<polygon fill="lightyellow" stroke="black" points="12734.57,-557.06 12340.74,-557.06 12239.43,-453.06 12633.26,-453.06 12734.57,-557.06"/>
<text text-anchor="middle" x="12487" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="12487" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="12487" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="12487" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_attn_allreduce&#45;&gt;dp0_pp2_layer14_router -->
<g id="edge531" class="edge">
<title>dp0_pp2_layer14_attn_allreduce&#45;&gt;dp0_pp2_layer14_router</title>
<path fill="none" stroke="black" d="M14823.08,-392.38C14711.77,-399.9 14559.89,-409.76 14426,-417.06 13790.5,-451.72 13037.28,-482.59 12685.96,-496.4"/>
<polygon fill="black" stroke="black" points="12685.8,-492.91 12675.94,-496.79 12686.07,-499.9 12685.8,-492.91"/>
</g>
<!-- dp0_pp2_layer14_attn_tp1 -->
<g id="node304" class="node">
<title>dp0_pp2_layer14_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="15269.5,-531.06 15004.5,-531.06 15004.5,-479.06 15269.5,-479.06 15269.5,-531.06"/>
<text text-anchor="middle" x="15137" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="15137" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="15137" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="15137" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer14_attn_tp1&#45;&gt;dp0_pp2_layer14_attn_allreduce -->
<g id="edge496" class="edge">
<title>dp0_pp2_layer14_attn_tp1&#45;&gt;dp0_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M15105.46,-478.92C15084.99,-462.6 15057.83,-440.94 15034.29,-422.18"/>
<polygon fill="black" stroke="black" points="15036.46,-419.44 15026.46,-415.94 15032.1,-424.91 15036.46,-419.44"/>
</g>
<!-- dp0_pp2_layer14_attn_tp2 -->
<g id="node305" class="node">
<title>dp0_pp2_layer14_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="14703.5,-531.06 14438.5,-531.06 14438.5,-479.06 14703.5,-479.06 14703.5,-531.06"/>
<text text-anchor="middle" x="14571" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="14571" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="14571" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="14571" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer14_attn_tp2&#45;&gt;dp0_pp2_layer14_attn_allreduce -->
<g id="edge497" class="edge">
<title>dp0_pp2_layer14_attn_tp2&#45;&gt;dp0_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M14637.07,-479.02C14660.85,-470.35 14687.99,-460.86 14713,-453.06 14761.74,-437.86 14816.05,-423.03 14863.1,-410.83"/>
<polygon fill="black" stroke="black" points="14864.22,-414.15 14873.03,-408.26 14862.47,-407.38 14864.22,-414.15"/>
</g>
<!-- dp0_pp2_layer14_attn_tp3 -->
<g id="node306" class="node">
<title>dp0_pp2_layer14_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="15552.5,-531.06 15287.5,-531.06 15287.5,-479.06 15552.5,-479.06 15552.5,-531.06"/>
<text text-anchor="middle" x="15420" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="15420" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="15420" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="15420" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer14_attn_tp3&#45;&gt;dp0_pp2_layer14_attn_allreduce -->
<g id="edge498" class="edge">
<title>dp0_pp2_layer14_attn_tp3&#45;&gt;dp0_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M15355.21,-478.95C15331.43,-470.18 15304.17,-460.64 15279,-453.06 15224.42,-436.63 15163.31,-421.31 15110.86,-409.08"/>
<polygon fill="black" stroke="black" points="15111.37,-405.6 15100.83,-406.75 15109.78,-412.42 15111.37,-405.6"/>
</g>
<!-- dp0_pp2_layer14_expert0 -->
<g id="node308" class="node">
<title>dp0_pp2_layer14_expert0</title>
<polygon fill="lightgreen" stroke="black" points="10784,-406.29 10560,-406.29 10560,-354.29 10784,-354.29 10784,-406.29"/>
<text text-anchor="middle" x="10672" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="10672" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="10672" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="10672" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert0 -->
<g id="edge499" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12284.73,-499.65C11899.55,-490.26 11074.11,-465.13 10793,-417.06 10780.99,-415.01 10768.48,-412.16 10756.27,-408.95"/>
<polygon fill="black" stroke="black" points="10757.11,-405.56 10746.54,-406.32 10755.28,-412.31 10757.11,-405.56"/>
</g>
<!-- dp0_pp2_layer14_expert1 -->
<g id="node309" class="node">
<title>dp0_pp2_layer14_expert1</title>
<polygon fill="lightgreen" stroke="black" points="11026,-406.29 10802,-406.29 10802,-354.29 11026,-354.29 11026,-406.29"/>
<text text-anchor="middle" x="10914" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="10914" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="10914" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="10914" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert1 -->
<g id="edge500" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12282.55,-497.55C11940.94,-485.71 11268.58,-458.03 11035,-417.06 11023.08,-414.97 11010.67,-412.12 10998.54,-408.93"/>
<polygon fill="black" stroke="black" points="10999.45,-405.55 10988.89,-406.3 10997.62,-412.3 10999.45,-405.55"/>
</g>
<!-- dp0_pp2_layer14_expert2 -->
<g id="node310" class="node">
<title>dp0_pp2_layer14_expert2</title>
<polygon fill="lightgreen" stroke="black" points="11268,-406.29 11044,-406.29 11044,-354.29 11268,-354.29 11268,-406.29"/>
<text text-anchor="middle" x="11156" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="11156" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="11156" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="11156" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert2 -->
<g id="edge501" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12287.82,-502.85C12046.66,-498.37 11629.02,-480.97 11277,-417.06 11265.38,-414.95 11253.29,-412.14 11241.44,-409.03"/>
<polygon fill="black" stroke="black" points="11242.13,-405.59 11231.56,-406.34 11240.29,-412.34 11242.13,-405.59"/>
</g>
<!-- dp0_pp2_layer14_expert3 -->
<g id="node311" class="node">
<title>dp0_pp2_layer14_expert3</title>
<polygon fill="lightgreen" stroke="black" points="11510,-406.29 11286,-406.29 11286,-354.29 11510,-354.29 11510,-406.29"/>
<text text-anchor="middle" x="11398" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="11398" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="11398" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="11398" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert3 -->
<g id="edge502" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12282.36,-497.41C12085.31,-488.25 11779.63,-466.79 11519,-417.06 11507.57,-414.88 11495.67,-412.06 11483.99,-408.97"/>
<polygon fill="black" stroke="black" points="11484.82,-405.57 11474.25,-406.31 11482.98,-412.32 11484.82,-405.57"/>
</g>
<!-- dp0_pp2_layer14_expert4 -->
<g id="node312" class="node">
<title>dp0_pp2_layer14_expert4</title>
<polygon fill="lightgreen" stroke="black" points="11752,-406.29 11528,-406.29 11528,-354.29 11752,-354.29 11752,-406.29"/>
<text text-anchor="middle" x="11640" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="11640" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="11640" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="11640" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert4 -->
<g id="edge503" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12273.43,-487.98C12127.99,-474.71 11931.64,-452.25 11761,-417.06 11750.05,-414.8 11738.65,-412.02 11727.43,-409.02"/>
<polygon fill="black" stroke="black" points="11728.19,-405.6 11717.62,-406.33 11726.34,-412.35 11728.19,-405.6"/>
</g>
<!-- dp0_pp2_layer14_expert5 -->
<g id="node313" class="node">
<title>dp0_pp2_layer14_expert5</title>
<polygon fill="lightgreen" stroke="black" points="11994,-406.29 11770,-406.29 11770,-354.29 11994,-354.29 11994,-406.29"/>
<text text-anchor="middle" x="11882" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="11882" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="11882" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="11882" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert5 -->
<g id="edge504" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12253.29,-467.38C12173.5,-453.44 12084,-436.25 12003,-417.06 11992.9,-414.67 11982.4,-411.94 11971.99,-409.07"/>
<polygon fill="black" stroke="black" points="11972.62,-405.62 11962.05,-406.3 11970.74,-412.36 11972.62,-405.62"/>
</g>
<!-- dp0_pp2_layer14_expert6 -->
<g id="node314" class="node">
<title>dp0_pp2_layer14_expert6</title>
<polygon fill="lightgreen" stroke="black" points="12236,-406.29 12012,-406.29 12012,-354.29 12236,-354.29 12236,-406.29"/>
<text text-anchor="middle" x="12124" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="12124" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="12124" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="12124" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert6 -->
<g id="edge505" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12335.94,-452.97C12292.16,-438.16 12245.94,-422.53 12207.87,-409.66"/>
<polygon fill="black" stroke="black" points="12208.97,-406.33 12198.38,-406.45 12206.73,-412.97 12208.97,-406.33"/>
</g>
<!-- dp0_pp2_layer14_expert7 -->
<g id="node315" class="node">
<title>dp0_pp2_layer14_expert7</title>
<polygon fill="lightgreen" stroke="black" points="12478,-406.29 12254,-406.29 12254,-354.29 12478,-354.29 12478,-406.29"/>
<text text-anchor="middle" x="12366" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="12366" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="12366" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="12366" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert7 -->
<g id="edge506" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12436.38,-452.71C12423.3,-439.43 12409.58,-425.51 12397.76,-413.52"/>
<polygon fill="black" stroke="black" points="12400.19,-411 12390.68,-406.33 12395.2,-415.91 12400.19,-411"/>
</g>
<!-- dp0_pp2_layer14_expert8 -->
<g id="node316" class="node">
<title>dp0_pp2_layer14_expert8</title>
<polygon fill="lightgreen" stroke="black" points="12720,-406.29 12496,-406.29 12496,-354.29 12720,-354.29 12720,-406.29"/>
<text text-anchor="middle" x="12608" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="12608" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="12608" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="12608" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert8 -->
<g id="edge507" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12537.61,-452.71C12550.7,-439.43 12564.42,-425.51 12576.23,-413.52"/>
<polygon fill="black" stroke="black" points="12578.79,-415.91 12583.32,-406.33 12573.81,-411 12578.79,-415.91"/>
</g>
<!-- dp0_pp2_layer14_expert9 -->
<g id="node317" class="node">
<title>dp0_pp2_layer14_expert9</title>
<polygon fill="lightgreen" stroke="black" points="12962,-406.29 12738,-406.29 12738,-354.29 12962,-354.29 12962,-406.29"/>
<text text-anchor="middle" x="12850" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="12850" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="12850" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="12850" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert9 -->
<g id="edge508" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12634.38,-454.21C12679.29,-439.03 12727.08,-422.86 12766.23,-409.62"/>
<polygon fill="black" stroke="black" points="12767.64,-412.84 12775.99,-406.32 12765.4,-406.21 12767.64,-412.84"/>
</g>
<!-- dp0_pp2_layer14_expert10 -->
<g id="node318" class="node">
<title>dp0_pp2_layer14_expert10</title>
<polygon fill="lightgreen" stroke="black" points="13204,-406.29 12980,-406.29 12980,-354.29 13204,-354.29 13204,-406.29"/>
<text text-anchor="middle" x="13092" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="13092" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="13092" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="13092" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert10 -->
<g id="edge509" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12657.89,-478.04C12750.98,-462.69 12867.88,-441.49 12971,-417.06 12981.09,-414.67 12991.6,-411.94 13002.01,-409.07"/>
<polygon fill="black" stroke="black" points="13003.26,-412.36 13011.95,-406.3 13001.37,-405.62 13003.26,-412.36"/>
</g>
<!-- dp0_pp2_layer14_expert11 -->
<g id="node319" class="node">
<title>dp0_pp2_layer14_expert11</title>
<polygon fill="lightgreen" stroke="black" points="13446,-406.29 13222,-406.29 13222,-354.29 13446,-354.29 13446,-406.29"/>
<text text-anchor="middle" x="13334" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="13334" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="13334" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="13334" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert11 -->
<g id="edge510" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12669.99,-490.7C12817.62,-477.88 13030.08,-454.78 13213,-417.06 13223.95,-414.8 13235.35,-412.02 13246.57,-409.02"/>
<polygon fill="black" stroke="black" points="13247.66,-412.35 13256.38,-406.33 13245.81,-405.6 13247.66,-412.35"/>
</g>
<!-- dp0_pp2_layer14_expert12 -->
<g id="node320" class="node">
<title>dp0_pp2_layer14_expert12</title>
<polygon fill="lightgreen" stroke="black" points="13688,-406.29 13464,-406.29 13464,-354.29 13688,-354.29 13688,-406.29"/>
<text text-anchor="middle" x="13576" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="13576" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="13576" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="13576" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert12 -->
<g id="edge511" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12677.27,-498.07C12873.59,-489.29 13187.95,-468.01 13455,-417.06 13466.43,-414.88 13478.33,-412.06 13490.01,-408.97"/>
<polygon fill="black" stroke="black" points="13491.02,-412.32 13499.75,-406.31 13489.18,-405.57 13491.02,-412.32"/>
</g>
<!-- dp0_pp2_layer14_expert13 -->
<g id="node321" class="node">
<title>dp0_pp2_layer14_expert13</title>
<polygon fill="lightgreen" stroke="black" points="13930,-406.29 13706,-406.29 13706,-354.29 13930,-354.29 13930,-406.29"/>
<text text-anchor="middle" x="13818" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="13818" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="13818" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="13818" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert13 -->
<g id="edge512" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12681.93,-502.93C12922.42,-498.58 13342.9,-481.35 13697,-417.06 13708.62,-414.95 13720.71,-412.14 13732.56,-409.03"/>
<polygon fill="black" stroke="black" points="13733.7,-412.34 13742.44,-406.34 13731.87,-405.59 13733.7,-412.34"/>
</g>
<!-- dp0_pp2_layer14_expert14 -->
<g id="node322" class="node">
<title>dp0_pp2_layer14_expert14</title>
<polygon fill="lightgreen" stroke="black" points="14172,-406.29 13948,-406.29 13948,-354.29 14172,-354.29 14172,-406.29"/>
<text text-anchor="middle" x="14060" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="14060" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="14060" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="14060" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert14 -->
<g id="edge513" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12677.32,-498.04C13014.17,-486.48 13702.15,-458.6 13939,-417.06 13950.92,-414.97 13963.32,-412.12 13975.46,-408.93"/>
<polygon fill="black" stroke="black" points="13976.38,-412.3 13985.11,-406.3 13974.54,-405.55 13976.38,-412.3"/>
</g>
<!-- dp0_pp2_layer14_expert15 -->
<g id="node323" class="node">
<title>dp0_pp2_layer14_expert15</title>
<polygon fill="lightgreen" stroke="black" points="14414,-406.29 14190,-406.29 14190,-354.29 14414,-354.29 14414,-406.29"/>
<text text-anchor="middle" x="14302" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="14302" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="14302" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="14302" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert15 -->
<g id="edge514" class="edge">
<title>dp0_pp2_layer14_router&#45;&gt;dp0_pp2_layer14_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12678.94,-499.9C13059.49,-490.72 13897.35,-465.57 14181,-417.06 14193.01,-415.01 14205.51,-412.16 14217.73,-408.95"/>
<polygon fill="black" stroke="black" points="14218.72,-412.31 14227.45,-406.32 14216.88,-405.56 14218.72,-412.31"/>
</g>
<!-- dp0_pp2_layer14_expert_agg -->
<g id="node324" class="node">
<title>dp0_pp2_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="12734.57,-307.52 12340.74,-307.52 12239.43,-203.52 12633.26,-203.52 12734.57,-307.52"/>
<text text-anchor="middle" x="12487" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="12487" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="12487" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="12487" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer14_expert0&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge515" class="edge">
<title>dp0_pp2_layer14_expert0&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M10730.07,-354.29C10749.69,-346.92 10771.97,-339.72 10793,-335.52 11072.13,-279.86 11895.93,-263.21 12282.43,-258.4"/>
<polygon fill="black" stroke="black" points="12282.65,-261.9 12292.61,-258.27 12282.57,-254.9 12282.65,-261.9"/>
</g>
<!-- dp0_pp2_layer14_expert1&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge516" class="edge">
<title>dp0_pp2_layer14_expert1&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M10972.39,-354.27C10991.95,-346.95 11014.09,-339.78 11035,-335.52 11267.8,-288.16 11943.09,-267.74 12284.43,-260.24"/>
<polygon fill="black" stroke="black" points="12284.51,-263.74 12294.43,-260.03 12284.35,-256.74 12284.51,-263.74"/>
</g>
<!-- dp0_pp2_layer14_expert2&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge517" class="edge">
<title>dp0_pp2_layer14_expert2&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M11214.73,-354.29C11234.21,-347.01 11256.23,-339.87 11277,-335.52 11463.91,-296.44 11993.54,-273.07 12286.3,-262.78"/>
<polygon fill="black" stroke="black" points="12286.74,-266.27 12296.61,-262.42 12286.5,-259.27 12286.74,-266.27"/>
</g>
<!-- dp0_pp2_layer14_expert3&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge518" class="edge">
<title>dp0_pp2_layer14_expert3&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M11457.39,-354.26C11476.72,-347.07 11498.48,-339.99 11519,-335.52 11777.91,-279.18 12083.7,-262.24 12281.26,-257.56"/>
<polygon fill="black" stroke="black" points="12281.55,-261.06 12291.47,-257.33 12281.39,-254.06 12281.55,-261.06"/>
</g>
<!-- dp0_pp2_layer14_expert4&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge519" class="edge">
<title>dp0_pp2_layer14_expert4&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M11700.39,-354.24C11719.49,-347.2 11740.87,-340.19 11761,-335.52 11936.82,-294.77 12141.6,-274.91 12288.75,-265.31"/>
<polygon fill="black" stroke="black" points="12289.05,-268.8 12298.81,-264.67 12288.6,-261.82 12289.05,-268.8"/>
</g>
<!-- dp0_pp2_layer14_expert5&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge520" class="edge">
<title>dp0_pp2_layer14_expert5&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M11944.42,-354.22C11963.04,-347.42 11983.65,-340.55 12003,-335.52 12100.09,-310.27 12210.34,-291.53 12301.07,-278.65"/>
<polygon fill="black" stroke="black" points="12301.78,-282.09 12311.19,-277.23 12300.8,-275.16 12301.78,-282.09"/>
</g>
<!-- dp0_pp2_layer14_expert6&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge521" class="edge">
<title>dp0_pp2_layer14_expert6&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M12192.02,-354.26C12209.26,-348.03 12227.78,-341.44 12245,-335.52 12271.73,-326.33 12300.21,-316.8 12327.89,-307.67"/>
<polygon fill="black" stroke="black" points="12329.24,-310.91 12337.65,-304.46 12327.06,-304.26 12329.24,-310.91"/>
</g>
<!-- dp0_pp2_layer14_expert7&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge522" class="edge">
<title>dp0_pp2_layer14_expert7&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M12390.78,-354.15C12402.02,-342.74 12415.83,-328.73 12429.45,-314.92"/>
<polygon fill="black" stroke="black" points="12432,-317.31 12436.53,-307.73 12427.02,-312.39 12432,-317.31"/>
</g>
<!-- dp0_pp2_layer14_expert8&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge523" class="edge">
<title>dp0_pp2_layer14_expert8&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M12583.22,-354.15C12571.97,-342.74 12558.16,-328.73 12544.55,-314.92"/>
<polygon fill="black" stroke="black" points="12546.98,-312.39 12537.47,-307.73 12541.99,-317.31 12546.98,-312.39"/>
</g>
<!-- dp0_pp2_layer14_expert9&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge524" class="edge">
<title>dp0_pp2_layer14_expert9&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M12781.98,-354.26C12764.73,-348.03 12746.21,-341.44 12729,-335.52 12705.29,-327.37 12680.21,-318.95 12655.53,-310.78"/>
<polygon fill="black" stroke="black" points="12656.32,-307.36 12645.73,-307.54 12654.12,-314 12656.32,-307.36"/>
</g>
<!-- dp0_pp2_layer14_expert10&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge525" class="edge">
<title>dp0_pp2_layer14_expert10&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M13029.58,-354.22C13010.96,-347.42 12990.35,-340.55 12971,-335.52 12890.99,-314.71 12802.05,-298.33 12722.46,-286"/>
<polygon fill="black" stroke="black" points="12722.71,-282.5 12712.3,-284.44 12721.65,-289.41 12722.71,-282.5"/>
</g>
<!-- dp0_pp2_layer14_expert11&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge526" class="edge">
<title>dp0_pp2_layer14_expert11&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M13273.61,-354.24C13254.51,-347.2 13233.13,-340.19 13213,-335.52 13044.74,-296.53 12849.97,-276.66 12704.55,-266.61"/>
<polygon fill="black" stroke="black" points="12704.38,-263.09 12694.16,-265.9 12703.9,-270.07 12704.38,-263.09"/>
</g>
<!-- dp0_pp2_layer14_expert12&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge527" class="edge">
<title>dp0_pp2_layer14_expert12&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M13516.61,-354.26C13497.28,-347.07 13475.52,-339.99 13455,-335.52 13197.51,-279.49 12893.64,-262.43 12695.99,-257.64"/>
<polygon fill="black" stroke="black" points="12695.86,-254.14 12685.78,-257.4 12695.69,-261.13 12695.86,-254.14"/>
</g>
<!-- dp0_pp2_layer14_expert13&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge528" class="edge">
<title>dp0_pp2_layer14_expert13&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M13759.27,-354.29C13739.79,-347.01 13717.77,-339.87 13697,-335.52 13513.02,-297.05 12996.97,-273.81 12701.63,-263.27"/>
<polygon fill="black" stroke="black" points="12701.33,-259.76 12691.21,-262.9 12701.08,-266.76 12701.33,-259.76"/>
</g>
<!-- dp0_pp2_layer14_expert14&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge529" class="edge">
<title>dp0_pp2_layer14_expert14&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M14001.6,-354.27C13982.05,-346.95 13959.9,-339.78 13939,-335.52 13708.27,-288.58 13042.86,-268.1 12698.74,-260.45"/>
<polygon fill="black" stroke="black" points="12698.73,-256.94 12688.65,-260.22 12698.57,-263.94 12698.73,-256.94"/>
</g>
<!-- dp0_pp2_layer14_expert15&#45;&gt;dp0_pp2_layer14_expert_agg -->
<g id="edge530" class="edge">
<title>dp0_pp2_layer14_expert15&#45;&gt;dp0_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M14243.93,-354.29C14224.3,-346.92 14202.03,-339.72 14181,-335.52 13903.21,-280.12 13085.98,-263.37 12697.17,-258.47"/>
<polygon fill="black" stroke="black" points="12696.97,-254.97 12686.93,-258.34 12696.88,-261.97 12696.97,-254.97"/>
</g>
<!-- dp0_pp2_layer15_attn_tp0 -->
<g id="node325" class="node">
<title>dp0_pp2_layer15_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="9969.5,-531.06 9704.5,-531.06 9704.5,-479.06 9969.5,-479.06 9969.5,-531.06"/>
<text text-anchor="middle" x="9837" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="9837" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="9837" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9837" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer14_expert_agg&#45;&gt;dp0_pp2_layer15_attn_tp0 -->
<g id="edge532" class="edge">
<title>dp0_pp2_layer14_expert_agg&#45;&gt;dp0_pp2_layer15_attn_tp0</title>
<path fill="none" stroke="black" d="M12294.78,-260.41C11874.38,-269.54 10884.17,-294.77 10551,-335.52 10518.8,-339.46 10010.23,-444.29 9979,-453.06 9956.37,-459.41 9932.16,-467.58 9910.26,-475.5"/>
<polygon fill="black" stroke="black" points="9908.89,-472.28 9900.7,-479 9911.29,-478.85 9908.89,-472.28"/>
</g>
<!-- dp0_pp2_layer15_attn_allreduce -->
<g id="node326" class="node">
<title>dp0_pp2_layer15_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="9966" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="9966" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="9966" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="9966" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="9966" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_attn_tp0&#45;&gt;dp0_pp2_layer15_attn_allreduce -->
<g id="edge533" class="edge">
<title>dp0_pp2_layer15_attn_tp0&#45;&gt;dp0_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M9863.41,-478.92C9880.15,-463 9902.21,-442 9921.58,-423.56"/>
<polygon fill="black" stroke="black" points="9924.03,-426.07 9928.86,-416.64 9919.2,-421 9924.03,-426.07"/>
</g>
<!-- dp0_pp2_layer15_router -->
<g id="node330" class="node">
<title>dp0_pp2_layer15_router</title>
<polygon fill="lightyellow" stroke="black" points="7717.57,-557.06 7323.74,-557.06 7222.43,-453.06 7616.26,-453.06 7717.57,-557.06"/>
<text text-anchor="middle" x="7470" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="7470" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="7470" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="7470" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_attn_allreduce&#45;&gt;dp0_pp2_layer15_router -->
<g id="edge569" class="edge">
<title>dp0_pp2_layer15_attn_allreduce&#45;&gt;dp0_pp2_layer15_router</title>
<path fill="none" stroke="black" d="M9806.08,-392.38C9694.77,-399.9 9542.89,-409.76 9409,-417.06 8773.5,-451.72 8020.28,-482.59 7668.96,-496.4"/>
<polygon fill="black" stroke="black" points="7668.8,-492.91 7658.94,-496.79 7669.07,-499.9 7668.8,-492.91"/>
</g>
<!-- dp0_pp2_layer15_attn_tp1 -->
<g id="node327" class="node">
<title>dp0_pp2_layer15_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="10252.5,-531.06 9987.5,-531.06 9987.5,-479.06 10252.5,-479.06 10252.5,-531.06"/>
<text text-anchor="middle" x="10120" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="10120" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="10120" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="10120" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer15_attn_tp1&#45;&gt;dp0_pp2_layer15_attn_allreduce -->
<g id="edge534" class="edge">
<title>dp0_pp2_layer15_attn_tp1&#45;&gt;dp0_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M10088.46,-478.92C10067.99,-462.6 10040.83,-440.94 10017.29,-422.18"/>
<polygon fill="black" stroke="black" points="10019.46,-419.44 10009.46,-415.94 10015.1,-424.91 10019.46,-419.44"/>
</g>
<!-- dp0_pp2_layer15_attn_tp2 -->
<g id="node328" class="node">
<title>dp0_pp2_layer15_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="9686.5,-531.06 9421.5,-531.06 9421.5,-479.06 9686.5,-479.06 9686.5,-531.06"/>
<text text-anchor="middle" x="9554" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="9554" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="9554" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9554" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer15_attn_tp2&#45;&gt;dp0_pp2_layer15_attn_allreduce -->
<g id="edge535" class="edge">
<title>dp0_pp2_layer15_attn_tp2&#45;&gt;dp0_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M9620.07,-479.02C9643.85,-470.35 9670.99,-460.86 9696,-453.06 9744.74,-437.86 9799.05,-423.03 9846.1,-410.83"/>
<polygon fill="black" stroke="black" points="9847.22,-414.15 9856.03,-408.26 9845.47,-407.38 9847.22,-414.15"/>
</g>
<!-- dp0_pp2_layer15_attn_tp3 -->
<g id="node329" class="node">
<title>dp0_pp2_layer15_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="10535.5,-531.06 10270.5,-531.06 10270.5,-479.06 10535.5,-479.06 10535.5,-531.06"/>
<text text-anchor="middle" x="10403" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="10403" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="10403" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="10403" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer15_attn_tp3&#45;&gt;dp0_pp2_layer15_attn_allreduce -->
<g id="edge536" class="edge">
<title>dp0_pp2_layer15_attn_tp3&#45;&gt;dp0_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M10338.21,-478.95C10314.43,-470.18 10287.17,-460.64 10262,-453.06 10207.42,-436.63 10146.31,-421.31 10093.86,-409.08"/>
<polygon fill="black" stroke="black" points="10094.37,-405.6 10083.83,-406.75 10092.78,-412.42 10094.37,-405.6"/>
</g>
<!-- dp0_pp2_layer15_expert0 -->
<g id="node331" class="node">
<title>dp0_pp2_layer15_expert0</title>
<polygon fill="lightgreen" stroke="black" points="5767,-406.29 5543,-406.29 5543,-354.29 5767,-354.29 5767,-406.29"/>
<text text-anchor="middle" x="5655" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="5655" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="5655" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="5655" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert0 -->
<g id="edge537" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7267.73,-499.65C6882.55,-490.26 6057.11,-465.13 5776,-417.06 5763.99,-415.01 5751.48,-412.16 5739.27,-408.95"/>
<polygon fill="black" stroke="black" points="5740.11,-405.56 5729.54,-406.32 5738.28,-412.31 5740.11,-405.56"/>
</g>
<!-- dp0_pp2_layer15_expert1 -->
<g id="node332" class="node">
<title>dp0_pp2_layer15_expert1</title>
<polygon fill="lightgreen" stroke="black" points="6009,-406.29 5785,-406.29 5785,-354.29 6009,-354.29 6009,-406.29"/>
<text text-anchor="middle" x="5897" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="5897" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="5897" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="5897" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert1 -->
<g id="edge538" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7265.55,-497.55C6923.94,-485.71 6251.58,-458.03 6018,-417.06 6006.08,-414.97 5993.67,-412.12 5981.54,-408.93"/>
<polygon fill="black" stroke="black" points="5982.45,-405.55 5971.89,-406.3 5980.62,-412.3 5982.45,-405.55"/>
</g>
<!-- dp0_pp2_layer15_expert2 -->
<g id="node333" class="node">
<title>dp0_pp2_layer15_expert2</title>
<polygon fill="lightgreen" stroke="black" points="6251,-406.29 6027,-406.29 6027,-354.29 6251,-354.29 6251,-406.29"/>
<text text-anchor="middle" x="6139" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="6139" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="6139" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="6139" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert2 -->
<g id="edge539" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7270.82,-502.85C7029.66,-498.37 6612.02,-480.97 6260,-417.06 6248.38,-414.95 6236.29,-412.14 6224.44,-409.03"/>
<polygon fill="black" stroke="black" points="6225.13,-405.59 6214.56,-406.34 6223.29,-412.34 6225.13,-405.59"/>
</g>
<!-- dp0_pp2_layer15_expert3 -->
<g id="node334" class="node">
<title>dp0_pp2_layer15_expert3</title>
<polygon fill="lightgreen" stroke="black" points="6493,-406.29 6269,-406.29 6269,-354.29 6493,-354.29 6493,-406.29"/>
<text text-anchor="middle" x="6381" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="6381" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="6381" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="6381" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert3 -->
<g id="edge540" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7265.36,-497.41C7068.31,-488.25 6762.63,-466.79 6502,-417.06 6490.57,-414.88 6478.67,-412.06 6466.99,-408.97"/>
<polygon fill="black" stroke="black" points="6467.82,-405.57 6457.25,-406.31 6465.98,-412.32 6467.82,-405.57"/>
</g>
<!-- dp0_pp2_layer15_expert4 -->
<g id="node335" class="node">
<title>dp0_pp2_layer15_expert4</title>
<polygon fill="lightgreen" stroke="black" points="6735,-406.29 6511,-406.29 6511,-354.29 6735,-354.29 6735,-406.29"/>
<text text-anchor="middle" x="6623" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="6623" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="6623" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="6623" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert4 -->
<g id="edge541" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7256.43,-487.98C7110.99,-474.71 6914.64,-452.25 6744,-417.06 6733.05,-414.8 6721.65,-412.02 6710.43,-409.02"/>
<polygon fill="black" stroke="black" points="6711.19,-405.6 6700.62,-406.33 6709.34,-412.35 6711.19,-405.6"/>
</g>
<!-- dp0_pp2_layer15_expert5 -->
<g id="node336" class="node">
<title>dp0_pp2_layer15_expert5</title>
<polygon fill="lightgreen" stroke="black" points="6977,-406.29 6753,-406.29 6753,-354.29 6977,-354.29 6977,-406.29"/>
<text text-anchor="middle" x="6865" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="6865" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="6865" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="6865" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert5 -->
<g id="edge542" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7236.29,-467.38C7156.5,-453.44 7067,-436.25 6986,-417.06 6975.9,-414.67 6965.4,-411.94 6954.99,-409.07"/>
<polygon fill="black" stroke="black" points="6955.62,-405.62 6945.05,-406.3 6953.74,-412.36 6955.62,-405.62"/>
</g>
<!-- dp0_pp2_layer15_expert6 -->
<g id="node337" class="node">
<title>dp0_pp2_layer15_expert6</title>
<polygon fill="lightgreen" stroke="black" points="7219,-406.29 6995,-406.29 6995,-354.29 7219,-354.29 7219,-406.29"/>
<text text-anchor="middle" x="7107" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="7107" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="7107" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="7107" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert6 -->
<g id="edge543" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.94,-452.97C7275.16,-438.16 7228.94,-422.53 7190.87,-409.66"/>
<polygon fill="black" stroke="black" points="7191.97,-406.33 7181.38,-406.45 7189.73,-412.97 7191.97,-406.33"/>
</g>
<!-- dp0_pp2_layer15_expert7 -->
<g id="node338" class="node">
<title>dp0_pp2_layer15_expert7</title>
<polygon fill="lightgreen" stroke="black" points="7461,-406.29 7237,-406.29 7237,-354.29 7461,-354.29 7461,-406.29"/>
<text text-anchor="middle" x="7349" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="7349" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="7349" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="7349" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert7 -->
<g id="edge544" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7419.38,-452.71C7406.3,-439.43 7392.58,-425.51 7380.76,-413.52"/>
<polygon fill="black" stroke="black" points="7383.19,-411 7373.68,-406.33 7378.2,-415.91 7383.19,-411"/>
</g>
<!-- dp0_pp2_layer15_expert8 -->
<g id="node339" class="node">
<title>dp0_pp2_layer15_expert8</title>
<polygon fill="lightgreen" stroke="black" points="7703,-406.29 7479,-406.29 7479,-354.29 7703,-354.29 7703,-406.29"/>
<text text-anchor="middle" x="7591" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="7591" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="7591" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="7591" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert8 -->
<g id="edge545" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7520.61,-452.71C7533.7,-439.43 7547.42,-425.51 7559.23,-413.52"/>
<polygon fill="black" stroke="black" points="7561.79,-415.91 7566.32,-406.33 7556.81,-411 7561.79,-415.91"/>
</g>
<!-- dp0_pp2_layer15_expert9 -->
<g id="node340" class="node">
<title>dp0_pp2_layer15_expert9</title>
<polygon fill="lightgreen" stroke="black" points="7945,-406.29 7721,-406.29 7721,-354.29 7945,-354.29 7945,-406.29"/>
<text text-anchor="middle" x="7833" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="7833" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="7833" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="7833" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert9 -->
<g id="edge546" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7617.38,-454.21C7662.29,-439.03 7710.08,-422.86 7749.23,-409.62"/>
<polygon fill="black" stroke="black" points="7750.64,-412.84 7758.99,-406.32 7748.4,-406.21 7750.64,-412.84"/>
</g>
<!-- dp0_pp2_layer15_expert10 -->
<g id="node341" class="node">
<title>dp0_pp2_layer15_expert10</title>
<polygon fill="lightgreen" stroke="black" points="8187,-406.29 7963,-406.29 7963,-354.29 8187,-354.29 8187,-406.29"/>
<text text-anchor="middle" x="8075" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="8075" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="8075" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="8075" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert10 -->
<g id="edge547" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7640.89,-478.04C7733.98,-462.69 7850.88,-441.49 7954,-417.06 7964.09,-414.67 7974.6,-411.94 7985.01,-409.07"/>
<polygon fill="black" stroke="black" points="7986.26,-412.36 7994.95,-406.3 7984.37,-405.62 7986.26,-412.36"/>
</g>
<!-- dp0_pp2_layer15_expert11 -->
<g id="node342" class="node">
<title>dp0_pp2_layer15_expert11</title>
<polygon fill="lightgreen" stroke="black" points="8429,-406.29 8205,-406.29 8205,-354.29 8429,-354.29 8429,-406.29"/>
<text text-anchor="middle" x="8317" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="8317" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="8317" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="8317" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert11 -->
<g id="edge548" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7652.99,-490.7C7800.62,-477.88 8013.08,-454.78 8196,-417.06 8206.95,-414.8 8218.35,-412.02 8229.57,-409.02"/>
<polygon fill="black" stroke="black" points="8230.66,-412.35 8239.38,-406.33 8228.81,-405.6 8230.66,-412.35"/>
</g>
<!-- dp0_pp2_layer15_expert12 -->
<g id="node343" class="node">
<title>dp0_pp2_layer15_expert12</title>
<polygon fill="lightgreen" stroke="black" points="8671,-406.29 8447,-406.29 8447,-354.29 8671,-354.29 8671,-406.29"/>
<text text-anchor="middle" x="8559" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="8559" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="8559" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="8559" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert12 -->
<g id="edge549" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7660.27,-498.07C7856.59,-489.29 8170.95,-468.01 8438,-417.06 8449.43,-414.88 8461.33,-412.06 8473.01,-408.97"/>
<polygon fill="black" stroke="black" points="8474.02,-412.32 8482.75,-406.31 8472.18,-405.57 8474.02,-412.32"/>
</g>
<!-- dp0_pp2_layer15_expert13 -->
<g id="node344" class="node">
<title>dp0_pp2_layer15_expert13</title>
<polygon fill="lightgreen" stroke="black" points="8913,-406.29 8689,-406.29 8689,-354.29 8913,-354.29 8913,-406.29"/>
<text text-anchor="middle" x="8801" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="8801" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="8801" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="8801" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert13 -->
<g id="edge550" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7664.93,-502.93C7905.42,-498.58 8325.9,-481.35 8680,-417.06 8691.62,-414.95 8703.71,-412.14 8715.56,-409.03"/>
<polygon fill="black" stroke="black" points="8716.7,-412.34 8725.44,-406.34 8714.87,-405.59 8716.7,-412.34"/>
</g>
<!-- dp0_pp2_layer15_expert14 -->
<g id="node345" class="node">
<title>dp0_pp2_layer15_expert14</title>
<polygon fill="lightgreen" stroke="black" points="9155,-406.29 8931,-406.29 8931,-354.29 9155,-354.29 9155,-406.29"/>
<text text-anchor="middle" x="9043" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="9043" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="9043" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="9043" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert14 -->
<g id="edge551" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7660.32,-498.04C7997.17,-486.48 8685.15,-458.6 8922,-417.06 8933.92,-414.97 8946.32,-412.12 8958.46,-408.93"/>
<polygon fill="black" stroke="black" points="8959.38,-412.3 8968.11,-406.3 8957.54,-405.55 8959.38,-412.3"/>
</g>
<!-- dp0_pp2_layer15_expert15 -->
<g id="node346" class="node">
<title>dp0_pp2_layer15_expert15</title>
<polygon fill="lightgreen" stroke="black" points="9397,-406.29 9173,-406.29 9173,-354.29 9397,-354.29 9397,-406.29"/>
<text text-anchor="middle" x="9285" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="9285" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="9285" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="9285" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert15 -->
<g id="edge552" class="edge">
<title>dp0_pp2_layer15_router&#45;&gt;dp0_pp2_layer15_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7661.94,-499.9C8042.49,-490.72 8880.35,-465.57 9164,-417.06 9176.01,-415.01 9188.51,-412.16 9200.73,-408.95"/>
<polygon fill="black" stroke="black" points="9201.72,-412.31 9210.45,-406.32 9199.88,-405.56 9201.72,-412.31"/>
</g>
<!-- dp0_pp2_layer15_expert_agg -->
<g id="node347" class="node">
<title>dp0_pp2_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="7717.57,-307.52 7323.74,-307.52 7222.43,-203.52 7616.26,-203.52 7717.57,-307.52"/>
<text text-anchor="middle" x="7470" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="7470" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="7470" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="7470" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer15_expert0&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge553" class="edge">
<title>dp0_pp2_layer15_expert0&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M5713.07,-354.29C5732.69,-346.92 5754.97,-339.72 5776,-335.52 6055.13,-279.86 6878.93,-263.21 7265.43,-258.4"/>
<polygon fill="black" stroke="black" points="7265.65,-261.9 7275.61,-258.27 7265.57,-254.9 7265.65,-261.9"/>
</g>
<!-- dp0_pp2_layer15_expert1&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge554" class="edge">
<title>dp0_pp2_layer15_expert1&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M5955.39,-354.27C5974.95,-346.95 5997.09,-339.78 6018,-335.52 6250.8,-288.16 6926.09,-267.74 7267.43,-260.24"/>
<polygon fill="black" stroke="black" points="7267.51,-263.74 7277.43,-260.03 7267.35,-256.74 7267.51,-263.74"/>
</g>
<!-- dp0_pp2_layer15_expert2&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge555" class="edge">
<title>dp0_pp2_layer15_expert2&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M6197.73,-354.29C6217.21,-347.01 6239.23,-339.87 6260,-335.52 6446.91,-296.44 6976.54,-273.07 7269.3,-262.78"/>
<polygon fill="black" stroke="black" points="7269.74,-266.27 7279.61,-262.42 7269.5,-259.27 7269.74,-266.27"/>
</g>
<!-- dp0_pp2_layer15_expert3&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge556" class="edge">
<title>dp0_pp2_layer15_expert3&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M6440.39,-354.26C6459.72,-347.07 6481.48,-339.99 6502,-335.52 6760.91,-279.18 7066.7,-262.24 7264.26,-257.56"/>
<polygon fill="black" stroke="black" points="7264.55,-261.06 7274.47,-257.33 7264.39,-254.06 7264.55,-261.06"/>
</g>
<!-- dp0_pp2_layer15_expert4&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge557" class="edge">
<title>dp0_pp2_layer15_expert4&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M6683.39,-354.24C6702.49,-347.2 6723.87,-340.19 6744,-335.52 6919.82,-294.77 7124.6,-274.91 7271.75,-265.31"/>
<polygon fill="black" stroke="black" points="7272.05,-268.8 7281.81,-264.67 7271.6,-261.82 7272.05,-268.8"/>
</g>
<!-- dp0_pp2_layer15_expert5&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge558" class="edge">
<title>dp0_pp2_layer15_expert5&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M6927.42,-354.22C6946.04,-347.42 6966.65,-340.55 6986,-335.52 7083.09,-310.27 7193.34,-291.53 7284.07,-278.65"/>
<polygon fill="black" stroke="black" points="7284.78,-282.09 7294.19,-277.23 7283.8,-275.16 7284.78,-282.09"/>
</g>
<!-- dp0_pp2_layer15_expert6&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge559" class="edge">
<title>dp0_pp2_layer15_expert6&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M7175.02,-354.26C7192.26,-348.03 7210.78,-341.44 7228,-335.52 7254.73,-326.33 7283.21,-316.8 7310.89,-307.67"/>
<polygon fill="black" stroke="black" points="7312.24,-310.91 7320.65,-304.46 7310.06,-304.26 7312.24,-310.91"/>
</g>
<!-- dp0_pp2_layer15_expert7&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge560" class="edge">
<title>dp0_pp2_layer15_expert7&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M7373.78,-354.15C7385.02,-342.74 7398.83,-328.73 7412.45,-314.92"/>
<polygon fill="black" stroke="black" points="7415,-317.31 7419.53,-307.73 7410.02,-312.39 7415,-317.31"/>
</g>
<!-- dp0_pp2_layer15_expert8&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge561" class="edge">
<title>dp0_pp2_layer15_expert8&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M7566.22,-354.15C7554.97,-342.74 7541.16,-328.73 7527.55,-314.92"/>
<polygon fill="black" stroke="black" points="7529.98,-312.39 7520.47,-307.73 7524.99,-317.31 7529.98,-312.39"/>
</g>
<!-- dp0_pp2_layer15_expert9&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge562" class="edge">
<title>dp0_pp2_layer15_expert9&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M7764.98,-354.26C7747.73,-348.03 7729.21,-341.44 7712,-335.52 7688.29,-327.37 7663.21,-318.95 7638.53,-310.78"/>
<polygon fill="black" stroke="black" points="7639.32,-307.36 7628.73,-307.54 7637.12,-314 7639.32,-307.36"/>
</g>
<!-- dp0_pp2_layer15_expert10&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge563" class="edge">
<title>dp0_pp2_layer15_expert10&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8012.58,-354.22C7993.96,-347.42 7973.35,-340.55 7954,-335.52 7873.99,-314.71 7785.05,-298.33 7705.46,-286"/>
<polygon fill="black" stroke="black" points="7705.71,-282.5 7695.3,-284.44 7704.65,-289.41 7705.71,-282.5"/>
</g>
<!-- dp0_pp2_layer15_expert11&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge564" class="edge">
<title>dp0_pp2_layer15_expert11&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8256.61,-354.24C8237.51,-347.2 8216.13,-340.19 8196,-335.52 8027.74,-296.53 7832.97,-276.66 7687.55,-266.61"/>
<polygon fill="black" stroke="black" points="7687.38,-263.09 7677.16,-265.9 7686.9,-270.07 7687.38,-263.09"/>
</g>
<!-- dp0_pp2_layer15_expert12&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge565" class="edge">
<title>dp0_pp2_layer15_expert12&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8499.61,-354.26C8480.28,-347.07 8458.52,-339.99 8438,-335.52 8180.51,-279.49 7876.64,-262.43 7678.99,-257.64"/>
<polygon fill="black" stroke="black" points="7678.86,-254.14 7668.78,-257.4 7678.69,-261.13 7678.86,-254.14"/>
</g>
<!-- dp0_pp2_layer15_expert13&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge566" class="edge">
<title>dp0_pp2_layer15_expert13&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8742.27,-354.29C8722.79,-347.01 8700.77,-339.87 8680,-335.52 8496.02,-297.05 7979.97,-273.81 7684.63,-263.27"/>
<polygon fill="black" stroke="black" points="7684.33,-259.76 7674.21,-262.9 7684.08,-266.76 7684.33,-259.76"/>
</g>
<!-- dp0_pp2_layer15_expert14&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge567" class="edge">
<title>dp0_pp2_layer15_expert14&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M8984.6,-354.27C8965.05,-346.95 8942.9,-339.78 8922,-335.52 8691.27,-288.58 8025.86,-268.1 7681.74,-260.45"/>
<polygon fill="black" stroke="black" points="7681.73,-256.94 7671.65,-260.22 7681.57,-263.94 7681.73,-256.94"/>
</g>
<!-- dp0_pp2_layer15_expert15&#45;&gt;dp0_pp2_layer15_expert_agg -->
<g id="edge568" class="edge">
<title>dp0_pp2_layer15_expert15&#45;&gt;dp0_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M9226.93,-354.29C9207.3,-346.92 9185.03,-339.72 9164,-335.52 8886.21,-280.12 8068.98,-263.37 7680.17,-258.47"/>
<polygon fill="black" stroke="black" points="7679.97,-254.97 7669.93,-258.34 7679.88,-261.97 7679.97,-254.97"/>
</g>
<!-- dp0_pp2_layer16_attn_tp0 -->
<g id="node348" class="node">
<title>dp0_pp2_layer16_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="4952.5,-531.06 4687.5,-531.06 4687.5,-479.06 4952.5,-479.06 4952.5,-531.06"/>
<text text-anchor="middle" x="4820" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="4820" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="4820" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="4820" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer15_expert_agg&#45;&gt;dp0_pp2_layer16_attn_tp0 -->
<g id="edge570" class="edge">
<title>dp0_pp2_layer15_expert_agg&#45;&gt;dp0_pp2_layer16_attn_tp0</title>
<path fill="none" stroke="black" d="M7277.78,-260.41C6857.38,-269.54 5867.17,-294.77 5534,-335.52 5501.8,-339.46 4993.23,-444.29 4962,-453.06 4939.37,-459.41 4915.16,-467.58 4893.26,-475.5"/>
<polygon fill="black" stroke="black" points="4891.89,-472.28 4883.7,-479 4894.29,-478.85 4891.89,-472.28"/>
</g>
<!-- dp0_pp2_layer16_attn_allreduce -->
<g id="node349" class="node">
<title>dp0_pp2_layer16_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="4949" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="4949" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="4949" y="-383.29" font-family="Arial" font-size="10.00">GPUs 16&#45;19</text>
<text text-anchor="middle" x="4949" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="4949" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_attn_tp0&#45;&gt;dp0_pp2_layer16_attn_allreduce -->
<g id="edge571" class="edge">
<title>dp0_pp2_layer16_attn_tp0&#45;&gt;dp0_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M4846.41,-478.92C4863.15,-463 4885.21,-442 4904.58,-423.56"/>
<polygon fill="black" stroke="black" points="4907.03,-426.07 4911.86,-416.64 4902.2,-421 4907.03,-426.07"/>
</g>
<!-- dp0_pp2_layer16_router -->
<g id="node353" class="node">
<title>dp0_pp2_layer16_router</title>
<polygon fill="lightyellow" stroke="black" points="2700.57,-557.06 2306.74,-557.06 2205.43,-453.06 2599.26,-453.06 2700.57,-557.06"/>
<text text-anchor="middle" x="2453" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="2453" y="-508.06" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="2453" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="2453" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_attn_allreduce&#45;&gt;dp0_pp2_layer16_router -->
<g id="edge607" class="edge">
<title>dp0_pp2_layer16_attn_allreduce&#45;&gt;dp0_pp2_layer16_router</title>
<path fill="none" stroke="black" d="M4789.08,-392.38C4677.77,-399.9 4525.89,-409.76 4392,-417.06 3756.5,-451.72 3003.28,-482.59 2651.96,-496.4"/>
<polygon fill="black" stroke="black" points="2651.8,-492.91 2641.94,-496.79 2652.07,-499.9 2651.8,-492.91"/>
</g>
<!-- dp0_pp2_layer16_attn_tp1 -->
<g id="node350" class="node">
<title>dp0_pp2_layer16_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="5235.5,-531.06 4970.5,-531.06 4970.5,-479.06 5235.5,-479.06 5235.5,-531.06"/>
<text text-anchor="middle" x="5103" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="5103" y="-508.06" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="5103" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5103" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer16_attn_tp1&#45;&gt;dp0_pp2_layer16_attn_allreduce -->
<g id="edge572" class="edge">
<title>dp0_pp2_layer16_attn_tp1&#45;&gt;dp0_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M5071.46,-478.92C5050.99,-462.6 5023.83,-440.94 5000.29,-422.18"/>
<polygon fill="black" stroke="black" points="5002.46,-419.44 4992.46,-415.94 4998.1,-424.91 5002.46,-419.44"/>
</g>
<!-- dp0_pp2_layer16_attn_tp2 -->
<g id="node351" class="node">
<title>dp0_pp2_layer16_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="4669.5,-531.06 4404.5,-531.06 4404.5,-479.06 4669.5,-479.06 4669.5,-531.06"/>
<text text-anchor="middle" x="4537" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="4537" y="-508.06" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="4537" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="4537" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer16_attn_tp2&#45;&gt;dp0_pp2_layer16_attn_allreduce -->
<g id="edge573" class="edge">
<title>dp0_pp2_layer16_attn_tp2&#45;&gt;dp0_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M4603.07,-479.02C4626.85,-470.35 4653.99,-460.86 4679,-453.06 4727.74,-437.86 4782.05,-423.03 4829.1,-410.83"/>
<polygon fill="black" stroke="black" points="4830.22,-414.15 4839.03,-408.26 4828.47,-407.38 4830.22,-414.15"/>
</g>
<!-- dp0_pp2_layer16_attn_tp3 -->
<g id="node352" class="node">
<title>dp0_pp2_layer16_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="5518.5,-531.06 5253.5,-531.06 5253.5,-479.06 5518.5,-479.06 5518.5,-531.06"/>
<text text-anchor="middle" x="5386" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="5386" y="-508.06" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="5386" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5386" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp0_pp2_layer16_attn_tp3&#45;&gt;dp0_pp2_layer16_attn_allreduce -->
<g id="edge574" class="edge">
<title>dp0_pp2_layer16_attn_tp3&#45;&gt;dp0_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M5321.21,-478.95C5297.43,-470.18 5270.17,-460.64 5245,-453.06 5190.42,-436.63 5129.31,-421.31 5076.86,-409.08"/>
<polygon fill="black" stroke="black" points="5077.37,-405.6 5066.83,-406.75 5075.78,-412.42 5077.37,-405.6"/>
</g>
<!-- dp0_pp2_layer16_expert0 -->
<g id="node354" class="node">
<title>dp0_pp2_layer16_expert0</title>
<polygon fill="lightgreen" stroke="black" points="750,-406.29 526,-406.29 526,-354.29 750,-354.29 750,-406.29"/>
<text text-anchor="middle" x="638" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="638" y="-383.29" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="638" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="638" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert0 -->
<g id="edge575" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2250.73,-499.65C1865.55,-490.26 1040.11,-465.13 759,-417.06 746.99,-415.01 734.48,-412.16 722.27,-408.95"/>
<polygon fill="black" stroke="black" points="723.11,-405.56 712.54,-406.32 721.28,-412.31 723.11,-405.56"/>
</g>
<!-- dp0_pp2_layer16_expert1 -->
<g id="node355" class="node">
<title>dp0_pp2_layer16_expert1</title>
<polygon fill="lightgreen" stroke="black" points="992,-406.29 768,-406.29 768,-354.29 992,-354.29 992,-406.29"/>
<text text-anchor="middle" x="880" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="880" y="-383.29" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="880" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="880" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert1 -->
<g id="edge576" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2248.55,-497.55C1906.94,-485.71 1234.58,-458.03 1001,-417.06 989.08,-414.97 976.67,-412.12 964.54,-408.93"/>
<polygon fill="black" stroke="black" points="965.45,-405.55 954.89,-406.3 963.62,-412.3 965.45,-405.55"/>
</g>
<!-- dp0_pp2_layer16_expert2 -->
<g id="node356" class="node">
<title>dp0_pp2_layer16_expert2</title>
<polygon fill="lightgreen" stroke="black" points="1234,-406.29 1010,-406.29 1010,-354.29 1234,-354.29 1234,-406.29"/>
<text text-anchor="middle" x="1122" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1122" y="-383.29" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1122" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="1122" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert2 -->
<g id="edge577" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2253.82,-502.85C2012.66,-498.37 1595.02,-480.97 1243,-417.06 1231.38,-414.95 1219.29,-412.14 1207.44,-409.03"/>
<polygon fill="black" stroke="black" points="1208.13,-405.59 1197.56,-406.34 1206.29,-412.34 1208.13,-405.59"/>
</g>
<!-- dp0_pp2_layer16_expert3 -->
<g id="node357" class="node">
<title>dp0_pp2_layer16_expert3</title>
<polygon fill="lightgreen" stroke="black" points="1476,-406.29 1252,-406.29 1252,-354.29 1476,-354.29 1476,-406.29"/>
<text text-anchor="middle" x="1364" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1364" y="-383.29" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1364" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="1364" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert3 -->
<g id="edge578" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2248.36,-497.41C2051.31,-488.25 1745.63,-466.79 1485,-417.06 1473.57,-414.88 1461.67,-412.06 1449.99,-408.97"/>
<polygon fill="black" stroke="black" points="1450.82,-405.57 1440.25,-406.31 1448.98,-412.32 1450.82,-405.57"/>
</g>
<!-- dp0_pp2_layer16_expert4 -->
<g id="node358" class="node">
<title>dp0_pp2_layer16_expert4</title>
<polygon fill="lightgreen" stroke="black" points="1718,-406.29 1494,-406.29 1494,-354.29 1718,-354.29 1718,-406.29"/>
<text text-anchor="middle" x="1606" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1606" y="-383.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1606" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="1606" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert4 -->
<g id="edge579" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2239.43,-487.98C2093.99,-474.71 1897.64,-452.25 1727,-417.06 1716.05,-414.8 1704.65,-412.02 1693.43,-409.02"/>
<polygon fill="black" stroke="black" points="1694.19,-405.6 1683.62,-406.33 1692.34,-412.35 1694.19,-405.6"/>
</g>
<!-- dp0_pp2_layer16_expert5 -->
<g id="node359" class="node">
<title>dp0_pp2_layer16_expert5</title>
<polygon fill="lightgreen" stroke="black" points="1960,-406.29 1736,-406.29 1736,-354.29 1960,-354.29 1960,-406.29"/>
<text text-anchor="middle" x="1848" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1848" y="-383.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1848" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="1848" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert5 -->
<g id="edge580" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2219.29,-467.38C2139.5,-453.44 2050,-436.25 1969,-417.06 1958.9,-414.67 1948.4,-411.94 1937.99,-409.07"/>
<polygon fill="black" stroke="black" points="1938.62,-405.62 1928.05,-406.3 1936.74,-412.36 1938.62,-405.62"/>
</g>
<!-- dp0_pp2_layer16_expert6 -->
<g id="node360" class="node">
<title>dp0_pp2_layer16_expert6</title>
<polygon fill="lightgreen" stroke="black" points="2202,-406.29 1978,-406.29 1978,-354.29 2202,-354.29 2202,-406.29"/>
<text text-anchor="middle" x="2090" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2090" y="-383.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="2090" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="2090" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert6 -->
<g id="edge581" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2301.94,-452.97C2258.16,-438.16 2211.94,-422.53 2173.87,-409.66"/>
<polygon fill="black" stroke="black" points="2174.97,-406.33 2164.38,-406.45 2172.73,-412.97 2174.97,-406.33"/>
</g>
<!-- dp0_pp2_layer16_expert7 -->
<g id="node361" class="node">
<title>dp0_pp2_layer16_expert7</title>
<polygon fill="lightgreen" stroke="black" points="2444,-406.29 2220,-406.29 2220,-354.29 2444,-354.29 2444,-406.29"/>
<text text-anchor="middle" x="2332" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2332" y="-383.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="2332" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="2332" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert7 -->
<g id="edge582" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2402.38,-452.71C2389.3,-439.43 2375.58,-425.51 2363.76,-413.52"/>
<polygon fill="black" stroke="black" points="2366.19,-411 2356.68,-406.33 2361.2,-415.91 2366.19,-411"/>
</g>
<!-- dp0_pp2_layer16_expert8 -->
<g id="node362" class="node">
<title>dp0_pp2_layer16_expert8</title>
<polygon fill="lightgreen" stroke="black" points="2686,-406.29 2462,-406.29 2462,-354.29 2686,-354.29 2686,-406.29"/>
<text text-anchor="middle" x="2574" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2574" y="-383.29" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="2574" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="2574" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert8 -->
<g id="edge583" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2503.61,-452.71C2516.7,-439.43 2530.42,-425.51 2542.23,-413.52"/>
<polygon fill="black" stroke="black" points="2544.79,-415.91 2549.32,-406.33 2539.81,-411 2544.79,-415.91"/>
</g>
<!-- dp0_pp2_layer16_expert9 -->
<g id="node363" class="node">
<title>dp0_pp2_layer16_expert9</title>
<polygon fill="lightgreen" stroke="black" points="2928,-406.29 2704,-406.29 2704,-354.29 2928,-354.29 2928,-406.29"/>
<text text-anchor="middle" x="2816" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="2816" y="-383.29" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="2816" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="2816" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert9 -->
<g id="edge584" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2600.38,-454.21C2645.29,-439.03 2693.08,-422.86 2732.23,-409.62"/>
<polygon fill="black" stroke="black" points="2733.64,-412.84 2741.99,-406.32 2731.4,-406.21 2733.64,-412.84"/>
</g>
<!-- dp0_pp2_layer16_expert10 -->
<g id="node364" class="node">
<title>dp0_pp2_layer16_expert10</title>
<polygon fill="lightgreen" stroke="black" points="3170,-406.29 2946,-406.29 2946,-354.29 3170,-354.29 3170,-406.29"/>
<text text-anchor="middle" x="3058" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3058" y="-383.29" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="3058" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="3058" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert10 -->
<g id="edge585" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2623.89,-478.04C2716.98,-462.69 2833.88,-441.49 2937,-417.06 2947.09,-414.67 2957.6,-411.94 2968.01,-409.07"/>
<polygon fill="black" stroke="black" points="2969.26,-412.36 2977.95,-406.3 2967.37,-405.62 2969.26,-412.36"/>
</g>
<!-- dp0_pp2_layer16_expert11 -->
<g id="node365" class="node">
<title>dp0_pp2_layer16_expert11</title>
<polygon fill="lightgreen" stroke="black" points="3412,-406.29 3188,-406.29 3188,-354.29 3412,-354.29 3412,-406.29"/>
<text text-anchor="middle" x="3300" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3300" y="-383.29" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="3300" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="3300" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert11 -->
<g id="edge586" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2635.99,-490.7C2783.62,-477.88 2996.08,-454.78 3179,-417.06 3189.95,-414.8 3201.35,-412.02 3212.57,-409.02"/>
<polygon fill="black" stroke="black" points="3213.66,-412.35 3222.38,-406.33 3211.81,-405.6 3213.66,-412.35"/>
</g>
<!-- dp0_pp2_layer16_expert12 -->
<g id="node366" class="node">
<title>dp0_pp2_layer16_expert12</title>
<polygon fill="lightgreen" stroke="black" points="3654,-406.29 3430,-406.29 3430,-354.29 3654,-354.29 3654,-406.29"/>
<text text-anchor="middle" x="3542" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="3542" y="-383.29" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="3542" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="3542" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert12 -->
<g id="edge587" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2643.27,-498.07C2839.59,-489.29 3153.95,-468.01 3421,-417.06 3432.43,-414.88 3444.33,-412.06 3456.01,-408.97"/>
<polygon fill="black" stroke="black" points="3457.02,-412.32 3465.75,-406.31 3455.18,-405.57 3457.02,-412.32"/>
</g>
<!-- dp0_pp2_layer16_expert13 -->
<g id="node367" class="node">
<title>dp0_pp2_layer16_expert13</title>
<polygon fill="lightgreen" stroke="black" points="3896,-406.29 3672,-406.29 3672,-354.29 3896,-354.29 3896,-406.29"/>
<text text-anchor="middle" x="3784" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="3784" y="-383.29" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="3784" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="3784" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert13 -->
<g id="edge588" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2647.93,-502.93C2888.42,-498.58 3308.9,-481.35 3663,-417.06 3674.62,-414.95 3686.71,-412.14 3698.56,-409.03"/>
<polygon fill="black" stroke="black" points="3699.7,-412.34 3708.44,-406.34 3697.87,-405.59 3699.7,-412.34"/>
</g>
<!-- dp0_pp2_layer16_expert14 -->
<g id="node368" class="node">
<title>dp0_pp2_layer16_expert14</title>
<polygon fill="lightgreen" stroke="black" points="4138,-406.29 3914,-406.29 3914,-354.29 4138,-354.29 4138,-406.29"/>
<text text-anchor="middle" x="4026" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4026" y="-383.29" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="4026" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="4026" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert14 -->
<g id="edge589" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2643.32,-498.04C2980.17,-486.48 3668.15,-458.6 3905,-417.06 3916.92,-414.97 3929.32,-412.12 3941.46,-408.93"/>
<polygon fill="black" stroke="black" points="3942.38,-412.3 3951.11,-406.3 3940.54,-405.55 3942.38,-412.3"/>
</g>
<!-- dp0_pp2_layer16_expert15 -->
<g id="node369" class="node">
<title>dp0_pp2_layer16_expert15</title>
<polygon fill="lightgreen" stroke="black" points="4380,-406.29 4156,-406.29 4156,-354.29 4380,-354.29 4380,-406.29"/>
<text text-anchor="middle" x="4268" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4268" y="-383.29" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="4268" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="4268" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert15 -->
<g id="edge590" class="edge">
<title>dp0_pp2_layer16_router&#45;&gt;dp0_pp2_layer16_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2644.94,-499.9C3025.49,-490.72 3863.35,-465.57 4147,-417.06 4159.01,-415.01 4171.51,-412.16 4183.73,-408.95"/>
<polygon fill="black" stroke="black" points="4184.72,-412.31 4193.45,-406.32 4182.88,-405.56 4184.72,-412.31"/>
</g>
<!-- dp0_pp2_layer16_expert_agg -->
<g id="node370" class="node">
<title>dp0_pp2_layer16_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="2821.57,-307.52 2427.74,-307.52 2326.43,-203.52 2720.26,-203.52 2821.57,-307.52"/>
<text text-anchor="middle" x="2574" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2574" y="-258.52" font-family="Arial" font-size="10.00">GPUs 16&#45;31</text>
<text text-anchor="middle" x="2574" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="2574" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_expert0&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge591" class="edge">
<title>dp0_pp2_layer16_expert0&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M696.06,-354.25C715.69,-346.88 737.96,-339.68 759,-335.52 1061.52,-275.68 1960.92,-261.16 2368.8,-257.65"/>
<polygon fill="black" stroke="black" points="2368.96,-261.14 2378.93,-257.56 2368.9,-254.15 2368.96,-261.14"/>
</g>
<!-- dp0_pp2_layer16_expert1&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge592" class="edge">
<title>dp0_pp2_layer16_expert1&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M938.38,-354.21C957.94,-346.89 980.08,-339.73 1001,-335.52 1256.86,-284.02 2005.83,-265.4 2370.21,-259.26"/>
<polygon fill="black" stroke="black" points="2370.4,-262.76 2380.34,-259.09 2370.28,-255.76 2370.4,-262.76"/>
</g>
<!-- dp0_pp2_layer16_expert2&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge593" class="edge">
<title>dp0_pp2_layer16_expert2&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M1180.71,-354.21C1200.19,-346.94 1222.21,-339.8 1243,-335.52 1452.71,-292.32 2054.36,-270.3 2372,-261.41"/>
<polygon fill="black" stroke="black" points="2372.34,-264.9 2382.24,-261.13 2372.15,-257.91 2372.34,-264.9"/>
</g>
<!-- dp0_pp2_layer16_expert3&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge594" class="edge">
<title>dp0_pp2_layer16_expert3&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M1423.05,-354.26C1442.46,-347.03 1464.35,-339.92 1485,-335.52 1649.34,-300.54 2108.32,-276.12 2375.04,-264.41"/>
<polygon fill="black" stroke="black" points="2375.4,-267.9 2385.24,-263.97 2375.09,-260.91 2375.4,-267.9"/>
</g>
<!-- dp0_pp2_layer16_expert4&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge595" class="edge">
<title>dp0_pp2_layer16_expert4&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M1665.73,-354.28C1684.98,-347.15 1706.62,-340.08 1727,-335.52 1943.91,-287.01 2198.52,-268.23 2371.54,-261"/>
<polygon fill="black" stroke="black" points="2371.93,-264.48 2381.78,-260.58 2371.64,-257.49 2371.93,-264.48"/>
</g>
<!-- dp0_pp2_layer16_expert5&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge596" class="edge">
<title>dp0_pp2_layer16_expert5&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M1909.07,-354.28C1928.02,-347.32 1949.14,-340.35 1969,-335.52 2104.78,-302.51 2261.27,-282.55 2381.08,-270.95"/>
<polygon fill="black" stroke="black" points="2381.47,-274.42 2391.09,-269.99 2380.8,-267.46 2381.47,-274.42"/>
</g>
<!-- dp0_pp2_layer16_expert6&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge597" class="edge">
<title>dp0_pp2_layer16_expert6&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M2154.16,-354.29C2172.37,-347.69 2192.32,-340.91 2211,-335.52 2271.46,-318.09 2338.57,-302.47 2398.47,-289.81"/>
<polygon fill="black" stroke="black" points="2399.33,-293.21 2408.4,-287.73 2397.9,-286.36 2399.33,-293.21"/>
</g>
<!-- dp0_pp2_layer16_expert7&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge598" class="edge">
<title>dp0_pp2_layer16_expert7&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M2381.55,-354.15C2405.49,-342.01 2435.24,-326.92 2464.13,-312.26"/>
<polygon fill="black" stroke="black" points="2465.73,-315.37 2473.06,-307.73 2462.56,-309.13 2465.73,-315.37"/>
</g>
<!-- dp0_pp2_layer16_expert8&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge599" class="edge">
<title>dp0_pp2_layer16_expert8&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M2574,-354.15C2574,-343.58 2574,-330.77 2574,-317.96"/>
<polygon fill="black" stroke="black" points="2577.5,-317.73 2574,-307.73 2570.5,-317.73 2577.5,-317.73"/>
</g>
<!-- dp0_pp2_layer16_expert9&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge600" class="edge">
<title>dp0_pp2_layer16_expert9&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M2766.44,-354.15C2742.51,-342.01 2712.76,-326.92 2683.87,-312.26"/>
<polygon fill="black" stroke="black" points="2685.44,-309.13 2674.93,-307.73 2682.27,-315.37 2685.44,-309.13"/>
</g>
<!-- dp0_pp2_layer16_expert10&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge601" class="edge">
<title>dp0_pp2_layer16_expert10&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M2993.84,-354.29C2975.63,-347.69 2955.67,-340.91 2937,-335.52 2902.59,-325.6 2866.02,-316.27 2829.86,-307.73"/>
<polygon fill="black" stroke="black" points="2830.21,-304.22 2819.68,-305.35 2828.61,-311.03 2830.21,-304.22"/>
</g>
<!-- dp0_pp2_layer16_expert11&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge602" class="edge">
<title>dp0_pp2_layer16_expert11&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M3238.93,-354.28C3219.98,-347.32 3198.86,-340.35 3179,-335.52 3054.73,-305.31 2913.11,-286.03 2798.15,-274.08"/>
<polygon fill="black" stroke="black" points="2798.47,-270.6 2788.17,-273.05 2797.76,-277.56 2798.47,-270.6"/>
</g>
<!-- dp0_pp2_layer16_expert12&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge603" class="edge">
<title>dp0_pp2_layer16_expert12&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M3482.27,-354.28C3463.02,-347.15 3441.38,-340.08 3421,-335.52 3208.33,-287.95 2959.41,-268.98 2786.7,-261.43"/>
<polygon fill="black" stroke="black" points="2786.61,-257.93 2776.47,-261 2786.31,-264.92 2786.61,-257.93"/>
</g>
<!-- dp0_pp2_layer16_expert13&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge604" class="edge">
<title>dp0_pp2_layer16_expert13&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M3724.94,-354.26C3705.54,-347.03 3683.65,-339.92 3663,-335.52 3502.14,-301.28 3059.03,-277.16 2790.2,-265.18"/>
<polygon fill="black" stroke="black" points="2790.06,-261.67 2779.92,-264.72 2789.75,-268.66 2790.06,-261.67"/>
</g>
<!-- dp0_pp2_layer16_expert14&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge605" class="edge">
<title>dp0_pp2_layer16_expert14&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M3967.28,-354.21C3947.81,-346.94 3925.78,-339.8 3905,-335.52 3697.74,-292.82 3107.66,-270.82 2787.26,-261.73"/>
<polygon fill="black" stroke="black" points="2787.02,-258.22 2776.92,-261.44 2786.82,-265.22 2787.02,-258.22"/>
</g>
<!-- dp0_pp2_layer16_expert15&#45;&gt;dp0_pp2_layer16_expert_agg -->
<g id="edge606" class="edge">
<title>dp0_pp2_layer16_expert15&#45;&gt;dp0_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M4209.61,-354.21C4190.06,-346.89 4167.91,-339.73 4147,-335.52 3892.8,-284.35 3151.86,-265.64 2784.93,-259.38"/>
<polygon fill="black" stroke="black" points="2784.78,-255.88 2774.72,-259.21 2784.66,-262.88 2784.78,-255.88"/>
</g>
<!-- output_dp0 -->
<g id="node1479" class="node">
<title>output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="41521" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="41521" y="-144.75" font-family="Arial" font-size="10.00">Output DP0</text>
<text text-anchor="middle" x="41521" y="-133.75" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="41521" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="41521" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp0_pp2_layer16_expert_agg&#45;&gt;output_dp0 -->
<g id="edge2434" class="edge">
<title>dp0_pp2_layer16_expert_agg&#45;&gt;output_dp0</title>
<path fill="none" stroke="black" d="M2763.8,-248.13C3233.11,-232.66 4485.73,-193.47 5531,-179.52 9354.29,-128.51 38770.58,-131.38 41341.7,-131.73"/>
<polygon fill="black" stroke="black" points="41341.92,-135.23 41351.92,-131.73 41341.92,-128.23 41341.92,-135.23"/>
</g>
<!-- dp1_pp1_layer1_attn_tp0 -->
<g id="node371" class="node">
<title>dp1_pp1_layer1_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="160563.5,-531.06 160298.5,-531.06 160298.5,-479.06 160563.5,-479.06 160563.5,-531.06"/>
<text text-anchor="middle" x="160431" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="160431" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="160431" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160431" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer1_attn_allreduce -->
<g id="node372" class="node">
<title>dp1_pp1_layer1_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="160572" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="160572" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="160572" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="160572" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="160572" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_attn_tp0&#45;&gt;dp1_pp1_layer1_attn_allreduce -->
<g id="edge608" class="edge">
<title>dp1_pp1_layer1_attn_tp0&#45;&gt;dp1_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M160459.87,-478.92C160478.39,-462.8 160502.87,-441.49 160524.23,-422.89"/>
<polygon fill="black" stroke="black" points="160526.7,-425.38 160531.94,-416.17 160522.1,-420.1 160526.7,-425.38"/>
</g>
<!-- dp1_pp1_layer1_router -->
<g id="node376" class="node">
<title>dp1_pp1_layer1_router</title>
<polygon fill="lightyellow" stroke="black" points="158311.57,-557.06 157917.74,-557.06 157816.43,-453.06 158210.26,-453.06 158311.57,-557.06"/>
<text text-anchor="middle" x="158064" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="158064" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="158064" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="158064" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_attn_allreduce&#45;&gt;dp1_pp1_layer1_router -->
<g id="edge644" class="edge">
<title>dp1_pp1_layer1_attn_allreduce&#45;&gt;dp1_pp1_layer1_router</title>
<path fill="none" stroke="black" d="M160411.7,-392.14C160297.73,-399.66 160141,-409.63 160003,-417.06 159367.48,-451.29 158614.27,-482.37 158262.96,-496.31"/>
<polygon fill="black" stroke="black" points="158262.79,-492.82 158252.94,-496.71 158263.07,-499.81 158262.79,-492.82"/>
</g>
<!-- dp1_pp1_layer1_attn_tp1 -->
<g id="node373" class="node">
<title>dp1_pp1_layer1_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="160846.5,-531.06 160581.5,-531.06 160581.5,-479.06 160846.5,-479.06 160846.5,-531.06"/>
<text text-anchor="middle" x="160714" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="160714" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="160714" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160714" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer1_attn_tp1&#45;&gt;dp1_pp1_layer1_attn_allreduce -->
<g id="edge609" class="edge">
<title>dp1_pp1_layer1_attn_tp1&#45;&gt;dp1_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M160684.92,-478.92C160666.28,-462.8 160641.62,-441.49 160620.11,-422.89"/>
<polygon fill="black" stroke="black" points="160622.2,-420.06 160612.34,-416.17 160617.62,-425.36 160622.2,-420.06"/>
</g>
<!-- dp1_pp1_layer1_attn_tp2 -->
<g id="node374" class="node">
<title>dp1_pp1_layer1_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="160280.5,-531.06 160015.5,-531.06 160015.5,-479.06 160280.5,-479.06 160280.5,-531.06"/>
<text text-anchor="middle" x="160148" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="160148" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="160148" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160148" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer1_attn_tp2&#45;&gt;dp1_pp1_layer1_attn_allreduce -->
<g id="edge610" class="edge">
<title>dp1_pp1_layer1_attn_tp2&#45;&gt;dp1_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M160213.66,-479C160237.53,-470.28 160264.83,-460.77 160290,-453.06 160341.51,-437.29 160399.04,-422.21 160448.64,-409.97"/>
<polygon fill="black" stroke="black" points="160449.57,-413.35 160458.45,-407.57 160447.9,-406.55 160449.57,-413.35"/>
</g>
<!-- dp1_pp1_layer1_attn_tp3 -->
<g id="node375" class="node">
<title>dp1_pp1_layer1_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="161129.5,-531.06 160864.5,-531.06 160864.5,-479.06 161129.5,-479.06 161129.5,-531.06"/>
<text text-anchor="middle" x="160997" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="160997" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="160997" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160997" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer1_attn_tp3&#45;&gt;dp1_pp1_layer1_attn_allreduce -->
<g id="edge611" class="edge">
<title>dp1_pp1_layer1_attn_tp3&#45;&gt;dp1_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M160931.82,-478.95C160908.12,-470.23 160881.01,-460.72 160856,-453.06 160804.14,-437.17 160746.21,-422.07 160696.26,-409.85"/>
<polygon fill="black" stroke="black" points="160696.92,-406.41 160686.38,-407.45 160695.27,-413.21 160696.92,-406.41"/>
</g>
<!-- dp1_pp1_layer1_expert0 -->
<g id="node377" class="node">
<title>dp1_pp1_layer1_expert0</title>
<polygon fill="lightgreen" stroke="black" points="156361,-406.29 156137,-406.29 156137,-354.29 156361,-354.29 156361,-406.29"/>
<text text-anchor="middle" x="156249" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="156249" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="156249" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="156249" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert0 -->
<g id="edge612" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157861.73,-499.65C157476.55,-490.26 156651.11,-465.13 156370,-417.06 156357.99,-415.01 156345.48,-412.16 156333.27,-408.95"/>
<polygon fill="black" stroke="black" points="156334.11,-405.56 156323.54,-406.32 156332.28,-412.31 156334.11,-405.56"/>
</g>
<!-- dp1_pp1_layer1_expert1 -->
<g id="node378" class="node">
<title>dp1_pp1_layer1_expert1</title>
<polygon fill="lightgreen" stroke="black" points="156603,-406.29 156379,-406.29 156379,-354.29 156603,-354.29 156603,-406.29"/>
<text text-anchor="middle" x="156491" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="156491" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="156491" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="156491" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert1 -->
<g id="edge613" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157859.55,-497.55C157517.94,-485.71 156845.58,-458.03 156612,-417.06 156600.08,-414.97 156587.67,-412.12 156575.54,-408.93"/>
<polygon fill="black" stroke="black" points="156576.45,-405.55 156565.89,-406.3 156574.62,-412.3 156576.45,-405.55"/>
</g>
<!-- dp1_pp1_layer1_expert2 -->
<g id="node379" class="node">
<title>dp1_pp1_layer1_expert2</title>
<polygon fill="lightgreen" stroke="black" points="156845,-406.29 156621,-406.29 156621,-354.29 156845,-354.29 156845,-406.29"/>
<text text-anchor="middle" x="156733" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="156733" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="156733" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="156733" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert2 -->
<g id="edge614" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157864.82,-502.85C157623.66,-498.37 157206.02,-480.97 156854,-417.06 156842.38,-414.95 156830.29,-412.14 156818.44,-409.03"/>
<polygon fill="black" stroke="black" points="156819.13,-405.59 156808.56,-406.34 156817.29,-412.34 156819.13,-405.59"/>
</g>
<!-- dp1_pp1_layer1_expert3 -->
<g id="node380" class="node">
<title>dp1_pp1_layer1_expert3</title>
<polygon fill="lightgreen" stroke="black" points="157087,-406.29 156863,-406.29 156863,-354.29 157087,-354.29 157087,-406.29"/>
<text text-anchor="middle" x="156975" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="156975" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="156975" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="156975" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert3 -->
<g id="edge615" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157859.36,-497.41C157662.31,-488.25 157356.63,-466.79 157096,-417.06 157084.57,-414.88 157072.67,-412.06 157060.99,-408.97"/>
<polygon fill="black" stroke="black" points="157061.82,-405.57 157051.25,-406.31 157059.98,-412.32 157061.82,-405.57"/>
</g>
<!-- dp1_pp1_layer1_expert4 -->
<g id="node381" class="node">
<title>dp1_pp1_layer1_expert4</title>
<polygon fill="lightgreen" stroke="black" points="157329,-406.29 157105,-406.29 157105,-354.29 157329,-354.29 157329,-406.29"/>
<text text-anchor="middle" x="157217" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="157217" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="157217" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="157217" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert4 -->
<g id="edge616" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157850.43,-487.98C157704.99,-474.71 157508.64,-452.25 157338,-417.06 157327.05,-414.8 157315.65,-412.02 157304.43,-409.02"/>
<polygon fill="black" stroke="black" points="157305.19,-405.6 157294.62,-406.33 157303.34,-412.35 157305.19,-405.6"/>
</g>
<!-- dp1_pp1_layer1_expert5 -->
<g id="node382" class="node">
<title>dp1_pp1_layer1_expert5</title>
<polygon fill="lightgreen" stroke="black" points="157571,-406.29 157347,-406.29 157347,-354.29 157571,-354.29 157571,-406.29"/>
<text text-anchor="middle" x="157459" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="157459" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="157459" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="157459" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert5 -->
<g id="edge617" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157830.29,-467.38C157750.5,-453.44 157661,-436.25 157580,-417.06 157569.9,-414.67 157559.4,-411.94 157548.99,-409.07"/>
<polygon fill="black" stroke="black" points="157549.62,-405.62 157539.05,-406.3 157547.74,-412.36 157549.62,-405.62"/>
</g>
<!-- dp1_pp1_layer1_expert6 -->
<g id="node383" class="node">
<title>dp1_pp1_layer1_expert6</title>
<polygon fill="lightgreen" stroke="black" points="157813,-406.29 157589,-406.29 157589,-354.29 157813,-354.29 157813,-406.29"/>
<text text-anchor="middle" x="157701" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="157701" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="157701" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="157701" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert6 -->
<g id="edge618" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M157912.94,-452.97C157869.16,-438.16 157822.94,-422.53 157784.87,-409.66"/>
<polygon fill="black" stroke="black" points="157785.97,-406.33 157775.38,-406.45 157783.73,-412.97 157785.97,-406.33"/>
</g>
<!-- dp1_pp1_layer1_expert7 -->
<g id="node384" class="node">
<title>dp1_pp1_layer1_expert7</title>
<polygon fill="lightgreen" stroke="black" points="158055,-406.29 157831,-406.29 157831,-354.29 158055,-354.29 158055,-406.29"/>
<text text-anchor="middle" x="157943" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="157943" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="157943" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="157943" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert7 -->
<g id="edge619" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158013.38,-452.71C158000.3,-439.43 157986.58,-425.51 157974.76,-413.52"/>
<polygon fill="black" stroke="black" points="157977.19,-411 157967.68,-406.33 157972.2,-415.91 157977.19,-411"/>
</g>
<!-- dp1_pp1_layer1_expert8 -->
<g id="node385" class="node">
<title>dp1_pp1_layer1_expert8</title>
<polygon fill="lightgreen" stroke="black" points="158297,-406.29 158073,-406.29 158073,-354.29 158297,-354.29 158297,-406.29"/>
<text text-anchor="middle" x="158185" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="158185" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="158185" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="158185" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert8 -->
<g id="edge620" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158114.61,-452.71C158127.7,-439.43 158141.42,-425.51 158153.23,-413.52"/>
<polygon fill="black" stroke="black" points="158155.79,-415.91 158160.32,-406.33 158150.81,-411 158155.79,-415.91"/>
</g>
<!-- dp1_pp1_layer1_expert9 -->
<g id="node386" class="node">
<title>dp1_pp1_layer1_expert9</title>
<polygon fill="lightgreen" stroke="black" points="158539,-406.29 158315,-406.29 158315,-354.29 158539,-354.29 158539,-406.29"/>
<text text-anchor="middle" x="158427" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="158427" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="158427" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="158427" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert9 -->
<g id="edge621" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158211.38,-454.21C158256.29,-439.03 158304.08,-422.86 158343.23,-409.62"/>
<polygon fill="black" stroke="black" points="158344.64,-412.84 158352.99,-406.32 158342.4,-406.21 158344.64,-412.84"/>
</g>
<!-- dp1_pp1_layer1_expert10 -->
<g id="node387" class="node">
<title>dp1_pp1_layer1_expert10</title>
<polygon fill="lightgreen" stroke="black" points="158781,-406.29 158557,-406.29 158557,-354.29 158781,-354.29 158781,-406.29"/>
<text text-anchor="middle" x="158669" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="158669" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="158669" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="158669" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert10 -->
<g id="edge622" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158234.89,-478.04C158327.98,-462.69 158444.88,-441.49 158548,-417.06 158558.09,-414.67 158568.6,-411.94 158579.01,-409.07"/>
<polygon fill="black" stroke="black" points="158580.26,-412.36 158588.95,-406.3 158578.37,-405.62 158580.26,-412.36"/>
</g>
<!-- dp1_pp1_layer1_expert11 -->
<g id="node388" class="node">
<title>dp1_pp1_layer1_expert11</title>
<polygon fill="lightgreen" stroke="black" points="159023,-406.29 158799,-406.29 158799,-354.29 159023,-354.29 159023,-406.29"/>
<text text-anchor="middle" x="158911" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="158911" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="158911" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="158911" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert11 -->
<g id="edge623" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158246.99,-490.7C158394.62,-477.88 158607.08,-454.78 158790,-417.06 158800.95,-414.8 158812.35,-412.02 158823.57,-409.02"/>
<polygon fill="black" stroke="black" points="158824.66,-412.35 158833.38,-406.33 158822.81,-405.6 158824.66,-412.35"/>
</g>
<!-- dp1_pp1_layer1_expert12 -->
<g id="node389" class="node">
<title>dp1_pp1_layer1_expert12</title>
<polygon fill="lightgreen" stroke="black" points="159265,-406.29 159041,-406.29 159041,-354.29 159265,-354.29 159265,-406.29"/>
<text text-anchor="middle" x="159153" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="159153" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="159153" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="159153" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert12 -->
<g id="edge624" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158254.27,-498.07C158450.59,-489.29 158764.95,-468.01 159032,-417.06 159043.43,-414.88 159055.33,-412.06 159067.01,-408.97"/>
<polygon fill="black" stroke="black" points="159068.02,-412.32 159076.75,-406.31 159066.18,-405.57 159068.02,-412.32"/>
</g>
<!-- dp1_pp1_layer1_expert13 -->
<g id="node390" class="node">
<title>dp1_pp1_layer1_expert13</title>
<polygon fill="lightgreen" stroke="black" points="159507,-406.29 159283,-406.29 159283,-354.29 159507,-354.29 159507,-406.29"/>
<text text-anchor="middle" x="159395" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="159395" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="159395" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="159395" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert13 -->
<g id="edge625" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158258.93,-502.93C158499.42,-498.58 158919.9,-481.35 159274,-417.06 159285.62,-414.95 159297.71,-412.14 159309.56,-409.03"/>
<polygon fill="black" stroke="black" points="159310.7,-412.34 159319.44,-406.34 159308.87,-405.59 159310.7,-412.34"/>
</g>
<!-- dp1_pp1_layer1_expert14 -->
<g id="node391" class="node">
<title>dp1_pp1_layer1_expert14</title>
<polygon fill="lightgreen" stroke="black" points="159749,-406.29 159525,-406.29 159525,-354.29 159749,-354.29 159749,-406.29"/>
<text text-anchor="middle" x="159637" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="159637" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="159637" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="159637" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert14 -->
<g id="edge626" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158254.32,-498.04C158591.17,-486.48 159279.15,-458.6 159516,-417.06 159527.92,-414.97 159540.32,-412.12 159552.46,-408.93"/>
<polygon fill="black" stroke="black" points="159553.38,-412.3 159562.11,-406.3 159551.54,-405.55 159553.38,-412.3"/>
</g>
<!-- dp1_pp1_layer1_expert15 -->
<g id="node392" class="node">
<title>dp1_pp1_layer1_expert15</title>
<polygon fill="lightgreen" stroke="black" points="159991,-406.29 159767,-406.29 159767,-354.29 159991,-354.29 159991,-406.29"/>
<text text-anchor="middle" x="159879" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="159879" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="159879" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="159879" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert15 -->
<g id="edge627" class="edge">
<title>dp1_pp1_layer1_router&#45;&gt;dp1_pp1_layer1_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M158255.94,-499.9C158636.49,-490.72 159474.35,-465.57 159758,-417.06 159770.01,-415.01 159782.51,-412.16 159794.73,-408.95"/>
<polygon fill="black" stroke="black" points="159795.72,-412.31 159804.45,-406.32 159793.88,-405.56 159795.72,-412.31"/>
</g>
<!-- dp1_pp1_layer1_expert_agg -->
<g id="node393" class="node">
<title>dp1_pp1_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="158311.57,-307.52 157917.74,-307.52 157816.43,-203.52 158210.26,-203.52 158311.57,-307.52"/>
<text text-anchor="middle" x="158064" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="158064" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="158064" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="158064" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer1_expert0&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge628" class="edge">
<title>dp1_pp1_layer1_expert0&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M156307.07,-354.29C156326.69,-346.92 156348.97,-339.72 156370,-335.52 156649.13,-279.86 157472.93,-263.21 157859.43,-258.4"/>
<polygon fill="black" stroke="black" points="157859.65,-261.9 157869.61,-258.27 157859.57,-254.9 157859.65,-261.9"/>
</g>
<!-- dp1_pp1_layer1_expert1&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge629" class="edge">
<title>dp1_pp1_layer1_expert1&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M156549.39,-354.27C156568.95,-346.95 156591.09,-339.78 156612,-335.52 156844.8,-288.16 157520.09,-267.74 157861.43,-260.24"/>
<polygon fill="black" stroke="black" points="157861.51,-263.74 157871.43,-260.03 157861.35,-256.74 157861.51,-263.74"/>
</g>
<!-- dp1_pp1_layer1_expert2&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge630" class="edge">
<title>dp1_pp1_layer1_expert2&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M156791.73,-354.29C156811.21,-347.01 156833.23,-339.87 156854,-335.52 157040.91,-296.44 157570.54,-273.07 157863.3,-262.78"/>
<polygon fill="black" stroke="black" points="157863.74,-266.27 157873.61,-262.42 157863.5,-259.27 157863.74,-266.27"/>
</g>
<!-- dp1_pp1_layer1_expert3&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge631" class="edge">
<title>dp1_pp1_layer1_expert3&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M157034.39,-354.26C157053.72,-347.07 157075.48,-339.99 157096,-335.52 157354.91,-279.18 157660.7,-262.24 157858.26,-257.56"/>
<polygon fill="black" stroke="black" points="157858.55,-261.06 157868.47,-257.33 157858.39,-254.06 157858.55,-261.06"/>
</g>
<!-- dp1_pp1_layer1_expert4&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge632" class="edge">
<title>dp1_pp1_layer1_expert4&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M157277.39,-354.24C157296.49,-347.2 157317.87,-340.19 157338,-335.52 157513.82,-294.77 157718.6,-274.91 157865.75,-265.31"/>
<polygon fill="black" stroke="black" points="157866.05,-268.8 157875.81,-264.67 157865.6,-261.82 157866.05,-268.8"/>
</g>
<!-- dp1_pp1_layer1_expert5&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge633" class="edge">
<title>dp1_pp1_layer1_expert5&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M157521.42,-354.22C157540.04,-347.42 157560.65,-340.55 157580,-335.52 157677.09,-310.27 157787.34,-291.53 157878.07,-278.65"/>
<polygon fill="black" stroke="black" points="157878.78,-282.09 157888.19,-277.23 157877.8,-275.16 157878.78,-282.09"/>
</g>
<!-- dp1_pp1_layer1_expert6&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge634" class="edge">
<title>dp1_pp1_layer1_expert6&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M157769.02,-354.26C157786.26,-348.03 157804.78,-341.44 157822,-335.52 157848.73,-326.33 157877.21,-316.8 157904.89,-307.67"/>
<polygon fill="black" stroke="black" points="157906.24,-310.91 157914.65,-304.46 157904.06,-304.26 157906.24,-310.91"/>
</g>
<!-- dp1_pp1_layer1_expert7&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge635" class="edge">
<title>dp1_pp1_layer1_expert7&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M157967.78,-354.15C157979.02,-342.74 157992.83,-328.73 158006.45,-314.92"/>
<polygon fill="black" stroke="black" points="158009,-317.31 158013.53,-307.73 158004.02,-312.39 158009,-317.31"/>
</g>
<!-- dp1_pp1_layer1_expert8&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge636" class="edge">
<title>dp1_pp1_layer1_expert8&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M158160.22,-354.15C158148.97,-342.74 158135.16,-328.73 158121.55,-314.92"/>
<polygon fill="black" stroke="black" points="158123.98,-312.39 158114.47,-307.73 158118.99,-317.31 158123.98,-312.39"/>
</g>
<!-- dp1_pp1_layer1_expert9&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge637" class="edge">
<title>dp1_pp1_layer1_expert9&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M158358.98,-354.26C158341.73,-348.03 158323.21,-341.44 158306,-335.52 158282.29,-327.37 158257.21,-318.95 158232.53,-310.78"/>
<polygon fill="black" stroke="black" points="158233.32,-307.36 158222.73,-307.54 158231.12,-314 158233.32,-307.36"/>
</g>
<!-- dp1_pp1_layer1_expert10&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge638" class="edge">
<title>dp1_pp1_layer1_expert10&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M158606.58,-354.22C158587.96,-347.42 158567.35,-340.55 158548,-335.52 158467.99,-314.71 158379.05,-298.33 158299.46,-286"/>
<polygon fill="black" stroke="black" points="158299.71,-282.5 158289.3,-284.44 158298.65,-289.41 158299.71,-282.5"/>
</g>
<!-- dp1_pp1_layer1_expert11&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge639" class="edge">
<title>dp1_pp1_layer1_expert11&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M158850.61,-354.24C158831.51,-347.2 158810.13,-340.19 158790,-335.52 158621.74,-296.53 158426.97,-276.66 158281.55,-266.61"/>
<polygon fill="black" stroke="black" points="158281.38,-263.09 158271.16,-265.9 158280.9,-270.07 158281.38,-263.09"/>
</g>
<!-- dp1_pp1_layer1_expert12&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge640" class="edge">
<title>dp1_pp1_layer1_expert12&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M159093.61,-354.26C159074.28,-347.07 159052.52,-339.99 159032,-335.52 158774.51,-279.49 158470.64,-262.43 158272.99,-257.64"/>
<polygon fill="black" stroke="black" points="158272.86,-254.14 158262.78,-257.4 158272.69,-261.13 158272.86,-254.14"/>
</g>
<!-- dp1_pp1_layer1_expert13&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge641" class="edge">
<title>dp1_pp1_layer1_expert13&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M159336.27,-354.29C159316.79,-347.01 159294.77,-339.87 159274,-335.52 159090.02,-297.05 158573.97,-273.81 158278.63,-263.27"/>
<polygon fill="black" stroke="black" points="158278.33,-259.76 158268.21,-262.9 158278.08,-266.76 158278.33,-259.76"/>
</g>
<!-- dp1_pp1_layer1_expert14&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge642" class="edge">
<title>dp1_pp1_layer1_expert14&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M159578.6,-354.27C159559.05,-346.95 159536.9,-339.78 159516,-335.52 159285.27,-288.58 158619.86,-268.1 158275.74,-260.45"/>
<polygon fill="black" stroke="black" points="158275.73,-256.94 158265.65,-260.22 158275.57,-263.94 158275.73,-256.94"/>
</g>
<!-- dp1_pp1_layer1_expert15&#45;&gt;dp1_pp1_layer1_expert_agg -->
<g id="edge643" class="edge">
<title>dp1_pp1_layer1_expert15&#45;&gt;dp1_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M159820.93,-354.29C159801.3,-346.92 159779.03,-339.72 159758,-335.52 159480.21,-280.12 158662.98,-263.37 158274.17,-258.47"/>
<polygon fill="black" stroke="black" points="158273.97,-254.97 158263.93,-258.34 158273.88,-261.97 158273.97,-254.97"/>
</g>
<!-- dp1_pp1_layer2_attn_tp0 -->
<g id="node394" class="node">
<title>dp1_pp1_layer2_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="155546.5,-531.06 155281.5,-531.06 155281.5,-479.06 155546.5,-479.06 155546.5,-531.06"/>
<text text-anchor="middle" x="155414" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="155414" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="155414" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="155414" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer1_expert_agg&#45;&gt;dp1_pp1_layer2_attn_tp0 -->
<g id="edge645" class="edge">
<title>dp1_pp1_layer1_expert_agg&#45;&gt;dp1_pp1_layer2_attn_tp0</title>
<path fill="none" stroke="black" d="M157871.78,-260.41C157451.38,-269.54 156461.17,-294.77 156128,-335.52 156095.8,-339.46 155587.23,-444.29 155556,-453.06 155533.37,-459.41 155509.16,-467.58 155487.26,-475.5"/>
<polygon fill="black" stroke="black" points="155485.89,-472.28 155477.7,-479 155488.29,-478.85 155485.89,-472.28"/>
</g>
<!-- dp1_pp1_layer2_attn_allreduce -->
<g id="node395" class="node">
<title>dp1_pp1_layer2_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="155543" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="155543" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="155543" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="155543" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="155543" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_attn_tp0&#45;&gt;dp1_pp1_layer2_attn_allreduce -->
<g id="edge646" class="edge">
<title>dp1_pp1_layer2_attn_tp0&#45;&gt;dp1_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M155440.41,-478.92C155457.15,-463 155479.21,-442 155498.58,-423.56"/>
<polygon fill="black" stroke="black" points="155501.03,-426.07 155505.86,-416.64 155496.2,-421 155501.03,-426.07"/>
</g>
<!-- dp1_pp1_layer2_router -->
<g id="node399" class="node">
<title>dp1_pp1_layer2_router</title>
<polygon fill="lightyellow" stroke="black" points="153294.57,-557.06 152900.74,-557.06 152799.43,-453.06 153193.26,-453.06 153294.57,-557.06"/>
<text text-anchor="middle" x="153047" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="153047" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="153047" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="153047" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_attn_allreduce&#45;&gt;dp1_pp1_layer2_router -->
<g id="edge682" class="edge">
<title>dp1_pp1_layer2_attn_allreduce&#45;&gt;dp1_pp1_layer2_router</title>
<path fill="none" stroke="black" d="M155383.08,-392.38C155271.77,-399.9 155119.89,-409.76 154986,-417.06 154350.5,-451.72 153597.28,-482.59 153245.96,-496.4"/>
<polygon fill="black" stroke="black" points="153245.8,-492.91 153235.94,-496.79 153246.07,-499.9 153245.8,-492.91"/>
</g>
<!-- dp1_pp1_layer2_attn_tp1 -->
<g id="node396" class="node">
<title>dp1_pp1_layer2_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="155829.5,-531.06 155564.5,-531.06 155564.5,-479.06 155829.5,-479.06 155829.5,-531.06"/>
<text text-anchor="middle" x="155697" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="155697" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="155697" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="155697" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer2_attn_tp1&#45;&gt;dp1_pp1_layer2_attn_allreduce -->
<g id="edge647" class="edge">
<title>dp1_pp1_layer2_attn_tp1&#45;&gt;dp1_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M155665.46,-478.92C155644.99,-462.6 155617.83,-440.94 155594.29,-422.18"/>
<polygon fill="black" stroke="black" points="155596.46,-419.44 155586.46,-415.94 155592.1,-424.91 155596.46,-419.44"/>
</g>
<!-- dp1_pp1_layer2_attn_tp2 -->
<g id="node397" class="node">
<title>dp1_pp1_layer2_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="155263.5,-531.06 154998.5,-531.06 154998.5,-479.06 155263.5,-479.06 155263.5,-531.06"/>
<text text-anchor="middle" x="155131" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="155131" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="155131" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="155131" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer2_attn_tp2&#45;&gt;dp1_pp1_layer2_attn_allreduce -->
<g id="edge648" class="edge">
<title>dp1_pp1_layer2_attn_tp2&#45;&gt;dp1_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M155197.07,-479.02C155220.85,-470.35 155247.99,-460.86 155273,-453.06 155321.74,-437.86 155376.05,-423.03 155423.1,-410.83"/>
<polygon fill="black" stroke="black" points="155424.22,-414.15 155433.03,-408.26 155422.47,-407.38 155424.22,-414.15"/>
</g>
<!-- dp1_pp1_layer2_attn_tp3 -->
<g id="node398" class="node">
<title>dp1_pp1_layer2_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="156112.5,-531.06 155847.5,-531.06 155847.5,-479.06 156112.5,-479.06 156112.5,-531.06"/>
<text text-anchor="middle" x="155980" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="155980" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="155980" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="155980" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer2_attn_tp3&#45;&gt;dp1_pp1_layer2_attn_allreduce -->
<g id="edge649" class="edge">
<title>dp1_pp1_layer2_attn_tp3&#45;&gt;dp1_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M155915.21,-478.95C155891.43,-470.18 155864.17,-460.64 155839,-453.06 155784.42,-436.63 155723.31,-421.31 155670.86,-409.08"/>
<polygon fill="black" stroke="black" points="155671.37,-405.6 155660.83,-406.75 155669.78,-412.42 155671.37,-405.6"/>
</g>
<!-- dp1_pp1_layer2_expert0 -->
<g id="node400" class="node">
<title>dp1_pp1_layer2_expert0</title>
<polygon fill="lightgreen" stroke="black" points="151344,-406.29 151120,-406.29 151120,-354.29 151344,-354.29 151344,-406.29"/>
<text text-anchor="middle" x="151232" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="151232" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="151232" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="151232" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert0 -->
<g id="edge650" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152844.73,-499.65C152459.55,-490.26 151634.11,-465.13 151353,-417.06 151340.99,-415.01 151328.48,-412.16 151316.27,-408.95"/>
<polygon fill="black" stroke="black" points="151317.11,-405.56 151306.54,-406.32 151315.28,-412.31 151317.11,-405.56"/>
</g>
<!-- dp1_pp1_layer2_expert1 -->
<g id="node401" class="node">
<title>dp1_pp1_layer2_expert1</title>
<polygon fill="lightgreen" stroke="black" points="151586,-406.29 151362,-406.29 151362,-354.29 151586,-354.29 151586,-406.29"/>
<text text-anchor="middle" x="151474" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="151474" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="151474" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="151474" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert1 -->
<g id="edge651" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152842.55,-497.55C152500.94,-485.71 151828.58,-458.03 151595,-417.06 151583.08,-414.97 151570.67,-412.12 151558.54,-408.93"/>
<polygon fill="black" stroke="black" points="151559.45,-405.55 151548.89,-406.3 151557.62,-412.3 151559.45,-405.55"/>
</g>
<!-- dp1_pp1_layer2_expert2 -->
<g id="node402" class="node">
<title>dp1_pp1_layer2_expert2</title>
<polygon fill="lightgreen" stroke="black" points="151828,-406.29 151604,-406.29 151604,-354.29 151828,-354.29 151828,-406.29"/>
<text text-anchor="middle" x="151716" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="151716" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="151716" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="151716" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert2 -->
<g id="edge652" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152847.82,-502.85C152606.66,-498.37 152189.02,-480.97 151837,-417.06 151825.38,-414.95 151813.29,-412.14 151801.44,-409.03"/>
<polygon fill="black" stroke="black" points="151802.13,-405.59 151791.56,-406.34 151800.29,-412.34 151802.13,-405.59"/>
</g>
<!-- dp1_pp1_layer2_expert3 -->
<g id="node403" class="node">
<title>dp1_pp1_layer2_expert3</title>
<polygon fill="lightgreen" stroke="black" points="152070,-406.29 151846,-406.29 151846,-354.29 152070,-354.29 152070,-406.29"/>
<text text-anchor="middle" x="151958" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="151958" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="151958" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="151958" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert3 -->
<g id="edge653" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152842.36,-497.41C152645.31,-488.25 152339.63,-466.79 152079,-417.06 152067.57,-414.88 152055.67,-412.06 152043.99,-408.97"/>
<polygon fill="black" stroke="black" points="152044.82,-405.57 152034.25,-406.31 152042.98,-412.32 152044.82,-405.57"/>
</g>
<!-- dp1_pp1_layer2_expert4 -->
<g id="node404" class="node">
<title>dp1_pp1_layer2_expert4</title>
<polygon fill="lightgreen" stroke="black" points="152312,-406.29 152088,-406.29 152088,-354.29 152312,-354.29 152312,-406.29"/>
<text text-anchor="middle" x="152200" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="152200" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="152200" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="152200" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert4 -->
<g id="edge654" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152833.43,-487.98C152687.99,-474.71 152491.64,-452.25 152321,-417.06 152310.05,-414.8 152298.65,-412.02 152287.43,-409.02"/>
<polygon fill="black" stroke="black" points="152288.19,-405.6 152277.62,-406.33 152286.34,-412.35 152288.19,-405.6"/>
</g>
<!-- dp1_pp1_layer2_expert5 -->
<g id="node405" class="node">
<title>dp1_pp1_layer2_expert5</title>
<polygon fill="lightgreen" stroke="black" points="152554,-406.29 152330,-406.29 152330,-354.29 152554,-354.29 152554,-406.29"/>
<text text-anchor="middle" x="152442" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="152442" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="152442" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="152442" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert5 -->
<g id="edge655" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152813.29,-467.38C152733.5,-453.44 152644,-436.25 152563,-417.06 152552.9,-414.67 152542.4,-411.94 152531.99,-409.07"/>
<polygon fill="black" stroke="black" points="152532.62,-405.62 152522.05,-406.3 152530.74,-412.36 152532.62,-405.62"/>
</g>
<!-- dp1_pp1_layer2_expert6 -->
<g id="node406" class="node">
<title>dp1_pp1_layer2_expert6</title>
<polygon fill="lightgreen" stroke="black" points="152796,-406.29 152572,-406.29 152572,-354.29 152796,-354.29 152796,-406.29"/>
<text text-anchor="middle" x="152684" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="152684" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="152684" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="152684" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert6 -->
<g id="edge656" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152895.94,-452.97C152852.16,-438.16 152805.94,-422.53 152767.87,-409.66"/>
<polygon fill="black" stroke="black" points="152768.97,-406.33 152758.38,-406.45 152766.73,-412.97 152768.97,-406.33"/>
</g>
<!-- dp1_pp1_layer2_expert7 -->
<g id="node407" class="node">
<title>dp1_pp1_layer2_expert7</title>
<polygon fill="lightgreen" stroke="black" points="153038,-406.29 152814,-406.29 152814,-354.29 153038,-354.29 153038,-406.29"/>
<text text-anchor="middle" x="152926" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="152926" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="152926" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="152926" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert7 -->
<g id="edge657" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M152996.38,-452.71C152983.3,-439.43 152969.58,-425.51 152957.76,-413.52"/>
<polygon fill="black" stroke="black" points="152960.19,-411 152950.68,-406.33 152955.2,-415.91 152960.19,-411"/>
</g>
<!-- dp1_pp1_layer2_expert8 -->
<g id="node408" class="node">
<title>dp1_pp1_layer2_expert8</title>
<polygon fill="lightgreen" stroke="black" points="153280,-406.29 153056,-406.29 153056,-354.29 153280,-354.29 153280,-406.29"/>
<text text-anchor="middle" x="153168" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="153168" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="153168" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="153168" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert8 -->
<g id="edge658" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153097.61,-452.71C153110.7,-439.43 153124.42,-425.51 153136.23,-413.52"/>
<polygon fill="black" stroke="black" points="153138.79,-415.91 153143.32,-406.33 153133.81,-411 153138.79,-415.91"/>
</g>
<!-- dp1_pp1_layer2_expert9 -->
<g id="node409" class="node">
<title>dp1_pp1_layer2_expert9</title>
<polygon fill="lightgreen" stroke="black" points="153522,-406.29 153298,-406.29 153298,-354.29 153522,-354.29 153522,-406.29"/>
<text text-anchor="middle" x="153410" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="153410" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="153410" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="153410" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert9 -->
<g id="edge659" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153194.38,-454.21C153239.29,-439.03 153287.08,-422.86 153326.23,-409.62"/>
<polygon fill="black" stroke="black" points="153327.64,-412.84 153335.99,-406.32 153325.4,-406.21 153327.64,-412.84"/>
</g>
<!-- dp1_pp1_layer2_expert10 -->
<g id="node410" class="node">
<title>dp1_pp1_layer2_expert10</title>
<polygon fill="lightgreen" stroke="black" points="153764,-406.29 153540,-406.29 153540,-354.29 153764,-354.29 153764,-406.29"/>
<text text-anchor="middle" x="153652" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="153652" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="153652" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="153652" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert10 -->
<g id="edge660" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153217.89,-478.04C153310.98,-462.69 153427.88,-441.49 153531,-417.06 153541.09,-414.67 153551.6,-411.94 153562.01,-409.07"/>
<polygon fill="black" stroke="black" points="153563.26,-412.36 153571.95,-406.3 153561.37,-405.62 153563.26,-412.36"/>
</g>
<!-- dp1_pp1_layer2_expert11 -->
<g id="node411" class="node">
<title>dp1_pp1_layer2_expert11</title>
<polygon fill="lightgreen" stroke="black" points="154006,-406.29 153782,-406.29 153782,-354.29 154006,-354.29 154006,-406.29"/>
<text text-anchor="middle" x="153894" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="153894" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="153894" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="153894" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert11 -->
<g id="edge661" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153229.99,-490.7C153377.62,-477.88 153590.08,-454.78 153773,-417.06 153783.95,-414.8 153795.35,-412.02 153806.57,-409.02"/>
<polygon fill="black" stroke="black" points="153807.66,-412.35 153816.38,-406.33 153805.81,-405.6 153807.66,-412.35"/>
</g>
<!-- dp1_pp1_layer2_expert12 -->
<g id="node412" class="node">
<title>dp1_pp1_layer2_expert12</title>
<polygon fill="lightgreen" stroke="black" points="154248,-406.29 154024,-406.29 154024,-354.29 154248,-354.29 154248,-406.29"/>
<text text-anchor="middle" x="154136" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="154136" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="154136" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="154136" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert12 -->
<g id="edge662" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153237.27,-498.07C153433.59,-489.29 153747.95,-468.01 154015,-417.06 154026.43,-414.88 154038.33,-412.06 154050.01,-408.97"/>
<polygon fill="black" stroke="black" points="154051.02,-412.32 154059.75,-406.31 154049.18,-405.57 154051.02,-412.32"/>
</g>
<!-- dp1_pp1_layer2_expert13 -->
<g id="node413" class="node">
<title>dp1_pp1_layer2_expert13</title>
<polygon fill="lightgreen" stroke="black" points="154490,-406.29 154266,-406.29 154266,-354.29 154490,-354.29 154490,-406.29"/>
<text text-anchor="middle" x="154378" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="154378" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="154378" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="154378" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert13 -->
<g id="edge663" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153241.93,-502.93C153482.42,-498.58 153902.9,-481.35 154257,-417.06 154268.62,-414.95 154280.71,-412.14 154292.56,-409.03"/>
<polygon fill="black" stroke="black" points="154293.7,-412.34 154302.44,-406.34 154291.87,-405.59 154293.7,-412.34"/>
</g>
<!-- dp1_pp1_layer2_expert14 -->
<g id="node414" class="node">
<title>dp1_pp1_layer2_expert14</title>
<polygon fill="lightgreen" stroke="black" points="154732,-406.29 154508,-406.29 154508,-354.29 154732,-354.29 154732,-406.29"/>
<text text-anchor="middle" x="154620" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="154620" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="154620" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="154620" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert14 -->
<g id="edge664" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153237.32,-498.04C153574.17,-486.48 154262.15,-458.6 154499,-417.06 154510.92,-414.97 154523.32,-412.12 154535.46,-408.93"/>
<polygon fill="black" stroke="black" points="154536.38,-412.3 154545.11,-406.3 154534.54,-405.55 154536.38,-412.3"/>
</g>
<!-- dp1_pp1_layer2_expert15 -->
<g id="node415" class="node">
<title>dp1_pp1_layer2_expert15</title>
<polygon fill="lightgreen" stroke="black" points="154974,-406.29 154750,-406.29 154750,-354.29 154974,-354.29 154974,-406.29"/>
<text text-anchor="middle" x="154862" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="154862" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="154862" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="154862" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert15 -->
<g id="edge665" class="edge">
<title>dp1_pp1_layer2_router&#45;&gt;dp1_pp1_layer2_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M153238.94,-499.9C153619.49,-490.72 154457.35,-465.57 154741,-417.06 154753.01,-415.01 154765.51,-412.16 154777.73,-408.95"/>
<polygon fill="black" stroke="black" points="154778.72,-412.31 154787.45,-406.32 154776.88,-405.56 154778.72,-412.31"/>
</g>
<!-- dp1_pp1_layer2_expert_agg -->
<g id="node416" class="node">
<title>dp1_pp1_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="153294.57,-307.52 152900.74,-307.52 152799.43,-203.52 153193.26,-203.52 153294.57,-307.52"/>
<text text-anchor="middle" x="153047" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="153047" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="153047" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="153047" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer2_expert0&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge666" class="edge">
<title>dp1_pp1_layer2_expert0&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M151290.07,-354.29C151309.69,-346.92 151331.97,-339.72 151353,-335.52 151632.13,-279.86 152455.93,-263.21 152842.43,-258.4"/>
<polygon fill="black" stroke="black" points="152842.65,-261.9 152852.61,-258.27 152842.57,-254.9 152842.65,-261.9"/>
</g>
<!-- dp1_pp1_layer2_expert1&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge667" class="edge">
<title>dp1_pp1_layer2_expert1&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M151532.39,-354.27C151551.95,-346.95 151574.09,-339.78 151595,-335.52 151827.8,-288.16 152503.09,-267.74 152844.43,-260.24"/>
<polygon fill="black" stroke="black" points="152844.51,-263.74 152854.43,-260.03 152844.35,-256.74 152844.51,-263.74"/>
</g>
<!-- dp1_pp1_layer2_expert2&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge668" class="edge">
<title>dp1_pp1_layer2_expert2&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M151774.73,-354.29C151794.21,-347.01 151816.23,-339.87 151837,-335.52 152023.91,-296.44 152553.54,-273.07 152846.3,-262.78"/>
<polygon fill="black" stroke="black" points="152846.74,-266.27 152856.61,-262.42 152846.5,-259.27 152846.74,-266.27"/>
</g>
<!-- dp1_pp1_layer2_expert3&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge669" class="edge">
<title>dp1_pp1_layer2_expert3&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M152017.39,-354.26C152036.72,-347.07 152058.48,-339.99 152079,-335.52 152337.91,-279.18 152643.7,-262.24 152841.26,-257.56"/>
<polygon fill="black" stroke="black" points="152841.55,-261.06 152851.47,-257.33 152841.39,-254.06 152841.55,-261.06"/>
</g>
<!-- dp1_pp1_layer2_expert4&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge670" class="edge">
<title>dp1_pp1_layer2_expert4&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M152260.39,-354.24C152279.49,-347.2 152300.87,-340.19 152321,-335.52 152496.82,-294.77 152701.6,-274.91 152848.75,-265.31"/>
<polygon fill="black" stroke="black" points="152849.05,-268.8 152858.81,-264.67 152848.6,-261.82 152849.05,-268.8"/>
</g>
<!-- dp1_pp1_layer2_expert5&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge671" class="edge">
<title>dp1_pp1_layer2_expert5&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M152504.42,-354.22C152523.04,-347.42 152543.65,-340.55 152563,-335.52 152660.09,-310.27 152770.34,-291.53 152861.07,-278.65"/>
<polygon fill="black" stroke="black" points="152861.78,-282.09 152871.19,-277.23 152860.8,-275.16 152861.78,-282.09"/>
</g>
<!-- dp1_pp1_layer2_expert6&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge672" class="edge">
<title>dp1_pp1_layer2_expert6&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M152752.02,-354.26C152769.26,-348.03 152787.78,-341.44 152805,-335.52 152831.73,-326.33 152860.21,-316.8 152887.89,-307.67"/>
<polygon fill="black" stroke="black" points="152889.24,-310.91 152897.65,-304.46 152887.06,-304.26 152889.24,-310.91"/>
</g>
<!-- dp1_pp1_layer2_expert7&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge673" class="edge">
<title>dp1_pp1_layer2_expert7&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M152950.78,-354.15C152962.02,-342.74 152975.83,-328.73 152989.45,-314.92"/>
<polygon fill="black" stroke="black" points="152992,-317.31 152996.53,-307.73 152987.02,-312.39 152992,-317.31"/>
</g>
<!-- dp1_pp1_layer2_expert8&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge674" class="edge">
<title>dp1_pp1_layer2_expert8&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M153143.22,-354.15C153131.97,-342.74 153118.16,-328.73 153104.55,-314.92"/>
<polygon fill="black" stroke="black" points="153106.98,-312.39 153097.47,-307.73 153101.99,-317.31 153106.98,-312.39"/>
</g>
<!-- dp1_pp1_layer2_expert9&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge675" class="edge">
<title>dp1_pp1_layer2_expert9&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M153341.98,-354.26C153324.73,-348.03 153306.21,-341.44 153289,-335.52 153265.29,-327.37 153240.21,-318.95 153215.53,-310.78"/>
<polygon fill="black" stroke="black" points="153216.32,-307.36 153205.73,-307.54 153214.12,-314 153216.32,-307.36"/>
</g>
<!-- dp1_pp1_layer2_expert10&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge676" class="edge">
<title>dp1_pp1_layer2_expert10&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M153589.58,-354.22C153570.96,-347.42 153550.35,-340.55 153531,-335.52 153450.99,-314.71 153362.05,-298.33 153282.46,-286"/>
<polygon fill="black" stroke="black" points="153282.71,-282.5 153272.3,-284.44 153281.65,-289.41 153282.71,-282.5"/>
</g>
<!-- dp1_pp1_layer2_expert11&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge677" class="edge">
<title>dp1_pp1_layer2_expert11&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M153833.61,-354.24C153814.51,-347.2 153793.13,-340.19 153773,-335.52 153604.74,-296.53 153409.97,-276.66 153264.55,-266.61"/>
<polygon fill="black" stroke="black" points="153264.38,-263.09 153254.16,-265.9 153263.9,-270.07 153264.38,-263.09"/>
</g>
<!-- dp1_pp1_layer2_expert12&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge678" class="edge">
<title>dp1_pp1_layer2_expert12&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M154076.61,-354.26C154057.28,-347.07 154035.52,-339.99 154015,-335.52 153757.51,-279.49 153453.64,-262.43 153255.99,-257.64"/>
<polygon fill="black" stroke="black" points="153255.86,-254.14 153245.78,-257.4 153255.69,-261.13 153255.86,-254.14"/>
</g>
<!-- dp1_pp1_layer2_expert13&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge679" class="edge">
<title>dp1_pp1_layer2_expert13&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M154319.27,-354.29C154299.79,-347.01 154277.77,-339.87 154257,-335.52 154073.02,-297.05 153556.97,-273.81 153261.63,-263.27"/>
<polygon fill="black" stroke="black" points="153261.33,-259.76 153251.21,-262.9 153261.08,-266.76 153261.33,-259.76"/>
</g>
<!-- dp1_pp1_layer2_expert14&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge680" class="edge">
<title>dp1_pp1_layer2_expert14&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M154561.6,-354.27C154542.05,-346.95 154519.9,-339.78 154499,-335.52 154268.27,-288.58 153602.86,-268.1 153258.74,-260.45"/>
<polygon fill="black" stroke="black" points="153258.73,-256.94 153248.65,-260.22 153258.57,-263.94 153258.73,-256.94"/>
</g>
<!-- dp1_pp1_layer2_expert15&#45;&gt;dp1_pp1_layer2_expert_agg -->
<g id="edge681" class="edge">
<title>dp1_pp1_layer2_expert15&#45;&gt;dp1_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M154803.93,-354.29C154784.3,-346.92 154762.03,-339.72 154741,-335.52 154463.21,-280.12 153645.98,-263.37 153257.17,-258.47"/>
<polygon fill="black" stroke="black" points="153256.97,-254.97 153246.93,-258.34 153256.88,-261.97 153256.97,-254.97"/>
</g>
<!-- dp1_pp1_layer3_attn_tp0 -->
<g id="node417" class="node">
<title>dp1_pp1_layer3_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="150529.5,-531.06 150264.5,-531.06 150264.5,-479.06 150529.5,-479.06 150529.5,-531.06"/>
<text text-anchor="middle" x="150397" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="150397" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="150397" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="150397" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer2_expert_agg&#45;&gt;dp1_pp1_layer3_attn_tp0 -->
<g id="edge683" class="edge">
<title>dp1_pp1_layer2_expert_agg&#45;&gt;dp1_pp1_layer3_attn_tp0</title>
<path fill="none" stroke="black" d="M152854.78,-260.41C152434.38,-269.54 151444.17,-294.77 151111,-335.52 151078.8,-339.46 150570.23,-444.29 150539,-453.06 150516.37,-459.41 150492.16,-467.58 150470.26,-475.5"/>
<polygon fill="black" stroke="black" points="150468.89,-472.28 150460.7,-479 150471.29,-478.85 150468.89,-472.28"/>
</g>
<!-- dp1_pp1_layer3_attn_allreduce -->
<g id="node418" class="node">
<title>dp1_pp1_layer3_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="150526" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="150526" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="150526" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="150526" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="150526" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_attn_tp0&#45;&gt;dp1_pp1_layer3_attn_allreduce -->
<g id="edge684" class="edge">
<title>dp1_pp1_layer3_attn_tp0&#45;&gt;dp1_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M150423.41,-478.92C150440.15,-463 150462.21,-442 150481.58,-423.56"/>
<polygon fill="black" stroke="black" points="150484.03,-426.07 150488.86,-416.64 150479.2,-421 150484.03,-426.07"/>
</g>
<!-- dp1_pp1_layer3_router -->
<g id="node422" class="node">
<title>dp1_pp1_layer3_router</title>
<polygon fill="lightyellow" stroke="black" points="148277.57,-557.06 147883.74,-557.06 147782.43,-453.06 148176.26,-453.06 148277.57,-557.06"/>
<text text-anchor="middle" x="148030" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="148030" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="148030" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="148030" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_attn_allreduce&#45;&gt;dp1_pp1_layer3_router -->
<g id="edge720" class="edge">
<title>dp1_pp1_layer3_attn_allreduce&#45;&gt;dp1_pp1_layer3_router</title>
<path fill="none" stroke="black" d="M150366.08,-392.38C150254.77,-399.9 150102.89,-409.76 149969,-417.06 149333.5,-451.72 148580.28,-482.59 148228.96,-496.4"/>
<polygon fill="black" stroke="black" points="148228.8,-492.91 148218.94,-496.79 148229.07,-499.9 148228.8,-492.91"/>
</g>
<!-- dp1_pp1_layer3_attn_tp1 -->
<g id="node419" class="node">
<title>dp1_pp1_layer3_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="150812.5,-531.06 150547.5,-531.06 150547.5,-479.06 150812.5,-479.06 150812.5,-531.06"/>
<text text-anchor="middle" x="150680" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="150680" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="150680" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="150680" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer3_attn_tp1&#45;&gt;dp1_pp1_layer3_attn_allreduce -->
<g id="edge685" class="edge">
<title>dp1_pp1_layer3_attn_tp1&#45;&gt;dp1_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M150648.46,-478.92C150627.99,-462.6 150600.83,-440.94 150577.29,-422.18"/>
<polygon fill="black" stroke="black" points="150579.46,-419.44 150569.46,-415.94 150575.1,-424.91 150579.46,-419.44"/>
</g>
<!-- dp1_pp1_layer3_attn_tp2 -->
<g id="node420" class="node">
<title>dp1_pp1_layer3_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="150246.5,-531.06 149981.5,-531.06 149981.5,-479.06 150246.5,-479.06 150246.5,-531.06"/>
<text text-anchor="middle" x="150114" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="150114" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="150114" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="150114" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer3_attn_tp2&#45;&gt;dp1_pp1_layer3_attn_allreduce -->
<g id="edge686" class="edge">
<title>dp1_pp1_layer3_attn_tp2&#45;&gt;dp1_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M150180.07,-479.02C150203.85,-470.35 150230.99,-460.86 150256,-453.06 150304.74,-437.86 150359.05,-423.03 150406.1,-410.83"/>
<polygon fill="black" stroke="black" points="150407.22,-414.15 150416.03,-408.26 150405.47,-407.38 150407.22,-414.15"/>
</g>
<!-- dp1_pp1_layer3_attn_tp3 -->
<g id="node421" class="node">
<title>dp1_pp1_layer3_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="151095.5,-531.06 150830.5,-531.06 150830.5,-479.06 151095.5,-479.06 151095.5,-531.06"/>
<text text-anchor="middle" x="150963" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="150963" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="150963" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="150963" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer3_attn_tp3&#45;&gt;dp1_pp1_layer3_attn_allreduce -->
<g id="edge687" class="edge">
<title>dp1_pp1_layer3_attn_tp3&#45;&gt;dp1_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M150898.21,-478.95C150874.43,-470.18 150847.17,-460.64 150822,-453.06 150767.42,-436.63 150706.31,-421.31 150653.86,-409.08"/>
<polygon fill="black" stroke="black" points="150654.37,-405.6 150643.83,-406.75 150652.78,-412.42 150654.37,-405.6"/>
</g>
<!-- dp1_pp1_layer3_expert0 -->
<g id="node423" class="node">
<title>dp1_pp1_layer3_expert0</title>
<polygon fill="lightgreen" stroke="black" points="146327,-406.29 146103,-406.29 146103,-354.29 146327,-354.29 146327,-406.29"/>
<text text-anchor="middle" x="146215" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="146215" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="146215" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="146215" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert0 -->
<g id="edge688" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147827.73,-499.65C147442.55,-490.26 146617.11,-465.13 146336,-417.06 146323.99,-415.01 146311.48,-412.16 146299.27,-408.95"/>
<polygon fill="black" stroke="black" points="146300.11,-405.56 146289.54,-406.32 146298.28,-412.31 146300.11,-405.56"/>
</g>
<!-- dp1_pp1_layer3_expert1 -->
<g id="node424" class="node">
<title>dp1_pp1_layer3_expert1</title>
<polygon fill="lightgreen" stroke="black" points="146569,-406.29 146345,-406.29 146345,-354.29 146569,-354.29 146569,-406.29"/>
<text text-anchor="middle" x="146457" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="146457" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="146457" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="146457" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert1 -->
<g id="edge689" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147825.55,-497.55C147483.94,-485.71 146811.58,-458.03 146578,-417.06 146566.08,-414.97 146553.67,-412.12 146541.54,-408.93"/>
<polygon fill="black" stroke="black" points="146542.45,-405.55 146531.89,-406.3 146540.62,-412.3 146542.45,-405.55"/>
</g>
<!-- dp1_pp1_layer3_expert2 -->
<g id="node425" class="node">
<title>dp1_pp1_layer3_expert2</title>
<polygon fill="lightgreen" stroke="black" points="146811,-406.29 146587,-406.29 146587,-354.29 146811,-354.29 146811,-406.29"/>
<text text-anchor="middle" x="146699" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="146699" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="146699" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="146699" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert2 -->
<g id="edge690" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147830.82,-502.85C147589.66,-498.37 147172.02,-480.97 146820,-417.06 146808.38,-414.95 146796.29,-412.14 146784.44,-409.03"/>
<polygon fill="black" stroke="black" points="146785.13,-405.59 146774.56,-406.34 146783.29,-412.34 146785.13,-405.59"/>
</g>
<!-- dp1_pp1_layer3_expert3 -->
<g id="node426" class="node">
<title>dp1_pp1_layer3_expert3</title>
<polygon fill="lightgreen" stroke="black" points="147053,-406.29 146829,-406.29 146829,-354.29 147053,-354.29 147053,-406.29"/>
<text text-anchor="middle" x="146941" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="146941" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="146941" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="146941" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert3 -->
<g id="edge691" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147825.36,-497.41C147628.31,-488.25 147322.63,-466.79 147062,-417.06 147050.57,-414.88 147038.67,-412.06 147026.99,-408.97"/>
<polygon fill="black" stroke="black" points="147027.82,-405.57 147017.25,-406.31 147025.98,-412.32 147027.82,-405.57"/>
</g>
<!-- dp1_pp1_layer3_expert4 -->
<g id="node427" class="node">
<title>dp1_pp1_layer3_expert4</title>
<polygon fill="lightgreen" stroke="black" points="147295,-406.29 147071,-406.29 147071,-354.29 147295,-354.29 147295,-406.29"/>
<text text-anchor="middle" x="147183" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="147183" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="147183" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="147183" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert4 -->
<g id="edge692" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147816.43,-487.98C147670.99,-474.71 147474.64,-452.25 147304,-417.06 147293.05,-414.8 147281.65,-412.02 147270.43,-409.02"/>
<polygon fill="black" stroke="black" points="147271.19,-405.6 147260.62,-406.33 147269.34,-412.35 147271.19,-405.6"/>
</g>
<!-- dp1_pp1_layer3_expert5 -->
<g id="node428" class="node">
<title>dp1_pp1_layer3_expert5</title>
<polygon fill="lightgreen" stroke="black" points="147537,-406.29 147313,-406.29 147313,-354.29 147537,-354.29 147537,-406.29"/>
<text text-anchor="middle" x="147425" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="147425" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="147425" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="147425" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert5 -->
<g id="edge693" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147796.29,-467.38C147716.5,-453.44 147627,-436.25 147546,-417.06 147535.9,-414.67 147525.4,-411.94 147514.99,-409.07"/>
<polygon fill="black" stroke="black" points="147515.62,-405.62 147505.05,-406.3 147513.74,-412.36 147515.62,-405.62"/>
</g>
<!-- dp1_pp1_layer3_expert6 -->
<g id="node429" class="node">
<title>dp1_pp1_layer3_expert6</title>
<polygon fill="lightgreen" stroke="black" points="147779,-406.29 147555,-406.29 147555,-354.29 147779,-354.29 147779,-406.29"/>
<text text-anchor="middle" x="147667" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="147667" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="147667" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="147667" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert6 -->
<g id="edge694" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147878.94,-452.97C147835.16,-438.16 147788.94,-422.53 147750.87,-409.66"/>
<polygon fill="black" stroke="black" points="147751.97,-406.33 147741.38,-406.45 147749.73,-412.97 147751.97,-406.33"/>
</g>
<!-- dp1_pp1_layer3_expert7 -->
<g id="node430" class="node">
<title>dp1_pp1_layer3_expert7</title>
<polygon fill="lightgreen" stroke="black" points="148021,-406.29 147797,-406.29 147797,-354.29 148021,-354.29 148021,-406.29"/>
<text text-anchor="middle" x="147909" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="147909" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="147909" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="147909" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert7 -->
<g id="edge695" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M147979.38,-452.71C147966.3,-439.43 147952.58,-425.51 147940.76,-413.52"/>
<polygon fill="black" stroke="black" points="147943.19,-411 147933.68,-406.33 147938.2,-415.91 147943.19,-411"/>
</g>
<!-- dp1_pp1_layer3_expert8 -->
<g id="node431" class="node">
<title>dp1_pp1_layer3_expert8</title>
<polygon fill="lightgreen" stroke="black" points="148263,-406.29 148039,-406.29 148039,-354.29 148263,-354.29 148263,-406.29"/>
<text text-anchor="middle" x="148151" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="148151" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="148151" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="148151" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert8 -->
<g id="edge696" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148080.61,-452.71C148093.7,-439.43 148107.42,-425.51 148119.23,-413.52"/>
<polygon fill="black" stroke="black" points="148121.79,-415.91 148126.32,-406.33 148116.81,-411 148121.79,-415.91"/>
</g>
<!-- dp1_pp1_layer3_expert9 -->
<g id="node432" class="node">
<title>dp1_pp1_layer3_expert9</title>
<polygon fill="lightgreen" stroke="black" points="148505,-406.29 148281,-406.29 148281,-354.29 148505,-354.29 148505,-406.29"/>
<text text-anchor="middle" x="148393" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="148393" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="148393" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="148393" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert9 -->
<g id="edge697" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148177.38,-454.21C148222.29,-439.03 148270.08,-422.86 148309.23,-409.62"/>
<polygon fill="black" stroke="black" points="148310.64,-412.84 148318.99,-406.32 148308.4,-406.21 148310.64,-412.84"/>
</g>
<!-- dp1_pp1_layer3_expert10 -->
<g id="node433" class="node">
<title>dp1_pp1_layer3_expert10</title>
<polygon fill="lightgreen" stroke="black" points="148747,-406.29 148523,-406.29 148523,-354.29 148747,-354.29 148747,-406.29"/>
<text text-anchor="middle" x="148635" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="148635" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="148635" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="148635" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert10 -->
<g id="edge698" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148200.89,-478.04C148293.98,-462.69 148410.88,-441.49 148514,-417.06 148524.09,-414.67 148534.6,-411.94 148545.01,-409.07"/>
<polygon fill="black" stroke="black" points="148546.26,-412.36 148554.95,-406.3 148544.37,-405.62 148546.26,-412.36"/>
</g>
<!-- dp1_pp1_layer3_expert11 -->
<g id="node434" class="node">
<title>dp1_pp1_layer3_expert11</title>
<polygon fill="lightgreen" stroke="black" points="148989,-406.29 148765,-406.29 148765,-354.29 148989,-354.29 148989,-406.29"/>
<text text-anchor="middle" x="148877" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="148877" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="148877" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="148877" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert11 -->
<g id="edge699" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148212.99,-490.7C148360.62,-477.88 148573.08,-454.78 148756,-417.06 148766.95,-414.8 148778.35,-412.02 148789.57,-409.02"/>
<polygon fill="black" stroke="black" points="148790.66,-412.35 148799.38,-406.33 148788.81,-405.6 148790.66,-412.35"/>
</g>
<!-- dp1_pp1_layer3_expert12 -->
<g id="node435" class="node">
<title>dp1_pp1_layer3_expert12</title>
<polygon fill="lightgreen" stroke="black" points="149231,-406.29 149007,-406.29 149007,-354.29 149231,-354.29 149231,-406.29"/>
<text text-anchor="middle" x="149119" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="149119" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="149119" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="149119" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert12 -->
<g id="edge700" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148220.27,-498.07C148416.59,-489.29 148730.95,-468.01 148998,-417.06 149009.43,-414.88 149021.33,-412.06 149033.01,-408.97"/>
<polygon fill="black" stroke="black" points="149034.02,-412.32 149042.75,-406.31 149032.18,-405.57 149034.02,-412.32"/>
</g>
<!-- dp1_pp1_layer3_expert13 -->
<g id="node436" class="node">
<title>dp1_pp1_layer3_expert13</title>
<polygon fill="lightgreen" stroke="black" points="149473,-406.29 149249,-406.29 149249,-354.29 149473,-354.29 149473,-406.29"/>
<text text-anchor="middle" x="149361" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="149361" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="149361" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="149361" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert13 -->
<g id="edge701" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148224.93,-502.93C148465.42,-498.58 148885.9,-481.35 149240,-417.06 149251.62,-414.95 149263.71,-412.14 149275.56,-409.03"/>
<polygon fill="black" stroke="black" points="149276.7,-412.34 149285.44,-406.34 149274.87,-405.59 149276.7,-412.34"/>
</g>
<!-- dp1_pp1_layer3_expert14 -->
<g id="node437" class="node">
<title>dp1_pp1_layer3_expert14</title>
<polygon fill="lightgreen" stroke="black" points="149715,-406.29 149491,-406.29 149491,-354.29 149715,-354.29 149715,-406.29"/>
<text text-anchor="middle" x="149603" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="149603" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="149603" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="149603" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert14 -->
<g id="edge702" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148220.32,-498.04C148557.17,-486.48 149245.15,-458.6 149482,-417.06 149493.92,-414.97 149506.32,-412.12 149518.46,-408.93"/>
<polygon fill="black" stroke="black" points="149519.38,-412.3 149528.11,-406.3 149517.54,-405.55 149519.38,-412.3"/>
</g>
<!-- dp1_pp1_layer3_expert15 -->
<g id="node438" class="node">
<title>dp1_pp1_layer3_expert15</title>
<polygon fill="lightgreen" stroke="black" points="149957,-406.29 149733,-406.29 149733,-354.29 149957,-354.29 149957,-406.29"/>
<text text-anchor="middle" x="149845" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="149845" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="149845" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="149845" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert15 -->
<g id="edge703" class="edge">
<title>dp1_pp1_layer3_router&#45;&gt;dp1_pp1_layer3_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M148221.94,-499.9C148602.49,-490.72 149440.35,-465.57 149724,-417.06 149736.01,-415.01 149748.51,-412.16 149760.73,-408.95"/>
<polygon fill="black" stroke="black" points="149761.72,-412.31 149770.45,-406.32 149759.88,-405.56 149761.72,-412.31"/>
</g>
<!-- dp1_pp1_layer3_expert_agg -->
<g id="node439" class="node">
<title>dp1_pp1_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="148277.57,-307.52 147883.74,-307.52 147782.43,-203.52 148176.26,-203.52 148277.57,-307.52"/>
<text text-anchor="middle" x="148030" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="148030" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="148030" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="148030" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer3_expert0&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge704" class="edge">
<title>dp1_pp1_layer3_expert0&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M146273.07,-354.29C146292.69,-346.92 146314.97,-339.72 146336,-335.52 146615.13,-279.86 147438.93,-263.21 147825.43,-258.4"/>
<polygon fill="black" stroke="black" points="147825.65,-261.9 147835.61,-258.27 147825.57,-254.9 147825.65,-261.9"/>
</g>
<!-- dp1_pp1_layer3_expert1&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge705" class="edge">
<title>dp1_pp1_layer3_expert1&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M146515.39,-354.27C146534.95,-346.95 146557.09,-339.78 146578,-335.52 146810.8,-288.16 147486.09,-267.74 147827.43,-260.24"/>
<polygon fill="black" stroke="black" points="147827.51,-263.74 147837.43,-260.03 147827.35,-256.74 147827.51,-263.74"/>
</g>
<!-- dp1_pp1_layer3_expert2&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge706" class="edge">
<title>dp1_pp1_layer3_expert2&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M146757.73,-354.29C146777.21,-347.01 146799.23,-339.87 146820,-335.52 147006.91,-296.44 147536.54,-273.07 147829.3,-262.78"/>
<polygon fill="black" stroke="black" points="147829.74,-266.27 147839.61,-262.42 147829.5,-259.27 147829.74,-266.27"/>
</g>
<!-- dp1_pp1_layer3_expert3&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge707" class="edge">
<title>dp1_pp1_layer3_expert3&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M147000.39,-354.26C147019.72,-347.07 147041.48,-339.99 147062,-335.52 147320.91,-279.18 147626.7,-262.24 147824.26,-257.56"/>
<polygon fill="black" stroke="black" points="147824.55,-261.06 147834.47,-257.33 147824.39,-254.06 147824.55,-261.06"/>
</g>
<!-- dp1_pp1_layer3_expert4&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge708" class="edge">
<title>dp1_pp1_layer3_expert4&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M147243.39,-354.24C147262.49,-347.2 147283.87,-340.19 147304,-335.52 147479.82,-294.77 147684.6,-274.91 147831.75,-265.31"/>
<polygon fill="black" stroke="black" points="147832.05,-268.8 147841.81,-264.67 147831.6,-261.82 147832.05,-268.8"/>
</g>
<!-- dp1_pp1_layer3_expert5&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge709" class="edge">
<title>dp1_pp1_layer3_expert5&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M147487.42,-354.22C147506.04,-347.42 147526.65,-340.55 147546,-335.52 147643.09,-310.27 147753.34,-291.53 147844.07,-278.65"/>
<polygon fill="black" stroke="black" points="147844.78,-282.09 147854.19,-277.23 147843.8,-275.16 147844.78,-282.09"/>
</g>
<!-- dp1_pp1_layer3_expert6&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge710" class="edge">
<title>dp1_pp1_layer3_expert6&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M147735.02,-354.26C147752.26,-348.03 147770.78,-341.44 147788,-335.52 147814.73,-326.33 147843.21,-316.8 147870.89,-307.67"/>
<polygon fill="black" stroke="black" points="147872.24,-310.91 147880.65,-304.46 147870.06,-304.26 147872.24,-310.91"/>
</g>
<!-- dp1_pp1_layer3_expert7&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge711" class="edge">
<title>dp1_pp1_layer3_expert7&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M147933.78,-354.15C147945.02,-342.74 147958.83,-328.73 147972.45,-314.92"/>
<polygon fill="black" stroke="black" points="147975,-317.31 147979.53,-307.73 147970.02,-312.39 147975,-317.31"/>
</g>
<!-- dp1_pp1_layer3_expert8&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge712" class="edge">
<title>dp1_pp1_layer3_expert8&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M148126.22,-354.15C148114.97,-342.74 148101.16,-328.73 148087.55,-314.92"/>
<polygon fill="black" stroke="black" points="148089.98,-312.39 148080.47,-307.73 148084.99,-317.31 148089.98,-312.39"/>
</g>
<!-- dp1_pp1_layer3_expert9&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge713" class="edge">
<title>dp1_pp1_layer3_expert9&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M148324.98,-354.26C148307.73,-348.03 148289.21,-341.44 148272,-335.52 148248.29,-327.37 148223.21,-318.95 148198.53,-310.78"/>
<polygon fill="black" stroke="black" points="148199.32,-307.36 148188.73,-307.54 148197.12,-314 148199.32,-307.36"/>
</g>
<!-- dp1_pp1_layer3_expert10&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge714" class="edge">
<title>dp1_pp1_layer3_expert10&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M148572.58,-354.22C148553.96,-347.42 148533.35,-340.55 148514,-335.52 148433.99,-314.71 148345.05,-298.33 148265.46,-286"/>
<polygon fill="black" stroke="black" points="148265.71,-282.5 148255.3,-284.44 148264.65,-289.41 148265.71,-282.5"/>
</g>
<!-- dp1_pp1_layer3_expert11&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge715" class="edge">
<title>dp1_pp1_layer3_expert11&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M148816.61,-354.24C148797.51,-347.2 148776.13,-340.19 148756,-335.52 148587.74,-296.53 148392.97,-276.66 148247.55,-266.61"/>
<polygon fill="black" stroke="black" points="148247.38,-263.09 148237.16,-265.9 148246.9,-270.07 148247.38,-263.09"/>
</g>
<!-- dp1_pp1_layer3_expert12&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge716" class="edge">
<title>dp1_pp1_layer3_expert12&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M149059.61,-354.26C149040.28,-347.07 149018.52,-339.99 148998,-335.52 148740.51,-279.49 148436.64,-262.43 148238.99,-257.64"/>
<polygon fill="black" stroke="black" points="148238.86,-254.14 148228.78,-257.4 148238.69,-261.13 148238.86,-254.14"/>
</g>
<!-- dp1_pp1_layer3_expert13&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge717" class="edge">
<title>dp1_pp1_layer3_expert13&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M149302.27,-354.29C149282.79,-347.01 149260.77,-339.87 149240,-335.52 149056.02,-297.05 148539.97,-273.81 148244.63,-263.27"/>
<polygon fill="black" stroke="black" points="148244.33,-259.76 148234.21,-262.9 148244.08,-266.76 148244.33,-259.76"/>
</g>
<!-- dp1_pp1_layer3_expert14&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge718" class="edge">
<title>dp1_pp1_layer3_expert14&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M149544.6,-354.27C149525.05,-346.95 149502.9,-339.78 149482,-335.52 149251.27,-288.58 148585.86,-268.1 148241.74,-260.45"/>
<polygon fill="black" stroke="black" points="148241.73,-256.94 148231.65,-260.22 148241.57,-263.94 148241.73,-256.94"/>
</g>
<!-- dp1_pp1_layer3_expert15&#45;&gt;dp1_pp1_layer3_expert_agg -->
<g id="edge719" class="edge">
<title>dp1_pp1_layer3_expert15&#45;&gt;dp1_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M149786.93,-354.29C149767.3,-346.92 149745.03,-339.72 149724,-335.52 149446.21,-280.12 148628.98,-263.37 148240.17,-258.47"/>
<polygon fill="black" stroke="black" points="148239.97,-254.97 148229.93,-258.34 148239.88,-261.97 148239.97,-254.97"/>
</g>
<!-- dp1_pp1_layer4_attn_tp0 -->
<g id="node440" class="node">
<title>dp1_pp1_layer4_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="145512.5,-531.06 145247.5,-531.06 145247.5,-479.06 145512.5,-479.06 145512.5,-531.06"/>
<text text-anchor="middle" x="145380" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="145380" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="145380" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="145380" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer3_expert_agg&#45;&gt;dp1_pp1_layer4_attn_tp0 -->
<g id="edge721" class="edge">
<title>dp1_pp1_layer3_expert_agg&#45;&gt;dp1_pp1_layer4_attn_tp0</title>
<path fill="none" stroke="black" d="M147837.78,-260.41C147417.38,-269.54 146427.17,-294.77 146094,-335.52 146061.8,-339.46 145553.23,-444.29 145522,-453.06 145499.37,-459.41 145475.16,-467.58 145453.26,-475.5"/>
<polygon fill="black" stroke="black" points="145451.89,-472.28 145443.7,-479 145454.29,-478.85 145451.89,-472.28"/>
</g>
<!-- dp1_pp1_layer4_attn_allreduce -->
<g id="node441" class="node">
<title>dp1_pp1_layer4_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="145509" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="145509" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="145509" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="145509" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="145509" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_attn_tp0&#45;&gt;dp1_pp1_layer4_attn_allreduce -->
<g id="edge722" class="edge">
<title>dp1_pp1_layer4_attn_tp0&#45;&gt;dp1_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M145406.41,-478.92C145423.15,-463 145445.21,-442 145464.58,-423.56"/>
<polygon fill="black" stroke="black" points="145467.03,-426.07 145471.86,-416.64 145462.2,-421 145467.03,-426.07"/>
</g>
<!-- dp1_pp1_layer4_router -->
<g id="node445" class="node">
<title>dp1_pp1_layer4_router</title>
<polygon fill="lightyellow" stroke="black" points="143260.57,-557.06 142866.74,-557.06 142765.43,-453.06 143159.26,-453.06 143260.57,-557.06"/>
<text text-anchor="middle" x="143013" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="143013" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="143013" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="143013" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_attn_allreduce&#45;&gt;dp1_pp1_layer4_router -->
<g id="edge758" class="edge">
<title>dp1_pp1_layer4_attn_allreduce&#45;&gt;dp1_pp1_layer4_router</title>
<path fill="none" stroke="black" d="M145349.08,-392.38C145237.77,-399.9 145085.89,-409.76 144952,-417.06 144316.5,-451.72 143563.28,-482.59 143211.96,-496.4"/>
<polygon fill="black" stroke="black" points="143211.8,-492.91 143201.94,-496.79 143212.07,-499.9 143211.8,-492.91"/>
</g>
<!-- dp1_pp1_layer4_attn_tp1 -->
<g id="node442" class="node">
<title>dp1_pp1_layer4_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="145795.5,-531.06 145530.5,-531.06 145530.5,-479.06 145795.5,-479.06 145795.5,-531.06"/>
<text text-anchor="middle" x="145663" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="145663" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="145663" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="145663" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer4_attn_tp1&#45;&gt;dp1_pp1_layer4_attn_allreduce -->
<g id="edge723" class="edge">
<title>dp1_pp1_layer4_attn_tp1&#45;&gt;dp1_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M145631.46,-478.92C145610.99,-462.6 145583.83,-440.94 145560.29,-422.18"/>
<polygon fill="black" stroke="black" points="145562.46,-419.44 145552.46,-415.94 145558.1,-424.91 145562.46,-419.44"/>
</g>
<!-- dp1_pp1_layer4_attn_tp2 -->
<g id="node443" class="node">
<title>dp1_pp1_layer4_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="145229.5,-531.06 144964.5,-531.06 144964.5,-479.06 145229.5,-479.06 145229.5,-531.06"/>
<text text-anchor="middle" x="145097" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="145097" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="145097" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="145097" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer4_attn_tp2&#45;&gt;dp1_pp1_layer4_attn_allreduce -->
<g id="edge724" class="edge">
<title>dp1_pp1_layer4_attn_tp2&#45;&gt;dp1_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M145163.07,-479.02C145186.85,-470.35 145213.99,-460.86 145239,-453.06 145287.74,-437.86 145342.05,-423.03 145389.1,-410.83"/>
<polygon fill="black" stroke="black" points="145390.22,-414.15 145399.03,-408.26 145388.47,-407.38 145390.22,-414.15"/>
</g>
<!-- dp1_pp1_layer4_attn_tp3 -->
<g id="node444" class="node">
<title>dp1_pp1_layer4_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="146078.5,-531.06 145813.5,-531.06 145813.5,-479.06 146078.5,-479.06 146078.5,-531.06"/>
<text text-anchor="middle" x="145946" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="145946" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="145946" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="145946" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer4_attn_tp3&#45;&gt;dp1_pp1_layer4_attn_allreduce -->
<g id="edge725" class="edge">
<title>dp1_pp1_layer4_attn_tp3&#45;&gt;dp1_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M145881.21,-478.95C145857.43,-470.18 145830.17,-460.64 145805,-453.06 145750.42,-436.63 145689.31,-421.31 145636.86,-409.08"/>
<polygon fill="black" stroke="black" points="145637.37,-405.6 145626.83,-406.75 145635.78,-412.42 145637.37,-405.6"/>
</g>
<!-- dp1_pp1_layer4_expert0 -->
<g id="node446" class="node">
<title>dp1_pp1_layer4_expert0</title>
<polygon fill="lightgreen" stroke="black" points="141310,-406.29 141086,-406.29 141086,-354.29 141310,-354.29 141310,-406.29"/>
<text text-anchor="middle" x="141198" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="141198" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="141198" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="141198" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert0 -->
<g id="edge726" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142810.73,-499.65C142425.55,-490.26 141600.11,-465.13 141319,-417.06 141306.99,-415.01 141294.48,-412.16 141282.27,-408.95"/>
<polygon fill="black" stroke="black" points="141283.11,-405.56 141272.54,-406.32 141281.28,-412.31 141283.11,-405.56"/>
</g>
<!-- dp1_pp1_layer4_expert1 -->
<g id="node447" class="node">
<title>dp1_pp1_layer4_expert1</title>
<polygon fill="lightgreen" stroke="black" points="141552,-406.29 141328,-406.29 141328,-354.29 141552,-354.29 141552,-406.29"/>
<text text-anchor="middle" x="141440" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="141440" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="141440" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="141440" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert1 -->
<g id="edge727" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142808.55,-497.55C142466.94,-485.71 141794.58,-458.03 141561,-417.06 141549.08,-414.97 141536.67,-412.12 141524.54,-408.93"/>
<polygon fill="black" stroke="black" points="141525.45,-405.55 141514.89,-406.3 141523.62,-412.3 141525.45,-405.55"/>
</g>
<!-- dp1_pp1_layer4_expert2 -->
<g id="node448" class="node">
<title>dp1_pp1_layer4_expert2</title>
<polygon fill="lightgreen" stroke="black" points="141794,-406.29 141570,-406.29 141570,-354.29 141794,-354.29 141794,-406.29"/>
<text text-anchor="middle" x="141682" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="141682" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="141682" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="141682" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert2 -->
<g id="edge728" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142813.82,-502.85C142572.66,-498.37 142155.02,-480.97 141803,-417.06 141791.38,-414.95 141779.29,-412.14 141767.44,-409.03"/>
<polygon fill="black" stroke="black" points="141768.13,-405.59 141757.56,-406.34 141766.29,-412.34 141768.13,-405.59"/>
</g>
<!-- dp1_pp1_layer4_expert3 -->
<g id="node449" class="node">
<title>dp1_pp1_layer4_expert3</title>
<polygon fill="lightgreen" stroke="black" points="142036,-406.29 141812,-406.29 141812,-354.29 142036,-354.29 142036,-406.29"/>
<text text-anchor="middle" x="141924" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="141924" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="141924" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="141924" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert3 -->
<g id="edge729" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142808.36,-497.41C142611.31,-488.25 142305.63,-466.79 142045,-417.06 142033.57,-414.88 142021.67,-412.06 142009.99,-408.97"/>
<polygon fill="black" stroke="black" points="142010.82,-405.57 142000.25,-406.31 142008.98,-412.32 142010.82,-405.57"/>
</g>
<!-- dp1_pp1_layer4_expert4 -->
<g id="node450" class="node">
<title>dp1_pp1_layer4_expert4</title>
<polygon fill="lightgreen" stroke="black" points="142278,-406.29 142054,-406.29 142054,-354.29 142278,-354.29 142278,-406.29"/>
<text text-anchor="middle" x="142166" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="142166" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="142166" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="142166" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert4 -->
<g id="edge730" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142799.43,-487.98C142653.99,-474.71 142457.64,-452.25 142287,-417.06 142276.05,-414.8 142264.65,-412.02 142253.43,-409.02"/>
<polygon fill="black" stroke="black" points="142254.19,-405.6 142243.62,-406.33 142252.34,-412.35 142254.19,-405.6"/>
</g>
<!-- dp1_pp1_layer4_expert5 -->
<g id="node451" class="node">
<title>dp1_pp1_layer4_expert5</title>
<polygon fill="lightgreen" stroke="black" points="142520,-406.29 142296,-406.29 142296,-354.29 142520,-354.29 142520,-406.29"/>
<text text-anchor="middle" x="142408" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="142408" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="142408" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="142408" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert5 -->
<g id="edge731" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142779.29,-467.38C142699.5,-453.44 142610,-436.25 142529,-417.06 142518.9,-414.67 142508.4,-411.94 142497.99,-409.07"/>
<polygon fill="black" stroke="black" points="142498.62,-405.62 142488.05,-406.3 142496.74,-412.36 142498.62,-405.62"/>
</g>
<!-- dp1_pp1_layer4_expert6 -->
<g id="node452" class="node">
<title>dp1_pp1_layer4_expert6</title>
<polygon fill="lightgreen" stroke="black" points="142762,-406.29 142538,-406.29 142538,-354.29 142762,-354.29 142762,-406.29"/>
<text text-anchor="middle" x="142650" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="142650" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="142650" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="142650" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert6 -->
<g id="edge732" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142861.94,-452.97C142818.16,-438.16 142771.94,-422.53 142733.87,-409.66"/>
<polygon fill="black" stroke="black" points="142734.97,-406.33 142724.38,-406.45 142732.73,-412.97 142734.97,-406.33"/>
</g>
<!-- dp1_pp1_layer4_expert7 -->
<g id="node453" class="node">
<title>dp1_pp1_layer4_expert7</title>
<polygon fill="lightgreen" stroke="black" points="143004,-406.29 142780,-406.29 142780,-354.29 143004,-354.29 143004,-406.29"/>
<text text-anchor="middle" x="142892" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="142892" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="142892" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="142892" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert7 -->
<g id="edge733" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M142962.38,-452.71C142949.3,-439.43 142935.58,-425.51 142923.76,-413.52"/>
<polygon fill="black" stroke="black" points="142926.19,-411 142916.68,-406.33 142921.2,-415.91 142926.19,-411"/>
</g>
<!-- dp1_pp1_layer4_expert8 -->
<g id="node454" class="node">
<title>dp1_pp1_layer4_expert8</title>
<polygon fill="lightgreen" stroke="black" points="143246,-406.29 143022,-406.29 143022,-354.29 143246,-354.29 143246,-406.29"/>
<text text-anchor="middle" x="143134" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="143134" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="143134" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="143134" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert8 -->
<g id="edge734" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143063.61,-452.71C143076.7,-439.43 143090.42,-425.51 143102.23,-413.52"/>
<polygon fill="black" stroke="black" points="143104.79,-415.91 143109.32,-406.33 143099.81,-411 143104.79,-415.91"/>
</g>
<!-- dp1_pp1_layer4_expert9 -->
<g id="node455" class="node">
<title>dp1_pp1_layer4_expert9</title>
<polygon fill="lightgreen" stroke="black" points="143488,-406.29 143264,-406.29 143264,-354.29 143488,-354.29 143488,-406.29"/>
<text text-anchor="middle" x="143376" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="143376" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="143376" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="143376" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert9 -->
<g id="edge735" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143160.38,-454.21C143205.29,-439.03 143253.08,-422.86 143292.23,-409.62"/>
<polygon fill="black" stroke="black" points="143293.64,-412.84 143301.99,-406.32 143291.4,-406.21 143293.64,-412.84"/>
</g>
<!-- dp1_pp1_layer4_expert10 -->
<g id="node456" class="node">
<title>dp1_pp1_layer4_expert10</title>
<polygon fill="lightgreen" stroke="black" points="143730,-406.29 143506,-406.29 143506,-354.29 143730,-354.29 143730,-406.29"/>
<text text-anchor="middle" x="143618" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="143618" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="143618" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="143618" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert10 -->
<g id="edge736" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143183.89,-478.04C143276.98,-462.69 143393.88,-441.49 143497,-417.06 143507.09,-414.67 143517.6,-411.94 143528.01,-409.07"/>
<polygon fill="black" stroke="black" points="143529.26,-412.36 143537.95,-406.3 143527.37,-405.62 143529.26,-412.36"/>
</g>
<!-- dp1_pp1_layer4_expert11 -->
<g id="node457" class="node">
<title>dp1_pp1_layer4_expert11</title>
<polygon fill="lightgreen" stroke="black" points="143972,-406.29 143748,-406.29 143748,-354.29 143972,-354.29 143972,-406.29"/>
<text text-anchor="middle" x="143860" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="143860" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="143860" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="143860" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert11 -->
<g id="edge737" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143195.99,-490.7C143343.62,-477.88 143556.08,-454.78 143739,-417.06 143749.95,-414.8 143761.35,-412.02 143772.57,-409.02"/>
<polygon fill="black" stroke="black" points="143773.66,-412.35 143782.38,-406.33 143771.81,-405.6 143773.66,-412.35"/>
</g>
<!-- dp1_pp1_layer4_expert12 -->
<g id="node458" class="node">
<title>dp1_pp1_layer4_expert12</title>
<polygon fill="lightgreen" stroke="black" points="144214,-406.29 143990,-406.29 143990,-354.29 144214,-354.29 144214,-406.29"/>
<text text-anchor="middle" x="144102" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="144102" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="144102" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="144102" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert12 -->
<g id="edge738" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143203.27,-498.07C143399.59,-489.29 143713.95,-468.01 143981,-417.06 143992.43,-414.88 144004.33,-412.06 144016.01,-408.97"/>
<polygon fill="black" stroke="black" points="144017.02,-412.32 144025.75,-406.31 144015.18,-405.57 144017.02,-412.32"/>
</g>
<!-- dp1_pp1_layer4_expert13 -->
<g id="node459" class="node">
<title>dp1_pp1_layer4_expert13</title>
<polygon fill="lightgreen" stroke="black" points="144456,-406.29 144232,-406.29 144232,-354.29 144456,-354.29 144456,-406.29"/>
<text text-anchor="middle" x="144344" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="144344" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="144344" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="144344" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert13 -->
<g id="edge739" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143207.93,-502.93C143448.42,-498.58 143868.9,-481.35 144223,-417.06 144234.62,-414.95 144246.71,-412.14 144258.56,-409.03"/>
<polygon fill="black" stroke="black" points="144259.7,-412.34 144268.44,-406.34 144257.87,-405.59 144259.7,-412.34"/>
</g>
<!-- dp1_pp1_layer4_expert14 -->
<g id="node460" class="node">
<title>dp1_pp1_layer4_expert14</title>
<polygon fill="lightgreen" stroke="black" points="144698,-406.29 144474,-406.29 144474,-354.29 144698,-354.29 144698,-406.29"/>
<text text-anchor="middle" x="144586" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="144586" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="144586" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="144586" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert14 -->
<g id="edge740" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143203.32,-498.04C143540.17,-486.48 144228.15,-458.6 144465,-417.06 144476.92,-414.97 144489.32,-412.12 144501.46,-408.93"/>
<polygon fill="black" stroke="black" points="144502.38,-412.3 144511.11,-406.3 144500.54,-405.55 144502.38,-412.3"/>
</g>
<!-- dp1_pp1_layer4_expert15 -->
<g id="node461" class="node">
<title>dp1_pp1_layer4_expert15</title>
<polygon fill="lightgreen" stroke="black" points="144940,-406.29 144716,-406.29 144716,-354.29 144940,-354.29 144940,-406.29"/>
<text text-anchor="middle" x="144828" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="144828" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="144828" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="144828" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert15 -->
<g id="edge741" class="edge">
<title>dp1_pp1_layer4_router&#45;&gt;dp1_pp1_layer4_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143204.94,-499.9C143585.49,-490.72 144423.35,-465.57 144707,-417.06 144719.01,-415.01 144731.51,-412.16 144743.73,-408.95"/>
<polygon fill="black" stroke="black" points="144744.72,-412.31 144753.45,-406.32 144742.88,-405.56 144744.72,-412.31"/>
</g>
<!-- dp1_pp1_layer4_expert_agg -->
<g id="node462" class="node">
<title>dp1_pp1_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="143260.57,-307.52 142866.74,-307.52 142765.43,-203.52 143159.26,-203.52 143260.57,-307.52"/>
<text text-anchor="middle" x="143013" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="143013" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="143013" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="143013" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer4_expert0&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge742" class="edge">
<title>dp1_pp1_layer4_expert0&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M141256.07,-354.29C141275.69,-346.92 141297.97,-339.72 141319,-335.52 141598.13,-279.86 142421.93,-263.21 142808.43,-258.4"/>
<polygon fill="black" stroke="black" points="142808.65,-261.9 142818.61,-258.27 142808.57,-254.9 142808.65,-261.9"/>
</g>
<!-- dp1_pp1_layer4_expert1&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge743" class="edge">
<title>dp1_pp1_layer4_expert1&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M141498.39,-354.27C141517.95,-346.95 141540.09,-339.78 141561,-335.52 141793.8,-288.16 142469.09,-267.74 142810.43,-260.24"/>
<polygon fill="black" stroke="black" points="142810.51,-263.74 142820.43,-260.03 142810.35,-256.74 142810.51,-263.74"/>
</g>
<!-- dp1_pp1_layer4_expert2&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge744" class="edge">
<title>dp1_pp1_layer4_expert2&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M141740.73,-354.29C141760.21,-347.01 141782.23,-339.87 141803,-335.52 141989.91,-296.44 142519.54,-273.07 142812.3,-262.78"/>
<polygon fill="black" stroke="black" points="142812.74,-266.27 142822.61,-262.42 142812.5,-259.27 142812.74,-266.27"/>
</g>
<!-- dp1_pp1_layer4_expert3&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge745" class="edge">
<title>dp1_pp1_layer4_expert3&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M141983.39,-354.26C142002.72,-347.07 142024.48,-339.99 142045,-335.52 142303.91,-279.18 142609.7,-262.24 142807.26,-257.56"/>
<polygon fill="black" stroke="black" points="142807.55,-261.06 142817.47,-257.33 142807.39,-254.06 142807.55,-261.06"/>
</g>
<!-- dp1_pp1_layer4_expert4&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge746" class="edge">
<title>dp1_pp1_layer4_expert4&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M142226.39,-354.24C142245.49,-347.2 142266.87,-340.19 142287,-335.52 142462.82,-294.77 142667.6,-274.91 142814.75,-265.31"/>
<polygon fill="black" stroke="black" points="142815.05,-268.8 142824.81,-264.67 142814.6,-261.82 142815.05,-268.8"/>
</g>
<!-- dp1_pp1_layer4_expert5&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge747" class="edge">
<title>dp1_pp1_layer4_expert5&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M142470.42,-354.22C142489.04,-347.42 142509.65,-340.55 142529,-335.52 142626.09,-310.27 142736.34,-291.53 142827.07,-278.65"/>
<polygon fill="black" stroke="black" points="142827.78,-282.09 142837.19,-277.23 142826.8,-275.16 142827.78,-282.09"/>
</g>
<!-- dp1_pp1_layer4_expert6&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge748" class="edge">
<title>dp1_pp1_layer4_expert6&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M142718.02,-354.26C142735.26,-348.03 142753.78,-341.44 142771,-335.52 142797.73,-326.33 142826.21,-316.8 142853.89,-307.67"/>
<polygon fill="black" stroke="black" points="142855.24,-310.91 142863.65,-304.46 142853.06,-304.26 142855.24,-310.91"/>
</g>
<!-- dp1_pp1_layer4_expert7&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge749" class="edge">
<title>dp1_pp1_layer4_expert7&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M142916.78,-354.15C142928.02,-342.74 142941.83,-328.73 142955.45,-314.92"/>
<polygon fill="black" stroke="black" points="142958,-317.31 142962.53,-307.73 142953.02,-312.39 142958,-317.31"/>
</g>
<!-- dp1_pp1_layer4_expert8&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge750" class="edge">
<title>dp1_pp1_layer4_expert8&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M143109.22,-354.15C143097.97,-342.74 143084.16,-328.73 143070.55,-314.92"/>
<polygon fill="black" stroke="black" points="143072.98,-312.39 143063.47,-307.73 143067.99,-317.31 143072.98,-312.39"/>
</g>
<!-- dp1_pp1_layer4_expert9&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge751" class="edge">
<title>dp1_pp1_layer4_expert9&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M143307.98,-354.26C143290.73,-348.03 143272.21,-341.44 143255,-335.52 143231.29,-327.37 143206.21,-318.95 143181.53,-310.78"/>
<polygon fill="black" stroke="black" points="143182.32,-307.36 143171.73,-307.54 143180.12,-314 143182.32,-307.36"/>
</g>
<!-- dp1_pp1_layer4_expert10&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge752" class="edge">
<title>dp1_pp1_layer4_expert10&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M143555.58,-354.22C143536.96,-347.42 143516.35,-340.55 143497,-335.52 143416.99,-314.71 143328.05,-298.33 143248.46,-286"/>
<polygon fill="black" stroke="black" points="143248.71,-282.5 143238.3,-284.44 143247.65,-289.41 143248.71,-282.5"/>
</g>
<!-- dp1_pp1_layer4_expert11&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge753" class="edge">
<title>dp1_pp1_layer4_expert11&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M143799.61,-354.24C143780.51,-347.2 143759.13,-340.19 143739,-335.52 143570.74,-296.53 143375.97,-276.66 143230.55,-266.61"/>
<polygon fill="black" stroke="black" points="143230.38,-263.09 143220.16,-265.9 143229.9,-270.07 143230.38,-263.09"/>
</g>
<!-- dp1_pp1_layer4_expert12&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge754" class="edge">
<title>dp1_pp1_layer4_expert12&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M144042.61,-354.26C144023.28,-347.07 144001.52,-339.99 143981,-335.52 143723.51,-279.49 143419.64,-262.43 143221.99,-257.64"/>
<polygon fill="black" stroke="black" points="143221.86,-254.14 143211.78,-257.4 143221.69,-261.13 143221.86,-254.14"/>
</g>
<!-- dp1_pp1_layer4_expert13&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge755" class="edge">
<title>dp1_pp1_layer4_expert13&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M144285.27,-354.29C144265.79,-347.01 144243.77,-339.87 144223,-335.52 144039.02,-297.05 143522.97,-273.81 143227.63,-263.27"/>
<polygon fill="black" stroke="black" points="143227.33,-259.76 143217.21,-262.9 143227.08,-266.76 143227.33,-259.76"/>
</g>
<!-- dp1_pp1_layer4_expert14&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge756" class="edge">
<title>dp1_pp1_layer4_expert14&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M144527.6,-354.27C144508.05,-346.95 144485.9,-339.78 144465,-335.52 144234.27,-288.58 143568.86,-268.1 143224.74,-260.45"/>
<polygon fill="black" stroke="black" points="143224.73,-256.94 143214.65,-260.22 143224.57,-263.94 143224.73,-256.94"/>
</g>
<!-- dp1_pp1_layer4_expert15&#45;&gt;dp1_pp1_layer4_expert_agg -->
<g id="edge757" class="edge">
<title>dp1_pp1_layer4_expert15&#45;&gt;dp1_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M144769.93,-354.29C144750.3,-346.92 144728.03,-339.72 144707,-335.52 144429.21,-280.12 143611.98,-263.37 143223.17,-258.47"/>
<polygon fill="black" stroke="black" points="143222.97,-254.97 143212.93,-258.34 143222.88,-261.97 143222.97,-254.97"/>
</g>
<!-- dp1_pp1_layer5_attn_tp0 -->
<g id="node463" class="node">
<title>dp1_pp1_layer5_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="140495.5,-531.06 140230.5,-531.06 140230.5,-479.06 140495.5,-479.06 140495.5,-531.06"/>
<text text-anchor="middle" x="140363" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="140363" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="140363" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="140363" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer4_expert_agg&#45;&gt;dp1_pp1_layer5_attn_tp0 -->
<g id="edge759" class="edge">
<title>dp1_pp1_layer4_expert_agg&#45;&gt;dp1_pp1_layer5_attn_tp0</title>
<path fill="none" stroke="black" d="M142820.78,-260.41C142400.38,-269.54 141410.17,-294.77 141077,-335.52 141044.8,-339.46 140536.23,-444.29 140505,-453.06 140482.37,-459.41 140458.16,-467.58 140436.26,-475.5"/>
<polygon fill="black" stroke="black" points="140434.89,-472.28 140426.7,-479 140437.29,-478.85 140434.89,-472.28"/>
</g>
<!-- dp1_pp1_layer5_attn_allreduce -->
<g id="node464" class="node">
<title>dp1_pp1_layer5_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="140492" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="140492" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="140492" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="140492" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="140492" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_attn_tp0&#45;&gt;dp1_pp1_layer5_attn_allreduce -->
<g id="edge760" class="edge">
<title>dp1_pp1_layer5_attn_tp0&#45;&gt;dp1_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M140389.41,-478.92C140406.15,-463 140428.21,-442 140447.58,-423.56"/>
<polygon fill="black" stroke="black" points="140450.03,-426.07 140454.86,-416.64 140445.2,-421 140450.03,-426.07"/>
</g>
<!-- dp1_pp1_layer5_router -->
<g id="node468" class="node">
<title>dp1_pp1_layer5_router</title>
<polygon fill="lightyellow" stroke="black" points="138243.57,-557.06 137849.74,-557.06 137748.43,-453.06 138142.26,-453.06 138243.57,-557.06"/>
<text text-anchor="middle" x="137996" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="137996" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="137996" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="137996" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_attn_allreduce&#45;&gt;dp1_pp1_layer5_router -->
<g id="edge796" class="edge">
<title>dp1_pp1_layer5_attn_allreduce&#45;&gt;dp1_pp1_layer5_router</title>
<path fill="none" stroke="black" d="M140332.08,-392.38C140220.77,-399.9 140068.89,-409.76 139935,-417.06 139299.5,-451.72 138546.28,-482.59 138194.96,-496.4"/>
<polygon fill="black" stroke="black" points="138194.8,-492.91 138184.94,-496.79 138195.07,-499.9 138194.8,-492.91"/>
</g>
<!-- dp1_pp1_layer5_attn_tp1 -->
<g id="node465" class="node">
<title>dp1_pp1_layer5_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="140778.5,-531.06 140513.5,-531.06 140513.5,-479.06 140778.5,-479.06 140778.5,-531.06"/>
<text text-anchor="middle" x="140646" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="140646" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="140646" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="140646" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer5_attn_tp1&#45;&gt;dp1_pp1_layer5_attn_allreduce -->
<g id="edge761" class="edge">
<title>dp1_pp1_layer5_attn_tp1&#45;&gt;dp1_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M140614.46,-478.92C140593.99,-462.6 140566.83,-440.94 140543.29,-422.18"/>
<polygon fill="black" stroke="black" points="140545.46,-419.44 140535.46,-415.94 140541.1,-424.91 140545.46,-419.44"/>
</g>
<!-- dp1_pp1_layer5_attn_tp2 -->
<g id="node466" class="node">
<title>dp1_pp1_layer5_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="140212.5,-531.06 139947.5,-531.06 139947.5,-479.06 140212.5,-479.06 140212.5,-531.06"/>
<text text-anchor="middle" x="140080" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="140080" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="140080" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="140080" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer5_attn_tp2&#45;&gt;dp1_pp1_layer5_attn_allreduce -->
<g id="edge762" class="edge">
<title>dp1_pp1_layer5_attn_tp2&#45;&gt;dp1_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M140146.07,-479.02C140169.85,-470.35 140196.99,-460.86 140222,-453.06 140270.74,-437.86 140325.05,-423.03 140372.1,-410.83"/>
<polygon fill="black" stroke="black" points="140373.22,-414.15 140382.03,-408.26 140371.47,-407.38 140373.22,-414.15"/>
</g>
<!-- dp1_pp1_layer5_attn_tp3 -->
<g id="node467" class="node">
<title>dp1_pp1_layer5_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="141061.5,-531.06 140796.5,-531.06 140796.5,-479.06 141061.5,-479.06 141061.5,-531.06"/>
<text text-anchor="middle" x="140929" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="140929" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="140929" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="140929" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer5_attn_tp3&#45;&gt;dp1_pp1_layer5_attn_allreduce -->
<g id="edge763" class="edge">
<title>dp1_pp1_layer5_attn_tp3&#45;&gt;dp1_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M140864.21,-478.95C140840.43,-470.18 140813.17,-460.64 140788,-453.06 140733.42,-436.63 140672.31,-421.31 140619.86,-409.08"/>
<polygon fill="black" stroke="black" points="140620.37,-405.6 140609.83,-406.75 140618.78,-412.42 140620.37,-405.6"/>
</g>
<!-- dp1_pp1_layer5_expert0 -->
<g id="node469" class="node">
<title>dp1_pp1_layer5_expert0</title>
<polygon fill="lightgreen" stroke="black" points="136293,-406.29 136069,-406.29 136069,-354.29 136293,-354.29 136293,-406.29"/>
<text text-anchor="middle" x="136181" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="136181" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="136181" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="136181" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert0 -->
<g id="edge764" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137793.73,-499.65C137408.55,-490.26 136583.11,-465.13 136302,-417.06 136289.99,-415.01 136277.48,-412.16 136265.27,-408.95"/>
<polygon fill="black" stroke="black" points="136266.11,-405.56 136255.54,-406.32 136264.28,-412.31 136266.11,-405.56"/>
</g>
<!-- dp1_pp1_layer5_expert1 -->
<g id="node470" class="node">
<title>dp1_pp1_layer5_expert1</title>
<polygon fill="lightgreen" stroke="black" points="136535,-406.29 136311,-406.29 136311,-354.29 136535,-354.29 136535,-406.29"/>
<text text-anchor="middle" x="136423" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="136423" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="136423" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="136423" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert1 -->
<g id="edge765" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137791.55,-497.55C137449.94,-485.71 136777.58,-458.03 136544,-417.06 136532.08,-414.97 136519.67,-412.12 136507.54,-408.93"/>
<polygon fill="black" stroke="black" points="136508.45,-405.55 136497.89,-406.3 136506.62,-412.3 136508.45,-405.55"/>
</g>
<!-- dp1_pp1_layer5_expert2 -->
<g id="node471" class="node">
<title>dp1_pp1_layer5_expert2</title>
<polygon fill="lightgreen" stroke="black" points="136777,-406.29 136553,-406.29 136553,-354.29 136777,-354.29 136777,-406.29"/>
<text text-anchor="middle" x="136665" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="136665" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="136665" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="136665" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert2 -->
<g id="edge766" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137796.82,-502.85C137555.66,-498.37 137138.02,-480.97 136786,-417.06 136774.38,-414.95 136762.29,-412.14 136750.44,-409.03"/>
<polygon fill="black" stroke="black" points="136751.13,-405.59 136740.56,-406.34 136749.29,-412.34 136751.13,-405.59"/>
</g>
<!-- dp1_pp1_layer5_expert3 -->
<g id="node472" class="node">
<title>dp1_pp1_layer5_expert3</title>
<polygon fill="lightgreen" stroke="black" points="137019,-406.29 136795,-406.29 136795,-354.29 137019,-354.29 137019,-406.29"/>
<text text-anchor="middle" x="136907" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="136907" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="136907" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="136907" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert3 -->
<g id="edge767" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137791.36,-497.41C137594.31,-488.25 137288.63,-466.79 137028,-417.06 137016.57,-414.88 137004.67,-412.06 136992.99,-408.97"/>
<polygon fill="black" stroke="black" points="136993.82,-405.57 136983.25,-406.31 136991.98,-412.32 136993.82,-405.57"/>
</g>
<!-- dp1_pp1_layer5_expert4 -->
<g id="node473" class="node">
<title>dp1_pp1_layer5_expert4</title>
<polygon fill="lightgreen" stroke="black" points="137261,-406.29 137037,-406.29 137037,-354.29 137261,-354.29 137261,-406.29"/>
<text text-anchor="middle" x="137149" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="137149" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="137149" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="137149" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert4 -->
<g id="edge768" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137782.43,-487.98C137636.99,-474.71 137440.64,-452.25 137270,-417.06 137259.05,-414.8 137247.65,-412.02 137236.43,-409.02"/>
<polygon fill="black" stroke="black" points="137237.19,-405.6 137226.62,-406.33 137235.34,-412.35 137237.19,-405.6"/>
</g>
<!-- dp1_pp1_layer5_expert5 -->
<g id="node474" class="node">
<title>dp1_pp1_layer5_expert5</title>
<polygon fill="lightgreen" stroke="black" points="137503,-406.29 137279,-406.29 137279,-354.29 137503,-354.29 137503,-406.29"/>
<text text-anchor="middle" x="137391" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="137391" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="137391" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="137391" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert5 -->
<g id="edge769" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137762.29,-467.38C137682.5,-453.44 137593,-436.25 137512,-417.06 137501.9,-414.67 137491.4,-411.94 137480.99,-409.07"/>
<polygon fill="black" stroke="black" points="137481.62,-405.62 137471.05,-406.3 137479.74,-412.36 137481.62,-405.62"/>
</g>
<!-- dp1_pp1_layer5_expert6 -->
<g id="node475" class="node">
<title>dp1_pp1_layer5_expert6</title>
<polygon fill="lightgreen" stroke="black" points="137745,-406.29 137521,-406.29 137521,-354.29 137745,-354.29 137745,-406.29"/>
<text text-anchor="middle" x="137633" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="137633" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="137633" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="137633" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert6 -->
<g id="edge770" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137844.94,-452.97C137801.16,-438.16 137754.94,-422.53 137716.87,-409.66"/>
<polygon fill="black" stroke="black" points="137717.97,-406.33 137707.38,-406.45 137715.73,-412.97 137717.97,-406.33"/>
</g>
<!-- dp1_pp1_layer5_expert7 -->
<g id="node476" class="node">
<title>dp1_pp1_layer5_expert7</title>
<polygon fill="lightgreen" stroke="black" points="137987,-406.29 137763,-406.29 137763,-354.29 137987,-354.29 137987,-406.29"/>
<text text-anchor="middle" x="137875" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="137875" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="137875" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="137875" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert7 -->
<g id="edge771" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M137945.38,-452.71C137932.3,-439.43 137918.58,-425.51 137906.76,-413.52"/>
<polygon fill="black" stroke="black" points="137909.19,-411 137899.68,-406.33 137904.2,-415.91 137909.19,-411"/>
</g>
<!-- dp1_pp1_layer5_expert8 -->
<g id="node477" class="node">
<title>dp1_pp1_layer5_expert8</title>
<polygon fill="lightgreen" stroke="black" points="138229,-406.29 138005,-406.29 138005,-354.29 138229,-354.29 138229,-406.29"/>
<text text-anchor="middle" x="138117" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="138117" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="138117" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="138117" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert8 -->
<g id="edge772" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138046.61,-452.71C138059.7,-439.43 138073.42,-425.51 138085.23,-413.52"/>
<polygon fill="black" stroke="black" points="138087.79,-415.91 138092.32,-406.33 138082.81,-411 138087.79,-415.91"/>
</g>
<!-- dp1_pp1_layer5_expert9 -->
<g id="node478" class="node">
<title>dp1_pp1_layer5_expert9</title>
<polygon fill="lightgreen" stroke="black" points="138471,-406.29 138247,-406.29 138247,-354.29 138471,-354.29 138471,-406.29"/>
<text text-anchor="middle" x="138359" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="138359" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="138359" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="138359" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert9 -->
<g id="edge773" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138143.38,-454.21C138188.29,-439.03 138236.08,-422.86 138275.23,-409.62"/>
<polygon fill="black" stroke="black" points="138276.64,-412.84 138284.99,-406.32 138274.4,-406.21 138276.64,-412.84"/>
</g>
<!-- dp1_pp1_layer5_expert10 -->
<g id="node479" class="node">
<title>dp1_pp1_layer5_expert10</title>
<polygon fill="lightgreen" stroke="black" points="138713,-406.29 138489,-406.29 138489,-354.29 138713,-354.29 138713,-406.29"/>
<text text-anchor="middle" x="138601" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="138601" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="138601" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="138601" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert10 -->
<g id="edge774" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138166.89,-478.04C138259.98,-462.69 138376.88,-441.49 138480,-417.06 138490.09,-414.67 138500.6,-411.94 138511.01,-409.07"/>
<polygon fill="black" stroke="black" points="138512.26,-412.36 138520.95,-406.3 138510.37,-405.62 138512.26,-412.36"/>
</g>
<!-- dp1_pp1_layer5_expert11 -->
<g id="node480" class="node">
<title>dp1_pp1_layer5_expert11</title>
<polygon fill="lightgreen" stroke="black" points="138955,-406.29 138731,-406.29 138731,-354.29 138955,-354.29 138955,-406.29"/>
<text text-anchor="middle" x="138843" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="138843" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="138843" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="138843" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert11 -->
<g id="edge775" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138178.99,-490.7C138326.62,-477.88 138539.08,-454.78 138722,-417.06 138732.95,-414.8 138744.35,-412.02 138755.57,-409.02"/>
<polygon fill="black" stroke="black" points="138756.66,-412.35 138765.38,-406.33 138754.81,-405.6 138756.66,-412.35"/>
</g>
<!-- dp1_pp1_layer5_expert12 -->
<g id="node481" class="node">
<title>dp1_pp1_layer5_expert12</title>
<polygon fill="lightgreen" stroke="black" points="139197,-406.29 138973,-406.29 138973,-354.29 139197,-354.29 139197,-406.29"/>
<text text-anchor="middle" x="139085" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="139085" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="139085" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="139085" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert12 -->
<g id="edge776" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138186.27,-498.07C138382.59,-489.29 138696.95,-468.01 138964,-417.06 138975.43,-414.88 138987.33,-412.06 138999.01,-408.97"/>
<polygon fill="black" stroke="black" points="139000.02,-412.32 139008.75,-406.31 138998.18,-405.57 139000.02,-412.32"/>
</g>
<!-- dp1_pp1_layer5_expert13 -->
<g id="node482" class="node">
<title>dp1_pp1_layer5_expert13</title>
<polygon fill="lightgreen" stroke="black" points="139439,-406.29 139215,-406.29 139215,-354.29 139439,-354.29 139439,-406.29"/>
<text text-anchor="middle" x="139327" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="139327" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="139327" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="139327" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert13 -->
<g id="edge777" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138190.93,-502.93C138431.42,-498.58 138851.9,-481.35 139206,-417.06 139217.62,-414.95 139229.71,-412.14 139241.56,-409.03"/>
<polygon fill="black" stroke="black" points="139242.7,-412.34 139251.44,-406.34 139240.87,-405.59 139242.7,-412.34"/>
</g>
<!-- dp1_pp1_layer5_expert14 -->
<g id="node483" class="node">
<title>dp1_pp1_layer5_expert14</title>
<polygon fill="lightgreen" stroke="black" points="139681,-406.29 139457,-406.29 139457,-354.29 139681,-354.29 139681,-406.29"/>
<text text-anchor="middle" x="139569" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="139569" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="139569" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="139569" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert14 -->
<g id="edge778" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138186.32,-498.04C138523.17,-486.48 139211.15,-458.6 139448,-417.06 139459.92,-414.97 139472.32,-412.12 139484.46,-408.93"/>
<polygon fill="black" stroke="black" points="139485.38,-412.3 139494.11,-406.3 139483.54,-405.55 139485.38,-412.3"/>
</g>
<!-- dp1_pp1_layer5_expert15 -->
<g id="node484" class="node">
<title>dp1_pp1_layer5_expert15</title>
<polygon fill="lightgreen" stroke="black" points="139923,-406.29 139699,-406.29 139699,-354.29 139923,-354.29 139923,-406.29"/>
<text text-anchor="middle" x="139811" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="139811" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="139811" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="139811" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert15 -->
<g id="edge779" class="edge">
<title>dp1_pp1_layer5_router&#45;&gt;dp1_pp1_layer5_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M138187.94,-499.9C138568.49,-490.72 139406.35,-465.57 139690,-417.06 139702.01,-415.01 139714.51,-412.16 139726.73,-408.95"/>
<polygon fill="black" stroke="black" points="139727.72,-412.31 139736.45,-406.32 139725.88,-405.56 139727.72,-412.31"/>
</g>
<!-- dp1_pp1_layer5_expert_agg -->
<g id="node485" class="node">
<title>dp1_pp1_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="138243.57,-307.52 137849.74,-307.52 137748.43,-203.52 138142.26,-203.52 138243.57,-307.52"/>
<text text-anchor="middle" x="137996" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="137996" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="137996" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="137996" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer5_expert0&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge780" class="edge">
<title>dp1_pp1_layer5_expert0&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M136239.07,-354.29C136258.69,-346.92 136280.97,-339.72 136302,-335.52 136581.13,-279.86 137404.93,-263.21 137791.43,-258.4"/>
<polygon fill="black" stroke="black" points="137791.65,-261.9 137801.61,-258.27 137791.57,-254.9 137791.65,-261.9"/>
</g>
<!-- dp1_pp1_layer5_expert1&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge781" class="edge">
<title>dp1_pp1_layer5_expert1&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M136481.39,-354.27C136500.95,-346.95 136523.09,-339.78 136544,-335.52 136776.8,-288.16 137452.09,-267.74 137793.43,-260.24"/>
<polygon fill="black" stroke="black" points="137793.51,-263.74 137803.43,-260.03 137793.35,-256.74 137793.51,-263.74"/>
</g>
<!-- dp1_pp1_layer5_expert2&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge782" class="edge">
<title>dp1_pp1_layer5_expert2&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M136723.73,-354.29C136743.21,-347.01 136765.23,-339.87 136786,-335.52 136972.91,-296.44 137502.54,-273.07 137795.3,-262.78"/>
<polygon fill="black" stroke="black" points="137795.74,-266.27 137805.61,-262.42 137795.5,-259.27 137795.74,-266.27"/>
</g>
<!-- dp1_pp1_layer5_expert3&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge783" class="edge">
<title>dp1_pp1_layer5_expert3&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M136966.39,-354.26C136985.72,-347.07 137007.48,-339.99 137028,-335.52 137286.91,-279.18 137592.7,-262.24 137790.26,-257.56"/>
<polygon fill="black" stroke="black" points="137790.55,-261.06 137800.47,-257.33 137790.39,-254.06 137790.55,-261.06"/>
</g>
<!-- dp1_pp1_layer5_expert4&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge784" class="edge">
<title>dp1_pp1_layer5_expert4&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M137209.39,-354.24C137228.49,-347.2 137249.87,-340.19 137270,-335.52 137445.82,-294.77 137650.6,-274.91 137797.75,-265.31"/>
<polygon fill="black" stroke="black" points="137798.05,-268.8 137807.81,-264.67 137797.6,-261.82 137798.05,-268.8"/>
</g>
<!-- dp1_pp1_layer5_expert5&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge785" class="edge">
<title>dp1_pp1_layer5_expert5&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M137453.42,-354.22C137472.04,-347.42 137492.65,-340.55 137512,-335.52 137609.09,-310.27 137719.34,-291.53 137810.07,-278.65"/>
<polygon fill="black" stroke="black" points="137810.78,-282.09 137820.19,-277.23 137809.8,-275.16 137810.78,-282.09"/>
</g>
<!-- dp1_pp1_layer5_expert6&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge786" class="edge">
<title>dp1_pp1_layer5_expert6&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M137701.02,-354.26C137718.26,-348.03 137736.78,-341.44 137754,-335.52 137780.73,-326.33 137809.21,-316.8 137836.89,-307.67"/>
<polygon fill="black" stroke="black" points="137838.24,-310.91 137846.65,-304.46 137836.06,-304.26 137838.24,-310.91"/>
</g>
<!-- dp1_pp1_layer5_expert7&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge787" class="edge">
<title>dp1_pp1_layer5_expert7&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M137899.78,-354.15C137911.02,-342.74 137924.83,-328.73 137938.45,-314.92"/>
<polygon fill="black" stroke="black" points="137941,-317.31 137945.53,-307.73 137936.02,-312.39 137941,-317.31"/>
</g>
<!-- dp1_pp1_layer5_expert8&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge788" class="edge">
<title>dp1_pp1_layer5_expert8&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M138092.22,-354.15C138080.97,-342.74 138067.16,-328.73 138053.55,-314.92"/>
<polygon fill="black" stroke="black" points="138055.98,-312.39 138046.47,-307.73 138050.99,-317.31 138055.98,-312.39"/>
</g>
<!-- dp1_pp1_layer5_expert9&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge789" class="edge">
<title>dp1_pp1_layer5_expert9&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M138290.98,-354.26C138273.73,-348.03 138255.21,-341.44 138238,-335.52 138214.29,-327.37 138189.21,-318.95 138164.53,-310.78"/>
<polygon fill="black" stroke="black" points="138165.32,-307.36 138154.73,-307.54 138163.12,-314 138165.32,-307.36"/>
</g>
<!-- dp1_pp1_layer5_expert10&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge790" class="edge">
<title>dp1_pp1_layer5_expert10&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M138538.58,-354.22C138519.96,-347.42 138499.35,-340.55 138480,-335.52 138399.99,-314.71 138311.05,-298.33 138231.46,-286"/>
<polygon fill="black" stroke="black" points="138231.71,-282.5 138221.3,-284.44 138230.65,-289.41 138231.71,-282.5"/>
</g>
<!-- dp1_pp1_layer5_expert11&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge791" class="edge">
<title>dp1_pp1_layer5_expert11&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M138782.61,-354.24C138763.51,-347.2 138742.13,-340.19 138722,-335.52 138553.74,-296.53 138358.97,-276.66 138213.55,-266.61"/>
<polygon fill="black" stroke="black" points="138213.38,-263.09 138203.16,-265.9 138212.9,-270.07 138213.38,-263.09"/>
</g>
<!-- dp1_pp1_layer5_expert12&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge792" class="edge">
<title>dp1_pp1_layer5_expert12&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M139025.61,-354.26C139006.28,-347.07 138984.52,-339.99 138964,-335.52 138706.51,-279.49 138402.64,-262.43 138204.99,-257.64"/>
<polygon fill="black" stroke="black" points="138204.86,-254.14 138194.78,-257.4 138204.69,-261.13 138204.86,-254.14"/>
</g>
<!-- dp1_pp1_layer5_expert13&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge793" class="edge">
<title>dp1_pp1_layer5_expert13&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M139268.27,-354.29C139248.79,-347.01 139226.77,-339.87 139206,-335.52 139022.02,-297.05 138505.97,-273.81 138210.63,-263.27"/>
<polygon fill="black" stroke="black" points="138210.33,-259.76 138200.21,-262.9 138210.08,-266.76 138210.33,-259.76"/>
</g>
<!-- dp1_pp1_layer5_expert14&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge794" class="edge">
<title>dp1_pp1_layer5_expert14&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M139510.6,-354.27C139491.05,-346.95 139468.9,-339.78 139448,-335.52 139217.27,-288.58 138551.86,-268.1 138207.74,-260.45"/>
<polygon fill="black" stroke="black" points="138207.73,-256.94 138197.65,-260.22 138207.57,-263.94 138207.73,-256.94"/>
</g>
<!-- dp1_pp1_layer5_expert15&#45;&gt;dp1_pp1_layer5_expert_agg -->
<g id="edge795" class="edge">
<title>dp1_pp1_layer5_expert15&#45;&gt;dp1_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M139752.93,-354.29C139733.3,-346.92 139711.03,-339.72 139690,-335.52 139412.21,-280.12 138594.98,-263.37 138206.17,-258.47"/>
<polygon fill="black" stroke="black" points="138205.97,-254.97 138195.93,-258.34 138205.88,-261.97 138205.97,-254.97"/>
</g>
<!-- dp1_pp1_layer6_attn_tp0 -->
<g id="node486" class="node">
<title>dp1_pp1_layer6_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="135478.5,-531.06 135213.5,-531.06 135213.5,-479.06 135478.5,-479.06 135478.5,-531.06"/>
<text text-anchor="middle" x="135346" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="135346" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="135346" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="135346" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer5_expert_agg&#45;&gt;dp1_pp1_layer6_attn_tp0 -->
<g id="edge797" class="edge">
<title>dp1_pp1_layer5_expert_agg&#45;&gt;dp1_pp1_layer6_attn_tp0</title>
<path fill="none" stroke="black" d="M137803.78,-260.41C137383.38,-269.54 136393.17,-294.77 136060,-335.52 136027.8,-339.46 135519.23,-444.29 135488,-453.06 135465.37,-459.41 135441.16,-467.58 135419.26,-475.5"/>
<polygon fill="black" stroke="black" points="135417.89,-472.28 135409.7,-479 135420.29,-478.85 135417.89,-472.28"/>
</g>
<!-- dp1_pp1_layer6_attn_allreduce -->
<g id="node487" class="node">
<title>dp1_pp1_layer6_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="135475" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="135475" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="135475" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="135475" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="135475" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_attn_tp0&#45;&gt;dp1_pp1_layer6_attn_allreduce -->
<g id="edge798" class="edge">
<title>dp1_pp1_layer6_attn_tp0&#45;&gt;dp1_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M135372.41,-478.92C135389.15,-463 135411.21,-442 135430.58,-423.56"/>
<polygon fill="black" stroke="black" points="135433.03,-426.07 135437.86,-416.64 135428.2,-421 135433.03,-426.07"/>
</g>
<!-- dp1_pp1_layer6_router -->
<g id="node491" class="node">
<title>dp1_pp1_layer6_router</title>
<polygon fill="lightyellow" stroke="black" points="133226.57,-557.06 132832.74,-557.06 132731.43,-453.06 133125.26,-453.06 133226.57,-557.06"/>
<text text-anchor="middle" x="132979" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="132979" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="132979" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="132979" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_attn_allreduce&#45;&gt;dp1_pp1_layer6_router -->
<g id="edge834" class="edge">
<title>dp1_pp1_layer6_attn_allreduce&#45;&gt;dp1_pp1_layer6_router</title>
<path fill="none" stroke="black" d="M135315.08,-392.38C135203.77,-399.9 135051.89,-409.76 134918,-417.06 134282.5,-451.72 133529.28,-482.59 133177.96,-496.4"/>
<polygon fill="black" stroke="black" points="133177.8,-492.91 133167.94,-496.79 133178.07,-499.9 133177.8,-492.91"/>
</g>
<!-- dp1_pp1_layer6_attn_tp1 -->
<g id="node488" class="node">
<title>dp1_pp1_layer6_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="135761.5,-531.06 135496.5,-531.06 135496.5,-479.06 135761.5,-479.06 135761.5,-531.06"/>
<text text-anchor="middle" x="135629" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="135629" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="135629" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="135629" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer6_attn_tp1&#45;&gt;dp1_pp1_layer6_attn_allreduce -->
<g id="edge799" class="edge">
<title>dp1_pp1_layer6_attn_tp1&#45;&gt;dp1_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M135597.46,-478.92C135576.99,-462.6 135549.83,-440.94 135526.29,-422.18"/>
<polygon fill="black" stroke="black" points="135528.46,-419.44 135518.46,-415.94 135524.1,-424.91 135528.46,-419.44"/>
</g>
<!-- dp1_pp1_layer6_attn_tp2 -->
<g id="node489" class="node">
<title>dp1_pp1_layer6_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="135195.5,-531.06 134930.5,-531.06 134930.5,-479.06 135195.5,-479.06 135195.5,-531.06"/>
<text text-anchor="middle" x="135063" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="135063" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="135063" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="135063" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer6_attn_tp2&#45;&gt;dp1_pp1_layer6_attn_allreduce -->
<g id="edge800" class="edge">
<title>dp1_pp1_layer6_attn_tp2&#45;&gt;dp1_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M135129.07,-479.02C135152.85,-470.35 135179.99,-460.86 135205,-453.06 135253.74,-437.86 135308.05,-423.03 135355.1,-410.83"/>
<polygon fill="black" stroke="black" points="135356.22,-414.15 135365.03,-408.26 135354.47,-407.38 135356.22,-414.15"/>
</g>
<!-- dp1_pp1_layer6_attn_tp3 -->
<g id="node490" class="node">
<title>dp1_pp1_layer6_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="136044.5,-531.06 135779.5,-531.06 135779.5,-479.06 136044.5,-479.06 136044.5,-531.06"/>
<text text-anchor="middle" x="135912" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="135912" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="135912" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="135912" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer6_attn_tp3&#45;&gt;dp1_pp1_layer6_attn_allreduce -->
<g id="edge801" class="edge">
<title>dp1_pp1_layer6_attn_tp3&#45;&gt;dp1_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M135847.21,-478.95C135823.43,-470.18 135796.17,-460.64 135771,-453.06 135716.42,-436.63 135655.31,-421.31 135602.86,-409.08"/>
<polygon fill="black" stroke="black" points="135603.37,-405.6 135592.83,-406.75 135601.78,-412.42 135603.37,-405.6"/>
</g>
<!-- dp1_pp1_layer6_expert0 -->
<g id="node492" class="node">
<title>dp1_pp1_layer6_expert0</title>
<polygon fill="lightgreen" stroke="black" points="131276,-406.29 131052,-406.29 131052,-354.29 131276,-354.29 131276,-406.29"/>
<text text-anchor="middle" x="131164" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="131164" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="131164" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="131164" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert0 -->
<g id="edge802" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132776.73,-499.65C132391.55,-490.26 131566.11,-465.13 131285,-417.06 131272.99,-415.01 131260.48,-412.16 131248.27,-408.95"/>
<polygon fill="black" stroke="black" points="131249.11,-405.56 131238.54,-406.32 131247.28,-412.31 131249.11,-405.56"/>
</g>
<!-- dp1_pp1_layer6_expert1 -->
<g id="node493" class="node">
<title>dp1_pp1_layer6_expert1</title>
<polygon fill="lightgreen" stroke="black" points="131518,-406.29 131294,-406.29 131294,-354.29 131518,-354.29 131518,-406.29"/>
<text text-anchor="middle" x="131406" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="131406" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="131406" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="131406" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert1 -->
<g id="edge803" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132774.55,-497.55C132432.94,-485.71 131760.58,-458.03 131527,-417.06 131515.08,-414.97 131502.67,-412.12 131490.54,-408.93"/>
<polygon fill="black" stroke="black" points="131491.45,-405.55 131480.89,-406.3 131489.62,-412.3 131491.45,-405.55"/>
</g>
<!-- dp1_pp1_layer6_expert2 -->
<g id="node494" class="node">
<title>dp1_pp1_layer6_expert2</title>
<polygon fill="lightgreen" stroke="black" points="131760,-406.29 131536,-406.29 131536,-354.29 131760,-354.29 131760,-406.29"/>
<text text-anchor="middle" x="131648" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="131648" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="131648" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="131648" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert2 -->
<g id="edge804" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132779.82,-502.85C132538.66,-498.37 132121.02,-480.97 131769,-417.06 131757.38,-414.95 131745.29,-412.14 131733.44,-409.03"/>
<polygon fill="black" stroke="black" points="131734.13,-405.59 131723.56,-406.34 131732.29,-412.34 131734.13,-405.59"/>
</g>
<!-- dp1_pp1_layer6_expert3 -->
<g id="node495" class="node">
<title>dp1_pp1_layer6_expert3</title>
<polygon fill="lightgreen" stroke="black" points="132002,-406.29 131778,-406.29 131778,-354.29 132002,-354.29 132002,-406.29"/>
<text text-anchor="middle" x="131890" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="131890" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="131890" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="131890" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert3 -->
<g id="edge805" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132774.36,-497.41C132577.31,-488.25 132271.63,-466.79 132011,-417.06 131999.57,-414.88 131987.67,-412.06 131975.99,-408.97"/>
<polygon fill="black" stroke="black" points="131976.82,-405.57 131966.25,-406.31 131974.98,-412.32 131976.82,-405.57"/>
</g>
<!-- dp1_pp1_layer6_expert4 -->
<g id="node496" class="node">
<title>dp1_pp1_layer6_expert4</title>
<polygon fill="lightgreen" stroke="black" points="132244,-406.29 132020,-406.29 132020,-354.29 132244,-354.29 132244,-406.29"/>
<text text-anchor="middle" x="132132" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="132132" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="132132" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="132132" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert4 -->
<g id="edge806" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132765.43,-487.98C132619.99,-474.71 132423.64,-452.25 132253,-417.06 132242.05,-414.8 132230.65,-412.02 132219.43,-409.02"/>
<polygon fill="black" stroke="black" points="132220.19,-405.6 132209.62,-406.33 132218.34,-412.35 132220.19,-405.6"/>
</g>
<!-- dp1_pp1_layer6_expert5 -->
<g id="node497" class="node">
<title>dp1_pp1_layer6_expert5</title>
<polygon fill="lightgreen" stroke="black" points="132486,-406.29 132262,-406.29 132262,-354.29 132486,-354.29 132486,-406.29"/>
<text text-anchor="middle" x="132374" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="132374" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="132374" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="132374" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert5 -->
<g id="edge807" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132745.29,-467.38C132665.5,-453.44 132576,-436.25 132495,-417.06 132484.9,-414.67 132474.4,-411.94 132463.99,-409.07"/>
<polygon fill="black" stroke="black" points="132464.62,-405.62 132454.05,-406.3 132462.74,-412.36 132464.62,-405.62"/>
</g>
<!-- dp1_pp1_layer6_expert6 -->
<g id="node498" class="node">
<title>dp1_pp1_layer6_expert6</title>
<polygon fill="lightgreen" stroke="black" points="132728,-406.29 132504,-406.29 132504,-354.29 132728,-354.29 132728,-406.29"/>
<text text-anchor="middle" x="132616" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="132616" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="132616" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="132616" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert6 -->
<g id="edge808" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132827.94,-452.97C132784.16,-438.16 132737.94,-422.53 132699.87,-409.66"/>
<polygon fill="black" stroke="black" points="132700.97,-406.33 132690.38,-406.45 132698.73,-412.97 132700.97,-406.33"/>
</g>
<!-- dp1_pp1_layer6_expert7 -->
<g id="node499" class="node">
<title>dp1_pp1_layer6_expert7</title>
<polygon fill="lightgreen" stroke="black" points="132970,-406.29 132746,-406.29 132746,-354.29 132970,-354.29 132970,-406.29"/>
<text text-anchor="middle" x="132858" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="132858" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="132858" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="132858" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert7 -->
<g id="edge809" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M132928.38,-452.71C132915.3,-439.43 132901.58,-425.51 132889.76,-413.52"/>
<polygon fill="black" stroke="black" points="132892.19,-411 132882.68,-406.33 132887.2,-415.91 132892.19,-411"/>
</g>
<!-- dp1_pp1_layer6_expert8 -->
<g id="node500" class="node">
<title>dp1_pp1_layer6_expert8</title>
<polygon fill="lightgreen" stroke="black" points="133212,-406.29 132988,-406.29 132988,-354.29 133212,-354.29 133212,-406.29"/>
<text text-anchor="middle" x="133100" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="133100" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="133100" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="133100" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert8 -->
<g id="edge810" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133029.61,-452.71C133042.7,-439.43 133056.42,-425.51 133068.23,-413.52"/>
<polygon fill="black" stroke="black" points="133070.79,-415.91 133075.32,-406.33 133065.81,-411 133070.79,-415.91"/>
</g>
<!-- dp1_pp1_layer6_expert9 -->
<g id="node501" class="node">
<title>dp1_pp1_layer6_expert9</title>
<polygon fill="lightgreen" stroke="black" points="133454,-406.29 133230,-406.29 133230,-354.29 133454,-354.29 133454,-406.29"/>
<text text-anchor="middle" x="133342" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="133342" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="133342" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="133342" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert9 -->
<g id="edge811" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133126.38,-454.21C133171.29,-439.03 133219.08,-422.86 133258.23,-409.62"/>
<polygon fill="black" stroke="black" points="133259.64,-412.84 133267.99,-406.32 133257.4,-406.21 133259.64,-412.84"/>
</g>
<!-- dp1_pp1_layer6_expert10 -->
<g id="node502" class="node">
<title>dp1_pp1_layer6_expert10</title>
<polygon fill="lightgreen" stroke="black" points="133696,-406.29 133472,-406.29 133472,-354.29 133696,-354.29 133696,-406.29"/>
<text text-anchor="middle" x="133584" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="133584" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="133584" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="133584" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert10 -->
<g id="edge812" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133149.89,-478.04C133242.98,-462.69 133359.88,-441.49 133463,-417.06 133473.09,-414.67 133483.6,-411.94 133494.01,-409.07"/>
<polygon fill="black" stroke="black" points="133495.26,-412.36 133503.95,-406.3 133493.37,-405.62 133495.26,-412.36"/>
</g>
<!-- dp1_pp1_layer6_expert11 -->
<g id="node503" class="node">
<title>dp1_pp1_layer6_expert11</title>
<polygon fill="lightgreen" stroke="black" points="133938,-406.29 133714,-406.29 133714,-354.29 133938,-354.29 133938,-406.29"/>
<text text-anchor="middle" x="133826" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="133826" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="133826" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="133826" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert11 -->
<g id="edge813" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133161.99,-490.7C133309.62,-477.88 133522.08,-454.78 133705,-417.06 133715.95,-414.8 133727.35,-412.02 133738.57,-409.02"/>
<polygon fill="black" stroke="black" points="133739.66,-412.35 133748.38,-406.33 133737.81,-405.6 133739.66,-412.35"/>
</g>
<!-- dp1_pp1_layer6_expert12 -->
<g id="node504" class="node">
<title>dp1_pp1_layer6_expert12</title>
<polygon fill="lightgreen" stroke="black" points="134180,-406.29 133956,-406.29 133956,-354.29 134180,-354.29 134180,-406.29"/>
<text text-anchor="middle" x="134068" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="134068" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="134068" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="134068" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert12 -->
<g id="edge814" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133169.27,-498.07C133365.59,-489.29 133679.95,-468.01 133947,-417.06 133958.43,-414.88 133970.33,-412.06 133982.01,-408.97"/>
<polygon fill="black" stroke="black" points="133983.02,-412.32 133991.75,-406.31 133981.18,-405.57 133983.02,-412.32"/>
</g>
<!-- dp1_pp1_layer6_expert13 -->
<g id="node505" class="node">
<title>dp1_pp1_layer6_expert13</title>
<polygon fill="lightgreen" stroke="black" points="134422,-406.29 134198,-406.29 134198,-354.29 134422,-354.29 134422,-406.29"/>
<text text-anchor="middle" x="134310" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="134310" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="134310" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="134310" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert13 -->
<g id="edge815" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133173.93,-502.93C133414.42,-498.58 133834.9,-481.35 134189,-417.06 134200.62,-414.95 134212.71,-412.14 134224.56,-409.03"/>
<polygon fill="black" stroke="black" points="134225.7,-412.34 134234.44,-406.34 134223.87,-405.59 134225.7,-412.34"/>
</g>
<!-- dp1_pp1_layer6_expert14 -->
<g id="node506" class="node">
<title>dp1_pp1_layer6_expert14</title>
<polygon fill="lightgreen" stroke="black" points="134664,-406.29 134440,-406.29 134440,-354.29 134664,-354.29 134664,-406.29"/>
<text text-anchor="middle" x="134552" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="134552" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="134552" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="134552" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert14 -->
<g id="edge816" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133169.32,-498.04C133506.17,-486.48 134194.15,-458.6 134431,-417.06 134442.92,-414.97 134455.32,-412.12 134467.46,-408.93"/>
<polygon fill="black" stroke="black" points="134468.38,-412.3 134477.11,-406.3 134466.54,-405.55 134468.38,-412.3"/>
</g>
<!-- dp1_pp1_layer6_expert15 -->
<g id="node507" class="node">
<title>dp1_pp1_layer6_expert15</title>
<polygon fill="lightgreen" stroke="black" points="134906,-406.29 134682,-406.29 134682,-354.29 134906,-354.29 134906,-406.29"/>
<text text-anchor="middle" x="134794" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="134794" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="134794" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="134794" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert15 -->
<g id="edge817" class="edge">
<title>dp1_pp1_layer6_router&#45;&gt;dp1_pp1_layer6_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M133170.94,-499.9C133551.49,-490.72 134389.35,-465.57 134673,-417.06 134685.01,-415.01 134697.51,-412.16 134709.73,-408.95"/>
<polygon fill="black" stroke="black" points="134710.72,-412.31 134719.45,-406.32 134708.88,-405.56 134710.72,-412.31"/>
</g>
<!-- dp1_pp1_layer6_expert_agg -->
<g id="node508" class="node">
<title>dp1_pp1_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="133226.57,-307.52 132832.74,-307.52 132731.43,-203.52 133125.26,-203.52 133226.57,-307.52"/>
<text text-anchor="middle" x="132979" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="132979" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="132979" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="132979" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer6_expert0&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge818" class="edge">
<title>dp1_pp1_layer6_expert0&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M131222.07,-354.29C131241.69,-346.92 131263.97,-339.72 131285,-335.52 131564.13,-279.86 132387.93,-263.21 132774.43,-258.4"/>
<polygon fill="black" stroke="black" points="132774.65,-261.9 132784.61,-258.27 132774.57,-254.9 132774.65,-261.9"/>
</g>
<!-- dp1_pp1_layer6_expert1&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge819" class="edge">
<title>dp1_pp1_layer6_expert1&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M131464.39,-354.27C131483.95,-346.95 131506.09,-339.78 131527,-335.52 131759.8,-288.16 132435.09,-267.74 132776.43,-260.24"/>
<polygon fill="black" stroke="black" points="132776.51,-263.74 132786.43,-260.03 132776.35,-256.74 132776.51,-263.74"/>
</g>
<!-- dp1_pp1_layer6_expert2&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge820" class="edge">
<title>dp1_pp1_layer6_expert2&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M131706.73,-354.29C131726.21,-347.01 131748.23,-339.87 131769,-335.52 131955.91,-296.44 132485.54,-273.07 132778.3,-262.78"/>
<polygon fill="black" stroke="black" points="132778.74,-266.27 132788.61,-262.42 132778.5,-259.27 132778.74,-266.27"/>
</g>
<!-- dp1_pp1_layer6_expert3&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge821" class="edge">
<title>dp1_pp1_layer6_expert3&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M131949.39,-354.26C131968.72,-347.07 131990.48,-339.99 132011,-335.52 132269.91,-279.18 132575.7,-262.24 132773.26,-257.56"/>
<polygon fill="black" stroke="black" points="132773.55,-261.06 132783.47,-257.33 132773.39,-254.06 132773.55,-261.06"/>
</g>
<!-- dp1_pp1_layer6_expert4&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge822" class="edge">
<title>dp1_pp1_layer6_expert4&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M132192.39,-354.24C132211.49,-347.2 132232.87,-340.19 132253,-335.52 132428.82,-294.77 132633.6,-274.91 132780.75,-265.31"/>
<polygon fill="black" stroke="black" points="132781.05,-268.8 132790.81,-264.67 132780.6,-261.82 132781.05,-268.8"/>
</g>
<!-- dp1_pp1_layer6_expert5&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge823" class="edge">
<title>dp1_pp1_layer6_expert5&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M132436.42,-354.22C132455.04,-347.42 132475.65,-340.55 132495,-335.52 132592.09,-310.27 132702.34,-291.53 132793.07,-278.65"/>
<polygon fill="black" stroke="black" points="132793.78,-282.09 132803.19,-277.23 132792.8,-275.16 132793.78,-282.09"/>
</g>
<!-- dp1_pp1_layer6_expert6&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge824" class="edge">
<title>dp1_pp1_layer6_expert6&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M132684.02,-354.26C132701.26,-348.03 132719.78,-341.44 132737,-335.52 132763.73,-326.33 132792.21,-316.8 132819.89,-307.67"/>
<polygon fill="black" stroke="black" points="132821.24,-310.91 132829.65,-304.46 132819.06,-304.26 132821.24,-310.91"/>
</g>
<!-- dp1_pp1_layer6_expert7&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge825" class="edge">
<title>dp1_pp1_layer6_expert7&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M132882.78,-354.15C132894.02,-342.74 132907.83,-328.73 132921.45,-314.92"/>
<polygon fill="black" stroke="black" points="132924,-317.31 132928.53,-307.73 132919.02,-312.39 132924,-317.31"/>
</g>
<!-- dp1_pp1_layer6_expert8&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge826" class="edge">
<title>dp1_pp1_layer6_expert8&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M133075.22,-354.15C133063.97,-342.74 133050.16,-328.73 133036.55,-314.92"/>
<polygon fill="black" stroke="black" points="133038.98,-312.39 133029.47,-307.73 133033.99,-317.31 133038.98,-312.39"/>
</g>
<!-- dp1_pp1_layer6_expert9&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge827" class="edge">
<title>dp1_pp1_layer6_expert9&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M133273.98,-354.26C133256.73,-348.03 133238.21,-341.44 133221,-335.52 133197.29,-327.37 133172.21,-318.95 133147.53,-310.78"/>
<polygon fill="black" stroke="black" points="133148.32,-307.36 133137.73,-307.54 133146.12,-314 133148.32,-307.36"/>
</g>
<!-- dp1_pp1_layer6_expert10&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge828" class="edge">
<title>dp1_pp1_layer6_expert10&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M133521.58,-354.22C133502.96,-347.42 133482.35,-340.55 133463,-335.52 133382.99,-314.71 133294.05,-298.33 133214.46,-286"/>
<polygon fill="black" stroke="black" points="133214.71,-282.5 133204.3,-284.44 133213.65,-289.41 133214.71,-282.5"/>
</g>
<!-- dp1_pp1_layer6_expert11&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge829" class="edge">
<title>dp1_pp1_layer6_expert11&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M133765.61,-354.24C133746.51,-347.2 133725.13,-340.19 133705,-335.52 133536.74,-296.53 133341.97,-276.66 133196.55,-266.61"/>
<polygon fill="black" stroke="black" points="133196.38,-263.09 133186.16,-265.9 133195.9,-270.07 133196.38,-263.09"/>
</g>
<!-- dp1_pp1_layer6_expert12&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge830" class="edge">
<title>dp1_pp1_layer6_expert12&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M134008.61,-354.26C133989.28,-347.07 133967.52,-339.99 133947,-335.52 133689.51,-279.49 133385.64,-262.43 133187.99,-257.64"/>
<polygon fill="black" stroke="black" points="133187.86,-254.14 133177.78,-257.4 133187.69,-261.13 133187.86,-254.14"/>
</g>
<!-- dp1_pp1_layer6_expert13&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge831" class="edge">
<title>dp1_pp1_layer6_expert13&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M134251.27,-354.29C134231.79,-347.01 134209.77,-339.87 134189,-335.52 134005.02,-297.05 133488.97,-273.81 133193.63,-263.27"/>
<polygon fill="black" stroke="black" points="133193.33,-259.76 133183.21,-262.9 133193.08,-266.76 133193.33,-259.76"/>
</g>
<!-- dp1_pp1_layer6_expert14&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge832" class="edge">
<title>dp1_pp1_layer6_expert14&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M134493.6,-354.27C134474.05,-346.95 134451.9,-339.78 134431,-335.52 134200.27,-288.58 133534.86,-268.1 133190.74,-260.45"/>
<polygon fill="black" stroke="black" points="133190.73,-256.94 133180.65,-260.22 133190.57,-263.94 133190.73,-256.94"/>
</g>
<!-- dp1_pp1_layer6_expert15&#45;&gt;dp1_pp1_layer6_expert_agg -->
<g id="edge833" class="edge">
<title>dp1_pp1_layer6_expert15&#45;&gt;dp1_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M134735.93,-354.29C134716.3,-346.92 134694.03,-339.72 134673,-335.52 134395.21,-280.12 133577.98,-263.37 133189.17,-258.47"/>
<polygon fill="black" stroke="black" points="133188.97,-254.97 133178.93,-258.34 133188.88,-261.97 133188.97,-254.97"/>
</g>
<!-- dp1_pp1_layer7_attn_tp0 -->
<g id="node509" class="node">
<title>dp1_pp1_layer7_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="130461.5,-531.06 130196.5,-531.06 130196.5,-479.06 130461.5,-479.06 130461.5,-531.06"/>
<text text-anchor="middle" x="130329" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="130329" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="130329" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="130329" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer6_expert_agg&#45;&gt;dp1_pp1_layer7_attn_tp0 -->
<g id="edge835" class="edge">
<title>dp1_pp1_layer6_expert_agg&#45;&gt;dp1_pp1_layer7_attn_tp0</title>
<path fill="none" stroke="black" d="M132786.78,-260.41C132366.38,-269.54 131376.17,-294.77 131043,-335.52 131010.8,-339.46 130502.23,-444.29 130471,-453.06 130448.37,-459.41 130424.16,-467.58 130402.26,-475.5"/>
<polygon fill="black" stroke="black" points="130400.89,-472.28 130392.7,-479 130403.29,-478.85 130400.89,-472.28"/>
</g>
<!-- dp1_pp1_layer7_attn_allreduce -->
<g id="node510" class="node">
<title>dp1_pp1_layer7_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="130458" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="130458" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="130458" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="130458" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="130458" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_attn_tp0&#45;&gt;dp1_pp1_layer7_attn_allreduce -->
<g id="edge836" class="edge">
<title>dp1_pp1_layer7_attn_tp0&#45;&gt;dp1_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M130355.41,-478.92C130372.15,-463 130394.21,-442 130413.58,-423.56"/>
<polygon fill="black" stroke="black" points="130416.03,-426.07 130420.86,-416.64 130411.2,-421 130416.03,-426.07"/>
</g>
<!-- dp1_pp1_layer7_router -->
<g id="node514" class="node">
<title>dp1_pp1_layer7_router</title>
<polygon fill="lightyellow" stroke="black" points="128209.57,-557.06 127815.74,-557.06 127714.43,-453.06 128108.26,-453.06 128209.57,-557.06"/>
<text text-anchor="middle" x="127962" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="127962" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="127962" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="127962" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_attn_allreduce&#45;&gt;dp1_pp1_layer7_router -->
<g id="edge872" class="edge">
<title>dp1_pp1_layer7_attn_allreduce&#45;&gt;dp1_pp1_layer7_router</title>
<path fill="none" stroke="black" d="M130298.08,-392.38C130186.77,-399.9 130034.89,-409.76 129901,-417.06 129265.5,-451.72 128512.28,-482.59 128160.96,-496.4"/>
<polygon fill="black" stroke="black" points="128160.8,-492.91 128150.94,-496.79 128161.07,-499.9 128160.8,-492.91"/>
</g>
<!-- dp1_pp1_layer7_attn_tp1 -->
<g id="node511" class="node">
<title>dp1_pp1_layer7_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="130744.5,-531.06 130479.5,-531.06 130479.5,-479.06 130744.5,-479.06 130744.5,-531.06"/>
<text text-anchor="middle" x="130612" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="130612" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="130612" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="130612" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer7_attn_tp1&#45;&gt;dp1_pp1_layer7_attn_allreduce -->
<g id="edge837" class="edge">
<title>dp1_pp1_layer7_attn_tp1&#45;&gt;dp1_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M130580.46,-478.92C130559.99,-462.6 130532.83,-440.94 130509.29,-422.18"/>
<polygon fill="black" stroke="black" points="130511.46,-419.44 130501.46,-415.94 130507.1,-424.91 130511.46,-419.44"/>
</g>
<!-- dp1_pp1_layer7_attn_tp2 -->
<g id="node512" class="node">
<title>dp1_pp1_layer7_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="130178.5,-531.06 129913.5,-531.06 129913.5,-479.06 130178.5,-479.06 130178.5,-531.06"/>
<text text-anchor="middle" x="130046" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="130046" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="130046" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="130046" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer7_attn_tp2&#45;&gt;dp1_pp1_layer7_attn_allreduce -->
<g id="edge838" class="edge">
<title>dp1_pp1_layer7_attn_tp2&#45;&gt;dp1_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M130112.07,-479.02C130135.85,-470.35 130162.99,-460.86 130188,-453.06 130236.74,-437.86 130291.05,-423.03 130338.1,-410.83"/>
<polygon fill="black" stroke="black" points="130339.22,-414.15 130348.03,-408.26 130337.47,-407.38 130339.22,-414.15"/>
</g>
<!-- dp1_pp1_layer7_attn_tp3 -->
<g id="node513" class="node">
<title>dp1_pp1_layer7_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="131027.5,-531.06 130762.5,-531.06 130762.5,-479.06 131027.5,-479.06 131027.5,-531.06"/>
<text text-anchor="middle" x="130895" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="130895" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="130895" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="130895" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer7_attn_tp3&#45;&gt;dp1_pp1_layer7_attn_allreduce -->
<g id="edge839" class="edge">
<title>dp1_pp1_layer7_attn_tp3&#45;&gt;dp1_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M130830.21,-478.95C130806.43,-470.18 130779.17,-460.64 130754,-453.06 130699.42,-436.63 130638.31,-421.31 130585.86,-409.08"/>
<polygon fill="black" stroke="black" points="130586.37,-405.6 130575.83,-406.75 130584.78,-412.42 130586.37,-405.6"/>
</g>
<!-- dp1_pp1_layer7_expert0 -->
<g id="node515" class="node">
<title>dp1_pp1_layer7_expert0</title>
<polygon fill="lightgreen" stroke="black" points="126259,-406.29 126035,-406.29 126035,-354.29 126259,-354.29 126259,-406.29"/>
<text text-anchor="middle" x="126147" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="126147" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="126147" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="126147" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert0 -->
<g id="edge840" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127759.73,-499.65C127374.55,-490.26 126549.11,-465.13 126268,-417.06 126255.99,-415.01 126243.48,-412.16 126231.27,-408.95"/>
<polygon fill="black" stroke="black" points="126232.11,-405.56 126221.54,-406.32 126230.28,-412.31 126232.11,-405.56"/>
</g>
<!-- dp1_pp1_layer7_expert1 -->
<g id="node516" class="node">
<title>dp1_pp1_layer7_expert1</title>
<polygon fill="lightgreen" stroke="black" points="126501,-406.29 126277,-406.29 126277,-354.29 126501,-354.29 126501,-406.29"/>
<text text-anchor="middle" x="126389" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="126389" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="126389" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="126389" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert1 -->
<g id="edge841" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127757.55,-497.55C127415.94,-485.71 126743.58,-458.03 126510,-417.06 126498.08,-414.97 126485.67,-412.12 126473.54,-408.93"/>
<polygon fill="black" stroke="black" points="126474.45,-405.55 126463.89,-406.3 126472.62,-412.3 126474.45,-405.55"/>
</g>
<!-- dp1_pp1_layer7_expert2 -->
<g id="node517" class="node">
<title>dp1_pp1_layer7_expert2</title>
<polygon fill="lightgreen" stroke="black" points="126743,-406.29 126519,-406.29 126519,-354.29 126743,-354.29 126743,-406.29"/>
<text text-anchor="middle" x="126631" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="126631" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="126631" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="126631" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert2 -->
<g id="edge842" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127762.82,-502.85C127521.66,-498.37 127104.02,-480.97 126752,-417.06 126740.38,-414.95 126728.29,-412.14 126716.44,-409.03"/>
<polygon fill="black" stroke="black" points="126717.13,-405.59 126706.56,-406.34 126715.29,-412.34 126717.13,-405.59"/>
</g>
<!-- dp1_pp1_layer7_expert3 -->
<g id="node518" class="node">
<title>dp1_pp1_layer7_expert3</title>
<polygon fill="lightgreen" stroke="black" points="126985,-406.29 126761,-406.29 126761,-354.29 126985,-354.29 126985,-406.29"/>
<text text-anchor="middle" x="126873" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="126873" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="126873" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="126873" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert3 -->
<g id="edge843" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127757.36,-497.41C127560.31,-488.25 127254.63,-466.79 126994,-417.06 126982.57,-414.88 126970.67,-412.06 126958.99,-408.97"/>
<polygon fill="black" stroke="black" points="126959.82,-405.57 126949.25,-406.31 126957.98,-412.32 126959.82,-405.57"/>
</g>
<!-- dp1_pp1_layer7_expert4 -->
<g id="node519" class="node">
<title>dp1_pp1_layer7_expert4</title>
<polygon fill="lightgreen" stroke="black" points="127227,-406.29 127003,-406.29 127003,-354.29 127227,-354.29 127227,-406.29"/>
<text text-anchor="middle" x="127115" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="127115" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="127115" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="127115" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert4 -->
<g id="edge844" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127748.43,-487.98C127602.99,-474.71 127406.64,-452.25 127236,-417.06 127225.05,-414.8 127213.65,-412.02 127202.43,-409.02"/>
<polygon fill="black" stroke="black" points="127203.19,-405.6 127192.62,-406.33 127201.34,-412.35 127203.19,-405.6"/>
</g>
<!-- dp1_pp1_layer7_expert5 -->
<g id="node520" class="node">
<title>dp1_pp1_layer7_expert5</title>
<polygon fill="lightgreen" stroke="black" points="127469,-406.29 127245,-406.29 127245,-354.29 127469,-354.29 127469,-406.29"/>
<text text-anchor="middle" x="127357" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="127357" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="127357" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="127357" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert5 -->
<g id="edge845" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127728.29,-467.38C127648.5,-453.44 127559,-436.25 127478,-417.06 127467.9,-414.67 127457.4,-411.94 127446.99,-409.07"/>
<polygon fill="black" stroke="black" points="127447.62,-405.62 127437.05,-406.3 127445.74,-412.36 127447.62,-405.62"/>
</g>
<!-- dp1_pp1_layer7_expert6 -->
<g id="node521" class="node">
<title>dp1_pp1_layer7_expert6</title>
<polygon fill="lightgreen" stroke="black" points="127711,-406.29 127487,-406.29 127487,-354.29 127711,-354.29 127711,-406.29"/>
<text text-anchor="middle" x="127599" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="127599" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="127599" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="127599" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert6 -->
<g id="edge846" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127810.94,-452.97C127767.16,-438.16 127720.94,-422.53 127682.87,-409.66"/>
<polygon fill="black" stroke="black" points="127683.97,-406.33 127673.38,-406.45 127681.73,-412.97 127683.97,-406.33"/>
</g>
<!-- dp1_pp1_layer7_expert7 -->
<g id="node522" class="node">
<title>dp1_pp1_layer7_expert7</title>
<polygon fill="lightgreen" stroke="black" points="127953,-406.29 127729,-406.29 127729,-354.29 127953,-354.29 127953,-406.29"/>
<text text-anchor="middle" x="127841" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="127841" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="127841" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="127841" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert7 -->
<g id="edge847" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M127911.38,-452.71C127898.3,-439.43 127884.58,-425.51 127872.76,-413.52"/>
<polygon fill="black" stroke="black" points="127875.19,-411 127865.68,-406.33 127870.2,-415.91 127875.19,-411"/>
</g>
<!-- dp1_pp1_layer7_expert8 -->
<g id="node523" class="node">
<title>dp1_pp1_layer7_expert8</title>
<polygon fill="lightgreen" stroke="black" points="128195,-406.29 127971,-406.29 127971,-354.29 128195,-354.29 128195,-406.29"/>
<text text-anchor="middle" x="128083" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="128083" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="128083" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="128083" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert8 -->
<g id="edge848" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128012.61,-452.71C128025.7,-439.43 128039.42,-425.51 128051.23,-413.52"/>
<polygon fill="black" stroke="black" points="128053.79,-415.91 128058.32,-406.33 128048.81,-411 128053.79,-415.91"/>
</g>
<!-- dp1_pp1_layer7_expert9 -->
<g id="node524" class="node">
<title>dp1_pp1_layer7_expert9</title>
<polygon fill="lightgreen" stroke="black" points="128437,-406.29 128213,-406.29 128213,-354.29 128437,-354.29 128437,-406.29"/>
<text text-anchor="middle" x="128325" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="128325" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="128325" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="128325" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert9 -->
<g id="edge849" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128109.38,-454.21C128154.29,-439.03 128202.08,-422.86 128241.23,-409.62"/>
<polygon fill="black" stroke="black" points="128242.64,-412.84 128250.99,-406.32 128240.4,-406.21 128242.64,-412.84"/>
</g>
<!-- dp1_pp1_layer7_expert10 -->
<g id="node525" class="node">
<title>dp1_pp1_layer7_expert10</title>
<polygon fill="lightgreen" stroke="black" points="128679,-406.29 128455,-406.29 128455,-354.29 128679,-354.29 128679,-406.29"/>
<text text-anchor="middle" x="128567" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="128567" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="128567" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="128567" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert10 -->
<g id="edge850" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128132.89,-478.04C128225.98,-462.69 128342.88,-441.49 128446,-417.06 128456.09,-414.67 128466.6,-411.94 128477.01,-409.07"/>
<polygon fill="black" stroke="black" points="128478.26,-412.36 128486.95,-406.3 128476.37,-405.62 128478.26,-412.36"/>
</g>
<!-- dp1_pp1_layer7_expert11 -->
<g id="node526" class="node">
<title>dp1_pp1_layer7_expert11</title>
<polygon fill="lightgreen" stroke="black" points="128921,-406.29 128697,-406.29 128697,-354.29 128921,-354.29 128921,-406.29"/>
<text text-anchor="middle" x="128809" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="128809" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="128809" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="128809" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert11 -->
<g id="edge851" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128144.99,-490.7C128292.62,-477.88 128505.08,-454.78 128688,-417.06 128698.95,-414.8 128710.35,-412.02 128721.57,-409.02"/>
<polygon fill="black" stroke="black" points="128722.66,-412.35 128731.38,-406.33 128720.81,-405.6 128722.66,-412.35"/>
</g>
<!-- dp1_pp1_layer7_expert12 -->
<g id="node527" class="node">
<title>dp1_pp1_layer7_expert12</title>
<polygon fill="lightgreen" stroke="black" points="129163,-406.29 128939,-406.29 128939,-354.29 129163,-354.29 129163,-406.29"/>
<text text-anchor="middle" x="129051" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="129051" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="129051" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="129051" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert12 -->
<g id="edge852" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128152.27,-498.07C128348.59,-489.29 128662.95,-468.01 128930,-417.06 128941.43,-414.88 128953.33,-412.06 128965.01,-408.97"/>
<polygon fill="black" stroke="black" points="128966.02,-412.32 128974.75,-406.31 128964.18,-405.57 128966.02,-412.32"/>
</g>
<!-- dp1_pp1_layer7_expert13 -->
<g id="node528" class="node">
<title>dp1_pp1_layer7_expert13</title>
<polygon fill="lightgreen" stroke="black" points="129405,-406.29 129181,-406.29 129181,-354.29 129405,-354.29 129405,-406.29"/>
<text text-anchor="middle" x="129293" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="129293" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="129293" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="129293" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert13 -->
<g id="edge853" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128156.93,-502.93C128397.42,-498.58 128817.9,-481.35 129172,-417.06 129183.62,-414.95 129195.71,-412.14 129207.56,-409.03"/>
<polygon fill="black" stroke="black" points="129208.7,-412.34 129217.44,-406.34 129206.87,-405.59 129208.7,-412.34"/>
</g>
<!-- dp1_pp1_layer7_expert14 -->
<g id="node529" class="node">
<title>dp1_pp1_layer7_expert14</title>
<polygon fill="lightgreen" stroke="black" points="129647,-406.29 129423,-406.29 129423,-354.29 129647,-354.29 129647,-406.29"/>
<text text-anchor="middle" x="129535" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="129535" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="129535" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="129535" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert14 -->
<g id="edge854" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128152.32,-498.04C128489.17,-486.48 129177.15,-458.6 129414,-417.06 129425.92,-414.97 129438.32,-412.12 129450.46,-408.93"/>
<polygon fill="black" stroke="black" points="129451.38,-412.3 129460.11,-406.3 129449.54,-405.55 129451.38,-412.3"/>
</g>
<!-- dp1_pp1_layer7_expert15 -->
<g id="node530" class="node">
<title>dp1_pp1_layer7_expert15</title>
<polygon fill="lightgreen" stroke="black" points="129889,-406.29 129665,-406.29 129665,-354.29 129889,-354.29 129889,-406.29"/>
<text text-anchor="middle" x="129777" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="129777" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="129777" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="129777" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert15 -->
<g id="edge855" class="edge">
<title>dp1_pp1_layer7_router&#45;&gt;dp1_pp1_layer7_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M128153.94,-499.9C128534.49,-490.72 129372.35,-465.57 129656,-417.06 129668.01,-415.01 129680.51,-412.16 129692.73,-408.95"/>
<polygon fill="black" stroke="black" points="129693.72,-412.31 129702.45,-406.32 129691.88,-405.56 129693.72,-412.31"/>
</g>
<!-- dp1_pp1_layer7_expert_agg -->
<g id="node531" class="node">
<title>dp1_pp1_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="128209.57,-307.52 127815.74,-307.52 127714.43,-203.52 128108.26,-203.52 128209.57,-307.52"/>
<text text-anchor="middle" x="127962" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="127962" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="127962" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="127962" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer7_expert0&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge856" class="edge">
<title>dp1_pp1_layer7_expert0&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M126205.07,-354.29C126224.69,-346.92 126246.97,-339.72 126268,-335.52 126547.13,-279.86 127370.93,-263.21 127757.43,-258.4"/>
<polygon fill="black" stroke="black" points="127757.65,-261.9 127767.61,-258.27 127757.57,-254.9 127757.65,-261.9"/>
</g>
<!-- dp1_pp1_layer7_expert1&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge857" class="edge">
<title>dp1_pp1_layer7_expert1&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M126447.39,-354.27C126466.95,-346.95 126489.09,-339.78 126510,-335.52 126742.8,-288.16 127418.09,-267.74 127759.43,-260.24"/>
<polygon fill="black" stroke="black" points="127759.51,-263.74 127769.43,-260.03 127759.35,-256.74 127759.51,-263.74"/>
</g>
<!-- dp1_pp1_layer7_expert2&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge858" class="edge">
<title>dp1_pp1_layer7_expert2&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M126689.73,-354.29C126709.21,-347.01 126731.23,-339.87 126752,-335.52 126938.91,-296.44 127468.54,-273.07 127761.3,-262.78"/>
<polygon fill="black" stroke="black" points="127761.74,-266.27 127771.61,-262.42 127761.5,-259.27 127761.74,-266.27"/>
</g>
<!-- dp1_pp1_layer7_expert3&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge859" class="edge">
<title>dp1_pp1_layer7_expert3&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M126932.39,-354.26C126951.72,-347.07 126973.48,-339.99 126994,-335.52 127252.91,-279.18 127558.7,-262.24 127756.26,-257.56"/>
<polygon fill="black" stroke="black" points="127756.55,-261.06 127766.47,-257.33 127756.39,-254.06 127756.55,-261.06"/>
</g>
<!-- dp1_pp1_layer7_expert4&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge860" class="edge">
<title>dp1_pp1_layer7_expert4&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M127175.39,-354.24C127194.49,-347.2 127215.87,-340.19 127236,-335.52 127411.82,-294.77 127616.6,-274.91 127763.75,-265.31"/>
<polygon fill="black" stroke="black" points="127764.05,-268.8 127773.81,-264.67 127763.6,-261.82 127764.05,-268.8"/>
</g>
<!-- dp1_pp1_layer7_expert5&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge861" class="edge">
<title>dp1_pp1_layer7_expert5&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M127419.42,-354.22C127438.04,-347.42 127458.65,-340.55 127478,-335.52 127575.09,-310.27 127685.34,-291.53 127776.07,-278.65"/>
<polygon fill="black" stroke="black" points="127776.78,-282.09 127786.19,-277.23 127775.8,-275.16 127776.78,-282.09"/>
</g>
<!-- dp1_pp1_layer7_expert6&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge862" class="edge">
<title>dp1_pp1_layer7_expert6&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M127667.02,-354.26C127684.26,-348.03 127702.78,-341.44 127720,-335.52 127746.73,-326.33 127775.21,-316.8 127802.89,-307.67"/>
<polygon fill="black" stroke="black" points="127804.24,-310.91 127812.65,-304.46 127802.06,-304.26 127804.24,-310.91"/>
</g>
<!-- dp1_pp1_layer7_expert7&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge863" class="edge">
<title>dp1_pp1_layer7_expert7&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M127865.78,-354.15C127877.02,-342.74 127890.83,-328.73 127904.45,-314.92"/>
<polygon fill="black" stroke="black" points="127907,-317.31 127911.53,-307.73 127902.02,-312.39 127907,-317.31"/>
</g>
<!-- dp1_pp1_layer7_expert8&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge864" class="edge">
<title>dp1_pp1_layer7_expert8&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M128058.22,-354.15C128046.97,-342.74 128033.16,-328.73 128019.55,-314.92"/>
<polygon fill="black" stroke="black" points="128021.98,-312.39 128012.47,-307.73 128016.99,-317.31 128021.98,-312.39"/>
</g>
<!-- dp1_pp1_layer7_expert9&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge865" class="edge">
<title>dp1_pp1_layer7_expert9&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M128256.98,-354.26C128239.73,-348.03 128221.21,-341.44 128204,-335.52 128180.29,-327.37 128155.21,-318.95 128130.53,-310.78"/>
<polygon fill="black" stroke="black" points="128131.32,-307.36 128120.73,-307.54 128129.12,-314 128131.32,-307.36"/>
</g>
<!-- dp1_pp1_layer7_expert10&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge866" class="edge">
<title>dp1_pp1_layer7_expert10&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M128504.58,-354.22C128485.96,-347.42 128465.35,-340.55 128446,-335.52 128365.99,-314.71 128277.05,-298.33 128197.46,-286"/>
<polygon fill="black" stroke="black" points="128197.71,-282.5 128187.3,-284.44 128196.65,-289.41 128197.71,-282.5"/>
</g>
<!-- dp1_pp1_layer7_expert11&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge867" class="edge">
<title>dp1_pp1_layer7_expert11&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M128748.61,-354.24C128729.51,-347.2 128708.13,-340.19 128688,-335.52 128519.74,-296.53 128324.97,-276.66 128179.55,-266.61"/>
<polygon fill="black" stroke="black" points="128179.38,-263.09 128169.16,-265.9 128178.9,-270.07 128179.38,-263.09"/>
</g>
<!-- dp1_pp1_layer7_expert12&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge868" class="edge">
<title>dp1_pp1_layer7_expert12&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M128991.61,-354.26C128972.28,-347.07 128950.52,-339.99 128930,-335.52 128672.51,-279.49 128368.64,-262.43 128170.99,-257.64"/>
<polygon fill="black" stroke="black" points="128170.86,-254.14 128160.78,-257.4 128170.69,-261.13 128170.86,-254.14"/>
</g>
<!-- dp1_pp1_layer7_expert13&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge869" class="edge">
<title>dp1_pp1_layer7_expert13&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M129234.27,-354.29C129214.79,-347.01 129192.77,-339.87 129172,-335.52 128988.02,-297.05 128471.97,-273.81 128176.63,-263.27"/>
<polygon fill="black" stroke="black" points="128176.33,-259.76 128166.21,-262.9 128176.08,-266.76 128176.33,-259.76"/>
</g>
<!-- dp1_pp1_layer7_expert14&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge870" class="edge">
<title>dp1_pp1_layer7_expert14&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M129476.6,-354.27C129457.05,-346.95 129434.9,-339.78 129414,-335.52 129183.27,-288.58 128517.86,-268.1 128173.74,-260.45"/>
<polygon fill="black" stroke="black" points="128173.73,-256.94 128163.65,-260.22 128173.57,-263.94 128173.73,-256.94"/>
</g>
<!-- dp1_pp1_layer7_expert15&#45;&gt;dp1_pp1_layer7_expert_agg -->
<g id="edge871" class="edge">
<title>dp1_pp1_layer7_expert15&#45;&gt;dp1_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M129718.93,-354.29C129699.3,-346.92 129677.03,-339.72 129656,-335.52 129378.21,-280.12 128560.98,-263.37 128172.17,-258.47"/>
<polygon fill="black" stroke="black" points="128171.97,-254.97 128161.93,-258.34 128171.88,-261.97 128171.97,-254.97"/>
</g>
<!-- dp1_pp1_layer8_attn_tp0 -->
<g id="node532" class="node">
<title>dp1_pp1_layer8_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="125444.5,-531.06 125179.5,-531.06 125179.5,-479.06 125444.5,-479.06 125444.5,-531.06"/>
<text text-anchor="middle" x="125312" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="125312" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="125312" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="125312" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer7_expert_agg&#45;&gt;dp1_pp1_layer8_attn_tp0 -->
<g id="edge873" class="edge">
<title>dp1_pp1_layer7_expert_agg&#45;&gt;dp1_pp1_layer8_attn_tp0</title>
<path fill="none" stroke="black" d="M127769.78,-260.41C127349.38,-269.54 126359.17,-294.77 126026,-335.52 125993.8,-339.46 125485.23,-444.29 125454,-453.06 125431.37,-459.41 125407.16,-467.58 125385.26,-475.5"/>
<polygon fill="black" stroke="black" points="125383.89,-472.28 125375.7,-479 125386.29,-478.85 125383.89,-472.28"/>
</g>
<!-- dp1_pp1_layer8_attn_allreduce -->
<g id="node533" class="node">
<title>dp1_pp1_layer8_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="125441" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="125441" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="125441" y="-383.29" font-family="Arial" font-size="10.00">GPUs 32&#45;35</text>
<text text-anchor="middle" x="125441" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="125441" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_attn_tp0&#45;&gt;dp1_pp1_layer8_attn_allreduce -->
<g id="edge874" class="edge">
<title>dp1_pp1_layer8_attn_tp0&#45;&gt;dp1_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M125338.41,-478.92C125355.15,-463 125377.21,-442 125396.58,-423.56"/>
<polygon fill="black" stroke="black" points="125399.03,-426.07 125403.86,-416.64 125394.2,-421 125399.03,-426.07"/>
</g>
<!-- dp1_pp1_layer8_router -->
<g id="node537" class="node">
<title>dp1_pp1_layer8_router</title>
<polygon fill="lightyellow" stroke="black" points="123192.57,-557.06 122798.74,-557.06 122697.43,-453.06 123091.26,-453.06 123192.57,-557.06"/>
<text text-anchor="middle" x="122945" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="122945" y="-508.06" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="122945" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="122945" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_attn_allreduce&#45;&gt;dp1_pp1_layer8_router -->
<g id="edge910" class="edge">
<title>dp1_pp1_layer8_attn_allreduce&#45;&gt;dp1_pp1_layer8_router</title>
<path fill="none" stroke="black" d="M125281.08,-392.38C125169.77,-399.9 125017.89,-409.76 124884,-417.06 124248.5,-451.72 123495.28,-482.59 123143.96,-496.4"/>
<polygon fill="black" stroke="black" points="123143.8,-492.91 123133.94,-496.79 123144.07,-499.9 123143.8,-492.91"/>
</g>
<!-- dp1_pp1_layer8_attn_tp1 -->
<g id="node534" class="node">
<title>dp1_pp1_layer8_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="125727.5,-531.06 125462.5,-531.06 125462.5,-479.06 125727.5,-479.06 125727.5,-531.06"/>
<text text-anchor="middle" x="125595" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="125595" y="-508.06" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="125595" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="125595" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer8_attn_tp1&#45;&gt;dp1_pp1_layer8_attn_allreduce -->
<g id="edge875" class="edge">
<title>dp1_pp1_layer8_attn_tp1&#45;&gt;dp1_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M125563.46,-478.92C125542.99,-462.6 125515.83,-440.94 125492.29,-422.18"/>
<polygon fill="black" stroke="black" points="125494.46,-419.44 125484.46,-415.94 125490.1,-424.91 125494.46,-419.44"/>
</g>
<!-- dp1_pp1_layer8_attn_tp2 -->
<g id="node535" class="node">
<title>dp1_pp1_layer8_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="125161.5,-531.06 124896.5,-531.06 124896.5,-479.06 125161.5,-479.06 125161.5,-531.06"/>
<text text-anchor="middle" x="125029" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="125029" y="-508.06" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="125029" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="125029" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer8_attn_tp2&#45;&gt;dp1_pp1_layer8_attn_allreduce -->
<g id="edge876" class="edge">
<title>dp1_pp1_layer8_attn_tp2&#45;&gt;dp1_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M125095.07,-479.02C125118.85,-470.35 125145.99,-460.86 125171,-453.06 125219.74,-437.86 125274.05,-423.03 125321.1,-410.83"/>
<polygon fill="black" stroke="black" points="125322.22,-414.15 125331.03,-408.26 125320.47,-407.38 125322.22,-414.15"/>
</g>
<!-- dp1_pp1_layer8_attn_tp3 -->
<g id="node536" class="node">
<title>dp1_pp1_layer8_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="126010.5,-531.06 125745.5,-531.06 125745.5,-479.06 126010.5,-479.06 126010.5,-531.06"/>
<text text-anchor="middle" x="125878" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="125878" y="-508.06" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="125878" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="125878" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp1_layer8_attn_tp3&#45;&gt;dp1_pp1_layer8_attn_allreduce -->
<g id="edge877" class="edge">
<title>dp1_pp1_layer8_attn_tp3&#45;&gt;dp1_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M125813.21,-478.95C125789.43,-470.18 125762.17,-460.64 125737,-453.06 125682.42,-436.63 125621.31,-421.31 125568.86,-409.08"/>
<polygon fill="black" stroke="black" points="125569.37,-405.6 125558.83,-406.75 125567.78,-412.42 125569.37,-405.6"/>
</g>
<!-- dp1_pp1_layer8_expert0 -->
<g id="node538" class="node">
<title>dp1_pp1_layer8_expert0</title>
<polygon fill="lightgreen" stroke="black" points="121242,-406.29 121018,-406.29 121018,-354.29 121242,-354.29 121242,-406.29"/>
<text text-anchor="middle" x="121130" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="121130" y="-383.29" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="121130" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="121130" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert0 -->
<g id="edge878" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122742.73,-499.65C122357.55,-490.26 121532.11,-465.13 121251,-417.06 121238.99,-415.01 121226.48,-412.16 121214.27,-408.95"/>
<polygon fill="black" stroke="black" points="121215.11,-405.56 121204.54,-406.32 121213.28,-412.31 121215.11,-405.56"/>
</g>
<!-- dp1_pp1_layer8_expert1 -->
<g id="node539" class="node">
<title>dp1_pp1_layer8_expert1</title>
<polygon fill="lightgreen" stroke="black" points="121484,-406.29 121260,-406.29 121260,-354.29 121484,-354.29 121484,-406.29"/>
<text text-anchor="middle" x="121372" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="121372" y="-383.29" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="121372" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="121372" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert1 -->
<g id="edge879" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122740.55,-497.55C122398.94,-485.71 121726.58,-458.03 121493,-417.06 121481.08,-414.97 121468.67,-412.12 121456.54,-408.93"/>
<polygon fill="black" stroke="black" points="121457.45,-405.55 121446.89,-406.3 121455.62,-412.3 121457.45,-405.55"/>
</g>
<!-- dp1_pp1_layer8_expert2 -->
<g id="node540" class="node">
<title>dp1_pp1_layer8_expert2</title>
<polygon fill="lightgreen" stroke="black" points="121726,-406.29 121502,-406.29 121502,-354.29 121726,-354.29 121726,-406.29"/>
<text text-anchor="middle" x="121614" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="121614" y="-383.29" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="121614" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="121614" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert2 -->
<g id="edge880" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122745.82,-502.85C122504.66,-498.37 122087.02,-480.97 121735,-417.06 121723.38,-414.95 121711.29,-412.14 121699.44,-409.03"/>
<polygon fill="black" stroke="black" points="121700.13,-405.59 121689.56,-406.34 121698.29,-412.34 121700.13,-405.59"/>
</g>
<!-- dp1_pp1_layer8_expert3 -->
<g id="node541" class="node">
<title>dp1_pp1_layer8_expert3</title>
<polygon fill="lightgreen" stroke="black" points="121968,-406.29 121744,-406.29 121744,-354.29 121968,-354.29 121968,-406.29"/>
<text text-anchor="middle" x="121856" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="121856" y="-383.29" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="121856" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="121856" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert3 -->
<g id="edge881" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122740.36,-497.41C122543.31,-488.25 122237.63,-466.79 121977,-417.06 121965.57,-414.88 121953.67,-412.06 121941.99,-408.97"/>
<polygon fill="black" stroke="black" points="121942.82,-405.57 121932.25,-406.31 121940.98,-412.32 121942.82,-405.57"/>
</g>
<!-- dp1_pp1_layer8_expert4 -->
<g id="node542" class="node">
<title>dp1_pp1_layer8_expert4</title>
<polygon fill="lightgreen" stroke="black" points="122210,-406.29 121986,-406.29 121986,-354.29 122210,-354.29 122210,-406.29"/>
<text text-anchor="middle" x="122098" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="122098" y="-383.29" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="122098" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="122098" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert4 -->
<g id="edge882" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122731.43,-487.98C122585.99,-474.71 122389.64,-452.25 122219,-417.06 122208.05,-414.8 122196.65,-412.02 122185.43,-409.02"/>
<polygon fill="black" stroke="black" points="122186.19,-405.6 122175.62,-406.33 122184.34,-412.35 122186.19,-405.6"/>
</g>
<!-- dp1_pp1_layer8_expert5 -->
<g id="node543" class="node">
<title>dp1_pp1_layer8_expert5</title>
<polygon fill="lightgreen" stroke="black" points="122452,-406.29 122228,-406.29 122228,-354.29 122452,-354.29 122452,-406.29"/>
<text text-anchor="middle" x="122340" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="122340" y="-383.29" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="122340" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="122340" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert5 -->
<g id="edge883" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122711.29,-467.38C122631.5,-453.44 122542,-436.25 122461,-417.06 122450.9,-414.67 122440.4,-411.94 122429.99,-409.07"/>
<polygon fill="black" stroke="black" points="122430.62,-405.62 122420.05,-406.3 122428.74,-412.36 122430.62,-405.62"/>
</g>
<!-- dp1_pp1_layer8_expert6 -->
<g id="node544" class="node">
<title>dp1_pp1_layer8_expert6</title>
<polygon fill="lightgreen" stroke="black" points="122694,-406.29 122470,-406.29 122470,-354.29 122694,-354.29 122694,-406.29"/>
<text text-anchor="middle" x="122582" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="122582" y="-383.29" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="122582" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="122582" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert6 -->
<g id="edge884" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122793.94,-452.97C122750.16,-438.16 122703.94,-422.53 122665.87,-409.66"/>
<polygon fill="black" stroke="black" points="122666.97,-406.33 122656.38,-406.45 122664.73,-412.97 122666.97,-406.33"/>
</g>
<!-- dp1_pp1_layer8_expert7 -->
<g id="node545" class="node">
<title>dp1_pp1_layer8_expert7</title>
<polygon fill="lightgreen" stroke="black" points="122936,-406.29 122712,-406.29 122712,-354.29 122936,-354.29 122936,-406.29"/>
<text text-anchor="middle" x="122824" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="122824" y="-383.29" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="122824" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="122824" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert7 -->
<g id="edge885" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122894.38,-452.71C122881.3,-439.43 122867.58,-425.51 122855.76,-413.52"/>
<polygon fill="black" stroke="black" points="122858.19,-411 122848.68,-406.33 122853.2,-415.91 122858.19,-411"/>
</g>
<!-- dp1_pp1_layer8_expert8 -->
<g id="node546" class="node">
<title>dp1_pp1_layer8_expert8</title>
<polygon fill="lightgreen" stroke="black" points="123178,-406.29 122954,-406.29 122954,-354.29 123178,-354.29 123178,-406.29"/>
<text text-anchor="middle" x="123066" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="123066" y="-383.29" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="123066" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="123066" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert8 -->
<g id="edge886" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122995.61,-452.71C123008.7,-439.43 123022.42,-425.51 123034.23,-413.52"/>
<polygon fill="black" stroke="black" points="123036.79,-415.91 123041.32,-406.33 123031.81,-411 123036.79,-415.91"/>
</g>
<!-- dp1_pp1_layer8_expert9 -->
<g id="node547" class="node">
<title>dp1_pp1_layer8_expert9</title>
<polygon fill="lightgreen" stroke="black" points="123420,-406.29 123196,-406.29 123196,-354.29 123420,-354.29 123420,-406.29"/>
<text text-anchor="middle" x="123308" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="123308" y="-383.29" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="123308" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="123308" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert9 -->
<g id="edge887" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123092.38,-454.21C123137.29,-439.03 123185.08,-422.86 123224.23,-409.62"/>
<polygon fill="black" stroke="black" points="123225.64,-412.84 123233.99,-406.32 123223.4,-406.21 123225.64,-412.84"/>
</g>
<!-- dp1_pp1_layer8_expert10 -->
<g id="node548" class="node">
<title>dp1_pp1_layer8_expert10</title>
<polygon fill="lightgreen" stroke="black" points="123662,-406.29 123438,-406.29 123438,-354.29 123662,-354.29 123662,-406.29"/>
<text text-anchor="middle" x="123550" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="123550" y="-383.29" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="123550" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="123550" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert10 -->
<g id="edge888" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123115.89,-478.04C123208.98,-462.69 123325.88,-441.49 123429,-417.06 123439.09,-414.67 123449.6,-411.94 123460.01,-409.07"/>
<polygon fill="black" stroke="black" points="123461.26,-412.36 123469.95,-406.3 123459.37,-405.62 123461.26,-412.36"/>
</g>
<!-- dp1_pp1_layer8_expert11 -->
<g id="node549" class="node">
<title>dp1_pp1_layer8_expert11</title>
<polygon fill="lightgreen" stroke="black" points="123904,-406.29 123680,-406.29 123680,-354.29 123904,-354.29 123904,-406.29"/>
<text text-anchor="middle" x="123792" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="123792" y="-383.29" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="123792" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="123792" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert11 -->
<g id="edge889" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123127.99,-490.7C123275.62,-477.88 123488.08,-454.78 123671,-417.06 123681.95,-414.8 123693.35,-412.02 123704.57,-409.02"/>
<polygon fill="black" stroke="black" points="123705.66,-412.35 123714.38,-406.33 123703.81,-405.6 123705.66,-412.35"/>
</g>
<!-- dp1_pp1_layer8_expert12 -->
<g id="node550" class="node">
<title>dp1_pp1_layer8_expert12</title>
<polygon fill="lightgreen" stroke="black" points="124146,-406.29 123922,-406.29 123922,-354.29 124146,-354.29 124146,-406.29"/>
<text text-anchor="middle" x="124034" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="124034" y="-383.29" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="124034" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="124034" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert12 -->
<g id="edge890" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123135.27,-498.07C123331.59,-489.29 123645.95,-468.01 123913,-417.06 123924.43,-414.88 123936.33,-412.06 123948.01,-408.97"/>
<polygon fill="black" stroke="black" points="123949.02,-412.32 123957.75,-406.31 123947.18,-405.57 123949.02,-412.32"/>
</g>
<!-- dp1_pp1_layer8_expert13 -->
<g id="node551" class="node">
<title>dp1_pp1_layer8_expert13</title>
<polygon fill="lightgreen" stroke="black" points="124388,-406.29 124164,-406.29 124164,-354.29 124388,-354.29 124388,-406.29"/>
<text text-anchor="middle" x="124276" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="124276" y="-383.29" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="124276" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="124276" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert13 -->
<g id="edge891" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123139.93,-502.93C123380.42,-498.58 123800.9,-481.35 124155,-417.06 124166.62,-414.95 124178.71,-412.14 124190.56,-409.03"/>
<polygon fill="black" stroke="black" points="124191.7,-412.34 124200.44,-406.34 124189.87,-405.59 124191.7,-412.34"/>
</g>
<!-- dp1_pp1_layer8_expert14 -->
<g id="node552" class="node">
<title>dp1_pp1_layer8_expert14</title>
<polygon fill="lightgreen" stroke="black" points="124630,-406.29 124406,-406.29 124406,-354.29 124630,-354.29 124630,-406.29"/>
<text text-anchor="middle" x="124518" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="124518" y="-383.29" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="124518" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="124518" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert14 -->
<g id="edge892" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123135.32,-498.04C123472.17,-486.48 124160.15,-458.6 124397,-417.06 124408.92,-414.97 124421.32,-412.12 124433.46,-408.93"/>
<polygon fill="black" stroke="black" points="124434.38,-412.3 124443.11,-406.3 124432.54,-405.55 124434.38,-412.3"/>
</g>
<!-- dp1_pp1_layer8_expert15 -->
<g id="node553" class="node">
<title>dp1_pp1_layer8_expert15</title>
<polygon fill="lightgreen" stroke="black" points="124872,-406.29 124648,-406.29 124648,-354.29 124872,-354.29 124872,-406.29"/>
<text text-anchor="middle" x="124760" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="124760" y="-383.29" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="124760" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="124760" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert15 -->
<g id="edge893" class="edge">
<title>dp1_pp1_layer8_router&#45;&gt;dp1_pp1_layer8_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M123136.94,-499.9C123517.49,-490.72 124355.35,-465.57 124639,-417.06 124651.01,-415.01 124663.51,-412.16 124675.73,-408.95"/>
<polygon fill="black" stroke="black" points="124676.72,-412.31 124685.45,-406.32 124674.88,-405.56 124676.72,-412.31"/>
</g>
<!-- dp1_pp1_layer8_expert_agg -->
<g id="node554" class="node">
<title>dp1_pp1_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="123313.57,-307.52 122919.74,-307.52 122818.43,-203.52 123212.26,-203.52 123313.57,-307.52"/>
<text text-anchor="middle" x="123066" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="123066" y="-258.52" font-family="Arial" font-size="10.00">GPUs 32&#45;47</text>
<text text-anchor="middle" x="123066" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="123066" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_expert0&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge894" class="edge">
<title>dp1_pp1_layer8_expert0&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M121188.06,-354.25C121207.69,-346.88 121229.96,-339.68 121251,-335.52 121553.52,-275.68 122452.92,-261.16 122860.8,-257.65"/>
<polygon fill="black" stroke="black" points="122860.96,-261.14 122870.93,-257.56 122860.9,-254.15 122860.96,-261.14"/>
</g>
<!-- dp1_pp1_layer8_expert1&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge895" class="edge">
<title>dp1_pp1_layer8_expert1&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M121430.38,-354.21C121449.94,-346.89 121472.08,-339.73 121493,-335.52 121748.86,-284.02 122497.83,-265.4 122862.21,-259.26"/>
<polygon fill="black" stroke="black" points="122862.4,-262.76 122872.34,-259.09 122862.28,-255.76 122862.4,-262.76"/>
</g>
<!-- dp1_pp1_layer8_expert2&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge896" class="edge">
<title>dp1_pp1_layer8_expert2&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M121672.71,-354.21C121692.19,-346.94 121714.21,-339.8 121735,-335.52 121944.71,-292.32 122546.36,-270.3 122864,-261.41"/>
<polygon fill="black" stroke="black" points="122864.34,-264.9 122874.24,-261.13 122864.15,-257.91 122864.34,-264.9"/>
</g>
<!-- dp1_pp1_layer8_expert3&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge897" class="edge">
<title>dp1_pp1_layer8_expert3&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M121915.05,-354.26C121934.46,-347.03 121956.35,-339.92 121977,-335.52 122141.34,-300.54 122600.32,-276.12 122867.04,-264.41"/>
<polygon fill="black" stroke="black" points="122867.4,-267.9 122877.24,-263.97 122867.09,-260.91 122867.4,-267.9"/>
</g>
<!-- dp1_pp1_layer8_expert4&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge898" class="edge">
<title>dp1_pp1_layer8_expert4&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M122157.73,-354.28C122176.98,-347.15 122198.62,-340.08 122219,-335.52 122435.91,-287.01 122690.52,-268.23 122863.54,-261"/>
<polygon fill="black" stroke="black" points="122863.93,-264.48 122873.78,-260.58 122863.64,-257.49 122863.93,-264.48"/>
</g>
<!-- dp1_pp1_layer8_expert5&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge899" class="edge">
<title>dp1_pp1_layer8_expert5&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M122401.07,-354.28C122420.02,-347.32 122441.14,-340.35 122461,-335.52 122596.78,-302.51 122753.27,-282.55 122873.08,-270.95"/>
<polygon fill="black" stroke="black" points="122873.47,-274.42 122883.09,-269.99 122872.8,-267.46 122873.47,-274.42"/>
</g>
<!-- dp1_pp1_layer8_expert6&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge900" class="edge">
<title>dp1_pp1_layer8_expert6&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M122646.16,-354.29C122664.37,-347.69 122684.32,-340.91 122703,-335.52 122763.46,-318.09 122830.57,-302.47 122890.47,-289.81"/>
<polygon fill="black" stroke="black" points="122891.33,-293.21 122900.4,-287.73 122889.9,-286.36 122891.33,-293.21"/>
</g>
<!-- dp1_pp1_layer8_expert7&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge901" class="edge">
<title>dp1_pp1_layer8_expert7&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M122873.55,-354.15C122897.49,-342.01 122927.24,-326.92 122956.13,-312.26"/>
<polygon fill="black" stroke="black" points="122957.73,-315.37 122965.06,-307.73 122954.56,-309.13 122957.73,-315.37"/>
</g>
<!-- dp1_pp1_layer8_expert8&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge902" class="edge">
<title>dp1_pp1_layer8_expert8&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M123066,-354.15C123066,-343.58 123066,-330.77 123066,-317.96"/>
<polygon fill="black" stroke="black" points="123069.5,-317.73 123066,-307.73 123062.5,-317.73 123069.5,-317.73"/>
</g>
<!-- dp1_pp1_layer8_expert9&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge903" class="edge">
<title>dp1_pp1_layer8_expert9&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M123258.44,-354.15C123234.51,-342.01 123204.76,-326.92 123175.87,-312.26"/>
<polygon fill="black" stroke="black" points="123177.44,-309.13 123166.93,-307.73 123174.27,-315.37 123177.44,-309.13"/>
</g>
<!-- dp1_pp1_layer8_expert10&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge904" class="edge">
<title>dp1_pp1_layer8_expert10&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M123485.84,-354.29C123467.63,-347.69 123447.67,-340.91 123429,-335.52 123394.59,-325.6 123358.02,-316.27 123321.86,-307.73"/>
<polygon fill="black" stroke="black" points="123322.21,-304.22 123311.68,-305.35 123320.61,-311.03 123322.21,-304.22"/>
</g>
<!-- dp1_pp1_layer8_expert11&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge905" class="edge">
<title>dp1_pp1_layer8_expert11&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M123730.93,-354.28C123711.98,-347.32 123690.86,-340.35 123671,-335.52 123546.73,-305.31 123405.11,-286.03 123290.15,-274.08"/>
<polygon fill="black" stroke="black" points="123290.47,-270.6 123280.17,-273.05 123289.76,-277.56 123290.47,-270.6"/>
</g>
<!-- dp1_pp1_layer8_expert12&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge906" class="edge">
<title>dp1_pp1_layer8_expert12&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M123974.27,-354.28C123955.02,-347.15 123933.38,-340.08 123913,-335.52 123700.33,-287.95 123451.41,-268.98 123278.7,-261.43"/>
<polygon fill="black" stroke="black" points="123278.61,-257.93 123268.47,-261 123278.31,-264.92 123278.61,-257.93"/>
</g>
<!-- dp1_pp1_layer8_expert13&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge907" class="edge">
<title>dp1_pp1_layer8_expert13&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M124216.94,-354.26C124197.54,-347.03 124175.65,-339.92 124155,-335.52 123994.14,-301.28 123551.03,-277.16 123282.2,-265.18"/>
<polygon fill="black" stroke="black" points="123282.06,-261.67 123271.92,-264.72 123281.75,-268.66 123282.06,-261.67"/>
</g>
<!-- dp1_pp1_layer8_expert14&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge908" class="edge">
<title>dp1_pp1_layer8_expert14&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M124459.28,-354.21C124439.81,-346.94 124417.78,-339.8 124397,-335.52 124189.74,-292.82 123599.66,-270.82 123279.26,-261.73"/>
<polygon fill="black" stroke="black" points="123279.02,-258.22 123268.92,-261.44 123278.82,-265.22 123279.02,-258.22"/>
</g>
<!-- dp1_pp1_layer8_expert15&#45;&gt;dp1_pp1_layer8_expert_agg -->
<g id="edge909" class="edge">
<title>dp1_pp1_layer8_expert15&#45;&gt;dp1_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M124701.61,-354.21C124682.06,-346.89 124659.91,-339.73 124639,-335.52 124384.8,-284.35 123643.86,-265.64 123276.93,-259.38"/>
<polygon fill="black" stroke="black" points="123276.78,-255.88 123266.72,-259.21 123276.66,-262.88 123276.78,-255.88"/>
</g>
<!-- dp1_pp1_to_pp2 -->
<g id="node1476" class="node">
<title>dp1_pp1_to_pp2</title>
<ellipse fill="lightblue" stroke="black" cx="132963" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="132963" y="-144.75" font-family="Arial" font-size="10.00">PP Stage Transition</text>
<text text-anchor="middle" x="132963" y="-133.75" font-family="Arial" font-size="10.00">GPU 47  GPU 48</text>
<text text-anchor="middle" x="132963" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="132963" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp1_layer8_expert_agg&#45;&gt;dp1_pp1_to_pp2 -->
<g id="edge2428" class="edge">
<title>dp1_pp1_layer8_expert_agg&#45;&gt;dp1_pp1_to_pp2</title>
<path fill="none" stroke="black" d="M123256.24,-248.48C123725.89,-233.82 124978.09,-196.37 126023,-179.52 128713.07,-136.15 131990.3,-132.1 132783.82,-131.77"/>
<polygon fill="black" stroke="black" points="132783.9,-135.27 132793.9,-131.76 132783.89,-128.27 132783.9,-135.27"/>
</g>
<!-- dp1_pp2_layer9_attn_tp0 -->
<g id="node555" class="node">
<title>dp1_pp2_layer9_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="120977.5,-531.06 120712.5,-531.06 120712.5,-479.06 120977.5,-479.06 120977.5,-531.06"/>
<text text-anchor="middle" x="120845" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="120845" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="120845" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="120845" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer9_attn_allreduce -->
<g id="node556" class="node">
<title>dp1_pp2_layer9_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="120420" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="120420" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="120420" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="120420" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="120420" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_attn_tp0&#45;&gt;dp1_pp2_layer9_attn_allreduce -->
<g id="edge911" class="edge">
<title>dp1_pp2_layer9_attn_tp0&#45;&gt;dp1_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M120779.82,-478.95C120756.12,-470.23 120729.01,-460.72 120704,-453.06 120652.14,-437.17 120594.21,-422.07 120544.26,-409.85"/>
<polygon fill="black" stroke="black" points="120544.92,-406.41 120534.38,-407.45 120543.27,-413.21 120544.92,-406.41"/>
</g>
<!-- dp1_pp2_layer9_router -->
<g id="node560" class="node">
<title>dp1_pp2_layer9_router</title>
<polygon fill="lightyellow" stroke="black" points="118159.57,-557.06 117765.74,-557.06 117664.43,-453.06 118058.26,-453.06 118159.57,-557.06"/>
<text text-anchor="middle" x="117912" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="117912" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="117912" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="117912" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_attn_allreduce&#45;&gt;dp1_pp2_layer9_router -->
<g id="edge947" class="edge">
<title>dp1_pp2_layer9_attn_allreduce&#45;&gt;dp1_pp2_layer9_router</title>
<path fill="none" stroke="black" d="M120259.7,-392.14C120145.73,-399.66 119989,-409.63 119851,-417.06 119215.48,-451.29 118462.27,-482.37 118110.96,-496.31"/>
<polygon fill="black" stroke="black" points="118110.79,-492.82 118100.94,-496.71 118111.07,-499.81 118110.79,-492.82"/>
</g>
<!-- dp1_pp2_layer9_attn_tp1 -->
<g id="node557" class="node">
<title>dp1_pp2_layer9_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="120128.5,-531.06 119863.5,-531.06 119863.5,-479.06 120128.5,-479.06 120128.5,-531.06"/>
<text text-anchor="middle" x="119996" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="119996" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="119996" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="119996" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer9_attn_tp1&#45;&gt;dp1_pp2_layer9_attn_allreduce -->
<g id="edge912" class="edge">
<title>dp1_pp2_layer9_attn_tp1&#45;&gt;dp1_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M120061.66,-479C120085.53,-470.28 120112.83,-460.77 120138,-453.06 120189.51,-437.29 120247.04,-422.21 120296.64,-409.97"/>
<polygon fill="black" stroke="black" points="120297.57,-413.35 120306.45,-407.57 120295.9,-406.55 120297.57,-413.35"/>
</g>
<!-- dp1_pp2_layer9_attn_tp2 -->
<g id="node558" class="node">
<title>dp1_pp2_layer9_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="120694.5,-531.06 120429.5,-531.06 120429.5,-479.06 120694.5,-479.06 120694.5,-531.06"/>
<text text-anchor="middle" x="120562" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="120562" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="120562" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="120562" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer9_attn_tp2&#45;&gt;dp1_pp2_layer9_attn_allreduce -->
<g id="edge913" class="edge">
<title>dp1_pp2_layer9_attn_tp2&#45;&gt;dp1_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M120532.92,-478.92C120514.28,-462.8 120489.62,-441.49 120468.11,-422.89"/>
<polygon fill="black" stroke="black" points="120470.2,-420.06 120460.34,-416.17 120465.62,-425.36 120470.2,-420.06"/>
</g>
<!-- dp1_pp2_layer9_attn_tp3 -->
<g id="node559" class="node">
<title>dp1_pp2_layer9_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="120411.5,-531.06 120146.5,-531.06 120146.5,-479.06 120411.5,-479.06 120411.5,-531.06"/>
<text text-anchor="middle" x="120279" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="120279" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="120279" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="120279" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer9_attn_tp3&#45;&gt;dp1_pp2_layer9_attn_allreduce -->
<g id="edge914" class="edge">
<title>dp1_pp2_layer9_attn_tp3&#45;&gt;dp1_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M120307.87,-478.92C120326.39,-462.8 120350.87,-441.49 120372.23,-422.89"/>
<polygon fill="black" stroke="black" points="120374.7,-425.38 120379.94,-416.17 120370.1,-420.1 120374.7,-425.38"/>
</g>
<!-- dp1_pp2_layer9_expert0 -->
<g id="node561" class="node">
<title>dp1_pp2_layer9_expert0</title>
<polygon fill="lightgreen" stroke="black" points="116209,-406.29 115985,-406.29 115985,-354.29 116209,-354.29 116209,-406.29"/>
<text text-anchor="middle" x="116097" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="116097" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="116097" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="116097" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert0 -->
<g id="edge915" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117709.73,-499.65C117324.55,-490.26 116499.11,-465.13 116218,-417.06 116205.99,-415.01 116193.48,-412.16 116181.27,-408.95"/>
<polygon fill="black" stroke="black" points="116182.11,-405.56 116171.54,-406.32 116180.28,-412.31 116182.11,-405.56"/>
</g>
<!-- dp1_pp2_layer9_expert1 -->
<g id="node562" class="node">
<title>dp1_pp2_layer9_expert1</title>
<polygon fill="lightgreen" stroke="black" points="116451,-406.29 116227,-406.29 116227,-354.29 116451,-354.29 116451,-406.29"/>
<text text-anchor="middle" x="116339" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="116339" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="116339" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="116339" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert1 -->
<g id="edge916" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117707.55,-497.55C117365.94,-485.71 116693.58,-458.03 116460,-417.06 116448.08,-414.97 116435.67,-412.12 116423.54,-408.93"/>
<polygon fill="black" stroke="black" points="116424.45,-405.55 116413.89,-406.3 116422.62,-412.3 116424.45,-405.55"/>
</g>
<!-- dp1_pp2_layer9_expert2 -->
<g id="node563" class="node">
<title>dp1_pp2_layer9_expert2</title>
<polygon fill="lightgreen" stroke="black" points="116693,-406.29 116469,-406.29 116469,-354.29 116693,-354.29 116693,-406.29"/>
<text text-anchor="middle" x="116581" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="116581" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="116581" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="116581" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert2 -->
<g id="edge917" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117712.82,-502.85C117471.66,-498.37 117054.02,-480.97 116702,-417.06 116690.38,-414.95 116678.29,-412.14 116666.44,-409.03"/>
<polygon fill="black" stroke="black" points="116667.13,-405.59 116656.56,-406.34 116665.29,-412.34 116667.13,-405.59"/>
</g>
<!-- dp1_pp2_layer9_expert3 -->
<g id="node564" class="node">
<title>dp1_pp2_layer9_expert3</title>
<polygon fill="lightgreen" stroke="black" points="116935,-406.29 116711,-406.29 116711,-354.29 116935,-354.29 116935,-406.29"/>
<text text-anchor="middle" x="116823" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="116823" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="116823" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="116823" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert3 -->
<g id="edge918" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117707.36,-497.41C117510.31,-488.25 117204.63,-466.79 116944,-417.06 116932.57,-414.88 116920.67,-412.06 116908.99,-408.97"/>
<polygon fill="black" stroke="black" points="116909.82,-405.57 116899.25,-406.31 116907.98,-412.32 116909.82,-405.57"/>
</g>
<!-- dp1_pp2_layer9_expert4 -->
<g id="node565" class="node">
<title>dp1_pp2_layer9_expert4</title>
<polygon fill="lightgreen" stroke="black" points="117177,-406.29 116953,-406.29 116953,-354.29 117177,-354.29 117177,-406.29"/>
<text text-anchor="middle" x="117065" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="117065" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="117065" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="117065" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert4 -->
<g id="edge919" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117698.43,-487.98C117552.99,-474.71 117356.64,-452.25 117186,-417.06 117175.05,-414.8 117163.65,-412.02 117152.43,-409.02"/>
<polygon fill="black" stroke="black" points="117153.19,-405.6 117142.62,-406.33 117151.34,-412.35 117153.19,-405.6"/>
</g>
<!-- dp1_pp2_layer9_expert5 -->
<g id="node566" class="node">
<title>dp1_pp2_layer9_expert5</title>
<polygon fill="lightgreen" stroke="black" points="117419,-406.29 117195,-406.29 117195,-354.29 117419,-354.29 117419,-406.29"/>
<text text-anchor="middle" x="117307" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="117307" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="117307" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="117307" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert5 -->
<g id="edge920" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117678.29,-467.38C117598.5,-453.44 117509,-436.25 117428,-417.06 117417.9,-414.67 117407.4,-411.94 117396.99,-409.07"/>
<polygon fill="black" stroke="black" points="117397.62,-405.62 117387.05,-406.3 117395.74,-412.36 117397.62,-405.62"/>
</g>
<!-- dp1_pp2_layer9_expert6 -->
<g id="node567" class="node">
<title>dp1_pp2_layer9_expert6</title>
<polygon fill="lightgreen" stroke="black" points="117661,-406.29 117437,-406.29 117437,-354.29 117661,-354.29 117661,-406.29"/>
<text text-anchor="middle" x="117549" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="117549" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="117549" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="117549" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert6 -->
<g id="edge921" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117760.94,-452.97C117717.16,-438.16 117670.94,-422.53 117632.87,-409.66"/>
<polygon fill="black" stroke="black" points="117633.97,-406.33 117623.38,-406.45 117631.73,-412.97 117633.97,-406.33"/>
</g>
<!-- dp1_pp2_layer9_expert7 -->
<g id="node568" class="node">
<title>dp1_pp2_layer9_expert7</title>
<polygon fill="lightgreen" stroke="black" points="117903,-406.29 117679,-406.29 117679,-354.29 117903,-354.29 117903,-406.29"/>
<text text-anchor="middle" x="117791" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="117791" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="117791" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="117791" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert7 -->
<g id="edge922" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117861.38,-452.71C117848.3,-439.43 117834.58,-425.51 117822.76,-413.52"/>
<polygon fill="black" stroke="black" points="117825.19,-411 117815.68,-406.33 117820.2,-415.91 117825.19,-411"/>
</g>
<!-- dp1_pp2_layer9_expert8 -->
<g id="node569" class="node">
<title>dp1_pp2_layer9_expert8</title>
<polygon fill="lightgreen" stroke="black" points="118145,-406.29 117921,-406.29 117921,-354.29 118145,-354.29 118145,-406.29"/>
<text text-anchor="middle" x="118033" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="118033" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="118033" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="118033" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert8 -->
<g id="edge923" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M117962.61,-452.71C117975.7,-439.43 117989.42,-425.51 118001.23,-413.52"/>
<polygon fill="black" stroke="black" points="118003.79,-415.91 118008.32,-406.33 117998.81,-411 118003.79,-415.91"/>
</g>
<!-- dp1_pp2_layer9_expert9 -->
<g id="node570" class="node">
<title>dp1_pp2_layer9_expert9</title>
<polygon fill="lightgreen" stroke="black" points="118387,-406.29 118163,-406.29 118163,-354.29 118387,-354.29 118387,-406.29"/>
<text text-anchor="middle" x="118275" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="118275" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="118275" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="118275" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert9 -->
<g id="edge924" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118059.38,-454.21C118104.29,-439.03 118152.08,-422.86 118191.23,-409.62"/>
<polygon fill="black" stroke="black" points="118192.64,-412.84 118200.99,-406.32 118190.4,-406.21 118192.64,-412.84"/>
</g>
<!-- dp1_pp2_layer9_expert10 -->
<g id="node571" class="node">
<title>dp1_pp2_layer9_expert10</title>
<polygon fill="lightgreen" stroke="black" points="118629,-406.29 118405,-406.29 118405,-354.29 118629,-354.29 118629,-406.29"/>
<text text-anchor="middle" x="118517" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="118517" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="118517" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="118517" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert10 -->
<g id="edge925" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118082.89,-478.04C118175.98,-462.69 118292.88,-441.49 118396,-417.06 118406.09,-414.67 118416.6,-411.94 118427.01,-409.07"/>
<polygon fill="black" stroke="black" points="118428.26,-412.36 118436.95,-406.3 118426.37,-405.62 118428.26,-412.36"/>
</g>
<!-- dp1_pp2_layer9_expert11 -->
<g id="node572" class="node">
<title>dp1_pp2_layer9_expert11</title>
<polygon fill="lightgreen" stroke="black" points="118871,-406.29 118647,-406.29 118647,-354.29 118871,-354.29 118871,-406.29"/>
<text text-anchor="middle" x="118759" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="118759" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="118759" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="118759" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert11 -->
<g id="edge926" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118094.99,-490.7C118242.62,-477.88 118455.08,-454.78 118638,-417.06 118648.95,-414.8 118660.35,-412.02 118671.57,-409.02"/>
<polygon fill="black" stroke="black" points="118672.66,-412.35 118681.38,-406.33 118670.81,-405.6 118672.66,-412.35"/>
</g>
<!-- dp1_pp2_layer9_expert12 -->
<g id="node573" class="node">
<title>dp1_pp2_layer9_expert12</title>
<polygon fill="lightgreen" stroke="black" points="119113,-406.29 118889,-406.29 118889,-354.29 119113,-354.29 119113,-406.29"/>
<text text-anchor="middle" x="119001" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="119001" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="119001" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="119001" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert12 -->
<g id="edge927" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118102.27,-498.07C118298.59,-489.29 118612.95,-468.01 118880,-417.06 118891.43,-414.88 118903.33,-412.06 118915.01,-408.97"/>
<polygon fill="black" stroke="black" points="118916.02,-412.32 118924.75,-406.31 118914.18,-405.57 118916.02,-412.32"/>
</g>
<!-- dp1_pp2_layer9_expert13 -->
<g id="node574" class="node">
<title>dp1_pp2_layer9_expert13</title>
<polygon fill="lightgreen" stroke="black" points="119355,-406.29 119131,-406.29 119131,-354.29 119355,-354.29 119355,-406.29"/>
<text text-anchor="middle" x="119243" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="119243" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="119243" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="119243" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert13 -->
<g id="edge928" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118106.93,-502.93C118347.42,-498.58 118767.9,-481.35 119122,-417.06 119133.62,-414.95 119145.71,-412.14 119157.56,-409.03"/>
<polygon fill="black" stroke="black" points="119158.7,-412.34 119167.44,-406.34 119156.87,-405.59 119158.7,-412.34"/>
</g>
<!-- dp1_pp2_layer9_expert14 -->
<g id="node575" class="node">
<title>dp1_pp2_layer9_expert14</title>
<polygon fill="lightgreen" stroke="black" points="119597,-406.29 119373,-406.29 119373,-354.29 119597,-354.29 119597,-406.29"/>
<text text-anchor="middle" x="119485" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="119485" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="119485" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="119485" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert14 -->
<g id="edge929" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118102.32,-498.04C118439.17,-486.48 119127.15,-458.6 119364,-417.06 119375.92,-414.97 119388.32,-412.12 119400.46,-408.93"/>
<polygon fill="black" stroke="black" points="119401.38,-412.3 119410.11,-406.3 119399.54,-405.55 119401.38,-412.3"/>
</g>
<!-- dp1_pp2_layer9_expert15 -->
<g id="node576" class="node">
<title>dp1_pp2_layer9_expert15</title>
<polygon fill="lightgreen" stroke="black" points="119839,-406.29 119615,-406.29 119615,-354.29 119839,-354.29 119839,-406.29"/>
<text text-anchor="middle" x="119727" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="119727" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="119727" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="119727" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert15 -->
<g id="edge930" class="edge">
<title>dp1_pp2_layer9_router&#45;&gt;dp1_pp2_layer9_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M118103.94,-499.9C118484.49,-490.72 119322.35,-465.57 119606,-417.06 119618.01,-415.01 119630.51,-412.16 119642.73,-408.95"/>
<polygon fill="black" stroke="black" points="119643.72,-412.31 119652.45,-406.32 119641.88,-405.56 119643.72,-412.31"/>
</g>
<!-- dp1_pp2_layer9_expert_agg -->
<g id="node577" class="node">
<title>dp1_pp2_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="118159.57,-307.52 117765.74,-307.52 117664.43,-203.52 118058.26,-203.52 118159.57,-307.52"/>
<text text-anchor="middle" x="117912" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="117912" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="117912" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="117912" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer9_expert0&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge931" class="edge">
<title>dp1_pp2_layer9_expert0&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M116155.07,-354.29C116174.69,-346.92 116196.97,-339.72 116218,-335.52 116497.13,-279.86 117320.93,-263.21 117707.43,-258.4"/>
<polygon fill="black" stroke="black" points="117707.65,-261.9 117717.61,-258.27 117707.57,-254.9 117707.65,-261.9"/>
</g>
<!-- dp1_pp2_layer9_expert1&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge932" class="edge">
<title>dp1_pp2_layer9_expert1&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M116397.39,-354.27C116416.95,-346.95 116439.09,-339.78 116460,-335.52 116692.8,-288.16 117368.09,-267.74 117709.43,-260.24"/>
<polygon fill="black" stroke="black" points="117709.51,-263.74 117719.43,-260.03 117709.35,-256.74 117709.51,-263.74"/>
</g>
<!-- dp1_pp2_layer9_expert2&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge933" class="edge">
<title>dp1_pp2_layer9_expert2&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M116639.73,-354.29C116659.21,-347.01 116681.23,-339.87 116702,-335.52 116888.91,-296.44 117418.54,-273.07 117711.3,-262.78"/>
<polygon fill="black" stroke="black" points="117711.74,-266.27 117721.61,-262.42 117711.5,-259.27 117711.74,-266.27"/>
</g>
<!-- dp1_pp2_layer9_expert3&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge934" class="edge">
<title>dp1_pp2_layer9_expert3&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M116882.39,-354.26C116901.72,-347.07 116923.48,-339.99 116944,-335.52 117202.91,-279.18 117508.7,-262.24 117706.26,-257.56"/>
<polygon fill="black" stroke="black" points="117706.55,-261.06 117716.47,-257.33 117706.39,-254.06 117706.55,-261.06"/>
</g>
<!-- dp1_pp2_layer9_expert4&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge935" class="edge">
<title>dp1_pp2_layer9_expert4&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M117125.39,-354.24C117144.49,-347.2 117165.87,-340.19 117186,-335.52 117361.82,-294.77 117566.6,-274.91 117713.75,-265.31"/>
<polygon fill="black" stroke="black" points="117714.05,-268.8 117723.81,-264.67 117713.6,-261.82 117714.05,-268.8"/>
</g>
<!-- dp1_pp2_layer9_expert5&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge936" class="edge">
<title>dp1_pp2_layer9_expert5&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M117369.42,-354.22C117388.04,-347.42 117408.65,-340.55 117428,-335.52 117525.09,-310.27 117635.34,-291.53 117726.07,-278.65"/>
<polygon fill="black" stroke="black" points="117726.78,-282.09 117736.19,-277.23 117725.8,-275.16 117726.78,-282.09"/>
</g>
<!-- dp1_pp2_layer9_expert6&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge937" class="edge">
<title>dp1_pp2_layer9_expert6&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M117617.02,-354.26C117634.26,-348.03 117652.78,-341.44 117670,-335.52 117696.73,-326.33 117725.21,-316.8 117752.89,-307.67"/>
<polygon fill="black" stroke="black" points="117754.24,-310.91 117762.65,-304.46 117752.06,-304.26 117754.24,-310.91"/>
</g>
<!-- dp1_pp2_layer9_expert7&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge938" class="edge">
<title>dp1_pp2_layer9_expert7&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M117815.78,-354.15C117827.02,-342.74 117840.83,-328.73 117854.45,-314.92"/>
<polygon fill="black" stroke="black" points="117857,-317.31 117861.53,-307.73 117852.02,-312.39 117857,-317.31"/>
</g>
<!-- dp1_pp2_layer9_expert8&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge939" class="edge">
<title>dp1_pp2_layer9_expert8&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M118008.22,-354.15C117996.97,-342.74 117983.16,-328.73 117969.55,-314.92"/>
<polygon fill="black" stroke="black" points="117971.98,-312.39 117962.47,-307.73 117966.99,-317.31 117971.98,-312.39"/>
</g>
<!-- dp1_pp2_layer9_expert9&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge940" class="edge">
<title>dp1_pp2_layer9_expert9&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M118206.98,-354.26C118189.73,-348.03 118171.21,-341.44 118154,-335.52 118130.29,-327.37 118105.21,-318.95 118080.53,-310.78"/>
<polygon fill="black" stroke="black" points="118081.32,-307.36 118070.73,-307.54 118079.12,-314 118081.32,-307.36"/>
</g>
<!-- dp1_pp2_layer9_expert10&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge941" class="edge">
<title>dp1_pp2_layer9_expert10&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M118454.58,-354.22C118435.96,-347.42 118415.35,-340.55 118396,-335.52 118315.99,-314.71 118227.05,-298.33 118147.46,-286"/>
<polygon fill="black" stroke="black" points="118147.71,-282.5 118137.3,-284.44 118146.65,-289.41 118147.71,-282.5"/>
</g>
<!-- dp1_pp2_layer9_expert11&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge942" class="edge">
<title>dp1_pp2_layer9_expert11&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M118698.61,-354.24C118679.51,-347.2 118658.13,-340.19 118638,-335.52 118469.74,-296.53 118274.97,-276.66 118129.55,-266.61"/>
<polygon fill="black" stroke="black" points="118129.38,-263.09 118119.16,-265.9 118128.9,-270.07 118129.38,-263.09"/>
</g>
<!-- dp1_pp2_layer9_expert12&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge943" class="edge">
<title>dp1_pp2_layer9_expert12&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M118941.61,-354.26C118922.28,-347.07 118900.52,-339.99 118880,-335.52 118622.51,-279.49 118318.64,-262.43 118120.99,-257.64"/>
<polygon fill="black" stroke="black" points="118120.86,-254.14 118110.78,-257.4 118120.69,-261.13 118120.86,-254.14"/>
</g>
<!-- dp1_pp2_layer9_expert13&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge944" class="edge">
<title>dp1_pp2_layer9_expert13&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M119184.27,-354.29C119164.79,-347.01 119142.77,-339.87 119122,-335.52 118938.02,-297.05 118421.97,-273.81 118126.63,-263.27"/>
<polygon fill="black" stroke="black" points="118126.33,-259.76 118116.21,-262.9 118126.08,-266.76 118126.33,-259.76"/>
</g>
<!-- dp1_pp2_layer9_expert14&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge945" class="edge">
<title>dp1_pp2_layer9_expert14&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M119426.6,-354.27C119407.05,-346.95 119384.9,-339.78 119364,-335.52 119133.27,-288.58 118467.86,-268.1 118123.74,-260.45"/>
<polygon fill="black" stroke="black" points="118123.73,-256.94 118113.65,-260.22 118123.57,-263.94 118123.73,-256.94"/>
</g>
<!-- dp1_pp2_layer9_expert15&#45;&gt;dp1_pp2_layer9_expert_agg -->
<g id="edge946" class="edge">
<title>dp1_pp2_layer9_expert15&#45;&gt;dp1_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M119668.93,-354.29C119649.3,-346.92 119627.03,-339.72 119606,-335.52 119328.21,-280.12 118510.98,-263.37 118122.17,-258.47"/>
<polygon fill="black" stroke="black" points="118121.97,-254.97 118111.93,-258.34 118121.88,-261.97 118121.97,-254.97"/>
</g>
<!-- dp1_pp2_layer10_attn_tp0 -->
<g id="node578" class="node">
<title>dp1_pp2_layer10_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="115394.5,-531.06 115129.5,-531.06 115129.5,-479.06 115394.5,-479.06 115394.5,-531.06"/>
<text text-anchor="middle" x="115262" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="115262" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="115262" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="115262" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer9_expert_agg&#45;&gt;dp1_pp2_layer10_attn_tp0 -->
<g id="edge948" class="edge">
<title>dp1_pp2_layer9_expert_agg&#45;&gt;dp1_pp2_layer10_attn_tp0</title>
<path fill="none" stroke="black" d="M117719.78,-260.41C117299.38,-269.54 116309.17,-294.77 115976,-335.52 115943.8,-339.46 115435.23,-444.29 115404,-453.06 115381.37,-459.41 115357.16,-467.58 115335.26,-475.5"/>
<polygon fill="black" stroke="black" points="115333.89,-472.28 115325.7,-479 115336.29,-478.85 115333.89,-472.28"/>
</g>
<!-- dp1_pp2_layer10_attn_allreduce -->
<g id="node579" class="node">
<title>dp1_pp2_layer10_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="115391" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="115391" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="115391" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="115391" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="115391" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_attn_tp0&#45;&gt;dp1_pp2_layer10_attn_allreduce -->
<g id="edge949" class="edge">
<title>dp1_pp2_layer10_attn_tp0&#45;&gt;dp1_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M115288.41,-478.92C115305.15,-463 115327.21,-442 115346.58,-423.56"/>
<polygon fill="black" stroke="black" points="115349.03,-426.07 115353.86,-416.64 115344.2,-421 115349.03,-426.07"/>
</g>
<!-- dp1_pp2_layer10_router -->
<g id="node583" class="node">
<title>dp1_pp2_layer10_router</title>
<polygon fill="lightyellow" stroke="black" points="113142.57,-557.06 112748.74,-557.06 112647.43,-453.06 113041.26,-453.06 113142.57,-557.06"/>
<text text-anchor="middle" x="112895" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="112895" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="112895" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="112895" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_attn_allreduce&#45;&gt;dp1_pp2_layer10_router -->
<g id="edge985" class="edge">
<title>dp1_pp2_layer10_attn_allreduce&#45;&gt;dp1_pp2_layer10_router</title>
<path fill="none" stroke="black" d="M115231.08,-392.38C115119.77,-399.9 114967.89,-409.76 114834,-417.06 114198.5,-451.72 113445.28,-482.59 113093.96,-496.4"/>
<polygon fill="black" stroke="black" points="113093.8,-492.91 113083.94,-496.79 113094.07,-499.9 113093.8,-492.91"/>
</g>
<!-- dp1_pp2_layer10_attn_tp1 -->
<g id="node580" class="node">
<title>dp1_pp2_layer10_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="115677.5,-531.06 115412.5,-531.06 115412.5,-479.06 115677.5,-479.06 115677.5,-531.06"/>
<text text-anchor="middle" x="115545" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="115545" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="115545" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="115545" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer10_attn_tp1&#45;&gt;dp1_pp2_layer10_attn_allreduce -->
<g id="edge950" class="edge">
<title>dp1_pp2_layer10_attn_tp1&#45;&gt;dp1_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M115513.46,-478.92C115492.99,-462.6 115465.83,-440.94 115442.29,-422.18"/>
<polygon fill="black" stroke="black" points="115444.46,-419.44 115434.46,-415.94 115440.1,-424.91 115444.46,-419.44"/>
</g>
<!-- dp1_pp2_layer10_attn_tp2 -->
<g id="node581" class="node">
<title>dp1_pp2_layer10_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="115111.5,-531.06 114846.5,-531.06 114846.5,-479.06 115111.5,-479.06 115111.5,-531.06"/>
<text text-anchor="middle" x="114979" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="114979" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="114979" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="114979" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer10_attn_tp2&#45;&gt;dp1_pp2_layer10_attn_allreduce -->
<g id="edge951" class="edge">
<title>dp1_pp2_layer10_attn_tp2&#45;&gt;dp1_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M115045.07,-479.02C115068.85,-470.35 115095.99,-460.86 115121,-453.06 115169.74,-437.86 115224.05,-423.03 115271.1,-410.83"/>
<polygon fill="black" stroke="black" points="115272.22,-414.15 115281.03,-408.26 115270.47,-407.38 115272.22,-414.15"/>
</g>
<!-- dp1_pp2_layer10_attn_tp3 -->
<g id="node582" class="node">
<title>dp1_pp2_layer10_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="115960.5,-531.06 115695.5,-531.06 115695.5,-479.06 115960.5,-479.06 115960.5,-531.06"/>
<text text-anchor="middle" x="115828" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="115828" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="115828" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="115828" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer10_attn_tp3&#45;&gt;dp1_pp2_layer10_attn_allreduce -->
<g id="edge952" class="edge">
<title>dp1_pp2_layer10_attn_tp3&#45;&gt;dp1_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M115763.21,-478.95C115739.43,-470.18 115712.17,-460.64 115687,-453.06 115632.42,-436.63 115571.31,-421.31 115518.86,-409.08"/>
<polygon fill="black" stroke="black" points="115519.37,-405.6 115508.83,-406.75 115517.78,-412.42 115519.37,-405.6"/>
</g>
<!-- dp1_pp2_layer10_expert0 -->
<g id="node584" class="node">
<title>dp1_pp2_layer10_expert0</title>
<polygon fill="lightgreen" stroke="black" points="111192,-406.29 110968,-406.29 110968,-354.29 111192,-354.29 111192,-406.29"/>
<text text-anchor="middle" x="111080" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="111080" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="111080" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="111080" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert0 -->
<g id="edge953" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112692.73,-499.65C112307.55,-490.26 111482.11,-465.13 111201,-417.06 111188.99,-415.01 111176.48,-412.16 111164.27,-408.95"/>
<polygon fill="black" stroke="black" points="111165.11,-405.56 111154.54,-406.32 111163.28,-412.31 111165.11,-405.56"/>
</g>
<!-- dp1_pp2_layer10_expert1 -->
<g id="node585" class="node">
<title>dp1_pp2_layer10_expert1</title>
<polygon fill="lightgreen" stroke="black" points="111434,-406.29 111210,-406.29 111210,-354.29 111434,-354.29 111434,-406.29"/>
<text text-anchor="middle" x="111322" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="111322" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="111322" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="111322" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert1 -->
<g id="edge954" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112690.55,-497.55C112348.94,-485.71 111676.58,-458.03 111443,-417.06 111431.08,-414.97 111418.67,-412.12 111406.54,-408.93"/>
<polygon fill="black" stroke="black" points="111407.45,-405.55 111396.89,-406.3 111405.62,-412.3 111407.45,-405.55"/>
</g>
<!-- dp1_pp2_layer10_expert2 -->
<g id="node586" class="node">
<title>dp1_pp2_layer10_expert2</title>
<polygon fill="lightgreen" stroke="black" points="111676,-406.29 111452,-406.29 111452,-354.29 111676,-354.29 111676,-406.29"/>
<text text-anchor="middle" x="111564" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="111564" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="111564" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="111564" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert2 -->
<g id="edge955" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112695.82,-502.85C112454.66,-498.37 112037.02,-480.97 111685,-417.06 111673.38,-414.95 111661.29,-412.14 111649.44,-409.03"/>
<polygon fill="black" stroke="black" points="111650.13,-405.59 111639.56,-406.34 111648.29,-412.34 111650.13,-405.59"/>
</g>
<!-- dp1_pp2_layer10_expert3 -->
<g id="node587" class="node">
<title>dp1_pp2_layer10_expert3</title>
<polygon fill="lightgreen" stroke="black" points="111918,-406.29 111694,-406.29 111694,-354.29 111918,-354.29 111918,-406.29"/>
<text text-anchor="middle" x="111806" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="111806" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="111806" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="111806" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert3 -->
<g id="edge956" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112690.36,-497.41C112493.31,-488.25 112187.63,-466.79 111927,-417.06 111915.57,-414.88 111903.67,-412.06 111891.99,-408.97"/>
<polygon fill="black" stroke="black" points="111892.82,-405.57 111882.25,-406.31 111890.98,-412.32 111892.82,-405.57"/>
</g>
<!-- dp1_pp2_layer10_expert4 -->
<g id="node588" class="node">
<title>dp1_pp2_layer10_expert4</title>
<polygon fill="lightgreen" stroke="black" points="112160,-406.29 111936,-406.29 111936,-354.29 112160,-354.29 112160,-406.29"/>
<text text-anchor="middle" x="112048" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="112048" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="112048" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="112048" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert4 -->
<g id="edge957" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112681.43,-487.98C112535.99,-474.71 112339.64,-452.25 112169,-417.06 112158.05,-414.8 112146.65,-412.02 112135.43,-409.02"/>
<polygon fill="black" stroke="black" points="112136.19,-405.6 112125.62,-406.33 112134.34,-412.35 112136.19,-405.6"/>
</g>
<!-- dp1_pp2_layer10_expert5 -->
<g id="node589" class="node">
<title>dp1_pp2_layer10_expert5</title>
<polygon fill="lightgreen" stroke="black" points="112402,-406.29 112178,-406.29 112178,-354.29 112402,-354.29 112402,-406.29"/>
<text text-anchor="middle" x="112290" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="112290" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="112290" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="112290" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert5 -->
<g id="edge958" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112661.29,-467.38C112581.5,-453.44 112492,-436.25 112411,-417.06 112400.9,-414.67 112390.4,-411.94 112379.99,-409.07"/>
<polygon fill="black" stroke="black" points="112380.62,-405.62 112370.05,-406.3 112378.74,-412.36 112380.62,-405.62"/>
</g>
<!-- dp1_pp2_layer10_expert6 -->
<g id="node590" class="node">
<title>dp1_pp2_layer10_expert6</title>
<polygon fill="lightgreen" stroke="black" points="112644,-406.29 112420,-406.29 112420,-354.29 112644,-354.29 112644,-406.29"/>
<text text-anchor="middle" x="112532" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="112532" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="112532" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="112532" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert6 -->
<g id="edge959" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112743.94,-452.97C112700.16,-438.16 112653.94,-422.53 112615.87,-409.66"/>
<polygon fill="black" stroke="black" points="112616.97,-406.33 112606.38,-406.45 112614.73,-412.97 112616.97,-406.33"/>
</g>
<!-- dp1_pp2_layer10_expert7 -->
<g id="node591" class="node">
<title>dp1_pp2_layer10_expert7</title>
<polygon fill="lightgreen" stroke="black" points="112886,-406.29 112662,-406.29 112662,-354.29 112886,-354.29 112886,-406.29"/>
<text text-anchor="middle" x="112774" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="112774" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="112774" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="112774" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert7 -->
<g id="edge960" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112844.38,-452.71C112831.3,-439.43 112817.58,-425.51 112805.76,-413.52"/>
<polygon fill="black" stroke="black" points="112808.19,-411 112798.68,-406.33 112803.2,-415.91 112808.19,-411"/>
</g>
<!-- dp1_pp2_layer10_expert8 -->
<g id="node592" class="node">
<title>dp1_pp2_layer10_expert8</title>
<polygon fill="lightgreen" stroke="black" points="113128,-406.29 112904,-406.29 112904,-354.29 113128,-354.29 113128,-406.29"/>
<text text-anchor="middle" x="113016" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="113016" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="113016" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="113016" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert8 -->
<g id="edge961" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M112945.61,-452.71C112958.7,-439.43 112972.42,-425.51 112984.23,-413.52"/>
<polygon fill="black" stroke="black" points="112986.79,-415.91 112991.32,-406.33 112981.81,-411 112986.79,-415.91"/>
</g>
<!-- dp1_pp2_layer10_expert9 -->
<g id="node593" class="node">
<title>dp1_pp2_layer10_expert9</title>
<polygon fill="lightgreen" stroke="black" points="113370,-406.29 113146,-406.29 113146,-354.29 113370,-354.29 113370,-406.29"/>
<text text-anchor="middle" x="113258" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="113258" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="113258" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="113258" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert9 -->
<g id="edge962" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113042.38,-454.21C113087.29,-439.03 113135.08,-422.86 113174.23,-409.62"/>
<polygon fill="black" stroke="black" points="113175.64,-412.84 113183.99,-406.32 113173.4,-406.21 113175.64,-412.84"/>
</g>
<!-- dp1_pp2_layer10_expert10 -->
<g id="node594" class="node">
<title>dp1_pp2_layer10_expert10</title>
<polygon fill="lightgreen" stroke="black" points="113612,-406.29 113388,-406.29 113388,-354.29 113612,-354.29 113612,-406.29"/>
<text text-anchor="middle" x="113500" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="113500" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="113500" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="113500" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert10 -->
<g id="edge963" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113065.89,-478.04C113158.98,-462.69 113275.88,-441.49 113379,-417.06 113389.09,-414.67 113399.6,-411.94 113410.01,-409.07"/>
<polygon fill="black" stroke="black" points="113411.26,-412.36 113419.95,-406.3 113409.37,-405.62 113411.26,-412.36"/>
</g>
<!-- dp1_pp2_layer10_expert11 -->
<g id="node595" class="node">
<title>dp1_pp2_layer10_expert11</title>
<polygon fill="lightgreen" stroke="black" points="113854,-406.29 113630,-406.29 113630,-354.29 113854,-354.29 113854,-406.29"/>
<text text-anchor="middle" x="113742" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="113742" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="113742" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="113742" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert11 -->
<g id="edge964" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113077.99,-490.7C113225.62,-477.88 113438.08,-454.78 113621,-417.06 113631.95,-414.8 113643.35,-412.02 113654.57,-409.02"/>
<polygon fill="black" stroke="black" points="113655.66,-412.35 113664.38,-406.33 113653.81,-405.6 113655.66,-412.35"/>
</g>
<!-- dp1_pp2_layer10_expert12 -->
<g id="node596" class="node">
<title>dp1_pp2_layer10_expert12</title>
<polygon fill="lightgreen" stroke="black" points="114096,-406.29 113872,-406.29 113872,-354.29 114096,-354.29 114096,-406.29"/>
<text text-anchor="middle" x="113984" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="113984" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="113984" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="113984" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert12 -->
<g id="edge965" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113085.27,-498.07C113281.59,-489.29 113595.95,-468.01 113863,-417.06 113874.43,-414.88 113886.33,-412.06 113898.01,-408.97"/>
<polygon fill="black" stroke="black" points="113899.02,-412.32 113907.75,-406.31 113897.18,-405.57 113899.02,-412.32"/>
</g>
<!-- dp1_pp2_layer10_expert13 -->
<g id="node597" class="node">
<title>dp1_pp2_layer10_expert13</title>
<polygon fill="lightgreen" stroke="black" points="114338,-406.29 114114,-406.29 114114,-354.29 114338,-354.29 114338,-406.29"/>
<text text-anchor="middle" x="114226" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="114226" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="114226" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="114226" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert13 -->
<g id="edge966" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113089.93,-502.93C113330.42,-498.58 113750.9,-481.35 114105,-417.06 114116.62,-414.95 114128.71,-412.14 114140.56,-409.03"/>
<polygon fill="black" stroke="black" points="114141.7,-412.34 114150.44,-406.34 114139.87,-405.59 114141.7,-412.34"/>
</g>
<!-- dp1_pp2_layer10_expert14 -->
<g id="node598" class="node">
<title>dp1_pp2_layer10_expert14</title>
<polygon fill="lightgreen" stroke="black" points="114580,-406.29 114356,-406.29 114356,-354.29 114580,-354.29 114580,-406.29"/>
<text text-anchor="middle" x="114468" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="114468" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="114468" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="114468" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert14 -->
<g id="edge967" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113085.32,-498.04C113422.17,-486.48 114110.15,-458.6 114347,-417.06 114358.92,-414.97 114371.32,-412.12 114383.46,-408.93"/>
<polygon fill="black" stroke="black" points="114384.38,-412.3 114393.11,-406.3 114382.54,-405.55 114384.38,-412.3"/>
</g>
<!-- dp1_pp2_layer10_expert15 -->
<g id="node599" class="node">
<title>dp1_pp2_layer10_expert15</title>
<polygon fill="lightgreen" stroke="black" points="114822,-406.29 114598,-406.29 114598,-354.29 114822,-354.29 114822,-406.29"/>
<text text-anchor="middle" x="114710" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="114710" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="114710" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="114710" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert15 -->
<g id="edge968" class="edge">
<title>dp1_pp2_layer10_router&#45;&gt;dp1_pp2_layer10_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M113086.94,-499.9C113467.49,-490.72 114305.35,-465.57 114589,-417.06 114601.01,-415.01 114613.51,-412.16 114625.73,-408.95"/>
<polygon fill="black" stroke="black" points="114626.72,-412.31 114635.45,-406.32 114624.88,-405.56 114626.72,-412.31"/>
</g>
<!-- dp1_pp2_layer10_expert_agg -->
<g id="node600" class="node">
<title>dp1_pp2_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="113142.57,-307.52 112748.74,-307.52 112647.43,-203.52 113041.26,-203.52 113142.57,-307.52"/>
<text text-anchor="middle" x="112895" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="112895" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="112895" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="112895" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer10_expert0&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge969" class="edge">
<title>dp1_pp2_layer10_expert0&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M111138.07,-354.29C111157.69,-346.92 111179.97,-339.72 111201,-335.52 111480.13,-279.86 112303.93,-263.21 112690.43,-258.4"/>
<polygon fill="black" stroke="black" points="112690.65,-261.9 112700.61,-258.27 112690.57,-254.9 112690.65,-261.9"/>
</g>
<!-- dp1_pp2_layer10_expert1&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge970" class="edge">
<title>dp1_pp2_layer10_expert1&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M111380.39,-354.27C111399.95,-346.95 111422.09,-339.78 111443,-335.52 111675.8,-288.16 112351.09,-267.74 112692.43,-260.24"/>
<polygon fill="black" stroke="black" points="112692.51,-263.74 112702.43,-260.03 112692.35,-256.74 112692.51,-263.74"/>
</g>
<!-- dp1_pp2_layer10_expert2&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge971" class="edge">
<title>dp1_pp2_layer10_expert2&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M111622.73,-354.29C111642.21,-347.01 111664.23,-339.87 111685,-335.52 111871.91,-296.44 112401.54,-273.07 112694.3,-262.78"/>
<polygon fill="black" stroke="black" points="112694.74,-266.27 112704.61,-262.42 112694.5,-259.27 112694.74,-266.27"/>
</g>
<!-- dp1_pp2_layer10_expert3&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge972" class="edge">
<title>dp1_pp2_layer10_expert3&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M111865.39,-354.26C111884.72,-347.07 111906.48,-339.99 111927,-335.52 112185.91,-279.18 112491.7,-262.24 112689.26,-257.56"/>
<polygon fill="black" stroke="black" points="112689.55,-261.06 112699.47,-257.33 112689.39,-254.06 112689.55,-261.06"/>
</g>
<!-- dp1_pp2_layer10_expert4&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge973" class="edge">
<title>dp1_pp2_layer10_expert4&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M112108.39,-354.24C112127.49,-347.2 112148.87,-340.19 112169,-335.52 112344.82,-294.77 112549.6,-274.91 112696.75,-265.31"/>
<polygon fill="black" stroke="black" points="112697.05,-268.8 112706.81,-264.67 112696.6,-261.82 112697.05,-268.8"/>
</g>
<!-- dp1_pp2_layer10_expert5&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge974" class="edge">
<title>dp1_pp2_layer10_expert5&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M112352.42,-354.22C112371.04,-347.42 112391.65,-340.55 112411,-335.52 112508.09,-310.27 112618.34,-291.53 112709.07,-278.65"/>
<polygon fill="black" stroke="black" points="112709.78,-282.09 112719.19,-277.23 112708.8,-275.16 112709.78,-282.09"/>
</g>
<!-- dp1_pp2_layer10_expert6&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge975" class="edge">
<title>dp1_pp2_layer10_expert6&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M112600.02,-354.26C112617.26,-348.03 112635.78,-341.44 112653,-335.52 112679.73,-326.33 112708.21,-316.8 112735.89,-307.67"/>
<polygon fill="black" stroke="black" points="112737.24,-310.91 112745.65,-304.46 112735.06,-304.26 112737.24,-310.91"/>
</g>
<!-- dp1_pp2_layer10_expert7&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge976" class="edge">
<title>dp1_pp2_layer10_expert7&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M112798.78,-354.15C112810.02,-342.74 112823.83,-328.73 112837.45,-314.92"/>
<polygon fill="black" stroke="black" points="112840,-317.31 112844.53,-307.73 112835.02,-312.39 112840,-317.31"/>
</g>
<!-- dp1_pp2_layer10_expert8&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge977" class="edge">
<title>dp1_pp2_layer10_expert8&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M112991.22,-354.15C112979.97,-342.74 112966.16,-328.73 112952.55,-314.92"/>
<polygon fill="black" stroke="black" points="112954.98,-312.39 112945.47,-307.73 112949.99,-317.31 112954.98,-312.39"/>
</g>
<!-- dp1_pp2_layer10_expert9&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge978" class="edge">
<title>dp1_pp2_layer10_expert9&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M113189.98,-354.26C113172.73,-348.03 113154.21,-341.44 113137,-335.52 113113.29,-327.37 113088.21,-318.95 113063.53,-310.78"/>
<polygon fill="black" stroke="black" points="113064.32,-307.36 113053.73,-307.54 113062.12,-314 113064.32,-307.36"/>
</g>
<!-- dp1_pp2_layer10_expert10&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge979" class="edge">
<title>dp1_pp2_layer10_expert10&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M113437.58,-354.22C113418.96,-347.42 113398.35,-340.55 113379,-335.52 113298.99,-314.71 113210.05,-298.33 113130.46,-286"/>
<polygon fill="black" stroke="black" points="113130.71,-282.5 113120.3,-284.44 113129.65,-289.41 113130.71,-282.5"/>
</g>
<!-- dp1_pp2_layer10_expert11&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge980" class="edge">
<title>dp1_pp2_layer10_expert11&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M113681.61,-354.24C113662.51,-347.2 113641.13,-340.19 113621,-335.52 113452.74,-296.53 113257.97,-276.66 113112.55,-266.61"/>
<polygon fill="black" stroke="black" points="113112.38,-263.09 113102.16,-265.9 113111.9,-270.07 113112.38,-263.09"/>
</g>
<!-- dp1_pp2_layer10_expert12&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge981" class="edge">
<title>dp1_pp2_layer10_expert12&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M113924.61,-354.26C113905.28,-347.07 113883.52,-339.99 113863,-335.52 113605.51,-279.49 113301.64,-262.43 113103.99,-257.64"/>
<polygon fill="black" stroke="black" points="113103.86,-254.14 113093.78,-257.4 113103.69,-261.13 113103.86,-254.14"/>
</g>
<!-- dp1_pp2_layer10_expert13&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge982" class="edge">
<title>dp1_pp2_layer10_expert13&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M114167.27,-354.29C114147.79,-347.01 114125.77,-339.87 114105,-335.52 113921.02,-297.05 113404.97,-273.81 113109.63,-263.27"/>
<polygon fill="black" stroke="black" points="113109.33,-259.76 113099.21,-262.9 113109.08,-266.76 113109.33,-259.76"/>
</g>
<!-- dp1_pp2_layer10_expert14&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge983" class="edge">
<title>dp1_pp2_layer10_expert14&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M114409.6,-354.27C114390.05,-346.95 114367.9,-339.78 114347,-335.52 114116.27,-288.58 113450.86,-268.1 113106.74,-260.45"/>
<polygon fill="black" stroke="black" points="113106.73,-256.94 113096.65,-260.22 113106.57,-263.94 113106.73,-256.94"/>
</g>
<!-- dp1_pp2_layer10_expert15&#45;&gt;dp1_pp2_layer10_expert_agg -->
<g id="edge984" class="edge">
<title>dp1_pp2_layer10_expert15&#45;&gt;dp1_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M114651.93,-354.29C114632.3,-346.92 114610.03,-339.72 114589,-335.52 114311.21,-280.12 113493.98,-263.37 113105.17,-258.47"/>
<polygon fill="black" stroke="black" points="113104.97,-254.97 113094.93,-258.34 113104.88,-261.97 113104.97,-254.97"/>
</g>
<!-- dp1_pp2_layer11_attn_tp0 -->
<g id="node601" class="node">
<title>dp1_pp2_layer11_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="110377.5,-531.06 110112.5,-531.06 110112.5,-479.06 110377.5,-479.06 110377.5,-531.06"/>
<text text-anchor="middle" x="110245" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="110245" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="110245" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="110245" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer10_expert_agg&#45;&gt;dp1_pp2_layer11_attn_tp0 -->
<g id="edge986" class="edge">
<title>dp1_pp2_layer10_expert_agg&#45;&gt;dp1_pp2_layer11_attn_tp0</title>
<path fill="none" stroke="black" d="M112702.78,-260.41C112282.38,-269.54 111292.17,-294.77 110959,-335.52 110926.8,-339.46 110418.23,-444.29 110387,-453.06 110364.37,-459.41 110340.16,-467.58 110318.26,-475.5"/>
<polygon fill="black" stroke="black" points="110316.89,-472.28 110308.7,-479 110319.29,-478.85 110316.89,-472.28"/>
</g>
<!-- dp1_pp2_layer11_attn_allreduce -->
<g id="node602" class="node">
<title>dp1_pp2_layer11_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="110374" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="110374" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="110374" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="110374" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="110374" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_attn_tp0&#45;&gt;dp1_pp2_layer11_attn_allreduce -->
<g id="edge987" class="edge">
<title>dp1_pp2_layer11_attn_tp0&#45;&gt;dp1_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M110271.41,-478.92C110288.15,-463 110310.21,-442 110329.58,-423.56"/>
<polygon fill="black" stroke="black" points="110332.03,-426.07 110336.86,-416.64 110327.2,-421 110332.03,-426.07"/>
</g>
<!-- dp1_pp2_layer11_router -->
<g id="node606" class="node">
<title>dp1_pp2_layer11_router</title>
<polygon fill="lightyellow" stroke="black" points="108125.57,-557.06 107731.74,-557.06 107630.43,-453.06 108024.26,-453.06 108125.57,-557.06"/>
<text text-anchor="middle" x="107878" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="107878" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="107878" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="107878" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_attn_allreduce&#45;&gt;dp1_pp2_layer11_router -->
<g id="edge1023" class="edge">
<title>dp1_pp2_layer11_attn_allreduce&#45;&gt;dp1_pp2_layer11_router</title>
<path fill="none" stroke="black" d="M110214.08,-392.38C110102.77,-399.9 109950.89,-409.76 109817,-417.06 109181.5,-451.72 108428.28,-482.59 108076.96,-496.4"/>
<polygon fill="black" stroke="black" points="108076.8,-492.91 108066.94,-496.79 108077.07,-499.9 108076.8,-492.91"/>
</g>
<!-- dp1_pp2_layer11_attn_tp1 -->
<g id="node603" class="node">
<title>dp1_pp2_layer11_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="110660.5,-531.06 110395.5,-531.06 110395.5,-479.06 110660.5,-479.06 110660.5,-531.06"/>
<text text-anchor="middle" x="110528" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="110528" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="110528" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="110528" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer11_attn_tp1&#45;&gt;dp1_pp2_layer11_attn_allreduce -->
<g id="edge988" class="edge">
<title>dp1_pp2_layer11_attn_tp1&#45;&gt;dp1_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M110496.46,-478.92C110475.99,-462.6 110448.83,-440.94 110425.29,-422.18"/>
<polygon fill="black" stroke="black" points="110427.46,-419.44 110417.46,-415.94 110423.1,-424.91 110427.46,-419.44"/>
</g>
<!-- dp1_pp2_layer11_attn_tp2 -->
<g id="node604" class="node">
<title>dp1_pp2_layer11_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="110094.5,-531.06 109829.5,-531.06 109829.5,-479.06 110094.5,-479.06 110094.5,-531.06"/>
<text text-anchor="middle" x="109962" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="109962" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="109962" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="109962" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer11_attn_tp2&#45;&gt;dp1_pp2_layer11_attn_allreduce -->
<g id="edge989" class="edge">
<title>dp1_pp2_layer11_attn_tp2&#45;&gt;dp1_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M110028.07,-479.02C110051.85,-470.35 110078.99,-460.86 110104,-453.06 110152.74,-437.86 110207.05,-423.03 110254.1,-410.83"/>
<polygon fill="black" stroke="black" points="110255.22,-414.15 110264.03,-408.26 110253.47,-407.38 110255.22,-414.15"/>
</g>
<!-- dp1_pp2_layer11_attn_tp3 -->
<g id="node605" class="node">
<title>dp1_pp2_layer11_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="110943.5,-531.06 110678.5,-531.06 110678.5,-479.06 110943.5,-479.06 110943.5,-531.06"/>
<text text-anchor="middle" x="110811" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="110811" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="110811" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="110811" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer11_attn_tp3&#45;&gt;dp1_pp2_layer11_attn_allreduce -->
<g id="edge990" class="edge">
<title>dp1_pp2_layer11_attn_tp3&#45;&gt;dp1_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M110746.21,-478.95C110722.43,-470.18 110695.17,-460.64 110670,-453.06 110615.42,-436.63 110554.31,-421.31 110501.86,-409.08"/>
<polygon fill="black" stroke="black" points="110502.37,-405.6 110491.83,-406.75 110500.78,-412.42 110502.37,-405.6"/>
</g>
<!-- dp1_pp2_layer11_expert0 -->
<g id="node607" class="node">
<title>dp1_pp2_layer11_expert0</title>
<polygon fill="lightgreen" stroke="black" points="106175,-406.29 105951,-406.29 105951,-354.29 106175,-354.29 106175,-406.29"/>
<text text-anchor="middle" x="106063" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="106063" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="106063" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="106063" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert0 -->
<g id="edge991" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107675.73,-499.65C107290.55,-490.26 106465.11,-465.13 106184,-417.06 106171.99,-415.01 106159.48,-412.16 106147.27,-408.95"/>
<polygon fill="black" stroke="black" points="106148.11,-405.56 106137.54,-406.32 106146.28,-412.31 106148.11,-405.56"/>
</g>
<!-- dp1_pp2_layer11_expert1 -->
<g id="node608" class="node">
<title>dp1_pp2_layer11_expert1</title>
<polygon fill="lightgreen" stroke="black" points="106417,-406.29 106193,-406.29 106193,-354.29 106417,-354.29 106417,-406.29"/>
<text text-anchor="middle" x="106305" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="106305" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="106305" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="106305" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert1 -->
<g id="edge992" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107673.55,-497.55C107331.94,-485.71 106659.58,-458.03 106426,-417.06 106414.08,-414.97 106401.67,-412.12 106389.54,-408.93"/>
<polygon fill="black" stroke="black" points="106390.45,-405.55 106379.89,-406.3 106388.62,-412.3 106390.45,-405.55"/>
</g>
<!-- dp1_pp2_layer11_expert2 -->
<g id="node609" class="node">
<title>dp1_pp2_layer11_expert2</title>
<polygon fill="lightgreen" stroke="black" points="106659,-406.29 106435,-406.29 106435,-354.29 106659,-354.29 106659,-406.29"/>
<text text-anchor="middle" x="106547" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="106547" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="106547" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="106547" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert2 -->
<g id="edge993" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107678.82,-502.85C107437.66,-498.37 107020.02,-480.97 106668,-417.06 106656.38,-414.95 106644.29,-412.14 106632.44,-409.03"/>
<polygon fill="black" stroke="black" points="106633.13,-405.59 106622.56,-406.34 106631.29,-412.34 106633.13,-405.59"/>
</g>
<!-- dp1_pp2_layer11_expert3 -->
<g id="node610" class="node">
<title>dp1_pp2_layer11_expert3</title>
<polygon fill="lightgreen" stroke="black" points="106901,-406.29 106677,-406.29 106677,-354.29 106901,-354.29 106901,-406.29"/>
<text text-anchor="middle" x="106789" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="106789" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="106789" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="106789" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert3 -->
<g id="edge994" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107673.36,-497.41C107476.31,-488.25 107170.63,-466.79 106910,-417.06 106898.57,-414.88 106886.67,-412.06 106874.99,-408.97"/>
<polygon fill="black" stroke="black" points="106875.82,-405.57 106865.25,-406.31 106873.98,-412.32 106875.82,-405.57"/>
</g>
<!-- dp1_pp2_layer11_expert4 -->
<g id="node611" class="node">
<title>dp1_pp2_layer11_expert4</title>
<polygon fill="lightgreen" stroke="black" points="107143,-406.29 106919,-406.29 106919,-354.29 107143,-354.29 107143,-406.29"/>
<text text-anchor="middle" x="107031" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="107031" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="107031" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="107031" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert4 -->
<g id="edge995" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107664.43,-487.98C107518.99,-474.71 107322.64,-452.25 107152,-417.06 107141.05,-414.8 107129.65,-412.02 107118.43,-409.02"/>
<polygon fill="black" stroke="black" points="107119.19,-405.6 107108.62,-406.33 107117.34,-412.35 107119.19,-405.6"/>
</g>
<!-- dp1_pp2_layer11_expert5 -->
<g id="node612" class="node">
<title>dp1_pp2_layer11_expert5</title>
<polygon fill="lightgreen" stroke="black" points="107385,-406.29 107161,-406.29 107161,-354.29 107385,-354.29 107385,-406.29"/>
<text text-anchor="middle" x="107273" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="107273" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="107273" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="107273" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert5 -->
<g id="edge996" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107644.29,-467.38C107564.5,-453.44 107475,-436.25 107394,-417.06 107383.9,-414.67 107373.4,-411.94 107362.99,-409.07"/>
<polygon fill="black" stroke="black" points="107363.62,-405.62 107353.05,-406.3 107361.74,-412.36 107363.62,-405.62"/>
</g>
<!-- dp1_pp2_layer11_expert6 -->
<g id="node613" class="node">
<title>dp1_pp2_layer11_expert6</title>
<polygon fill="lightgreen" stroke="black" points="107627,-406.29 107403,-406.29 107403,-354.29 107627,-354.29 107627,-406.29"/>
<text text-anchor="middle" x="107515" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="107515" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="107515" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="107515" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert6 -->
<g id="edge997" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107726.94,-452.97C107683.16,-438.16 107636.94,-422.53 107598.87,-409.66"/>
<polygon fill="black" stroke="black" points="107599.97,-406.33 107589.38,-406.45 107597.73,-412.97 107599.97,-406.33"/>
</g>
<!-- dp1_pp2_layer11_expert7 -->
<g id="node614" class="node">
<title>dp1_pp2_layer11_expert7</title>
<polygon fill="lightgreen" stroke="black" points="107869,-406.29 107645,-406.29 107645,-354.29 107869,-354.29 107869,-406.29"/>
<text text-anchor="middle" x="107757" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="107757" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="107757" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="107757" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert7 -->
<g id="edge998" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107827.38,-452.71C107814.3,-439.43 107800.58,-425.51 107788.76,-413.52"/>
<polygon fill="black" stroke="black" points="107791.19,-411 107781.68,-406.33 107786.2,-415.91 107791.19,-411"/>
</g>
<!-- dp1_pp2_layer11_expert8 -->
<g id="node615" class="node">
<title>dp1_pp2_layer11_expert8</title>
<polygon fill="lightgreen" stroke="black" points="108111,-406.29 107887,-406.29 107887,-354.29 108111,-354.29 108111,-406.29"/>
<text text-anchor="middle" x="107999" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="107999" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="107999" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="107999" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert8 -->
<g id="edge999" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M107928.61,-452.71C107941.7,-439.43 107955.42,-425.51 107967.23,-413.52"/>
<polygon fill="black" stroke="black" points="107969.79,-415.91 107974.32,-406.33 107964.81,-411 107969.79,-415.91"/>
</g>
<!-- dp1_pp2_layer11_expert9 -->
<g id="node616" class="node">
<title>dp1_pp2_layer11_expert9</title>
<polygon fill="lightgreen" stroke="black" points="108353,-406.29 108129,-406.29 108129,-354.29 108353,-354.29 108353,-406.29"/>
<text text-anchor="middle" x="108241" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="108241" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="108241" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="108241" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert9 -->
<g id="edge1000" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108025.38,-454.21C108070.29,-439.03 108118.08,-422.86 108157.23,-409.62"/>
<polygon fill="black" stroke="black" points="108158.64,-412.84 108166.99,-406.32 108156.4,-406.21 108158.64,-412.84"/>
</g>
<!-- dp1_pp2_layer11_expert10 -->
<g id="node617" class="node">
<title>dp1_pp2_layer11_expert10</title>
<polygon fill="lightgreen" stroke="black" points="108595,-406.29 108371,-406.29 108371,-354.29 108595,-354.29 108595,-406.29"/>
<text text-anchor="middle" x="108483" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="108483" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="108483" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="108483" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert10 -->
<g id="edge1001" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108048.89,-478.04C108141.98,-462.69 108258.88,-441.49 108362,-417.06 108372.09,-414.67 108382.6,-411.94 108393.01,-409.07"/>
<polygon fill="black" stroke="black" points="108394.26,-412.36 108402.95,-406.3 108392.37,-405.62 108394.26,-412.36"/>
</g>
<!-- dp1_pp2_layer11_expert11 -->
<g id="node618" class="node">
<title>dp1_pp2_layer11_expert11</title>
<polygon fill="lightgreen" stroke="black" points="108837,-406.29 108613,-406.29 108613,-354.29 108837,-354.29 108837,-406.29"/>
<text text-anchor="middle" x="108725" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="108725" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="108725" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="108725" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert11 -->
<g id="edge1002" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108060.99,-490.7C108208.62,-477.88 108421.08,-454.78 108604,-417.06 108614.95,-414.8 108626.35,-412.02 108637.57,-409.02"/>
<polygon fill="black" stroke="black" points="108638.66,-412.35 108647.38,-406.33 108636.81,-405.6 108638.66,-412.35"/>
</g>
<!-- dp1_pp2_layer11_expert12 -->
<g id="node619" class="node">
<title>dp1_pp2_layer11_expert12</title>
<polygon fill="lightgreen" stroke="black" points="109079,-406.29 108855,-406.29 108855,-354.29 109079,-354.29 109079,-406.29"/>
<text text-anchor="middle" x="108967" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="108967" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="108967" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="108967" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert12 -->
<g id="edge1003" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108068.27,-498.07C108264.59,-489.29 108578.95,-468.01 108846,-417.06 108857.43,-414.88 108869.33,-412.06 108881.01,-408.97"/>
<polygon fill="black" stroke="black" points="108882.02,-412.32 108890.75,-406.31 108880.18,-405.57 108882.02,-412.32"/>
</g>
<!-- dp1_pp2_layer11_expert13 -->
<g id="node620" class="node">
<title>dp1_pp2_layer11_expert13</title>
<polygon fill="lightgreen" stroke="black" points="109321,-406.29 109097,-406.29 109097,-354.29 109321,-354.29 109321,-406.29"/>
<text text-anchor="middle" x="109209" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="109209" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="109209" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="109209" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert13 -->
<g id="edge1004" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108072.93,-502.93C108313.42,-498.58 108733.9,-481.35 109088,-417.06 109099.62,-414.95 109111.71,-412.14 109123.56,-409.03"/>
<polygon fill="black" stroke="black" points="109124.7,-412.34 109133.44,-406.34 109122.87,-405.59 109124.7,-412.34"/>
</g>
<!-- dp1_pp2_layer11_expert14 -->
<g id="node621" class="node">
<title>dp1_pp2_layer11_expert14</title>
<polygon fill="lightgreen" stroke="black" points="109563,-406.29 109339,-406.29 109339,-354.29 109563,-354.29 109563,-406.29"/>
<text text-anchor="middle" x="109451" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="109451" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="109451" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="109451" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert14 -->
<g id="edge1005" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108068.32,-498.04C108405.17,-486.48 109093.15,-458.6 109330,-417.06 109341.92,-414.97 109354.32,-412.12 109366.46,-408.93"/>
<polygon fill="black" stroke="black" points="109367.38,-412.3 109376.11,-406.3 109365.54,-405.55 109367.38,-412.3"/>
</g>
<!-- dp1_pp2_layer11_expert15 -->
<g id="node622" class="node">
<title>dp1_pp2_layer11_expert15</title>
<polygon fill="lightgreen" stroke="black" points="109805,-406.29 109581,-406.29 109581,-354.29 109805,-354.29 109805,-406.29"/>
<text text-anchor="middle" x="109693" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="109693" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="109693" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="109693" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert15 -->
<g id="edge1006" class="edge">
<title>dp1_pp2_layer11_router&#45;&gt;dp1_pp2_layer11_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M108069.94,-499.9C108450.49,-490.72 109288.35,-465.57 109572,-417.06 109584.01,-415.01 109596.51,-412.16 109608.73,-408.95"/>
<polygon fill="black" stroke="black" points="109609.72,-412.31 109618.45,-406.32 109607.88,-405.56 109609.72,-412.31"/>
</g>
<!-- dp1_pp2_layer11_expert_agg -->
<g id="node623" class="node">
<title>dp1_pp2_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="108125.57,-307.52 107731.74,-307.52 107630.43,-203.52 108024.26,-203.52 108125.57,-307.52"/>
<text text-anchor="middle" x="107878" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="107878" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="107878" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="107878" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer11_expert0&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1007" class="edge">
<title>dp1_pp2_layer11_expert0&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M106121.07,-354.29C106140.69,-346.92 106162.97,-339.72 106184,-335.52 106463.13,-279.86 107286.93,-263.21 107673.43,-258.4"/>
<polygon fill="black" stroke="black" points="107673.65,-261.9 107683.61,-258.27 107673.57,-254.9 107673.65,-261.9"/>
</g>
<!-- dp1_pp2_layer11_expert1&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1008" class="edge">
<title>dp1_pp2_layer11_expert1&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M106363.39,-354.27C106382.95,-346.95 106405.09,-339.78 106426,-335.52 106658.8,-288.16 107334.09,-267.74 107675.43,-260.24"/>
<polygon fill="black" stroke="black" points="107675.51,-263.74 107685.43,-260.03 107675.35,-256.74 107675.51,-263.74"/>
</g>
<!-- dp1_pp2_layer11_expert2&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1009" class="edge">
<title>dp1_pp2_layer11_expert2&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M106605.73,-354.29C106625.21,-347.01 106647.23,-339.87 106668,-335.52 106854.91,-296.44 107384.54,-273.07 107677.3,-262.78"/>
<polygon fill="black" stroke="black" points="107677.74,-266.27 107687.61,-262.42 107677.5,-259.27 107677.74,-266.27"/>
</g>
<!-- dp1_pp2_layer11_expert3&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1010" class="edge">
<title>dp1_pp2_layer11_expert3&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M106848.39,-354.26C106867.72,-347.07 106889.48,-339.99 106910,-335.52 107168.91,-279.18 107474.7,-262.24 107672.26,-257.56"/>
<polygon fill="black" stroke="black" points="107672.55,-261.06 107682.47,-257.33 107672.39,-254.06 107672.55,-261.06"/>
</g>
<!-- dp1_pp2_layer11_expert4&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1011" class="edge">
<title>dp1_pp2_layer11_expert4&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M107091.39,-354.24C107110.49,-347.2 107131.87,-340.19 107152,-335.52 107327.82,-294.77 107532.6,-274.91 107679.75,-265.31"/>
<polygon fill="black" stroke="black" points="107680.05,-268.8 107689.81,-264.67 107679.6,-261.82 107680.05,-268.8"/>
</g>
<!-- dp1_pp2_layer11_expert5&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1012" class="edge">
<title>dp1_pp2_layer11_expert5&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M107335.42,-354.22C107354.04,-347.42 107374.65,-340.55 107394,-335.52 107491.09,-310.27 107601.34,-291.53 107692.07,-278.65"/>
<polygon fill="black" stroke="black" points="107692.78,-282.09 107702.19,-277.23 107691.8,-275.16 107692.78,-282.09"/>
</g>
<!-- dp1_pp2_layer11_expert6&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1013" class="edge">
<title>dp1_pp2_layer11_expert6&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M107583.02,-354.26C107600.26,-348.03 107618.78,-341.44 107636,-335.52 107662.73,-326.33 107691.21,-316.8 107718.89,-307.67"/>
<polygon fill="black" stroke="black" points="107720.24,-310.91 107728.65,-304.46 107718.06,-304.26 107720.24,-310.91"/>
</g>
<!-- dp1_pp2_layer11_expert7&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1014" class="edge">
<title>dp1_pp2_layer11_expert7&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M107781.78,-354.15C107793.02,-342.74 107806.83,-328.73 107820.45,-314.92"/>
<polygon fill="black" stroke="black" points="107823,-317.31 107827.53,-307.73 107818.02,-312.39 107823,-317.31"/>
</g>
<!-- dp1_pp2_layer11_expert8&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1015" class="edge">
<title>dp1_pp2_layer11_expert8&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M107974.22,-354.15C107962.97,-342.74 107949.16,-328.73 107935.55,-314.92"/>
<polygon fill="black" stroke="black" points="107937.98,-312.39 107928.47,-307.73 107932.99,-317.31 107937.98,-312.39"/>
</g>
<!-- dp1_pp2_layer11_expert9&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1016" class="edge">
<title>dp1_pp2_layer11_expert9&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M108172.98,-354.26C108155.73,-348.03 108137.21,-341.44 108120,-335.52 108096.29,-327.37 108071.21,-318.95 108046.53,-310.78"/>
<polygon fill="black" stroke="black" points="108047.32,-307.36 108036.73,-307.54 108045.12,-314 108047.32,-307.36"/>
</g>
<!-- dp1_pp2_layer11_expert10&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1017" class="edge">
<title>dp1_pp2_layer11_expert10&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M108420.58,-354.22C108401.96,-347.42 108381.35,-340.55 108362,-335.52 108281.99,-314.71 108193.05,-298.33 108113.46,-286"/>
<polygon fill="black" stroke="black" points="108113.71,-282.5 108103.3,-284.44 108112.65,-289.41 108113.71,-282.5"/>
</g>
<!-- dp1_pp2_layer11_expert11&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1018" class="edge">
<title>dp1_pp2_layer11_expert11&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M108664.61,-354.24C108645.51,-347.2 108624.13,-340.19 108604,-335.52 108435.74,-296.53 108240.97,-276.66 108095.55,-266.61"/>
<polygon fill="black" stroke="black" points="108095.38,-263.09 108085.16,-265.9 108094.9,-270.07 108095.38,-263.09"/>
</g>
<!-- dp1_pp2_layer11_expert12&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1019" class="edge">
<title>dp1_pp2_layer11_expert12&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M108907.61,-354.26C108888.28,-347.07 108866.52,-339.99 108846,-335.52 108588.51,-279.49 108284.64,-262.43 108086.99,-257.64"/>
<polygon fill="black" stroke="black" points="108086.86,-254.14 108076.78,-257.4 108086.69,-261.13 108086.86,-254.14"/>
</g>
<!-- dp1_pp2_layer11_expert13&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1020" class="edge">
<title>dp1_pp2_layer11_expert13&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M109150.27,-354.29C109130.79,-347.01 109108.77,-339.87 109088,-335.52 108904.02,-297.05 108387.97,-273.81 108092.63,-263.27"/>
<polygon fill="black" stroke="black" points="108092.33,-259.76 108082.21,-262.9 108092.08,-266.76 108092.33,-259.76"/>
</g>
<!-- dp1_pp2_layer11_expert14&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1021" class="edge">
<title>dp1_pp2_layer11_expert14&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M109392.6,-354.27C109373.05,-346.95 109350.9,-339.78 109330,-335.52 109099.27,-288.58 108433.86,-268.1 108089.74,-260.45"/>
<polygon fill="black" stroke="black" points="108089.73,-256.94 108079.65,-260.22 108089.57,-263.94 108089.73,-256.94"/>
</g>
<!-- dp1_pp2_layer11_expert15&#45;&gt;dp1_pp2_layer11_expert_agg -->
<g id="edge1022" class="edge">
<title>dp1_pp2_layer11_expert15&#45;&gt;dp1_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M109634.93,-354.29C109615.3,-346.92 109593.03,-339.72 109572,-335.52 109294.21,-280.12 108476.98,-263.37 108088.17,-258.47"/>
<polygon fill="black" stroke="black" points="108087.97,-254.97 108077.93,-258.34 108087.88,-261.97 108087.97,-254.97"/>
</g>
<!-- dp1_pp2_layer12_attn_tp0 -->
<g id="node624" class="node">
<title>dp1_pp2_layer12_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="105360.5,-531.06 105095.5,-531.06 105095.5,-479.06 105360.5,-479.06 105360.5,-531.06"/>
<text text-anchor="middle" x="105228" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="105228" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="105228" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="105228" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer11_expert_agg&#45;&gt;dp1_pp2_layer12_attn_tp0 -->
<g id="edge1024" class="edge">
<title>dp1_pp2_layer11_expert_agg&#45;&gt;dp1_pp2_layer12_attn_tp0</title>
<path fill="none" stroke="black" d="M107685.78,-260.41C107265.38,-269.54 106275.17,-294.77 105942,-335.52 105909.8,-339.46 105401.23,-444.29 105370,-453.06 105347.37,-459.41 105323.16,-467.58 105301.26,-475.5"/>
<polygon fill="black" stroke="black" points="105299.89,-472.28 105291.7,-479 105302.29,-478.85 105299.89,-472.28"/>
</g>
<!-- dp1_pp2_layer12_attn_allreduce -->
<g id="node625" class="node">
<title>dp1_pp2_layer12_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="105357" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="105357" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="105357" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="105357" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="105357" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_attn_tp0&#45;&gt;dp1_pp2_layer12_attn_allreduce -->
<g id="edge1025" class="edge">
<title>dp1_pp2_layer12_attn_tp0&#45;&gt;dp1_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M105254.41,-478.92C105271.15,-463 105293.21,-442 105312.58,-423.56"/>
<polygon fill="black" stroke="black" points="105315.03,-426.07 105319.86,-416.64 105310.2,-421 105315.03,-426.07"/>
</g>
<!-- dp1_pp2_layer12_router -->
<g id="node629" class="node">
<title>dp1_pp2_layer12_router</title>
<polygon fill="lightyellow" stroke="black" points="103108.57,-557.06 102714.74,-557.06 102613.43,-453.06 103007.26,-453.06 103108.57,-557.06"/>
<text text-anchor="middle" x="102861" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="102861" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="102861" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="102861" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_attn_allreduce&#45;&gt;dp1_pp2_layer12_router -->
<g id="edge1061" class="edge">
<title>dp1_pp2_layer12_attn_allreduce&#45;&gt;dp1_pp2_layer12_router</title>
<path fill="none" stroke="black" d="M105197.08,-392.38C105085.77,-399.9 104933.89,-409.76 104800,-417.06 104164.5,-451.72 103411.28,-482.59 103059.96,-496.4"/>
<polygon fill="black" stroke="black" points="103059.8,-492.91 103049.94,-496.79 103060.07,-499.9 103059.8,-492.91"/>
</g>
<!-- dp1_pp2_layer12_attn_tp1 -->
<g id="node626" class="node">
<title>dp1_pp2_layer12_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="105643.5,-531.06 105378.5,-531.06 105378.5,-479.06 105643.5,-479.06 105643.5,-531.06"/>
<text text-anchor="middle" x="105511" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="105511" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="105511" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="105511" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer12_attn_tp1&#45;&gt;dp1_pp2_layer12_attn_allreduce -->
<g id="edge1026" class="edge">
<title>dp1_pp2_layer12_attn_tp1&#45;&gt;dp1_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M105479.46,-478.92C105458.99,-462.6 105431.83,-440.94 105408.29,-422.18"/>
<polygon fill="black" stroke="black" points="105410.46,-419.44 105400.46,-415.94 105406.1,-424.91 105410.46,-419.44"/>
</g>
<!-- dp1_pp2_layer12_attn_tp2 -->
<g id="node627" class="node">
<title>dp1_pp2_layer12_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="105077.5,-531.06 104812.5,-531.06 104812.5,-479.06 105077.5,-479.06 105077.5,-531.06"/>
<text text-anchor="middle" x="104945" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="104945" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="104945" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="104945" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer12_attn_tp2&#45;&gt;dp1_pp2_layer12_attn_allreduce -->
<g id="edge1027" class="edge">
<title>dp1_pp2_layer12_attn_tp2&#45;&gt;dp1_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M105011.07,-479.02C105034.85,-470.35 105061.99,-460.86 105087,-453.06 105135.74,-437.86 105190.05,-423.03 105237.1,-410.83"/>
<polygon fill="black" stroke="black" points="105238.22,-414.15 105247.03,-408.26 105236.47,-407.38 105238.22,-414.15"/>
</g>
<!-- dp1_pp2_layer12_attn_tp3 -->
<g id="node628" class="node">
<title>dp1_pp2_layer12_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="105926.5,-531.06 105661.5,-531.06 105661.5,-479.06 105926.5,-479.06 105926.5,-531.06"/>
<text text-anchor="middle" x="105794" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="105794" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="105794" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="105794" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer12_attn_tp3&#45;&gt;dp1_pp2_layer12_attn_allreduce -->
<g id="edge1028" class="edge">
<title>dp1_pp2_layer12_attn_tp3&#45;&gt;dp1_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M105729.21,-478.95C105705.43,-470.18 105678.17,-460.64 105653,-453.06 105598.42,-436.63 105537.31,-421.31 105484.86,-409.08"/>
<polygon fill="black" stroke="black" points="105485.37,-405.6 105474.83,-406.75 105483.78,-412.42 105485.37,-405.6"/>
</g>
<!-- dp1_pp2_layer12_expert0 -->
<g id="node630" class="node">
<title>dp1_pp2_layer12_expert0</title>
<polygon fill="lightgreen" stroke="black" points="101158,-406.29 100934,-406.29 100934,-354.29 101158,-354.29 101158,-406.29"/>
<text text-anchor="middle" x="101046" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="101046" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="101046" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="101046" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert0 -->
<g id="edge1029" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102658.73,-499.65C102273.55,-490.26 101448.11,-465.13 101167,-417.06 101154.99,-415.01 101142.48,-412.16 101130.27,-408.95"/>
<polygon fill="black" stroke="black" points="101131.11,-405.56 101120.54,-406.32 101129.28,-412.31 101131.11,-405.56"/>
</g>
<!-- dp1_pp2_layer12_expert1 -->
<g id="node631" class="node">
<title>dp1_pp2_layer12_expert1</title>
<polygon fill="lightgreen" stroke="black" points="101400,-406.29 101176,-406.29 101176,-354.29 101400,-354.29 101400,-406.29"/>
<text text-anchor="middle" x="101288" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="101288" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="101288" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="101288" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert1 -->
<g id="edge1030" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102656.55,-497.55C102314.94,-485.71 101642.58,-458.03 101409,-417.06 101397.08,-414.97 101384.67,-412.12 101372.54,-408.93"/>
<polygon fill="black" stroke="black" points="101373.45,-405.55 101362.89,-406.3 101371.62,-412.3 101373.45,-405.55"/>
</g>
<!-- dp1_pp2_layer12_expert2 -->
<g id="node632" class="node">
<title>dp1_pp2_layer12_expert2</title>
<polygon fill="lightgreen" stroke="black" points="101642,-406.29 101418,-406.29 101418,-354.29 101642,-354.29 101642,-406.29"/>
<text text-anchor="middle" x="101530" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="101530" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="101530" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="101530" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert2 -->
<g id="edge1031" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102661.82,-502.85C102420.66,-498.37 102003.02,-480.97 101651,-417.06 101639.38,-414.95 101627.29,-412.14 101615.44,-409.03"/>
<polygon fill="black" stroke="black" points="101616.13,-405.59 101605.56,-406.34 101614.29,-412.34 101616.13,-405.59"/>
</g>
<!-- dp1_pp2_layer12_expert3 -->
<g id="node633" class="node">
<title>dp1_pp2_layer12_expert3</title>
<polygon fill="lightgreen" stroke="black" points="101884,-406.29 101660,-406.29 101660,-354.29 101884,-354.29 101884,-406.29"/>
<text text-anchor="middle" x="101772" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="101772" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="101772" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="101772" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert3 -->
<g id="edge1032" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102656.36,-497.41C102459.31,-488.25 102153.63,-466.79 101893,-417.06 101881.57,-414.88 101869.67,-412.06 101857.99,-408.97"/>
<polygon fill="black" stroke="black" points="101858.82,-405.57 101848.25,-406.31 101856.98,-412.32 101858.82,-405.57"/>
</g>
<!-- dp1_pp2_layer12_expert4 -->
<g id="node634" class="node">
<title>dp1_pp2_layer12_expert4</title>
<polygon fill="lightgreen" stroke="black" points="102126,-406.29 101902,-406.29 101902,-354.29 102126,-354.29 102126,-406.29"/>
<text text-anchor="middle" x="102014" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="102014" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="102014" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="102014" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert4 -->
<g id="edge1033" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102647.43,-487.98C102501.99,-474.71 102305.64,-452.25 102135,-417.06 102124.05,-414.8 102112.65,-412.02 102101.43,-409.02"/>
<polygon fill="black" stroke="black" points="102102.19,-405.6 102091.62,-406.33 102100.34,-412.35 102102.19,-405.6"/>
</g>
<!-- dp1_pp2_layer12_expert5 -->
<g id="node635" class="node">
<title>dp1_pp2_layer12_expert5</title>
<polygon fill="lightgreen" stroke="black" points="102368,-406.29 102144,-406.29 102144,-354.29 102368,-354.29 102368,-406.29"/>
<text text-anchor="middle" x="102256" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="102256" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="102256" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="102256" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert5 -->
<g id="edge1034" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102627.29,-467.38C102547.5,-453.44 102458,-436.25 102377,-417.06 102366.9,-414.67 102356.4,-411.94 102345.99,-409.07"/>
<polygon fill="black" stroke="black" points="102346.62,-405.62 102336.05,-406.3 102344.74,-412.36 102346.62,-405.62"/>
</g>
<!-- dp1_pp2_layer12_expert6 -->
<g id="node636" class="node">
<title>dp1_pp2_layer12_expert6</title>
<polygon fill="lightgreen" stroke="black" points="102610,-406.29 102386,-406.29 102386,-354.29 102610,-354.29 102610,-406.29"/>
<text text-anchor="middle" x="102498" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="102498" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="102498" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="102498" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert6 -->
<g id="edge1035" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102709.94,-452.97C102666.16,-438.16 102619.94,-422.53 102581.87,-409.66"/>
<polygon fill="black" stroke="black" points="102582.97,-406.33 102572.38,-406.45 102580.73,-412.97 102582.97,-406.33"/>
</g>
<!-- dp1_pp2_layer12_expert7 -->
<g id="node637" class="node">
<title>dp1_pp2_layer12_expert7</title>
<polygon fill="lightgreen" stroke="black" points="102852,-406.29 102628,-406.29 102628,-354.29 102852,-354.29 102852,-406.29"/>
<text text-anchor="middle" x="102740" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="102740" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="102740" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="102740" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert7 -->
<g id="edge1036" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102810.38,-452.71C102797.3,-439.43 102783.58,-425.51 102771.76,-413.52"/>
<polygon fill="black" stroke="black" points="102774.19,-411 102764.68,-406.33 102769.2,-415.91 102774.19,-411"/>
</g>
<!-- dp1_pp2_layer12_expert8 -->
<g id="node638" class="node">
<title>dp1_pp2_layer12_expert8</title>
<polygon fill="lightgreen" stroke="black" points="103094,-406.29 102870,-406.29 102870,-354.29 103094,-354.29 103094,-406.29"/>
<text text-anchor="middle" x="102982" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="102982" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="102982" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="102982" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert8 -->
<g id="edge1037" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M102911.61,-452.71C102924.7,-439.43 102938.42,-425.51 102950.23,-413.52"/>
<polygon fill="black" stroke="black" points="102952.79,-415.91 102957.32,-406.33 102947.81,-411 102952.79,-415.91"/>
</g>
<!-- dp1_pp2_layer12_expert9 -->
<g id="node639" class="node">
<title>dp1_pp2_layer12_expert9</title>
<polygon fill="lightgreen" stroke="black" points="103336,-406.29 103112,-406.29 103112,-354.29 103336,-354.29 103336,-406.29"/>
<text text-anchor="middle" x="103224" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="103224" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="103224" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="103224" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert9 -->
<g id="edge1038" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103008.38,-454.21C103053.29,-439.03 103101.08,-422.86 103140.23,-409.62"/>
<polygon fill="black" stroke="black" points="103141.64,-412.84 103149.99,-406.32 103139.4,-406.21 103141.64,-412.84"/>
</g>
<!-- dp1_pp2_layer12_expert10 -->
<g id="node640" class="node">
<title>dp1_pp2_layer12_expert10</title>
<polygon fill="lightgreen" stroke="black" points="103578,-406.29 103354,-406.29 103354,-354.29 103578,-354.29 103578,-406.29"/>
<text text-anchor="middle" x="103466" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="103466" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="103466" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="103466" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert10 -->
<g id="edge1039" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103031.89,-478.04C103124.98,-462.69 103241.88,-441.49 103345,-417.06 103355.09,-414.67 103365.6,-411.94 103376.01,-409.07"/>
<polygon fill="black" stroke="black" points="103377.26,-412.36 103385.95,-406.3 103375.37,-405.62 103377.26,-412.36"/>
</g>
<!-- dp1_pp2_layer12_expert11 -->
<g id="node641" class="node">
<title>dp1_pp2_layer12_expert11</title>
<polygon fill="lightgreen" stroke="black" points="103820,-406.29 103596,-406.29 103596,-354.29 103820,-354.29 103820,-406.29"/>
<text text-anchor="middle" x="103708" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="103708" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="103708" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="103708" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert11 -->
<g id="edge1040" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103043.99,-490.7C103191.62,-477.88 103404.08,-454.78 103587,-417.06 103597.95,-414.8 103609.35,-412.02 103620.57,-409.02"/>
<polygon fill="black" stroke="black" points="103621.66,-412.35 103630.38,-406.33 103619.81,-405.6 103621.66,-412.35"/>
</g>
<!-- dp1_pp2_layer12_expert12 -->
<g id="node642" class="node">
<title>dp1_pp2_layer12_expert12</title>
<polygon fill="lightgreen" stroke="black" points="104062,-406.29 103838,-406.29 103838,-354.29 104062,-354.29 104062,-406.29"/>
<text text-anchor="middle" x="103950" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="103950" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="103950" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="103950" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert12 -->
<g id="edge1041" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103051.27,-498.07C103247.59,-489.29 103561.95,-468.01 103829,-417.06 103840.43,-414.88 103852.33,-412.06 103864.01,-408.97"/>
<polygon fill="black" stroke="black" points="103865.02,-412.32 103873.75,-406.31 103863.18,-405.57 103865.02,-412.32"/>
</g>
<!-- dp1_pp2_layer12_expert13 -->
<g id="node643" class="node">
<title>dp1_pp2_layer12_expert13</title>
<polygon fill="lightgreen" stroke="black" points="104304,-406.29 104080,-406.29 104080,-354.29 104304,-354.29 104304,-406.29"/>
<text text-anchor="middle" x="104192" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="104192" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="104192" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="104192" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert13 -->
<g id="edge1042" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103055.93,-502.93C103296.42,-498.58 103716.9,-481.35 104071,-417.06 104082.62,-414.95 104094.71,-412.14 104106.56,-409.03"/>
<polygon fill="black" stroke="black" points="104107.7,-412.34 104116.44,-406.34 104105.87,-405.59 104107.7,-412.34"/>
</g>
<!-- dp1_pp2_layer12_expert14 -->
<g id="node644" class="node">
<title>dp1_pp2_layer12_expert14</title>
<polygon fill="lightgreen" stroke="black" points="104546,-406.29 104322,-406.29 104322,-354.29 104546,-354.29 104546,-406.29"/>
<text text-anchor="middle" x="104434" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="104434" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="104434" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="104434" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert14 -->
<g id="edge1043" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103051.32,-498.04C103388.17,-486.48 104076.15,-458.6 104313,-417.06 104324.92,-414.97 104337.32,-412.12 104349.46,-408.93"/>
<polygon fill="black" stroke="black" points="104350.38,-412.3 104359.11,-406.3 104348.54,-405.55 104350.38,-412.3"/>
</g>
<!-- dp1_pp2_layer12_expert15 -->
<g id="node645" class="node">
<title>dp1_pp2_layer12_expert15</title>
<polygon fill="lightgreen" stroke="black" points="104788,-406.29 104564,-406.29 104564,-354.29 104788,-354.29 104788,-406.29"/>
<text text-anchor="middle" x="104676" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="104676" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="104676" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="104676" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert15 -->
<g id="edge1044" class="edge">
<title>dp1_pp2_layer12_router&#45;&gt;dp1_pp2_layer12_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M103052.94,-499.9C103433.49,-490.72 104271.35,-465.57 104555,-417.06 104567.01,-415.01 104579.51,-412.16 104591.73,-408.95"/>
<polygon fill="black" stroke="black" points="104592.72,-412.31 104601.45,-406.32 104590.88,-405.56 104592.72,-412.31"/>
</g>
<!-- dp1_pp2_layer12_expert_agg -->
<g id="node646" class="node">
<title>dp1_pp2_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="103108.57,-307.52 102714.74,-307.52 102613.43,-203.52 103007.26,-203.52 103108.57,-307.52"/>
<text text-anchor="middle" x="102861" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="102861" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="102861" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="102861" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer12_expert0&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1045" class="edge">
<title>dp1_pp2_layer12_expert0&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M101104.07,-354.29C101123.69,-346.92 101145.97,-339.72 101167,-335.52 101446.13,-279.86 102269.93,-263.21 102656.43,-258.4"/>
<polygon fill="black" stroke="black" points="102656.65,-261.9 102666.61,-258.27 102656.57,-254.9 102656.65,-261.9"/>
</g>
<!-- dp1_pp2_layer12_expert1&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1046" class="edge">
<title>dp1_pp2_layer12_expert1&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M101346.39,-354.27C101365.95,-346.95 101388.09,-339.78 101409,-335.52 101641.8,-288.16 102317.09,-267.74 102658.43,-260.24"/>
<polygon fill="black" stroke="black" points="102658.51,-263.74 102668.43,-260.03 102658.35,-256.74 102658.51,-263.74"/>
</g>
<!-- dp1_pp2_layer12_expert2&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1047" class="edge">
<title>dp1_pp2_layer12_expert2&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M101588.73,-354.29C101608.21,-347.01 101630.23,-339.87 101651,-335.52 101837.91,-296.44 102367.54,-273.07 102660.3,-262.78"/>
<polygon fill="black" stroke="black" points="102660.74,-266.27 102670.61,-262.42 102660.5,-259.27 102660.74,-266.27"/>
</g>
<!-- dp1_pp2_layer12_expert3&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1048" class="edge">
<title>dp1_pp2_layer12_expert3&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M101831.39,-354.26C101850.72,-347.07 101872.48,-339.99 101893,-335.52 102151.91,-279.18 102457.7,-262.24 102655.26,-257.56"/>
<polygon fill="black" stroke="black" points="102655.55,-261.06 102665.47,-257.33 102655.39,-254.06 102655.55,-261.06"/>
</g>
<!-- dp1_pp2_layer12_expert4&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1049" class="edge">
<title>dp1_pp2_layer12_expert4&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M102074.39,-354.24C102093.49,-347.2 102114.87,-340.19 102135,-335.52 102310.82,-294.77 102515.6,-274.91 102662.75,-265.31"/>
<polygon fill="black" stroke="black" points="102663.05,-268.8 102672.81,-264.67 102662.6,-261.82 102663.05,-268.8"/>
</g>
<!-- dp1_pp2_layer12_expert5&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1050" class="edge">
<title>dp1_pp2_layer12_expert5&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M102318.42,-354.22C102337.04,-347.42 102357.65,-340.55 102377,-335.52 102474.09,-310.27 102584.34,-291.53 102675.07,-278.65"/>
<polygon fill="black" stroke="black" points="102675.78,-282.09 102685.19,-277.23 102674.8,-275.16 102675.78,-282.09"/>
</g>
<!-- dp1_pp2_layer12_expert6&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1051" class="edge">
<title>dp1_pp2_layer12_expert6&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M102566.02,-354.26C102583.26,-348.03 102601.78,-341.44 102619,-335.52 102645.73,-326.33 102674.21,-316.8 102701.89,-307.67"/>
<polygon fill="black" stroke="black" points="102703.24,-310.91 102711.65,-304.46 102701.06,-304.26 102703.24,-310.91"/>
</g>
<!-- dp1_pp2_layer12_expert7&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1052" class="edge">
<title>dp1_pp2_layer12_expert7&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M102764.78,-354.15C102776.02,-342.74 102789.83,-328.73 102803.45,-314.92"/>
<polygon fill="black" stroke="black" points="102806,-317.31 102810.53,-307.73 102801.02,-312.39 102806,-317.31"/>
</g>
<!-- dp1_pp2_layer12_expert8&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1053" class="edge">
<title>dp1_pp2_layer12_expert8&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M102957.22,-354.15C102945.97,-342.74 102932.16,-328.73 102918.55,-314.92"/>
<polygon fill="black" stroke="black" points="102920.98,-312.39 102911.47,-307.73 102915.99,-317.31 102920.98,-312.39"/>
</g>
<!-- dp1_pp2_layer12_expert9&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1054" class="edge">
<title>dp1_pp2_layer12_expert9&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M103155.98,-354.26C103138.73,-348.03 103120.21,-341.44 103103,-335.52 103079.29,-327.37 103054.21,-318.95 103029.53,-310.78"/>
<polygon fill="black" stroke="black" points="103030.32,-307.36 103019.73,-307.54 103028.12,-314 103030.32,-307.36"/>
</g>
<!-- dp1_pp2_layer12_expert10&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1055" class="edge">
<title>dp1_pp2_layer12_expert10&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M103403.58,-354.22C103384.96,-347.42 103364.35,-340.55 103345,-335.52 103264.99,-314.71 103176.05,-298.33 103096.46,-286"/>
<polygon fill="black" stroke="black" points="103096.71,-282.5 103086.3,-284.44 103095.65,-289.41 103096.71,-282.5"/>
</g>
<!-- dp1_pp2_layer12_expert11&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1056" class="edge">
<title>dp1_pp2_layer12_expert11&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M103647.61,-354.24C103628.51,-347.2 103607.13,-340.19 103587,-335.52 103418.74,-296.53 103223.97,-276.66 103078.55,-266.61"/>
<polygon fill="black" stroke="black" points="103078.38,-263.09 103068.16,-265.9 103077.9,-270.07 103078.38,-263.09"/>
</g>
<!-- dp1_pp2_layer12_expert12&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1057" class="edge">
<title>dp1_pp2_layer12_expert12&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M103890.61,-354.26C103871.28,-347.07 103849.52,-339.99 103829,-335.52 103571.51,-279.49 103267.64,-262.43 103069.99,-257.64"/>
<polygon fill="black" stroke="black" points="103069.86,-254.14 103059.78,-257.4 103069.69,-261.13 103069.86,-254.14"/>
</g>
<!-- dp1_pp2_layer12_expert13&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1058" class="edge">
<title>dp1_pp2_layer12_expert13&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M104133.27,-354.29C104113.79,-347.01 104091.77,-339.87 104071,-335.52 103887.02,-297.05 103370.97,-273.81 103075.63,-263.27"/>
<polygon fill="black" stroke="black" points="103075.33,-259.76 103065.21,-262.9 103075.08,-266.76 103075.33,-259.76"/>
</g>
<!-- dp1_pp2_layer12_expert14&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1059" class="edge">
<title>dp1_pp2_layer12_expert14&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M104375.6,-354.27C104356.05,-346.95 104333.9,-339.78 104313,-335.52 104082.27,-288.58 103416.86,-268.1 103072.74,-260.45"/>
<polygon fill="black" stroke="black" points="103072.73,-256.94 103062.65,-260.22 103072.57,-263.94 103072.73,-256.94"/>
</g>
<!-- dp1_pp2_layer12_expert15&#45;&gt;dp1_pp2_layer12_expert_agg -->
<g id="edge1060" class="edge">
<title>dp1_pp2_layer12_expert15&#45;&gt;dp1_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M104617.93,-354.29C104598.3,-346.92 104576.03,-339.72 104555,-335.52 104277.21,-280.12 103459.98,-263.37 103071.17,-258.47"/>
<polygon fill="black" stroke="black" points="103070.97,-254.97 103060.93,-258.34 103070.88,-261.97 103070.97,-254.97"/>
</g>
<!-- dp1_pp2_layer13_attn_tp0 -->
<g id="node647" class="node">
<title>dp1_pp2_layer13_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="100343.5,-531.06 100078.5,-531.06 100078.5,-479.06 100343.5,-479.06 100343.5,-531.06"/>
<text text-anchor="middle" x="100211" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="100211" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="100211" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="100211" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer12_expert_agg&#45;&gt;dp1_pp2_layer13_attn_tp0 -->
<g id="edge1062" class="edge">
<title>dp1_pp2_layer12_expert_agg&#45;&gt;dp1_pp2_layer13_attn_tp0</title>
<path fill="none" stroke="black" d="M102668.78,-260.41C102248.38,-269.54 101258.17,-294.77 100925,-335.52 100892.8,-339.46 100384.23,-444.29 100353,-453.06 100330.37,-459.41 100306.16,-467.58 100284.26,-475.5"/>
<polygon fill="black" stroke="black" points="100282.89,-472.28 100274.7,-479 100285.29,-478.85 100282.89,-472.28"/>
</g>
<!-- dp1_pp2_layer13_attn_allreduce -->
<g id="node648" class="node">
<title>dp1_pp2_layer13_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="100340" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="100340" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="100340" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="100340" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="100340" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_attn_tp0&#45;&gt;dp1_pp2_layer13_attn_allreduce -->
<g id="edge1063" class="edge">
<title>dp1_pp2_layer13_attn_tp0&#45;&gt;dp1_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M100237.41,-478.92C100254.15,-463 100276.21,-442 100295.58,-423.56"/>
<polygon fill="black" stroke="black" points="100298.03,-426.07 100302.86,-416.64 100293.2,-421 100298.03,-426.07"/>
</g>
<!-- dp1_pp2_layer13_router -->
<g id="node652" class="node">
<title>dp1_pp2_layer13_router</title>
<polygon fill="lightyellow" stroke="black" points="98091.57,-557.06 97697.74,-557.06 97596.43,-453.06 97990.26,-453.06 98091.57,-557.06"/>
<text text-anchor="middle" x="97844" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="97844" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="97844" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="97844" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_attn_allreduce&#45;&gt;dp1_pp2_layer13_router -->
<g id="edge1099" class="edge">
<title>dp1_pp2_layer13_attn_allreduce&#45;&gt;dp1_pp2_layer13_router</title>
<path fill="none" stroke="black" d="M100180.08,-392.38C100068.77,-399.9 99916.89,-409.76 99783,-417.06 99147.5,-451.72 98394.28,-482.59 98042.96,-496.4"/>
<polygon fill="black" stroke="black" points="98042.8,-492.91 98032.94,-496.79 98043.07,-499.9 98042.8,-492.91"/>
</g>
<!-- dp1_pp2_layer13_attn_tp1 -->
<g id="node649" class="node">
<title>dp1_pp2_layer13_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="100626.5,-531.06 100361.5,-531.06 100361.5,-479.06 100626.5,-479.06 100626.5,-531.06"/>
<text text-anchor="middle" x="100494" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="100494" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="100494" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="100494" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer13_attn_tp1&#45;&gt;dp1_pp2_layer13_attn_allreduce -->
<g id="edge1064" class="edge">
<title>dp1_pp2_layer13_attn_tp1&#45;&gt;dp1_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M100462.46,-478.92C100441.99,-462.6 100414.83,-440.94 100391.29,-422.18"/>
<polygon fill="black" stroke="black" points="100393.46,-419.44 100383.46,-415.94 100389.1,-424.91 100393.46,-419.44"/>
</g>
<!-- dp1_pp2_layer13_attn_tp2 -->
<g id="node650" class="node">
<title>dp1_pp2_layer13_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="100060.5,-531.06 99795.5,-531.06 99795.5,-479.06 100060.5,-479.06 100060.5,-531.06"/>
<text text-anchor="middle" x="99928" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="99928" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="99928" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="99928" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer13_attn_tp2&#45;&gt;dp1_pp2_layer13_attn_allreduce -->
<g id="edge1065" class="edge">
<title>dp1_pp2_layer13_attn_tp2&#45;&gt;dp1_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M99994.07,-479.02C100017.85,-470.35 100044.99,-460.86 100070,-453.06 100118.74,-437.86 100173.05,-423.03 100220.1,-410.83"/>
<polygon fill="black" stroke="black" points="100221.22,-414.15 100230.03,-408.26 100219.47,-407.38 100221.22,-414.15"/>
</g>
<!-- dp1_pp2_layer13_attn_tp3 -->
<g id="node651" class="node">
<title>dp1_pp2_layer13_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="100909.5,-531.06 100644.5,-531.06 100644.5,-479.06 100909.5,-479.06 100909.5,-531.06"/>
<text text-anchor="middle" x="100777" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="100777" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="100777" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="100777" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer13_attn_tp3&#45;&gt;dp1_pp2_layer13_attn_allreduce -->
<g id="edge1066" class="edge">
<title>dp1_pp2_layer13_attn_tp3&#45;&gt;dp1_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M100712.21,-478.95C100688.43,-470.18 100661.17,-460.64 100636,-453.06 100581.42,-436.63 100520.31,-421.31 100467.86,-409.08"/>
<polygon fill="black" stroke="black" points="100468.37,-405.6 100457.83,-406.75 100466.78,-412.42 100468.37,-405.6"/>
</g>
<!-- dp1_pp2_layer13_expert0 -->
<g id="node653" class="node">
<title>dp1_pp2_layer13_expert0</title>
<polygon fill="lightgreen" stroke="black" points="96141,-406.29 95917,-406.29 95917,-354.29 96141,-354.29 96141,-406.29"/>
<text text-anchor="middle" x="96029" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="96029" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="96029" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="96029" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert0 -->
<g id="edge1067" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97641.73,-499.65C97256.55,-490.26 96431.11,-465.13 96150,-417.06 96137.99,-415.01 96125.48,-412.16 96113.27,-408.95"/>
<polygon fill="black" stroke="black" points="96114.11,-405.56 96103.54,-406.32 96112.28,-412.31 96114.11,-405.56"/>
</g>
<!-- dp1_pp2_layer13_expert1 -->
<g id="node654" class="node">
<title>dp1_pp2_layer13_expert1</title>
<polygon fill="lightgreen" stroke="black" points="96383,-406.29 96159,-406.29 96159,-354.29 96383,-354.29 96383,-406.29"/>
<text text-anchor="middle" x="96271" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="96271" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="96271" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="96271" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert1 -->
<g id="edge1068" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97639.55,-497.55C97297.94,-485.71 96625.58,-458.03 96392,-417.06 96380.08,-414.97 96367.67,-412.12 96355.54,-408.93"/>
<polygon fill="black" stroke="black" points="96356.45,-405.55 96345.89,-406.3 96354.62,-412.3 96356.45,-405.55"/>
</g>
<!-- dp1_pp2_layer13_expert2 -->
<g id="node655" class="node">
<title>dp1_pp2_layer13_expert2</title>
<polygon fill="lightgreen" stroke="black" points="96625,-406.29 96401,-406.29 96401,-354.29 96625,-354.29 96625,-406.29"/>
<text text-anchor="middle" x="96513" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="96513" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="96513" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="96513" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert2 -->
<g id="edge1069" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97644.82,-502.85C97403.66,-498.37 96986.02,-480.97 96634,-417.06 96622.38,-414.95 96610.29,-412.14 96598.44,-409.03"/>
<polygon fill="black" stroke="black" points="96599.13,-405.59 96588.56,-406.34 96597.29,-412.34 96599.13,-405.59"/>
</g>
<!-- dp1_pp2_layer13_expert3 -->
<g id="node656" class="node">
<title>dp1_pp2_layer13_expert3</title>
<polygon fill="lightgreen" stroke="black" points="96867,-406.29 96643,-406.29 96643,-354.29 96867,-354.29 96867,-406.29"/>
<text text-anchor="middle" x="96755" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="96755" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="96755" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="96755" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert3 -->
<g id="edge1070" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97639.36,-497.41C97442.31,-488.25 97136.63,-466.79 96876,-417.06 96864.57,-414.88 96852.67,-412.06 96840.99,-408.97"/>
<polygon fill="black" stroke="black" points="96841.82,-405.57 96831.25,-406.31 96839.98,-412.32 96841.82,-405.57"/>
</g>
<!-- dp1_pp2_layer13_expert4 -->
<g id="node657" class="node">
<title>dp1_pp2_layer13_expert4</title>
<polygon fill="lightgreen" stroke="black" points="97109,-406.29 96885,-406.29 96885,-354.29 97109,-354.29 97109,-406.29"/>
<text text-anchor="middle" x="96997" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="96997" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="96997" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="96997" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert4 -->
<g id="edge1071" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97630.43,-487.98C97484.99,-474.71 97288.64,-452.25 97118,-417.06 97107.05,-414.8 97095.65,-412.02 97084.43,-409.02"/>
<polygon fill="black" stroke="black" points="97085.19,-405.6 97074.62,-406.33 97083.34,-412.35 97085.19,-405.6"/>
</g>
<!-- dp1_pp2_layer13_expert5 -->
<g id="node658" class="node">
<title>dp1_pp2_layer13_expert5</title>
<polygon fill="lightgreen" stroke="black" points="97351,-406.29 97127,-406.29 97127,-354.29 97351,-354.29 97351,-406.29"/>
<text text-anchor="middle" x="97239" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="97239" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="97239" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="97239" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert5 -->
<g id="edge1072" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97610.29,-467.38C97530.5,-453.44 97441,-436.25 97360,-417.06 97349.9,-414.67 97339.4,-411.94 97328.99,-409.07"/>
<polygon fill="black" stroke="black" points="97329.62,-405.62 97319.05,-406.3 97327.74,-412.36 97329.62,-405.62"/>
</g>
<!-- dp1_pp2_layer13_expert6 -->
<g id="node659" class="node">
<title>dp1_pp2_layer13_expert6</title>
<polygon fill="lightgreen" stroke="black" points="97593,-406.29 97369,-406.29 97369,-354.29 97593,-354.29 97593,-406.29"/>
<text text-anchor="middle" x="97481" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="97481" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="97481" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="97481" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert6 -->
<g id="edge1073" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97692.94,-452.97C97649.16,-438.16 97602.94,-422.53 97564.87,-409.66"/>
<polygon fill="black" stroke="black" points="97565.97,-406.33 97555.38,-406.45 97563.73,-412.97 97565.97,-406.33"/>
</g>
<!-- dp1_pp2_layer13_expert7 -->
<g id="node660" class="node">
<title>dp1_pp2_layer13_expert7</title>
<polygon fill="lightgreen" stroke="black" points="97835,-406.29 97611,-406.29 97611,-354.29 97835,-354.29 97835,-406.29"/>
<text text-anchor="middle" x="97723" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="97723" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="97723" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="97723" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert7 -->
<g id="edge1074" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97793.38,-452.71C97780.3,-439.43 97766.58,-425.51 97754.76,-413.52"/>
<polygon fill="black" stroke="black" points="97757.19,-411 97747.68,-406.33 97752.2,-415.91 97757.19,-411"/>
</g>
<!-- dp1_pp2_layer13_expert8 -->
<g id="node661" class="node">
<title>dp1_pp2_layer13_expert8</title>
<polygon fill="lightgreen" stroke="black" points="98077,-406.29 97853,-406.29 97853,-354.29 98077,-354.29 98077,-406.29"/>
<text text-anchor="middle" x="97965" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="97965" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="97965" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="97965" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert8 -->
<g id="edge1075" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97894.61,-452.71C97907.7,-439.43 97921.42,-425.51 97933.23,-413.52"/>
<polygon fill="black" stroke="black" points="97935.79,-415.91 97940.32,-406.33 97930.81,-411 97935.79,-415.91"/>
</g>
<!-- dp1_pp2_layer13_expert9 -->
<g id="node662" class="node">
<title>dp1_pp2_layer13_expert9</title>
<polygon fill="lightgreen" stroke="black" points="98319,-406.29 98095,-406.29 98095,-354.29 98319,-354.29 98319,-406.29"/>
<text text-anchor="middle" x="98207" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="98207" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="98207" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="98207" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert9 -->
<g id="edge1076" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M97991.38,-454.21C98036.29,-439.03 98084.08,-422.86 98123.23,-409.62"/>
<polygon fill="black" stroke="black" points="98124.64,-412.84 98132.99,-406.32 98122.4,-406.21 98124.64,-412.84"/>
</g>
<!-- dp1_pp2_layer13_expert10 -->
<g id="node663" class="node">
<title>dp1_pp2_layer13_expert10</title>
<polygon fill="lightgreen" stroke="black" points="98561,-406.29 98337,-406.29 98337,-354.29 98561,-354.29 98561,-406.29"/>
<text text-anchor="middle" x="98449" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="98449" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="98449" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="98449" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert10 -->
<g id="edge1077" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98014.89,-478.04C98107.98,-462.69 98224.88,-441.49 98328,-417.06 98338.09,-414.67 98348.6,-411.94 98359.01,-409.07"/>
<polygon fill="black" stroke="black" points="98360.26,-412.36 98368.95,-406.3 98358.37,-405.62 98360.26,-412.36"/>
</g>
<!-- dp1_pp2_layer13_expert11 -->
<g id="node664" class="node">
<title>dp1_pp2_layer13_expert11</title>
<polygon fill="lightgreen" stroke="black" points="98803,-406.29 98579,-406.29 98579,-354.29 98803,-354.29 98803,-406.29"/>
<text text-anchor="middle" x="98691" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="98691" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="98691" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="98691" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert11 -->
<g id="edge1078" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98026.99,-490.7C98174.62,-477.88 98387.08,-454.78 98570,-417.06 98580.95,-414.8 98592.35,-412.02 98603.57,-409.02"/>
<polygon fill="black" stroke="black" points="98604.66,-412.35 98613.38,-406.33 98602.81,-405.6 98604.66,-412.35"/>
</g>
<!-- dp1_pp2_layer13_expert12 -->
<g id="node665" class="node">
<title>dp1_pp2_layer13_expert12</title>
<polygon fill="lightgreen" stroke="black" points="99045,-406.29 98821,-406.29 98821,-354.29 99045,-354.29 99045,-406.29"/>
<text text-anchor="middle" x="98933" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="98933" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="98933" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="98933" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert12 -->
<g id="edge1079" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98034.27,-498.07C98230.59,-489.29 98544.95,-468.01 98812,-417.06 98823.43,-414.88 98835.33,-412.06 98847.01,-408.97"/>
<polygon fill="black" stroke="black" points="98848.02,-412.32 98856.75,-406.31 98846.18,-405.57 98848.02,-412.32"/>
</g>
<!-- dp1_pp2_layer13_expert13 -->
<g id="node666" class="node">
<title>dp1_pp2_layer13_expert13</title>
<polygon fill="lightgreen" stroke="black" points="99287,-406.29 99063,-406.29 99063,-354.29 99287,-354.29 99287,-406.29"/>
<text text-anchor="middle" x="99175" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="99175" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="99175" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="99175" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert13 -->
<g id="edge1080" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98038.93,-502.93C98279.42,-498.58 98699.9,-481.35 99054,-417.06 99065.62,-414.95 99077.71,-412.14 99089.56,-409.03"/>
<polygon fill="black" stroke="black" points="99090.7,-412.34 99099.44,-406.34 99088.87,-405.59 99090.7,-412.34"/>
</g>
<!-- dp1_pp2_layer13_expert14 -->
<g id="node667" class="node">
<title>dp1_pp2_layer13_expert14</title>
<polygon fill="lightgreen" stroke="black" points="99529,-406.29 99305,-406.29 99305,-354.29 99529,-354.29 99529,-406.29"/>
<text text-anchor="middle" x="99417" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="99417" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="99417" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="99417" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert14 -->
<g id="edge1081" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98034.32,-498.04C98371.17,-486.48 99059.15,-458.6 99296,-417.06 99307.92,-414.97 99320.32,-412.12 99332.46,-408.93"/>
<polygon fill="black" stroke="black" points="99333.38,-412.3 99342.11,-406.3 99331.54,-405.55 99333.38,-412.3"/>
</g>
<!-- dp1_pp2_layer13_expert15 -->
<g id="node668" class="node">
<title>dp1_pp2_layer13_expert15</title>
<polygon fill="lightgreen" stroke="black" points="99771,-406.29 99547,-406.29 99547,-354.29 99771,-354.29 99771,-406.29"/>
<text text-anchor="middle" x="99659" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="99659" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="99659" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="99659" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert15 -->
<g id="edge1082" class="edge">
<title>dp1_pp2_layer13_router&#45;&gt;dp1_pp2_layer13_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98035.94,-499.9C98416.49,-490.72 99254.35,-465.57 99538,-417.06 99550.01,-415.01 99562.51,-412.16 99574.73,-408.95"/>
<polygon fill="black" stroke="black" points="99575.72,-412.31 99584.45,-406.32 99573.88,-405.56 99575.72,-412.31"/>
</g>
<!-- dp1_pp2_layer13_expert_agg -->
<g id="node669" class="node">
<title>dp1_pp2_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="98091.57,-307.52 97697.74,-307.52 97596.43,-203.52 97990.26,-203.52 98091.57,-307.52"/>
<text text-anchor="middle" x="97844" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="97844" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="97844" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="97844" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer13_expert0&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1083" class="edge">
<title>dp1_pp2_layer13_expert0&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M96087.07,-354.29C96106.69,-346.92 96128.97,-339.72 96150,-335.52 96429.13,-279.86 97252.93,-263.21 97639.43,-258.4"/>
<polygon fill="black" stroke="black" points="97639.65,-261.9 97649.61,-258.27 97639.57,-254.9 97639.65,-261.9"/>
</g>
<!-- dp1_pp2_layer13_expert1&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1084" class="edge">
<title>dp1_pp2_layer13_expert1&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M96329.39,-354.27C96348.95,-346.95 96371.09,-339.78 96392,-335.52 96624.8,-288.16 97300.09,-267.74 97641.43,-260.24"/>
<polygon fill="black" stroke="black" points="97641.51,-263.74 97651.43,-260.03 97641.35,-256.74 97641.51,-263.74"/>
</g>
<!-- dp1_pp2_layer13_expert2&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1085" class="edge">
<title>dp1_pp2_layer13_expert2&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M96571.73,-354.29C96591.21,-347.01 96613.23,-339.87 96634,-335.52 96820.91,-296.44 97350.54,-273.07 97643.3,-262.78"/>
<polygon fill="black" stroke="black" points="97643.74,-266.27 97653.61,-262.42 97643.5,-259.27 97643.74,-266.27"/>
</g>
<!-- dp1_pp2_layer13_expert3&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1086" class="edge">
<title>dp1_pp2_layer13_expert3&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M96814.39,-354.26C96833.72,-347.07 96855.48,-339.99 96876,-335.52 97134.91,-279.18 97440.7,-262.24 97638.26,-257.56"/>
<polygon fill="black" stroke="black" points="97638.55,-261.06 97648.47,-257.33 97638.39,-254.06 97638.55,-261.06"/>
</g>
<!-- dp1_pp2_layer13_expert4&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1087" class="edge">
<title>dp1_pp2_layer13_expert4&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M97057.39,-354.24C97076.49,-347.2 97097.87,-340.19 97118,-335.52 97293.82,-294.77 97498.6,-274.91 97645.75,-265.31"/>
<polygon fill="black" stroke="black" points="97646.05,-268.8 97655.81,-264.67 97645.6,-261.82 97646.05,-268.8"/>
</g>
<!-- dp1_pp2_layer13_expert5&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1088" class="edge">
<title>dp1_pp2_layer13_expert5&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M97301.42,-354.22C97320.04,-347.42 97340.65,-340.55 97360,-335.52 97457.09,-310.27 97567.34,-291.53 97658.07,-278.65"/>
<polygon fill="black" stroke="black" points="97658.78,-282.09 97668.19,-277.23 97657.8,-275.16 97658.78,-282.09"/>
</g>
<!-- dp1_pp2_layer13_expert6&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1089" class="edge">
<title>dp1_pp2_layer13_expert6&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M97549.02,-354.26C97566.26,-348.03 97584.78,-341.44 97602,-335.52 97628.73,-326.33 97657.21,-316.8 97684.89,-307.67"/>
<polygon fill="black" stroke="black" points="97686.24,-310.91 97694.65,-304.46 97684.06,-304.26 97686.24,-310.91"/>
</g>
<!-- dp1_pp2_layer13_expert7&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1090" class="edge">
<title>dp1_pp2_layer13_expert7&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M97747.78,-354.15C97759.02,-342.74 97772.83,-328.73 97786.45,-314.92"/>
<polygon fill="black" stroke="black" points="97789,-317.31 97793.53,-307.73 97784.02,-312.39 97789,-317.31"/>
</g>
<!-- dp1_pp2_layer13_expert8&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1091" class="edge">
<title>dp1_pp2_layer13_expert8&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M97940.22,-354.15C97928.97,-342.74 97915.16,-328.73 97901.55,-314.92"/>
<polygon fill="black" stroke="black" points="97903.98,-312.39 97894.47,-307.73 97898.99,-317.31 97903.98,-312.39"/>
</g>
<!-- dp1_pp2_layer13_expert9&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1092" class="edge">
<title>dp1_pp2_layer13_expert9&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M98138.98,-354.26C98121.73,-348.03 98103.21,-341.44 98086,-335.52 98062.29,-327.37 98037.21,-318.95 98012.53,-310.78"/>
<polygon fill="black" stroke="black" points="98013.32,-307.36 98002.73,-307.54 98011.12,-314 98013.32,-307.36"/>
</g>
<!-- dp1_pp2_layer13_expert10&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1093" class="edge">
<title>dp1_pp2_layer13_expert10&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M98386.58,-354.22C98367.96,-347.42 98347.35,-340.55 98328,-335.52 98247.99,-314.71 98159.05,-298.33 98079.46,-286"/>
<polygon fill="black" stroke="black" points="98079.71,-282.5 98069.3,-284.44 98078.65,-289.41 98079.71,-282.5"/>
</g>
<!-- dp1_pp2_layer13_expert11&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1094" class="edge">
<title>dp1_pp2_layer13_expert11&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M98630.61,-354.24C98611.51,-347.2 98590.13,-340.19 98570,-335.52 98401.74,-296.53 98206.97,-276.66 98061.55,-266.61"/>
<polygon fill="black" stroke="black" points="98061.38,-263.09 98051.16,-265.9 98060.9,-270.07 98061.38,-263.09"/>
</g>
<!-- dp1_pp2_layer13_expert12&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1095" class="edge">
<title>dp1_pp2_layer13_expert12&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M98873.61,-354.26C98854.28,-347.07 98832.52,-339.99 98812,-335.52 98554.51,-279.49 98250.64,-262.43 98052.99,-257.64"/>
<polygon fill="black" stroke="black" points="98052.86,-254.14 98042.78,-257.4 98052.69,-261.13 98052.86,-254.14"/>
</g>
<!-- dp1_pp2_layer13_expert13&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1096" class="edge">
<title>dp1_pp2_layer13_expert13&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M99116.27,-354.29C99096.79,-347.01 99074.77,-339.87 99054,-335.52 98870.02,-297.05 98353.97,-273.81 98058.63,-263.27"/>
<polygon fill="black" stroke="black" points="98058.33,-259.76 98048.21,-262.9 98058.08,-266.76 98058.33,-259.76"/>
</g>
<!-- dp1_pp2_layer13_expert14&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1097" class="edge">
<title>dp1_pp2_layer13_expert14&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M99358.6,-354.27C99339.05,-346.95 99316.9,-339.78 99296,-335.52 99065.27,-288.58 98399.86,-268.1 98055.74,-260.45"/>
<polygon fill="black" stroke="black" points="98055.73,-256.94 98045.65,-260.22 98055.57,-263.94 98055.73,-256.94"/>
</g>
<!-- dp1_pp2_layer13_expert15&#45;&gt;dp1_pp2_layer13_expert_agg -->
<g id="edge1098" class="edge">
<title>dp1_pp2_layer13_expert15&#45;&gt;dp1_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M99600.93,-354.29C99581.3,-346.92 99559.03,-339.72 99538,-335.52 99260.21,-280.12 98442.98,-263.37 98054.17,-258.47"/>
<polygon fill="black" stroke="black" points="98053.97,-254.97 98043.93,-258.34 98053.88,-261.97 98053.97,-254.97"/>
</g>
<!-- dp1_pp2_layer14_attn_tp0 -->
<g id="node670" class="node">
<title>dp1_pp2_layer14_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="95326.5,-531.06 95061.5,-531.06 95061.5,-479.06 95326.5,-479.06 95326.5,-531.06"/>
<text text-anchor="middle" x="95194" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="95194" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="95194" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="95194" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer13_expert_agg&#45;&gt;dp1_pp2_layer14_attn_tp0 -->
<g id="edge1100" class="edge">
<title>dp1_pp2_layer13_expert_agg&#45;&gt;dp1_pp2_layer14_attn_tp0</title>
<path fill="none" stroke="black" d="M97651.78,-260.41C97231.38,-269.54 96241.17,-294.77 95908,-335.52 95875.8,-339.46 95367.23,-444.29 95336,-453.06 95313.37,-459.41 95289.16,-467.58 95267.26,-475.5"/>
<polygon fill="black" stroke="black" points="95265.89,-472.28 95257.7,-479 95268.29,-478.85 95265.89,-472.28"/>
</g>
<!-- dp1_pp2_layer14_attn_allreduce -->
<g id="node671" class="node">
<title>dp1_pp2_layer14_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="95323" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="95323" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="95323" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="95323" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="95323" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_attn_tp0&#45;&gt;dp1_pp2_layer14_attn_allreduce -->
<g id="edge1101" class="edge">
<title>dp1_pp2_layer14_attn_tp0&#45;&gt;dp1_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M95220.41,-478.92C95237.15,-463 95259.21,-442 95278.58,-423.56"/>
<polygon fill="black" stroke="black" points="95281.03,-426.07 95285.86,-416.64 95276.2,-421 95281.03,-426.07"/>
</g>
<!-- dp1_pp2_layer14_router -->
<g id="node675" class="node">
<title>dp1_pp2_layer14_router</title>
<polygon fill="lightyellow" stroke="black" points="93074.57,-557.06 92680.74,-557.06 92579.43,-453.06 92973.26,-453.06 93074.57,-557.06"/>
<text text-anchor="middle" x="92827" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="92827" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="92827" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="92827" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_attn_allreduce&#45;&gt;dp1_pp2_layer14_router -->
<g id="edge1137" class="edge">
<title>dp1_pp2_layer14_attn_allreduce&#45;&gt;dp1_pp2_layer14_router</title>
<path fill="none" stroke="black" d="M95163.08,-392.38C95051.77,-399.9 94899.89,-409.76 94766,-417.06 94130.5,-451.72 93377.28,-482.59 93025.96,-496.4"/>
<polygon fill="black" stroke="black" points="93025.8,-492.91 93015.94,-496.79 93026.07,-499.9 93025.8,-492.91"/>
</g>
<!-- dp1_pp2_layer14_attn_tp1 -->
<g id="node672" class="node">
<title>dp1_pp2_layer14_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="95609.5,-531.06 95344.5,-531.06 95344.5,-479.06 95609.5,-479.06 95609.5,-531.06"/>
<text text-anchor="middle" x="95477" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="95477" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="95477" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="95477" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer14_attn_tp1&#45;&gt;dp1_pp2_layer14_attn_allreduce -->
<g id="edge1102" class="edge">
<title>dp1_pp2_layer14_attn_tp1&#45;&gt;dp1_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M95445.46,-478.92C95424.99,-462.6 95397.83,-440.94 95374.29,-422.18"/>
<polygon fill="black" stroke="black" points="95376.46,-419.44 95366.46,-415.94 95372.1,-424.91 95376.46,-419.44"/>
</g>
<!-- dp1_pp2_layer14_attn_tp2 -->
<g id="node673" class="node">
<title>dp1_pp2_layer14_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="95043.5,-531.06 94778.5,-531.06 94778.5,-479.06 95043.5,-479.06 95043.5,-531.06"/>
<text text-anchor="middle" x="94911" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="94911" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="94911" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="94911" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer14_attn_tp2&#45;&gt;dp1_pp2_layer14_attn_allreduce -->
<g id="edge1103" class="edge">
<title>dp1_pp2_layer14_attn_tp2&#45;&gt;dp1_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M94977.07,-479.02C95000.85,-470.35 95027.99,-460.86 95053,-453.06 95101.74,-437.86 95156.05,-423.03 95203.1,-410.83"/>
<polygon fill="black" stroke="black" points="95204.22,-414.15 95213.03,-408.26 95202.47,-407.38 95204.22,-414.15"/>
</g>
<!-- dp1_pp2_layer14_attn_tp3 -->
<g id="node674" class="node">
<title>dp1_pp2_layer14_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="95892.5,-531.06 95627.5,-531.06 95627.5,-479.06 95892.5,-479.06 95892.5,-531.06"/>
<text text-anchor="middle" x="95760" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="95760" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="95760" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="95760" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer14_attn_tp3&#45;&gt;dp1_pp2_layer14_attn_allreduce -->
<g id="edge1104" class="edge">
<title>dp1_pp2_layer14_attn_tp3&#45;&gt;dp1_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M95695.21,-478.95C95671.43,-470.18 95644.17,-460.64 95619,-453.06 95564.42,-436.63 95503.31,-421.31 95450.86,-409.08"/>
<polygon fill="black" stroke="black" points="95451.37,-405.6 95440.83,-406.75 95449.78,-412.42 95451.37,-405.6"/>
</g>
<!-- dp1_pp2_layer14_expert0 -->
<g id="node676" class="node">
<title>dp1_pp2_layer14_expert0</title>
<polygon fill="lightgreen" stroke="black" points="91124,-406.29 90900,-406.29 90900,-354.29 91124,-354.29 91124,-406.29"/>
<text text-anchor="middle" x="91012" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="91012" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="91012" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="91012" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert0 -->
<g id="edge1105" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92624.73,-499.65C92239.55,-490.26 91414.11,-465.13 91133,-417.06 91120.99,-415.01 91108.48,-412.16 91096.27,-408.95"/>
<polygon fill="black" stroke="black" points="91097.11,-405.56 91086.54,-406.32 91095.28,-412.31 91097.11,-405.56"/>
</g>
<!-- dp1_pp2_layer14_expert1 -->
<g id="node677" class="node">
<title>dp1_pp2_layer14_expert1</title>
<polygon fill="lightgreen" stroke="black" points="91366,-406.29 91142,-406.29 91142,-354.29 91366,-354.29 91366,-406.29"/>
<text text-anchor="middle" x="91254" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="91254" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="91254" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="91254" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert1 -->
<g id="edge1106" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92622.55,-497.55C92280.94,-485.71 91608.58,-458.03 91375,-417.06 91363.08,-414.97 91350.67,-412.12 91338.54,-408.93"/>
<polygon fill="black" stroke="black" points="91339.45,-405.55 91328.89,-406.3 91337.62,-412.3 91339.45,-405.55"/>
</g>
<!-- dp1_pp2_layer14_expert2 -->
<g id="node678" class="node">
<title>dp1_pp2_layer14_expert2</title>
<polygon fill="lightgreen" stroke="black" points="91608,-406.29 91384,-406.29 91384,-354.29 91608,-354.29 91608,-406.29"/>
<text text-anchor="middle" x="91496" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="91496" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="91496" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="91496" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert2 -->
<g id="edge1107" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92627.82,-502.85C92386.66,-498.37 91969.02,-480.97 91617,-417.06 91605.38,-414.95 91593.29,-412.14 91581.44,-409.03"/>
<polygon fill="black" stroke="black" points="91582.13,-405.59 91571.56,-406.34 91580.29,-412.34 91582.13,-405.59"/>
</g>
<!-- dp1_pp2_layer14_expert3 -->
<g id="node679" class="node">
<title>dp1_pp2_layer14_expert3</title>
<polygon fill="lightgreen" stroke="black" points="91850,-406.29 91626,-406.29 91626,-354.29 91850,-354.29 91850,-406.29"/>
<text text-anchor="middle" x="91738" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="91738" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="91738" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="91738" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert3 -->
<g id="edge1108" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92622.36,-497.41C92425.31,-488.25 92119.63,-466.79 91859,-417.06 91847.57,-414.88 91835.67,-412.06 91823.99,-408.97"/>
<polygon fill="black" stroke="black" points="91824.82,-405.57 91814.25,-406.31 91822.98,-412.32 91824.82,-405.57"/>
</g>
<!-- dp1_pp2_layer14_expert4 -->
<g id="node680" class="node">
<title>dp1_pp2_layer14_expert4</title>
<polygon fill="lightgreen" stroke="black" points="92092,-406.29 91868,-406.29 91868,-354.29 92092,-354.29 92092,-406.29"/>
<text text-anchor="middle" x="91980" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="91980" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="91980" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="91980" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert4 -->
<g id="edge1109" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92613.43,-487.98C92467.99,-474.71 92271.64,-452.25 92101,-417.06 92090.05,-414.8 92078.65,-412.02 92067.43,-409.02"/>
<polygon fill="black" stroke="black" points="92068.19,-405.6 92057.62,-406.33 92066.34,-412.35 92068.19,-405.6"/>
</g>
<!-- dp1_pp2_layer14_expert5 -->
<g id="node681" class="node">
<title>dp1_pp2_layer14_expert5</title>
<polygon fill="lightgreen" stroke="black" points="92334,-406.29 92110,-406.29 92110,-354.29 92334,-354.29 92334,-406.29"/>
<text text-anchor="middle" x="92222" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="92222" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="92222" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="92222" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert5 -->
<g id="edge1110" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92593.29,-467.38C92513.5,-453.44 92424,-436.25 92343,-417.06 92332.9,-414.67 92322.4,-411.94 92311.99,-409.07"/>
<polygon fill="black" stroke="black" points="92312.62,-405.62 92302.05,-406.3 92310.74,-412.36 92312.62,-405.62"/>
</g>
<!-- dp1_pp2_layer14_expert6 -->
<g id="node682" class="node">
<title>dp1_pp2_layer14_expert6</title>
<polygon fill="lightgreen" stroke="black" points="92576,-406.29 92352,-406.29 92352,-354.29 92576,-354.29 92576,-406.29"/>
<text text-anchor="middle" x="92464" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="92464" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="92464" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="92464" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert6 -->
<g id="edge1111" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92675.94,-452.97C92632.16,-438.16 92585.94,-422.53 92547.87,-409.66"/>
<polygon fill="black" stroke="black" points="92548.97,-406.33 92538.38,-406.45 92546.73,-412.97 92548.97,-406.33"/>
</g>
<!-- dp1_pp2_layer14_expert7 -->
<g id="node683" class="node">
<title>dp1_pp2_layer14_expert7</title>
<polygon fill="lightgreen" stroke="black" points="92818,-406.29 92594,-406.29 92594,-354.29 92818,-354.29 92818,-406.29"/>
<text text-anchor="middle" x="92706" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="92706" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="92706" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="92706" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert7 -->
<g id="edge1112" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92776.38,-452.71C92763.3,-439.43 92749.58,-425.51 92737.76,-413.52"/>
<polygon fill="black" stroke="black" points="92740.19,-411 92730.68,-406.33 92735.2,-415.91 92740.19,-411"/>
</g>
<!-- dp1_pp2_layer14_expert8 -->
<g id="node684" class="node">
<title>dp1_pp2_layer14_expert8</title>
<polygon fill="lightgreen" stroke="black" points="93060,-406.29 92836,-406.29 92836,-354.29 93060,-354.29 93060,-406.29"/>
<text text-anchor="middle" x="92948" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="92948" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="92948" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="92948" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert8 -->
<g id="edge1113" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92877.61,-452.71C92890.7,-439.43 92904.42,-425.51 92916.23,-413.52"/>
<polygon fill="black" stroke="black" points="92918.79,-415.91 92923.32,-406.33 92913.81,-411 92918.79,-415.91"/>
</g>
<!-- dp1_pp2_layer14_expert9 -->
<g id="node685" class="node">
<title>dp1_pp2_layer14_expert9</title>
<polygon fill="lightgreen" stroke="black" points="93302,-406.29 93078,-406.29 93078,-354.29 93302,-354.29 93302,-406.29"/>
<text text-anchor="middle" x="93190" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="93190" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="93190" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="93190" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert9 -->
<g id="edge1114" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92974.38,-454.21C93019.29,-439.03 93067.08,-422.86 93106.23,-409.62"/>
<polygon fill="black" stroke="black" points="93107.64,-412.84 93115.99,-406.32 93105.4,-406.21 93107.64,-412.84"/>
</g>
<!-- dp1_pp2_layer14_expert10 -->
<g id="node686" class="node">
<title>dp1_pp2_layer14_expert10</title>
<polygon fill="lightgreen" stroke="black" points="93544,-406.29 93320,-406.29 93320,-354.29 93544,-354.29 93544,-406.29"/>
<text text-anchor="middle" x="93432" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="93432" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="93432" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="93432" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert10 -->
<g id="edge1115" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M92997.89,-478.04C93090.98,-462.69 93207.88,-441.49 93311,-417.06 93321.09,-414.67 93331.6,-411.94 93342.01,-409.07"/>
<polygon fill="black" stroke="black" points="93343.26,-412.36 93351.95,-406.3 93341.37,-405.62 93343.26,-412.36"/>
</g>
<!-- dp1_pp2_layer14_expert11 -->
<g id="node687" class="node">
<title>dp1_pp2_layer14_expert11</title>
<polygon fill="lightgreen" stroke="black" points="93786,-406.29 93562,-406.29 93562,-354.29 93786,-354.29 93786,-406.29"/>
<text text-anchor="middle" x="93674" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="93674" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="93674" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="93674" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert11 -->
<g id="edge1116" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93009.99,-490.7C93157.62,-477.88 93370.08,-454.78 93553,-417.06 93563.95,-414.8 93575.35,-412.02 93586.57,-409.02"/>
<polygon fill="black" stroke="black" points="93587.66,-412.35 93596.38,-406.33 93585.81,-405.6 93587.66,-412.35"/>
</g>
<!-- dp1_pp2_layer14_expert12 -->
<g id="node688" class="node">
<title>dp1_pp2_layer14_expert12</title>
<polygon fill="lightgreen" stroke="black" points="94028,-406.29 93804,-406.29 93804,-354.29 94028,-354.29 94028,-406.29"/>
<text text-anchor="middle" x="93916" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="93916" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="93916" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="93916" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert12 -->
<g id="edge1117" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93017.27,-498.07C93213.59,-489.29 93527.95,-468.01 93795,-417.06 93806.43,-414.88 93818.33,-412.06 93830.01,-408.97"/>
<polygon fill="black" stroke="black" points="93831.02,-412.32 93839.75,-406.31 93829.18,-405.57 93831.02,-412.32"/>
</g>
<!-- dp1_pp2_layer14_expert13 -->
<g id="node689" class="node">
<title>dp1_pp2_layer14_expert13</title>
<polygon fill="lightgreen" stroke="black" points="94270,-406.29 94046,-406.29 94046,-354.29 94270,-354.29 94270,-406.29"/>
<text text-anchor="middle" x="94158" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="94158" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="94158" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="94158" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert13 -->
<g id="edge1118" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93021.93,-502.93C93262.42,-498.58 93682.9,-481.35 94037,-417.06 94048.62,-414.95 94060.71,-412.14 94072.56,-409.03"/>
<polygon fill="black" stroke="black" points="94073.7,-412.34 94082.44,-406.34 94071.87,-405.59 94073.7,-412.34"/>
</g>
<!-- dp1_pp2_layer14_expert14 -->
<g id="node690" class="node">
<title>dp1_pp2_layer14_expert14</title>
<polygon fill="lightgreen" stroke="black" points="94512,-406.29 94288,-406.29 94288,-354.29 94512,-354.29 94512,-406.29"/>
<text text-anchor="middle" x="94400" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="94400" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="94400" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="94400" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert14 -->
<g id="edge1119" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93017.32,-498.04C93354.17,-486.48 94042.15,-458.6 94279,-417.06 94290.92,-414.97 94303.32,-412.12 94315.46,-408.93"/>
<polygon fill="black" stroke="black" points="94316.38,-412.3 94325.11,-406.3 94314.54,-405.55 94316.38,-412.3"/>
</g>
<!-- dp1_pp2_layer14_expert15 -->
<g id="node691" class="node">
<title>dp1_pp2_layer14_expert15</title>
<polygon fill="lightgreen" stroke="black" points="94754,-406.29 94530,-406.29 94530,-354.29 94754,-354.29 94754,-406.29"/>
<text text-anchor="middle" x="94642" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="94642" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="94642" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="94642" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert15 -->
<g id="edge1120" class="edge">
<title>dp1_pp2_layer14_router&#45;&gt;dp1_pp2_layer14_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M93018.94,-499.9C93399.49,-490.72 94237.35,-465.57 94521,-417.06 94533.01,-415.01 94545.51,-412.16 94557.73,-408.95"/>
<polygon fill="black" stroke="black" points="94558.72,-412.31 94567.45,-406.32 94556.88,-405.56 94558.72,-412.31"/>
</g>
<!-- dp1_pp2_layer14_expert_agg -->
<g id="node692" class="node">
<title>dp1_pp2_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="93074.57,-307.52 92680.74,-307.52 92579.43,-203.52 92973.26,-203.52 93074.57,-307.52"/>
<text text-anchor="middle" x="92827" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="92827" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="92827" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="92827" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer14_expert0&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1121" class="edge">
<title>dp1_pp2_layer14_expert0&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M91070.07,-354.29C91089.69,-346.92 91111.97,-339.72 91133,-335.52 91412.13,-279.86 92235.93,-263.21 92622.43,-258.4"/>
<polygon fill="black" stroke="black" points="92622.65,-261.9 92632.61,-258.27 92622.57,-254.9 92622.65,-261.9"/>
</g>
<!-- dp1_pp2_layer14_expert1&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1122" class="edge">
<title>dp1_pp2_layer14_expert1&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M91312.39,-354.27C91331.95,-346.95 91354.09,-339.78 91375,-335.52 91607.8,-288.16 92283.09,-267.74 92624.43,-260.24"/>
<polygon fill="black" stroke="black" points="92624.51,-263.74 92634.43,-260.03 92624.35,-256.74 92624.51,-263.74"/>
</g>
<!-- dp1_pp2_layer14_expert2&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1123" class="edge">
<title>dp1_pp2_layer14_expert2&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M91554.73,-354.29C91574.21,-347.01 91596.23,-339.87 91617,-335.52 91803.91,-296.44 92333.54,-273.07 92626.3,-262.78"/>
<polygon fill="black" stroke="black" points="92626.74,-266.27 92636.61,-262.42 92626.5,-259.27 92626.74,-266.27"/>
</g>
<!-- dp1_pp2_layer14_expert3&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1124" class="edge">
<title>dp1_pp2_layer14_expert3&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M91797.39,-354.26C91816.72,-347.07 91838.48,-339.99 91859,-335.52 92117.91,-279.18 92423.7,-262.24 92621.26,-257.56"/>
<polygon fill="black" stroke="black" points="92621.55,-261.06 92631.47,-257.33 92621.39,-254.06 92621.55,-261.06"/>
</g>
<!-- dp1_pp2_layer14_expert4&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1125" class="edge">
<title>dp1_pp2_layer14_expert4&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M92040.39,-354.24C92059.49,-347.2 92080.87,-340.19 92101,-335.52 92276.82,-294.77 92481.6,-274.91 92628.75,-265.31"/>
<polygon fill="black" stroke="black" points="92629.05,-268.8 92638.81,-264.67 92628.6,-261.82 92629.05,-268.8"/>
</g>
<!-- dp1_pp2_layer14_expert5&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1126" class="edge">
<title>dp1_pp2_layer14_expert5&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M92284.42,-354.22C92303.04,-347.42 92323.65,-340.55 92343,-335.52 92440.09,-310.27 92550.34,-291.53 92641.07,-278.65"/>
<polygon fill="black" stroke="black" points="92641.78,-282.09 92651.19,-277.23 92640.8,-275.16 92641.78,-282.09"/>
</g>
<!-- dp1_pp2_layer14_expert6&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1127" class="edge">
<title>dp1_pp2_layer14_expert6&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M92532.02,-354.26C92549.26,-348.03 92567.78,-341.44 92585,-335.52 92611.73,-326.33 92640.21,-316.8 92667.89,-307.67"/>
<polygon fill="black" stroke="black" points="92669.24,-310.91 92677.65,-304.46 92667.06,-304.26 92669.24,-310.91"/>
</g>
<!-- dp1_pp2_layer14_expert7&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1128" class="edge">
<title>dp1_pp2_layer14_expert7&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M92730.78,-354.15C92742.02,-342.74 92755.83,-328.73 92769.45,-314.92"/>
<polygon fill="black" stroke="black" points="92772,-317.31 92776.53,-307.73 92767.02,-312.39 92772,-317.31"/>
</g>
<!-- dp1_pp2_layer14_expert8&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1129" class="edge">
<title>dp1_pp2_layer14_expert8&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M92923.22,-354.15C92911.97,-342.74 92898.16,-328.73 92884.55,-314.92"/>
<polygon fill="black" stroke="black" points="92886.98,-312.39 92877.47,-307.73 92881.99,-317.31 92886.98,-312.39"/>
</g>
<!-- dp1_pp2_layer14_expert9&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1130" class="edge">
<title>dp1_pp2_layer14_expert9&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M93121.98,-354.26C93104.73,-348.03 93086.21,-341.44 93069,-335.52 93045.29,-327.37 93020.21,-318.95 92995.53,-310.78"/>
<polygon fill="black" stroke="black" points="92996.32,-307.36 92985.73,-307.54 92994.12,-314 92996.32,-307.36"/>
</g>
<!-- dp1_pp2_layer14_expert10&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1131" class="edge">
<title>dp1_pp2_layer14_expert10&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M93369.58,-354.22C93350.96,-347.42 93330.35,-340.55 93311,-335.52 93230.99,-314.71 93142.05,-298.33 93062.46,-286"/>
<polygon fill="black" stroke="black" points="93062.71,-282.5 93052.3,-284.44 93061.65,-289.41 93062.71,-282.5"/>
</g>
<!-- dp1_pp2_layer14_expert11&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1132" class="edge">
<title>dp1_pp2_layer14_expert11&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M93613.61,-354.24C93594.51,-347.2 93573.13,-340.19 93553,-335.52 93384.74,-296.53 93189.97,-276.66 93044.55,-266.61"/>
<polygon fill="black" stroke="black" points="93044.38,-263.09 93034.16,-265.9 93043.9,-270.07 93044.38,-263.09"/>
</g>
<!-- dp1_pp2_layer14_expert12&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1133" class="edge">
<title>dp1_pp2_layer14_expert12&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M93856.61,-354.26C93837.28,-347.07 93815.52,-339.99 93795,-335.52 93537.51,-279.49 93233.64,-262.43 93035.99,-257.64"/>
<polygon fill="black" stroke="black" points="93035.86,-254.14 93025.78,-257.4 93035.69,-261.13 93035.86,-254.14"/>
</g>
<!-- dp1_pp2_layer14_expert13&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1134" class="edge">
<title>dp1_pp2_layer14_expert13&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M94099.27,-354.29C94079.79,-347.01 94057.77,-339.87 94037,-335.52 93853.02,-297.05 93336.97,-273.81 93041.63,-263.27"/>
<polygon fill="black" stroke="black" points="93041.33,-259.76 93031.21,-262.9 93041.08,-266.76 93041.33,-259.76"/>
</g>
<!-- dp1_pp2_layer14_expert14&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1135" class="edge">
<title>dp1_pp2_layer14_expert14&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M94341.6,-354.27C94322.05,-346.95 94299.9,-339.78 94279,-335.52 94048.27,-288.58 93382.86,-268.1 93038.74,-260.45"/>
<polygon fill="black" stroke="black" points="93038.73,-256.94 93028.65,-260.22 93038.57,-263.94 93038.73,-256.94"/>
</g>
<!-- dp1_pp2_layer14_expert15&#45;&gt;dp1_pp2_layer14_expert_agg -->
<g id="edge1136" class="edge">
<title>dp1_pp2_layer14_expert15&#45;&gt;dp1_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M94583.93,-354.29C94564.3,-346.92 94542.03,-339.72 94521,-335.52 94243.21,-280.12 93425.98,-263.37 93037.17,-258.47"/>
<polygon fill="black" stroke="black" points="93036.97,-254.97 93026.93,-258.34 93036.88,-261.97 93036.97,-254.97"/>
</g>
<!-- dp1_pp2_layer15_attn_tp0 -->
<g id="node693" class="node">
<title>dp1_pp2_layer15_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="90309.5,-531.06 90044.5,-531.06 90044.5,-479.06 90309.5,-479.06 90309.5,-531.06"/>
<text text-anchor="middle" x="90177" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="90177" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="90177" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="90177" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer14_expert_agg&#45;&gt;dp1_pp2_layer15_attn_tp0 -->
<g id="edge1138" class="edge">
<title>dp1_pp2_layer14_expert_agg&#45;&gt;dp1_pp2_layer15_attn_tp0</title>
<path fill="none" stroke="black" d="M92634.78,-260.41C92214.38,-269.54 91224.17,-294.77 90891,-335.52 90858.8,-339.46 90350.23,-444.29 90319,-453.06 90296.37,-459.41 90272.16,-467.58 90250.26,-475.5"/>
<polygon fill="black" stroke="black" points="90248.89,-472.28 90240.7,-479 90251.29,-478.85 90248.89,-472.28"/>
</g>
<!-- dp1_pp2_layer15_attn_allreduce -->
<g id="node694" class="node">
<title>dp1_pp2_layer15_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="90306" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="90306" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="90306" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="90306" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="90306" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_attn_tp0&#45;&gt;dp1_pp2_layer15_attn_allreduce -->
<g id="edge1139" class="edge">
<title>dp1_pp2_layer15_attn_tp0&#45;&gt;dp1_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M90203.41,-478.92C90220.15,-463 90242.21,-442 90261.58,-423.56"/>
<polygon fill="black" stroke="black" points="90264.03,-426.07 90268.86,-416.64 90259.2,-421 90264.03,-426.07"/>
</g>
<!-- dp1_pp2_layer15_router -->
<g id="node698" class="node">
<title>dp1_pp2_layer15_router</title>
<polygon fill="lightyellow" stroke="black" points="88057.57,-557.06 87663.74,-557.06 87562.43,-453.06 87956.26,-453.06 88057.57,-557.06"/>
<text text-anchor="middle" x="87810" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="87810" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="87810" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="87810" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_attn_allreduce&#45;&gt;dp1_pp2_layer15_router -->
<g id="edge1175" class="edge">
<title>dp1_pp2_layer15_attn_allreduce&#45;&gt;dp1_pp2_layer15_router</title>
<path fill="none" stroke="black" d="M90146.08,-392.38C90034.77,-399.9 89882.89,-409.76 89749,-417.06 89113.5,-451.72 88360.28,-482.59 88008.96,-496.4"/>
<polygon fill="black" stroke="black" points="88008.8,-492.91 87998.94,-496.79 88009.07,-499.9 88008.8,-492.91"/>
</g>
<!-- dp1_pp2_layer15_attn_tp1 -->
<g id="node695" class="node">
<title>dp1_pp2_layer15_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="90592.5,-531.06 90327.5,-531.06 90327.5,-479.06 90592.5,-479.06 90592.5,-531.06"/>
<text text-anchor="middle" x="90460" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="90460" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="90460" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="90460" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer15_attn_tp1&#45;&gt;dp1_pp2_layer15_attn_allreduce -->
<g id="edge1140" class="edge">
<title>dp1_pp2_layer15_attn_tp1&#45;&gt;dp1_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M90428.46,-478.92C90407.99,-462.6 90380.83,-440.94 90357.29,-422.18"/>
<polygon fill="black" stroke="black" points="90359.46,-419.44 90349.46,-415.94 90355.1,-424.91 90359.46,-419.44"/>
</g>
<!-- dp1_pp2_layer15_attn_tp2 -->
<g id="node696" class="node">
<title>dp1_pp2_layer15_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="90026.5,-531.06 89761.5,-531.06 89761.5,-479.06 90026.5,-479.06 90026.5,-531.06"/>
<text text-anchor="middle" x="89894" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="89894" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="89894" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="89894" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer15_attn_tp2&#45;&gt;dp1_pp2_layer15_attn_allreduce -->
<g id="edge1141" class="edge">
<title>dp1_pp2_layer15_attn_tp2&#45;&gt;dp1_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M89960.07,-479.02C89983.85,-470.35 90010.99,-460.86 90036,-453.06 90084.74,-437.86 90139.05,-423.03 90186.1,-410.83"/>
<polygon fill="black" stroke="black" points="90187.22,-414.15 90196.03,-408.26 90185.47,-407.38 90187.22,-414.15"/>
</g>
<!-- dp1_pp2_layer15_attn_tp3 -->
<g id="node697" class="node">
<title>dp1_pp2_layer15_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="90875.5,-531.06 90610.5,-531.06 90610.5,-479.06 90875.5,-479.06 90875.5,-531.06"/>
<text text-anchor="middle" x="90743" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="90743" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="90743" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="90743" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer15_attn_tp3&#45;&gt;dp1_pp2_layer15_attn_allreduce -->
<g id="edge1142" class="edge">
<title>dp1_pp2_layer15_attn_tp3&#45;&gt;dp1_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M90678.21,-478.95C90654.43,-470.18 90627.17,-460.64 90602,-453.06 90547.42,-436.63 90486.31,-421.31 90433.86,-409.08"/>
<polygon fill="black" stroke="black" points="90434.37,-405.6 90423.83,-406.75 90432.78,-412.42 90434.37,-405.6"/>
</g>
<!-- dp1_pp2_layer15_expert0 -->
<g id="node699" class="node">
<title>dp1_pp2_layer15_expert0</title>
<polygon fill="lightgreen" stroke="black" points="86107,-406.29 85883,-406.29 85883,-354.29 86107,-354.29 86107,-406.29"/>
<text text-anchor="middle" x="85995" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="85995" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="85995" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="85995" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert0 -->
<g id="edge1143" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87607.73,-499.65C87222.55,-490.26 86397.11,-465.13 86116,-417.06 86103.99,-415.01 86091.48,-412.16 86079.27,-408.95"/>
<polygon fill="black" stroke="black" points="86080.11,-405.56 86069.54,-406.32 86078.28,-412.31 86080.11,-405.56"/>
</g>
<!-- dp1_pp2_layer15_expert1 -->
<g id="node700" class="node">
<title>dp1_pp2_layer15_expert1</title>
<polygon fill="lightgreen" stroke="black" points="86349,-406.29 86125,-406.29 86125,-354.29 86349,-354.29 86349,-406.29"/>
<text text-anchor="middle" x="86237" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="86237" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="86237" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="86237" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert1 -->
<g id="edge1144" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87605.55,-497.55C87263.94,-485.71 86591.58,-458.03 86358,-417.06 86346.08,-414.97 86333.67,-412.12 86321.54,-408.93"/>
<polygon fill="black" stroke="black" points="86322.45,-405.55 86311.89,-406.3 86320.62,-412.3 86322.45,-405.55"/>
</g>
<!-- dp1_pp2_layer15_expert2 -->
<g id="node701" class="node">
<title>dp1_pp2_layer15_expert2</title>
<polygon fill="lightgreen" stroke="black" points="86591,-406.29 86367,-406.29 86367,-354.29 86591,-354.29 86591,-406.29"/>
<text text-anchor="middle" x="86479" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="86479" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="86479" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="86479" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert2 -->
<g id="edge1145" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87610.82,-502.85C87369.66,-498.37 86952.02,-480.97 86600,-417.06 86588.38,-414.95 86576.29,-412.14 86564.44,-409.03"/>
<polygon fill="black" stroke="black" points="86565.13,-405.59 86554.56,-406.34 86563.29,-412.34 86565.13,-405.59"/>
</g>
<!-- dp1_pp2_layer15_expert3 -->
<g id="node702" class="node">
<title>dp1_pp2_layer15_expert3</title>
<polygon fill="lightgreen" stroke="black" points="86833,-406.29 86609,-406.29 86609,-354.29 86833,-354.29 86833,-406.29"/>
<text text-anchor="middle" x="86721" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="86721" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="86721" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="86721" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert3 -->
<g id="edge1146" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87605.36,-497.41C87408.31,-488.25 87102.63,-466.79 86842,-417.06 86830.57,-414.88 86818.67,-412.06 86806.99,-408.97"/>
<polygon fill="black" stroke="black" points="86807.82,-405.57 86797.25,-406.31 86805.98,-412.32 86807.82,-405.57"/>
</g>
<!-- dp1_pp2_layer15_expert4 -->
<g id="node703" class="node">
<title>dp1_pp2_layer15_expert4</title>
<polygon fill="lightgreen" stroke="black" points="87075,-406.29 86851,-406.29 86851,-354.29 87075,-354.29 87075,-406.29"/>
<text text-anchor="middle" x="86963" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="86963" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="86963" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="86963" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert4 -->
<g id="edge1147" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87596.43,-487.98C87450.99,-474.71 87254.64,-452.25 87084,-417.06 87073.05,-414.8 87061.65,-412.02 87050.43,-409.02"/>
<polygon fill="black" stroke="black" points="87051.19,-405.6 87040.62,-406.33 87049.34,-412.35 87051.19,-405.6"/>
</g>
<!-- dp1_pp2_layer15_expert5 -->
<g id="node704" class="node">
<title>dp1_pp2_layer15_expert5</title>
<polygon fill="lightgreen" stroke="black" points="87317,-406.29 87093,-406.29 87093,-354.29 87317,-354.29 87317,-406.29"/>
<text text-anchor="middle" x="87205" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="87205" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="87205" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="87205" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert5 -->
<g id="edge1148" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87576.29,-467.38C87496.5,-453.44 87407,-436.25 87326,-417.06 87315.9,-414.67 87305.4,-411.94 87294.99,-409.07"/>
<polygon fill="black" stroke="black" points="87295.62,-405.62 87285.05,-406.3 87293.74,-412.36 87295.62,-405.62"/>
</g>
<!-- dp1_pp2_layer15_expert6 -->
<g id="node705" class="node">
<title>dp1_pp2_layer15_expert6</title>
<polygon fill="lightgreen" stroke="black" points="87559,-406.29 87335,-406.29 87335,-354.29 87559,-354.29 87559,-406.29"/>
<text text-anchor="middle" x="87447" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="87447" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="87447" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="87447" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert6 -->
<g id="edge1149" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87658.94,-452.97C87615.16,-438.16 87568.94,-422.53 87530.87,-409.66"/>
<polygon fill="black" stroke="black" points="87531.97,-406.33 87521.38,-406.45 87529.73,-412.97 87531.97,-406.33"/>
</g>
<!-- dp1_pp2_layer15_expert7 -->
<g id="node706" class="node">
<title>dp1_pp2_layer15_expert7</title>
<polygon fill="lightgreen" stroke="black" points="87801,-406.29 87577,-406.29 87577,-354.29 87801,-354.29 87801,-406.29"/>
<text text-anchor="middle" x="87689" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="87689" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="87689" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="87689" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert7 -->
<g id="edge1150" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87759.38,-452.71C87746.3,-439.43 87732.58,-425.51 87720.76,-413.52"/>
<polygon fill="black" stroke="black" points="87723.19,-411 87713.68,-406.33 87718.2,-415.91 87723.19,-411"/>
</g>
<!-- dp1_pp2_layer15_expert8 -->
<g id="node707" class="node">
<title>dp1_pp2_layer15_expert8</title>
<polygon fill="lightgreen" stroke="black" points="88043,-406.29 87819,-406.29 87819,-354.29 88043,-354.29 88043,-406.29"/>
<text text-anchor="middle" x="87931" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="87931" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="87931" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="87931" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert8 -->
<g id="edge1151" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87860.61,-452.71C87873.7,-439.43 87887.42,-425.51 87899.23,-413.52"/>
<polygon fill="black" stroke="black" points="87901.79,-415.91 87906.32,-406.33 87896.81,-411 87901.79,-415.91"/>
</g>
<!-- dp1_pp2_layer15_expert9 -->
<g id="node708" class="node">
<title>dp1_pp2_layer15_expert9</title>
<polygon fill="lightgreen" stroke="black" points="88285,-406.29 88061,-406.29 88061,-354.29 88285,-354.29 88285,-406.29"/>
<text text-anchor="middle" x="88173" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="88173" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="88173" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="88173" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert9 -->
<g id="edge1152" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87957.38,-454.21C88002.29,-439.03 88050.08,-422.86 88089.23,-409.62"/>
<polygon fill="black" stroke="black" points="88090.64,-412.84 88098.99,-406.32 88088.4,-406.21 88090.64,-412.84"/>
</g>
<!-- dp1_pp2_layer15_expert10 -->
<g id="node709" class="node">
<title>dp1_pp2_layer15_expert10</title>
<polygon fill="lightgreen" stroke="black" points="88527,-406.29 88303,-406.29 88303,-354.29 88527,-354.29 88527,-406.29"/>
<text text-anchor="middle" x="88415" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="88415" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="88415" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="88415" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert10 -->
<g id="edge1153" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87980.89,-478.04C88073.98,-462.69 88190.88,-441.49 88294,-417.06 88304.09,-414.67 88314.6,-411.94 88325.01,-409.07"/>
<polygon fill="black" stroke="black" points="88326.26,-412.36 88334.95,-406.3 88324.37,-405.62 88326.26,-412.36"/>
</g>
<!-- dp1_pp2_layer15_expert11 -->
<g id="node710" class="node">
<title>dp1_pp2_layer15_expert11</title>
<polygon fill="lightgreen" stroke="black" points="88769,-406.29 88545,-406.29 88545,-354.29 88769,-354.29 88769,-406.29"/>
<text text-anchor="middle" x="88657" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="88657" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="88657" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="88657" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert11 -->
<g id="edge1154" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M87992.99,-490.7C88140.62,-477.88 88353.08,-454.78 88536,-417.06 88546.95,-414.8 88558.35,-412.02 88569.57,-409.02"/>
<polygon fill="black" stroke="black" points="88570.66,-412.35 88579.38,-406.33 88568.81,-405.6 88570.66,-412.35"/>
</g>
<!-- dp1_pp2_layer15_expert12 -->
<g id="node711" class="node">
<title>dp1_pp2_layer15_expert12</title>
<polygon fill="lightgreen" stroke="black" points="89011,-406.29 88787,-406.29 88787,-354.29 89011,-354.29 89011,-406.29"/>
<text text-anchor="middle" x="88899" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="88899" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="88899" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="88899" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert12 -->
<g id="edge1155" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88000.27,-498.07C88196.59,-489.29 88510.95,-468.01 88778,-417.06 88789.43,-414.88 88801.33,-412.06 88813.01,-408.97"/>
<polygon fill="black" stroke="black" points="88814.02,-412.32 88822.75,-406.31 88812.18,-405.57 88814.02,-412.32"/>
</g>
<!-- dp1_pp2_layer15_expert13 -->
<g id="node712" class="node">
<title>dp1_pp2_layer15_expert13</title>
<polygon fill="lightgreen" stroke="black" points="89253,-406.29 89029,-406.29 89029,-354.29 89253,-354.29 89253,-406.29"/>
<text text-anchor="middle" x="89141" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="89141" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="89141" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="89141" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert13 -->
<g id="edge1156" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88004.93,-502.93C88245.42,-498.58 88665.9,-481.35 89020,-417.06 89031.62,-414.95 89043.71,-412.14 89055.56,-409.03"/>
<polygon fill="black" stroke="black" points="89056.7,-412.34 89065.44,-406.34 89054.87,-405.59 89056.7,-412.34"/>
</g>
<!-- dp1_pp2_layer15_expert14 -->
<g id="node713" class="node">
<title>dp1_pp2_layer15_expert14</title>
<polygon fill="lightgreen" stroke="black" points="89495,-406.29 89271,-406.29 89271,-354.29 89495,-354.29 89495,-406.29"/>
<text text-anchor="middle" x="89383" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="89383" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="89383" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="89383" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert14 -->
<g id="edge1157" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88000.32,-498.04C88337.17,-486.48 89025.15,-458.6 89262,-417.06 89273.92,-414.97 89286.32,-412.12 89298.46,-408.93"/>
<polygon fill="black" stroke="black" points="89299.38,-412.3 89308.11,-406.3 89297.54,-405.55 89299.38,-412.3"/>
</g>
<!-- dp1_pp2_layer15_expert15 -->
<g id="node714" class="node">
<title>dp1_pp2_layer15_expert15</title>
<polygon fill="lightgreen" stroke="black" points="89737,-406.29 89513,-406.29 89513,-354.29 89737,-354.29 89737,-406.29"/>
<text text-anchor="middle" x="89625" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="89625" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="89625" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="89625" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert15 -->
<g id="edge1158" class="edge">
<title>dp1_pp2_layer15_router&#45;&gt;dp1_pp2_layer15_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M88001.94,-499.9C88382.49,-490.72 89220.35,-465.57 89504,-417.06 89516.01,-415.01 89528.51,-412.16 89540.73,-408.95"/>
<polygon fill="black" stroke="black" points="89541.72,-412.31 89550.45,-406.32 89539.88,-405.56 89541.72,-412.31"/>
</g>
<!-- dp1_pp2_layer15_expert_agg -->
<g id="node715" class="node">
<title>dp1_pp2_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="88057.57,-307.52 87663.74,-307.52 87562.43,-203.52 87956.26,-203.52 88057.57,-307.52"/>
<text text-anchor="middle" x="87810" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="87810" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="87810" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="87810" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer15_expert0&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1159" class="edge">
<title>dp1_pp2_layer15_expert0&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M86053.07,-354.29C86072.69,-346.92 86094.97,-339.72 86116,-335.52 86395.13,-279.86 87218.93,-263.21 87605.43,-258.4"/>
<polygon fill="black" stroke="black" points="87605.65,-261.9 87615.61,-258.27 87605.57,-254.9 87605.65,-261.9"/>
</g>
<!-- dp1_pp2_layer15_expert1&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1160" class="edge">
<title>dp1_pp2_layer15_expert1&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M86295.39,-354.27C86314.95,-346.95 86337.09,-339.78 86358,-335.52 86590.8,-288.16 87266.09,-267.74 87607.43,-260.24"/>
<polygon fill="black" stroke="black" points="87607.51,-263.74 87617.43,-260.03 87607.35,-256.74 87607.51,-263.74"/>
</g>
<!-- dp1_pp2_layer15_expert2&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1161" class="edge">
<title>dp1_pp2_layer15_expert2&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M86537.73,-354.29C86557.21,-347.01 86579.23,-339.87 86600,-335.52 86786.91,-296.44 87316.54,-273.07 87609.3,-262.78"/>
<polygon fill="black" stroke="black" points="87609.74,-266.27 87619.61,-262.42 87609.5,-259.27 87609.74,-266.27"/>
</g>
<!-- dp1_pp2_layer15_expert3&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1162" class="edge">
<title>dp1_pp2_layer15_expert3&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M86780.39,-354.26C86799.72,-347.07 86821.48,-339.99 86842,-335.52 87100.91,-279.18 87406.7,-262.24 87604.26,-257.56"/>
<polygon fill="black" stroke="black" points="87604.55,-261.06 87614.47,-257.33 87604.39,-254.06 87604.55,-261.06"/>
</g>
<!-- dp1_pp2_layer15_expert4&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1163" class="edge">
<title>dp1_pp2_layer15_expert4&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M87023.39,-354.24C87042.49,-347.2 87063.87,-340.19 87084,-335.52 87259.82,-294.77 87464.6,-274.91 87611.75,-265.31"/>
<polygon fill="black" stroke="black" points="87612.05,-268.8 87621.81,-264.67 87611.6,-261.82 87612.05,-268.8"/>
</g>
<!-- dp1_pp2_layer15_expert5&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1164" class="edge">
<title>dp1_pp2_layer15_expert5&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M87267.42,-354.22C87286.04,-347.42 87306.65,-340.55 87326,-335.52 87423.09,-310.27 87533.34,-291.53 87624.07,-278.65"/>
<polygon fill="black" stroke="black" points="87624.78,-282.09 87634.19,-277.23 87623.8,-275.16 87624.78,-282.09"/>
</g>
<!-- dp1_pp2_layer15_expert6&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1165" class="edge">
<title>dp1_pp2_layer15_expert6&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M87515.02,-354.26C87532.26,-348.03 87550.78,-341.44 87568,-335.52 87594.73,-326.33 87623.21,-316.8 87650.89,-307.67"/>
<polygon fill="black" stroke="black" points="87652.24,-310.91 87660.65,-304.46 87650.06,-304.26 87652.24,-310.91"/>
</g>
<!-- dp1_pp2_layer15_expert7&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1166" class="edge">
<title>dp1_pp2_layer15_expert7&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M87713.78,-354.15C87725.02,-342.74 87738.83,-328.73 87752.45,-314.92"/>
<polygon fill="black" stroke="black" points="87755,-317.31 87759.53,-307.73 87750.02,-312.39 87755,-317.31"/>
</g>
<!-- dp1_pp2_layer15_expert8&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1167" class="edge">
<title>dp1_pp2_layer15_expert8&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M87906.22,-354.15C87894.97,-342.74 87881.16,-328.73 87867.55,-314.92"/>
<polygon fill="black" stroke="black" points="87869.98,-312.39 87860.47,-307.73 87864.99,-317.31 87869.98,-312.39"/>
</g>
<!-- dp1_pp2_layer15_expert9&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1168" class="edge">
<title>dp1_pp2_layer15_expert9&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M88104.98,-354.26C88087.73,-348.03 88069.21,-341.44 88052,-335.52 88028.29,-327.37 88003.21,-318.95 87978.53,-310.78"/>
<polygon fill="black" stroke="black" points="87979.32,-307.36 87968.73,-307.54 87977.12,-314 87979.32,-307.36"/>
</g>
<!-- dp1_pp2_layer15_expert10&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1169" class="edge">
<title>dp1_pp2_layer15_expert10&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M88352.58,-354.22C88333.96,-347.42 88313.35,-340.55 88294,-335.52 88213.99,-314.71 88125.05,-298.33 88045.46,-286"/>
<polygon fill="black" stroke="black" points="88045.71,-282.5 88035.3,-284.44 88044.65,-289.41 88045.71,-282.5"/>
</g>
<!-- dp1_pp2_layer15_expert11&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1170" class="edge">
<title>dp1_pp2_layer15_expert11&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M88596.61,-354.24C88577.51,-347.2 88556.13,-340.19 88536,-335.52 88367.74,-296.53 88172.97,-276.66 88027.55,-266.61"/>
<polygon fill="black" stroke="black" points="88027.38,-263.09 88017.16,-265.9 88026.9,-270.07 88027.38,-263.09"/>
</g>
<!-- dp1_pp2_layer15_expert12&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1171" class="edge">
<title>dp1_pp2_layer15_expert12&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M88839.61,-354.26C88820.28,-347.07 88798.52,-339.99 88778,-335.52 88520.51,-279.49 88216.64,-262.43 88018.99,-257.64"/>
<polygon fill="black" stroke="black" points="88018.86,-254.14 88008.78,-257.4 88018.69,-261.13 88018.86,-254.14"/>
</g>
<!-- dp1_pp2_layer15_expert13&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1172" class="edge">
<title>dp1_pp2_layer15_expert13&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M89082.27,-354.29C89062.79,-347.01 89040.77,-339.87 89020,-335.52 88836.02,-297.05 88319.97,-273.81 88024.63,-263.27"/>
<polygon fill="black" stroke="black" points="88024.33,-259.76 88014.21,-262.9 88024.08,-266.76 88024.33,-259.76"/>
</g>
<!-- dp1_pp2_layer15_expert14&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1173" class="edge">
<title>dp1_pp2_layer15_expert14&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M89324.6,-354.27C89305.05,-346.95 89282.9,-339.78 89262,-335.52 89031.27,-288.58 88365.86,-268.1 88021.74,-260.45"/>
<polygon fill="black" stroke="black" points="88021.73,-256.94 88011.65,-260.22 88021.57,-263.94 88021.73,-256.94"/>
</g>
<!-- dp1_pp2_layer15_expert15&#45;&gt;dp1_pp2_layer15_expert_agg -->
<g id="edge1174" class="edge">
<title>dp1_pp2_layer15_expert15&#45;&gt;dp1_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M89566.93,-354.29C89547.3,-346.92 89525.03,-339.72 89504,-335.52 89226.21,-280.12 88408.98,-263.37 88020.17,-258.47"/>
<polygon fill="black" stroke="black" points="88019.97,-254.97 88009.93,-258.34 88019.88,-261.97 88019.97,-254.97"/>
</g>
<!-- dp1_pp2_layer16_attn_tp0 -->
<g id="node716" class="node">
<title>dp1_pp2_layer16_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="85292.5,-531.06 85027.5,-531.06 85027.5,-479.06 85292.5,-479.06 85292.5,-531.06"/>
<text text-anchor="middle" x="85160" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="85160" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="85160" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="85160" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer15_expert_agg&#45;&gt;dp1_pp2_layer16_attn_tp0 -->
<g id="edge1176" class="edge">
<title>dp1_pp2_layer15_expert_agg&#45;&gt;dp1_pp2_layer16_attn_tp0</title>
<path fill="none" stroke="black" d="M87617.78,-260.41C87197.38,-269.54 86207.17,-294.77 85874,-335.52 85841.8,-339.46 85333.23,-444.29 85302,-453.06 85279.37,-459.41 85255.16,-467.58 85233.26,-475.5"/>
<polygon fill="black" stroke="black" points="85231.89,-472.28 85223.7,-479 85234.29,-478.85 85231.89,-472.28"/>
</g>
<!-- dp1_pp2_layer16_attn_allreduce -->
<g id="node717" class="node">
<title>dp1_pp2_layer16_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="85289" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="85289" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="85289" y="-383.29" font-family="Arial" font-size="10.00">GPUs 48&#45;51</text>
<text text-anchor="middle" x="85289" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="85289" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_attn_tp0&#45;&gt;dp1_pp2_layer16_attn_allreduce -->
<g id="edge1177" class="edge">
<title>dp1_pp2_layer16_attn_tp0&#45;&gt;dp1_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M85186.41,-478.92C85203.15,-463 85225.21,-442 85244.58,-423.56"/>
<polygon fill="black" stroke="black" points="85247.03,-426.07 85251.86,-416.64 85242.2,-421 85247.03,-426.07"/>
</g>
<!-- dp1_pp2_layer16_router -->
<g id="node721" class="node">
<title>dp1_pp2_layer16_router</title>
<polygon fill="lightyellow" stroke="black" points="83040.57,-557.06 82646.74,-557.06 82545.43,-453.06 82939.26,-453.06 83040.57,-557.06"/>
<text text-anchor="middle" x="82793" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="82793" y="-508.06" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="82793" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="82793" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_attn_allreduce&#45;&gt;dp1_pp2_layer16_router -->
<g id="edge1213" class="edge">
<title>dp1_pp2_layer16_attn_allreduce&#45;&gt;dp1_pp2_layer16_router</title>
<path fill="none" stroke="black" d="M85129.08,-392.38C85017.77,-399.9 84865.89,-409.76 84732,-417.06 84096.5,-451.72 83343.28,-482.59 82991.96,-496.4"/>
<polygon fill="black" stroke="black" points="82991.8,-492.91 82981.94,-496.79 82992.07,-499.9 82991.8,-492.91"/>
</g>
<!-- dp1_pp2_layer16_attn_tp1 -->
<g id="node718" class="node">
<title>dp1_pp2_layer16_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="85575.5,-531.06 85310.5,-531.06 85310.5,-479.06 85575.5,-479.06 85575.5,-531.06"/>
<text text-anchor="middle" x="85443" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="85443" y="-508.06" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="85443" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="85443" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer16_attn_tp1&#45;&gt;dp1_pp2_layer16_attn_allreduce -->
<g id="edge1178" class="edge">
<title>dp1_pp2_layer16_attn_tp1&#45;&gt;dp1_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M85411.46,-478.92C85390.99,-462.6 85363.83,-440.94 85340.29,-422.18"/>
<polygon fill="black" stroke="black" points="85342.46,-419.44 85332.46,-415.94 85338.1,-424.91 85342.46,-419.44"/>
</g>
<!-- dp1_pp2_layer16_attn_tp2 -->
<g id="node719" class="node">
<title>dp1_pp2_layer16_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="85009.5,-531.06 84744.5,-531.06 84744.5,-479.06 85009.5,-479.06 85009.5,-531.06"/>
<text text-anchor="middle" x="84877" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="84877" y="-508.06" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="84877" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="84877" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer16_attn_tp2&#45;&gt;dp1_pp2_layer16_attn_allreduce -->
<g id="edge1179" class="edge">
<title>dp1_pp2_layer16_attn_tp2&#45;&gt;dp1_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M84943.07,-479.02C84966.85,-470.35 84993.99,-460.86 85019,-453.06 85067.74,-437.86 85122.05,-423.03 85169.1,-410.83"/>
<polygon fill="black" stroke="black" points="85170.22,-414.15 85179.03,-408.26 85168.47,-407.38 85170.22,-414.15"/>
</g>
<!-- dp1_pp2_layer16_attn_tp3 -->
<g id="node720" class="node">
<title>dp1_pp2_layer16_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="85858.5,-531.06 85593.5,-531.06 85593.5,-479.06 85858.5,-479.06 85858.5,-531.06"/>
<text text-anchor="middle" x="85726" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="85726" y="-508.06" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="85726" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="85726" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp1_pp2_layer16_attn_tp3&#45;&gt;dp1_pp2_layer16_attn_allreduce -->
<g id="edge1180" class="edge">
<title>dp1_pp2_layer16_attn_tp3&#45;&gt;dp1_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M85661.21,-478.95C85637.43,-470.18 85610.17,-460.64 85585,-453.06 85530.42,-436.63 85469.31,-421.31 85416.86,-409.08"/>
<polygon fill="black" stroke="black" points="85417.37,-405.6 85406.83,-406.75 85415.78,-412.42 85417.37,-405.6"/>
</g>
<!-- dp1_pp2_layer16_expert0 -->
<g id="node722" class="node">
<title>dp1_pp2_layer16_expert0</title>
<polygon fill="lightgreen" stroke="black" points="81090,-406.29 80866,-406.29 80866,-354.29 81090,-354.29 81090,-406.29"/>
<text text-anchor="middle" x="80978" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="80978" y="-383.29" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="80978" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="80978" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert0 -->
<g id="edge1181" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82590.73,-499.65C82205.55,-490.26 81380.11,-465.13 81099,-417.06 81086.99,-415.01 81074.48,-412.16 81062.27,-408.95"/>
<polygon fill="black" stroke="black" points="81063.11,-405.56 81052.54,-406.32 81061.28,-412.31 81063.11,-405.56"/>
</g>
<!-- dp1_pp2_layer16_expert1 -->
<g id="node723" class="node">
<title>dp1_pp2_layer16_expert1</title>
<polygon fill="lightgreen" stroke="black" points="81332,-406.29 81108,-406.29 81108,-354.29 81332,-354.29 81332,-406.29"/>
<text text-anchor="middle" x="81220" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="81220" y="-383.29" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="81220" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="81220" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert1 -->
<g id="edge1182" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82588.55,-497.55C82246.94,-485.71 81574.58,-458.03 81341,-417.06 81329.08,-414.97 81316.67,-412.12 81304.54,-408.93"/>
<polygon fill="black" stroke="black" points="81305.45,-405.55 81294.89,-406.3 81303.62,-412.3 81305.45,-405.55"/>
</g>
<!-- dp1_pp2_layer16_expert2 -->
<g id="node724" class="node">
<title>dp1_pp2_layer16_expert2</title>
<polygon fill="lightgreen" stroke="black" points="81574,-406.29 81350,-406.29 81350,-354.29 81574,-354.29 81574,-406.29"/>
<text text-anchor="middle" x="81462" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="81462" y="-383.29" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="81462" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="81462" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert2 -->
<g id="edge1183" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82593.82,-502.85C82352.66,-498.37 81935.02,-480.97 81583,-417.06 81571.38,-414.95 81559.29,-412.14 81547.44,-409.03"/>
<polygon fill="black" stroke="black" points="81548.13,-405.59 81537.56,-406.34 81546.29,-412.34 81548.13,-405.59"/>
</g>
<!-- dp1_pp2_layer16_expert3 -->
<g id="node725" class="node">
<title>dp1_pp2_layer16_expert3</title>
<polygon fill="lightgreen" stroke="black" points="81816,-406.29 81592,-406.29 81592,-354.29 81816,-354.29 81816,-406.29"/>
<text text-anchor="middle" x="81704" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="81704" y="-383.29" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="81704" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="81704" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert3 -->
<g id="edge1184" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82588.36,-497.41C82391.31,-488.25 82085.63,-466.79 81825,-417.06 81813.57,-414.88 81801.67,-412.06 81789.99,-408.97"/>
<polygon fill="black" stroke="black" points="81790.82,-405.57 81780.25,-406.31 81788.98,-412.32 81790.82,-405.57"/>
</g>
<!-- dp1_pp2_layer16_expert4 -->
<g id="node726" class="node">
<title>dp1_pp2_layer16_expert4</title>
<polygon fill="lightgreen" stroke="black" points="82058,-406.29 81834,-406.29 81834,-354.29 82058,-354.29 82058,-406.29"/>
<text text-anchor="middle" x="81946" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="81946" y="-383.29" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="81946" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="81946" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert4 -->
<g id="edge1185" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82579.43,-487.98C82433.99,-474.71 82237.64,-452.25 82067,-417.06 82056.05,-414.8 82044.65,-412.02 82033.43,-409.02"/>
<polygon fill="black" stroke="black" points="82034.19,-405.6 82023.62,-406.33 82032.34,-412.35 82034.19,-405.6"/>
</g>
<!-- dp1_pp2_layer16_expert5 -->
<g id="node727" class="node">
<title>dp1_pp2_layer16_expert5</title>
<polygon fill="lightgreen" stroke="black" points="82300,-406.29 82076,-406.29 82076,-354.29 82300,-354.29 82300,-406.29"/>
<text text-anchor="middle" x="82188" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="82188" y="-383.29" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="82188" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="82188" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert5 -->
<g id="edge1186" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82559.29,-467.38C82479.5,-453.44 82390,-436.25 82309,-417.06 82298.9,-414.67 82288.4,-411.94 82277.99,-409.07"/>
<polygon fill="black" stroke="black" points="82278.62,-405.62 82268.05,-406.3 82276.74,-412.36 82278.62,-405.62"/>
</g>
<!-- dp1_pp2_layer16_expert6 -->
<g id="node728" class="node">
<title>dp1_pp2_layer16_expert6</title>
<polygon fill="lightgreen" stroke="black" points="82542,-406.29 82318,-406.29 82318,-354.29 82542,-354.29 82542,-406.29"/>
<text text-anchor="middle" x="82430" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="82430" y="-383.29" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="82430" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="82430" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert6 -->
<g id="edge1187" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82641.94,-452.97C82598.16,-438.16 82551.94,-422.53 82513.87,-409.66"/>
<polygon fill="black" stroke="black" points="82514.97,-406.33 82504.38,-406.45 82512.73,-412.97 82514.97,-406.33"/>
</g>
<!-- dp1_pp2_layer16_expert7 -->
<g id="node729" class="node">
<title>dp1_pp2_layer16_expert7</title>
<polygon fill="lightgreen" stroke="black" points="82784,-406.29 82560,-406.29 82560,-354.29 82784,-354.29 82784,-406.29"/>
<text text-anchor="middle" x="82672" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="82672" y="-383.29" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="82672" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="82672" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert7 -->
<g id="edge1188" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82742.38,-452.71C82729.3,-439.43 82715.58,-425.51 82703.76,-413.52"/>
<polygon fill="black" stroke="black" points="82706.19,-411 82696.68,-406.33 82701.2,-415.91 82706.19,-411"/>
</g>
<!-- dp1_pp2_layer16_expert8 -->
<g id="node730" class="node">
<title>dp1_pp2_layer16_expert8</title>
<polygon fill="lightgreen" stroke="black" points="83026,-406.29 82802,-406.29 82802,-354.29 83026,-354.29 83026,-406.29"/>
<text text-anchor="middle" x="82914" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="82914" y="-383.29" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="82914" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="82914" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert8 -->
<g id="edge1189" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82843.61,-452.71C82856.7,-439.43 82870.42,-425.51 82882.23,-413.52"/>
<polygon fill="black" stroke="black" points="82884.79,-415.91 82889.32,-406.33 82879.81,-411 82884.79,-415.91"/>
</g>
<!-- dp1_pp2_layer16_expert9 -->
<g id="node731" class="node">
<title>dp1_pp2_layer16_expert9</title>
<polygon fill="lightgreen" stroke="black" points="83268,-406.29 83044,-406.29 83044,-354.29 83268,-354.29 83268,-406.29"/>
<text text-anchor="middle" x="83156" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="83156" y="-383.29" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="83156" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="83156" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert9 -->
<g id="edge1190" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82940.38,-454.21C82985.29,-439.03 83033.08,-422.86 83072.23,-409.62"/>
<polygon fill="black" stroke="black" points="83073.64,-412.84 83081.99,-406.32 83071.4,-406.21 83073.64,-412.84"/>
</g>
<!-- dp1_pp2_layer16_expert10 -->
<g id="node732" class="node">
<title>dp1_pp2_layer16_expert10</title>
<polygon fill="lightgreen" stroke="black" points="83510,-406.29 83286,-406.29 83286,-354.29 83510,-354.29 83510,-406.29"/>
<text text-anchor="middle" x="83398" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="83398" y="-383.29" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="83398" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="83398" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert10 -->
<g id="edge1191" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82963.89,-478.04C83056.98,-462.69 83173.88,-441.49 83277,-417.06 83287.09,-414.67 83297.6,-411.94 83308.01,-409.07"/>
<polygon fill="black" stroke="black" points="83309.26,-412.36 83317.95,-406.3 83307.37,-405.62 83309.26,-412.36"/>
</g>
<!-- dp1_pp2_layer16_expert11 -->
<g id="node733" class="node">
<title>dp1_pp2_layer16_expert11</title>
<polygon fill="lightgreen" stroke="black" points="83752,-406.29 83528,-406.29 83528,-354.29 83752,-354.29 83752,-406.29"/>
<text text-anchor="middle" x="83640" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="83640" y="-383.29" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="83640" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="83640" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert11 -->
<g id="edge1192" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82975.99,-490.7C83123.62,-477.88 83336.08,-454.78 83519,-417.06 83529.95,-414.8 83541.35,-412.02 83552.57,-409.02"/>
<polygon fill="black" stroke="black" points="83553.66,-412.35 83562.38,-406.33 83551.81,-405.6 83553.66,-412.35"/>
</g>
<!-- dp1_pp2_layer16_expert12 -->
<g id="node734" class="node">
<title>dp1_pp2_layer16_expert12</title>
<polygon fill="lightgreen" stroke="black" points="83994,-406.29 83770,-406.29 83770,-354.29 83994,-354.29 83994,-406.29"/>
<text text-anchor="middle" x="83882" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="83882" y="-383.29" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="83882" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="83882" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert12 -->
<g id="edge1193" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82983.27,-498.07C83179.59,-489.29 83493.95,-468.01 83761,-417.06 83772.43,-414.88 83784.33,-412.06 83796.01,-408.97"/>
<polygon fill="black" stroke="black" points="83797.02,-412.32 83805.75,-406.31 83795.18,-405.57 83797.02,-412.32"/>
</g>
<!-- dp1_pp2_layer16_expert13 -->
<g id="node735" class="node">
<title>dp1_pp2_layer16_expert13</title>
<polygon fill="lightgreen" stroke="black" points="84236,-406.29 84012,-406.29 84012,-354.29 84236,-354.29 84236,-406.29"/>
<text text-anchor="middle" x="84124" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="84124" y="-383.29" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="84124" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="84124" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert13 -->
<g id="edge1194" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82987.93,-502.93C83228.42,-498.58 83648.9,-481.35 84003,-417.06 84014.62,-414.95 84026.71,-412.14 84038.56,-409.03"/>
<polygon fill="black" stroke="black" points="84039.7,-412.34 84048.44,-406.34 84037.87,-405.59 84039.7,-412.34"/>
</g>
<!-- dp1_pp2_layer16_expert14 -->
<g id="node736" class="node">
<title>dp1_pp2_layer16_expert14</title>
<polygon fill="lightgreen" stroke="black" points="84478,-406.29 84254,-406.29 84254,-354.29 84478,-354.29 84478,-406.29"/>
<text text-anchor="middle" x="84366" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="84366" y="-383.29" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="84366" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="84366" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert14 -->
<g id="edge1195" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82983.32,-498.04C83320.17,-486.48 84008.15,-458.6 84245,-417.06 84256.92,-414.97 84269.32,-412.12 84281.46,-408.93"/>
<polygon fill="black" stroke="black" points="84282.38,-412.3 84291.11,-406.3 84280.54,-405.55 84282.38,-412.3"/>
</g>
<!-- dp1_pp2_layer16_expert15 -->
<g id="node737" class="node">
<title>dp1_pp2_layer16_expert15</title>
<polygon fill="lightgreen" stroke="black" points="84720,-406.29 84496,-406.29 84496,-354.29 84720,-354.29 84720,-406.29"/>
<text text-anchor="middle" x="84608" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="84608" y="-383.29" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="84608" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="84608" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert15 -->
<g id="edge1196" class="edge">
<title>dp1_pp2_layer16_router&#45;&gt;dp1_pp2_layer16_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M82984.94,-499.9C83365.49,-490.72 84203.35,-465.57 84487,-417.06 84499.01,-415.01 84511.51,-412.16 84523.73,-408.95"/>
<polygon fill="black" stroke="black" points="84524.72,-412.31 84533.45,-406.32 84522.88,-405.56 84524.72,-412.31"/>
</g>
<!-- dp1_pp2_layer16_expert_agg -->
<g id="node738" class="node">
<title>dp1_pp2_layer16_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="83161.57,-307.52 82767.74,-307.52 82666.43,-203.52 83060.26,-203.52 83161.57,-307.52"/>
<text text-anchor="middle" x="82914" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="82914" y="-258.52" font-family="Arial" font-size="10.00">GPUs 48&#45;63</text>
<text text-anchor="middle" x="82914" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="82914" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_expert0&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1197" class="edge">
<title>dp1_pp2_layer16_expert0&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M81036.06,-354.25C81055.69,-346.88 81077.96,-339.68 81099,-335.52 81401.52,-275.68 82300.92,-261.16 82708.8,-257.65"/>
<polygon fill="black" stroke="black" points="82708.96,-261.14 82718.93,-257.56 82708.9,-254.15 82708.96,-261.14"/>
</g>
<!-- dp1_pp2_layer16_expert1&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1198" class="edge">
<title>dp1_pp2_layer16_expert1&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M81278.38,-354.21C81297.94,-346.89 81320.08,-339.73 81341,-335.52 81596.86,-284.02 82345.83,-265.4 82710.21,-259.26"/>
<polygon fill="black" stroke="black" points="82710.4,-262.76 82720.34,-259.09 82710.28,-255.76 82710.4,-262.76"/>
</g>
<!-- dp1_pp2_layer16_expert2&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1199" class="edge">
<title>dp1_pp2_layer16_expert2&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M81520.71,-354.21C81540.19,-346.94 81562.21,-339.8 81583,-335.52 81792.71,-292.32 82394.36,-270.3 82712,-261.41"/>
<polygon fill="black" stroke="black" points="82712.34,-264.9 82722.24,-261.13 82712.15,-257.91 82712.34,-264.9"/>
</g>
<!-- dp1_pp2_layer16_expert3&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1200" class="edge">
<title>dp1_pp2_layer16_expert3&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M81763.05,-354.26C81782.46,-347.03 81804.35,-339.92 81825,-335.52 81989.34,-300.54 82448.32,-276.12 82715.04,-264.41"/>
<polygon fill="black" stroke="black" points="82715.4,-267.9 82725.24,-263.97 82715.09,-260.91 82715.4,-267.9"/>
</g>
<!-- dp1_pp2_layer16_expert4&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1201" class="edge">
<title>dp1_pp2_layer16_expert4&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M82005.73,-354.28C82024.98,-347.15 82046.62,-340.08 82067,-335.52 82283.91,-287.01 82538.52,-268.23 82711.54,-261"/>
<polygon fill="black" stroke="black" points="82711.93,-264.48 82721.78,-260.58 82711.64,-257.49 82711.93,-264.48"/>
</g>
<!-- dp1_pp2_layer16_expert5&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1202" class="edge">
<title>dp1_pp2_layer16_expert5&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M82249.07,-354.28C82268.02,-347.32 82289.14,-340.35 82309,-335.52 82444.78,-302.51 82601.27,-282.55 82721.08,-270.95"/>
<polygon fill="black" stroke="black" points="82721.47,-274.42 82731.09,-269.99 82720.8,-267.46 82721.47,-274.42"/>
</g>
<!-- dp1_pp2_layer16_expert6&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1203" class="edge">
<title>dp1_pp2_layer16_expert6&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M82494.16,-354.29C82512.37,-347.69 82532.32,-340.91 82551,-335.52 82611.46,-318.09 82678.57,-302.47 82738.47,-289.81"/>
<polygon fill="black" stroke="black" points="82739.33,-293.21 82748.4,-287.73 82737.9,-286.36 82739.33,-293.21"/>
</g>
<!-- dp1_pp2_layer16_expert7&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1204" class="edge">
<title>dp1_pp2_layer16_expert7&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M82721.55,-354.15C82745.49,-342.01 82775.24,-326.92 82804.13,-312.26"/>
<polygon fill="black" stroke="black" points="82805.73,-315.37 82813.06,-307.73 82802.56,-309.13 82805.73,-315.37"/>
</g>
<!-- dp1_pp2_layer16_expert8&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1205" class="edge">
<title>dp1_pp2_layer16_expert8&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M82914,-354.15C82914,-343.58 82914,-330.77 82914,-317.96"/>
<polygon fill="black" stroke="black" points="82917.5,-317.73 82914,-307.73 82910.5,-317.73 82917.5,-317.73"/>
</g>
<!-- dp1_pp2_layer16_expert9&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1206" class="edge">
<title>dp1_pp2_layer16_expert9&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M83106.44,-354.15C83082.51,-342.01 83052.76,-326.92 83023.87,-312.26"/>
<polygon fill="black" stroke="black" points="83025.44,-309.13 83014.93,-307.73 83022.27,-315.37 83025.44,-309.13"/>
</g>
<!-- dp1_pp2_layer16_expert10&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1207" class="edge">
<title>dp1_pp2_layer16_expert10&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M83333.84,-354.29C83315.63,-347.69 83295.67,-340.91 83277,-335.52 83242.59,-325.6 83206.02,-316.27 83169.86,-307.73"/>
<polygon fill="black" stroke="black" points="83170.21,-304.22 83159.68,-305.35 83168.61,-311.03 83170.21,-304.22"/>
</g>
<!-- dp1_pp2_layer16_expert11&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1208" class="edge">
<title>dp1_pp2_layer16_expert11&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M83578.93,-354.28C83559.98,-347.32 83538.86,-340.35 83519,-335.52 83394.73,-305.31 83253.11,-286.03 83138.15,-274.08"/>
<polygon fill="black" stroke="black" points="83138.47,-270.6 83128.17,-273.05 83137.76,-277.56 83138.47,-270.6"/>
</g>
<!-- dp1_pp2_layer16_expert12&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1209" class="edge">
<title>dp1_pp2_layer16_expert12&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M83822.27,-354.28C83803.02,-347.15 83781.38,-340.08 83761,-335.52 83548.33,-287.95 83299.41,-268.98 83126.7,-261.43"/>
<polygon fill="black" stroke="black" points="83126.61,-257.93 83116.47,-261 83126.31,-264.92 83126.61,-257.93"/>
</g>
<!-- dp1_pp2_layer16_expert13&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1210" class="edge">
<title>dp1_pp2_layer16_expert13&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M84064.94,-354.26C84045.54,-347.03 84023.65,-339.92 84003,-335.52 83842.14,-301.28 83399.03,-277.16 83130.2,-265.18"/>
<polygon fill="black" stroke="black" points="83130.06,-261.67 83119.92,-264.72 83129.75,-268.66 83130.06,-261.67"/>
</g>
<!-- dp1_pp2_layer16_expert14&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1211" class="edge">
<title>dp1_pp2_layer16_expert14&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M84307.28,-354.21C84287.81,-346.94 84265.78,-339.8 84245,-335.52 84037.74,-292.82 83447.66,-270.82 83127.26,-261.73"/>
<polygon fill="black" stroke="black" points="83127.02,-258.22 83116.92,-261.44 83126.82,-265.22 83127.02,-258.22"/>
</g>
<!-- dp1_pp2_layer16_expert15&#45;&gt;dp1_pp2_layer16_expert_agg -->
<g id="edge1212" class="edge">
<title>dp1_pp2_layer16_expert15&#45;&gt;dp1_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M84549.61,-354.21C84530.06,-346.89 84507.91,-339.73 84487,-335.52 84232.8,-284.35 83491.86,-265.64 83124.93,-259.38"/>
<polygon fill="black" stroke="black" points="83124.78,-255.88 83114.72,-259.21 83124.66,-262.88 83124.78,-255.88"/>
</g>
<!-- output_dp1 -->
<g id="node1480" class="node">
<title>output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="97990" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="97990" y="-144.75" font-family="Arial" font-size="10.00">Output DP1</text>
<text text-anchor="middle" x="97990" y="-133.75" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="97990" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="97990" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp1_pp2_layer16_expert_agg&#45;&gt;output_dp1 -->
<g id="edge2435" class="edge">
<title>dp1_pp2_layer16_expert_agg&#45;&gt;output_dp1</title>
<path fill="none" stroke="black" d="M83104.24,-248.28C83573.88,-233.19 84826.07,-194.83 85871,-179.52 88344.17,-143.29 96496.93,-133.32 97810.59,-131.93"/>
<polygon fill="black" stroke="black" points="97811.06,-135.43 97821.06,-131.92 97811.05,-128.43 97811.06,-135.43"/>
</g>
<!-- dp2_pp1_layer1_attn_tp0 -->
<g id="node739" class="node">
<title>dp2_pp1_layer1_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="240903.5,-531.06 240638.5,-531.06 240638.5,-479.06 240903.5,-479.06 240903.5,-531.06"/>
<text text-anchor="middle" x="240771" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="240771" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="240771" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="240771" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer1_attn_allreduce -->
<g id="node740" class="node">
<title>dp2_pp1_layer1_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="240912" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="240912" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="240912" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="240912" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="240912" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_attn_tp0&#45;&gt;dp2_pp1_layer1_attn_allreduce -->
<g id="edge1214" class="edge">
<title>dp2_pp1_layer1_attn_tp0&#45;&gt;dp2_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M240799.87,-478.92C240818.39,-462.8 240842.87,-441.49 240864.23,-422.89"/>
<polygon fill="black" stroke="black" points="240866.7,-425.38 240871.94,-416.17 240862.1,-420.1 240866.7,-425.38"/>
</g>
<!-- dp2_pp1_layer1_router -->
<g id="node744" class="node">
<title>dp2_pp1_layer1_router</title>
<polygon fill="lightyellow" stroke="black" points="238651.57,-557.06 238257.74,-557.06 238156.43,-453.06 238550.26,-453.06 238651.57,-557.06"/>
<text text-anchor="middle" x="238404" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="238404" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="238404" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="238404" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_attn_allreduce&#45;&gt;dp2_pp1_layer1_router -->
<g id="edge1250" class="edge">
<title>dp2_pp1_layer1_attn_allreduce&#45;&gt;dp2_pp1_layer1_router</title>
<path fill="none" stroke="black" d="M240751.7,-392.14C240637.73,-399.66 240481,-409.63 240343,-417.06 239707.48,-451.29 238954.27,-482.37 238602.96,-496.31"/>
<polygon fill="black" stroke="black" points="238602.79,-492.82 238592.94,-496.71 238603.07,-499.81 238602.79,-492.82"/>
</g>
<!-- dp2_pp1_layer1_attn_tp1 -->
<g id="node741" class="node">
<title>dp2_pp1_layer1_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="241186.5,-531.06 240921.5,-531.06 240921.5,-479.06 241186.5,-479.06 241186.5,-531.06"/>
<text text-anchor="middle" x="241054" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="241054" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="241054" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="241054" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer1_attn_tp1&#45;&gt;dp2_pp1_layer1_attn_allreduce -->
<g id="edge1215" class="edge">
<title>dp2_pp1_layer1_attn_tp1&#45;&gt;dp2_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M241024.92,-478.92C241006.28,-462.8 240981.62,-441.49 240960.11,-422.89"/>
<polygon fill="black" stroke="black" points="240962.2,-420.06 240952.34,-416.17 240957.62,-425.36 240962.2,-420.06"/>
</g>
<!-- dp2_pp1_layer1_attn_tp2 -->
<g id="node742" class="node">
<title>dp2_pp1_layer1_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="240620.5,-531.06 240355.5,-531.06 240355.5,-479.06 240620.5,-479.06 240620.5,-531.06"/>
<text text-anchor="middle" x="240488" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="240488" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="240488" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="240488" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer1_attn_tp2&#45;&gt;dp2_pp1_layer1_attn_allreduce -->
<g id="edge1216" class="edge">
<title>dp2_pp1_layer1_attn_tp2&#45;&gt;dp2_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M240553.66,-479C240577.53,-470.28 240604.83,-460.77 240630,-453.06 240681.51,-437.29 240739.04,-422.21 240788.64,-409.97"/>
<polygon fill="black" stroke="black" points="240789.57,-413.35 240798.45,-407.57 240787.9,-406.55 240789.57,-413.35"/>
</g>
<!-- dp2_pp1_layer1_attn_tp3 -->
<g id="node743" class="node">
<title>dp2_pp1_layer1_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="241469.5,-531.06 241204.5,-531.06 241204.5,-479.06 241469.5,-479.06 241469.5,-531.06"/>
<text text-anchor="middle" x="241337" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="241337" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="241337" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="241337" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer1_attn_tp3&#45;&gt;dp2_pp1_layer1_attn_allreduce -->
<g id="edge1217" class="edge">
<title>dp2_pp1_layer1_attn_tp3&#45;&gt;dp2_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M241271.82,-478.95C241248.12,-470.23 241221.01,-460.72 241196,-453.06 241144.14,-437.17 241086.21,-422.07 241036.26,-409.85"/>
<polygon fill="black" stroke="black" points="241036.92,-406.41 241026.38,-407.45 241035.27,-413.21 241036.92,-406.41"/>
</g>
<!-- dp2_pp1_layer1_expert0 -->
<g id="node745" class="node">
<title>dp2_pp1_layer1_expert0</title>
<polygon fill="lightgreen" stroke="black" points="236701,-406.29 236477,-406.29 236477,-354.29 236701,-354.29 236701,-406.29"/>
<text text-anchor="middle" x="236589" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="236589" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="236589" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="236589" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert0 -->
<g id="edge1218" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238201.73,-499.65C237816.55,-490.26 236991.11,-465.13 236710,-417.06 236697.99,-415.01 236685.48,-412.16 236673.27,-408.95"/>
<polygon fill="black" stroke="black" points="236674.11,-405.56 236663.54,-406.32 236672.28,-412.31 236674.11,-405.56"/>
</g>
<!-- dp2_pp1_layer1_expert1 -->
<g id="node746" class="node">
<title>dp2_pp1_layer1_expert1</title>
<polygon fill="lightgreen" stroke="black" points="236943,-406.29 236719,-406.29 236719,-354.29 236943,-354.29 236943,-406.29"/>
<text text-anchor="middle" x="236831" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="236831" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="236831" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="236831" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert1 -->
<g id="edge1219" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238199.55,-497.55C237857.94,-485.71 237185.58,-458.03 236952,-417.06 236940.08,-414.97 236927.67,-412.12 236915.54,-408.93"/>
<polygon fill="black" stroke="black" points="236916.45,-405.55 236905.89,-406.3 236914.62,-412.3 236916.45,-405.55"/>
</g>
<!-- dp2_pp1_layer1_expert2 -->
<g id="node747" class="node">
<title>dp2_pp1_layer1_expert2</title>
<polygon fill="lightgreen" stroke="black" points="237185,-406.29 236961,-406.29 236961,-354.29 237185,-354.29 237185,-406.29"/>
<text text-anchor="middle" x="237073" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="237073" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="237073" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="237073" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert2 -->
<g id="edge1220" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238204.82,-502.85C237963.66,-498.37 237546.02,-480.97 237194,-417.06 237182.38,-414.95 237170.29,-412.14 237158.44,-409.03"/>
<polygon fill="black" stroke="black" points="237159.13,-405.59 237148.56,-406.34 237157.29,-412.34 237159.13,-405.59"/>
</g>
<!-- dp2_pp1_layer1_expert3 -->
<g id="node748" class="node">
<title>dp2_pp1_layer1_expert3</title>
<polygon fill="lightgreen" stroke="black" points="237427,-406.29 237203,-406.29 237203,-354.29 237427,-354.29 237427,-406.29"/>
<text text-anchor="middle" x="237315" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="237315" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="237315" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="237315" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert3 -->
<g id="edge1221" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238199.36,-497.41C238002.31,-488.25 237696.63,-466.79 237436,-417.06 237424.57,-414.88 237412.67,-412.06 237400.99,-408.97"/>
<polygon fill="black" stroke="black" points="237401.82,-405.57 237391.25,-406.31 237399.98,-412.32 237401.82,-405.57"/>
</g>
<!-- dp2_pp1_layer1_expert4 -->
<g id="node749" class="node">
<title>dp2_pp1_layer1_expert4</title>
<polygon fill="lightgreen" stroke="black" points="237669,-406.29 237445,-406.29 237445,-354.29 237669,-354.29 237669,-406.29"/>
<text text-anchor="middle" x="237557" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="237557" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="237557" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="237557" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert4 -->
<g id="edge1222" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238190.43,-487.98C238044.99,-474.71 237848.64,-452.25 237678,-417.06 237667.05,-414.8 237655.65,-412.02 237644.43,-409.02"/>
<polygon fill="black" stroke="black" points="237645.19,-405.6 237634.62,-406.33 237643.34,-412.35 237645.19,-405.6"/>
</g>
<!-- dp2_pp1_layer1_expert5 -->
<g id="node750" class="node">
<title>dp2_pp1_layer1_expert5</title>
<polygon fill="lightgreen" stroke="black" points="237911,-406.29 237687,-406.29 237687,-354.29 237911,-354.29 237911,-406.29"/>
<text text-anchor="middle" x="237799" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="237799" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="237799" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="237799" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert5 -->
<g id="edge1223" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238170.29,-467.38C238090.5,-453.44 238001,-436.25 237920,-417.06 237909.9,-414.67 237899.4,-411.94 237888.99,-409.07"/>
<polygon fill="black" stroke="black" points="237889.62,-405.62 237879.05,-406.3 237887.74,-412.36 237889.62,-405.62"/>
</g>
<!-- dp2_pp1_layer1_expert6 -->
<g id="node751" class="node">
<title>dp2_pp1_layer1_expert6</title>
<polygon fill="lightgreen" stroke="black" points="238153,-406.29 237929,-406.29 237929,-354.29 238153,-354.29 238153,-406.29"/>
<text text-anchor="middle" x="238041" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="238041" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="238041" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="238041" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert6 -->
<g id="edge1224" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238252.94,-452.97C238209.16,-438.16 238162.94,-422.53 238124.87,-409.66"/>
<polygon fill="black" stroke="black" points="238125.97,-406.33 238115.38,-406.45 238123.73,-412.97 238125.97,-406.33"/>
</g>
<!-- dp2_pp1_layer1_expert7 -->
<g id="node752" class="node">
<title>dp2_pp1_layer1_expert7</title>
<polygon fill="lightgreen" stroke="black" points="238395,-406.29 238171,-406.29 238171,-354.29 238395,-354.29 238395,-406.29"/>
<text text-anchor="middle" x="238283" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="238283" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="238283" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="238283" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert7 -->
<g id="edge1225" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238353.38,-452.71C238340.3,-439.43 238326.58,-425.51 238314.76,-413.52"/>
<polygon fill="black" stroke="black" points="238317.19,-411 238307.68,-406.33 238312.2,-415.91 238317.19,-411"/>
</g>
<!-- dp2_pp1_layer1_expert8 -->
<g id="node753" class="node">
<title>dp2_pp1_layer1_expert8</title>
<polygon fill="lightgreen" stroke="black" points="238637,-406.29 238413,-406.29 238413,-354.29 238637,-354.29 238637,-406.29"/>
<text text-anchor="middle" x="238525" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="238525" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="238525" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="238525" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert8 -->
<g id="edge1226" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238454.61,-452.71C238467.7,-439.43 238481.42,-425.51 238493.23,-413.52"/>
<polygon fill="black" stroke="black" points="238495.79,-415.91 238500.32,-406.33 238490.81,-411 238495.79,-415.91"/>
</g>
<!-- dp2_pp1_layer1_expert9 -->
<g id="node754" class="node">
<title>dp2_pp1_layer1_expert9</title>
<polygon fill="lightgreen" stroke="black" points="238879,-406.29 238655,-406.29 238655,-354.29 238879,-354.29 238879,-406.29"/>
<text text-anchor="middle" x="238767" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="238767" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="238767" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="238767" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert9 -->
<g id="edge1227" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238551.38,-454.21C238596.29,-439.03 238644.08,-422.86 238683.23,-409.62"/>
<polygon fill="black" stroke="black" points="238684.64,-412.84 238692.99,-406.32 238682.4,-406.21 238684.64,-412.84"/>
</g>
<!-- dp2_pp1_layer1_expert10 -->
<g id="node755" class="node">
<title>dp2_pp1_layer1_expert10</title>
<polygon fill="lightgreen" stroke="black" points="239121,-406.29 238897,-406.29 238897,-354.29 239121,-354.29 239121,-406.29"/>
<text text-anchor="middle" x="239009" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="239009" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="239009" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="239009" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert10 -->
<g id="edge1228" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238574.89,-478.04C238667.98,-462.69 238784.88,-441.49 238888,-417.06 238898.09,-414.67 238908.6,-411.94 238919.01,-409.07"/>
<polygon fill="black" stroke="black" points="238920.26,-412.36 238928.95,-406.3 238918.37,-405.62 238920.26,-412.36"/>
</g>
<!-- dp2_pp1_layer1_expert11 -->
<g id="node756" class="node">
<title>dp2_pp1_layer1_expert11</title>
<polygon fill="lightgreen" stroke="black" points="239363,-406.29 239139,-406.29 239139,-354.29 239363,-354.29 239363,-406.29"/>
<text text-anchor="middle" x="239251" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="239251" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="239251" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="239251" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert11 -->
<g id="edge1229" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238586.99,-490.7C238734.62,-477.88 238947.08,-454.78 239130,-417.06 239140.95,-414.8 239152.35,-412.02 239163.57,-409.02"/>
<polygon fill="black" stroke="black" points="239164.66,-412.35 239173.38,-406.33 239162.81,-405.6 239164.66,-412.35"/>
</g>
<!-- dp2_pp1_layer1_expert12 -->
<g id="node757" class="node">
<title>dp2_pp1_layer1_expert12</title>
<polygon fill="lightgreen" stroke="black" points="239605,-406.29 239381,-406.29 239381,-354.29 239605,-354.29 239605,-406.29"/>
<text text-anchor="middle" x="239493" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="239493" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="239493" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="239493" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert12 -->
<g id="edge1230" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238594.27,-498.07C238790.59,-489.29 239104.95,-468.01 239372,-417.06 239383.43,-414.88 239395.33,-412.06 239407.01,-408.97"/>
<polygon fill="black" stroke="black" points="239408.02,-412.32 239416.75,-406.31 239406.18,-405.57 239408.02,-412.32"/>
</g>
<!-- dp2_pp1_layer1_expert13 -->
<g id="node758" class="node">
<title>dp2_pp1_layer1_expert13</title>
<polygon fill="lightgreen" stroke="black" points="239847,-406.29 239623,-406.29 239623,-354.29 239847,-354.29 239847,-406.29"/>
<text text-anchor="middle" x="239735" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="239735" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="239735" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="239735" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert13 -->
<g id="edge1231" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238598.93,-502.93C238839.42,-498.58 239259.9,-481.35 239614,-417.06 239625.62,-414.95 239637.71,-412.14 239649.56,-409.03"/>
<polygon fill="black" stroke="black" points="239650.7,-412.34 239659.44,-406.34 239648.87,-405.59 239650.7,-412.34"/>
</g>
<!-- dp2_pp1_layer1_expert14 -->
<g id="node759" class="node">
<title>dp2_pp1_layer1_expert14</title>
<polygon fill="lightgreen" stroke="black" points="240089,-406.29 239865,-406.29 239865,-354.29 240089,-354.29 240089,-406.29"/>
<text text-anchor="middle" x="239977" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="239977" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="239977" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="239977" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert14 -->
<g id="edge1232" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238594.32,-498.04C238931.17,-486.48 239619.15,-458.6 239856,-417.06 239867.92,-414.97 239880.32,-412.12 239892.46,-408.93"/>
<polygon fill="black" stroke="black" points="239893.38,-412.3 239902.11,-406.3 239891.54,-405.55 239893.38,-412.3"/>
</g>
<!-- dp2_pp1_layer1_expert15 -->
<g id="node760" class="node">
<title>dp2_pp1_layer1_expert15</title>
<polygon fill="lightgreen" stroke="black" points="240331,-406.29 240107,-406.29 240107,-354.29 240331,-354.29 240331,-406.29"/>
<text text-anchor="middle" x="240219" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="240219" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="240219" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="240219" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert15 -->
<g id="edge1233" class="edge">
<title>dp2_pp1_layer1_router&#45;&gt;dp2_pp1_layer1_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M238595.94,-499.9C238976.49,-490.72 239814.35,-465.57 240098,-417.06 240110.01,-415.01 240122.51,-412.16 240134.73,-408.95"/>
<polygon fill="black" stroke="black" points="240135.72,-412.31 240144.45,-406.32 240133.88,-405.56 240135.72,-412.31"/>
</g>
<!-- dp2_pp1_layer1_expert_agg -->
<g id="node761" class="node">
<title>dp2_pp1_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="238651.57,-307.52 238257.74,-307.52 238156.43,-203.52 238550.26,-203.52 238651.57,-307.52"/>
<text text-anchor="middle" x="238404" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="238404" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="238404" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="238404" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer1_expert0&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1234" class="edge">
<title>dp2_pp1_layer1_expert0&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M236647.07,-354.29C236666.69,-346.92 236688.97,-339.72 236710,-335.52 236989.13,-279.86 237812.93,-263.21 238199.43,-258.4"/>
<polygon fill="black" stroke="black" points="238199.65,-261.9 238209.61,-258.27 238199.57,-254.9 238199.65,-261.9"/>
</g>
<!-- dp2_pp1_layer1_expert1&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1235" class="edge">
<title>dp2_pp1_layer1_expert1&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M236889.39,-354.27C236908.95,-346.95 236931.09,-339.78 236952,-335.52 237184.8,-288.16 237860.09,-267.74 238201.43,-260.24"/>
<polygon fill="black" stroke="black" points="238201.51,-263.74 238211.43,-260.03 238201.35,-256.74 238201.51,-263.74"/>
</g>
<!-- dp2_pp1_layer1_expert2&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1236" class="edge">
<title>dp2_pp1_layer1_expert2&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M237131.73,-354.29C237151.21,-347.01 237173.23,-339.87 237194,-335.52 237380.91,-296.44 237910.54,-273.07 238203.3,-262.78"/>
<polygon fill="black" stroke="black" points="238203.74,-266.27 238213.61,-262.42 238203.5,-259.27 238203.74,-266.27"/>
</g>
<!-- dp2_pp1_layer1_expert3&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1237" class="edge">
<title>dp2_pp1_layer1_expert3&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M237374.39,-354.26C237393.72,-347.07 237415.48,-339.99 237436,-335.52 237694.91,-279.18 238000.7,-262.24 238198.26,-257.56"/>
<polygon fill="black" stroke="black" points="238198.55,-261.06 238208.47,-257.33 238198.39,-254.06 238198.55,-261.06"/>
</g>
<!-- dp2_pp1_layer1_expert4&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1238" class="edge">
<title>dp2_pp1_layer1_expert4&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M237617.39,-354.24C237636.49,-347.2 237657.87,-340.19 237678,-335.52 237853.82,-294.77 238058.6,-274.91 238205.75,-265.31"/>
<polygon fill="black" stroke="black" points="238206.05,-268.8 238215.81,-264.67 238205.6,-261.82 238206.05,-268.8"/>
</g>
<!-- dp2_pp1_layer1_expert5&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1239" class="edge">
<title>dp2_pp1_layer1_expert5&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M237861.42,-354.22C237880.04,-347.42 237900.65,-340.55 237920,-335.52 238017.09,-310.27 238127.34,-291.53 238218.07,-278.65"/>
<polygon fill="black" stroke="black" points="238218.78,-282.09 238228.19,-277.23 238217.8,-275.16 238218.78,-282.09"/>
</g>
<!-- dp2_pp1_layer1_expert6&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1240" class="edge">
<title>dp2_pp1_layer1_expert6&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M238109.02,-354.26C238126.26,-348.03 238144.78,-341.44 238162,-335.52 238188.73,-326.33 238217.21,-316.8 238244.89,-307.67"/>
<polygon fill="black" stroke="black" points="238246.24,-310.91 238254.65,-304.46 238244.06,-304.26 238246.24,-310.91"/>
</g>
<!-- dp2_pp1_layer1_expert7&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1241" class="edge">
<title>dp2_pp1_layer1_expert7&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M238307.78,-354.15C238319.02,-342.74 238332.83,-328.73 238346.45,-314.92"/>
<polygon fill="black" stroke="black" points="238349,-317.31 238353.53,-307.73 238344.02,-312.39 238349,-317.31"/>
</g>
<!-- dp2_pp1_layer1_expert8&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1242" class="edge">
<title>dp2_pp1_layer1_expert8&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M238500.22,-354.15C238488.97,-342.74 238475.16,-328.73 238461.55,-314.92"/>
<polygon fill="black" stroke="black" points="238463.98,-312.39 238454.47,-307.73 238458.99,-317.31 238463.98,-312.39"/>
</g>
<!-- dp2_pp1_layer1_expert9&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1243" class="edge">
<title>dp2_pp1_layer1_expert9&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M238698.98,-354.26C238681.73,-348.03 238663.21,-341.44 238646,-335.52 238622.29,-327.37 238597.21,-318.95 238572.53,-310.78"/>
<polygon fill="black" stroke="black" points="238573.32,-307.36 238562.73,-307.54 238571.12,-314 238573.32,-307.36"/>
</g>
<!-- dp2_pp1_layer1_expert10&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1244" class="edge">
<title>dp2_pp1_layer1_expert10&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M238946.58,-354.22C238927.96,-347.42 238907.35,-340.55 238888,-335.52 238807.99,-314.71 238719.05,-298.33 238639.46,-286"/>
<polygon fill="black" stroke="black" points="238639.71,-282.5 238629.3,-284.44 238638.65,-289.41 238639.71,-282.5"/>
</g>
<!-- dp2_pp1_layer1_expert11&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1245" class="edge">
<title>dp2_pp1_layer1_expert11&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M239190.61,-354.24C239171.51,-347.2 239150.13,-340.19 239130,-335.52 238961.74,-296.53 238766.97,-276.66 238621.55,-266.61"/>
<polygon fill="black" stroke="black" points="238621.38,-263.09 238611.16,-265.9 238620.9,-270.07 238621.38,-263.09"/>
</g>
<!-- dp2_pp1_layer1_expert12&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1246" class="edge">
<title>dp2_pp1_layer1_expert12&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M239433.61,-354.26C239414.28,-347.07 239392.52,-339.99 239372,-335.52 239114.51,-279.49 238810.64,-262.43 238612.99,-257.64"/>
<polygon fill="black" stroke="black" points="238612.86,-254.14 238602.78,-257.4 238612.69,-261.13 238612.86,-254.14"/>
</g>
<!-- dp2_pp1_layer1_expert13&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1247" class="edge">
<title>dp2_pp1_layer1_expert13&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M239676.27,-354.29C239656.79,-347.01 239634.77,-339.87 239614,-335.52 239430.02,-297.05 238913.97,-273.81 238618.63,-263.27"/>
<polygon fill="black" stroke="black" points="238618.33,-259.76 238608.21,-262.9 238618.08,-266.76 238618.33,-259.76"/>
</g>
<!-- dp2_pp1_layer1_expert14&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1248" class="edge">
<title>dp2_pp1_layer1_expert14&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M239918.6,-354.27C239899.05,-346.95 239876.9,-339.78 239856,-335.52 239625.27,-288.58 238959.86,-268.1 238615.74,-260.45"/>
<polygon fill="black" stroke="black" points="238615.73,-256.94 238605.65,-260.22 238615.57,-263.94 238615.73,-256.94"/>
</g>
<!-- dp2_pp1_layer1_expert15&#45;&gt;dp2_pp1_layer1_expert_agg -->
<g id="edge1249" class="edge">
<title>dp2_pp1_layer1_expert15&#45;&gt;dp2_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M240160.93,-354.29C240141.3,-346.92 240119.03,-339.72 240098,-335.52 239820.21,-280.12 239002.98,-263.37 238614.17,-258.47"/>
<polygon fill="black" stroke="black" points="238613.97,-254.97 238603.93,-258.34 238613.88,-261.97 238613.97,-254.97"/>
</g>
<!-- dp2_pp1_layer2_attn_tp0 -->
<g id="node762" class="node">
<title>dp2_pp1_layer2_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="235886.5,-531.06 235621.5,-531.06 235621.5,-479.06 235886.5,-479.06 235886.5,-531.06"/>
<text text-anchor="middle" x="235754" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="235754" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="235754" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="235754" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer1_expert_agg&#45;&gt;dp2_pp1_layer2_attn_tp0 -->
<g id="edge1251" class="edge">
<title>dp2_pp1_layer1_expert_agg&#45;&gt;dp2_pp1_layer2_attn_tp0</title>
<path fill="none" stroke="black" d="M238211.78,-260.41C237791.38,-269.54 236801.17,-294.77 236468,-335.52 236435.8,-339.46 235927.23,-444.29 235896,-453.06 235873.37,-459.41 235849.16,-467.58 235827.26,-475.5"/>
<polygon fill="black" stroke="black" points="235825.89,-472.28 235817.7,-479 235828.29,-478.85 235825.89,-472.28"/>
</g>
<!-- dp2_pp1_layer2_attn_allreduce -->
<g id="node763" class="node">
<title>dp2_pp1_layer2_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="235883" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="235883" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="235883" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="235883" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="235883" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_attn_tp0&#45;&gt;dp2_pp1_layer2_attn_allreduce -->
<g id="edge1252" class="edge">
<title>dp2_pp1_layer2_attn_tp0&#45;&gt;dp2_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M235780.41,-478.92C235797.15,-463 235819.21,-442 235838.58,-423.56"/>
<polygon fill="black" stroke="black" points="235841.03,-426.07 235845.86,-416.64 235836.2,-421 235841.03,-426.07"/>
</g>
<!-- dp2_pp1_layer2_router -->
<g id="node767" class="node">
<title>dp2_pp1_layer2_router</title>
<polygon fill="lightyellow" stroke="black" points="233634.57,-557.06 233240.74,-557.06 233139.43,-453.06 233533.26,-453.06 233634.57,-557.06"/>
<text text-anchor="middle" x="233387" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="233387" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="233387" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="233387" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_attn_allreduce&#45;&gt;dp2_pp1_layer2_router -->
<g id="edge1288" class="edge">
<title>dp2_pp1_layer2_attn_allreduce&#45;&gt;dp2_pp1_layer2_router</title>
<path fill="none" stroke="black" d="M235723.08,-392.38C235611.77,-399.9 235459.89,-409.76 235326,-417.06 234690.5,-451.72 233937.28,-482.59 233585.96,-496.4"/>
<polygon fill="black" stroke="black" points="233585.8,-492.91 233575.94,-496.79 233586.07,-499.9 233585.8,-492.91"/>
</g>
<!-- dp2_pp1_layer2_attn_tp1 -->
<g id="node764" class="node">
<title>dp2_pp1_layer2_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="236169.5,-531.06 235904.5,-531.06 235904.5,-479.06 236169.5,-479.06 236169.5,-531.06"/>
<text text-anchor="middle" x="236037" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="236037" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="236037" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="236037" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer2_attn_tp1&#45;&gt;dp2_pp1_layer2_attn_allreduce -->
<g id="edge1253" class="edge">
<title>dp2_pp1_layer2_attn_tp1&#45;&gt;dp2_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M236005.46,-478.92C235984.99,-462.6 235957.83,-440.94 235934.29,-422.18"/>
<polygon fill="black" stroke="black" points="235936.46,-419.44 235926.46,-415.94 235932.1,-424.91 235936.46,-419.44"/>
</g>
<!-- dp2_pp1_layer2_attn_tp2 -->
<g id="node765" class="node">
<title>dp2_pp1_layer2_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="235603.5,-531.06 235338.5,-531.06 235338.5,-479.06 235603.5,-479.06 235603.5,-531.06"/>
<text text-anchor="middle" x="235471" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="235471" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="235471" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="235471" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer2_attn_tp2&#45;&gt;dp2_pp1_layer2_attn_allreduce -->
<g id="edge1254" class="edge">
<title>dp2_pp1_layer2_attn_tp2&#45;&gt;dp2_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M235537.07,-479.02C235560.85,-470.35 235587.99,-460.86 235613,-453.06 235661.74,-437.86 235716.05,-423.03 235763.1,-410.83"/>
<polygon fill="black" stroke="black" points="235764.22,-414.15 235773.03,-408.26 235762.47,-407.38 235764.22,-414.15"/>
</g>
<!-- dp2_pp1_layer2_attn_tp3 -->
<g id="node766" class="node">
<title>dp2_pp1_layer2_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="236452.5,-531.06 236187.5,-531.06 236187.5,-479.06 236452.5,-479.06 236452.5,-531.06"/>
<text text-anchor="middle" x="236320" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="236320" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="236320" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="236320" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer2_attn_tp3&#45;&gt;dp2_pp1_layer2_attn_allreduce -->
<g id="edge1255" class="edge">
<title>dp2_pp1_layer2_attn_tp3&#45;&gt;dp2_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M236255.21,-478.95C236231.43,-470.18 236204.17,-460.64 236179,-453.06 236124.42,-436.63 236063.31,-421.31 236010.86,-409.08"/>
<polygon fill="black" stroke="black" points="236011.37,-405.6 236000.83,-406.75 236009.78,-412.42 236011.37,-405.6"/>
</g>
<!-- dp2_pp1_layer2_expert0 -->
<g id="node768" class="node">
<title>dp2_pp1_layer2_expert0</title>
<polygon fill="lightgreen" stroke="black" points="231684,-406.29 231460,-406.29 231460,-354.29 231684,-354.29 231684,-406.29"/>
<text text-anchor="middle" x="231572" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="231572" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="231572" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="231572" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert0 -->
<g id="edge1256" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233184.73,-499.65C232799.55,-490.26 231974.11,-465.13 231693,-417.06 231680.99,-415.01 231668.48,-412.16 231656.27,-408.95"/>
<polygon fill="black" stroke="black" points="231657.11,-405.56 231646.54,-406.32 231655.28,-412.31 231657.11,-405.56"/>
</g>
<!-- dp2_pp1_layer2_expert1 -->
<g id="node769" class="node">
<title>dp2_pp1_layer2_expert1</title>
<polygon fill="lightgreen" stroke="black" points="231926,-406.29 231702,-406.29 231702,-354.29 231926,-354.29 231926,-406.29"/>
<text text-anchor="middle" x="231814" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="231814" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="231814" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="231814" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert1 -->
<g id="edge1257" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233182.55,-497.55C232840.94,-485.71 232168.58,-458.03 231935,-417.06 231923.08,-414.97 231910.67,-412.12 231898.54,-408.93"/>
<polygon fill="black" stroke="black" points="231899.45,-405.55 231888.89,-406.3 231897.62,-412.3 231899.45,-405.55"/>
</g>
<!-- dp2_pp1_layer2_expert2 -->
<g id="node770" class="node">
<title>dp2_pp1_layer2_expert2</title>
<polygon fill="lightgreen" stroke="black" points="232168,-406.29 231944,-406.29 231944,-354.29 232168,-354.29 232168,-406.29"/>
<text text-anchor="middle" x="232056" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="232056" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="232056" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="232056" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert2 -->
<g id="edge1258" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233187.82,-502.85C232946.66,-498.37 232529.02,-480.97 232177,-417.06 232165.38,-414.95 232153.29,-412.14 232141.44,-409.03"/>
<polygon fill="black" stroke="black" points="232142.13,-405.59 232131.56,-406.34 232140.29,-412.34 232142.13,-405.59"/>
</g>
<!-- dp2_pp1_layer2_expert3 -->
<g id="node771" class="node">
<title>dp2_pp1_layer2_expert3</title>
<polygon fill="lightgreen" stroke="black" points="232410,-406.29 232186,-406.29 232186,-354.29 232410,-354.29 232410,-406.29"/>
<text text-anchor="middle" x="232298" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="232298" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="232298" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="232298" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert3 -->
<g id="edge1259" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233182.36,-497.41C232985.31,-488.25 232679.63,-466.79 232419,-417.06 232407.57,-414.88 232395.67,-412.06 232383.99,-408.97"/>
<polygon fill="black" stroke="black" points="232384.82,-405.57 232374.25,-406.31 232382.98,-412.32 232384.82,-405.57"/>
</g>
<!-- dp2_pp1_layer2_expert4 -->
<g id="node772" class="node">
<title>dp2_pp1_layer2_expert4</title>
<polygon fill="lightgreen" stroke="black" points="232652,-406.29 232428,-406.29 232428,-354.29 232652,-354.29 232652,-406.29"/>
<text text-anchor="middle" x="232540" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="232540" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="232540" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="232540" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert4 -->
<g id="edge1260" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233173.43,-487.98C233027.99,-474.71 232831.64,-452.25 232661,-417.06 232650.05,-414.8 232638.65,-412.02 232627.43,-409.02"/>
<polygon fill="black" stroke="black" points="232628.19,-405.6 232617.62,-406.33 232626.34,-412.35 232628.19,-405.6"/>
</g>
<!-- dp2_pp1_layer2_expert5 -->
<g id="node773" class="node">
<title>dp2_pp1_layer2_expert5</title>
<polygon fill="lightgreen" stroke="black" points="232894,-406.29 232670,-406.29 232670,-354.29 232894,-354.29 232894,-406.29"/>
<text text-anchor="middle" x="232782" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="232782" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="232782" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="232782" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert5 -->
<g id="edge1261" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233153.29,-467.38C233073.5,-453.44 232984,-436.25 232903,-417.06 232892.9,-414.67 232882.4,-411.94 232871.99,-409.07"/>
<polygon fill="black" stroke="black" points="232872.62,-405.62 232862.05,-406.3 232870.74,-412.36 232872.62,-405.62"/>
</g>
<!-- dp2_pp1_layer2_expert6 -->
<g id="node774" class="node">
<title>dp2_pp1_layer2_expert6</title>
<polygon fill="lightgreen" stroke="black" points="233136,-406.29 232912,-406.29 232912,-354.29 233136,-354.29 233136,-406.29"/>
<text text-anchor="middle" x="233024" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="233024" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="233024" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="233024" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert6 -->
<g id="edge1262" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233235.94,-452.97C233192.16,-438.16 233145.94,-422.53 233107.87,-409.66"/>
<polygon fill="black" stroke="black" points="233108.97,-406.33 233098.38,-406.45 233106.73,-412.97 233108.97,-406.33"/>
</g>
<!-- dp2_pp1_layer2_expert7 -->
<g id="node775" class="node">
<title>dp2_pp1_layer2_expert7</title>
<polygon fill="lightgreen" stroke="black" points="233378,-406.29 233154,-406.29 233154,-354.29 233378,-354.29 233378,-406.29"/>
<text text-anchor="middle" x="233266" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="233266" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="233266" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="233266" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert7 -->
<g id="edge1263" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233336.38,-452.71C233323.3,-439.43 233309.58,-425.51 233297.76,-413.52"/>
<polygon fill="black" stroke="black" points="233300.19,-411 233290.68,-406.33 233295.2,-415.91 233300.19,-411"/>
</g>
<!-- dp2_pp1_layer2_expert8 -->
<g id="node776" class="node">
<title>dp2_pp1_layer2_expert8</title>
<polygon fill="lightgreen" stroke="black" points="233620,-406.29 233396,-406.29 233396,-354.29 233620,-354.29 233620,-406.29"/>
<text text-anchor="middle" x="233508" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="233508" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="233508" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="233508" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert8 -->
<g id="edge1264" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233437.61,-452.71C233450.7,-439.43 233464.42,-425.51 233476.23,-413.52"/>
<polygon fill="black" stroke="black" points="233478.79,-415.91 233483.32,-406.33 233473.81,-411 233478.79,-415.91"/>
</g>
<!-- dp2_pp1_layer2_expert9 -->
<g id="node777" class="node">
<title>dp2_pp1_layer2_expert9</title>
<polygon fill="lightgreen" stroke="black" points="233862,-406.29 233638,-406.29 233638,-354.29 233862,-354.29 233862,-406.29"/>
<text text-anchor="middle" x="233750" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="233750" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="233750" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="233750" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert9 -->
<g id="edge1265" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233534.38,-454.21C233579.29,-439.03 233627.08,-422.86 233666.23,-409.62"/>
<polygon fill="black" stroke="black" points="233667.64,-412.84 233675.99,-406.32 233665.4,-406.21 233667.64,-412.84"/>
</g>
<!-- dp2_pp1_layer2_expert10 -->
<g id="node778" class="node">
<title>dp2_pp1_layer2_expert10</title>
<polygon fill="lightgreen" stroke="black" points="234104,-406.29 233880,-406.29 233880,-354.29 234104,-354.29 234104,-406.29"/>
<text text-anchor="middle" x="233992" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="233992" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="233992" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="233992" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert10 -->
<g id="edge1266" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233557.89,-478.04C233650.98,-462.69 233767.88,-441.49 233871,-417.06 233881.09,-414.67 233891.6,-411.94 233902.01,-409.07"/>
<polygon fill="black" stroke="black" points="233903.26,-412.36 233911.95,-406.3 233901.37,-405.62 233903.26,-412.36"/>
</g>
<!-- dp2_pp1_layer2_expert11 -->
<g id="node779" class="node">
<title>dp2_pp1_layer2_expert11</title>
<polygon fill="lightgreen" stroke="black" points="234346,-406.29 234122,-406.29 234122,-354.29 234346,-354.29 234346,-406.29"/>
<text text-anchor="middle" x="234234" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="234234" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="234234" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="234234" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert11 -->
<g id="edge1267" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233569.99,-490.7C233717.62,-477.88 233930.08,-454.78 234113,-417.06 234123.95,-414.8 234135.35,-412.02 234146.57,-409.02"/>
<polygon fill="black" stroke="black" points="234147.66,-412.35 234156.38,-406.33 234145.81,-405.6 234147.66,-412.35"/>
</g>
<!-- dp2_pp1_layer2_expert12 -->
<g id="node780" class="node">
<title>dp2_pp1_layer2_expert12</title>
<polygon fill="lightgreen" stroke="black" points="234588,-406.29 234364,-406.29 234364,-354.29 234588,-354.29 234588,-406.29"/>
<text text-anchor="middle" x="234476" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="234476" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="234476" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="234476" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert12 -->
<g id="edge1268" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233577.27,-498.07C233773.59,-489.29 234087.95,-468.01 234355,-417.06 234366.43,-414.88 234378.33,-412.06 234390.01,-408.97"/>
<polygon fill="black" stroke="black" points="234391.02,-412.32 234399.75,-406.31 234389.18,-405.57 234391.02,-412.32"/>
</g>
<!-- dp2_pp1_layer2_expert13 -->
<g id="node781" class="node">
<title>dp2_pp1_layer2_expert13</title>
<polygon fill="lightgreen" stroke="black" points="234830,-406.29 234606,-406.29 234606,-354.29 234830,-354.29 234830,-406.29"/>
<text text-anchor="middle" x="234718" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="234718" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="234718" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="234718" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert13 -->
<g id="edge1269" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233581.93,-502.93C233822.42,-498.58 234242.9,-481.35 234597,-417.06 234608.62,-414.95 234620.71,-412.14 234632.56,-409.03"/>
<polygon fill="black" stroke="black" points="234633.7,-412.34 234642.44,-406.34 234631.87,-405.59 234633.7,-412.34"/>
</g>
<!-- dp2_pp1_layer2_expert14 -->
<g id="node782" class="node">
<title>dp2_pp1_layer2_expert14</title>
<polygon fill="lightgreen" stroke="black" points="235072,-406.29 234848,-406.29 234848,-354.29 235072,-354.29 235072,-406.29"/>
<text text-anchor="middle" x="234960" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="234960" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="234960" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="234960" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert14 -->
<g id="edge1270" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233577.32,-498.04C233914.17,-486.48 234602.15,-458.6 234839,-417.06 234850.92,-414.97 234863.32,-412.12 234875.46,-408.93"/>
<polygon fill="black" stroke="black" points="234876.38,-412.3 234885.11,-406.3 234874.54,-405.55 234876.38,-412.3"/>
</g>
<!-- dp2_pp1_layer2_expert15 -->
<g id="node783" class="node">
<title>dp2_pp1_layer2_expert15</title>
<polygon fill="lightgreen" stroke="black" points="235314,-406.29 235090,-406.29 235090,-354.29 235314,-354.29 235314,-406.29"/>
<text text-anchor="middle" x="235202" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="235202" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="235202" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="235202" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert15 -->
<g id="edge1271" class="edge">
<title>dp2_pp1_layer2_router&#45;&gt;dp2_pp1_layer2_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233578.94,-499.9C233959.49,-490.72 234797.35,-465.57 235081,-417.06 235093.01,-415.01 235105.51,-412.16 235117.73,-408.95"/>
<polygon fill="black" stroke="black" points="235118.72,-412.31 235127.45,-406.32 235116.88,-405.56 235118.72,-412.31"/>
</g>
<!-- dp2_pp1_layer2_expert_agg -->
<g id="node784" class="node">
<title>dp2_pp1_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="233634.57,-307.52 233240.74,-307.52 233139.43,-203.52 233533.26,-203.52 233634.57,-307.52"/>
<text text-anchor="middle" x="233387" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="233387" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="233387" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="233387" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer2_expert0&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1272" class="edge">
<title>dp2_pp1_layer2_expert0&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M231630.07,-354.29C231649.69,-346.92 231671.97,-339.72 231693,-335.52 231972.13,-279.86 232795.93,-263.21 233182.43,-258.4"/>
<polygon fill="black" stroke="black" points="233182.65,-261.9 233192.61,-258.27 233182.57,-254.9 233182.65,-261.9"/>
</g>
<!-- dp2_pp1_layer2_expert1&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1273" class="edge">
<title>dp2_pp1_layer2_expert1&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M231872.39,-354.27C231891.95,-346.95 231914.09,-339.78 231935,-335.52 232167.8,-288.16 232843.09,-267.74 233184.43,-260.24"/>
<polygon fill="black" stroke="black" points="233184.51,-263.74 233194.43,-260.03 233184.35,-256.74 233184.51,-263.74"/>
</g>
<!-- dp2_pp1_layer2_expert2&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1274" class="edge">
<title>dp2_pp1_layer2_expert2&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M232114.73,-354.29C232134.21,-347.01 232156.23,-339.87 232177,-335.52 232363.91,-296.44 232893.54,-273.07 233186.3,-262.78"/>
<polygon fill="black" stroke="black" points="233186.74,-266.27 233196.61,-262.42 233186.5,-259.27 233186.74,-266.27"/>
</g>
<!-- dp2_pp1_layer2_expert3&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1275" class="edge">
<title>dp2_pp1_layer2_expert3&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M232357.39,-354.26C232376.72,-347.07 232398.48,-339.99 232419,-335.52 232677.91,-279.18 232983.7,-262.24 233181.26,-257.56"/>
<polygon fill="black" stroke="black" points="233181.55,-261.06 233191.47,-257.33 233181.39,-254.06 233181.55,-261.06"/>
</g>
<!-- dp2_pp1_layer2_expert4&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1276" class="edge">
<title>dp2_pp1_layer2_expert4&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M232600.39,-354.24C232619.49,-347.2 232640.87,-340.19 232661,-335.52 232836.82,-294.77 233041.6,-274.91 233188.75,-265.31"/>
<polygon fill="black" stroke="black" points="233189.05,-268.8 233198.81,-264.67 233188.6,-261.82 233189.05,-268.8"/>
</g>
<!-- dp2_pp1_layer2_expert5&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1277" class="edge">
<title>dp2_pp1_layer2_expert5&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M232844.42,-354.22C232863.04,-347.42 232883.65,-340.55 232903,-335.52 233000.09,-310.27 233110.34,-291.53 233201.07,-278.65"/>
<polygon fill="black" stroke="black" points="233201.78,-282.09 233211.19,-277.23 233200.8,-275.16 233201.78,-282.09"/>
</g>
<!-- dp2_pp1_layer2_expert6&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1278" class="edge">
<title>dp2_pp1_layer2_expert6&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M233092.02,-354.26C233109.26,-348.03 233127.78,-341.44 233145,-335.52 233171.73,-326.33 233200.21,-316.8 233227.89,-307.67"/>
<polygon fill="black" stroke="black" points="233229.24,-310.91 233237.65,-304.46 233227.06,-304.26 233229.24,-310.91"/>
</g>
<!-- dp2_pp1_layer2_expert7&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1279" class="edge">
<title>dp2_pp1_layer2_expert7&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M233290.78,-354.15C233302.02,-342.74 233315.83,-328.73 233329.45,-314.92"/>
<polygon fill="black" stroke="black" points="233332,-317.31 233336.53,-307.73 233327.02,-312.39 233332,-317.31"/>
</g>
<!-- dp2_pp1_layer2_expert8&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1280" class="edge">
<title>dp2_pp1_layer2_expert8&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M233483.22,-354.15C233471.97,-342.74 233458.16,-328.73 233444.55,-314.92"/>
<polygon fill="black" stroke="black" points="233446.98,-312.39 233437.47,-307.73 233441.99,-317.31 233446.98,-312.39"/>
</g>
<!-- dp2_pp1_layer2_expert9&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1281" class="edge">
<title>dp2_pp1_layer2_expert9&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M233681.98,-354.26C233664.73,-348.03 233646.21,-341.44 233629,-335.52 233605.29,-327.37 233580.21,-318.95 233555.53,-310.78"/>
<polygon fill="black" stroke="black" points="233556.32,-307.36 233545.73,-307.54 233554.12,-314 233556.32,-307.36"/>
</g>
<!-- dp2_pp1_layer2_expert10&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1282" class="edge">
<title>dp2_pp1_layer2_expert10&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M233929.58,-354.22C233910.96,-347.42 233890.35,-340.55 233871,-335.52 233790.99,-314.71 233702.05,-298.33 233622.46,-286"/>
<polygon fill="black" stroke="black" points="233622.71,-282.5 233612.3,-284.44 233621.65,-289.41 233622.71,-282.5"/>
</g>
<!-- dp2_pp1_layer2_expert11&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1283" class="edge">
<title>dp2_pp1_layer2_expert11&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M234173.61,-354.24C234154.51,-347.2 234133.13,-340.19 234113,-335.52 233944.74,-296.53 233749.97,-276.66 233604.55,-266.61"/>
<polygon fill="black" stroke="black" points="233604.38,-263.09 233594.16,-265.9 233603.9,-270.07 233604.38,-263.09"/>
</g>
<!-- dp2_pp1_layer2_expert12&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1284" class="edge">
<title>dp2_pp1_layer2_expert12&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M234416.61,-354.26C234397.28,-347.07 234375.52,-339.99 234355,-335.52 234097.51,-279.49 233793.64,-262.43 233595.99,-257.64"/>
<polygon fill="black" stroke="black" points="233595.86,-254.14 233585.78,-257.4 233595.69,-261.13 233595.86,-254.14"/>
</g>
<!-- dp2_pp1_layer2_expert13&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1285" class="edge">
<title>dp2_pp1_layer2_expert13&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M234659.27,-354.29C234639.79,-347.01 234617.77,-339.87 234597,-335.52 234413.02,-297.05 233896.97,-273.81 233601.63,-263.27"/>
<polygon fill="black" stroke="black" points="233601.33,-259.76 233591.21,-262.9 233601.08,-266.76 233601.33,-259.76"/>
</g>
<!-- dp2_pp1_layer2_expert14&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1286" class="edge">
<title>dp2_pp1_layer2_expert14&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M234901.6,-354.27C234882.05,-346.95 234859.9,-339.78 234839,-335.52 234608.27,-288.58 233942.86,-268.1 233598.74,-260.45"/>
<polygon fill="black" stroke="black" points="233598.73,-256.94 233588.65,-260.22 233598.57,-263.94 233598.73,-256.94"/>
</g>
<!-- dp2_pp1_layer2_expert15&#45;&gt;dp2_pp1_layer2_expert_agg -->
<g id="edge1287" class="edge">
<title>dp2_pp1_layer2_expert15&#45;&gt;dp2_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M235143.93,-354.29C235124.3,-346.92 235102.03,-339.72 235081,-335.52 234803.21,-280.12 233985.98,-263.37 233597.17,-258.47"/>
<polygon fill="black" stroke="black" points="233596.97,-254.97 233586.93,-258.34 233596.88,-261.97 233596.97,-254.97"/>
</g>
<!-- dp2_pp1_layer3_attn_tp0 -->
<g id="node785" class="node">
<title>dp2_pp1_layer3_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="230869.5,-531.06 230604.5,-531.06 230604.5,-479.06 230869.5,-479.06 230869.5,-531.06"/>
<text text-anchor="middle" x="230737" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="230737" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="230737" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="230737" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer2_expert_agg&#45;&gt;dp2_pp1_layer3_attn_tp0 -->
<g id="edge1289" class="edge">
<title>dp2_pp1_layer2_expert_agg&#45;&gt;dp2_pp1_layer3_attn_tp0</title>
<path fill="none" stroke="black" d="M233194.78,-260.41C232774.38,-269.54 231784.17,-294.77 231451,-335.52 231418.8,-339.46 230910.23,-444.29 230879,-453.06 230856.37,-459.41 230832.16,-467.58 230810.26,-475.5"/>
<polygon fill="black" stroke="black" points="230808.89,-472.28 230800.7,-479 230811.29,-478.85 230808.89,-472.28"/>
</g>
<!-- dp2_pp1_layer3_attn_allreduce -->
<g id="node786" class="node">
<title>dp2_pp1_layer3_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="230866" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="230866" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="230866" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="230866" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="230866" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_attn_tp0&#45;&gt;dp2_pp1_layer3_attn_allreduce -->
<g id="edge1290" class="edge">
<title>dp2_pp1_layer3_attn_tp0&#45;&gt;dp2_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M230763.41,-478.92C230780.15,-463 230802.21,-442 230821.58,-423.56"/>
<polygon fill="black" stroke="black" points="230824.03,-426.07 230828.86,-416.64 230819.2,-421 230824.03,-426.07"/>
</g>
<!-- dp2_pp1_layer3_router -->
<g id="node790" class="node">
<title>dp2_pp1_layer3_router</title>
<polygon fill="lightyellow" stroke="black" points="228617.57,-557.06 228223.74,-557.06 228122.43,-453.06 228516.26,-453.06 228617.57,-557.06"/>
<text text-anchor="middle" x="228370" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="228370" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="228370" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="228370" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_attn_allreduce&#45;&gt;dp2_pp1_layer3_router -->
<g id="edge1326" class="edge">
<title>dp2_pp1_layer3_attn_allreduce&#45;&gt;dp2_pp1_layer3_router</title>
<path fill="none" stroke="black" d="M230706.08,-392.38C230594.77,-399.9 230442.89,-409.76 230309,-417.06 229673.5,-451.72 228920.28,-482.59 228568.96,-496.4"/>
<polygon fill="black" stroke="black" points="228568.8,-492.91 228558.94,-496.79 228569.07,-499.9 228568.8,-492.91"/>
</g>
<!-- dp2_pp1_layer3_attn_tp1 -->
<g id="node787" class="node">
<title>dp2_pp1_layer3_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="231152.5,-531.06 230887.5,-531.06 230887.5,-479.06 231152.5,-479.06 231152.5,-531.06"/>
<text text-anchor="middle" x="231020" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="231020" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="231020" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="231020" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer3_attn_tp1&#45;&gt;dp2_pp1_layer3_attn_allreduce -->
<g id="edge1291" class="edge">
<title>dp2_pp1_layer3_attn_tp1&#45;&gt;dp2_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M230988.46,-478.92C230967.99,-462.6 230940.83,-440.94 230917.29,-422.18"/>
<polygon fill="black" stroke="black" points="230919.46,-419.44 230909.46,-415.94 230915.1,-424.91 230919.46,-419.44"/>
</g>
<!-- dp2_pp1_layer3_attn_tp2 -->
<g id="node788" class="node">
<title>dp2_pp1_layer3_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="230586.5,-531.06 230321.5,-531.06 230321.5,-479.06 230586.5,-479.06 230586.5,-531.06"/>
<text text-anchor="middle" x="230454" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="230454" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="230454" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="230454" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer3_attn_tp2&#45;&gt;dp2_pp1_layer3_attn_allreduce -->
<g id="edge1292" class="edge">
<title>dp2_pp1_layer3_attn_tp2&#45;&gt;dp2_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M230520.07,-479.02C230543.85,-470.35 230570.99,-460.86 230596,-453.06 230644.74,-437.86 230699.05,-423.03 230746.1,-410.83"/>
<polygon fill="black" stroke="black" points="230747.22,-414.15 230756.03,-408.26 230745.47,-407.38 230747.22,-414.15"/>
</g>
<!-- dp2_pp1_layer3_attn_tp3 -->
<g id="node789" class="node">
<title>dp2_pp1_layer3_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="231435.5,-531.06 231170.5,-531.06 231170.5,-479.06 231435.5,-479.06 231435.5,-531.06"/>
<text text-anchor="middle" x="231303" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="231303" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="231303" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="231303" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer3_attn_tp3&#45;&gt;dp2_pp1_layer3_attn_allreduce -->
<g id="edge1293" class="edge">
<title>dp2_pp1_layer3_attn_tp3&#45;&gt;dp2_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M231238.21,-478.95C231214.43,-470.18 231187.17,-460.64 231162,-453.06 231107.42,-436.63 231046.31,-421.31 230993.86,-409.08"/>
<polygon fill="black" stroke="black" points="230994.37,-405.6 230983.83,-406.75 230992.78,-412.42 230994.37,-405.6"/>
</g>
<!-- dp2_pp1_layer3_expert0 -->
<g id="node791" class="node">
<title>dp2_pp1_layer3_expert0</title>
<polygon fill="lightgreen" stroke="black" points="226667,-406.29 226443,-406.29 226443,-354.29 226667,-354.29 226667,-406.29"/>
<text text-anchor="middle" x="226555" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="226555" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="226555" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="226555" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert0 -->
<g id="edge1294" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228167.73,-499.65C227782.55,-490.26 226957.11,-465.13 226676,-417.06 226663.99,-415.01 226651.48,-412.16 226639.27,-408.95"/>
<polygon fill="black" stroke="black" points="226640.11,-405.56 226629.54,-406.32 226638.28,-412.31 226640.11,-405.56"/>
</g>
<!-- dp2_pp1_layer3_expert1 -->
<g id="node792" class="node">
<title>dp2_pp1_layer3_expert1</title>
<polygon fill="lightgreen" stroke="black" points="226909,-406.29 226685,-406.29 226685,-354.29 226909,-354.29 226909,-406.29"/>
<text text-anchor="middle" x="226797" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="226797" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="226797" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="226797" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert1 -->
<g id="edge1295" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228165.55,-497.55C227823.94,-485.71 227151.58,-458.03 226918,-417.06 226906.08,-414.97 226893.67,-412.12 226881.54,-408.93"/>
<polygon fill="black" stroke="black" points="226882.45,-405.55 226871.89,-406.3 226880.62,-412.3 226882.45,-405.55"/>
</g>
<!-- dp2_pp1_layer3_expert2 -->
<g id="node793" class="node">
<title>dp2_pp1_layer3_expert2</title>
<polygon fill="lightgreen" stroke="black" points="227151,-406.29 226927,-406.29 226927,-354.29 227151,-354.29 227151,-406.29"/>
<text text-anchor="middle" x="227039" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="227039" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="227039" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="227039" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert2 -->
<g id="edge1296" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228170.82,-502.85C227929.66,-498.37 227512.02,-480.97 227160,-417.06 227148.38,-414.95 227136.29,-412.14 227124.44,-409.03"/>
<polygon fill="black" stroke="black" points="227125.13,-405.59 227114.56,-406.34 227123.29,-412.34 227125.13,-405.59"/>
</g>
<!-- dp2_pp1_layer3_expert3 -->
<g id="node794" class="node">
<title>dp2_pp1_layer3_expert3</title>
<polygon fill="lightgreen" stroke="black" points="227393,-406.29 227169,-406.29 227169,-354.29 227393,-354.29 227393,-406.29"/>
<text text-anchor="middle" x="227281" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="227281" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="227281" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="227281" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert3 -->
<g id="edge1297" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228165.36,-497.41C227968.31,-488.25 227662.63,-466.79 227402,-417.06 227390.57,-414.88 227378.67,-412.06 227366.99,-408.97"/>
<polygon fill="black" stroke="black" points="227367.82,-405.57 227357.25,-406.31 227365.98,-412.32 227367.82,-405.57"/>
</g>
<!-- dp2_pp1_layer3_expert4 -->
<g id="node795" class="node">
<title>dp2_pp1_layer3_expert4</title>
<polygon fill="lightgreen" stroke="black" points="227635,-406.29 227411,-406.29 227411,-354.29 227635,-354.29 227635,-406.29"/>
<text text-anchor="middle" x="227523" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="227523" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="227523" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="227523" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert4 -->
<g id="edge1298" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228156.43,-487.98C228010.99,-474.71 227814.64,-452.25 227644,-417.06 227633.05,-414.8 227621.65,-412.02 227610.43,-409.02"/>
<polygon fill="black" stroke="black" points="227611.19,-405.6 227600.62,-406.33 227609.34,-412.35 227611.19,-405.6"/>
</g>
<!-- dp2_pp1_layer3_expert5 -->
<g id="node796" class="node">
<title>dp2_pp1_layer3_expert5</title>
<polygon fill="lightgreen" stroke="black" points="227877,-406.29 227653,-406.29 227653,-354.29 227877,-354.29 227877,-406.29"/>
<text text-anchor="middle" x="227765" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="227765" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="227765" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="227765" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert5 -->
<g id="edge1299" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228136.29,-467.38C228056.5,-453.44 227967,-436.25 227886,-417.06 227875.9,-414.67 227865.4,-411.94 227854.99,-409.07"/>
<polygon fill="black" stroke="black" points="227855.62,-405.62 227845.05,-406.3 227853.74,-412.36 227855.62,-405.62"/>
</g>
<!-- dp2_pp1_layer3_expert6 -->
<g id="node797" class="node">
<title>dp2_pp1_layer3_expert6</title>
<polygon fill="lightgreen" stroke="black" points="228119,-406.29 227895,-406.29 227895,-354.29 228119,-354.29 228119,-406.29"/>
<text text-anchor="middle" x="228007" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="228007" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="228007" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="228007" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert6 -->
<g id="edge1300" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228218.94,-452.97C228175.16,-438.16 228128.94,-422.53 228090.87,-409.66"/>
<polygon fill="black" stroke="black" points="228091.97,-406.33 228081.38,-406.45 228089.73,-412.97 228091.97,-406.33"/>
</g>
<!-- dp2_pp1_layer3_expert7 -->
<g id="node798" class="node">
<title>dp2_pp1_layer3_expert7</title>
<polygon fill="lightgreen" stroke="black" points="228361,-406.29 228137,-406.29 228137,-354.29 228361,-354.29 228361,-406.29"/>
<text text-anchor="middle" x="228249" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="228249" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="228249" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="228249" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert7 -->
<g id="edge1301" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228319.38,-452.71C228306.3,-439.43 228292.58,-425.51 228280.76,-413.52"/>
<polygon fill="black" stroke="black" points="228283.19,-411 228273.68,-406.33 228278.2,-415.91 228283.19,-411"/>
</g>
<!-- dp2_pp1_layer3_expert8 -->
<g id="node799" class="node">
<title>dp2_pp1_layer3_expert8</title>
<polygon fill="lightgreen" stroke="black" points="228603,-406.29 228379,-406.29 228379,-354.29 228603,-354.29 228603,-406.29"/>
<text text-anchor="middle" x="228491" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="228491" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="228491" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="228491" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert8 -->
<g id="edge1302" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228420.61,-452.71C228433.7,-439.43 228447.42,-425.51 228459.23,-413.52"/>
<polygon fill="black" stroke="black" points="228461.79,-415.91 228466.32,-406.33 228456.81,-411 228461.79,-415.91"/>
</g>
<!-- dp2_pp1_layer3_expert9 -->
<g id="node800" class="node">
<title>dp2_pp1_layer3_expert9</title>
<polygon fill="lightgreen" stroke="black" points="228845,-406.29 228621,-406.29 228621,-354.29 228845,-354.29 228845,-406.29"/>
<text text-anchor="middle" x="228733" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="228733" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="228733" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="228733" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert9 -->
<g id="edge1303" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228517.38,-454.21C228562.29,-439.03 228610.08,-422.86 228649.23,-409.62"/>
<polygon fill="black" stroke="black" points="228650.64,-412.84 228658.99,-406.32 228648.4,-406.21 228650.64,-412.84"/>
</g>
<!-- dp2_pp1_layer3_expert10 -->
<g id="node801" class="node">
<title>dp2_pp1_layer3_expert10</title>
<polygon fill="lightgreen" stroke="black" points="229087,-406.29 228863,-406.29 228863,-354.29 229087,-354.29 229087,-406.29"/>
<text text-anchor="middle" x="228975" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="228975" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="228975" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="228975" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert10 -->
<g id="edge1304" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228540.89,-478.04C228633.98,-462.69 228750.88,-441.49 228854,-417.06 228864.09,-414.67 228874.6,-411.94 228885.01,-409.07"/>
<polygon fill="black" stroke="black" points="228886.26,-412.36 228894.95,-406.3 228884.37,-405.62 228886.26,-412.36"/>
</g>
<!-- dp2_pp1_layer3_expert11 -->
<g id="node802" class="node">
<title>dp2_pp1_layer3_expert11</title>
<polygon fill="lightgreen" stroke="black" points="229329,-406.29 229105,-406.29 229105,-354.29 229329,-354.29 229329,-406.29"/>
<text text-anchor="middle" x="229217" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="229217" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="229217" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="229217" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert11 -->
<g id="edge1305" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228552.99,-490.7C228700.62,-477.88 228913.08,-454.78 229096,-417.06 229106.95,-414.8 229118.35,-412.02 229129.57,-409.02"/>
<polygon fill="black" stroke="black" points="229130.66,-412.35 229139.38,-406.33 229128.81,-405.6 229130.66,-412.35"/>
</g>
<!-- dp2_pp1_layer3_expert12 -->
<g id="node803" class="node">
<title>dp2_pp1_layer3_expert12</title>
<polygon fill="lightgreen" stroke="black" points="229571,-406.29 229347,-406.29 229347,-354.29 229571,-354.29 229571,-406.29"/>
<text text-anchor="middle" x="229459" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="229459" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="229459" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="229459" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert12 -->
<g id="edge1306" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228560.27,-498.07C228756.59,-489.29 229070.95,-468.01 229338,-417.06 229349.43,-414.88 229361.33,-412.06 229373.01,-408.97"/>
<polygon fill="black" stroke="black" points="229374.02,-412.32 229382.75,-406.31 229372.18,-405.57 229374.02,-412.32"/>
</g>
<!-- dp2_pp1_layer3_expert13 -->
<g id="node804" class="node">
<title>dp2_pp1_layer3_expert13</title>
<polygon fill="lightgreen" stroke="black" points="229813,-406.29 229589,-406.29 229589,-354.29 229813,-354.29 229813,-406.29"/>
<text text-anchor="middle" x="229701" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="229701" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="229701" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="229701" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert13 -->
<g id="edge1307" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228564.93,-502.93C228805.42,-498.58 229225.9,-481.35 229580,-417.06 229591.62,-414.95 229603.71,-412.14 229615.56,-409.03"/>
<polygon fill="black" stroke="black" points="229616.7,-412.34 229625.44,-406.34 229614.87,-405.59 229616.7,-412.34"/>
</g>
<!-- dp2_pp1_layer3_expert14 -->
<g id="node805" class="node">
<title>dp2_pp1_layer3_expert14</title>
<polygon fill="lightgreen" stroke="black" points="230055,-406.29 229831,-406.29 229831,-354.29 230055,-354.29 230055,-406.29"/>
<text text-anchor="middle" x="229943" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="229943" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="229943" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="229943" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert14 -->
<g id="edge1308" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228560.32,-498.04C228897.17,-486.48 229585.15,-458.6 229822,-417.06 229833.92,-414.97 229846.32,-412.12 229858.46,-408.93"/>
<polygon fill="black" stroke="black" points="229859.38,-412.3 229868.11,-406.3 229857.54,-405.55 229859.38,-412.3"/>
</g>
<!-- dp2_pp1_layer3_expert15 -->
<g id="node806" class="node">
<title>dp2_pp1_layer3_expert15</title>
<polygon fill="lightgreen" stroke="black" points="230297,-406.29 230073,-406.29 230073,-354.29 230297,-354.29 230297,-406.29"/>
<text text-anchor="middle" x="230185" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="230185" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="230185" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="230185" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert15 -->
<g id="edge1309" class="edge">
<title>dp2_pp1_layer3_router&#45;&gt;dp2_pp1_layer3_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M228561.94,-499.9C228942.49,-490.72 229780.35,-465.57 230064,-417.06 230076.01,-415.01 230088.51,-412.16 230100.73,-408.95"/>
<polygon fill="black" stroke="black" points="230101.72,-412.31 230110.45,-406.32 230099.88,-405.56 230101.72,-412.31"/>
</g>
<!-- dp2_pp1_layer3_expert_agg -->
<g id="node807" class="node">
<title>dp2_pp1_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="228617.57,-307.52 228223.74,-307.52 228122.43,-203.52 228516.26,-203.52 228617.57,-307.52"/>
<text text-anchor="middle" x="228370" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="228370" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="228370" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="228370" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer3_expert0&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1310" class="edge">
<title>dp2_pp1_layer3_expert0&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M226613.07,-354.29C226632.69,-346.92 226654.97,-339.72 226676,-335.52 226955.13,-279.86 227778.93,-263.21 228165.43,-258.4"/>
<polygon fill="black" stroke="black" points="228165.65,-261.9 228175.61,-258.27 228165.57,-254.9 228165.65,-261.9"/>
</g>
<!-- dp2_pp1_layer3_expert1&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1311" class="edge">
<title>dp2_pp1_layer3_expert1&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M226855.39,-354.27C226874.95,-346.95 226897.09,-339.78 226918,-335.52 227150.8,-288.16 227826.09,-267.74 228167.43,-260.24"/>
<polygon fill="black" stroke="black" points="228167.51,-263.74 228177.43,-260.03 228167.35,-256.74 228167.51,-263.74"/>
</g>
<!-- dp2_pp1_layer3_expert2&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1312" class="edge">
<title>dp2_pp1_layer3_expert2&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M227097.73,-354.29C227117.21,-347.01 227139.23,-339.87 227160,-335.52 227346.91,-296.44 227876.54,-273.07 228169.3,-262.78"/>
<polygon fill="black" stroke="black" points="228169.74,-266.27 228179.61,-262.42 228169.5,-259.27 228169.74,-266.27"/>
</g>
<!-- dp2_pp1_layer3_expert3&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1313" class="edge">
<title>dp2_pp1_layer3_expert3&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M227340.39,-354.26C227359.72,-347.07 227381.48,-339.99 227402,-335.52 227660.91,-279.18 227966.7,-262.24 228164.26,-257.56"/>
<polygon fill="black" stroke="black" points="228164.55,-261.06 228174.47,-257.33 228164.39,-254.06 228164.55,-261.06"/>
</g>
<!-- dp2_pp1_layer3_expert4&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1314" class="edge">
<title>dp2_pp1_layer3_expert4&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M227583.39,-354.24C227602.49,-347.2 227623.87,-340.19 227644,-335.52 227819.82,-294.77 228024.6,-274.91 228171.75,-265.31"/>
<polygon fill="black" stroke="black" points="228172.05,-268.8 228181.81,-264.67 228171.6,-261.82 228172.05,-268.8"/>
</g>
<!-- dp2_pp1_layer3_expert5&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1315" class="edge">
<title>dp2_pp1_layer3_expert5&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M227827.42,-354.22C227846.04,-347.42 227866.65,-340.55 227886,-335.52 227983.09,-310.27 228093.34,-291.53 228184.07,-278.65"/>
<polygon fill="black" stroke="black" points="228184.78,-282.09 228194.19,-277.23 228183.8,-275.16 228184.78,-282.09"/>
</g>
<!-- dp2_pp1_layer3_expert6&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1316" class="edge">
<title>dp2_pp1_layer3_expert6&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M228075.02,-354.26C228092.26,-348.03 228110.78,-341.44 228128,-335.52 228154.73,-326.33 228183.21,-316.8 228210.89,-307.67"/>
<polygon fill="black" stroke="black" points="228212.24,-310.91 228220.65,-304.46 228210.06,-304.26 228212.24,-310.91"/>
</g>
<!-- dp2_pp1_layer3_expert7&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1317" class="edge">
<title>dp2_pp1_layer3_expert7&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M228273.78,-354.15C228285.02,-342.74 228298.83,-328.73 228312.45,-314.92"/>
<polygon fill="black" stroke="black" points="228315,-317.31 228319.53,-307.73 228310.02,-312.39 228315,-317.31"/>
</g>
<!-- dp2_pp1_layer3_expert8&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1318" class="edge">
<title>dp2_pp1_layer3_expert8&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M228466.22,-354.15C228454.97,-342.74 228441.16,-328.73 228427.55,-314.92"/>
<polygon fill="black" stroke="black" points="228429.98,-312.39 228420.47,-307.73 228424.99,-317.31 228429.98,-312.39"/>
</g>
<!-- dp2_pp1_layer3_expert9&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1319" class="edge">
<title>dp2_pp1_layer3_expert9&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M228664.98,-354.26C228647.73,-348.03 228629.21,-341.44 228612,-335.52 228588.29,-327.37 228563.21,-318.95 228538.53,-310.78"/>
<polygon fill="black" stroke="black" points="228539.32,-307.36 228528.73,-307.54 228537.12,-314 228539.32,-307.36"/>
</g>
<!-- dp2_pp1_layer3_expert10&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1320" class="edge">
<title>dp2_pp1_layer3_expert10&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M228912.58,-354.22C228893.96,-347.42 228873.35,-340.55 228854,-335.52 228773.99,-314.71 228685.05,-298.33 228605.46,-286"/>
<polygon fill="black" stroke="black" points="228605.71,-282.5 228595.3,-284.44 228604.65,-289.41 228605.71,-282.5"/>
</g>
<!-- dp2_pp1_layer3_expert11&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1321" class="edge">
<title>dp2_pp1_layer3_expert11&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M229156.61,-354.24C229137.51,-347.2 229116.13,-340.19 229096,-335.52 228927.74,-296.53 228732.97,-276.66 228587.55,-266.61"/>
<polygon fill="black" stroke="black" points="228587.38,-263.09 228577.16,-265.9 228586.9,-270.07 228587.38,-263.09"/>
</g>
<!-- dp2_pp1_layer3_expert12&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1322" class="edge">
<title>dp2_pp1_layer3_expert12&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M229399.61,-354.26C229380.28,-347.07 229358.52,-339.99 229338,-335.52 229080.51,-279.49 228776.64,-262.43 228578.99,-257.64"/>
<polygon fill="black" stroke="black" points="228578.86,-254.14 228568.78,-257.4 228578.69,-261.13 228578.86,-254.14"/>
</g>
<!-- dp2_pp1_layer3_expert13&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1323" class="edge">
<title>dp2_pp1_layer3_expert13&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M229642.27,-354.29C229622.79,-347.01 229600.77,-339.87 229580,-335.52 229396.02,-297.05 228879.97,-273.81 228584.63,-263.27"/>
<polygon fill="black" stroke="black" points="228584.33,-259.76 228574.21,-262.9 228584.08,-266.76 228584.33,-259.76"/>
</g>
<!-- dp2_pp1_layer3_expert14&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1324" class="edge">
<title>dp2_pp1_layer3_expert14&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M229884.6,-354.27C229865.05,-346.95 229842.9,-339.78 229822,-335.52 229591.27,-288.58 228925.86,-268.1 228581.74,-260.45"/>
<polygon fill="black" stroke="black" points="228581.73,-256.94 228571.65,-260.22 228581.57,-263.94 228581.73,-256.94"/>
</g>
<!-- dp2_pp1_layer3_expert15&#45;&gt;dp2_pp1_layer3_expert_agg -->
<g id="edge1325" class="edge">
<title>dp2_pp1_layer3_expert15&#45;&gt;dp2_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M230126.93,-354.29C230107.3,-346.92 230085.03,-339.72 230064,-335.52 229786.21,-280.12 228968.98,-263.37 228580.17,-258.47"/>
<polygon fill="black" stroke="black" points="228579.97,-254.97 228569.93,-258.34 228579.88,-261.97 228579.97,-254.97"/>
</g>
<!-- dp2_pp1_layer4_attn_tp0 -->
<g id="node808" class="node">
<title>dp2_pp1_layer4_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="225852.5,-531.06 225587.5,-531.06 225587.5,-479.06 225852.5,-479.06 225852.5,-531.06"/>
<text text-anchor="middle" x="225720" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="225720" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="225720" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="225720" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer3_expert_agg&#45;&gt;dp2_pp1_layer4_attn_tp0 -->
<g id="edge1327" class="edge">
<title>dp2_pp1_layer3_expert_agg&#45;&gt;dp2_pp1_layer4_attn_tp0</title>
<path fill="none" stroke="black" d="M228177.78,-260.41C227757.38,-269.54 226767.17,-294.77 226434,-335.52 226401.8,-339.46 225893.23,-444.29 225862,-453.06 225839.37,-459.41 225815.16,-467.58 225793.26,-475.5"/>
<polygon fill="black" stroke="black" points="225791.89,-472.28 225783.7,-479 225794.29,-478.85 225791.89,-472.28"/>
</g>
<!-- dp2_pp1_layer4_attn_allreduce -->
<g id="node809" class="node">
<title>dp2_pp1_layer4_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="225849" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="225849" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="225849" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="225849" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="225849" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_attn_tp0&#45;&gt;dp2_pp1_layer4_attn_allreduce -->
<g id="edge1328" class="edge">
<title>dp2_pp1_layer4_attn_tp0&#45;&gt;dp2_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M225746.41,-478.92C225763.15,-463 225785.21,-442 225804.58,-423.56"/>
<polygon fill="black" stroke="black" points="225807.03,-426.07 225811.86,-416.64 225802.2,-421 225807.03,-426.07"/>
</g>
<!-- dp2_pp1_layer4_router -->
<g id="node813" class="node">
<title>dp2_pp1_layer4_router</title>
<polygon fill="lightyellow" stroke="black" points="223600.57,-557.06 223206.74,-557.06 223105.43,-453.06 223499.26,-453.06 223600.57,-557.06"/>
<text text-anchor="middle" x="223353" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="223353" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="223353" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="223353" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_attn_allreduce&#45;&gt;dp2_pp1_layer4_router -->
<g id="edge1364" class="edge">
<title>dp2_pp1_layer4_attn_allreduce&#45;&gt;dp2_pp1_layer4_router</title>
<path fill="none" stroke="black" d="M225689.08,-392.38C225577.77,-399.9 225425.89,-409.76 225292,-417.06 224656.5,-451.72 223903.28,-482.59 223551.96,-496.4"/>
<polygon fill="black" stroke="black" points="223551.8,-492.91 223541.94,-496.79 223552.07,-499.9 223551.8,-492.91"/>
</g>
<!-- dp2_pp1_layer4_attn_tp1 -->
<g id="node810" class="node">
<title>dp2_pp1_layer4_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="226135.5,-531.06 225870.5,-531.06 225870.5,-479.06 226135.5,-479.06 226135.5,-531.06"/>
<text text-anchor="middle" x="226003" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="226003" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="226003" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="226003" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer4_attn_tp1&#45;&gt;dp2_pp1_layer4_attn_allreduce -->
<g id="edge1329" class="edge">
<title>dp2_pp1_layer4_attn_tp1&#45;&gt;dp2_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M225971.46,-478.92C225950.99,-462.6 225923.83,-440.94 225900.29,-422.18"/>
<polygon fill="black" stroke="black" points="225902.46,-419.44 225892.46,-415.94 225898.1,-424.91 225902.46,-419.44"/>
</g>
<!-- dp2_pp1_layer4_attn_tp2 -->
<g id="node811" class="node">
<title>dp2_pp1_layer4_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="225569.5,-531.06 225304.5,-531.06 225304.5,-479.06 225569.5,-479.06 225569.5,-531.06"/>
<text text-anchor="middle" x="225437" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="225437" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="225437" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="225437" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer4_attn_tp2&#45;&gt;dp2_pp1_layer4_attn_allreduce -->
<g id="edge1330" class="edge">
<title>dp2_pp1_layer4_attn_tp2&#45;&gt;dp2_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M225503.07,-479.02C225526.85,-470.35 225553.99,-460.86 225579,-453.06 225627.74,-437.86 225682.05,-423.03 225729.1,-410.83"/>
<polygon fill="black" stroke="black" points="225730.22,-414.15 225739.03,-408.26 225728.47,-407.38 225730.22,-414.15"/>
</g>
<!-- dp2_pp1_layer4_attn_tp3 -->
<g id="node812" class="node">
<title>dp2_pp1_layer4_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="226418.5,-531.06 226153.5,-531.06 226153.5,-479.06 226418.5,-479.06 226418.5,-531.06"/>
<text text-anchor="middle" x="226286" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="226286" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="226286" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="226286" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer4_attn_tp3&#45;&gt;dp2_pp1_layer4_attn_allreduce -->
<g id="edge1331" class="edge">
<title>dp2_pp1_layer4_attn_tp3&#45;&gt;dp2_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M226221.21,-478.95C226197.43,-470.18 226170.17,-460.64 226145,-453.06 226090.42,-436.63 226029.31,-421.31 225976.86,-409.08"/>
<polygon fill="black" stroke="black" points="225977.37,-405.6 225966.83,-406.75 225975.78,-412.42 225977.37,-405.6"/>
</g>
<!-- dp2_pp1_layer4_expert0 -->
<g id="node814" class="node">
<title>dp2_pp1_layer4_expert0</title>
<polygon fill="lightgreen" stroke="black" points="221650,-406.29 221426,-406.29 221426,-354.29 221650,-354.29 221650,-406.29"/>
<text text-anchor="middle" x="221538" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="221538" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="221538" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="221538" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert0 -->
<g id="edge1332" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223150.73,-499.65C222765.55,-490.26 221940.11,-465.13 221659,-417.06 221646.99,-415.01 221634.48,-412.16 221622.27,-408.95"/>
<polygon fill="black" stroke="black" points="221623.11,-405.56 221612.54,-406.32 221621.28,-412.31 221623.11,-405.56"/>
</g>
<!-- dp2_pp1_layer4_expert1 -->
<g id="node815" class="node">
<title>dp2_pp1_layer4_expert1</title>
<polygon fill="lightgreen" stroke="black" points="221892,-406.29 221668,-406.29 221668,-354.29 221892,-354.29 221892,-406.29"/>
<text text-anchor="middle" x="221780" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="221780" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="221780" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="221780" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert1 -->
<g id="edge1333" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223148.55,-497.55C222806.94,-485.71 222134.58,-458.03 221901,-417.06 221889.08,-414.97 221876.67,-412.12 221864.54,-408.93"/>
<polygon fill="black" stroke="black" points="221865.45,-405.55 221854.89,-406.3 221863.62,-412.3 221865.45,-405.55"/>
</g>
<!-- dp2_pp1_layer4_expert2 -->
<g id="node816" class="node">
<title>dp2_pp1_layer4_expert2</title>
<polygon fill="lightgreen" stroke="black" points="222134,-406.29 221910,-406.29 221910,-354.29 222134,-354.29 222134,-406.29"/>
<text text-anchor="middle" x="222022" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="222022" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="222022" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="222022" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert2 -->
<g id="edge1334" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223153.82,-502.85C222912.66,-498.37 222495.02,-480.97 222143,-417.06 222131.38,-414.95 222119.29,-412.14 222107.44,-409.03"/>
<polygon fill="black" stroke="black" points="222108.13,-405.59 222097.56,-406.34 222106.29,-412.34 222108.13,-405.59"/>
</g>
<!-- dp2_pp1_layer4_expert3 -->
<g id="node817" class="node">
<title>dp2_pp1_layer4_expert3</title>
<polygon fill="lightgreen" stroke="black" points="222376,-406.29 222152,-406.29 222152,-354.29 222376,-354.29 222376,-406.29"/>
<text text-anchor="middle" x="222264" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="222264" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="222264" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="222264" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert3 -->
<g id="edge1335" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223148.36,-497.41C222951.31,-488.25 222645.63,-466.79 222385,-417.06 222373.57,-414.88 222361.67,-412.06 222349.99,-408.97"/>
<polygon fill="black" stroke="black" points="222350.82,-405.57 222340.25,-406.31 222348.98,-412.32 222350.82,-405.57"/>
</g>
<!-- dp2_pp1_layer4_expert4 -->
<g id="node818" class="node">
<title>dp2_pp1_layer4_expert4</title>
<polygon fill="lightgreen" stroke="black" points="222618,-406.29 222394,-406.29 222394,-354.29 222618,-354.29 222618,-406.29"/>
<text text-anchor="middle" x="222506" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="222506" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="222506" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="222506" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert4 -->
<g id="edge1336" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223139.43,-487.98C222993.99,-474.71 222797.64,-452.25 222627,-417.06 222616.05,-414.8 222604.65,-412.02 222593.43,-409.02"/>
<polygon fill="black" stroke="black" points="222594.19,-405.6 222583.62,-406.33 222592.34,-412.35 222594.19,-405.6"/>
</g>
<!-- dp2_pp1_layer4_expert5 -->
<g id="node819" class="node">
<title>dp2_pp1_layer4_expert5</title>
<polygon fill="lightgreen" stroke="black" points="222860,-406.29 222636,-406.29 222636,-354.29 222860,-354.29 222860,-406.29"/>
<text text-anchor="middle" x="222748" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="222748" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="222748" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="222748" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert5 -->
<g id="edge1337" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223119.29,-467.38C223039.5,-453.44 222950,-436.25 222869,-417.06 222858.9,-414.67 222848.4,-411.94 222837.99,-409.07"/>
<polygon fill="black" stroke="black" points="222838.62,-405.62 222828.05,-406.3 222836.74,-412.36 222838.62,-405.62"/>
</g>
<!-- dp2_pp1_layer4_expert6 -->
<g id="node820" class="node">
<title>dp2_pp1_layer4_expert6</title>
<polygon fill="lightgreen" stroke="black" points="223102,-406.29 222878,-406.29 222878,-354.29 223102,-354.29 223102,-406.29"/>
<text text-anchor="middle" x="222990" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="222990" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="222990" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="222990" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert6 -->
<g id="edge1338" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223201.94,-452.97C223158.16,-438.16 223111.94,-422.53 223073.87,-409.66"/>
<polygon fill="black" stroke="black" points="223074.97,-406.33 223064.38,-406.45 223072.73,-412.97 223074.97,-406.33"/>
</g>
<!-- dp2_pp1_layer4_expert7 -->
<g id="node821" class="node">
<title>dp2_pp1_layer4_expert7</title>
<polygon fill="lightgreen" stroke="black" points="223344,-406.29 223120,-406.29 223120,-354.29 223344,-354.29 223344,-406.29"/>
<text text-anchor="middle" x="223232" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="223232" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="223232" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="223232" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert7 -->
<g id="edge1339" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223302.38,-452.71C223289.3,-439.43 223275.58,-425.51 223263.76,-413.52"/>
<polygon fill="black" stroke="black" points="223266.19,-411 223256.68,-406.33 223261.2,-415.91 223266.19,-411"/>
</g>
<!-- dp2_pp1_layer4_expert8 -->
<g id="node822" class="node">
<title>dp2_pp1_layer4_expert8</title>
<polygon fill="lightgreen" stroke="black" points="223586,-406.29 223362,-406.29 223362,-354.29 223586,-354.29 223586,-406.29"/>
<text text-anchor="middle" x="223474" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="223474" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="223474" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="223474" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert8 -->
<g id="edge1340" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223403.61,-452.71C223416.7,-439.43 223430.42,-425.51 223442.23,-413.52"/>
<polygon fill="black" stroke="black" points="223444.79,-415.91 223449.32,-406.33 223439.81,-411 223444.79,-415.91"/>
</g>
<!-- dp2_pp1_layer4_expert9 -->
<g id="node823" class="node">
<title>dp2_pp1_layer4_expert9</title>
<polygon fill="lightgreen" stroke="black" points="223828,-406.29 223604,-406.29 223604,-354.29 223828,-354.29 223828,-406.29"/>
<text text-anchor="middle" x="223716" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="223716" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="223716" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="223716" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert9 -->
<g id="edge1341" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223500.38,-454.21C223545.29,-439.03 223593.08,-422.86 223632.23,-409.62"/>
<polygon fill="black" stroke="black" points="223633.64,-412.84 223641.99,-406.32 223631.4,-406.21 223633.64,-412.84"/>
</g>
<!-- dp2_pp1_layer4_expert10 -->
<g id="node824" class="node">
<title>dp2_pp1_layer4_expert10</title>
<polygon fill="lightgreen" stroke="black" points="224070,-406.29 223846,-406.29 223846,-354.29 224070,-354.29 224070,-406.29"/>
<text text-anchor="middle" x="223958" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="223958" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="223958" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="223958" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert10 -->
<g id="edge1342" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223523.89,-478.04C223616.98,-462.69 223733.88,-441.49 223837,-417.06 223847.09,-414.67 223857.6,-411.94 223868.01,-409.07"/>
<polygon fill="black" stroke="black" points="223869.26,-412.36 223877.95,-406.3 223867.37,-405.62 223869.26,-412.36"/>
</g>
<!-- dp2_pp1_layer4_expert11 -->
<g id="node825" class="node">
<title>dp2_pp1_layer4_expert11</title>
<polygon fill="lightgreen" stroke="black" points="224312,-406.29 224088,-406.29 224088,-354.29 224312,-354.29 224312,-406.29"/>
<text text-anchor="middle" x="224200" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="224200" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="224200" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="224200" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert11 -->
<g id="edge1343" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223535.99,-490.7C223683.62,-477.88 223896.08,-454.78 224079,-417.06 224089.95,-414.8 224101.35,-412.02 224112.57,-409.02"/>
<polygon fill="black" stroke="black" points="224113.66,-412.35 224122.38,-406.33 224111.81,-405.6 224113.66,-412.35"/>
</g>
<!-- dp2_pp1_layer4_expert12 -->
<g id="node826" class="node">
<title>dp2_pp1_layer4_expert12</title>
<polygon fill="lightgreen" stroke="black" points="224554,-406.29 224330,-406.29 224330,-354.29 224554,-354.29 224554,-406.29"/>
<text text-anchor="middle" x="224442" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="224442" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="224442" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="224442" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert12 -->
<g id="edge1344" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223543.27,-498.07C223739.59,-489.29 224053.95,-468.01 224321,-417.06 224332.43,-414.88 224344.33,-412.06 224356.01,-408.97"/>
<polygon fill="black" stroke="black" points="224357.02,-412.32 224365.75,-406.31 224355.18,-405.57 224357.02,-412.32"/>
</g>
<!-- dp2_pp1_layer4_expert13 -->
<g id="node827" class="node">
<title>dp2_pp1_layer4_expert13</title>
<polygon fill="lightgreen" stroke="black" points="224796,-406.29 224572,-406.29 224572,-354.29 224796,-354.29 224796,-406.29"/>
<text text-anchor="middle" x="224684" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="224684" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="224684" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="224684" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert13 -->
<g id="edge1345" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223547.93,-502.93C223788.42,-498.58 224208.9,-481.35 224563,-417.06 224574.62,-414.95 224586.71,-412.14 224598.56,-409.03"/>
<polygon fill="black" stroke="black" points="224599.7,-412.34 224608.44,-406.34 224597.87,-405.59 224599.7,-412.34"/>
</g>
<!-- dp2_pp1_layer4_expert14 -->
<g id="node828" class="node">
<title>dp2_pp1_layer4_expert14</title>
<polygon fill="lightgreen" stroke="black" points="225038,-406.29 224814,-406.29 224814,-354.29 225038,-354.29 225038,-406.29"/>
<text text-anchor="middle" x="224926" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="224926" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="224926" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="224926" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert14 -->
<g id="edge1346" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223543.32,-498.04C223880.17,-486.48 224568.15,-458.6 224805,-417.06 224816.92,-414.97 224829.32,-412.12 224841.46,-408.93"/>
<polygon fill="black" stroke="black" points="224842.38,-412.3 224851.11,-406.3 224840.54,-405.55 224842.38,-412.3"/>
</g>
<!-- dp2_pp1_layer4_expert15 -->
<g id="node829" class="node">
<title>dp2_pp1_layer4_expert15</title>
<polygon fill="lightgreen" stroke="black" points="225280,-406.29 225056,-406.29 225056,-354.29 225280,-354.29 225280,-406.29"/>
<text text-anchor="middle" x="225168" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="225168" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="225168" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="225168" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert15 -->
<g id="edge1347" class="edge">
<title>dp2_pp1_layer4_router&#45;&gt;dp2_pp1_layer4_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M223544.94,-499.9C223925.49,-490.72 224763.35,-465.57 225047,-417.06 225059.01,-415.01 225071.51,-412.16 225083.73,-408.95"/>
<polygon fill="black" stroke="black" points="225084.72,-412.31 225093.45,-406.32 225082.88,-405.56 225084.72,-412.31"/>
</g>
<!-- dp2_pp1_layer4_expert_agg -->
<g id="node830" class="node">
<title>dp2_pp1_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="223600.57,-307.52 223206.74,-307.52 223105.43,-203.52 223499.26,-203.52 223600.57,-307.52"/>
<text text-anchor="middle" x="223353" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="223353" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="223353" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="223353" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer4_expert0&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1348" class="edge">
<title>dp2_pp1_layer4_expert0&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M221596.07,-354.29C221615.69,-346.92 221637.97,-339.72 221659,-335.52 221938.13,-279.86 222761.93,-263.21 223148.43,-258.4"/>
<polygon fill="black" stroke="black" points="223148.65,-261.9 223158.61,-258.27 223148.57,-254.9 223148.65,-261.9"/>
</g>
<!-- dp2_pp1_layer4_expert1&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1349" class="edge">
<title>dp2_pp1_layer4_expert1&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M221838.39,-354.27C221857.95,-346.95 221880.09,-339.78 221901,-335.52 222133.8,-288.16 222809.09,-267.74 223150.43,-260.24"/>
<polygon fill="black" stroke="black" points="223150.51,-263.74 223160.43,-260.03 223150.35,-256.74 223150.51,-263.74"/>
</g>
<!-- dp2_pp1_layer4_expert2&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1350" class="edge">
<title>dp2_pp1_layer4_expert2&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M222080.73,-354.29C222100.21,-347.01 222122.23,-339.87 222143,-335.52 222329.91,-296.44 222859.54,-273.07 223152.3,-262.78"/>
<polygon fill="black" stroke="black" points="223152.74,-266.27 223162.61,-262.42 223152.5,-259.27 223152.74,-266.27"/>
</g>
<!-- dp2_pp1_layer4_expert3&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1351" class="edge">
<title>dp2_pp1_layer4_expert3&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M222323.39,-354.26C222342.72,-347.07 222364.48,-339.99 222385,-335.52 222643.91,-279.18 222949.7,-262.24 223147.26,-257.56"/>
<polygon fill="black" stroke="black" points="223147.55,-261.06 223157.47,-257.33 223147.39,-254.06 223147.55,-261.06"/>
</g>
<!-- dp2_pp1_layer4_expert4&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1352" class="edge">
<title>dp2_pp1_layer4_expert4&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M222566.39,-354.24C222585.49,-347.2 222606.87,-340.19 222627,-335.52 222802.82,-294.77 223007.6,-274.91 223154.75,-265.31"/>
<polygon fill="black" stroke="black" points="223155.05,-268.8 223164.81,-264.67 223154.6,-261.82 223155.05,-268.8"/>
</g>
<!-- dp2_pp1_layer4_expert5&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1353" class="edge">
<title>dp2_pp1_layer4_expert5&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M222810.42,-354.22C222829.04,-347.42 222849.65,-340.55 222869,-335.52 222966.09,-310.27 223076.34,-291.53 223167.07,-278.65"/>
<polygon fill="black" stroke="black" points="223167.78,-282.09 223177.19,-277.23 223166.8,-275.16 223167.78,-282.09"/>
</g>
<!-- dp2_pp1_layer4_expert6&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1354" class="edge">
<title>dp2_pp1_layer4_expert6&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M223058.02,-354.26C223075.26,-348.03 223093.78,-341.44 223111,-335.52 223137.73,-326.33 223166.21,-316.8 223193.89,-307.67"/>
<polygon fill="black" stroke="black" points="223195.24,-310.91 223203.65,-304.46 223193.06,-304.26 223195.24,-310.91"/>
</g>
<!-- dp2_pp1_layer4_expert7&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1355" class="edge">
<title>dp2_pp1_layer4_expert7&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M223256.78,-354.15C223268.02,-342.74 223281.83,-328.73 223295.45,-314.92"/>
<polygon fill="black" stroke="black" points="223298,-317.31 223302.53,-307.73 223293.02,-312.39 223298,-317.31"/>
</g>
<!-- dp2_pp1_layer4_expert8&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1356" class="edge">
<title>dp2_pp1_layer4_expert8&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M223449.22,-354.15C223437.97,-342.74 223424.16,-328.73 223410.55,-314.92"/>
<polygon fill="black" stroke="black" points="223412.98,-312.39 223403.47,-307.73 223407.99,-317.31 223412.98,-312.39"/>
</g>
<!-- dp2_pp1_layer4_expert9&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1357" class="edge">
<title>dp2_pp1_layer4_expert9&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M223647.98,-354.26C223630.73,-348.03 223612.21,-341.44 223595,-335.52 223571.29,-327.37 223546.21,-318.95 223521.53,-310.78"/>
<polygon fill="black" stroke="black" points="223522.32,-307.36 223511.73,-307.54 223520.12,-314 223522.32,-307.36"/>
</g>
<!-- dp2_pp1_layer4_expert10&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1358" class="edge">
<title>dp2_pp1_layer4_expert10&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M223895.58,-354.22C223876.96,-347.42 223856.35,-340.55 223837,-335.52 223756.99,-314.71 223668.05,-298.33 223588.46,-286"/>
<polygon fill="black" stroke="black" points="223588.71,-282.5 223578.3,-284.44 223587.65,-289.41 223588.71,-282.5"/>
</g>
<!-- dp2_pp1_layer4_expert11&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1359" class="edge">
<title>dp2_pp1_layer4_expert11&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M224139.61,-354.24C224120.51,-347.2 224099.13,-340.19 224079,-335.52 223910.74,-296.53 223715.97,-276.66 223570.55,-266.61"/>
<polygon fill="black" stroke="black" points="223570.38,-263.09 223560.16,-265.9 223569.9,-270.07 223570.38,-263.09"/>
</g>
<!-- dp2_pp1_layer4_expert12&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1360" class="edge">
<title>dp2_pp1_layer4_expert12&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M224382.61,-354.26C224363.28,-347.07 224341.52,-339.99 224321,-335.52 224063.51,-279.49 223759.64,-262.43 223561.99,-257.64"/>
<polygon fill="black" stroke="black" points="223561.86,-254.14 223551.78,-257.4 223561.69,-261.13 223561.86,-254.14"/>
</g>
<!-- dp2_pp1_layer4_expert13&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1361" class="edge">
<title>dp2_pp1_layer4_expert13&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M224625.27,-354.29C224605.79,-347.01 224583.77,-339.87 224563,-335.52 224379.02,-297.05 223862.97,-273.81 223567.63,-263.27"/>
<polygon fill="black" stroke="black" points="223567.33,-259.76 223557.21,-262.9 223567.08,-266.76 223567.33,-259.76"/>
</g>
<!-- dp2_pp1_layer4_expert14&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1362" class="edge">
<title>dp2_pp1_layer4_expert14&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M224867.6,-354.27C224848.05,-346.95 224825.9,-339.78 224805,-335.52 224574.27,-288.58 223908.86,-268.1 223564.74,-260.45"/>
<polygon fill="black" stroke="black" points="223564.73,-256.94 223554.65,-260.22 223564.57,-263.94 223564.73,-256.94"/>
</g>
<!-- dp2_pp1_layer4_expert15&#45;&gt;dp2_pp1_layer4_expert_agg -->
<g id="edge1363" class="edge">
<title>dp2_pp1_layer4_expert15&#45;&gt;dp2_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M225109.93,-354.29C225090.3,-346.92 225068.03,-339.72 225047,-335.52 224769.21,-280.12 223951.98,-263.37 223563.17,-258.47"/>
<polygon fill="black" stroke="black" points="223562.97,-254.97 223552.93,-258.34 223562.88,-261.97 223562.97,-254.97"/>
</g>
<!-- dp2_pp1_layer5_attn_tp0 -->
<g id="node831" class="node">
<title>dp2_pp1_layer5_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="220835.5,-531.06 220570.5,-531.06 220570.5,-479.06 220835.5,-479.06 220835.5,-531.06"/>
<text text-anchor="middle" x="220703" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="220703" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="220703" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="220703" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer4_expert_agg&#45;&gt;dp2_pp1_layer5_attn_tp0 -->
<g id="edge1365" class="edge">
<title>dp2_pp1_layer4_expert_agg&#45;&gt;dp2_pp1_layer5_attn_tp0</title>
<path fill="none" stroke="black" d="M223160.78,-260.41C222740.38,-269.54 221750.17,-294.77 221417,-335.52 221384.8,-339.46 220876.23,-444.29 220845,-453.06 220822.37,-459.41 220798.16,-467.58 220776.26,-475.5"/>
<polygon fill="black" stroke="black" points="220774.89,-472.28 220766.7,-479 220777.29,-478.85 220774.89,-472.28"/>
</g>
<!-- dp2_pp1_layer5_attn_allreduce -->
<g id="node832" class="node">
<title>dp2_pp1_layer5_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="220832" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="220832" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="220832" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="220832" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="220832" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_attn_tp0&#45;&gt;dp2_pp1_layer5_attn_allreduce -->
<g id="edge1366" class="edge">
<title>dp2_pp1_layer5_attn_tp0&#45;&gt;dp2_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M220729.41,-478.92C220746.15,-463 220768.21,-442 220787.58,-423.56"/>
<polygon fill="black" stroke="black" points="220790.03,-426.07 220794.86,-416.64 220785.2,-421 220790.03,-426.07"/>
</g>
<!-- dp2_pp1_layer5_router -->
<g id="node836" class="node">
<title>dp2_pp1_layer5_router</title>
<polygon fill="lightyellow" stroke="black" points="218583.57,-557.06 218189.74,-557.06 218088.43,-453.06 218482.26,-453.06 218583.57,-557.06"/>
<text text-anchor="middle" x="218336" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="218336" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="218336" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="218336" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_attn_allreduce&#45;&gt;dp2_pp1_layer5_router -->
<g id="edge1402" class="edge">
<title>dp2_pp1_layer5_attn_allreduce&#45;&gt;dp2_pp1_layer5_router</title>
<path fill="none" stroke="black" d="M220672.08,-392.38C220560.77,-399.9 220408.89,-409.76 220275,-417.06 219639.5,-451.72 218886.28,-482.59 218534.96,-496.4"/>
<polygon fill="black" stroke="black" points="218534.8,-492.91 218524.94,-496.79 218535.07,-499.9 218534.8,-492.91"/>
</g>
<!-- dp2_pp1_layer5_attn_tp1 -->
<g id="node833" class="node">
<title>dp2_pp1_layer5_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="221118.5,-531.06 220853.5,-531.06 220853.5,-479.06 221118.5,-479.06 221118.5,-531.06"/>
<text text-anchor="middle" x="220986" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="220986" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="220986" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="220986" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer5_attn_tp1&#45;&gt;dp2_pp1_layer5_attn_allreduce -->
<g id="edge1367" class="edge">
<title>dp2_pp1_layer5_attn_tp1&#45;&gt;dp2_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M220954.46,-478.92C220933.99,-462.6 220906.83,-440.94 220883.29,-422.18"/>
<polygon fill="black" stroke="black" points="220885.46,-419.44 220875.46,-415.94 220881.1,-424.91 220885.46,-419.44"/>
</g>
<!-- dp2_pp1_layer5_attn_tp2 -->
<g id="node834" class="node">
<title>dp2_pp1_layer5_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="220552.5,-531.06 220287.5,-531.06 220287.5,-479.06 220552.5,-479.06 220552.5,-531.06"/>
<text text-anchor="middle" x="220420" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="220420" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="220420" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="220420" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer5_attn_tp2&#45;&gt;dp2_pp1_layer5_attn_allreduce -->
<g id="edge1368" class="edge">
<title>dp2_pp1_layer5_attn_tp2&#45;&gt;dp2_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M220486.07,-479.02C220509.85,-470.35 220536.99,-460.86 220562,-453.06 220610.74,-437.86 220665.05,-423.03 220712.1,-410.83"/>
<polygon fill="black" stroke="black" points="220713.22,-414.15 220722.03,-408.26 220711.47,-407.38 220713.22,-414.15"/>
</g>
<!-- dp2_pp1_layer5_attn_tp3 -->
<g id="node835" class="node">
<title>dp2_pp1_layer5_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="221401.5,-531.06 221136.5,-531.06 221136.5,-479.06 221401.5,-479.06 221401.5,-531.06"/>
<text text-anchor="middle" x="221269" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="221269" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="221269" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="221269" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer5_attn_tp3&#45;&gt;dp2_pp1_layer5_attn_allreduce -->
<g id="edge1369" class="edge">
<title>dp2_pp1_layer5_attn_tp3&#45;&gt;dp2_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M221204.21,-478.95C221180.43,-470.18 221153.17,-460.64 221128,-453.06 221073.42,-436.63 221012.31,-421.31 220959.86,-409.08"/>
<polygon fill="black" stroke="black" points="220960.37,-405.6 220949.83,-406.75 220958.78,-412.42 220960.37,-405.6"/>
</g>
<!-- dp2_pp1_layer5_expert0 -->
<g id="node837" class="node">
<title>dp2_pp1_layer5_expert0</title>
<polygon fill="lightgreen" stroke="black" points="216633,-406.29 216409,-406.29 216409,-354.29 216633,-354.29 216633,-406.29"/>
<text text-anchor="middle" x="216521" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="216521" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="216521" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="216521" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert0 -->
<g id="edge1370" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218133.73,-499.65C217748.55,-490.26 216923.11,-465.13 216642,-417.06 216629.99,-415.01 216617.48,-412.16 216605.27,-408.95"/>
<polygon fill="black" stroke="black" points="216606.11,-405.56 216595.54,-406.32 216604.28,-412.31 216606.11,-405.56"/>
</g>
<!-- dp2_pp1_layer5_expert1 -->
<g id="node838" class="node">
<title>dp2_pp1_layer5_expert1</title>
<polygon fill="lightgreen" stroke="black" points="216875,-406.29 216651,-406.29 216651,-354.29 216875,-354.29 216875,-406.29"/>
<text text-anchor="middle" x="216763" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="216763" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="216763" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="216763" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert1 -->
<g id="edge1371" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218131.55,-497.55C217789.94,-485.71 217117.58,-458.03 216884,-417.06 216872.08,-414.97 216859.67,-412.12 216847.54,-408.93"/>
<polygon fill="black" stroke="black" points="216848.45,-405.55 216837.89,-406.3 216846.62,-412.3 216848.45,-405.55"/>
</g>
<!-- dp2_pp1_layer5_expert2 -->
<g id="node839" class="node">
<title>dp2_pp1_layer5_expert2</title>
<polygon fill="lightgreen" stroke="black" points="217117,-406.29 216893,-406.29 216893,-354.29 217117,-354.29 217117,-406.29"/>
<text text-anchor="middle" x="217005" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="217005" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="217005" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="217005" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert2 -->
<g id="edge1372" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218136.82,-502.85C217895.66,-498.37 217478.02,-480.97 217126,-417.06 217114.38,-414.95 217102.29,-412.14 217090.44,-409.03"/>
<polygon fill="black" stroke="black" points="217091.13,-405.59 217080.56,-406.34 217089.29,-412.34 217091.13,-405.59"/>
</g>
<!-- dp2_pp1_layer5_expert3 -->
<g id="node840" class="node">
<title>dp2_pp1_layer5_expert3</title>
<polygon fill="lightgreen" stroke="black" points="217359,-406.29 217135,-406.29 217135,-354.29 217359,-354.29 217359,-406.29"/>
<text text-anchor="middle" x="217247" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="217247" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="217247" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="217247" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert3 -->
<g id="edge1373" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218131.36,-497.41C217934.31,-488.25 217628.63,-466.79 217368,-417.06 217356.57,-414.88 217344.67,-412.06 217332.99,-408.97"/>
<polygon fill="black" stroke="black" points="217333.82,-405.57 217323.25,-406.31 217331.98,-412.32 217333.82,-405.57"/>
</g>
<!-- dp2_pp1_layer5_expert4 -->
<g id="node841" class="node">
<title>dp2_pp1_layer5_expert4</title>
<polygon fill="lightgreen" stroke="black" points="217601,-406.29 217377,-406.29 217377,-354.29 217601,-354.29 217601,-406.29"/>
<text text-anchor="middle" x="217489" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="217489" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="217489" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="217489" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert4 -->
<g id="edge1374" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218122.43,-487.98C217976.99,-474.71 217780.64,-452.25 217610,-417.06 217599.05,-414.8 217587.65,-412.02 217576.43,-409.02"/>
<polygon fill="black" stroke="black" points="217577.19,-405.6 217566.62,-406.33 217575.34,-412.35 217577.19,-405.6"/>
</g>
<!-- dp2_pp1_layer5_expert5 -->
<g id="node842" class="node">
<title>dp2_pp1_layer5_expert5</title>
<polygon fill="lightgreen" stroke="black" points="217843,-406.29 217619,-406.29 217619,-354.29 217843,-354.29 217843,-406.29"/>
<text text-anchor="middle" x="217731" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="217731" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="217731" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="217731" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert5 -->
<g id="edge1375" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218102.29,-467.38C218022.5,-453.44 217933,-436.25 217852,-417.06 217841.9,-414.67 217831.4,-411.94 217820.99,-409.07"/>
<polygon fill="black" stroke="black" points="217821.62,-405.62 217811.05,-406.3 217819.74,-412.36 217821.62,-405.62"/>
</g>
<!-- dp2_pp1_layer5_expert6 -->
<g id="node843" class="node">
<title>dp2_pp1_layer5_expert6</title>
<polygon fill="lightgreen" stroke="black" points="218085,-406.29 217861,-406.29 217861,-354.29 218085,-354.29 218085,-406.29"/>
<text text-anchor="middle" x="217973" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="217973" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="217973" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="217973" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert6 -->
<g id="edge1376" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218184.94,-452.97C218141.16,-438.16 218094.94,-422.53 218056.87,-409.66"/>
<polygon fill="black" stroke="black" points="218057.97,-406.33 218047.38,-406.45 218055.73,-412.97 218057.97,-406.33"/>
</g>
<!-- dp2_pp1_layer5_expert7 -->
<g id="node844" class="node">
<title>dp2_pp1_layer5_expert7</title>
<polygon fill="lightgreen" stroke="black" points="218327,-406.29 218103,-406.29 218103,-354.29 218327,-354.29 218327,-406.29"/>
<text text-anchor="middle" x="218215" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="218215" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="218215" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="218215" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert7 -->
<g id="edge1377" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218285.38,-452.71C218272.3,-439.43 218258.58,-425.51 218246.76,-413.52"/>
<polygon fill="black" stroke="black" points="218249.19,-411 218239.68,-406.33 218244.2,-415.91 218249.19,-411"/>
</g>
<!-- dp2_pp1_layer5_expert8 -->
<g id="node845" class="node">
<title>dp2_pp1_layer5_expert8</title>
<polygon fill="lightgreen" stroke="black" points="218569,-406.29 218345,-406.29 218345,-354.29 218569,-354.29 218569,-406.29"/>
<text text-anchor="middle" x="218457" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="218457" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="218457" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="218457" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert8 -->
<g id="edge1378" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218386.61,-452.71C218399.7,-439.43 218413.42,-425.51 218425.23,-413.52"/>
<polygon fill="black" stroke="black" points="218427.79,-415.91 218432.32,-406.33 218422.81,-411 218427.79,-415.91"/>
</g>
<!-- dp2_pp1_layer5_expert9 -->
<g id="node846" class="node">
<title>dp2_pp1_layer5_expert9</title>
<polygon fill="lightgreen" stroke="black" points="218811,-406.29 218587,-406.29 218587,-354.29 218811,-354.29 218811,-406.29"/>
<text text-anchor="middle" x="218699" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="218699" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="218699" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="218699" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert9 -->
<g id="edge1379" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218483.38,-454.21C218528.29,-439.03 218576.08,-422.86 218615.23,-409.62"/>
<polygon fill="black" stroke="black" points="218616.64,-412.84 218624.99,-406.32 218614.4,-406.21 218616.64,-412.84"/>
</g>
<!-- dp2_pp1_layer5_expert10 -->
<g id="node847" class="node">
<title>dp2_pp1_layer5_expert10</title>
<polygon fill="lightgreen" stroke="black" points="219053,-406.29 218829,-406.29 218829,-354.29 219053,-354.29 219053,-406.29"/>
<text text-anchor="middle" x="218941" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="218941" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="218941" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="218941" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert10 -->
<g id="edge1380" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218506.89,-478.04C218599.98,-462.69 218716.88,-441.49 218820,-417.06 218830.09,-414.67 218840.6,-411.94 218851.01,-409.07"/>
<polygon fill="black" stroke="black" points="218852.26,-412.36 218860.95,-406.3 218850.37,-405.62 218852.26,-412.36"/>
</g>
<!-- dp2_pp1_layer5_expert11 -->
<g id="node848" class="node">
<title>dp2_pp1_layer5_expert11</title>
<polygon fill="lightgreen" stroke="black" points="219295,-406.29 219071,-406.29 219071,-354.29 219295,-354.29 219295,-406.29"/>
<text text-anchor="middle" x="219183" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="219183" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="219183" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="219183" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert11 -->
<g id="edge1381" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218518.99,-490.7C218666.62,-477.88 218879.08,-454.78 219062,-417.06 219072.95,-414.8 219084.35,-412.02 219095.57,-409.02"/>
<polygon fill="black" stroke="black" points="219096.66,-412.35 219105.38,-406.33 219094.81,-405.6 219096.66,-412.35"/>
</g>
<!-- dp2_pp1_layer5_expert12 -->
<g id="node849" class="node">
<title>dp2_pp1_layer5_expert12</title>
<polygon fill="lightgreen" stroke="black" points="219537,-406.29 219313,-406.29 219313,-354.29 219537,-354.29 219537,-406.29"/>
<text text-anchor="middle" x="219425" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="219425" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="219425" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="219425" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert12 -->
<g id="edge1382" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218526.27,-498.07C218722.59,-489.29 219036.95,-468.01 219304,-417.06 219315.43,-414.88 219327.33,-412.06 219339.01,-408.97"/>
<polygon fill="black" stroke="black" points="219340.02,-412.32 219348.75,-406.31 219338.18,-405.57 219340.02,-412.32"/>
</g>
<!-- dp2_pp1_layer5_expert13 -->
<g id="node850" class="node">
<title>dp2_pp1_layer5_expert13</title>
<polygon fill="lightgreen" stroke="black" points="219779,-406.29 219555,-406.29 219555,-354.29 219779,-354.29 219779,-406.29"/>
<text text-anchor="middle" x="219667" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="219667" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="219667" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="219667" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert13 -->
<g id="edge1383" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218530.93,-502.93C218771.42,-498.58 219191.9,-481.35 219546,-417.06 219557.62,-414.95 219569.71,-412.14 219581.56,-409.03"/>
<polygon fill="black" stroke="black" points="219582.7,-412.34 219591.44,-406.34 219580.87,-405.59 219582.7,-412.34"/>
</g>
<!-- dp2_pp1_layer5_expert14 -->
<g id="node851" class="node">
<title>dp2_pp1_layer5_expert14</title>
<polygon fill="lightgreen" stroke="black" points="220021,-406.29 219797,-406.29 219797,-354.29 220021,-354.29 220021,-406.29"/>
<text text-anchor="middle" x="219909" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="219909" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="219909" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="219909" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert14 -->
<g id="edge1384" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218526.32,-498.04C218863.17,-486.48 219551.15,-458.6 219788,-417.06 219799.92,-414.97 219812.32,-412.12 219824.46,-408.93"/>
<polygon fill="black" stroke="black" points="219825.38,-412.3 219834.11,-406.3 219823.54,-405.55 219825.38,-412.3"/>
</g>
<!-- dp2_pp1_layer5_expert15 -->
<g id="node852" class="node">
<title>dp2_pp1_layer5_expert15</title>
<polygon fill="lightgreen" stroke="black" points="220263,-406.29 220039,-406.29 220039,-354.29 220263,-354.29 220263,-406.29"/>
<text text-anchor="middle" x="220151" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="220151" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="220151" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="220151" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert15 -->
<g id="edge1385" class="edge">
<title>dp2_pp1_layer5_router&#45;&gt;dp2_pp1_layer5_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218527.94,-499.9C218908.49,-490.72 219746.35,-465.57 220030,-417.06 220042.01,-415.01 220054.51,-412.16 220066.73,-408.95"/>
<polygon fill="black" stroke="black" points="220067.72,-412.31 220076.45,-406.32 220065.88,-405.56 220067.72,-412.31"/>
</g>
<!-- dp2_pp1_layer5_expert_agg -->
<g id="node853" class="node">
<title>dp2_pp1_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="218583.57,-307.52 218189.74,-307.52 218088.43,-203.52 218482.26,-203.52 218583.57,-307.52"/>
<text text-anchor="middle" x="218336" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="218336" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="218336" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="218336" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer5_expert0&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1386" class="edge">
<title>dp2_pp1_layer5_expert0&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M216579.07,-354.29C216598.69,-346.92 216620.97,-339.72 216642,-335.52 216921.13,-279.86 217744.93,-263.21 218131.43,-258.4"/>
<polygon fill="black" stroke="black" points="218131.65,-261.9 218141.61,-258.27 218131.57,-254.9 218131.65,-261.9"/>
</g>
<!-- dp2_pp1_layer5_expert1&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1387" class="edge">
<title>dp2_pp1_layer5_expert1&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M216821.39,-354.27C216840.95,-346.95 216863.09,-339.78 216884,-335.52 217116.8,-288.16 217792.09,-267.74 218133.43,-260.24"/>
<polygon fill="black" stroke="black" points="218133.51,-263.74 218143.43,-260.03 218133.35,-256.74 218133.51,-263.74"/>
</g>
<!-- dp2_pp1_layer5_expert2&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1388" class="edge">
<title>dp2_pp1_layer5_expert2&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M217063.73,-354.29C217083.21,-347.01 217105.23,-339.87 217126,-335.52 217312.91,-296.44 217842.54,-273.07 218135.3,-262.78"/>
<polygon fill="black" stroke="black" points="218135.74,-266.27 218145.61,-262.42 218135.5,-259.27 218135.74,-266.27"/>
</g>
<!-- dp2_pp1_layer5_expert3&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1389" class="edge">
<title>dp2_pp1_layer5_expert3&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M217306.39,-354.26C217325.72,-347.07 217347.48,-339.99 217368,-335.52 217626.91,-279.18 217932.7,-262.24 218130.26,-257.56"/>
<polygon fill="black" stroke="black" points="218130.55,-261.06 218140.47,-257.33 218130.39,-254.06 218130.55,-261.06"/>
</g>
<!-- dp2_pp1_layer5_expert4&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1390" class="edge">
<title>dp2_pp1_layer5_expert4&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M217549.39,-354.24C217568.49,-347.2 217589.87,-340.19 217610,-335.52 217785.82,-294.77 217990.6,-274.91 218137.75,-265.31"/>
<polygon fill="black" stroke="black" points="218138.05,-268.8 218147.81,-264.67 218137.6,-261.82 218138.05,-268.8"/>
</g>
<!-- dp2_pp1_layer5_expert5&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1391" class="edge">
<title>dp2_pp1_layer5_expert5&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M217793.42,-354.22C217812.04,-347.42 217832.65,-340.55 217852,-335.52 217949.09,-310.27 218059.34,-291.53 218150.07,-278.65"/>
<polygon fill="black" stroke="black" points="218150.78,-282.09 218160.19,-277.23 218149.8,-275.16 218150.78,-282.09"/>
</g>
<!-- dp2_pp1_layer5_expert6&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1392" class="edge">
<title>dp2_pp1_layer5_expert6&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M218041.02,-354.26C218058.26,-348.03 218076.78,-341.44 218094,-335.52 218120.73,-326.33 218149.21,-316.8 218176.89,-307.67"/>
<polygon fill="black" stroke="black" points="218178.24,-310.91 218186.65,-304.46 218176.06,-304.26 218178.24,-310.91"/>
</g>
<!-- dp2_pp1_layer5_expert7&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1393" class="edge">
<title>dp2_pp1_layer5_expert7&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M218239.78,-354.15C218251.02,-342.74 218264.83,-328.73 218278.45,-314.92"/>
<polygon fill="black" stroke="black" points="218281,-317.31 218285.53,-307.73 218276.02,-312.39 218281,-317.31"/>
</g>
<!-- dp2_pp1_layer5_expert8&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1394" class="edge">
<title>dp2_pp1_layer5_expert8&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M218432.22,-354.15C218420.97,-342.74 218407.16,-328.73 218393.55,-314.92"/>
<polygon fill="black" stroke="black" points="218395.98,-312.39 218386.47,-307.73 218390.99,-317.31 218395.98,-312.39"/>
</g>
<!-- dp2_pp1_layer5_expert9&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1395" class="edge">
<title>dp2_pp1_layer5_expert9&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M218630.98,-354.26C218613.73,-348.03 218595.21,-341.44 218578,-335.52 218554.29,-327.37 218529.21,-318.95 218504.53,-310.78"/>
<polygon fill="black" stroke="black" points="218505.32,-307.36 218494.73,-307.54 218503.12,-314 218505.32,-307.36"/>
</g>
<!-- dp2_pp1_layer5_expert10&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1396" class="edge">
<title>dp2_pp1_layer5_expert10&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M218878.58,-354.22C218859.96,-347.42 218839.35,-340.55 218820,-335.52 218739.99,-314.71 218651.05,-298.33 218571.46,-286"/>
<polygon fill="black" stroke="black" points="218571.71,-282.5 218561.3,-284.44 218570.65,-289.41 218571.71,-282.5"/>
</g>
<!-- dp2_pp1_layer5_expert11&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1397" class="edge">
<title>dp2_pp1_layer5_expert11&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M219122.61,-354.24C219103.51,-347.2 219082.13,-340.19 219062,-335.52 218893.74,-296.53 218698.97,-276.66 218553.55,-266.61"/>
<polygon fill="black" stroke="black" points="218553.38,-263.09 218543.16,-265.9 218552.9,-270.07 218553.38,-263.09"/>
</g>
<!-- dp2_pp1_layer5_expert12&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1398" class="edge">
<title>dp2_pp1_layer5_expert12&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M219365.61,-354.26C219346.28,-347.07 219324.52,-339.99 219304,-335.52 219046.51,-279.49 218742.64,-262.43 218544.99,-257.64"/>
<polygon fill="black" stroke="black" points="218544.86,-254.14 218534.78,-257.4 218544.69,-261.13 218544.86,-254.14"/>
</g>
<!-- dp2_pp1_layer5_expert13&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1399" class="edge">
<title>dp2_pp1_layer5_expert13&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M219608.27,-354.29C219588.79,-347.01 219566.77,-339.87 219546,-335.52 219362.02,-297.05 218845.97,-273.81 218550.63,-263.27"/>
<polygon fill="black" stroke="black" points="218550.33,-259.76 218540.21,-262.9 218550.08,-266.76 218550.33,-259.76"/>
</g>
<!-- dp2_pp1_layer5_expert14&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1400" class="edge">
<title>dp2_pp1_layer5_expert14&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M219850.6,-354.27C219831.05,-346.95 219808.9,-339.78 219788,-335.52 219557.27,-288.58 218891.86,-268.1 218547.74,-260.45"/>
<polygon fill="black" stroke="black" points="218547.73,-256.94 218537.65,-260.22 218547.57,-263.94 218547.73,-256.94"/>
</g>
<!-- dp2_pp1_layer5_expert15&#45;&gt;dp2_pp1_layer5_expert_agg -->
<g id="edge1401" class="edge">
<title>dp2_pp1_layer5_expert15&#45;&gt;dp2_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M220092.93,-354.29C220073.3,-346.92 220051.03,-339.72 220030,-335.52 219752.21,-280.12 218934.98,-263.37 218546.17,-258.47"/>
<polygon fill="black" stroke="black" points="218545.97,-254.97 218535.93,-258.34 218545.88,-261.97 218545.97,-254.97"/>
</g>
<!-- dp2_pp1_layer6_attn_tp0 -->
<g id="node854" class="node">
<title>dp2_pp1_layer6_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="215818.5,-531.06 215553.5,-531.06 215553.5,-479.06 215818.5,-479.06 215818.5,-531.06"/>
<text text-anchor="middle" x="215686" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="215686" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="215686" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="215686" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer5_expert_agg&#45;&gt;dp2_pp1_layer6_attn_tp0 -->
<g id="edge1403" class="edge">
<title>dp2_pp1_layer5_expert_agg&#45;&gt;dp2_pp1_layer6_attn_tp0</title>
<path fill="none" stroke="black" d="M218143.78,-260.41C217723.38,-269.54 216733.17,-294.77 216400,-335.52 216367.8,-339.46 215859.23,-444.29 215828,-453.06 215805.37,-459.41 215781.16,-467.58 215759.26,-475.5"/>
<polygon fill="black" stroke="black" points="215757.89,-472.28 215749.7,-479 215760.29,-478.85 215757.89,-472.28"/>
</g>
<!-- dp2_pp1_layer6_attn_allreduce -->
<g id="node855" class="node">
<title>dp2_pp1_layer6_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="215815" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="215815" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="215815" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="215815" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="215815" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_attn_tp0&#45;&gt;dp2_pp1_layer6_attn_allreduce -->
<g id="edge1404" class="edge">
<title>dp2_pp1_layer6_attn_tp0&#45;&gt;dp2_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M215712.41,-478.92C215729.15,-463 215751.21,-442 215770.58,-423.56"/>
<polygon fill="black" stroke="black" points="215773.03,-426.07 215777.86,-416.64 215768.2,-421 215773.03,-426.07"/>
</g>
<!-- dp2_pp1_layer6_router -->
<g id="node859" class="node">
<title>dp2_pp1_layer6_router</title>
<polygon fill="lightyellow" stroke="black" points="213566.57,-557.06 213172.74,-557.06 213071.43,-453.06 213465.26,-453.06 213566.57,-557.06"/>
<text text-anchor="middle" x="213319" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="213319" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="213319" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="213319" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_attn_allreduce&#45;&gt;dp2_pp1_layer6_router -->
<g id="edge1440" class="edge">
<title>dp2_pp1_layer6_attn_allreduce&#45;&gt;dp2_pp1_layer6_router</title>
<path fill="none" stroke="black" d="M215655.08,-392.38C215543.77,-399.9 215391.89,-409.76 215258,-417.06 214622.5,-451.72 213869.28,-482.59 213517.96,-496.4"/>
<polygon fill="black" stroke="black" points="213517.8,-492.91 213507.94,-496.79 213518.07,-499.9 213517.8,-492.91"/>
</g>
<!-- dp2_pp1_layer6_attn_tp1 -->
<g id="node856" class="node">
<title>dp2_pp1_layer6_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="216101.5,-531.06 215836.5,-531.06 215836.5,-479.06 216101.5,-479.06 216101.5,-531.06"/>
<text text-anchor="middle" x="215969" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="215969" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="215969" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="215969" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer6_attn_tp1&#45;&gt;dp2_pp1_layer6_attn_allreduce -->
<g id="edge1405" class="edge">
<title>dp2_pp1_layer6_attn_tp1&#45;&gt;dp2_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M215937.46,-478.92C215916.99,-462.6 215889.83,-440.94 215866.29,-422.18"/>
<polygon fill="black" stroke="black" points="215868.46,-419.44 215858.46,-415.94 215864.1,-424.91 215868.46,-419.44"/>
</g>
<!-- dp2_pp1_layer6_attn_tp2 -->
<g id="node857" class="node">
<title>dp2_pp1_layer6_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="215535.5,-531.06 215270.5,-531.06 215270.5,-479.06 215535.5,-479.06 215535.5,-531.06"/>
<text text-anchor="middle" x="215403" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="215403" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="215403" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="215403" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer6_attn_tp2&#45;&gt;dp2_pp1_layer6_attn_allreduce -->
<g id="edge1406" class="edge">
<title>dp2_pp1_layer6_attn_tp2&#45;&gt;dp2_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M215469.07,-479.02C215492.85,-470.35 215519.99,-460.86 215545,-453.06 215593.74,-437.86 215648.05,-423.03 215695.1,-410.83"/>
<polygon fill="black" stroke="black" points="215696.22,-414.15 215705.03,-408.26 215694.47,-407.38 215696.22,-414.15"/>
</g>
<!-- dp2_pp1_layer6_attn_tp3 -->
<g id="node858" class="node">
<title>dp2_pp1_layer6_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="216384.5,-531.06 216119.5,-531.06 216119.5,-479.06 216384.5,-479.06 216384.5,-531.06"/>
<text text-anchor="middle" x="216252" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="216252" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="216252" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="216252" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer6_attn_tp3&#45;&gt;dp2_pp1_layer6_attn_allreduce -->
<g id="edge1407" class="edge">
<title>dp2_pp1_layer6_attn_tp3&#45;&gt;dp2_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M216187.21,-478.95C216163.43,-470.18 216136.17,-460.64 216111,-453.06 216056.42,-436.63 215995.31,-421.31 215942.86,-409.08"/>
<polygon fill="black" stroke="black" points="215943.37,-405.6 215932.83,-406.75 215941.78,-412.42 215943.37,-405.6"/>
</g>
<!-- dp2_pp1_layer6_expert0 -->
<g id="node860" class="node">
<title>dp2_pp1_layer6_expert0</title>
<polygon fill="lightgreen" stroke="black" points="211616,-406.29 211392,-406.29 211392,-354.29 211616,-354.29 211616,-406.29"/>
<text text-anchor="middle" x="211504" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="211504" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="211504" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="211504" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert0 -->
<g id="edge1408" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213116.73,-499.65C212731.55,-490.26 211906.11,-465.13 211625,-417.06 211612.99,-415.01 211600.48,-412.16 211588.27,-408.95"/>
<polygon fill="black" stroke="black" points="211589.11,-405.56 211578.54,-406.32 211587.28,-412.31 211589.11,-405.56"/>
</g>
<!-- dp2_pp1_layer6_expert1 -->
<g id="node861" class="node">
<title>dp2_pp1_layer6_expert1</title>
<polygon fill="lightgreen" stroke="black" points="211858,-406.29 211634,-406.29 211634,-354.29 211858,-354.29 211858,-406.29"/>
<text text-anchor="middle" x="211746" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="211746" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="211746" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="211746" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert1 -->
<g id="edge1409" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213114.55,-497.55C212772.94,-485.71 212100.58,-458.03 211867,-417.06 211855.08,-414.97 211842.67,-412.12 211830.54,-408.93"/>
<polygon fill="black" stroke="black" points="211831.45,-405.55 211820.89,-406.3 211829.62,-412.3 211831.45,-405.55"/>
</g>
<!-- dp2_pp1_layer6_expert2 -->
<g id="node862" class="node">
<title>dp2_pp1_layer6_expert2</title>
<polygon fill="lightgreen" stroke="black" points="212100,-406.29 211876,-406.29 211876,-354.29 212100,-354.29 212100,-406.29"/>
<text text-anchor="middle" x="211988" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="211988" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="211988" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="211988" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert2 -->
<g id="edge1410" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213119.82,-502.85C212878.66,-498.37 212461.02,-480.97 212109,-417.06 212097.38,-414.95 212085.29,-412.14 212073.44,-409.03"/>
<polygon fill="black" stroke="black" points="212074.13,-405.59 212063.56,-406.34 212072.29,-412.34 212074.13,-405.59"/>
</g>
<!-- dp2_pp1_layer6_expert3 -->
<g id="node863" class="node">
<title>dp2_pp1_layer6_expert3</title>
<polygon fill="lightgreen" stroke="black" points="212342,-406.29 212118,-406.29 212118,-354.29 212342,-354.29 212342,-406.29"/>
<text text-anchor="middle" x="212230" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="212230" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="212230" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="212230" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert3 -->
<g id="edge1411" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213114.36,-497.41C212917.31,-488.25 212611.63,-466.79 212351,-417.06 212339.57,-414.88 212327.67,-412.06 212315.99,-408.97"/>
<polygon fill="black" stroke="black" points="212316.82,-405.57 212306.25,-406.31 212314.98,-412.32 212316.82,-405.57"/>
</g>
<!-- dp2_pp1_layer6_expert4 -->
<g id="node864" class="node">
<title>dp2_pp1_layer6_expert4</title>
<polygon fill="lightgreen" stroke="black" points="212584,-406.29 212360,-406.29 212360,-354.29 212584,-354.29 212584,-406.29"/>
<text text-anchor="middle" x="212472" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="212472" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="212472" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="212472" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert4 -->
<g id="edge1412" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213105.43,-487.98C212959.99,-474.71 212763.64,-452.25 212593,-417.06 212582.05,-414.8 212570.65,-412.02 212559.43,-409.02"/>
<polygon fill="black" stroke="black" points="212560.19,-405.6 212549.62,-406.33 212558.34,-412.35 212560.19,-405.6"/>
</g>
<!-- dp2_pp1_layer6_expert5 -->
<g id="node865" class="node">
<title>dp2_pp1_layer6_expert5</title>
<polygon fill="lightgreen" stroke="black" points="212826,-406.29 212602,-406.29 212602,-354.29 212826,-354.29 212826,-406.29"/>
<text text-anchor="middle" x="212714" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="212714" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="212714" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="212714" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert5 -->
<g id="edge1413" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213085.29,-467.38C213005.5,-453.44 212916,-436.25 212835,-417.06 212824.9,-414.67 212814.4,-411.94 212803.99,-409.07"/>
<polygon fill="black" stroke="black" points="212804.62,-405.62 212794.05,-406.3 212802.74,-412.36 212804.62,-405.62"/>
</g>
<!-- dp2_pp1_layer6_expert6 -->
<g id="node866" class="node">
<title>dp2_pp1_layer6_expert6</title>
<polygon fill="lightgreen" stroke="black" points="213068,-406.29 212844,-406.29 212844,-354.29 213068,-354.29 213068,-406.29"/>
<text text-anchor="middle" x="212956" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="212956" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="212956" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="212956" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert6 -->
<g id="edge1414" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213167.94,-452.97C213124.16,-438.16 213077.94,-422.53 213039.87,-409.66"/>
<polygon fill="black" stroke="black" points="213040.97,-406.33 213030.38,-406.45 213038.73,-412.97 213040.97,-406.33"/>
</g>
<!-- dp2_pp1_layer6_expert7 -->
<g id="node867" class="node">
<title>dp2_pp1_layer6_expert7</title>
<polygon fill="lightgreen" stroke="black" points="213310,-406.29 213086,-406.29 213086,-354.29 213310,-354.29 213310,-406.29"/>
<text text-anchor="middle" x="213198" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="213198" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="213198" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="213198" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert7 -->
<g id="edge1415" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213268.38,-452.71C213255.3,-439.43 213241.58,-425.51 213229.76,-413.52"/>
<polygon fill="black" stroke="black" points="213232.19,-411 213222.68,-406.33 213227.2,-415.91 213232.19,-411"/>
</g>
<!-- dp2_pp1_layer6_expert8 -->
<g id="node868" class="node">
<title>dp2_pp1_layer6_expert8</title>
<polygon fill="lightgreen" stroke="black" points="213552,-406.29 213328,-406.29 213328,-354.29 213552,-354.29 213552,-406.29"/>
<text text-anchor="middle" x="213440" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="213440" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="213440" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="213440" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert8 -->
<g id="edge1416" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213369.61,-452.71C213382.7,-439.43 213396.42,-425.51 213408.23,-413.52"/>
<polygon fill="black" stroke="black" points="213410.79,-415.91 213415.32,-406.33 213405.81,-411 213410.79,-415.91"/>
</g>
<!-- dp2_pp1_layer6_expert9 -->
<g id="node869" class="node">
<title>dp2_pp1_layer6_expert9</title>
<polygon fill="lightgreen" stroke="black" points="213794,-406.29 213570,-406.29 213570,-354.29 213794,-354.29 213794,-406.29"/>
<text text-anchor="middle" x="213682" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="213682" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="213682" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="213682" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert9 -->
<g id="edge1417" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213466.38,-454.21C213511.29,-439.03 213559.08,-422.86 213598.23,-409.62"/>
<polygon fill="black" stroke="black" points="213599.64,-412.84 213607.99,-406.32 213597.4,-406.21 213599.64,-412.84"/>
</g>
<!-- dp2_pp1_layer6_expert10 -->
<g id="node870" class="node">
<title>dp2_pp1_layer6_expert10</title>
<polygon fill="lightgreen" stroke="black" points="214036,-406.29 213812,-406.29 213812,-354.29 214036,-354.29 214036,-406.29"/>
<text text-anchor="middle" x="213924" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="213924" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="213924" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="213924" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert10 -->
<g id="edge1418" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213489.89,-478.04C213582.98,-462.69 213699.88,-441.49 213803,-417.06 213813.09,-414.67 213823.6,-411.94 213834.01,-409.07"/>
<polygon fill="black" stroke="black" points="213835.26,-412.36 213843.95,-406.3 213833.37,-405.62 213835.26,-412.36"/>
</g>
<!-- dp2_pp1_layer6_expert11 -->
<g id="node871" class="node">
<title>dp2_pp1_layer6_expert11</title>
<polygon fill="lightgreen" stroke="black" points="214278,-406.29 214054,-406.29 214054,-354.29 214278,-354.29 214278,-406.29"/>
<text text-anchor="middle" x="214166" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="214166" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="214166" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="214166" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert11 -->
<g id="edge1419" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213501.99,-490.7C213649.62,-477.88 213862.08,-454.78 214045,-417.06 214055.95,-414.8 214067.35,-412.02 214078.57,-409.02"/>
<polygon fill="black" stroke="black" points="214079.66,-412.35 214088.38,-406.33 214077.81,-405.6 214079.66,-412.35"/>
</g>
<!-- dp2_pp1_layer6_expert12 -->
<g id="node872" class="node">
<title>dp2_pp1_layer6_expert12</title>
<polygon fill="lightgreen" stroke="black" points="214520,-406.29 214296,-406.29 214296,-354.29 214520,-354.29 214520,-406.29"/>
<text text-anchor="middle" x="214408" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="214408" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="214408" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="214408" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert12 -->
<g id="edge1420" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213509.27,-498.07C213705.59,-489.29 214019.95,-468.01 214287,-417.06 214298.43,-414.88 214310.33,-412.06 214322.01,-408.97"/>
<polygon fill="black" stroke="black" points="214323.02,-412.32 214331.75,-406.31 214321.18,-405.57 214323.02,-412.32"/>
</g>
<!-- dp2_pp1_layer6_expert13 -->
<g id="node873" class="node">
<title>dp2_pp1_layer6_expert13</title>
<polygon fill="lightgreen" stroke="black" points="214762,-406.29 214538,-406.29 214538,-354.29 214762,-354.29 214762,-406.29"/>
<text text-anchor="middle" x="214650" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="214650" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="214650" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="214650" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert13 -->
<g id="edge1421" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213513.93,-502.93C213754.42,-498.58 214174.9,-481.35 214529,-417.06 214540.62,-414.95 214552.71,-412.14 214564.56,-409.03"/>
<polygon fill="black" stroke="black" points="214565.7,-412.34 214574.44,-406.34 214563.87,-405.59 214565.7,-412.34"/>
</g>
<!-- dp2_pp1_layer6_expert14 -->
<g id="node874" class="node">
<title>dp2_pp1_layer6_expert14</title>
<polygon fill="lightgreen" stroke="black" points="215004,-406.29 214780,-406.29 214780,-354.29 215004,-354.29 215004,-406.29"/>
<text text-anchor="middle" x="214892" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="214892" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="214892" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="214892" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert14 -->
<g id="edge1422" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213509.32,-498.04C213846.17,-486.48 214534.15,-458.6 214771,-417.06 214782.92,-414.97 214795.32,-412.12 214807.46,-408.93"/>
<polygon fill="black" stroke="black" points="214808.38,-412.3 214817.11,-406.3 214806.54,-405.55 214808.38,-412.3"/>
</g>
<!-- dp2_pp1_layer6_expert15 -->
<g id="node875" class="node">
<title>dp2_pp1_layer6_expert15</title>
<polygon fill="lightgreen" stroke="black" points="215246,-406.29 215022,-406.29 215022,-354.29 215246,-354.29 215246,-406.29"/>
<text text-anchor="middle" x="215134" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="215134" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="215134" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="215134" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert15 -->
<g id="edge1423" class="edge">
<title>dp2_pp1_layer6_router&#45;&gt;dp2_pp1_layer6_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M213510.94,-499.9C213891.49,-490.72 214729.35,-465.57 215013,-417.06 215025.01,-415.01 215037.51,-412.16 215049.73,-408.95"/>
<polygon fill="black" stroke="black" points="215050.72,-412.31 215059.45,-406.32 215048.88,-405.56 215050.72,-412.31"/>
</g>
<!-- dp2_pp1_layer6_expert_agg -->
<g id="node876" class="node">
<title>dp2_pp1_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="213566.57,-307.52 213172.74,-307.52 213071.43,-203.52 213465.26,-203.52 213566.57,-307.52"/>
<text text-anchor="middle" x="213319" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="213319" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="213319" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="213319" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer6_expert0&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1424" class="edge">
<title>dp2_pp1_layer6_expert0&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M211562.07,-354.29C211581.69,-346.92 211603.97,-339.72 211625,-335.52 211904.13,-279.86 212727.93,-263.21 213114.43,-258.4"/>
<polygon fill="black" stroke="black" points="213114.65,-261.9 213124.61,-258.27 213114.57,-254.9 213114.65,-261.9"/>
</g>
<!-- dp2_pp1_layer6_expert1&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1425" class="edge">
<title>dp2_pp1_layer6_expert1&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M211804.39,-354.27C211823.95,-346.95 211846.09,-339.78 211867,-335.52 212099.8,-288.16 212775.09,-267.74 213116.43,-260.24"/>
<polygon fill="black" stroke="black" points="213116.51,-263.74 213126.43,-260.03 213116.35,-256.74 213116.51,-263.74"/>
</g>
<!-- dp2_pp1_layer6_expert2&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1426" class="edge">
<title>dp2_pp1_layer6_expert2&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M212046.73,-354.29C212066.21,-347.01 212088.23,-339.87 212109,-335.52 212295.91,-296.44 212825.54,-273.07 213118.3,-262.78"/>
<polygon fill="black" stroke="black" points="213118.74,-266.27 213128.61,-262.42 213118.5,-259.27 213118.74,-266.27"/>
</g>
<!-- dp2_pp1_layer6_expert3&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1427" class="edge">
<title>dp2_pp1_layer6_expert3&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M212289.39,-354.26C212308.72,-347.07 212330.48,-339.99 212351,-335.52 212609.91,-279.18 212915.7,-262.24 213113.26,-257.56"/>
<polygon fill="black" stroke="black" points="213113.55,-261.06 213123.47,-257.33 213113.39,-254.06 213113.55,-261.06"/>
</g>
<!-- dp2_pp1_layer6_expert4&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1428" class="edge">
<title>dp2_pp1_layer6_expert4&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M212532.39,-354.24C212551.49,-347.2 212572.87,-340.19 212593,-335.52 212768.82,-294.77 212973.6,-274.91 213120.75,-265.31"/>
<polygon fill="black" stroke="black" points="213121.05,-268.8 213130.81,-264.67 213120.6,-261.82 213121.05,-268.8"/>
</g>
<!-- dp2_pp1_layer6_expert5&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1429" class="edge">
<title>dp2_pp1_layer6_expert5&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M212776.42,-354.22C212795.04,-347.42 212815.65,-340.55 212835,-335.52 212932.09,-310.27 213042.34,-291.53 213133.07,-278.65"/>
<polygon fill="black" stroke="black" points="213133.78,-282.09 213143.19,-277.23 213132.8,-275.16 213133.78,-282.09"/>
</g>
<!-- dp2_pp1_layer6_expert6&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1430" class="edge">
<title>dp2_pp1_layer6_expert6&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M213024.02,-354.26C213041.26,-348.03 213059.78,-341.44 213077,-335.52 213103.73,-326.33 213132.21,-316.8 213159.89,-307.67"/>
<polygon fill="black" stroke="black" points="213161.24,-310.91 213169.65,-304.46 213159.06,-304.26 213161.24,-310.91"/>
</g>
<!-- dp2_pp1_layer6_expert7&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1431" class="edge">
<title>dp2_pp1_layer6_expert7&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M213222.78,-354.15C213234.02,-342.74 213247.83,-328.73 213261.45,-314.92"/>
<polygon fill="black" stroke="black" points="213264,-317.31 213268.53,-307.73 213259.02,-312.39 213264,-317.31"/>
</g>
<!-- dp2_pp1_layer6_expert8&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1432" class="edge">
<title>dp2_pp1_layer6_expert8&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M213415.22,-354.15C213403.97,-342.74 213390.16,-328.73 213376.55,-314.92"/>
<polygon fill="black" stroke="black" points="213378.98,-312.39 213369.47,-307.73 213373.99,-317.31 213378.98,-312.39"/>
</g>
<!-- dp2_pp1_layer6_expert9&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1433" class="edge">
<title>dp2_pp1_layer6_expert9&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M213613.98,-354.26C213596.73,-348.03 213578.21,-341.44 213561,-335.52 213537.29,-327.37 213512.21,-318.95 213487.53,-310.78"/>
<polygon fill="black" stroke="black" points="213488.32,-307.36 213477.73,-307.54 213486.12,-314 213488.32,-307.36"/>
</g>
<!-- dp2_pp1_layer6_expert10&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1434" class="edge">
<title>dp2_pp1_layer6_expert10&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M213861.58,-354.22C213842.96,-347.42 213822.35,-340.55 213803,-335.52 213722.99,-314.71 213634.05,-298.33 213554.46,-286"/>
<polygon fill="black" stroke="black" points="213554.71,-282.5 213544.3,-284.44 213553.65,-289.41 213554.71,-282.5"/>
</g>
<!-- dp2_pp1_layer6_expert11&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1435" class="edge">
<title>dp2_pp1_layer6_expert11&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M214105.61,-354.24C214086.51,-347.2 214065.13,-340.19 214045,-335.52 213876.74,-296.53 213681.97,-276.66 213536.55,-266.61"/>
<polygon fill="black" stroke="black" points="213536.38,-263.09 213526.16,-265.9 213535.9,-270.07 213536.38,-263.09"/>
</g>
<!-- dp2_pp1_layer6_expert12&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1436" class="edge">
<title>dp2_pp1_layer6_expert12&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M214348.61,-354.26C214329.28,-347.07 214307.52,-339.99 214287,-335.52 214029.51,-279.49 213725.64,-262.43 213527.99,-257.64"/>
<polygon fill="black" stroke="black" points="213527.86,-254.14 213517.78,-257.4 213527.69,-261.13 213527.86,-254.14"/>
</g>
<!-- dp2_pp1_layer6_expert13&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1437" class="edge">
<title>dp2_pp1_layer6_expert13&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M214591.27,-354.29C214571.79,-347.01 214549.77,-339.87 214529,-335.52 214345.02,-297.05 213828.97,-273.81 213533.63,-263.27"/>
<polygon fill="black" stroke="black" points="213533.33,-259.76 213523.21,-262.9 213533.08,-266.76 213533.33,-259.76"/>
</g>
<!-- dp2_pp1_layer6_expert14&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1438" class="edge">
<title>dp2_pp1_layer6_expert14&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M214833.6,-354.27C214814.05,-346.95 214791.9,-339.78 214771,-335.52 214540.27,-288.58 213874.86,-268.1 213530.74,-260.45"/>
<polygon fill="black" stroke="black" points="213530.73,-256.94 213520.65,-260.22 213530.57,-263.94 213530.73,-256.94"/>
</g>
<!-- dp2_pp1_layer6_expert15&#45;&gt;dp2_pp1_layer6_expert_agg -->
<g id="edge1439" class="edge">
<title>dp2_pp1_layer6_expert15&#45;&gt;dp2_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M215075.93,-354.29C215056.3,-346.92 215034.03,-339.72 215013,-335.52 214735.21,-280.12 213917.98,-263.37 213529.17,-258.47"/>
<polygon fill="black" stroke="black" points="213528.97,-254.97 213518.93,-258.34 213528.88,-261.97 213528.97,-254.97"/>
</g>
<!-- dp2_pp1_layer7_attn_tp0 -->
<g id="node877" class="node">
<title>dp2_pp1_layer7_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="210801.5,-531.06 210536.5,-531.06 210536.5,-479.06 210801.5,-479.06 210801.5,-531.06"/>
<text text-anchor="middle" x="210669" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="210669" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="210669" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="210669" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer6_expert_agg&#45;&gt;dp2_pp1_layer7_attn_tp0 -->
<g id="edge1441" class="edge">
<title>dp2_pp1_layer6_expert_agg&#45;&gt;dp2_pp1_layer7_attn_tp0</title>
<path fill="none" stroke="black" d="M213126.78,-260.41C212706.38,-269.54 211716.17,-294.77 211383,-335.52 211350.8,-339.46 210842.23,-444.29 210811,-453.06 210788.37,-459.41 210764.16,-467.58 210742.26,-475.5"/>
<polygon fill="black" stroke="black" points="210740.89,-472.28 210732.7,-479 210743.29,-478.85 210740.89,-472.28"/>
</g>
<!-- dp2_pp1_layer7_attn_allreduce -->
<g id="node878" class="node">
<title>dp2_pp1_layer7_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="210798" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="210798" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="210798" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="210798" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="210798" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_attn_tp0&#45;&gt;dp2_pp1_layer7_attn_allreduce -->
<g id="edge1442" class="edge">
<title>dp2_pp1_layer7_attn_tp0&#45;&gt;dp2_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M210695.41,-478.92C210712.15,-463 210734.21,-442 210753.58,-423.56"/>
<polygon fill="black" stroke="black" points="210756.03,-426.07 210760.86,-416.64 210751.2,-421 210756.03,-426.07"/>
</g>
<!-- dp2_pp1_layer7_router -->
<g id="node882" class="node">
<title>dp2_pp1_layer7_router</title>
<polygon fill="lightyellow" stroke="black" points="208549.57,-557.06 208155.74,-557.06 208054.43,-453.06 208448.26,-453.06 208549.57,-557.06"/>
<text text-anchor="middle" x="208302" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="208302" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="208302" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="208302" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_attn_allreduce&#45;&gt;dp2_pp1_layer7_router -->
<g id="edge1478" class="edge">
<title>dp2_pp1_layer7_attn_allreduce&#45;&gt;dp2_pp1_layer7_router</title>
<path fill="none" stroke="black" d="M210638.08,-392.38C210526.77,-399.9 210374.89,-409.76 210241,-417.06 209605.5,-451.72 208852.28,-482.59 208500.96,-496.4"/>
<polygon fill="black" stroke="black" points="208500.8,-492.91 208490.94,-496.79 208501.07,-499.9 208500.8,-492.91"/>
</g>
<!-- dp2_pp1_layer7_attn_tp1 -->
<g id="node879" class="node">
<title>dp2_pp1_layer7_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="211084.5,-531.06 210819.5,-531.06 210819.5,-479.06 211084.5,-479.06 211084.5,-531.06"/>
<text text-anchor="middle" x="210952" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="210952" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="210952" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="210952" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer7_attn_tp1&#45;&gt;dp2_pp1_layer7_attn_allreduce -->
<g id="edge1443" class="edge">
<title>dp2_pp1_layer7_attn_tp1&#45;&gt;dp2_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M210920.46,-478.92C210899.99,-462.6 210872.83,-440.94 210849.29,-422.18"/>
<polygon fill="black" stroke="black" points="210851.46,-419.44 210841.46,-415.94 210847.1,-424.91 210851.46,-419.44"/>
</g>
<!-- dp2_pp1_layer7_attn_tp2 -->
<g id="node880" class="node">
<title>dp2_pp1_layer7_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="210518.5,-531.06 210253.5,-531.06 210253.5,-479.06 210518.5,-479.06 210518.5,-531.06"/>
<text text-anchor="middle" x="210386" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="210386" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="210386" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="210386" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer7_attn_tp2&#45;&gt;dp2_pp1_layer7_attn_allreduce -->
<g id="edge1444" class="edge">
<title>dp2_pp1_layer7_attn_tp2&#45;&gt;dp2_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M210452.07,-479.02C210475.85,-470.35 210502.99,-460.86 210528,-453.06 210576.74,-437.86 210631.05,-423.03 210678.1,-410.83"/>
<polygon fill="black" stroke="black" points="210679.22,-414.15 210688.03,-408.26 210677.47,-407.38 210679.22,-414.15"/>
</g>
<!-- dp2_pp1_layer7_attn_tp3 -->
<g id="node881" class="node">
<title>dp2_pp1_layer7_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="211367.5,-531.06 211102.5,-531.06 211102.5,-479.06 211367.5,-479.06 211367.5,-531.06"/>
<text text-anchor="middle" x="211235" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="211235" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="211235" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="211235" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer7_attn_tp3&#45;&gt;dp2_pp1_layer7_attn_allreduce -->
<g id="edge1445" class="edge">
<title>dp2_pp1_layer7_attn_tp3&#45;&gt;dp2_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M211170.21,-478.95C211146.43,-470.18 211119.17,-460.64 211094,-453.06 211039.42,-436.63 210978.31,-421.31 210925.86,-409.08"/>
<polygon fill="black" stroke="black" points="210926.37,-405.6 210915.83,-406.75 210924.78,-412.42 210926.37,-405.6"/>
</g>
<!-- dp2_pp1_layer7_expert0 -->
<g id="node883" class="node">
<title>dp2_pp1_layer7_expert0</title>
<polygon fill="lightgreen" stroke="black" points="206599,-406.29 206375,-406.29 206375,-354.29 206599,-354.29 206599,-406.29"/>
<text text-anchor="middle" x="206487" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="206487" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="206487" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="206487" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert0 -->
<g id="edge1446" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208099.73,-499.65C207714.55,-490.26 206889.11,-465.13 206608,-417.06 206595.99,-415.01 206583.48,-412.16 206571.27,-408.95"/>
<polygon fill="black" stroke="black" points="206572.11,-405.56 206561.54,-406.32 206570.28,-412.31 206572.11,-405.56"/>
</g>
<!-- dp2_pp1_layer7_expert1 -->
<g id="node884" class="node">
<title>dp2_pp1_layer7_expert1</title>
<polygon fill="lightgreen" stroke="black" points="206841,-406.29 206617,-406.29 206617,-354.29 206841,-354.29 206841,-406.29"/>
<text text-anchor="middle" x="206729" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="206729" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="206729" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="206729" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert1 -->
<g id="edge1447" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208097.55,-497.55C207755.94,-485.71 207083.58,-458.03 206850,-417.06 206838.08,-414.97 206825.67,-412.12 206813.54,-408.93"/>
<polygon fill="black" stroke="black" points="206814.45,-405.55 206803.89,-406.3 206812.62,-412.3 206814.45,-405.55"/>
</g>
<!-- dp2_pp1_layer7_expert2 -->
<g id="node885" class="node">
<title>dp2_pp1_layer7_expert2</title>
<polygon fill="lightgreen" stroke="black" points="207083,-406.29 206859,-406.29 206859,-354.29 207083,-354.29 207083,-406.29"/>
<text text-anchor="middle" x="206971" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="206971" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="206971" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="206971" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert2 -->
<g id="edge1448" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208102.82,-502.85C207861.66,-498.37 207444.02,-480.97 207092,-417.06 207080.38,-414.95 207068.29,-412.14 207056.44,-409.03"/>
<polygon fill="black" stroke="black" points="207057.13,-405.59 207046.56,-406.34 207055.29,-412.34 207057.13,-405.59"/>
</g>
<!-- dp2_pp1_layer7_expert3 -->
<g id="node886" class="node">
<title>dp2_pp1_layer7_expert3</title>
<polygon fill="lightgreen" stroke="black" points="207325,-406.29 207101,-406.29 207101,-354.29 207325,-354.29 207325,-406.29"/>
<text text-anchor="middle" x="207213" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="207213" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="207213" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="207213" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert3 -->
<g id="edge1449" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208097.36,-497.41C207900.31,-488.25 207594.63,-466.79 207334,-417.06 207322.57,-414.88 207310.67,-412.06 207298.99,-408.97"/>
<polygon fill="black" stroke="black" points="207299.82,-405.57 207289.25,-406.31 207297.98,-412.32 207299.82,-405.57"/>
</g>
<!-- dp2_pp1_layer7_expert4 -->
<g id="node887" class="node">
<title>dp2_pp1_layer7_expert4</title>
<polygon fill="lightgreen" stroke="black" points="207567,-406.29 207343,-406.29 207343,-354.29 207567,-354.29 207567,-406.29"/>
<text text-anchor="middle" x="207455" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="207455" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="207455" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="207455" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert4 -->
<g id="edge1450" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208088.43,-487.98C207942.99,-474.71 207746.64,-452.25 207576,-417.06 207565.05,-414.8 207553.65,-412.02 207542.43,-409.02"/>
<polygon fill="black" stroke="black" points="207543.19,-405.6 207532.62,-406.33 207541.34,-412.35 207543.19,-405.6"/>
</g>
<!-- dp2_pp1_layer7_expert5 -->
<g id="node888" class="node">
<title>dp2_pp1_layer7_expert5</title>
<polygon fill="lightgreen" stroke="black" points="207809,-406.29 207585,-406.29 207585,-354.29 207809,-354.29 207809,-406.29"/>
<text text-anchor="middle" x="207697" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="207697" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="207697" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="207697" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert5 -->
<g id="edge1451" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208068.29,-467.38C207988.5,-453.44 207899,-436.25 207818,-417.06 207807.9,-414.67 207797.4,-411.94 207786.99,-409.07"/>
<polygon fill="black" stroke="black" points="207787.62,-405.62 207777.05,-406.3 207785.74,-412.36 207787.62,-405.62"/>
</g>
<!-- dp2_pp1_layer7_expert6 -->
<g id="node889" class="node">
<title>dp2_pp1_layer7_expert6</title>
<polygon fill="lightgreen" stroke="black" points="208051,-406.29 207827,-406.29 207827,-354.29 208051,-354.29 208051,-406.29"/>
<text text-anchor="middle" x="207939" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="207939" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="207939" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="207939" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert6 -->
<g id="edge1452" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208150.94,-452.97C208107.16,-438.16 208060.94,-422.53 208022.87,-409.66"/>
<polygon fill="black" stroke="black" points="208023.97,-406.33 208013.38,-406.45 208021.73,-412.97 208023.97,-406.33"/>
</g>
<!-- dp2_pp1_layer7_expert7 -->
<g id="node890" class="node">
<title>dp2_pp1_layer7_expert7</title>
<polygon fill="lightgreen" stroke="black" points="208293,-406.29 208069,-406.29 208069,-354.29 208293,-354.29 208293,-406.29"/>
<text text-anchor="middle" x="208181" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="208181" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="208181" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="208181" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert7 -->
<g id="edge1453" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208251.38,-452.71C208238.3,-439.43 208224.58,-425.51 208212.76,-413.52"/>
<polygon fill="black" stroke="black" points="208215.19,-411 208205.68,-406.33 208210.2,-415.91 208215.19,-411"/>
</g>
<!-- dp2_pp1_layer7_expert8 -->
<g id="node891" class="node">
<title>dp2_pp1_layer7_expert8</title>
<polygon fill="lightgreen" stroke="black" points="208535,-406.29 208311,-406.29 208311,-354.29 208535,-354.29 208535,-406.29"/>
<text text-anchor="middle" x="208423" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="208423" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="208423" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="208423" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert8 -->
<g id="edge1454" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208352.61,-452.71C208365.7,-439.43 208379.42,-425.51 208391.23,-413.52"/>
<polygon fill="black" stroke="black" points="208393.79,-415.91 208398.32,-406.33 208388.81,-411 208393.79,-415.91"/>
</g>
<!-- dp2_pp1_layer7_expert9 -->
<g id="node892" class="node">
<title>dp2_pp1_layer7_expert9</title>
<polygon fill="lightgreen" stroke="black" points="208777,-406.29 208553,-406.29 208553,-354.29 208777,-354.29 208777,-406.29"/>
<text text-anchor="middle" x="208665" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="208665" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="208665" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="208665" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert9 -->
<g id="edge1455" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208449.38,-454.21C208494.29,-439.03 208542.08,-422.86 208581.23,-409.62"/>
<polygon fill="black" stroke="black" points="208582.64,-412.84 208590.99,-406.32 208580.4,-406.21 208582.64,-412.84"/>
</g>
<!-- dp2_pp1_layer7_expert10 -->
<g id="node893" class="node">
<title>dp2_pp1_layer7_expert10</title>
<polygon fill="lightgreen" stroke="black" points="209019,-406.29 208795,-406.29 208795,-354.29 209019,-354.29 209019,-406.29"/>
<text text-anchor="middle" x="208907" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="208907" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="208907" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="208907" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert10 -->
<g id="edge1456" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208472.89,-478.04C208565.98,-462.69 208682.88,-441.49 208786,-417.06 208796.09,-414.67 208806.6,-411.94 208817.01,-409.07"/>
<polygon fill="black" stroke="black" points="208818.26,-412.36 208826.95,-406.3 208816.37,-405.62 208818.26,-412.36"/>
</g>
<!-- dp2_pp1_layer7_expert11 -->
<g id="node894" class="node">
<title>dp2_pp1_layer7_expert11</title>
<polygon fill="lightgreen" stroke="black" points="209261,-406.29 209037,-406.29 209037,-354.29 209261,-354.29 209261,-406.29"/>
<text text-anchor="middle" x="209149" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="209149" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="209149" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="209149" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert11 -->
<g id="edge1457" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208484.99,-490.7C208632.62,-477.88 208845.08,-454.78 209028,-417.06 209038.95,-414.8 209050.35,-412.02 209061.57,-409.02"/>
<polygon fill="black" stroke="black" points="209062.66,-412.35 209071.38,-406.33 209060.81,-405.6 209062.66,-412.35"/>
</g>
<!-- dp2_pp1_layer7_expert12 -->
<g id="node895" class="node">
<title>dp2_pp1_layer7_expert12</title>
<polygon fill="lightgreen" stroke="black" points="209503,-406.29 209279,-406.29 209279,-354.29 209503,-354.29 209503,-406.29"/>
<text text-anchor="middle" x="209391" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="209391" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="209391" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="209391" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert12 -->
<g id="edge1458" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208492.27,-498.07C208688.59,-489.29 209002.95,-468.01 209270,-417.06 209281.43,-414.88 209293.33,-412.06 209305.01,-408.97"/>
<polygon fill="black" stroke="black" points="209306.02,-412.32 209314.75,-406.31 209304.18,-405.57 209306.02,-412.32"/>
</g>
<!-- dp2_pp1_layer7_expert13 -->
<g id="node896" class="node">
<title>dp2_pp1_layer7_expert13</title>
<polygon fill="lightgreen" stroke="black" points="209745,-406.29 209521,-406.29 209521,-354.29 209745,-354.29 209745,-406.29"/>
<text text-anchor="middle" x="209633" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="209633" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="209633" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="209633" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert13 -->
<g id="edge1459" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208496.93,-502.93C208737.42,-498.58 209157.9,-481.35 209512,-417.06 209523.62,-414.95 209535.71,-412.14 209547.56,-409.03"/>
<polygon fill="black" stroke="black" points="209548.7,-412.34 209557.44,-406.34 209546.87,-405.59 209548.7,-412.34"/>
</g>
<!-- dp2_pp1_layer7_expert14 -->
<g id="node897" class="node">
<title>dp2_pp1_layer7_expert14</title>
<polygon fill="lightgreen" stroke="black" points="209987,-406.29 209763,-406.29 209763,-354.29 209987,-354.29 209987,-406.29"/>
<text text-anchor="middle" x="209875" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="209875" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="209875" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="209875" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert14 -->
<g id="edge1460" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208492.32,-498.04C208829.17,-486.48 209517.15,-458.6 209754,-417.06 209765.92,-414.97 209778.32,-412.12 209790.46,-408.93"/>
<polygon fill="black" stroke="black" points="209791.38,-412.3 209800.11,-406.3 209789.54,-405.55 209791.38,-412.3"/>
</g>
<!-- dp2_pp1_layer7_expert15 -->
<g id="node898" class="node">
<title>dp2_pp1_layer7_expert15</title>
<polygon fill="lightgreen" stroke="black" points="210229,-406.29 210005,-406.29 210005,-354.29 210229,-354.29 210229,-406.29"/>
<text text-anchor="middle" x="210117" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="210117" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="210117" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="210117" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert15 -->
<g id="edge1461" class="edge">
<title>dp2_pp1_layer7_router&#45;&gt;dp2_pp1_layer7_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M208493.94,-499.9C208874.49,-490.72 209712.35,-465.57 209996,-417.06 210008.01,-415.01 210020.51,-412.16 210032.73,-408.95"/>
<polygon fill="black" stroke="black" points="210033.72,-412.31 210042.45,-406.32 210031.88,-405.56 210033.72,-412.31"/>
</g>
<!-- dp2_pp1_layer7_expert_agg -->
<g id="node899" class="node">
<title>dp2_pp1_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="208549.57,-307.52 208155.74,-307.52 208054.43,-203.52 208448.26,-203.52 208549.57,-307.52"/>
<text text-anchor="middle" x="208302" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="208302" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="208302" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="208302" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer7_expert0&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1462" class="edge">
<title>dp2_pp1_layer7_expert0&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M206545.07,-354.29C206564.69,-346.92 206586.97,-339.72 206608,-335.52 206887.13,-279.86 207710.93,-263.21 208097.43,-258.4"/>
<polygon fill="black" stroke="black" points="208097.65,-261.9 208107.61,-258.27 208097.57,-254.9 208097.65,-261.9"/>
</g>
<!-- dp2_pp1_layer7_expert1&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1463" class="edge">
<title>dp2_pp1_layer7_expert1&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M206787.39,-354.27C206806.95,-346.95 206829.09,-339.78 206850,-335.52 207082.8,-288.16 207758.09,-267.74 208099.43,-260.24"/>
<polygon fill="black" stroke="black" points="208099.51,-263.74 208109.43,-260.03 208099.35,-256.74 208099.51,-263.74"/>
</g>
<!-- dp2_pp1_layer7_expert2&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1464" class="edge">
<title>dp2_pp1_layer7_expert2&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M207029.73,-354.29C207049.21,-347.01 207071.23,-339.87 207092,-335.52 207278.91,-296.44 207808.54,-273.07 208101.3,-262.78"/>
<polygon fill="black" stroke="black" points="208101.74,-266.27 208111.61,-262.42 208101.5,-259.27 208101.74,-266.27"/>
</g>
<!-- dp2_pp1_layer7_expert3&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1465" class="edge">
<title>dp2_pp1_layer7_expert3&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M207272.39,-354.26C207291.72,-347.07 207313.48,-339.99 207334,-335.52 207592.91,-279.18 207898.7,-262.24 208096.26,-257.56"/>
<polygon fill="black" stroke="black" points="208096.55,-261.06 208106.47,-257.33 208096.39,-254.06 208096.55,-261.06"/>
</g>
<!-- dp2_pp1_layer7_expert4&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1466" class="edge">
<title>dp2_pp1_layer7_expert4&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M207515.39,-354.24C207534.49,-347.2 207555.87,-340.19 207576,-335.52 207751.82,-294.77 207956.6,-274.91 208103.75,-265.31"/>
<polygon fill="black" stroke="black" points="208104.05,-268.8 208113.81,-264.67 208103.6,-261.82 208104.05,-268.8"/>
</g>
<!-- dp2_pp1_layer7_expert5&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1467" class="edge">
<title>dp2_pp1_layer7_expert5&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M207759.42,-354.22C207778.04,-347.42 207798.65,-340.55 207818,-335.52 207915.09,-310.27 208025.34,-291.53 208116.07,-278.65"/>
<polygon fill="black" stroke="black" points="208116.78,-282.09 208126.19,-277.23 208115.8,-275.16 208116.78,-282.09"/>
</g>
<!-- dp2_pp1_layer7_expert6&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1468" class="edge">
<title>dp2_pp1_layer7_expert6&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M208007.02,-354.26C208024.26,-348.03 208042.78,-341.44 208060,-335.52 208086.73,-326.33 208115.21,-316.8 208142.89,-307.67"/>
<polygon fill="black" stroke="black" points="208144.24,-310.91 208152.65,-304.46 208142.06,-304.26 208144.24,-310.91"/>
</g>
<!-- dp2_pp1_layer7_expert7&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1469" class="edge">
<title>dp2_pp1_layer7_expert7&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M208205.78,-354.15C208217.02,-342.74 208230.83,-328.73 208244.45,-314.92"/>
<polygon fill="black" stroke="black" points="208247,-317.31 208251.53,-307.73 208242.02,-312.39 208247,-317.31"/>
</g>
<!-- dp2_pp1_layer7_expert8&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1470" class="edge">
<title>dp2_pp1_layer7_expert8&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M208398.22,-354.15C208386.97,-342.74 208373.16,-328.73 208359.55,-314.92"/>
<polygon fill="black" stroke="black" points="208361.98,-312.39 208352.47,-307.73 208356.99,-317.31 208361.98,-312.39"/>
</g>
<!-- dp2_pp1_layer7_expert9&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1471" class="edge">
<title>dp2_pp1_layer7_expert9&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M208596.98,-354.26C208579.73,-348.03 208561.21,-341.44 208544,-335.52 208520.29,-327.37 208495.21,-318.95 208470.53,-310.78"/>
<polygon fill="black" stroke="black" points="208471.32,-307.36 208460.73,-307.54 208469.12,-314 208471.32,-307.36"/>
</g>
<!-- dp2_pp1_layer7_expert10&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1472" class="edge">
<title>dp2_pp1_layer7_expert10&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M208844.58,-354.22C208825.96,-347.42 208805.35,-340.55 208786,-335.52 208705.99,-314.71 208617.05,-298.33 208537.46,-286"/>
<polygon fill="black" stroke="black" points="208537.71,-282.5 208527.3,-284.44 208536.65,-289.41 208537.71,-282.5"/>
</g>
<!-- dp2_pp1_layer7_expert11&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1473" class="edge">
<title>dp2_pp1_layer7_expert11&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M209088.61,-354.24C209069.51,-347.2 209048.13,-340.19 209028,-335.52 208859.74,-296.53 208664.97,-276.66 208519.55,-266.61"/>
<polygon fill="black" stroke="black" points="208519.38,-263.09 208509.16,-265.9 208518.9,-270.07 208519.38,-263.09"/>
</g>
<!-- dp2_pp1_layer7_expert12&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1474" class="edge">
<title>dp2_pp1_layer7_expert12&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M209331.61,-354.26C209312.28,-347.07 209290.52,-339.99 209270,-335.52 209012.51,-279.49 208708.64,-262.43 208510.99,-257.64"/>
<polygon fill="black" stroke="black" points="208510.86,-254.14 208500.78,-257.4 208510.69,-261.13 208510.86,-254.14"/>
</g>
<!-- dp2_pp1_layer7_expert13&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1475" class="edge">
<title>dp2_pp1_layer7_expert13&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M209574.27,-354.29C209554.79,-347.01 209532.77,-339.87 209512,-335.52 209328.02,-297.05 208811.97,-273.81 208516.63,-263.27"/>
<polygon fill="black" stroke="black" points="208516.33,-259.76 208506.21,-262.9 208516.08,-266.76 208516.33,-259.76"/>
</g>
<!-- dp2_pp1_layer7_expert14&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1476" class="edge">
<title>dp2_pp1_layer7_expert14&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M209816.6,-354.27C209797.05,-346.95 209774.9,-339.78 209754,-335.52 209523.27,-288.58 208857.86,-268.1 208513.74,-260.45"/>
<polygon fill="black" stroke="black" points="208513.73,-256.94 208503.65,-260.22 208513.57,-263.94 208513.73,-256.94"/>
</g>
<!-- dp2_pp1_layer7_expert15&#45;&gt;dp2_pp1_layer7_expert_agg -->
<g id="edge1477" class="edge">
<title>dp2_pp1_layer7_expert15&#45;&gt;dp2_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M210058.93,-354.29C210039.3,-346.92 210017.03,-339.72 209996,-335.52 209718.21,-280.12 208900.98,-263.37 208512.17,-258.47"/>
<polygon fill="black" stroke="black" points="208511.97,-254.97 208501.93,-258.34 208511.88,-261.97 208511.97,-254.97"/>
</g>
<!-- dp2_pp1_layer8_attn_tp0 -->
<g id="node900" class="node">
<title>dp2_pp1_layer8_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="205784.5,-531.06 205519.5,-531.06 205519.5,-479.06 205784.5,-479.06 205784.5,-531.06"/>
<text text-anchor="middle" x="205652" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="205652" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="205652" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="205652" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer7_expert_agg&#45;&gt;dp2_pp1_layer8_attn_tp0 -->
<g id="edge1479" class="edge">
<title>dp2_pp1_layer7_expert_agg&#45;&gt;dp2_pp1_layer8_attn_tp0</title>
<path fill="none" stroke="black" d="M208109.78,-260.41C207689.38,-269.54 206699.17,-294.77 206366,-335.52 206333.8,-339.46 205825.23,-444.29 205794,-453.06 205771.37,-459.41 205747.16,-467.58 205725.26,-475.5"/>
<polygon fill="black" stroke="black" points="205723.89,-472.28 205715.7,-479 205726.29,-478.85 205723.89,-472.28"/>
</g>
<!-- dp2_pp1_layer8_attn_allreduce -->
<g id="node901" class="node">
<title>dp2_pp1_layer8_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="205781" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="205781" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="205781" y="-383.29" font-family="Arial" font-size="10.00">GPUs 64&#45;67</text>
<text text-anchor="middle" x="205781" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="205781" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_attn_tp0&#45;&gt;dp2_pp1_layer8_attn_allreduce -->
<g id="edge1480" class="edge">
<title>dp2_pp1_layer8_attn_tp0&#45;&gt;dp2_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M205678.41,-478.92C205695.15,-463 205717.21,-442 205736.58,-423.56"/>
<polygon fill="black" stroke="black" points="205739.03,-426.07 205743.86,-416.64 205734.2,-421 205739.03,-426.07"/>
</g>
<!-- dp2_pp1_layer8_router -->
<g id="node905" class="node">
<title>dp2_pp1_layer8_router</title>
<polygon fill="lightyellow" stroke="black" points="203532.57,-557.06 203138.74,-557.06 203037.43,-453.06 203431.26,-453.06 203532.57,-557.06"/>
<text text-anchor="middle" x="203285" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="203285" y="-508.06" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="203285" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="203285" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_attn_allreduce&#45;&gt;dp2_pp1_layer8_router -->
<g id="edge1516" class="edge">
<title>dp2_pp1_layer8_attn_allreduce&#45;&gt;dp2_pp1_layer8_router</title>
<path fill="none" stroke="black" d="M205621.08,-392.38C205509.77,-399.9 205357.89,-409.76 205224,-417.06 204588.5,-451.72 203835.28,-482.59 203483.96,-496.4"/>
<polygon fill="black" stroke="black" points="203483.8,-492.91 203473.94,-496.79 203484.07,-499.9 203483.8,-492.91"/>
</g>
<!-- dp2_pp1_layer8_attn_tp1 -->
<g id="node902" class="node">
<title>dp2_pp1_layer8_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="206067.5,-531.06 205802.5,-531.06 205802.5,-479.06 206067.5,-479.06 206067.5,-531.06"/>
<text text-anchor="middle" x="205935" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="205935" y="-508.06" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="205935" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="205935" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer8_attn_tp1&#45;&gt;dp2_pp1_layer8_attn_allreduce -->
<g id="edge1481" class="edge">
<title>dp2_pp1_layer8_attn_tp1&#45;&gt;dp2_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M205903.46,-478.92C205882.99,-462.6 205855.83,-440.94 205832.29,-422.18"/>
<polygon fill="black" stroke="black" points="205834.46,-419.44 205824.46,-415.94 205830.1,-424.91 205834.46,-419.44"/>
</g>
<!-- dp2_pp1_layer8_attn_tp2 -->
<g id="node903" class="node">
<title>dp2_pp1_layer8_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="205501.5,-531.06 205236.5,-531.06 205236.5,-479.06 205501.5,-479.06 205501.5,-531.06"/>
<text text-anchor="middle" x="205369" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="205369" y="-508.06" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="205369" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="205369" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer8_attn_tp2&#45;&gt;dp2_pp1_layer8_attn_allreduce -->
<g id="edge1482" class="edge">
<title>dp2_pp1_layer8_attn_tp2&#45;&gt;dp2_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M205435.07,-479.02C205458.85,-470.35 205485.99,-460.86 205511,-453.06 205559.74,-437.86 205614.05,-423.03 205661.1,-410.83"/>
<polygon fill="black" stroke="black" points="205662.22,-414.15 205671.03,-408.26 205660.47,-407.38 205662.22,-414.15"/>
</g>
<!-- dp2_pp1_layer8_attn_tp3 -->
<g id="node904" class="node">
<title>dp2_pp1_layer8_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="206350.5,-531.06 206085.5,-531.06 206085.5,-479.06 206350.5,-479.06 206350.5,-531.06"/>
<text text-anchor="middle" x="206218" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="206218" y="-508.06" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="206218" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="206218" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp1_layer8_attn_tp3&#45;&gt;dp2_pp1_layer8_attn_allreduce -->
<g id="edge1483" class="edge">
<title>dp2_pp1_layer8_attn_tp3&#45;&gt;dp2_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M206153.21,-478.95C206129.43,-470.18 206102.17,-460.64 206077,-453.06 206022.42,-436.63 205961.31,-421.31 205908.86,-409.08"/>
<polygon fill="black" stroke="black" points="205909.37,-405.6 205898.83,-406.75 205907.78,-412.42 205909.37,-405.6"/>
</g>
<!-- dp2_pp1_layer8_expert0 -->
<g id="node906" class="node">
<title>dp2_pp1_layer8_expert0</title>
<polygon fill="lightgreen" stroke="black" points="201582,-406.29 201358,-406.29 201358,-354.29 201582,-354.29 201582,-406.29"/>
<text text-anchor="middle" x="201470" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="201470" y="-383.29" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="201470" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="201470" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert0 -->
<g id="edge1484" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203082.73,-499.65C202697.55,-490.26 201872.11,-465.13 201591,-417.06 201578.99,-415.01 201566.48,-412.16 201554.27,-408.95"/>
<polygon fill="black" stroke="black" points="201555.11,-405.56 201544.54,-406.32 201553.28,-412.31 201555.11,-405.56"/>
</g>
<!-- dp2_pp1_layer8_expert1 -->
<g id="node907" class="node">
<title>dp2_pp1_layer8_expert1</title>
<polygon fill="lightgreen" stroke="black" points="201824,-406.29 201600,-406.29 201600,-354.29 201824,-354.29 201824,-406.29"/>
<text text-anchor="middle" x="201712" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="201712" y="-383.29" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="201712" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="201712" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert1 -->
<g id="edge1485" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203080.55,-497.55C202738.94,-485.71 202066.58,-458.03 201833,-417.06 201821.08,-414.97 201808.67,-412.12 201796.54,-408.93"/>
<polygon fill="black" stroke="black" points="201797.45,-405.55 201786.89,-406.3 201795.62,-412.3 201797.45,-405.55"/>
</g>
<!-- dp2_pp1_layer8_expert2 -->
<g id="node908" class="node">
<title>dp2_pp1_layer8_expert2</title>
<polygon fill="lightgreen" stroke="black" points="202066,-406.29 201842,-406.29 201842,-354.29 202066,-354.29 202066,-406.29"/>
<text text-anchor="middle" x="201954" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="201954" y="-383.29" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="201954" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="201954" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert2 -->
<g id="edge1486" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203085.82,-502.85C202844.66,-498.37 202427.02,-480.97 202075,-417.06 202063.38,-414.95 202051.29,-412.14 202039.44,-409.03"/>
<polygon fill="black" stroke="black" points="202040.13,-405.59 202029.56,-406.34 202038.29,-412.34 202040.13,-405.59"/>
</g>
<!-- dp2_pp1_layer8_expert3 -->
<g id="node909" class="node">
<title>dp2_pp1_layer8_expert3</title>
<polygon fill="lightgreen" stroke="black" points="202308,-406.29 202084,-406.29 202084,-354.29 202308,-354.29 202308,-406.29"/>
<text text-anchor="middle" x="202196" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="202196" y="-383.29" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="202196" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="202196" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert3 -->
<g id="edge1487" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203080.36,-497.41C202883.31,-488.25 202577.63,-466.79 202317,-417.06 202305.57,-414.88 202293.67,-412.06 202281.99,-408.97"/>
<polygon fill="black" stroke="black" points="202282.82,-405.57 202272.25,-406.31 202280.98,-412.32 202282.82,-405.57"/>
</g>
<!-- dp2_pp1_layer8_expert4 -->
<g id="node910" class="node">
<title>dp2_pp1_layer8_expert4</title>
<polygon fill="lightgreen" stroke="black" points="202550,-406.29 202326,-406.29 202326,-354.29 202550,-354.29 202550,-406.29"/>
<text text-anchor="middle" x="202438" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="202438" y="-383.29" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="202438" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="202438" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert4 -->
<g id="edge1488" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203071.43,-487.98C202925.99,-474.71 202729.64,-452.25 202559,-417.06 202548.05,-414.8 202536.65,-412.02 202525.43,-409.02"/>
<polygon fill="black" stroke="black" points="202526.19,-405.6 202515.62,-406.33 202524.34,-412.35 202526.19,-405.6"/>
</g>
<!-- dp2_pp1_layer8_expert5 -->
<g id="node911" class="node">
<title>dp2_pp1_layer8_expert5</title>
<polygon fill="lightgreen" stroke="black" points="202792,-406.29 202568,-406.29 202568,-354.29 202792,-354.29 202792,-406.29"/>
<text text-anchor="middle" x="202680" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="202680" y="-383.29" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="202680" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="202680" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert5 -->
<g id="edge1489" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203051.29,-467.38C202971.5,-453.44 202882,-436.25 202801,-417.06 202790.9,-414.67 202780.4,-411.94 202769.99,-409.07"/>
<polygon fill="black" stroke="black" points="202770.62,-405.62 202760.05,-406.3 202768.74,-412.36 202770.62,-405.62"/>
</g>
<!-- dp2_pp1_layer8_expert6 -->
<g id="node912" class="node">
<title>dp2_pp1_layer8_expert6</title>
<polygon fill="lightgreen" stroke="black" points="203034,-406.29 202810,-406.29 202810,-354.29 203034,-354.29 203034,-406.29"/>
<text text-anchor="middle" x="202922" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="202922" y="-383.29" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="202922" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="202922" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert6 -->
<g id="edge1490" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203133.94,-452.97C203090.16,-438.16 203043.94,-422.53 203005.87,-409.66"/>
<polygon fill="black" stroke="black" points="203006.97,-406.33 202996.38,-406.45 203004.73,-412.97 203006.97,-406.33"/>
</g>
<!-- dp2_pp1_layer8_expert7 -->
<g id="node913" class="node">
<title>dp2_pp1_layer8_expert7</title>
<polygon fill="lightgreen" stroke="black" points="203276,-406.29 203052,-406.29 203052,-354.29 203276,-354.29 203276,-406.29"/>
<text text-anchor="middle" x="203164" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="203164" y="-383.29" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="203164" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="203164" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert7 -->
<g id="edge1491" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203234.38,-452.71C203221.3,-439.43 203207.58,-425.51 203195.76,-413.52"/>
<polygon fill="black" stroke="black" points="203198.19,-411 203188.68,-406.33 203193.2,-415.91 203198.19,-411"/>
</g>
<!-- dp2_pp1_layer8_expert8 -->
<g id="node914" class="node">
<title>dp2_pp1_layer8_expert8</title>
<polygon fill="lightgreen" stroke="black" points="203518,-406.29 203294,-406.29 203294,-354.29 203518,-354.29 203518,-406.29"/>
<text text-anchor="middle" x="203406" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="203406" y="-383.29" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="203406" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="203406" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert8 -->
<g id="edge1492" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203335.61,-452.71C203348.7,-439.43 203362.42,-425.51 203374.23,-413.52"/>
<polygon fill="black" stroke="black" points="203376.79,-415.91 203381.32,-406.33 203371.81,-411 203376.79,-415.91"/>
</g>
<!-- dp2_pp1_layer8_expert9 -->
<g id="node915" class="node">
<title>dp2_pp1_layer8_expert9</title>
<polygon fill="lightgreen" stroke="black" points="203760,-406.29 203536,-406.29 203536,-354.29 203760,-354.29 203760,-406.29"/>
<text text-anchor="middle" x="203648" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="203648" y="-383.29" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="203648" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="203648" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert9 -->
<g id="edge1493" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203432.38,-454.21C203477.29,-439.03 203525.08,-422.86 203564.23,-409.62"/>
<polygon fill="black" stroke="black" points="203565.64,-412.84 203573.99,-406.32 203563.4,-406.21 203565.64,-412.84"/>
</g>
<!-- dp2_pp1_layer8_expert10 -->
<g id="node916" class="node">
<title>dp2_pp1_layer8_expert10</title>
<polygon fill="lightgreen" stroke="black" points="204002,-406.29 203778,-406.29 203778,-354.29 204002,-354.29 204002,-406.29"/>
<text text-anchor="middle" x="203890" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="203890" y="-383.29" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="203890" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="203890" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert10 -->
<g id="edge1494" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203455.89,-478.04C203548.98,-462.69 203665.88,-441.49 203769,-417.06 203779.09,-414.67 203789.6,-411.94 203800.01,-409.07"/>
<polygon fill="black" stroke="black" points="203801.26,-412.36 203809.95,-406.3 203799.37,-405.62 203801.26,-412.36"/>
</g>
<!-- dp2_pp1_layer8_expert11 -->
<g id="node917" class="node">
<title>dp2_pp1_layer8_expert11</title>
<polygon fill="lightgreen" stroke="black" points="204244,-406.29 204020,-406.29 204020,-354.29 204244,-354.29 204244,-406.29"/>
<text text-anchor="middle" x="204132" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="204132" y="-383.29" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="204132" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="204132" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert11 -->
<g id="edge1495" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203467.99,-490.7C203615.62,-477.88 203828.08,-454.78 204011,-417.06 204021.95,-414.8 204033.35,-412.02 204044.57,-409.02"/>
<polygon fill="black" stroke="black" points="204045.66,-412.35 204054.38,-406.33 204043.81,-405.6 204045.66,-412.35"/>
</g>
<!-- dp2_pp1_layer8_expert12 -->
<g id="node918" class="node">
<title>dp2_pp1_layer8_expert12</title>
<polygon fill="lightgreen" stroke="black" points="204486,-406.29 204262,-406.29 204262,-354.29 204486,-354.29 204486,-406.29"/>
<text text-anchor="middle" x="204374" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="204374" y="-383.29" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="204374" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="204374" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert12 -->
<g id="edge1496" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203475.27,-498.07C203671.59,-489.29 203985.95,-468.01 204253,-417.06 204264.43,-414.88 204276.33,-412.06 204288.01,-408.97"/>
<polygon fill="black" stroke="black" points="204289.02,-412.32 204297.75,-406.31 204287.18,-405.57 204289.02,-412.32"/>
</g>
<!-- dp2_pp1_layer8_expert13 -->
<g id="node919" class="node">
<title>dp2_pp1_layer8_expert13</title>
<polygon fill="lightgreen" stroke="black" points="204728,-406.29 204504,-406.29 204504,-354.29 204728,-354.29 204728,-406.29"/>
<text text-anchor="middle" x="204616" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="204616" y="-383.29" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="204616" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="204616" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert13 -->
<g id="edge1497" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203479.93,-502.93C203720.42,-498.58 204140.9,-481.35 204495,-417.06 204506.62,-414.95 204518.71,-412.14 204530.56,-409.03"/>
<polygon fill="black" stroke="black" points="204531.7,-412.34 204540.44,-406.34 204529.87,-405.59 204531.7,-412.34"/>
</g>
<!-- dp2_pp1_layer8_expert14 -->
<g id="node920" class="node">
<title>dp2_pp1_layer8_expert14</title>
<polygon fill="lightgreen" stroke="black" points="204970,-406.29 204746,-406.29 204746,-354.29 204970,-354.29 204970,-406.29"/>
<text text-anchor="middle" x="204858" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="204858" y="-383.29" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="204858" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="204858" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert14 -->
<g id="edge1498" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203475.32,-498.04C203812.17,-486.48 204500.15,-458.6 204737,-417.06 204748.92,-414.97 204761.32,-412.12 204773.46,-408.93"/>
<polygon fill="black" stroke="black" points="204774.38,-412.3 204783.11,-406.3 204772.54,-405.55 204774.38,-412.3"/>
</g>
<!-- dp2_pp1_layer8_expert15 -->
<g id="node921" class="node">
<title>dp2_pp1_layer8_expert15</title>
<polygon fill="lightgreen" stroke="black" points="205212,-406.29 204988,-406.29 204988,-354.29 205212,-354.29 205212,-406.29"/>
<text text-anchor="middle" x="205100" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="205100" y="-383.29" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="205100" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="205100" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert15 -->
<g id="edge1499" class="edge">
<title>dp2_pp1_layer8_router&#45;&gt;dp2_pp1_layer8_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M203476.94,-499.9C203857.49,-490.72 204695.35,-465.57 204979,-417.06 204991.01,-415.01 205003.51,-412.16 205015.73,-408.95"/>
<polygon fill="black" stroke="black" points="205016.72,-412.31 205025.45,-406.32 205014.88,-405.56 205016.72,-412.31"/>
</g>
<!-- dp2_pp1_layer8_expert_agg -->
<g id="node922" class="node">
<title>dp2_pp1_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="203653.57,-307.52 203259.74,-307.52 203158.43,-203.52 203552.26,-203.52 203653.57,-307.52"/>
<text text-anchor="middle" x="203406" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="203406" y="-258.52" font-family="Arial" font-size="10.00">GPUs 64&#45;79</text>
<text text-anchor="middle" x="203406" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="203406" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_expert0&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1500" class="edge">
<title>dp2_pp1_layer8_expert0&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M201528.06,-354.25C201547.69,-346.88 201569.96,-339.68 201591,-335.52 201893.52,-275.68 202792.92,-261.16 203200.8,-257.65"/>
<polygon fill="black" stroke="black" points="203200.96,-261.14 203210.93,-257.56 203200.9,-254.15 203200.96,-261.14"/>
</g>
<!-- dp2_pp1_layer8_expert1&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1501" class="edge">
<title>dp2_pp1_layer8_expert1&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M201770.38,-354.21C201789.94,-346.89 201812.08,-339.73 201833,-335.52 202088.86,-284.02 202837.83,-265.4 203202.21,-259.26"/>
<polygon fill="black" stroke="black" points="203202.4,-262.76 203212.34,-259.09 203202.28,-255.76 203202.4,-262.76"/>
</g>
<!-- dp2_pp1_layer8_expert2&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1502" class="edge">
<title>dp2_pp1_layer8_expert2&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M202012.71,-354.21C202032.19,-346.94 202054.21,-339.8 202075,-335.52 202284.71,-292.32 202886.36,-270.3 203204,-261.41"/>
<polygon fill="black" stroke="black" points="203204.34,-264.9 203214.24,-261.13 203204.15,-257.91 203204.34,-264.9"/>
</g>
<!-- dp2_pp1_layer8_expert3&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1503" class="edge">
<title>dp2_pp1_layer8_expert3&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M202255.05,-354.26C202274.46,-347.03 202296.35,-339.92 202317,-335.52 202481.34,-300.54 202940.32,-276.12 203207.04,-264.41"/>
<polygon fill="black" stroke="black" points="203207.4,-267.9 203217.24,-263.97 203207.09,-260.91 203207.4,-267.9"/>
</g>
<!-- dp2_pp1_layer8_expert4&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1504" class="edge">
<title>dp2_pp1_layer8_expert4&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M202497.73,-354.28C202516.98,-347.15 202538.62,-340.08 202559,-335.52 202775.91,-287.01 203030.52,-268.23 203203.54,-261"/>
<polygon fill="black" stroke="black" points="203203.93,-264.48 203213.78,-260.58 203203.64,-257.49 203203.93,-264.48"/>
</g>
<!-- dp2_pp1_layer8_expert5&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1505" class="edge">
<title>dp2_pp1_layer8_expert5&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M202741.07,-354.28C202760.02,-347.32 202781.14,-340.35 202801,-335.52 202936.78,-302.51 203093.27,-282.55 203213.08,-270.95"/>
<polygon fill="black" stroke="black" points="203213.47,-274.42 203223.09,-269.99 203212.8,-267.46 203213.47,-274.42"/>
</g>
<!-- dp2_pp1_layer8_expert6&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1506" class="edge">
<title>dp2_pp1_layer8_expert6&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M202986.16,-354.29C203004.37,-347.69 203024.32,-340.91 203043,-335.52 203103.46,-318.09 203170.57,-302.47 203230.47,-289.81"/>
<polygon fill="black" stroke="black" points="203231.33,-293.21 203240.4,-287.73 203229.9,-286.36 203231.33,-293.21"/>
</g>
<!-- dp2_pp1_layer8_expert7&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1507" class="edge">
<title>dp2_pp1_layer8_expert7&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M203213.55,-354.15C203237.49,-342.01 203267.24,-326.92 203296.13,-312.26"/>
<polygon fill="black" stroke="black" points="203297.73,-315.37 203305.06,-307.73 203294.56,-309.13 203297.73,-315.37"/>
</g>
<!-- dp2_pp1_layer8_expert8&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1508" class="edge">
<title>dp2_pp1_layer8_expert8&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M203406,-354.15C203406,-343.58 203406,-330.77 203406,-317.96"/>
<polygon fill="black" stroke="black" points="203409.5,-317.73 203406,-307.73 203402.5,-317.73 203409.5,-317.73"/>
</g>
<!-- dp2_pp1_layer8_expert9&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1509" class="edge">
<title>dp2_pp1_layer8_expert9&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M203598.44,-354.15C203574.51,-342.01 203544.76,-326.92 203515.87,-312.26"/>
<polygon fill="black" stroke="black" points="203517.44,-309.13 203506.93,-307.73 203514.27,-315.37 203517.44,-309.13"/>
</g>
<!-- dp2_pp1_layer8_expert10&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1510" class="edge">
<title>dp2_pp1_layer8_expert10&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M203825.84,-354.29C203807.63,-347.69 203787.67,-340.91 203769,-335.52 203734.59,-325.6 203698.02,-316.27 203661.86,-307.73"/>
<polygon fill="black" stroke="black" points="203662.21,-304.22 203651.68,-305.35 203660.61,-311.03 203662.21,-304.22"/>
</g>
<!-- dp2_pp1_layer8_expert11&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1511" class="edge">
<title>dp2_pp1_layer8_expert11&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M204070.93,-354.28C204051.98,-347.32 204030.86,-340.35 204011,-335.52 203886.73,-305.31 203745.11,-286.03 203630.15,-274.08"/>
<polygon fill="black" stroke="black" points="203630.47,-270.6 203620.17,-273.05 203629.76,-277.56 203630.47,-270.6"/>
</g>
<!-- dp2_pp1_layer8_expert12&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1512" class="edge">
<title>dp2_pp1_layer8_expert12&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M204314.27,-354.28C204295.02,-347.15 204273.38,-340.08 204253,-335.52 204040.33,-287.95 203791.41,-268.98 203618.7,-261.43"/>
<polygon fill="black" stroke="black" points="203618.61,-257.93 203608.47,-261 203618.31,-264.92 203618.61,-257.93"/>
</g>
<!-- dp2_pp1_layer8_expert13&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1513" class="edge">
<title>dp2_pp1_layer8_expert13&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M204556.94,-354.26C204537.54,-347.03 204515.65,-339.92 204495,-335.52 204334.14,-301.28 203891.03,-277.16 203622.2,-265.18"/>
<polygon fill="black" stroke="black" points="203622.06,-261.67 203611.92,-264.72 203621.75,-268.66 203622.06,-261.67"/>
</g>
<!-- dp2_pp1_layer8_expert14&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1514" class="edge">
<title>dp2_pp1_layer8_expert14&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M204799.28,-354.21C204779.81,-346.94 204757.78,-339.8 204737,-335.52 204529.74,-292.82 203939.66,-270.82 203619.26,-261.73"/>
<polygon fill="black" stroke="black" points="203619.02,-258.22 203608.92,-261.44 203618.82,-265.22 203619.02,-258.22"/>
</g>
<!-- dp2_pp1_layer8_expert15&#45;&gt;dp2_pp1_layer8_expert_agg -->
<g id="edge1515" class="edge">
<title>dp2_pp1_layer8_expert15&#45;&gt;dp2_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M205041.61,-354.21C205022.06,-346.89 204999.91,-339.73 204979,-335.52 204724.8,-284.35 203983.86,-265.64 203616.93,-259.38"/>
<polygon fill="black" stroke="black" points="203616.78,-255.88 203606.72,-259.21 203616.66,-262.88 203616.78,-255.88"/>
</g>
<!-- dp2_pp1_to_pp2 -->
<g id="node1477" class="node">
<title>dp2_pp1_to_pp2</title>
<ellipse fill="lightblue" stroke="black" cx="213303" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="213303" y="-144.75" font-family="Arial" font-size="10.00">PP Stage Transition</text>
<text text-anchor="middle" x="213303" y="-133.75" font-family="Arial" font-size="10.00">GPU 79  GPU 80</text>
<text text-anchor="middle" x="213303" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="213303" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp1_layer8_expert_agg&#45;&gt;dp2_pp1_to_pp2 -->
<g id="edge2430" class="edge">
<title>dp2_pp1_layer8_expert_agg&#45;&gt;dp2_pp1_to_pp2</title>
<path fill="none" stroke="black" d="M203596.24,-248.48C204065.89,-233.82 205318.09,-196.37 206363,-179.52 209053.07,-136.15 212330.3,-132.1 213123.82,-131.77"/>
<polygon fill="black" stroke="black" points="213123.9,-135.27 213133.9,-131.76 213123.89,-128.27 213123.9,-135.27"/>
</g>
<!-- dp2_pp2_layer9_attn_tp0 -->
<g id="node923" class="node">
<title>dp2_pp2_layer9_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="201317.5,-531.06 201052.5,-531.06 201052.5,-479.06 201317.5,-479.06 201317.5,-531.06"/>
<text text-anchor="middle" x="201185" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="201185" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="201185" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="201185" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer9_attn_allreduce -->
<g id="node924" class="node">
<title>dp2_pp2_layer9_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="200760" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="200760" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="200760" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="200760" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="200760" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_attn_tp0&#45;&gt;dp2_pp2_layer9_attn_allreduce -->
<g id="edge1517" class="edge">
<title>dp2_pp2_layer9_attn_tp0&#45;&gt;dp2_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M201119.82,-478.95C201096.12,-470.23 201069.01,-460.72 201044,-453.06 200992.14,-437.17 200934.21,-422.07 200884.26,-409.85"/>
<polygon fill="black" stroke="black" points="200884.92,-406.41 200874.38,-407.45 200883.27,-413.21 200884.92,-406.41"/>
</g>
<!-- dp2_pp2_layer9_router -->
<g id="node928" class="node">
<title>dp2_pp2_layer9_router</title>
<polygon fill="lightyellow" stroke="black" points="198499.57,-557.06 198105.74,-557.06 198004.43,-453.06 198398.26,-453.06 198499.57,-557.06"/>
<text text-anchor="middle" x="198252" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="198252" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="198252" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="198252" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_attn_allreduce&#45;&gt;dp2_pp2_layer9_router -->
<g id="edge1553" class="edge">
<title>dp2_pp2_layer9_attn_allreduce&#45;&gt;dp2_pp2_layer9_router</title>
<path fill="none" stroke="black" d="M200599.7,-392.14C200485.73,-399.66 200329,-409.63 200191,-417.06 199555.48,-451.29 198802.27,-482.37 198450.96,-496.31"/>
<polygon fill="black" stroke="black" points="198450.79,-492.82 198440.94,-496.71 198451.07,-499.81 198450.79,-492.82"/>
</g>
<!-- dp2_pp2_layer9_attn_tp1 -->
<g id="node925" class="node">
<title>dp2_pp2_layer9_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="200468.5,-531.06 200203.5,-531.06 200203.5,-479.06 200468.5,-479.06 200468.5,-531.06"/>
<text text-anchor="middle" x="200336" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="200336" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="200336" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="200336" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer9_attn_tp1&#45;&gt;dp2_pp2_layer9_attn_allreduce -->
<g id="edge1518" class="edge">
<title>dp2_pp2_layer9_attn_tp1&#45;&gt;dp2_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M200401.66,-479C200425.53,-470.28 200452.83,-460.77 200478,-453.06 200529.51,-437.29 200587.04,-422.21 200636.64,-409.97"/>
<polygon fill="black" stroke="black" points="200637.57,-413.35 200646.45,-407.57 200635.9,-406.55 200637.57,-413.35"/>
</g>
<!-- dp2_pp2_layer9_attn_tp2 -->
<g id="node926" class="node">
<title>dp2_pp2_layer9_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="201034.5,-531.06 200769.5,-531.06 200769.5,-479.06 201034.5,-479.06 201034.5,-531.06"/>
<text text-anchor="middle" x="200902" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="200902" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="200902" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="200902" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer9_attn_tp2&#45;&gt;dp2_pp2_layer9_attn_allreduce -->
<g id="edge1519" class="edge">
<title>dp2_pp2_layer9_attn_tp2&#45;&gt;dp2_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M200872.92,-478.92C200854.28,-462.8 200829.62,-441.49 200808.11,-422.89"/>
<polygon fill="black" stroke="black" points="200810.2,-420.06 200800.34,-416.17 200805.62,-425.36 200810.2,-420.06"/>
</g>
<!-- dp2_pp2_layer9_attn_tp3 -->
<g id="node927" class="node">
<title>dp2_pp2_layer9_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="200751.5,-531.06 200486.5,-531.06 200486.5,-479.06 200751.5,-479.06 200751.5,-531.06"/>
<text text-anchor="middle" x="200619" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="200619" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="200619" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="200619" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer9_attn_tp3&#45;&gt;dp2_pp2_layer9_attn_allreduce -->
<g id="edge1520" class="edge">
<title>dp2_pp2_layer9_attn_tp3&#45;&gt;dp2_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M200647.87,-478.92C200666.39,-462.8 200690.87,-441.49 200712.23,-422.89"/>
<polygon fill="black" stroke="black" points="200714.7,-425.38 200719.94,-416.17 200710.1,-420.1 200714.7,-425.38"/>
</g>
<!-- dp2_pp2_layer9_expert0 -->
<g id="node929" class="node">
<title>dp2_pp2_layer9_expert0</title>
<polygon fill="lightgreen" stroke="black" points="196549,-406.29 196325,-406.29 196325,-354.29 196549,-354.29 196549,-406.29"/>
<text text-anchor="middle" x="196437" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="196437" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="196437" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="196437" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert0 -->
<g id="edge1521" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198049.73,-499.65C197664.55,-490.26 196839.11,-465.13 196558,-417.06 196545.99,-415.01 196533.48,-412.16 196521.27,-408.95"/>
<polygon fill="black" stroke="black" points="196522.11,-405.56 196511.54,-406.32 196520.28,-412.31 196522.11,-405.56"/>
</g>
<!-- dp2_pp2_layer9_expert1 -->
<g id="node930" class="node">
<title>dp2_pp2_layer9_expert1</title>
<polygon fill="lightgreen" stroke="black" points="196791,-406.29 196567,-406.29 196567,-354.29 196791,-354.29 196791,-406.29"/>
<text text-anchor="middle" x="196679" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="196679" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="196679" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="196679" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert1 -->
<g id="edge1522" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198047.55,-497.55C197705.94,-485.71 197033.58,-458.03 196800,-417.06 196788.08,-414.97 196775.67,-412.12 196763.54,-408.93"/>
<polygon fill="black" stroke="black" points="196764.45,-405.55 196753.89,-406.3 196762.62,-412.3 196764.45,-405.55"/>
</g>
<!-- dp2_pp2_layer9_expert2 -->
<g id="node931" class="node">
<title>dp2_pp2_layer9_expert2</title>
<polygon fill="lightgreen" stroke="black" points="197033,-406.29 196809,-406.29 196809,-354.29 197033,-354.29 197033,-406.29"/>
<text text-anchor="middle" x="196921" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="196921" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="196921" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="196921" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert2 -->
<g id="edge1523" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198052.82,-502.85C197811.66,-498.37 197394.02,-480.97 197042,-417.06 197030.38,-414.95 197018.29,-412.14 197006.44,-409.03"/>
<polygon fill="black" stroke="black" points="197007.13,-405.59 196996.56,-406.34 197005.29,-412.34 197007.13,-405.59"/>
</g>
<!-- dp2_pp2_layer9_expert3 -->
<g id="node932" class="node">
<title>dp2_pp2_layer9_expert3</title>
<polygon fill="lightgreen" stroke="black" points="197275,-406.29 197051,-406.29 197051,-354.29 197275,-354.29 197275,-406.29"/>
<text text-anchor="middle" x="197163" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="197163" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="197163" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="197163" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert3 -->
<g id="edge1524" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198047.36,-497.41C197850.31,-488.25 197544.63,-466.79 197284,-417.06 197272.57,-414.88 197260.67,-412.06 197248.99,-408.97"/>
<polygon fill="black" stroke="black" points="197249.82,-405.57 197239.25,-406.31 197247.98,-412.32 197249.82,-405.57"/>
</g>
<!-- dp2_pp2_layer9_expert4 -->
<g id="node933" class="node">
<title>dp2_pp2_layer9_expert4</title>
<polygon fill="lightgreen" stroke="black" points="197517,-406.29 197293,-406.29 197293,-354.29 197517,-354.29 197517,-406.29"/>
<text text-anchor="middle" x="197405" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="197405" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="197405" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="197405" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert4 -->
<g id="edge1525" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198038.43,-487.98C197892.99,-474.71 197696.64,-452.25 197526,-417.06 197515.05,-414.8 197503.65,-412.02 197492.43,-409.02"/>
<polygon fill="black" stroke="black" points="197493.19,-405.6 197482.62,-406.33 197491.34,-412.35 197493.19,-405.6"/>
</g>
<!-- dp2_pp2_layer9_expert5 -->
<g id="node934" class="node">
<title>dp2_pp2_layer9_expert5</title>
<polygon fill="lightgreen" stroke="black" points="197759,-406.29 197535,-406.29 197535,-354.29 197759,-354.29 197759,-406.29"/>
<text text-anchor="middle" x="197647" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="197647" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="197647" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="197647" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert5 -->
<g id="edge1526" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198018.29,-467.38C197938.5,-453.44 197849,-436.25 197768,-417.06 197757.9,-414.67 197747.4,-411.94 197736.99,-409.07"/>
<polygon fill="black" stroke="black" points="197737.62,-405.62 197727.05,-406.3 197735.74,-412.36 197737.62,-405.62"/>
</g>
<!-- dp2_pp2_layer9_expert6 -->
<g id="node935" class="node">
<title>dp2_pp2_layer9_expert6</title>
<polygon fill="lightgreen" stroke="black" points="198001,-406.29 197777,-406.29 197777,-354.29 198001,-354.29 198001,-406.29"/>
<text text-anchor="middle" x="197889" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="197889" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="197889" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="197889" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert6 -->
<g id="edge1527" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198100.94,-452.97C198057.16,-438.16 198010.94,-422.53 197972.87,-409.66"/>
<polygon fill="black" stroke="black" points="197973.97,-406.33 197963.38,-406.45 197971.73,-412.97 197973.97,-406.33"/>
</g>
<!-- dp2_pp2_layer9_expert7 -->
<g id="node936" class="node">
<title>dp2_pp2_layer9_expert7</title>
<polygon fill="lightgreen" stroke="black" points="198243,-406.29 198019,-406.29 198019,-354.29 198243,-354.29 198243,-406.29"/>
<text text-anchor="middle" x="198131" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="198131" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="198131" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="198131" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert7 -->
<g id="edge1528" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198201.38,-452.71C198188.3,-439.43 198174.58,-425.51 198162.76,-413.52"/>
<polygon fill="black" stroke="black" points="198165.19,-411 198155.68,-406.33 198160.2,-415.91 198165.19,-411"/>
</g>
<!-- dp2_pp2_layer9_expert8 -->
<g id="node937" class="node">
<title>dp2_pp2_layer9_expert8</title>
<polygon fill="lightgreen" stroke="black" points="198485,-406.29 198261,-406.29 198261,-354.29 198485,-354.29 198485,-406.29"/>
<text text-anchor="middle" x="198373" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="198373" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="198373" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="198373" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert8 -->
<g id="edge1529" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198302.61,-452.71C198315.7,-439.43 198329.42,-425.51 198341.23,-413.52"/>
<polygon fill="black" stroke="black" points="198343.79,-415.91 198348.32,-406.33 198338.81,-411 198343.79,-415.91"/>
</g>
<!-- dp2_pp2_layer9_expert9 -->
<g id="node938" class="node">
<title>dp2_pp2_layer9_expert9</title>
<polygon fill="lightgreen" stroke="black" points="198727,-406.29 198503,-406.29 198503,-354.29 198727,-354.29 198727,-406.29"/>
<text text-anchor="middle" x="198615" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="198615" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="198615" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="198615" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert9 -->
<g id="edge1530" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198399.38,-454.21C198444.29,-439.03 198492.08,-422.86 198531.23,-409.62"/>
<polygon fill="black" stroke="black" points="198532.64,-412.84 198540.99,-406.32 198530.4,-406.21 198532.64,-412.84"/>
</g>
<!-- dp2_pp2_layer9_expert10 -->
<g id="node939" class="node">
<title>dp2_pp2_layer9_expert10</title>
<polygon fill="lightgreen" stroke="black" points="198969,-406.29 198745,-406.29 198745,-354.29 198969,-354.29 198969,-406.29"/>
<text text-anchor="middle" x="198857" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="198857" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="198857" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="198857" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert10 -->
<g id="edge1531" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198422.89,-478.04C198515.98,-462.69 198632.88,-441.49 198736,-417.06 198746.09,-414.67 198756.6,-411.94 198767.01,-409.07"/>
<polygon fill="black" stroke="black" points="198768.26,-412.36 198776.95,-406.3 198766.37,-405.62 198768.26,-412.36"/>
</g>
<!-- dp2_pp2_layer9_expert11 -->
<g id="node940" class="node">
<title>dp2_pp2_layer9_expert11</title>
<polygon fill="lightgreen" stroke="black" points="199211,-406.29 198987,-406.29 198987,-354.29 199211,-354.29 199211,-406.29"/>
<text text-anchor="middle" x="199099" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="199099" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="199099" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="199099" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert11 -->
<g id="edge1532" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198434.99,-490.7C198582.62,-477.88 198795.08,-454.78 198978,-417.06 198988.95,-414.8 199000.35,-412.02 199011.57,-409.02"/>
<polygon fill="black" stroke="black" points="199012.66,-412.35 199021.38,-406.33 199010.81,-405.6 199012.66,-412.35"/>
</g>
<!-- dp2_pp2_layer9_expert12 -->
<g id="node941" class="node">
<title>dp2_pp2_layer9_expert12</title>
<polygon fill="lightgreen" stroke="black" points="199453,-406.29 199229,-406.29 199229,-354.29 199453,-354.29 199453,-406.29"/>
<text text-anchor="middle" x="199341" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="199341" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="199341" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="199341" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert12 -->
<g id="edge1533" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198442.27,-498.07C198638.59,-489.29 198952.95,-468.01 199220,-417.06 199231.43,-414.88 199243.33,-412.06 199255.01,-408.97"/>
<polygon fill="black" stroke="black" points="199256.02,-412.32 199264.75,-406.31 199254.18,-405.57 199256.02,-412.32"/>
</g>
<!-- dp2_pp2_layer9_expert13 -->
<g id="node942" class="node">
<title>dp2_pp2_layer9_expert13</title>
<polygon fill="lightgreen" stroke="black" points="199695,-406.29 199471,-406.29 199471,-354.29 199695,-354.29 199695,-406.29"/>
<text text-anchor="middle" x="199583" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="199583" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="199583" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="199583" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert13 -->
<g id="edge1534" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198446.93,-502.93C198687.42,-498.58 199107.9,-481.35 199462,-417.06 199473.62,-414.95 199485.71,-412.14 199497.56,-409.03"/>
<polygon fill="black" stroke="black" points="199498.7,-412.34 199507.44,-406.34 199496.87,-405.59 199498.7,-412.34"/>
</g>
<!-- dp2_pp2_layer9_expert14 -->
<g id="node943" class="node">
<title>dp2_pp2_layer9_expert14</title>
<polygon fill="lightgreen" stroke="black" points="199937,-406.29 199713,-406.29 199713,-354.29 199937,-354.29 199937,-406.29"/>
<text text-anchor="middle" x="199825" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="199825" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="199825" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="199825" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert14 -->
<g id="edge1535" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198442.32,-498.04C198779.17,-486.48 199467.15,-458.6 199704,-417.06 199715.92,-414.97 199728.32,-412.12 199740.46,-408.93"/>
<polygon fill="black" stroke="black" points="199741.38,-412.3 199750.11,-406.3 199739.54,-405.55 199741.38,-412.3"/>
</g>
<!-- dp2_pp2_layer9_expert15 -->
<g id="node944" class="node">
<title>dp2_pp2_layer9_expert15</title>
<polygon fill="lightgreen" stroke="black" points="200179,-406.29 199955,-406.29 199955,-354.29 200179,-354.29 200179,-406.29"/>
<text text-anchor="middle" x="200067" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="200067" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="200067" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="200067" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert15 -->
<g id="edge1536" class="edge">
<title>dp2_pp2_layer9_router&#45;&gt;dp2_pp2_layer9_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M198443.94,-499.9C198824.49,-490.72 199662.35,-465.57 199946,-417.06 199958.01,-415.01 199970.51,-412.16 199982.73,-408.95"/>
<polygon fill="black" stroke="black" points="199983.72,-412.31 199992.45,-406.32 199981.88,-405.56 199983.72,-412.31"/>
</g>
<!-- dp2_pp2_layer9_expert_agg -->
<g id="node945" class="node">
<title>dp2_pp2_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="198499.57,-307.52 198105.74,-307.52 198004.43,-203.52 198398.26,-203.52 198499.57,-307.52"/>
<text text-anchor="middle" x="198252" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="198252" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="198252" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="198252" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer9_expert0&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1537" class="edge">
<title>dp2_pp2_layer9_expert0&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M196495.07,-354.29C196514.69,-346.92 196536.97,-339.72 196558,-335.52 196837.13,-279.86 197660.93,-263.21 198047.43,-258.4"/>
<polygon fill="black" stroke="black" points="198047.65,-261.9 198057.61,-258.27 198047.57,-254.9 198047.65,-261.9"/>
</g>
<!-- dp2_pp2_layer9_expert1&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1538" class="edge">
<title>dp2_pp2_layer9_expert1&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M196737.39,-354.27C196756.95,-346.95 196779.09,-339.78 196800,-335.52 197032.8,-288.16 197708.09,-267.74 198049.43,-260.24"/>
<polygon fill="black" stroke="black" points="198049.51,-263.74 198059.43,-260.03 198049.35,-256.74 198049.51,-263.74"/>
</g>
<!-- dp2_pp2_layer9_expert2&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1539" class="edge">
<title>dp2_pp2_layer9_expert2&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M196979.73,-354.29C196999.21,-347.01 197021.23,-339.87 197042,-335.52 197228.91,-296.44 197758.54,-273.07 198051.3,-262.78"/>
<polygon fill="black" stroke="black" points="198051.74,-266.27 198061.61,-262.42 198051.5,-259.27 198051.74,-266.27"/>
</g>
<!-- dp2_pp2_layer9_expert3&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1540" class="edge">
<title>dp2_pp2_layer9_expert3&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M197222.39,-354.26C197241.72,-347.07 197263.48,-339.99 197284,-335.52 197542.91,-279.18 197848.7,-262.24 198046.26,-257.56"/>
<polygon fill="black" stroke="black" points="198046.55,-261.06 198056.47,-257.33 198046.39,-254.06 198046.55,-261.06"/>
</g>
<!-- dp2_pp2_layer9_expert4&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1541" class="edge">
<title>dp2_pp2_layer9_expert4&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M197465.39,-354.24C197484.49,-347.2 197505.87,-340.19 197526,-335.52 197701.82,-294.77 197906.6,-274.91 198053.75,-265.31"/>
<polygon fill="black" stroke="black" points="198054.05,-268.8 198063.81,-264.67 198053.6,-261.82 198054.05,-268.8"/>
</g>
<!-- dp2_pp2_layer9_expert5&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1542" class="edge">
<title>dp2_pp2_layer9_expert5&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M197709.42,-354.22C197728.04,-347.42 197748.65,-340.55 197768,-335.52 197865.09,-310.27 197975.34,-291.53 198066.07,-278.65"/>
<polygon fill="black" stroke="black" points="198066.78,-282.09 198076.19,-277.23 198065.8,-275.16 198066.78,-282.09"/>
</g>
<!-- dp2_pp2_layer9_expert6&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1543" class="edge">
<title>dp2_pp2_layer9_expert6&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M197957.02,-354.26C197974.26,-348.03 197992.78,-341.44 198010,-335.52 198036.73,-326.33 198065.21,-316.8 198092.89,-307.67"/>
<polygon fill="black" stroke="black" points="198094.24,-310.91 198102.65,-304.46 198092.06,-304.26 198094.24,-310.91"/>
</g>
<!-- dp2_pp2_layer9_expert7&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1544" class="edge">
<title>dp2_pp2_layer9_expert7&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M198155.78,-354.15C198167.02,-342.74 198180.83,-328.73 198194.45,-314.92"/>
<polygon fill="black" stroke="black" points="198197,-317.31 198201.53,-307.73 198192.02,-312.39 198197,-317.31"/>
</g>
<!-- dp2_pp2_layer9_expert8&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1545" class="edge">
<title>dp2_pp2_layer9_expert8&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M198348.22,-354.15C198336.97,-342.74 198323.16,-328.73 198309.55,-314.92"/>
<polygon fill="black" stroke="black" points="198311.98,-312.39 198302.47,-307.73 198306.99,-317.31 198311.98,-312.39"/>
</g>
<!-- dp2_pp2_layer9_expert9&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1546" class="edge">
<title>dp2_pp2_layer9_expert9&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M198546.98,-354.26C198529.73,-348.03 198511.21,-341.44 198494,-335.52 198470.29,-327.37 198445.21,-318.95 198420.53,-310.78"/>
<polygon fill="black" stroke="black" points="198421.32,-307.36 198410.73,-307.54 198419.12,-314 198421.32,-307.36"/>
</g>
<!-- dp2_pp2_layer9_expert10&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1547" class="edge">
<title>dp2_pp2_layer9_expert10&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M198794.58,-354.22C198775.96,-347.42 198755.35,-340.55 198736,-335.52 198655.99,-314.71 198567.05,-298.33 198487.46,-286"/>
<polygon fill="black" stroke="black" points="198487.71,-282.5 198477.3,-284.44 198486.65,-289.41 198487.71,-282.5"/>
</g>
<!-- dp2_pp2_layer9_expert11&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1548" class="edge">
<title>dp2_pp2_layer9_expert11&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M199038.61,-354.24C199019.51,-347.2 198998.13,-340.19 198978,-335.52 198809.74,-296.53 198614.97,-276.66 198469.55,-266.61"/>
<polygon fill="black" stroke="black" points="198469.38,-263.09 198459.16,-265.9 198468.9,-270.07 198469.38,-263.09"/>
</g>
<!-- dp2_pp2_layer9_expert12&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1549" class="edge">
<title>dp2_pp2_layer9_expert12&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M199281.61,-354.26C199262.28,-347.07 199240.52,-339.99 199220,-335.52 198962.51,-279.49 198658.64,-262.43 198460.99,-257.64"/>
<polygon fill="black" stroke="black" points="198460.86,-254.14 198450.78,-257.4 198460.69,-261.13 198460.86,-254.14"/>
</g>
<!-- dp2_pp2_layer9_expert13&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1550" class="edge">
<title>dp2_pp2_layer9_expert13&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M199524.27,-354.29C199504.79,-347.01 199482.77,-339.87 199462,-335.52 199278.02,-297.05 198761.97,-273.81 198466.63,-263.27"/>
<polygon fill="black" stroke="black" points="198466.33,-259.76 198456.21,-262.9 198466.08,-266.76 198466.33,-259.76"/>
</g>
<!-- dp2_pp2_layer9_expert14&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1551" class="edge">
<title>dp2_pp2_layer9_expert14&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M199766.6,-354.27C199747.05,-346.95 199724.9,-339.78 199704,-335.52 199473.27,-288.58 198807.86,-268.1 198463.74,-260.45"/>
<polygon fill="black" stroke="black" points="198463.73,-256.94 198453.65,-260.22 198463.57,-263.94 198463.73,-256.94"/>
</g>
<!-- dp2_pp2_layer9_expert15&#45;&gt;dp2_pp2_layer9_expert_agg -->
<g id="edge1552" class="edge">
<title>dp2_pp2_layer9_expert15&#45;&gt;dp2_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M200008.93,-354.29C199989.3,-346.92 199967.03,-339.72 199946,-335.52 199668.21,-280.12 198850.98,-263.37 198462.17,-258.47"/>
<polygon fill="black" stroke="black" points="198461.97,-254.97 198451.93,-258.34 198461.88,-261.97 198461.97,-254.97"/>
</g>
<!-- dp2_pp2_layer10_attn_tp0 -->
<g id="node946" class="node">
<title>dp2_pp2_layer10_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="195734.5,-531.06 195469.5,-531.06 195469.5,-479.06 195734.5,-479.06 195734.5,-531.06"/>
<text text-anchor="middle" x="195602" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="195602" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="195602" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="195602" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer9_expert_agg&#45;&gt;dp2_pp2_layer10_attn_tp0 -->
<g id="edge1554" class="edge">
<title>dp2_pp2_layer9_expert_agg&#45;&gt;dp2_pp2_layer10_attn_tp0</title>
<path fill="none" stroke="black" d="M198059.78,-260.41C197639.38,-269.54 196649.17,-294.77 196316,-335.52 196283.8,-339.46 195775.23,-444.29 195744,-453.06 195721.37,-459.41 195697.16,-467.58 195675.26,-475.5"/>
<polygon fill="black" stroke="black" points="195673.89,-472.28 195665.7,-479 195676.29,-478.85 195673.89,-472.28"/>
</g>
<!-- dp2_pp2_layer10_attn_allreduce -->
<g id="node947" class="node">
<title>dp2_pp2_layer10_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="195731" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="195731" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="195731" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="195731" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="195731" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_attn_tp0&#45;&gt;dp2_pp2_layer10_attn_allreduce -->
<g id="edge1555" class="edge">
<title>dp2_pp2_layer10_attn_tp0&#45;&gt;dp2_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M195628.41,-478.92C195645.15,-463 195667.21,-442 195686.58,-423.56"/>
<polygon fill="black" stroke="black" points="195689.03,-426.07 195693.86,-416.64 195684.2,-421 195689.03,-426.07"/>
</g>
<!-- dp2_pp2_layer10_router -->
<g id="node951" class="node">
<title>dp2_pp2_layer10_router</title>
<polygon fill="lightyellow" stroke="black" points="193482.57,-557.06 193088.74,-557.06 192987.43,-453.06 193381.26,-453.06 193482.57,-557.06"/>
<text text-anchor="middle" x="193235" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="193235" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="193235" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="193235" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_attn_allreduce&#45;&gt;dp2_pp2_layer10_router -->
<g id="edge1591" class="edge">
<title>dp2_pp2_layer10_attn_allreduce&#45;&gt;dp2_pp2_layer10_router</title>
<path fill="none" stroke="black" d="M195571.08,-392.38C195459.77,-399.9 195307.89,-409.76 195174,-417.06 194538.5,-451.72 193785.28,-482.59 193433.96,-496.4"/>
<polygon fill="black" stroke="black" points="193433.8,-492.91 193423.94,-496.79 193434.07,-499.9 193433.8,-492.91"/>
</g>
<!-- dp2_pp2_layer10_attn_tp1 -->
<g id="node948" class="node">
<title>dp2_pp2_layer10_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="196017.5,-531.06 195752.5,-531.06 195752.5,-479.06 196017.5,-479.06 196017.5,-531.06"/>
<text text-anchor="middle" x="195885" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="195885" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="195885" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="195885" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer10_attn_tp1&#45;&gt;dp2_pp2_layer10_attn_allreduce -->
<g id="edge1556" class="edge">
<title>dp2_pp2_layer10_attn_tp1&#45;&gt;dp2_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M195853.46,-478.92C195832.99,-462.6 195805.83,-440.94 195782.29,-422.18"/>
<polygon fill="black" stroke="black" points="195784.46,-419.44 195774.46,-415.94 195780.1,-424.91 195784.46,-419.44"/>
</g>
<!-- dp2_pp2_layer10_attn_tp2 -->
<g id="node949" class="node">
<title>dp2_pp2_layer10_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="195451.5,-531.06 195186.5,-531.06 195186.5,-479.06 195451.5,-479.06 195451.5,-531.06"/>
<text text-anchor="middle" x="195319" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="195319" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="195319" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="195319" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer10_attn_tp2&#45;&gt;dp2_pp2_layer10_attn_allreduce -->
<g id="edge1557" class="edge">
<title>dp2_pp2_layer10_attn_tp2&#45;&gt;dp2_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M195385.07,-479.02C195408.85,-470.35 195435.99,-460.86 195461,-453.06 195509.74,-437.86 195564.05,-423.03 195611.1,-410.83"/>
<polygon fill="black" stroke="black" points="195612.22,-414.15 195621.03,-408.26 195610.47,-407.38 195612.22,-414.15"/>
</g>
<!-- dp2_pp2_layer10_attn_tp3 -->
<g id="node950" class="node">
<title>dp2_pp2_layer10_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="196300.5,-531.06 196035.5,-531.06 196035.5,-479.06 196300.5,-479.06 196300.5,-531.06"/>
<text text-anchor="middle" x="196168" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="196168" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="196168" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="196168" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer10_attn_tp3&#45;&gt;dp2_pp2_layer10_attn_allreduce -->
<g id="edge1558" class="edge">
<title>dp2_pp2_layer10_attn_tp3&#45;&gt;dp2_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M196103.21,-478.95C196079.43,-470.18 196052.17,-460.64 196027,-453.06 195972.42,-436.63 195911.31,-421.31 195858.86,-409.08"/>
<polygon fill="black" stroke="black" points="195859.37,-405.6 195848.83,-406.75 195857.78,-412.42 195859.37,-405.6"/>
</g>
<!-- dp2_pp2_layer10_expert0 -->
<g id="node952" class="node">
<title>dp2_pp2_layer10_expert0</title>
<polygon fill="lightgreen" stroke="black" points="191532,-406.29 191308,-406.29 191308,-354.29 191532,-354.29 191532,-406.29"/>
<text text-anchor="middle" x="191420" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="191420" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="191420" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="191420" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert0 -->
<g id="edge1559" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193032.73,-499.65C192647.55,-490.26 191822.11,-465.13 191541,-417.06 191528.99,-415.01 191516.48,-412.16 191504.27,-408.95"/>
<polygon fill="black" stroke="black" points="191505.11,-405.56 191494.54,-406.32 191503.28,-412.31 191505.11,-405.56"/>
</g>
<!-- dp2_pp2_layer10_expert1 -->
<g id="node953" class="node">
<title>dp2_pp2_layer10_expert1</title>
<polygon fill="lightgreen" stroke="black" points="191774,-406.29 191550,-406.29 191550,-354.29 191774,-354.29 191774,-406.29"/>
<text text-anchor="middle" x="191662" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="191662" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="191662" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="191662" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert1 -->
<g id="edge1560" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193030.55,-497.55C192688.94,-485.71 192016.58,-458.03 191783,-417.06 191771.08,-414.97 191758.67,-412.12 191746.54,-408.93"/>
<polygon fill="black" stroke="black" points="191747.45,-405.55 191736.89,-406.3 191745.62,-412.3 191747.45,-405.55"/>
</g>
<!-- dp2_pp2_layer10_expert2 -->
<g id="node954" class="node">
<title>dp2_pp2_layer10_expert2</title>
<polygon fill="lightgreen" stroke="black" points="192016,-406.29 191792,-406.29 191792,-354.29 192016,-354.29 192016,-406.29"/>
<text text-anchor="middle" x="191904" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="191904" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="191904" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="191904" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert2 -->
<g id="edge1561" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193035.82,-502.85C192794.66,-498.37 192377.02,-480.97 192025,-417.06 192013.38,-414.95 192001.29,-412.14 191989.44,-409.03"/>
<polygon fill="black" stroke="black" points="191990.13,-405.59 191979.56,-406.34 191988.29,-412.34 191990.13,-405.59"/>
</g>
<!-- dp2_pp2_layer10_expert3 -->
<g id="node955" class="node">
<title>dp2_pp2_layer10_expert3</title>
<polygon fill="lightgreen" stroke="black" points="192258,-406.29 192034,-406.29 192034,-354.29 192258,-354.29 192258,-406.29"/>
<text text-anchor="middle" x="192146" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="192146" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="192146" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="192146" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert3 -->
<g id="edge1562" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193030.36,-497.41C192833.31,-488.25 192527.63,-466.79 192267,-417.06 192255.57,-414.88 192243.67,-412.06 192231.99,-408.97"/>
<polygon fill="black" stroke="black" points="192232.82,-405.57 192222.25,-406.31 192230.98,-412.32 192232.82,-405.57"/>
</g>
<!-- dp2_pp2_layer10_expert4 -->
<g id="node956" class="node">
<title>dp2_pp2_layer10_expert4</title>
<polygon fill="lightgreen" stroke="black" points="192500,-406.29 192276,-406.29 192276,-354.29 192500,-354.29 192500,-406.29"/>
<text text-anchor="middle" x="192388" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="192388" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="192388" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="192388" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert4 -->
<g id="edge1563" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193021.43,-487.98C192875.99,-474.71 192679.64,-452.25 192509,-417.06 192498.05,-414.8 192486.65,-412.02 192475.43,-409.02"/>
<polygon fill="black" stroke="black" points="192476.19,-405.6 192465.62,-406.33 192474.34,-412.35 192476.19,-405.6"/>
</g>
<!-- dp2_pp2_layer10_expert5 -->
<g id="node957" class="node">
<title>dp2_pp2_layer10_expert5</title>
<polygon fill="lightgreen" stroke="black" points="192742,-406.29 192518,-406.29 192518,-354.29 192742,-354.29 192742,-406.29"/>
<text text-anchor="middle" x="192630" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="192630" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="192630" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="192630" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert5 -->
<g id="edge1564" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193001.29,-467.38C192921.5,-453.44 192832,-436.25 192751,-417.06 192740.9,-414.67 192730.4,-411.94 192719.99,-409.07"/>
<polygon fill="black" stroke="black" points="192720.62,-405.62 192710.05,-406.3 192718.74,-412.36 192720.62,-405.62"/>
</g>
<!-- dp2_pp2_layer10_expert6 -->
<g id="node958" class="node">
<title>dp2_pp2_layer10_expert6</title>
<polygon fill="lightgreen" stroke="black" points="192984,-406.29 192760,-406.29 192760,-354.29 192984,-354.29 192984,-406.29"/>
<text text-anchor="middle" x="192872" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="192872" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="192872" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="192872" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert6 -->
<g id="edge1565" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193083.94,-452.97C193040.16,-438.16 192993.94,-422.53 192955.87,-409.66"/>
<polygon fill="black" stroke="black" points="192956.97,-406.33 192946.38,-406.45 192954.73,-412.97 192956.97,-406.33"/>
</g>
<!-- dp2_pp2_layer10_expert7 -->
<g id="node959" class="node">
<title>dp2_pp2_layer10_expert7</title>
<polygon fill="lightgreen" stroke="black" points="193226,-406.29 193002,-406.29 193002,-354.29 193226,-354.29 193226,-406.29"/>
<text text-anchor="middle" x="193114" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="193114" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="193114" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="193114" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert7 -->
<g id="edge1566" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193184.38,-452.71C193171.3,-439.43 193157.58,-425.51 193145.76,-413.52"/>
<polygon fill="black" stroke="black" points="193148.19,-411 193138.68,-406.33 193143.2,-415.91 193148.19,-411"/>
</g>
<!-- dp2_pp2_layer10_expert8 -->
<g id="node960" class="node">
<title>dp2_pp2_layer10_expert8</title>
<polygon fill="lightgreen" stroke="black" points="193468,-406.29 193244,-406.29 193244,-354.29 193468,-354.29 193468,-406.29"/>
<text text-anchor="middle" x="193356" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="193356" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="193356" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="193356" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert8 -->
<g id="edge1567" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193285.61,-452.71C193298.7,-439.43 193312.42,-425.51 193324.23,-413.52"/>
<polygon fill="black" stroke="black" points="193326.79,-415.91 193331.32,-406.33 193321.81,-411 193326.79,-415.91"/>
</g>
<!-- dp2_pp2_layer10_expert9 -->
<g id="node961" class="node">
<title>dp2_pp2_layer10_expert9</title>
<polygon fill="lightgreen" stroke="black" points="193710,-406.29 193486,-406.29 193486,-354.29 193710,-354.29 193710,-406.29"/>
<text text-anchor="middle" x="193598" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="193598" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="193598" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="193598" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert9 -->
<g id="edge1568" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193382.38,-454.21C193427.29,-439.03 193475.08,-422.86 193514.23,-409.62"/>
<polygon fill="black" stroke="black" points="193515.64,-412.84 193523.99,-406.32 193513.4,-406.21 193515.64,-412.84"/>
</g>
<!-- dp2_pp2_layer10_expert10 -->
<g id="node962" class="node">
<title>dp2_pp2_layer10_expert10</title>
<polygon fill="lightgreen" stroke="black" points="193952,-406.29 193728,-406.29 193728,-354.29 193952,-354.29 193952,-406.29"/>
<text text-anchor="middle" x="193840" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="193840" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="193840" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="193840" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert10 -->
<g id="edge1569" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193405.89,-478.04C193498.98,-462.69 193615.88,-441.49 193719,-417.06 193729.09,-414.67 193739.6,-411.94 193750.01,-409.07"/>
<polygon fill="black" stroke="black" points="193751.26,-412.36 193759.95,-406.3 193749.37,-405.62 193751.26,-412.36"/>
</g>
<!-- dp2_pp2_layer10_expert11 -->
<g id="node963" class="node">
<title>dp2_pp2_layer10_expert11</title>
<polygon fill="lightgreen" stroke="black" points="194194,-406.29 193970,-406.29 193970,-354.29 194194,-354.29 194194,-406.29"/>
<text text-anchor="middle" x="194082" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="194082" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="194082" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="194082" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert11 -->
<g id="edge1570" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193417.99,-490.7C193565.62,-477.88 193778.08,-454.78 193961,-417.06 193971.95,-414.8 193983.35,-412.02 193994.57,-409.02"/>
<polygon fill="black" stroke="black" points="193995.66,-412.35 194004.38,-406.33 193993.81,-405.6 193995.66,-412.35"/>
</g>
<!-- dp2_pp2_layer10_expert12 -->
<g id="node964" class="node">
<title>dp2_pp2_layer10_expert12</title>
<polygon fill="lightgreen" stroke="black" points="194436,-406.29 194212,-406.29 194212,-354.29 194436,-354.29 194436,-406.29"/>
<text text-anchor="middle" x="194324" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="194324" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="194324" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="194324" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert12 -->
<g id="edge1571" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193425.27,-498.07C193621.59,-489.29 193935.95,-468.01 194203,-417.06 194214.43,-414.88 194226.33,-412.06 194238.01,-408.97"/>
<polygon fill="black" stroke="black" points="194239.02,-412.32 194247.75,-406.31 194237.18,-405.57 194239.02,-412.32"/>
</g>
<!-- dp2_pp2_layer10_expert13 -->
<g id="node965" class="node">
<title>dp2_pp2_layer10_expert13</title>
<polygon fill="lightgreen" stroke="black" points="194678,-406.29 194454,-406.29 194454,-354.29 194678,-354.29 194678,-406.29"/>
<text text-anchor="middle" x="194566" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="194566" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="194566" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="194566" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert13 -->
<g id="edge1572" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193429.93,-502.93C193670.42,-498.58 194090.9,-481.35 194445,-417.06 194456.62,-414.95 194468.71,-412.14 194480.56,-409.03"/>
<polygon fill="black" stroke="black" points="194481.7,-412.34 194490.44,-406.34 194479.87,-405.59 194481.7,-412.34"/>
</g>
<!-- dp2_pp2_layer10_expert14 -->
<g id="node966" class="node">
<title>dp2_pp2_layer10_expert14</title>
<polygon fill="lightgreen" stroke="black" points="194920,-406.29 194696,-406.29 194696,-354.29 194920,-354.29 194920,-406.29"/>
<text text-anchor="middle" x="194808" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="194808" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="194808" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="194808" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert14 -->
<g id="edge1573" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193425.32,-498.04C193762.17,-486.48 194450.15,-458.6 194687,-417.06 194698.92,-414.97 194711.32,-412.12 194723.46,-408.93"/>
<polygon fill="black" stroke="black" points="194724.38,-412.3 194733.11,-406.3 194722.54,-405.55 194724.38,-412.3"/>
</g>
<!-- dp2_pp2_layer10_expert15 -->
<g id="node967" class="node">
<title>dp2_pp2_layer10_expert15</title>
<polygon fill="lightgreen" stroke="black" points="195162,-406.29 194938,-406.29 194938,-354.29 195162,-354.29 195162,-406.29"/>
<text text-anchor="middle" x="195050" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="195050" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="195050" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="195050" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert15 -->
<g id="edge1574" class="edge">
<title>dp2_pp2_layer10_router&#45;&gt;dp2_pp2_layer10_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193426.94,-499.9C193807.49,-490.72 194645.35,-465.57 194929,-417.06 194941.01,-415.01 194953.51,-412.16 194965.73,-408.95"/>
<polygon fill="black" stroke="black" points="194966.72,-412.31 194975.45,-406.32 194964.88,-405.56 194966.72,-412.31"/>
</g>
<!-- dp2_pp2_layer10_expert_agg -->
<g id="node968" class="node">
<title>dp2_pp2_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="193482.57,-307.52 193088.74,-307.52 192987.43,-203.52 193381.26,-203.52 193482.57,-307.52"/>
<text text-anchor="middle" x="193235" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="193235" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="193235" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="193235" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer10_expert0&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1575" class="edge">
<title>dp2_pp2_layer10_expert0&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M191478.07,-354.29C191497.69,-346.92 191519.97,-339.72 191541,-335.52 191820.13,-279.86 192643.93,-263.21 193030.43,-258.4"/>
<polygon fill="black" stroke="black" points="193030.65,-261.9 193040.61,-258.27 193030.57,-254.9 193030.65,-261.9"/>
</g>
<!-- dp2_pp2_layer10_expert1&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1576" class="edge">
<title>dp2_pp2_layer10_expert1&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M191720.39,-354.27C191739.95,-346.95 191762.09,-339.78 191783,-335.52 192015.8,-288.16 192691.09,-267.74 193032.43,-260.24"/>
<polygon fill="black" stroke="black" points="193032.51,-263.74 193042.43,-260.03 193032.35,-256.74 193032.51,-263.74"/>
</g>
<!-- dp2_pp2_layer10_expert2&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1577" class="edge">
<title>dp2_pp2_layer10_expert2&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M191962.73,-354.29C191982.21,-347.01 192004.23,-339.87 192025,-335.52 192211.91,-296.44 192741.54,-273.07 193034.3,-262.78"/>
<polygon fill="black" stroke="black" points="193034.74,-266.27 193044.61,-262.42 193034.5,-259.27 193034.74,-266.27"/>
</g>
<!-- dp2_pp2_layer10_expert3&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1578" class="edge">
<title>dp2_pp2_layer10_expert3&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M192205.39,-354.26C192224.72,-347.07 192246.48,-339.99 192267,-335.52 192525.91,-279.18 192831.7,-262.24 193029.26,-257.56"/>
<polygon fill="black" stroke="black" points="193029.55,-261.06 193039.47,-257.33 193029.39,-254.06 193029.55,-261.06"/>
</g>
<!-- dp2_pp2_layer10_expert4&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1579" class="edge">
<title>dp2_pp2_layer10_expert4&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M192448.39,-354.24C192467.49,-347.2 192488.87,-340.19 192509,-335.52 192684.82,-294.77 192889.6,-274.91 193036.75,-265.31"/>
<polygon fill="black" stroke="black" points="193037.05,-268.8 193046.81,-264.67 193036.6,-261.82 193037.05,-268.8"/>
</g>
<!-- dp2_pp2_layer10_expert5&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1580" class="edge">
<title>dp2_pp2_layer10_expert5&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M192692.42,-354.22C192711.04,-347.42 192731.65,-340.55 192751,-335.52 192848.09,-310.27 192958.34,-291.53 193049.07,-278.65"/>
<polygon fill="black" stroke="black" points="193049.78,-282.09 193059.19,-277.23 193048.8,-275.16 193049.78,-282.09"/>
</g>
<!-- dp2_pp2_layer10_expert6&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1581" class="edge">
<title>dp2_pp2_layer10_expert6&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M192940.02,-354.26C192957.26,-348.03 192975.78,-341.44 192993,-335.52 193019.73,-326.33 193048.21,-316.8 193075.89,-307.67"/>
<polygon fill="black" stroke="black" points="193077.24,-310.91 193085.65,-304.46 193075.06,-304.26 193077.24,-310.91"/>
</g>
<!-- dp2_pp2_layer10_expert7&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1582" class="edge">
<title>dp2_pp2_layer10_expert7&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M193138.78,-354.15C193150.02,-342.74 193163.83,-328.73 193177.45,-314.92"/>
<polygon fill="black" stroke="black" points="193180,-317.31 193184.53,-307.73 193175.02,-312.39 193180,-317.31"/>
</g>
<!-- dp2_pp2_layer10_expert8&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1583" class="edge">
<title>dp2_pp2_layer10_expert8&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M193331.22,-354.15C193319.97,-342.74 193306.16,-328.73 193292.55,-314.92"/>
<polygon fill="black" stroke="black" points="193294.98,-312.39 193285.47,-307.73 193289.99,-317.31 193294.98,-312.39"/>
</g>
<!-- dp2_pp2_layer10_expert9&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1584" class="edge">
<title>dp2_pp2_layer10_expert9&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M193529.98,-354.26C193512.73,-348.03 193494.21,-341.44 193477,-335.52 193453.29,-327.37 193428.21,-318.95 193403.53,-310.78"/>
<polygon fill="black" stroke="black" points="193404.32,-307.36 193393.73,-307.54 193402.12,-314 193404.32,-307.36"/>
</g>
<!-- dp2_pp2_layer10_expert10&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1585" class="edge">
<title>dp2_pp2_layer10_expert10&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M193777.58,-354.22C193758.96,-347.42 193738.35,-340.55 193719,-335.52 193638.99,-314.71 193550.05,-298.33 193470.46,-286"/>
<polygon fill="black" stroke="black" points="193470.71,-282.5 193460.3,-284.44 193469.65,-289.41 193470.71,-282.5"/>
</g>
<!-- dp2_pp2_layer10_expert11&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1586" class="edge">
<title>dp2_pp2_layer10_expert11&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M194021.61,-354.24C194002.51,-347.2 193981.13,-340.19 193961,-335.52 193792.74,-296.53 193597.97,-276.66 193452.55,-266.61"/>
<polygon fill="black" stroke="black" points="193452.38,-263.09 193442.16,-265.9 193451.9,-270.07 193452.38,-263.09"/>
</g>
<!-- dp2_pp2_layer10_expert12&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1587" class="edge">
<title>dp2_pp2_layer10_expert12&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M194264.61,-354.26C194245.28,-347.07 194223.52,-339.99 194203,-335.52 193945.51,-279.49 193641.64,-262.43 193443.99,-257.64"/>
<polygon fill="black" stroke="black" points="193443.86,-254.14 193433.78,-257.4 193443.69,-261.13 193443.86,-254.14"/>
</g>
<!-- dp2_pp2_layer10_expert13&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1588" class="edge">
<title>dp2_pp2_layer10_expert13&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M194507.27,-354.29C194487.79,-347.01 194465.77,-339.87 194445,-335.52 194261.02,-297.05 193744.97,-273.81 193449.63,-263.27"/>
<polygon fill="black" stroke="black" points="193449.33,-259.76 193439.21,-262.9 193449.08,-266.76 193449.33,-259.76"/>
</g>
<!-- dp2_pp2_layer10_expert14&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1589" class="edge">
<title>dp2_pp2_layer10_expert14&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M194749.6,-354.27C194730.05,-346.95 194707.9,-339.78 194687,-335.52 194456.27,-288.58 193790.86,-268.1 193446.74,-260.45"/>
<polygon fill="black" stroke="black" points="193446.73,-256.94 193436.65,-260.22 193446.57,-263.94 193446.73,-256.94"/>
</g>
<!-- dp2_pp2_layer10_expert15&#45;&gt;dp2_pp2_layer10_expert_agg -->
<g id="edge1590" class="edge">
<title>dp2_pp2_layer10_expert15&#45;&gt;dp2_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M194991.93,-354.29C194972.3,-346.92 194950.03,-339.72 194929,-335.52 194651.21,-280.12 193833.98,-263.37 193445.17,-258.47"/>
<polygon fill="black" stroke="black" points="193444.97,-254.97 193434.93,-258.34 193444.88,-261.97 193444.97,-254.97"/>
</g>
<!-- dp2_pp2_layer11_attn_tp0 -->
<g id="node969" class="node">
<title>dp2_pp2_layer11_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="190717.5,-531.06 190452.5,-531.06 190452.5,-479.06 190717.5,-479.06 190717.5,-531.06"/>
<text text-anchor="middle" x="190585" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="190585" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="190585" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="190585" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer10_expert_agg&#45;&gt;dp2_pp2_layer11_attn_tp0 -->
<g id="edge1592" class="edge">
<title>dp2_pp2_layer10_expert_agg&#45;&gt;dp2_pp2_layer11_attn_tp0</title>
<path fill="none" stroke="black" d="M193042.78,-260.41C192622.38,-269.54 191632.17,-294.77 191299,-335.52 191266.8,-339.46 190758.23,-444.29 190727,-453.06 190704.37,-459.41 190680.16,-467.58 190658.26,-475.5"/>
<polygon fill="black" stroke="black" points="190656.89,-472.28 190648.7,-479 190659.29,-478.85 190656.89,-472.28"/>
</g>
<!-- dp2_pp2_layer11_attn_allreduce -->
<g id="node970" class="node">
<title>dp2_pp2_layer11_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="190714" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="190714" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="190714" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="190714" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="190714" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_attn_tp0&#45;&gt;dp2_pp2_layer11_attn_allreduce -->
<g id="edge1593" class="edge">
<title>dp2_pp2_layer11_attn_tp0&#45;&gt;dp2_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M190611.41,-478.92C190628.15,-463 190650.21,-442 190669.58,-423.56"/>
<polygon fill="black" stroke="black" points="190672.03,-426.07 190676.86,-416.64 190667.2,-421 190672.03,-426.07"/>
</g>
<!-- dp2_pp2_layer11_router -->
<g id="node974" class="node">
<title>dp2_pp2_layer11_router</title>
<polygon fill="lightyellow" stroke="black" points="188465.57,-557.06 188071.74,-557.06 187970.43,-453.06 188364.26,-453.06 188465.57,-557.06"/>
<text text-anchor="middle" x="188218" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="188218" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="188218" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="188218" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_attn_allreduce&#45;&gt;dp2_pp2_layer11_router -->
<g id="edge1629" class="edge">
<title>dp2_pp2_layer11_attn_allreduce&#45;&gt;dp2_pp2_layer11_router</title>
<path fill="none" stroke="black" d="M190554.08,-392.38C190442.77,-399.9 190290.89,-409.76 190157,-417.06 189521.5,-451.72 188768.28,-482.59 188416.96,-496.4"/>
<polygon fill="black" stroke="black" points="188416.8,-492.91 188406.94,-496.79 188417.07,-499.9 188416.8,-492.91"/>
</g>
<!-- dp2_pp2_layer11_attn_tp1 -->
<g id="node971" class="node">
<title>dp2_pp2_layer11_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="191000.5,-531.06 190735.5,-531.06 190735.5,-479.06 191000.5,-479.06 191000.5,-531.06"/>
<text text-anchor="middle" x="190868" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="190868" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="190868" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="190868" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer11_attn_tp1&#45;&gt;dp2_pp2_layer11_attn_allreduce -->
<g id="edge1594" class="edge">
<title>dp2_pp2_layer11_attn_tp1&#45;&gt;dp2_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M190836.46,-478.92C190815.99,-462.6 190788.83,-440.94 190765.29,-422.18"/>
<polygon fill="black" stroke="black" points="190767.46,-419.44 190757.46,-415.94 190763.1,-424.91 190767.46,-419.44"/>
</g>
<!-- dp2_pp2_layer11_attn_tp2 -->
<g id="node972" class="node">
<title>dp2_pp2_layer11_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="190434.5,-531.06 190169.5,-531.06 190169.5,-479.06 190434.5,-479.06 190434.5,-531.06"/>
<text text-anchor="middle" x="190302" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="190302" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="190302" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="190302" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer11_attn_tp2&#45;&gt;dp2_pp2_layer11_attn_allreduce -->
<g id="edge1595" class="edge">
<title>dp2_pp2_layer11_attn_tp2&#45;&gt;dp2_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M190368.07,-479.02C190391.85,-470.35 190418.99,-460.86 190444,-453.06 190492.74,-437.86 190547.05,-423.03 190594.1,-410.83"/>
<polygon fill="black" stroke="black" points="190595.22,-414.15 190604.03,-408.26 190593.47,-407.38 190595.22,-414.15"/>
</g>
<!-- dp2_pp2_layer11_attn_tp3 -->
<g id="node973" class="node">
<title>dp2_pp2_layer11_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="191283.5,-531.06 191018.5,-531.06 191018.5,-479.06 191283.5,-479.06 191283.5,-531.06"/>
<text text-anchor="middle" x="191151" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="191151" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="191151" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="191151" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer11_attn_tp3&#45;&gt;dp2_pp2_layer11_attn_allreduce -->
<g id="edge1596" class="edge">
<title>dp2_pp2_layer11_attn_tp3&#45;&gt;dp2_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M191086.21,-478.95C191062.43,-470.18 191035.17,-460.64 191010,-453.06 190955.42,-436.63 190894.31,-421.31 190841.86,-409.08"/>
<polygon fill="black" stroke="black" points="190842.37,-405.6 190831.83,-406.75 190840.78,-412.42 190842.37,-405.6"/>
</g>
<!-- dp2_pp2_layer11_expert0 -->
<g id="node975" class="node">
<title>dp2_pp2_layer11_expert0</title>
<polygon fill="lightgreen" stroke="black" points="186515,-406.29 186291,-406.29 186291,-354.29 186515,-354.29 186515,-406.29"/>
<text text-anchor="middle" x="186403" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="186403" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="186403" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="186403" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert0 -->
<g id="edge1597" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188015.73,-499.65C187630.55,-490.26 186805.11,-465.13 186524,-417.06 186511.99,-415.01 186499.48,-412.16 186487.27,-408.95"/>
<polygon fill="black" stroke="black" points="186488.11,-405.56 186477.54,-406.32 186486.28,-412.31 186488.11,-405.56"/>
</g>
<!-- dp2_pp2_layer11_expert1 -->
<g id="node976" class="node">
<title>dp2_pp2_layer11_expert1</title>
<polygon fill="lightgreen" stroke="black" points="186757,-406.29 186533,-406.29 186533,-354.29 186757,-354.29 186757,-406.29"/>
<text text-anchor="middle" x="186645" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="186645" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="186645" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="186645" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert1 -->
<g id="edge1598" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188013.55,-497.55C187671.94,-485.71 186999.58,-458.03 186766,-417.06 186754.08,-414.97 186741.67,-412.12 186729.54,-408.93"/>
<polygon fill="black" stroke="black" points="186730.45,-405.55 186719.89,-406.3 186728.62,-412.3 186730.45,-405.55"/>
</g>
<!-- dp2_pp2_layer11_expert2 -->
<g id="node977" class="node">
<title>dp2_pp2_layer11_expert2</title>
<polygon fill="lightgreen" stroke="black" points="186999,-406.29 186775,-406.29 186775,-354.29 186999,-354.29 186999,-406.29"/>
<text text-anchor="middle" x="186887" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="186887" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="186887" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="186887" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert2 -->
<g id="edge1599" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188018.82,-502.85C187777.66,-498.37 187360.02,-480.97 187008,-417.06 186996.38,-414.95 186984.29,-412.14 186972.44,-409.03"/>
<polygon fill="black" stroke="black" points="186973.13,-405.59 186962.56,-406.34 186971.29,-412.34 186973.13,-405.59"/>
</g>
<!-- dp2_pp2_layer11_expert3 -->
<g id="node978" class="node">
<title>dp2_pp2_layer11_expert3</title>
<polygon fill="lightgreen" stroke="black" points="187241,-406.29 187017,-406.29 187017,-354.29 187241,-354.29 187241,-406.29"/>
<text text-anchor="middle" x="187129" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="187129" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="187129" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="187129" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert3 -->
<g id="edge1600" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188013.36,-497.41C187816.31,-488.25 187510.63,-466.79 187250,-417.06 187238.57,-414.88 187226.67,-412.06 187214.99,-408.97"/>
<polygon fill="black" stroke="black" points="187215.82,-405.57 187205.25,-406.31 187213.98,-412.32 187215.82,-405.57"/>
</g>
<!-- dp2_pp2_layer11_expert4 -->
<g id="node979" class="node">
<title>dp2_pp2_layer11_expert4</title>
<polygon fill="lightgreen" stroke="black" points="187483,-406.29 187259,-406.29 187259,-354.29 187483,-354.29 187483,-406.29"/>
<text text-anchor="middle" x="187371" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="187371" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="187371" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="187371" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert4 -->
<g id="edge1601" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188004.43,-487.98C187858.99,-474.71 187662.64,-452.25 187492,-417.06 187481.05,-414.8 187469.65,-412.02 187458.43,-409.02"/>
<polygon fill="black" stroke="black" points="187459.19,-405.6 187448.62,-406.33 187457.34,-412.35 187459.19,-405.6"/>
</g>
<!-- dp2_pp2_layer11_expert5 -->
<g id="node980" class="node">
<title>dp2_pp2_layer11_expert5</title>
<polygon fill="lightgreen" stroke="black" points="187725,-406.29 187501,-406.29 187501,-354.29 187725,-354.29 187725,-406.29"/>
<text text-anchor="middle" x="187613" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="187613" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="187613" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="187613" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert5 -->
<g id="edge1602" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M187984.29,-467.38C187904.5,-453.44 187815,-436.25 187734,-417.06 187723.9,-414.67 187713.4,-411.94 187702.99,-409.07"/>
<polygon fill="black" stroke="black" points="187703.62,-405.62 187693.05,-406.3 187701.74,-412.36 187703.62,-405.62"/>
</g>
<!-- dp2_pp2_layer11_expert6 -->
<g id="node981" class="node">
<title>dp2_pp2_layer11_expert6</title>
<polygon fill="lightgreen" stroke="black" points="187967,-406.29 187743,-406.29 187743,-354.29 187967,-354.29 187967,-406.29"/>
<text text-anchor="middle" x="187855" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="187855" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="187855" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="187855" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert6 -->
<g id="edge1603" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188066.94,-452.97C188023.16,-438.16 187976.94,-422.53 187938.87,-409.66"/>
<polygon fill="black" stroke="black" points="187939.97,-406.33 187929.38,-406.45 187937.73,-412.97 187939.97,-406.33"/>
</g>
<!-- dp2_pp2_layer11_expert7 -->
<g id="node982" class="node">
<title>dp2_pp2_layer11_expert7</title>
<polygon fill="lightgreen" stroke="black" points="188209,-406.29 187985,-406.29 187985,-354.29 188209,-354.29 188209,-406.29"/>
<text text-anchor="middle" x="188097" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="188097" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="188097" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="188097" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert7 -->
<g id="edge1604" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188167.38,-452.71C188154.3,-439.43 188140.58,-425.51 188128.76,-413.52"/>
<polygon fill="black" stroke="black" points="188131.19,-411 188121.68,-406.33 188126.2,-415.91 188131.19,-411"/>
</g>
<!-- dp2_pp2_layer11_expert8 -->
<g id="node983" class="node">
<title>dp2_pp2_layer11_expert8</title>
<polygon fill="lightgreen" stroke="black" points="188451,-406.29 188227,-406.29 188227,-354.29 188451,-354.29 188451,-406.29"/>
<text text-anchor="middle" x="188339" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="188339" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="188339" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="188339" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert8 -->
<g id="edge1605" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188268.61,-452.71C188281.7,-439.43 188295.42,-425.51 188307.23,-413.52"/>
<polygon fill="black" stroke="black" points="188309.79,-415.91 188314.32,-406.33 188304.81,-411 188309.79,-415.91"/>
</g>
<!-- dp2_pp2_layer11_expert9 -->
<g id="node984" class="node">
<title>dp2_pp2_layer11_expert9</title>
<polygon fill="lightgreen" stroke="black" points="188693,-406.29 188469,-406.29 188469,-354.29 188693,-354.29 188693,-406.29"/>
<text text-anchor="middle" x="188581" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="188581" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="188581" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="188581" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert9 -->
<g id="edge1606" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188365.38,-454.21C188410.29,-439.03 188458.08,-422.86 188497.23,-409.62"/>
<polygon fill="black" stroke="black" points="188498.64,-412.84 188506.99,-406.32 188496.4,-406.21 188498.64,-412.84"/>
</g>
<!-- dp2_pp2_layer11_expert10 -->
<g id="node985" class="node">
<title>dp2_pp2_layer11_expert10</title>
<polygon fill="lightgreen" stroke="black" points="188935,-406.29 188711,-406.29 188711,-354.29 188935,-354.29 188935,-406.29"/>
<text text-anchor="middle" x="188823" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="188823" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="188823" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="188823" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert10 -->
<g id="edge1607" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188388.89,-478.04C188481.98,-462.69 188598.88,-441.49 188702,-417.06 188712.09,-414.67 188722.6,-411.94 188733.01,-409.07"/>
<polygon fill="black" stroke="black" points="188734.26,-412.36 188742.95,-406.3 188732.37,-405.62 188734.26,-412.36"/>
</g>
<!-- dp2_pp2_layer11_expert11 -->
<g id="node986" class="node">
<title>dp2_pp2_layer11_expert11</title>
<polygon fill="lightgreen" stroke="black" points="189177,-406.29 188953,-406.29 188953,-354.29 189177,-354.29 189177,-406.29"/>
<text text-anchor="middle" x="189065" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="189065" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="189065" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="189065" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert11 -->
<g id="edge1608" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188400.99,-490.7C188548.62,-477.88 188761.08,-454.78 188944,-417.06 188954.95,-414.8 188966.35,-412.02 188977.57,-409.02"/>
<polygon fill="black" stroke="black" points="188978.66,-412.35 188987.38,-406.33 188976.81,-405.6 188978.66,-412.35"/>
</g>
<!-- dp2_pp2_layer11_expert12 -->
<g id="node987" class="node">
<title>dp2_pp2_layer11_expert12</title>
<polygon fill="lightgreen" stroke="black" points="189419,-406.29 189195,-406.29 189195,-354.29 189419,-354.29 189419,-406.29"/>
<text text-anchor="middle" x="189307" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="189307" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="189307" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="189307" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert12 -->
<g id="edge1609" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188408.27,-498.07C188604.59,-489.29 188918.95,-468.01 189186,-417.06 189197.43,-414.88 189209.33,-412.06 189221.01,-408.97"/>
<polygon fill="black" stroke="black" points="189222.02,-412.32 189230.75,-406.31 189220.18,-405.57 189222.02,-412.32"/>
</g>
<!-- dp2_pp2_layer11_expert13 -->
<g id="node988" class="node">
<title>dp2_pp2_layer11_expert13</title>
<polygon fill="lightgreen" stroke="black" points="189661,-406.29 189437,-406.29 189437,-354.29 189661,-354.29 189661,-406.29"/>
<text text-anchor="middle" x="189549" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="189549" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="189549" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="189549" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert13 -->
<g id="edge1610" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188412.93,-502.93C188653.42,-498.58 189073.9,-481.35 189428,-417.06 189439.62,-414.95 189451.71,-412.14 189463.56,-409.03"/>
<polygon fill="black" stroke="black" points="189464.7,-412.34 189473.44,-406.34 189462.87,-405.59 189464.7,-412.34"/>
</g>
<!-- dp2_pp2_layer11_expert14 -->
<g id="node989" class="node">
<title>dp2_pp2_layer11_expert14</title>
<polygon fill="lightgreen" stroke="black" points="189903,-406.29 189679,-406.29 189679,-354.29 189903,-354.29 189903,-406.29"/>
<text text-anchor="middle" x="189791" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="189791" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="189791" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="189791" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert14 -->
<g id="edge1611" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188408.32,-498.04C188745.17,-486.48 189433.15,-458.6 189670,-417.06 189681.92,-414.97 189694.32,-412.12 189706.46,-408.93"/>
<polygon fill="black" stroke="black" points="189707.38,-412.3 189716.11,-406.3 189705.54,-405.55 189707.38,-412.3"/>
</g>
<!-- dp2_pp2_layer11_expert15 -->
<g id="node990" class="node">
<title>dp2_pp2_layer11_expert15</title>
<polygon fill="lightgreen" stroke="black" points="190145,-406.29 189921,-406.29 189921,-354.29 190145,-354.29 190145,-406.29"/>
<text text-anchor="middle" x="190033" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="190033" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="190033" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="190033" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert15 -->
<g id="edge1612" class="edge">
<title>dp2_pp2_layer11_router&#45;&gt;dp2_pp2_layer11_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M188409.94,-499.9C188790.49,-490.72 189628.35,-465.57 189912,-417.06 189924.01,-415.01 189936.51,-412.16 189948.73,-408.95"/>
<polygon fill="black" stroke="black" points="189949.72,-412.31 189958.45,-406.32 189947.88,-405.56 189949.72,-412.31"/>
</g>
<!-- dp2_pp2_layer11_expert_agg -->
<g id="node991" class="node">
<title>dp2_pp2_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="188465.57,-307.52 188071.74,-307.52 187970.43,-203.52 188364.26,-203.52 188465.57,-307.52"/>
<text text-anchor="middle" x="188218" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="188218" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="188218" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="188218" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer11_expert0&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1613" class="edge">
<title>dp2_pp2_layer11_expert0&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M186461.07,-354.29C186480.69,-346.92 186502.97,-339.72 186524,-335.52 186803.13,-279.86 187626.93,-263.21 188013.43,-258.4"/>
<polygon fill="black" stroke="black" points="188013.65,-261.9 188023.61,-258.27 188013.57,-254.9 188013.65,-261.9"/>
</g>
<!-- dp2_pp2_layer11_expert1&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1614" class="edge">
<title>dp2_pp2_layer11_expert1&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M186703.39,-354.27C186722.95,-346.95 186745.09,-339.78 186766,-335.52 186998.8,-288.16 187674.09,-267.74 188015.43,-260.24"/>
<polygon fill="black" stroke="black" points="188015.51,-263.74 188025.43,-260.03 188015.35,-256.74 188015.51,-263.74"/>
</g>
<!-- dp2_pp2_layer11_expert2&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1615" class="edge">
<title>dp2_pp2_layer11_expert2&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M186945.73,-354.29C186965.21,-347.01 186987.23,-339.87 187008,-335.52 187194.91,-296.44 187724.54,-273.07 188017.3,-262.78"/>
<polygon fill="black" stroke="black" points="188017.74,-266.27 188027.61,-262.42 188017.5,-259.27 188017.74,-266.27"/>
</g>
<!-- dp2_pp2_layer11_expert3&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1616" class="edge">
<title>dp2_pp2_layer11_expert3&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M187188.39,-354.26C187207.72,-347.07 187229.48,-339.99 187250,-335.52 187508.91,-279.18 187814.7,-262.24 188012.26,-257.56"/>
<polygon fill="black" stroke="black" points="188012.55,-261.06 188022.47,-257.33 188012.39,-254.06 188012.55,-261.06"/>
</g>
<!-- dp2_pp2_layer11_expert4&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1617" class="edge">
<title>dp2_pp2_layer11_expert4&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M187431.39,-354.24C187450.49,-347.2 187471.87,-340.19 187492,-335.52 187667.82,-294.77 187872.6,-274.91 188019.75,-265.31"/>
<polygon fill="black" stroke="black" points="188020.05,-268.8 188029.81,-264.67 188019.6,-261.82 188020.05,-268.8"/>
</g>
<!-- dp2_pp2_layer11_expert5&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1618" class="edge">
<title>dp2_pp2_layer11_expert5&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M187675.42,-354.22C187694.04,-347.42 187714.65,-340.55 187734,-335.52 187831.09,-310.27 187941.34,-291.53 188032.07,-278.65"/>
<polygon fill="black" stroke="black" points="188032.78,-282.09 188042.19,-277.23 188031.8,-275.16 188032.78,-282.09"/>
</g>
<!-- dp2_pp2_layer11_expert6&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1619" class="edge">
<title>dp2_pp2_layer11_expert6&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M187923.02,-354.26C187940.26,-348.03 187958.78,-341.44 187976,-335.52 188002.73,-326.33 188031.21,-316.8 188058.89,-307.67"/>
<polygon fill="black" stroke="black" points="188060.24,-310.91 188068.65,-304.46 188058.06,-304.26 188060.24,-310.91"/>
</g>
<!-- dp2_pp2_layer11_expert7&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1620" class="edge">
<title>dp2_pp2_layer11_expert7&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M188121.78,-354.15C188133.02,-342.74 188146.83,-328.73 188160.45,-314.92"/>
<polygon fill="black" stroke="black" points="188163,-317.31 188167.53,-307.73 188158.02,-312.39 188163,-317.31"/>
</g>
<!-- dp2_pp2_layer11_expert8&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1621" class="edge">
<title>dp2_pp2_layer11_expert8&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M188314.22,-354.15C188302.97,-342.74 188289.16,-328.73 188275.55,-314.92"/>
<polygon fill="black" stroke="black" points="188277.98,-312.39 188268.47,-307.73 188272.99,-317.31 188277.98,-312.39"/>
</g>
<!-- dp2_pp2_layer11_expert9&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1622" class="edge">
<title>dp2_pp2_layer11_expert9&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M188512.98,-354.26C188495.73,-348.03 188477.21,-341.44 188460,-335.52 188436.29,-327.37 188411.21,-318.95 188386.53,-310.78"/>
<polygon fill="black" stroke="black" points="188387.32,-307.36 188376.73,-307.54 188385.12,-314 188387.32,-307.36"/>
</g>
<!-- dp2_pp2_layer11_expert10&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1623" class="edge">
<title>dp2_pp2_layer11_expert10&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M188760.58,-354.22C188741.96,-347.42 188721.35,-340.55 188702,-335.52 188621.99,-314.71 188533.05,-298.33 188453.46,-286"/>
<polygon fill="black" stroke="black" points="188453.71,-282.5 188443.3,-284.44 188452.65,-289.41 188453.71,-282.5"/>
</g>
<!-- dp2_pp2_layer11_expert11&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1624" class="edge">
<title>dp2_pp2_layer11_expert11&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M189004.61,-354.24C188985.51,-347.2 188964.13,-340.19 188944,-335.52 188775.74,-296.53 188580.97,-276.66 188435.55,-266.61"/>
<polygon fill="black" stroke="black" points="188435.38,-263.09 188425.16,-265.9 188434.9,-270.07 188435.38,-263.09"/>
</g>
<!-- dp2_pp2_layer11_expert12&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1625" class="edge">
<title>dp2_pp2_layer11_expert12&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M189247.61,-354.26C189228.28,-347.07 189206.52,-339.99 189186,-335.52 188928.51,-279.49 188624.64,-262.43 188426.99,-257.64"/>
<polygon fill="black" stroke="black" points="188426.86,-254.14 188416.78,-257.4 188426.69,-261.13 188426.86,-254.14"/>
</g>
<!-- dp2_pp2_layer11_expert13&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1626" class="edge">
<title>dp2_pp2_layer11_expert13&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M189490.27,-354.29C189470.79,-347.01 189448.77,-339.87 189428,-335.52 189244.02,-297.05 188727.97,-273.81 188432.63,-263.27"/>
<polygon fill="black" stroke="black" points="188432.33,-259.76 188422.21,-262.9 188432.08,-266.76 188432.33,-259.76"/>
</g>
<!-- dp2_pp2_layer11_expert14&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1627" class="edge">
<title>dp2_pp2_layer11_expert14&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M189732.6,-354.27C189713.05,-346.95 189690.9,-339.78 189670,-335.52 189439.27,-288.58 188773.86,-268.1 188429.74,-260.45"/>
<polygon fill="black" stroke="black" points="188429.73,-256.94 188419.65,-260.22 188429.57,-263.94 188429.73,-256.94"/>
</g>
<!-- dp2_pp2_layer11_expert15&#45;&gt;dp2_pp2_layer11_expert_agg -->
<g id="edge1628" class="edge">
<title>dp2_pp2_layer11_expert15&#45;&gt;dp2_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M189974.93,-354.29C189955.3,-346.92 189933.03,-339.72 189912,-335.52 189634.21,-280.12 188816.98,-263.37 188428.17,-258.47"/>
<polygon fill="black" stroke="black" points="188427.97,-254.97 188417.93,-258.34 188427.88,-261.97 188427.97,-254.97"/>
</g>
<!-- dp2_pp2_layer12_attn_tp0 -->
<g id="node992" class="node">
<title>dp2_pp2_layer12_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="185700.5,-531.06 185435.5,-531.06 185435.5,-479.06 185700.5,-479.06 185700.5,-531.06"/>
<text text-anchor="middle" x="185568" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="185568" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="185568" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="185568" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer11_expert_agg&#45;&gt;dp2_pp2_layer12_attn_tp0 -->
<g id="edge1630" class="edge">
<title>dp2_pp2_layer11_expert_agg&#45;&gt;dp2_pp2_layer12_attn_tp0</title>
<path fill="none" stroke="black" d="M188025.78,-260.41C187605.38,-269.54 186615.17,-294.77 186282,-335.52 186249.8,-339.46 185741.23,-444.29 185710,-453.06 185687.37,-459.41 185663.16,-467.58 185641.26,-475.5"/>
<polygon fill="black" stroke="black" points="185639.89,-472.28 185631.7,-479 185642.29,-478.85 185639.89,-472.28"/>
</g>
<!-- dp2_pp2_layer12_attn_allreduce -->
<g id="node993" class="node">
<title>dp2_pp2_layer12_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="185697" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="185697" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="185697" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="185697" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="185697" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_attn_tp0&#45;&gt;dp2_pp2_layer12_attn_allreduce -->
<g id="edge1631" class="edge">
<title>dp2_pp2_layer12_attn_tp0&#45;&gt;dp2_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M185594.41,-478.92C185611.15,-463 185633.21,-442 185652.58,-423.56"/>
<polygon fill="black" stroke="black" points="185655.03,-426.07 185659.86,-416.64 185650.2,-421 185655.03,-426.07"/>
</g>
<!-- dp2_pp2_layer12_router -->
<g id="node997" class="node">
<title>dp2_pp2_layer12_router</title>
<polygon fill="lightyellow" stroke="black" points="183448.57,-557.06 183054.74,-557.06 182953.43,-453.06 183347.26,-453.06 183448.57,-557.06"/>
<text text-anchor="middle" x="183201" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="183201" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="183201" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="183201" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_attn_allreduce&#45;&gt;dp2_pp2_layer12_router -->
<g id="edge1667" class="edge">
<title>dp2_pp2_layer12_attn_allreduce&#45;&gt;dp2_pp2_layer12_router</title>
<path fill="none" stroke="black" d="M185537.08,-392.38C185425.77,-399.9 185273.89,-409.76 185140,-417.06 184504.5,-451.72 183751.28,-482.59 183399.96,-496.4"/>
<polygon fill="black" stroke="black" points="183399.8,-492.91 183389.94,-496.79 183400.07,-499.9 183399.8,-492.91"/>
</g>
<!-- dp2_pp2_layer12_attn_tp1 -->
<g id="node994" class="node">
<title>dp2_pp2_layer12_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="185983.5,-531.06 185718.5,-531.06 185718.5,-479.06 185983.5,-479.06 185983.5,-531.06"/>
<text text-anchor="middle" x="185851" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="185851" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="185851" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="185851" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer12_attn_tp1&#45;&gt;dp2_pp2_layer12_attn_allreduce -->
<g id="edge1632" class="edge">
<title>dp2_pp2_layer12_attn_tp1&#45;&gt;dp2_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M185819.46,-478.92C185798.99,-462.6 185771.83,-440.94 185748.29,-422.18"/>
<polygon fill="black" stroke="black" points="185750.46,-419.44 185740.46,-415.94 185746.1,-424.91 185750.46,-419.44"/>
</g>
<!-- dp2_pp2_layer12_attn_tp2 -->
<g id="node995" class="node">
<title>dp2_pp2_layer12_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="185417.5,-531.06 185152.5,-531.06 185152.5,-479.06 185417.5,-479.06 185417.5,-531.06"/>
<text text-anchor="middle" x="185285" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="185285" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="185285" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="185285" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer12_attn_tp2&#45;&gt;dp2_pp2_layer12_attn_allreduce -->
<g id="edge1633" class="edge">
<title>dp2_pp2_layer12_attn_tp2&#45;&gt;dp2_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M185351.07,-479.02C185374.85,-470.35 185401.99,-460.86 185427,-453.06 185475.74,-437.86 185530.05,-423.03 185577.1,-410.83"/>
<polygon fill="black" stroke="black" points="185578.22,-414.15 185587.03,-408.26 185576.47,-407.38 185578.22,-414.15"/>
</g>
<!-- dp2_pp2_layer12_attn_tp3 -->
<g id="node996" class="node">
<title>dp2_pp2_layer12_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="186266.5,-531.06 186001.5,-531.06 186001.5,-479.06 186266.5,-479.06 186266.5,-531.06"/>
<text text-anchor="middle" x="186134" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="186134" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="186134" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="186134" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer12_attn_tp3&#45;&gt;dp2_pp2_layer12_attn_allreduce -->
<g id="edge1634" class="edge">
<title>dp2_pp2_layer12_attn_tp3&#45;&gt;dp2_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M186069.21,-478.95C186045.43,-470.18 186018.17,-460.64 185993,-453.06 185938.42,-436.63 185877.31,-421.31 185824.86,-409.08"/>
<polygon fill="black" stroke="black" points="185825.37,-405.6 185814.83,-406.75 185823.78,-412.42 185825.37,-405.6"/>
</g>
<!-- dp2_pp2_layer12_expert0 -->
<g id="node998" class="node">
<title>dp2_pp2_layer12_expert0</title>
<polygon fill="lightgreen" stroke="black" points="181498,-406.29 181274,-406.29 181274,-354.29 181498,-354.29 181498,-406.29"/>
<text text-anchor="middle" x="181386" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="181386" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="181386" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="181386" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert0 -->
<g id="edge1635" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182998.73,-499.65C182613.55,-490.26 181788.11,-465.13 181507,-417.06 181494.99,-415.01 181482.48,-412.16 181470.27,-408.95"/>
<polygon fill="black" stroke="black" points="181471.11,-405.56 181460.54,-406.32 181469.28,-412.31 181471.11,-405.56"/>
</g>
<!-- dp2_pp2_layer12_expert1 -->
<g id="node999" class="node">
<title>dp2_pp2_layer12_expert1</title>
<polygon fill="lightgreen" stroke="black" points="181740,-406.29 181516,-406.29 181516,-354.29 181740,-354.29 181740,-406.29"/>
<text text-anchor="middle" x="181628" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="181628" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="181628" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="181628" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert1 -->
<g id="edge1636" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182996.55,-497.55C182654.94,-485.71 181982.58,-458.03 181749,-417.06 181737.08,-414.97 181724.67,-412.12 181712.54,-408.93"/>
<polygon fill="black" stroke="black" points="181713.45,-405.55 181702.89,-406.3 181711.62,-412.3 181713.45,-405.55"/>
</g>
<!-- dp2_pp2_layer12_expert2 -->
<g id="node1000" class="node">
<title>dp2_pp2_layer12_expert2</title>
<polygon fill="lightgreen" stroke="black" points="181982,-406.29 181758,-406.29 181758,-354.29 181982,-354.29 181982,-406.29"/>
<text text-anchor="middle" x="181870" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="181870" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="181870" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="181870" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert2 -->
<g id="edge1637" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183001.82,-502.85C182760.66,-498.37 182343.02,-480.97 181991,-417.06 181979.38,-414.95 181967.29,-412.14 181955.44,-409.03"/>
<polygon fill="black" stroke="black" points="181956.13,-405.59 181945.56,-406.34 181954.29,-412.34 181956.13,-405.59"/>
</g>
<!-- dp2_pp2_layer12_expert3 -->
<g id="node1001" class="node">
<title>dp2_pp2_layer12_expert3</title>
<polygon fill="lightgreen" stroke="black" points="182224,-406.29 182000,-406.29 182000,-354.29 182224,-354.29 182224,-406.29"/>
<text text-anchor="middle" x="182112" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="182112" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="182112" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="182112" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert3 -->
<g id="edge1638" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182996.36,-497.41C182799.31,-488.25 182493.63,-466.79 182233,-417.06 182221.57,-414.88 182209.67,-412.06 182197.99,-408.97"/>
<polygon fill="black" stroke="black" points="182198.82,-405.57 182188.25,-406.31 182196.98,-412.32 182198.82,-405.57"/>
</g>
<!-- dp2_pp2_layer12_expert4 -->
<g id="node1002" class="node">
<title>dp2_pp2_layer12_expert4</title>
<polygon fill="lightgreen" stroke="black" points="182466,-406.29 182242,-406.29 182242,-354.29 182466,-354.29 182466,-406.29"/>
<text text-anchor="middle" x="182354" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="182354" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="182354" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="182354" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert4 -->
<g id="edge1639" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182987.43,-487.98C182841.99,-474.71 182645.64,-452.25 182475,-417.06 182464.05,-414.8 182452.65,-412.02 182441.43,-409.02"/>
<polygon fill="black" stroke="black" points="182442.19,-405.6 182431.62,-406.33 182440.34,-412.35 182442.19,-405.6"/>
</g>
<!-- dp2_pp2_layer12_expert5 -->
<g id="node1003" class="node">
<title>dp2_pp2_layer12_expert5</title>
<polygon fill="lightgreen" stroke="black" points="182708,-406.29 182484,-406.29 182484,-354.29 182708,-354.29 182708,-406.29"/>
<text text-anchor="middle" x="182596" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="182596" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="182596" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="182596" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert5 -->
<g id="edge1640" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M182967.29,-467.38C182887.5,-453.44 182798,-436.25 182717,-417.06 182706.9,-414.67 182696.4,-411.94 182685.99,-409.07"/>
<polygon fill="black" stroke="black" points="182686.62,-405.62 182676.05,-406.3 182684.74,-412.36 182686.62,-405.62"/>
</g>
<!-- dp2_pp2_layer12_expert6 -->
<g id="node1004" class="node">
<title>dp2_pp2_layer12_expert6</title>
<polygon fill="lightgreen" stroke="black" points="182950,-406.29 182726,-406.29 182726,-354.29 182950,-354.29 182950,-406.29"/>
<text text-anchor="middle" x="182838" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="182838" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="182838" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="182838" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert6 -->
<g id="edge1641" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183049.94,-452.97C183006.16,-438.16 182959.94,-422.53 182921.87,-409.66"/>
<polygon fill="black" stroke="black" points="182922.97,-406.33 182912.38,-406.45 182920.73,-412.97 182922.97,-406.33"/>
</g>
<!-- dp2_pp2_layer12_expert7 -->
<g id="node1005" class="node">
<title>dp2_pp2_layer12_expert7</title>
<polygon fill="lightgreen" stroke="black" points="183192,-406.29 182968,-406.29 182968,-354.29 183192,-354.29 183192,-406.29"/>
<text text-anchor="middle" x="183080" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="183080" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="183080" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="183080" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert7 -->
<g id="edge1642" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183150.38,-452.71C183137.3,-439.43 183123.58,-425.51 183111.76,-413.52"/>
<polygon fill="black" stroke="black" points="183114.19,-411 183104.68,-406.33 183109.2,-415.91 183114.19,-411"/>
</g>
<!-- dp2_pp2_layer12_expert8 -->
<g id="node1006" class="node">
<title>dp2_pp2_layer12_expert8</title>
<polygon fill="lightgreen" stroke="black" points="183434,-406.29 183210,-406.29 183210,-354.29 183434,-354.29 183434,-406.29"/>
<text text-anchor="middle" x="183322" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="183322" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="183322" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="183322" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert8 -->
<g id="edge1643" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183251.61,-452.71C183264.7,-439.43 183278.42,-425.51 183290.23,-413.52"/>
<polygon fill="black" stroke="black" points="183292.79,-415.91 183297.32,-406.33 183287.81,-411 183292.79,-415.91"/>
</g>
<!-- dp2_pp2_layer12_expert9 -->
<g id="node1007" class="node">
<title>dp2_pp2_layer12_expert9</title>
<polygon fill="lightgreen" stroke="black" points="183676,-406.29 183452,-406.29 183452,-354.29 183676,-354.29 183676,-406.29"/>
<text text-anchor="middle" x="183564" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="183564" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="183564" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="183564" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert9 -->
<g id="edge1644" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183348.38,-454.21C183393.29,-439.03 183441.08,-422.86 183480.23,-409.62"/>
<polygon fill="black" stroke="black" points="183481.64,-412.84 183489.99,-406.32 183479.4,-406.21 183481.64,-412.84"/>
</g>
<!-- dp2_pp2_layer12_expert10 -->
<g id="node1008" class="node">
<title>dp2_pp2_layer12_expert10</title>
<polygon fill="lightgreen" stroke="black" points="183918,-406.29 183694,-406.29 183694,-354.29 183918,-354.29 183918,-406.29"/>
<text text-anchor="middle" x="183806" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="183806" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="183806" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="183806" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert10 -->
<g id="edge1645" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183371.89,-478.04C183464.98,-462.69 183581.88,-441.49 183685,-417.06 183695.09,-414.67 183705.6,-411.94 183716.01,-409.07"/>
<polygon fill="black" stroke="black" points="183717.26,-412.36 183725.95,-406.3 183715.37,-405.62 183717.26,-412.36"/>
</g>
<!-- dp2_pp2_layer12_expert11 -->
<g id="node1009" class="node">
<title>dp2_pp2_layer12_expert11</title>
<polygon fill="lightgreen" stroke="black" points="184160,-406.29 183936,-406.29 183936,-354.29 184160,-354.29 184160,-406.29"/>
<text text-anchor="middle" x="184048" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="184048" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="184048" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="184048" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert11 -->
<g id="edge1646" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183383.99,-490.7C183531.62,-477.88 183744.08,-454.78 183927,-417.06 183937.95,-414.8 183949.35,-412.02 183960.57,-409.02"/>
<polygon fill="black" stroke="black" points="183961.66,-412.35 183970.38,-406.33 183959.81,-405.6 183961.66,-412.35"/>
</g>
<!-- dp2_pp2_layer12_expert12 -->
<g id="node1010" class="node">
<title>dp2_pp2_layer12_expert12</title>
<polygon fill="lightgreen" stroke="black" points="184402,-406.29 184178,-406.29 184178,-354.29 184402,-354.29 184402,-406.29"/>
<text text-anchor="middle" x="184290" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="184290" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="184290" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="184290" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert12 -->
<g id="edge1647" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183391.27,-498.07C183587.59,-489.29 183901.95,-468.01 184169,-417.06 184180.43,-414.88 184192.33,-412.06 184204.01,-408.97"/>
<polygon fill="black" stroke="black" points="184205.02,-412.32 184213.75,-406.31 184203.18,-405.57 184205.02,-412.32"/>
</g>
<!-- dp2_pp2_layer12_expert13 -->
<g id="node1011" class="node">
<title>dp2_pp2_layer12_expert13</title>
<polygon fill="lightgreen" stroke="black" points="184644,-406.29 184420,-406.29 184420,-354.29 184644,-354.29 184644,-406.29"/>
<text text-anchor="middle" x="184532" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="184532" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="184532" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="184532" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert13 -->
<g id="edge1648" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183395.93,-502.93C183636.42,-498.58 184056.9,-481.35 184411,-417.06 184422.62,-414.95 184434.71,-412.14 184446.56,-409.03"/>
<polygon fill="black" stroke="black" points="184447.7,-412.34 184456.44,-406.34 184445.87,-405.59 184447.7,-412.34"/>
</g>
<!-- dp2_pp2_layer12_expert14 -->
<g id="node1012" class="node">
<title>dp2_pp2_layer12_expert14</title>
<polygon fill="lightgreen" stroke="black" points="184886,-406.29 184662,-406.29 184662,-354.29 184886,-354.29 184886,-406.29"/>
<text text-anchor="middle" x="184774" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="184774" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="184774" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="184774" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert14 -->
<g id="edge1649" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183391.32,-498.04C183728.17,-486.48 184416.15,-458.6 184653,-417.06 184664.92,-414.97 184677.32,-412.12 184689.46,-408.93"/>
<polygon fill="black" stroke="black" points="184690.38,-412.3 184699.11,-406.3 184688.54,-405.55 184690.38,-412.3"/>
</g>
<!-- dp2_pp2_layer12_expert15 -->
<g id="node1013" class="node">
<title>dp2_pp2_layer12_expert15</title>
<polygon fill="lightgreen" stroke="black" points="185128,-406.29 184904,-406.29 184904,-354.29 185128,-354.29 185128,-406.29"/>
<text text-anchor="middle" x="185016" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="185016" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="185016" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="185016" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert15 -->
<g id="edge1650" class="edge">
<title>dp2_pp2_layer12_router&#45;&gt;dp2_pp2_layer12_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M183392.94,-499.9C183773.49,-490.72 184611.35,-465.57 184895,-417.06 184907.01,-415.01 184919.51,-412.16 184931.73,-408.95"/>
<polygon fill="black" stroke="black" points="184932.72,-412.31 184941.45,-406.32 184930.88,-405.56 184932.72,-412.31"/>
</g>
<!-- dp2_pp2_layer12_expert_agg -->
<g id="node1014" class="node">
<title>dp2_pp2_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="183448.57,-307.52 183054.74,-307.52 182953.43,-203.52 183347.26,-203.52 183448.57,-307.52"/>
<text text-anchor="middle" x="183201" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="183201" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="183201" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="183201" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer12_expert0&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1651" class="edge">
<title>dp2_pp2_layer12_expert0&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M181444.07,-354.29C181463.69,-346.92 181485.97,-339.72 181507,-335.52 181786.13,-279.86 182609.93,-263.21 182996.43,-258.4"/>
<polygon fill="black" stroke="black" points="182996.65,-261.9 183006.61,-258.27 182996.57,-254.9 182996.65,-261.9"/>
</g>
<!-- dp2_pp2_layer12_expert1&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1652" class="edge">
<title>dp2_pp2_layer12_expert1&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M181686.39,-354.27C181705.95,-346.95 181728.09,-339.78 181749,-335.52 181981.8,-288.16 182657.09,-267.74 182998.43,-260.24"/>
<polygon fill="black" stroke="black" points="182998.51,-263.74 183008.43,-260.03 182998.35,-256.74 182998.51,-263.74"/>
</g>
<!-- dp2_pp2_layer12_expert2&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1653" class="edge">
<title>dp2_pp2_layer12_expert2&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M181928.73,-354.29C181948.21,-347.01 181970.23,-339.87 181991,-335.52 182177.91,-296.44 182707.54,-273.07 183000.3,-262.78"/>
<polygon fill="black" stroke="black" points="183000.74,-266.27 183010.61,-262.42 183000.5,-259.27 183000.74,-266.27"/>
</g>
<!-- dp2_pp2_layer12_expert3&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1654" class="edge">
<title>dp2_pp2_layer12_expert3&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M182171.39,-354.26C182190.72,-347.07 182212.48,-339.99 182233,-335.52 182491.91,-279.18 182797.7,-262.24 182995.26,-257.56"/>
<polygon fill="black" stroke="black" points="182995.55,-261.06 183005.47,-257.33 182995.39,-254.06 182995.55,-261.06"/>
</g>
<!-- dp2_pp2_layer12_expert4&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1655" class="edge">
<title>dp2_pp2_layer12_expert4&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M182414.39,-354.24C182433.49,-347.2 182454.87,-340.19 182475,-335.52 182650.82,-294.77 182855.6,-274.91 183002.75,-265.31"/>
<polygon fill="black" stroke="black" points="183003.05,-268.8 183012.81,-264.67 183002.6,-261.82 183003.05,-268.8"/>
</g>
<!-- dp2_pp2_layer12_expert5&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1656" class="edge">
<title>dp2_pp2_layer12_expert5&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M182658.42,-354.22C182677.04,-347.42 182697.65,-340.55 182717,-335.52 182814.09,-310.27 182924.34,-291.53 183015.07,-278.65"/>
<polygon fill="black" stroke="black" points="183015.78,-282.09 183025.19,-277.23 183014.8,-275.16 183015.78,-282.09"/>
</g>
<!-- dp2_pp2_layer12_expert6&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1657" class="edge">
<title>dp2_pp2_layer12_expert6&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M182906.02,-354.26C182923.26,-348.03 182941.78,-341.44 182959,-335.52 182985.73,-326.33 183014.21,-316.8 183041.89,-307.67"/>
<polygon fill="black" stroke="black" points="183043.24,-310.91 183051.65,-304.46 183041.06,-304.26 183043.24,-310.91"/>
</g>
<!-- dp2_pp2_layer12_expert7&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1658" class="edge">
<title>dp2_pp2_layer12_expert7&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M183104.78,-354.15C183116.02,-342.74 183129.83,-328.73 183143.45,-314.92"/>
<polygon fill="black" stroke="black" points="183146,-317.31 183150.53,-307.73 183141.02,-312.39 183146,-317.31"/>
</g>
<!-- dp2_pp2_layer12_expert8&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1659" class="edge">
<title>dp2_pp2_layer12_expert8&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M183297.22,-354.15C183285.97,-342.74 183272.16,-328.73 183258.55,-314.92"/>
<polygon fill="black" stroke="black" points="183260.98,-312.39 183251.47,-307.73 183255.99,-317.31 183260.98,-312.39"/>
</g>
<!-- dp2_pp2_layer12_expert9&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1660" class="edge">
<title>dp2_pp2_layer12_expert9&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M183495.98,-354.26C183478.73,-348.03 183460.21,-341.44 183443,-335.52 183419.29,-327.37 183394.21,-318.95 183369.53,-310.78"/>
<polygon fill="black" stroke="black" points="183370.32,-307.36 183359.73,-307.54 183368.12,-314 183370.32,-307.36"/>
</g>
<!-- dp2_pp2_layer12_expert10&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1661" class="edge">
<title>dp2_pp2_layer12_expert10&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M183743.58,-354.22C183724.96,-347.42 183704.35,-340.55 183685,-335.52 183604.99,-314.71 183516.05,-298.33 183436.46,-286"/>
<polygon fill="black" stroke="black" points="183436.71,-282.5 183426.3,-284.44 183435.65,-289.41 183436.71,-282.5"/>
</g>
<!-- dp2_pp2_layer12_expert11&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1662" class="edge">
<title>dp2_pp2_layer12_expert11&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M183987.61,-354.24C183968.51,-347.2 183947.13,-340.19 183927,-335.52 183758.74,-296.53 183563.97,-276.66 183418.55,-266.61"/>
<polygon fill="black" stroke="black" points="183418.38,-263.09 183408.16,-265.9 183417.9,-270.07 183418.38,-263.09"/>
</g>
<!-- dp2_pp2_layer12_expert12&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1663" class="edge">
<title>dp2_pp2_layer12_expert12&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M184230.61,-354.26C184211.28,-347.07 184189.52,-339.99 184169,-335.52 183911.51,-279.49 183607.64,-262.43 183409.99,-257.64"/>
<polygon fill="black" stroke="black" points="183409.86,-254.14 183399.78,-257.4 183409.69,-261.13 183409.86,-254.14"/>
</g>
<!-- dp2_pp2_layer12_expert13&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1664" class="edge">
<title>dp2_pp2_layer12_expert13&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M184473.27,-354.29C184453.79,-347.01 184431.77,-339.87 184411,-335.52 184227.02,-297.05 183710.97,-273.81 183415.63,-263.27"/>
<polygon fill="black" stroke="black" points="183415.33,-259.76 183405.21,-262.9 183415.08,-266.76 183415.33,-259.76"/>
</g>
<!-- dp2_pp2_layer12_expert14&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1665" class="edge">
<title>dp2_pp2_layer12_expert14&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M184715.6,-354.27C184696.05,-346.95 184673.9,-339.78 184653,-335.52 184422.27,-288.58 183756.86,-268.1 183412.74,-260.45"/>
<polygon fill="black" stroke="black" points="183412.73,-256.94 183402.65,-260.22 183412.57,-263.94 183412.73,-256.94"/>
</g>
<!-- dp2_pp2_layer12_expert15&#45;&gt;dp2_pp2_layer12_expert_agg -->
<g id="edge1666" class="edge">
<title>dp2_pp2_layer12_expert15&#45;&gt;dp2_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M184957.93,-354.29C184938.3,-346.92 184916.03,-339.72 184895,-335.52 184617.21,-280.12 183799.98,-263.37 183411.17,-258.47"/>
<polygon fill="black" stroke="black" points="183410.97,-254.97 183400.93,-258.34 183410.88,-261.97 183410.97,-254.97"/>
</g>
<!-- dp2_pp2_layer13_attn_tp0 -->
<g id="node1015" class="node">
<title>dp2_pp2_layer13_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="180683.5,-531.06 180418.5,-531.06 180418.5,-479.06 180683.5,-479.06 180683.5,-531.06"/>
<text text-anchor="middle" x="180551" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="180551" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="180551" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="180551" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer12_expert_agg&#45;&gt;dp2_pp2_layer13_attn_tp0 -->
<g id="edge1668" class="edge">
<title>dp2_pp2_layer12_expert_agg&#45;&gt;dp2_pp2_layer13_attn_tp0</title>
<path fill="none" stroke="black" d="M183008.78,-260.41C182588.38,-269.54 181598.17,-294.77 181265,-335.52 181232.8,-339.46 180724.23,-444.29 180693,-453.06 180670.37,-459.41 180646.16,-467.58 180624.26,-475.5"/>
<polygon fill="black" stroke="black" points="180622.89,-472.28 180614.7,-479 180625.29,-478.85 180622.89,-472.28"/>
</g>
<!-- dp2_pp2_layer13_attn_allreduce -->
<g id="node1016" class="node">
<title>dp2_pp2_layer13_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="180680" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="180680" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="180680" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="180680" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="180680" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_attn_tp0&#45;&gt;dp2_pp2_layer13_attn_allreduce -->
<g id="edge1669" class="edge">
<title>dp2_pp2_layer13_attn_tp0&#45;&gt;dp2_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M180577.41,-478.92C180594.15,-463 180616.21,-442 180635.58,-423.56"/>
<polygon fill="black" stroke="black" points="180638.03,-426.07 180642.86,-416.64 180633.2,-421 180638.03,-426.07"/>
</g>
<!-- dp2_pp2_layer13_router -->
<g id="node1020" class="node">
<title>dp2_pp2_layer13_router</title>
<polygon fill="lightyellow" stroke="black" points="178431.57,-557.06 178037.74,-557.06 177936.43,-453.06 178330.26,-453.06 178431.57,-557.06"/>
<text text-anchor="middle" x="178184" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="178184" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="178184" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="178184" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_attn_allreduce&#45;&gt;dp2_pp2_layer13_router -->
<g id="edge1705" class="edge">
<title>dp2_pp2_layer13_attn_allreduce&#45;&gt;dp2_pp2_layer13_router</title>
<path fill="none" stroke="black" d="M180520.08,-392.38C180408.77,-399.9 180256.89,-409.76 180123,-417.06 179487.5,-451.72 178734.28,-482.59 178382.96,-496.4"/>
<polygon fill="black" stroke="black" points="178382.8,-492.91 178372.94,-496.79 178383.07,-499.9 178382.8,-492.91"/>
</g>
<!-- dp2_pp2_layer13_attn_tp1 -->
<g id="node1017" class="node">
<title>dp2_pp2_layer13_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="180966.5,-531.06 180701.5,-531.06 180701.5,-479.06 180966.5,-479.06 180966.5,-531.06"/>
<text text-anchor="middle" x="180834" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="180834" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="180834" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="180834" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer13_attn_tp1&#45;&gt;dp2_pp2_layer13_attn_allreduce -->
<g id="edge1670" class="edge">
<title>dp2_pp2_layer13_attn_tp1&#45;&gt;dp2_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M180802.46,-478.92C180781.99,-462.6 180754.83,-440.94 180731.29,-422.18"/>
<polygon fill="black" stroke="black" points="180733.46,-419.44 180723.46,-415.94 180729.1,-424.91 180733.46,-419.44"/>
</g>
<!-- dp2_pp2_layer13_attn_tp2 -->
<g id="node1018" class="node">
<title>dp2_pp2_layer13_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="180400.5,-531.06 180135.5,-531.06 180135.5,-479.06 180400.5,-479.06 180400.5,-531.06"/>
<text text-anchor="middle" x="180268" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="180268" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="180268" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="180268" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer13_attn_tp2&#45;&gt;dp2_pp2_layer13_attn_allreduce -->
<g id="edge1671" class="edge">
<title>dp2_pp2_layer13_attn_tp2&#45;&gt;dp2_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M180334.07,-479.02C180357.85,-470.35 180384.99,-460.86 180410,-453.06 180458.74,-437.86 180513.05,-423.03 180560.1,-410.83"/>
<polygon fill="black" stroke="black" points="180561.22,-414.15 180570.03,-408.26 180559.47,-407.38 180561.22,-414.15"/>
</g>
<!-- dp2_pp2_layer13_attn_tp3 -->
<g id="node1019" class="node">
<title>dp2_pp2_layer13_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="181249.5,-531.06 180984.5,-531.06 180984.5,-479.06 181249.5,-479.06 181249.5,-531.06"/>
<text text-anchor="middle" x="181117" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="181117" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="181117" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="181117" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer13_attn_tp3&#45;&gt;dp2_pp2_layer13_attn_allreduce -->
<g id="edge1672" class="edge">
<title>dp2_pp2_layer13_attn_tp3&#45;&gt;dp2_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M181052.21,-478.95C181028.43,-470.18 181001.17,-460.64 180976,-453.06 180921.42,-436.63 180860.31,-421.31 180807.86,-409.08"/>
<polygon fill="black" stroke="black" points="180808.37,-405.6 180797.83,-406.75 180806.78,-412.42 180808.37,-405.6"/>
</g>
<!-- dp2_pp2_layer13_expert0 -->
<g id="node1021" class="node">
<title>dp2_pp2_layer13_expert0</title>
<polygon fill="lightgreen" stroke="black" points="176481,-406.29 176257,-406.29 176257,-354.29 176481,-354.29 176481,-406.29"/>
<text text-anchor="middle" x="176369" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="176369" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="176369" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="176369" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert0 -->
<g id="edge1673" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177981.73,-499.65C177596.55,-490.26 176771.11,-465.13 176490,-417.06 176477.99,-415.01 176465.48,-412.16 176453.27,-408.95"/>
<polygon fill="black" stroke="black" points="176454.11,-405.56 176443.54,-406.32 176452.28,-412.31 176454.11,-405.56"/>
</g>
<!-- dp2_pp2_layer13_expert1 -->
<g id="node1022" class="node">
<title>dp2_pp2_layer13_expert1</title>
<polygon fill="lightgreen" stroke="black" points="176723,-406.29 176499,-406.29 176499,-354.29 176723,-354.29 176723,-406.29"/>
<text text-anchor="middle" x="176611" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="176611" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="176611" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="176611" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert1 -->
<g id="edge1674" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177979.55,-497.55C177637.94,-485.71 176965.58,-458.03 176732,-417.06 176720.08,-414.97 176707.67,-412.12 176695.54,-408.93"/>
<polygon fill="black" stroke="black" points="176696.45,-405.55 176685.89,-406.3 176694.62,-412.3 176696.45,-405.55"/>
</g>
<!-- dp2_pp2_layer13_expert2 -->
<g id="node1023" class="node">
<title>dp2_pp2_layer13_expert2</title>
<polygon fill="lightgreen" stroke="black" points="176965,-406.29 176741,-406.29 176741,-354.29 176965,-354.29 176965,-406.29"/>
<text text-anchor="middle" x="176853" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="176853" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="176853" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="176853" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert2 -->
<g id="edge1675" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177984.82,-502.85C177743.66,-498.37 177326.02,-480.97 176974,-417.06 176962.38,-414.95 176950.29,-412.14 176938.44,-409.03"/>
<polygon fill="black" stroke="black" points="176939.13,-405.59 176928.56,-406.34 176937.29,-412.34 176939.13,-405.59"/>
</g>
<!-- dp2_pp2_layer13_expert3 -->
<g id="node1024" class="node">
<title>dp2_pp2_layer13_expert3</title>
<polygon fill="lightgreen" stroke="black" points="177207,-406.29 176983,-406.29 176983,-354.29 177207,-354.29 177207,-406.29"/>
<text text-anchor="middle" x="177095" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="177095" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="177095" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="177095" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert3 -->
<g id="edge1676" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177979.36,-497.41C177782.31,-488.25 177476.63,-466.79 177216,-417.06 177204.57,-414.88 177192.67,-412.06 177180.99,-408.97"/>
<polygon fill="black" stroke="black" points="177181.82,-405.57 177171.25,-406.31 177179.98,-412.32 177181.82,-405.57"/>
</g>
<!-- dp2_pp2_layer13_expert4 -->
<g id="node1025" class="node">
<title>dp2_pp2_layer13_expert4</title>
<polygon fill="lightgreen" stroke="black" points="177449,-406.29 177225,-406.29 177225,-354.29 177449,-354.29 177449,-406.29"/>
<text text-anchor="middle" x="177337" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="177337" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="177337" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="177337" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert4 -->
<g id="edge1677" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177970.43,-487.98C177824.99,-474.71 177628.64,-452.25 177458,-417.06 177447.05,-414.8 177435.65,-412.02 177424.43,-409.02"/>
<polygon fill="black" stroke="black" points="177425.19,-405.6 177414.62,-406.33 177423.34,-412.35 177425.19,-405.6"/>
</g>
<!-- dp2_pp2_layer13_expert5 -->
<g id="node1026" class="node">
<title>dp2_pp2_layer13_expert5</title>
<polygon fill="lightgreen" stroke="black" points="177691,-406.29 177467,-406.29 177467,-354.29 177691,-354.29 177691,-406.29"/>
<text text-anchor="middle" x="177579" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="177579" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="177579" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="177579" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert5 -->
<g id="edge1678" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177950.29,-467.38C177870.5,-453.44 177781,-436.25 177700,-417.06 177689.9,-414.67 177679.4,-411.94 177668.99,-409.07"/>
<polygon fill="black" stroke="black" points="177669.62,-405.62 177659.05,-406.3 177667.74,-412.36 177669.62,-405.62"/>
</g>
<!-- dp2_pp2_layer13_expert6 -->
<g id="node1027" class="node">
<title>dp2_pp2_layer13_expert6</title>
<polygon fill="lightgreen" stroke="black" points="177933,-406.29 177709,-406.29 177709,-354.29 177933,-354.29 177933,-406.29"/>
<text text-anchor="middle" x="177821" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="177821" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="177821" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="177821" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert6 -->
<g id="edge1679" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178032.94,-452.97C177989.16,-438.16 177942.94,-422.53 177904.87,-409.66"/>
<polygon fill="black" stroke="black" points="177905.97,-406.33 177895.38,-406.45 177903.73,-412.97 177905.97,-406.33"/>
</g>
<!-- dp2_pp2_layer13_expert7 -->
<g id="node1028" class="node">
<title>dp2_pp2_layer13_expert7</title>
<polygon fill="lightgreen" stroke="black" points="178175,-406.29 177951,-406.29 177951,-354.29 178175,-354.29 178175,-406.29"/>
<text text-anchor="middle" x="178063" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="178063" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="178063" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="178063" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert7 -->
<g id="edge1680" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178133.38,-452.71C178120.3,-439.43 178106.58,-425.51 178094.76,-413.52"/>
<polygon fill="black" stroke="black" points="178097.19,-411 178087.68,-406.33 178092.2,-415.91 178097.19,-411"/>
</g>
<!-- dp2_pp2_layer13_expert8 -->
<g id="node1029" class="node">
<title>dp2_pp2_layer13_expert8</title>
<polygon fill="lightgreen" stroke="black" points="178417,-406.29 178193,-406.29 178193,-354.29 178417,-354.29 178417,-406.29"/>
<text text-anchor="middle" x="178305" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="178305" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="178305" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="178305" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert8 -->
<g id="edge1681" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178234.61,-452.71C178247.7,-439.43 178261.42,-425.51 178273.23,-413.52"/>
<polygon fill="black" stroke="black" points="178275.79,-415.91 178280.32,-406.33 178270.81,-411 178275.79,-415.91"/>
</g>
<!-- dp2_pp2_layer13_expert9 -->
<g id="node1030" class="node">
<title>dp2_pp2_layer13_expert9</title>
<polygon fill="lightgreen" stroke="black" points="178659,-406.29 178435,-406.29 178435,-354.29 178659,-354.29 178659,-406.29"/>
<text text-anchor="middle" x="178547" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="178547" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="178547" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="178547" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert9 -->
<g id="edge1682" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178331.38,-454.21C178376.29,-439.03 178424.08,-422.86 178463.23,-409.62"/>
<polygon fill="black" stroke="black" points="178464.64,-412.84 178472.99,-406.32 178462.4,-406.21 178464.64,-412.84"/>
</g>
<!-- dp2_pp2_layer13_expert10 -->
<g id="node1031" class="node">
<title>dp2_pp2_layer13_expert10</title>
<polygon fill="lightgreen" stroke="black" points="178901,-406.29 178677,-406.29 178677,-354.29 178901,-354.29 178901,-406.29"/>
<text text-anchor="middle" x="178789" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="178789" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="178789" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="178789" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert10 -->
<g id="edge1683" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178354.89,-478.04C178447.98,-462.69 178564.88,-441.49 178668,-417.06 178678.09,-414.67 178688.6,-411.94 178699.01,-409.07"/>
<polygon fill="black" stroke="black" points="178700.26,-412.36 178708.95,-406.3 178698.37,-405.62 178700.26,-412.36"/>
</g>
<!-- dp2_pp2_layer13_expert11 -->
<g id="node1032" class="node">
<title>dp2_pp2_layer13_expert11</title>
<polygon fill="lightgreen" stroke="black" points="179143,-406.29 178919,-406.29 178919,-354.29 179143,-354.29 179143,-406.29"/>
<text text-anchor="middle" x="179031" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="179031" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="179031" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="179031" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert11 -->
<g id="edge1684" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178366.99,-490.7C178514.62,-477.88 178727.08,-454.78 178910,-417.06 178920.95,-414.8 178932.35,-412.02 178943.57,-409.02"/>
<polygon fill="black" stroke="black" points="178944.66,-412.35 178953.38,-406.33 178942.81,-405.6 178944.66,-412.35"/>
</g>
<!-- dp2_pp2_layer13_expert12 -->
<g id="node1033" class="node">
<title>dp2_pp2_layer13_expert12</title>
<polygon fill="lightgreen" stroke="black" points="179385,-406.29 179161,-406.29 179161,-354.29 179385,-354.29 179385,-406.29"/>
<text text-anchor="middle" x="179273" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="179273" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="179273" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="179273" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert12 -->
<g id="edge1685" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178374.27,-498.07C178570.59,-489.29 178884.95,-468.01 179152,-417.06 179163.43,-414.88 179175.33,-412.06 179187.01,-408.97"/>
<polygon fill="black" stroke="black" points="179188.02,-412.32 179196.75,-406.31 179186.18,-405.57 179188.02,-412.32"/>
</g>
<!-- dp2_pp2_layer13_expert13 -->
<g id="node1034" class="node">
<title>dp2_pp2_layer13_expert13</title>
<polygon fill="lightgreen" stroke="black" points="179627,-406.29 179403,-406.29 179403,-354.29 179627,-354.29 179627,-406.29"/>
<text text-anchor="middle" x="179515" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="179515" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="179515" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="179515" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert13 -->
<g id="edge1686" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178378.93,-502.93C178619.42,-498.58 179039.9,-481.35 179394,-417.06 179405.62,-414.95 179417.71,-412.14 179429.56,-409.03"/>
<polygon fill="black" stroke="black" points="179430.7,-412.34 179439.44,-406.34 179428.87,-405.59 179430.7,-412.34"/>
</g>
<!-- dp2_pp2_layer13_expert14 -->
<g id="node1035" class="node">
<title>dp2_pp2_layer13_expert14</title>
<polygon fill="lightgreen" stroke="black" points="179869,-406.29 179645,-406.29 179645,-354.29 179869,-354.29 179869,-406.29"/>
<text text-anchor="middle" x="179757" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="179757" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="179757" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="179757" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert14 -->
<g id="edge1687" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178374.32,-498.04C178711.17,-486.48 179399.15,-458.6 179636,-417.06 179647.92,-414.97 179660.32,-412.12 179672.46,-408.93"/>
<polygon fill="black" stroke="black" points="179673.38,-412.3 179682.11,-406.3 179671.54,-405.55 179673.38,-412.3"/>
</g>
<!-- dp2_pp2_layer13_expert15 -->
<g id="node1036" class="node">
<title>dp2_pp2_layer13_expert15</title>
<polygon fill="lightgreen" stroke="black" points="180111,-406.29 179887,-406.29 179887,-354.29 180111,-354.29 180111,-406.29"/>
<text text-anchor="middle" x="179999" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="179999" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="179999" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="179999" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert15 -->
<g id="edge1688" class="edge">
<title>dp2_pp2_layer13_router&#45;&gt;dp2_pp2_layer13_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M178375.94,-499.9C178756.49,-490.72 179594.35,-465.57 179878,-417.06 179890.01,-415.01 179902.51,-412.16 179914.73,-408.95"/>
<polygon fill="black" stroke="black" points="179915.72,-412.31 179924.45,-406.32 179913.88,-405.56 179915.72,-412.31"/>
</g>
<!-- dp2_pp2_layer13_expert_agg -->
<g id="node1037" class="node">
<title>dp2_pp2_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="178431.57,-307.52 178037.74,-307.52 177936.43,-203.52 178330.26,-203.52 178431.57,-307.52"/>
<text text-anchor="middle" x="178184" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="178184" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="178184" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="178184" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer13_expert0&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1689" class="edge">
<title>dp2_pp2_layer13_expert0&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M176427.07,-354.29C176446.69,-346.92 176468.97,-339.72 176490,-335.52 176769.13,-279.86 177592.93,-263.21 177979.43,-258.4"/>
<polygon fill="black" stroke="black" points="177979.65,-261.9 177989.61,-258.27 177979.57,-254.9 177979.65,-261.9"/>
</g>
<!-- dp2_pp2_layer13_expert1&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1690" class="edge">
<title>dp2_pp2_layer13_expert1&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M176669.39,-354.27C176688.95,-346.95 176711.09,-339.78 176732,-335.52 176964.8,-288.16 177640.09,-267.74 177981.43,-260.24"/>
<polygon fill="black" stroke="black" points="177981.51,-263.74 177991.43,-260.03 177981.35,-256.74 177981.51,-263.74"/>
</g>
<!-- dp2_pp2_layer13_expert2&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1691" class="edge">
<title>dp2_pp2_layer13_expert2&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M176911.73,-354.29C176931.21,-347.01 176953.23,-339.87 176974,-335.52 177160.91,-296.44 177690.54,-273.07 177983.3,-262.78"/>
<polygon fill="black" stroke="black" points="177983.74,-266.27 177993.61,-262.42 177983.5,-259.27 177983.74,-266.27"/>
</g>
<!-- dp2_pp2_layer13_expert3&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1692" class="edge">
<title>dp2_pp2_layer13_expert3&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M177154.39,-354.26C177173.72,-347.07 177195.48,-339.99 177216,-335.52 177474.91,-279.18 177780.7,-262.24 177978.26,-257.56"/>
<polygon fill="black" stroke="black" points="177978.55,-261.06 177988.47,-257.33 177978.39,-254.06 177978.55,-261.06"/>
</g>
<!-- dp2_pp2_layer13_expert4&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1693" class="edge">
<title>dp2_pp2_layer13_expert4&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M177397.39,-354.24C177416.49,-347.2 177437.87,-340.19 177458,-335.52 177633.82,-294.77 177838.6,-274.91 177985.75,-265.31"/>
<polygon fill="black" stroke="black" points="177986.05,-268.8 177995.81,-264.67 177985.6,-261.82 177986.05,-268.8"/>
</g>
<!-- dp2_pp2_layer13_expert5&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1694" class="edge">
<title>dp2_pp2_layer13_expert5&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M177641.42,-354.22C177660.04,-347.42 177680.65,-340.55 177700,-335.52 177797.09,-310.27 177907.34,-291.53 177998.07,-278.65"/>
<polygon fill="black" stroke="black" points="177998.78,-282.09 178008.19,-277.23 177997.8,-275.16 177998.78,-282.09"/>
</g>
<!-- dp2_pp2_layer13_expert6&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1695" class="edge">
<title>dp2_pp2_layer13_expert6&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M177889.02,-354.26C177906.26,-348.03 177924.78,-341.44 177942,-335.52 177968.73,-326.33 177997.21,-316.8 178024.89,-307.67"/>
<polygon fill="black" stroke="black" points="178026.24,-310.91 178034.65,-304.46 178024.06,-304.26 178026.24,-310.91"/>
</g>
<!-- dp2_pp2_layer13_expert7&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1696" class="edge">
<title>dp2_pp2_layer13_expert7&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M178087.78,-354.15C178099.02,-342.74 178112.83,-328.73 178126.45,-314.92"/>
<polygon fill="black" stroke="black" points="178129,-317.31 178133.53,-307.73 178124.02,-312.39 178129,-317.31"/>
</g>
<!-- dp2_pp2_layer13_expert8&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1697" class="edge">
<title>dp2_pp2_layer13_expert8&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M178280.22,-354.15C178268.97,-342.74 178255.16,-328.73 178241.55,-314.92"/>
<polygon fill="black" stroke="black" points="178243.98,-312.39 178234.47,-307.73 178238.99,-317.31 178243.98,-312.39"/>
</g>
<!-- dp2_pp2_layer13_expert9&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1698" class="edge">
<title>dp2_pp2_layer13_expert9&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M178478.98,-354.26C178461.73,-348.03 178443.21,-341.44 178426,-335.52 178402.29,-327.37 178377.21,-318.95 178352.53,-310.78"/>
<polygon fill="black" stroke="black" points="178353.32,-307.36 178342.73,-307.54 178351.12,-314 178353.32,-307.36"/>
</g>
<!-- dp2_pp2_layer13_expert10&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1699" class="edge">
<title>dp2_pp2_layer13_expert10&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M178726.58,-354.22C178707.96,-347.42 178687.35,-340.55 178668,-335.52 178587.99,-314.71 178499.05,-298.33 178419.46,-286"/>
<polygon fill="black" stroke="black" points="178419.71,-282.5 178409.3,-284.44 178418.65,-289.41 178419.71,-282.5"/>
</g>
<!-- dp2_pp2_layer13_expert11&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1700" class="edge">
<title>dp2_pp2_layer13_expert11&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M178970.61,-354.24C178951.51,-347.2 178930.13,-340.19 178910,-335.52 178741.74,-296.53 178546.97,-276.66 178401.55,-266.61"/>
<polygon fill="black" stroke="black" points="178401.38,-263.09 178391.16,-265.9 178400.9,-270.07 178401.38,-263.09"/>
</g>
<!-- dp2_pp2_layer13_expert12&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1701" class="edge">
<title>dp2_pp2_layer13_expert12&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M179213.61,-354.26C179194.28,-347.07 179172.52,-339.99 179152,-335.52 178894.51,-279.49 178590.64,-262.43 178392.99,-257.64"/>
<polygon fill="black" stroke="black" points="178392.86,-254.14 178382.78,-257.4 178392.69,-261.13 178392.86,-254.14"/>
</g>
<!-- dp2_pp2_layer13_expert13&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1702" class="edge">
<title>dp2_pp2_layer13_expert13&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M179456.27,-354.29C179436.79,-347.01 179414.77,-339.87 179394,-335.52 179210.02,-297.05 178693.97,-273.81 178398.63,-263.27"/>
<polygon fill="black" stroke="black" points="178398.33,-259.76 178388.21,-262.9 178398.08,-266.76 178398.33,-259.76"/>
</g>
<!-- dp2_pp2_layer13_expert14&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1703" class="edge">
<title>dp2_pp2_layer13_expert14&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M179698.6,-354.27C179679.05,-346.95 179656.9,-339.78 179636,-335.52 179405.27,-288.58 178739.86,-268.1 178395.74,-260.45"/>
<polygon fill="black" stroke="black" points="178395.73,-256.94 178385.65,-260.22 178395.57,-263.94 178395.73,-256.94"/>
</g>
<!-- dp2_pp2_layer13_expert15&#45;&gt;dp2_pp2_layer13_expert_agg -->
<g id="edge1704" class="edge">
<title>dp2_pp2_layer13_expert15&#45;&gt;dp2_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M179940.93,-354.29C179921.3,-346.92 179899.03,-339.72 179878,-335.52 179600.21,-280.12 178782.98,-263.37 178394.17,-258.47"/>
<polygon fill="black" stroke="black" points="178393.97,-254.97 178383.93,-258.34 178393.88,-261.97 178393.97,-254.97"/>
</g>
<!-- dp2_pp2_layer14_attn_tp0 -->
<g id="node1038" class="node">
<title>dp2_pp2_layer14_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="175666.5,-531.06 175401.5,-531.06 175401.5,-479.06 175666.5,-479.06 175666.5,-531.06"/>
<text text-anchor="middle" x="175534" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="175534" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="175534" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="175534" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer13_expert_agg&#45;&gt;dp2_pp2_layer14_attn_tp0 -->
<g id="edge1706" class="edge">
<title>dp2_pp2_layer13_expert_agg&#45;&gt;dp2_pp2_layer14_attn_tp0</title>
<path fill="none" stroke="black" d="M177991.78,-260.41C177571.38,-269.54 176581.17,-294.77 176248,-335.52 176215.8,-339.46 175707.23,-444.29 175676,-453.06 175653.37,-459.41 175629.16,-467.58 175607.26,-475.5"/>
<polygon fill="black" stroke="black" points="175605.89,-472.28 175597.7,-479 175608.29,-478.85 175605.89,-472.28"/>
</g>
<!-- dp2_pp2_layer14_attn_allreduce -->
<g id="node1039" class="node">
<title>dp2_pp2_layer14_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="175663" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="175663" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="175663" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="175663" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="175663" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_attn_tp0&#45;&gt;dp2_pp2_layer14_attn_allreduce -->
<g id="edge1707" class="edge">
<title>dp2_pp2_layer14_attn_tp0&#45;&gt;dp2_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M175560.41,-478.92C175577.15,-463 175599.21,-442 175618.58,-423.56"/>
<polygon fill="black" stroke="black" points="175621.03,-426.07 175625.86,-416.64 175616.2,-421 175621.03,-426.07"/>
</g>
<!-- dp2_pp2_layer14_router -->
<g id="node1043" class="node">
<title>dp2_pp2_layer14_router</title>
<polygon fill="lightyellow" stroke="black" points="173414.57,-557.06 173020.74,-557.06 172919.43,-453.06 173313.26,-453.06 173414.57,-557.06"/>
<text text-anchor="middle" x="173167" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="173167" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="173167" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="173167" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_attn_allreduce&#45;&gt;dp2_pp2_layer14_router -->
<g id="edge1743" class="edge">
<title>dp2_pp2_layer14_attn_allreduce&#45;&gt;dp2_pp2_layer14_router</title>
<path fill="none" stroke="black" d="M175503.08,-392.38C175391.77,-399.9 175239.89,-409.76 175106,-417.06 174470.5,-451.72 173717.28,-482.59 173365.96,-496.4"/>
<polygon fill="black" stroke="black" points="173365.8,-492.91 173355.94,-496.79 173366.07,-499.9 173365.8,-492.91"/>
</g>
<!-- dp2_pp2_layer14_attn_tp1 -->
<g id="node1040" class="node">
<title>dp2_pp2_layer14_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="175949.5,-531.06 175684.5,-531.06 175684.5,-479.06 175949.5,-479.06 175949.5,-531.06"/>
<text text-anchor="middle" x="175817" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="175817" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="175817" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="175817" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer14_attn_tp1&#45;&gt;dp2_pp2_layer14_attn_allreduce -->
<g id="edge1708" class="edge">
<title>dp2_pp2_layer14_attn_tp1&#45;&gt;dp2_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M175785.46,-478.92C175764.99,-462.6 175737.83,-440.94 175714.29,-422.18"/>
<polygon fill="black" stroke="black" points="175716.46,-419.44 175706.46,-415.94 175712.1,-424.91 175716.46,-419.44"/>
</g>
<!-- dp2_pp2_layer14_attn_tp2 -->
<g id="node1041" class="node">
<title>dp2_pp2_layer14_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="175383.5,-531.06 175118.5,-531.06 175118.5,-479.06 175383.5,-479.06 175383.5,-531.06"/>
<text text-anchor="middle" x="175251" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="175251" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="175251" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="175251" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer14_attn_tp2&#45;&gt;dp2_pp2_layer14_attn_allreduce -->
<g id="edge1709" class="edge">
<title>dp2_pp2_layer14_attn_tp2&#45;&gt;dp2_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M175317.07,-479.02C175340.85,-470.35 175367.99,-460.86 175393,-453.06 175441.74,-437.86 175496.05,-423.03 175543.1,-410.83"/>
<polygon fill="black" stroke="black" points="175544.22,-414.15 175553.03,-408.26 175542.47,-407.38 175544.22,-414.15"/>
</g>
<!-- dp2_pp2_layer14_attn_tp3 -->
<g id="node1042" class="node">
<title>dp2_pp2_layer14_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="176232.5,-531.06 175967.5,-531.06 175967.5,-479.06 176232.5,-479.06 176232.5,-531.06"/>
<text text-anchor="middle" x="176100" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="176100" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="176100" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="176100" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer14_attn_tp3&#45;&gt;dp2_pp2_layer14_attn_allreduce -->
<g id="edge1710" class="edge">
<title>dp2_pp2_layer14_attn_tp3&#45;&gt;dp2_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M176035.21,-478.95C176011.43,-470.18 175984.17,-460.64 175959,-453.06 175904.42,-436.63 175843.31,-421.31 175790.86,-409.08"/>
<polygon fill="black" stroke="black" points="175791.37,-405.6 175780.83,-406.75 175789.78,-412.42 175791.37,-405.6"/>
</g>
<!-- dp2_pp2_layer14_expert0 -->
<g id="node1044" class="node">
<title>dp2_pp2_layer14_expert0</title>
<polygon fill="lightgreen" stroke="black" points="171464,-406.29 171240,-406.29 171240,-354.29 171464,-354.29 171464,-406.29"/>
<text text-anchor="middle" x="171352" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="171352" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="171352" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="171352" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert0 -->
<g id="edge1711" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172964.73,-499.65C172579.55,-490.26 171754.11,-465.13 171473,-417.06 171460.99,-415.01 171448.48,-412.16 171436.27,-408.95"/>
<polygon fill="black" stroke="black" points="171437.11,-405.56 171426.54,-406.32 171435.28,-412.31 171437.11,-405.56"/>
</g>
<!-- dp2_pp2_layer14_expert1 -->
<g id="node1045" class="node">
<title>dp2_pp2_layer14_expert1</title>
<polygon fill="lightgreen" stroke="black" points="171706,-406.29 171482,-406.29 171482,-354.29 171706,-354.29 171706,-406.29"/>
<text text-anchor="middle" x="171594" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="171594" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="171594" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="171594" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert1 -->
<g id="edge1712" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172962.55,-497.55C172620.94,-485.71 171948.58,-458.03 171715,-417.06 171703.08,-414.97 171690.67,-412.12 171678.54,-408.93"/>
<polygon fill="black" stroke="black" points="171679.45,-405.55 171668.89,-406.3 171677.62,-412.3 171679.45,-405.55"/>
</g>
<!-- dp2_pp2_layer14_expert2 -->
<g id="node1046" class="node">
<title>dp2_pp2_layer14_expert2</title>
<polygon fill="lightgreen" stroke="black" points="171948,-406.29 171724,-406.29 171724,-354.29 171948,-354.29 171948,-406.29"/>
<text text-anchor="middle" x="171836" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="171836" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="171836" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="171836" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert2 -->
<g id="edge1713" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172967.82,-502.85C172726.66,-498.37 172309.02,-480.97 171957,-417.06 171945.38,-414.95 171933.29,-412.14 171921.44,-409.03"/>
<polygon fill="black" stroke="black" points="171922.13,-405.59 171911.56,-406.34 171920.29,-412.34 171922.13,-405.59"/>
</g>
<!-- dp2_pp2_layer14_expert3 -->
<g id="node1047" class="node">
<title>dp2_pp2_layer14_expert3</title>
<polygon fill="lightgreen" stroke="black" points="172190,-406.29 171966,-406.29 171966,-354.29 172190,-354.29 172190,-406.29"/>
<text text-anchor="middle" x="172078" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="172078" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="172078" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="172078" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert3 -->
<g id="edge1714" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172962.36,-497.41C172765.31,-488.25 172459.63,-466.79 172199,-417.06 172187.57,-414.88 172175.67,-412.06 172163.99,-408.97"/>
<polygon fill="black" stroke="black" points="172164.82,-405.57 172154.25,-406.31 172162.98,-412.32 172164.82,-405.57"/>
</g>
<!-- dp2_pp2_layer14_expert4 -->
<g id="node1048" class="node">
<title>dp2_pp2_layer14_expert4</title>
<polygon fill="lightgreen" stroke="black" points="172432,-406.29 172208,-406.29 172208,-354.29 172432,-354.29 172432,-406.29"/>
<text text-anchor="middle" x="172320" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="172320" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="172320" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="172320" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert4 -->
<g id="edge1715" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172953.43,-487.98C172807.99,-474.71 172611.64,-452.25 172441,-417.06 172430.05,-414.8 172418.65,-412.02 172407.43,-409.02"/>
<polygon fill="black" stroke="black" points="172408.19,-405.6 172397.62,-406.33 172406.34,-412.35 172408.19,-405.6"/>
</g>
<!-- dp2_pp2_layer14_expert5 -->
<g id="node1049" class="node">
<title>dp2_pp2_layer14_expert5</title>
<polygon fill="lightgreen" stroke="black" points="172674,-406.29 172450,-406.29 172450,-354.29 172674,-354.29 172674,-406.29"/>
<text text-anchor="middle" x="172562" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="172562" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="172562" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="172562" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert5 -->
<g id="edge1716" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M172933.29,-467.38C172853.5,-453.44 172764,-436.25 172683,-417.06 172672.9,-414.67 172662.4,-411.94 172651.99,-409.07"/>
<polygon fill="black" stroke="black" points="172652.62,-405.62 172642.05,-406.3 172650.74,-412.36 172652.62,-405.62"/>
</g>
<!-- dp2_pp2_layer14_expert6 -->
<g id="node1050" class="node">
<title>dp2_pp2_layer14_expert6</title>
<polygon fill="lightgreen" stroke="black" points="172916,-406.29 172692,-406.29 172692,-354.29 172916,-354.29 172916,-406.29"/>
<text text-anchor="middle" x="172804" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="172804" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="172804" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="172804" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert6 -->
<g id="edge1717" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173015.94,-452.97C172972.16,-438.16 172925.94,-422.53 172887.87,-409.66"/>
<polygon fill="black" stroke="black" points="172888.97,-406.33 172878.38,-406.45 172886.73,-412.97 172888.97,-406.33"/>
</g>
<!-- dp2_pp2_layer14_expert7 -->
<g id="node1051" class="node">
<title>dp2_pp2_layer14_expert7</title>
<polygon fill="lightgreen" stroke="black" points="173158,-406.29 172934,-406.29 172934,-354.29 173158,-354.29 173158,-406.29"/>
<text text-anchor="middle" x="173046" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="173046" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="173046" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="173046" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert7 -->
<g id="edge1718" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173116.38,-452.71C173103.3,-439.43 173089.58,-425.51 173077.76,-413.52"/>
<polygon fill="black" stroke="black" points="173080.19,-411 173070.68,-406.33 173075.2,-415.91 173080.19,-411"/>
</g>
<!-- dp2_pp2_layer14_expert8 -->
<g id="node1052" class="node">
<title>dp2_pp2_layer14_expert8</title>
<polygon fill="lightgreen" stroke="black" points="173400,-406.29 173176,-406.29 173176,-354.29 173400,-354.29 173400,-406.29"/>
<text text-anchor="middle" x="173288" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="173288" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="173288" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="173288" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert8 -->
<g id="edge1719" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173217.61,-452.71C173230.7,-439.43 173244.42,-425.51 173256.23,-413.52"/>
<polygon fill="black" stroke="black" points="173258.79,-415.91 173263.32,-406.33 173253.81,-411 173258.79,-415.91"/>
</g>
<!-- dp2_pp2_layer14_expert9 -->
<g id="node1053" class="node">
<title>dp2_pp2_layer14_expert9</title>
<polygon fill="lightgreen" stroke="black" points="173642,-406.29 173418,-406.29 173418,-354.29 173642,-354.29 173642,-406.29"/>
<text text-anchor="middle" x="173530" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="173530" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="173530" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="173530" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert9 -->
<g id="edge1720" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173314.38,-454.21C173359.29,-439.03 173407.08,-422.86 173446.23,-409.62"/>
<polygon fill="black" stroke="black" points="173447.64,-412.84 173455.99,-406.32 173445.4,-406.21 173447.64,-412.84"/>
</g>
<!-- dp2_pp2_layer14_expert10 -->
<g id="node1054" class="node">
<title>dp2_pp2_layer14_expert10</title>
<polygon fill="lightgreen" stroke="black" points="173884,-406.29 173660,-406.29 173660,-354.29 173884,-354.29 173884,-406.29"/>
<text text-anchor="middle" x="173772" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="173772" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="173772" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="173772" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert10 -->
<g id="edge1721" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173337.89,-478.04C173430.98,-462.69 173547.88,-441.49 173651,-417.06 173661.09,-414.67 173671.6,-411.94 173682.01,-409.07"/>
<polygon fill="black" stroke="black" points="173683.26,-412.36 173691.95,-406.3 173681.37,-405.62 173683.26,-412.36"/>
</g>
<!-- dp2_pp2_layer14_expert11 -->
<g id="node1055" class="node">
<title>dp2_pp2_layer14_expert11</title>
<polygon fill="lightgreen" stroke="black" points="174126,-406.29 173902,-406.29 173902,-354.29 174126,-354.29 174126,-406.29"/>
<text text-anchor="middle" x="174014" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="174014" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="174014" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="174014" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert11 -->
<g id="edge1722" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173349.99,-490.7C173497.62,-477.88 173710.08,-454.78 173893,-417.06 173903.95,-414.8 173915.35,-412.02 173926.57,-409.02"/>
<polygon fill="black" stroke="black" points="173927.66,-412.35 173936.38,-406.33 173925.81,-405.6 173927.66,-412.35"/>
</g>
<!-- dp2_pp2_layer14_expert12 -->
<g id="node1056" class="node">
<title>dp2_pp2_layer14_expert12</title>
<polygon fill="lightgreen" stroke="black" points="174368,-406.29 174144,-406.29 174144,-354.29 174368,-354.29 174368,-406.29"/>
<text text-anchor="middle" x="174256" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="174256" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="174256" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="174256" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert12 -->
<g id="edge1723" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173357.27,-498.07C173553.59,-489.29 173867.95,-468.01 174135,-417.06 174146.43,-414.88 174158.33,-412.06 174170.01,-408.97"/>
<polygon fill="black" stroke="black" points="174171.02,-412.32 174179.75,-406.31 174169.18,-405.57 174171.02,-412.32"/>
</g>
<!-- dp2_pp2_layer14_expert13 -->
<g id="node1057" class="node">
<title>dp2_pp2_layer14_expert13</title>
<polygon fill="lightgreen" stroke="black" points="174610,-406.29 174386,-406.29 174386,-354.29 174610,-354.29 174610,-406.29"/>
<text text-anchor="middle" x="174498" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="174498" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="174498" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="174498" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert13 -->
<g id="edge1724" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173361.93,-502.93C173602.42,-498.58 174022.9,-481.35 174377,-417.06 174388.62,-414.95 174400.71,-412.14 174412.56,-409.03"/>
<polygon fill="black" stroke="black" points="174413.7,-412.34 174422.44,-406.34 174411.87,-405.59 174413.7,-412.34"/>
</g>
<!-- dp2_pp2_layer14_expert14 -->
<g id="node1058" class="node">
<title>dp2_pp2_layer14_expert14</title>
<polygon fill="lightgreen" stroke="black" points="174852,-406.29 174628,-406.29 174628,-354.29 174852,-354.29 174852,-406.29"/>
<text text-anchor="middle" x="174740" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="174740" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="174740" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="174740" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert14 -->
<g id="edge1725" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173357.32,-498.04C173694.17,-486.48 174382.15,-458.6 174619,-417.06 174630.92,-414.97 174643.32,-412.12 174655.46,-408.93"/>
<polygon fill="black" stroke="black" points="174656.38,-412.3 174665.11,-406.3 174654.54,-405.55 174656.38,-412.3"/>
</g>
<!-- dp2_pp2_layer14_expert15 -->
<g id="node1059" class="node">
<title>dp2_pp2_layer14_expert15</title>
<polygon fill="lightgreen" stroke="black" points="175094,-406.29 174870,-406.29 174870,-354.29 175094,-354.29 175094,-406.29"/>
<text text-anchor="middle" x="174982" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="174982" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="174982" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="174982" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert15 -->
<g id="edge1726" class="edge">
<title>dp2_pp2_layer14_router&#45;&gt;dp2_pp2_layer14_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M173358.94,-499.9C173739.49,-490.72 174577.35,-465.57 174861,-417.06 174873.01,-415.01 174885.51,-412.16 174897.73,-408.95"/>
<polygon fill="black" stroke="black" points="174898.72,-412.31 174907.45,-406.32 174896.88,-405.56 174898.72,-412.31"/>
</g>
<!-- dp2_pp2_layer14_expert_agg -->
<g id="node1060" class="node">
<title>dp2_pp2_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="173414.57,-307.52 173020.74,-307.52 172919.43,-203.52 173313.26,-203.52 173414.57,-307.52"/>
<text text-anchor="middle" x="173167" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="173167" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="173167" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="173167" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer14_expert0&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1727" class="edge">
<title>dp2_pp2_layer14_expert0&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M171410.07,-354.29C171429.69,-346.92 171451.97,-339.72 171473,-335.52 171752.13,-279.86 172575.93,-263.21 172962.43,-258.4"/>
<polygon fill="black" stroke="black" points="172962.65,-261.9 172972.61,-258.27 172962.57,-254.9 172962.65,-261.9"/>
</g>
<!-- dp2_pp2_layer14_expert1&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1728" class="edge">
<title>dp2_pp2_layer14_expert1&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M171652.39,-354.27C171671.95,-346.95 171694.09,-339.78 171715,-335.52 171947.8,-288.16 172623.09,-267.74 172964.43,-260.24"/>
<polygon fill="black" stroke="black" points="172964.51,-263.74 172974.43,-260.03 172964.35,-256.74 172964.51,-263.74"/>
</g>
<!-- dp2_pp2_layer14_expert2&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1729" class="edge">
<title>dp2_pp2_layer14_expert2&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M171894.73,-354.29C171914.21,-347.01 171936.23,-339.87 171957,-335.52 172143.91,-296.44 172673.54,-273.07 172966.3,-262.78"/>
<polygon fill="black" stroke="black" points="172966.74,-266.27 172976.61,-262.42 172966.5,-259.27 172966.74,-266.27"/>
</g>
<!-- dp2_pp2_layer14_expert3&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1730" class="edge">
<title>dp2_pp2_layer14_expert3&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M172137.39,-354.26C172156.72,-347.07 172178.48,-339.99 172199,-335.52 172457.91,-279.18 172763.7,-262.24 172961.26,-257.56"/>
<polygon fill="black" stroke="black" points="172961.55,-261.06 172971.47,-257.33 172961.39,-254.06 172961.55,-261.06"/>
</g>
<!-- dp2_pp2_layer14_expert4&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1731" class="edge">
<title>dp2_pp2_layer14_expert4&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M172380.39,-354.24C172399.49,-347.2 172420.87,-340.19 172441,-335.52 172616.82,-294.77 172821.6,-274.91 172968.75,-265.31"/>
<polygon fill="black" stroke="black" points="172969.05,-268.8 172978.81,-264.67 172968.6,-261.82 172969.05,-268.8"/>
</g>
<!-- dp2_pp2_layer14_expert5&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1732" class="edge">
<title>dp2_pp2_layer14_expert5&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M172624.42,-354.22C172643.04,-347.42 172663.65,-340.55 172683,-335.52 172780.09,-310.27 172890.34,-291.53 172981.07,-278.65"/>
<polygon fill="black" stroke="black" points="172981.78,-282.09 172991.19,-277.23 172980.8,-275.16 172981.78,-282.09"/>
</g>
<!-- dp2_pp2_layer14_expert6&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1733" class="edge">
<title>dp2_pp2_layer14_expert6&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M172872.02,-354.26C172889.26,-348.03 172907.78,-341.44 172925,-335.52 172951.73,-326.33 172980.21,-316.8 173007.89,-307.67"/>
<polygon fill="black" stroke="black" points="173009.24,-310.91 173017.65,-304.46 173007.06,-304.26 173009.24,-310.91"/>
</g>
<!-- dp2_pp2_layer14_expert7&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1734" class="edge">
<title>dp2_pp2_layer14_expert7&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M173070.78,-354.15C173082.02,-342.74 173095.83,-328.73 173109.45,-314.92"/>
<polygon fill="black" stroke="black" points="173112,-317.31 173116.53,-307.73 173107.02,-312.39 173112,-317.31"/>
</g>
<!-- dp2_pp2_layer14_expert8&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1735" class="edge">
<title>dp2_pp2_layer14_expert8&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M173263.22,-354.15C173251.97,-342.74 173238.16,-328.73 173224.55,-314.92"/>
<polygon fill="black" stroke="black" points="173226.98,-312.39 173217.47,-307.73 173221.99,-317.31 173226.98,-312.39"/>
</g>
<!-- dp2_pp2_layer14_expert9&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1736" class="edge">
<title>dp2_pp2_layer14_expert9&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M173461.98,-354.26C173444.73,-348.03 173426.21,-341.44 173409,-335.52 173385.29,-327.37 173360.21,-318.95 173335.53,-310.78"/>
<polygon fill="black" stroke="black" points="173336.32,-307.36 173325.73,-307.54 173334.12,-314 173336.32,-307.36"/>
</g>
<!-- dp2_pp2_layer14_expert10&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1737" class="edge">
<title>dp2_pp2_layer14_expert10&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M173709.58,-354.22C173690.96,-347.42 173670.35,-340.55 173651,-335.52 173570.99,-314.71 173482.05,-298.33 173402.46,-286"/>
<polygon fill="black" stroke="black" points="173402.71,-282.5 173392.3,-284.44 173401.65,-289.41 173402.71,-282.5"/>
</g>
<!-- dp2_pp2_layer14_expert11&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1738" class="edge">
<title>dp2_pp2_layer14_expert11&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M173953.61,-354.24C173934.51,-347.2 173913.13,-340.19 173893,-335.52 173724.74,-296.53 173529.97,-276.66 173384.55,-266.61"/>
<polygon fill="black" stroke="black" points="173384.38,-263.09 173374.16,-265.9 173383.9,-270.07 173384.38,-263.09"/>
</g>
<!-- dp2_pp2_layer14_expert12&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1739" class="edge">
<title>dp2_pp2_layer14_expert12&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M174196.61,-354.26C174177.28,-347.07 174155.52,-339.99 174135,-335.52 173877.51,-279.49 173573.64,-262.43 173375.99,-257.64"/>
<polygon fill="black" stroke="black" points="173375.86,-254.14 173365.78,-257.4 173375.69,-261.13 173375.86,-254.14"/>
</g>
<!-- dp2_pp2_layer14_expert13&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1740" class="edge">
<title>dp2_pp2_layer14_expert13&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M174439.27,-354.29C174419.79,-347.01 174397.77,-339.87 174377,-335.52 174193.02,-297.05 173676.97,-273.81 173381.63,-263.27"/>
<polygon fill="black" stroke="black" points="173381.33,-259.76 173371.21,-262.9 173381.08,-266.76 173381.33,-259.76"/>
</g>
<!-- dp2_pp2_layer14_expert14&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1741" class="edge">
<title>dp2_pp2_layer14_expert14&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M174681.6,-354.27C174662.05,-346.95 174639.9,-339.78 174619,-335.52 174388.27,-288.58 173722.86,-268.1 173378.74,-260.45"/>
<polygon fill="black" stroke="black" points="173378.73,-256.94 173368.65,-260.22 173378.57,-263.94 173378.73,-256.94"/>
</g>
<!-- dp2_pp2_layer14_expert15&#45;&gt;dp2_pp2_layer14_expert_agg -->
<g id="edge1742" class="edge">
<title>dp2_pp2_layer14_expert15&#45;&gt;dp2_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M174923.93,-354.29C174904.3,-346.92 174882.03,-339.72 174861,-335.52 174583.21,-280.12 173765.98,-263.37 173377.17,-258.47"/>
<polygon fill="black" stroke="black" points="173376.97,-254.97 173366.93,-258.34 173376.88,-261.97 173376.97,-254.97"/>
</g>
<!-- dp2_pp2_layer15_attn_tp0 -->
<g id="node1061" class="node">
<title>dp2_pp2_layer15_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="170649.5,-531.06 170384.5,-531.06 170384.5,-479.06 170649.5,-479.06 170649.5,-531.06"/>
<text text-anchor="middle" x="170517" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="170517" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="170517" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="170517" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer14_expert_agg&#45;&gt;dp2_pp2_layer15_attn_tp0 -->
<g id="edge1744" class="edge">
<title>dp2_pp2_layer14_expert_agg&#45;&gt;dp2_pp2_layer15_attn_tp0</title>
<path fill="none" stroke="black" d="M172974.78,-260.41C172554.38,-269.54 171564.17,-294.77 171231,-335.52 171198.8,-339.46 170690.23,-444.29 170659,-453.06 170636.37,-459.41 170612.16,-467.58 170590.26,-475.5"/>
<polygon fill="black" stroke="black" points="170588.89,-472.28 170580.7,-479 170591.29,-478.85 170588.89,-472.28"/>
</g>
<!-- dp2_pp2_layer15_attn_allreduce -->
<g id="node1062" class="node">
<title>dp2_pp2_layer15_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="170646" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="170646" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="170646" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="170646" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="170646" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_attn_tp0&#45;&gt;dp2_pp2_layer15_attn_allreduce -->
<g id="edge1745" class="edge">
<title>dp2_pp2_layer15_attn_tp0&#45;&gt;dp2_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M170543.41,-478.92C170560.15,-463 170582.21,-442 170601.58,-423.56"/>
<polygon fill="black" stroke="black" points="170604.03,-426.07 170608.86,-416.64 170599.2,-421 170604.03,-426.07"/>
</g>
<!-- dp2_pp2_layer15_router -->
<g id="node1066" class="node">
<title>dp2_pp2_layer15_router</title>
<polygon fill="lightyellow" stroke="black" points="168397.57,-557.06 168003.74,-557.06 167902.43,-453.06 168296.26,-453.06 168397.57,-557.06"/>
<text text-anchor="middle" x="168150" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="168150" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="168150" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="168150" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_attn_allreduce&#45;&gt;dp2_pp2_layer15_router -->
<g id="edge1781" class="edge">
<title>dp2_pp2_layer15_attn_allreduce&#45;&gt;dp2_pp2_layer15_router</title>
<path fill="none" stroke="black" d="M170486.08,-392.38C170374.77,-399.9 170222.89,-409.76 170089,-417.06 169453.5,-451.72 168700.28,-482.59 168348.96,-496.4"/>
<polygon fill="black" stroke="black" points="168348.8,-492.91 168338.94,-496.79 168349.07,-499.9 168348.8,-492.91"/>
</g>
<!-- dp2_pp2_layer15_attn_tp1 -->
<g id="node1063" class="node">
<title>dp2_pp2_layer15_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="170932.5,-531.06 170667.5,-531.06 170667.5,-479.06 170932.5,-479.06 170932.5,-531.06"/>
<text text-anchor="middle" x="170800" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="170800" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="170800" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="170800" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer15_attn_tp1&#45;&gt;dp2_pp2_layer15_attn_allreduce -->
<g id="edge1746" class="edge">
<title>dp2_pp2_layer15_attn_tp1&#45;&gt;dp2_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M170768.46,-478.92C170747.99,-462.6 170720.83,-440.94 170697.29,-422.18"/>
<polygon fill="black" stroke="black" points="170699.46,-419.44 170689.46,-415.94 170695.1,-424.91 170699.46,-419.44"/>
</g>
<!-- dp2_pp2_layer15_attn_tp2 -->
<g id="node1064" class="node">
<title>dp2_pp2_layer15_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="170366.5,-531.06 170101.5,-531.06 170101.5,-479.06 170366.5,-479.06 170366.5,-531.06"/>
<text text-anchor="middle" x="170234" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="170234" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="170234" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="170234" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer15_attn_tp2&#45;&gt;dp2_pp2_layer15_attn_allreduce -->
<g id="edge1747" class="edge">
<title>dp2_pp2_layer15_attn_tp2&#45;&gt;dp2_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M170300.07,-479.02C170323.85,-470.35 170350.99,-460.86 170376,-453.06 170424.74,-437.86 170479.05,-423.03 170526.1,-410.83"/>
<polygon fill="black" stroke="black" points="170527.22,-414.15 170536.03,-408.26 170525.47,-407.38 170527.22,-414.15"/>
</g>
<!-- dp2_pp2_layer15_attn_tp3 -->
<g id="node1065" class="node">
<title>dp2_pp2_layer15_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="171215.5,-531.06 170950.5,-531.06 170950.5,-479.06 171215.5,-479.06 171215.5,-531.06"/>
<text text-anchor="middle" x="171083" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="171083" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="171083" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="171083" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer15_attn_tp3&#45;&gt;dp2_pp2_layer15_attn_allreduce -->
<g id="edge1748" class="edge">
<title>dp2_pp2_layer15_attn_tp3&#45;&gt;dp2_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M171018.21,-478.95C170994.43,-470.18 170967.17,-460.64 170942,-453.06 170887.42,-436.63 170826.31,-421.31 170773.86,-409.08"/>
<polygon fill="black" stroke="black" points="170774.37,-405.6 170763.83,-406.75 170772.78,-412.42 170774.37,-405.6"/>
</g>
<!-- dp2_pp2_layer15_expert0 -->
<g id="node1067" class="node">
<title>dp2_pp2_layer15_expert0</title>
<polygon fill="lightgreen" stroke="black" points="166447,-406.29 166223,-406.29 166223,-354.29 166447,-354.29 166447,-406.29"/>
<text text-anchor="middle" x="166335" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="166335" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="166335" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="166335" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert0 -->
<g id="edge1749" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167947.73,-499.65C167562.55,-490.26 166737.11,-465.13 166456,-417.06 166443.99,-415.01 166431.48,-412.16 166419.27,-408.95"/>
<polygon fill="black" stroke="black" points="166420.11,-405.56 166409.54,-406.32 166418.28,-412.31 166420.11,-405.56"/>
</g>
<!-- dp2_pp2_layer15_expert1 -->
<g id="node1068" class="node">
<title>dp2_pp2_layer15_expert1</title>
<polygon fill="lightgreen" stroke="black" points="166689,-406.29 166465,-406.29 166465,-354.29 166689,-354.29 166689,-406.29"/>
<text text-anchor="middle" x="166577" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="166577" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="166577" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="166577" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert1 -->
<g id="edge1750" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167945.55,-497.55C167603.94,-485.71 166931.58,-458.03 166698,-417.06 166686.08,-414.97 166673.67,-412.12 166661.54,-408.93"/>
<polygon fill="black" stroke="black" points="166662.45,-405.55 166651.89,-406.3 166660.62,-412.3 166662.45,-405.55"/>
</g>
<!-- dp2_pp2_layer15_expert2 -->
<g id="node1069" class="node">
<title>dp2_pp2_layer15_expert2</title>
<polygon fill="lightgreen" stroke="black" points="166931,-406.29 166707,-406.29 166707,-354.29 166931,-354.29 166931,-406.29"/>
<text text-anchor="middle" x="166819" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="166819" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="166819" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="166819" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert2 -->
<g id="edge1751" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167950.82,-502.85C167709.66,-498.37 167292.02,-480.97 166940,-417.06 166928.38,-414.95 166916.29,-412.14 166904.44,-409.03"/>
<polygon fill="black" stroke="black" points="166905.13,-405.59 166894.56,-406.34 166903.29,-412.34 166905.13,-405.59"/>
</g>
<!-- dp2_pp2_layer15_expert3 -->
<g id="node1070" class="node">
<title>dp2_pp2_layer15_expert3</title>
<polygon fill="lightgreen" stroke="black" points="167173,-406.29 166949,-406.29 166949,-354.29 167173,-354.29 167173,-406.29"/>
<text text-anchor="middle" x="167061" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="167061" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="167061" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="167061" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert3 -->
<g id="edge1752" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167945.36,-497.41C167748.31,-488.25 167442.63,-466.79 167182,-417.06 167170.57,-414.88 167158.67,-412.06 167146.99,-408.97"/>
<polygon fill="black" stroke="black" points="167147.82,-405.57 167137.25,-406.31 167145.98,-412.32 167147.82,-405.57"/>
</g>
<!-- dp2_pp2_layer15_expert4 -->
<g id="node1071" class="node">
<title>dp2_pp2_layer15_expert4</title>
<polygon fill="lightgreen" stroke="black" points="167415,-406.29 167191,-406.29 167191,-354.29 167415,-354.29 167415,-406.29"/>
<text text-anchor="middle" x="167303" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="167303" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="167303" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="167303" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert4 -->
<g id="edge1753" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167936.43,-487.98C167790.99,-474.71 167594.64,-452.25 167424,-417.06 167413.05,-414.8 167401.65,-412.02 167390.43,-409.02"/>
<polygon fill="black" stroke="black" points="167391.19,-405.6 167380.62,-406.33 167389.34,-412.35 167391.19,-405.6"/>
</g>
<!-- dp2_pp2_layer15_expert5 -->
<g id="node1072" class="node">
<title>dp2_pp2_layer15_expert5</title>
<polygon fill="lightgreen" stroke="black" points="167657,-406.29 167433,-406.29 167433,-354.29 167657,-354.29 167657,-406.29"/>
<text text-anchor="middle" x="167545" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="167545" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="167545" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="167545" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert5 -->
<g id="edge1754" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167916.29,-467.38C167836.5,-453.44 167747,-436.25 167666,-417.06 167655.9,-414.67 167645.4,-411.94 167634.99,-409.07"/>
<polygon fill="black" stroke="black" points="167635.62,-405.62 167625.05,-406.3 167633.74,-412.36 167635.62,-405.62"/>
</g>
<!-- dp2_pp2_layer15_expert6 -->
<g id="node1073" class="node">
<title>dp2_pp2_layer15_expert6</title>
<polygon fill="lightgreen" stroke="black" points="167899,-406.29 167675,-406.29 167675,-354.29 167899,-354.29 167899,-406.29"/>
<text text-anchor="middle" x="167787" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="167787" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="167787" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="167787" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert6 -->
<g id="edge1755" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M167998.94,-452.97C167955.16,-438.16 167908.94,-422.53 167870.87,-409.66"/>
<polygon fill="black" stroke="black" points="167871.97,-406.33 167861.38,-406.45 167869.73,-412.97 167871.97,-406.33"/>
</g>
<!-- dp2_pp2_layer15_expert7 -->
<g id="node1074" class="node">
<title>dp2_pp2_layer15_expert7</title>
<polygon fill="lightgreen" stroke="black" points="168141,-406.29 167917,-406.29 167917,-354.29 168141,-354.29 168141,-406.29"/>
<text text-anchor="middle" x="168029" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="168029" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="168029" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="168029" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert7 -->
<g id="edge1756" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168099.38,-452.71C168086.3,-439.43 168072.58,-425.51 168060.76,-413.52"/>
<polygon fill="black" stroke="black" points="168063.19,-411 168053.68,-406.33 168058.2,-415.91 168063.19,-411"/>
</g>
<!-- dp2_pp2_layer15_expert8 -->
<g id="node1075" class="node">
<title>dp2_pp2_layer15_expert8</title>
<polygon fill="lightgreen" stroke="black" points="168383,-406.29 168159,-406.29 168159,-354.29 168383,-354.29 168383,-406.29"/>
<text text-anchor="middle" x="168271" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="168271" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="168271" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="168271" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert8 -->
<g id="edge1757" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168200.61,-452.71C168213.7,-439.43 168227.42,-425.51 168239.23,-413.52"/>
<polygon fill="black" stroke="black" points="168241.79,-415.91 168246.32,-406.33 168236.81,-411 168241.79,-415.91"/>
</g>
<!-- dp2_pp2_layer15_expert9 -->
<g id="node1076" class="node">
<title>dp2_pp2_layer15_expert9</title>
<polygon fill="lightgreen" stroke="black" points="168625,-406.29 168401,-406.29 168401,-354.29 168625,-354.29 168625,-406.29"/>
<text text-anchor="middle" x="168513" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="168513" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="168513" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="168513" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert9 -->
<g id="edge1758" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168297.38,-454.21C168342.29,-439.03 168390.08,-422.86 168429.23,-409.62"/>
<polygon fill="black" stroke="black" points="168430.64,-412.84 168438.99,-406.32 168428.4,-406.21 168430.64,-412.84"/>
</g>
<!-- dp2_pp2_layer15_expert10 -->
<g id="node1077" class="node">
<title>dp2_pp2_layer15_expert10</title>
<polygon fill="lightgreen" stroke="black" points="168867,-406.29 168643,-406.29 168643,-354.29 168867,-354.29 168867,-406.29"/>
<text text-anchor="middle" x="168755" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="168755" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="168755" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="168755" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert10 -->
<g id="edge1759" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168320.89,-478.04C168413.98,-462.69 168530.88,-441.49 168634,-417.06 168644.09,-414.67 168654.6,-411.94 168665.01,-409.07"/>
<polygon fill="black" stroke="black" points="168666.26,-412.36 168674.95,-406.3 168664.37,-405.62 168666.26,-412.36"/>
</g>
<!-- dp2_pp2_layer15_expert11 -->
<g id="node1078" class="node">
<title>dp2_pp2_layer15_expert11</title>
<polygon fill="lightgreen" stroke="black" points="169109,-406.29 168885,-406.29 168885,-354.29 169109,-354.29 169109,-406.29"/>
<text text-anchor="middle" x="168997" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="168997" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="168997" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="168997" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert11 -->
<g id="edge1760" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168332.99,-490.7C168480.62,-477.88 168693.08,-454.78 168876,-417.06 168886.95,-414.8 168898.35,-412.02 168909.57,-409.02"/>
<polygon fill="black" stroke="black" points="168910.66,-412.35 168919.38,-406.33 168908.81,-405.6 168910.66,-412.35"/>
</g>
<!-- dp2_pp2_layer15_expert12 -->
<g id="node1079" class="node">
<title>dp2_pp2_layer15_expert12</title>
<polygon fill="lightgreen" stroke="black" points="169351,-406.29 169127,-406.29 169127,-354.29 169351,-354.29 169351,-406.29"/>
<text text-anchor="middle" x="169239" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="169239" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="169239" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="169239" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert12 -->
<g id="edge1761" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168340.27,-498.07C168536.59,-489.29 168850.95,-468.01 169118,-417.06 169129.43,-414.88 169141.33,-412.06 169153.01,-408.97"/>
<polygon fill="black" stroke="black" points="169154.02,-412.32 169162.75,-406.31 169152.18,-405.57 169154.02,-412.32"/>
</g>
<!-- dp2_pp2_layer15_expert13 -->
<g id="node1080" class="node">
<title>dp2_pp2_layer15_expert13</title>
<polygon fill="lightgreen" stroke="black" points="169593,-406.29 169369,-406.29 169369,-354.29 169593,-354.29 169593,-406.29"/>
<text text-anchor="middle" x="169481" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="169481" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="169481" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="169481" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert13 -->
<g id="edge1762" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168344.93,-502.93C168585.42,-498.58 169005.9,-481.35 169360,-417.06 169371.62,-414.95 169383.71,-412.14 169395.56,-409.03"/>
<polygon fill="black" stroke="black" points="169396.7,-412.34 169405.44,-406.34 169394.87,-405.59 169396.7,-412.34"/>
</g>
<!-- dp2_pp2_layer15_expert14 -->
<g id="node1081" class="node">
<title>dp2_pp2_layer15_expert14</title>
<polygon fill="lightgreen" stroke="black" points="169835,-406.29 169611,-406.29 169611,-354.29 169835,-354.29 169835,-406.29"/>
<text text-anchor="middle" x="169723" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="169723" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="169723" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="169723" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert14 -->
<g id="edge1763" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168340.32,-498.04C168677.17,-486.48 169365.15,-458.6 169602,-417.06 169613.92,-414.97 169626.32,-412.12 169638.46,-408.93"/>
<polygon fill="black" stroke="black" points="169639.38,-412.3 169648.11,-406.3 169637.54,-405.55 169639.38,-412.3"/>
</g>
<!-- dp2_pp2_layer15_expert15 -->
<g id="node1082" class="node">
<title>dp2_pp2_layer15_expert15</title>
<polygon fill="lightgreen" stroke="black" points="170077,-406.29 169853,-406.29 169853,-354.29 170077,-354.29 170077,-406.29"/>
<text text-anchor="middle" x="169965" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="169965" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="169965" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="169965" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert15 -->
<g id="edge1764" class="edge">
<title>dp2_pp2_layer15_router&#45;&gt;dp2_pp2_layer15_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M168341.94,-499.9C168722.49,-490.72 169560.35,-465.57 169844,-417.06 169856.01,-415.01 169868.51,-412.16 169880.73,-408.95"/>
<polygon fill="black" stroke="black" points="169881.72,-412.31 169890.45,-406.32 169879.88,-405.56 169881.72,-412.31"/>
</g>
<!-- dp2_pp2_layer15_expert_agg -->
<g id="node1083" class="node">
<title>dp2_pp2_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="168397.57,-307.52 168003.74,-307.52 167902.43,-203.52 168296.26,-203.52 168397.57,-307.52"/>
<text text-anchor="middle" x="168150" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="168150" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="168150" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="168150" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer15_expert0&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1765" class="edge">
<title>dp2_pp2_layer15_expert0&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M166393.07,-354.29C166412.69,-346.92 166434.97,-339.72 166456,-335.52 166735.13,-279.86 167558.93,-263.21 167945.43,-258.4"/>
<polygon fill="black" stroke="black" points="167945.65,-261.9 167955.61,-258.27 167945.57,-254.9 167945.65,-261.9"/>
</g>
<!-- dp2_pp2_layer15_expert1&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1766" class="edge">
<title>dp2_pp2_layer15_expert1&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M166635.39,-354.27C166654.95,-346.95 166677.09,-339.78 166698,-335.52 166930.8,-288.16 167606.09,-267.74 167947.43,-260.24"/>
<polygon fill="black" stroke="black" points="167947.51,-263.74 167957.43,-260.03 167947.35,-256.74 167947.51,-263.74"/>
</g>
<!-- dp2_pp2_layer15_expert2&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1767" class="edge">
<title>dp2_pp2_layer15_expert2&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M166877.73,-354.29C166897.21,-347.01 166919.23,-339.87 166940,-335.52 167126.91,-296.44 167656.54,-273.07 167949.3,-262.78"/>
<polygon fill="black" stroke="black" points="167949.74,-266.27 167959.61,-262.42 167949.5,-259.27 167949.74,-266.27"/>
</g>
<!-- dp2_pp2_layer15_expert3&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1768" class="edge">
<title>dp2_pp2_layer15_expert3&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M167120.39,-354.26C167139.72,-347.07 167161.48,-339.99 167182,-335.52 167440.91,-279.18 167746.7,-262.24 167944.26,-257.56"/>
<polygon fill="black" stroke="black" points="167944.55,-261.06 167954.47,-257.33 167944.39,-254.06 167944.55,-261.06"/>
</g>
<!-- dp2_pp2_layer15_expert4&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1769" class="edge">
<title>dp2_pp2_layer15_expert4&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M167363.39,-354.24C167382.49,-347.2 167403.87,-340.19 167424,-335.52 167599.82,-294.77 167804.6,-274.91 167951.75,-265.31"/>
<polygon fill="black" stroke="black" points="167952.05,-268.8 167961.81,-264.67 167951.6,-261.82 167952.05,-268.8"/>
</g>
<!-- dp2_pp2_layer15_expert5&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1770" class="edge">
<title>dp2_pp2_layer15_expert5&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M167607.42,-354.22C167626.04,-347.42 167646.65,-340.55 167666,-335.52 167763.09,-310.27 167873.34,-291.53 167964.07,-278.65"/>
<polygon fill="black" stroke="black" points="167964.78,-282.09 167974.19,-277.23 167963.8,-275.16 167964.78,-282.09"/>
</g>
<!-- dp2_pp2_layer15_expert6&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1771" class="edge">
<title>dp2_pp2_layer15_expert6&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M167855.02,-354.26C167872.26,-348.03 167890.78,-341.44 167908,-335.52 167934.73,-326.33 167963.21,-316.8 167990.89,-307.67"/>
<polygon fill="black" stroke="black" points="167992.24,-310.91 168000.65,-304.46 167990.06,-304.26 167992.24,-310.91"/>
</g>
<!-- dp2_pp2_layer15_expert7&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1772" class="edge">
<title>dp2_pp2_layer15_expert7&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M168053.78,-354.15C168065.02,-342.74 168078.83,-328.73 168092.45,-314.92"/>
<polygon fill="black" stroke="black" points="168095,-317.31 168099.53,-307.73 168090.02,-312.39 168095,-317.31"/>
</g>
<!-- dp2_pp2_layer15_expert8&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1773" class="edge">
<title>dp2_pp2_layer15_expert8&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M168246.22,-354.15C168234.97,-342.74 168221.16,-328.73 168207.55,-314.92"/>
<polygon fill="black" stroke="black" points="168209.98,-312.39 168200.47,-307.73 168204.99,-317.31 168209.98,-312.39"/>
</g>
<!-- dp2_pp2_layer15_expert9&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1774" class="edge">
<title>dp2_pp2_layer15_expert9&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M168444.98,-354.26C168427.73,-348.03 168409.21,-341.44 168392,-335.52 168368.29,-327.37 168343.21,-318.95 168318.53,-310.78"/>
<polygon fill="black" stroke="black" points="168319.32,-307.36 168308.73,-307.54 168317.12,-314 168319.32,-307.36"/>
</g>
<!-- dp2_pp2_layer15_expert10&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1775" class="edge">
<title>dp2_pp2_layer15_expert10&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M168692.58,-354.22C168673.96,-347.42 168653.35,-340.55 168634,-335.52 168553.99,-314.71 168465.05,-298.33 168385.46,-286"/>
<polygon fill="black" stroke="black" points="168385.71,-282.5 168375.3,-284.44 168384.65,-289.41 168385.71,-282.5"/>
</g>
<!-- dp2_pp2_layer15_expert11&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1776" class="edge">
<title>dp2_pp2_layer15_expert11&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M168936.61,-354.24C168917.51,-347.2 168896.13,-340.19 168876,-335.52 168707.74,-296.53 168512.97,-276.66 168367.55,-266.61"/>
<polygon fill="black" stroke="black" points="168367.38,-263.09 168357.16,-265.9 168366.9,-270.07 168367.38,-263.09"/>
</g>
<!-- dp2_pp2_layer15_expert12&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1777" class="edge">
<title>dp2_pp2_layer15_expert12&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M169179.61,-354.26C169160.28,-347.07 169138.52,-339.99 169118,-335.52 168860.51,-279.49 168556.64,-262.43 168358.99,-257.64"/>
<polygon fill="black" stroke="black" points="168358.86,-254.14 168348.78,-257.4 168358.69,-261.13 168358.86,-254.14"/>
</g>
<!-- dp2_pp2_layer15_expert13&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1778" class="edge">
<title>dp2_pp2_layer15_expert13&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M169422.27,-354.29C169402.79,-347.01 169380.77,-339.87 169360,-335.52 169176.02,-297.05 168659.97,-273.81 168364.63,-263.27"/>
<polygon fill="black" stroke="black" points="168364.33,-259.76 168354.21,-262.9 168364.08,-266.76 168364.33,-259.76"/>
</g>
<!-- dp2_pp2_layer15_expert14&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1779" class="edge">
<title>dp2_pp2_layer15_expert14&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M169664.6,-354.27C169645.05,-346.95 169622.9,-339.78 169602,-335.52 169371.27,-288.58 168705.86,-268.1 168361.74,-260.45"/>
<polygon fill="black" stroke="black" points="168361.73,-256.94 168351.65,-260.22 168361.57,-263.94 168361.73,-256.94"/>
</g>
<!-- dp2_pp2_layer15_expert15&#45;&gt;dp2_pp2_layer15_expert_agg -->
<g id="edge1780" class="edge">
<title>dp2_pp2_layer15_expert15&#45;&gt;dp2_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M169906.93,-354.29C169887.3,-346.92 169865.03,-339.72 169844,-335.52 169566.21,-280.12 168748.98,-263.37 168360.17,-258.47"/>
<polygon fill="black" stroke="black" points="168359.97,-254.97 168349.93,-258.34 168359.88,-261.97 168359.97,-254.97"/>
</g>
<!-- dp2_pp2_layer16_attn_tp0 -->
<g id="node1084" class="node">
<title>dp2_pp2_layer16_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="165632.5,-531.06 165367.5,-531.06 165367.5,-479.06 165632.5,-479.06 165632.5,-531.06"/>
<text text-anchor="middle" x="165500" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="165500" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="165500" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="165500" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer15_expert_agg&#45;&gt;dp2_pp2_layer16_attn_tp0 -->
<g id="edge1782" class="edge">
<title>dp2_pp2_layer15_expert_agg&#45;&gt;dp2_pp2_layer16_attn_tp0</title>
<path fill="none" stroke="black" d="M167957.78,-260.41C167537.38,-269.54 166547.17,-294.77 166214,-335.52 166181.8,-339.46 165673.23,-444.29 165642,-453.06 165619.37,-459.41 165595.16,-467.58 165573.26,-475.5"/>
<polygon fill="black" stroke="black" points="165571.89,-472.28 165563.7,-479 165574.29,-478.85 165571.89,-472.28"/>
</g>
<!-- dp2_pp2_layer16_attn_allreduce -->
<g id="node1085" class="node">
<title>dp2_pp2_layer16_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="165629" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="165629" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="165629" y="-383.29" font-family="Arial" font-size="10.00">GPUs 80&#45;83</text>
<text text-anchor="middle" x="165629" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="165629" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_attn_tp0&#45;&gt;dp2_pp2_layer16_attn_allreduce -->
<g id="edge1783" class="edge">
<title>dp2_pp2_layer16_attn_tp0&#45;&gt;dp2_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M165526.41,-478.92C165543.15,-463 165565.21,-442 165584.58,-423.56"/>
<polygon fill="black" stroke="black" points="165587.03,-426.07 165591.86,-416.64 165582.2,-421 165587.03,-426.07"/>
</g>
<!-- dp2_pp2_layer16_router -->
<g id="node1089" class="node">
<title>dp2_pp2_layer16_router</title>
<polygon fill="lightyellow" stroke="black" points="163380.57,-557.06 162986.74,-557.06 162885.43,-453.06 163279.26,-453.06 163380.57,-557.06"/>
<text text-anchor="middle" x="163133" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="163133" y="-508.06" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="163133" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="163133" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_attn_allreduce&#45;&gt;dp2_pp2_layer16_router -->
<g id="edge1819" class="edge">
<title>dp2_pp2_layer16_attn_allreduce&#45;&gt;dp2_pp2_layer16_router</title>
<path fill="none" stroke="black" d="M165469.08,-392.38C165357.77,-399.9 165205.89,-409.76 165072,-417.06 164436.5,-451.72 163683.28,-482.59 163331.96,-496.4"/>
<polygon fill="black" stroke="black" points="163331.8,-492.91 163321.94,-496.79 163332.07,-499.9 163331.8,-492.91"/>
</g>
<!-- dp2_pp2_layer16_attn_tp1 -->
<g id="node1086" class="node">
<title>dp2_pp2_layer16_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="165915.5,-531.06 165650.5,-531.06 165650.5,-479.06 165915.5,-479.06 165915.5,-531.06"/>
<text text-anchor="middle" x="165783" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="165783" y="-508.06" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="165783" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="165783" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer16_attn_tp1&#45;&gt;dp2_pp2_layer16_attn_allreduce -->
<g id="edge1784" class="edge">
<title>dp2_pp2_layer16_attn_tp1&#45;&gt;dp2_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M165751.46,-478.92C165730.99,-462.6 165703.83,-440.94 165680.29,-422.18"/>
<polygon fill="black" stroke="black" points="165682.46,-419.44 165672.46,-415.94 165678.1,-424.91 165682.46,-419.44"/>
</g>
<!-- dp2_pp2_layer16_attn_tp2 -->
<g id="node1087" class="node">
<title>dp2_pp2_layer16_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="165349.5,-531.06 165084.5,-531.06 165084.5,-479.06 165349.5,-479.06 165349.5,-531.06"/>
<text text-anchor="middle" x="165217" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="165217" y="-508.06" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="165217" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="165217" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer16_attn_tp2&#45;&gt;dp2_pp2_layer16_attn_allreduce -->
<g id="edge1785" class="edge">
<title>dp2_pp2_layer16_attn_tp2&#45;&gt;dp2_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M165283.07,-479.02C165306.85,-470.35 165333.99,-460.86 165359,-453.06 165407.74,-437.86 165462.05,-423.03 165509.1,-410.83"/>
<polygon fill="black" stroke="black" points="165510.22,-414.15 165519.03,-408.26 165508.47,-407.38 165510.22,-414.15"/>
</g>
<!-- dp2_pp2_layer16_attn_tp3 -->
<g id="node1088" class="node">
<title>dp2_pp2_layer16_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="166198.5,-531.06 165933.5,-531.06 165933.5,-479.06 166198.5,-479.06 166198.5,-531.06"/>
<text text-anchor="middle" x="166066" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="166066" y="-508.06" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="166066" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="166066" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp2_pp2_layer16_attn_tp3&#45;&gt;dp2_pp2_layer16_attn_allreduce -->
<g id="edge1786" class="edge">
<title>dp2_pp2_layer16_attn_tp3&#45;&gt;dp2_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M166001.21,-478.95C165977.43,-470.18 165950.17,-460.64 165925,-453.06 165870.42,-436.63 165809.31,-421.31 165756.86,-409.08"/>
<polygon fill="black" stroke="black" points="165757.37,-405.6 165746.83,-406.75 165755.78,-412.42 165757.37,-405.6"/>
</g>
<!-- dp2_pp2_layer16_expert0 -->
<g id="node1090" class="node">
<title>dp2_pp2_layer16_expert0</title>
<polygon fill="lightgreen" stroke="black" points="161430,-406.29 161206,-406.29 161206,-354.29 161430,-354.29 161430,-406.29"/>
<text text-anchor="middle" x="161318" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="161318" y="-383.29" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="161318" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="161318" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert0 -->
<g id="edge1787" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162930.73,-499.65C162545.55,-490.26 161720.11,-465.13 161439,-417.06 161426.99,-415.01 161414.48,-412.16 161402.27,-408.95"/>
<polygon fill="black" stroke="black" points="161403.11,-405.56 161392.54,-406.32 161401.28,-412.31 161403.11,-405.56"/>
</g>
<!-- dp2_pp2_layer16_expert1 -->
<g id="node1091" class="node">
<title>dp2_pp2_layer16_expert1</title>
<polygon fill="lightgreen" stroke="black" points="161672,-406.29 161448,-406.29 161448,-354.29 161672,-354.29 161672,-406.29"/>
<text text-anchor="middle" x="161560" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="161560" y="-383.29" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="161560" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="161560" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert1 -->
<g id="edge1788" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162928.55,-497.55C162586.94,-485.71 161914.58,-458.03 161681,-417.06 161669.08,-414.97 161656.67,-412.12 161644.54,-408.93"/>
<polygon fill="black" stroke="black" points="161645.45,-405.55 161634.89,-406.3 161643.62,-412.3 161645.45,-405.55"/>
</g>
<!-- dp2_pp2_layer16_expert2 -->
<g id="node1092" class="node">
<title>dp2_pp2_layer16_expert2</title>
<polygon fill="lightgreen" stroke="black" points="161914,-406.29 161690,-406.29 161690,-354.29 161914,-354.29 161914,-406.29"/>
<text text-anchor="middle" x="161802" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="161802" y="-383.29" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="161802" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="161802" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert2 -->
<g id="edge1789" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162933.82,-502.85C162692.66,-498.37 162275.02,-480.97 161923,-417.06 161911.38,-414.95 161899.29,-412.14 161887.44,-409.03"/>
<polygon fill="black" stroke="black" points="161888.13,-405.59 161877.56,-406.34 161886.29,-412.34 161888.13,-405.59"/>
</g>
<!-- dp2_pp2_layer16_expert3 -->
<g id="node1093" class="node">
<title>dp2_pp2_layer16_expert3</title>
<polygon fill="lightgreen" stroke="black" points="162156,-406.29 161932,-406.29 161932,-354.29 162156,-354.29 162156,-406.29"/>
<text text-anchor="middle" x="162044" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="162044" y="-383.29" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="162044" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="162044" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert3 -->
<g id="edge1790" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162928.36,-497.41C162731.31,-488.25 162425.63,-466.79 162165,-417.06 162153.57,-414.88 162141.67,-412.06 162129.99,-408.97"/>
<polygon fill="black" stroke="black" points="162130.82,-405.57 162120.25,-406.31 162128.98,-412.32 162130.82,-405.57"/>
</g>
<!-- dp2_pp2_layer16_expert4 -->
<g id="node1094" class="node">
<title>dp2_pp2_layer16_expert4</title>
<polygon fill="lightgreen" stroke="black" points="162398,-406.29 162174,-406.29 162174,-354.29 162398,-354.29 162398,-406.29"/>
<text text-anchor="middle" x="162286" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="162286" y="-383.29" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="162286" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="162286" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert4 -->
<g id="edge1791" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162919.43,-487.98C162773.99,-474.71 162577.64,-452.25 162407,-417.06 162396.05,-414.8 162384.65,-412.02 162373.43,-409.02"/>
<polygon fill="black" stroke="black" points="162374.19,-405.6 162363.62,-406.33 162372.34,-412.35 162374.19,-405.6"/>
</g>
<!-- dp2_pp2_layer16_expert5 -->
<g id="node1095" class="node">
<title>dp2_pp2_layer16_expert5</title>
<polygon fill="lightgreen" stroke="black" points="162640,-406.29 162416,-406.29 162416,-354.29 162640,-354.29 162640,-406.29"/>
<text text-anchor="middle" x="162528" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="162528" y="-383.29" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="162528" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="162528" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert5 -->
<g id="edge1792" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162899.29,-467.38C162819.5,-453.44 162730,-436.25 162649,-417.06 162638.9,-414.67 162628.4,-411.94 162617.99,-409.07"/>
<polygon fill="black" stroke="black" points="162618.62,-405.62 162608.05,-406.3 162616.74,-412.36 162618.62,-405.62"/>
</g>
<!-- dp2_pp2_layer16_expert6 -->
<g id="node1096" class="node">
<title>dp2_pp2_layer16_expert6</title>
<polygon fill="lightgreen" stroke="black" points="162882,-406.29 162658,-406.29 162658,-354.29 162882,-354.29 162882,-406.29"/>
<text text-anchor="middle" x="162770" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="162770" y="-383.29" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="162770" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="162770" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert6 -->
<g id="edge1793" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162981.94,-452.97C162938.16,-438.16 162891.94,-422.53 162853.87,-409.66"/>
<polygon fill="black" stroke="black" points="162854.97,-406.33 162844.38,-406.45 162852.73,-412.97 162854.97,-406.33"/>
</g>
<!-- dp2_pp2_layer16_expert7 -->
<g id="node1097" class="node">
<title>dp2_pp2_layer16_expert7</title>
<polygon fill="lightgreen" stroke="black" points="163124,-406.29 162900,-406.29 162900,-354.29 163124,-354.29 163124,-406.29"/>
<text text-anchor="middle" x="163012" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="163012" y="-383.29" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="163012" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="163012" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert7 -->
<g id="edge1794" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163082.38,-452.71C163069.3,-439.43 163055.58,-425.51 163043.76,-413.52"/>
<polygon fill="black" stroke="black" points="163046.19,-411 163036.68,-406.33 163041.2,-415.91 163046.19,-411"/>
</g>
<!-- dp2_pp2_layer16_expert8 -->
<g id="node1098" class="node">
<title>dp2_pp2_layer16_expert8</title>
<polygon fill="lightgreen" stroke="black" points="163366,-406.29 163142,-406.29 163142,-354.29 163366,-354.29 163366,-406.29"/>
<text text-anchor="middle" x="163254" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="163254" y="-383.29" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="163254" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="163254" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert8 -->
<g id="edge1795" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163183.61,-452.71C163196.7,-439.43 163210.42,-425.51 163222.23,-413.52"/>
<polygon fill="black" stroke="black" points="163224.79,-415.91 163229.32,-406.33 163219.81,-411 163224.79,-415.91"/>
</g>
<!-- dp2_pp2_layer16_expert9 -->
<g id="node1099" class="node">
<title>dp2_pp2_layer16_expert9</title>
<polygon fill="lightgreen" stroke="black" points="163608,-406.29 163384,-406.29 163384,-354.29 163608,-354.29 163608,-406.29"/>
<text text-anchor="middle" x="163496" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="163496" y="-383.29" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="163496" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="163496" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert9 -->
<g id="edge1796" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163280.38,-454.21C163325.29,-439.03 163373.08,-422.86 163412.23,-409.62"/>
<polygon fill="black" stroke="black" points="163413.64,-412.84 163421.99,-406.32 163411.4,-406.21 163413.64,-412.84"/>
</g>
<!-- dp2_pp2_layer16_expert10 -->
<g id="node1100" class="node">
<title>dp2_pp2_layer16_expert10</title>
<polygon fill="lightgreen" stroke="black" points="163850,-406.29 163626,-406.29 163626,-354.29 163850,-354.29 163850,-406.29"/>
<text text-anchor="middle" x="163738" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="163738" y="-383.29" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="163738" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="163738" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert10 -->
<g id="edge1797" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163303.89,-478.04C163396.98,-462.69 163513.88,-441.49 163617,-417.06 163627.09,-414.67 163637.6,-411.94 163648.01,-409.07"/>
<polygon fill="black" stroke="black" points="163649.26,-412.36 163657.95,-406.3 163647.37,-405.62 163649.26,-412.36"/>
</g>
<!-- dp2_pp2_layer16_expert11 -->
<g id="node1101" class="node">
<title>dp2_pp2_layer16_expert11</title>
<polygon fill="lightgreen" stroke="black" points="164092,-406.29 163868,-406.29 163868,-354.29 164092,-354.29 164092,-406.29"/>
<text text-anchor="middle" x="163980" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="163980" y="-383.29" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="163980" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="163980" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert11 -->
<g id="edge1798" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163315.99,-490.7C163463.62,-477.88 163676.08,-454.78 163859,-417.06 163869.95,-414.8 163881.35,-412.02 163892.57,-409.02"/>
<polygon fill="black" stroke="black" points="163893.66,-412.35 163902.38,-406.33 163891.81,-405.6 163893.66,-412.35"/>
</g>
<!-- dp2_pp2_layer16_expert12 -->
<g id="node1102" class="node">
<title>dp2_pp2_layer16_expert12</title>
<polygon fill="lightgreen" stroke="black" points="164334,-406.29 164110,-406.29 164110,-354.29 164334,-354.29 164334,-406.29"/>
<text text-anchor="middle" x="164222" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="164222" y="-383.29" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="164222" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="164222" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert12 -->
<g id="edge1799" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163323.27,-498.07C163519.59,-489.29 163833.95,-468.01 164101,-417.06 164112.43,-414.88 164124.33,-412.06 164136.01,-408.97"/>
<polygon fill="black" stroke="black" points="164137.02,-412.32 164145.75,-406.31 164135.18,-405.57 164137.02,-412.32"/>
</g>
<!-- dp2_pp2_layer16_expert13 -->
<g id="node1103" class="node">
<title>dp2_pp2_layer16_expert13</title>
<polygon fill="lightgreen" stroke="black" points="164576,-406.29 164352,-406.29 164352,-354.29 164576,-354.29 164576,-406.29"/>
<text text-anchor="middle" x="164464" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="164464" y="-383.29" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="164464" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="164464" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert13 -->
<g id="edge1800" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163327.93,-502.93C163568.42,-498.58 163988.9,-481.35 164343,-417.06 164354.62,-414.95 164366.71,-412.14 164378.56,-409.03"/>
<polygon fill="black" stroke="black" points="164379.7,-412.34 164388.44,-406.34 164377.87,-405.59 164379.7,-412.34"/>
</g>
<!-- dp2_pp2_layer16_expert14 -->
<g id="node1104" class="node">
<title>dp2_pp2_layer16_expert14</title>
<polygon fill="lightgreen" stroke="black" points="164818,-406.29 164594,-406.29 164594,-354.29 164818,-354.29 164818,-406.29"/>
<text text-anchor="middle" x="164706" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="164706" y="-383.29" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="164706" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="164706" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert14 -->
<g id="edge1801" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163323.32,-498.04C163660.17,-486.48 164348.15,-458.6 164585,-417.06 164596.92,-414.97 164609.32,-412.12 164621.46,-408.93"/>
<polygon fill="black" stroke="black" points="164622.38,-412.3 164631.11,-406.3 164620.54,-405.55 164622.38,-412.3"/>
</g>
<!-- dp2_pp2_layer16_expert15 -->
<g id="node1105" class="node">
<title>dp2_pp2_layer16_expert15</title>
<polygon fill="lightgreen" stroke="black" points="165060,-406.29 164836,-406.29 164836,-354.29 165060,-354.29 165060,-406.29"/>
<text text-anchor="middle" x="164948" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="164948" y="-383.29" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="164948" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="164948" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert15 -->
<g id="edge1802" class="edge">
<title>dp2_pp2_layer16_router&#45;&gt;dp2_pp2_layer16_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M163324.94,-499.9C163705.49,-490.72 164543.35,-465.57 164827,-417.06 164839.01,-415.01 164851.51,-412.16 164863.73,-408.95"/>
<polygon fill="black" stroke="black" points="164864.72,-412.31 164873.45,-406.32 164862.88,-405.56 164864.72,-412.31"/>
</g>
<!-- dp2_pp2_layer16_expert_agg -->
<g id="node1106" class="node">
<title>dp2_pp2_layer16_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="163259.57,-307.52 162865.74,-307.52 162764.43,-203.52 163158.26,-203.52 163259.57,-307.52"/>
<text text-anchor="middle" x="163012" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="163012" y="-258.52" font-family="Arial" font-size="10.00">GPUs 80&#45;95</text>
<text text-anchor="middle" x="163012" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="163012" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_expert0&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1803" class="edge">
<title>dp2_pp2_layer16_expert0&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M161376.38,-354.21C161395.94,-346.89 161418.08,-339.73 161439,-335.52 161694.86,-284.02 162443.83,-265.4 162808.21,-259.26"/>
<polygon fill="black" stroke="black" points="162808.4,-262.76 162818.34,-259.09 162808.28,-255.76 162808.4,-262.76"/>
</g>
<!-- dp2_pp2_layer16_expert1&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1804" class="edge">
<title>dp2_pp2_layer16_expert1&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M161618.71,-354.21C161638.19,-346.94 161660.21,-339.8 161681,-335.52 161890.71,-292.32 162492.36,-270.3 162810,-261.41"/>
<polygon fill="black" stroke="black" points="162810.34,-264.9 162820.24,-261.13 162810.15,-257.91 162810.34,-264.9"/>
</g>
<!-- dp2_pp2_layer16_expert2&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1805" class="edge">
<title>dp2_pp2_layer16_expert2&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M161861.05,-354.26C161880.46,-347.03 161902.35,-339.92 161923,-335.52 162087.34,-300.54 162546.32,-276.12 162813.04,-264.41"/>
<polygon fill="black" stroke="black" points="162813.4,-267.9 162823.24,-263.97 162813.09,-260.91 162813.4,-267.9"/>
</g>
<!-- dp2_pp2_layer16_expert3&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1806" class="edge">
<title>dp2_pp2_layer16_expert3&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M162103.73,-354.28C162122.98,-347.15 162144.62,-340.08 162165,-335.52 162381.91,-287.01 162636.52,-268.23 162809.54,-261"/>
<polygon fill="black" stroke="black" points="162809.93,-264.48 162819.78,-260.58 162809.64,-257.49 162809.93,-264.48"/>
</g>
<!-- dp2_pp2_layer16_expert4&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1807" class="edge">
<title>dp2_pp2_layer16_expert4&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M162347.07,-354.28C162366.02,-347.32 162387.14,-340.35 162407,-335.52 162542.78,-302.51 162699.27,-282.55 162819.08,-270.95"/>
<polygon fill="black" stroke="black" points="162819.47,-274.42 162829.09,-269.99 162818.8,-267.46 162819.47,-274.42"/>
</g>
<!-- dp2_pp2_layer16_expert5&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1808" class="edge">
<title>dp2_pp2_layer16_expert5&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M162592.16,-354.29C162610.37,-347.69 162630.32,-340.91 162649,-335.52 162709.46,-318.09 162776.57,-302.47 162836.47,-289.81"/>
<polygon fill="black" stroke="black" points="162837.33,-293.21 162846.4,-287.73 162835.9,-286.36 162837.33,-293.21"/>
</g>
<!-- dp2_pp2_layer16_expert6&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1809" class="edge">
<title>dp2_pp2_layer16_expert6&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M162819.55,-354.15C162843.49,-342.01 162873.24,-326.92 162902.13,-312.26"/>
<polygon fill="black" stroke="black" points="162903.73,-315.37 162911.06,-307.73 162900.56,-309.13 162903.73,-315.37"/>
</g>
<!-- dp2_pp2_layer16_expert7&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1810" class="edge">
<title>dp2_pp2_layer16_expert7&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M163012,-354.15C163012,-343.58 163012,-330.77 163012,-317.96"/>
<polygon fill="black" stroke="black" points="163015.5,-317.73 163012,-307.73 163008.5,-317.73 163015.5,-317.73"/>
</g>
<!-- dp2_pp2_layer16_expert8&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1811" class="edge">
<title>dp2_pp2_layer16_expert8&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M163204.44,-354.15C163180.51,-342.01 163150.76,-326.92 163121.87,-312.26"/>
<polygon fill="black" stroke="black" points="163123.44,-309.13 163112.93,-307.73 163120.27,-315.37 163123.44,-309.13"/>
</g>
<!-- dp2_pp2_layer16_expert9&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1812" class="edge">
<title>dp2_pp2_layer16_expert9&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M163431.84,-354.29C163413.63,-347.69 163393.67,-340.91 163375,-335.52 163340.59,-325.6 163304.02,-316.27 163267.86,-307.73"/>
<polygon fill="black" stroke="black" points="163268.21,-304.22 163257.68,-305.35 163266.61,-311.03 163268.21,-304.22"/>
</g>
<!-- dp2_pp2_layer16_expert10&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1813" class="edge">
<title>dp2_pp2_layer16_expert10&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M163676.93,-354.28C163657.98,-347.32 163636.86,-340.35 163617,-335.52 163492.73,-305.31 163351.11,-286.03 163236.15,-274.08"/>
<polygon fill="black" stroke="black" points="163236.47,-270.6 163226.17,-273.05 163235.76,-277.56 163236.47,-270.6"/>
</g>
<!-- dp2_pp2_layer16_expert11&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1814" class="edge">
<title>dp2_pp2_layer16_expert11&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M163920.27,-354.28C163901.02,-347.15 163879.38,-340.08 163859,-335.52 163646.33,-287.95 163397.41,-268.98 163224.7,-261.43"/>
<polygon fill="black" stroke="black" points="163224.61,-257.93 163214.47,-261 163224.31,-264.92 163224.61,-257.93"/>
</g>
<!-- dp2_pp2_layer16_expert12&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1815" class="edge">
<title>dp2_pp2_layer16_expert12&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M164162.94,-354.26C164143.54,-347.03 164121.65,-339.92 164101,-335.52 163940.14,-301.28 163497.03,-277.16 163228.2,-265.18"/>
<polygon fill="black" stroke="black" points="163228.06,-261.67 163217.92,-264.72 163227.75,-268.66 163228.06,-261.67"/>
</g>
<!-- dp2_pp2_layer16_expert13&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1816" class="edge">
<title>dp2_pp2_layer16_expert13&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M164405.28,-354.21C164385.81,-346.94 164363.78,-339.8 164343,-335.52 164135.74,-292.82 163545.66,-270.82 163225.26,-261.73"/>
<polygon fill="black" stroke="black" points="163225.02,-258.22 163214.92,-261.44 163224.82,-265.22 163225.02,-258.22"/>
</g>
<!-- dp2_pp2_layer16_expert14&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1817" class="edge">
<title>dp2_pp2_layer16_expert14&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M164647.61,-354.21C164628.06,-346.89 164605.91,-339.73 164585,-335.52 164330.8,-284.35 163589.86,-265.64 163222.93,-259.38"/>
<polygon fill="black" stroke="black" points="163222.78,-255.88 163212.72,-259.21 163222.66,-262.88 163222.78,-255.88"/>
</g>
<!-- dp2_pp2_layer16_expert15&#45;&gt;dp2_pp2_layer16_expert_agg -->
<g id="edge1818" class="edge">
<title>dp2_pp2_layer16_expert15&#45;&gt;dp2_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M164889.94,-354.25C164870.31,-346.88 164848.04,-339.68 164827,-335.52 164525.53,-275.89 163631.35,-261.27 163221.49,-257.68"/>
<polygon fill="black" stroke="black" points="163221.33,-254.18 163211.3,-257.6 163221.27,-261.18 163221.33,-254.18"/>
</g>
<!-- output_dp2 -->
<g id="node1481" class="node">
<title>output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="143217" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="143217" y="-144.75" font-family="Arial" font-size="10.00">Output DP2</text>
<text text-anchor="middle" x="143217" y="-133.75" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="143217" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="143217" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp2_pp2_layer16_expert_agg&#45;&gt;output_dp2 -->
<g id="edge2436" class="edge">
<title>dp2_pp2_layer16_expert_agg&#45;&gt;output_dp2</title>
<path fill="none" stroke="black" d="M162803.05,-243.38C162462.7,-225.81 161767.4,-192.35 161178,-179.52 159307.26,-138.8 145154.58,-132.45 143396.12,-131.81"/>
<polygon fill="black" stroke="black" points="143395.94,-128.31 143385.94,-131.81 143395.94,-135.31 143395.94,-128.31"/>
</g>
<!-- dp3_pp1_layer1_attn_tp0 -->
<g id="node1107" class="node">
<title>dp3_pp1_layer1_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="321243.5,-531.06 320978.5,-531.06 320978.5,-479.06 321243.5,-479.06 321243.5,-531.06"/>
<text text-anchor="middle" x="321111" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="321111" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="321111" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="321111" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer1_attn_allreduce -->
<g id="node1108" class="node">
<title>dp3_pp1_layer1_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="321252" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="321252" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="321252" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="321252" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="321252" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_attn_tp0&#45;&gt;dp3_pp1_layer1_attn_allreduce -->
<g id="edge1820" class="edge">
<title>dp3_pp1_layer1_attn_tp0&#45;&gt;dp3_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M321139.87,-478.92C321158.39,-462.8 321182.87,-441.49 321204.23,-422.89"/>
<polygon fill="black" stroke="black" points="321206.7,-425.38 321211.94,-416.17 321202.1,-420.1 321206.7,-425.38"/>
</g>
<!-- dp3_pp1_layer1_router -->
<g id="node1112" class="node">
<title>dp3_pp1_layer1_router</title>
<polygon fill="lightyellow" stroke="black" points="318991.57,-557.06 318597.74,-557.06 318496.43,-453.06 318890.26,-453.06 318991.57,-557.06"/>
<text text-anchor="middle" x="318744" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="318744" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="318744" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="318744" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_attn_allreduce&#45;&gt;dp3_pp1_layer1_router -->
<g id="edge1856" class="edge">
<title>dp3_pp1_layer1_attn_allreduce&#45;&gt;dp3_pp1_layer1_router</title>
<path fill="none" stroke="black" d="M321091.7,-392.14C320977.73,-399.66 320821,-409.63 320683,-417.06 320047.48,-451.29 319294.27,-482.37 318942.96,-496.31"/>
<polygon fill="black" stroke="black" points="318942.79,-492.82 318932.94,-496.71 318943.07,-499.81 318942.79,-492.82"/>
</g>
<!-- dp3_pp1_layer1_attn_tp1 -->
<g id="node1109" class="node">
<title>dp3_pp1_layer1_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="321526.5,-531.06 321261.5,-531.06 321261.5,-479.06 321526.5,-479.06 321526.5,-531.06"/>
<text text-anchor="middle" x="321394" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="321394" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="321394" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="321394" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer1_attn_tp1&#45;&gt;dp3_pp1_layer1_attn_allreduce -->
<g id="edge1821" class="edge">
<title>dp3_pp1_layer1_attn_tp1&#45;&gt;dp3_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M321364.92,-478.92C321346.28,-462.8 321321.62,-441.49 321300.11,-422.89"/>
<polygon fill="black" stroke="black" points="321302.2,-420.06 321292.34,-416.17 321297.62,-425.36 321302.2,-420.06"/>
</g>
<!-- dp3_pp1_layer1_attn_tp2 -->
<g id="node1110" class="node">
<title>dp3_pp1_layer1_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="320960.5,-531.06 320695.5,-531.06 320695.5,-479.06 320960.5,-479.06 320960.5,-531.06"/>
<text text-anchor="middle" x="320828" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="320828" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="320828" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="320828" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer1_attn_tp2&#45;&gt;dp3_pp1_layer1_attn_allreduce -->
<g id="edge1822" class="edge">
<title>dp3_pp1_layer1_attn_tp2&#45;&gt;dp3_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M320893.66,-479C320917.53,-470.28 320944.83,-460.77 320970,-453.06 321021.51,-437.29 321079.04,-422.21 321128.64,-409.97"/>
<polygon fill="black" stroke="black" points="321129.57,-413.35 321138.45,-407.57 321127.9,-406.55 321129.57,-413.35"/>
</g>
<!-- dp3_pp1_layer1_attn_tp3 -->
<g id="node1111" class="node">
<title>dp3_pp1_layer1_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="321809.5,-531.06 321544.5,-531.06 321544.5,-479.06 321809.5,-479.06 321809.5,-531.06"/>
<text text-anchor="middle" x="321677" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="321677" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="321677" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="321677" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer1_attn_tp3&#45;&gt;dp3_pp1_layer1_attn_allreduce -->
<g id="edge1823" class="edge">
<title>dp3_pp1_layer1_attn_tp3&#45;&gt;dp3_pp1_layer1_attn_allreduce</title>
<path fill="none" stroke="black" d="M321611.82,-478.95C321588.12,-470.23 321561.01,-460.72 321536,-453.06 321484.14,-437.17 321426.21,-422.07 321376.26,-409.85"/>
<polygon fill="black" stroke="black" points="321376.92,-406.41 321366.38,-407.45 321375.27,-413.21 321376.92,-406.41"/>
</g>
<!-- dp3_pp1_layer1_expert0 -->
<g id="node1113" class="node">
<title>dp3_pp1_layer1_expert0</title>
<polygon fill="lightgreen" stroke="black" points="317041,-406.29 316817,-406.29 316817,-354.29 317041,-354.29 317041,-406.29"/>
<text text-anchor="middle" x="316929" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="316929" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="316929" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="316929" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert0 -->
<g id="edge1824" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318541.73,-499.65C318156.55,-490.26 317331.11,-465.13 317050,-417.06 317037.99,-415.01 317025.48,-412.16 317013.27,-408.95"/>
<polygon fill="black" stroke="black" points="317014.11,-405.56 317003.54,-406.32 317012.28,-412.31 317014.11,-405.56"/>
</g>
<!-- dp3_pp1_layer1_expert1 -->
<g id="node1114" class="node">
<title>dp3_pp1_layer1_expert1</title>
<polygon fill="lightgreen" stroke="black" points="317283,-406.29 317059,-406.29 317059,-354.29 317283,-354.29 317283,-406.29"/>
<text text-anchor="middle" x="317171" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="317171" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="317171" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="317171" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert1 -->
<g id="edge1825" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318539.55,-497.55C318197.94,-485.71 317525.58,-458.03 317292,-417.06 317280.08,-414.97 317267.67,-412.12 317255.54,-408.93"/>
<polygon fill="black" stroke="black" points="317256.45,-405.55 317245.89,-406.3 317254.62,-412.3 317256.45,-405.55"/>
</g>
<!-- dp3_pp1_layer1_expert2 -->
<g id="node1115" class="node">
<title>dp3_pp1_layer1_expert2</title>
<polygon fill="lightgreen" stroke="black" points="317525,-406.29 317301,-406.29 317301,-354.29 317525,-354.29 317525,-406.29"/>
<text text-anchor="middle" x="317413" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="317413" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="317413" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="317413" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert2 -->
<g id="edge1826" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318544.82,-502.85C318303.66,-498.37 317886.02,-480.97 317534,-417.06 317522.38,-414.95 317510.29,-412.14 317498.44,-409.03"/>
<polygon fill="black" stroke="black" points="317499.13,-405.59 317488.56,-406.34 317497.29,-412.34 317499.13,-405.59"/>
</g>
<!-- dp3_pp1_layer1_expert3 -->
<g id="node1116" class="node">
<title>dp3_pp1_layer1_expert3</title>
<polygon fill="lightgreen" stroke="black" points="317767,-406.29 317543,-406.29 317543,-354.29 317767,-354.29 317767,-406.29"/>
<text text-anchor="middle" x="317655" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="317655" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="317655" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="317655" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert3 -->
<g id="edge1827" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318539.36,-497.41C318342.31,-488.25 318036.63,-466.79 317776,-417.06 317764.57,-414.88 317752.67,-412.06 317740.99,-408.97"/>
<polygon fill="black" stroke="black" points="317741.82,-405.57 317731.25,-406.31 317739.98,-412.32 317741.82,-405.57"/>
</g>
<!-- dp3_pp1_layer1_expert4 -->
<g id="node1117" class="node">
<title>dp3_pp1_layer1_expert4</title>
<polygon fill="lightgreen" stroke="black" points="318009,-406.29 317785,-406.29 317785,-354.29 318009,-354.29 318009,-406.29"/>
<text text-anchor="middle" x="317897" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="317897" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="317897" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="317897" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert4 -->
<g id="edge1828" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318530.43,-487.98C318384.99,-474.71 318188.64,-452.25 318018,-417.06 318007.05,-414.8 317995.65,-412.02 317984.43,-409.02"/>
<polygon fill="black" stroke="black" points="317985.19,-405.6 317974.62,-406.33 317983.34,-412.35 317985.19,-405.6"/>
</g>
<!-- dp3_pp1_layer1_expert5 -->
<g id="node1118" class="node">
<title>dp3_pp1_layer1_expert5</title>
<polygon fill="lightgreen" stroke="black" points="318251,-406.29 318027,-406.29 318027,-354.29 318251,-354.29 318251,-406.29"/>
<text text-anchor="middle" x="318139" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="318139" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="318139" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="318139" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert5 -->
<g id="edge1829" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318510.29,-467.38C318430.5,-453.44 318341,-436.25 318260,-417.06 318249.9,-414.67 318239.4,-411.94 318228.99,-409.07"/>
<polygon fill="black" stroke="black" points="318229.62,-405.62 318219.05,-406.3 318227.74,-412.36 318229.62,-405.62"/>
</g>
<!-- dp3_pp1_layer1_expert6 -->
<g id="node1119" class="node">
<title>dp3_pp1_layer1_expert6</title>
<polygon fill="lightgreen" stroke="black" points="318493,-406.29 318269,-406.29 318269,-354.29 318493,-354.29 318493,-406.29"/>
<text text-anchor="middle" x="318381" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="318381" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="318381" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="318381" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert6 -->
<g id="edge1830" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318592.94,-452.97C318549.16,-438.16 318502.94,-422.53 318464.87,-409.66"/>
<polygon fill="black" stroke="black" points="318465.97,-406.33 318455.38,-406.45 318463.73,-412.97 318465.97,-406.33"/>
</g>
<!-- dp3_pp1_layer1_expert7 -->
<g id="node1120" class="node">
<title>dp3_pp1_layer1_expert7</title>
<polygon fill="lightgreen" stroke="black" points="318735,-406.29 318511,-406.29 318511,-354.29 318735,-354.29 318735,-406.29"/>
<text text-anchor="middle" x="318623" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="318623" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="318623" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="318623" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert7 -->
<g id="edge1831" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318693.38,-452.71C318680.3,-439.43 318666.58,-425.51 318654.76,-413.52"/>
<polygon fill="black" stroke="black" points="318657.19,-411 318647.68,-406.33 318652.2,-415.91 318657.19,-411"/>
</g>
<!-- dp3_pp1_layer1_expert8 -->
<g id="node1121" class="node">
<title>dp3_pp1_layer1_expert8</title>
<polygon fill="lightgreen" stroke="black" points="318977,-406.29 318753,-406.29 318753,-354.29 318977,-354.29 318977,-406.29"/>
<text text-anchor="middle" x="318865" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="318865" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="318865" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="318865" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert8 -->
<g id="edge1832" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318794.61,-452.71C318807.7,-439.43 318821.42,-425.51 318833.23,-413.52"/>
<polygon fill="black" stroke="black" points="318835.79,-415.91 318840.32,-406.33 318830.81,-411 318835.79,-415.91"/>
</g>
<!-- dp3_pp1_layer1_expert9 -->
<g id="node1122" class="node">
<title>dp3_pp1_layer1_expert9</title>
<polygon fill="lightgreen" stroke="black" points="319219,-406.29 318995,-406.29 318995,-354.29 319219,-354.29 319219,-406.29"/>
<text text-anchor="middle" x="319107" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="319107" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="319107" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="319107" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert9 -->
<g id="edge1833" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318891.38,-454.21C318936.29,-439.03 318984.08,-422.86 319023.23,-409.62"/>
<polygon fill="black" stroke="black" points="319024.64,-412.84 319032.99,-406.32 319022.4,-406.21 319024.64,-412.84"/>
</g>
<!-- dp3_pp1_layer1_expert10 -->
<g id="node1123" class="node">
<title>dp3_pp1_layer1_expert10</title>
<polygon fill="lightgreen" stroke="black" points="319461,-406.29 319237,-406.29 319237,-354.29 319461,-354.29 319461,-406.29"/>
<text text-anchor="middle" x="319349" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="319349" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="319349" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="319349" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert10 -->
<g id="edge1834" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318914.89,-478.04C319007.98,-462.69 319124.88,-441.49 319228,-417.06 319238.09,-414.67 319248.6,-411.94 319259.01,-409.07"/>
<polygon fill="black" stroke="black" points="319260.26,-412.36 319268.95,-406.3 319258.37,-405.62 319260.26,-412.36"/>
</g>
<!-- dp3_pp1_layer1_expert11 -->
<g id="node1124" class="node">
<title>dp3_pp1_layer1_expert11</title>
<polygon fill="lightgreen" stroke="black" points="319703,-406.29 319479,-406.29 319479,-354.29 319703,-354.29 319703,-406.29"/>
<text text-anchor="middle" x="319591" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="319591" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="319591" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="319591" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert11 -->
<g id="edge1835" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318926.99,-490.7C319074.62,-477.88 319287.08,-454.78 319470,-417.06 319480.95,-414.8 319492.35,-412.02 319503.57,-409.02"/>
<polygon fill="black" stroke="black" points="319504.66,-412.35 319513.38,-406.33 319502.81,-405.6 319504.66,-412.35"/>
</g>
<!-- dp3_pp1_layer1_expert12 -->
<g id="node1125" class="node">
<title>dp3_pp1_layer1_expert12</title>
<polygon fill="lightgreen" stroke="black" points="319945,-406.29 319721,-406.29 319721,-354.29 319945,-354.29 319945,-406.29"/>
<text text-anchor="middle" x="319833" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="319833" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="319833" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="319833" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert12 -->
<g id="edge1836" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318934.27,-498.07C319130.59,-489.29 319444.95,-468.01 319712,-417.06 319723.43,-414.88 319735.33,-412.06 319747.01,-408.97"/>
<polygon fill="black" stroke="black" points="319748.02,-412.32 319756.75,-406.31 319746.18,-405.57 319748.02,-412.32"/>
</g>
<!-- dp3_pp1_layer1_expert13 -->
<g id="node1126" class="node">
<title>dp3_pp1_layer1_expert13</title>
<polygon fill="lightgreen" stroke="black" points="320187,-406.29 319963,-406.29 319963,-354.29 320187,-354.29 320187,-406.29"/>
<text text-anchor="middle" x="320075" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="320075" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="320075" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="320075" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert13 -->
<g id="edge1837" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318938.93,-502.93C319179.42,-498.58 319599.9,-481.35 319954,-417.06 319965.62,-414.95 319977.71,-412.14 319989.56,-409.03"/>
<polygon fill="black" stroke="black" points="319990.7,-412.34 319999.44,-406.34 319988.87,-405.59 319990.7,-412.34"/>
</g>
<!-- dp3_pp1_layer1_expert14 -->
<g id="node1127" class="node">
<title>dp3_pp1_layer1_expert14</title>
<polygon fill="lightgreen" stroke="black" points="320429,-406.29 320205,-406.29 320205,-354.29 320429,-354.29 320429,-406.29"/>
<text text-anchor="middle" x="320317" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="320317" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="320317" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="320317" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert14 -->
<g id="edge1838" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318934.32,-498.04C319271.17,-486.48 319959.15,-458.6 320196,-417.06 320207.92,-414.97 320220.32,-412.12 320232.46,-408.93"/>
<polygon fill="black" stroke="black" points="320233.38,-412.3 320242.11,-406.3 320231.54,-405.55 320233.38,-412.3"/>
</g>
<!-- dp3_pp1_layer1_expert15 -->
<g id="node1128" class="node">
<title>dp3_pp1_layer1_expert15</title>
<polygon fill="lightgreen" stroke="black" points="320671,-406.29 320447,-406.29 320447,-354.29 320671,-354.29 320671,-406.29"/>
<text text-anchor="middle" x="320559" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="320559" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="320559" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="320559" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert15 -->
<g id="edge1839" class="edge">
<title>dp3_pp1_layer1_router&#45;&gt;dp3_pp1_layer1_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M318935.94,-499.9C319316.49,-490.72 320154.35,-465.57 320438,-417.06 320450.01,-415.01 320462.51,-412.16 320474.73,-408.95"/>
<polygon fill="black" stroke="black" points="320475.72,-412.31 320484.45,-406.32 320473.88,-405.56 320475.72,-412.31"/>
</g>
<!-- dp3_pp1_layer1_expert_agg -->
<g id="node1129" class="node">
<title>dp3_pp1_layer1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="318991.57,-307.52 318597.74,-307.52 318496.43,-203.52 318890.26,-203.52 318991.57,-307.52"/>
<text text-anchor="middle" x="318744" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="318744" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="318744" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="318744" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer1_expert0&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1840" class="edge">
<title>dp3_pp1_layer1_expert0&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M316987.07,-354.29C317006.69,-346.92 317028.97,-339.72 317050,-335.52 317329.13,-279.86 318152.93,-263.21 318539.43,-258.4"/>
<polygon fill="black" stroke="black" points="318539.65,-261.9 318549.61,-258.27 318539.57,-254.9 318539.65,-261.9"/>
</g>
<!-- dp3_pp1_layer1_expert1&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1841" class="edge">
<title>dp3_pp1_layer1_expert1&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M317229.39,-354.27C317248.95,-346.95 317271.09,-339.78 317292,-335.52 317524.8,-288.16 318200.09,-267.74 318541.43,-260.24"/>
<polygon fill="black" stroke="black" points="318541.51,-263.74 318551.43,-260.03 318541.35,-256.74 318541.51,-263.74"/>
</g>
<!-- dp3_pp1_layer1_expert2&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1842" class="edge">
<title>dp3_pp1_layer1_expert2&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M317471.73,-354.29C317491.21,-347.01 317513.23,-339.87 317534,-335.52 317720.91,-296.44 318250.54,-273.07 318543.3,-262.78"/>
<polygon fill="black" stroke="black" points="318543.74,-266.27 318553.61,-262.42 318543.5,-259.27 318543.74,-266.27"/>
</g>
<!-- dp3_pp1_layer1_expert3&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1843" class="edge">
<title>dp3_pp1_layer1_expert3&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M317714.39,-354.26C317733.72,-347.07 317755.48,-339.99 317776,-335.52 318034.91,-279.18 318340.7,-262.24 318538.26,-257.56"/>
<polygon fill="black" stroke="black" points="318538.55,-261.06 318548.47,-257.33 318538.39,-254.06 318538.55,-261.06"/>
</g>
<!-- dp3_pp1_layer1_expert4&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1844" class="edge">
<title>dp3_pp1_layer1_expert4&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M317957.39,-354.24C317976.49,-347.2 317997.87,-340.19 318018,-335.52 318193.82,-294.77 318398.6,-274.91 318545.75,-265.31"/>
<polygon fill="black" stroke="black" points="318546.05,-268.8 318555.81,-264.67 318545.6,-261.82 318546.05,-268.8"/>
</g>
<!-- dp3_pp1_layer1_expert5&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1845" class="edge">
<title>dp3_pp1_layer1_expert5&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M318201.42,-354.22C318220.04,-347.42 318240.65,-340.55 318260,-335.52 318357.09,-310.27 318467.34,-291.53 318558.07,-278.65"/>
<polygon fill="black" stroke="black" points="318558.78,-282.09 318568.19,-277.23 318557.8,-275.16 318558.78,-282.09"/>
</g>
<!-- dp3_pp1_layer1_expert6&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1846" class="edge">
<title>dp3_pp1_layer1_expert6&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M318449.02,-354.26C318466.26,-348.03 318484.78,-341.44 318502,-335.52 318528.73,-326.33 318557.21,-316.8 318584.89,-307.67"/>
<polygon fill="black" stroke="black" points="318586.24,-310.91 318594.65,-304.46 318584.06,-304.26 318586.24,-310.91"/>
</g>
<!-- dp3_pp1_layer1_expert7&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1847" class="edge">
<title>dp3_pp1_layer1_expert7&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M318647.78,-354.15C318659.02,-342.74 318672.83,-328.73 318686.45,-314.92"/>
<polygon fill="black" stroke="black" points="318689,-317.31 318693.53,-307.73 318684.02,-312.39 318689,-317.31"/>
</g>
<!-- dp3_pp1_layer1_expert8&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1848" class="edge">
<title>dp3_pp1_layer1_expert8&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M318840.22,-354.15C318828.97,-342.74 318815.16,-328.73 318801.55,-314.92"/>
<polygon fill="black" stroke="black" points="318803.98,-312.39 318794.47,-307.73 318798.99,-317.31 318803.98,-312.39"/>
</g>
<!-- dp3_pp1_layer1_expert9&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1849" class="edge">
<title>dp3_pp1_layer1_expert9&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M319038.98,-354.26C319021.73,-348.03 319003.21,-341.44 318986,-335.52 318962.29,-327.37 318937.21,-318.95 318912.53,-310.78"/>
<polygon fill="black" stroke="black" points="318913.32,-307.36 318902.73,-307.54 318911.12,-314 318913.32,-307.36"/>
</g>
<!-- dp3_pp1_layer1_expert10&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1850" class="edge">
<title>dp3_pp1_layer1_expert10&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M319286.58,-354.22C319267.96,-347.42 319247.35,-340.55 319228,-335.52 319147.99,-314.71 319059.05,-298.33 318979.46,-286"/>
<polygon fill="black" stroke="black" points="318979.71,-282.5 318969.3,-284.44 318978.65,-289.41 318979.71,-282.5"/>
</g>
<!-- dp3_pp1_layer1_expert11&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1851" class="edge">
<title>dp3_pp1_layer1_expert11&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M319530.61,-354.24C319511.51,-347.2 319490.13,-340.19 319470,-335.52 319301.74,-296.53 319106.97,-276.66 318961.55,-266.61"/>
<polygon fill="black" stroke="black" points="318961.38,-263.09 318951.16,-265.9 318960.9,-270.07 318961.38,-263.09"/>
</g>
<!-- dp3_pp1_layer1_expert12&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1852" class="edge">
<title>dp3_pp1_layer1_expert12&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M319773.61,-354.26C319754.28,-347.07 319732.52,-339.99 319712,-335.52 319454.51,-279.49 319150.64,-262.43 318952.99,-257.64"/>
<polygon fill="black" stroke="black" points="318952.86,-254.14 318942.78,-257.4 318952.69,-261.13 318952.86,-254.14"/>
</g>
<!-- dp3_pp1_layer1_expert13&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1853" class="edge">
<title>dp3_pp1_layer1_expert13&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M320016.27,-354.29C319996.79,-347.01 319974.77,-339.87 319954,-335.52 319770.02,-297.05 319253.97,-273.81 318958.63,-263.27"/>
<polygon fill="black" stroke="black" points="318958.33,-259.76 318948.21,-262.9 318958.08,-266.76 318958.33,-259.76"/>
</g>
<!-- dp3_pp1_layer1_expert14&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1854" class="edge">
<title>dp3_pp1_layer1_expert14&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M320258.6,-354.27C320239.05,-346.95 320216.9,-339.78 320196,-335.52 319965.27,-288.58 319299.86,-268.1 318955.74,-260.45"/>
<polygon fill="black" stroke="black" points="318955.73,-256.94 318945.65,-260.22 318955.57,-263.94 318955.73,-256.94"/>
</g>
<!-- dp3_pp1_layer1_expert15&#45;&gt;dp3_pp1_layer1_expert_agg -->
<g id="edge1855" class="edge">
<title>dp3_pp1_layer1_expert15&#45;&gt;dp3_pp1_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M320500.93,-354.29C320481.3,-346.92 320459.03,-339.72 320438,-335.52 320160.21,-280.12 319342.98,-263.37 318954.17,-258.47"/>
<polygon fill="black" stroke="black" points="318953.97,-254.97 318943.93,-258.34 318953.88,-261.97 318953.97,-254.97"/>
</g>
<!-- dp3_pp1_layer2_attn_tp0 -->
<g id="node1130" class="node">
<title>dp3_pp1_layer2_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="316226.5,-531.06 315961.5,-531.06 315961.5,-479.06 316226.5,-479.06 316226.5,-531.06"/>
<text text-anchor="middle" x="316094" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="316094" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="316094" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="316094" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer1_expert_agg&#45;&gt;dp3_pp1_layer2_attn_tp0 -->
<g id="edge1857" class="edge">
<title>dp3_pp1_layer1_expert_agg&#45;&gt;dp3_pp1_layer2_attn_tp0</title>
<path fill="none" stroke="black" d="M318551.78,-260.41C318131.38,-269.54 317141.17,-294.77 316808,-335.52 316775.8,-339.46 316267.23,-444.29 316236,-453.06 316213.37,-459.41 316189.16,-467.58 316167.26,-475.5"/>
<polygon fill="black" stroke="black" points="316165.89,-472.28 316157.7,-479 316168.29,-478.85 316165.89,-472.28"/>
</g>
<!-- dp3_pp1_layer2_attn_allreduce -->
<g id="node1131" class="node">
<title>dp3_pp1_layer2_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="316223" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="316223" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="316223" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="316223" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="316223" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_attn_tp0&#45;&gt;dp3_pp1_layer2_attn_allreduce -->
<g id="edge1858" class="edge">
<title>dp3_pp1_layer2_attn_tp0&#45;&gt;dp3_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M316120.41,-478.92C316137.15,-463 316159.21,-442 316178.58,-423.56"/>
<polygon fill="black" stroke="black" points="316181.03,-426.07 316185.86,-416.64 316176.2,-421 316181.03,-426.07"/>
</g>
<!-- dp3_pp1_layer2_router -->
<g id="node1135" class="node">
<title>dp3_pp1_layer2_router</title>
<polygon fill="lightyellow" stroke="black" points="313974.57,-557.06 313580.74,-557.06 313479.43,-453.06 313873.26,-453.06 313974.57,-557.06"/>
<text text-anchor="middle" x="313727" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="313727" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="313727" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="313727" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_attn_allreduce&#45;&gt;dp3_pp1_layer2_router -->
<g id="edge1894" class="edge">
<title>dp3_pp1_layer2_attn_allreduce&#45;&gt;dp3_pp1_layer2_router</title>
<path fill="none" stroke="black" d="M316063.08,-392.38C315951.77,-399.9 315799.89,-409.76 315666,-417.06 315030.5,-451.72 314277.28,-482.59 313925.96,-496.4"/>
<polygon fill="black" stroke="black" points="313925.8,-492.91 313915.94,-496.79 313926.07,-499.9 313925.8,-492.91"/>
</g>
<!-- dp3_pp1_layer2_attn_tp1 -->
<g id="node1132" class="node">
<title>dp3_pp1_layer2_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="316509.5,-531.06 316244.5,-531.06 316244.5,-479.06 316509.5,-479.06 316509.5,-531.06"/>
<text text-anchor="middle" x="316377" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="316377" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="316377" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="316377" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer2_attn_tp1&#45;&gt;dp3_pp1_layer2_attn_allreduce -->
<g id="edge1859" class="edge">
<title>dp3_pp1_layer2_attn_tp1&#45;&gt;dp3_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M316345.46,-478.92C316324.99,-462.6 316297.83,-440.94 316274.29,-422.18"/>
<polygon fill="black" stroke="black" points="316276.46,-419.44 316266.46,-415.94 316272.1,-424.91 316276.46,-419.44"/>
</g>
<!-- dp3_pp1_layer2_attn_tp2 -->
<g id="node1133" class="node">
<title>dp3_pp1_layer2_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="315943.5,-531.06 315678.5,-531.06 315678.5,-479.06 315943.5,-479.06 315943.5,-531.06"/>
<text text-anchor="middle" x="315811" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="315811" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="315811" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="315811" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer2_attn_tp2&#45;&gt;dp3_pp1_layer2_attn_allreduce -->
<g id="edge1860" class="edge">
<title>dp3_pp1_layer2_attn_tp2&#45;&gt;dp3_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M315877.07,-479.02C315900.85,-470.35 315927.99,-460.86 315953,-453.06 316001.74,-437.86 316056.05,-423.03 316103.1,-410.83"/>
<polygon fill="black" stroke="black" points="316104.22,-414.15 316113.03,-408.26 316102.47,-407.38 316104.22,-414.15"/>
</g>
<!-- dp3_pp1_layer2_attn_tp3 -->
<g id="node1134" class="node">
<title>dp3_pp1_layer2_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="316792.5,-531.06 316527.5,-531.06 316527.5,-479.06 316792.5,-479.06 316792.5,-531.06"/>
<text text-anchor="middle" x="316660" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="316660" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="316660" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="316660" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer2_attn_tp3&#45;&gt;dp3_pp1_layer2_attn_allreduce -->
<g id="edge1861" class="edge">
<title>dp3_pp1_layer2_attn_tp3&#45;&gt;dp3_pp1_layer2_attn_allreduce</title>
<path fill="none" stroke="black" d="M316595.21,-478.95C316571.43,-470.18 316544.17,-460.64 316519,-453.06 316464.42,-436.63 316403.31,-421.31 316350.86,-409.08"/>
<polygon fill="black" stroke="black" points="316351.37,-405.6 316340.83,-406.75 316349.78,-412.42 316351.37,-405.6"/>
</g>
<!-- dp3_pp1_layer2_expert0 -->
<g id="node1136" class="node">
<title>dp3_pp1_layer2_expert0</title>
<polygon fill="lightgreen" stroke="black" points="312024,-406.29 311800,-406.29 311800,-354.29 312024,-354.29 312024,-406.29"/>
<text text-anchor="middle" x="311912" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="311912" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="311912" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="311912" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert0 -->
<g id="edge1862" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313524.73,-499.65C313139.55,-490.26 312314.11,-465.13 312033,-417.06 312020.99,-415.01 312008.48,-412.16 311996.27,-408.95"/>
<polygon fill="black" stroke="black" points="311997.11,-405.56 311986.54,-406.32 311995.28,-412.31 311997.11,-405.56"/>
</g>
<!-- dp3_pp1_layer2_expert1 -->
<g id="node1137" class="node">
<title>dp3_pp1_layer2_expert1</title>
<polygon fill="lightgreen" stroke="black" points="312266,-406.29 312042,-406.29 312042,-354.29 312266,-354.29 312266,-406.29"/>
<text text-anchor="middle" x="312154" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="312154" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="312154" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="312154" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert1 -->
<g id="edge1863" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313522.55,-497.55C313180.94,-485.71 312508.58,-458.03 312275,-417.06 312263.08,-414.97 312250.67,-412.12 312238.54,-408.93"/>
<polygon fill="black" stroke="black" points="312239.45,-405.55 312228.89,-406.3 312237.62,-412.3 312239.45,-405.55"/>
</g>
<!-- dp3_pp1_layer2_expert2 -->
<g id="node1138" class="node">
<title>dp3_pp1_layer2_expert2</title>
<polygon fill="lightgreen" stroke="black" points="312508,-406.29 312284,-406.29 312284,-354.29 312508,-354.29 312508,-406.29"/>
<text text-anchor="middle" x="312396" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="312396" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="312396" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="312396" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert2 -->
<g id="edge1864" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313527.82,-502.85C313286.66,-498.37 312869.02,-480.97 312517,-417.06 312505.38,-414.95 312493.29,-412.14 312481.44,-409.03"/>
<polygon fill="black" stroke="black" points="312482.13,-405.59 312471.56,-406.34 312480.29,-412.34 312482.13,-405.59"/>
</g>
<!-- dp3_pp1_layer2_expert3 -->
<g id="node1139" class="node">
<title>dp3_pp1_layer2_expert3</title>
<polygon fill="lightgreen" stroke="black" points="312750,-406.29 312526,-406.29 312526,-354.29 312750,-354.29 312750,-406.29"/>
<text text-anchor="middle" x="312638" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="312638" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="312638" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="312638" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert3 -->
<g id="edge1865" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313522.36,-497.41C313325.31,-488.25 313019.63,-466.79 312759,-417.06 312747.57,-414.88 312735.67,-412.06 312723.99,-408.97"/>
<polygon fill="black" stroke="black" points="312724.82,-405.57 312714.25,-406.31 312722.98,-412.32 312724.82,-405.57"/>
</g>
<!-- dp3_pp1_layer2_expert4 -->
<g id="node1140" class="node">
<title>dp3_pp1_layer2_expert4</title>
<polygon fill="lightgreen" stroke="black" points="312992,-406.29 312768,-406.29 312768,-354.29 312992,-354.29 312992,-406.29"/>
<text text-anchor="middle" x="312880" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="312880" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="312880" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="312880" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert4 -->
<g id="edge1866" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313513.43,-487.98C313367.99,-474.71 313171.64,-452.25 313001,-417.06 312990.05,-414.8 312978.65,-412.02 312967.43,-409.02"/>
<polygon fill="black" stroke="black" points="312968.19,-405.6 312957.62,-406.33 312966.34,-412.35 312968.19,-405.6"/>
</g>
<!-- dp3_pp1_layer2_expert5 -->
<g id="node1141" class="node">
<title>dp3_pp1_layer2_expert5</title>
<polygon fill="lightgreen" stroke="black" points="313234,-406.29 313010,-406.29 313010,-354.29 313234,-354.29 313234,-406.29"/>
<text text-anchor="middle" x="313122" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="313122" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="313122" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="313122" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert5 -->
<g id="edge1867" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313493.29,-467.38C313413.5,-453.44 313324,-436.25 313243,-417.06 313232.9,-414.67 313222.4,-411.94 313211.99,-409.07"/>
<polygon fill="black" stroke="black" points="313212.62,-405.62 313202.05,-406.3 313210.74,-412.36 313212.62,-405.62"/>
</g>
<!-- dp3_pp1_layer2_expert6 -->
<g id="node1142" class="node">
<title>dp3_pp1_layer2_expert6</title>
<polygon fill="lightgreen" stroke="black" points="313476,-406.29 313252,-406.29 313252,-354.29 313476,-354.29 313476,-406.29"/>
<text text-anchor="middle" x="313364" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="313364" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="313364" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="313364" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert6 -->
<g id="edge1868" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313575.94,-452.97C313532.16,-438.16 313485.94,-422.53 313447.87,-409.66"/>
<polygon fill="black" stroke="black" points="313448.97,-406.33 313438.38,-406.45 313446.73,-412.97 313448.97,-406.33"/>
</g>
<!-- dp3_pp1_layer2_expert7 -->
<g id="node1143" class="node">
<title>dp3_pp1_layer2_expert7</title>
<polygon fill="lightgreen" stroke="black" points="313718,-406.29 313494,-406.29 313494,-354.29 313718,-354.29 313718,-406.29"/>
<text text-anchor="middle" x="313606" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="313606" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="313606" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="313606" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert7 -->
<g id="edge1869" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313676.38,-452.71C313663.3,-439.43 313649.58,-425.51 313637.76,-413.52"/>
<polygon fill="black" stroke="black" points="313640.19,-411 313630.68,-406.33 313635.2,-415.91 313640.19,-411"/>
</g>
<!-- dp3_pp1_layer2_expert8 -->
<g id="node1144" class="node">
<title>dp3_pp1_layer2_expert8</title>
<polygon fill="lightgreen" stroke="black" points="313960,-406.29 313736,-406.29 313736,-354.29 313960,-354.29 313960,-406.29"/>
<text text-anchor="middle" x="313848" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="313848" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="313848" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="313848" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert8 -->
<g id="edge1870" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313777.61,-452.71C313790.7,-439.43 313804.42,-425.51 313816.23,-413.52"/>
<polygon fill="black" stroke="black" points="313818.79,-415.91 313823.32,-406.33 313813.81,-411 313818.79,-415.91"/>
</g>
<!-- dp3_pp1_layer2_expert9 -->
<g id="node1145" class="node">
<title>dp3_pp1_layer2_expert9</title>
<polygon fill="lightgreen" stroke="black" points="314202,-406.29 313978,-406.29 313978,-354.29 314202,-354.29 314202,-406.29"/>
<text text-anchor="middle" x="314090" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="314090" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="314090" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="314090" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert9 -->
<g id="edge1871" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313874.38,-454.21C313919.29,-439.03 313967.08,-422.86 314006.23,-409.62"/>
<polygon fill="black" stroke="black" points="314007.64,-412.84 314015.99,-406.32 314005.4,-406.21 314007.64,-412.84"/>
</g>
<!-- dp3_pp1_layer2_expert10 -->
<g id="node1146" class="node">
<title>dp3_pp1_layer2_expert10</title>
<polygon fill="lightgreen" stroke="black" points="314444,-406.29 314220,-406.29 314220,-354.29 314444,-354.29 314444,-406.29"/>
<text text-anchor="middle" x="314332" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="314332" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="314332" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="314332" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert10 -->
<g id="edge1872" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313897.89,-478.04C313990.98,-462.69 314107.88,-441.49 314211,-417.06 314221.09,-414.67 314231.6,-411.94 314242.01,-409.07"/>
<polygon fill="black" stroke="black" points="314243.26,-412.36 314251.95,-406.3 314241.37,-405.62 314243.26,-412.36"/>
</g>
<!-- dp3_pp1_layer2_expert11 -->
<g id="node1147" class="node">
<title>dp3_pp1_layer2_expert11</title>
<polygon fill="lightgreen" stroke="black" points="314686,-406.29 314462,-406.29 314462,-354.29 314686,-354.29 314686,-406.29"/>
<text text-anchor="middle" x="314574" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="314574" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="314574" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="314574" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert11 -->
<g id="edge1873" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313909.99,-490.7C314057.62,-477.88 314270.08,-454.78 314453,-417.06 314463.95,-414.8 314475.35,-412.02 314486.57,-409.02"/>
<polygon fill="black" stroke="black" points="314487.66,-412.35 314496.38,-406.33 314485.81,-405.6 314487.66,-412.35"/>
</g>
<!-- dp3_pp1_layer2_expert12 -->
<g id="node1148" class="node">
<title>dp3_pp1_layer2_expert12</title>
<polygon fill="lightgreen" stroke="black" points="314928,-406.29 314704,-406.29 314704,-354.29 314928,-354.29 314928,-406.29"/>
<text text-anchor="middle" x="314816" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="314816" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="314816" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="314816" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert12 -->
<g id="edge1874" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313917.27,-498.07C314113.59,-489.29 314427.95,-468.01 314695,-417.06 314706.43,-414.88 314718.33,-412.06 314730.01,-408.97"/>
<polygon fill="black" stroke="black" points="314731.02,-412.32 314739.75,-406.31 314729.18,-405.57 314731.02,-412.32"/>
</g>
<!-- dp3_pp1_layer2_expert13 -->
<g id="node1149" class="node">
<title>dp3_pp1_layer2_expert13</title>
<polygon fill="lightgreen" stroke="black" points="315170,-406.29 314946,-406.29 314946,-354.29 315170,-354.29 315170,-406.29"/>
<text text-anchor="middle" x="315058" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="315058" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="315058" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="315058" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert13 -->
<g id="edge1875" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313921.93,-502.93C314162.42,-498.58 314582.9,-481.35 314937,-417.06 314948.62,-414.95 314960.71,-412.14 314972.56,-409.03"/>
<polygon fill="black" stroke="black" points="314973.7,-412.34 314982.44,-406.34 314971.87,-405.59 314973.7,-412.34"/>
</g>
<!-- dp3_pp1_layer2_expert14 -->
<g id="node1150" class="node">
<title>dp3_pp1_layer2_expert14</title>
<polygon fill="lightgreen" stroke="black" points="315412,-406.29 315188,-406.29 315188,-354.29 315412,-354.29 315412,-406.29"/>
<text text-anchor="middle" x="315300" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="315300" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="315300" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="315300" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert14 -->
<g id="edge1876" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313917.32,-498.04C314254.17,-486.48 314942.15,-458.6 315179,-417.06 315190.92,-414.97 315203.32,-412.12 315215.46,-408.93"/>
<polygon fill="black" stroke="black" points="315216.38,-412.3 315225.11,-406.3 315214.54,-405.55 315216.38,-412.3"/>
</g>
<!-- dp3_pp1_layer2_expert15 -->
<g id="node1151" class="node">
<title>dp3_pp1_layer2_expert15</title>
<polygon fill="lightgreen" stroke="black" points="315654,-406.29 315430,-406.29 315430,-354.29 315654,-354.29 315654,-406.29"/>
<text text-anchor="middle" x="315542" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="315542" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="315542" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="315542" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert15 -->
<g id="edge1877" class="edge">
<title>dp3_pp1_layer2_router&#45;&gt;dp3_pp1_layer2_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M313918.94,-499.9C314299.49,-490.72 315137.35,-465.57 315421,-417.06 315433.01,-415.01 315445.51,-412.16 315457.73,-408.95"/>
<polygon fill="black" stroke="black" points="315458.72,-412.31 315467.45,-406.32 315456.88,-405.56 315458.72,-412.31"/>
</g>
<!-- dp3_pp1_layer2_expert_agg -->
<g id="node1152" class="node">
<title>dp3_pp1_layer2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="313974.57,-307.52 313580.74,-307.52 313479.43,-203.52 313873.26,-203.52 313974.57,-307.52"/>
<text text-anchor="middle" x="313727" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="313727" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="313727" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="313727" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer2_expert0&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1878" class="edge">
<title>dp3_pp1_layer2_expert0&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M311970.07,-354.29C311989.69,-346.92 312011.97,-339.72 312033,-335.52 312312.13,-279.86 313135.93,-263.21 313522.43,-258.4"/>
<polygon fill="black" stroke="black" points="313522.65,-261.9 313532.61,-258.27 313522.57,-254.9 313522.65,-261.9"/>
</g>
<!-- dp3_pp1_layer2_expert1&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1879" class="edge">
<title>dp3_pp1_layer2_expert1&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M312212.39,-354.27C312231.95,-346.95 312254.09,-339.78 312275,-335.52 312507.8,-288.16 313183.09,-267.74 313524.43,-260.24"/>
<polygon fill="black" stroke="black" points="313524.51,-263.74 313534.43,-260.03 313524.35,-256.74 313524.51,-263.74"/>
</g>
<!-- dp3_pp1_layer2_expert2&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1880" class="edge">
<title>dp3_pp1_layer2_expert2&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M312454.73,-354.29C312474.21,-347.01 312496.23,-339.87 312517,-335.52 312703.91,-296.44 313233.54,-273.07 313526.3,-262.78"/>
<polygon fill="black" stroke="black" points="313526.74,-266.27 313536.61,-262.42 313526.5,-259.27 313526.74,-266.27"/>
</g>
<!-- dp3_pp1_layer2_expert3&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1881" class="edge">
<title>dp3_pp1_layer2_expert3&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M312697.39,-354.26C312716.72,-347.07 312738.48,-339.99 312759,-335.52 313017.91,-279.18 313323.7,-262.24 313521.26,-257.56"/>
<polygon fill="black" stroke="black" points="313521.55,-261.06 313531.47,-257.33 313521.39,-254.06 313521.55,-261.06"/>
</g>
<!-- dp3_pp1_layer2_expert4&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1882" class="edge">
<title>dp3_pp1_layer2_expert4&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M312940.39,-354.24C312959.49,-347.2 312980.87,-340.19 313001,-335.52 313176.82,-294.77 313381.6,-274.91 313528.75,-265.31"/>
<polygon fill="black" stroke="black" points="313529.05,-268.8 313538.81,-264.67 313528.6,-261.82 313529.05,-268.8"/>
</g>
<!-- dp3_pp1_layer2_expert5&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1883" class="edge">
<title>dp3_pp1_layer2_expert5&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M313184.42,-354.22C313203.04,-347.42 313223.65,-340.55 313243,-335.52 313340.09,-310.27 313450.34,-291.53 313541.07,-278.65"/>
<polygon fill="black" stroke="black" points="313541.78,-282.09 313551.19,-277.23 313540.8,-275.16 313541.78,-282.09"/>
</g>
<!-- dp3_pp1_layer2_expert6&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1884" class="edge">
<title>dp3_pp1_layer2_expert6&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M313432.02,-354.26C313449.26,-348.03 313467.78,-341.44 313485,-335.52 313511.73,-326.33 313540.21,-316.8 313567.89,-307.67"/>
<polygon fill="black" stroke="black" points="313569.24,-310.91 313577.65,-304.46 313567.06,-304.26 313569.24,-310.91"/>
</g>
<!-- dp3_pp1_layer2_expert7&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1885" class="edge">
<title>dp3_pp1_layer2_expert7&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M313630.78,-354.15C313642.02,-342.74 313655.83,-328.73 313669.45,-314.92"/>
<polygon fill="black" stroke="black" points="313672,-317.31 313676.53,-307.73 313667.02,-312.39 313672,-317.31"/>
</g>
<!-- dp3_pp1_layer2_expert8&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1886" class="edge">
<title>dp3_pp1_layer2_expert8&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M313823.22,-354.15C313811.97,-342.74 313798.16,-328.73 313784.55,-314.92"/>
<polygon fill="black" stroke="black" points="313786.98,-312.39 313777.47,-307.73 313781.99,-317.31 313786.98,-312.39"/>
</g>
<!-- dp3_pp1_layer2_expert9&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1887" class="edge">
<title>dp3_pp1_layer2_expert9&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M314021.98,-354.26C314004.73,-348.03 313986.21,-341.44 313969,-335.52 313945.29,-327.37 313920.21,-318.95 313895.53,-310.78"/>
<polygon fill="black" stroke="black" points="313896.32,-307.36 313885.73,-307.54 313894.12,-314 313896.32,-307.36"/>
</g>
<!-- dp3_pp1_layer2_expert10&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1888" class="edge">
<title>dp3_pp1_layer2_expert10&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M314269.58,-354.22C314250.96,-347.42 314230.35,-340.55 314211,-335.52 314130.99,-314.71 314042.05,-298.33 313962.46,-286"/>
<polygon fill="black" stroke="black" points="313962.71,-282.5 313952.3,-284.44 313961.65,-289.41 313962.71,-282.5"/>
</g>
<!-- dp3_pp1_layer2_expert11&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1889" class="edge">
<title>dp3_pp1_layer2_expert11&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M314513.61,-354.24C314494.51,-347.2 314473.13,-340.19 314453,-335.52 314284.74,-296.53 314089.97,-276.66 313944.55,-266.61"/>
<polygon fill="black" stroke="black" points="313944.38,-263.09 313934.16,-265.9 313943.9,-270.07 313944.38,-263.09"/>
</g>
<!-- dp3_pp1_layer2_expert12&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1890" class="edge">
<title>dp3_pp1_layer2_expert12&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M314756.61,-354.26C314737.28,-347.07 314715.52,-339.99 314695,-335.52 314437.51,-279.49 314133.64,-262.43 313935.99,-257.64"/>
<polygon fill="black" stroke="black" points="313935.86,-254.14 313925.78,-257.4 313935.69,-261.13 313935.86,-254.14"/>
</g>
<!-- dp3_pp1_layer2_expert13&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1891" class="edge">
<title>dp3_pp1_layer2_expert13&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M314999.27,-354.29C314979.79,-347.01 314957.77,-339.87 314937,-335.52 314753.02,-297.05 314236.97,-273.81 313941.63,-263.27"/>
<polygon fill="black" stroke="black" points="313941.33,-259.76 313931.21,-262.9 313941.08,-266.76 313941.33,-259.76"/>
</g>
<!-- dp3_pp1_layer2_expert14&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1892" class="edge">
<title>dp3_pp1_layer2_expert14&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M315241.6,-354.27C315222.05,-346.95 315199.9,-339.78 315179,-335.52 314948.27,-288.58 314282.86,-268.1 313938.74,-260.45"/>
<polygon fill="black" stroke="black" points="313938.73,-256.94 313928.65,-260.22 313938.57,-263.94 313938.73,-256.94"/>
</g>
<!-- dp3_pp1_layer2_expert15&#45;&gt;dp3_pp1_layer2_expert_agg -->
<g id="edge1893" class="edge">
<title>dp3_pp1_layer2_expert15&#45;&gt;dp3_pp1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M315483.93,-354.29C315464.3,-346.92 315442.03,-339.72 315421,-335.52 315143.21,-280.12 314325.98,-263.37 313937.17,-258.47"/>
<polygon fill="black" stroke="black" points="313936.97,-254.97 313926.93,-258.34 313936.88,-261.97 313936.97,-254.97"/>
</g>
<!-- dp3_pp1_layer3_attn_tp0 -->
<g id="node1153" class="node">
<title>dp3_pp1_layer3_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="311209.5,-531.06 310944.5,-531.06 310944.5,-479.06 311209.5,-479.06 311209.5,-531.06"/>
<text text-anchor="middle" x="311077" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="311077" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="311077" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="311077" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer2_expert_agg&#45;&gt;dp3_pp1_layer3_attn_tp0 -->
<g id="edge1895" class="edge">
<title>dp3_pp1_layer2_expert_agg&#45;&gt;dp3_pp1_layer3_attn_tp0</title>
<path fill="none" stroke="black" d="M313534.78,-260.41C313114.38,-269.54 312124.17,-294.77 311791,-335.52 311758.8,-339.46 311250.23,-444.29 311219,-453.06 311196.37,-459.41 311172.16,-467.58 311150.26,-475.5"/>
<polygon fill="black" stroke="black" points="311148.89,-472.28 311140.7,-479 311151.29,-478.85 311148.89,-472.28"/>
</g>
<!-- dp3_pp1_layer3_attn_allreduce -->
<g id="node1154" class="node">
<title>dp3_pp1_layer3_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="311206" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="311206" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="311206" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="311206" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="311206" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_attn_tp0&#45;&gt;dp3_pp1_layer3_attn_allreduce -->
<g id="edge1896" class="edge">
<title>dp3_pp1_layer3_attn_tp0&#45;&gt;dp3_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M311103.41,-478.92C311120.15,-463 311142.21,-442 311161.58,-423.56"/>
<polygon fill="black" stroke="black" points="311164.03,-426.07 311168.86,-416.64 311159.2,-421 311164.03,-426.07"/>
</g>
<!-- dp3_pp1_layer3_router -->
<g id="node1158" class="node">
<title>dp3_pp1_layer3_router</title>
<polygon fill="lightyellow" stroke="black" points="308957.57,-557.06 308563.74,-557.06 308462.43,-453.06 308856.26,-453.06 308957.57,-557.06"/>
<text text-anchor="middle" x="308710" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="308710" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="308710" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="308710" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_attn_allreduce&#45;&gt;dp3_pp1_layer3_router -->
<g id="edge1932" class="edge">
<title>dp3_pp1_layer3_attn_allreduce&#45;&gt;dp3_pp1_layer3_router</title>
<path fill="none" stroke="black" d="M311046.08,-392.38C310934.77,-399.9 310782.89,-409.76 310649,-417.06 310013.5,-451.72 309260.28,-482.59 308908.96,-496.4"/>
<polygon fill="black" stroke="black" points="308908.8,-492.91 308898.94,-496.79 308909.07,-499.9 308908.8,-492.91"/>
</g>
<!-- dp3_pp1_layer3_attn_tp1 -->
<g id="node1155" class="node">
<title>dp3_pp1_layer3_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="311492.5,-531.06 311227.5,-531.06 311227.5,-479.06 311492.5,-479.06 311492.5,-531.06"/>
<text text-anchor="middle" x="311360" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="311360" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="311360" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="311360" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer3_attn_tp1&#45;&gt;dp3_pp1_layer3_attn_allreduce -->
<g id="edge1897" class="edge">
<title>dp3_pp1_layer3_attn_tp1&#45;&gt;dp3_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M311328.46,-478.92C311307.99,-462.6 311280.83,-440.94 311257.29,-422.18"/>
<polygon fill="black" stroke="black" points="311259.46,-419.44 311249.46,-415.94 311255.1,-424.91 311259.46,-419.44"/>
</g>
<!-- dp3_pp1_layer3_attn_tp2 -->
<g id="node1156" class="node">
<title>dp3_pp1_layer3_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="310926.5,-531.06 310661.5,-531.06 310661.5,-479.06 310926.5,-479.06 310926.5,-531.06"/>
<text text-anchor="middle" x="310794" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="310794" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="310794" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="310794" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer3_attn_tp2&#45;&gt;dp3_pp1_layer3_attn_allreduce -->
<g id="edge1898" class="edge">
<title>dp3_pp1_layer3_attn_tp2&#45;&gt;dp3_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M310860.07,-479.02C310883.85,-470.35 310910.99,-460.86 310936,-453.06 310984.74,-437.86 311039.05,-423.03 311086.1,-410.83"/>
<polygon fill="black" stroke="black" points="311087.22,-414.15 311096.03,-408.26 311085.47,-407.38 311087.22,-414.15"/>
</g>
<!-- dp3_pp1_layer3_attn_tp3 -->
<g id="node1157" class="node">
<title>dp3_pp1_layer3_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="311775.5,-531.06 311510.5,-531.06 311510.5,-479.06 311775.5,-479.06 311775.5,-531.06"/>
<text text-anchor="middle" x="311643" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="311643" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="311643" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="311643" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer3_attn_tp3&#45;&gt;dp3_pp1_layer3_attn_allreduce -->
<g id="edge1899" class="edge">
<title>dp3_pp1_layer3_attn_tp3&#45;&gt;dp3_pp1_layer3_attn_allreduce</title>
<path fill="none" stroke="black" d="M311578.21,-478.95C311554.43,-470.18 311527.17,-460.64 311502,-453.06 311447.42,-436.63 311386.31,-421.31 311333.86,-409.08"/>
<polygon fill="black" stroke="black" points="311334.37,-405.6 311323.83,-406.75 311332.78,-412.42 311334.37,-405.6"/>
</g>
<!-- dp3_pp1_layer3_expert0 -->
<g id="node1159" class="node">
<title>dp3_pp1_layer3_expert0</title>
<polygon fill="lightgreen" stroke="black" points="307007,-406.29 306783,-406.29 306783,-354.29 307007,-354.29 307007,-406.29"/>
<text text-anchor="middle" x="306895" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="306895" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="306895" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="306895" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert0 -->
<g id="edge1900" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308507.73,-499.65C308122.55,-490.26 307297.11,-465.13 307016,-417.06 307003.99,-415.01 306991.48,-412.16 306979.27,-408.95"/>
<polygon fill="black" stroke="black" points="306980.11,-405.56 306969.54,-406.32 306978.28,-412.31 306980.11,-405.56"/>
</g>
<!-- dp3_pp1_layer3_expert1 -->
<g id="node1160" class="node">
<title>dp3_pp1_layer3_expert1</title>
<polygon fill="lightgreen" stroke="black" points="307249,-406.29 307025,-406.29 307025,-354.29 307249,-354.29 307249,-406.29"/>
<text text-anchor="middle" x="307137" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="307137" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="307137" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="307137" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert1 -->
<g id="edge1901" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308505.55,-497.55C308163.94,-485.71 307491.58,-458.03 307258,-417.06 307246.08,-414.97 307233.67,-412.12 307221.54,-408.93"/>
<polygon fill="black" stroke="black" points="307222.45,-405.55 307211.89,-406.3 307220.62,-412.3 307222.45,-405.55"/>
</g>
<!-- dp3_pp1_layer3_expert2 -->
<g id="node1161" class="node">
<title>dp3_pp1_layer3_expert2</title>
<polygon fill="lightgreen" stroke="black" points="307491,-406.29 307267,-406.29 307267,-354.29 307491,-354.29 307491,-406.29"/>
<text text-anchor="middle" x="307379" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="307379" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="307379" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="307379" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert2 -->
<g id="edge1902" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308510.82,-502.85C308269.66,-498.37 307852.02,-480.97 307500,-417.06 307488.38,-414.95 307476.29,-412.14 307464.44,-409.03"/>
<polygon fill="black" stroke="black" points="307465.13,-405.59 307454.56,-406.34 307463.29,-412.34 307465.13,-405.59"/>
</g>
<!-- dp3_pp1_layer3_expert3 -->
<g id="node1162" class="node">
<title>dp3_pp1_layer3_expert3</title>
<polygon fill="lightgreen" stroke="black" points="307733,-406.29 307509,-406.29 307509,-354.29 307733,-354.29 307733,-406.29"/>
<text text-anchor="middle" x="307621" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="307621" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="307621" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="307621" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert3 -->
<g id="edge1903" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308505.36,-497.41C308308.31,-488.25 308002.63,-466.79 307742,-417.06 307730.57,-414.88 307718.67,-412.06 307706.99,-408.97"/>
<polygon fill="black" stroke="black" points="307707.82,-405.57 307697.25,-406.31 307705.98,-412.32 307707.82,-405.57"/>
</g>
<!-- dp3_pp1_layer3_expert4 -->
<g id="node1163" class="node">
<title>dp3_pp1_layer3_expert4</title>
<polygon fill="lightgreen" stroke="black" points="307975,-406.29 307751,-406.29 307751,-354.29 307975,-354.29 307975,-406.29"/>
<text text-anchor="middle" x="307863" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="307863" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="307863" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="307863" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert4 -->
<g id="edge1904" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308496.43,-487.98C308350.99,-474.71 308154.64,-452.25 307984,-417.06 307973.05,-414.8 307961.65,-412.02 307950.43,-409.02"/>
<polygon fill="black" stroke="black" points="307951.19,-405.6 307940.62,-406.33 307949.34,-412.35 307951.19,-405.6"/>
</g>
<!-- dp3_pp1_layer3_expert5 -->
<g id="node1164" class="node">
<title>dp3_pp1_layer3_expert5</title>
<polygon fill="lightgreen" stroke="black" points="308217,-406.29 307993,-406.29 307993,-354.29 308217,-354.29 308217,-406.29"/>
<text text-anchor="middle" x="308105" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="308105" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="308105" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="308105" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert5 -->
<g id="edge1905" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308476.29,-467.38C308396.5,-453.44 308307,-436.25 308226,-417.06 308215.9,-414.67 308205.4,-411.94 308194.99,-409.07"/>
<polygon fill="black" stroke="black" points="308195.62,-405.62 308185.05,-406.3 308193.74,-412.36 308195.62,-405.62"/>
</g>
<!-- dp3_pp1_layer3_expert6 -->
<g id="node1165" class="node">
<title>dp3_pp1_layer3_expert6</title>
<polygon fill="lightgreen" stroke="black" points="308459,-406.29 308235,-406.29 308235,-354.29 308459,-354.29 308459,-406.29"/>
<text text-anchor="middle" x="308347" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="308347" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="308347" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="308347" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert6 -->
<g id="edge1906" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308558.94,-452.97C308515.16,-438.16 308468.94,-422.53 308430.87,-409.66"/>
<polygon fill="black" stroke="black" points="308431.97,-406.33 308421.38,-406.45 308429.73,-412.97 308431.97,-406.33"/>
</g>
<!-- dp3_pp1_layer3_expert7 -->
<g id="node1166" class="node">
<title>dp3_pp1_layer3_expert7</title>
<polygon fill="lightgreen" stroke="black" points="308701,-406.29 308477,-406.29 308477,-354.29 308701,-354.29 308701,-406.29"/>
<text text-anchor="middle" x="308589" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="308589" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="308589" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="308589" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert7 -->
<g id="edge1907" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308659.38,-452.71C308646.3,-439.43 308632.58,-425.51 308620.76,-413.52"/>
<polygon fill="black" stroke="black" points="308623.19,-411 308613.68,-406.33 308618.2,-415.91 308623.19,-411"/>
</g>
<!-- dp3_pp1_layer3_expert8 -->
<g id="node1167" class="node">
<title>dp3_pp1_layer3_expert8</title>
<polygon fill="lightgreen" stroke="black" points="308943,-406.29 308719,-406.29 308719,-354.29 308943,-354.29 308943,-406.29"/>
<text text-anchor="middle" x="308831" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="308831" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="308831" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="308831" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert8 -->
<g id="edge1908" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308760.61,-452.71C308773.7,-439.43 308787.42,-425.51 308799.23,-413.52"/>
<polygon fill="black" stroke="black" points="308801.79,-415.91 308806.32,-406.33 308796.81,-411 308801.79,-415.91"/>
</g>
<!-- dp3_pp1_layer3_expert9 -->
<g id="node1168" class="node">
<title>dp3_pp1_layer3_expert9</title>
<polygon fill="lightgreen" stroke="black" points="309185,-406.29 308961,-406.29 308961,-354.29 309185,-354.29 309185,-406.29"/>
<text text-anchor="middle" x="309073" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="309073" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="309073" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="309073" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert9 -->
<g id="edge1909" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308857.38,-454.21C308902.29,-439.03 308950.08,-422.86 308989.23,-409.62"/>
<polygon fill="black" stroke="black" points="308990.64,-412.84 308998.99,-406.32 308988.4,-406.21 308990.64,-412.84"/>
</g>
<!-- dp3_pp1_layer3_expert10 -->
<g id="node1169" class="node">
<title>dp3_pp1_layer3_expert10</title>
<polygon fill="lightgreen" stroke="black" points="309427,-406.29 309203,-406.29 309203,-354.29 309427,-354.29 309427,-406.29"/>
<text text-anchor="middle" x="309315" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="309315" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="309315" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="309315" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert10 -->
<g id="edge1910" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308880.89,-478.04C308973.98,-462.69 309090.88,-441.49 309194,-417.06 309204.09,-414.67 309214.6,-411.94 309225.01,-409.07"/>
<polygon fill="black" stroke="black" points="309226.26,-412.36 309234.95,-406.3 309224.37,-405.62 309226.26,-412.36"/>
</g>
<!-- dp3_pp1_layer3_expert11 -->
<g id="node1170" class="node">
<title>dp3_pp1_layer3_expert11</title>
<polygon fill="lightgreen" stroke="black" points="309669,-406.29 309445,-406.29 309445,-354.29 309669,-354.29 309669,-406.29"/>
<text text-anchor="middle" x="309557" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="309557" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="309557" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="309557" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert11 -->
<g id="edge1911" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308892.99,-490.7C309040.62,-477.88 309253.08,-454.78 309436,-417.06 309446.95,-414.8 309458.35,-412.02 309469.57,-409.02"/>
<polygon fill="black" stroke="black" points="309470.66,-412.35 309479.38,-406.33 309468.81,-405.6 309470.66,-412.35"/>
</g>
<!-- dp3_pp1_layer3_expert12 -->
<g id="node1171" class="node">
<title>dp3_pp1_layer3_expert12</title>
<polygon fill="lightgreen" stroke="black" points="309911,-406.29 309687,-406.29 309687,-354.29 309911,-354.29 309911,-406.29"/>
<text text-anchor="middle" x="309799" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="309799" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="309799" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="309799" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert12 -->
<g id="edge1912" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308900.27,-498.07C309096.59,-489.29 309410.95,-468.01 309678,-417.06 309689.43,-414.88 309701.33,-412.06 309713.01,-408.97"/>
<polygon fill="black" stroke="black" points="309714.02,-412.32 309722.75,-406.31 309712.18,-405.57 309714.02,-412.32"/>
</g>
<!-- dp3_pp1_layer3_expert13 -->
<g id="node1172" class="node">
<title>dp3_pp1_layer3_expert13</title>
<polygon fill="lightgreen" stroke="black" points="310153,-406.29 309929,-406.29 309929,-354.29 310153,-354.29 310153,-406.29"/>
<text text-anchor="middle" x="310041" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="310041" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="310041" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="310041" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert13 -->
<g id="edge1913" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308904.93,-502.93C309145.42,-498.58 309565.9,-481.35 309920,-417.06 309931.62,-414.95 309943.71,-412.14 309955.56,-409.03"/>
<polygon fill="black" stroke="black" points="309956.7,-412.34 309965.44,-406.34 309954.87,-405.59 309956.7,-412.34"/>
</g>
<!-- dp3_pp1_layer3_expert14 -->
<g id="node1173" class="node">
<title>dp3_pp1_layer3_expert14</title>
<polygon fill="lightgreen" stroke="black" points="310395,-406.29 310171,-406.29 310171,-354.29 310395,-354.29 310395,-406.29"/>
<text text-anchor="middle" x="310283" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="310283" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="310283" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="310283" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert14 -->
<g id="edge1914" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308900.32,-498.04C309237.17,-486.48 309925.15,-458.6 310162,-417.06 310173.92,-414.97 310186.32,-412.12 310198.46,-408.93"/>
<polygon fill="black" stroke="black" points="310199.38,-412.3 310208.11,-406.3 310197.54,-405.55 310199.38,-412.3"/>
</g>
<!-- dp3_pp1_layer3_expert15 -->
<g id="node1174" class="node">
<title>dp3_pp1_layer3_expert15</title>
<polygon fill="lightgreen" stroke="black" points="310637,-406.29 310413,-406.29 310413,-354.29 310637,-354.29 310637,-406.29"/>
<text text-anchor="middle" x="310525" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="310525" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="310525" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="310525" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert15 -->
<g id="edge1915" class="edge">
<title>dp3_pp1_layer3_router&#45;&gt;dp3_pp1_layer3_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M308901.94,-499.9C309282.49,-490.72 310120.35,-465.57 310404,-417.06 310416.01,-415.01 310428.51,-412.16 310440.73,-408.95"/>
<polygon fill="black" stroke="black" points="310441.72,-412.31 310450.45,-406.32 310439.88,-405.56 310441.72,-412.31"/>
</g>
<!-- dp3_pp1_layer3_expert_agg -->
<g id="node1175" class="node">
<title>dp3_pp1_layer3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="308957.57,-307.52 308563.74,-307.52 308462.43,-203.52 308856.26,-203.52 308957.57,-307.52"/>
<text text-anchor="middle" x="308710" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="308710" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="308710" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="308710" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer3_expert0&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1916" class="edge">
<title>dp3_pp1_layer3_expert0&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M306953.07,-354.29C306972.69,-346.92 306994.97,-339.72 307016,-335.52 307295.13,-279.86 308118.93,-263.21 308505.43,-258.4"/>
<polygon fill="black" stroke="black" points="308505.65,-261.9 308515.61,-258.27 308505.57,-254.9 308505.65,-261.9"/>
</g>
<!-- dp3_pp1_layer3_expert1&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1917" class="edge">
<title>dp3_pp1_layer3_expert1&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M307195.39,-354.27C307214.95,-346.95 307237.09,-339.78 307258,-335.52 307490.8,-288.16 308166.09,-267.74 308507.43,-260.24"/>
<polygon fill="black" stroke="black" points="308507.51,-263.74 308517.43,-260.03 308507.35,-256.74 308507.51,-263.74"/>
</g>
<!-- dp3_pp1_layer3_expert2&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1918" class="edge">
<title>dp3_pp1_layer3_expert2&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M307437.73,-354.29C307457.21,-347.01 307479.23,-339.87 307500,-335.52 307686.91,-296.44 308216.54,-273.07 308509.3,-262.78"/>
<polygon fill="black" stroke="black" points="308509.74,-266.27 308519.61,-262.42 308509.5,-259.27 308509.74,-266.27"/>
</g>
<!-- dp3_pp1_layer3_expert3&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1919" class="edge">
<title>dp3_pp1_layer3_expert3&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M307680.39,-354.26C307699.72,-347.07 307721.48,-339.99 307742,-335.52 308000.91,-279.18 308306.7,-262.24 308504.26,-257.56"/>
<polygon fill="black" stroke="black" points="308504.55,-261.06 308514.47,-257.33 308504.39,-254.06 308504.55,-261.06"/>
</g>
<!-- dp3_pp1_layer3_expert4&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1920" class="edge">
<title>dp3_pp1_layer3_expert4&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M307923.39,-354.24C307942.49,-347.2 307963.87,-340.19 307984,-335.52 308159.82,-294.77 308364.6,-274.91 308511.75,-265.31"/>
<polygon fill="black" stroke="black" points="308512.05,-268.8 308521.81,-264.67 308511.6,-261.82 308512.05,-268.8"/>
</g>
<!-- dp3_pp1_layer3_expert5&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1921" class="edge">
<title>dp3_pp1_layer3_expert5&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M308167.42,-354.22C308186.04,-347.42 308206.65,-340.55 308226,-335.52 308323.09,-310.27 308433.34,-291.53 308524.07,-278.65"/>
<polygon fill="black" stroke="black" points="308524.78,-282.09 308534.19,-277.23 308523.8,-275.16 308524.78,-282.09"/>
</g>
<!-- dp3_pp1_layer3_expert6&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1922" class="edge">
<title>dp3_pp1_layer3_expert6&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M308415.02,-354.26C308432.26,-348.03 308450.78,-341.44 308468,-335.52 308494.73,-326.33 308523.21,-316.8 308550.89,-307.67"/>
<polygon fill="black" stroke="black" points="308552.24,-310.91 308560.65,-304.46 308550.06,-304.26 308552.24,-310.91"/>
</g>
<!-- dp3_pp1_layer3_expert7&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1923" class="edge">
<title>dp3_pp1_layer3_expert7&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M308613.78,-354.15C308625.02,-342.74 308638.83,-328.73 308652.45,-314.92"/>
<polygon fill="black" stroke="black" points="308655,-317.31 308659.53,-307.73 308650.02,-312.39 308655,-317.31"/>
</g>
<!-- dp3_pp1_layer3_expert8&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1924" class="edge">
<title>dp3_pp1_layer3_expert8&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M308806.22,-354.15C308794.97,-342.74 308781.16,-328.73 308767.55,-314.92"/>
<polygon fill="black" stroke="black" points="308769.98,-312.39 308760.47,-307.73 308764.99,-317.31 308769.98,-312.39"/>
</g>
<!-- dp3_pp1_layer3_expert9&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1925" class="edge">
<title>dp3_pp1_layer3_expert9&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M309004.98,-354.26C308987.73,-348.03 308969.21,-341.44 308952,-335.52 308928.29,-327.37 308903.21,-318.95 308878.53,-310.78"/>
<polygon fill="black" stroke="black" points="308879.32,-307.36 308868.73,-307.54 308877.12,-314 308879.32,-307.36"/>
</g>
<!-- dp3_pp1_layer3_expert10&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1926" class="edge">
<title>dp3_pp1_layer3_expert10&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M309252.58,-354.22C309233.96,-347.42 309213.35,-340.55 309194,-335.52 309113.99,-314.71 309025.05,-298.33 308945.46,-286"/>
<polygon fill="black" stroke="black" points="308945.71,-282.5 308935.3,-284.44 308944.65,-289.41 308945.71,-282.5"/>
</g>
<!-- dp3_pp1_layer3_expert11&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1927" class="edge">
<title>dp3_pp1_layer3_expert11&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M309496.61,-354.24C309477.51,-347.2 309456.13,-340.19 309436,-335.52 309267.74,-296.53 309072.97,-276.66 308927.55,-266.61"/>
<polygon fill="black" stroke="black" points="308927.38,-263.09 308917.16,-265.9 308926.9,-270.07 308927.38,-263.09"/>
</g>
<!-- dp3_pp1_layer3_expert12&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1928" class="edge">
<title>dp3_pp1_layer3_expert12&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M309739.61,-354.26C309720.28,-347.07 309698.52,-339.99 309678,-335.52 309420.51,-279.49 309116.64,-262.43 308918.99,-257.64"/>
<polygon fill="black" stroke="black" points="308918.86,-254.14 308908.78,-257.4 308918.69,-261.13 308918.86,-254.14"/>
</g>
<!-- dp3_pp1_layer3_expert13&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1929" class="edge">
<title>dp3_pp1_layer3_expert13&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M309982.27,-354.29C309962.79,-347.01 309940.77,-339.87 309920,-335.52 309736.02,-297.05 309219.97,-273.81 308924.63,-263.27"/>
<polygon fill="black" stroke="black" points="308924.33,-259.76 308914.21,-262.9 308924.08,-266.76 308924.33,-259.76"/>
</g>
<!-- dp3_pp1_layer3_expert14&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1930" class="edge">
<title>dp3_pp1_layer3_expert14&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M310224.6,-354.27C310205.05,-346.95 310182.9,-339.78 310162,-335.52 309931.27,-288.58 309265.86,-268.1 308921.74,-260.45"/>
<polygon fill="black" stroke="black" points="308921.73,-256.94 308911.65,-260.22 308921.57,-263.94 308921.73,-256.94"/>
</g>
<!-- dp3_pp1_layer3_expert15&#45;&gt;dp3_pp1_layer3_expert_agg -->
<g id="edge1931" class="edge">
<title>dp3_pp1_layer3_expert15&#45;&gt;dp3_pp1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M310466.93,-354.29C310447.3,-346.92 310425.03,-339.72 310404,-335.52 310126.21,-280.12 309308.98,-263.37 308920.17,-258.47"/>
<polygon fill="black" stroke="black" points="308919.97,-254.97 308909.93,-258.34 308919.88,-261.97 308919.97,-254.97"/>
</g>
<!-- dp3_pp1_layer4_attn_tp0 -->
<g id="node1176" class="node">
<title>dp3_pp1_layer4_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="306192.5,-531.06 305927.5,-531.06 305927.5,-479.06 306192.5,-479.06 306192.5,-531.06"/>
<text text-anchor="middle" x="306060" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="306060" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="306060" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="306060" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer3_expert_agg&#45;&gt;dp3_pp1_layer4_attn_tp0 -->
<g id="edge1933" class="edge">
<title>dp3_pp1_layer3_expert_agg&#45;&gt;dp3_pp1_layer4_attn_tp0</title>
<path fill="none" stroke="black" d="M308517.78,-260.41C308097.38,-269.54 307107.17,-294.77 306774,-335.52 306741.8,-339.46 306233.23,-444.29 306202,-453.06 306179.37,-459.41 306155.16,-467.58 306133.26,-475.5"/>
<polygon fill="black" stroke="black" points="306131.89,-472.28 306123.7,-479 306134.29,-478.85 306131.89,-472.28"/>
</g>
<!-- dp3_pp1_layer4_attn_allreduce -->
<g id="node1177" class="node">
<title>dp3_pp1_layer4_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="306189" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="306189" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="306189" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="306189" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="306189" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_attn_tp0&#45;&gt;dp3_pp1_layer4_attn_allreduce -->
<g id="edge1934" class="edge">
<title>dp3_pp1_layer4_attn_tp0&#45;&gt;dp3_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M306086.41,-478.92C306103.15,-463 306125.21,-442 306144.58,-423.56"/>
<polygon fill="black" stroke="black" points="306147.03,-426.07 306151.86,-416.64 306142.2,-421 306147.03,-426.07"/>
</g>
<!-- dp3_pp1_layer4_router -->
<g id="node1181" class="node">
<title>dp3_pp1_layer4_router</title>
<polygon fill="lightyellow" stroke="black" points="303940.57,-557.06 303546.74,-557.06 303445.43,-453.06 303839.26,-453.06 303940.57,-557.06"/>
<text text-anchor="middle" x="303693" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="303693" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="303693" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="303693" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_attn_allreduce&#45;&gt;dp3_pp1_layer4_router -->
<g id="edge1970" class="edge">
<title>dp3_pp1_layer4_attn_allreduce&#45;&gt;dp3_pp1_layer4_router</title>
<path fill="none" stroke="black" d="M306029.08,-392.38C305917.77,-399.9 305765.89,-409.76 305632,-417.06 304996.5,-451.72 304243.28,-482.59 303891.96,-496.4"/>
<polygon fill="black" stroke="black" points="303891.8,-492.91 303881.94,-496.79 303892.07,-499.9 303891.8,-492.91"/>
</g>
<!-- dp3_pp1_layer4_attn_tp1 -->
<g id="node1178" class="node">
<title>dp3_pp1_layer4_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="306475.5,-531.06 306210.5,-531.06 306210.5,-479.06 306475.5,-479.06 306475.5,-531.06"/>
<text text-anchor="middle" x="306343" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="306343" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="306343" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="306343" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer4_attn_tp1&#45;&gt;dp3_pp1_layer4_attn_allreduce -->
<g id="edge1935" class="edge">
<title>dp3_pp1_layer4_attn_tp1&#45;&gt;dp3_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M306311.46,-478.92C306290.99,-462.6 306263.83,-440.94 306240.29,-422.18"/>
<polygon fill="black" stroke="black" points="306242.46,-419.44 306232.46,-415.94 306238.1,-424.91 306242.46,-419.44"/>
</g>
<!-- dp3_pp1_layer4_attn_tp2 -->
<g id="node1179" class="node">
<title>dp3_pp1_layer4_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="305909.5,-531.06 305644.5,-531.06 305644.5,-479.06 305909.5,-479.06 305909.5,-531.06"/>
<text text-anchor="middle" x="305777" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="305777" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="305777" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="305777" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer4_attn_tp2&#45;&gt;dp3_pp1_layer4_attn_allreduce -->
<g id="edge1936" class="edge">
<title>dp3_pp1_layer4_attn_tp2&#45;&gt;dp3_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M305843.07,-479.02C305866.85,-470.35 305893.99,-460.86 305919,-453.06 305967.74,-437.86 306022.05,-423.03 306069.1,-410.83"/>
<polygon fill="black" stroke="black" points="306070.22,-414.15 306079.03,-408.26 306068.47,-407.38 306070.22,-414.15"/>
</g>
<!-- dp3_pp1_layer4_attn_tp3 -->
<g id="node1180" class="node">
<title>dp3_pp1_layer4_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="306758.5,-531.06 306493.5,-531.06 306493.5,-479.06 306758.5,-479.06 306758.5,-531.06"/>
<text text-anchor="middle" x="306626" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="306626" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="306626" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="306626" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer4_attn_tp3&#45;&gt;dp3_pp1_layer4_attn_allreduce -->
<g id="edge1937" class="edge">
<title>dp3_pp1_layer4_attn_tp3&#45;&gt;dp3_pp1_layer4_attn_allreduce</title>
<path fill="none" stroke="black" d="M306561.21,-478.95C306537.43,-470.18 306510.17,-460.64 306485,-453.06 306430.42,-436.63 306369.31,-421.31 306316.86,-409.08"/>
<polygon fill="black" stroke="black" points="306317.37,-405.6 306306.83,-406.75 306315.78,-412.42 306317.37,-405.6"/>
</g>
<!-- dp3_pp1_layer4_expert0 -->
<g id="node1182" class="node">
<title>dp3_pp1_layer4_expert0</title>
<polygon fill="lightgreen" stroke="black" points="301990,-406.29 301766,-406.29 301766,-354.29 301990,-354.29 301990,-406.29"/>
<text text-anchor="middle" x="301878" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="301878" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="301878" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="301878" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert0 -->
<g id="edge1938" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303490.73,-499.65C303105.55,-490.26 302280.11,-465.13 301999,-417.06 301986.99,-415.01 301974.48,-412.16 301962.27,-408.95"/>
<polygon fill="black" stroke="black" points="301963.11,-405.56 301952.54,-406.32 301961.28,-412.31 301963.11,-405.56"/>
</g>
<!-- dp3_pp1_layer4_expert1 -->
<g id="node1183" class="node">
<title>dp3_pp1_layer4_expert1</title>
<polygon fill="lightgreen" stroke="black" points="302232,-406.29 302008,-406.29 302008,-354.29 302232,-354.29 302232,-406.29"/>
<text text-anchor="middle" x="302120" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="302120" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="302120" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="302120" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert1 -->
<g id="edge1939" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303488.55,-497.55C303146.94,-485.71 302474.58,-458.03 302241,-417.06 302229.08,-414.97 302216.67,-412.12 302204.54,-408.93"/>
<polygon fill="black" stroke="black" points="302205.45,-405.55 302194.89,-406.3 302203.62,-412.3 302205.45,-405.55"/>
</g>
<!-- dp3_pp1_layer4_expert2 -->
<g id="node1184" class="node">
<title>dp3_pp1_layer4_expert2</title>
<polygon fill="lightgreen" stroke="black" points="302474,-406.29 302250,-406.29 302250,-354.29 302474,-354.29 302474,-406.29"/>
<text text-anchor="middle" x="302362" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="302362" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="302362" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="302362" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert2 -->
<g id="edge1940" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303493.82,-502.85C303252.66,-498.37 302835.02,-480.97 302483,-417.06 302471.38,-414.95 302459.29,-412.14 302447.44,-409.03"/>
<polygon fill="black" stroke="black" points="302448.13,-405.59 302437.56,-406.34 302446.29,-412.34 302448.13,-405.59"/>
</g>
<!-- dp3_pp1_layer4_expert3 -->
<g id="node1185" class="node">
<title>dp3_pp1_layer4_expert3</title>
<polygon fill="lightgreen" stroke="black" points="302716,-406.29 302492,-406.29 302492,-354.29 302716,-354.29 302716,-406.29"/>
<text text-anchor="middle" x="302604" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="302604" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="302604" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="302604" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert3 -->
<g id="edge1941" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303488.36,-497.41C303291.31,-488.25 302985.63,-466.79 302725,-417.06 302713.57,-414.88 302701.67,-412.06 302689.99,-408.97"/>
<polygon fill="black" stroke="black" points="302690.82,-405.57 302680.25,-406.31 302688.98,-412.32 302690.82,-405.57"/>
</g>
<!-- dp3_pp1_layer4_expert4 -->
<g id="node1186" class="node">
<title>dp3_pp1_layer4_expert4</title>
<polygon fill="lightgreen" stroke="black" points="302958,-406.29 302734,-406.29 302734,-354.29 302958,-354.29 302958,-406.29"/>
<text text-anchor="middle" x="302846" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="302846" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="302846" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="302846" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert4 -->
<g id="edge1942" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303479.43,-487.98C303333.99,-474.71 303137.64,-452.25 302967,-417.06 302956.05,-414.8 302944.65,-412.02 302933.43,-409.02"/>
<polygon fill="black" stroke="black" points="302934.19,-405.6 302923.62,-406.33 302932.34,-412.35 302934.19,-405.6"/>
</g>
<!-- dp3_pp1_layer4_expert5 -->
<g id="node1187" class="node">
<title>dp3_pp1_layer4_expert5</title>
<polygon fill="lightgreen" stroke="black" points="303200,-406.29 302976,-406.29 302976,-354.29 303200,-354.29 303200,-406.29"/>
<text text-anchor="middle" x="303088" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="303088" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="303088" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="303088" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert5 -->
<g id="edge1943" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303459.29,-467.38C303379.5,-453.44 303290,-436.25 303209,-417.06 303198.9,-414.67 303188.4,-411.94 303177.99,-409.07"/>
<polygon fill="black" stroke="black" points="303178.62,-405.62 303168.05,-406.3 303176.74,-412.36 303178.62,-405.62"/>
</g>
<!-- dp3_pp1_layer4_expert6 -->
<g id="node1188" class="node">
<title>dp3_pp1_layer4_expert6</title>
<polygon fill="lightgreen" stroke="black" points="303442,-406.29 303218,-406.29 303218,-354.29 303442,-354.29 303442,-406.29"/>
<text text-anchor="middle" x="303330" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="303330" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="303330" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="303330" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert6 -->
<g id="edge1944" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303541.94,-452.97C303498.16,-438.16 303451.94,-422.53 303413.87,-409.66"/>
<polygon fill="black" stroke="black" points="303414.97,-406.33 303404.38,-406.45 303412.73,-412.97 303414.97,-406.33"/>
</g>
<!-- dp3_pp1_layer4_expert7 -->
<g id="node1189" class="node">
<title>dp3_pp1_layer4_expert7</title>
<polygon fill="lightgreen" stroke="black" points="303684,-406.29 303460,-406.29 303460,-354.29 303684,-354.29 303684,-406.29"/>
<text text-anchor="middle" x="303572" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="303572" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="303572" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="303572" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert7 -->
<g id="edge1945" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303642.38,-452.71C303629.3,-439.43 303615.58,-425.51 303603.76,-413.52"/>
<polygon fill="black" stroke="black" points="303606.19,-411 303596.68,-406.33 303601.2,-415.91 303606.19,-411"/>
</g>
<!-- dp3_pp1_layer4_expert8 -->
<g id="node1190" class="node">
<title>dp3_pp1_layer4_expert8</title>
<polygon fill="lightgreen" stroke="black" points="303926,-406.29 303702,-406.29 303702,-354.29 303926,-354.29 303926,-406.29"/>
<text text-anchor="middle" x="303814" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="303814" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="303814" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="303814" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert8 -->
<g id="edge1946" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303743.61,-452.71C303756.7,-439.43 303770.42,-425.51 303782.23,-413.52"/>
<polygon fill="black" stroke="black" points="303784.79,-415.91 303789.32,-406.33 303779.81,-411 303784.79,-415.91"/>
</g>
<!-- dp3_pp1_layer4_expert9 -->
<g id="node1191" class="node">
<title>dp3_pp1_layer4_expert9</title>
<polygon fill="lightgreen" stroke="black" points="304168,-406.29 303944,-406.29 303944,-354.29 304168,-354.29 304168,-406.29"/>
<text text-anchor="middle" x="304056" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="304056" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="304056" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="304056" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert9 -->
<g id="edge1947" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303840.38,-454.21C303885.29,-439.03 303933.08,-422.86 303972.23,-409.62"/>
<polygon fill="black" stroke="black" points="303973.64,-412.84 303981.99,-406.32 303971.4,-406.21 303973.64,-412.84"/>
</g>
<!-- dp3_pp1_layer4_expert10 -->
<g id="node1192" class="node">
<title>dp3_pp1_layer4_expert10</title>
<polygon fill="lightgreen" stroke="black" points="304410,-406.29 304186,-406.29 304186,-354.29 304410,-354.29 304410,-406.29"/>
<text text-anchor="middle" x="304298" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="304298" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="304298" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="304298" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert10 -->
<g id="edge1948" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303863.89,-478.04C303956.98,-462.69 304073.88,-441.49 304177,-417.06 304187.09,-414.67 304197.6,-411.94 304208.01,-409.07"/>
<polygon fill="black" stroke="black" points="304209.26,-412.36 304217.95,-406.3 304207.37,-405.62 304209.26,-412.36"/>
</g>
<!-- dp3_pp1_layer4_expert11 -->
<g id="node1193" class="node">
<title>dp3_pp1_layer4_expert11</title>
<polygon fill="lightgreen" stroke="black" points="304652,-406.29 304428,-406.29 304428,-354.29 304652,-354.29 304652,-406.29"/>
<text text-anchor="middle" x="304540" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="304540" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="304540" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="304540" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert11 -->
<g id="edge1949" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303875.99,-490.7C304023.62,-477.88 304236.08,-454.78 304419,-417.06 304429.95,-414.8 304441.35,-412.02 304452.57,-409.02"/>
<polygon fill="black" stroke="black" points="304453.66,-412.35 304462.38,-406.33 304451.81,-405.6 304453.66,-412.35"/>
</g>
<!-- dp3_pp1_layer4_expert12 -->
<g id="node1194" class="node">
<title>dp3_pp1_layer4_expert12</title>
<polygon fill="lightgreen" stroke="black" points="304894,-406.29 304670,-406.29 304670,-354.29 304894,-354.29 304894,-406.29"/>
<text text-anchor="middle" x="304782" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="304782" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="304782" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="304782" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert12 -->
<g id="edge1950" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303883.27,-498.07C304079.59,-489.29 304393.95,-468.01 304661,-417.06 304672.43,-414.88 304684.33,-412.06 304696.01,-408.97"/>
<polygon fill="black" stroke="black" points="304697.02,-412.32 304705.75,-406.31 304695.18,-405.57 304697.02,-412.32"/>
</g>
<!-- dp3_pp1_layer4_expert13 -->
<g id="node1195" class="node">
<title>dp3_pp1_layer4_expert13</title>
<polygon fill="lightgreen" stroke="black" points="305136,-406.29 304912,-406.29 304912,-354.29 305136,-354.29 305136,-406.29"/>
<text text-anchor="middle" x="305024" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="305024" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="305024" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="305024" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert13 -->
<g id="edge1951" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303887.93,-502.93C304128.42,-498.58 304548.9,-481.35 304903,-417.06 304914.62,-414.95 304926.71,-412.14 304938.56,-409.03"/>
<polygon fill="black" stroke="black" points="304939.7,-412.34 304948.44,-406.34 304937.87,-405.59 304939.7,-412.34"/>
</g>
<!-- dp3_pp1_layer4_expert14 -->
<g id="node1196" class="node">
<title>dp3_pp1_layer4_expert14</title>
<polygon fill="lightgreen" stroke="black" points="305378,-406.29 305154,-406.29 305154,-354.29 305378,-354.29 305378,-406.29"/>
<text text-anchor="middle" x="305266" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="305266" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="305266" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="305266" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert14 -->
<g id="edge1952" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303883.32,-498.04C304220.17,-486.48 304908.15,-458.6 305145,-417.06 305156.92,-414.97 305169.32,-412.12 305181.46,-408.93"/>
<polygon fill="black" stroke="black" points="305182.38,-412.3 305191.11,-406.3 305180.54,-405.55 305182.38,-412.3"/>
</g>
<!-- dp3_pp1_layer4_expert15 -->
<g id="node1197" class="node">
<title>dp3_pp1_layer4_expert15</title>
<polygon fill="lightgreen" stroke="black" points="305620,-406.29 305396,-406.29 305396,-354.29 305620,-354.29 305620,-406.29"/>
<text text-anchor="middle" x="305508" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="305508" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="305508" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="305508" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert15 -->
<g id="edge1953" class="edge">
<title>dp3_pp1_layer4_router&#45;&gt;dp3_pp1_layer4_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M303884.94,-499.9C304265.49,-490.72 305103.35,-465.57 305387,-417.06 305399.01,-415.01 305411.51,-412.16 305423.73,-408.95"/>
<polygon fill="black" stroke="black" points="305424.72,-412.31 305433.45,-406.32 305422.88,-405.56 305424.72,-412.31"/>
</g>
<!-- dp3_pp1_layer4_expert_agg -->
<g id="node1198" class="node">
<title>dp3_pp1_layer4_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="303940.57,-307.52 303546.74,-307.52 303445.43,-203.52 303839.26,-203.52 303940.57,-307.52"/>
<text text-anchor="middle" x="303693" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="303693" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="303693" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="303693" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer4_expert0&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1954" class="edge">
<title>dp3_pp1_layer4_expert0&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M301936.07,-354.29C301955.69,-346.92 301977.97,-339.72 301999,-335.52 302278.13,-279.86 303101.93,-263.21 303488.43,-258.4"/>
<polygon fill="black" stroke="black" points="303488.65,-261.9 303498.61,-258.27 303488.57,-254.9 303488.65,-261.9"/>
</g>
<!-- dp3_pp1_layer4_expert1&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1955" class="edge">
<title>dp3_pp1_layer4_expert1&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M302178.39,-354.27C302197.95,-346.95 302220.09,-339.78 302241,-335.52 302473.8,-288.16 303149.09,-267.74 303490.43,-260.24"/>
<polygon fill="black" stroke="black" points="303490.51,-263.74 303500.43,-260.03 303490.35,-256.74 303490.51,-263.74"/>
</g>
<!-- dp3_pp1_layer4_expert2&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1956" class="edge">
<title>dp3_pp1_layer4_expert2&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M302420.73,-354.29C302440.21,-347.01 302462.23,-339.87 302483,-335.52 302669.91,-296.44 303199.54,-273.07 303492.3,-262.78"/>
<polygon fill="black" stroke="black" points="303492.74,-266.27 303502.61,-262.42 303492.5,-259.27 303492.74,-266.27"/>
</g>
<!-- dp3_pp1_layer4_expert3&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1957" class="edge">
<title>dp3_pp1_layer4_expert3&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M302663.39,-354.26C302682.72,-347.07 302704.48,-339.99 302725,-335.52 302983.91,-279.18 303289.7,-262.24 303487.26,-257.56"/>
<polygon fill="black" stroke="black" points="303487.55,-261.06 303497.47,-257.33 303487.39,-254.06 303487.55,-261.06"/>
</g>
<!-- dp3_pp1_layer4_expert4&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1958" class="edge">
<title>dp3_pp1_layer4_expert4&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M302906.39,-354.24C302925.49,-347.2 302946.87,-340.19 302967,-335.52 303142.82,-294.77 303347.6,-274.91 303494.75,-265.31"/>
<polygon fill="black" stroke="black" points="303495.05,-268.8 303504.81,-264.67 303494.6,-261.82 303495.05,-268.8"/>
</g>
<!-- dp3_pp1_layer4_expert5&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1959" class="edge">
<title>dp3_pp1_layer4_expert5&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M303150.42,-354.22C303169.04,-347.42 303189.65,-340.55 303209,-335.52 303306.09,-310.27 303416.34,-291.53 303507.07,-278.65"/>
<polygon fill="black" stroke="black" points="303507.78,-282.09 303517.19,-277.23 303506.8,-275.16 303507.78,-282.09"/>
</g>
<!-- dp3_pp1_layer4_expert6&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1960" class="edge">
<title>dp3_pp1_layer4_expert6&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M303398.02,-354.26C303415.26,-348.03 303433.78,-341.44 303451,-335.52 303477.73,-326.33 303506.21,-316.8 303533.89,-307.67"/>
<polygon fill="black" stroke="black" points="303535.24,-310.91 303543.65,-304.46 303533.06,-304.26 303535.24,-310.91"/>
</g>
<!-- dp3_pp1_layer4_expert7&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1961" class="edge">
<title>dp3_pp1_layer4_expert7&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M303596.78,-354.15C303608.02,-342.74 303621.83,-328.73 303635.45,-314.92"/>
<polygon fill="black" stroke="black" points="303638,-317.31 303642.53,-307.73 303633.02,-312.39 303638,-317.31"/>
</g>
<!-- dp3_pp1_layer4_expert8&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1962" class="edge">
<title>dp3_pp1_layer4_expert8&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M303789.22,-354.15C303777.97,-342.74 303764.16,-328.73 303750.55,-314.92"/>
<polygon fill="black" stroke="black" points="303752.98,-312.39 303743.47,-307.73 303747.99,-317.31 303752.98,-312.39"/>
</g>
<!-- dp3_pp1_layer4_expert9&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1963" class="edge">
<title>dp3_pp1_layer4_expert9&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M303987.98,-354.26C303970.73,-348.03 303952.21,-341.44 303935,-335.52 303911.29,-327.37 303886.21,-318.95 303861.53,-310.78"/>
<polygon fill="black" stroke="black" points="303862.32,-307.36 303851.73,-307.54 303860.12,-314 303862.32,-307.36"/>
</g>
<!-- dp3_pp1_layer4_expert10&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1964" class="edge">
<title>dp3_pp1_layer4_expert10&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M304235.58,-354.22C304216.96,-347.42 304196.35,-340.55 304177,-335.52 304096.99,-314.71 304008.05,-298.33 303928.46,-286"/>
<polygon fill="black" stroke="black" points="303928.71,-282.5 303918.3,-284.44 303927.65,-289.41 303928.71,-282.5"/>
</g>
<!-- dp3_pp1_layer4_expert11&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1965" class="edge">
<title>dp3_pp1_layer4_expert11&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M304479.61,-354.24C304460.51,-347.2 304439.13,-340.19 304419,-335.52 304250.74,-296.53 304055.97,-276.66 303910.55,-266.61"/>
<polygon fill="black" stroke="black" points="303910.38,-263.09 303900.16,-265.9 303909.9,-270.07 303910.38,-263.09"/>
</g>
<!-- dp3_pp1_layer4_expert12&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1966" class="edge">
<title>dp3_pp1_layer4_expert12&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M304722.61,-354.26C304703.28,-347.07 304681.52,-339.99 304661,-335.52 304403.51,-279.49 304099.64,-262.43 303901.99,-257.64"/>
<polygon fill="black" stroke="black" points="303901.86,-254.14 303891.78,-257.4 303901.69,-261.13 303901.86,-254.14"/>
</g>
<!-- dp3_pp1_layer4_expert13&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1967" class="edge">
<title>dp3_pp1_layer4_expert13&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M304965.27,-354.29C304945.79,-347.01 304923.77,-339.87 304903,-335.52 304719.02,-297.05 304202.97,-273.81 303907.63,-263.27"/>
<polygon fill="black" stroke="black" points="303907.33,-259.76 303897.21,-262.9 303907.08,-266.76 303907.33,-259.76"/>
</g>
<!-- dp3_pp1_layer4_expert14&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1968" class="edge">
<title>dp3_pp1_layer4_expert14&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M305207.6,-354.27C305188.05,-346.95 305165.9,-339.78 305145,-335.52 304914.27,-288.58 304248.86,-268.1 303904.74,-260.45"/>
<polygon fill="black" stroke="black" points="303904.73,-256.94 303894.65,-260.22 303904.57,-263.94 303904.73,-256.94"/>
</g>
<!-- dp3_pp1_layer4_expert15&#45;&gt;dp3_pp1_layer4_expert_agg -->
<g id="edge1969" class="edge">
<title>dp3_pp1_layer4_expert15&#45;&gt;dp3_pp1_layer4_expert_agg</title>
<path fill="none" stroke="black" d="M305449.93,-354.29C305430.3,-346.92 305408.03,-339.72 305387,-335.52 305109.21,-280.12 304291.98,-263.37 303903.17,-258.47"/>
<polygon fill="black" stroke="black" points="303902.97,-254.97 303892.93,-258.34 303902.88,-261.97 303902.97,-254.97"/>
</g>
<!-- dp3_pp1_layer5_attn_tp0 -->
<g id="node1199" class="node">
<title>dp3_pp1_layer5_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="301175.5,-531.06 300910.5,-531.06 300910.5,-479.06 301175.5,-479.06 301175.5,-531.06"/>
<text text-anchor="middle" x="301043" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="301043" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="301043" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="301043" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer4_expert_agg&#45;&gt;dp3_pp1_layer5_attn_tp0 -->
<g id="edge1971" class="edge">
<title>dp3_pp1_layer4_expert_agg&#45;&gt;dp3_pp1_layer5_attn_tp0</title>
<path fill="none" stroke="black" d="M303500.78,-260.41C303080.38,-269.54 302090.17,-294.77 301757,-335.52 301724.8,-339.46 301216.23,-444.29 301185,-453.06 301162.37,-459.41 301138.16,-467.58 301116.26,-475.5"/>
<polygon fill="black" stroke="black" points="301114.89,-472.28 301106.7,-479 301117.29,-478.85 301114.89,-472.28"/>
</g>
<!-- dp3_pp1_layer5_attn_allreduce -->
<g id="node1200" class="node">
<title>dp3_pp1_layer5_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="301172" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="301172" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="301172" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="301172" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="301172" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_attn_tp0&#45;&gt;dp3_pp1_layer5_attn_allreduce -->
<g id="edge1972" class="edge">
<title>dp3_pp1_layer5_attn_tp0&#45;&gt;dp3_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M301069.41,-478.92C301086.15,-463 301108.21,-442 301127.58,-423.56"/>
<polygon fill="black" stroke="black" points="301130.03,-426.07 301134.86,-416.64 301125.2,-421 301130.03,-426.07"/>
</g>
<!-- dp3_pp1_layer5_router -->
<g id="node1204" class="node">
<title>dp3_pp1_layer5_router</title>
<polygon fill="lightyellow" stroke="black" points="298923.57,-557.06 298529.74,-557.06 298428.43,-453.06 298822.26,-453.06 298923.57,-557.06"/>
<text text-anchor="middle" x="298676" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="298676" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="298676" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="298676" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_attn_allreduce&#45;&gt;dp3_pp1_layer5_router -->
<g id="edge2008" class="edge">
<title>dp3_pp1_layer5_attn_allreduce&#45;&gt;dp3_pp1_layer5_router</title>
<path fill="none" stroke="black" d="M301012.08,-392.38C300900.77,-399.9 300748.89,-409.76 300615,-417.06 299979.5,-451.72 299226.28,-482.59 298874.96,-496.4"/>
<polygon fill="black" stroke="black" points="298874.8,-492.91 298864.94,-496.79 298875.07,-499.9 298874.8,-492.91"/>
</g>
<!-- dp3_pp1_layer5_attn_tp1 -->
<g id="node1201" class="node">
<title>dp3_pp1_layer5_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="301458.5,-531.06 301193.5,-531.06 301193.5,-479.06 301458.5,-479.06 301458.5,-531.06"/>
<text text-anchor="middle" x="301326" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="301326" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="301326" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="301326" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer5_attn_tp1&#45;&gt;dp3_pp1_layer5_attn_allreduce -->
<g id="edge1973" class="edge">
<title>dp3_pp1_layer5_attn_tp1&#45;&gt;dp3_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M301294.46,-478.92C301273.99,-462.6 301246.83,-440.94 301223.29,-422.18"/>
<polygon fill="black" stroke="black" points="301225.46,-419.44 301215.46,-415.94 301221.1,-424.91 301225.46,-419.44"/>
</g>
<!-- dp3_pp1_layer5_attn_tp2 -->
<g id="node1202" class="node">
<title>dp3_pp1_layer5_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="300892.5,-531.06 300627.5,-531.06 300627.5,-479.06 300892.5,-479.06 300892.5,-531.06"/>
<text text-anchor="middle" x="300760" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="300760" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="300760" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="300760" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer5_attn_tp2&#45;&gt;dp3_pp1_layer5_attn_allreduce -->
<g id="edge1974" class="edge">
<title>dp3_pp1_layer5_attn_tp2&#45;&gt;dp3_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M300826.07,-479.02C300849.85,-470.35 300876.99,-460.86 300902,-453.06 300950.74,-437.86 301005.05,-423.03 301052.1,-410.83"/>
<polygon fill="black" stroke="black" points="301053.22,-414.15 301062.03,-408.26 301051.47,-407.38 301053.22,-414.15"/>
</g>
<!-- dp3_pp1_layer5_attn_tp3 -->
<g id="node1203" class="node">
<title>dp3_pp1_layer5_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="301741.5,-531.06 301476.5,-531.06 301476.5,-479.06 301741.5,-479.06 301741.5,-531.06"/>
<text text-anchor="middle" x="301609" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="301609" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="301609" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="301609" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer5_attn_tp3&#45;&gt;dp3_pp1_layer5_attn_allreduce -->
<g id="edge1975" class="edge">
<title>dp3_pp1_layer5_attn_tp3&#45;&gt;dp3_pp1_layer5_attn_allreduce</title>
<path fill="none" stroke="black" d="M301544.21,-478.95C301520.43,-470.18 301493.17,-460.64 301468,-453.06 301413.42,-436.63 301352.31,-421.31 301299.86,-409.08"/>
<polygon fill="black" stroke="black" points="301300.37,-405.6 301289.83,-406.75 301298.78,-412.42 301300.37,-405.6"/>
</g>
<!-- dp3_pp1_layer5_expert0 -->
<g id="node1205" class="node">
<title>dp3_pp1_layer5_expert0</title>
<polygon fill="lightgreen" stroke="black" points="296973,-406.29 296749,-406.29 296749,-354.29 296973,-354.29 296973,-406.29"/>
<text text-anchor="middle" x="296861" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="296861" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="296861" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="296861" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert0 -->
<g id="edge1976" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298473.73,-499.65C298088.55,-490.26 297263.11,-465.13 296982,-417.06 296969.99,-415.01 296957.48,-412.16 296945.27,-408.95"/>
<polygon fill="black" stroke="black" points="296946.11,-405.56 296935.54,-406.32 296944.28,-412.31 296946.11,-405.56"/>
</g>
<!-- dp3_pp1_layer5_expert1 -->
<g id="node1206" class="node">
<title>dp3_pp1_layer5_expert1</title>
<polygon fill="lightgreen" stroke="black" points="297215,-406.29 296991,-406.29 296991,-354.29 297215,-354.29 297215,-406.29"/>
<text text-anchor="middle" x="297103" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="297103" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="297103" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="297103" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert1 -->
<g id="edge1977" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298471.55,-497.55C298129.94,-485.71 297457.58,-458.03 297224,-417.06 297212.08,-414.97 297199.67,-412.12 297187.54,-408.93"/>
<polygon fill="black" stroke="black" points="297188.45,-405.55 297177.89,-406.3 297186.62,-412.3 297188.45,-405.55"/>
</g>
<!-- dp3_pp1_layer5_expert2 -->
<g id="node1207" class="node">
<title>dp3_pp1_layer5_expert2</title>
<polygon fill="lightgreen" stroke="black" points="297457,-406.29 297233,-406.29 297233,-354.29 297457,-354.29 297457,-406.29"/>
<text text-anchor="middle" x="297345" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="297345" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="297345" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="297345" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert2 -->
<g id="edge1978" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298476.82,-502.85C298235.66,-498.37 297818.02,-480.97 297466,-417.06 297454.38,-414.95 297442.29,-412.14 297430.44,-409.03"/>
<polygon fill="black" stroke="black" points="297431.13,-405.59 297420.56,-406.34 297429.29,-412.34 297431.13,-405.59"/>
</g>
<!-- dp3_pp1_layer5_expert3 -->
<g id="node1208" class="node">
<title>dp3_pp1_layer5_expert3</title>
<polygon fill="lightgreen" stroke="black" points="297699,-406.29 297475,-406.29 297475,-354.29 297699,-354.29 297699,-406.29"/>
<text text-anchor="middle" x="297587" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="297587" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="297587" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="297587" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert3 -->
<g id="edge1979" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298471.36,-497.41C298274.31,-488.25 297968.63,-466.79 297708,-417.06 297696.57,-414.88 297684.67,-412.06 297672.99,-408.97"/>
<polygon fill="black" stroke="black" points="297673.82,-405.57 297663.25,-406.31 297671.98,-412.32 297673.82,-405.57"/>
</g>
<!-- dp3_pp1_layer5_expert4 -->
<g id="node1209" class="node">
<title>dp3_pp1_layer5_expert4</title>
<polygon fill="lightgreen" stroke="black" points="297941,-406.29 297717,-406.29 297717,-354.29 297941,-354.29 297941,-406.29"/>
<text text-anchor="middle" x="297829" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="297829" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="297829" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="297829" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert4 -->
<g id="edge1980" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298462.43,-487.98C298316.99,-474.71 298120.64,-452.25 297950,-417.06 297939.05,-414.8 297927.65,-412.02 297916.43,-409.02"/>
<polygon fill="black" stroke="black" points="297917.19,-405.6 297906.62,-406.33 297915.34,-412.35 297917.19,-405.6"/>
</g>
<!-- dp3_pp1_layer5_expert5 -->
<g id="node1210" class="node">
<title>dp3_pp1_layer5_expert5</title>
<polygon fill="lightgreen" stroke="black" points="298183,-406.29 297959,-406.29 297959,-354.29 298183,-354.29 298183,-406.29"/>
<text text-anchor="middle" x="298071" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="298071" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="298071" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="298071" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert5 -->
<g id="edge1981" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298442.29,-467.38C298362.5,-453.44 298273,-436.25 298192,-417.06 298181.9,-414.67 298171.4,-411.94 298160.99,-409.07"/>
<polygon fill="black" stroke="black" points="298161.62,-405.62 298151.05,-406.3 298159.74,-412.36 298161.62,-405.62"/>
</g>
<!-- dp3_pp1_layer5_expert6 -->
<g id="node1211" class="node">
<title>dp3_pp1_layer5_expert6</title>
<polygon fill="lightgreen" stroke="black" points="298425,-406.29 298201,-406.29 298201,-354.29 298425,-354.29 298425,-406.29"/>
<text text-anchor="middle" x="298313" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="298313" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="298313" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="298313" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert6 -->
<g id="edge1982" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298524.94,-452.97C298481.16,-438.16 298434.94,-422.53 298396.87,-409.66"/>
<polygon fill="black" stroke="black" points="298397.97,-406.33 298387.38,-406.45 298395.73,-412.97 298397.97,-406.33"/>
</g>
<!-- dp3_pp1_layer5_expert7 -->
<g id="node1212" class="node">
<title>dp3_pp1_layer5_expert7</title>
<polygon fill="lightgreen" stroke="black" points="298667,-406.29 298443,-406.29 298443,-354.29 298667,-354.29 298667,-406.29"/>
<text text-anchor="middle" x="298555" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="298555" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="298555" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="298555" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert7 -->
<g id="edge1983" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298625.38,-452.71C298612.3,-439.43 298598.58,-425.51 298586.76,-413.52"/>
<polygon fill="black" stroke="black" points="298589.19,-411 298579.68,-406.33 298584.2,-415.91 298589.19,-411"/>
</g>
<!-- dp3_pp1_layer5_expert8 -->
<g id="node1213" class="node">
<title>dp3_pp1_layer5_expert8</title>
<polygon fill="lightgreen" stroke="black" points="298909,-406.29 298685,-406.29 298685,-354.29 298909,-354.29 298909,-406.29"/>
<text text-anchor="middle" x="298797" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="298797" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="298797" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="298797" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert8 -->
<g id="edge1984" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298726.61,-452.71C298739.7,-439.43 298753.42,-425.51 298765.23,-413.52"/>
<polygon fill="black" stroke="black" points="298767.79,-415.91 298772.32,-406.33 298762.81,-411 298767.79,-415.91"/>
</g>
<!-- dp3_pp1_layer5_expert9 -->
<g id="node1214" class="node">
<title>dp3_pp1_layer5_expert9</title>
<polygon fill="lightgreen" stroke="black" points="299151,-406.29 298927,-406.29 298927,-354.29 299151,-354.29 299151,-406.29"/>
<text text-anchor="middle" x="299039" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="299039" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="299039" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="299039" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert9 -->
<g id="edge1985" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298823.38,-454.21C298868.29,-439.03 298916.08,-422.86 298955.23,-409.62"/>
<polygon fill="black" stroke="black" points="298956.64,-412.84 298964.99,-406.32 298954.4,-406.21 298956.64,-412.84"/>
</g>
<!-- dp3_pp1_layer5_expert10 -->
<g id="node1215" class="node">
<title>dp3_pp1_layer5_expert10</title>
<polygon fill="lightgreen" stroke="black" points="299393,-406.29 299169,-406.29 299169,-354.29 299393,-354.29 299393,-406.29"/>
<text text-anchor="middle" x="299281" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="299281" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="299281" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="299281" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert10 -->
<g id="edge1986" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298846.89,-478.04C298939.98,-462.69 299056.88,-441.49 299160,-417.06 299170.09,-414.67 299180.6,-411.94 299191.01,-409.07"/>
<polygon fill="black" stroke="black" points="299192.26,-412.36 299200.95,-406.3 299190.37,-405.62 299192.26,-412.36"/>
</g>
<!-- dp3_pp1_layer5_expert11 -->
<g id="node1216" class="node">
<title>dp3_pp1_layer5_expert11</title>
<polygon fill="lightgreen" stroke="black" points="299635,-406.29 299411,-406.29 299411,-354.29 299635,-354.29 299635,-406.29"/>
<text text-anchor="middle" x="299523" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="299523" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="299523" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="299523" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert11 -->
<g id="edge1987" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298858.99,-490.7C299006.62,-477.88 299219.08,-454.78 299402,-417.06 299412.95,-414.8 299424.35,-412.02 299435.57,-409.02"/>
<polygon fill="black" stroke="black" points="299436.66,-412.35 299445.38,-406.33 299434.81,-405.6 299436.66,-412.35"/>
</g>
<!-- dp3_pp1_layer5_expert12 -->
<g id="node1217" class="node">
<title>dp3_pp1_layer5_expert12</title>
<polygon fill="lightgreen" stroke="black" points="299877,-406.29 299653,-406.29 299653,-354.29 299877,-354.29 299877,-406.29"/>
<text text-anchor="middle" x="299765" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="299765" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="299765" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="299765" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert12 -->
<g id="edge1988" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298866.27,-498.07C299062.59,-489.29 299376.95,-468.01 299644,-417.06 299655.43,-414.88 299667.33,-412.06 299679.01,-408.97"/>
<polygon fill="black" stroke="black" points="299680.02,-412.32 299688.75,-406.31 299678.18,-405.57 299680.02,-412.32"/>
</g>
<!-- dp3_pp1_layer5_expert13 -->
<g id="node1218" class="node">
<title>dp3_pp1_layer5_expert13</title>
<polygon fill="lightgreen" stroke="black" points="300119,-406.29 299895,-406.29 299895,-354.29 300119,-354.29 300119,-406.29"/>
<text text-anchor="middle" x="300007" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="300007" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="300007" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="300007" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert13 -->
<g id="edge1989" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298870.93,-502.93C299111.42,-498.58 299531.9,-481.35 299886,-417.06 299897.62,-414.95 299909.71,-412.14 299921.56,-409.03"/>
<polygon fill="black" stroke="black" points="299922.7,-412.34 299931.44,-406.34 299920.87,-405.59 299922.7,-412.34"/>
</g>
<!-- dp3_pp1_layer5_expert14 -->
<g id="node1219" class="node">
<title>dp3_pp1_layer5_expert14</title>
<polygon fill="lightgreen" stroke="black" points="300361,-406.29 300137,-406.29 300137,-354.29 300361,-354.29 300361,-406.29"/>
<text text-anchor="middle" x="300249" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="300249" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="300249" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="300249" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert14 -->
<g id="edge1990" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298866.32,-498.04C299203.17,-486.48 299891.15,-458.6 300128,-417.06 300139.92,-414.97 300152.32,-412.12 300164.46,-408.93"/>
<polygon fill="black" stroke="black" points="300165.38,-412.3 300174.11,-406.3 300163.54,-405.55 300165.38,-412.3"/>
</g>
<!-- dp3_pp1_layer5_expert15 -->
<g id="node1220" class="node">
<title>dp3_pp1_layer5_expert15</title>
<polygon fill="lightgreen" stroke="black" points="300603,-406.29 300379,-406.29 300379,-354.29 300603,-354.29 300603,-406.29"/>
<text text-anchor="middle" x="300491" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="300491" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="300491" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="300491" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert15 -->
<g id="edge1991" class="edge">
<title>dp3_pp1_layer5_router&#45;&gt;dp3_pp1_layer5_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M298867.94,-499.9C299248.49,-490.72 300086.35,-465.57 300370,-417.06 300382.01,-415.01 300394.51,-412.16 300406.73,-408.95"/>
<polygon fill="black" stroke="black" points="300407.72,-412.31 300416.45,-406.32 300405.88,-405.56 300407.72,-412.31"/>
</g>
<!-- dp3_pp1_layer5_expert_agg -->
<g id="node1221" class="node">
<title>dp3_pp1_layer5_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="298923.57,-307.52 298529.74,-307.52 298428.43,-203.52 298822.26,-203.52 298923.57,-307.52"/>
<text text-anchor="middle" x="298676" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="298676" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="298676" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="298676" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer5_expert0&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1992" class="edge">
<title>dp3_pp1_layer5_expert0&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M296919.07,-354.29C296938.69,-346.92 296960.97,-339.72 296982,-335.52 297261.13,-279.86 298084.93,-263.21 298471.43,-258.4"/>
<polygon fill="black" stroke="black" points="298471.65,-261.9 298481.61,-258.27 298471.57,-254.9 298471.65,-261.9"/>
</g>
<!-- dp3_pp1_layer5_expert1&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1993" class="edge">
<title>dp3_pp1_layer5_expert1&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M297161.39,-354.27C297180.95,-346.95 297203.09,-339.78 297224,-335.52 297456.8,-288.16 298132.09,-267.74 298473.43,-260.24"/>
<polygon fill="black" stroke="black" points="298473.51,-263.74 298483.43,-260.03 298473.35,-256.74 298473.51,-263.74"/>
</g>
<!-- dp3_pp1_layer5_expert2&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1994" class="edge">
<title>dp3_pp1_layer5_expert2&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M297403.73,-354.29C297423.21,-347.01 297445.23,-339.87 297466,-335.52 297652.91,-296.44 298182.54,-273.07 298475.3,-262.78"/>
<polygon fill="black" stroke="black" points="298475.74,-266.27 298485.61,-262.42 298475.5,-259.27 298475.74,-266.27"/>
</g>
<!-- dp3_pp1_layer5_expert3&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1995" class="edge">
<title>dp3_pp1_layer5_expert3&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M297646.39,-354.26C297665.72,-347.07 297687.48,-339.99 297708,-335.52 297966.91,-279.18 298272.7,-262.24 298470.26,-257.56"/>
<polygon fill="black" stroke="black" points="298470.55,-261.06 298480.47,-257.33 298470.39,-254.06 298470.55,-261.06"/>
</g>
<!-- dp3_pp1_layer5_expert4&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1996" class="edge">
<title>dp3_pp1_layer5_expert4&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M297889.39,-354.24C297908.49,-347.2 297929.87,-340.19 297950,-335.52 298125.82,-294.77 298330.6,-274.91 298477.75,-265.31"/>
<polygon fill="black" stroke="black" points="298478.05,-268.8 298487.81,-264.67 298477.6,-261.82 298478.05,-268.8"/>
</g>
<!-- dp3_pp1_layer5_expert5&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1997" class="edge">
<title>dp3_pp1_layer5_expert5&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M298133.42,-354.22C298152.04,-347.42 298172.65,-340.55 298192,-335.52 298289.09,-310.27 298399.34,-291.53 298490.07,-278.65"/>
<polygon fill="black" stroke="black" points="298490.78,-282.09 298500.19,-277.23 298489.8,-275.16 298490.78,-282.09"/>
</g>
<!-- dp3_pp1_layer5_expert6&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1998" class="edge">
<title>dp3_pp1_layer5_expert6&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M298381.02,-354.26C298398.26,-348.03 298416.78,-341.44 298434,-335.52 298460.73,-326.33 298489.21,-316.8 298516.89,-307.67"/>
<polygon fill="black" stroke="black" points="298518.24,-310.91 298526.65,-304.46 298516.06,-304.26 298518.24,-310.91"/>
</g>
<!-- dp3_pp1_layer5_expert7&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge1999" class="edge">
<title>dp3_pp1_layer5_expert7&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M298579.78,-354.15C298591.02,-342.74 298604.83,-328.73 298618.45,-314.92"/>
<polygon fill="black" stroke="black" points="298621,-317.31 298625.53,-307.73 298616.02,-312.39 298621,-317.31"/>
</g>
<!-- dp3_pp1_layer5_expert8&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2000" class="edge">
<title>dp3_pp1_layer5_expert8&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M298772.22,-354.15C298760.97,-342.74 298747.16,-328.73 298733.55,-314.92"/>
<polygon fill="black" stroke="black" points="298735.98,-312.39 298726.47,-307.73 298730.99,-317.31 298735.98,-312.39"/>
</g>
<!-- dp3_pp1_layer5_expert9&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2001" class="edge">
<title>dp3_pp1_layer5_expert9&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M298970.98,-354.26C298953.73,-348.03 298935.21,-341.44 298918,-335.52 298894.29,-327.37 298869.21,-318.95 298844.53,-310.78"/>
<polygon fill="black" stroke="black" points="298845.32,-307.36 298834.73,-307.54 298843.12,-314 298845.32,-307.36"/>
</g>
<!-- dp3_pp1_layer5_expert10&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2002" class="edge">
<title>dp3_pp1_layer5_expert10&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M299218.58,-354.22C299199.96,-347.42 299179.35,-340.55 299160,-335.52 299079.99,-314.71 298991.05,-298.33 298911.46,-286"/>
<polygon fill="black" stroke="black" points="298911.71,-282.5 298901.3,-284.44 298910.65,-289.41 298911.71,-282.5"/>
</g>
<!-- dp3_pp1_layer5_expert11&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2003" class="edge">
<title>dp3_pp1_layer5_expert11&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M299462.61,-354.24C299443.51,-347.2 299422.13,-340.19 299402,-335.52 299233.74,-296.53 299038.97,-276.66 298893.55,-266.61"/>
<polygon fill="black" stroke="black" points="298893.38,-263.09 298883.16,-265.9 298892.9,-270.07 298893.38,-263.09"/>
</g>
<!-- dp3_pp1_layer5_expert12&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2004" class="edge">
<title>dp3_pp1_layer5_expert12&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M299705.61,-354.26C299686.28,-347.07 299664.52,-339.99 299644,-335.52 299386.51,-279.49 299082.64,-262.43 298884.99,-257.64"/>
<polygon fill="black" stroke="black" points="298884.86,-254.14 298874.78,-257.4 298884.69,-261.13 298884.86,-254.14"/>
</g>
<!-- dp3_pp1_layer5_expert13&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2005" class="edge">
<title>dp3_pp1_layer5_expert13&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M299948.27,-354.29C299928.79,-347.01 299906.77,-339.87 299886,-335.52 299702.02,-297.05 299185.97,-273.81 298890.63,-263.27"/>
<polygon fill="black" stroke="black" points="298890.33,-259.76 298880.21,-262.9 298890.08,-266.76 298890.33,-259.76"/>
</g>
<!-- dp3_pp1_layer5_expert14&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2006" class="edge">
<title>dp3_pp1_layer5_expert14&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M300190.6,-354.27C300171.05,-346.95 300148.9,-339.78 300128,-335.52 299897.27,-288.58 299231.86,-268.1 298887.74,-260.45"/>
<polygon fill="black" stroke="black" points="298887.73,-256.94 298877.65,-260.22 298887.57,-263.94 298887.73,-256.94"/>
</g>
<!-- dp3_pp1_layer5_expert15&#45;&gt;dp3_pp1_layer5_expert_agg -->
<g id="edge2007" class="edge">
<title>dp3_pp1_layer5_expert15&#45;&gt;dp3_pp1_layer5_expert_agg</title>
<path fill="none" stroke="black" d="M300432.93,-354.29C300413.3,-346.92 300391.03,-339.72 300370,-335.52 300092.21,-280.12 299274.98,-263.37 298886.17,-258.47"/>
<polygon fill="black" stroke="black" points="298885.97,-254.97 298875.93,-258.34 298885.88,-261.97 298885.97,-254.97"/>
</g>
<!-- dp3_pp1_layer6_attn_tp0 -->
<g id="node1222" class="node">
<title>dp3_pp1_layer6_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="296158.5,-531.06 295893.5,-531.06 295893.5,-479.06 296158.5,-479.06 296158.5,-531.06"/>
<text text-anchor="middle" x="296026" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="296026" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="296026" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="296026" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer5_expert_agg&#45;&gt;dp3_pp1_layer6_attn_tp0 -->
<g id="edge2009" class="edge">
<title>dp3_pp1_layer5_expert_agg&#45;&gt;dp3_pp1_layer6_attn_tp0</title>
<path fill="none" stroke="black" d="M298483.78,-260.41C298063.38,-269.54 297073.17,-294.77 296740,-335.52 296707.8,-339.46 296199.23,-444.29 296168,-453.06 296145.37,-459.41 296121.16,-467.58 296099.26,-475.5"/>
<polygon fill="black" stroke="black" points="296097.89,-472.28 296089.7,-479 296100.29,-478.85 296097.89,-472.28"/>
</g>
<!-- dp3_pp1_layer6_attn_allreduce -->
<g id="node1223" class="node">
<title>dp3_pp1_layer6_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="296155" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="296155" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="296155" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="296155" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="296155" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_attn_tp0&#45;&gt;dp3_pp1_layer6_attn_allreduce -->
<g id="edge2010" class="edge">
<title>dp3_pp1_layer6_attn_tp0&#45;&gt;dp3_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M296052.41,-478.92C296069.15,-463 296091.21,-442 296110.58,-423.56"/>
<polygon fill="black" stroke="black" points="296113.03,-426.07 296117.86,-416.64 296108.2,-421 296113.03,-426.07"/>
</g>
<!-- dp3_pp1_layer6_router -->
<g id="node1227" class="node">
<title>dp3_pp1_layer6_router</title>
<polygon fill="lightyellow" stroke="black" points="293906.57,-557.06 293512.74,-557.06 293411.43,-453.06 293805.26,-453.06 293906.57,-557.06"/>
<text text-anchor="middle" x="293659" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="293659" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="293659" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="293659" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_attn_allreduce&#45;&gt;dp3_pp1_layer6_router -->
<g id="edge2046" class="edge">
<title>dp3_pp1_layer6_attn_allreduce&#45;&gt;dp3_pp1_layer6_router</title>
<path fill="none" stroke="black" d="M295995.08,-392.38C295883.77,-399.9 295731.89,-409.76 295598,-417.06 294962.5,-451.72 294209.28,-482.59 293857.96,-496.4"/>
<polygon fill="black" stroke="black" points="293857.8,-492.91 293847.94,-496.79 293858.07,-499.9 293857.8,-492.91"/>
</g>
<!-- dp3_pp1_layer6_attn_tp1 -->
<g id="node1224" class="node">
<title>dp3_pp1_layer6_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="296441.5,-531.06 296176.5,-531.06 296176.5,-479.06 296441.5,-479.06 296441.5,-531.06"/>
<text text-anchor="middle" x="296309" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="296309" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="296309" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="296309" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer6_attn_tp1&#45;&gt;dp3_pp1_layer6_attn_allreduce -->
<g id="edge2011" class="edge">
<title>dp3_pp1_layer6_attn_tp1&#45;&gt;dp3_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M296277.46,-478.92C296256.99,-462.6 296229.83,-440.94 296206.29,-422.18"/>
<polygon fill="black" stroke="black" points="296208.46,-419.44 296198.46,-415.94 296204.1,-424.91 296208.46,-419.44"/>
</g>
<!-- dp3_pp1_layer6_attn_tp2 -->
<g id="node1225" class="node">
<title>dp3_pp1_layer6_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="295875.5,-531.06 295610.5,-531.06 295610.5,-479.06 295875.5,-479.06 295875.5,-531.06"/>
<text text-anchor="middle" x="295743" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="295743" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="295743" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="295743" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer6_attn_tp2&#45;&gt;dp3_pp1_layer6_attn_allreduce -->
<g id="edge2012" class="edge">
<title>dp3_pp1_layer6_attn_tp2&#45;&gt;dp3_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M295809.07,-479.02C295832.85,-470.35 295859.99,-460.86 295885,-453.06 295933.74,-437.86 295988.05,-423.03 296035.1,-410.83"/>
<polygon fill="black" stroke="black" points="296036.22,-414.15 296045.03,-408.26 296034.47,-407.38 296036.22,-414.15"/>
</g>
<!-- dp3_pp1_layer6_attn_tp3 -->
<g id="node1226" class="node">
<title>dp3_pp1_layer6_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="296724.5,-531.06 296459.5,-531.06 296459.5,-479.06 296724.5,-479.06 296724.5,-531.06"/>
<text text-anchor="middle" x="296592" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="296592" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="296592" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="296592" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer6_attn_tp3&#45;&gt;dp3_pp1_layer6_attn_allreduce -->
<g id="edge2013" class="edge">
<title>dp3_pp1_layer6_attn_tp3&#45;&gt;dp3_pp1_layer6_attn_allreduce</title>
<path fill="none" stroke="black" d="M296527.21,-478.95C296503.43,-470.18 296476.17,-460.64 296451,-453.06 296396.42,-436.63 296335.31,-421.31 296282.86,-409.08"/>
<polygon fill="black" stroke="black" points="296283.37,-405.6 296272.83,-406.75 296281.78,-412.42 296283.37,-405.6"/>
</g>
<!-- dp3_pp1_layer6_expert0 -->
<g id="node1228" class="node">
<title>dp3_pp1_layer6_expert0</title>
<polygon fill="lightgreen" stroke="black" points="291956,-406.29 291732,-406.29 291732,-354.29 291956,-354.29 291956,-406.29"/>
<text text-anchor="middle" x="291844" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="291844" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="291844" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="291844" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert0 -->
<g id="edge2014" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293456.73,-499.65C293071.55,-490.26 292246.11,-465.13 291965,-417.06 291952.99,-415.01 291940.48,-412.16 291928.27,-408.95"/>
<polygon fill="black" stroke="black" points="291929.11,-405.56 291918.54,-406.32 291927.28,-412.31 291929.11,-405.56"/>
</g>
<!-- dp3_pp1_layer6_expert1 -->
<g id="node1229" class="node">
<title>dp3_pp1_layer6_expert1</title>
<polygon fill="lightgreen" stroke="black" points="292198,-406.29 291974,-406.29 291974,-354.29 292198,-354.29 292198,-406.29"/>
<text text-anchor="middle" x="292086" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="292086" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="292086" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="292086" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert1 -->
<g id="edge2015" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293454.55,-497.55C293112.94,-485.71 292440.58,-458.03 292207,-417.06 292195.08,-414.97 292182.67,-412.12 292170.54,-408.93"/>
<polygon fill="black" stroke="black" points="292171.45,-405.55 292160.89,-406.3 292169.62,-412.3 292171.45,-405.55"/>
</g>
<!-- dp3_pp1_layer6_expert2 -->
<g id="node1230" class="node">
<title>dp3_pp1_layer6_expert2</title>
<polygon fill="lightgreen" stroke="black" points="292440,-406.29 292216,-406.29 292216,-354.29 292440,-354.29 292440,-406.29"/>
<text text-anchor="middle" x="292328" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="292328" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="292328" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="292328" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert2 -->
<g id="edge2016" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293459.82,-502.85C293218.66,-498.37 292801.02,-480.97 292449,-417.06 292437.38,-414.95 292425.29,-412.14 292413.44,-409.03"/>
<polygon fill="black" stroke="black" points="292414.13,-405.59 292403.56,-406.34 292412.29,-412.34 292414.13,-405.59"/>
</g>
<!-- dp3_pp1_layer6_expert3 -->
<g id="node1231" class="node">
<title>dp3_pp1_layer6_expert3</title>
<polygon fill="lightgreen" stroke="black" points="292682,-406.29 292458,-406.29 292458,-354.29 292682,-354.29 292682,-406.29"/>
<text text-anchor="middle" x="292570" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="292570" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="292570" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="292570" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert3 -->
<g id="edge2017" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293454.36,-497.41C293257.31,-488.25 292951.63,-466.79 292691,-417.06 292679.57,-414.88 292667.67,-412.06 292655.99,-408.97"/>
<polygon fill="black" stroke="black" points="292656.82,-405.57 292646.25,-406.31 292654.98,-412.32 292656.82,-405.57"/>
</g>
<!-- dp3_pp1_layer6_expert4 -->
<g id="node1232" class="node">
<title>dp3_pp1_layer6_expert4</title>
<polygon fill="lightgreen" stroke="black" points="292924,-406.29 292700,-406.29 292700,-354.29 292924,-354.29 292924,-406.29"/>
<text text-anchor="middle" x="292812" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="292812" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="292812" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="292812" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert4 -->
<g id="edge2018" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293445.43,-487.98C293299.99,-474.71 293103.64,-452.25 292933,-417.06 292922.05,-414.8 292910.65,-412.02 292899.43,-409.02"/>
<polygon fill="black" stroke="black" points="292900.19,-405.6 292889.62,-406.33 292898.34,-412.35 292900.19,-405.6"/>
</g>
<!-- dp3_pp1_layer6_expert5 -->
<g id="node1233" class="node">
<title>dp3_pp1_layer6_expert5</title>
<polygon fill="lightgreen" stroke="black" points="293166,-406.29 292942,-406.29 292942,-354.29 293166,-354.29 293166,-406.29"/>
<text text-anchor="middle" x="293054" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="293054" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="293054" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="293054" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert5 -->
<g id="edge2019" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293425.29,-467.38C293345.5,-453.44 293256,-436.25 293175,-417.06 293164.9,-414.67 293154.4,-411.94 293143.99,-409.07"/>
<polygon fill="black" stroke="black" points="293144.62,-405.62 293134.05,-406.3 293142.74,-412.36 293144.62,-405.62"/>
</g>
<!-- dp3_pp1_layer6_expert6 -->
<g id="node1234" class="node">
<title>dp3_pp1_layer6_expert6</title>
<polygon fill="lightgreen" stroke="black" points="293408,-406.29 293184,-406.29 293184,-354.29 293408,-354.29 293408,-406.29"/>
<text text-anchor="middle" x="293296" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="293296" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="293296" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="293296" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert6 -->
<g id="edge2020" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293507.94,-452.97C293464.16,-438.16 293417.94,-422.53 293379.87,-409.66"/>
<polygon fill="black" stroke="black" points="293380.97,-406.33 293370.38,-406.45 293378.73,-412.97 293380.97,-406.33"/>
</g>
<!-- dp3_pp1_layer6_expert7 -->
<g id="node1235" class="node">
<title>dp3_pp1_layer6_expert7</title>
<polygon fill="lightgreen" stroke="black" points="293650,-406.29 293426,-406.29 293426,-354.29 293650,-354.29 293650,-406.29"/>
<text text-anchor="middle" x="293538" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="293538" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="293538" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="293538" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert7 -->
<g id="edge2021" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293608.38,-452.71C293595.3,-439.43 293581.58,-425.51 293569.76,-413.52"/>
<polygon fill="black" stroke="black" points="293572.19,-411 293562.68,-406.33 293567.2,-415.91 293572.19,-411"/>
</g>
<!-- dp3_pp1_layer6_expert8 -->
<g id="node1236" class="node">
<title>dp3_pp1_layer6_expert8</title>
<polygon fill="lightgreen" stroke="black" points="293892,-406.29 293668,-406.29 293668,-354.29 293892,-354.29 293892,-406.29"/>
<text text-anchor="middle" x="293780" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="293780" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="293780" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="293780" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert8 -->
<g id="edge2022" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293709.61,-452.71C293722.7,-439.43 293736.42,-425.51 293748.23,-413.52"/>
<polygon fill="black" stroke="black" points="293750.79,-415.91 293755.32,-406.33 293745.81,-411 293750.79,-415.91"/>
</g>
<!-- dp3_pp1_layer6_expert9 -->
<g id="node1237" class="node">
<title>dp3_pp1_layer6_expert9</title>
<polygon fill="lightgreen" stroke="black" points="294134,-406.29 293910,-406.29 293910,-354.29 294134,-354.29 294134,-406.29"/>
<text text-anchor="middle" x="294022" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="294022" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="294022" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="294022" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert9 -->
<g id="edge2023" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293806.38,-454.21C293851.29,-439.03 293899.08,-422.86 293938.23,-409.62"/>
<polygon fill="black" stroke="black" points="293939.64,-412.84 293947.99,-406.32 293937.4,-406.21 293939.64,-412.84"/>
</g>
<!-- dp3_pp1_layer6_expert10 -->
<g id="node1238" class="node">
<title>dp3_pp1_layer6_expert10</title>
<polygon fill="lightgreen" stroke="black" points="294376,-406.29 294152,-406.29 294152,-354.29 294376,-354.29 294376,-406.29"/>
<text text-anchor="middle" x="294264" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="294264" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="294264" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="294264" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert10 -->
<g id="edge2024" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293829.89,-478.04C293922.98,-462.69 294039.88,-441.49 294143,-417.06 294153.09,-414.67 294163.6,-411.94 294174.01,-409.07"/>
<polygon fill="black" stroke="black" points="294175.26,-412.36 294183.95,-406.3 294173.37,-405.62 294175.26,-412.36"/>
</g>
<!-- dp3_pp1_layer6_expert11 -->
<g id="node1239" class="node">
<title>dp3_pp1_layer6_expert11</title>
<polygon fill="lightgreen" stroke="black" points="294618,-406.29 294394,-406.29 294394,-354.29 294618,-354.29 294618,-406.29"/>
<text text-anchor="middle" x="294506" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="294506" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="294506" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="294506" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert11 -->
<g id="edge2025" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293841.99,-490.7C293989.62,-477.88 294202.08,-454.78 294385,-417.06 294395.95,-414.8 294407.35,-412.02 294418.57,-409.02"/>
<polygon fill="black" stroke="black" points="294419.66,-412.35 294428.38,-406.33 294417.81,-405.6 294419.66,-412.35"/>
</g>
<!-- dp3_pp1_layer6_expert12 -->
<g id="node1240" class="node">
<title>dp3_pp1_layer6_expert12</title>
<polygon fill="lightgreen" stroke="black" points="294860,-406.29 294636,-406.29 294636,-354.29 294860,-354.29 294860,-406.29"/>
<text text-anchor="middle" x="294748" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="294748" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="294748" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="294748" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert12 -->
<g id="edge2026" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293849.27,-498.07C294045.59,-489.29 294359.95,-468.01 294627,-417.06 294638.43,-414.88 294650.33,-412.06 294662.01,-408.97"/>
<polygon fill="black" stroke="black" points="294663.02,-412.32 294671.75,-406.31 294661.18,-405.57 294663.02,-412.32"/>
</g>
<!-- dp3_pp1_layer6_expert13 -->
<g id="node1241" class="node">
<title>dp3_pp1_layer6_expert13</title>
<polygon fill="lightgreen" stroke="black" points="295102,-406.29 294878,-406.29 294878,-354.29 295102,-354.29 295102,-406.29"/>
<text text-anchor="middle" x="294990" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="294990" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="294990" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="294990" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert13 -->
<g id="edge2027" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293853.93,-502.93C294094.42,-498.58 294514.9,-481.35 294869,-417.06 294880.62,-414.95 294892.71,-412.14 294904.56,-409.03"/>
<polygon fill="black" stroke="black" points="294905.7,-412.34 294914.44,-406.34 294903.87,-405.59 294905.7,-412.34"/>
</g>
<!-- dp3_pp1_layer6_expert14 -->
<g id="node1242" class="node">
<title>dp3_pp1_layer6_expert14</title>
<polygon fill="lightgreen" stroke="black" points="295344,-406.29 295120,-406.29 295120,-354.29 295344,-354.29 295344,-406.29"/>
<text text-anchor="middle" x="295232" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="295232" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="295232" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="295232" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert14 -->
<g id="edge2028" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293849.32,-498.04C294186.17,-486.48 294874.15,-458.6 295111,-417.06 295122.92,-414.97 295135.32,-412.12 295147.46,-408.93"/>
<polygon fill="black" stroke="black" points="295148.38,-412.3 295157.11,-406.3 295146.54,-405.55 295148.38,-412.3"/>
</g>
<!-- dp3_pp1_layer6_expert15 -->
<g id="node1243" class="node">
<title>dp3_pp1_layer6_expert15</title>
<polygon fill="lightgreen" stroke="black" points="295586,-406.29 295362,-406.29 295362,-354.29 295586,-354.29 295586,-406.29"/>
<text text-anchor="middle" x="295474" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="295474" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="295474" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="295474" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert15 -->
<g id="edge2029" class="edge">
<title>dp3_pp1_layer6_router&#45;&gt;dp3_pp1_layer6_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M293850.94,-499.9C294231.49,-490.72 295069.35,-465.57 295353,-417.06 295365.01,-415.01 295377.51,-412.16 295389.73,-408.95"/>
<polygon fill="black" stroke="black" points="295390.72,-412.31 295399.45,-406.32 295388.88,-405.56 295390.72,-412.31"/>
</g>
<!-- dp3_pp1_layer6_expert_agg -->
<g id="node1244" class="node">
<title>dp3_pp1_layer6_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="293906.57,-307.52 293512.74,-307.52 293411.43,-203.52 293805.26,-203.52 293906.57,-307.52"/>
<text text-anchor="middle" x="293659" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="293659" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="293659" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="293659" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer6_expert0&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2030" class="edge">
<title>dp3_pp1_layer6_expert0&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M291902.07,-354.29C291921.69,-346.92 291943.97,-339.72 291965,-335.52 292244.13,-279.86 293067.93,-263.21 293454.43,-258.4"/>
<polygon fill="black" stroke="black" points="293454.65,-261.9 293464.61,-258.27 293454.57,-254.9 293454.65,-261.9"/>
</g>
<!-- dp3_pp1_layer6_expert1&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2031" class="edge">
<title>dp3_pp1_layer6_expert1&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M292144.39,-354.27C292163.95,-346.95 292186.09,-339.78 292207,-335.52 292439.8,-288.16 293115.09,-267.74 293456.43,-260.24"/>
<polygon fill="black" stroke="black" points="293456.51,-263.74 293466.43,-260.03 293456.35,-256.74 293456.51,-263.74"/>
</g>
<!-- dp3_pp1_layer6_expert2&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2032" class="edge">
<title>dp3_pp1_layer6_expert2&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M292386.73,-354.29C292406.21,-347.01 292428.23,-339.87 292449,-335.52 292635.91,-296.44 293165.54,-273.07 293458.3,-262.78"/>
<polygon fill="black" stroke="black" points="293458.74,-266.27 293468.61,-262.42 293458.5,-259.27 293458.74,-266.27"/>
</g>
<!-- dp3_pp1_layer6_expert3&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2033" class="edge">
<title>dp3_pp1_layer6_expert3&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M292629.39,-354.26C292648.72,-347.07 292670.48,-339.99 292691,-335.52 292949.91,-279.18 293255.7,-262.24 293453.26,-257.56"/>
<polygon fill="black" stroke="black" points="293453.55,-261.06 293463.47,-257.33 293453.39,-254.06 293453.55,-261.06"/>
</g>
<!-- dp3_pp1_layer6_expert4&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2034" class="edge">
<title>dp3_pp1_layer6_expert4&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M292872.39,-354.24C292891.49,-347.2 292912.87,-340.19 292933,-335.52 293108.82,-294.77 293313.6,-274.91 293460.75,-265.31"/>
<polygon fill="black" stroke="black" points="293461.05,-268.8 293470.81,-264.67 293460.6,-261.82 293461.05,-268.8"/>
</g>
<!-- dp3_pp1_layer6_expert5&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2035" class="edge">
<title>dp3_pp1_layer6_expert5&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M293116.42,-354.22C293135.04,-347.42 293155.65,-340.55 293175,-335.52 293272.09,-310.27 293382.34,-291.53 293473.07,-278.65"/>
<polygon fill="black" stroke="black" points="293473.78,-282.09 293483.19,-277.23 293472.8,-275.16 293473.78,-282.09"/>
</g>
<!-- dp3_pp1_layer6_expert6&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2036" class="edge">
<title>dp3_pp1_layer6_expert6&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M293364.02,-354.26C293381.26,-348.03 293399.78,-341.44 293417,-335.52 293443.73,-326.33 293472.21,-316.8 293499.89,-307.67"/>
<polygon fill="black" stroke="black" points="293501.24,-310.91 293509.65,-304.46 293499.06,-304.26 293501.24,-310.91"/>
</g>
<!-- dp3_pp1_layer6_expert7&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2037" class="edge">
<title>dp3_pp1_layer6_expert7&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M293562.78,-354.15C293574.02,-342.74 293587.83,-328.73 293601.45,-314.92"/>
<polygon fill="black" stroke="black" points="293604,-317.31 293608.53,-307.73 293599.02,-312.39 293604,-317.31"/>
</g>
<!-- dp3_pp1_layer6_expert8&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2038" class="edge">
<title>dp3_pp1_layer6_expert8&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M293755.22,-354.15C293743.97,-342.74 293730.16,-328.73 293716.55,-314.92"/>
<polygon fill="black" stroke="black" points="293718.98,-312.39 293709.47,-307.73 293713.99,-317.31 293718.98,-312.39"/>
</g>
<!-- dp3_pp1_layer6_expert9&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2039" class="edge">
<title>dp3_pp1_layer6_expert9&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M293953.98,-354.26C293936.73,-348.03 293918.21,-341.44 293901,-335.52 293877.29,-327.37 293852.21,-318.95 293827.53,-310.78"/>
<polygon fill="black" stroke="black" points="293828.32,-307.36 293817.73,-307.54 293826.12,-314 293828.32,-307.36"/>
</g>
<!-- dp3_pp1_layer6_expert10&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2040" class="edge">
<title>dp3_pp1_layer6_expert10&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M294201.58,-354.22C294182.96,-347.42 294162.35,-340.55 294143,-335.52 294062.99,-314.71 293974.05,-298.33 293894.46,-286"/>
<polygon fill="black" stroke="black" points="293894.71,-282.5 293884.3,-284.44 293893.65,-289.41 293894.71,-282.5"/>
</g>
<!-- dp3_pp1_layer6_expert11&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2041" class="edge">
<title>dp3_pp1_layer6_expert11&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M294445.61,-354.24C294426.51,-347.2 294405.13,-340.19 294385,-335.52 294216.74,-296.53 294021.97,-276.66 293876.55,-266.61"/>
<polygon fill="black" stroke="black" points="293876.38,-263.09 293866.16,-265.9 293875.9,-270.07 293876.38,-263.09"/>
</g>
<!-- dp3_pp1_layer6_expert12&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2042" class="edge">
<title>dp3_pp1_layer6_expert12&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M294688.61,-354.26C294669.28,-347.07 294647.52,-339.99 294627,-335.52 294369.51,-279.49 294065.64,-262.43 293867.99,-257.64"/>
<polygon fill="black" stroke="black" points="293867.86,-254.14 293857.78,-257.4 293867.69,-261.13 293867.86,-254.14"/>
</g>
<!-- dp3_pp1_layer6_expert13&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2043" class="edge">
<title>dp3_pp1_layer6_expert13&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M294931.27,-354.29C294911.79,-347.01 294889.77,-339.87 294869,-335.52 294685.02,-297.05 294168.97,-273.81 293873.63,-263.27"/>
<polygon fill="black" stroke="black" points="293873.33,-259.76 293863.21,-262.9 293873.08,-266.76 293873.33,-259.76"/>
</g>
<!-- dp3_pp1_layer6_expert14&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2044" class="edge">
<title>dp3_pp1_layer6_expert14&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M295173.6,-354.27C295154.05,-346.95 295131.9,-339.78 295111,-335.52 294880.27,-288.58 294214.86,-268.1 293870.74,-260.45"/>
<polygon fill="black" stroke="black" points="293870.73,-256.94 293860.65,-260.22 293870.57,-263.94 293870.73,-256.94"/>
</g>
<!-- dp3_pp1_layer6_expert15&#45;&gt;dp3_pp1_layer6_expert_agg -->
<g id="edge2045" class="edge">
<title>dp3_pp1_layer6_expert15&#45;&gt;dp3_pp1_layer6_expert_agg</title>
<path fill="none" stroke="black" d="M295415.93,-354.29C295396.3,-346.92 295374.03,-339.72 295353,-335.52 295075.21,-280.12 294257.98,-263.37 293869.17,-258.47"/>
<polygon fill="black" stroke="black" points="293868.97,-254.97 293858.93,-258.34 293868.88,-261.97 293868.97,-254.97"/>
</g>
<!-- dp3_pp1_layer7_attn_tp0 -->
<g id="node1245" class="node">
<title>dp3_pp1_layer7_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="291141.5,-531.06 290876.5,-531.06 290876.5,-479.06 291141.5,-479.06 291141.5,-531.06"/>
<text text-anchor="middle" x="291009" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="291009" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="291009" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="291009" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer6_expert_agg&#45;&gt;dp3_pp1_layer7_attn_tp0 -->
<g id="edge2047" class="edge">
<title>dp3_pp1_layer6_expert_agg&#45;&gt;dp3_pp1_layer7_attn_tp0</title>
<path fill="none" stroke="black" d="M293466.78,-260.41C293046.38,-269.54 292056.17,-294.77 291723,-335.52 291690.8,-339.46 291182.23,-444.29 291151,-453.06 291128.37,-459.41 291104.16,-467.58 291082.26,-475.5"/>
<polygon fill="black" stroke="black" points="291080.89,-472.28 291072.7,-479 291083.29,-478.85 291080.89,-472.28"/>
</g>
<!-- dp3_pp1_layer7_attn_allreduce -->
<g id="node1246" class="node">
<title>dp3_pp1_layer7_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="291138" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="291138" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="291138" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="291138" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="291138" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_attn_tp0&#45;&gt;dp3_pp1_layer7_attn_allreduce -->
<g id="edge2048" class="edge">
<title>dp3_pp1_layer7_attn_tp0&#45;&gt;dp3_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M291035.41,-478.92C291052.15,-463 291074.21,-442 291093.58,-423.56"/>
<polygon fill="black" stroke="black" points="291096.03,-426.07 291100.86,-416.64 291091.2,-421 291096.03,-426.07"/>
</g>
<!-- dp3_pp1_layer7_router -->
<g id="node1250" class="node">
<title>dp3_pp1_layer7_router</title>
<polygon fill="lightyellow" stroke="black" points="288889.57,-557.06 288495.74,-557.06 288394.43,-453.06 288788.26,-453.06 288889.57,-557.06"/>
<text text-anchor="middle" x="288642" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="288642" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="288642" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="288642" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_attn_allreduce&#45;&gt;dp3_pp1_layer7_router -->
<g id="edge2084" class="edge">
<title>dp3_pp1_layer7_attn_allreduce&#45;&gt;dp3_pp1_layer7_router</title>
<path fill="none" stroke="black" d="M290978.08,-392.38C290866.77,-399.9 290714.89,-409.76 290581,-417.06 289945.5,-451.72 289192.28,-482.59 288840.96,-496.4"/>
<polygon fill="black" stroke="black" points="288840.8,-492.91 288830.94,-496.79 288841.07,-499.9 288840.8,-492.91"/>
</g>
<!-- dp3_pp1_layer7_attn_tp1 -->
<g id="node1247" class="node">
<title>dp3_pp1_layer7_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="291424.5,-531.06 291159.5,-531.06 291159.5,-479.06 291424.5,-479.06 291424.5,-531.06"/>
<text text-anchor="middle" x="291292" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="291292" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="291292" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="291292" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer7_attn_tp1&#45;&gt;dp3_pp1_layer7_attn_allreduce -->
<g id="edge2049" class="edge">
<title>dp3_pp1_layer7_attn_tp1&#45;&gt;dp3_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M291260.46,-478.92C291239.99,-462.6 291212.83,-440.94 291189.29,-422.18"/>
<polygon fill="black" stroke="black" points="291191.46,-419.44 291181.46,-415.94 291187.1,-424.91 291191.46,-419.44"/>
</g>
<!-- dp3_pp1_layer7_attn_tp2 -->
<g id="node1248" class="node">
<title>dp3_pp1_layer7_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="290858.5,-531.06 290593.5,-531.06 290593.5,-479.06 290858.5,-479.06 290858.5,-531.06"/>
<text text-anchor="middle" x="290726" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="290726" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="290726" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="290726" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer7_attn_tp2&#45;&gt;dp3_pp1_layer7_attn_allreduce -->
<g id="edge2050" class="edge">
<title>dp3_pp1_layer7_attn_tp2&#45;&gt;dp3_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M290792.07,-479.02C290815.85,-470.35 290842.99,-460.86 290868,-453.06 290916.74,-437.86 290971.05,-423.03 291018.1,-410.83"/>
<polygon fill="black" stroke="black" points="291019.22,-414.15 291028.03,-408.26 291017.47,-407.38 291019.22,-414.15"/>
</g>
<!-- dp3_pp1_layer7_attn_tp3 -->
<g id="node1249" class="node">
<title>dp3_pp1_layer7_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="291707.5,-531.06 291442.5,-531.06 291442.5,-479.06 291707.5,-479.06 291707.5,-531.06"/>
<text text-anchor="middle" x="291575" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="291575" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="291575" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="291575" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer7_attn_tp3&#45;&gt;dp3_pp1_layer7_attn_allreduce -->
<g id="edge2051" class="edge">
<title>dp3_pp1_layer7_attn_tp3&#45;&gt;dp3_pp1_layer7_attn_allreduce</title>
<path fill="none" stroke="black" d="M291510.21,-478.95C291486.43,-470.18 291459.17,-460.64 291434,-453.06 291379.42,-436.63 291318.31,-421.31 291265.86,-409.08"/>
<polygon fill="black" stroke="black" points="291266.37,-405.6 291255.83,-406.75 291264.78,-412.42 291266.37,-405.6"/>
</g>
<!-- dp3_pp1_layer7_expert0 -->
<g id="node1251" class="node">
<title>dp3_pp1_layer7_expert0</title>
<polygon fill="lightgreen" stroke="black" points="286939,-406.29 286715,-406.29 286715,-354.29 286939,-354.29 286939,-406.29"/>
<text text-anchor="middle" x="286827" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="286827" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="286827" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="286827" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert0 -->
<g id="edge2052" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288439.73,-499.65C288054.55,-490.26 287229.11,-465.13 286948,-417.06 286935.99,-415.01 286923.48,-412.16 286911.27,-408.95"/>
<polygon fill="black" stroke="black" points="286912.11,-405.56 286901.54,-406.32 286910.28,-412.31 286912.11,-405.56"/>
</g>
<!-- dp3_pp1_layer7_expert1 -->
<g id="node1252" class="node">
<title>dp3_pp1_layer7_expert1</title>
<polygon fill="lightgreen" stroke="black" points="287181,-406.29 286957,-406.29 286957,-354.29 287181,-354.29 287181,-406.29"/>
<text text-anchor="middle" x="287069" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="287069" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="287069" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="287069" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert1 -->
<g id="edge2053" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288437.55,-497.55C288095.94,-485.71 287423.58,-458.03 287190,-417.06 287178.08,-414.97 287165.67,-412.12 287153.54,-408.93"/>
<polygon fill="black" stroke="black" points="287154.45,-405.55 287143.89,-406.3 287152.62,-412.3 287154.45,-405.55"/>
</g>
<!-- dp3_pp1_layer7_expert2 -->
<g id="node1253" class="node">
<title>dp3_pp1_layer7_expert2</title>
<polygon fill="lightgreen" stroke="black" points="287423,-406.29 287199,-406.29 287199,-354.29 287423,-354.29 287423,-406.29"/>
<text text-anchor="middle" x="287311" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="287311" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="287311" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="287311" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert2 -->
<g id="edge2054" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288442.82,-502.85C288201.66,-498.37 287784.02,-480.97 287432,-417.06 287420.38,-414.95 287408.29,-412.14 287396.44,-409.03"/>
<polygon fill="black" stroke="black" points="287397.13,-405.59 287386.56,-406.34 287395.29,-412.34 287397.13,-405.59"/>
</g>
<!-- dp3_pp1_layer7_expert3 -->
<g id="node1254" class="node">
<title>dp3_pp1_layer7_expert3</title>
<polygon fill="lightgreen" stroke="black" points="287665,-406.29 287441,-406.29 287441,-354.29 287665,-354.29 287665,-406.29"/>
<text text-anchor="middle" x="287553" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="287553" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="287553" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="287553" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert3 -->
<g id="edge2055" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288437.36,-497.41C288240.31,-488.25 287934.63,-466.79 287674,-417.06 287662.57,-414.88 287650.67,-412.06 287638.99,-408.97"/>
<polygon fill="black" stroke="black" points="287639.82,-405.57 287629.25,-406.31 287637.98,-412.32 287639.82,-405.57"/>
</g>
<!-- dp3_pp1_layer7_expert4 -->
<g id="node1255" class="node">
<title>dp3_pp1_layer7_expert4</title>
<polygon fill="lightgreen" stroke="black" points="287907,-406.29 287683,-406.29 287683,-354.29 287907,-354.29 287907,-406.29"/>
<text text-anchor="middle" x="287795" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="287795" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="287795" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="287795" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert4 -->
<g id="edge2056" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288428.43,-487.98C288282.99,-474.71 288086.64,-452.25 287916,-417.06 287905.05,-414.8 287893.65,-412.02 287882.43,-409.02"/>
<polygon fill="black" stroke="black" points="287883.19,-405.6 287872.62,-406.33 287881.34,-412.35 287883.19,-405.6"/>
</g>
<!-- dp3_pp1_layer7_expert5 -->
<g id="node1256" class="node">
<title>dp3_pp1_layer7_expert5</title>
<polygon fill="lightgreen" stroke="black" points="288149,-406.29 287925,-406.29 287925,-354.29 288149,-354.29 288149,-406.29"/>
<text text-anchor="middle" x="288037" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="288037" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="288037" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="288037" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert5 -->
<g id="edge2057" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288408.29,-467.38C288328.5,-453.44 288239,-436.25 288158,-417.06 288147.9,-414.67 288137.4,-411.94 288126.99,-409.07"/>
<polygon fill="black" stroke="black" points="288127.62,-405.62 288117.05,-406.3 288125.74,-412.36 288127.62,-405.62"/>
</g>
<!-- dp3_pp1_layer7_expert6 -->
<g id="node1257" class="node">
<title>dp3_pp1_layer7_expert6</title>
<polygon fill="lightgreen" stroke="black" points="288391,-406.29 288167,-406.29 288167,-354.29 288391,-354.29 288391,-406.29"/>
<text text-anchor="middle" x="288279" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="288279" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="288279" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="288279" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert6 -->
<g id="edge2058" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288490.94,-452.97C288447.16,-438.16 288400.94,-422.53 288362.87,-409.66"/>
<polygon fill="black" stroke="black" points="288363.97,-406.33 288353.38,-406.45 288361.73,-412.97 288363.97,-406.33"/>
</g>
<!-- dp3_pp1_layer7_expert7 -->
<g id="node1258" class="node">
<title>dp3_pp1_layer7_expert7</title>
<polygon fill="lightgreen" stroke="black" points="288633,-406.29 288409,-406.29 288409,-354.29 288633,-354.29 288633,-406.29"/>
<text text-anchor="middle" x="288521" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="288521" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="288521" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="288521" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert7 -->
<g id="edge2059" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288591.38,-452.71C288578.3,-439.43 288564.58,-425.51 288552.76,-413.52"/>
<polygon fill="black" stroke="black" points="288555.19,-411 288545.68,-406.33 288550.2,-415.91 288555.19,-411"/>
</g>
<!-- dp3_pp1_layer7_expert8 -->
<g id="node1259" class="node">
<title>dp3_pp1_layer7_expert8</title>
<polygon fill="lightgreen" stroke="black" points="288875,-406.29 288651,-406.29 288651,-354.29 288875,-354.29 288875,-406.29"/>
<text text-anchor="middle" x="288763" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="288763" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="288763" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="288763" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert8 -->
<g id="edge2060" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288692.61,-452.71C288705.7,-439.43 288719.42,-425.51 288731.23,-413.52"/>
<polygon fill="black" stroke="black" points="288733.79,-415.91 288738.32,-406.33 288728.81,-411 288733.79,-415.91"/>
</g>
<!-- dp3_pp1_layer7_expert9 -->
<g id="node1260" class="node">
<title>dp3_pp1_layer7_expert9</title>
<polygon fill="lightgreen" stroke="black" points="289117,-406.29 288893,-406.29 288893,-354.29 289117,-354.29 289117,-406.29"/>
<text text-anchor="middle" x="289005" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="289005" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="289005" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="289005" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert9 -->
<g id="edge2061" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288789.38,-454.21C288834.29,-439.03 288882.08,-422.86 288921.23,-409.62"/>
<polygon fill="black" stroke="black" points="288922.64,-412.84 288930.99,-406.32 288920.4,-406.21 288922.64,-412.84"/>
</g>
<!-- dp3_pp1_layer7_expert10 -->
<g id="node1261" class="node">
<title>dp3_pp1_layer7_expert10</title>
<polygon fill="lightgreen" stroke="black" points="289359,-406.29 289135,-406.29 289135,-354.29 289359,-354.29 289359,-406.29"/>
<text text-anchor="middle" x="289247" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="289247" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="289247" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="289247" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert10 -->
<g id="edge2062" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288812.89,-478.04C288905.98,-462.69 289022.88,-441.49 289126,-417.06 289136.09,-414.67 289146.6,-411.94 289157.01,-409.07"/>
<polygon fill="black" stroke="black" points="289158.26,-412.36 289166.95,-406.3 289156.37,-405.62 289158.26,-412.36"/>
</g>
<!-- dp3_pp1_layer7_expert11 -->
<g id="node1262" class="node">
<title>dp3_pp1_layer7_expert11</title>
<polygon fill="lightgreen" stroke="black" points="289601,-406.29 289377,-406.29 289377,-354.29 289601,-354.29 289601,-406.29"/>
<text text-anchor="middle" x="289489" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="289489" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="289489" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="289489" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert11 -->
<g id="edge2063" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288824.99,-490.7C288972.62,-477.88 289185.08,-454.78 289368,-417.06 289378.95,-414.8 289390.35,-412.02 289401.57,-409.02"/>
<polygon fill="black" stroke="black" points="289402.66,-412.35 289411.38,-406.33 289400.81,-405.6 289402.66,-412.35"/>
</g>
<!-- dp3_pp1_layer7_expert12 -->
<g id="node1263" class="node">
<title>dp3_pp1_layer7_expert12</title>
<polygon fill="lightgreen" stroke="black" points="289843,-406.29 289619,-406.29 289619,-354.29 289843,-354.29 289843,-406.29"/>
<text text-anchor="middle" x="289731" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="289731" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="289731" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="289731" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert12 -->
<g id="edge2064" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288832.27,-498.07C289028.59,-489.29 289342.95,-468.01 289610,-417.06 289621.43,-414.88 289633.33,-412.06 289645.01,-408.97"/>
<polygon fill="black" stroke="black" points="289646.02,-412.32 289654.75,-406.31 289644.18,-405.57 289646.02,-412.32"/>
</g>
<!-- dp3_pp1_layer7_expert13 -->
<g id="node1264" class="node">
<title>dp3_pp1_layer7_expert13</title>
<polygon fill="lightgreen" stroke="black" points="290085,-406.29 289861,-406.29 289861,-354.29 290085,-354.29 290085,-406.29"/>
<text text-anchor="middle" x="289973" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="289973" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="289973" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="289973" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert13 -->
<g id="edge2065" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288836.93,-502.93C289077.42,-498.58 289497.9,-481.35 289852,-417.06 289863.62,-414.95 289875.71,-412.14 289887.56,-409.03"/>
<polygon fill="black" stroke="black" points="289888.7,-412.34 289897.44,-406.34 289886.87,-405.59 289888.7,-412.34"/>
</g>
<!-- dp3_pp1_layer7_expert14 -->
<g id="node1265" class="node">
<title>dp3_pp1_layer7_expert14</title>
<polygon fill="lightgreen" stroke="black" points="290327,-406.29 290103,-406.29 290103,-354.29 290327,-354.29 290327,-406.29"/>
<text text-anchor="middle" x="290215" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="290215" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="290215" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="290215" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert14 -->
<g id="edge2066" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288832.32,-498.04C289169.17,-486.48 289857.15,-458.6 290094,-417.06 290105.92,-414.97 290118.32,-412.12 290130.46,-408.93"/>
<polygon fill="black" stroke="black" points="290131.38,-412.3 290140.11,-406.3 290129.54,-405.55 290131.38,-412.3"/>
</g>
<!-- dp3_pp1_layer7_expert15 -->
<g id="node1266" class="node">
<title>dp3_pp1_layer7_expert15</title>
<polygon fill="lightgreen" stroke="black" points="290569,-406.29 290345,-406.29 290345,-354.29 290569,-354.29 290569,-406.29"/>
<text text-anchor="middle" x="290457" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="290457" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="290457" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="290457" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert15 -->
<g id="edge2067" class="edge">
<title>dp3_pp1_layer7_router&#45;&gt;dp3_pp1_layer7_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M288833.94,-499.9C289214.49,-490.72 290052.35,-465.57 290336,-417.06 290348.01,-415.01 290360.51,-412.16 290372.73,-408.95"/>
<polygon fill="black" stroke="black" points="290373.72,-412.31 290382.45,-406.32 290371.88,-405.56 290373.72,-412.31"/>
</g>
<!-- dp3_pp1_layer7_expert_agg -->
<g id="node1267" class="node">
<title>dp3_pp1_layer7_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="288889.57,-307.52 288495.74,-307.52 288394.43,-203.52 288788.26,-203.52 288889.57,-307.52"/>
<text text-anchor="middle" x="288642" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="288642" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="288642" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="288642" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer7_expert0&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2068" class="edge">
<title>dp3_pp1_layer7_expert0&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M286885.07,-354.29C286904.69,-346.92 286926.97,-339.72 286948,-335.52 287227.13,-279.86 288050.93,-263.21 288437.43,-258.4"/>
<polygon fill="black" stroke="black" points="288437.65,-261.9 288447.61,-258.27 288437.57,-254.9 288437.65,-261.9"/>
</g>
<!-- dp3_pp1_layer7_expert1&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2069" class="edge">
<title>dp3_pp1_layer7_expert1&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M287127.39,-354.27C287146.95,-346.95 287169.09,-339.78 287190,-335.52 287422.8,-288.16 288098.09,-267.74 288439.43,-260.24"/>
<polygon fill="black" stroke="black" points="288439.51,-263.74 288449.43,-260.03 288439.35,-256.74 288439.51,-263.74"/>
</g>
<!-- dp3_pp1_layer7_expert2&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2070" class="edge">
<title>dp3_pp1_layer7_expert2&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M287369.73,-354.29C287389.21,-347.01 287411.23,-339.87 287432,-335.52 287618.91,-296.44 288148.54,-273.07 288441.3,-262.78"/>
<polygon fill="black" stroke="black" points="288441.74,-266.27 288451.61,-262.42 288441.5,-259.27 288441.74,-266.27"/>
</g>
<!-- dp3_pp1_layer7_expert3&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2071" class="edge">
<title>dp3_pp1_layer7_expert3&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M287612.39,-354.26C287631.72,-347.07 287653.48,-339.99 287674,-335.52 287932.91,-279.18 288238.7,-262.24 288436.26,-257.56"/>
<polygon fill="black" stroke="black" points="288436.55,-261.06 288446.47,-257.33 288436.39,-254.06 288436.55,-261.06"/>
</g>
<!-- dp3_pp1_layer7_expert4&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2072" class="edge">
<title>dp3_pp1_layer7_expert4&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M287855.39,-354.24C287874.49,-347.2 287895.87,-340.19 287916,-335.52 288091.82,-294.77 288296.6,-274.91 288443.75,-265.31"/>
<polygon fill="black" stroke="black" points="288444.05,-268.8 288453.81,-264.67 288443.6,-261.82 288444.05,-268.8"/>
</g>
<!-- dp3_pp1_layer7_expert5&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2073" class="edge">
<title>dp3_pp1_layer7_expert5&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M288099.42,-354.22C288118.04,-347.42 288138.65,-340.55 288158,-335.52 288255.09,-310.27 288365.34,-291.53 288456.07,-278.65"/>
<polygon fill="black" stroke="black" points="288456.78,-282.09 288466.19,-277.23 288455.8,-275.16 288456.78,-282.09"/>
</g>
<!-- dp3_pp1_layer7_expert6&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2074" class="edge">
<title>dp3_pp1_layer7_expert6&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M288347.02,-354.26C288364.26,-348.03 288382.78,-341.44 288400,-335.52 288426.73,-326.33 288455.21,-316.8 288482.89,-307.67"/>
<polygon fill="black" stroke="black" points="288484.24,-310.91 288492.65,-304.46 288482.06,-304.26 288484.24,-310.91"/>
</g>
<!-- dp3_pp1_layer7_expert7&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2075" class="edge">
<title>dp3_pp1_layer7_expert7&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M288545.78,-354.15C288557.02,-342.74 288570.83,-328.73 288584.45,-314.92"/>
<polygon fill="black" stroke="black" points="288587,-317.31 288591.53,-307.73 288582.02,-312.39 288587,-317.31"/>
</g>
<!-- dp3_pp1_layer7_expert8&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2076" class="edge">
<title>dp3_pp1_layer7_expert8&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M288738.22,-354.15C288726.97,-342.74 288713.16,-328.73 288699.55,-314.92"/>
<polygon fill="black" stroke="black" points="288701.98,-312.39 288692.47,-307.73 288696.99,-317.31 288701.98,-312.39"/>
</g>
<!-- dp3_pp1_layer7_expert9&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2077" class="edge">
<title>dp3_pp1_layer7_expert9&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M288936.98,-354.26C288919.73,-348.03 288901.21,-341.44 288884,-335.52 288860.29,-327.37 288835.21,-318.95 288810.53,-310.78"/>
<polygon fill="black" stroke="black" points="288811.32,-307.36 288800.73,-307.54 288809.12,-314 288811.32,-307.36"/>
</g>
<!-- dp3_pp1_layer7_expert10&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2078" class="edge">
<title>dp3_pp1_layer7_expert10&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M289184.58,-354.22C289165.96,-347.42 289145.35,-340.55 289126,-335.52 289045.99,-314.71 288957.05,-298.33 288877.46,-286"/>
<polygon fill="black" stroke="black" points="288877.71,-282.5 288867.3,-284.44 288876.65,-289.41 288877.71,-282.5"/>
</g>
<!-- dp3_pp1_layer7_expert11&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2079" class="edge">
<title>dp3_pp1_layer7_expert11&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M289428.61,-354.24C289409.51,-347.2 289388.13,-340.19 289368,-335.52 289199.74,-296.53 289004.97,-276.66 288859.55,-266.61"/>
<polygon fill="black" stroke="black" points="288859.38,-263.09 288849.16,-265.9 288858.9,-270.07 288859.38,-263.09"/>
</g>
<!-- dp3_pp1_layer7_expert12&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2080" class="edge">
<title>dp3_pp1_layer7_expert12&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M289671.61,-354.26C289652.28,-347.07 289630.52,-339.99 289610,-335.52 289352.51,-279.49 289048.64,-262.43 288850.99,-257.64"/>
<polygon fill="black" stroke="black" points="288850.86,-254.14 288840.78,-257.4 288850.69,-261.13 288850.86,-254.14"/>
</g>
<!-- dp3_pp1_layer7_expert13&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2081" class="edge">
<title>dp3_pp1_layer7_expert13&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M289914.27,-354.29C289894.79,-347.01 289872.77,-339.87 289852,-335.52 289668.02,-297.05 289151.97,-273.81 288856.63,-263.27"/>
<polygon fill="black" stroke="black" points="288856.33,-259.76 288846.21,-262.9 288856.08,-266.76 288856.33,-259.76"/>
</g>
<!-- dp3_pp1_layer7_expert14&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2082" class="edge">
<title>dp3_pp1_layer7_expert14&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M290156.6,-354.27C290137.05,-346.95 290114.9,-339.78 290094,-335.52 289863.27,-288.58 289197.86,-268.1 288853.74,-260.45"/>
<polygon fill="black" stroke="black" points="288853.73,-256.94 288843.65,-260.22 288853.57,-263.94 288853.73,-256.94"/>
</g>
<!-- dp3_pp1_layer7_expert15&#45;&gt;dp3_pp1_layer7_expert_agg -->
<g id="edge2083" class="edge">
<title>dp3_pp1_layer7_expert15&#45;&gt;dp3_pp1_layer7_expert_agg</title>
<path fill="none" stroke="black" d="M290398.93,-354.29C290379.3,-346.92 290357.03,-339.72 290336,-335.52 290058.21,-280.12 289240.98,-263.37 288852.17,-258.47"/>
<polygon fill="black" stroke="black" points="288851.97,-254.97 288841.93,-258.34 288851.88,-261.97 288851.97,-254.97"/>
</g>
<!-- dp3_pp1_layer8_attn_tp0 -->
<g id="node1268" class="node">
<title>dp3_pp1_layer8_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="286124.5,-531.06 285859.5,-531.06 285859.5,-479.06 286124.5,-479.06 286124.5,-531.06"/>
<text text-anchor="middle" x="285992" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="285992" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="285992" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="285992" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer7_expert_agg&#45;&gt;dp3_pp1_layer8_attn_tp0 -->
<g id="edge2085" class="edge">
<title>dp3_pp1_layer7_expert_agg&#45;&gt;dp3_pp1_layer8_attn_tp0</title>
<path fill="none" stroke="black" d="M288449.78,-260.41C288029.38,-269.54 287039.17,-294.77 286706,-335.52 286673.8,-339.46 286165.23,-444.29 286134,-453.06 286111.37,-459.41 286087.16,-467.58 286065.26,-475.5"/>
<polygon fill="black" stroke="black" points="286063.89,-472.28 286055.7,-479 286066.29,-478.85 286063.89,-472.28"/>
</g>
<!-- dp3_pp1_layer8_attn_allreduce -->
<g id="node1269" class="node">
<title>dp3_pp1_layer8_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="286121" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="286121" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="286121" y="-383.29" font-family="Arial" font-size="10.00">GPUs 96&#45;99</text>
<text text-anchor="middle" x="286121" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="286121" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_attn_tp0&#45;&gt;dp3_pp1_layer8_attn_allreduce -->
<g id="edge2086" class="edge">
<title>dp3_pp1_layer8_attn_tp0&#45;&gt;dp3_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M286018.41,-478.92C286035.15,-463 286057.21,-442 286076.58,-423.56"/>
<polygon fill="black" stroke="black" points="286079.03,-426.07 286083.86,-416.64 286074.2,-421 286079.03,-426.07"/>
</g>
<!-- dp3_pp1_layer8_router -->
<g id="node1273" class="node">
<title>dp3_pp1_layer8_router</title>
<polygon fill="lightyellow" stroke="black" points="283872.57,-557.06 283478.74,-557.06 283377.43,-453.06 283771.26,-453.06 283872.57,-557.06"/>
<text text-anchor="middle" x="283625" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="283625" y="-508.06" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="283625" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="283625" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_attn_allreduce&#45;&gt;dp3_pp1_layer8_router -->
<g id="edge2122" class="edge">
<title>dp3_pp1_layer8_attn_allreduce&#45;&gt;dp3_pp1_layer8_router</title>
<path fill="none" stroke="black" d="M285961.08,-392.38C285849.77,-399.9 285697.89,-409.76 285564,-417.06 284928.5,-451.72 284175.28,-482.59 283823.96,-496.4"/>
<polygon fill="black" stroke="black" points="283823.8,-492.91 283813.94,-496.79 283824.07,-499.9 283823.8,-492.91"/>
</g>
<!-- dp3_pp1_layer8_attn_tp1 -->
<g id="node1270" class="node">
<title>dp3_pp1_layer8_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="286407.5,-531.06 286142.5,-531.06 286142.5,-479.06 286407.5,-479.06 286407.5,-531.06"/>
<text text-anchor="middle" x="286275" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="286275" y="-508.06" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="286275" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="286275" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer8_attn_tp1&#45;&gt;dp3_pp1_layer8_attn_allreduce -->
<g id="edge2087" class="edge">
<title>dp3_pp1_layer8_attn_tp1&#45;&gt;dp3_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M286243.46,-478.92C286222.99,-462.6 286195.83,-440.94 286172.29,-422.18"/>
<polygon fill="black" stroke="black" points="286174.46,-419.44 286164.46,-415.94 286170.1,-424.91 286174.46,-419.44"/>
</g>
<!-- dp3_pp1_layer8_attn_tp2 -->
<g id="node1271" class="node">
<title>dp3_pp1_layer8_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="285841.5,-531.06 285576.5,-531.06 285576.5,-479.06 285841.5,-479.06 285841.5,-531.06"/>
<text text-anchor="middle" x="285709" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="285709" y="-508.06" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="285709" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="285709" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer8_attn_tp2&#45;&gt;dp3_pp1_layer8_attn_allreduce -->
<g id="edge2088" class="edge">
<title>dp3_pp1_layer8_attn_tp2&#45;&gt;dp3_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M285775.07,-479.02C285798.85,-470.35 285825.99,-460.86 285851,-453.06 285899.74,-437.86 285954.05,-423.03 286001.1,-410.83"/>
<polygon fill="black" stroke="black" points="286002.22,-414.15 286011.03,-408.26 286000.47,-407.38 286002.22,-414.15"/>
</g>
<!-- dp3_pp1_layer8_attn_tp3 -->
<g id="node1272" class="node">
<title>dp3_pp1_layer8_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="286690.5,-531.06 286425.5,-531.06 286425.5,-479.06 286690.5,-479.06 286690.5,-531.06"/>
<text text-anchor="middle" x="286558" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="286558" y="-508.06" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="286558" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="286558" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp1_layer8_attn_tp3&#45;&gt;dp3_pp1_layer8_attn_allreduce -->
<g id="edge2089" class="edge">
<title>dp3_pp1_layer8_attn_tp3&#45;&gt;dp3_pp1_layer8_attn_allreduce</title>
<path fill="none" stroke="black" d="M286493.21,-478.95C286469.43,-470.18 286442.17,-460.64 286417,-453.06 286362.42,-436.63 286301.31,-421.31 286248.86,-409.08"/>
<polygon fill="black" stroke="black" points="286249.37,-405.6 286238.83,-406.75 286247.78,-412.42 286249.37,-405.6"/>
</g>
<!-- dp3_pp1_layer8_expert0 -->
<g id="node1274" class="node">
<title>dp3_pp1_layer8_expert0</title>
<polygon fill="lightgreen" stroke="black" points="281922,-406.29 281698,-406.29 281698,-354.29 281922,-354.29 281922,-406.29"/>
<text text-anchor="middle" x="281810" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="281810" y="-383.29" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="281810" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="281810" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert0 -->
<g id="edge2090" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283422.73,-499.65C283037.55,-490.26 282212.11,-465.13 281931,-417.06 281918.99,-415.01 281906.48,-412.16 281894.27,-408.95"/>
<polygon fill="black" stroke="black" points="281895.11,-405.56 281884.54,-406.32 281893.28,-412.31 281895.11,-405.56"/>
</g>
<!-- dp3_pp1_layer8_expert1 -->
<g id="node1275" class="node">
<title>dp3_pp1_layer8_expert1</title>
<polygon fill="lightgreen" stroke="black" points="282164,-406.29 281940,-406.29 281940,-354.29 282164,-354.29 282164,-406.29"/>
<text text-anchor="middle" x="282052" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="282052" y="-383.29" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="282052" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="282052" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert1 -->
<g id="edge2091" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283420.55,-497.55C283078.94,-485.71 282406.58,-458.03 282173,-417.06 282161.08,-414.97 282148.67,-412.12 282136.54,-408.93"/>
<polygon fill="black" stroke="black" points="282137.45,-405.55 282126.89,-406.3 282135.62,-412.3 282137.45,-405.55"/>
</g>
<!-- dp3_pp1_layer8_expert2 -->
<g id="node1276" class="node">
<title>dp3_pp1_layer8_expert2</title>
<polygon fill="lightgreen" stroke="black" points="282406,-406.29 282182,-406.29 282182,-354.29 282406,-354.29 282406,-406.29"/>
<text text-anchor="middle" x="282294" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="282294" y="-383.29" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="282294" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="282294" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert2 -->
<g id="edge2092" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283425.82,-502.85C283184.66,-498.37 282767.02,-480.97 282415,-417.06 282403.38,-414.95 282391.29,-412.14 282379.44,-409.03"/>
<polygon fill="black" stroke="black" points="282380.13,-405.59 282369.56,-406.34 282378.29,-412.34 282380.13,-405.59"/>
</g>
<!-- dp3_pp1_layer8_expert3 -->
<g id="node1277" class="node">
<title>dp3_pp1_layer8_expert3</title>
<polygon fill="lightgreen" stroke="black" points="282648,-406.29 282424,-406.29 282424,-354.29 282648,-354.29 282648,-406.29"/>
<text text-anchor="middle" x="282536" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="282536" y="-383.29" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="282536" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="282536" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert3 -->
<g id="edge2093" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283420.36,-497.41C283223.31,-488.25 282917.63,-466.79 282657,-417.06 282645.57,-414.88 282633.67,-412.06 282621.99,-408.97"/>
<polygon fill="black" stroke="black" points="282622.82,-405.57 282612.25,-406.31 282620.98,-412.32 282622.82,-405.57"/>
</g>
<!-- dp3_pp1_layer8_expert4 -->
<g id="node1278" class="node">
<title>dp3_pp1_layer8_expert4</title>
<polygon fill="lightgreen" stroke="black" points="282890,-406.29 282666,-406.29 282666,-354.29 282890,-354.29 282890,-406.29"/>
<text text-anchor="middle" x="282778" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="282778" y="-383.29" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="282778" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="282778" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert4 -->
<g id="edge2094" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283411.43,-487.98C283265.99,-474.71 283069.64,-452.25 282899,-417.06 282888.05,-414.8 282876.65,-412.02 282865.43,-409.02"/>
<polygon fill="black" stroke="black" points="282866.19,-405.6 282855.62,-406.33 282864.34,-412.35 282866.19,-405.6"/>
</g>
<!-- dp3_pp1_layer8_expert5 -->
<g id="node1279" class="node">
<title>dp3_pp1_layer8_expert5</title>
<polygon fill="lightgreen" stroke="black" points="283132,-406.29 282908,-406.29 282908,-354.29 283132,-354.29 283132,-406.29"/>
<text text-anchor="middle" x="283020" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="283020" y="-383.29" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="283020" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="283020" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert5 -->
<g id="edge2095" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283391.29,-467.38C283311.5,-453.44 283222,-436.25 283141,-417.06 283130.9,-414.67 283120.4,-411.94 283109.99,-409.07"/>
<polygon fill="black" stroke="black" points="283110.62,-405.62 283100.05,-406.3 283108.74,-412.36 283110.62,-405.62"/>
</g>
<!-- dp3_pp1_layer8_expert6 -->
<g id="node1280" class="node">
<title>dp3_pp1_layer8_expert6</title>
<polygon fill="lightgreen" stroke="black" points="283374,-406.29 283150,-406.29 283150,-354.29 283374,-354.29 283374,-406.29"/>
<text text-anchor="middle" x="283262" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="283262" y="-383.29" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="283262" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="283262" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert6 -->
<g id="edge2096" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283473.94,-452.97C283430.16,-438.16 283383.94,-422.53 283345.87,-409.66"/>
<polygon fill="black" stroke="black" points="283346.97,-406.33 283336.38,-406.45 283344.73,-412.97 283346.97,-406.33"/>
</g>
<!-- dp3_pp1_layer8_expert7 -->
<g id="node1281" class="node">
<title>dp3_pp1_layer8_expert7</title>
<polygon fill="lightgreen" stroke="black" points="283616,-406.29 283392,-406.29 283392,-354.29 283616,-354.29 283616,-406.29"/>
<text text-anchor="middle" x="283504" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="283504" y="-383.29" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="283504" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="283504" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert7 -->
<g id="edge2097" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283574.38,-452.71C283561.3,-439.43 283547.58,-425.51 283535.76,-413.52"/>
<polygon fill="black" stroke="black" points="283538.19,-411 283528.68,-406.33 283533.2,-415.91 283538.19,-411"/>
</g>
<!-- dp3_pp1_layer8_expert8 -->
<g id="node1282" class="node">
<title>dp3_pp1_layer8_expert8</title>
<polygon fill="lightgreen" stroke="black" points="283858,-406.29 283634,-406.29 283634,-354.29 283858,-354.29 283858,-406.29"/>
<text text-anchor="middle" x="283746" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="283746" y="-383.29" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="283746" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="283746" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert8 -->
<g id="edge2098" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283675.61,-452.71C283688.7,-439.43 283702.42,-425.51 283714.23,-413.52"/>
<polygon fill="black" stroke="black" points="283716.79,-415.91 283721.32,-406.33 283711.81,-411 283716.79,-415.91"/>
</g>
<!-- dp3_pp1_layer8_expert9 -->
<g id="node1283" class="node">
<title>dp3_pp1_layer8_expert9</title>
<polygon fill="lightgreen" stroke="black" points="284100,-406.29 283876,-406.29 283876,-354.29 284100,-354.29 284100,-406.29"/>
<text text-anchor="middle" x="283988" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="283988" y="-383.29" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="283988" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="283988" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert9 -->
<g id="edge2099" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283772.38,-454.21C283817.29,-439.03 283865.08,-422.86 283904.23,-409.62"/>
<polygon fill="black" stroke="black" points="283905.64,-412.84 283913.99,-406.32 283903.4,-406.21 283905.64,-412.84"/>
</g>
<!-- dp3_pp1_layer8_expert10 -->
<g id="node1284" class="node">
<title>dp3_pp1_layer8_expert10</title>
<polygon fill="lightgreen" stroke="black" points="284342,-406.29 284118,-406.29 284118,-354.29 284342,-354.29 284342,-406.29"/>
<text text-anchor="middle" x="284230" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="284230" y="-383.29" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="284230" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="284230" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert10 -->
<g id="edge2100" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283795.89,-478.04C283888.98,-462.69 284005.88,-441.49 284109,-417.06 284119.09,-414.67 284129.6,-411.94 284140.01,-409.07"/>
<polygon fill="black" stroke="black" points="284141.26,-412.36 284149.95,-406.3 284139.37,-405.62 284141.26,-412.36"/>
</g>
<!-- dp3_pp1_layer8_expert11 -->
<g id="node1285" class="node">
<title>dp3_pp1_layer8_expert11</title>
<polygon fill="lightgreen" stroke="black" points="284584,-406.29 284360,-406.29 284360,-354.29 284584,-354.29 284584,-406.29"/>
<text text-anchor="middle" x="284472" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="284472" y="-383.29" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="284472" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="284472" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert11 -->
<g id="edge2101" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283807.99,-490.7C283955.62,-477.88 284168.08,-454.78 284351,-417.06 284361.95,-414.8 284373.35,-412.02 284384.57,-409.02"/>
<polygon fill="black" stroke="black" points="284385.66,-412.35 284394.38,-406.33 284383.81,-405.6 284385.66,-412.35"/>
</g>
<!-- dp3_pp1_layer8_expert12 -->
<g id="node1286" class="node">
<title>dp3_pp1_layer8_expert12</title>
<polygon fill="lightgreen" stroke="black" points="284826,-406.29 284602,-406.29 284602,-354.29 284826,-354.29 284826,-406.29"/>
<text text-anchor="middle" x="284714" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="284714" y="-383.29" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="284714" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="284714" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert12 -->
<g id="edge2102" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283815.27,-498.07C284011.59,-489.29 284325.95,-468.01 284593,-417.06 284604.43,-414.88 284616.33,-412.06 284628.01,-408.97"/>
<polygon fill="black" stroke="black" points="284629.02,-412.32 284637.75,-406.31 284627.18,-405.57 284629.02,-412.32"/>
</g>
<!-- dp3_pp1_layer8_expert13 -->
<g id="node1287" class="node">
<title>dp3_pp1_layer8_expert13</title>
<polygon fill="lightgreen" stroke="black" points="285068,-406.29 284844,-406.29 284844,-354.29 285068,-354.29 285068,-406.29"/>
<text text-anchor="middle" x="284956" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="284956" y="-383.29" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="284956" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="284956" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert13 -->
<g id="edge2103" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283819.93,-502.93C284060.42,-498.58 284480.9,-481.35 284835,-417.06 284846.62,-414.95 284858.71,-412.14 284870.56,-409.03"/>
<polygon fill="black" stroke="black" points="284871.7,-412.34 284880.44,-406.34 284869.87,-405.59 284871.7,-412.34"/>
</g>
<!-- dp3_pp1_layer8_expert14 -->
<g id="node1288" class="node">
<title>dp3_pp1_layer8_expert14</title>
<polygon fill="lightgreen" stroke="black" points="285310,-406.29 285086,-406.29 285086,-354.29 285310,-354.29 285310,-406.29"/>
<text text-anchor="middle" x="285198" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="285198" y="-383.29" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="285198" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="285198" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert14 -->
<g id="edge2104" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283815.32,-498.04C284152.17,-486.48 284840.15,-458.6 285077,-417.06 285088.92,-414.97 285101.32,-412.12 285113.46,-408.93"/>
<polygon fill="black" stroke="black" points="285114.38,-412.3 285123.11,-406.3 285112.54,-405.55 285114.38,-412.3"/>
</g>
<!-- dp3_pp1_layer8_expert15 -->
<g id="node1289" class="node">
<title>dp3_pp1_layer8_expert15</title>
<polygon fill="lightgreen" stroke="black" points="285552,-406.29 285328,-406.29 285328,-354.29 285552,-354.29 285552,-406.29"/>
<text text-anchor="middle" x="285440" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="285440" y="-383.29" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="285440" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="285440" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert15 -->
<g id="edge2105" class="edge">
<title>dp3_pp1_layer8_router&#45;&gt;dp3_pp1_layer8_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M283816.94,-499.9C284197.49,-490.72 285035.35,-465.57 285319,-417.06 285331.01,-415.01 285343.51,-412.16 285355.73,-408.95"/>
<polygon fill="black" stroke="black" points="285356.72,-412.31 285365.45,-406.32 285354.88,-405.56 285356.72,-412.31"/>
</g>
<!-- dp3_pp1_layer8_expert_agg -->
<g id="node1290" class="node">
<title>dp3_pp1_layer8_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="283993.57,-307.52 283599.74,-307.52 283498.43,-203.52 283892.26,-203.52 283993.57,-307.52"/>
<text text-anchor="middle" x="283746" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="283746" y="-258.52" font-family="Arial" font-size="10.00">GPUs 96&#45;111</text>
<text text-anchor="middle" x="283746" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="283746" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_expert0&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2106" class="edge">
<title>dp3_pp1_layer8_expert0&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M281868.06,-354.25C281887.69,-346.88 281909.96,-339.68 281931,-335.52 282233.52,-275.68 283132.92,-261.16 283540.8,-257.65"/>
<polygon fill="black" stroke="black" points="283540.96,-261.14 283550.93,-257.56 283540.9,-254.15 283540.96,-261.14"/>
</g>
<!-- dp3_pp1_layer8_expert1&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2107" class="edge">
<title>dp3_pp1_layer8_expert1&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M282110.38,-354.21C282129.94,-346.89 282152.08,-339.73 282173,-335.52 282428.86,-284.02 283177.83,-265.4 283542.21,-259.26"/>
<polygon fill="black" stroke="black" points="283542.4,-262.76 283552.34,-259.09 283542.28,-255.76 283542.4,-262.76"/>
</g>
<!-- dp3_pp1_layer8_expert2&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2108" class="edge">
<title>dp3_pp1_layer8_expert2&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M282352.71,-354.21C282372.19,-346.94 282394.21,-339.8 282415,-335.52 282624.71,-292.32 283226.36,-270.3 283544,-261.41"/>
<polygon fill="black" stroke="black" points="283544.34,-264.9 283554.24,-261.13 283544.15,-257.91 283544.34,-264.9"/>
</g>
<!-- dp3_pp1_layer8_expert3&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2109" class="edge">
<title>dp3_pp1_layer8_expert3&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M282595.05,-354.26C282614.46,-347.03 282636.35,-339.92 282657,-335.52 282821.34,-300.54 283280.32,-276.12 283547.04,-264.41"/>
<polygon fill="black" stroke="black" points="283547.4,-267.9 283557.24,-263.97 283547.09,-260.91 283547.4,-267.9"/>
</g>
<!-- dp3_pp1_layer8_expert4&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2110" class="edge">
<title>dp3_pp1_layer8_expert4&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M282837.73,-354.28C282856.98,-347.15 282878.62,-340.08 282899,-335.52 283115.91,-287.01 283370.52,-268.23 283543.54,-261"/>
<polygon fill="black" stroke="black" points="283543.93,-264.48 283553.78,-260.58 283543.64,-257.49 283543.93,-264.48"/>
</g>
<!-- dp3_pp1_layer8_expert5&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2111" class="edge">
<title>dp3_pp1_layer8_expert5&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M283081.07,-354.28C283100.02,-347.32 283121.14,-340.35 283141,-335.52 283276.78,-302.51 283433.27,-282.55 283553.08,-270.95"/>
<polygon fill="black" stroke="black" points="283553.47,-274.42 283563.09,-269.99 283552.8,-267.46 283553.47,-274.42"/>
</g>
<!-- dp3_pp1_layer8_expert6&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2112" class="edge">
<title>dp3_pp1_layer8_expert6&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M283326.16,-354.29C283344.37,-347.69 283364.32,-340.91 283383,-335.52 283443.46,-318.09 283510.57,-302.47 283570.47,-289.81"/>
<polygon fill="black" stroke="black" points="283571.33,-293.21 283580.4,-287.73 283569.9,-286.36 283571.33,-293.21"/>
</g>
<!-- dp3_pp1_layer8_expert7&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2113" class="edge">
<title>dp3_pp1_layer8_expert7&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M283553.55,-354.15C283577.49,-342.01 283607.24,-326.92 283636.13,-312.26"/>
<polygon fill="black" stroke="black" points="283637.73,-315.37 283645.06,-307.73 283634.56,-309.13 283637.73,-315.37"/>
</g>
<!-- dp3_pp1_layer8_expert8&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2114" class="edge">
<title>dp3_pp1_layer8_expert8&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M283746,-354.15C283746,-343.58 283746,-330.77 283746,-317.96"/>
<polygon fill="black" stroke="black" points="283749.5,-317.73 283746,-307.73 283742.5,-317.73 283749.5,-317.73"/>
</g>
<!-- dp3_pp1_layer8_expert9&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2115" class="edge">
<title>dp3_pp1_layer8_expert9&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M283938.44,-354.15C283914.51,-342.01 283884.76,-326.92 283855.87,-312.26"/>
<polygon fill="black" stroke="black" points="283857.44,-309.13 283846.93,-307.73 283854.27,-315.37 283857.44,-309.13"/>
</g>
<!-- dp3_pp1_layer8_expert10&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2116" class="edge">
<title>dp3_pp1_layer8_expert10&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M284165.84,-354.29C284147.63,-347.69 284127.67,-340.91 284109,-335.52 284074.59,-325.6 284038.02,-316.27 284001.86,-307.73"/>
<polygon fill="black" stroke="black" points="284002.21,-304.22 283991.68,-305.35 284000.61,-311.03 284002.21,-304.22"/>
</g>
<!-- dp3_pp1_layer8_expert11&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2117" class="edge">
<title>dp3_pp1_layer8_expert11&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M284410.93,-354.28C284391.98,-347.32 284370.86,-340.35 284351,-335.52 284226.73,-305.31 284085.11,-286.03 283970.15,-274.08"/>
<polygon fill="black" stroke="black" points="283970.47,-270.6 283960.17,-273.05 283969.76,-277.56 283970.47,-270.6"/>
</g>
<!-- dp3_pp1_layer8_expert12&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2118" class="edge">
<title>dp3_pp1_layer8_expert12&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M284654.27,-354.28C284635.02,-347.15 284613.38,-340.08 284593,-335.52 284380.33,-287.95 284131.41,-268.98 283958.7,-261.43"/>
<polygon fill="black" stroke="black" points="283958.61,-257.93 283948.47,-261 283958.31,-264.92 283958.61,-257.93"/>
</g>
<!-- dp3_pp1_layer8_expert13&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2119" class="edge">
<title>dp3_pp1_layer8_expert13&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M284896.94,-354.26C284877.54,-347.03 284855.65,-339.92 284835,-335.52 284674.14,-301.28 284231.03,-277.16 283962.2,-265.18"/>
<polygon fill="black" stroke="black" points="283962.06,-261.67 283951.92,-264.72 283961.75,-268.66 283962.06,-261.67"/>
</g>
<!-- dp3_pp1_layer8_expert14&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2120" class="edge">
<title>dp3_pp1_layer8_expert14&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M285139.28,-354.21C285119.81,-346.94 285097.78,-339.8 285077,-335.52 284869.74,-292.82 284279.66,-270.82 283959.26,-261.73"/>
<polygon fill="black" stroke="black" points="283959.02,-258.22 283948.92,-261.44 283958.82,-265.22 283959.02,-258.22"/>
</g>
<!-- dp3_pp1_layer8_expert15&#45;&gt;dp3_pp1_layer8_expert_agg -->
<g id="edge2121" class="edge">
<title>dp3_pp1_layer8_expert15&#45;&gt;dp3_pp1_layer8_expert_agg</title>
<path fill="none" stroke="black" d="M285381.61,-354.21C285362.06,-346.89 285339.91,-339.73 285319,-335.52 285064.8,-284.35 284323.86,-265.64 283956.93,-259.38"/>
<polygon fill="black" stroke="black" points="283956.78,-255.88 283946.72,-259.21 283956.66,-262.88 283956.78,-255.88"/>
</g>
<!-- dp3_pp1_to_pp2 -->
<g id="node1478" class="node">
<title>dp3_pp1_to_pp2</title>
<ellipse fill="lightblue" stroke="black" cx="302795" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="302795" y="-144.75" font-family="Arial" font-size="10.00">PP Stage Transition</text>
<text text-anchor="middle" x="302795" y="-133.75" font-family="Arial" font-size="10.00">GPU 111  GPU 112</text>
<text text-anchor="middle" x="302795" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="302795" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp1_layer8_expert_agg&#45;&gt;dp3_pp1_to_pp2 -->
<g id="edge2432" class="edge">
<title>dp3_pp1_layer8_expert_agg&#45;&gt;dp3_pp1_to_pp2</title>
<path fill="none" stroke="black" d="M283936.24,-248.22C284405.88,-232.99 285658.06,-194.32 286703,-179.52 290026.47,-132.45 301073.96,-131.61 302615.75,-131.73"/>
<polygon fill="black" stroke="black" points="302615.8,-135.23 302625.8,-131.73 302615.8,-128.23 302615.8,-135.23"/>
</g>
<!-- dp3_pp2_layer9_attn_tp0 -->
<g id="node1291" class="node">
<title>dp3_pp2_layer9_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="281657.5,-531.06 281392.5,-531.06 281392.5,-479.06 281657.5,-479.06 281657.5,-531.06"/>
<text text-anchor="middle" x="281525" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="281525" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="281525" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="281525" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer9_attn_allreduce -->
<g id="node1292" class="node">
<title>dp3_pp2_layer9_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="281100" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="281100" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="281100" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="281100" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="281100" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_attn_tp0&#45;&gt;dp3_pp2_layer9_attn_allreduce -->
<g id="edge2123" class="edge">
<title>dp3_pp2_layer9_attn_tp0&#45;&gt;dp3_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M281459.82,-478.95C281436.12,-470.23 281409.01,-460.72 281384,-453.06 281332.14,-437.17 281274.21,-422.07 281224.26,-409.85"/>
<polygon fill="black" stroke="black" points="281224.92,-406.41 281214.38,-407.45 281223.27,-413.21 281224.92,-406.41"/>
</g>
<!-- dp3_pp2_layer9_router -->
<g id="node1296" class="node">
<title>dp3_pp2_layer9_router</title>
<polygon fill="lightyellow" stroke="black" points="278839.57,-557.06 278445.74,-557.06 278344.43,-453.06 278738.26,-453.06 278839.57,-557.06"/>
<text text-anchor="middle" x="278592" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="278592" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="278592" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="278592" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_attn_allreduce&#45;&gt;dp3_pp2_layer9_router -->
<g id="edge2159" class="edge">
<title>dp3_pp2_layer9_attn_allreduce&#45;&gt;dp3_pp2_layer9_router</title>
<path fill="none" stroke="black" d="M280939.7,-392.14C280825.73,-399.66 280669,-409.63 280531,-417.06 279895.48,-451.29 279142.27,-482.37 278790.96,-496.31"/>
<polygon fill="black" stroke="black" points="278790.79,-492.82 278780.94,-496.71 278791.07,-499.81 278790.79,-492.82"/>
</g>
<!-- dp3_pp2_layer9_attn_tp1 -->
<g id="node1293" class="node">
<title>dp3_pp2_layer9_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="280808.5,-531.06 280543.5,-531.06 280543.5,-479.06 280808.5,-479.06 280808.5,-531.06"/>
<text text-anchor="middle" x="280676" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="280676" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="280676" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="280676" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer9_attn_tp1&#45;&gt;dp3_pp2_layer9_attn_allreduce -->
<g id="edge2124" class="edge">
<title>dp3_pp2_layer9_attn_tp1&#45;&gt;dp3_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M280741.66,-479C280765.53,-470.28 280792.83,-460.77 280818,-453.06 280869.51,-437.29 280927.04,-422.21 280976.64,-409.97"/>
<polygon fill="black" stroke="black" points="280977.57,-413.35 280986.45,-407.57 280975.9,-406.55 280977.57,-413.35"/>
</g>
<!-- dp3_pp2_layer9_attn_tp2 -->
<g id="node1294" class="node">
<title>dp3_pp2_layer9_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="281374.5,-531.06 281109.5,-531.06 281109.5,-479.06 281374.5,-479.06 281374.5,-531.06"/>
<text text-anchor="middle" x="281242" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="281242" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="281242" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="281242" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer9_attn_tp2&#45;&gt;dp3_pp2_layer9_attn_allreduce -->
<g id="edge2125" class="edge">
<title>dp3_pp2_layer9_attn_tp2&#45;&gt;dp3_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M281212.92,-478.92C281194.28,-462.8 281169.62,-441.49 281148.11,-422.89"/>
<polygon fill="black" stroke="black" points="281150.2,-420.06 281140.34,-416.17 281145.62,-425.36 281150.2,-420.06"/>
</g>
<!-- dp3_pp2_layer9_attn_tp3 -->
<g id="node1295" class="node">
<title>dp3_pp2_layer9_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="281091.5,-531.06 280826.5,-531.06 280826.5,-479.06 281091.5,-479.06 281091.5,-531.06"/>
<text text-anchor="middle" x="280959" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="280959" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="280959" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="280959" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer9_attn_tp3&#45;&gt;dp3_pp2_layer9_attn_allreduce -->
<g id="edge2126" class="edge">
<title>dp3_pp2_layer9_attn_tp3&#45;&gt;dp3_pp2_layer9_attn_allreduce</title>
<path fill="none" stroke="black" d="M280987.87,-478.92C281006.39,-462.8 281030.87,-441.49 281052.23,-422.89"/>
<polygon fill="black" stroke="black" points="281054.7,-425.38 281059.94,-416.17 281050.1,-420.1 281054.7,-425.38"/>
</g>
<!-- dp3_pp2_layer9_expert0 -->
<g id="node1297" class="node">
<title>dp3_pp2_layer9_expert0</title>
<polygon fill="lightgreen" stroke="black" points="276889,-406.29 276665,-406.29 276665,-354.29 276889,-354.29 276889,-406.29"/>
<text text-anchor="middle" x="276777" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="276777" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="276777" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="276777" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert0 -->
<g id="edge2127" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278389.73,-499.65C278004.55,-490.26 277179.11,-465.13 276898,-417.06 276885.99,-415.01 276873.48,-412.16 276861.27,-408.95"/>
<polygon fill="black" stroke="black" points="276862.11,-405.56 276851.54,-406.32 276860.28,-412.31 276862.11,-405.56"/>
</g>
<!-- dp3_pp2_layer9_expert1 -->
<g id="node1298" class="node">
<title>dp3_pp2_layer9_expert1</title>
<polygon fill="lightgreen" stroke="black" points="277131,-406.29 276907,-406.29 276907,-354.29 277131,-354.29 277131,-406.29"/>
<text text-anchor="middle" x="277019" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="277019" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="277019" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="277019" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert1 -->
<g id="edge2128" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278387.55,-497.55C278045.94,-485.71 277373.58,-458.03 277140,-417.06 277128.08,-414.97 277115.67,-412.12 277103.54,-408.93"/>
<polygon fill="black" stroke="black" points="277104.45,-405.55 277093.89,-406.3 277102.62,-412.3 277104.45,-405.55"/>
</g>
<!-- dp3_pp2_layer9_expert2 -->
<g id="node1299" class="node">
<title>dp3_pp2_layer9_expert2</title>
<polygon fill="lightgreen" stroke="black" points="277373,-406.29 277149,-406.29 277149,-354.29 277373,-354.29 277373,-406.29"/>
<text text-anchor="middle" x="277261" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="277261" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="277261" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="277261" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert2 -->
<g id="edge2129" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278392.82,-502.85C278151.66,-498.37 277734.02,-480.97 277382,-417.06 277370.38,-414.95 277358.29,-412.14 277346.44,-409.03"/>
<polygon fill="black" stroke="black" points="277347.13,-405.59 277336.56,-406.34 277345.29,-412.34 277347.13,-405.59"/>
</g>
<!-- dp3_pp2_layer9_expert3 -->
<g id="node1300" class="node">
<title>dp3_pp2_layer9_expert3</title>
<polygon fill="lightgreen" stroke="black" points="277615,-406.29 277391,-406.29 277391,-354.29 277615,-354.29 277615,-406.29"/>
<text text-anchor="middle" x="277503" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="277503" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="277503" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="277503" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert3 -->
<g id="edge2130" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278387.36,-497.41C278190.31,-488.25 277884.63,-466.79 277624,-417.06 277612.57,-414.88 277600.67,-412.06 277588.99,-408.97"/>
<polygon fill="black" stroke="black" points="277589.82,-405.57 277579.25,-406.31 277587.98,-412.32 277589.82,-405.57"/>
</g>
<!-- dp3_pp2_layer9_expert4 -->
<g id="node1301" class="node">
<title>dp3_pp2_layer9_expert4</title>
<polygon fill="lightgreen" stroke="black" points="277857,-406.29 277633,-406.29 277633,-354.29 277857,-354.29 277857,-406.29"/>
<text text-anchor="middle" x="277745" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="277745" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="277745" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="277745" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert4 -->
<g id="edge2131" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278378.43,-487.98C278232.99,-474.71 278036.64,-452.25 277866,-417.06 277855.05,-414.8 277843.65,-412.02 277832.43,-409.02"/>
<polygon fill="black" stroke="black" points="277833.19,-405.6 277822.62,-406.33 277831.34,-412.35 277833.19,-405.6"/>
</g>
<!-- dp3_pp2_layer9_expert5 -->
<g id="node1302" class="node">
<title>dp3_pp2_layer9_expert5</title>
<polygon fill="lightgreen" stroke="black" points="278099,-406.29 277875,-406.29 277875,-354.29 278099,-354.29 278099,-406.29"/>
<text text-anchor="middle" x="277987" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="277987" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="277987" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="277987" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert5 -->
<g id="edge2132" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278358.29,-467.38C278278.5,-453.44 278189,-436.25 278108,-417.06 278097.9,-414.67 278087.4,-411.94 278076.99,-409.07"/>
<polygon fill="black" stroke="black" points="278077.62,-405.62 278067.05,-406.3 278075.74,-412.36 278077.62,-405.62"/>
</g>
<!-- dp3_pp2_layer9_expert6 -->
<g id="node1303" class="node">
<title>dp3_pp2_layer9_expert6</title>
<polygon fill="lightgreen" stroke="black" points="278341,-406.29 278117,-406.29 278117,-354.29 278341,-354.29 278341,-406.29"/>
<text text-anchor="middle" x="278229" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="278229" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="278229" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="278229" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert6 -->
<g id="edge2133" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278440.94,-452.97C278397.16,-438.16 278350.94,-422.53 278312.87,-409.66"/>
<polygon fill="black" stroke="black" points="278313.97,-406.33 278303.38,-406.45 278311.73,-412.97 278313.97,-406.33"/>
</g>
<!-- dp3_pp2_layer9_expert7 -->
<g id="node1304" class="node">
<title>dp3_pp2_layer9_expert7</title>
<polygon fill="lightgreen" stroke="black" points="278583,-406.29 278359,-406.29 278359,-354.29 278583,-354.29 278583,-406.29"/>
<text text-anchor="middle" x="278471" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="278471" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="278471" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="278471" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert7 -->
<g id="edge2134" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278541.38,-452.71C278528.3,-439.43 278514.58,-425.51 278502.76,-413.52"/>
<polygon fill="black" stroke="black" points="278505.19,-411 278495.68,-406.33 278500.2,-415.91 278505.19,-411"/>
</g>
<!-- dp3_pp2_layer9_expert8 -->
<g id="node1305" class="node">
<title>dp3_pp2_layer9_expert8</title>
<polygon fill="lightgreen" stroke="black" points="278825,-406.29 278601,-406.29 278601,-354.29 278825,-354.29 278825,-406.29"/>
<text text-anchor="middle" x="278713" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="278713" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="278713" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="278713" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert8 -->
<g id="edge2135" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278642.61,-452.71C278655.7,-439.43 278669.42,-425.51 278681.23,-413.52"/>
<polygon fill="black" stroke="black" points="278683.79,-415.91 278688.32,-406.33 278678.81,-411 278683.79,-415.91"/>
</g>
<!-- dp3_pp2_layer9_expert9 -->
<g id="node1306" class="node">
<title>dp3_pp2_layer9_expert9</title>
<polygon fill="lightgreen" stroke="black" points="279067,-406.29 278843,-406.29 278843,-354.29 279067,-354.29 279067,-406.29"/>
<text text-anchor="middle" x="278955" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="278955" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="278955" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="278955" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert9 -->
<g id="edge2136" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278739.38,-454.21C278784.29,-439.03 278832.08,-422.86 278871.23,-409.62"/>
<polygon fill="black" stroke="black" points="278872.64,-412.84 278880.99,-406.32 278870.4,-406.21 278872.64,-412.84"/>
</g>
<!-- dp3_pp2_layer9_expert10 -->
<g id="node1307" class="node">
<title>dp3_pp2_layer9_expert10</title>
<polygon fill="lightgreen" stroke="black" points="279309,-406.29 279085,-406.29 279085,-354.29 279309,-354.29 279309,-406.29"/>
<text text-anchor="middle" x="279197" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="279197" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="279197" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="279197" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert10 -->
<g id="edge2137" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278762.89,-478.04C278855.98,-462.69 278972.88,-441.49 279076,-417.06 279086.09,-414.67 279096.6,-411.94 279107.01,-409.07"/>
<polygon fill="black" stroke="black" points="279108.26,-412.36 279116.95,-406.3 279106.37,-405.62 279108.26,-412.36"/>
</g>
<!-- dp3_pp2_layer9_expert11 -->
<g id="node1308" class="node">
<title>dp3_pp2_layer9_expert11</title>
<polygon fill="lightgreen" stroke="black" points="279551,-406.29 279327,-406.29 279327,-354.29 279551,-354.29 279551,-406.29"/>
<text text-anchor="middle" x="279439" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="279439" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="279439" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="279439" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert11 -->
<g id="edge2138" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278774.99,-490.7C278922.62,-477.88 279135.08,-454.78 279318,-417.06 279328.95,-414.8 279340.35,-412.02 279351.57,-409.02"/>
<polygon fill="black" stroke="black" points="279352.66,-412.35 279361.38,-406.33 279350.81,-405.6 279352.66,-412.35"/>
</g>
<!-- dp3_pp2_layer9_expert12 -->
<g id="node1309" class="node">
<title>dp3_pp2_layer9_expert12</title>
<polygon fill="lightgreen" stroke="black" points="279793,-406.29 279569,-406.29 279569,-354.29 279793,-354.29 279793,-406.29"/>
<text text-anchor="middle" x="279681" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="279681" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="279681" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="279681" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert12 -->
<g id="edge2139" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278782.27,-498.07C278978.59,-489.29 279292.95,-468.01 279560,-417.06 279571.43,-414.88 279583.33,-412.06 279595.01,-408.97"/>
<polygon fill="black" stroke="black" points="279596.02,-412.32 279604.75,-406.31 279594.18,-405.57 279596.02,-412.32"/>
</g>
<!-- dp3_pp2_layer9_expert13 -->
<g id="node1310" class="node">
<title>dp3_pp2_layer9_expert13</title>
<polygon fill="lightgreen" stroke="black" points="280035,-406.29 279811,-406.29 279811,-354.29 280035,-354.29 280035,-406.29"/>
<text text-anchor="middle" x="279923" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="279923" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="279923" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="279923" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert13 -->
<g id="edge2140" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278786.93,-502.93C279027.42,-498.58 279447.9,-481.35 279802,-417.06 279813.62,-414.95 279825.71,-412.14 279837.56,-409.03"/>
<polygon fill="black" stroke="black" points="279838.7,-412.34 279847.44,-406.34 279836.87,-405.59 279838.7,-412.34"/>
</g>
<!-- dp3_pp2_layer9_expert14 -->
<g id="node1311" class="node">
<title>dp3_pp2_layer9_expert14</title>
<polygon fill="lightgreen" stroke="black" points="280277,-406.29 280053,-406.29 280053,-354.29 280277,-354.29 280277,-406.29"/>
<text text-anchor="middle" x="280165" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="280165" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="280165" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="280165" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert14 -->
<g id="edge2141" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278782.32,-498.04C279119.17,-486.48 279807.15,-458.6 280044,-417.06 280055.92,-414.97 280068.32,-412.12 280080.46,-408.93"/>
<polygon fill="black" stroke="black" points="280081.38,-412.3 280090.11,-406.3 280079.54,-405.55 280081.38,-412.3"/>
</g>
<!-- dp3_pp2_layer9_expert15 -->
<g id="node1312" class="node">
<title>dp3_pp2_layer9_expert15</title>
<polygon fill="lightgreen" stroke="black" points="280519,-406.29 280295,-406.29 280295,-354.29 280519,-354.29 280519,-406.29"/>
<text text-anchor="middle" x="280407" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="280407" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="280407" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="280407" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert15 -->
<g id="edge2142" class="edge">
<title>dp3_pp2_layer9_router&#45;&gt;dp3_pp2_layer9_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M278783.94,-499.9C279164.49,-490.72 280002.35,-465.57 280286,-417.06 280298.01,-415.01 280310.51,-412.16 280322.73,-408.95"/>
<polygon fill="black" stroke="black" points="280323.72,-412.31 280332.45,-406.32 280321.88,-405.56 280323.72,-412.31"/>
</g>
<!-- dp3_pp2_layer9_expert_agg -->
<g id="node1313" class="node">
<title>dp3_pp2_layer9_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="278839.57,-307.52 278445.74,-307.52 278344.43,-203.52 278738.26,-203.52 278839.57,-307.52"/>
<text text-anchor="middle" x="278592" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="278592" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="278592" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="278592" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer9_expert0&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2143" class="edge">
<title>dp3_pp2_layer9_expert0&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M276835.07,-354.29C276854.69,-346.92 276876.97,-339.72 276898,-335.52 277177.13,-279.86 278000.93,-263.21 278387.43,-258.4"/>
<polygon fill="black" stroke="black" points="278387.65,-261.9 278397.61,-258.27 278387.57,-254.9 278387.65,-261.9"/>
</g>
<!-- dp3_pp2_layer9_expert1&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2144" class="edge">
<title>dp3_pp2_layer9_expert1&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M277077.39,-354.27C277096.95,-346.95 277119.09,-339.78 277140,-335.52 277372.8,-288.16 278048.09,-267.74 278389.43,-260.24"/>
<polygon fill="black" stroke="black" points="278389.51,-263.74 278399.43,-260.03 278389.35,-256.74 278389.51,-263.74"/>
</g>
<!-- dp3_pp2_layer9_expert2&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2145" class="edge">
<title>dp3_pp2_layer9_expert2&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M277319.73,-354.29C277339.21,-347.01 277361.23,-339.87 277382,-335.52 277568.91,-296.44 278098.54,-273.07 278391.3,-262.78"/>
<polygon fill="black" stroke="black" points="278391.74,-266.27 278401.61,-262.42 278391.5,-259.27 278391.74,-266.27"/>
</g>
<!-- dp3_pp2_layer9_expert3&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2146" class="edge">
<title>dp3_pp2_layer9_expert3&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M277562.39,-354.26C277581.72,-347.07 277603.48,-339.99 277624,-335.52 277882.91,-279.18 278188.7,-262.24 278386.26,-257.56"/>
<polygon fill="black" stroke="black" points="278386.55,-261.06 278396.47,-257.33 278386.39,-254.06 278386.55,-261.06"/>
</g>
<!-- dp3_pp2_layer9_expert4&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2147" class="edge">
<title>dp3_pp2_layer9_expert4&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M277805.39,-354.24C277824.49,-347.2 277845.87,-340.19 277866,-335.52 278041.82,-294.77 278246.6,-274.91 278393.75,-265.31"/>
<polygon fill="black" stroke="black" points="278394.05,-268.8 278403.81,-264.67 278393.6,-261.82 278394.05,-268.8"/>
</g>
<!-- dp3_pp2_layer9_expert5&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2148" class="edge">
<title>dp3_pp2_layer9_expert5&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M278049.42,-354.22C278068.04,-347.42 278088.65,-340.55 278108,-335.52 278205.09,-310.27 278315.34,-291.53 278406.07,-278.65"/>
<polygon fill="black" stroke="black" points="278406.78,-282.09 278416.19,-277.23 278405.8,-275.16 278406.78,-282.09"/>
</g>
<!-- dp3_pp2_layer9_expert6&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2149" class="edge">
<title>dp3_pp2_layer9_expert6&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M278297.02,-354.26C278314.26,-348.03 278332.78,-341.44 278350,-335.52 278376.73,-326.33 278405.21,-316.8 278432.89,-307.67"/>
<polygon fill="black" stroke="black" points="278434.24,-310.91 278442.65,-304.46 278432.06,-304.26 278434.24,-310.91"/>
</g>
<!-- dp3_pp2_layer9_expert7&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2150" class="edge">
<title>dp3_pp2_layer9_expert7&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M278495.78,-354.15C278507.02,-342.74 278520.83,-328.73 278534.45,-314.92"/>
<polygon fill="black" stroke="black" points="278537,-317.31 278541.53,-307.73 278532.02,-312.39 278537,-317.31"/>
</g>
<!-- dp3_pp2_layer9_expert8&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2151" class="edge">
<title>dp3_pp2_layer9_expert8&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M278688.22,-354.15C278676.97,-342.74 278663.16,-328.73 278649.55,-314.92"/>
<polygon fill="black" stroke="black" points="278651.98,-312.39 278642.47,-307.73 278646.99,-317.31 278651.98,-312.39"/>
</g>
<!-- dp3_pp2_layer9_expert9&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2152" class="edge">
<title>dp3_pp2_layer9_expert9&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M278886.98,-354.26C278869.73,-348.03 278851.21,-341.44 278834,-335.52 278810.29,-327.37 278785.21,-318.95 278760.53,-310.78"/>
<polygon fill="black" stroke="black" points="278761.32,-307.36 278750.73,-307.54 278759.12,-314 278761.32,-307.36"/>
</g>
<!-- dp3_pp2_layer9_expert10&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2153" class="edge">
<title>dp3_pp2_layer9_expert10&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M279134.58,-354.22C279115.96,-347.42 279095.35,-340.55 279076,-335.52 278995.99,-314.71 278907.05,-298.33 278827.46,-286"/>
<polygon fill="black" stroke="black" points="278827.71,-282.5 278817.3,-284.44 278826.65,-289.41 278827.71,-282.5"/>
</g>
<!-- dp3_pp2_layer9_expert11&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2154" class="edge">
<title>dp3_pp2_layer9_expert11&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M279378.61,-354.24C279359.51,-347.2 279338.13,-340.19 279318,-335.52 279149.74,-296.53 278954.97,-276.66 278809.55,-266.61"/>
<polygon fill="black" stroke="black" points="278809.38,-263.09 278799.16,-265.9 278808.9,-270.07 278809.38,-263.09"/>
</g>
<!-- dp3_pp2_layer9_expert12&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2155" class="edge">
<title>dp3_pp2_layer9_expert12&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M279621.61,-354.26C279602.28,-347.07 279580.52,-339.99 279560,-335.52 279302.51,-279.49 278998.64,-262.43 278800.99,-257.64"/>
<polygon fill="black" stroke="black" points="278800.86,-254.14 278790.78,-257.4 278800.69,-261.13 278800.86,-254.14"/>
</g>
<!-- dp3_pp2_layer9_expert13&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2156" class="edge">
<title>dp3_pp2_layer9_expert13&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M279864.27,-354.29C279844.79,-347.01 279822.77,-339.87 279802,-335.52 279618.02,-297.05 279101.97,-273.81 278806.63,-263.27"/>
<polygon fill="black" stroke="black" points="278806.33,-259.76 278796.21,-262.9 278806.08,-266.76 278806.33,-259.76"/>
</g>
<!-- dp3_pp2_layer9_expert14&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2157" class="edge">
<title>dp3_pp2_layer9_expert14&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M280106.6,-354.27C280087.05,-346.95 280064.9,-339.78 280044,-335.52 279813.27,-288.58 279147.86,-268.1 278803.74,-260.45"/>
<polygon fill="black" stroke="black" points="278803.73,-256.94 278793.65,-260.22 278803.57,-263.94 278803.73,-256.94"/>
</g>
<!-- dp3_pp2_layer9_expert15&#45;&gt;dp3_pp2_layer9_expert_agg -->
<g id="edge2158" class="edge">
<title>dp3_pp2_layer9_expert15&#45;&gt;dp3_pp2_layer9_expert_agg</title>
<path fill="none" stroke="black" d="M280348.93,-354.29C280329.3,-346.92 280307.03,-339.72 280286,-335.52 280008.21,-280.12 279190.98,-263.37 278802.17,-258.47"/>
<polygon fill="black" stroke="black" points="278801.97,-254.97 278791.93,-258.34 278801.88,-261.97 278801.97,-254.97"/>
</g>
<!-- dp3_pp2_layer10_attn_tp0 -->
<g id="node1314" class="node">
<title>dp3_pp2_layer10_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="276074.5,-531.06 275809.5,-531.06 275809.5,-479.06 276074.5,-479.06 276074.5,-531.06"/>
<text text-anchor="middle" x="275942" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="275942" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="275942" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="275942" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer9_expert_agg&#45;&gt;dp3_pp2_layer10_attn_tp0 -->
<g id="edge2160" class="edge">
<title>dp3_pp2_layer9_expert_agg&#45;&gt;dp3_pp2_layer10_attn_tp0</title>
<path fill="none" stroke="black" d="M278399.78,-260.41C277979.38,-269.54 276989.17,-294.77 276656,-335.52 276623.8,-339.46 276115.23,-444.29 276084,-453.06 276061.37,-459.41 276037.16,-467.58 276015.26,-475.5"/>
<polygon fill="black" stroke="black" points="276013.89,-472.28 276005.7,-479 276016.29,-478.85 276013.89,-472.28"/>
</g>
<!-- dp3_pp2_layer10_attn_allreduce -->
<g id="node1315" class="node">
<title>dp3_pp2_layer10_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="276071" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="276071" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="276071" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="276071" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="276071" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_attn_tp0&#45;&gt;dp3_pp2_layer10_attn_allreduce -->
<g id="edge2161" class="edge">
<title>dp3_pp2_layer10_attn_tp0&#45;&gt;dp3_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M275968.41,-478.92C275985.15,-463 276007.21,-442 276026.58,-423.56"/>
<polygon fill="black" stroke="black" points="276029.03,-426.07 276033.86,-416.64 276024.2,-421 276029.03,-426.07"/>
</g>
<!-- dp3_pp2_layer10_router -->
<g id="node1319" class="node">
<title>dp3_pp2_layer10_router</title>
<polygon fill="lightyellow" stroke="black" points="273822.57,-557.06 273428.74,-557.06 273327.43,-453.06 273721.26,-453.06 273822.57,-557.06"/>
<text text-anchor="middle" x="273575" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="273575" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="273575" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="273575" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_attn_allreduce&#45;&gt;dp3_pp2_layer10_router -->
<g id="edge2197" class="edge">
<title>dp3_pp2_layer10_attn_allreduce&#45;&gt;dp3_pp2_layer10_router</title>
<path fill="none" stroke="black" d="M275911.08,-392.38C275799.77,-399.9 275647.89,-409.76 275514,-417.06 274878.5,-451.72 274125.28,-482.59 273773.96,-496.4"/>
<polygon fill="black" stroke="black" points="273773.8,-492.91 273763.94,-496.79 273774.07,-499.9 273773.8,-492.91"/>
</g>
<!-- dp3_pp2_layer10_attn_tp1 -->
<g id="node1316" class="node">
<title>dp3_pp2_layer10_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="276357.5,-531.06 276092.5,-531.06 276092.5,-479.06 276357.5,-479.06 276357.5,-531.06"/>
<text text-anchor="middle" x="276225" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="276225" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="276225" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="276225" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer10_attn_tp1&#45;&gt;dp3_pp2_layer10_attn_allreduce -->
<g id="edge2162" class="edge">
<title>dp3_pp2_layer10_attn_tp1&#45;&gt;dp3_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M276193.46,-478.92C276172.99,-462.6 276145.83,-440.94 276122.29,-422.18"/>
<polygon fill="black" stroke="black" points="276124.46,-419.44 276114.46,-415.94 276120.1,-424.91 276124.46,-419.44"/>
</g>
<!-- dp3_pp2_layer10_attn_tp2 -->
<g id="node1317" class="node">
<title>dp3_pp2_layer10_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="275791.5,-531.06 275526.5,-531.06 275526.5,-479.06 275791.5,-479.06 275791.5,-531.06"/>
<text text-anchor="middle" x="275659" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="275659" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="275659" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="275659" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer10_attn_tp2&#45;&gt;dp3_pp2_layer10_attn_allreduce -->
<g id="edge2163" class="edge">
<title>dp3_pp2_layer10_attn_tp2&#45;&gt;dp3_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M275725.07,-479.02C275748.85,-470.35 275775.99,-460.86 275801,-453.06 275849.74,-437.86 275904.05,-423.03 275951.1,-410.83"/>
<polygon fill="black" stroke="black" points="275952.22,-414.15 275961.03,-408.26 275950.47,-407.38 275952.22,-414.15"/>
</g>
<!-- dp3_pp2_layer10_attn_tp3 -->
<g id="node1318" class="node">
<title>dp3_pp2_layer10_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="276640.5,-531.06 276375.5,-531.06 276375.5,-479.06 276640.5,-479.06 276640.5,-531.06"/>
<text text-anchor="middle" x="276508" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="276508" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="276508" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="276508" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer10_attn_tp3&#45;&gt;dp3_pp2_layer10_attn_allreduce -->
<g id="edge2164" class="edge">
<title>dp3_pp2_layer10_attn_tp3&#45;&gt;dp3_pp2_layer10_attn_allreduce</title>
<path fill="none" stroke="black" d="M276443.21,-478.95C276419.43,-470.18 276392.17,-460.64 276367,-453.06 276312.42,-436.63 276251.31,-421.31 276198.86,-409.08"/>
<polygon fill="black" stroke="black" points="276199.37,-405.6 276188.83,-406.75 276197.78,-412.42 276199.37,-405.6"/>
</g>
<!-- dp3_pp2_layer10_expert0 -->
<g id="node1320" class="node">
<title>dp3_pp2_layer10_expert0</title>
<polygon fill="lightgreen" stroke="black" points="271872,-406.29 271648,-406.29 271648,-354.29 271872,-354.29 271872,-406.29"/>
<text text-anchor="middle" x="271760" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="271760" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="271760" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="271760" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert0 -->
<g id="edge2165" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273372.73,-499.65C272987.55,-490.26 272162.11,-465.13 271881,-417.06 271868.99,-415.01 271856.48,-412.16 271844.27,-408.95"/>
<polygon fill="black" stroke="black" points="271845.11,-405.56 271834.54,-406.32 271843.28,-412.31 271845.11,-405.56"/>
</g>
<!-- dp3_pp2_layer10_expert1 -->
<g id="node1321" class="node">
<title>dp3_pp2_layer10_expert1</title>
<polygon fill="lightgreen" stroke="black" points="272114,-406.29 271890,-406.29 271890,-354.29 272114,-354.29 272114,-406.29"/>
<text text-anchor="middle" x="272002" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="272002" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="272002" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="272002" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert1 -->
<g id="edge2166" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273370.55,-497.55C273028.94,-485.71 272356.58,-458.03 272123,-417.06 272111.08,-414.97 272098.67,-412.12 272086.54,-408.93"/>
<polygon fill="black" stroke="black" points="272087.45,-405.55 272076.89,-406.3 272085.62,-412.3 272087.45,-405.55"/>
</g>
<!-- dp3_pp2_layer10_expert2 -->
<g id="node1322" class="node">
<title>dp3_pp2_layer10_expert2</title>
<polygon fill="lightgreen" stroke="black" points="272356,-406.29 272132,-406.29 272132,-354.29 272356,-354.29 272356,-406.29"/>
<text text-anchor="middle" x="272244" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="272244" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="272244" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="272244" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert2 -->
<g id="edge2167" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273375.82,-502.85C273134.66,-498.37 272717.02,-480.97 272365,-417.06 272353.38,-414.95 272341.29,-412.14 272329.44,-409.03"/>
<polygon fill="black" stroke="black" points="272330.13,-405.59 272319.56,-406.34 272328.29,-412.34 272330.13,-405.59"/>
</g>
<!-- dp3_pp2_layer10_expert3 -->
<g id="node1323" class="node">
<title>dp3_pp2_layer10_expert3</title>
<polygon fill="lightgreen" stroke="black" points="272598,-406.29 272374,-406.29 272374,-354.29 272598,-354.29 272598,-406.29"/>
<text text-anchor="middle" x="272486" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="272486" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="272486" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="272486" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert3 -->
<g id="edge2168" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273370.36,-497.41C273173.31,-488.25 272867.63,-466.79 272607,-417.06 272595.57,-414.88 272583.67,-412.06 272571.99,-408.97"/>
<polygon fill="black" stroke="black" points="272572.82,-405.57 272562.25,-406.31 272570.98,-412.32 272572.82,-405.57"/>
</g>
<!-- dp3_pp2_layer10_expert4 -->
<g id="node1324" class="node">
<title>dp3_pp2_layer10_expert4</title>
<polygon fill="lightgreen" stroke="black" points="272840,-406.29 272616,-406.29 272616,-354.29 272840,-354.29 272840,-406.29"/>
<text text-anchor="middle" x="272728" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="272728" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="272728" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="272728" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert4 -->
<g id="edge2169" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273361.43,-487.98C273215.99,-474.71 273019.64,-452.25 272849,-417.06 272838.05,-414.8 272826.65,-412.02 272815.43,-409.02"/>
<polygon fill="black" stroke="black" points="272816.19,-405.6 272805.62,-406.33 272814.34,-412.35 272816.19,-405.6"/>
</g>
<!-- dp3_pp2_layer10_expert5 -->
<g id="node1325" class="node">
<title>dp3_pp2_layer10_expert5</title>
<polygon fill="lightgreen" stroke="black" points="273082,-406.29 272858,-406.29 272858,-354.29 273082,-354.29 273082,-406.29"/>
<text text-anchor="middle" x="272970" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="272970" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="272970" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="272970" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert5 -->
<g id="edge2170" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273341.29,-467.38C273261.5,-453.44 273172,-436.25 273091,-417.06 273080.9,-414.67 273070.4,-411.94 273059.99,-409.07"/>
<polygon fill="black" stroke="black" points="273060.62,-405.62 273050.05,-406.3 273058.74,-412.36 273060.62,-405.62"/>
</g>
<!-- dp3_pp2_layer10_expert6 -->
<g id="node1326" class="node">
<title>dp3_pp2_layer10_expert6</title>
<polygon fill="lightgreen" stroke="black" points="273324,-406.29 273100,-406.29 273100,-354.29 273324,-354.29 273324,-406.29"/>
<text text-anchor="middle" x="273212" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="273212" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="273212" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="273212" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert6 -->
<g id="edge2171" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273423.94,-452.97C273380.16,-438.16 273333.94,-422.53 273295.87,-409.66"/>
<polygon fill="black" stroke="black" points="273296.97,-406.33 273286.38,-406.45 273294.73,-412.97 273296.97,-406.33"/>
</g>
<!-- dp3_pp2_layer10_expert7 -->
<g id="node1327" class="node">
<title>dp3_pp2_layer10_expert7</title>
<polygon fill="lightgreen" stroke="black" points="273566,-406.29 273342,-406.29 273342,-354.29 273566,-354.29 273566,-406.29"/>
<text text-anchor="middle" x="273454" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="273454" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="273454" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="273454" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert7 -->
<g id="edge2172" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273524.38,-452.71C273511.3,-439.43 273497.58,-425.51 273485.76,-413.52"/>
<polygon fill="black" stroke="black" points="273488.19,-411 273478.68,-406.33 273483.2,-415.91 273488.19,-411"/>
</g>
<!-- dp3_pp2_layer10_expert8 -->
<g id="node1328" class="node">
<title>dp3_pp2_layer10_expert8</title>
<polygon fill="lightgreen" stroke="black" points="273808,-406.29 273584,-406.29 273584,-354.29 273808,-354.29 273808,-406.29"/>
<text text-anchor="middle" x="273696" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="273696" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="273696" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="273696" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert8 -->
<g id="edge2173" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273625.61,-452.71C273638.7,-439.43 273652.42,-425.51 273664.23,-413.52"/>
<polygon fill="black" stroke="black" points="273666.79,-415.91 273671.32,-406.33 273661.81,-411 273666.79,-415.91"/>
</g>
<!-- dp3_pp2_layer10_expert9 -->
<g id="node1329" class="node">
<title>dp3_pp2_layer10_expert9</title>
<polygon fill="lightgreen" stroke="black" points="274050,-406.29 273826,-406.29 273826,-354.29 274050,-354.29 274050,-406.29"/>
<text text-anchor="middle" x="273938" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="273938" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="273938" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="273938" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert9 -->
<g id="edge2174" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273722.38,-454.21C273767.29,-439.03 273815.08,-422.86 273854.23,-409.62"/>
<polygon fill="black" stroke="black" points="273855.64,-412.84 273863.99,-406.32 273853.4,-406.21 273855.64,-412.84"/>
</g>
<!-- dp3_pp2_layer10_expert10 -->
<g id="node1330" class="node">
<title>dp3_pp2_layer10_expert10</title>
<polygon fill="lightgreen" stroke="black" points="274292,-406.29 274068,-406.29 274068,-354.29 274292,-354.29 274292,-406.29"/>
<text text-anchor="middle" x="274180" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="274180" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="274180" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="274180" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert10 -->
<g id="edge2175" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273745.89,-478.04C273838.98,-462.69 273955.88,-441.49 274059,-417.06 274069.09,-414.67 274079.6,-411.94 274090.01,-409.07"/>
<polygon fill="black" stroke="black" points="274091.26,-412.36 274099.95,-406.3 274089.37,-405.62 274091.26,-412.36"/>
</g>
<!-- dp3_pp2_layer10_expert11 -->
<g id="node1331" class="node">
<title>dp3_pp2_layer10_expert11</title>
<polygon fill="lightgreen" stroke="black" points="274534,-406.29 274310,-406.29 274310,-354.29 274534,-354.29 274534,-406.29"/>
<text text-anchor="middle" x="274422" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="274422" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="274422" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="274422" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert11 -->
<g id="edge2176" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273757.99,-490.7C273905.62,-477.88 274118.08,-454.78 274301,-417.06 274311.95,-414.8 274323.35,-412.02 274334.57,-409.02"/>
<polygon fill="black" stroke="black" points="274335.66,-412.35 274344.38,-406.33 274333.81,-405.6 274335.66,-412.35"/>
</g>
<!-- dp3_pp2_layer10_expert12 -->
<g id="node1332" class="node">
<title>dp3_pp2_layer10_expert12</title>
<polygon fill="lightgreen" stroke="black" points="274776,-406.29 274552,-406.29 274552,-354.29 274776,-354.29 274776,-406.29"/>
<text text-anchor="middle" x="274664" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="274664" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="274664" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="274664" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert12 -->
<g id="edge2177" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273765.27,-498.07C273961.59,-489.29 274275.95,-468.01 274543,-417.06 274554.43,-414.88 274566.33,-412.06 274578.01,-408.97"/>
<polygon fill="black" stroke="black" points="274579.02,-412.32 274587.75,-406.31 274577.18,-405.57 274579.02,-412.32"/>
</g>
<!-- dp3_pp2_layer10_expert13 -->
<g id="node1333" class="node">
<title>dp3_pp2_layer10_expert13</title>
<polygon fill="lightgreen" stroke="black" points="275018,-406.29 274794,-406.29 274794,-354.29 275018,-354.29 275018,-406.29"/>
<text text-anchor="middle" x="274906" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="274906" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="274906" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="274906" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert13 -->
<g id="edge2178" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273769.93,-502.93C274010.42,-498.58 274430.9,-481.35 274785,-417.06 274796.62,-414.95 274808.71,-412.14 274820.56,-409.03"/>
<polygon fill="black" stroke="black" points="274821.7,-412.34 274830.44,-406.34 274819.87,-405.59 274821.7,-412.34"/>
</g>
<!-- dp3_pp2_layer10_expert14 -->
<g id="node1334" class="node">
<title>dp3_pp2_layer10_expert14</title>
<polygon fill="lightgreen" stroke="black" points="275260,-406.29 275036,-406.29 275036,-354.29 275260,-354.29 275260,-406.29"/>
<text text-anchor="middle" x="275148" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="275148" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="275148" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="275148" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert14 -->
<g id="edge2179" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273765.32,-498.04C274102.17,-486.48 274790.15,-458.6 275027,-417.06 275038.92,-414.97 275051.32,-412.12 275063.46,-408.93"/>
<polygon fill="black" stroke="black" points="275064.38,-412.3 275073.11,-406.3 275062.54,-405.55 275064.38,-412.3"/>
</g>
<!-- dp3_pp2_layer10_expert15 -->
<g id="node1335" class="node">
<title>dp3_pp2_layer10_expert15</title>
<polygon fill="lightgreen" stroke="black" points="275502,-406.29 275278,-406.29 275278,-354.29 275502,-354.29 275502,-406.29"/>
<text text-anchor="middle" x="275390" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="275390" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="275390" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="275390" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert15 -->
<g id="edge2180" class="edge">
<title>dp3_pp2_layer10_router&#45;&gt;dp3_pp2_layer10_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M273766.94,-499.9C274147.49,-490.72 274985.35,-465.57 275269,-417.06 275281.01,-415.01 275293.51,-412.16 275305.73,-408.95"/>
<polygon fill="black" stroke="black" points="275306.72,-412.31 275315.45,-406.32 275304.88,-405.56 275306.72,-412.31"/>
</g>
<!-- dp3_pp2_layer10_expert_agg -->
<g id="node1336" class="node">
<title>dp3_pp2_layer10_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="273822.57,-307.52 273428.74,-307.52 273327.43,-203.52 273721.26,-203.52 273822.57,-307.52"/>
<text text-anchor="middle" x="273575" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="273575" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="273575" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="273575" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer10_expert0&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2181" class="edge">
<title>dp3_pp2_layer10_expert0&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M271818.07,-354.29C271837.69,-346.92 271859.97,-339.72 271881,-335.52 272160.13,-279.86 272983.93,-263.21 273370.43,-258.4"/>
<polygon fill="black" stroke="black" points="273370.65,-261.9 273380.61,-258.27 273370.57,-254.9 273370.65,-261.9"/>
</g>
<!-- dp3_pp2_layer10_expert1&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2182" class="edge">
<title>dp3_pp2_layer10_expert1&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M272060.39,-354.27C272079.95,-346.95 272102.09,-339.78 272123,-335.52 272355.8,-288.16 273031.09,-267.74 273372.43,-260.24"/>
<polygon fill="black" stroke="black" points="273372.51,-263.74 273382.43,-260.03 273372.35,-256.74 273372.51,-263.74"/>
</g>
<!-- dp3_pp2_layer10_expert2&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2183" class="edge">
<title>dp3_pp2_layer10_expert2&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M272302.73,-354.29C272322.21,-347.01 272344.23,-339.87 272365,-335.52 272551.91,-296.44 273081.54,-273.07 273374.3,-262.78"/>
<polygon fill="black" stroke="black" points="273374.74,-266.27 273384.61,-262.42 273374.5,-259.27 273374.74,-266.27"/>
</g>
<!-- dp3_pp2_layer10_expert3&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2184" class="edge">
<title>dp3_pp2_layer10_expert3&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M272545.39,-354.26C272564.72,-347.07 272586.48,-339.99 272607,-335.52 272865.91,-279.18 273171.7,-262.24 273369.26,-257.56"/>
<polygon fill="black" stroke="black" points="273369.55,-261.06 273379.47,-257.33 273369.39,-254.06 273369.55,-261.06"/>
</g>
<!-- dp3_pp2_layer10_expert4&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2185" class="edge">
<title>dp3_pp2_layer10_expert4&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M272788.39,-354.24C272807.49,-347.2 272828.87,-340.19 272849,-335.52 273024.82,-294.77 273229.6,-274.91 273376.75,-265.31"/>
<polygon fill="black" stroke="black" points="273377.05,-268.8 273386.81,-264.67 273376.6,-261.82 273377.05,-268.8"/>
</g>
<!-- dp3_pp2_layer10_expert5&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2186" class="edge">
<title>dp3_pp2_layer10_expert5&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M273032.42,-354.22C273051.04,-347.42 273071.65,-340.55 273091,-335.52 273188.09,-310.27 273298.34,-291.53 273389.07,-278.65"/>
<polygon fill="black" stroke="black" points="273389.78,-282.09 273399.19,-277.23 273388.8,-275.16 273389.78,-282.09"/>
</g>
<!-- dp3_pp2_layer10_expert6&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2187" class="edge">
<title>dp3_pp2_layer10_expert6&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M273280.02,-354.26C273297.26,-348.03 273315.78,-341.44 273333,-335.52 273359.73,-326.33 273388.21,-316.8 273415.89,-307.67"/>
<polygon fill="black" stroke="black" points="273417.24,-310.91 273425.65,-304.46 273415.06,-304.26 273417.24,-310.91"/>
</g>
<!-- dp3_pp2_layer10_expert7&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2188" class="edge">
<title>dp3_pp2_layer10_expert7&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M273478.78,-354.15C273490.02,-342.74 273503.83,-328.73 273517.45,-314.92"/>
<polygon fill="black" stroke="black" points="273520,-317.31 273524.53,-307.73 273515.02,-312.39 273520,-317.31"/>
</g>
<!-- dp3_pp2_layer10_expert8&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2189" class="edge">
<title>dp3_pp2_layer10_expert8&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M273671.22,-354.15C273659.97,-342.74 273646.16,-328.73 273632.55,-314.92"/>
<polygon fill="black" stroke="black" points="273634.98,-312.39 273625.47,-307.73 273629.99,-317.31 273634.98,-312.39"/>
</g>
<!-- dp3_pp2_layer10_expert9&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2190" class="edge">
<title>dp3_pp2_layer10_expert9&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M273869.98,-354.26C273852.73,-348.03 273834.21,-341.44 273817,-335.52 273793.29,-327.37 273768.21,-318.95 273743.53,-310.78"/>
<polygon fill="black" stroke="black" points="273744.32,-307.36 273733.73,-307.54 273742.12,-314 273744.32,-307.36"/>
</g>
<!-- dp3_pp2_layer10_expert10&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2191" class="edge">
<title>dp3_pp2_layer10_expert10&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M274117.58,-354.22C274098.96,-347.42 274078.35,-340.55 274059,-335.52 273978.99,-314.71 273890.05,-298.33 273810.46,-286"/>
<polygon fill="black" stroke="black" points="273810.71,-282.5 273800.3,-284.44 273809.65,-289.41 273810.71,-282.5"/>
</g>
<!-- dp3_pp2_layer10_expert11&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2192" class="edge">
<title>dp3_pp2_layer10_expert11&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M274361.61,-354.24C274342.51,-347.2 274321.13,-340.19 274301,-335.52 274132.74,-296.53 273937.97,-276.66 273792.55,-266.61"/>
<polygon fill="black" stroke="black" points="273792.38,-263.09 273782.16,-265.9 273791.9,-270.07 273792.38,-263.09"/>
</g>
<!-- dp3_pp2_layer10_expert12&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2193" class="edge">
<title>dp3_pp2_layer10_expert12&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M274604.61,-354.26C274585.28,-347.07 274563.52,-339.99 274543,-335.52 274285.51,-279.49 273981.64,-262.43 273783.99,-257.64"/>
<polygon fill="black" stroke="black" points="273783.86,-254.14 273773.78,-257.4 273783.69,-261.13 273783.86,-254.14"/>
</g>
<!-- dp3_pp2_layer10_expert13&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2194" class="edge">
<title>dp3_pp2_layer10_expert13&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M274847.27,-354.29C274827.79,-347.01 274805.77,-339.87 274785,-335.52 274601.02,-297.05 274084.97,-273.81 273789.63,-263.27"/>
<polygon fill="black" stroke="black" points="273789.33,-259.76 273779.21,-262.9 273789.08,-266.76 273789.33,-259.76"/>
</g>
<!-- dp3_pp2_layer10_expert14&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2195" class="edge">
<title>dp3_pp2_layer10_expert14&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M275089.6,-354.27C275070.05,-346.95 275047.9,-339.78 275027,-335.52 274796.27,-288.58 274130.86,-268.1 273786.74,-260.45"/>
<polygon fill="black" stroke="black" points="273786.73,-256.94 273776.65,-260.22 273786.57,-263.94 273786.73,-256.94"/>
</g>
<!-- dp3_pp2_layer10_expert15&#45;&gt;dp3_pp2_layer10_expert_agg -->
<g id="edge2196" class="edge">
<title>dp3_pp2_layer10_expert15&#45;&gt;dp3_pp2_layer10_expert_agg</title>
<path fill="none" stroke="black" d="M275331.93,-354.29C275312.3,-346.92 275290.03,-339.72 275269,-335.52 274991.21,-280.12 274173.98,-263.37 273785.17,-258.47"/>
<polygon fill="black" stroke="black" points="273784.97,-254.97 273774.93,-258.34 273784.88,-261.97 273784.97,-254.97"/>
</g>
<!-- dp3_pp2_layer11_attn_tp0 -->
<g id="node1337" class="node">
<title>dp3_pp2_layer11_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="271057.5,-531.06 270792.5,-531.06 270792.5,-479.06 271057.5,-479.06 271057.5,-531.06"/>
<text text-anchor="middle" x="270925" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="270925" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="270925" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="270925" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer10_expert_agg&#45;&gt;dp3_pp2_layer11_attn_tp0 -->
<g id="edge2198" class="edge">
<title>dp3_pp2_layer10_expert_agg&#45;&gt;dp3_pp2_layer11_attn_tp0</title>
<path fill="none" stroke="black" d="M273382.78,-260.41C272962.38,-269.54 271972.17,-294.77 271639,-335.52 271606.8,-339.46 271098.23,-444.29 271067,-453.06 271044.37,-459.41 271020.16,-467.58 270998.26,-475.5"/>
<polygon fill="black" stroke="black" points="270996.89,-472.28 270988.7,-479 270999.29,-478.85 270996.89,-472.28"/>
</g>
<!-- dp3_pp2_layer11_attn_allreduce -->
<g id="node1338" class="node">
<title>dp3_pp2_layer11_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="271054" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="271054" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="271054" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="271054" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="271054" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_attn_tp0&#45;&gt;dp3_pp2_layer11_attn_allreduce -->
<g id="edge2199" class="edge">
<title>dp3_pp2_layer11_attn_tp0&#45;&gt;dp3_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M270951.41,-478.92C270968.15,-463 270990.21,-442 271009.58,-423.56"/>
<polygon fill="black" stroke="black" points="271012.03,-426.07 271016.86,-416.64 271007.2,-421 271012.03,-426.07"/>
</g>
<!-- dp3_pp2_layer11_router -->
<g id="node1342" class="node">
<title>dp3_pp2_layer11_router</title>
<polygon fill="lightyellow" stroke="black" points="268805.57,-557.06 268411.74,-557.06 268310.43,-453.06 268704.26,-453.06 268805.57,-557.06"/>
<text text-anchor="middle" x="268558" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="268558" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="268558" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="268558" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_attn_allreduce&#45;&gt;dp3_pp2_layer11_router -->
<g id="edge2235" class="edge">
<title>dp3_pp2_layer11_attn_allreduce&#45;&gt;dp3_pp2_layer11_router</title>
<path fill="none" stroke="black" d="M270894.08,-392.38C270782.77,-399.9 270630.89,-409.76 270497,-417.06 269861.5,-451.72 269108.28,-482.59 268756.96,-496.4"/>
<polygon fill="black" stroke="black" points="268756.8,-492.91 268746.94,-496.79 268757.07,-499.9 268756.8,-492.91"/>
</g>
<!-- dp3_pp2_layer11_attn_tp1 -->
<g id="node1339" class="node">
<title>dp3_pp2_layer11_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="271340.5,-531.06 271075.5,-531.06 271075.5,-479.06 271340.5,-479.06 271340.5,-531.06"/>
<text text-anchor="middle" x="271208" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="271208" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="271208" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="271208" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer11_attn_tp1&#45;&gt;dp3_pp2_layer11_attn_allreduce -->
<g id="edge2200" class="edge">
<title>dp3_pp2_layer11_attn_tp1&#45;&gt;dp3_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M271176.46,-478.92C271155.99,-462.6 271128.83,-440.94 271105.29,-422.18"/>
<polygon fill="black" stroke="black" points="271107.46,-419.44 271097.46,-415.94 271103.1,-424.91 271107.46,-419.44"/>
</g>
<!-- dp3_pp2_layer11_attn_tp2 -->
<g id="node1340" class="node">
<title>dp3_pp2_layer11_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="270774.5,-531.06 270509.5,-531.06 270509.5,-479.06 270774.5,-479.06 270774.5,-531.06"/>
<text text-anchor="middle" x="270642" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="270642" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="270642" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="270642" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer11_attn_tp2&#45;&gt;dp3_pp2_layer11_attn_allreduce -->
<g id="edge2201" class="edge">
<title>dp3_pp2_layer11_attn_tp2&#45;&gt;dp3_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M270708.07,-479.02C270731.85,-470.35 270758.99,-460.86 270784,-453.06 270832.74,-437.86 270887.05,-423.03 270934.1,-410.83"/>
<polygon fill="black" stroke="black" points="270935.22,-414.15 270944.03,-408.26 270933.47,-407.38 270935.22,-414.15"/>
</g>
<!-- dp3_pp2_layer11_attn_tp3 -->
<g id="node1341" class="node">
<title>dp3_pp2_layer11_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="271623.5,-531.06 271358.5,-531.06 271358.5,-479.06 271623.5,-479.06 271623.5,-531.06"/>
<text text-anchor="middle" x="271491" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="271491" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="271491" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="271491" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer11_attn_tp3&#45;&gt;dp3_pp2_layer11_attn_allreduce -->
<g id="edge2202" class="edge">
<title>dp3_pp2_layer11_attn_tp3&#45;&gt;dp3_pp2_layer11_attn_allreduce</title>
<path fill="none" stroke="black" d="M271426.21,-478.95C271402.43,-470.18 271375.17,-460.64 271350,-453.06 271295.42,-436.63 271234.31,-421.31 271181.86,-409.08"/>
<polygon fill="black" stroke="black" points="271182.37,-405.6 271171.83,-406.75 271180.78,-412.42 271182.37,-405.6"/>
</g>
<!-- dp3_pp2_layer11_expert0 -->
<g id="node1343" class="node">
<title>dp3_pp2_layer11_expert0</title>
<polygon fill="lightgreen" stroke="black" points="266855,-406.29 266631,-406.29 266631,-354.29 266855,-354.29 266855,-406.29"/>
<text text-anchor="middle" x="266743" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="266743" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="266743" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="266743" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert0 -->
<g id="edge2203" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268355.73,-499.65C267970.55,-490.26 267145.11,-465.13 266864,-417.06 266851.99,-415.01 266839.48,-412.16 266827.27,-408.95"/>
<polygon fill="black" stroke="black" points="266828.11,-405.56 266817.54,-406.32 266826.28,-412.31 266828.11,-405.56"/>
</g>
<!-- dp3_pp2_layer11_expert1 -->
<g id="node1344" class="node">
<title>dp3_pp2_layer11_expert1</title>
<polygon fill="lightgreen" stroke="black" points="267097,-406.29 266873,-406.29 266873,-354.29 267097,-354.29 267097,-406.29"/>
<text text-anchor="middle" x="266985" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="266985" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="266985" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="266985" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert1 -->
<g id="edge2204" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268353.55,-497.55C268011.94,-485.71 267339.58,-458.03 267106,-417.06 267094.08,-414.97 267081.67,-412.12 267069.54,-408.93"/>
<polygon fill="black" stroke="black" points="267070.45,-405.55 267059.89,-406.3 267068.62,-412.3 267070.45,-405.55"/>
</g>
<!-- dp3_pp2_layer11_expert2 -->
<g id="node1345" class="node">
<title>dp3_pp2_layer11_expert2</title>
<polygon fill="lightgreen" stroke="black" points="267339,-406.29 267115,-406.29 267115,-354.29 267339,-354.29 267339,-406.29"/>
<text text-anchor="middle" x="267227" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="267227" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="267227" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="267227" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert2 -->
<g id="edge2205" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268358.82,-502.85C268117.66,-498.37 267700.02,-480.97 267348,-417.06 267336.38,-414.95 267324.29,-412.14 267312.44,-409.03"/>
<polygon fill="black" stroke="black" points="267313.13,-405.59 267302.56,-406.34 267311.29,-412.34 267313.13,-405.59"/>
</g>
<!-- dp3_pp2_layer11_expert3 -->
<g id="node1346" class="node">
<title>dp3_pp2_layer11_expert3</title>
<polygon fill="lightgreen" stroke="black" points="267581,-406.29 267357,-406.29 267357,-354.29 267581,-354.29 267581,-406.29"/>
<text text-anchor="middle" x="267469" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="267469" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="267469" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="267469" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert3 -->
<g id="edge2206" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268353.36,-497.41C268156.31,-488.25 267850.63,-466.79 267590,-417.06 267578.57,-414.88 267566.67,-412.06 267554.99,-408.97"/>
<polygon fill="black" stroke="black" points="267555.82,-405.57 267545.25,-406.31 267553.98,-412.32 267555.82,-405.57"/>
</g>
<!-- dp3_pp2_layer11_expert4 -->
<g id="node1347" class="node">
<title>dp3_pp2_layer11_expert4</title>
<polygon fill="lightgreen" stroke="black" points="267823,-406.29 267599,-406.29 267599,-354.29 267823,-354.29 267823,-406.29"/>
<text text-anchor="middle" x="267711" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="267711" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="267711" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="267711" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert4 -->
<g id="edge2207" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268344.43,-487.98C268198.99,-474.71 268002.64,-452.25 267832,-417.06 267821.05,-414.8 267809.65,-412.02 267798.43,-409.02"/>
<polygon fill="black" stroke="black" points="267799.19,-405.6 267788.62,-406.33 267797.34,-412.35 267799.19,-405.6"/>
</g>
<!-- dp3_pp2_layer11_expert5 -->
<g id="node1348" class="node">
<title>dp3_pp2_layer11_expert5</title>
<polygon fill="lightgreen" stroke="black" points="268065,-406.29 267841,-406.29 267841,-354.29 268065,-354.29 268065,-406.29"/>
<text text-anchor="middle" x="267953" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="267953" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="267953" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="267953" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert5 -->
<g id="edge2208" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268324.29,-467.38C268244.5,-453.44 268155,-436.25 268074,-417.06 268063.9,-414.67 268053.4,-411.94 268042.99,-409.07"/>
<polygon fill="black" stroke="black" points="268043.62,-405.62 268033.05,-406.3 268041.74,-412.36 268043.62,-405.62"/>
</g>
<!-- dp3_pp2_layer11_expert6 -->
<g id="node1349" class="node">
<title>dp3_pp2_layer11_expert6</title>
<polygon fill="lightgreen" stroke="black" points="268307,-406.29 268083,-406.29 268083,-354.29 268307,-354.29 268307,-406.29"/>
<text text-anchor="middle" x="268195" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="268195" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="268195" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="268195" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert6 -->
<g id="edge2209" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268406.94,-452.97C268363.16,-438.16 268316.94,-422.53 268278.87,-409.66"/>
<polygon fill="black" stroke="black" points="268279.97,-406.33 268269.38,-406.45 268277.73,-412.97 268279.97,-406.33"/>
</g>
<!-- dp3_pp2_layer11_expert7 -->
<g id="node1350" class="node">
<title>dp3_pp2_layer11_expert7</title>
<polygon fill="lightgreen" stroke="black" points="268549,-406.29 268325,-406.29 268325,-354.29 268549,-354.29 268549,-406.29"/>
<text text-anchor="middle" x="268437" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="268437" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="268437" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="268437" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert7 -->
<g id="edge2210" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268507.38,-452.71C268494.3,-439.43 268480.58,-425.51 268468.76,-413.52"/>
<polygon fill="black" stroke="black" points="268471.19,-411 268461.68,-406.33 268466.2,-415.91 268471.19,-411"/>
</g>
<!-- dp3_pp2_layer11_expert8 -->
<g id="node1351" class="node">
<title>dp3_pp2_layer11_expert8</title>
<polygon fill="lightgreen" stroke="black" points="268791,-406.29 268567,-406.29 268567,-354.29 268791,-354.29 268791,-406.29"/>
<text text-anchor="middle" x="268679" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="268679" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="268679" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="268679" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert8 -->
<g id="edge2211" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268608.61,-452.71C268621.7,-439.43 268635.42,-425.51 268647.23,-413.52"/>
<polygon fill="black" stroke="black" points="268649.79,-415.91 268654.32,-406.33 268644.81,-411 268649.79,-415.91"/>
</g>
<!-- dp3_pp2_layer11_expert9 -->
<g id="node1352" class="node">
<title>dp3_pp2_layer11_expert9</title>
<polygon fill="lightgreen" stroke="black" points="269033,-406.29 268809,-406.29 268809,-354.29 269033,-354.29 269033,-406.29"/>
<text text-anchor="middle" x="268921" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="268921" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="268921" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="268921" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert9 -->
<g id="edge2212" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268705.38,-454.21C268750.29,-439.03 268798.08,-422.86 268837.23,-409.62"/>
<polygon fill="black" stroke="black" points="268838.64,-412.84 268846.99,-406.32 268836.4,-406.21 268838.64,-412.84"/>
</g>
<!-- dp3_pp2_layer11_expert10 -->
<g id="node1353" class="node">
<title>dp3_pp2_layer11_expert10</title>
<polygon fill="lightgreen" stroke="black" points="269275,-406.29 269051,-406.29 269051,-354.29 269275,-354.29 269275,-406.29"/>
<text text-anchor="middle" x="269163" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="269163" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="269163" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="269163" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert10 -->
<g id="edge2213" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268728.89,-478.04C268821.98,-462.69 268938.88,-441.49 269042,-417.06 269052.09,-414.67 269062.6,-411.94 269073.01,-409.07"/>
<polygon fill="black" stroke="black" points="269074.26,-412.36 269082.95,-406.3 269072.37,-405.62 269074.26,-412.36"/>
</g>
<!-- dp3_pp2_layer11_expert11 -->
<g id="node1354" class="node">
<title>dp3_pp2_layer11_expert11</title>
<polygon fill="lightgreen" stroke="black" points="269517,-406.29 269293,-406.29 269293,-354.29 269517,-354.29 269517,-406.29"/>
<text text-anchor="middle" x="269405" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="269405" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="269405" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="269405" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert11 -->
<g id="edge2214" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268740.99,-490.7C268888.62,-477.88 269101.08,-454.78 269284,-417.06 269294.95,-414.8 269306.35,-412.02 269317.57,-409.02"/>
<polygon fill="black" stroke="black" points="269318.66,-412.35 269327.38,-406.33 269316.81,-405.6 269318.66,-412.35"/>
</g>
<!-- dp3_pp2_layer11_expert12 -->
<g id="node1355" class="node">
<title>dp3_pp2_layer11_expert12</title>
<polygon fill="lightgreen" stroke="black" points="269759,-406.29 269535,-406.29 269535,-354.29 269759,-354.29 269759,-406.29"/>
<text text-anchor="middle" x="269647" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="269647" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="269647" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="269647" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert12 -->
<g id="edge2215" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268748.27,-498.07C268944.59,-489.29 269258.95,-468.01 269526,-417.06 269537.43,-414.88 269549.33,-412.06 269561.01,-408.97"/>
<polygon fill="black" stroke="black" points="269562.02,-412.32 269570.75,-406.31 269560.18,-405.57 269562.02,-412.32"/>
</g>
<!-- dp3_pp2_layer11_expert13 -->
<g id="node1356" class="node">
<title>dp3_pp2_layer11_expert13</title>
<polygon fill="lightgreen" stroke="black" points="270001,-406.29 269777,-406.29 269777,-354.29 270001,-354.29 270001,-406.29"/>
<text text-anchor="middle" x="269889" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="269889" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="269889" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="269889" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert13 -->
<g id="edge2216" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268752.93,-502.93C268993.42,-498.58 269413.9,-481.35 269768,-417.06 269779.62,-414.95 269791.71,-412.14 269803.56,-409.03"/>
<polygon fill="black" stroke="black" points="269804.7,-412.34 269813.44,-406.34 269802.87,-405.59 269804.7,-412.34"/>
</g>
<!-- dp3_pp2_layer11_expert14 -->
<g id="node1357" class="node">
<title>dp3_pp2_layer11_expert14</title>
<polygon fill="lightgreen" stroke="black" points="270243,-406.29 270019,-406.29 270019,-354.29 270243,-354.29 270243,-406.29"/>
<text text-anchor="middle" x="270131" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="270131" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="270131" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="270131" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert14 -->
<g id="edge2217" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268748.32,-498.04C269085.17,-486.48 269773.15,-458.6 270010,-417.06 270021.92,-414.97 270034.32,-412.12 270046.46,-408.93"/>
<polygon fill="black" stroke="black" points="270047.38,-412.3 270056.11,-406.3 270045.54,-405.55 270047.38,-412.3"/>
</g>
<!-- dp3_pp2_layer11_expert15 -->
<g id="node1358" class="node">
<title>dp3_pp2_layer11_expert15</title>
<polygon fill="lightgreen" stroke="black" points="270485,-406.29 270261,-406.29 270261,-354.29 270485,-354.29 270485,-406.29"/>
<text text-anchor="middle" x="270373" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="270373" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="270373" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="270373" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert15 -->
<g id="edge2218" class="edge">
<title>dp3_pp2_layer11_router&#45;&gt;dp3_pp2_layer11_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M268749.94,-499.9C269130.49,-490.72 269968.35,-465.57 270252,-417.06 270264.01,-415.01 270276.51,-412.16 270288.73,-408.95"/>
<polygon fill="black" stroke="black" points="270289.72,-412.31 270298.45,-406.32 270287.88,-405.56 270289.72,-412.31"/>
</g>
<!-- dp3_pp2_layer11_expert_agg -->
<g id="node1359" class="node">
<title>dp3_pp2_layer11_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="268805.57,-307.52 268411.74,-307.52 268310.43,-203.52 268704.26,-203.52 268805.57,-307.52"/>
<text text-anchor="middle" x="268558" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="268558" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="268558" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="268558" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer11_expert0&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2219" class="edge">
<title>dp3_pp2_layer11_expert0&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M266801.07,-354.29C266820.69,-346.92 266842.97,-339.72 266864,-335.52 267143.13,-279.86 267966.93,-263.21 268353.43,-258.4"/>
<polygon fill="black" stroke="black" points="268353.65,-261.9 268363.61,-258.27 268353.57,-254.9 268353.65,-261.9"/>
</g>
<!-- dp3_pp2_layer11_expert1&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2220" class="edge">
<title>dp3_pp2_layer11_expert1&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M267043.39,-354.27C267062.95,-346.95 267085.09,-339.78 267106,-335.52 267338.8,-288.16 268014.09,-267.74 268355.43,-260.24"/>
<polygon fill="black" stroke="black" points="268355.51,-263.74 268365.43,-260.03 268355.35,-256.74 268355.51,-263.74"/>
</g>
<!-- dp3_pp2_layer11_expert2&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2221" class="edge">
<title>dp3_pp2_layer11_expert2&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M267285.73,-354.29C267305.21,-347.01 267327.23,-339.87 267348,-335.52 267534.91,-296.44 268064.54,-273.07 268357.3,-262.78"/>
<polygon fill="black" stroke="black" points="268357.74,-266.27 268367.61,-262.42 268357.5,-259.27 268357.74,-266.27"/>
</g>
<!-- dp3_pp2_layer11_expert3&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2222" class="edge">
<title>dp3_pp2_layer11_expert3&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M267528.39,-354.26C267547.72,-347.07 267569.48,-339.99 267590,-335.52 267848.91,-279.18 268154.7,-262.24 268352.26,-257.56"/>
<polygon fill="black" stroke="black" points="268352.55,-261.06 268362.47,-257.33 268352.39,-254.06 268352.55,-261.06"/>
</g>
<!-- dp3_pp2_layer11_expert4&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2223" class="edge">
<title>dp3_pp2_layer11_expert4&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M267771.39,-354.24C267790.49,-347.2 267811.87,-340.19 267832,-335.52 268007.82,-294.77 268212.6,-274.91 268359.75,-265.31"/>
<polygon fill="black" stroke="black" points="268360.05,-268.8 268369.81,-264.67 268359.6,-261.82 268360.05,-268.8"/>
</g>
<!-- dp3_pp2_layer11_expert5&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2224" class="edge">
<title>dp3_pp2_layer11_expert5&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M268015.42,-354.22C268034.04,-347.42 268054.65,-340.55 268074,-335.52 268171.09,-310.27 268281.34,-291.53 268372.07,-278.65"/>
<polygon fill="black" stroke="black" points="268372.78,-282.09 268382.19,-277.23 268371.8,-275.16 268372.78,-282.09"/>
</g>
<!-- dp3_pp2_layer11_expert6&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2225" class="edge">
<title>dp3_pp2_layer11_expert6&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M268263.02,-354.26C268280.26,-348.03 268298.78,-341.44 268316,-335.52 268342.73,-326.33 268371.21,-316.8 268398.89,-307.67"/>
<polygon fill="black" stroke="black" points="268400.24,-310.91 268408.65,-304.46 268398.06,-304.26 268400.24,-310.91"/>
</g>
<!-- dp3_pp2_layer11_expert7&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2226" class="edge">
<title>dp3_pp2_layer11_expert7&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M268461.78,-354.15C268473.02,-342.74 268486.83,-328.73 268500.45,-314.92"/>
<polygon fill="black" stroke="black" points="268503,-317.31 268507.53,-307.73 268498.02,-312.39 268503,-317.31"/>
</g>
<!-- dp3_pp2_layer11_expert8&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2227" class="edge">
<title>dp3_pp2_layer11_expert8&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M268654.22,-354.15C268642.97,-342.74 268629.16,-328.73 268615.55,-314.92"/>
<polygon fill="black" stroke="black" points="268617.98,-312.39 268608.47,-307.73 268612.99,-317.31 268617.98,-312.39"/>
</g>
<!-- dp3_pp2_layer11_expert9&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2228" class="edge">
<title>dp3_pp2_layer11_expert9&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M268852.98,-354.26C268835.73,-348.03 268817.21,-341.44 268800,-335.52 268776.29,-327.37 268751.21,-318.95 268726.53,-310.78"/>
<polygon fill="black" stroke="black" points="268727.32,-307.36 268716.73,-307.54 268725.12,-314 268727.32,-307.36"/>
</g>
<!-- dp3_pp2_layer11_expert10&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2229" class="edge">
<title>dp3_pp2_layer11_expert10&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M269100.58,-354.22C269081.96,-347.42 269061.35,-340.55 269042,-335.52 268961.99,-314.71 268873.05,-298.33 268793.46,-286"/>
<polygon fill="black" stroke="black" points="268793.71,-282.5 268783.3,-284.44 268792.65,-289.41 268793.71,-282.5"/>
</g>
<!-- dp3_pp2_layer11_expert11&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2230" class="edge">
<title>dp3_pp2_layer11_expert11&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M269344.61,-354.24C269325.51,-347.2 269304.13,-340.19 269284,-335.52 269115.74,-296.53 268920.97,-276.66 268775.55,-266.61"/>
<polygon fill="black" stroke="black" points="268775.38,-263.09 268765.16,-265.9 268774.9,-270.07 268775.38,-263.09"/>
</g>
<!-- dp3_pp2_layer11_expert12&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2231" class="edge">
<title>dp3_pp2_layer11_expert12&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M269587.61,-354.26C269568.28,-347.07 269546.52,-339.99 269526,-335.52 269268.51,-279.49 268964.64,-262.43 268766.99,-257.64"/>
<polygon fill="black" stroke="black" points="268766.86,-254.14 268756.78,-257.4 268766.69,-261.13 268766.86,-254.14"/>
</g>
<!-- dp3_pp2_layer11_expert13&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2232" class="edge">
<title>dp3_pp2_layer11_expert13&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M269830.27,-354.29C269810.79,-347.01 269788.77,-339.87 269768,-335.52 269584.02,-297.05 269067.97,-273.81 268772.63,-263.27"/>
<polygon fill="black" stroke="black" points="268772.33,-259.76 268762.21,-262.9 268772.08,-266.76 268772.33,-259.76"/>
</g>
<!-- dp3_pp2_layer11_expert14&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2233" class="edge">
<title>dp3_pp2_layer11_expert14&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M270072.6,-354.27C270053.05,-346.95 270030.9,-339.78 270010,-335.52 269779.27,-288.58 269113.86,-268.1 268769.74,-260.45"/>
<polygon fill="black" stroke="black" points="268769.73,-256.94 268759.65,-260.22 268769.57,-263.94 268769.73,-256.94"/>
</g>
<!-- dp3_pp2_layer11_expert15&#45;&gt;dp3_pp2_layer11_expert_agg -->
<g id="edge2234" class="edge">
<title>dp3_pp2_layer11_expert15&#45;&gt;dp3_pp2_layer11_expert_agg</title>
<path fill="none" stroke="black" d="M270314.93,-354.29C270295.3,-346.92 270273.03,-339.72 270252,-335.52 269974.21,-280.12 269156.98,-263.37 268768.17,-258.47"/>
<polygon fill="black" stroke="black" points="268767.97,-254.97 268757.93,-258.34 268767.88,-261.97 268767.97,-254.97"/>
</g>
<!-- dp3_pp2_layer12_attn_tp0 -->
<g id="node1360" class="node">
<title>dp3_pp2_layer12_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="266040.5,-531.06 265775.5,-531.06 265775.5,-479.06 266040.5,-479.06 266040.5,-531.06"/>
<text text-anchor="middle" x="265908" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="265908" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="265908" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="265908" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer11_expert_agg&#45;&gt;dp3_pp2_layer12_attn_tp0 -->
<g id="edge2236" class="edge">
<title>dp3_pp2_layer11_expert_agg&#45;&gt;dp3_pp2_layer12_attn_tp0</title>
<path fill="none" stroke="black" d="M268365.78,-260.41C267945.38,-269.54 266955.17,-294.77 266622,-335.52 266589.8,-339.46 266081.23,-444.29 266050,-453.06 266027.37,-459.41 266003.16,-467.58 265981.26,-475.5"/>
<polygon fill="black" stroke="black" points="265979.89,-472.28 265971.7,-479 265982.29,-478.85 265979.89,-472.28"/>
</g>
<!-- dp3_pp2_layer12_attn_allreduce -->
<g id="node1361" class="node">
<title>dp3_pp2_layer12_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="266037" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="266037" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="266037" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="266037" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="266037" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_attn_tp0&#45;&gt;dp3_pp2_layer12_attn_allreduce -->
<g id="edge2237" class="edge">
<title>dp3_pp2_layer12_attn_tp0&#45;&gt;dp3_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M265934.41,-478.92C265951.15,-463 265973.21,-442 265992.58,-423.56"/>
<polygon fill="black" stroke="black" points="265995.03,-426.07 265999.86,-416.64 265990.2,-421 265995.03,-426.07"/>
</g>
<!-- dp3_pp2_layer12_router -->
<g id="node1365" class="node">
<title>dp3_pp2_layer12_router</title>
<polygon fill="lightyellow" stroke="black" points="263788.57,-557.06 263394.74,-557.06 263293.43,-453.06 263687.26,-453.06 263788.57,-557.06"/>
<text text-anchor="middle" x="263541" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="263541" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="263541" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="263541" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_attn_allreduce&#45;&gt;dp3_pp2_layer12_router -->
<g id="edge2273" class="edge">
<title>dp3_pp2_layer12_attn_allreduce&#45;&gt;dp3_pp2_layer12_router</title>
<path fill="none" stroke="black" d="M265877.08,-392.38C265765.77,-399.9 265613.89,-409.76 265480,-417.06 264844.5,-451.72 264091.28,-482.59 263739.96,-496.4"/>
<polygon fill="black" stroke="black" points="263739.8,-492.91 263729.94,-496.79 263740.07,-499.9 263739.8,-492.91"/>
</g>
<!-- dp3_pp2_layer12_attn_tp1 -->
<g id="node1362" class="node">
<title>dp3_pp2_layer12_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="266323.5,-531.06 266058.5,-531.06 266058.5,-479.06 266323.5,-479.06 266323.5,-531.06"/>
<text text-anchor="middle" x="266191" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="266191" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="266191" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="266191" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer12_attn_tp1&#45;&gt;dp3_pp2_layer12_attn_allreduce -->
<g id="edge2238" class="edge">
<title>dp3_pp2_layer12_attn_tp1&#45;&gt;dp3_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M266159.46,-478.92C266138.99,-462.6 266111.83,-440.94 266088.29,-422.18"/>
<polygon fill="black" stroke="black" points="266090.46,-419.44 266080.46,-415.94 266086.1,-424.91 266090.46,-419.44"/>
</g>
<!-- dp3_pp2_layer12_attn_tp2 -->
<g id="node1363" class="node">
<title>dp3_pp2_layer12_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="265757.5,-531.06 265492.5,-531.06 265492.5,-479.06 265757.5,-479.06 265757.5,-531.06"/>
<text text-anchor="middle" x="265625" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="265625" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="265625" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="265625" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer12_attn_tp2&#45;&gt;dp3_pp2_layer12_attn_allreduce -->
<g id="edge2239" class="edge">
<title>dp3_pp2_layer12_attn_tp2&#45;&gt;dp3_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M265691.07,-479.02C265714.85,-470.35 265741.99,-460.86 265767,-453.06 265815.74,-437.86 265870.05,-423.03 265917.1,-410.83"/>
<polygon fill="black" stroke="black" points="265918.22,-414.15 265927.03,-408.26 265916.47,-407.38 265918.22,-414.15"/>
</g>
<!-- dp3_pp2_layer12_attn_tp3 -->
<g id="node1364" class="node">
<title>dp3_pp2_layer12_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="266606.5,-531.06 266341.5,-531.06 266341.5,-479.06 266606.5,-479.06 266606.5,-531.06"/>
<text text-anchor="middle" x="266474" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="266474" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="266474" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="266474" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer12_attn_tp3&#45;&gt;dp3_pp2_layer12_attn_allreduce -->
<g id="edge2240" class="edge">
<title>dp3_pp2_layer12_attn_tp3&#45;&gt;dp3_pp2_layer12_attn_allreduce</title>
<path fill="none" stroke="black" d="M266409.21,-478.95C266385.43,-470.18 266358.17,-460.64 266333,-453.06 266278.42,-436.63 266217.31,-421.31 266164.86,-409.08"/>
<polygon fill="black" stroke="black" points="266165.37,-405.6 266154.83,-406.75 266163.78,-412.42 266165.37,-405.6"/>
</g>
<!-- dp3_pp2_layer12_expert0 -->
<g id="node1366" class="node">
<title>dp3_pp2_layer12_expert0</title>
<polygon fill="lightgreen" stroke="black" points="261838,-406.29 261614,-406.29 261614,-354.29 261838,-354.29 261838,-406.29"/>
<text text-anchor="middle" x="261726" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="261726" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="261726" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="261726" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert0 -->
<g id="edge2241" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263338.73,-499.65C262953.55,-490.26 262128.11,-465.13 261847,-417.06 261834.99,-415.01 261822.48,-412.16 261810.27,-408.95"/>
<polygon fill="black" stroke="black" points="261811.11,-405.56 261800.54,-406.32 261809.28,-412.31 261811.11,-405.56"/>
</g>
<!-- dp3_pp2_layer12_expert1 -->
<g id="node1367" class="node">
<title>dp3_pp2_layer12_expert1</title>
<polygon fill="lightgreen" stroke="black" points="262080,-406.29 261856,-406.29 261856,-354.29 262080,-354.29 262080,-406.29"/>
<text text-anchor="middle" x="261968" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="261968" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="261968" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="261968" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert1 -->
<g id="edge2242" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263336.55,-497.55C262994.94,-485.71 262322.58,-458.03 262089,-417.06 262077.08,-414.97 262064.67,-412.12 262052.54,-408.93"/>
<polygon fill="black" stroke="black" points="262053.45,-405.55 262042.89,-406.3 262051.62,-412.3 262053.45,-405.55"/>
</g>
<!-- dp3_pp2_layer12_expert2 -->
<g id="node1368" class="node">
<title>dp3_pp2_layer12_expert2</title>
<polygon fill="lightgreen" stroke="black" points="262322,-406.29 262098,-406.29 262098,-354.29 262322,-354.29 262322,-406.29"/>
<text text-anchor="middle" x="262210" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="262210" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="262210" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="262210" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert2 -->
<g id="edge2243" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263341.82,-502.85C263100.66,-498.37 262683.02,-480.97 262331,-417.06 262319.38,-414.95 262307.29,-412.14 262295.44,-409.03"/>
<polygon fill="black" stroke="black" points="262296.13,-405.59 262285.56,-406.34 262294.29,-412.34 262296.13,-405.59"/>
</g>
<!-- dp3_pp2_layer12_expert3 -->
<g id="node1369" class="node">
<title>dp3_pp2_layer12_expert3</title>
<polygon fill="lightgreen" stroke="black" points="262564,-406.29 262340,-406.29 262340,-354.29 262564,-354.29 262564,-406.29"/>
<text text-anchor="middle" x="262452" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="262452" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="262452" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="262452" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert3 -->
<g id="edge2244" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263336.36,-497.41C263139.31,-488.25 262833.63,-466.79 262573,-417.06 262561.57,-414.88 262549.67,-412.06 262537.99,-408.97"/>
<polygon fill="black" stroke="black" points="262538.82,-405.57 262528.25,-406.31 262536.98,-412.32 262538.82,-405.57"/>
</g>
<!-- dp3_pp2_layer12_expert4 -->
<g id="node1370" class="node">
<title>dp3_pp2_layer12_expert4</title>
<polygon fill="lightgreen" stroke="black" points="262806,-406.29 262582,-406.29 262582,-354.29 262806,-354.29 262806,-406.29"/>
<text text-anchor="middle" x="262694" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="262694" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="262694" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="262694" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert4 -->
<g id="edge2245" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263327.43,-487.98C263181.99,-474.71 262985.64,-452.25 262815,-417.06 262804.05,-414.8 262792.65,-412.02 262781.43,-409.02"/>
<polygon fill="black" stroke="black" points="262782.19,-405.6 262771.62,-406.33 262780.34,-412.35 262782.19,-405.6"/>
</g>
<!-- dp3_pp2_layer12_expert5 -->
<g id="node1371" class="node">
<title>dp3_pp2_layer12_expert5</title>
<polygon fill="lightgreen" stroke="black" points="263048,-406.29 262824,-406.29 262824,-354.29 263048,-354.29 263048,-406.29"/>
<text text-anchor="middle" x="262936" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="262936" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="262936" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="262936" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert5 -->
<g id="edge2246" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263307.29,-467.38C263227.5,-453.44 263138,-436.25 263057,-417.06 263046.9,-414.67 263036.4,-411.94 263025.99,-409.07"/>
<polygon fill="black" stroke="black" points="263026.62,-405.62 263016.05,-406.3 263024.74,-412.36 263026.62,-405.62"/>
</g>
<!-- dp3_pp2_layer12_expert6 -->
<g id="node1372" class="node">
<title>dp3_pp2_layer12_expert6</title>
<polygon fill="lightgreen" stroke="black" points="263290,-406.29 263066,-406.29 263066,-354.29 263290,-354.29 263290,-406.29"/>
<text text-anchor="middle" x="263178" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="263178" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="263178" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="263178" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert6 -->
<g id="edge2247" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263389.94,-452.97C263346.16,-438.16 263299.94,-422.53 263261.87,-409.66"/>
<polygon fill="black" stroke="black" points="263262.97,-406.33 263252.38,-406.45 263260.73,-412.97 263262.97,-406.33"/>
</g>
<!-- dp3_pp2_layer12_expert7 -->
<g id="node1373" class="node">
<title>dp3_pp2_layer12_expert7</title>
<polygon fill="lightgreen" stroke="black" points="263532,-406.29 263308,-406.29 263308,-354.29 263532,-354.29 263532,-406.29"/>
<text text-anchor="middle" x="263420" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="263420" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="263420" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="263420" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert7 -->
<g id="edge2248" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263490.38,-452.71C263477.3,-439.43 263463.58,-425.51 263451.76,-413.52"/>
<polygon fill="black" stroke="black" points="263454.19,-411 263444.68,-406.33 263449.2,-415.91 263454.19,-411"/>
</g>
<!-- dp3_pp2_layer12_expert8 -->
<g id="node1374" class="node">
<title>dp3_pp2_layer12_expert8</title>
<polygon fill="lightgreen" stroke="black" points="263774,-406.29 263550,-406.29 263550,-354.29 263774,-354.29 263774,-406.29"/>
<text text-anchor="middle" x="263662" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="263662" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="263662" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="263662" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert8 -->
<g id="edge2249" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263591.61,-452.71C263604.7,-439.43 263618.42,-425.51 263630.23,-413.52"/>
<polygon fill="black" stroke="black" points="263632.79,-415.91 263637.32,-406.33 263627.81,-411 263632.79,-415.91"/>
</g>
<!-- dp3_pp2_layer12_expert9 -->
<g id="node1375" class="node">
<title>dp3_pp2_layer12_expert9</title>
<polygon fill="lightgreen" stroke="black" points="264016,-406.29 263792,-406.29 263792,-354.29 264016,-354.29 264016,-406.29"/>
<text text-anchor="middle" x="263904" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="263904" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="263904" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="263904" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert9 -->
<g id="edge2250" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263688.38,-454.21C263733.29,-439.03 263781.08,-422.86 263820.23,-409.62"/>
<polygon fill="black" stroke="black" points="263821.64,-412.84 263829.99,-406.32 263819.4,-406.21 263821.64,-412.84"/>
</g>
<!-- dp3_pp2_layer12_expert10 -->
<g id="node1376" class="node">
<title>dp3_pp2_layer12_expert10</title>
<polygon fill="lightgreen" stroke="black" points="264258,-406.29 264034,-406.29 264034,-354.29 264258,-354.29 264258,-406.29"/>
<text text-anchor="middle" x="264146" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="264146" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="264146" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="264146" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert10 -->
<g id="edge2251" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263711.89,-478.04C263804.98,-462.69 263921.88,-441.49 264025,-417.06 264035.09,-414.67 264045.6,-411.94 264056.01,-409.07"/>
<polygon fill="black" stroke="black" points="264057.26,-412.36 264065.95,-406.3 264055.37,-405.62 264057.26,-412.36"/>
</g>
<!-- dp3_pp2_layer12_expert11 -->
<g id="node1377" class="node">
<title>dp3_pp2_layer12_expert11</title>
<polygon fill="lightgreen" stroke="black" points="264500,-406.29 264276,-406.29 264276,-354.29 264500,-354.29 264500,-406.29"/>
<text text-anchor="middle" x="264388" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="264388" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="264388" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="264388" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert11 -->
<g id="edge2252" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263723.99,-490.7C263871.62,-477.88 264084.08,-454.78 264267,-417.06 264277.95,-414.8 264289.35,-412.02 264300.57,-409.02"/>
<polygon fill="black" stroke="black" points="264301.66,-412.35 264310.38,-406.33 264299.81,-405.6 264301.66,-412.35"/>
</g>
<!-- dp3_pp2_layer12_expert12 -->
<g id="node1378" class="node">
<title>dp3_pp2_layer12_expert12</title>
<polygon fill="lightgreen" stroke="black" points="264742,-406.29 264518,-406.29 264518,-354.29 264742,-354.29 264742,-406.29"/>
<text text-anchor="middle" x="264630" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="264630" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="264630" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="264630" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert12 -->
<g id="edge2253" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263731.27,-498.07C263927.59,-489.29 264241.95,-468.01 264509,-417.06 264520.43,-414.88 264532.33,-412.06 264544.01,-408.97"/>
<polygon fill="black" stroke="black" points="264545.02,-412.32 264553.75,-406.31 264543.18,-405.57 264545.02,-412.32"/>
</g>
<!-- dp3_pp2_layer12_expert13 -->
<g id="node1379" class="node">
<title>dp3_pp2_layer12_expert13</title>
<polygon fill="lightgreen" stroke="black" points="264984,-406.29 264760,-406.29 264760,-354.29 264984,-354.29 264984,-406.29"/>
<text text-anchor="middle" x="264872" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="264872" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="264872" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="264872" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert13 -->
<g id="edge2254" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263735.93,-502.93C263976.42,-498.58 264396.9,-481.35 264751,-417.06 264762.62,-414.95 264774.71,-412.14 264786.56,-409.03"/>
<polygon fill="black" stroke="black" points="264787.7,-412.34 264796.44,-406.34 264785.87,-405.59 264787.7,-412.34"/>
</g>
<!-- dp3_pp2_layer12_expert14 -->
<g id="node1380" class="node">
<title>dp3_pp2_layer12_expert14</title>
<polygon fill="lightgreen" stroke="black" points="265226,-406.29 265002,-406.29 265002,-354.29 265226,-354.29 265226,-406.29"/>
<text text-anchor="middle" x="265114" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="265114" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="265114" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="265114" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert14 -->
<g id="edge2255" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263731.32,-498.04C264068.17,-486.48 264756.15,-458.6 264993,-417.06 265004.92,-414.97 265017.32,-412.12 265029.46,-408.93"/>
<polygon fill="black" stroke="black" points="265030.38,-412.3 265039.11,-406.3 265028.54,-405.55 265030.38,-412.3"/>
</g>
<!-- dp3_pp2_layer12_expert15 -->
<g id="node1381" class="node">
<title>dp3_pp2_layer12_expert15</title>
<polygon fill="lightgreen" stroke="black" points="265468,-406.29 265244,-406.29 265244,-354.29 265468,-354.29 265468,-406.29"/>
<text text-anchor="middle" x="265356" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="265356" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="265356" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="265356" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert15 -->
<g id="edge2256" class="edge">
<title>dp3_pp2_layer12_router&#45;&gt;dp3_pp2_layer12_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M263732.94,-499.9C264113.49,-490.72 264951.35,-465.57 265235,-417.06 265247.01,-415.01 265259.51,-412.16 265271.73,-408.95"/>
<polygon fill="black" stroke="black" points="265272.72,-412.31 265281.45,-406.32 265270.88,-405.56 265272.72,-412.31"/>
</g>
<!-- dp3_pp2_layer12_expert_agg -->
<g id="node1382" class="node">
<title>dp3_pp2_layer12_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="263788.57,-307.52 263394.74,-307.52 263293.43,-203.52 263687.26,-203.52 263788.57,-307.52"/>
<text text-anchor="middle" x="263541" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="263541" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="263541" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="263541" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer12_expert0&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2257" class="edge">
<title>dp3_pp2_layer12_expert0&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M261784.07,-354.29C261803.69,-346.92 261825.97,-339.72 261847,-335.52 262126.13,-279.86 262949.93,-263.21 263336.43,-258.4"/>
<polygon fill="black" stroke="black" points="263336.65,-261.9 263346.61,-258.27 263336.57,-254.9 263336.65,-261.9"/>
</g>
<!-- dp3_pp2_layer12_expert1&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2258" class="edge">
<title>dp3_pp2_layer12_expert1&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M262026.39,-354.27C262045.95,-346.95 262068.09,-339.78 262089,-335.52 262321.8,-288.16 262997.09,-267.74 263338.43,-260.24"/>
<polygon fill="black" stroke="black" points="263338.51,-263.74 263348.43,-260.03 263338.35,-256.74 263338.51,-263.74"/>
</g>
<!-- dp3_pp2_layer12_expert2&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2259" class="edge">
<title>dp3_pp2_layer12_expert2&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M262268.73,-354.29C262288.21,-347.01 262310.23,-339.87 262331,-335.52 262517.91,-296.44 263047.54,-273.07 263340.3,-262.78"/>
<polygon fill="black" stroke="black" points="263340.74,-266.27 263350.61,-262.42 263340.5,-259.27 263340.74,-266.27"/>
</g>
<!-- dp3_pp2_layer12_expert3&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2260" class="edge">
<title>dp3_pp2_layer12_expert3&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M262511.39,-354.26C262530.72,-347.07 262552.48,-339.99 262573,-335.52 262831.91,-279.18 263137.7,-262.24 263335.26,-257.56"/>
<polygon fill="black" stroke="black" points="263335.55,-261.06 263345.47,-257.33 263335.39,-254.06 263335.55,-261.06"/>
</g>
<!-- dp3_pp2_layer12_expert4&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2261" class="edge">
<title>dp3_pp2_layer12_expert4&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M262754.39,-354.24C262773.49,-347.2 262794.87,-340.19 262815,-335.52 262990.82,-294.77 263195.6,-274.91 263342.75,-265.31"/>
<polygon fill="black" stroke="black" points="263343.05,-268.8 263352.81,-264.67 263342.6,-261.82 263343.05,-268.8"/>
</g>
<!-- dp3_pp2_layer12_expert5&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2262" class="edge">
<title>dp3_pp2_layer12_expert5&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M262998.42,-354.22C263017.04,-347.42 263037.65,-340.55 263057,-335.52 263154.09,-310.27 263264.34,-291.53 263355.07,-278.65"/>
<polygon fill="black" stroke="black" points="263355.78,-282.09 263365.19,-277.23 263354.8,-275.16 263355.78,-282.09"/>
</g>
<!-- dp3_pp2_layer12_expert6&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2263" class="edge">
<title>dp3_pp2_layer12_expert6&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M263246.02,-354.26C263263.26,-348.03 263281.78,-341.44 263299,-335.52 263325.73,-326.33 263354.21,-316.8 263381.89,-307.67"/>
<polygon fill="black" stroke="black" points="263383.24,-310.91 263391.65,-304.46 263381.06,-304.26 263383.24,-310.91"/>
</g>
<!-- dp3_pp2_layer12_expert7&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2264" class="edge">
<title>dp3_pp2_layer12_expert7&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M263444.78,-354.15C263456.02,-342.74 263469.83,-328.73 263483.45,-314.92"/>
<polygon fill="black" stroke="black" points="263486,-317.31 263490.53,-307.73 263481.02,-312.39 263486,-317.31"/>
</g>
<!-- dp3_pp2_layer12_expert8&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2265" class="edge">
<title>dp3_pp2_layer12_expert8&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M263637.22,-354.15C263625.97,-342.74 263612.16,-328.73 263598.55,-314.92"/>
<polygon fill="black" stroke="black" points="263600.98,-312.39 263591.47,-307.73 263595.99,-317.31 263600.98,-312.39"/>
</g>
<!-- dp3_pp2_layer12_expert9&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2266" class="edge">
<title>dp3_pp2_layer12_expert9&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M263835.98,-354.26C263818.73,-348.03 263800.21,-341.44 263783,-335.52 263759.29,-327.37 263734.21,-318.95 263709.53,-310.78"/>
<polygon fill="black" stroke="black" points="263710.32,-307.36 263699.73,-307.54 263708.12,-314 263710.32,-307.36"/>
</g>
<!-- dp3_pp2_layer12_expert10&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2267" class="edge">
<title>dp3_pp2_layer12_expert10&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M264083.58,-354.22C264064.96,-347.42 264044.35,-340.55 264025,-335.52 263944.99,-314.71 263856.05,-298.33 263776.46,-286"/>
<polygon fill="black" stroke="black" points="263776.71,-282.5 263766.3,-284.44 263775.65,-289.41 263776.71,-282.5"/>
</g>
<!-- dp3_pp2_layer12_expert11&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2268" class="edge">
<title>dp3_pp2_layer12_expert11&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M264327.61,-354.24C264308.51,-347.2 264287.13,-340.19 264267,-335.52 264098.74,-296.53 263903.97,-276.66 263758.55,-266.61"/>
<polygon fill="black" stroke="black" points="263758.38,-263.09 263748.16,-265.9 263757.9,-270.07 263758.38,-263.09"/>
</g>
<!-- dp3_pp2_layer12_expert12&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2269" class="edge">
<title>dp3_pp2_layer12_expert12&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M264570.61,-354.26C264551.28,-347.07 264529.52,-339.99 264509,-335.52 264251.51,-279.49 263947.64,-262.43 263749.99,-257.64"/>
<polygon fill="black" stroke="black" points="263749.86,-254.14 263739.78,-257.4 263749.69,-261.13 263749.86,-254.14"/>
</g>
<!-- dp3_pp2_layer12_expert13&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2270" class="edge">
<title>dp3_pp2_layer12_expert13&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M264813.27,-354.29C264793.79,-347.01 264771.77,-339.87 264751,-335.52 264567.02,-297.05 264050.97,-273.81 263755.63,-263.27"/>
<polygon fill="black" stroke="black" points="263755.33,-259.76 263745.21,-262.9 263755.08,-266.76 263755.33,-259.76"/>
</g>
<!-- dp3_pp2_layer12_expert14&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2271" class="edge">
<title>dp3_pp2_layer12_expert14&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M265055.6,-354.27C265036.05,-346.95 265013.9,-339.78 264993,-335.52 264762.27,-288.58 264096.86,-268.1 263752.74,-260.45"/>
<polygon fill="black" stroke="black" points="263752.73,-256.94 263742.65,-260.22 263752.57,-263.94 263752.73,-256.94"/>
</g>
<!-- dp3_pp2_layer12_expert15&#45;&gt;dp3_pp2_layer12_expert_agg -->
<g id="edge2272" class="edge">
<title>dp3_pp2_layer12_expert15&#45;&gt;dp3_pp2_layer12_expert_agg</title>
<path fill="none" stroke="black" d="M265297.93,-354.29C265278.3,-346.92 265256.03,-339.72 265235,-335.52 264957.21,-280.12 264139.98,-263.37 263751.17,-258.47"/>
<polygon fill="black" stroke="black" points="263750.97,-254.97 263740.93,-258.34 263750.88,-261.97 263750.97,-254.97"/>
</g>
<!-- dp3_pp2_layer13_attn_tp0 -->
<g id="node1383" class="node">
<title>dp3_pp2_layer13_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="261023.5,-531.06 260758.5,-531.06 260758.5,-479.06 261023.5,-479.06 261023.5,-531.06"/>
<text text-anchor="middle" x="260891" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="260891" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="260891" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="260891" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer12_expert_agg&#45;&gt;dp3_pp2_layer13_attn_tp0 -->
<g id="edge2274" class="edge">
<title>dp3_pp2_layer12_expert_agg&#45;&gt;dp3_pp2_layer13_attn_tp0</title>
<path fill="none" stroke="black" d="M263348.78,-260.41C262928.38,-269.54 261938.17,-294.77 261605,-335.52 261572.8,-339.46 261064.23,-444.29 261033,-453.06 261010.37,-459.41 260986.16,-467.58 260964.26,-475.5"/>
<polygon fill="black" stroke="black" points="260962.89,-472.28 260954.7,-479 260965.29,-478.85 260962.89,-472.28"/>
</g>
<!-- dp3_pp2_layer13_attn_allreduce -->
<g id="node1384" class="node">
<title>dp3_pp2_layer13_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="261020" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="261020" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="261020" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="261020" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="261020" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_attn_tp0&#45;&gt;dp3_pp2_layer13_attn_allreduce -->
<g id="edge2275" class="edge">
<title>dp3_pp2_layer13_attn_tp0&#45;&gt;dp3_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M260917.41,-478.92C260934.15,-463 260956.21,-442 260975.58,-423.56"/>
<polygon fill="black" stroke="black" points="260978.03,-426.07 260982.86,-416.64 260973.2,-421 260978.03,-426.07"/>
</g>
<!-- dp3_pp2_layer13_router -->
<g id="node1388" class="node">
<title>dp3_pp2_layer13_router</title>
<polygon fill="lightyellow" stroke="black" points="258771.57,-557.06 258377.74,-557.06 258276.43,-453.06 258670.26,-453.06 258771.57,-557.06"/>
<text text-anchor="middle" x="258524" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="258524" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="258524" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="258524" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_attn_allreduce&#45;&gt;dp3_pp2_layer13_router -->
<g id="edge2311" class="edge">
<title>dp3_pp2_layer13_attn_allreduce&#45;&gt;dp3_pp2_layer13_router</title>
<path fill="none" stroke="black" d="M260860.08,-392.38C260748.77,-399.9 260596.89,-409.76 260463,-417.06 259827.5,-451.72 259074.28,-482.59 258722.96,-496.4"/>
<polygon fill="black" stroke="black" points="258722.8,-492.91 258712.94,-496.79 258723.07,-499.9 258722.8,-492.91"/>
</g>
<!-- dp3_pp2_layer13_attn_tp1 -->
<g id="node1385" class="node">
<title>dp3_pp2_layer13_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="261306.5,-531.06 261041.5,-531.06 261041.5,-479.06 261306.5,-479.06 261306.5,-531.06"/>
<text text-anchor="middle" x="261174" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="261174" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="261174" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="261174" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer13_attn_tp1&#45;&gt;dp3_pp2_layer13_attn_allreduce -->
<g id="edge2276" class="edge">
<title>dp3_pp2_layer13_attn_tp1&#45;&gt;dp3_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M261142.46,-478.92C261121.99,-462.6 261094.83,-440.94 261071.29,-422.18"/>
<polygon fill="black" stroke="black" points="261073.46,-419.44 261063.46,-415.94 261069.1,-424.91 261073.46,-419.44"/>
</g>
<!-- dp3_pp2_layer13_attn_tp2 -->
<g id="node1386" class="node">
<title>dp3_pp2_layer13_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="260740.5,-531.06 260475.5,-531.06 260475.5,-479.06 260740.5,-479.06 260740.5,-531.06"/>
<text text-anchor="middle" x="260608" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="260608" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="260608" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="260608" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer13_attn_tp2&#45;&gt;dp3_pp2_layer13_attn_allreduce -->
<g id="edge2277" class="edge">
<title>dp3_pp2_layer13_attn_tp2&#45;&gt;dp3_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M260674.07,-479.02C260697.85,-470.35 260724.99,-460.86 260750,-453.06 260798.74,-437.86 260853.05,-423.03 260900.1,-410.83"/>
<polygon fill="black" stroke="black" points="260901.22,-414.15 260910.03,-408.26 260899.47,-407.38 260901.22,-414.15"/>
</g>
<!-- dp3_pp2_layer13_attn_tp3 -->
<g id="node1387" class="node">
<title>dp3_pp2_layer13_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="261589.5,-531.06 261324.5,-531.06 261324.5,-479.06 261589.5,-479.06 261589.5,-531.06"/>
<text text-anchor="middle" x="261457" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="261457" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="261457" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="261457" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer13_attn_tp3&#45;&gt;dp3_pp2_layer13_attn_allreduce -->
<g id="edge2278" class="edge">
<title>dp3_pp2_layer13_attn_tp3&#45;&gt;dp3_pp2_layer13_attn_allreduce</title>
<path fill="none" stroke="black" d="M261392.21,-478.95C261368.43,-470.18 261341.17,-460.64 261316,-453.06 261261.42,-436.63 261200.31,-421.31 261147.86,-409.08"/>
<polygon fill="black" stroke="black" points="261148.37,-405.6 261137.83,-406.75 261146.78,-412.42 261148.37,-405.6"/>
</g>
<!-- dp3_pp2_layer13_expert0 -->
<g id="node1389" class="node">
<title>dp3_pp2_layer13_expert0</title>
<polygon fill="lightgreen" stroke="black" points="256821,-406.29 256597,-406.29 256597,-354.29 256821,-354.29 256821,-406.29"/>
<text text-anchor="middle" x="256709" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="256709" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="256709" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="256709" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert0 -->
<g id="edge2279" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258321.73,-499.65C257936.55,-490.26 257111.11,-465.13 256830,-417.06 256817.99,-415.01 256805.48,-412.16 256793.27,-408.95"/>
<polygon fill="black" stroke="black" points="256794.11,-405.56 256783.54,-406.32 256792.28,-412.31 256794.11,-405.56"/>
</g>
<!-- dp3_pp2_layer13_expert1 -->
<g id="node1390" class="node">
<title>dp3_pp2_layer13_expert1</title>
<polygon fill="lightgreen" stroke="black" points="257063,-406.29 256839,-406.29 256839,-354.29 257063,-354.29 257063,-406.29"/>
<text text-anchor="middle" x="256951" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="256951" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="256951" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="256951" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert1 -->
<g id="edge2280" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258319.55,-497.55C257977.94,-485.71 257305.58,-458.03 257072,-417.06 257060.08,-414.97 257047.67,-412.12 257035.54,-408.93"/>
<polygon fill="black" stroke="black" points="257036.45,-405.55 257025.89,-406.3 257034.62,-412.3 257036.45,-405.55"/>
</g>
<!-- dp3_pp2_layer13_expert2 -->
<g id="node1391" class="node">
<title>dp3_pp2_layer13_expert2</title>
<polygon fill="lightgreen" stroke="black" points="257305,-406.29 257081,-406.29 257081,-354.29 257305,-354.29 257305,-406.29"/>
<text text-anchor="middle" x="257193" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="257193" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="257193" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="257193" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert2 -->
<g id="edge2281" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258324.82,-502.85C258083.66,-498.37 257666.02,-480.97 257314,-417.06 257302.38,-414.95 257290.29,-412.14 257278.44,-409.03"/>
<polygon fill="black" stroke="black" points="257279.13,-405.59 257268.56,-406.34 257277.29,-412.34 257279.13,-405.59"/>
</g>
<!-- dp3_pp2_layer13_expert3 -->
<g id="node1392" class="node">
<title>dp3_pp2_layer13_expert3</title>
<polygon fill="lightgreen" stroke="black" points="257547,-406.29 257323,-406.29 257323,-354.29 257547,-354.29 257547,-406.29"/>
<text text-anchor="middle" x="257435" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="257435" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="257435" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="257435" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert3 -->
<g id="edge2282" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258319.36,-497.41C258122.31,-488.25 257816.63,-466.79 257556,-417.06 257544.57,-414.88 257532.67,-412.06 257520.99,-408.97"/>
<polygon fill="black" stroke="black" points="257521.82,-405.57 257511.25,-406.31 257519.98,-412.32 257521.82,-405.57"/>
</g>
<!-- dp3_pp2_layer13_expert4 -->
<g id="node1393" class="node">
<title>dp3_pp2_layer13_expert4</title>
<polygon fill="lightgreen" stroke="black" points="257789,-406.29 257565,-406.29 257565,-354.29 257789,-354.29 257789,-406.29"/>
<text text-anchor="middle" x="257677" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="257677" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="257677" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="257677" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert4 -->
<g id="edge2283" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258310.43,-487.98C258164.99,-474.71 257968.64,-452.25 257798,-417.06 257787.05,-414.8 257775.65,-412.02 257764.43,-409.02"/>
<polygon fill="black" stroke="black" points="257765.19,-405.6 257754.62,-406.33 257763.34,-412.35 257765.19,-405.6"/>
</g>
<!-- dp3_pp2_layer13_expert5 -->
<g id="node1394" class="node">
<title>dp3_pp2_layer13_expert5</title>
<polygon fill="lightgreen" stroke="black" points="258031,-406.29 257807,-406.29 257807,-354.29 258031,-354.29 258031,-406.29"/>
<text text-anchor="middle" x="257919" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="257919" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="257919" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="257919" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert5 -->
<g id="edge2284" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258290.29,-467.38C258210.5,-453.44 258121,-436.25 258040,-417.06 258029.9,-414.67 258019.4,-411.94 258008.99,-409.07"/>
<polygon fill="black" stroke="black" points="258009.62,-405.62 257999.05,-406.3 258007.74,-412.36 258009.62,-405.62"/>
</g>
<!-- dp3_pp2_layer13_expert6 -->
<g id="node1395" class="node">
<title>dp3_pp2_layer13_expert6</title>
<polygon fill="lightgreen" stroke="black" points="258273,-406.29 258049,-406.29 258049,-354.29 258273,-354.29 258273,-406.29"/>
<text text-anchor="middle" x="258161" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="258161" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="258161" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="258161" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert6 -->
<g id="edge2285" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258372.94,-452.97C258329.16,-438.16 258282.94,-422.53 258244.87,-409.66"/>
<polygon fill="black" stroke="black" points="258245.97,-406.33 258235.38,-406.45 258243.73,-412.97 258245.97,-406.33"/>
</g>
<!-- dp3_pp2_layer13_expert7 -->
<g id="node1396" class="node">
<title>dp3_pp2_layer13_expert7</title>
<polygon fill="lightgreen" stroke="black" points="258515,-406.29 258291,-406.29 258291,-354.29 258515,-354.29 258515,-406.29"/>
<text text-anchor="middle" x="258403" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="258403" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="258403" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="258403" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert7 -->
<g id="edge2286" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258473.38,-452.71C258460.3,-439.43 258446.58,-425.51 258434.76,-413.52"/>
<polygon fill="black" stroke="black" points="258437.19,-411 258427.68,-406.33 258432.2,-415.91 258437.19,-411"/>
</g>
<!-- dp3_pp2_layer13_expert8 -->
<g id="node1397" class="node">
<title>dp3_pp2_layer13_expert8</title>
<polygon fill="lightgreen" stroke="black" points="258757,-406.29 258533,-406.29 258533,-354.29 258757,-354.29 258757,-406.29"/>
<text text-anchor="middle" x="258645" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="258645" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="258645" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="258645" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert8 -->
<g id="edge2287" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258574.61,-452.71C258587.7,-439.43 258601.42,-425.51 258613.23,-413.52"/>
<polygon fill="black" stroke="black" points="258615.79,-415.91 258620.32,-406.33 258610.81,-411 258615.79,-415.91"/>
</g>
<!-- dp3_pp2_layer13_expert9 -->
<g id="node1398" class="node">
<title>dp3_pp2_layer13_expert9</title>
<polygon fill="lightgreen" stroke="black" points="258999,-406.29 258775,-406.29 258775,-354.29 258999,-354.29 258999,-406.29"/>
<text text-anchor="middle" x="258887" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="258887" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="258887" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="258887" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert9 -->
<g id="edge2288" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258671.38,-454.21C258716.29,-439.03 258764.08,-422.86 258803.23,-409.62"/>
<polygon fill="black" stroke="black" points="258804.64,-412.84 258812.99,-406.32 258802.4,-406.21 258804.64,-412.84"/>
</g>
<!-- dp3_pp2_layer13_expert10 -->
<g id="node1399" class="node">
<title>dp3_pp2_layer13_expert10</title>
<polygon fill="lightgreen" stroke="black" points="259241,-406.29 259017,-406.29 259017,-354.29 259241,-354.29 259241,-406.29"/>
<text text-anchor="middle" x="259129" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="259129" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="259129" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="259129" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert10 -->
<g id="edge2289" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258694.89,-478.04C258787.98,-462.69 258904.88,-441.49 259008,-417.06 259018.09,-414.67 259028.6,-411.94 259039.01,-409.07"/>
<polygon fill="black" stroke="black" points="259040.26,-412.36 259048.95,-406.3 259038.37,-405.62 259040.26,-412.36"/>
</g>
<!-- dp3_pp2_layer13_expert11 -->
<g id="node1400" class="node">
<title>dp3_pp2_layer13_expert11</title>
<polygon fill="lightgreen" stroke="black" points="259483,-406.29 259259,-406.29 259259,-354.29 259483,-354.29 259483,-406.29"/>
<text text-anchor="middle" x="259371" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="259371" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="259371" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="259371" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert11 -->
<g id="edge2290" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258706.99,-490.7C258854.62,-477.88 259067.08,-454.78 259250,-417.06 259260.95,-414.8 259272.35,-412.02 259283.57,-409.02"/>
<polygon fill="black" stroke="black" points="259284.66,-412.35 259293.38,-406.33 259282.81,-405.6 259284.66,-412.35"/>
</g>
<!-- dp3_pp2_layer13_expert12 -->
<g id="node1401" class="node">
<title>dp3_pp2_layer13_expert12</title>
<polygon fill="lightgreen" stroke="black" points="259725,-406.29 259501,-406.29 259501,-354.29 259725,-354.29 259725,-406.29"/>
<text text-anchor="middle" x="259613" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="259613" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="259613" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="259613" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert12 -->
<g id="edge2291" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258714.27,-498.07C258910.59,-489.29 259224.95,-468.01 259492,-417.06 259503.43,-414.88 259515.33,-412.06 259527.01,-408.97"/>
<polygon fill="black" stroke="black" points="259528.02,-412.32 259536.75,-406.31 259526.18,-405.57 259528.02,-412.32"/>
</g>
<!-- dp3_pp2_layer13_expert13 -->
<g id="node1402" class="node">
<title>dp3_pp2_layer13_expert13</title>
<polygon fill="lightgreen" stroke="black" points="259967,-406.29 259743,-406.29 259743,-354.29 259967,-354.29 259967,-406.29"/>
<text text-anchor="middle" x="259855" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="259855" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="259855" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="259855" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert13 -->
<g id="edge2292" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258718.93,-502.93C258959.42,-498.58 259379.9,-481.35 259734,-417.06 259745.62,-414.95 259757.71,-412.14 259769.56,-409.03"/>
<polygon fill="black" stroke="black" points="259770.7,-412.34 259779.44,-406.34 259768.87,-405.59 259770.7,-412.34"/>
</g>
<!-- dp3_pp2_layer13_expert14 -->
<g id="node1403" class="node">
<title>dp3_pp2_layer13_expert14</title>
<polygon fill="lightgreen" stroke="black" points="260209,-406.29 259985,-406.29 259985,-354.29 260209,-354.29 260209,-406.29"/>
<text text-anchor="middle" x="260097" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="260097" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="260097" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="260097" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert14 -->
<g id="edge2293" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258714.32,-498.04C259051.17,-486.48 259739.15,-458.6 259976,-417.06 259987.92,-414.97 260000.32,-412.12 260012.46,-408.93"/>
<polygon fill="black" stroke="black" points="260013.38,-412.3 260022.11,-406.3 260011.54,-405.55 260013.38,-412.3"/>
</g>
<!-- dp3_pp2_layer13_expert15 -->
<g id="node1404" class="node">
<title>dp3_pp2_layer13_expert15</title>
<polygon fill="lightgreen" stroke="black" points="260451,-406.29 260227,-406.29 260227,-354.29 260451,-354.29 260451,-406.29"/>
<text text-anchor="middle" x="260339" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="260339" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="260339" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="260339" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert15 -->
<g id="edge2294" class="edge">
<title>dp3_pp2_layer13_router&#45;&gt;dp3_pp2_layer13_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M258715.94,-499.9C259096.49,-490.72 259934.35,-465.57 260218,-417.06 260230.01,-415.01 260242.51,-412.16 260254.73,-408.95"/>
<polygon fill="black" stroke="black" points="260255.72,-412.31 260264.45,-406.32 260253.88,-405.56 260255.72,-412.31"/>
</g>
<!-- dp3_pp2_layer13_expert_agg -->
<g id="node1405" class="node">
<title>dp3_pp2_layer13_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="258771.57,-307.52 258377.74,-307.52 258276.43,-203.52 258670.26,-203.52 258771.57,-307.52"/>
<text text-anchor="middle" x="258524" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="258524" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="258524" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="258524" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer13_expert0&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2295" class="edge">
<title>dp3_pp2_layer13_expert0&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M256767.07,-354.29C256786.69,-346.92 256808.97,-339.72 256830,-335.52 257109.13,-279.86 257932.93,-263.21 258319.43,-258.4"/>
<polygon fill="black" stroke="black" points="258319.65,-261.9 258329.61,-258.27 258319.57,-254.9 258319.65,-261.9"/>
</g>
<!-- dp3_pp2_layer13_expert1&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2296" class="edge">
<title>dp3_pp2_layer13_expert1&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M257009.39,-354.27C257028.95,-346.95 257051.09,-339.78 257072,-335.52 257304.8,-288.16 257980.09,-267.74 258321.43,-260.24"/>
<polygon fill="black" stroke="black" points="258321.51,-263.74 258331.43,-260.03 258321.35,-256.74 258321.51,-263.74"/>
</g>
<!-- dp3_pp2_layer13_expert2&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2297" class="edge">
<title>dp3_pp2_layer13_expert2&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M257251.73,-354.29C257271.21,-347.01 257293.23,-339.87 257314,-335.52 257500.91,-296.44 258030.54,-273.07 258323.3,-262.78"/>
<polygon fill="black" stroke="black" points="258323.74,-266.27 258333.61,-262.42 258323.5,-259.27 258323.74,-266.27"/>
</g>
<!-- dp3_pp2_layer13_expert3&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2298" class="edge">
<title>dp3_pp2_layer13_expert3&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M257494.39,-354.26C257513.72,-347.07 257535.48,-339.99 257556,-335.52 257814.91,-279.18 258120.7,-262.24 258318.26,-257.56"/>
<polygon fill="black" stroke="black" points="258318.55,-261.06 258328.47,-257.33 258318.39,-254.06 258318.55,-261.06"/>
</g>
<!-- dp3_pp2_layer13_expert4&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2299" class="edge">
<title>dp3_pp2_layer13_expert4&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M257737.39,-354.24C257756.49,-347.2 257777.87,-340.19 257798,-335.52 257973.82,-294.77 258178.6,-274.91 258325.75,-265.31"/>
<polygon fill="black" stroke="black" points="258326.05,-268.8 258335.81,-264.67 258325.6,-261.82 258326.05,-268.8"/>
</g>
<!-- dp3_pp2_layer13_expert5&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2300" class="edge">
<title>dp3_pp2_layer13_expert5&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M257981.42,-354.22C258000.04,-347.42 258020.65,-340.55 258040,-335.52 258137.09,-310.27 258247.34,-291.53 258338.07,-278.65"/>
<polygon fill="black" stroke="black" points="258338.78,-282.09 258348.19,-277.23 258337.8,-275.16 258338.78,-282.09"/>
</g>
<!-- dp3_pp2_layer13_expert6&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2301" class="edge">
<title>dp3_pp2_layer13_expert6&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M258229.02,-354.26C258246.26,-348.03 258264.78,-341.44 258282,-335.52 258308.73,-326.33 258337.21,-316.8 258364.89,-307.67"/>
<polygon fill="black" stroke="black" points="258366.24,-310.91 258374.65,-304.46 258364.06,-304.26 258366.24,-310.91"/>
</g>
<!-- dp3_pp2_layer13_expert7&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2302" class="edge">
<title>dp3_pp2_layer13_expert7&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M258427.78,-354.15C258439.02,-342.74 258452.83,-328.73 258466.45,-314.92"/>
<polygon fill="black" stroke="black" points="258469,-317.31 258473.53,-307.73 258464.02,-312.39 258469,-317.31"/>
</g>
<!-- dp3_pp2_layer13_expert8&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2303" class="edge">
<title>dp3_pp2_layer13_expert8&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M258620.22,-354.15C258608.97,-342.74 258595.16,-328.73 258581.55,-314.92"/>
<polygon fill="black" stroke="black" points="258583.98,-312.39 258574.47,-307.73 258578.99,-317.31 258583.98,-312.39"/>
</g>
<!-- dp3_pp2_layer13_expert9&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2304" class="edge">
<title>dp3_pp2_layer13_expert9&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M258818.98,-354.26C258801.73,-348.03 258783.21,-341.44 258766,-335.52 258742.29,-327.37 258717.21,-318.95 258692.53,-310.78"/>
<polygon fill="black" stroke="black" points="258693.32,-307.36 258682.73,-307.54 258691.12,-314 258693.32,-307.36"/>
</g>
<!-- dp3_pp2_layer13_expert10&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2305" class="edge">
<title>dp3_pp2_layer13_expert10&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M259066.58,-354.22C259047.96,-347.42 259027.35,-340.55 259008,-335.52 258927.99,-314.71 258839.05,-298.33 258759.46,-286"/>
<polygon fill="black" stroke="black" points="258759.71,-282.5 258749.3,-284.44 258758.65,-289.41 258759.71,-282.5"/>
</g>
<!-- dp3_pp2_layer13_expert11&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2306" class="edge">
<title>dp3_pp2_layer13_expert11&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M259310.61,-354.24C259291.51,-347.2 259270.13,-340.19 259250,-335.52 259081.74,-296.53 258886.97,-276.66 258741.55,-266.61"/>
<polygon fill="black" stroke="black" points="258741.38,-263.09 258731.16,-265.9 258740.9,-270.07 258741.38,-263.09"/>
</g>
<!-- dp3_pp2_layer13_expert12&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2307" class="edge">
<title>dp3_pp2_layer13_expert12&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M259553.61,-354.26C259534.28,-347.07 259512.52,-339.99 259492,-335.52 259234.51,-279.49 258930.64,-262.43 258732.99,-257.64"/>
<polygon fill="black" stroke="black" points="258732.86,-254.14 258722.78,-257.4 258732.69,-261.13 258732.86,-254.14"/>
</g>
<!-- dp3_pp2_layer13_expert13&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2308" class="edge">
<title>dp3_pp2_layer13_expert13&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M259796.27,-354.29C259776.79,-347.01 259754.77,-339.87 259734,-335.52 259550.02,-297.05 259033.97,-273.81 258738.63,-263.27"/>
<polygon fill="black" stroke="black" points="258738.33,-259.76 258728.21,-262.9 258738.08,-266.76 258738.33,-259.76"/>
</g>
<!-- dp3_pp2_layer13_expert14&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2309" class="edge">
<title>dp3_pp2_layer13_expert14&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M260038.6,-354.27C260019.05,-346.95 259996.9,-339.78 259976,-335.52 259745.27,-288.58 259079.86,-268.1 258735.74,-260.45"/>
<polygon fill="black" stroke="black" points="258735.73,-256.94 258725.65,-260.22 258735.57,-263.94 258735.73,-256.94"/>
</g>
<!-- dp3_pp2_layer13_expert15&#45;&gt;dp3_pp2_layer13_expert_agg -->
<g id="edge2310" class="edge">
<title>dp3_pp2_layer13_expert15&#45;&gt;dp3_pp2_layer13_expert_agg</title>
<path fill="none" stroke="black" d="M260280.93,-354.29C260261.3,-346.92 260239.03,-339.72 260218,-335.52 259940.21,-280.12 259122.98,-263.37 258734.17,-258.47"/>
<polygon fill="black" stroke="black" points="258733.97,-254.97 258723.93,-258.34 258733.88,-261.97 258733.97,-254.97"/>
</g>
<!-- dp3_pp2_layer14_attn_tp0 -->
<g id="node1406" class="node">
<title>dp3_pp2_layer14_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="256006.5,-531.06 255741.5,-531.06 255741.5,-479.06 256006.5,-479.06 256006.5,-531.06"/>
<text text-anchor="middle" x="255874" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="255874" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="255874" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="255874" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer13_expert_agg&#45;&gt;dp3_pp2_layer14_attn_tp0 -->
<g id="edge2312" class="edge">
<title>dp3_pp2_layer13_expert_agg&#45;&gt;dp3_pp2_layer14_attn_tp0</title>
<path fill="none" stroke="black" d="M258331.78,-260.41C257911.38,-269.54 256921.17,-294.77 256588,-335.52 256555.8,-339.46 256047.23,-444.29 256016,-453.06 255993.37,-459.41 255969.16,-467.58 255947.26,-475.5"/>
<polygon fill="black" stroke="black" points="255945.89,-472.28 255937.7,-479 255948.29,-478.85 255945.89,-472.28"/>
</g>
<!-- dp3_pp2_layer14_attn_allreduce -->
<g id="node1407" class="node">
<title>dp3_pp2_layer14_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="256003" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="256003" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="256003" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="256003" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="256003" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_attn_tp0&#45;&gt;dp3_pp2_layer14_attn_allreduce -->
<g id="edge2313" class="edge">
<title>dp3_pp2_layer14_attn_tp0&#45;&gt;dp3_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M255900.41,-478.92C255917.15,-463 255939.21,-442 255958.58,-423.56"/>
<polygon fill="black" stroke="black" points="255961.03,-426.07 255965.86,-416.64 255956.2,-421 255961.03,-426.07"/>
</g>
<!-- dp3_pp2_layer14_router -->
<g id="node1411" class="node">
<title>dp3_pp2_layer14_router</title>
<polygon fill="lightyellow" stroke="black" points="253754.57,-557.06 253360.74,-557.06 253259.43,-453.06 253653.26,-453.06 253754.57,-557.06"/>
<text text-anchor="middle" x="253507" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="253507" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="253507" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="253507" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_attn_allreduce&#45;&gt;dp3_pp2_layer14_router -->
<g id="edge2349" class="edge">
<title>dp3_pp2_layer14_attn_allreduce&#45;&gt;dp3_pp2_layer14_router</title>
<path fill="none" stroke="black" d="M255843.08,-392.38C255731.77,-399.9 255579.89,-409.76 255446,-417.06 254810.5,-451.72 254057.28,-482.59 253705.96,-496.4"/>
<polygon fill="black" stroke="black" points="253705.8,-492.91 253695.94,-496.79 253706.07,-499.9 253705.8,-492.91"/>
</g>
<!-- dp3_pp2_layer14_attn_tp1 -->
<g id="node1408" class="node">
<title>dp3_pp2_layer14_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="256289.5,-531.06 256024.5,-531.06 256024.5,-479.06 256289.5,-479.06 256289.5,-531.06"/>
<text text-anchor="middle" x="256157" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="256157" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="256157" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="256157" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer14_attn_tp1&#45;&gt;dp3_pp2_layer14_attn_allreduce -->
<g id="edge2314" class="edge">
<title>dp3_pp2_layer14_attn_tp1&#45;&gt;dp3_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M256125.46,-478.92C256104.99,-462.6 256077.83,-440.94 256054.29,-422.18"/>
<polygon fill="black" stroke="black" points="256056.46,-419.44 256046.46,-415.94 256052.1,-424.91 256056.46,-419.44"/>
</g>
<!-- dp3_pp2_layer14_attn_tp2 -->
<g id="node1409" class="node">
<title>dp3_pp2_layer14_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="255723.5,-531.06 255458.5,-531.06 255458.5,-479.06 255723.5,-479.06 255723.5,-531.06"/>
<text text-anchor="middle" x="255591" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="255591" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="255591" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="255591" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer14_attn_tp2&#45;&gt;dp3_pp2_layer14_attn_allreduce -->
<g id="edge2315" class="edge">
<title>dp3_pp2_layer14_attn_tp2&#45;&gt;dp3_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M255657.07,-479.02C255680.85,-470.35 255707.99,-460.86 255733,-453.06 255781.74,-437.86 255836.05,-423.03 255883.1,-410.83"/>
<polygon fill="black" stroke="black" points="255884.22,-414.15 255893.03,-408.26 255882.47,-407.38 255884.22,-414.15"/>
</g>
<!-- dp3_pp2_layer14_attn_tp3 -->
<g id="node1410" class="node">
<title>dp3_pp2_layer14_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="256572.5,-531.06 256307.5,-531.06 256307.5,-479.06 256572.5,-479.06 256572.5,-531.06"/>
<text text-anchor="middle" x="256440" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="256440" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="256440" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="256440" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer14_attn_tp3&#45;&gt;dp3_pp2_layer14_attn_allreduce -->
<g id="edge2316" class="edge">
<title>dp3_pp2_layer14_attn_tp3&#45;&gt;dp3_pp2_layer14_attn_allreduce</title>
<path fill="none" stroke="black" d="M256375.21,-478.95C256351.43,-470.18 256324.17,-460.64 256299,-453.06 256244.42,-436.63 256183.31,-421.31 256130.86,-409.08"/>
<polygon fill="black" stroke="black" points="256131.37,-405.6 256120.83,-406.75 256129.78,-412.42 256131.37,-405.6"/>
</g>
<!-- dp3_pp2_layer14_expert0 -->
<g id="node1412" class="node">
<title>dp3_pp2_layer14_expert0</title>
<polygon fill="lightgreen" stroke="black" points="251804,-406.29 251580,-406.29 251580,-354.29 251804,-354.29 251804,-406.29"/>
<text text-anchor="middle" x="251692" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="251692" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="251692" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="251692" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert0 -->
<g id="edge2317" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253304.73,-499.65C252919.55,-490.26 252094.11,-465.13 251813,-417.06 251800.99,-415.01 251788.48,-412.16 251776.27,-408.95"/>
<polygon fill="black" stroke="black" points="251777.11,-405.56 251766.54,-406.32 251775.28,-412.31 251777.11,-405.56"/>
</g>
<!-- dp3_pp2_layer14_expert1 -->
<g id="node1413" class="node">
<title>dp3_pp2_layer14_expert1</title>
<polygon fill="lightgreen" stroke="black" points="252046,-406.29 251822,-406.29 251822,-354.29 252046,-354.29 252046,-406.29"/>
<text text-anchor="middle" x="251934" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="251934" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="251934" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="251934" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert1 -->
<g id="edge2318" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253302.55,-497.55C252960.94,-485.71 252288.58,-458.03 252055,-417.06 252043.08,-414.97 252030.67,-412.12 252018.54,-408.93"/>
<polygon fill="black" stroke="black" points="252019.45,-405.55 252008.89,-406.3 252017.62,-412.3 252019.45,-405.55"/>
</g>
<!-- dp3_pp2_layer14_expert2 -->
<g id="node1414" class="node">
<title>dp3_pp2_layer14_expert2</title>
<polygon fill="lightgreen" stroke="black" points="252288,-406.29 252064,-406.29 252064,-354.29 252288,-354.29 252288,-406.29"/>
<text text-anchor="middle" x="252176" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="252176" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="252176" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="252176" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert2 -->
<g id="edge2319" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253307.82,-502.85C253066.66,-498.37 252649.02,-480.97 252297,-417.06 252285.38,-414.95 252273.29,-412.14 252261.44,-409.03"/>
<polygon fill="black" stroke="black" points="252262.13,-405.59 252251.56,-406.34 252260.29,-412.34 252262.13,-405.59"/>
</g>
<!-- dp3_pp2_layer14_expert3 -->
<g id="node1415" class="node">
<title>dp3_pp2_layer14_expert3</title>
<polygon fill="lightgreen" stroke="black" points="252530,-406.29 252306,-406.29 252306,-354.29 252530,-354.29 252530,-406.29"/>
<text text-anchor="middle" x="252418" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="252418" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="252418" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="252418" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert3 -->
<g id="edge2320" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253302.36,-497.41C253105.31,-488.25 252799.63,-466.79 252539,-417.06 252527.57,-414.88 252515.67,-412.06 252503.99,-408.97"/>
<polygon fill="black" stroke="black" points="252504.82,-405.57 252494.25,-406.31 252502.98,-412.32 252504.82,-405.57"/>
</g>
<!-- dp3_pp2_layer14_expert4 -->
<g id="node1416" class="node">
<title>dp3_pp2_layer14_expert4</title>
<polygon fill="lightgreen" stroke="black" points="252772,-406.29 252548,-406.29 252548,-354.29 252772,-354.29 252772,-406.29"/>
<text text-anchor="middle" x="252660" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="252660" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="252660" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="252660" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert4 -->
<g id="edge2321" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253293.43,-487.98C253147.99,-474.71 252951.64,-452.25 252781,-417.06 252770.05,-414.8 252758.65,-412.02 252747.43,-409.02"/>
<polygon fill="black" stroke="black" points="252748.19,-405.6 252737.62,-406.33 252746.34,-412.35 252748.19,-405.6"/>
</g>
<!-- dp3_pp2_layer14_expert5 -->
<g id="node1417" class="node">
<title>dp3_pp2_layer14_expert5</title>
<polygon fill="lightgreen" stroke="black" points="253014,-406.29 252790,-406.29 252790,-354.29 253014,-354.29 253014,-406.29"/>
<text text-anchor="middle" x="252902" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="252902" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="252902" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="252902" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert5 -->
<g id="edge2322" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253273.29,-467.38C253193.5,-453.44 253104,-436.25 253023,-417.06 253012.9,-414.67 253002.4,-411.94 252991.99,-409.07"/>
<polygon fill="black" stroke="black" points="252992.62,-405.62 252982.05,-406.3 252990.74,-412.36 252992.62,-405.62"/>
</g>
<!-- dp3_pp2_layer14_expert6 -->
<g id="node1418" class="node">
<title>dp3_pp2_layer14_expert6</title>
<polygon fill="lightgreen" stroke="black" points="253256,-406.29 253032,-406.29 253032,-354.29 253256,-354.29 253256,-406.29"/>
<text text-anchor="middle" x="253144" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="253144" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="253144" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="253144" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert6 -->
<g id="edge2323" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253355.94,-452.97C253312.16,-438.16 253265.94,-422.53 253227.87,-409.66"/>
<polygon fill="black" stroke="black" points="253228.97,-406.33 253218.38,-406.45 253226.73,-412.97 253228.97,-406.33"/>
</g>
<!-- dp3_pp2_layer14_expert7 -->
<g id="node1419" class="node">
<title>dp3_pp2_layer14_expert7</title>
<polygon fill="lightgreen" stroke="black" points="253498,-406.29 253274,-406.29 253274,-354.29 253498,-354.29 253498,-406.29"/>
<text text-anchor="middle" x="253386" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="253386" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="253386" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="253386" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert7 -->
<g id="edge2324" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253456.38,-452.71C253443.3,-439.43 253429.58,-425.51 253417.76,-413.52"/>
<polygon fill="black" stroke="black" points="253420.19,-411 253410.68,-406.33 253415.2,-415.91 253420.19,-411"/>
</g>
<!-- dp3_pp2_layer14_expert8 -->
<g id="node1420" class="node">
<title>dp3_pp2_layer14_expert8</title>
<polygon fill="lightgreen" stroke="black" points="253740,-406.29 253516,-406.29 253516,-354.29 253740,-354.29 253740,-406.29"/>
<text text-anchor="middle" x="253628" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="253628" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="253628" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="253628" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert8 -->
<g id="edge2325" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253557.61,-452.71C253570.7,-439.43 253584.42,-425.51 253596.23,-413.52"/>
<polygon fill="black" stroke="black" points="253598.79,-415.91 253603.32,-406.33 253593.81,-411 253598.79,-415.91"/>
</g>
<!-- dp3_pp2_layer14_expert9 -->
<g id="node1421" class="node">
<title>dp3_pp2_layer14_expert9</title>
<polygon fill="lightgreen" stroke="black" points="253982,-406.29 253758,-406.29 253758,-354.29 253982,-354.29 253982,-406.29"/>
<text text-anchor="middle" x="253870" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="253870" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="253870" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="253870" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert9 -->
<g id="edge2326" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253654.38,-454.21C253699.29,-439.03 253747.08,-422.86 253786.23,-409.62"/>
<polygon fill="black" stroke="black" points="253787.64,-412.84 253795.99,-406.32 253785.4,-406.21 253787.64,-412.84"/>
</g>
<!-- dp3_pp2_layer14_expert10 -->
<g id="node1422" class="node">
<title>dp3_pp2_layer14_expert10</title>
<polygon fill="lightgreen" stroke="black" points="254224,-406.29 254000,-406.29 254000,-354.29 254224,-354.29 254224,-406.29"/>
<text text-anchor="middle" x="254112" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="254112" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="254112" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="254112" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert10 -->
<g id="edge2327" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253677.89,-478.04C253770.98,-462.69 253887.88,-441.49 253991,-417.06 254001.09,-414.67 254011.6,-411.94 254022.01,-409.07"/>
<polygon fill="black" stroke="black" points="254023.26,-412.36 254031.95,-406.3 254021.37,-405.62 254023.26,-412.36"/>
</g>
<!-- dp3_pp2_layer14_expert11 -->
<g id="node1423" class="node">
<title>dp3_pp2_layer14_expert11</title>
<polygon fill="lightgreen" stroke="black" points="254466,-406.29 254242,-406.29 254242,-354.29 254466,-354.29 254466,-406.29"/>
<text text-anchor="middle" x="254354" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="254354" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="254354" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="254354" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert11 -->
<g id="edge2328" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253689.99,-490.7C253837.62,-477.88 254050.08,-454.78 254233,-417.06 254243.95,-414.8 254255.35,-412.02 254266.57,-409.02"/>
<polygon fill="black" stroke="black" points="254267.66,-412.35 254276.38,-406.33 254265.81,-405.6 254267.66,-412.35"/>
</g>
<!-- dp3_pp2_layer14_expert12 -->
<g id="node1424" class="node">
<title>dp3_pp2_layer14_expert12</title>
<polygon fill="lightgreen" stroke="black" points="254708,-406.29 254484,-406.29 254484,-354.29 254708,-354.29 254708,-406.29"/>
<text text-anchor="middle" x="254596" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="254596" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="254596" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="254596" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert12 -->
<g id="edge2329" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253697.27,-498.07C253893.59,-489.29 254207.95,-468.01 254475,-417.06 254486.43,-414.88 254498.33,-412.06 254510.01,-408.97"/>
<polygon fill="black" stroke="black" points="254511.02,-412.32 254519.75,-406.31 254509.18,-405.57 254511.02,-412.32"/>
</g>
<!-- dp3_pp2_layer14_expert13 -->
<g id="node1425" class="node">
<title>dp3_pp2_layer14_expert13</title>
<polygon fill="lightgreen" stroke="black" points="254950,-406.29 254726,-406.29 254726,-354.29 254950,-354.29 254950,-406.29"/>
<text text-anchor="middle" x="254838" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="254838" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="254838" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="254838" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert13 -->
<g id="edge2330" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253701.93,-502.93C253942.42,-498.58 254362.9,-481.35 254717,-417.06 254728.62,-414.95 254740.71,-412.14 254752.56,-409.03"/>
<polygon fill="black" stroke="black" points="254753.7,-412.34 254762.44,-406.34 254751.87,-405.59 254753.7,-412.34"/>
</g>
<!-- dp3_pp2_layer14_expert14 -->
<g id="node1426" class="node">
<title>dp3_pp2_layer14_expert14</title>
<polygon fill="lightgreen" stroke="black" points="255192,-406.29 254968,-406.29 254968,-354.29 255192,-354.29 255192,-406.29"/>
<text text-anchor="middle" x="255080" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="255080" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="255080" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="255080" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert14 -->
<g id="edge2331" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253697.32,-498.04C254034.17,-486.48 254722.15,-458.6 254959,-417.06 254970.92,-414.97 254983.32,-412.12 254995.46,-408.93"/>
<polygon fill="black" stroke="black" points="254996.38,-412.3 255005.11,-406.3 254994.54,-405.55 254996.38,-412.3"/>
</g>
<!-- dp3_pp2_layer14_expert15 -->
<g id="node1427" class="node">
<title>dp3_pp2_layer14_expert15</title>
<polygon fill="lightgreen" stroke="black" points="255434,-406.29 255210,-406.29 255210,-354.29 255434,-354.29 255434,-406.29"/>
<text text-anchor="middle" x="255322" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="255322" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="255322" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="255322" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert15 -->
<g id="edge2332" class="edge">
<title>dp3_pp2_layer14_router&#45;&gt;dp3_pp2_layer14_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M253698.94,-499.9C254079.49,-490.72 254917.35,-465.57 255201,-417.06 255213.01,-415.01 255225.51,-412.16 255237.73,-408.95"/>
<polygon fill="black" stroke="black" points="255238.72,-412.31 255247.45,-406.32 255236.88,-405.56 255238.72,-412.31"/>
</g>
<!-- dp3_pp2_layer14_expert_agg -->
<g id="node1428" class="node">
<title>dp3_pp2_layer14_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="253754.57,-307.52 253360.74,-307.52 253259.43,-203.52 253653.26,-203.52 253754.57,-307.52"/>
<text text-anchor="middle" x="253507" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="253507" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="253507" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="253507" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer14_expert0&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2333" class="edge">
<title>dp3_pp2_layer14_expert0&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M251750.07,-354.29C251769.69,-346.92 251791.97,-339.72 251813,-335.52 252092.13,-279.86 252915.93,-263.21 253302.43,-258.4"/>
<polygon fill="black" stroke="black" points="253302.65,-261.9 253312.61,-258.27 253302.57,-254.9 253302.65,-261.9"/>
</g>
<!-- dp3_pp2_layer14_expert1&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2334" class="edge">
<title>dp3_pp2_layer14_expert1&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M251992.39,-354.27C252011.95,-346.95 252034.09,-339.78 252055,-335.52 252287.8,-288.16 252963.09,-267.74 253304.43,-260.24"/>
<polygon fill="black" stroke="black" points="253304.51,-263.74 253314.43,-260.03 253304.35,-256.74 253304.51,-263.74"/>
</g>
<!-- dp3_pp2_layer14_expert2&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2335" class="edge">
<title>dp3_pp2_layer14_expert2&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M252234.73,-354.29C252254.21,-347.01 252276.23,-339.87 252297,-335.52 252483.91,-296.44 253013.54,-273.07 253306.3,-262.78"/>
<polygon fill="black" stroke="black" points="253306.74,-266.27 253316.61,-262.42 253306.5,-259.27 253306.74,-266.27"/>
</g>
<!-- dp3_pp2_layer14_expert3&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2336" class="edge">
<title>dp3_pp2_layer14_expert3&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M252477.39,-354.26C252496.72,-347.07 252518.48,-339.99 252539,-335.52 252797.91,-279.18 253103.7,-262.24 253301.26,-257.56"/>
<polygon fill="black" stroke="black" points="253301.55,-261.06 253311.47,-257.33 253301.39,-254.06 253301.55,-261.06"/>
</g>
<!-- dp3_pp2_layer14_expert4&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2337" class="edge">
<title>dp3_pp2_layer14_expert4&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M252720.39,-354.24C252739.49,-347.2 252760.87,-340.19 252781,-335.52 252956.82,-294.77 253161.6,-274.91 253308.75,-265.31"/>
<polygon fill="black" stroke="black" points="253309.05,-268.8 253318.81,-264.67 253308.6,-261.82 253309.05,-268.8"/>
</g>
<!-- dp3_pp2_layer14_expert5&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2338" class="edge">
<title>dp3_pp2_layer14_expert5&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M252964.42,-354.22C252983.04,-347.42 253003.65,-340.55 253023,-335.52 253120.09,-310.27 253230.34,-291.53 253321.07,-278.65"/>
<polygon fill="black" stroke="black" points="253321.78,-282.09 253331.19,-277.23 253320.8,-275.16 253321.78,-282.09"/>
</g>
<!-- dp3_pp2_layer14_expert6&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2339" class="edge">
<title>dp3_pp2_layer14_expert6&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M253212.02,-354.26C253229.26,-348.03 253247.78,-341.44 253265,-335.52 253291.73,-326.33 253320.21,-316.8 253347.89,-307.67"/>
<polygon fill="black" stroke="black" points="253349.24,-310.91 253357.65,-304.46 253347.06,-304.26 253349.24,-310.91"/>
</g>
<!-- dp3_pp2_layer14_expert7&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2340" class="edge">
<title>dp3_pp2_layer14_expert7&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M253410.78,-354.15C253422.02,-342.74 253435.83,-328.73 253449.45,-314.92"/>
<polygon fill="black" stroke="black" points="253452,-317.31 253456.53,-307.73 253447.02,-312.39 253452,-317.31"/>
</g>
<!-- dp3_pp2_layer14_expert8&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2341" class="edge">
<title>dp3_pp2_layer14_expert8&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M253603.22,-354.15C253591.97,-342.74 253578.16,-328.73 253564.55,-314.92"/>
<polygon fill="black" stroke="black" points="253566.98,-312.39 253557.47,-307.73 253561.99,-317.31 253566.98,-312.39"/>
</g>
<!-- dp3_pp2_layer14_expert9&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2342" class="edge">
<title>dp3_pp2_layer14_expert9&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M253801.98,-354.26C253784.73,-348.03 253766.21,-341.44 253749,-335.52 253725.29,-327.37 253700.21,-318.95 253675.53,-310.78"/>
<polygon fill="black" stroke="black" points="253676.32,-307.36 253665.73,-307.54 253674.12,-314 253676.32,-307.36"/>
</g>
<!-- dp3_pp2_layer14_expert10&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2343" class="edge">
<title>dp3_pp2_layer14_expert10&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M254049.58,-354.22C254030.96,-347.42 254010.35,-340.55 253991,-335.52 253910.99,-314.71 253822.05,-298.33 253742.46,-286"/>
<polygon fill="black" stroke="black" points="253742.71,-282.5 253732.3,-284.44 253741.65,-289.41 253742.71,-282.5"/>
</g>
<!-- dp3_pp2_layer14_expert11&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2344" class="edge">
<title>dp3_pp2_layer14_expert11&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M254293.61,-354.24C254274.51,-347.2 254253.13,-340.19 254233,-335.52 254064.74,-296.53 253869.97,-276.66 253724.55,-266.61"/>
<polygon fill="black" stroke="black" points="253724.38,-263.09 253714.16,-265.9 253723.9,-270.07 253724.38,-263.09"/>
</g>
<!-- dp3_pp2_layer14_expert12&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2345" class="edge">
<title>dp3_pp2_layer14_expert12&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M254536.61,-354.26C254517.28,-347.07 254495.52,-339.99 254475,-335.52 254217.51,-279.49 253913.64,-262.43 253715.99,-257.64"/>
<polygon fill="black" stroke="black" points="253715.86,-254.14 253705.78,-257.4 253715.69,-261.13 253715.86,-254.14"/>
</g>
<!-- dp3_pp2_layer14_expert13&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2346" class="edge">
<title>dp3_pp2_layer14_expert13&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M254779.27,-354.29C254759.79,-347.01 254737.77,-339.87 254717,-335.52 254533.02,-297.05 254016.97,-273.81 253721.63,-263.27"/>
<polygon fill="black" stroke="black" points="253721.33,-259.76 253711.21,-262.9 253721.08,-266.76 253721.33,-259.76"/>
</g>
<!-- dp3_pp2_layer14_expert14&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2347" class="edge">
<title>dp3_pp2_layer14_expert14&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M255021.6,-354.27C255002.05,-346.95 254979.9,-339.78 254959,-335.52 254728.27,-288.58 254062.86,-268.1 253718.74,-260.45"/>
<polygon fill="black" stroke="black" points="253718.73,-256.94 253708.65,-260.22 253718.57,-263.94 253718.73,-256.94"/>
</g>
<!-- dp3_pp2_layer14_expert15&#45;&gt;dp3_pp2_layer14_expert_agg -->
<g id="edge2348" class="edge">
<title>dp3_pp2_layer14_expert15&#45;&gt;dp3_pp2_layer14_expert_agg</title>
<path fill="none" stroke="black" d="M255263.93,-354.29C255244.3,-346.92 255222.03,-339.72 255201,-335.52 254923.21,-280.12 254105.98,-263.37 253717.17,-258.47"/>
<polygon fill="black" stroke="black" points="253716.97,-254.97 253706.93,-258.34 253716.88,-261.97 253716.97,-254.97"/>
</g>
<!-- dp3_pp2_layer15_attn_tp0 -->
<g id="node1429" class="node">
<title>dp3_pp2_layer15_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="250989.5,-531.06 250724.5,-531.06 250724.5,-479.06 250989.5,-479.06 250989.5,-531.06"/>
<text text-anchor="middle" x="250857" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="250857" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="250857" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="250857" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer14_expert_agg&#45;&gt;dp3_pp2_layer15_attn_tp0 -->
<g id="edge2350" class="edge">
<title>dp3_pp2_layer14_expert_agg&#45;&gt;dp3_pp2_layer15_attn_tp0</title>
<path fill="none" stroke="black" d="M253314.78,-260.41C252894.38,-269.54 251904.17,-294.77 251571,-335.52 251538.8,-339.46 251030.23,-444.29 250999,-453.06 250976.37,-459.41 250952.16,-467.58 250930.26,-475.5"/>
<polygon fill="black" stroke="black" points="250928.89,-472.28 250920.7,-479 250931.29,-478.85 250928.89,-472.28"/>
</g>
<!-- dp3_pp2_layer15_attn_allreduce -->
<g id="node1430" class="node">
<title>dp3_pp2_layer15_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="250986" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="250986" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="250986" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="250986" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="250986" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_attn_tp0&#45;&gt;dp3_pp2_layer15_attn_allreduce -->
<g id="edge2351" class="edge">
<title>dp3_pp2_layer15_attn_tp0&#45;&gt;dp3_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M250883.41,-478.92C250900.15,-463 250922.21,-442 250941.58,-423.56"/>
<polygon fill="black" stroke="black" points="250944.03,-426.07 250948.86,-416.64 250939.2,-421 250944.03,-426.07"/>
</g>
<!-- dp3_pp2_layer15_router -->
<g id="node1434" class="node">
<title>dp3_pp2_layer15_router</title>
<polygon fill="lightyellow" stroke="black" points="248737.57,-557.06 248343.74,-557.06 248242.43,-453.06 248636.26,-453.06 248737.57,-557.06"/>
<text text-anchor="middle" x="248490" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="248490" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="248490" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="248490" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_attn_allreduce&#45;&gt;dp3_pp2_layer15_router -->
<g id="edge2387" class="edge">
<title>dp3_pp2_layer15_attn_allreduce&#45;&gt;dp3_pp2_layer15_router</title>
<path fill="none" stroke="black" d="M250826.08,-392.38C250714.77,-399.9 250562.89,-409.76 250429,-417.06 249793.5,-451.72 249040.28,-482.59 248688.96,-496.4"/>
<polygon fill="black" stroke="black" points="248688.8,-492.91 248678.94,-496.79 248689.07,-499.9 248688.8,-492.91"/>
</g>
<!-- dp3_pp2_layer15_attn_tp1 -->
<g id="node1431" class="node">
<title>dp3_pp2_layer15_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="251272.5,-531.06 251007.5,-531.06 251007.5,-479.06 251272.5,-479.06 251272.5,-531.06"/>
<text text-anchor="middle" x="251140" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="251140" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="251140" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="251140" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer15_attn_tp1&#45;&gt;dp3_pp2_layer15_attn_allreduce -->
<g id="edge2352" class="edge">
<title>dp3_pp2_layer15_attn_tp1&#45;&gt;dp3_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M251108.46,-478.92C251087.99,-462.6 251060.83,-440.94 251037.29,-422.18"/>
<polygon fill="black" stroke="black" points="251039.46,-419.44 251029.46,-415.94 251035.1,-424.91 251039.46,-419.44"/>
</g>
<!-- dp3_pp2_layer15_attn_tp2 -->
<g id="node1432" class="node">
<title>dp3_pp2_layer15_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="250706.5,-531.06 250441.5,-531.06 250441.5,-479.06 250706.5,-479.06 250706.5,-531.06"/>
<text text-anchor="middle" x="250574" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="250574" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="250574" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="250574" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer15_attn_tp2&#45;&gt;dp3_pp2_layer15_attn_allreduce -->
<g id="edge2353" class="edge">
<title>dp3_pp2_layer15_attn_tp2&#45;&gt;dp3_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M250640.07,-479.02C250663.85,-470.35 250690.99,-460.86 250716,-453.06 250764.74,-437.86 250819.05,-423.03 250866.1,-410.83"/>
<polygon fill="black" stroke="black" points="250867.22,-414.15 250876.03,-408.26 250865.47,-407.38 250867.22,-414.15"/>
</g>
<!-- dp3_pp2_layer15_attn_tp3 -->
<g id="node1433" class="node">
<title>dp3_pp2_layer15_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="251555.5,-531.06 251290.5,-531.06 251290.5,-479.06 251555.5,-479.06 251555.5,-531.06"/>
<text text-anchor="middle" x="251423" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="251423" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="251423" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="251423" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer15_attn_tp3&#45;&gt;dp3_pp2_layer15_attn_allreduce -->
<g id="edge2354" class="edge">
<title>dp3_pp2_layer15_attn_tp3&#45;&gt;dp3_pp2_layer15_attn_allreduce</title>
<path fill="none" stroke="black" d="M251358.21,-478.95C251334.43,-470.18 251307.17,-460.64 251282,-453.06 251227.42,-436.63 251166.31,-421.31 251113.86,-409.08"/>
<polygon fill="black" stroke="black" points="251114.37,-405.6 251103.83,-406.75 251112.78,-412.42 251114.37,-405.6"/>
</g>
<!-- dp3_pp2_layer15_expert0 -->
<g id="node1435" class="node">
<title>dp3_pp2_layer15_expert0</title>
<polygon fill="lightgreen" stroke="black" points="246787,-406.29 246563,-406.29 246563,-354.29 246787,-354.29 246787,-406.29"/>
<text text-anchor="middle" x="246675" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="246675" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="246675" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="246675" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert0 -->
<g id="edge2355" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248287.73,-499.65C247902.55,-490.26 247077.11,-465.13 246796,-417.06 246783.99,-415.01 246771.48,-412.16 246759.27,-408.95"/>
<polygon fill="black" stroke="black" points="246760.11,-405.56 246749.54,-406.32 246758.28,-412.31 246760.11,-405.56"/>
</g>
<!-- dp3_pp2_layer15_expert1 -->
<g id="node1436" class="node">
<title>dp3_pp2_layer15_expert1</title>
<polygon fill="lightgreen" stroke="black" points="247029,-406.29 246805,-406.29 246805,-354.29 247029,-354.29 247029,-406.29"/>
<text text-anchor="middle" x="246917" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="246917" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="246917" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="246917" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert1 -->
<g id="edge2356" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248285.55,-497.55C247943.94,-485.71 247271.58,-458.03 247038,-417.06 247026.08,-414.97 247013.67,-412.12 247001.54,-408.93"/>
<polygon fill="black" stroke="black" points="247002.45,-405.55 246991.89,-406.3 247000.62,-412.3 247002.45,-405.55"/>
</g>
<!-- dp3_pp2_layer15_expert2 -->
<g id="node1437" class="node">
<title>dp3_pp2_layer15_expert2</title>
<polygon fill="lightgreen" stroke="black" points="247271,-406.29 247047,-406.29 247047,-354.29 247271,-354.29 247271,-406.29"/>
<text text-anchor="middle" x="247159" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="247159" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="247159" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="247159" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert2 -->
<g id="edge2357" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248290.82,-502.85C248049.66,-498.37 247632.02,-480.97 247280,-417.06 247268.38,-414.95 247256.29,-412.14 247244.44,-409.03"/>
<polygon fill="black" stroke="black" points="247245.13,-405.59 247234.56,-406.34 247243.29,-412.34 247245.13,-405.59"/>
</g>
<!-- dp3_pp2_layer15_expert3 -->
<g id="node1438" class="node">
<title>dp3_pp2_layer15_expert3</title>
<polygon fill="lightgreen" stroke="black" points="247513,-406.29 247289,-406.29 247289,-354.29 247513,-354.29 247513,-406.29"/>
<text text-anchor="middle" x="247401" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="247401" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="247401" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="247401" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert3 -->
<g id="edge2358" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248285.36,-497.41C248088.31,-488.25 247782.63,-466.79 247522,-417.06 247510.57,-414.88 247498.67,-412.06 247486.99,-408.97"/>
<polygon fill="black" stroke="black" points="247487.82,-405.57 247477.25,-406.31 247485.98,-412.32 247487.82,-405.57"/>
</g>
<!-- dp3_pp2_layer15_expert4 -->
<g id="node1439" class="node">
<title>dp3_pp2_layer15_expert4</title>
<polygon fill="lightgreen" stroke="black" points="247755,-406.29 247531,-406.29 247531,-354.29 247755,-354.29 247755,-406.29"/>
<text text-anchor="middle" x="247643" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="247643" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="247643" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="247643" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert4 -->
<g id="edge2359" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248276.43,-487.98C248130.99,-474.71 247934.64,-452.25 247764,-417.06 247753.05,-414.8 247741.65,-412.02 247730.43,-409.02"/>
<polygon fill="black" stroke="black" points="247731.19,-405.6 247720.62,-406.33 247729.34,-412.35 247731.19,-405.6"/>
</g>
<!-- dp3_pp2_layer15_expert5 -->
<g id="node1440" class="node">
<title>dp3_pp2_layer15_expert5</title>
<polygon fill="lightgreen" stroke="black" points="247997,-406.29 247773,-406.29 247773,-354.29 247997,-354.29 247997,-406.29"/>
<text text-anchor="middle" x="247885" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="247885" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="247885" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="247885" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert5 -->
<g id="edge2360" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248256.29,-467.38C248176.5,-453.44 248087,-436.25 248006,-417.06 247995.9,-414.67 247985.4,-411.94 247974.99,-409.07"/>
<polygon fill="black" stroke="black" points="247975.62,-405.62 247965.05,-406.3 247973.74,-412.36 247975.62,-405.62"/>
</g>
<!-- dp3_pp2_layer15_expert6 -->
<g id="node1441" class="node">
<title>dp3_pp2_layer15_expert6</title>
<polygon fill="lightgreen" stroke="black" points="248239,-406.29 248015,-406.29 248015,-354.29 248239,-354.29 248239,-406.29"/>
<text text-anchor="middle" x="248127" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="248127" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="248127" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="248127" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert6 -->
<g id="edge2361" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248338.94,-452.97C248295.16,-438.16 248248.94,-422.53 248210.87,-409.66"/>
<polygon fill="black" stroke="black" points="248211.97,-406.33 248201.38,-406.45 248209.73,-412.97 248211.97,-406.33"/>
</g>
<!-- dp3_pp2_layer15_expert7 -->
<g id="node1442" class="node">
<title>dp3_pp2_layer15_expert7</title>
<polygon fill="lightgreen" stroke="black" points="248481,-406.29 248257,-406.29 248257,-354.29 248481,-354.29 248481,-406.29"/>
<text text-anchor="middle" x="248369" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="248369" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="248369" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="248369" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert7 -->
<g id="edge2362" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248439.38,-452.71C248426.3,-439.43 248412.58,-425.51 248400.76,-413.52"/>
<polygon fill="black" stroke="black" points="248403.19,-411 248393.68,-406.33 248398.2,-415.91 248403.19,-411"/>
</g>
<!-- dp3_pp2_layer15_expert8 -->
<g id="node1443" class="node">
<title>dp3_pp2_layer15_expert8</title>
<polygon fill="lightgreen" stroke="black" points="248723,-406.29 248499,-406.29 248499,-354.29 248723,-354.29 248723,-406.29"/>
<text text-anchor="middle" x="248611" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="248611" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="248611" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="248611" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert8 -->
<g id="edge2363" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248540.61,-452.71C248553.7,-439.43 248567.42,-425.51 248579.23,-413.52"/>
<polygon fill="black" stroke="black" points="248581.79,-415.91 248586.32,-406.33 248576.81,-411 248581.79,-415.91"/>
</g>
<!-- dp3_pp2_layer15_expert9 -->
<g id="node1444" class="node">
<title>dp3_pp2_layer15_expert9</title>
<polygon fill="lightgreen" stroke="black" points="248965,-406.29 248741,-406.29 248741,-354.29 248965,-354.29 248965,-406.29"/>
<text text-anchor="middle" x="248853" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="248853" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="248853" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="248853" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert9 -->
<g id="edge2364" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248637.38,-454.21C248682.29,-439.03 248730.08,-422.86 248769.23,-409.62"/>
<polygon fill="black" stroke="black" points="248770.64,-412.84 248778.99,-406.32 248768.4,-406.21 248770.64,-412.84"/>
</g>
<!-- dp3_pp2_layer15_expert10 -->
<g id="node1445" class="node">
<title>dp3_pp2_layer15_expert10</title>
<polygon fill="lightgreen" stroke="black" points="249207,-406.29 248983,-406.29 248983,-354.29 249207,-354.29 249207,-406.29"/>
<text text-anchor="middle" x="249095" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="249095" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="249095" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="249095" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert10 -->
<g id="edge2365" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248660.89,-478.04C248753.98,-462.69 248870.88,-441.49 248974,-417.06 248984.09,-414.67 248994.6,-411.94 249005.01,-409.07"/>
<polygon fill="black" stroke="black" points="249006.26,-412.36 249014.95,-406.3 249004.37,-405.62 249006.26,-412.36"/>
</g>
<!-- dp3_pp2_layer15_expert11 -->
<g id="node1446" class="node">
<title>dp3_pp2_layer15_expert11</title>
<polygon fill="lightgreen" stroke="black" points="249449,-406.29 249225,-406.29 249225,-354.29 249449,-354.29 249449,-406.29"/>
<text text-anchor="middle" x="249337" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="249337" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="249337" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="249337" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert11 -->
<g id="edge2366" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248672.99,-490.7C248820.62,-477.88 249033.08,-454.78 249216,-417.06 249226.95,-414.8 249238.35,-412.02 249249.57,-409.02"/>
<polygon fill="black" stroke="black" points="249250.66,-412.35 249259.38,-406.33 249248.81,-405.6 249250.66,-412.35"/>
</g>
<!-- dp3_pp2_layer15_expert12 -->
<g id="node1447" class="node">
<title>dp3_pp2_layer15_expert12</title>
<polygon fill="lightgreen" stroke="black" points="249691,-406.29 249467,-406.29 249467,-354.29 249691,-354.29 249691,-406.29"/>
<text text-anchor="middle" x="249579" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="249579" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="249579" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="249579" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert12 -->
<g id="edge2367" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248680.27,-498.07C248876.59,-489.29 249190.95,-468.01 249458,-417.06 249469.43,-414.88 249481.33,-412.06 249493.01,-408.97"/>
<polygon fill="black" stroke="black" points="249494.02,-412.32 249502.75,-406.31 249492.18,-405.57 249494.02,-412.32"/>
</g>
<!-- dp3_pp2_layer15_expert13 -->
<g id="node1448" class="node">
<title>dp3_pp2_layer15_expert13</title>
<polygon fill="lightgreen" stroke="black" points="249933,-406.29 249709,-406.29 249709,-354.29 249933,-354.29 249933,-406.29"/>
<text text-anchor="middle" x="249821" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="249821" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="249821" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="249821" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert13 -->
<g id="edge2368" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248684.93,-502.93C248925.42,-498.58 249345.9,-481.35 249700,-417.06 249711.62,-414.95 249723.71,-412.14 249735.56,-409.03"/>
<polygon fill="black" stroke="black" points="249736.7,-412.34 249745.44,-406.34 249734.87,-405.59 249736.7,-412.34"/>
</g>
<!-- dp3_pp2_layer15_expert14 -->
<g id="node1449" class="node">
<title>dp3_pp2_layer15_expert14</title>
<polygon fill="lightgreen" stroke="black" points="250175,-406.29 249951,-406.29 249951,-354.29 250175,-354.29 250175,-406.29"/>
<text text-anchor="middle" x="250063" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="250063" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="250063" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="250063" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert14 -->
<g id="edge2369" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248680.32,-498.04C249017.17,-486.48 249705.15,-458.6 249942,-417.06 249953.92,-414.97 249966.32,-412.12 249978.46,-408.93"/>
<polygon fill="black" stroke="black" points="249979.38,-412.3 249988.11,-406.3 249977.54,-405.55 249979.38,-412.3"/>
</g>
<!-- dp3_pp2_layer15_expert15 -->
<g id="node1450" class="node">
<title>dp3_pp2_layer15_expert15</title>
<polygon fill="lightgreen" stroke="black" points="250417,-406.29 250193,-406.29 250193,-354.29 250417,-354.29 250417,-406.29"/>
<text text-anchor="middle" x="250305" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="250305" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="250305" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="250305" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert15 -->
<g id="edge2370" class="edge">
<title>dp3_pp2_layer15_router&#45;&gt;dp3_pp2_layer15_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248681.94,-499.9C249062.49,-490.72 249900.35,-465.57 250184,-417.06 250196.01,-415.01 250208.51,-412.16 250220.73,-408.95"/>
<polygon fill="black" stroke="black" points="250221.72,-412.31 250230.45,-406.32 250219.88,-405.56 250221.72,-412.31"/>
</g>
<!-- dp3_pp2_layer15_expert_agg -->
<g id="node1451" class="node">
<title>dp3_pp2_layer15_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="248737.57,-307.52 248343.74,-307.52 248242.43,-203.52 248636.26,-203.52 248737.57,-307.52"/>
<text text-anchor="middle" x="248490" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="248490" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="248490" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="248490" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer15_expert0&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2371" class="edge">
<title>dp3_pp2_layer15_expert0&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M246733.07,-354.29C246752.69,-346.92 246774.97,-339.72 246796,-335.52 247075.13,-279.86 247898.93,-263.21 248285.43,-258.4"/>
<polygon fill="black" stroke="black" points="248285.65,-261.9 248295.61,-258.27 248285.57,-254.9 248285.65,-261.9"/>
</g>
<!-- dp3_pp2_layer15_expert1&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2372" class="edge">
<title>dp3_pp2_layer15_expert1&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M246975.39,-354.27C246994.95,-346.95 247017.09,-339.78 247038,-335.52 247270.8,-288.16 247946.09,-267.74 248287.43,-260.24"/>
<polygon fill="black" stroke="black" points="248287.51,-263.74 248297.43,-260.03 248287.35,-256.74 248287.51,-263.74"/>
</g>
<!-- dp3_pp2_layer15_expert2&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2373" class="edge">
<title>dp3_pp2_layer15_expert2&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M247217.73,-354.29C247237.21,-347.01 247259.23,-339.87 247280,-335.52 247466.91,-296.44 247996.54,-273.07 248289.3,-262.78"/>
<polygon fill="black" stroke="black" points="248289.74,-266.27 248299.61,-262.42 248289.5,-259.27 248289.74,-266.27"/>
</g>
<!-- dp3_pp2_layer15_expert3&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2374" class="edge">
<title>dp3_pp2_layer15_expert3&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M247460.39,-354.26C247479.72,-347.07 247501.48,-339.99 247522,-335.52 247780.91,-279.18 248086.7,-262.24 248284.26,-257.56"/>
<polygon fill="black" stroke="black" points="248284.55,-261.06 248294.47,-257.33 248284.39,-254.06 248284.55,-261.06"/>
</g>
<!-- dp3_pp2_layer15_expert4&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2375" class="edge">
<title>dp3_pp2_layer15_expert4&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M247703.39,-354.24C247722.49,-347.2 247743.87,-340.19 247764,-335.52 247939.82,-294.77 248144.6,-274.91 248291.75,-265.31"/>
<polygon fill="black" stroke="black" points="248292.05,-268.8 248301.81,-264.67 248291.6,-261.82 248292.05,-268.8"/>
</g>
<!-- dp3_pp2_layer15_expert5&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2376" class="edge">
<title>dp3_pp2_layer15_expert5&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M247947.42,-354.22C247966.04,-347.42 247986.65,-340.55 248006,-335.52 248103.09,-310.27 248213.34,-291.53 248304.07,-278.65"/>
<polygon fill="black" stroke="black" points="248304.78,-282.09 248314.19,-277.23 248303.8,-275.16 248304.78,-282.09"/>
</g>
<!-- dp3_pp2_layer15_expert6&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2377" class="edge">
<title>dp3_pp2_layer15_expert6&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M248195.02,-354.26C248212.26,-348.03 248230.78,-341.44 248248,-335.52 248274.73,-326.33 248303.21,-316.8 248330.89,-307.67"/>
<polygon fill="black" stroke="black" points="248332.24,-310.91 248340.65,-304.46 248330.06,-304.26 248332.24,-310.91"/>
</g>
<!-- dp3_pp2_layer15_expert7&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2378" class="edge">
<title>dp3_pp2_layer15_expert7&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M248393.78,-354.15C248405.02,-342.74 248418.83,-328.73 248432.45,-314.92"/>
<polygon fill="black" stroke="black" points="248435,-317.31 248439.53,-307.73 248430.02,-312.39 248435,-317.31"/>
</g>
<!-- dp3_pp2_layer15_expert8&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2379" class="edge">
<title>dp3_pp2_layer15_expert8&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M248586.22,-354.15C248574.97,-342.74 248561.16,-328.73 248547.55,-314.92"/>
<polygon fill="black" stroke="black" points="248549.98,-312.39 248540.47,-307.73 248544.99,-317.31 248549.98,-312.39"/>
</g>
<!-- dp3_pp2_layer15_expert9&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2380" class="edge">
<title>dp3_pp2_layer15_expert9&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M248784.98,-354.26C248767.73,-348.03 248749.21,-341.44 248732,-335.52 248708.29,-327.37 248683.21,-318.95 248658.53,-310.78"/>
<polygon fill="black" stroke="black" points="248659.32,-307.36 248648.73,-307.54 248657.12,-314 248659.32,-307.36"/>
</g>
<!-- dp3_pp2_layer15_expert10&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2381" class="edge">
<title>dp3_pp2_layer15_expert10&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M249032.58,-354.22C249013.96,-347.42 248993.35,-340.55 248974,-335.52 248893.99,-314.71 248805.05,-298.33 248725.46,-286"/>
<polygon fill="black" stroke="black" points="248725.71,-282.5 248715.3,-284.44 248724.65,-289.41 248725.71,-282.5"/>
</g>
<!-- dp3_pp2_layer15_expert11&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2382" class="edge">
<title>dp3_pp2_layer15_expert11&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M249276.61,-354.24C249257.51,-347.2 249236.13,-340.19 249216,-335.52 249047.74,-296.53 248852.97,-276.66 248707.55,-266.61"/>
<polygon fill="black" stroke="black" points="248707.38,-263.09 248697.16,-265.9 248706.9,-270.07 248707.38,-263.09"/>
</g>
<!-- dp3_pp2_layer15_expert12&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2383" class="edge">
<title>dp3_pp2_layer15_expert12&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M249519.61,-354.26C249500.28,-347.07 249478.52,-339.99 249458,-335.52 249200.51,-279.49 248896.64,-262.43 248698.99,-257.64"/>
<polygon fill="black" stroke="black" points="248698.86,-254.14 248688.78,-257.4 248698.69,-261.13 248698.86,-254.14"/>
</g>
<!-- dp3_pp2_layer15_expert13&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2384" class="edge">
<title>dp3_pp2_layer15_expert13&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M249762.27,-354.29C249742.79,-347.01 249720.77,-339.87 249700,-335.52 249516.02,-297.05 248999.97,-273.81 248704.63,-263.27"/>
<polygon fill="black" stroke="black" points="248704.33,-259.76 248694.21,-262.9 248704.08,-266.76 248704.33,-259.76"/>
</g>
<!-- dp3_pp2_layer15_expert14&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2385" class="edge">
<title>dp3_pp2_layer15_expert14&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M250004.6,-354.27C249985.05,-346.95 249962.9,-339.78 249942,-335.52 249711.27,-288.58 249045.86,-268.1 248701.74,-260.45"/>
<polygon fill="black" stroke="black" points="248701.73,-256.94 248691.65,-260.22 248701.57,-263.94 248701.73,-256.94"/>
</g>
<!-- dp3_pp2_layer15_expert15&#45;&gt;dp3_pp2_layer15_expert_agg -->
<g id="edge2386" class="edge">
<title>dp3_pp2_layer15_expert15&#45;&gt;dp3_pp2_layer15_expert_agg</title>
<path fill="none" stroke="black" d="M250246.93,-354.29C250227.3,-346.92 250205.03,-339.72 250184,-335.52 249906.21,-280.12 249088.98,-263.37 248700.17,-258.47"/>
<polygon fill="black" stroke="black" points="248699.97,-254.97 248689.93,-258.34 248699.88,-261.97 248699.97,-254.97"/>
</g>
<!-- dp3_pp2_layer16_attn_tp0 -->
<g id="node1452" class="node">
<title>dp3_pp2_layer16_attn_tp0</title>
<polygon fill="lightgreen" stroke="black" points="245972.5,-531.06 245707.5,-531.06 245707.5,-479.06 245972.5,-479.06 245972.5,-531.06"/>
<text text-anchor="middle" x="245840" y="-519.06" font-family="Arial" font-size="10.00">Attention TP0</text>
<text text-anchor="middle" x="245840" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="245840" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="245840" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer15_expert_agg&#45;&gt;dp3_pp2_layer16_attn_tp0 -->
<g id="edge2388" class="edge">
<title>dp3_pp2_layer15_expert_agg&#45;&gt;dp3_pp2_layer16_attn_tp0</title>
<path fill="none" stroke="black" d="M248297.78,-260.41C247877.38,-269.54 246887.17,-294.77 246554,-335.52 246521.8,-339.46 246013.23,-444.29 245982,-453.06 245959.37,-459.41 245935.16,-467.58 245913.26,-475.5"/>
<polygon fill="black" stroke="black" points="245911.89,-472.28 245903.7,-479 245914.29,-478.85 245911.89,-472.28"/>
</g>
<!-- dp3_pp2_layer16_attn_allreduce -->
<g id="node1453" class="node">
<title>dp3_pp2_layer16_attn_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="245969" cy="-380.29" rx="169" ry="36.54"/>
<text text-anchor="middle" x="245969" y="-394.29" font-family="Arial" font-size="10.00">AllReduce Attention</text>
<text text-anchor="middle" x="245969" y="-383.29" font-family="Arial" font-size="10.00">GPUs 112&#45;115</text>
<text text-anchor="middle" x="245969" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="245969" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_attn_tp0&#45;&gt;dp3_pp2_layer16_attn_allreduce -->
<g id="edge2389" class="edge">
<title>dp3_pp2_layer16_attn_tp0&#45;&gt;dp3_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M245866.41,-478.92C245883.15,-463 245905.21,-442 245924.58,-423.56"/>
<polygon fill="black" stroke="black" points="245927.03,-426.07 245931.86,-416.64 245922.2,-421 245927.03,-426.07"/>
</g>
<!-- dp3_pp2_layer16_router -->
<g id="node1457" class="node">
<title>dp3_pp2_layer16_router</title>
<polygon fill="lightyellow" stroke="black" points="243720.57,-557.06 243326.74,-557.06 243225.43,-453.06 243619.26,-453.06 243720.57,-557.06"/>
<text text-anchor="middle" x="243473" y="-519.06" font-family="Arial" font-size="10.00">Router</text>
<text text-anchor="middle" x="243473" y="-508.06" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="243473" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="243473" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_attn_allreduce&#45;&gt;dp3_pp2_layer16_router -->
<g id="edge2425" class="edge">
<title>dp3_pp2_layer16_attn_allreduce&#45;&gt;dp3_pp2_layer16_router</title>
<path fill="none" stroke="black" d="M245809.08,-392.38C245697.77,-399.9 245545.89,-409.76 245412,-417.06 244776.5,-451.72 244023.28,-482.59 243671.96,-496.4"/>
<polygon fill="black" stroke="black" points="243671.8,-492.91 243661.94,-496.79 243672.07,-499.9 243671.8,-492.91"/>
</g>
<!-- dp3_pp2_layer16_attn_tp1 -->
<g id="node1454" class="node">
<title>dp3_pp2_layer16_attn_tp1</title>
<polygon fill="lightgreen" stroke="black" points="246255.5,-531.06 245990.5,-531.06 245990.5,-479.06 246255.5,-479.06 246255.5,-531.06"/>
<text text-anchor="middle" x="246123" y="-519.06" font-family="Arial" font-size="10.00">Attention TP1</text>
<text text-anchor="middle" x="246123" y="-508.06" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="246123" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="246123" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer16_attn_tp1&#45;&gt;dp3_pp2_layer16_attn_allreduce -->
<g id="edge2390" class="edge">
<title>dp3_pp2_layer16_attn_tp1&#45;&gt;dp3_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M246091.46,-478.92C246070.99,-462.6 246043.83,-440.94 246020.29,-422.18"/>
<polygon fill="black" stroke="black" points="246022.46,-419.44 246012.46,-415.94 246018.1,-424.91 246022.46,-419.44"/>
</g>
<!-- dp3_pp2_layer16_attn_tp2 -->
<g id="node1455" class="node">
<title>dp3_pp2_layer16_attn_tp2</title>
<polygon fill="lightgreen" stroke="black" points="245689.5,-531.06 245424.5,-531.06 245424.5,-479.06 245689.5,-479.06 245689.5,-531.06"/>
<text text-anchor="middle" x="245557" y="-519.06" font-family="Arial" font-size="10.00">Attention TP2</text>
<text text-anchor="middle" x="245557" y="-508.06" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="245557" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="245557" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer16_attn_tp2&#45;&gt;dp3_pp2_layer16_attn_allreduce -->
<g id="edge2391" class="edge">
<title>dp3_pp2_layer16_attn_tp2&#45;&gt;dp3_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M245623.07,-479.02C245646.85,-470.35 245673.99,-460.86 245699,-453.06 245747.74,-437.86 245802.05,-423.03 245849.1,-410.83"/>
<polygon fill="black" stroke="black" points="245850.22,-414.15 245859.03,-408.26 245848.47,-407.38 245850.22,-414.15"/>
</g>
<!-- dp3_pp2_layer16_attn_tp3 -->
<g id="node1456" class="node">
<title>dp3_pp2_layer16_attn_tp3</title>
<polygon fill="lightgreen" stroke="black" points="246538.5,-531.06 246273.5,-531.06 246273.5,-479.06 246538.5,-479.06 246538.5,-531.06"/>
<text text-anchor="middle" x="246406" y="-519.06" font-family="Arial" font-size="10.00">Attention TP3</text>
<text text-anchor="middle" x="246406" y="-508.06" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="246406" y="-497.06" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
<text text-anchor="middle" x="246406" y="-486.06" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, heads=4, d_k=32]</text>
</g>
<!-- dp3_pp2_layer16_attn_tp3&#45;&gt;dp3_pp2_layer16_attn_allreduce -->
<g id="edge2392" class="edge">
<title>dp3_pp2_layer16_attn_tp3&#45;&gt;dp3_pp2_layer16_attn_allreduce</title>
<path fill="none" stroke="black" d="M246341.21,-478.95C246317.43,-470.18 246290.17,-460.64 246265,-453.06 246210.42,-436.63 246149.31,-421.31 246096.86,-409.08"/>
<polygon fill="black" stroke="black" points="246097.37,-405.6 246086.83,-406.75 246095.78,-412.42 246097.37,-405.6"/>
</g>
<!-- dp3_pp2_layer16_expert0 -->
<g id="node1458" class="node">
<title>dp3_pp2_layer16_expert0</title>
<polygon fill="lightgreen" stroke="black" points="241770,-406.29 241546,-406.29 241546,-354.29 241770,-354.29 241770,-406.29"/>
<text text-anchor="middle" x="241658" y="-394.29" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="241658" y="-383.29" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="241658" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="241658" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert0 -->
<g id="edge2393" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243270.73,-499.65C242885.55,-490.26 242060.11,-465.13 241779,-417.06 241766.99,-415.01 241754.48,-412.16 241742.27,-408.95"/>
<polygon fill="black" stroke="black" points="241743.11,-405.56 241732.54,-406.32 241741.28,-412.31 241743.11,-405.56"/>
</g>
<!-- dp3_pp2_layer16_expert1 -->
<g id="node1459" class="node">
<title>dp3_pp2_layer16_expert1</title>
<polygon fill="lightgreen" stroke="black" points="242012,-406.29 241788,-406.29 241788,-354.29 242012,-354.29 242012,-406.29"/>
<text text-anchor="middle" x="241900" y="-394.29" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="241900" y="-383.29" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="241900" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="241900" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert1 -->
<g id="edge2394" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243268.55,-497.55C242926.94,-485.71 242254.58,-458.03 242021,-417.06 242009.08,-414.97 241996.67,-412.12 241984.54,-408.93"/>
<polygon fill="black" stroke="black" points="241985.45,-405.55 241974.89,-406.3 241983.62,-412.3 241985.45,-405.55"/>
</g>
<!-- dp3_pp2_layer16_expert2 -->
<g id="node1460" class="node">
<title>dp3_pp2_layer16_expert2</title>
<polygon fill="lightgreen" stroke="black" points="242254,-406.29 242030,-406.29 242030,-354.29 242254,-354.29 242254,-406.29"/>
<text text-anchor="middle" x="242142" y="-394.29" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="242142" y="-383.29" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="242142" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="242142" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert2 -->
<g id="edge2395" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243273.82,-502.85C243032.66,-498.37 242615.02,-480.97 242263,-417.06 242251.38,-414.95 242239.29,-412.14 242227.44,-409.03"/>
<polygon fill="black" stroke="black" points="242228.13,-405.59 242217.56,-406.34 242226.29,-412.34 242228.13,-405.59"/>
</g>
<!-- dp3_pp2_layer16_expert3 -->
<g id="node1461" class="node">
<title>dp3_pp2_layer16_expert3</title>
<polygon fill="lightgreen" stroke="black" points="242496,-406.29 242272,-406.29 242272,-354.29 242496,-354.29 242496,-406.29"/>
<text text-anchor="middle" x="242384" y="-394.29" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="242384" y="-383.29" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="242384" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="242384" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert3 -->
<g id="edge2396" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243268.36,-497.41C243071.31,-488.25 242765.63,-466.79 242505,-417.06 242493.57,-414.88 242481.67,-412.06 242469.99,-408.97"/>
<polygon fill="black" stroke="black" points="242470.82,-405.57 242460.25,-406.31 242468.98,-412.32 242470.82,-405.57"/>
</g>
<!-- dp3_pp2_layer16_expert4 -->
<g id="node1462" class="node">
<title>dp3_pp2_layer16_expert4</title>
<polygon fill="lightgreen" stroke="black" points="242738,-406.29 242514,-406.29 242514,-354.29 242738,-354.29 242738,-406.29"/>
<text text-anchor="middle" x="242626" y="-394.29" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="242626" y="-383.29" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="242626" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="242626" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert4 -->
<g id="edge2397" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243259.43,-487.98C243113.99,-474.71 242917.64,-452.25 242747,-417.06 242736.05,-414.8 242724.65,-412.02 242713.43,-409.02"/>
<polygon fill="black" stroke="black" points="242714.19,-405.6 242703.62,-406.33 242712.34,-412.35 242714.19,-405.6"/>
</g>
<!-- dp3_pp2_layer16_expert5 -->
<g id="node1463" class="node">
<title>dp3_pp2_layer16_expert5</title>
<polygon fill="lightgreen" stroke="black" points="242980,-406.29 242756,-406.29 242756,-354.29 242980,-354.29 242980,-406.29"/>
<text text-anchor="middle" x="242868" y="-394.29" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="242868" y="-383.29" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="242868" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="242868" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert5 -->
<g id="edge2398" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243239.29,-467.38C243159.5,-453.44 243070,-436.25 242989,-417.06 242978.9,-414.67 242968.4,-411.94 242957.99,-409.07"/>
<polygon fill="black" stroke="black" points="242958.62,-405.62 242948.05,-406.3 242956.74,-412.36 242958.62,-405.62"/>
</g>
<!-- dp3_pp2_layer16_expert6 -->
<g id="node1464" class="node">
<title>dp3_pp2_layer16_expert6</title>
<polygon fill="lightgreen" stroke="black" points="243222,-406.29 242998,-406.29 242998,-354.29 243222,-354.29 243222,-406.29"/>
<text text-anchor="middle" x="243110" y="-394.29" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="243110" y="-383.29" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="243110" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="243110" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert6 -->
<g id="edge2399" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243321.94,-452.97C243278.16,-438.16 243231.94,-422.53 243193.87,-409.66"/>
<polygon fill="black" stroke="black" points="243194.97,-406.33 243184.38,-406.45 243192.73,-412.97 243194.97,-406.33"/>
</g>
<!-- dp3_pp2_layer16_expert7 -->
<g id="node1465" class="node">
<title>dp3_pp2_layer16_expert7</title>
<polygon fill="lightgreen" stroke="black" points="243464,-406.29 243240,-406.29 243240,-354.29 243464,-354.29 243464,-406.29"/>
<text text-anchor="middle" x="243352" y="-394.29" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="243352" y="-383.29" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="243352" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="243352" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert7 -->
<g id="edge2400" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243422.38,-452.71C243409.3,-439.43 243395.58,-425.51 243383.76,-413.52"/>
<polygon fill="black" stroke="black" points="243386.19,-411 243376.68,-406.33 243381.2,-415.91 243386.19,-411"/>
</g>
<!-- dp3_pp2_layer16_expert8 -->
<g id="node1466" class="node">
<title>dp3_pp2_layer16_expert8</title>
<polygon fill="lightgreen" stroke="black" points="243706,-406.29 243482,-406.29 243482,-354.29 243706,-354.29 243706,-406.29"/>
<text text-anchor="middle" x="243594" y="-394.29" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="243594" y="-383.29" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="243594" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="243594" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert8 -->
<g id="edge2401" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243523.61,-452.71C243536.7,-439.43 243550.42,-425.51 243562.23,-413.52"/>
<polygon fill="black" stroke="black" points="243564.79,-415.91 243569.32,-406.33 243559.81,-411 243564.79,-415.91"/>
</g>
<!-- dp3_pp2_layer16_expert9 -->
<g id="node1467" class="node">
<title>dp3_pp2_layer16_expert9</title>
<polygon fill="lightgreen" stroke="black" points="243948,-406.29 243724,-406.29 243724,-354.29 243948,-354.29 243948,-406.29"/>
<text text-anchor="middle" x="243836" y="-394.29" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="243836" y="-383.29" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="243836" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="243836" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert9 -->
<g id="edge2402" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243620.38,-454.21C243665.29,-439.03 243713.08,-422.86 243752.23,-409.62"/>
<polygon fill="black" stroke="black" points="243753.64,-412.84 243761.99,-406.32 243751.4,-406.21 243753.64,-412.84"/>
</g>
<!-- dp3_pp2_layer16_expert10 -->
<g id="node1468" class="node">
<title>dp3_pp2_layer16_expert10</title>
<polygon fill="lightgreen" stroke="black" points="244190,-406.29 243966,-406.29 243966,-354.29 244190,-354.29 244190,-406.29"/>
<text text-anchor="middle" x="244078" y="-394.29" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="244078" y="-383.29" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="244078" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="244078" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert10 -->
<g id="edge2403" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243643.89,-478.04C243736.98,-462.69 243853.88,-441.49 243957,-417.06 243967.09,-414.67 243977.6,-411.94 243988.01,-409.07"/>
<polygon fill="black" stroke="black" points="243989.26,-412.36 243997.95,-406.3 243987.37,-405.62 243989.26,-412.36"/>
</g>
<!-- dp3_pp2_layer16_expert11 -->
<g id="node1469" class="node">
<title>dp3_pp2_layer16_expert11</title>
<polygon fill="lightgreen" stroke="black" points="244432,-406.29 244208,-406.29 244208,-354.29 244432,-354.29 244432,-406.29"/>
<text text-anchor="middle" x="244320" y="-394.29" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="244320" y="-383.29" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="244320" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="244320" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert11 -->
<g id="edge2404" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243655.99,-490.7C243803.62,-477.88 244016.08,-454.78 244199,-417.06 244209.95,-414.8 244221.35,-412.02 244232.57,-409.02"/>
<polygon fill="black" stroke="black" points="244233.66,-412.35 244242.38,-406.33 244231.81,-405.6 244233.66,-412.35"/>
</g>
<!-- dp3_pp2_layer16_expert12 -->
<g id="node1470" class="node">
<title>dp3_pp2_layer16_expert12</title>
<polygon fill="lightgreen" stroke="black" points="244674,-406.29 244450,-406.29 244450,-354.29 244674,-354.29 244674,-406.29"/>
<text text-anchor="middle" x="244562" y="-394.29" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="244562" y="-383.29" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="244562" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="244562" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert12 -->
<g id="edge2405" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243663.27,-498.07C243859.59,-489.29 244173.95,-468.01 244441,-417.06 244452.43,-414.88 244464.33,-412.06 244476.01,-408.97"/>
<polygon fill="black" stroke="black" points="244477.02,-412.32 244485.75,-406.31 244475.18,-405.57 244477.02,-412.32"/>
</g>
<!-- dp3_pp2_layer16_expert13 -->
<g id="node1471" class="node">
<title>dp3_pp2_layer16_expert13</title>
<polygon fill="lightgreen" stroke="black" points="244916,-406.29 244692,-406.29 244692,-354.29 244916,-354.29 244916,-406.29"/>
<text text-anchor="middle" x="244804" y="-394.29" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="244804" y="-383.29" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="244804" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="244804" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert13 -->
<g id="edge2406" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243667.93,-502.93C243908.42,-498.58 244328.9,-481.35 244683,-417.06 244694.62,-414.95 244706.71,-412.14 244718.56,-409.03"/>
<polygon fill="black" stroke="black" points="244719.7,-412.34 244728.44,-406.34 244717.87,-405.59 244719.7,-412.34"/>
</g>
<!-- dp3_pp2_layer16_expert14 -->
<g id="node1472" class="node">
<title>dp3_pp2_layer16_expert14</title>
<polygon fill="lightgreen" stroke="black" points="245158,-406.29 244934,-406.29 244934,-354.29 245158,-354.29 245158,-406.29"/>
<text text-anchor="middle" x="245046" y="-394.29" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="245046" y="-383.29" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="245046" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="245046" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert14 -->
<g id="edge2407" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243663.32,-498.04C244000.17,-486.48 244688.15,-458.6 244925,-417.06 244936.92,-414.97 244949.32,-412.12 244961.46,-408.93"/>
<polygon fill="black" stroke="black" points="244962.38,-412.3 244971.11,-406.3 244960.54,-405.55 244962.38,-412.3"/>
</g>
<!-- dp3_pp2_layer16_expert15 -->
<g id="node1473" class="node">
<title>dp3_pp2_layer16_expert15</title>
<polygon fill="lightgreen" stroke="black" points="245400,-406.29 245176,-406.29 245176,-354.29 245400,-354.29 245400,-406.29"/>
<text text-anchor="middle" x="245288" y="-394.29" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="245288" y="-383.29" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="245288" y="-372.29" font-family="Arial" font-size="10.00">Input: [batch_size=?, seq_len=?, hidden=512]</text>
<text text-anchor="middle" x="245288" y="-361.29" font-family="Arial" font-size="10.00">Output: [batch_size=?, seq_len=?, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert15 -->
<g id="edge2408" class="edge">
<title>dp3_pp2_layer16_router&#45;&gt;dp3_pp2_layer16_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243664.94,-499.9C244045.49,-490.72 244883.35,-465.57 245167,-417.06 245179.01,-415.01 245191.51,-412.16 245203.73,-408.95"/>
<polygon fill="black" stroke="black" points="245204.72,-412.31 245213.45,-406.32 245202.88,-405.56 245204.72,-412.31"/>
</g>
<!-- dp3_pp2_layer16_expert_agg -->
<g id="node1474" class="node">
<title>dp3_pp2_layer16_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="243599.57,-307.52 243205.74,-307.52 243104.43,-203.52 243498.26,-203.52 243599.57,-307.52"/>
<text text-anchor="middle" x="243352" y="-269.52" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="243352" y="-258.52" font-family="Arial" font-size="10.00">GPUs 112&#45;127</text>
<text text-anchor="middle" x="243352" y="-247.52" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="243352" y="-236.52" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_expert0&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2409" class="edge">
<title>dp3_pp2_layer16_expert0&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M241716.38,-354.21C241735.94,-346.89 241758.08,-339.73 241779,-335.52 242034.86,-284.02 242783.83,-265.4 243148.21,-259.26"/>
<polygon fill="black" stroke="black" points="243148.4,-262.76 243158.34,-259.09 243148.28,-255.76 243148.4,-262.76"/>
</g>
<!-- dp3_pp2_layer16_expert1&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2410" class="edge">
<title>dp3_pp2_layer16_expert1&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M241958.71,-354.21C241978.19,-346.94 242000.21,-339.8 242021,-335.52 242230.71,-292.32 242832.36,-270.3 243150,-261.41"/>
<polygon fill="black" stroke="black" points="243150.34,-264.9 243160.24,-261.13 243150.15,-257.91 243150.34,-264.9"/>
</g>
<!-- dp3_pp2_layer16_expert2&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2411" class="edge">
<title>dp3_pp2_layer16_expert2&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M242201.05,-354.26C242220.46,-347.03 242242.35,-339.92 242263,-335.52 242427.34,-300.54 242886.32,-276.12 243153.04,-264.41"/>
<polygon fill="black" stroke="black" points="243153.4,-267.9 243163.24,-263.97 243153.09,-260.91 243153.4,-267.9"/>
</g>
<!-- dp3_pp2_layer16_expert3&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2412" class="edge">
<title>dp3_pp2_layer16_expert3&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M242443.73,-354.28C242462.98,-347.15 242484.62,-340.08 242505,-335.52 242721.91,-287.01 242976.52,-268.23 243149.54,-261"/>
<polygon fill="black" stroke="black" points="243149.93,-264.48 243159.78,-260.58 243149.64,-257.49 243149.93,-264.48"/>
</g>
<!-- dp3_pp2_layer16_expert4&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2413" class="edge">
<title>dp3_pp2_layer16_expert4&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M242687.07,-354.28C242706.02,-347.32 242727.14,-340.35 242747,-335.52 242882.78,-302.51 243039.27,-282.55 243159.08,-270.95"/>
<polygon fill="black" stroke="black" points="243159.47,-274.42 243169.09,-269.99 243158.8,-267.46 243159.47,-274.42"/>
</g>
<!-- dp3_pp2_layer16_expert5&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2414" class="edge">
<title>dp3_pp2_layer16_expert5&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M242932.16,-354.29C242950.37,-347.69 242970.32,-340.91 242989,-335.52 243049.46,-318.09 243116.57,-302.47 243176.47,-289.81"/>
<polygon fill="black" stroke="black" points="243177.33,-293.21 243186.4,-287.73 243175.9,-286.36 243177.33,-293.21"/>
</g>
<!-- dp3_pp2_layer16_expert6&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2415" class="edge">
<title>dp3_pp2_layer16_expert6&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M243159.55,-354.15C243183.49,-342.01 243213.24,-326.92 243242.13,-312.26"/>
<polygon fill="black" stroke="black" points="243243.73,-315.37 243251.06,-307.73 243240.56,-309.13 243243.73,-315.37"/>
</g>
<!-- dp3_pp2_layer16_expert7&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2416" class="edge">
<title>dp3_pp2_layer16_expert7&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M243352,-354.15C243352,-343.58 243352,-330.77 243352,-317.96"/>
<polygon fill="black" stroke="black" points="243355.5,-317.73 243352,-307.73 243348.5,-317.73 243355.5,-317.73"/>
</g>
<!-- dp3_pp2_layer16_expert8&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2417" class="edge">
<title>dp3_pp2_layer16_expert8&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M243544.44,-354.15C243520.51,-342.01 243490.76,-326.92 243461.87,-312.26"/>
<polygon fill="black" stroke="black" points="243463.44,-309.13 243452.93,-307.73 243460.27,-315.37 243463.44,-309.13"/>
</g>
<!-- dp3_pp2_layer16_expert9&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2418" class="edge">
<title>dp3_pp2_layer16_expert9&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M243771.84,-354.29C243753.63,-347.69 243733.67,-340.91 243715,-335.52 243680.59,-325.6 243644.02,-316.27 243607.86,-307.73"/>
<polygon fill="black" stroke="black" points="243608.21,-304.22 243597.68,-305.35 243606.61,-311.03 243608.21,-304.22"/>
</g>
<!-- dp3_pp2_layer16_expert10&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2419" class="edge">
<title>dp3_pp2_layer16_expert10&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M244016.93,-354.28C243997.98,-347.32 243976.86,-340.35 243957,-335.52 243832.73,-305.31 243691.11,-286.03 243576.15,-274.08"/>
<polygon fill="black" stroke="black" points="243576.47,-270.6 243566.17,-273.05 243575.76,-277.56 243576.47,-270.6"/>
</g>
<!-- dp3_pp2_layer16_expert11&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2420" class="edge">
<title>dp3_pp2_layer16_expert11&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M244260.27,-354.28C244241.02,-347.15 244219.38,-340.08 244199,-335.52 243986.33,-287.95 243737.41,-268.98 243564.7,-261.43"/>
<polygon fill="black" stroke="black" points="243564.61,-257.93 243554.47,-261 243564.31,-264.92 243564.61,-257.93"/>
</g>
<!-- dp3_pp2_layer16_expert12&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2421" class="edge">
<title>dp3_pp2_layer16_expert12&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M244502.94,-354.26C244483.54,-347.03 244461.65,-339.92 244441,-335.52 244280.14,-301.28 243837.03,-277.16 243568.2,-265.18"/>
<polygon fill="black" stroke="black" points="243568.06,-261.67 243557.92,-264.72 243567.75,-268.66 243568.06,-261.67"/>
</g>
<!-- dp3_pp2_layer16_expert13&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2422" class="edge">
<title>dp3_pp2_layer16_expert13&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M244745.28,-354.21C244725.81,-346.94 244703.78,-339.8 244683,-335.52 244475.74,-292.82 243885.66,-270.82 243565.26,-261.73"/>
<polygon fill="black" stroke="black" points="243565.02,-258.22 243554.92,-261.44 243564.82,-265.22 243565.02,-258.22"/>
</g>
<!-- dp3_pp2_layer16_expert14&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2423" class="edge">
<title>dp3_pp2_layer16_expert14&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M244987.61,-354.21C244968.06,-346.89 244945.91,-339.73 244925,-335.52 244670.8,-284.35 243929.86,-265.64 243562.93,-259.38"/>
<polygon fill="black" stroke="black" points="243562.78,-255.88 243552.72,-259.21 243562.66,-262.88 243562.78,-255.88"/>
</g>
<!-- dp3_pp2_layer16_expert15&#45;&gt;dp3_pp2_layer16_expert_agg -->
<g id="edge2424" class="edge">
<title>dp3_pp2_layer16_expert15&#45;&gt;dp3_pp2_layer16_expert_agg</title>
<path fill="none" stroke="black" d="M245229.94,-354.25C245210.31,-346.88 245188.04,-339.68 245167,-335.52 244865.53,-275.89 243971.35,-261.27 243561.49,-257.68"/>
<polygon fill="black" stroke="black" points="243561.33,-254.18 243551.3,-257.6 243561.27,-261.18 243561.33,-254.18"/>
</g>
<!-- output_dp3 -->
<g id="node1482" class="node">
<title>output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="233454" cy="-130.75" rx="169" ry="36.54"/>
<text text-anchor="middle" x="233454" y="-144.75" font-family="Arial" font-size="10.00">Output DP3</text>
<text text-anchor="middle" x="233454" y="-133.75" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="233454" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="233454" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- dp3_pp2_layer16_expert_agg&#45;&gt;output_dp3 -->
<g id="edge2437" class="edge">
<title>dp3_pp2_layer16_expert_agg&#45;&gt;output_dp3</title>
<path fill="none" stroke="black" d="M243143.39,-243.62C242803.16,-226.36 242107.57,-193.32 241518,-179.52 239906.52,-141.81 234669.6,-133.29 233633.17,-131.96"/>
<polygon fill="black" stroke="black" points="233633.03,-128.46 233623.03,-131.95 233633.02,-135.46 233633.03,-128.46"/>
</g>
<!-- dp0_pp1_to_pp2&#45;&gt;dp0_pp2_layer9_attn_tp0 -->
<g id="edge2427" class="edge">
<title>dp0_pp1_to_pp2&#45;&gt;dp0_pp2_layer9_attn_tp0</title>
<path fill="none" stroke="black" d="M61944.09,-131.89C63737.12,-133.37 79196.08,-147.07 79663,-179.52 79917.86,-197.24 80634.05,-143.01 80802,-335.52 80825.82,-362.83 80827.61,-391.42 80802,-417.06 80752.75,-466.35 40734.86,-442.38 40666,-453.06 40636.71,-457.6 40605.45,-466.51 40578.34,-475.63"/>
<polygon fill="black" stroke="black" points="40576.87,-472.43 40568.55,-478.99 40579.14,-479.05 40576.87,-472.43"/>
</g>
<!-- dp1_pp1_to_pp2&#45;&gt;dp1_pp2_layer9_attn_tp0 -->
<g id="edge2429" class="edge">
<title>dp1_pp1_to_pp2&#45;&gt;dp1_pp2_layer9_attn_tp0</title>
<path fill="none" stroke="black" d="M133131.93,-132.53C134097.87,-136.95 139019.41,-158.97 143039,-167.52 143156.8,-167.77 159885.47,-171.47 160003,-179.52 160257.88,-196.99 160974.05,-143.01 161142,-335.52 161165.82,-362.83 161167.61,-391.42 161142,-417.06 161092.75,-466.35 121074.86,-442.38 121006,-453.06 120976.71,-457.6 120945.45,-466.51 120918.34,-475.63"/>
<polygon fill="black" stroke="black" points="120916.87,-472.43 120908.55,-478.99 120919.14,-479.05 120916.87,-472.43"/>
</g>
<!-- dp2_pp1_to_pp2&#45;&gt;dp2_pp2_layer9_attn_tp0 -->
<g id="edge2431" class="edge">
<title>dp2_pp1_to_pp2&#45;&gt;dp2_pp2_layer9_attn_tp0</title>
<path fill="none" stroke="black" d="M213472.1,-132.06C214896.48,-134.66 225041.14,-153.16 233276,-167.52 233472.3,-167.86 240147.16,-166.01 240343,-179.52 240597.87,-197.11 241314.05,-143.01 241482,-335.52 241505.82,-362.83 241507.61,-391.42 241482,-417.06 241432.75,-466.35 201414.86,-442.38 201346,-453.06 201316.71,-457.6 201285.45,-466.51 201258.34,-475.63"/>
<polygon fill="black" stroke="black" points="201256.87,-472.43 201248.55,-478.99 201259.14,-479.05 201256.87,-472.43"/>
</g>
<!-- dp3_pp1_to_pp2&#45;&gt;dp3_pp2_layer9_attn_tp0 -->
<g id="edge2433" class="edge">
<title>dp3_pp1_to_pp2&#45;&gt;dp3_pp2_layer9_attn_tp0</title>
<path fill="none" stroke="black" d="M302964.09,-131.89C304757.12,-133.37 320216.08,-147.07 320683,-179.52 320937.86,-197.24 321654.05,-143.01 321822,-335.52 321845.82,-362.83 321847.61,-391.42 321822,-417.06 321772.75,-466.35 281754.86,-442.38 281686,-453.06 281656.71,-457.6 281625.45,-466.51 281598.34,-475.63"/>
<polygon fill="black" stroke="black" points="281596.87,-472.43 281588.55,-478.99 281599.14,-479.05 281596.87,-472.43"/>
</g>
<!-- final_output -->
<g id="node1483" class="node">
<title>final_output</title>
<ellipse fill="lightblue" stroke="black" cx="128141" cy="-28.99" rx="169" ry="28.98"/>
<text text-anchor="middle" x="128141" y="-37.49" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="128141" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="128141" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- output_dp0&#45;&gt;final_output -->
<g id="edge2438" class="edge">
<title>output_dp0&#45;&gt;final_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M41690.12,-129.4C43118.67,-126.42 53318.04,-105.34 61597,-93.98 89974.01,-55.06 125157.92,-31.92 127961.94,-30.11"/>
<polygon fill="black" stroke="black" points="127962.08,-33.61 127972.08,-30.1 127962.08,-26.61 127962.08,-33.61"/>
</g>
<!-- output_dp1&#45;&gt;final_output -->
<g id="edge2439" class="edge">
<title>output_dp1&#45;&gt;final_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98159.1,-129.19C100463.83,-121.57 125590.02,-38.43 127961.61,-30.58"/>
<polygon fill="black" stroke="black" points="127961.91,-34.08 127971.9,-30.55 127961.89,-27.08 127961.91,-34.08"/>
</g>
<!-- output_dp2&#45;&gt;final_output -->
<g id="edge2440" class="edge">
<title>output_dp2&#45;&gt;final_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M143048.01,-128.63C141506.51,-118.43 129902.68,-41.65 128319.67,-31.17"/>
<polygon fill="black" stroke="black" points="128319.67,-27.67 128309.64,-31.11 128319.62,-34.67 128319.67,-27.67"/>
</g>
<!-- output_dp3&#45;&gt;final_output -->
<g id="edge2441" class="edge">
<title>output_dp3&#45;&gt;final_output</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M233284.9,-129.38C231860.52,-126.28 221715.86,-104.44 213481,-93.98 176908.47,-47.52 131519.72,-31.16 128320.28,-30.05"/>
<polygon fill="black" stroke="black" points="128320.16,-26.55 128310.16,-30.05 128320.16,-33.55 128320.16,-26.55"/>
</g>
</g>
</svg>
