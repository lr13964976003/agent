<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="1pt"
 viewBox="0.00 0.00 1440.00 0.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0 0) rotate(0) translate(4 247.48)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-247.48 504239,-247.48 504239,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="169" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="169" y="-144.48" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="169" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="169" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_input_dp0 -->
<g id="node2" class="node">
<title>stage1_input_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="525" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="525" y="-144.48" font-family="Arial" font-size="10.00">Stage1 Input</text>
<text text-anchor="middle" x="525" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="525" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_input_l1_dp0 -->
<g id="node3" class="node">
<title>attn_input_l1_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="898" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="898" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L1</text>
<text text-anchor="middle" x="898" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="898" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_input_dp0&#45;&gt;attn_input_l1_dp0 -->
<g id="edge1" class="edge">
<title>stage1_input_dp0&#45;&gt;attn_input_l1_dp0</title>
<path fill="none" stroke="black" d="M694.01,-135.98C702.23,-135.98 710.44,-135.98 718.66,-135.98"/>
<polygon fill="black" stroke="black" points="718.68,-139.48 728.68,-135.98 718.68,-132.48 718.68,-139.48"/>
</g>
<!-- attn_tp0_l1_dp0 -->
<g id="node4" class="node">
<title>attn_tp0_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="2196,-161.98 1936,-161.98 1936,-109.98 2196,-109.98 2196,-161.98"/>
<text text-anchor="middle" x="2066" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L1</text>
<text text-anchor="middle" x="2066" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2066" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="2066" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp0&#45;&gt;attn_tp0_l1_dp0 -->
<g id="edge2" class="edge">
<title>attn_input_l1_dp0&#45;&gt;attn_tp0_l1_dp0</title>
<path fill="none" stroke="black" d="M981.52,-161.26C1018.12,-171.09 1061.81,-181.13 1102,-185.98 1147,-191.42 1873.27,-193.33 1918,-185.98 1943.4,-181.81 1970.31,-173.85 1994.12,-165.5"/>
<polygon fill="black" stroke="black" points="1995.55,-168.71 2003.78,-162.03 1993.18,-162.12 1995.55,-168.71"/>
</g>
<!-- attn_tp1_l1_dp0 -->
<g id="node5" class="node">
<title>attn_tp1_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="1918,-161.98 1658,-161.98 1658,-109.98 1918,-109.98 1918,-161.98"/>
<text text-anchor="middle" x="1788" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L1</text>
<text text-anchor="middle" x="1788" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1788" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1788" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp0&#45;&gt;attn_tp1_l1_dp0 -->
<g id="edge3" class="edge">
<title>attn_input_l1_dp0&#45;&gt;attn_tp1_l1_dp0</title>
<path fill="none" stroke="black" d="M981.52,-161.26C1018.12,-171.09 1061.81,-181.13 1102,-185.98 1161.35,-193.15 1581.01,-195.68 1640,-185.98 1665.4,-181.81 1692.31,-173.85 1716.12,-165.5"/>
<polygon fill="black" stroke="black" points="1717.55,-168.71 1725.78,-162.03 1715.18,-162.12 1717.55,-168.71"/>
</g>
<!-- attn_tp2_l1_dp0 -->
<g id="node6" class="node">
<title>attn_tp2_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="1640,-161.98 1380,-161.98 1380,-109.98 1640,-109.98 1640,-161.98"/>
<text text-anchor="middle" x="1510" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L1</text>
<text text-anchor="middle" x="1510" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1510" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1510" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp0&#45;&gt;attn_tp2_l1_dp0 -->
<g id="edge4" class="edge">
<title>attn_input_l1_dp0&#45;&gt;attn_tp2_l1_dp0</title>
<path fill="none" stroke="black" d="M981.52,-161.26C1018.12,-171.09 1061.81,-181.13 1102,-185.98 1159.36,-192.91 1304.99,-195.35 1362,-185.98 1387.4,-181.81 1414.31,-173.85 1438.12,-165.5"/>
<polygon fill="black" stroke="black" points="1439.55,-168.71 1447.78,-162.03 1437.18,-162.12 1439.55,-168.71"/>
</g>
<!-- attn_tp3_l1_dp0 -->
<g id="node7" class="node">
<title>attn_tp3_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="1362,-161.98 1102,-161.98 1102,-109.98 1362,-109.98 1362,-161.98"/>
<text text-anchor="middle" x="1232" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L1</text>
<text text-anchor="middle" x="1232" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1232" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1232" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp0&#45;&gt;attn_tp3_l1_dp0 -->
<g id="edge5" class="edge">
<title>attn_input_l1_dp0&#45;&gt;attn_tp3_l1_dp0</title>
<path fill="none" stroke="black" d="M1067.28,-135.98C1075.35,-135.98 1083.42,-135.98 1091.49,-135.98"/>
<polygon fill="black" stroke="black" points="1091.7,-139.48 1101.7,-135.98 1091.7,-132.48 1091.7,-139.48"/>
</g>
<!-- allreduce_l1_dp0 -->
<g id="node8" class="node">
<title>allreduce_l1_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="2400" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="2400" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L1</text>
<text text-anchor="middle" x="2400" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="2400" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l1_dp0&#45;&gt;allreduce_l1_dp0 -->
<g id="edge6" class="edge">
<title>attn_tp0_l1_dp0&#45;&gt;allreduce_l1_dp0</title>
<path fill="none" stroke="black" d="M2196.14,-135.98C2204.35,-135.98 2212.56,-135.98 2220.77,-135.98"/>
<polygon fill="black" stroke="black" points="2220.78,-139.48 2230.78,-135.98 2220.78,-132.48 2220.78,-139.48"/>
</g>
<!-- attn_tp1_l1_dp0&#45;&gt;allreduce_l1_dp0 -->
<g id="edge7" class="edge">
<title>attn_tp1_l1_dp0&#45;&gt;allreduce_l1_dp0</title>
<path fill="none" stroke="black" d="M1850.22,-162.03C1876.24,-171.59 1907.1,-181.23 1936,-185.98 1993.01,-195.35 2138.64,-192.91 2196,-185.98 2232.57,-181.57 2272.05,-172.85 2306.44,-163.91"/>
<polygon fill="black" stroke="black" points="2307.7,-167.2 2316.47,-161.26 2305.91,-160.43 2307.7,-167.2"/>
</g>
<!-- attn_tp2_l1_dp0&#45;&gt;allreduce_l1_dp0 -->
<g id="edge8" class="edge">
<title>attn_tp2_l1_dp0&#45;&gt;allreduce_l1_dp0</title>
<path fill="none" stroke="black" d="M1572.22,-162.03C1598.24,-171.59 1629.1,-181.23 1658,-185.98 1716.98,-195.68 2136.65,-193.15 2196,-185.98 2232.57,-181.57 2272.05,-172.85 2306.44,-163.91"/>
<polygon fill="black" stroke="black" points="2307.7,-167.2 2316.47,-161.26 2305.91,-160.43 2307.7,-167.2"/>
</g>
<!-- attn_tp3_l1_dp0&#45;&gt;allreduce_l1_dp0 -->
<g id="edge9" class="edge">
<title>attn_tp3_l1_dp0&#45;&gt;allreduce_l1_dp0</title>
<path fill="none" stroke="black" d="M1294.22,-162.03C1320.24,-171.59 1351.1,-181.23 1380,-185.98 1424.73,-193.33 2150.99,-191.42 2196,-185.98 2232.57,-181.57 2272.05,-172.85 2306.44,-163.91"/>
<polygon fill="black" stroke="black" points="2307.7,-167.2 2316.47,-161.26 2305.91,-160.43 2307.7,-167.2"/>
</g>
<!-- moe_input_l1_dp0 -->
<g id="node9" class="node">
<title>moe_input_l1_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="2773" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="2773" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L1</text>
<text text-anchor="middle" x="2773" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="2773" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l1_dp0&#45;&gt;moe_input_l1_dp0 -->
<g id="edge10" class="edge">
<title>allreduce_l1_dp0&#45;&gt;moe_input_l1_dp0</title>
<path fill="none" stroke="black" d="M2569.01,-135.98C2577.23,-135.98 2585.44,-135.98 2593.66,-135.98"/>
<polygon fill="black" stroke="black" points="2593.68,-139.48 2603.68,-135.98 2593.68,-132.48 2593.68,-139.48"/>
</g>
<!-- router_l1_dp0 -->
<g id="node10" class="node">
<title>router_l1_dp0</title>
<polygon fill="lightyellow" stroke="black" points="3472.57,-176.98 3078.74,-176.98 2977.43,-94.98 3371.26,-94.98 3472.57,-176.98"/>
<text text-anchor="middle" x="3225" y="-144.48" font-family="Arial" font-size="10.00">Router L1</text>
<text text-anchor="middle" x="3225" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="3225" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l1_dp0&#45;&gt;router_l1_dp0 -->
<g id="edge11" class="edge">
<title>moe_input_l1_dp0&#45;&gt;router_l1_dp0</title>
<path fill="none" stroke="black" d="M2942.06,-135.98C2967.34,-135.98 2992.63,-135.98 3017.92,-135.98"/>
<polygon fill="black" stroke="black" points="3017.99,-139.48 3027.99,-135.98 3017.99,-132.48 3017.99,-139.48"/>
</g>
<!-- expert0_l1_dp0 -->
<g id="node11" class="node">
<title>expert0_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="7574.5,-161.98 7345.5,-161.98 7345.5,-109.98 7574.5,-109.98 7574.5,-161.98"/>
<text text-anchor="middle" x="7460" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L1</text>
<text text-anchor="middle" x="7460" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="7460" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="7460" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert0_l1_dp0 -->
<g id="edge12" class="edge">
<title>router_l1_dp0&#45;&gt;expert0_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.41,-167C3499.3,-171.09 3539.23,-174.66 3577,-176.98 4301.09,-221.46 6116.04,-196.54 6841.5,-198.98 7061.49,-199.72 7119.72,-217.24 7336,-176.98 7351.27,-174.14 7367.24,-169.88 7382.45,-165.17"/>
<polygon fill="black" stroke="black" points="7383.86,-168.4 7392.32,-162.02 7381.73,-161.73 7383.86,-168.4"/>
<text text-anchor="middle" x="6863" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l1_dp0 -->
<g id="node12" class="node">
<title>expert1_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="7327.5,-161.98 7098.5,-161.98 7098.5,-109.98 7327.5,-109.98 7327.5,-161.98"/>
<text text-anchor="middle" x="7213" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L1</text>
<text text-anchor="middle" x="7213" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="7213" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="7213" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert1_l1_dp0 -->
<g id="edge13" class="edge">
<title>router_l1_dp0&#45;&gt;expert1_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3370.67,-176.99C3409.3,-186.08 3451.21,-194.39 3490.5,-198.98 3509.48,-201.2 3514.39,-199.04 3533.5,-198.98 3731.03,-198.37 6894.08,-208.99 7089,-176.98 7104.93,-174.37 7121.6,-170.03 7137.36,-165.14"/>
<polygon fill="black" stroke="black" points="7138.58,-168.42 7147.03,-162.03 7136.44,-161.76 7138.58,-168.42"/>
<text text-anchor="middle" x="3512" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l1_dp0 -->
<g id="node13" class="node">
<title>expert2_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="7080.5,-161.98 6851.5,-161.98 6851.5,-109.98 7080.5,-109.98 7080.5,-161.98"/>
<text text-anchor="middle" x="6966" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L1</text>
<text text-anchor="middle" x="6966" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="6966" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="6966" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert2_l1_dp0 -->
<g id="edge14" class="edge">
<title>router_l1_dp0&#45;&gt;expert2_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.42,-166.96C3499.3,-171.06 3539.23,-174.64 3577,-176.98 4192.17,-215.14 5734.15,-196.54 6350.5,-198.98 6569.16,-199.85 6627.03,-217.03 6842,-176.98 6857.27,-174.14 6873.24,-169.88 6888.45,-165.17"/>
<polygon fill="black" stroke="black" points="6889.86,-168.4 6898.32,-162.02 6887.73,-161.73 6889.86,-168.4"/>
<text text-anchor="middle" x="6372" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l1_dp0 -->
<g id="node14" class="node">
<title>expert3_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="6833.5,-161.98 6604.5,-161.98 6604.5,-109.98 6833.5,-109.98 6833.5,-161.98"/>
<text text-anchor="middle" x="6719" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L1</text>
<text text-anchor="middle" x="6719" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="6719" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="6719" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert3_l1_dp0 -->
<g id="edge15" class="edge">
<title>router_l1_dp0&#45;&gt;expert3_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3397.37,-177C3442.98,-186.1 3492.37,-194.39 3538.5,-198.98 3557.52,-200.87 3562.39,-199.05 3581.5,-198.98 3916.34,-197.76 6264.61,-231.42 6595,-176.98 6610.93,-174.36 6627.6,-170.02 6643.35,-165.13"/>
<polygon fill="black" stroke="black" points="6644.58,-168.41 6653.03,-162.02 6642.44,-161.74 6644.58,-168.41"/>
<text text-anchor="middle" x="3560" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l1_dp0 -->
<g id="node15" class="node">
<title>expert4_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="6586.5,-161.98 6357.5,-161.98 6357.5,-109.98 6586.5,-109.98 6586.5,-161.98"/>
<text text-anchor="middle" x="6472" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L1</text>
<text text-anchor="middle" x="6472" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="6472" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="6472" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert4_l1_dp0 -->
<g id="edge16" class="edge">
<title>router_l1_dp0&#45;&gt;expert4_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.42,-166.91C3499.3,-171.01 3539.24,-174.61 3577,-176.98 4084.13,-208.87 5355.37,-196.54 5863.5,-198.98 6079.05,-200.02 6136.1,-216.54 6348,-176.98 6363.27,-174.13 6379.24,-169.87 6394.45,-165.16"/>
<polygon fill="black" stroke="black" points="6395.86,-168.39 6404.32,-162.01 6393.73,-161.72 6395.86,-168.39"/>
<text text-anchor="middle" x="5885" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l1_dp0 -->
<g id="node16" class="node">
<title>expert5_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="6339.5,-161.98 6110.5,-161.98 6110.5,-109.98 6339.5,-109.98 6339.5,-161.98"/>
<text text-anchor="middle" x="6225" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L1</text>
<text text-anchor="middle" x="6225" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="6225" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="6225" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert5_l1_dp0 -->
<g id="edge17" class="edge">
<title>router_l1_dp0&#45;&gt;expert5_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3424.02,-177C3476.62,-186.1 3533.5,-194.4 3586.5,-198.98 3605.54,-200.63 3610.39,-199.07 3629.5,-198.98 3904.12,-197.76 5830.07,-221.85 6101,-176.98 6116.93,-174.34 6133.59,-170 6149.35,-165.11"/>
<polygon fill="black" stroke="black" points="6150.58,-168.39 6159.03,-162 6148.44,-161.72 6150.58,-168.39"/>
<text text-anchor="middle" x="3608" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l1_dp0 -->
<g id="node17" class="node">
<title>expert6_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="6092.5,-161.98 5863.5,-161.98 5863.5,-109.98 6092.5,-109.98 6092.5,-161.98"/>
<text text-anchor="middle" x="5978" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L1</text>
<text text-anchor="middle" x="5978" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="5978" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="5978" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert6_l1_dp0 -->
<g id="edge18" class="edge">
<title>router_l1_dp0&#45;&gt;expert6_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.42,-166.83C3499.31,-170.94 3539.24,-174.56 3577,-176.98 4378.3,-228.39 4580.56,-194.09 5383.5,-198.98 5592.83,-200.26 5648.25,-215.57 5854,-176.98 5869.26,-174.12 5885.24,-169.85 5900.45,-165.14"/>
<polygon fill="black" stroke="black" points="5901.85,-168.37 5910.32,-161.99 5899.73,-161.7 5901.85,-168.37"/>
<text text-anchor="middle" x="5405" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l1_dp0 -->
<g id="node18" class="node">
<title>expert7_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="5845.5,-161.98 5616.5,-161.98 5616.5,-109.98 5845.5,-109.98 5845.5,-161.98"/>
<text text-anchor="middle" x="5731" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L1</text>
<text text-anchor="middle" x="5731" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="5731" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="5731" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert7_l1_dp0 -->
<g id="edge19" class="edge">
<title>router_l1_dp0&#45;&gt;expert7_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3450.65,-177.01C3510.23,-186.11 3574.61,-194.4 3634.5,-198.98 3653.55,-200.44 3658.39,-199.09 3677.5,-198.98 3891.9,-197.76 5395.52,-212.28 5607,-176.98 5622.83,-174.34 5639.4,-170.02 5655.07,-165.16"/>
<polygon fill="black" stroke="black" points="5656.25,-168.46 5664.7,-162.07 5654.11,-161.79 5656.25,-168.46"/>
<text text-anchor="middle" x="3656" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l1_dp0 -->
<g id="node19" class="node">
<title>expert8_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="5598.5,-161.98 5369.5,-161.98 5369.5,-109.98 5598.5,-109.98 5598.5,-161.98"/>
<text text-anchor="middle" x="5484" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L1</text>
<text text-anchor="middle" x="5484" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5484" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="5484" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert8_l1_dp0 -->
<g id="edge20" class="edge">
<title>router_l1_dp0&#45;&gt;expert8_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3459.96,-166.64C3498.99,-170.78 3539.09,-174.47 3577,-176.98 3883.81,-197.32 4653.13,-207.44 4960.5,-198.98 5138.26,-194.09 5185.28,-210.07 5360,-176.98 5375.17,-174.11 5391.04,-169.87 5406.16,-165.18"/>
<polygon fill="black" stroke="black" points="5407.52,-168.42 5415.98,-162.05 5405.39,-161.75 5407.52,-168.42"/>
<text text-anchor="middle" x="4939" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l1_dp0 -->
<g id="node20" class="node">
<title>expert9_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="5351.5,-161.98 5122.5,-161.98 5122.5,-109.98 5351.5,-109.98 5351.5,-161.98"/>
<text text-anchor="middle" x="5237" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L1</text>
<text text-anchor="middle" x="5237" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5237" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="5237" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert9_l1_dp0 -->
<g id="edge21" class="edge">
<title>router_l1_dp0&#45;&gt;expert9_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.89,-176.28C3539.94,-185.66 3613.91,-194.28 3682.5,-198.98 3841.09,-209.85 4956.26,-203.5 5113,-176.98 5128.83,-174.3 5145.39,-169.97 5161.06,-165.1"/>
<polygon fill="black" stroke="black" points="5162.24,-168.4 5170.69,-162.01 5160.1,-161.74 5162.24,-168.4"/>
<text text-anchor="middle" x="3704" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l1_dp0 -->
<g id="node21" class="node">
<title>expert10_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="5104.5,-161.98 4875.5,-161.98 4875.5,-109.98 5104.5,-109.98 5104.5,-161.98"/>
<text text-anchor="middle" x="4990" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L1</text>
<text text-anchor="middle" x="4990" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4990" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="4990" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert10_l1_dp0 -->
<g id="edge22" class="edge">
<title>router_l1_dp0&#45;&gt;expert10_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3459.5,-166.33C3498.68,-170.52 3538.95,-174.31 3577,-176.98 3996.3,-206.45 4102.38,-212.42 4522.5,-198.98 4675.4,-194.09 4715.82,-206.12 4866,-176.98 4881.06,-174.06 4896.83,-169.82 4911.87,-165.16"/>
<polygon fill="black" stroke="black" points="4913.17,-168.42 4921.64,-162.04 4911.05,-161.75 4913.17,-168.42"/>
<text text-anchor="middle" x="4501" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l1_dp0 -->
<g id="node22" class="node">
<title>expert11_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="4857.5,-161.98 4628.5,-161.98 4628.5,-109.98 4857.5,-109.98 4857.5,-161.98"/>
<text text-anchor="middle" x="4743" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L1</text>
<text text-anchor="middle" x="4743" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4743" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="4743" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert11_l1_dp0 -->
<g id="edge23" class="edge">
<title>router_l1_dp0&#45;&gt;expert11_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3467.08,-172.34C3550.36,-183.2 3644.33,-193.63 3730.5,-198.98 3927.62,-211.22 4424.43,-210.92 4619,-176.98 4634.72,-174.24 4651.17,-169.91 4666.76,-165.06"/>
<polygon fill="black" stroke="black" points="4667.89,-168.38 4676.35,-161.99 4665.75,-161.71 4667.89,-168.38"/>
<text text-anchor="middle" x="3752" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l1_dp0 -->
<g id="node23" class="node">
<title>expert12_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="4610.5,-161.98 4381.5,-161.98 4381.5,-109.98 4610.5,-109.98 4610.5,-161.98"/>
<text text-anchor="middle" x="4496" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L1</text>
<text text-anchor="middle" x="4496" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4496" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="4496" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert12_l1_dp0 -->
<g id="edge24" class="edge">
<title>router_l1_dp0&#45;&gt;expert12_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.99,-167.31C3645.78,-188.18 3909.35,-209.94 4140.5,-198.98 4243.74,-194.09 4270.85,-198.23 4372,-176.98 4386.65,-173.9 4402,-169.69 4416.7,-165.12"/>
<polygon fill="black" stroke="black" points="4417.79,-168.45 4426.26,-162.08 4415.67,-161.78 4417.79,-168.45"/>
<text text-anchor="middle" x="4119" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l1_dp0 -->
<g id="node24" class="node">
<title>expert13_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="4363.5,-161.98 4134.5,-161.98 4134.5,-109.98 4363.5,-109.98 4363.5,-161.98"/>
<text text-anchor="middle" x="4249" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L1</text>
<text text-anchor="middle" x="4249" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4249" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="4249" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert13_l1_dp0 -->
<g id="edge25" class="edge">
<title>router_l1_dp0&#45;&gt;expert13_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3458.04,-176.99C3641.11,-201.94 3901.58,-221.31 4125,-176.98 4139.96,-174.01 4155.62,-169.78 4170.58,-165.14"/>
<polygon fill="black" stroke="black" points="4171.83,-168.41 4180.29,-162.04 4169.7,-161.74 4171.83,-168.41"/>
<text text-anchor="middle" x="3800" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l1_dp0 -->
<g id="node25" class="node">
<title>expert14_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="4116.5,-161.98 3887.5,-161.98 3887.5,-109.98 4116.5,-109.98 4116.5,-161.98"/>
<text text-anchor="middle" x="4002" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L1</text>
<text text-anchor="middle" x="4002" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4002" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="4002" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert14_l1_dp0 -->
<g id="edge26" class="edge">
<title>router_l1_dp0&#45;&gt;expert14_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.9,-167.35C3571.65,-180.36 3705.6,-193.66 3826.5,-198.98 3845.59,-199.82 3850.86,-203.19 3869.5,-198.98 3897.7,-192.62 3926.94,-179.52 3950.75,-166.9"/>
<polygon fill="black" stroke="black" points="3952.48,-169.94 3959.6,-162.1 3949.14,-163.79 3952.48,-169.94"/>
<text text-anchor="middle" x="3848" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l1_dp0 -->
<g id="node26" class="node">
<title>expert15_l1_dp0</title>
<polygon fill="lightgreen" stroke="black" points="3815.5,-161.98 3586.5,-161.98 3586.5,-109.98 3815.5,-109.98 3815.5,-161.98"/>
<text text-anchor="middle" x="3701" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L1</text>
<text text-anchor="middle" x="3701" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3701" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="3701" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp0&#45;&gt;expert15_l1_dp0 -->
<g id="edge27" class="edge">
<title>router_l1_dp0&#45;&gt;expert15_l1_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3422.04,-135.98C3474.11,-135.98 3528.87,-135.98 3575.95,-135.98"/>
<polygon fill="black" stroke="black" points="3576.18,-139.48 3586.18,-135.98 3576.18,-132.48 3576.18,-139.48"/>
<text text-anchor="middle" x="3529.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l1_dp0 -->
<g id="node27" class="node">
<title>expert_agg_l1_dp0</title>
<polygon fill="lightyellow" stroke="black" points="8105.57,-176.98 7711.74,-176.98 7610.43,-94.98 8004.26,-94.98 8105.57,-176.98"/>
<text text-anchor="middle" x="7858" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L1</text>
<text text-anchor="middle" x="7858" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="7858" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge28" class="edge">
<title>expert0_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M7574.66,-135.98C7600.06,-135.98 7625.47,-135.98 7650.87,-135.98"/>
<polygon fill="black" stroke="black" points="7650.99,-139.48 7660.99,-135.98 7650.99,-132.48 7650.99,-139.48"/>
</g>
<!-- expert1_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge29" class="edge">
<title>expert1_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M7268.24,-162.02C7291.4,-171.57 7318.96,-181.22 7345,-185.98 7395.06,-195.15 7523.3,-190.41 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert2_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge30" class="edge">
<title>expert2_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M7021.24,-162.02C7044.4,-171.57 7071.96,-181.22 7098,-185.98 7150.02,-195.51 7521.31,-190.59 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert3_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge31" class="edge">
<title>expert3_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M6774.24,-162.02C6797.4,-171.57 6824.96,-181.22 6851,-185.98 6930.02,-200.45 7493.97,-192.97 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert4_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge32" class="edge">
<title>expert4_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M6527.24,-162.02C6550.4,-171.57 6577.96,-181.22 6604,-185.98 6657.01,-195.69 7520.31,-190.67 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert5_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge33" class="edge">
<title>expert5_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M6280.24,-162.02C6303.4,-171.57 6330.96,-181.22 6357,-185.98 6423.5,-198.16 7506.64,-191.87 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert6_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge34" class="edge">
<title>expert6_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M6033.24,-162.02C6056.4,-171.57 6083.96,-181.22 6110,-185.98 6190,-200.63 7492.97,-193.06 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert7_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge35" class="edge">
<title>expert7_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M5786.24,-162.02C5809.4,-171.57 5836.96,-181.22 5863,-185.98 5909.75,-194.54 7526.65,-190.12 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert8_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge36" class="edge">
<title>expert8_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M5539.24,-162.02C5562.4,-171.57 5589.96,-181.22 5616,-185.98 5669.5,-195.78 7519.82,-190.72 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert9_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge37" class="edge">
<title>expert9_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M5292.24,-162.02C5315.4,-171.57 5342.96,-181.22 5369,-185.98 5429.25,-197.01 7512.98,-191.31 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert10_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge38" class="edge">
<title>expert10_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M5045.24,-162.02C5068.4,-171.57 5095.96,-181.22 5122,-185.98 5189,-198.25 7506.15,-191.91 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert11_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge39" class="edge">
<title>expert11_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M4798.24,-162.02C4821.4,-171.57 4848.96,-181.22 4875,-185.98 4948.75,-199.48 7499.31,-192.51 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert12_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge40" class="edge">
<title>expert12_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M4551.24,-162.02C4574.4,-171.57 4601.96,-181.22 4628,-185.98 4708.49,-200.72 7492.48,-193.1 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert13_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge41" class="edge">
<title>expert13_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M4304.24,-162.02C4327.4,-171.57 4354.96,-181.22 4381,-185.98 4424.62,-193.97 7529.82,-189.84 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert14_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge42" class="edge">
<title>expert14_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M4057.24,-162.02C4080.4,-171.57 4107.96,-181.22 4134,-185.98 4181,-194.59 7526.4,-190.14 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- expert15_l1_dp0&#45;&gt;expert_agg_l1_dp0 -->
<g id="edge43" class="edge">
<title>expert15_l1_dp0&#45;&gt;expert_agg_l1_dp0</title>
<path fill="none" stroke="black" d="M3779.72,-162.05C3812.5,-171.62 3851.2,-181.25 3887,-185.98 3988.53,-199.39 7471.97,-194.9 7574,-185.98 7612.11,-182.65 7652.78,-176.86 7691.08,-170.36"/>
<polygon fill="black" stroke="black" points="7692.02,-173.75 7701.29,-168.6 7690.84,-166.85 7692.02,-173.75"/>
</g>
<!-- layer1_output_dp0 -->
<g id="node28" class="node">
<title>layer1_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="8310" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="8310" y="-144.48" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="8310" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="8310" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l1_dp0&#45;&gt;layer1_output_dp0 -->
<g id="edge44" class="edge">
<title>expert_agg_l1_dp0&#45;&gt;layer1_output_dp0</title>
<path fill="none" stroke="black" d="M8055.31,-135.98C8080.49,-135.98 8105.66,-135.98 8130.84,-135.98"/>
<polygon fill="black" stroke="black" points="8130.87,-139.48 8140.87,-135.98 8130.87,-132.48 8130.87,-139.48"/>
</g>
<!-- attn_input_l2_dp0 -->
<g id="node29" class="node">
<title>attn_input_l2_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="8683" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="8683" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L2</text>
<text text-anchor="middle" x="8683" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="8683" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer1_output_dp0&#45;&gt;attn_input_l2_dp0 -->
<g id="edge45" class="edge">
<title>layer1_output_dp0&#45;&gt;attn_input_l2_dp0</title>
<path fill="none" stroke="black" d="M8479.01,-135.98C8487.23,-135.98 8495.44,-135.98 8503.66,-135.98"/>
<polygon fill="black" stroke="black" points="8503.68,-139.48 8513.68,-135.98 8503.68,-132.48 8503.68,-139.48"/>
</g>
<!-- attn_tp0_l2_dp0 -->
<g id="node30" class="node">
<title>attn_tp0_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="9981,-161.98 9721,-161.98 9721,-109.98 9981,-109.98 9981,-161.98"/>
<text text-anchor="middle" x="9851" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L2</text>
<text text-anchor="middle" x="9851" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="9851" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9851" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp0&#45;&gt;attn_tp0_l2_dp0 -->
<g id="edge46" class="edge">
<title>attn_input_l2_dp0&#45;&gt;attn_tp0_l2_dp0</title>
<path fill="none" stroke="black" d="M8766.52,-161.26C8803.12,-171.09 8846.81,-181.13 8887,-185.98 8932,-191.42 9658.27,-193.33 9703,-185.98 9728.4,-181.81 9755.31,-173.85 9779.12,-165.5"/>
<polygon fill="black" stroke="black" points="9780.55,-168.71 9788.78,-162.03 9778.18,-162.12 9780.55,-168.71"/>
</g>
<!-- attn_tp1_l2_dp0 -->
<g id="node31" class="node">
<title>attn_tp1_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="9703,-161.98 9443,-161.98 9443,-109.98 9703,-109.98 9703,-161.98"/>
<text text-anchor="middle" x="9573" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L2</text>
<text text-anchor="middle" x="9573" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="9573" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9573" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp0&#45;&gt;attn_tp1_l2_dp0 -->
<g id="edge47" class="edge">
<title>attn_input_l2_dp0&#45;&gt;attn_tp1_l2_dp0</title>
<path fill="none" stroke="black" d="M8766.52,-161.26C8803.12,-171.09 8846.81,-181.13 8887,-185.98 8946.35,-193.15 9366.01,-195.68 9425,-185.98 9450.4,-181.81 9477.31,-173.85 9501.12,-165.5"/>
<polygon fill="black" stroke="black" points="9502.55,-168.71 9510.78,-162.03 9500.18,-162.12 9502.55,-168.71"/>
</g>
<!-- attn_tp2_l2_dp0 -->
<g id="node32" class="node">
<title>attn_tp2_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="9425,-161.98 9165,-161.98 9165,-109.98 9425,-109.98 9425,-161.98"/>
<text text-anchor="middle" x="9295" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L2</text>
<text text-anchor="middle" x="9295" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="9295" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9295" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp0&#45;&gt;attn_tp2_l2_dp0 -->
<g id="edge48" class="edge">
<title>attn_input_l2_dp0&#45;&gt;attn_tp2_l2_dp0</title>
<path fill="none" stroke="black" d="M8766.52,-161.26C8803.12,-171.09 8846.81,-181.13 8887,-185.98 8944.36,-192.91 9089.99,-195.35 9147,-185.98 9172.4,-181.81 9199.31,-173.85 9223.12,-165.5"/>
<polygon fill="black" stroke="black" points="9224.55,-168.71 9232.78,-162.03 9222.18,-162.12 9224.55,-168.71"/>
</g>
<!-- attn_tp3_l2_dp0 -->
<g id="node33" class="node">
<title>attn_tp3_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="9147,-161.98 8887,-161.98 8887,-109.98 9147,-109.98 9147,-161.98"/>
<text text-anchor="middle" x="9017" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L2</text>
<text text-anchor="middle" x="9017" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="9017" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9017" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp0&#45;&gt;attn_tp3_l2_dp0 -->
<g id="edge49" class="edge">
<title>attn_input_l2_dp0&#45;&gt;attn_tp3_l2_dp0</title>
<path fill="none" stroke="black" d="M8852.28,-135.98C8860.35,-135.98 8868.42,-135.98 8876.49,-135.98"/>
<polygon fill="black" stroke="black" points="8876.7,-139.48 8886.7,-135.98 8876.7,-132.48 8876.7,-139.48"/>
</g>
<!-- allreduce_l2_dp0 -->
<g id="node34" class="node">
<title>allreduce_l2_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="10185" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="10185" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L2</text>
<text text-anchor="middle" x="10185" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="10185" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l2_dp0&#45;&gt;allreduce_l2_dp0 -->
<g id="edge50" class="edge">
<title>attn_tp0_l2_dp0&#45;&gt;allreduce_l2_dp0</title>
<path fill="none" stroke="black" d="M9981.14,-135.98C9989.35,-135.98 9997.56,-135.98 10005.77,-135.98"/>
<polygon fill="black" stroke="black" points="10005.78,-139.48 10015.78,-135.98 10005.78,-132.48 10005.78,-139.48"/>
</g>
<!-- attn_tp1_l2_dp0&#45;&gt;allreduce_l2_dp0 -->
<g id="edge51" class="edge">
<title>attn_tp1_l2_dp0&#45;&gt;allreduce_l2_dp0</title>
<path fill="none" stroke="black" d="M9635.22,-162.03C9661.24,-171.59 9692.1,-181.23 9721,-185.98 9778.01,-195.35 9923.64,-192.91 9981,-185.98 10017.57,-181.57 10057.05,-172.85 10091.44,-163.91"/>
<polygon fill="black" stroke="black" points="10092.7,-167.2 10101.47,-161.26 10090.91,-160.43 10092.7,-167.2"/>
</g>
<!-- attn_tp2_l2_dp0&#45;&gt;allreduce_l2_dp0 -->
<g id="edge52" class="edge">
<title>attn_tp2_l2_dp0&#45;&gt;allreduce_l2_dp0</title>
<path fill="none" stroke="black" d="M9357.22,-162.03C9383.24,-171.59 9414.1,-181.23 9443,-185.98 9501.98,-195.68 9921.65,-193.15 9981,-185.98 10017.57,-181.57 10057.05,-172.85 10091.44,-163.91"/>
<polygon fill="black" stroke="black" points="10092.7,-167.2 10101.47,-161.26 10090.91,-160.43 10092.7,-167.2"/>
</g>
<!-- attn_tp3_l2_dp0&#45;&gt;allreduce_l2_dp0 -->
<g id="edge53" class="edge">
<title>attn_tp3_l2_dp0&#45;&gt;allreduce_l2_dp0</title>
<path fill="none" stroke="black" d="M9079.22,-162.03C9105.24,-171.59 9136.1,-181.23 9165,-185.98 9209.73,-193.33 9935.99,-191.42 9981,-185.98 10017.57,-181.57 10057.05,-172.85 10091.44,-163.91"/>
<polygon fill="black" stroke="black" points="10092.7,-167.2 10101.47,-161.26 10090.91,-160.43 10092.7,-167.2"/>
</g>
<!-- moe_input_l2_dp0 -->
<g id="node35" class="node">
<title>moe_input_l2_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="10558" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="10558" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L2</text>
<text text-anchor="middle" x="10558" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="10558" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l2_dp0&#45;&gt;moe_input_l2_dp0 -->
<g id="edge54" class="edge">
<title>allreduce_l2_dp0&#45;&gt;moe_input_l2_dp0</title>
<path fill="none" stroke="black" d="M10354.01,-135.98C10362.23,-135.98 10370.44,-135.98 10378.66,-135.98"/>
<polygon fill="black" stroke="black" points="10378.68,-139.48 10388.68,-135.98 10378.68,-132.48 10378.68,-139.48"/>
</g>
<!-- router_l2_dp0 -->
<g id="node36" class="node">
<title>router_l2_dp0</title>
<polygon fill="lightyellow" stroke="black" points="11257.57,-176.98 10863.74,-176.98 10762.43,-94.98 11156.26,-94.98 11257.57,-176.98"/>
<text text-anchor="middle" x="11010" y="-144.48" font-family="Arial" font-size="10.00">Router L2</text>
<text text-anchor="middle" x="11010" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="11010" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l2_dp0&#45;&gt;router_l2_dp0 -->
<g id="edge55" class="edge">
<title>moe_input_l2_dp0&#45;&gt;router_l2_dp0</title>
<path fill="none" stroke="black" d="M10727.06,-135.98C10752.34,-135.98 10777.63,-135.98 10802.92,-135.98"/>
<polygon fill="black" stroke="black" points="10802.99,-139.48 10812.99,-135.98 10802.99,-132.48 10802.99,-139.48"/>
</g>
<!-- expert0_l2_dp0 -->
<g id="node37" class="node">
<title>expert0_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="15407.5,-161.98 15178.5,-161.98 15178.5,-109.98 15407.5,-109.98 15407.5,-161.98"/>
<text text-anchor="middle" x="15293" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L2</text>
<text text-anchor="middle" x="15293" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="15293" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="15293" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert0_l2_dp0 -->
<g id="edge56" class="edge">
<title>router_l2_dp0&#45;&gt;expert0_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11243.11,-165.12C11290.33,-169.97 11339.7,-174.3 11386,-176.98 12062.32,-216.2 13757.04,-196.54 14434.5,-198.98 14597.79,-199.57 15008.21,-205.5 15169,-176.98 15184.62,-174.21 15200.97,-169.89 15216.48,-165.08"/>
<polygon fill="black" stroke="black" points="15217.55,-168.41 15226.01,-162.02 15215.42,-161.74 15217.55,-168.41"/>
<text text-anchor="middle" x="14456" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l2_dp0 -->
<g id="node38" class="node">
<title>expert1_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="15160.5,-161.98 14931.5,-161.98 14931.5,-109.98 15160.5,-109.98 15160.5,-161.98"/>
<text text-anchor="middle" x="15046" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L2</text>
<text text-anchor="middle" x="15046" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="15046" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="15046" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert1_l2_dp0 -->
<g id="edge57" class="edge">
<title>router_l2_dp0&#45;&gt;expert1_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11155.67,-176.99C11194.3,-186.08 11236.21,-194.39 11275.5,-198.98 11294.48,-201.2 11299.39,-199.04 11318.5,-198.98 11518.7,-198.37 14724.44,-209.41 14922,-176.98 14937.93,-174.37 14954.6,-170.03 14970.36,-165.14"/>
<polygon fill="black" stroke="black" points="14971.58,-168.42 14980.03,-162.03 14969.44,-161.76 14971.58,-168.42"/>
<text text-anchor="middle" x="11297" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l2_dp0 -->
<g id="node39" class="node">
<title>expert2_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="14913.5,-161.98 14684.5,-161.98 14684.5,-109.98 14913.5,-109.98 14913.5,-161.98"/>
<text text-anchor="middle" x="14799" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L2</text>
<text text-anchor="middle" x="14799" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="14799" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="14799" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert2_l2_dp0 -->
<g id="edge58" class="edge">
<title>router_l2_dp0&#45;&gt;expert2_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11182.37,-177C11227.98,-186.1 11277.37,-194.39 11323.5,-198.98 11342.52,-200.87 11347.39,-199.05 11366.5,-198.98 11550.31,-198.37 14493.63,-206.81 14675,-176.98 14690.93,-174.36 14707.6,-170.03 14723.35,-165.13"/>
<polygon fill="black" stroke="black" points="14724.58,-168.41 14733.03,-162.02 14722.44,-161.75 14724.58,-168.41"/>
<text text-anchor="middle" x="11345" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l2_dp0 -->
<g id="node40" class="node">
<title>expert3_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="14666.5,-161.98 14437.5,-161.98 14437.5,-109.98 14666.5,-109.98 14666.5,-161.98"/>
<text text-anchor="middle" x="14552" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L2</text>
<text text-anchor="middle" x="14552" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="14552" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="14552" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert3_l2_dp0 -->
<g id="edge59" class="edge">
<title>router_l2_dp0&#45;&gt;expert3_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11242.86,-165.01C11290.16,-169.88 11339.62,-174.24 11386,-176.98 11909.88,-207.95 13222.77,-207.46 13747.5,-198.98 14050.06,-194.09 14130.06,-229.91 14428,-176.98 14443.62,-174.21 14459.97,-169.89 14475.47,-165.07"/>
<polygon fill="black" stroke="black" points="14476.55,-168.4 14485.01,-162.02 14474.42,-161.73 14476.55,-168.4"/>
<text text-anchor="middle" x="13726" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l2_dp0 -->
<g id="node41" class="node">
<title>expert4_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="14419.5,-161.98 14190.5,-161.98 14190.5,-109.98 14419.5,-109.98 14419.5,-161.98"/>
<text text-anchor="middle" x="14305" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L2</text>
<text text-anchor="middle" x="14305" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="14305" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="14305" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert4_l2_dp0 -->
<g id="edge60" class="edge">
<title>router_l2_dp0&#45;&gt;expert4_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11209.02,-177C11261.62,-186.1 11318.5,-194.4 11371.5,-198.98 11390.54,-200.63 11395.39,-199.06 11414.5,-198.98 11721.89,-197.76 13877.71,-227.06 14181,-176.98 14196.93,-174.35 14213.6,-170.01 14229.35,-165.12"/>
<polygon fill="black" stroke="black" points="14230.58,-168.4 14239.03,-162.01 14228.44,-161.73 14230.58,-168.4"/>
<text text-anchor="middle" x="11393" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l2_dp0 -->
<g id="node42" class="node">
<title>expert5_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="14172.5,-161.98 13943.5,-161.98 13943.5,-109.98 14172.5,-109.98 14172.5,-161.98"/>
<text text-anchor="middle" x="14058" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L2</text>
<text text-anchor="middle" x="14058" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="14058" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="14058" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert5_l2_dp0 -->
<g id="edge61" class="edge">
<title>router_l2_dp0&#45;&gt;expert5_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11235.65,-177.01C11295.23,-186.11 11359.61,-194.4 11419.5,-198.98 11438.55,-200.44 11443.39,-199.07 11462.5,-198.98 11737.12,-197.76 13663.07,-221.85 13934,-176.98 13949.93,-174.34 13966.59,-170 13982.35,-165.11"/>
<polygon fill="black" stroke="black" points="13983.58,-168.39 13992.03,-162 13981.44,-161.72 13983.58,-168.39"/>
<text text-anchor="middle" x="11441" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l2_dp0 -->
<g id="node43" class="node">
<title>expert6_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="13925.5,-161.98 13696.5,-161.98 13696.5,-109.98 13925.5,-109.98 13925.5,-161.98"/>
<text text-anchor="middle" x="13811" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L2</text>
<text text-anchor="middle" x="13811" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="13811" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="13811" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert6_l2_dp0 -->
<g id="edge62" class="edge">
<title>router_l2_dp0&#45;&gt;expert6_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11256.89,-176.28C11324.94,-185.66 11398.91,-194.28 11467.5,-198.98 11486.56,-200.29 11491.39,-199.08 11510.5,-198.98 11752.34,-197.76 13448.43,-216.64 13687,-176.98 13702.84,-174.35 13719.4,-170.04 13735.07,-165.18"/>
<polygon fill="black" stroke="black" points="13736.25,-168.47 13744.7,-162.09 13734.11,-161.81 13736.25,-168.47"/>
<text text-anchor="middle" x="11489" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l2_dp0 -->
<g id="node44" class="node">
<title>expert7_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="13678.5,-161.98 13449.5,-161.98 13449.5,-109.98 13678.5,-109.98 13678.5,-161.98"/>
<text text-anchor="middle" x="13564" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L2</text>
<text text-anchor="middle" x="13564" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="13564" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="13564" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert7_l2_dp0 -->
<g id="edge63" class="edge">
<title>router_l2_dp0&#45;&gt;expert7_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11242.62,-164.83C11289.99,-169.72 11339.55,-174.14 11386,-176.98 11750.35,-199.3 12663.6,-208.73 13028.5,-198.98 13211.58,-194.09 13260.02,-210.92 13440,-176.98 13455.17,-174.12 13471.04,-169.88 13486.17,-165.2"/>
<polygon fill="black" stroke="black" points="13487.52,-168.44 13495.99,-162.07 13485.4,-161.77 13487.52,-168.44"/>
<text text-anchor="middle" x="13007" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l2_dp0 -->
<g id="node45" class="node">
<title>expert8_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="13431.5,-161.98 13202.5,-161.98 13202.5,-109.98 13431.5,-109.98 13431.5,-161.98"/>
<text text-anchor="middle" x="13317" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L2</text>
<text text-anchor="middle" x="13317" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="13317" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="13317" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert8_l2_dp0 -->
<g id="edge64" class="edge">
<title>router_l2_dp0&#45;&gt;expert8_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11252.08,-172.34C11335.36,-183.2 11429.33,-193.63 11515.5,-198.98 11701.55,-210.53 13009.17,-207.86 13193,-176.98 13208.83,-174.32 13225.39,-170 13241.07,-165.13"/>
<polygon fill="black" stroke="black" points="13242.24,-168.43 13250.7,-162.04 13240.1,-161.77 13242.24,-168.43"/>
<text text-anchor="middle" x="11537" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l2_dp0 -->
<g id="node46" class="node">
<title>expert9_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="13184.5,-161.98 12955.5,-161.98 12955.5,-109.98 13184.5,-109.98 13184.5,-161.98"/>
<text text-anchor="middle" x="13070" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L2</text>
<text text-anchor="middle" x="13070" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="13070" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="13070" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert9_l2_dp0 -->
<g id="edge65" class="edge">
<title>router_l2_dp0&#45;&gt;expert9_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11242.38,-164.61C11289.83,-169.53 11339.47,-174.01 11386,-176.98 11914.56,-210.8 12048.09,-214.77 12577.5,-198.98 12741.49,-194.09 12784.87,-207.88 12946,-176.98 12961.16,-174.08 12977.03,-169.81 12992.15,-165.12"/>
<polygon fill="black" stroke="black" points="12993.51,-168.37 13001.97,-161.99 12991.38,-161.7 12993.51,-168.37"/>
<text text-anchor="middle" x="12556" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l2_dp0 -->
<g id="node47" class="node">
<title>expert10_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="12937.5,-161.98 12708.5,-161.98 12708.5,-109.98 12937.5,-109.98 12937.5,-161.98"/>
<text text-anchor="middle" x="12823" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L2</text>
<text text-anchor="middle" x="12823" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="12823" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="12823" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert10_l2_dp0 -->
<g id="edge66" class="edge">
<title>router_l2_dp0&#45;&gt;expert10_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11247.88,-169.04C11345.47,-181.04 11459.7,-193.09 11563.5,-198.98 11815.47,-213.28 12450.24,-219.61 12699,-176.98 12714.73,-174.29 12731.18,-169.97 12746.78,-165.14"/>
<polygon fill="black" stroke="black" points="12747.9,-168.45 12756.36,-162.07 12745.77,-161.78 12747.9,-168.45"/>
<text text-anchor="middle" x="11585" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l2_dp0 -->
<g id="node48" class="node">
<title>expert11_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="12690.5,-161.98 12461.5,-161.98 12461.5,-109.98 12690.5,-109.98 12690.5,-161.98"/>
<text text-anchor="middle" x="12576" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L2</text>
<text text-anchor="middle" x="12576" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="12576" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="12576" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert11_l2_dp0 -->
<g id="edge67" class="edge">
<title>router_l2_dp0&#45;&gt;expert11_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11241.91,-164.17C11289.5,-169.14 11339.32,-173.75 11386,-176.98 11733.97,-201.08 11821.96,-212.58 12170.5,-198.98 12295.9,-194.09 12328.97,-201.75 12452,-176.98 12466.86,-173.99 12482.42,-169.77 12497.29,-165.16"/>
<polygon fill="black" stroke="black" points="12498.48,-168.45 12506.95,-162.08 12496.36,-161.78 12498.48,-168.45"/>
<text text-anchor="middle" x="12149" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l2_dp0 -->
<g id="node49" class="node">
<title>expert12_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="12443.5,-161.98 12214.5,-161.98 12214.5,-109.98 12443.5,-109.98 12443.5,-161.98"/>
<text text-anchor="middle" x="12329" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L2</text>
<text text-anchor="middle" x="12329" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="12329" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="12329" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert12_l2_dp0 -->
<g id="edge68" class="edge">
<title>router_l2_dp0&#45;&gt;expert12_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11238.62,-161.33C11287.25,-166.61 11338.32,-172.06 11386,-176.98 11386,-176.98 12205,-176.98 12205,-176.98 12220.37,-174.19 12236.45,-169.93 12251.75,-165.2"/>
<polygon fill="black" stroke="black" points="12253.21,-168.41 12261.67,-162.03 12251.08,-161.74 12253.21,-168.41"/>
<text text-anchor="middle" x="11633" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l2_dp0 -->
<g id="node50" class="node">
<title>expert13_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="12196.5,-161.98 11967.5,-161.98 11967.5,-109.98 12196.5,-109.98 12196.5,-161.98"/>
<text text-anchor="middle" x="12082" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L2</text>
<text text-anchor="middle" x="12082" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="12082" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="12082" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert13_l2_dp0 -->
<g id="edge69" class="edge">
<title>router_l2_dp0&#45;&gt;expert13_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11255.48,-177.01C11423.02,-199.46 11649.9,-219.01 11849.5,-198.98 11900.66,-193.85 11956.31,-179.11 12000.33,-165.18"/>
<polygon fill="black" stroke="black" points="12001.66,-168.43 12010.11,-162.04 11999.52,-161.77 12001.66,-168.43"/>
<text text-anchor="middle" x="11828" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l2_dp0 -->
<g id="node51" class="node">
<title>expert14_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="11949.5,-161.98 11720.5,-161.98 11720.5,-109.98 11949.5,-109.98 11949.5,-161.98"/>
<text text-anchor="middle" x="11835" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L2</text>
<text text-anchor="middle" x="11835" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="11835" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="11835" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert14_l2_dp0 -->
<g id="edge70" class="edge">
<title>router_l2_dp0&#45;&gt;expert14_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11242.91,-165.01C11366.47,-178.78 11520.97,-193.42 11659.5,-198.98 11678.59,-199.75 11683.86,-203.19 11702.5,-198.98 11730.7,-192.62 11759.94,-179.52 11783.75,-166.9"/>
<polygon fill="black" stroke="black" points="11785.48,-169.94 11792.6,-162.1 11782.14,-163.79 11785.48,-169.94"/>
<text text-anchor="middle" x="11681" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l2_dp0 -->
<g id="node52" class="node">
<title>expert15_l2_dp0</title>
<polygon fill="lightgreen" stroke="black" points="11624.5,-161.98 11395.5,-161.98 11395.5,-109.98 11624.5,-109.98 11624.5,-161.98"/>
<text text-anchor="middle" x="11510" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L2</text>
<text text-anchor="middle" x="11510" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="11510" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="11510" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp0&#45;&gt;expert15_l2_dp0 -->
<g id="edge71" class="edge">
<title>router_l2_dp0&#45;&gt;expert15_l2_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11207.25,-135.98C11267.17,-135.98 11331.31,-135.98 11385.07,-135.98"/>
<polygon fill="black" stroke="black" points="11385.33,-139.48 11395.33,-135.98 11385.33,-132.48 11385.33,-139.48"/>
<text text-anchor="middle" x="11326.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l2_dp0 -->
<g id="node53" class="node">
<title>expert_agg_l2_dp0</title>
<polygon fill="lightyellow" stroke="black" points="15938.57,-176.98 15544.74,-176.98 15443.43,-94.98 15837.26,-94.98 15938.57,-176.98"/>
<text text-anchor="middle" x="15691" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L2</text>
<text text-anchor="middle" x="15691" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="15691" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge72" class="edge">
<title>expert0_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M15407.66,-135.98C15433.06,-135.98 15458.47,-135.98 15483.87,-135.98"/>
<polygon fill="black" stroke="black" points="15483.99,-139.48 15493.99,-135.98 15483.99,-132.48 15483.99,-139.48"/>
</g>
<!-- expert1_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge73" class="edge">
<title>expert1_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M15101.24,-162.02C15124.4,-171.57 15151.96,-181.22 15178,-185.98 15228.06,-195.15 15356.3,-190.41 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert2_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge74" class="edge">
<title>expert2_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M14854.24,-162.02C14877.4,-171.57 14904.96,-181.22 14931,-185.98 14983.02,-195.51 15354.31,-190.59 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert3_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge75" class="edge">
<title>expert3_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M14607.24,-162.02C14630.4,-171.57 14657.96,-181.22 14684,-185.98 14763.02,-200.45 15326.97,-192.97 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert4_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge76" class="edge">
<title>expert4_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M14360.24,-162.02C14383.4,-171.57 14410.96,-181.22 14437,-185.98 14490.01,-195.69 15353.31,-190.67 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert5_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge77" class="edge">
<title>expert5_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M14113.24,-162.02C14136.4,-171.57 14163.96,-181.22 14190,-185.98 14256.5,-198.16 15339.64,-191.87 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert6_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge78" class="edge">
<title>expert6_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M13866.24,-162.02C13889.4,-171.57 13916.96,-181.22 13943,-185.98 14023,-200.63 15325.97,-193.06 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert7_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge79" class="edge">
<title>expert7_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M13619.24,-162.02C13642.4,-171.57 13669.96,-181.22 13696,-185.98 13742.75,-194.54 15359.65,-190.12 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert8_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge80" class="edge">
<title>expert8_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M13372.24,-162.02C13395.4,-171.57 13422.96,-181.22 13449,-185.98 13502.5,-195.78 15352.82,-190.72 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert9_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge81" class="edge">
<title>expert9_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M13125.24,-162.02C13148.4,-171.57 13175.96,-181.22 13202,-185.98 13262.25,-197.01 15345.98,-191.31 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert10_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge82" class="edge">
<title>expert10_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M12878.24,-162.02C12901.4,-171.57 12928.96,-181.22 12955,-185.98 13022,-198.25 15339.15,-191.91 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert11_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge83" class="edge">
<title>expert11_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M12631.24,-162.02C12654.4,-171.57 12681.96,-181.22 12708,-185.98 12781.75,-199.48 15332.31,-192.51 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert12_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge84" class="edge">
<title>expert12_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M12384.24,-162.02C12407.4,-171.57 12434.96,-181.22 12461,-185.98 12541.49,-200.72 15325.48,-193.1 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert13_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge85" class="edge">
<title>expert13_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M12137.24,-162.02C12160.4,-171.57 12187.96,-181.22 12214,-185.98 12257.62,-193.97 15362.82,-189.84 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert14_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge86" class="edge">
<title>expert14_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M11890.24,-162.02C11913.4,-171.57 11940.96,-181.22 11967,-185.98 12014,-194.59 15359.4,-190.14 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- expert15_l2_dp0&#45;&gt;expert_agg_l2_dp0 -->
<g id="edge87" class="edge">
<title>expert15_l2_dp0&#45;&gt;expert_agg_l2_dp0</title>
<path fill="none" stroke="black" d="M11598.84,-162C11635.94,-171.58 11679.71,-181.25 11720,-185.98 11821.72,-197.93 15304.97,-194.9 15407,-185.98 15445.11,-182.65 15485.78,-176.86 15524.08,-170.36"/>
<polygon fill="black" stroke="black" points="15525.02,-173.75 15534.29,-168.6 15523.84,-166.85 15525.02,-173.75"/>
</g>
<!-- layer2_output_dp0 -->
<g id="node54" class="node">
<title>layer2_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="16143" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="16143" y="-144.48" font-family="Arial" font-size="10.00">Layer 2 Output</text>
<text text-anchor="middle" x="16143" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="16143" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l2_dp0&#45;&gt;layer2_output_dp0 -->
<g id="edge88" class="edge">
<title>expert_agg_l2_dp0&#45;&gt;layer2_output_dp0</title>
<path fill="none" stroke="black" d="M15888.31,-135.98C15913.49,-135.98 15938.66,-135.98 15963.84,-135.98"/>
<polygon fill="black" stroke="black" points="15963.87,-139.48 15973.87,-135.98 15963.87,-132.48 15963.87,-139.48"/>
</g>
<!-- attn_input_l3_dp0 -->
<g id="node55" class="node">
<title>attn_input_l3_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="16516" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="16516" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L3</text>
<text text-anchor="middle" x="16516" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="16516" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer2_output_dp0&#45;&gt;attn_input_l3_dp0 -->
<g id="edge89" class="edge">
<title>layer2_output_dp0&#45;&gt;attn_input_l3_dp0</title>
<path fill="none" stroke="black" d="M16312.01,-135.98C16320.23,-135.98 16328.44,-135.98 16336.66,-135.98"/>
<polygon fill="black" stroke="black" points="16336.68,-139.48 16346.68,-135.98 16336.68,-132.48 16336.68,-139.48"/>
</g>
<!-- attn_tp0_l3_dp0 -->
<g id="node56" class="node">
<title>attn_tp0_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="17814,-161.98 17554,-161.98 17554,-109.98 17814,-109.98 17814,-161.98"/>
<text text-anchor="middle" x="17684" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L3</text>
<text text-anchor="middle" x="17684" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="17684" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="17684" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp0&#45;&gt;attn_tp0_l3_dp0 -->
<g id="edge90" class="edge">
<title>attn_input_l3_dp0&#45;&gt;attn_tp0_l3_dp0</title>
<path fill="none" stroke="black" d="M16599.52,-161.26C16636.12,-171.09 16679.81,-181.13 16720,-185.98 16765,-191.42 17491.27,-193.33 17536,-185.98 17561.4,-181.81 17588.31,-173.85 17612.12,-165.5"/>
<polygon fill="black" stroke="black" points="17613.55,-168.71 17621.78,-162.03 17611.18,-162.12 17613.55,-168.71"/>
</g>
<!-- attn_tp1_l3_dp0 -->
<g id="node57" class="node">
<title>attn_tp1_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="17536,-161.98 17276,-161.98 17276,-109.98 17536,-109.98 17536,-161.98"/>
<text text-anchor="middle" x="17406" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L3</text>
<text text-anchor="middle" x="17406" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="17406" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="17406" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp0&#45;&gt;attn_tp1_l3_dp0 -->
<g id="edge91" class="edge">
<title>attn_input_l3_dp0&#45;&gt;attn_tp1_l3_dp0</title>
<path fill="none" stroke="black" d="M16599.52,-161.26C16636.12,-171.09 16679.81,-181.13 16720,-185.98 16779.35,-193.15 17199.01,-195.68 17258,-185.98 17283.4,-181.81 17310.31,-173.85 17334.12,-165.5"/>
<polygon fill="black" stroke="black" points="17335.55,-168.71 17343.78,-162.03 17333.18,-162.12 17335.55,-168.71"/>
</g>
<!-- attn_tp2_l3_dp0 -->
<g id="node58" class="node">
<title>attn_tp2_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="17258,-161.98 16998,-161.98 16998,-109.98 17258,-109.98 17258,-161.98"/>
<text text-anchor="middle" x="17128" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L3</text>
<text text-anchor="middle" x="17128" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="17128" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="17128" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp0&#45;&gt;attn_tp2_l3_dp0 -->
<g id="edge92" class="edge">
<title>attn_input_l3_dp0&#45;&gt;attn_tp2_l3_dp0</title>
<path fill="none" stroke="black" d="M16599.52,-161.26C16636.12,-171.09 16679.81,-181.13 16720,-185.98 16777.36,-192.91 16922.99,-195.35 16980,-185.98 17005.4,-181.81 17032.31,-173.85 17056.12,-165.5"/>
<polygon fill="black" stroke="black" points="17057.55,-168.71 17065.78,-162.03 17055.18,-162.12 17057.55,-168.71"/>
</g>
<!-- attn_tp3_l3_dp0 -->
<g id="node59" class="node">
<title>attn_tp3_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="16980,-161.98 16720,-161.98 16720,-109.98 16980,-109.98 16980,-161.98"/>
<text text-anchor="middle" x="16850" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L3</text>
<text text-anchor="middle" x="16850" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="16850" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="16850" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp0&#45;&gt;attn_tp3_l3_dp0 -->
<g id="edge93" class="edge">
<title>attn_input_l3_dp0&#45;&gt;attn_tp3_l3_dp0</title>
<path fill="none" stroke="black" d="M16685.28,-135.98C16693.35,-135.98 16701.42,-135.98 16709.49,-135.98"/>
<polygon fill="black" stroke="black" points="16709.7,-139.48 16719.7,-135.98 16709.7,-132.48 16709.7,-139.48"/>
</g>
<!-- allreduce_l3_dp0 -->
<g id="node60" class="node">
<title>allreduce_l3_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="18018" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="18018" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L3</text>
<text text-anchor="middle" x="18018" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="18018" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l3_dp0&#45;&gt;allreduce_l3_dp0 -->
<g id="edge94" class="edge">
<title>attn_tp0_l3_dp0&#45;&gt;allreduce_l3_dp0</title>
<path fill="none" stroke="black" d="M17814.14,-135.98C17822.35,-135.98 17830.56,-135.98 17838.77,-135.98"/>
<polygon fill="black" stroke="black" points="17838.78,-139.48 17848.78,-135.98 17838.78,-132.48 17838.78,-139.48"/>
</g>
<!-- attn_tp1_l3_dp0&#45;&gt;allreduce_l3_dp0 -->
<g id="edge95" class="edge">
<title>attn_tp1_l3_dp0&#45;&gt;allreduce_l3_dp0</title>
<path fill="none" stroke="black" d="M17468.22,-162.03C17494.24,-171.59 17525.1,-181.23 17554,-185.98 17611.01,-195.35 17756.64,-192.91 17814,-185.98 17850.57,-181.57 17890.05,-172.85 17924.44,-163.91"/>
<polygon fill="black" stroke="black" points="17925.7,-167.2 17934.47,-161.26 17923.91,-160.43 17925.7,-167.2"/>
</g>
<!-- attn_tp2_l3_dp0&#45;&gt;allreduce_l3_dp0 -->
<g id="edge96" class="edge">
<title>attn_tp2_l3_dp0&#45;&gt;allreduce_l3_dp0</title>
<path fill="none" stroke="black" d="M17190.22,-162.03C17216.24,-171.59 17247.1,-181.23 17276,-185.98 17334.98,-195.68 17754.65,-193.15 17814,-185.98 17850.57,-181.57 17890.05,-172.85 17924.44,-163.91"/>
<polygon fill="black" stroke="black" points="17925.7,-167.2 17934.47,-161.26 17923.91,-160.43 17925.7,-167.2"/>
</g>
<!-- attn_tp3_l3_dp0&#45;&gt;allreduce_l3_dp0 -->
<g id="edge97" class="edge">
<title>attn_tp3_l3_dp0&#45;&gt;allreduce_l3_dp0</title>
<path fill="none" stroke="black" d="M16912.22,-162.03C16938.24,-171.59 16969.1,-181.23 16998,-185.98 17042.73,-193.33 17768.99,-191.42 17814,-185.98 17850.57,-181.57 17890.05,-172.85 17924.44,-163.91"/>
<polygon fill="black" stroke="black" points="17925.7,-167.2 17934.47,-161.26 17923.91,-160.43 17925.7,-167.2"/>
</g>
<!-- moe_input_l3_dp0 -->
<g id="node61" class="node">
<title>moe_input_l3_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="18391" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="18391" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L3</text>
<text text-anchor="middle" x="18391" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="18391" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l3_dp0&#45;&gt;moe_input_l3_dp0 -->
<g id="edge98" class="edge">
<title>allreduce_l3_dp0&#45;&gt;moe_input_l3_dp0</title>
<path fill="none" stroke="black" d="M18187.01,-135.98C18195.23,-135.98 18203.44,-135.98 18211.66,-135.98"/>
<polygon fill="black" stroke="black" points="18211.68,-139.48 18221.68,-135.98 18211.68,-132.48 18211.68,-139.48"/>
</g>
<!-- router_l3_dp0 -->
<g id="node62" class="node">
<title>router_l3_dp0</title>
<polygon fill="lightyellow" stroke="black" points="19090.57,-176.98 18696.74,-176.98 18595.43,-94.98 18989.26,-94.98 19090.57,-176.98"/>
<text text-anchor="middle" x="18843" y="-144.48" font-family="Arial" font-size="10.00">Router L3</text>
<text text-anchor="middle" x="18843" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="18843" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l3_dp0&#45;&gt;router_l3_dp0 -->
<g id="edge99" class="edge">
<title>moe_input_l3_dp0&#45;&gt;router_l3_dp0</title>
<path fill="none" stroke="black" d="M18560.06,-135.98C18585.34,-135.98 18610.63,-135.98 18635.92,-135.98"/>
<polygon fill="black" stroke="black" points="18635.99,-139.48 18645.99,-135.98 18635.99,-132.48 18635.99,-139.48"/>
</g>
<!-- expert0_l3_dp0 -->
<g id="node63" class="node">
<title>expert0_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="23336.5,-161.98 23107.5,-161.98 23107.5,-109.98 23336.5,-109.98 23336.5,-161.98"/>
<text text-anchor="middle" x="23222" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L3</text>
<text text-anchor="middle" x="23222" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="23222" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="23222" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert0_l3_dp0 -->
<g id="edge100" class="edge">
<title>router_l3_dp0&#45;&gt;expert0_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19072.12,-161.89C19135.19,-168 19203.67,-173.69 19267,-176.98 19926.46,-211.28 21578.2,-207.43 22238.5,-198.98 22429.55,-196.54 22909.77,-209.77 23098,-176.98 23113.72,-174.24 23130.17,-169.91 23145.76,-165.07"/>
<polygon fill="black" stroke="black" points="23146.89,-168.38 23155.35,-162 23144.76,-161.72 23146.89,-168.38"/>
<text text-anchor="middle" x="22217" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l3_dp0 -->
<g id="node64" class="node">
<title>expert1_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="23089.5,-161.98 22860.5,-161.98 22860.5,-109.98 23089.5,-109.98 23089.5,-161.98"/>
<text text-anchor="middle" x="22975" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L3</text>
<text text-anchor="middle" x="22975" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="22975" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="22975" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert1_l3_dp0 -->
<g id="edge101" class="edge">
<title>router_l3_dp0&#45;&gt;expert1_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18988.67,-176.99C19027.3,-186.08 19069.21,-194.39 19108.5,-198.98 19127.48,-201.2 19132.39,-199.04 19151.5,-198.98 19357.03,-198.37 22648.18,-210.26 22851,-176.98 22866.93,-174.37 22883.6,-170.03 22899.36,-165.14"/>
<polygon fill="black" stroke="black" points="22900.58,-168.42 22909.03,-162.03 22898.44,-161.76 22900.58,-168.42"/>
<text text-anchor="middle" x="19130" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l3_dp0 -->
<g id="node65" class="node">
<title>expert2_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="22842.5,-161.98 22613.5,-161.98 22613.5,-109.98 22842.5,-109.98 22842.5,-161.98"/>
<text text-anchor="middle" x="22728" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L3</text>
<text text-anchor="middle" x="22728" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="22728" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="22728" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert2_l3_dp0 -->
<g id="edge102" class="edge">
<title>router_l3_dp0&#45;&gt;expert2_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19015.37,-177C19060.98,-186.1 19110.37,-194.39 19156.5,-198.98 19175.52,-200.87 19180.39,-199.04 19199.5,-198.98 19388.64,-198.37 22417.36,-207.66 22604,-176.98 22619.93,-174.36 22636.6,-170.03 22652.35,-165.14"/>
<polygon fill="black" stroke="black" points="22653.58,-168.42 22662.03,-162.03 22651.44,-161.75 22653.58,-168.42"/>
<text text-anchor="middle" x="19178" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l3_dp0 -->
<g id="node66" class="node">
<title>expert3_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="22595.5,-161.98 22366.5,-161.98 22366.5,-109.98 22595.5,-109.98 22595.5,-161.98"/>
<text text-anchor="middle" x="22481" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L3</text>
<text text-anchor="middle" x="22481" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="22481" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="22481" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert3_l3_dp0 -->
<g id="edge103" class="edge">
<title>router_l3_dp0&#45;&gt;expert3_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19042.02,-177C19094.62,-186.1 19151.5,-194.4 19204.5,-198.98 19223.54,-200.63 19228.39,-199.05 19247.5,-198.98 19593.01,-197.76 22016.08,-233.12 22357,-176.98 22372.93,-174.36 22389.6,-170.02 22405.35,-165.13"/>
<polygon fill="black" stroke="black" points="22406.58,-168.41 22415.03,-162.02 22404.44,-161.75 22406.58,-168.41"/>
<text text-anchor="middle" x="19226" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l3_dp0 -->
<g id="node67" class="node">
<title>expert4_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="22348.5,-161.98 22119.5,-161.98 22119.5,-109.98 22348.5,-109.98 22348.5,-161.98"/>
<text text-anchor="middle" x="22234" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L3</text>
<text text-anchor="middle" x="22234" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="22234" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="22234" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert4_l3_dp0 -->
<g id="edge104" class="edge">
<title>router_l3_dp0&#45;&gt;expert4_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19071.85,-161.73C19135,-167.85 19203.58,-173.58 19267,-176.98 19727.14,-201.68 20879.74,-205.57 21340.5,-198.98 21682.6,-194.09 21773.02,-236.2 22110,-176.98 22125.63,-174.24 22141.97,-169.93 22157.48,-165.12"/>
<polygon fill="black" stroke="black" points="22158.56,-168.45 22167.02,-162.07 22156.43,-161.78 22158.56,-168.45"/>
<text text-anchor="middle" x="21319" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l3_dp0 -->
<g id="node68" class="node">
<title>expert5_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="22101.5,-161.98 21872.5,-161.98 21872.5,-109.98 22101.5,-109.98 22101.5,-161.98"/>
<text text-anchor="middle" x="21987" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L3</text>
<text text-anchor="middle" x="21987" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="21987" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="21987" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert5_l3_dp0 -->
<g id="edge105" class="edge">
<title>router_l3_dp0&#45;&gt;expert5_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19068.65,-177.01C19128.23,-186.11 19192.61,-194.4 19252.5,-198.98 19271.55,-200.44 19276.39,-199.06 19295.5,-198.98 19580.78,-197.76 21581.54,-223.55 21863,-176.98 21878.93,-174.35 21895.59,-170 21911.35,-165.11"/>
<polygon fill="black" stroke="black" points="21912.58,-168.39 21921.03,-162 21910.44,-161.73 21912.58,-168.39"/>
<text text-anchor="middle" x="19274" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l3_dp0 -->
<g id="node69" class="node">
<title>expert6_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="21854.5,-161.98 21625.5,-161.98 21625.5,-109.98 21854.5,-109.98 21854.5,-161.98"/>
<text text-anchor="middle" x="21740" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L3</text>
<text text-anchor="middle" x="21740" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="21740" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="21740" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert6_l3_dp0 -->
<g id="edge106" class="edge">
<title>router_l3_dp0&#45;&gt;expert6_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19089.89,-176.28C19157.94,-185.66 19231.91,-194.28 19300.5,-198.98 19319.56,-200.29 19324.39,-199.08 19343.5,-198.98 19596.01,-197.76 21366.9,-218.34 21616,-176.98 21631.93,-174.34 21648.59,-169.99 21664.35,-165.1"/>
<polygon fill="black" stroke="black" points="21665.58,-168.38 21674.03,-161.99 21663.44,-161.71 21665.58,-168.38"/>
<text text-anchor="middle" x="19322" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l3_dp0 -->
<g id="node70" class="node">
<title>expert7_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="21607.5,-161.98 21378.5,-161.98 21378.5,-109.98 21607.5,-109.98 21607.5,-161.98"/>
<text text-anchor="middle" x="21493" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L3</text>
<text text-anchor="middle" x="21493" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="21493" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="21493" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert7_l3_dp0 -->
<g id="edge107" class="edge">
<title>router_l3_dp0&#45;&gt;expert7_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19085.08,-172.34C19168.36,-183.2 19262.33,-193.63 19348.5,-198.98 19367.57,-200.17 19372.39,-199.09 19391.5,-198.98 19611.23,-197.76 21152.26,-213.12 21369,-176.98 21384.83,-174.34 21401.4,-170.03 21417.07,-165.16"/>
<polygon fill="black" stroke="black" points="21418.25,-168.46 21426.7,-162.07 21416.11,-161.8 21418.25,-168.46"/>
<text text-anchor="middle" x="19370" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l3_dp0 -->
<g id="node71" class="node">
<title>expert8_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="21360.5,-161.98 21131.5,-161.98 21131.5,-109.98 21360.5,-109.98 21360.5,-161.98"/>
<text text-anchor="middle" x="21246" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L3</text>
<text text-anchor="middle" x="21246" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="21246" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="21246" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert8_l3_dp0 -->
<g id="edge108" class="edge">
<title>router_l3_dp0&#45;&gt;expert8_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19071.32,-161.37C19134.62,-167.51 19203.41,-173.34 19267,-176.98 19828.16,-209.12 19969.51,-209.45 20531.5,-198.98 20794.08,-194.09 20863.53,-223.56 21122,-176.98 21137.37,-174.21 21153.46,-169.96 21168.75,-165.23"/>
<polygon fill="black" stroke="black" points="21170.21,-168.44 21178.67,-162.06 21168.08,-161.77 21170.21,-168.44"/>
<text text-anchor="middle" x="20510" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l3_dp0 -->
<g id="node72" class="node">
<title>expert9_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="21113.5,-161.98 20884.5,-161.98 20884.5,-109.98 21113.5,-109.98 21113.5,-161.98"/>
<text text-anchor="middle" x="20999" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L3</text>
<text text-anchor="middle" x="20999" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="20999" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="20999" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert9_l3_dp0 -->
<g id="edge109" class="edge">
<title>router_l3_dp0&#45;&gt;expert9_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19080.88,-169.04C19178.47,-181.04 19292.7,-193.09 19396.5,-198.98 19560.53,-208.29 20713,-204.35 20875,-176.98 20890.83,-174.31 20907.39,-169.98 20923.06,-165.11"/>
<polygon fill="black" stroke="black" points="20924.24,-168.41 20932.69,-162.02 20922.1,-161.74 20924.24,-168.41"/>
<text text-anchor="middle" x="19418" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l3_dp0 -->
<g id="node73" class="node">
<title>expert10_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="20866.5,-161.98 20637.5,-161.98 20637.5,-109.98 20866.5,-109.98 20866.5,-161.98"/>
<text text-anchor="middle" x="20752" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L3</text>
<text text-anchor="middle" x="20752" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="20752" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="20752" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert10_l3_dp0 -->
<g id="edge110" class="edge">
<title>router_l3_dp0&#45;&gt;expert10_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19077.51,-166.28C19188.54,-179.16 19323.13,-192.64 19444.5,-198.98 19575.84,-205.84 20498.36,-199.14 20628,-176.98 20643.73,-174.29 20660.19,-169.98 20675.78,-165.15"/>
<polygon fill="black" stroke="black" points="20676.9,-168.46 20685.36,-162.08 20674.77,-161.79 20676.9,-168.46"/>
<text text-anchor="middle" x="19466" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l3_dp0 -->
<g id="node74" class="node">
<title>expert11_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="20619.5,-161.98 20390.5,-161.98 20390.5,-109.98 20619.5,-109.98 20619.5,-161.98"/>
<text text-anchor="middle" x="20505" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L3</text>
<text text-anchor="middle" x="20505" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="20505" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="20505" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert11_l3_dp0 -->
<g id="edge111" class="edge">
<title>router_l3_dp0&#45;&gt;expert11_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19074.44,-163.92C19198.26,-177.47 19353.46,-192.26 19492.5,-198.98 19689.77,-208.53 20186.43,-210.92 20381,-176.98 20396.72,-174.24 20413.17,-169.91 20428.76,-165.06"/>
<polygon fill="black" stroke="black" points="20429.89,-168.38 20438.35,-161.99 20427.75,-161.71 20429.89,-168.38"/>
<text text-anchor="middle" x="19514" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l3_dp0 -->
<g id="node75" class="node">
<title>expert12_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="20372.5,-161.98 20143.5,-161.98 20143.5,-109.98 20372.5,-109.98 20372.5,-161.98"/>
<text text-anchor="middle" x="20258" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L3</text>
<text text-anchor="middle" x="20258" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="20258" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="20258" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert12_l3_dp0 -->
<g id="edge112" class="edge">
<title>router_l3_dp0&#45;&gt;expert12_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19074.66,-164.01C19289.25,-186.58 19617.32,-212.5 19902.5,-198.98 20005.74,-194.09 20032.85,-198.23 20134,-176.98 20148.65,-173.9 20164,-169.69 20178.7,-165.12"/>
<polygon fill="black" stroke="black" points="20179.79,-168.45 20188.26,-162.08 20177.67,-161.78 20179.79,-168.45"/>
<text text-anchor="middle" x="19881" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l3_dp0 -->
<g id="node76" class="node">
<title>expert13_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="20125.5,-161.98 19896.5,-161.98 19896.5,-109.98 20125.5,-109.98 20125.5,-161.98"/>
<text text-anchor="middle" x="20011" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L3</text>
<text text-anchor="middle" x="20011" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="20011" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="20011" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert13_l3_dp0 -->
<g id="edge113" class="edge">
<title>router_l3_dp0&#45;&gt;expert13_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19083.38,-176.99C19296.6,-205.92 19615.44,-230.86 19887,-176.98 19901.96,-174.01 19917.62,-169.78 19932.58,-165.14"/>
<polygon fill="black" stroke="black" points="19933.83,-168.41 19942.29,-162.04 19931.7,-161.74 19933.83,-168.41"/>
<text text-anchor="middle" x="19562" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l3_dp0 -->
<g id="node77" class="node">
<title>expert14_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="19878.5,-161.98 19649.5,-161.98 19649.5,-109.98 19878.5,-109.98 19878.5,-161.98"/>
<text text-anchor="middle" x="19764" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L3</text>
<text text-anchor="middle" x="19764" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="19764" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="19764" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert14_l3_dp0 -->
<g id="edge114" class="edge">
<title>router_l3_dp0&#45;&gt;expert14_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19071.45,-161.26C19218.81,-176.09 19414.71,-193.04 19588.5,-198.98 19607.6,-199.64 19612.86,-203.19 19631.5,-198.98 19659.7,-192.62 19688.94,-179.52 19712.75,-166.9"/>
<polygon fill="black" stroke="black" points="19714.48,-169.94 19721.6,-162.1 19711.14,-163.79 19714.48,-169.94"/>
<text text-anchor="middle" x="19610" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l3_dp0 -->
<g id="node78" class="node">
<title>expert15_l3_dp0</title>
<polygon fill="lightgreen" stroke="black" points="19505.5,-161.98 19276.5,-161.98 19276.5,-109.98 19505.5,-109.98 19505.5,-161.98"/>
<text text-anchor="middle" x="19391" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L3</text>
<text text-anchor="middle" x="19391" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="19391" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="19391" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp0&#45;&gt;expert15_l3_dp0 -->
<g id="edge115" class="edge">
<title>router_l3_dp0&#45;&gt;expert15_l3_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19040.06,-135.98C19115.51,-135.98 19199.43,-135.98 19266.28,-135.98"/>
<polygon fill="black" stroke="black" points="19266.44,-139.48 19276.44,-135.98 19266.44,-132.48 19266.44,-139.48"/>
<text text-anchor="middle" x="19183.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l3_dp0 -->
<g id="node79" class="node">
<title>expert_agg_l3_dp0</title>
<polygon fill="lightyellow" stroke="black" points="23867.57,-176.98 23473.74,-176.98 23372.43,-94.98 23766.26,-94.98 23867.57,-176.98"/>
<text text-anchor="middle" x="23620" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L3</text>
<text text-anchor="middle" x="23620" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="23620" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge116" class="edge">
<title>expert0_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M23336.66,-135.98C23362.06,-135.98 23387.47,-135.98 23412.87,-135.98"/>
<polygon fill="black" stroke="black" points="23412.99,-139.48 23422.99,-135.98 23412.99,-132.48 23412.99,-139.48"/>
</g>
<!-- expert1_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge117" class="edge">
<title>expert1_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M23030.24,-162.02C23053.4,-171.57 23080.96,-181.22 23107,-185.98 23157.06,-195.15 23285.3,-190.41 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert2_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge118" class="edge">
<title>expert2_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M22783.24,-162.02C22806.4,-171.57 22833.96,-181.22 22860,-185.98 22912.02,-195.51 23283.31,-190.59 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert3_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge119" class="edge">
<title>expert3_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M22536.24,-162.02C22559.4,-171.57 22586.96,-181.22 22613,-185.98 22692.02,-200.45 23255.97,-192.97 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert4_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge120" class="edge">
<title>expert4_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M22289.24,-162.02C22312.4,-171.57 22339.96,-181.22 22366,-185.98 22419.01,-195.69 23282.31,-190.67 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert5_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge121" class="edge">
<title>expert5_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M22042.24,-162.02C22065.4,-171.57 22092.96,-181.22 22119,-185.98 22185.5,-198.16 23268.64,-191.87 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert6_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge122" class="edge">
<title>expert6_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M21795.24,-162.02C21818.4,-171.57 21845.96,-181.22 21872,-185.98 21952,-200.63 23254.97,-193.06 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert7_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge123" class="edge">
<title>expert7_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M21548.24,-162.02C21571.4,-171.57 21598.96,-181.22 21625,-185.98 21671.75,-194.54 23288.65,-190.12 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert8_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge124" class="edge">
<title>expert8_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M21301.24,-162.02C21324.4,-171.57 21351.96,-181.22 21378,-185.98 21431.5,-195.78 23281.82,-190.72 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert9_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge125" class="edge">
<title>expert9_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M21054.24,-162.02C21077.4,-171.57 21104.96,-181.22 21131,-185.98 21191.25,-197.01 23274.98,-191.31 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert10_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge126" class="edge">
<title>expert10_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M20807.24,-162.02C20830.4,-171.57 20857.96,-181.22 20884,-185.98 20951,-198.25 23268.15,-191.91 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert11_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge127" class="edge">
<title>expert11_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M20560.24,-162.02C20583.4,-171.57 20610.96,-181.22 20637,-185.98 20710.75,-199.48 23261.31,-192.51 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert12_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge128" class="edge">
<title>expert12_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M20313.24,-162.02C20336.4,-171.57 20363.96,-181.22 20390,-185.98 20470.49,-200.72 23254.48,-193.1 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert13_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge129" class="edge">
<title>expert13_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M20066.24,-162.02C20089.4,-171.57 20116.96,-181.22 20143,-185.98 20186.62,-193.97 23291.82,-189.84 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert14_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge130" class="edge">
<title>expert14_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M19819.24,-162.02C19842.4,-171.57 19869.96,-181.22 19896,-185.98 19943,-194.59 23288.4,-190.14 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- expert15_l3_dp0&#45;&gt;expert_agg_l3_dp0 -->
<g id="edge131" class="edge">
<title>expert15_l3_dp0&#45;&gt;expert_agg_l3_dp0</title>
<path fill="none" stroke="black" d="M19500.49,-162.01C19546.12,-171.59 19599.84,-181.26 19649,-185.98 19750.95,-195.77 23233.97,-194.9 23336,-185.98 23374.11,-182.65 23414.78,-176.86 23453.08,-170.36"/>
<polygon fill="black" stroke="black" points="23454.02,-173.75 23463.29,-168.6 23452.84,-166.85 23454.02,-173.75"/>
</g>
<!-- layer3_output_dp0 -->
<g id="node80" class="node">
<title>layer3_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="24072" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="24072" y="-144.48" font-family="Arial" font-size="10.00">Layer 3 Output</text>
<text text-anchor="middle" x="24072" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="24072" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l3_dp0&#45;&gt;layer3_output_dp0 -->
<g id="edge132" class="edge">
<title>expert_agg_l3_dp0&#45;&gt;layer3_output_dp0</title>
<path fill="none" stroke="black" d="M23817.31,-135.98C23842.49,-135.98 23867.66,-135.98 23892.84,-135.98"/>
<polygon fill="black" stroke="black" points="23892.87,-139.48 23902.87,-135.98 23892.87,-132.48 23892.87,-139.48"/>
</g>
<!-- attn_input_l4_dp0 -->
<g id="node81" class="node">
<title>attn_input_l4_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="24445" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="24445" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L4</text>
<text text-anchor="middle" x="24445" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="24445" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer3_output_dp0&#45;&gt;attn_input_l4_dp0 -->
<g id="edge133" class="edge">
<title>layer3_output_dp0&#45;&gt;attn_input_l4_dp0</title>
<path fill="none" stroke="black" d="M24241.01,-135.98C24249.23,-135.98 24257.44,-135.98 24265.66,-135.98"/>
<polygon fill="black" stroke="black" points="24265.68,-139.48 24275.68,-135.98 24265.68,-132.48 24265.68,-139.48"/>
</g>
<!-- attn_tp0_l4_dp0 -->
<g id="node82" class="node">
<title>attn_tp0_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="25743,-161.98 25483,-161.98 25483,-109.98 25743,-109.98 25743,-161.98"/>
<text text-anchor="middle" x="25613" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L4</text>
<text text-anchor="middle" x="25613" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="25613" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="25613" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp0&#45;&gt;attn_tp0_l4_dp0 -->
<g id="edge134" class="edge">
<title>attn_input_l4_dp0&#45;&gt;attn_tp0_l4_dp0</title>
<path fill="none" stroke="black" d="M24528.52,-161.26C24565.12,-171.09 24608.81,-181.13 24649,-185.98 24694,-191.42 25420.27,-193.33 25465,-185.98 25490.4,-181.81 25517.31,-173.85 25541.12,-165.5"/>
<polygon fill="black" stroke="black" points="25542.55,-168.71 25550.78,-162.03 25540.18,-162.12 25542.55,-168.71"/>
</g>
<!-- attn_tp1_l4_dp0 -->
<g id="node83" class="node">
<title>attn_tp1_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="25465,-161.98 25205,-161.98 25205,-109.98 25465,-109.98 25465,-161.98"/>
<text text-anchor="middle" x="25335" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L4</text>
<text text-anchor="middle" x="25335" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="25335" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="25335" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp0&#45;&gt;attn_tp1_l4_dp0 -->
<g id="edge135" class="edge">
<title>attn_input_l4_dp0&#45;&gt;attn_tp1_l4_dp0</title>
<path fill="none" stroke="black" d="M24528.52,-161.26C24565.12,-171.09 24608.81,-181.13 24649,-185.98 24708.35,-193.15 25128.01,-195.68 25187,-185.98 25212.4,-181.81 25239.31,-173.85 25263.12,-165.5"/>
<polygon fill="black" stroke="black" points="25264.55,-168.71 25272.78,-162.03 25262.18,-162.12 25264.55,-168.71"/>
</g>
<!-- attn_tp2_l4_dp0 -->
<g id="node84" class="node">
<title>attn_tp2_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="25187,-161.98 24927,-161.98 24927,-109.98 25187,-109.98 25187,-161.98"/>
<text text-anchor="middle" x="25057" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L4</text>
<text text-anchor="middle" x="25057" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="25057" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="25057" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp0&#45;&gt;attn_tp2_l4_dp0 -->
<g id="edge136" class="edge">
<title>attn_input_l4_dp0&#45;&gt;attn_tp2_l4_dp0</title>
<path fill="none" stroke="black" d="M24528.52,-161.26C24565.12,-171.09 24608.81,-181.13 24649,-185.98 24706.36,-192.91 24851.99,-195.35 24909,-185.98 24934.4,-181.81 24961.31,-173.85 24985.12,-165.5"/>
<polygon fill="black" stroke="black" points="24986.55,-168.71 24994.78,-162.03 24984.18,-162.12 24986.55,-168.71"/>
</g>
<!-- attn_tp3_l4_dp0 -->
<g id="node85" class="node">
<title>attn_tp3_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="24909,-161.98 24649,-161.98 24649,-109.98 24909,-109.98 24909,-161.98"/>
<text text-anchor="middle" x="24779" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L4</text>
<text text-anchor="middle" x="24779" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="24779" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="24779" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp0&#45;&gt;attn_tp3_l4_dp0 -->
<g id="edge137" class="edge">
<title>attn_input_l4_dp0&#45;&gt;attn_tp3_l4_dp0</title>
<path fill="none" stroke="black" d="M24614.28,-135.98C24622.35,-135.98 24630.42,-135.98 24638.49,-135.98"/>
<polygon fill="black" stroke="black" points="24638.7,-139.48 24648.7,-135.98 24638.7,-132.48 24638.7,-139.48"/>
</g>
<!-- allreduce_l4_dp0 -->
<g id="node86" class="node">
<title>allreduce_l4_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="25947" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="25947" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L4</text>
<text text-anchor="middle" x="25947" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="25947" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l4_dp0&#45;&gt;allreduce_l4_dp0 -->
<g id="edge138" class="edge">
<title>attn_tp0_l4_dp0&#45;&gt;allreduce_l4_dp0</title>
<path fill="none" stroke="black" d="M25743.14,-135.98C25751.35,-135.98 25759.56,-135.98 25767.77,-135.98"/>
<polygon fill="black" stroke="black" points="25767.78,-139.48 25777.78,-135.98 25767.78,-132.48 25767.78,-139.48"/>
</g>
<!-- attn_tp1_l4_dp0&#45;&gt;allreduce_l4_dp0 -->
<g id="edge139" class="edge">
<title>attn_tp1_l4_dp0&#45;&gt;allreduce_l4_dp0</title>
<path fill="none" stroke="black" d="M25397.22,-162.03C25423.24,-171.59 25454.1,-181.23 25483,-185.98 25540.01,-195.35 25685.64,-192.91 25743,-185.98 25779.57,-181.57 25819.05,-172.85 25853.44,-163.91"/>
<polygon fill="black" stroke="black" points="25854.7,-167.2 25863.47,-161.26 25852.91,-160.43 25854.7,-167.2"/>
</g>
<!-- attn_tp2_l4_dp0&#45;&gt;allreduce_l4_dp0 -->
<g id="edge140" class="edge">
<title>attn_tp2_l4_dp0&#45;&gt;allreduce_l4_dp0</title>
<path fill="none" stroke="black" d="M25119.22,-162.03C25145.24,-171.59 25176.1,-181.23 25205,-185.98 25263.98,-195.68 25683.65,-193.15 25743,-185.98 25779.57,-181.57 25819.05,-172.85 25853.44,-163.91"/>
<polygon fill="black" stroke="black" points="25854.7,-167.2 25863.47,-161.26 25852.91,-160.43 25854.7,-167.2"/>
</g>
<!-- attn_tp3_l4_dp0&#45;&gt;allreduce_l4_dp0 -->
<g id="edge141" class="edge">
<title>attn_tp3_l4_dp0&#45;&gt;allreduce_l4_dp0</title>
<path fill="none" stroke="black" d="M24841.22,-162.03C24867.24,-171.59 24898.1,-181.23 24927,-185.98 24971.73,-193.33 25697.99,-191.42 25743,-185.98 25779.57,-181.57 25819.05,-172.85 25853.44,-163.91"/>
<polygon fill="black" stroke="black" points="25854.7,-167.2 25863.47,-161.26 25852.91,-160.43 25854.7,-167.2"/>
</g>
<!-- moe_input_l4_dp0 -->
<g id="node87" class="node">
<title>moe_input_l4_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="26320" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="26320" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L4</text>
<text text-anchor="middle" x="26320" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="26320" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l4_dp0&#45;&gt;moe_input_l4_dp0 -->
<g id="edge142" class="edge">
<title>allreduce_l4_dp0&#45;&gt;moe_input_l4_dp0</title>
<path fill="none" stroke="black" d="M26116.01,-135.98C26124.23,-135.98 26132.44,-135.98 26140.66,-135.98"/>
<polygon fill="black" stroke="black" points="26140.68,-139.48 26150.68,-135.98 26140.68,-132.48 26140.68,-139.48"/>
</g>
<!-- router_l4_dp0 -->
<g id="node88" class="node">
<title>router_l4_dp0</title>
<polygon fill="lightyellow" stroke="black" points="27019.57,-176.98 26625.74,-176.98 26524.43,-94.98 26918.26,-94.98 27019.57,-176.98"/>
<text text-anchor="middle" x="26772" y="-144.48" font-family="Arial" font-size="10.00">Router L4</text>
<text text-anchor="middle" x="26772" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="26772" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l4_dp0&#45;&gt;router_l4_dp0 -->
<g id="edge143" class="edge">
<title>moe_input_l4_dp0&#45;&gt;router_l4_dp0</title>
<path fill="none" stroke="black" d="M26489.06,-135.98C26514.34,-135.98 26539.63,-135.98 26564.92,-135.98"/>
<polygon fill="black" stroke="black" points="26564.99,-139.48 26574.99,-135.98 26564.99,-132.48 26564.99,-139.48"/>
</g>
<!-- expert0_l4_dp0 -->
<g id="node89" class="node">
<title>expert0_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="31217.5,-161.98 30988.5,-161.98 30988.5,-109.98 31217.5,-109.98 31217.5,-161.98"/>
<text text-anchor="middle" x="31103" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L4</text>
<text text-anchor="middle" x="31103" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="31103" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="31103" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert0_l4_dp0 -->
<g id="edge144" class="edge">
<title>router_l4_dp0&#45;&gt;expert0_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27003.05,-163.45C27058.32,-168.97 27117.19,-173.99 27172,-176.98 27890.61,-216.16 29690.82,-196.54 30410.5,-198.98 30663.35,-199.84 30730.25,-222.4 30979,-176.98 30994.37,-174.18 31010.45,-169.91 31025.74,-165.17"/>
<polygon fill="black" stroke="black" points="31027.2,-168.38 31035.66,-162 31025.07,-161.71 31027.2,-168.38"/>
<text text-anchor="middle" x="30432" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l4_dp0 -->
<g id="node90" class="node">
<title>expert1_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="30970.5,-161.98 30741.5,-161.98 30741.5,-109.98 30970.5,-109.98 30970.5,-161.98"/>
<text text-anchor="middle" x="30856" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L4</text>
<text text-anchor="middle" x="30856" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="30856" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="30856" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert1_l4_dp0 -->
<g id="edge145" class="edge">
<title>router_l4_dp0&#45;&gt;expert1_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27002.79,-163.37C27058.14,-168.9 27117.11,-173.95 27172,-176.98 27774.77,-210.28 29284.86,-206.85 29888.5,-198.98 30075.99,-196.54 30547.28,-209.21 30732,-176.98 30747.72,-174.24 30764.17,-169.91 30779.76,-165.06"/>
<polygon fill="black" stroke="black" points="30780.89,-168.38 30789.35,-161.99 30778.75,-161.71 30780.89,-168.38"/>
<text text-anchor="middle" x="29867" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l4_dp0 -->
<g id="node91" class="node">
<title>expert2_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="30723.5,-161.98 30494.5,-161.98 30494.5,-109.98 30723.5,-109.98 30723.5,-161.98"/>
<text text-anchor="middle" x="30609" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L4</text>
<text text-anchor="middle" x="30609" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="30609" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="30609" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert2_l4_dp0 -->
<g id="edge146" class="edge">
<title>router_l4_dp0&#45;&gt;expert2_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26917.67,-176.99C26956.3,-186.08 26998.21,-194.39 27037.5,-198.98 27056.48,-201.2 27061.39,-199.04 27080.5,-198.98 27269.64,-198.37 30298.36,-207.66 30485,-176.98 30500.93,-174.36 30517.6,-170.03 30533.35,-165.14"/>
<polygon fill="black" stroke="black" points="30534.58,-168.42 30543.03,-162.03 30532.44,-161.75 30534.58,-168.42"/>
<text text-anchor="middle" x="27059" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l4_dp0 -->
<g id="node92" class="node">
<title>expert3_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="30476.5,-161.98 30247.5,-161.98 30247.5,-109.98 30476.5,-109.98 30476.5,-161.98"/>
<text text-anchor="middle" x="30362" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L4</text>
<text text-anchor="middle" x="30362" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="30362" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="30362" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert3_l4_dp0 -->
<g id="edge147" class="edge">
<title>router_l4_dp0&#45;&gt;expert3_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26944.37,-177C26989.98,-186.1 27039.37,-194.39 27085.5,-198.98 27104.52,-200.87 27109.39,-199.05 27128.5,-198.98 27474.01,-197.76 29897.08,-233.12 30238,-176.98 30253.93,-174.36 30270.6,-170.02 30286.35,-165.13"/>
<polygon fill="black" stroke="black" points="30287.58,-168.41 30296.03,-162.02 30285.44,-161.75 30287.58,-168.41"/>
<text text-anchor="middle" x="27107" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l4_dp0 -->
<g id="node93" class="node">
<title>expert4_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="30229.5,-161.98 30000.5,-161.98 30000.5,-109.98 30229.5,-109.98 30229.5,-161.98"/>
<text text-anchor="middle" x="30115" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L4</text>
<text text-anchor="middle" x="30115" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="30115" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="30115" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert4_l4_dp0 -->
<g id="edge148" class="edge">
<title>router_l4_dp0&#45;&gt;expert4_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26971.02,-177C27023.62,-186.1 27080.5,-194.4 27133.5,-198.98 27152.54,-200.63 27157.39,-199.06 27176.5,-198.98 27489.23,-197.76 29682.44,-227.91 29991,-176.98 30006.93,-174.35 30023.6,-170.01 30039.35,-165.12"/>
<polygon fill="black" stroke="black" points="30040.58,-168.4 30049.03,-162.01 30038.44,-161.74 30040.58,-168.4"/>
<text text-anchor="middle" x="27155" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l4_dp0 -->
<g id="node94" class="node">
<title>expert5_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="29982.5,-161.98 29753.5,-161.98 29753.5,-109.98 29982.5,-109.98 29982.5,-161.98"/>
<text text-anchor="middle" x="29868" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L4</text>
<text text-anchor="middle" x="29868" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="29868" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="29868" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert5_l4_dp0 -->
<g id="edge149" class="edge">
<title>router_l4_dp0&#45;&gt;expert5_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27002.54,-163.18C27057.96,-168.73 27117.03,-173.83 27172,-176.98 27578.81,-200.28 28598.07,-205.05 29005.5,-198.98 29333.83,-194.09 29420.62,-234.01 29744,-176.98 29759.62,-174.23 29775.97,-169.91 29791.48,-165.1"/>
<polygon fill="black" stroke="black" points="29792.56,-168.43 29801.01,-162.05 29790.42,-161.77 29792.56,-168.43"/>
<text text-anchor="middle" x="28984" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l4_dp0 -->
<g id="node95" class="node">
<title>expert6_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="29735.5,-161.98 29506.5,-161.98 29506.5,-109.98 29735.5,-109.98 29735.5,-161.98"/>
<text text-anchor="middle" x="29621" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L4</text>
<text text-anchor="middle" x="29621" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="29621" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="29621" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert6_l4_dp0 -->
<g id="edge150" class="edge">
<title>router_l4_dp0&#45;&gt;expert6_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26997.65,-177.01C27057.23,-186.11 27121.61,-194.4 27181.5,-198.98 27200.55,-200.44 27205.39,-199.08 27224.5,-198.98 27477.01,-197.76 29247.9,-218.34 29497,-176.98 29512.93,-174.34 29529.59,-169.99 29545.35,-165.1"/>
<polygon fill="black" stroke="black" points="29546.58,-168.38 29555.03,-161.99 29544.44,-161.71 29546.58,-168.38"/>
<text text-anchor="middle" x="27203" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l4_dp0 -->
<g id="node96" class="node">
<title>expert7_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="29488.5,-161.98 29259.5,-161.98 29259.5,-109.98 29488.5,-109.98 29488.5,-161.98"/>
<text text-anchor="middle" x="29374" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L4</text>
<text text-anchor="middle" x="29374" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="29374" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="29374" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert7_l4_dp0 -->
<g id="edge151" class="edge">
<title>router_l4_dp0&#45;&gt;expert7_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27018.89,-176.28C27086.94,-185.66 27160.91,-194.28 27229.5,-198.98 27248.56,-200.29 27253.39,-199.09 27272.5,-198.98 27492.23,-197.76 29033.26,-213.12 29250,-176.98 29265.83,-174.34 29282.4,-170.03 29298.07,-165.16"/>
<polygon fill="black" stroke="black" points="29299.25,-168.46 29307.7,-162.07 29297.11,-161.8 29299.25,-168.46"/>
<text text-anchor="middle" x="27251" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l4_dp0 -->
<g id="node97" class="node">
<title>expert8_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="29241.5,-161.98 29012.5,-161.98 29012.5,-109.98 29241.5,-109.98 29241.5,-161.98"/>
<text text-anchor="middle" x="29127" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L4</text>
<text text-anchor="middle" x="29127" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="29127" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="29127" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert8_l4_dp0 -->
<g id="edge152" class="edge">
<title>router_l4_dp0&#45;&gt;expert8_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27014.08,-172.34C27097.36,-183.2 27191.33,-193.63 27277.5,-198.98 27468.87,-210.86 28813.9,-208.7 29003,-176.98 29018.83,-174.33 29035.39,-170 29051.07,-165.14"/>
<polygon fill="black" stroke="black" points="29052.24,-168.44 29060.7,-162.05 29050.11,-161.77 29052.24,-168.44"/>
<text text-anchor="middle" x="27299" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l4_dp0 -->
<g id="node98" class="node">
<title>expert9_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="28994.5,-161.98 28765.5,-161.98 28765.5,-109.98 28994.5,-109.98 28994.5,-161.98"/>
<text text-anchor="middle" x="28880" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L4</text>
<text text-anchor="middle" x="28880" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="28880" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="28880" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert9_l4_dp0 -->
<g id="edge153" class="edge">
<title>router_l4_dp0&#45;&gt;expert9_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27002.03,-162.76C27057.61,-168.34 27116.87,-173.56 27172,-176.98 27640.31,-206.02 27758.39,-208.74 28227.5,-198.98 28462.54,-194.09 28524.72,-219.18 28756,-176.98 28771.37,-174.18 28787.45,-169.91 28802.74,-165.18"/>
<polygon fill="black" stroke="black" points="28804.2,-168.38 28812.66,-162.01 28802.07,-161.72 28804.2,-168.38"/>
<text text-anchor="middle" x="28206" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l4_dp0 -->
<g id="node99" class="node">
<title>expert10_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="28747.5,-161.98 28518.5,-161.98 28518.5,-109.98 28747.5,-109.98 28747.5,-161.98"/>
<text text-anchor="middle" x="28633" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L4</text>
<text text-anchor="middle" x="28633" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="28633" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="28633" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert10_l4_dp0 -->
<g id="edge154" class="edge">
<title>router_l4_dp0&#45;&gt;expert10_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27009.88,-169.04C27107.47,-181.04 27221.7,-193.09 27325.5,-198.98 27456.81,-206.43 28379.36,-199.14 28509,-176.98 28524.73,-174.29 28541.19,-169.98 28556.78,-165.15"/>
<polygon fill="black" stroke="black" points="28557.9,-168.46 28566.36,-162.08 28555.77,-161.79 28557.9,-168.46"/>
<text text-anchor="middle" x="27347" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l4_dp0 -->
<g id="node100" class="node">
<title>expert11_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="28500.5,-161.98 28271.5,-161.98 28271.5,-109.98 28500.5,-109.98 28500.5,-161.98"/>
<text text-anchor="middle" x="28386" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L4</text>
<text text-anchor="middle" x="28386" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="28386" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="28386" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert11_l4_dp0 -->
<g id="edge155" class="edge">
<title>router_l4_dp0&#45;&gt;expert11_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27006.51,-166.28C27117.54,-179.16 27252.13,-192.64 27373.5,-198.98 27570.73,-209.28 28067.43,-210.92 28262,-176.98 28277.72,-174.24 28294.17,-169.91 28309.76,-165.06"/>
<polygon fill="black" stroke="black" points="28310.89,-168.38 28319.35,-161.99 28308.75,-161.71 28310.89,-168.38"/>
<text text-anchor="middle" x="27395" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l4_dp0 -->
<g id="node101" class="node">
<title>expert12_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="28253.5,-161.98 28024.5,-161.98 28024.5,-109.98 28253.5,-109.98 28253.5,-161.98"/>
<text text-anchor="middle" x="28139" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L4</text>
<text text-anchor="middle" x="28139" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="28139" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="28139" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert12_l4_dp0 -->
<g id="edge156" class="edge">
<title>router_l4_dp0&#45;&gt;expert12_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26998.29,-159.74C27055,-165.54 27115.71,-171.62 27172,-176.98 27172,-176.98 28015,-176.98 28015,-176.98 28030.37,-174.19 28046.45,-169.93 28061.75,-165.2"/>
<polygon fill="black" stroke="black" points="28063.21,-168.41 28071.67,-162.03 28061.08,-161.74 28063.21,-168.41"/>
<text text-anchor="middle" x="27443" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l4_dp0 -->
<g id="node102" class="node">
<title>expert13_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="28006.5,-161.98 27777.5,-161.98 27777.5,-109.98 28006.5,-109.98 28006.5,-161.98"/>
<text text-anchor="middle" x="27892" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L4</text>
<text text-anchor="middle" x="27892" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="27892" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="27892" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert13_l4_dp0 -->
<g id="edge157" class="edge">
<title>router_l4_dp0&#45;&gt;expert13_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27018.61,-176.06C27196.88,-199.52 27443.36,-220.67 27659.5,-198.98 27710.66,-193.85 27766.31,-179.11 27810.33,-165.18"/>
<polygon fill="black" stroke="black" points="27811.66,-168.43 27820.11,-162.04 27809.52,-161.77 27811.66,-168.43"/>
<text text-anchor="middle" x="27638" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l4_dp0 -->
<g id="node103" class="node">
<title>expert14_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="27759.5,-161.98 27530.5,-161.98 27530.5,-109.98 27759.5,-109.98 27759.5,-161.98"/>
<text text-anchor="middle" x="27645" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L4</text>
<text text-anchor="middle" x="27645" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="27645" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="27645" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert14_l4_dp0 -->
<g id="edge158" class="edge">
<title>router_l4_dp0&#45;&gt;expert14_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27002.52,-163.01C27138.24,-177.37 27313.37,-193.22 27469.5,-198.98 27488.6,-199.69 27493.86,-203.19 27512.5,-198.98 27540.7,-192.62 27569.94,-179.52 27593.75,-166.9"/>
<polygon fill="black" stroke="black" points="27595.48,-169.94 27602.6,-162.1 27592.14,-163.79 27595.48,-169.94"/>
<text text-anchor="middle" x="27491" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l4_dp0 -->
<g id="node104" class="node">
<title>expert15_l4_dp0</title>
<polygon fill="lightgreen" stroke="black" points="27410.5,-161.98 27181.5,-161.98 27181.5,-109.98 27410.5,-109.98 27410.5,-161.98"/>
<text text-anchor="middle" x="27296" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L4</text>
<text text-anchor="middle" x="27296" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="27296" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="27296" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp0&#45;&gt;expert15_l4_dp0 -->
<g id="edge159" class="edge">
<title>router_l4_dp0&#45;&gt;expert15_l4_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26968.98,-135.98C27036.75,-135.98 27110.72,-135.98 27171.14,-135.98"/>
<polygon fill="black" stroke="black" points="27171.49,-139.48 27181.49,-135.98 27171.49,-132.48 27171.49,-139.48"/>
<text text-anchor="middle" x="27100.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l4_dp0 -->
<g id="node105" class="node">
<title>expert_agg_l4_dp0</title>
<polygon fill="lightyellow" stroke="black" points="31748.57,-176.98 31354.74,-176.98 31253.43,-94.98 31647.26,-94.98 31748.57,-176.98"/>
<text text-anchor="middle" x="31501" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L4</text>
<text text-anchor="middle" x="31501" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="31501" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge160" class="edge">
<title>expert0_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M31217.66,-135.98C31243.06,-135.98 31268.47,-135.98 31293.87,-135.98"/>
<polygon fill="black" stroke="black" points="31293.99,-139.48 31303.99,-135.98 31293.99,-132.48 31293.99,-139.48"/>
</g>
<!-- expert1_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge161" class="edge">
<title>expert1_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M30911.24,-162.02C30934.4,-171.57 30961.96,-181.22 30988,-185.98 31038.06,-195.15 31166.3,-190.41 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert2_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge162" class="edge">
<title>expert2_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M30664.24,-162.02C30687.4,-171.57 30714.96,-181.22 30741,-185.98 30793.02,-195.51 31164.31,-190.59 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert3_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge163" class="edge">
<title>expert3_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M30417.24,-162.02C30440.4,-171.57 30467.96,-181.22 30494,-185.98 30573.02,-200.45 31136.97,-192.97 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert4_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge164" class="edge">
<title>expert4_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M30170.24,-162.02C30193.4,-171.57 30220.96,-181.22 30247,-185.98 30300.01,-195.69 31163.31,-190.67 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert5_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge165" class="edge">
<title>expert5_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M29923.24,-162.02C29946.4,-171.57 29973.96,-181.22 30000,-185.98 30066.5,-198.16 31149.64,-191.87 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert6_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge166" class="edge">
<title>expert6_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M29676.24,-162.02C29699.4,-171.57 29726.96,-181.22 29753,-185.98 29833,-200.63 31135.97,-193.06 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert7_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge167" class="edge">
<title>expert7_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M29429.24,-162.02C29452.4,-171.57 29479.96,-181.22 29506,-185.98 29552.75,-194.54 31169.65,-190.12 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert8_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge168" class="edge">
<title>expert8_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M29182.24,-162.02C29205.4,-171.57 29232.96,-181.22 29259,-185.98 29312.5,-195.78 31162.82,-190.72 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert9_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge169" class="edge">
<title>expert9_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M28935.24,-162.02C28958.4,-171.57 28985.96,-181.22 29012,-185.98 29072.25,-197.01 31155.98,-191.31 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert10_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge170" class="edge">
<title>expert10_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M28688.24,-162.02C28711.4,-171.57 28738.96,-181.22 28765,-185.98 28832,-198.25 31149.15,-191.91 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert11_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge171" class="edge">
<title>expert11_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M28441.24,-162.02C28464.4,-171.57 28491.96,-181.22 28518,-185.98 28591.75,-199.48 31142.31,-192.51 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert12_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge172" class="edge">
<title>expert12_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M28194.24,-162.02C28217.4,-171.57 28244.96,-181.22 28271,-185.98 28351.49,-200.72 31135.48,-193.1 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert13_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge173" class="edge">
<title>expert13_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M27947.24,-162.02C27970.4,-171.57 27997.96,-181.22 28024,-185.98 28067.62,-193.97 31172.82,-189.84 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert14_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge174" class="edge">
<title>expert14_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M27700.24,-162.02C27723.4,-171.57 27750.96,-181.22 27777,-185.98 27824,-194.59 31169.4,-190.14 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- expert15_l4_dp0&#45;&gt;expert_agg_l4_dp0 -->
<g id="edge175" class="edge">
<title>expert15_l4_dp0&#45;&gt;expert_agg_l4_dp0</title>
<path fill="none" stroke="black" d="M27395.17,-162C27436.54,-171.59 27485.28,-181.26 27530,-185.98 27631.85,-196.74 31114.97,-194.9 31217,-185.98 31255.11,-182.65 31295.78,-176.86 31334.08,-170.36"/>
<polygon fill="black" stroke="black" points="31335.02,-173.75 31344.29,-168.6 31333.84,-166.85 31335.02,-173.75"/>
</g>
<!-- layer4_output_dp0 -->
<g id="node106" class="node">
<title>layer4_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="31953" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="31953" y="-144.48" font-family="Arial" font-size="10.00">Layer 4 Output</text>
<text text-anchor="middle" x="31953" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="31953" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l4_dp0&#45;&gt;layer4_output_dp0 -->
<g id="edge176" class="edge">
<title>expert_agg_l4_dp0&#45;&gt;layer4_output_dp0</title>
<path fill="none" stroke="black" d="M31698.31,-135.98C31723.49,-135.98 31748.66,-135.98 31773.84,-135.98"/>
<polygon fill="black" stroke="black" points="31773.87,-139.48 31783.87,-135.98 31773.87,-132.48 31773.87,-139.48"/>
</g>
<!-- attn_input_l5_dp0 -->
<g id="node107" class="node">
<title>attn_input_l5_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="32326" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="32326" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L5</text>
<text text-anchor="middle" x="32326" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="32326" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer4_output_dp0&#45;&gt;attn_input_l5_dp0 -->
<g id="edge177" class="edge">
<title>layer4_output_dp0&#45;&gt;attn_input_l5_dp0</title>
<path fill="none" stroke="black" d="M32122.01,-135.98C32130.23,-135.98 32138.44,-135.98 32146.66,-135.98"/>
<polygon fill="black" stroke="black" points="32146.68,-139.48 32156.68,-135.98 32146.68,-132.48 32146.68,-139.48"/>
</g>
<!-- attn_tp0_l5_dp0 -->
<g id="node108" class="node">
<title>attn_tp0_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="33624,-161.98 33364,-161.98 33364,-109.98 33624,-109.98 33624,-161.98"/>
<text text-anchor="middle" x="33494" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L5</text>
<text text-anchor="middle" x="33494" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="33494" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="33494" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp0&#45;&gt;attn_tp0_l5_dp0 -->
<g id="edge178" class="edge">
<title>attn_input_l5_dp0&#45;&gt;attn_tp0_l5_dp0</title>
<path fill="none" stroke="black" d="M32409.52,-161.26C32446.12,-171.09 32489.81,-181.13 32530,-185.98 32575,-191.42 33301.27,-193.33 33346,-185.98 33371.4,-181.81 33398.31,-173.85 33422.12,-165.5"/>
<polygon fill="black" stroke="black" points="33423.55,-168.71 33431.78,-162.03 33421.18,-162.12 33423.55,-168.71"/>
</g>
<!-- attn_tp1_l5_dp0 -->
<g id="node109" class="node">
<title>attn_tp1_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="33346,-161.98 33086,-161.98 33086,-109.98 33346,-109.98 33346,-161.98"/>
<text text-anchor="middle" x="33216" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L5</text>
<text text-anchor="middle" x="33216" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="33216" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="33216" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp0&#45;&gt;attn_tp1_l5_dp0 -->
<g id="edge179" class="edge">
<title>attn_input_l5_dp0&#45;&gt;attn_tp1_l5_dp0</title>
<path fill="none" stroke="black" d="M32409.52,-161.26C32446.12,-171.09 32489.81,-181.13 32530,-185.98 32589.35,-193.15 33009.01,-195.68 33068,-185.98 33093.4,-181.81 33120.31,-173.85 33144.12,-165.5"/>
<polygon fill="black" stroke="black" points="33145.55,-168.71 33153.78,-162.03 33143.18,-162.12 33145.55,-168.71"/>
</g>
<!-- attn_tp2_l5_dp0 -->
<g id="node110" class="node">
<title>attn_tp2_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="33068,-161.98 32808,-161.98 32808,-109.98 33068,-109.98 33068,-161.98"/>
<text text-anchor="middle" x="32938" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L5</text>
<text text-anchor="middle" x="32938" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="32938" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="32938" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp0&#45;&gt;attn_tp2_l5_dp0 -->
<g id="edge180" class="edge">
<title>attn_input_l5_dp0&#45;&gt;attn_tp2_l5_dp0</title>
<path fill="none" stroke="black" d="M32409.52,-161.26C32446.12,-171.09 32489.81,-181.13 32530,-185.98 32587.36,-192.91 32732.99,-195.35 32790,-185.98 32815.4,-181.81 32842.31,-173.85 32866.12,-165.5"/>
<polygon fill="black" stroke="black" points="32867.55,-168.71 32875.78,-162.03 32865.18,-162.12 32867.55,-168.71"/>
</g>
<!-- attn_tp3_l5_dp0 -->
<g id="node111" class="node">
<title>attn_tp3_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="32790,-161.98 32530,-161.98 32530,-109.98 32790,-109.98 32790,-161.98"/>
<text text-anchor="middle" x="32660" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L5</text>
<text text-anchor="middle" x="32660" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="32660" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="32660" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp0&#45;&gt;attn_tp3_l5_dp0 -->
<g id="edge181" class="edge">
<title>attn_input_l5_dp0&#45;&gt;attn_tp3_l5_dp0</title>
<path fill="none" stroke="black" d="M32495.28,-135.98C32503.35,-135.98 32511.42,-135.98 32519.49,-135.98"/>
<polygon fill="black" stroke="black" points="32519.7,-139.48 32529.7,-135.98 32519.7,-132.48 32519.7,-139.48"/>
</g>
<!-- allreduce_l5_dp0 -->
<g id="node112" class="node">
<title>allreduce_l5_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="33828" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="33828" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L5</text>
<text text-anchor="middle" x="33828" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="33828" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l5_dp0&#45;&gt;allreduce_l5_dp0 -->
<g id="edge182" class="edge">
<title>attn_tp0_l5_dp0&#45;&gt;allreduce_l5_dp0</title>
<path fill="none" stroke="black" d="M33624.14,-135.98C33632.35,-135.98 33640.56,-135.98 33648.77,-135.98"/>
<polygon fill="black" stroke="black" points="33648.78,-139.48 33658.78,-135.98 33648.78,-132.48 33648.78,-139.48"/>
</g>
<!-- attn_tp1_l5_dp0&#45;&gt;allreduce_l5_dp0 -->
<g id="edge183" class="edge">
<title>attn_tp1_l5_dp0&#45;&gt;allreduce_l5_dp0</title>
<path fill="none" stroke="black" d="M33278.22,-162.03C33304.24,-171.59 33335.1,-181.23 33364,-185.98 33421.01,-195.35 33566.64,-192.91 33624,-185.98 33660.57,-181.57 33700.05,-172.85 33734.44,-163.91"/>
<polygon fill="black" stroke="black" points="33735.7,-167.2 33744.47,-161.26 33733.91,-160.43 33735.7,-167.2"/>
</g>
<!-- attn_tp2_l5_dp0&#45;&gt;allreduce_l5_dp0 -->
<g id="edge184" class="edge">
<title>attn_tp2_l5_dp0&#45;&gt;allreduce_l5_dp0</title>
<path fill="none" stroke="black" d="M33000.22,-162.03C33026.24,-171.59 33057.1,-181.23 33086,-185.98 33144.98,-195.68 33564.65,-193.15 33624,-185.98 33660.57,-181.57 33700.05,-172.85 33734.44,-163.91"/>
<polygon fill="black" stroke="black" points="33735.7,-167.2 33744.47,-161.26 33733.91,-160.43 33735.7,-167.2"/>
</g>
<!-- attn_tp3_l5_dp0&#45;&gt;allreduce_l5_dp0 -->
<g id="edge185" class="edge">
<title>attn_tp3_l5_dp0&#45;&gt;allreduce_l5_dp0</title>
<path fill="none" stroke="black" d="M32722.22,-162.03C32748.24,-171.59 32779.1,-181.23 32808,-185.98 32852.73,-193.33 33578.99,-191.42 33624,-185.98 33660.57,-181.57 33700.05,-172.85 33734.44,-163.91"/>
<polygon fill="black" stroke="black" points="33735.7,-167.2 33744.47,-161.26 33733.91,-160.43 33735.7,-167.2"/>
</g>
<!-- moe_input_l5_dp0 -->
<g id="node113" class="node">
<title>moe_input_l5_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="34201" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="34201" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L5</text>
<text text-anchor="middle" x="34201" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="34201" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l5_dp0&#45;&gt;moe_input_l5_dp0 -->
<g id="edge186" class="edge">
<title>allreduce_l5_dp0&#45;&gt;moe_input_l5_dp0</title>
<path fill="none" stroke="black" d="M33997.01,-135.98C34005.23,-135.98 34013.44,-135.98 34021.66,-135.98"/>
<polygon fill="black" stroke="black" points="34021.68,-139.48 34031.68,-135.98 34021.68,-132.48 34021.68,-139.48"/>
</g>
<!-- router_l5_dp0 -->
<g id="node114" class="node">
<title>router_l5_dp0</title>
<polygon fill="lightyellow" stroke="black" points="34900.57,-176.98 34506.74,-176.98 34405.43,-94.98 34799.26,-94.98 34900.57,-176.98"/>
<text text-anchor="middle" x="34653" y="-144.48" font-family="Arial" font-size="10.00">Router L5</text>
<text text-anchor="middle" x="34653" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="34653" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l5_dp0&#45;&gt;router_l5_dp0 -->
<g id="edge187" class="edge">
<title>moe_input_l5_dp0&#45;&gt;router_l5_dp0</title>
<path fill="none" stroke="black" d="M34370.06,-135.98C34395.34,-135.98 34420.63,-135.98 34445.92,-135.98"/>
<polygon fill="black" stroke="black" points="34445.99,-139.48 34455.99,-135.98 34445.99,-132.48 34445.99,-139.48"/>
</g>
<!-- expert0_l5_dp0 -->
<g id="node115" class="node">
<title>expert0_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="39146.5,-161.98 38917.5,-161.98 38917.5,-109.98 39146.5,-109.98 39146.5,-161.98"/>
<text text-anchor="middle" x="39032" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L5</text>
<text text-anchor="middle" x="39032" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="39032" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="39032" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert0_l5_dp0 -->
<g id="edge188" class="edge">
<title>router_l5_dp0&#45;&gt;expert0_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34882.12,-161.92C34945.19,-168.02 35013.67,-173.71 35077,-176.98 35774.86,-213.09 37522.71,-196.54 38221.5,-198.98 38526.76,-200.05 38607.49,-230.66 38908,-176.98 38923.62,-174.19 38939.96,-169.86 38955.47,-165.05"/>
<polygon fill="black" stroke="black" points="38956.55,-168.38 38965,-161.99 38954.41,-161.71 38956.55,-168.38"/>
<text text-anchor="middle" x="38243" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l5_dp0 -->
<g id="node116" class="node">
<title>expert1_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="38899.5,-161.98 38670.5,-161.98 38670.5,-109.98 38899.5,-109.98 38899.5,-161.98"/>
<text text-anchor="middle" x="38785" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L5</text>
<text text-anchor="middle" x="38785" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="38785" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="38785" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert1_l5_dp0 -->
<g id="edge189" class="edge">
<title>router_l5_dp0&#45;&gt;expert1_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34798.67,-176.99C34837.3,-186.08 34879.21,-194.39 34918.5,-198.98 34937.48,-201.2 34942.39,-199.04 34961.5,-198.98 35167.03,-198.37 38458.18,-210.26 38661,-176.98 38676.93,-174.37 38693.6,-170.03 38709.36,-165.14"/>
<polygon fill="black" stroke="black" points="38710.58,-168.42 38719.03,-162.03 38708.44,-161.76 38710.58,-168.42"/>
<text text-anchor="middle" x="34940" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l5_dp0 -->
<g id="node117" class="node">
<title>expert2_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="38652.5,-161.98 38423.5,-161.98 38423.5,-109.98 38652.5,-109.98 38652.5,-161.98"/>
<text text-anchor="middle" x="38538" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L5</text>
<text text-anchor="middle" x="38538" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="38538" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="38538" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert2_l5_dp0 -->
<g id="edge190" class="edge">
<title>router_l5_dp0&#45;&gt;expert2_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34881.85,-161.81C34945,-167.93 35013.58,-173.64 35077,-176.98 35633.03,-206.29 37025.75,-206.35 37582.5,-198.98 37767.32,-196.54 38231.91,-208.78 38414,-176.98 38429.72,-174.24 38446.17,-169.9 38461.76,-165.06"/>
<polygon fill="black" stroke="black" points="38462.89,-168.37 38471.34,-161.99 38460.75,-161.71 38462.89,-168.37"/>
<text text-anchor="middle" x="37561" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l5_dp0 -->
<g id="node118" class="node">
<title>expert3_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="38405.5,-161.98 38176.5,-161.98 38176.5,-109.98 38405.5,-109.98 38405.5,-161.98"/>
<text text-anchor="middle" x="38291" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L5</text>
<text text-anchor="middle" x="38291" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="38291" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="38291" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert3_l5_dp0 -->
<g id="edge191" class="edge">
<title>router_l5_dp0&#45;&gt;expert3_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34825.37,-177C34870.98,-186.1 34920.37,-194.39 34966.5,-198.98 34985.52,-200.87 34990.39,-199.05 35009.5,-198.98 35360.34,-197.76 37820.82,-233.97 38167,-176.98 38182.93,-174.36 38199.6,-170.02 38215.35,-165.13"/>
<polygon fill="black" stroke="black" points="38216.58,-168.41 38225.03,-162.02 38214.44,-161.75 38216.58,-168.41"/>
<text text-anchor="middle" x="34988" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l5_dp0 -->
<g id="node119" class="node">
<title>expert4_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="38158.5,-161.98 37929.5,-161.98 37929.5,-109.98 38158.5,-109.98 38158.5,-161.98"/>
<text text-anchor="middle" x="38044" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L5</text>
<text text-anchor="middle" x="38044" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="38044" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="38044" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert4_l5_dp0 -->
<g id="edge192" class="edge">
<title>router_l5_dp0&#45;&gt;expert4_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34852.02,-177C34904.62,-186.1 34961.5,-194.4 35014.5,-198.98 35033.54,-200.63 35038.39,-199.06 35057.5,-198.98 35375.56,-197.76 37606.18,-228.76 37920,-176.98 37935.93,-174.35 37952.6,-170.01 37968.35,-165.12"/>
<polygon fill="black" stroke="black" points="37969.58,-168.4 37978.03,-162.01 37967.44,-161.74 37969.58,-168.4"/>
<text text-anchor="middle" x="35036" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l5_dp0 -->
<g id="node120" class="node">
<title>expert5_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="37911.5,-161.98 37682.5,-161.98 37682.5,-109.98 37911.5,-109.98 37911.5,-161.98"/>
<text text-anchor="middle" x="37797" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L5</text>
<text text-anchor="middle" x="37797" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="37797" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="37797" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert5_l5_dp0 -->
<g id="edge193" class="edge">
<title>router_l5_dp0&#45;&gt;expert5_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34878.65,-177.01C34938.23,-186.11 35002.61,-194.4 35062.5,-198.98 35081.55,-200.44 35086.39,-199.06 35105.5,-198.98 35390.78,-197.76 37391.54,-223.55 37673,-176.98 37688.93,-174.35 37705.59,-170 37721.35,-165.11"/>
<polygon fill="black" stroke="black" points="37722.58,-168.39 37731.03,-162 37720.44,-161.73 37722.58,-168.39"/>
<text text-anchor="middle" x="35084" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l5_dp0 -->
<g id="node121" class="node">
<title>expert6_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="37664.5,-161.98 37435.5,-161.98 37435.5,-109.98 37664.5,-109.98 37664.5,-161.98"/>
<text text-anchor="middle" x="37550" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L5</text>
<text text-anchor="middle" x="37550" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="37550" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="37550" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert6_l5_dp0 -->
<g id="edge194" class="edge">
<title>router_l5_dp0&#45;&gt;expert6_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34881.59,-161.58C34944.81,-167.7 35013.49,-173.48 35077,-176.98 35802.85,-217.02 35985.63,-210.19 36712.5,-198.98 37029.72,-194.09 37113.59,-232.24 37426,-176.98 37441.62,-174.22 37457.97,-169.9 37473.48,-165.09"/>
<polygon fill="black" stroke="black" points="37474.55,-168.42 37483.01,-162.04 37472.42,-161.75 37474.55,-168.42"/>
<text text-anchor="middle" x="36691" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l5_dp0 -->
<g id="node122" class="node">
<title>expert7_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="37417.5,-161.98 37188.5,-161.98 37188.5,-109.98 37417.5,-109.98 37417.5,-161.98"/>
<text text-anchor="middle" x="37303" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L5</text>
<text text-anchor="middle" x="37303" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="37303" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="37303" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert7_l5_dp0 -->
<g id="edge195" class="edge">
<title>router_l5_dp0&#45;&gt;expert7_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34899.89,-176.28C34967.94,-185.66 35041.91,-194.28 35110.5,-198.98 35129.56,-200.29 35134.39,-199.09 35153.5,-198.98 35378.56,-197.76 36956.99,-213.97 37179,-176.98 37194.83,-174.34 37211.4,-170.03 37227.07,-165.17"/>
<polygon fill="black" stroke="black" points="37228.25,-168.46 37236.7,-162.08 37226.11,-161.8 37228.25,-168.46"/>
<text text-anchor="middle" x="35132" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l5_dp0 -->
<g id="node123" class="node">
<title>expert8_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="37170.5,-161.98 36941.5,-161.98 36941.5,-109.98 37170.5,-109.98 37170.5,-161.98"/>
<text text-anchor="middle" x="37056" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L5</text>
<text text-anchor="middle" x="37056" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="37056" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="37056" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert8_l5_dp0 -->
<g id="edge196" class="edge">
<title>router_l5_dp0&#45;&gt;expert8_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34895.08,-172.34C34978.36,-183.2 35072.33,-193.63 35158.5,-198.98 35355.19,-211.19 36737.64,-209.55 36932,-176.98 36947.83,-174.33 36964.39,-170.01 36980.07,-165.14"/>
<polygon fill="black" stroke="black" points="36981.24,-168.44 36989.7,-162.05 36979.11,-161.78 36981.24,-168.44"/>
<text text-anchor="middle" x="35180" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l5_dp0 -->
<g id="node124" class="node">
<title>expert9_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="36923.5,-161.98 36694.5,-161.98 36694.5,-109.98 36923.5,-109.98 36923.5,-161.98"/>
<text text-anchor="middle" x="36809" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L5</text>
<text text-anchor="middle" x="36809" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="36809" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="36809" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert9_l5_dp0 -->
<g id="edge197" class="edge">
<title>router_l5_dp0&#45;&gt;expert9_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34890.88,-169.04C34988.47,-181.04 35102.7,-193.09 35206.5,-198.98 35370.53,-208.29 36523,-204.35 36685,-176.98 36700.83,-174.31 36717.39,-169.98 36733.06,-165.11"/>
<polygon fill="black" stroke="black" points="36734.24,-168.41 36742.69,-162.02 36732.1,-161.74 36734.24,-168.41"/>
<text text-anchor="middle" x="35228" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l5_dp0 -->
<g id="node125" class="node">
<title>expert10_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="36676.5,-161.98 36447.5,-161.98 36447.5,-109.98 36676.5,-109.98 36676.5,-161.98"/>
<text text-anchor="middle" x="36562" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L5</text>
<text text-anchor="middle" x="36562" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="36562" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="36562" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert10_l5_dp0 -->
<g id="edge198" class="edge">
<title>router_l5_dp0&#45;&gt;expert10_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34881.06,-161C34944.44,-167.15 35013.33,-173.08 35077,-176.98 35468.61,-201.02 35567.26,-208 35959.5,-198.98 36172.33,-194.09 36228.65,-215.65 36438,-176.98 36453.27,-174.16 36469.25,-169.92 36484.46,-165.21"/>
<polygon fill="black" stroke="black" points="36485.87,-168.43 36494.33,-162.06 36483.74,-161.76 36485.87,-168.43"/>
<text text-anchor="middle" x="35938" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l5_dp0 -->
<g id="node126" class="node">
<title>expert11_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="36429.5,-161.98 36200.5,-161.98 36200.5,-109.98 36429.5,-109.98 36429.5,-161.98"/>
<text text-anchor="middle" x="36315" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L5</text>
<text text-anchor="middle" x="36315" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="36315" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="36315" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert11_l5_dp0 -->
<g id="edge199" class="edge">
<title>router_l5_dp0&#45;&gt;expert11_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34887.51,-166.28C34998.54,-179.16 35133.13,-192.64 35254.5,-198.98 35462.38,-209.84 35985.9,-212.61 36191,-176.98 36206.72,-174.25 36223.18,-169.92 36238.77,-165.08"/>
<polygon fill="black" stroke="black" points="36239.89,-168.39 36248.35,-162.01 36237.76,-161.73 36239.89,-168.39"/>
<text text-anchor="middle" x="35276" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l5_dp0 -->
<g id="node127" class="node">
<title>expert12_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="36182.5,-161.98 35953.5,-161.98 35953.5,-109.98 36182.5,-109.98 36182.5,-161.98"/>
<text text-anchor="middle" x="36068" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L5</text>
<text text-anchor="middle" x="36068" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="36068" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="36068" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert12_l5_dp0 -->
<g id="edge200" class="edge">
<title>router_l5_dp0&#45;&gt;expert12_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34884.44,-163.92C35008.26,-177.47 35163.46,-192.26 35302.5,-198.98 35444.97,-205.88 35803.61,-202.24 35944,-176.98 35959.38,-174.22 35975.46,-169.97 35990.75,-165.24"/>
<polygon fill="black" stroke="black" points="35992.21,-168.44 36000.67,-162.07 35990.08,-161.78 35992.21,-168.44"/>
<text text-anchor="middle" x="35324" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l5_dp0 -->
<g id="node128" class="node">
<title>expert13_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="35935.5,-161.98 35706.5,-161.98 35706.5,-109.98 35935.5,-109.98 35935.5,-161.98"/>
<text text-anchor="middle" x="35821" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L5</text>
<text text-anchor="middle" x="35821" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="35821" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="35821" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert13_l5_dp0 -->
<g id="edge201" class="edge">
<title>router_l5_dp0&#45;&gt;expert13_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34893.38,-176.99C35106.6,-205.92 35425.44,-230.86 35697,-176.98 35711.96,-174.01 35727.62,-169.78 35742.58,-165.14"/>
<polygon fill="black" stroke="black" points="35743.83,-168.41 35752.29,-162.04 35741.7,-161.74 35743.83,-168.41"/>
<text text-anchor="middle" x="35372" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l5_dp0 -->
<g id="node129" class="node">
<title>expert14_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="35688.5,-161.98 35459.5,-161.98 35459.5,-109.98 35688.5,-109.98 35688.5,-161.98"/>
<text text-anchor="middle" x="35574" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L5</text>
<text text-anchor="middle" x="35574" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="35574" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="35574" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert14_l5_dp0 -->
<g id="edge202" class="edge">
<title>router_l5_dp0&#45;&gt;expert14_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34881.45,-161.26C35028.81,-176.09 35224.71,-193.04 35398.5,-198.98 35417.6,-199.64 35422.86,-203.19 35441.5,-198.98 35469.7,-192.62 35498.94,-179.52 35522.75,-166.9"/>
<polygon fill="black" stroke="black" points="35524.48,-169.94 35531.6,-162.1 35521.14,-163.79 35524.48,-169.94"/>
<text text-anchor="middle" x="35420" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l5_dp0 -->
<g id="node130" class="node">
<title>expert15_l5_dp0</title>
<polygon fill="lightgreen" stroke="black" points="35315.5,-161.98 35086.5,-161.98 35086.5,-109.98 35315.5,-109.98 35315.5,-161.98"/>
<text text-anchor="middle" x="35201" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L5</text>
<text text-anchor="middle" x="35201" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="35201" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="35201" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp0&#45;&gt;expert15_l5_dp0 -->
<g id="edge203" class="edge">
<title>router_l5_dp0&#45;&gt;expert15_l5_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34850.06,-135.98C34925.51,-135.98 35009.43,-135.98 35076.28,-135.98"/>
<polygon fill="black" stroke="black" points="35076.44,-139.48 35086.44,-135.98 35076.44,-132.48 35076.44,-139.48"/>
<text text-anchor="middle" x="34993.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l5_dp0 -->
<g id="node131" class="node">
<title>expert_agg_l5_dp0</title>
<polygon fill="lightyellow" stroke="black" points="39677.57,-176.98 39283.74,-176.98 39182.43,-94.98 39576.26,-94.98 39677.57,-176.98"/>
<text text-anchor="middle" x="39430" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L5</text>
<text text-anchor="middle" x="39430" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="39430" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge204" class="edge">
<title>expert0_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M39146.66,-135.98C39172.06,-135.98 39197.47,-135.98 39222.87,-135.98"/>
<polygon fill="black" stroke="black" points="39222.99,-139.48 39232.99,-135.98 39222.99,-132.48 39222.99,-139.48"/>
</g>
<!-- expert1_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge205" class="edge">
<title>expert1_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M38840.24,-162.02C38863.4,-171.57 38890.96,-181.22 38917,-185.98 38967.06,-195.15 39095.3,-190.41 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert2_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge206" class="edge">
<title>expert2_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M38593.24,-162.02C38616.4,-171.57 38643.96,-181.22 38670,-185.98 38722.02,-195.51 39093.31,-190.59 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert3_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge207" class="edge">
<title>expert3_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M38346.24,-162.02C38369.4,-171.57 38396.96,-181.22 38423,-185.98 38502.02,-200.45 39065.97,-192.97 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert4_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge208" class="edge">
<title>expert4_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M38099.24,-162.02C38122.4,-171.57 38149.96,-181.22 38176,-185.98 38229.01,-195.69 39092.31,-190.67 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert5_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge209" class="edge">
<title>expert5_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M37852.24,-162.02C37875.4,-171.57 37902.96,-181.22 37929,-185.98 37995.5,-198.16 39078.64,-191.87 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert6_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge210" class="edge">
<title>expert6_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M37605.24,-162.02C37628.4,-171.57 37655.96,-181.22 37682,-185.98 37762,-200.63 39064.97,-193.06 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert7_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge211" class="edge">
<title>expert7_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M37358.24,-162.02C37381.4,-171.57 37408.96,-181.22 37435,-185.98 37481.75,-194.54 39098.65,-190.12 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert8_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge212" class="edge">
<title>expert8_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M37111.24,-162.02C37134.4,-171.57 37161.96,-181.22 37188,-185.98 37241.5,-195.78 39091.82,-190.72 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert9_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge213" class="edge">
<title>expert9_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M36864.24,-162.02C36887.4,-171.57 36914.96,-181.22 36941,-185.98 37001.25,-197.01 39084.98,-191.31 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert10_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge214" class="edge">
<title>expert10_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M36617.24,-162.02C36640.4,-171.57 36667.96,-181.22 36694,-185.98 36761,-198.25 39078.15,-191.91 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert11_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge215" class="edge">
<title>expert11_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M36370.24,-162.02C36393.4,-171.57 36420.96,-181.22 36447,-185.98 36520.75,-199.48 39071.31,-192.51 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert12_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge216" class="edge">
<title>expert12_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M36123.24,-162.02C36146.4,-171.57 36173.96,-181.22 36200,-185.98 36280.49,-200.72 39064.48,-193.1 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert13_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge217" class="edge">
<title>expert13_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M35876.24,-162.02C35899.4,-171.57 35926.96,-181.22 35953,-185.98 35996.62,-193.97 39101.82,-189.84 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert14_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge218" class="edge">
<title>expert14_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M35629.24,-162.02C35652.4,-171.57 35679.96,-181.22 35706,-185.98 35753,-194.59 39098.4,-190.14 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- expert15_l5_dp0&#45;&gt;expert_agg_l5_dp0 -->
<g id="edge219" class="edge">
<title>expert15_l5_dp0&#45;&gt;expert_agg_l5_dp0</title>
<path fill="none" stroke="black" d="M35310.49,-162.01C35356.12,-171.59 35409.84,-181.26 35459,-185.98 35560.95,-195.77 39043.97,-194.9 39146,-185.98 39184.11,-182.65 39224.78,-176.86 39263.08,-170.36"/>
<polygon fill="black" stroke="black" points="39264.02,-173.75 39273.29,-168.6 39262.84,-166.85 39264.02,-173.75"/>
</g>
<!-- layer5_output_dp0 -->
<g id="node132" class="node">
<title>layer5_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="39882" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="39882" y="-144.48" font-family="Arial" font-size="10.00">Layer 5 Output</text>
<text text-anchor="middle" x="39882" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="39882" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l5_dp0&#45;&gt;layer5_output_dp0 -->
<g id="edge220" class="edge">
<title>expert_agg_l5_dp0&#45;&gt;layer5_output_dp0</title>
<path fill="none" stroke="black" d="M39627.31,-135.98C39652.49,-135.98 39677.66,-135.98 39702.84,-135.98"/>
<polygon fill="black" stroke="black" points="39702.87,-139.48 39712.87,-135.98 39702.87,-132.48 39702.87,-139.48"/>
</g>
<!-- attn_input_l6_dp0 -->
<g id="node133" class="node">
<title>attn_input_l6_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="40255" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="40255" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L6</text>
<text text-anchor="middle" x="40255" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="40255" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer5_output_dp0&#45;&gt;attn_input_l6_dp0 -->
<g id="edge221" class="edge">
<title>layer5_output_dp0&#45;&gt;attn_input_l6_dp0</title>
<path fill="none" stroke="black" d="M40051.01,-135.98C40059.23,-135.98 40067.44,-135.98 40075.66,-135.98"/>
<polygon fill="black" stroke="black" points="40075.68,-139.48 40085.68,-135.98 40075.68,-132.48 40075.68,-139.48"/>
</g>
<!-- attn_tp0_l6_dp0 -->
<g id="node134" class="node">
<title>attn_tp0_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="41553,-161.98 41293,-161.98 41293,-109.98 41553,-109.98 41553,-161.98"/>
<text text-anchor="middle" x="41423" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L6</text>
<text text-anchor="middle" x="41423" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="41423" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="41423" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp0&#45;&gt;attn_tp0_l6_dp0 -->
<g id="edge222" class="edge">
<title>attn_input_l6_dp0&#45;&gt;attn_tp0_l6_dp0</title>
<path fill="none" stroke="black" d="M40338.52,-161.26C40375.12,-171.09 40418.81,-181.13 40459,-185.98 40504,-191.42 41230.27,-193.33 41275,-185.98 41300.4,-181.81 41327.31,-173.85 41351.12,-165.5"/>
<polygon fill="black" stroke="black" points="41352.55,-168.71 41360.78,-162.03 41350.18,-162.12 41352.55,-168.71"/>
</g>
<!-- attn_tp1_l6_dp0 -->
<g id="node135" class="node">
<title>attn_tp1_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="41275,-161.98 41015,-161.98 41015,-109.98 41275,-109.98 41275,-161.98"/>
<text text-anchor="middle" x="41145" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L6</text>
<text text-anchor="middle" x="41145" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="41145" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="41145" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp0&#45;&gt;attn_tp1_l6_dp0 -->
<g id="edge223" class="edge">
<title>attn_input_l6_dp0&#45;&gt;attn_tp1_l6_dp0</title>
<path fill="none" stroke="black" d="M40338.52,-161.26C40375.12,-171.09 40418.81,-181.13 40459,-185.98 40518.35,-193.15 40938.01,-195.68 40997,-185.98 41022.4,-181.81 41049.31,-173.85 41073.12,-165.5"/>
<polygon fill="black" stroke="black" points="41074.55,-168.71 41082.78,-162.03 41072.18,-162.12 41074.55,-168.71"/>
</g>
<!-- attn_tp2_l6_dp0 -->
<g id="node136" class="node">
<title>attn_tp2_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="40997,-161.98 40737,-161.98 40737,-109.98 40997,-109.98 40997,-161.98"/>
<text text-anchor="middle" x="40867" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L6</text>
<text text-anchor="middle" x="40867" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="40867" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="40867" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp0&#45;&gt;attn_tp2_l6_dp0 -->
<g id="edge224" class="edge">
<title>attn_input_l6_dp0&#45;&gt;attn_tp2_l6_dp0</title>
<path fill="none" stroke="black" d="M40338.52,-161.26C40375.12,-171.09 40418.81,-181.13 40459,-185.98 40516.36,-192.91 40661.99,-195.35 40719,-185.98 40744.4,-181.81 40771.31,-173.85 40795.12,-165.5"/>
<polygon fill="black" stroke="black" points="40796.55,-168.71 40804.78,-162.03 40794.18,-162.12 40796.55,-168.71"/>
</g>
<!-- attn_tp3_l6_dp0 -->
<g id="node137" class="node">
<title>attn_tp3_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="40719,-161.98 40459,-161.98 40459,-109.98 40719,-109.98 40719,-161.98"/>
<text text-anchor="middle" x="40589" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L6</text>
<text text-anchor="middle" x="40589" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="40589" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="40589" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp0&#45;&gt;attn_tp3_l6_dp0 -->
<g id="edge225" class="edge">
<title>attn_input_l6_dp0&#45;&gt;attn_tp3_l6_dp0</title>
<path fill="none" stroke="black" d="M40424.28,-135.98C40432.35,-135.98 40440.42,-135.98 40448.49,-135.98"/>
<polygon fill="black" stroke="black" points="40448.7,-139.48 40458.7,-135.98 40448.7,-132.48 40448.7,-139.48"/>
</g>
<!-- allreduce_l6_dp0 -->
<g id="node138" class="node">
<title>allreduce_l6_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="41757" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="41757" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L6</text>
<text text-anchor="middle" x="41757" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="41757" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l6_dp0&#45;&gt;allreduce_l6_dp0 -->
<g id="edge226" class="edge">
<title>attn_tp0_l6_dp0&#45;&gt;allreduce_l6_dp0</title>
<path fill="none" stroke="black" d="M41553.14,-135.98C41561.35,-135.98 41569.56,-135.98 41577.77,-135.98"/>
<polygon fill="black" stroke="black" points="41577.78,-139.48 41587.78,-135.98 41577.78,-132.48 41577.78,-139.48"/>
</g>
<!-- attn_tp1_l6_dp0&#45;&gt;allreduce_l6_dp0 -->
<g id="edge227" class="edge">
<title>attn_tp1_l6_dp0&#45;&gt;allreduce_l6_dp0</title>
<path fill="none" stroke="black" d="M41207.22,-162.03C41233.24,-171.59 41264.1,-181.23 41293,-185.98 41350.01,-195.35 41495.64,-192.91 41553,-185.98 41589.57,-181.57 41629.05,-172.85 41663.44,-163.91"/>
<polygon fill="black" stroke="black" points="41664.7,-167.2 41673.47,-161.26 41662.91,-160.43 41664.7,-167.2"/>
</g>
<!-- attn_tp2_l6_dp0&#45;&gt;allreduce_l6_dp0 -->
<g id="edge228" class="edge">
<title>attn_tp2_l6_dp0&#45;&gt;allreduce_l6_dp0</title>
<path fill="none" stroke="black" d="M40929.22,-162.03C40955.24,-171.59 40986.1,-181.23 41015,-185.98 41073.98,-195.68 41493.65,-193.15 41553,-185.98 41589.57,-181.57 41629.05,-172.85 41663.44,-163.91"/>
<polygon fill="black" stroke="black" points="41664.7,-167.2 41673.47,-161.26 41662.91,-160.43 41664.7,-167.2"/>
</g>
<!-- attn_tp3_l6_dp0&#45;&gt;allreduce_l6_dp0 -->
<g id="edge229" class="edge">
<title>attn_tp3_l6_dp0&#45;&gt;allreduce_l6_dp0</title>
<path fill="none" stroke="black" d="M40651.22,-162.03C40677.24,-171.59 40708.1,-181.23 40737,-185.98 40781.73,-193.33 41507.99,-191.42 41553,-185.98 41589.57,-181.57 41629.05,-172.85 41663.44,-163.91"/>
<polygon fill="black" stroke="black" points="41664.7,-167.2 41673.47,-161.26 41662.91,-160.43 41664.7,-167.2"/>
</g>
<!-- moe_input_l6_dp0 -->
<g id="node139" class="node">
<title>moe_input_l6_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="42130" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="42130" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L6</text>
<text text-anchor="middle" x="42130" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="42130" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l6_dp0&#45;&gt;moe_input_l6_dp0 -->
<g id="edge230" class="edge">
<title>allreduce_l6_dp0&#45;&gt;moe_input_l6_dp0</title>
<path fill="none" stroke="black" d="M41926.01,-135.98C41934.23,-135.98 41942.44,-135.98 41950.66,-135.98"/>
<polygon fill="black" stroke="black" points="41950.68,-139.48 41960.68,-135.98 41950.68,-132.48 41950.68,-139.48"/>
</g>
<!-- router_l6_dp0 -->
<g id="node140" class="node">
<title>router_l6_dp0</title>
<polygon fill="lightyellow" stroke="black" points="42829.57,-176.98 42435.74,-176.98 42334.43,-94.98 42728.26,-94.98 42829.57,-176.98"/>
<text text-anchor="middle" x="42582" y="-144.48" font-family="Arial" font-size="10.00">Router L6</text>
<text text-anchor="middle" x="42582" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="42582" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l6_dp0&#45;&gt;router_l6_dp0 -->
<g id="edge231" class="edge">
<title>moe_input_l6_dp0&#45;&gt;router_l6_dp0</title>
<path fill="none" stroke="black" d="M42299.06,-135.98C42324.34,-135.98 42349.63,-135.98 42374.92,-135.98"/>
<polygon fill="black" stroke="black" points="42374.99,-139.48 42384.99,-135.98 42374.99,-132.48 42374.99,-139.48"/>
</g>
<!-- expert0_l6_dp0 -->
<g id="node141" class="node">
<title>expert0_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="47075.5,-161.98 46846.5,-161.98 46846.5,-109.98 47075.5,-109.98 47075.5,-161.98"/>
<text text-anchor="middle" x="46961" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L6</text>
<text text-anchor="middle" x="46961" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="46961" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="46961" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert0_l6_dp0 -->
<g id="edge232" class="edge">
<title>router_l6_dp0&#45;&gt;expert0_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42811.12,-161.91C42874.19,-168.01 42942.67,-173.7 43006,-176.98 43679.89,-211.94 45367.71,-196.54 46042.5,-198.98 46219.12,-199.62 46663.05,-207.61 46837,-176.98 46852.62,-174.23 46868.97,-169.92 46884.48,-165.11"/>
<polygon fill="black" stroke="black" points="46885.56,-168.44 46894.02,-162.06 46883.42,-161.77 46885.56,-168.44"/>
<text text-anchor="middle" x="46064" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l6_dp0 -->
<g id="node142" class="node">
<title>expert1_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="46828.5,-161.98 46599.5,-161.98 46599.5,-109.98 46828.5,-109.98 46828.5,-161.98"/>
<text text-anchor="middle" x="46714" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L6</text>
<text text-anchor="middle" x="46714" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="46714" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="46714" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert1_l6_dp0 -->
<g id="edge233" class="edge">
<title>router_l6_dp0&#45;&gt;expert1_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42727.67,-176.99C42766.3,-186.08 42808.21,-194.39 42847.5,-198.98 42866.48,-201.2 42871.39,-199.04 42890.5,-198.98 43096.03,-198.37 46387.18,-210.26 46590,-176.98 46605.93,-174.37 46622.6,-170.03 46638.36,-165.14"/>
<polygon fill="black" stroke="black" points="46639.58,-168.42 46648.03,-162.03 46637.44,-161.76 46639.58,-168.42"/>
<text text-anchor="middle" x="42869" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l6_dp0 -->
<g id="node143" class="node">
<title>expert2_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="46581.5,-161.98 46352.5,-161.98 46352.5,-109.98 46581.5,-109.98 46581.5,-161.98"/>
<text text-anchor="middle" x="46467" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L6</text>
<text text-anchor="middle" x="46467" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="46467" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="46467" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert2_l6_dp0 -->
<g id="edge234" class="edge">
<title>router_l6_dp0&#45;&gt;expert2_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42754.37,-177C42799.98,-186.1 42849.37,-194.39 42895.5,-198.98 42914.52,-200.87 42919.39,-199.04 42938.5,-198.98 43127.64,-198.37 46156.36,-207.66 46343,-176.98 46358.93,-174.36 46375.6,-170.03 46391.35,-165.14"/>
<polygon fill="black" stroke="black" points="46392.58,-168.42 46401.03,-162.03 46390.44,-161.75 46392.58,-168.42"/>
<text text-anchor="middle" x="42917" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l6_dp0 -->
<g id="node144" class="node">
<title>expert3_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="46334.5,-161.98 46105.5,-161.98 46105.5,-109.98 46334.5,-109.98 46334.5,-161.98"/>
<text text-anchor="middle" x="46220" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L6</text>
<text text-anchor="middle" x="46220" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="46220" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="46220" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert3_l6_dp0 -->
<g id="edge235" class="edge">
<title>router_l6_dp0&#45;&gt;expert3_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42810.85,-161.77C42874,-167.89 42942.58,-173.61 43006,-176.98 43514.08,-203.99 44786.75,-205.97 45295.5,-198.98 45651.38,-194.09 45745.42,-238.39 46096,-176.98 46111.63,-174.25 46127.98,-169.94 46143.49,-165.13"/>
<polygon fill="black" stroke="black" points="46144.56,-168.46 46153.02,-162.08 46142.43,-161.79 46144.56,-168.46"/>
<text text-anchor="middle" x="45274" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l6_dp0 -->
<g id="node145" class="node">
<title>expert4_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="46087.5,-161.98 45858.5,-161.98 45858.5,-109.98 46087.5,-109.98 46087.5,-161.98"/>
<text text-anchor="middle" x="45973" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L6</text>
<text text-anchor="middle" x="45973" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="45973" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="45973" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert4_l6_dp0 -->
<g id="edge236" class="edge">
<title>router_l6_dp0&#45;&gt;expert4_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42781.02,-177C42833.62,-186.1 42890.5,-194.4 42943.5,-198.98 42962.54,-200.63 42967.39,-199.06 42986.5,-198.98 43304.56,-197.76 45535.18,-228.76 45849,-176.98 45864.93,-174.35 45881.6,-170.01 45897.35,-165.12"/>
<polygon fill="black" stroke="black" points="45898.58,-168.4 45907.03,-162.01 45896.44,-161.74 45898.58,-168.4"/>
<text text-anchor="middle" x="42965" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l6_dp0 -->
<g id="node146" class="node">
<title>expert5_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="45840.5,-161.98 45611.5,-161.98 45611.5,-109.98 45840.5,-109.98 45840.5,-161.98"/>
<text text-anchor="middle" x="45726" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L6</text>
<text text-anchor="middle" x="45726" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="45726" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="45726" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert5_l6_dp0 -->
<g id="edge237" class="edge">
<title>router_l6_dp0&#45;&gt;expert5_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42807.65,-177.01C42867.23,-186.11 42931.61,-194.4 42991.5,-198.98 43010.55,-200.44 43015.39,-199.06 43034.5,-198.98 43319.78,-197.76 45320.54,-223.55 45602,-176.98 45617.93,-174.35 45634.59,-170 45650.35,-165.11"/>
<polygon fill="black" stroke="black" points="45651.58,-168.39 45660.03,-162 45649.44,-161.73 45651.58,-168.39"/>
<text text-anchor="middle" x="43013" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l6_dp0 -->
<g id="node147" class="node">
<title>expert6_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="45593.5,-161.98 45364.5,-161.98 45364.5,-109.98 45593.5,-109.98 45593.5,-161.98"/>
<text text-anchor="middle" x="45479" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L6</text>
<text text-anchor="middle" x="45479" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="45479" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="45479" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert6_l6_dp0 -->
<g id="edge238" class="edge">
<title>router_l6_dp0&#45;&gt;expert6_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42828.89,-176.28C42896.94,-185.66 42970.91,-194.28 43039.5,-198.98 43058.56,-200.29 43063.39,-199.08 43082.5,-198.98 43335.01,-197.76 45105.9,-218.34 45355,-176.98 45370.93,-174.34 45387.59,-169.99 45403.35,-165.1"/>
<polygon fill="black" stroke="black" points="45404.58,-168.38 45413.03,-161.99 45402.44,-161.71 45404.58,-168.38"/>
<text text-anchor="middle" x="43061" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l6_dp0 -->
<g id="node148" class="node">
<title>expert7_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="45346.5,-161.98 45117.5,-161.98 45117.5,-109.98 45346.5,-109.98 45346.5,-161.98"/>
<text text-anchor="middle" x="45232" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L6</text>
<text text-anchor="middle" x="45232" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="45232" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="45232" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert7_l6_dp0 -->
<g id="edge239" class="edge">
<title>router_l6_dp0&#45;&gt;expert7_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42810.59,-161.5C42873.81,-167.63 42942.5,-173.42 43006,-176.98 43649.28,-213.06 43811.29,-209.84 44455.5,-198.98 44745.62,-194.09 44822.34,-227.94 45108,-176.98 45123.62,-174.2 45139.96,-169.87 45155.47,-165.05"/>
<polygon fill="black" stroke="black" points="45156.55,-168.38 45165.01,-162 45154.41,-161.72 45156.55,-168.38"/>
<text text-anchor="middle" x="44434" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l6_dp0 -->
<g id="node149" class="node">
<title>expert8_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="45099.5,-161.98 44870.5,-161.98 44870.5,-109.98 45099.5,-109.98 45099.5,-161.98"/>
<text text-anchor="middle" x="44985" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L6</text>
<text text-anchor="middle" x="44985" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="44985" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="44985" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert8_l6_dp0 -->
<g id="edge240" class="edge">
<title>router_l6_dp0&#45;&gt;expert8_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42824.08,-172.34C42907.36,-183.2 43001.33,-193.63 43087.5,-198.98 43284.19,-211.19 44666.64,-209.55 44861,-176.98 44876.83,-174.33 44893.39,-170.01 44909.07,-165.14"/>
<polygon fill="black" stroke="black" points="44910.24,-168.44 44918.7,-162.05 44908.11,-161.78 44910.24,-168.44"/>
<text text-anchor="middle" x="43109" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l6_dp0 -->
<g id="node150" class="node">
<title>expert9_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="44852.5,-161.98 44623.5,-161.98 44623.5,-109.98 44852.5,-109.98 44852.5,-161.98"/>
<text text-anchor="middle" x="44738" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L6</text>
<text text-anchor="middle" x="44738" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="44738" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="44738" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert9_l6_dp0 -->
<g id="edge241" class="edge">
<title>router_l6_dp0&#45;&gt;expert9_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42819.88,-169.04C42917.47,-181.04 43031.7,-193.09 43135.5,-198.98 43299.53,-208.29 44452,-204.35 44614,-176.98 44629.83,-174.31 44646.39,-169.98 44662.06,-165.11"/>
<polygon fill="black" stroke="black" points="44663.24,-168.41 44671.69,-162.02 44661.1,-161.74 44663.24,-168.41"/>
<text text-anchor="middle" x="43157" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l6_dp0 -->
<g id="node151" class="node">
<title>expert10_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="44605.5,-161.98 44376.5,-161.98 44376.5,-109.98 44605.5,-109.98 44605.5,-161.98"/>
<text text-anchor="middle" x="44491" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L6</text>
<text text-anchor="middle" x="44491" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="44491" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="44491" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert10_l6_dp0 -->
<g id="edge242" class="edge">
<title>router_l6_dp0&#45;&gt;expert10_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42816.51,-166.28C42927.54,-179.16 43062.13,-192.64 43183.5,-198.98 43314.84,-205.84 44237.36,-199.14 44367,-176.98 44382.73,-174.29 44399.19,-169.98 44414.78,-165.15"/>
<polygon fill="black" stroke="black" points="44415.9,-168.46 44424.36,-162.08 44413.77,-161.79 44415.9,-168.46"/>
<text text-anchor="middle" x="43205" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l6_dp0 -->
<g id="node152" class="node">
<title>expert11_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="44358.5,-161.98 44129.5,-161.98 44129.5,-109.98 44358.5,-109.98 44358.5,-161.98"/>
<text text-anchor="middle" x="44244" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L6</text>
<text text-anchor="middle" x="44244" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="44244" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="44244" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert11_l6_dp0 -->
<g id="edge243" class="edge">
<title>router_l6_dp0&#45;&gt;expert11_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42809.53,-160.76C42873.05,-166.92 42942.16,-172.92 43006,-176.98 43342.57,-198.41 43427.41,-209.4 43764.5,-198.98 43922.73,-194.09 43964.56,-206.97 44120,-176.98 44135.07,-174.08 44150.83,-169.84 44165.88,-165.18"/>
<polygon fill="black" stroke="black" points="44167.18,-168.44 44175.64,-162.07 44165.05,-161.77 44167.18,-168.44"/>
<text text-anchor="middle" x="43743" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l6_dp0 -->
<g id="node153" class="node">
<title>expert12_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="44111.5,-161.98 43882.5,-161.98 43882.5,-109.98 44111.5,-109.98 44111.5,-161.98"/>
<text text-anchor="middle" x="43997" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L6</text>
<text text-anchor="middle" x="43997" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="43997" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="43997" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert12_l6_dp0 -->
<g id="edge244" class="edge">
<title>router_l6_dp0&#45;&gt;expert12_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42813.44,-163.92C42937.26,-177.47 43092.46,-192.26 43231.5,-198.98 43373.97,-205.88 43732.61,-202.24 43873,-176.98 43888.38,-174.22 43904.46,-169.97 43919.75,-165.24"/>
<polygon fill="black" stroke="black" points="43921.21,-168.44 43929.67,-162.07 43919.08,-161.78 43921.21,-168.44"/>
<text text-anchor="middle" x="43253" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l6_dp0 -->
<g id="node154" class="node">
<title>expert13_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="43864.5,-161.98 43635.5,-161.98 43635.5,-109.98 43864.5,-109.98 43864.5,-161.98"/>
<text text-anchor="middle" x="43750" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L6</text>
<text text-anchor="middle" x="43750" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="43750" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="43750" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert13_l6_dp0 -->
<g id="edge245" class="edge">
<title>router_l6_dp0&#45;&gt;expert13_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42822.38,-176.99C43035.6,-205.92 43354.44,-230.86 43626,-176.98 43640.96,-174.01 43656.62,-169.78 43671.58,-165.14"/>
<polygon fill="black" stroke="black" points="43672.83,-168.41 43681.29,-162.04 43670.7,-161.74 43672.83,-168.41"/>
<text text-anchor="middle" x="43301" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l6_dp0 -->
<g id="node155" class="node">
<title>expert14_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="43617.5,-161.98 43388.5,-161.98 43388.5,-109.98 43617.5,-109.98 43617.5,-161.98"/>
<text text-anchor="middle" x="43503" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L6</text>
<text text-anchor="middle" x="43503" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="43503" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="43503" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert14_l6_dp0 -->
<g id="edge246" class="edge">
<title>router_l6_dp0&#45;&gt;expert14_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42810.45,-161.26C42957.81,-176.09 43153.71,-193.04 43327.5,-198.98 43346.6,-199.64 43351.86,-203.19 43370.5,-198.98 43398.7,-192.62 43427.94,-179.52 43451.75,-166.9"/>
<polygon fill="black" stroke="black" points="43453.48,-169.94 43460.6,-162.1 43450.14,-163.79 43453.48,-169.94"/>
<text text-anchor="middle" x="43349" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l6_dp0 -->
<g id="node156" class="node">
<title>expert15_l6_dp0</title>
<polygon fill="lightgreen" stroke="black" points="43244.5,-161.98 43015.5,-161.98 43015.5,-109.98 43244.5,-109.98 43244.5,-161.98"/>
<text text-anchor="middle" x="43130" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L6</text>
<text text-anchor="middle" x="43130" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="43130" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="43130" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp0&#45;&gt;expert15_l6_dp0 -->
<g id="edge247" class="edge">
<title>router_l6_dp0&#45;&gt;expert15_l6_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M42779.06,-135.98C42854.51,-135.98 42938.43,-135.98 43005.28,-135.98"/>
<polygon fill="black" stroke="black" points="43005.44,-139.48 43015.44,-135.98 43005.44,-132.48 43005.44,-139.48"/>
<text text-anchor="middle" x="42922.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l6_dp0 -->
<g id="node157" class="node">
<title>expert_agg_l6_dp0</title>
<polygon fill="lightyellow" stroke="black" points="47606.57,-176.98 47212.74,-176.98 47111.43,-94.98 47505.26,-94.98 47606.57,-176.98"/>
<text text-anchor="middle" x="47359" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L6</text>
<text text-anchor="middle" x="47359" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="47359" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge248" class="edge">
<title>expert0_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M47075.66,-135.98C47101.06,-135.98 47126.47,-135.98 47151.87,-135.98"/>
<polygon fill="black" stroke="black" points="47151.99,-139.48 47161.99,-135.98 47151.99,-132.48 47151.99,-139.48"/>
</g>
<!-- expert1_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge249" class="edge">
<title>expert1_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M46769.24,-162.02C46792.4,-171.57 46819.96,-181.22 46846,-185.98 46896.06,-195.15 47024.3,-190.41 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert2_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge250" class="edge">
<title>expert2_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M46522.24,-162.02C46545.4,-171.57 46572.96,-181.22 46599,-185.98 46651.02,-195.51 47022.31,-190.59 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert3_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge251" class="edge">
<title>expert3_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M46275.24,-162.02C46298.4,-171.57 46325.96,-181.22 46352,-185.98 46431.02,-200.45 46994.97,-192.97 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert4_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge252" class="edge">
<title>expert4_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M46028.24,-162.02C46051.4,-171.57 46078.96,-181.22 46105,-185.98 46158.01,-195.69 47021.31,-190.67 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert5_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge253" class="edge">
<title>expert5_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M45781.24,-162.02C45804.4,-171.57 45831.96,-181.22 45858,-185.98 45924.5,-198.16 47007.64,-191.87 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert6_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge254" class="edge">
<title>expert6_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M45534.24,-162.02C45557.4,-171.57 45584.96,-181.22 45611,-185.98 45691,-200.63 46993.97,-193.06 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert7_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge255" class="edge">
<title>expert7_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M45287.24,-162.02C45310.4,-171.57 45337.96,-181.22 45364,-185.98 45410.75,-194.54 47027.65,-190.12 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert8_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge256" class="edge">
<title>expert8_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M45040.24,-162.02C45063.4,-171.57 45090.96,-181.22 45117,-185.98 45170.5,-195.78 47020.82,-190.72 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert9_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge257" class="edge">
<title>expert9_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M44793.24,-162.02C44816.4,-171.57 44843.96,-181.22 44870,-185.98 44930.25,-197.01 47013.98,-191.31 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert10_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge258" class="edge">
<title>expert10_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M44546.24,-162.02C44569.4,-171.57 44596.96,-181.22 44623,-185.98 44690,-198.25 47007.15,-191.91 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert11_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge259" class="edge">
<title>expert11_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M44299.24,-162.02C44322.4,-171.57 44349.96,-181.22 44376,-185.98 44449.75,-199.48 47000.31,-192.51 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert12_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge260" class="edge">
<title>expert12_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M44052.24,-162.02C44075.4,-171.57 44102.96,-181.22 44129,-185.98 44209.49,-200.72 46993.48,-193.1 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert13_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge261" class="edge">
<title>expert13_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M43805.24,-162.02C43828.4,-171.57 43855.96,-181.22 43882,-185.98 43925.62,-193.97 47030.82,-189.84 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert14_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge262" class="edge">
<title>expert14_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M43558.24,-162.02C43581.4,-171.57 43608.96,-181.22 43635,-185.98 43682,-194.59 47027.4,-190.14 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- expert15_l6_dp0&#45;&gt;expert_agg_l6_dp0 -->
<g id="edge263" class="edge">
<title>expert15_l6_dp0&#45;&gt;expert_agg_l6_dp0</title>
<path fill="none" stroke="black" d="M43239.49,-162.01C43285.12,-171.59 43338.84,-181.26 43388,-185.98 43489.95,-195.77 46972.97,-194.9 47075,-185.98 47113.11,-182.65 47153.78,-176.86 47192.08,-170.36"/>
<polygon fill="black" stroke="black" points="47193.02,-173.75 47202.29,-168.6 47191.84,-166.85 47193.02,-173.75"/>
</g>
<!-- layer6_output_dp0 -->
<g id="node158" class="node">
<title>layer6_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="47811" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="47811" y="-144.48" font-family="Arial" font-size="10.00">Layer 6 Output</text>
<text text-anchor="middle" x="47811" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="47811" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l6_dp0&#45;&gt;layer6_output_dp0 -->
<g id="edge264" class="edge">
<title>expert_agg_l6_dp0&#45;&gt;layer6_output_dp0</title>
<path fill="none" stroke="black" d="M47556.31,-135.98C47581.49,-135.98 47606.66,-135.98 47631.84,-135.98"/>
<polygon fill="black" stroke="black" points="47631.87,-139.48 47641.87,-135.98 47631.87,-132.48 47631.87,-139.48"/>
</g>
<!-- attn_input_l7_dp0 -->
<g id="node159" class="node">
<title>attn_input_l7_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="48184" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="48184" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L7</text>
<text text-anchor="middle" x="48184" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="48184" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer6_output_dp0&#45;&gt;attn_input_l7_dp0 -->
<g id="edge265" class="edge">
<title>layer6_output_dp0&#45;&gt;attn_input_l7_dp0</title>
<path fill="none" stroke="black" d="M47980.01,-135.98C47988.23,-135.98 47996.44,-135.98 48004.66,-135.98"/>
<polygon fill="black" stroke="black" points="48004.68,-139.48 48014.68,-135.98 48004.68,-132.48 48004.68,-139.48"/>
</g>
<!-- attn_tp0_l7_dp0 -->
<g id="node160" class="node">
<title>attn_tp0_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="49482,-161.98 49222,-161.98 49222,-109.98 49482,-109.98 49482,-161.98"/>
<text text-anchor="middle" x="49352" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L7</text>
<text text-anchor="middle" x="49352" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="49352" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="49352" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp0&#45;&gt;attn_tp0_l7_dp0 -->
<g id="edge266" class="edge">
<title>attn_input_l7_dp0&#45;&gt;attn_tp0_l7_dp0</title>
<path fill="none" stroke="black" d="M48267.52,-161.26C48304.12,-171.09 48347.81,-181.13 48388,-185.98 48433,-191.42 49159.27,-193.33 49204,-185.98 49229.4,-181.81 49256.31,-173.85 49280.12,-165.5"/>
<polygon fill="black" stroke="black" points="49281.55,-168.71 49289.78,-162.03 49279.18,-162.12 49281.55,-168.71"/>
</g>
<!-- attn_tp1_l7_dp0 -->
<g id="node161" class="node">
<title>attn_tp1_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="49204,-161.98 48944,-161.98 48944,-109.98 49204,-109.98 49204,-161.98"/>
<text text-anchor="middle" x="49074" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L7</text>
<text text-anchor="middle" x="49074" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="49074" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="49074" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp0&#45;&gt;attn_tp1_l7_dp0 -->
<g id="edge267" class="edge">
<title>attn_input_l7_dp0&#45;&gt;attn_tp1_l7_dp0</title>
<path fill="none" stroke="black" d="M48267.52,-161.26C48304.12,-171.09 48347.81,-181.13 48388,-185.98 48447.35,-193.15 48867.01,-195.68 48926,-185.98 48951.4,-181.81 48978.31,-173.85 49002.12,-165.5"/>
<polygon fill="black" stroke="black" points="49003.55,-168.71 49011.78,-162.03 49001.18,-162.12 49003.55,-168.71"/>
</g>
<!-- attn_tp2_l7_dp0 -->
<g id="node162" class="node">
<title>attn_tp2_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="48926,-161.98 48666,-161.98 48666,-109.98 48926,-109.98 48926,-161.98"/>
<text text-anchor="middle" x="48796" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L7</text>
<text text-anchor="middle" x="48796" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="48796" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="48796" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp0&#45;&gt;attn_tp2_l7_dp0 -->
<g id="edge268" class="edge">
<title>attn_input_l7_dp0&#45;&gt;attn_tp2_l7_dp0</title>
<path fill="none" stroke="black" d="M48267.52,-161.26C48304.12,-171.09 48347.81,-181.13 48388,-185.98 48445.36,-192.91 48590.99,-195.35 48648,-185.98 48673.4,-181.81 48700.31,-173.85 48724.12,-165.5"/>
<polygon fill="black" stroke="black" points="48725.55,-168.71 48733.78,-162.03 48723.18,-162.12 48725.55,-168.71"/>
</g>
<!-- attn_tp3_l7_dp0 -->
<g id="node163" class="node">
<title>attn_tp3_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="48648,-161.98 48388,-161.98 48388,-109.98 48648,-109.98 48648,-161.98"/>
<text text-anchor="middle" x="48518" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L7</text>
<text text-anchor="middle" x="48518" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="48518" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="48518" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp0&#45;&gt;attn_tp3_l7_dp0 -->
<g id="edge269" class="edge">
<title>attn_input_l7_dp0&#45;&gt;attn_tp3_l7_dp0</title>
<path fill="none" stroke="black" d="M48353.28,-135.98C48361.35,-135.98 48369.42,-135.98 48377.49,-135.98"/>
<polygon fill="black" stroke="black" points="48377.7,-139.48 48387.7,-135.98 48377.7,-132.48 48377.7,-139.48"/>
</g>
<!-- allreduce_l7_dp0 -->
<g id="node164" class="node">
<title>allreduce_l7_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="49686" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="49686" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L7</text>
<text text-anchor="middle" x="49686" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="49686" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l7_dp0&#45;&gt;allreduce_l7_dp0 -->
<g id="edge270" class="edge">
<title>attn_tp0_l7_dp0&#45;&gt;allreduce_l7_dp0</title>
<path fill="none" stroke="black" d="M49482.14,-135.98C49490.35,-135.98 49498.56,-135.98 49506.77,-135.98"/>
<polygon fill="black" stroke="black" points="49506.78,-139.48 49516.78,-135.98 49506.78,-132.48 49506.78,-139.48"/>
</g>
<!-- attn_tp1_l7_dp0&#45;&gt;allreduce_l7_dp0 -->
<g id="edge271" class="edge">
<title>attn_tp1_l7_dp0&#45;&gt;allreduce_l7_dp0</title>
<path fill="none" stroke="black" d="M49136.22,-162.03C49162.24,-171.59 49193.1,-181.23 49222,-185.98 49279.01,-195.35 49424.64,-192.91 49482,-185.98 49518.57,-181.57 49558.05,-172.85 49592.44,-163.91"/>
<polygon fill="black" stroke="black" points="49593.7,-167.2 49602.47,-161.26 49591.91,-160.43 49593.7,-167.2"/>
</g>
<!-- attn_tp2_l7_dp0&#45;&gt;allreduce_l7_dp0 -->
<g id="edge272" class="edge">
<title>attn_tp2_l7_dp0&#45;&gt;allreduce_l7_dp0</title>
<path fill="none" stroke="black" d="M48858.22,-162.03C48884.24,-171.59 48915.1,-181.23 48944,-185.98 49002.98,-195.68 49422.65,-193.15 49482,-185.98 49518.57,-181.57 49558.05,-172.85 49592.44,-163.91"/>
<polygon fill="black" stroke="black" points="49593.7,-167.2 49602.47,-161.26 49591.91,-160.43 49593.7,-167.2"/>
</g>
<!-- attn_tp3_l7_dp0&#45;&gt;allreduce_l7_dp0 -->
<g id="edge273" class="edge">
<title>attn_tp3_l7_dp0&#45;&gt;allreduce_l7_dp0</title>
<path fill="none" stroke="black" d="M48580.22,-162.03C48606.24,-171.59 48637.1,-181.23 48666,-185.98 48710.73,-193.33 49436.99,-191.42 49482,-185.98 49518.57,-181.57 49558.05,-172.85 49592.44,-163.91"/>
<polygon fill="black" stroke="black" points="49593.7,-167.2 49602.47,-161.26 49591.91,-160.43 49593.7,-167.2"/>
</g>
<!-- moe_input_l7_dp0 -->
<g id="node165" class="node">
<title>moe_input_l7_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="50059" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="50059" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L7</text>
<text text-anchor="middle" x="50059" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="50059" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l7_dp0&#45;&gt;moe_input_l7_dp0 -->
<g id="edge274" class="edge">
<title>allreduce_l7_dp0&#45;&gt;moe_input_l7_dp0</title>
<path fill="none" stroke="black" d="M49855.01,-135.98C49863.23,-135.98 49871.44,-135.98 49879.66,-135.98"/>
<polygon fill="black" stroke="black" points="49879.68,-139.48 49889.68,-135.98 49879.68,-132.48 49879.68,-139.48"/>
</g>
<!-- router_l7_dp0 -->
<g id="node166" class="node">
<title>router_l7_dp0</title>
<polygon fill="lightyellow" stroke="black" points="50758.57,-176.98 50364.74,-176.98 50263.43,-94.98 50657.26,-94.98 50758.57,-176.98"/>
<text text-anchor="middle" x="50511" y="-144.48" font-family="Arial" font-size="10.00">Router L7</text>
<text text-anchor="middle" x="50511" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="50511" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l7_dp0&#45;&gt;router_l7_dp0 -->
<g id="edge275" class="edge">
<title>moe_input_l7_dp0&#45;&gt;router_l7_dp0</title>
<path fill="none" stroke="black" d="M50228.06,-135.98C50253.34,-135.98 50278.63,-135.98 50303.92,-135.98"/>
<polygon fill="black" stroke="black" points="50303.99,-139.48 50313.99,-135.98 50303.99,-132.48 50303.99,-139.48"/>
</g>
<!-- expert0_l7_dp0 -->
<g id="node167" class="node">
<title>expert0_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="55004.5,-161.98 54775.5,-161.98 54775.5,-109.98 55004.5,-109.98 55004.5,-161.98"/>
<text text-anchor="middle" x="54890" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L7</text>
<text text-anchor="middle" x="54890" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="54890" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="54890" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert0_l7_dp0 -->
<g id="edge276" class="edge">
<title>router_l7_dp0&#45;&gt;expert0_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50740.12,-161.89C50803.19,-168 50871.67,-173.69 50935,-176.98 51594.46,-211.28 53246.2,-207.43 53906.5,-198.98 54097.55,-196.54 54577.77,-209.77 54766,-176.98 54781.72,-174.24 54798.17,-169.91 54813.76,-165.07"/>
<polygon fill="black" stroke="black" points="54814.89,-168.38 54823.35,-162 54812.76,-161.72 54814.89,-168.38"/>
<text text-anchor="middle" x="53885" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l7_dp0 -->
<g id="node168" class="node">
<title>expert1_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="54757.5,-161.98 54528.5,-161.98 54528.5,-109.98 54757.5,-109.98 54757.5,-161.98"/>
<text text-anchor="middle" x="54643" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L7</text>
<text text-anchor="middle" x="54643" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="54643" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="54643" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert1_l7_dp0 -->
<g id="edge277" class="edge">
<title>router_l7_dp0&#45;&gt;expert1_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50656.67,-176.99C50695.3,-186.08 50737.21,-194.39 50776.5,-198.98 50795.48,-201.2 50800.39,-199.04 50819.5,-198.98 51025.03,-198.37 54316.18,-210.26 54519,-176.98 54534.93,-174.37 54551.6,-170.03 54567.36,-165.14"/>
<polygon fill="black" stroke="black" points="54568.58,-168.42 54577.03,-162.03 54566.44,-161.76 54568.58,-168.42"/>
<text text-anchor="middle" x="50798" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l7_dp0 -->
<g id="node169" class="node">
<title>expert2_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="54510.5,-161.98 54281.5,-161.98 54281.5,-109.98 54510.5,-109.98 54510.5,-161.98"/>
<text text-anchor="middle" x="54396" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L7</text>
<text text-anchor="middle" x="54396" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="54396" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="54396" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert2_l7_dp0 -->
<g id="edge278" class="edge">
<title>router_l7_dp0&#45;&gt;expert2_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50683.37,-177C50728.98,-186.1 50778.37,-194.39 50824.5,-198.98 50843.52,-200.87 50848.39,-199.04 50867.5,-198.98 51056.64,-198.37 54085.36,-207.66 54272,-176.98 54287.93,-174.36 54304.6,-170.03 54320.35,-165.14"/>
<polygon fill="black" stroke="black" points="54321.58,-168.42 54330.03,-162.03 54319.44,-161.75 54321.58,-168.42"/>
<text text-anchor="middle" x="50846" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l7_dp0 -->
<g id="node170" class="node">
<title>expert3_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="54263.5,-161.98 54034.5,-161.98 54034.5,-109.98 54263.5,-109.98 54263.5,-161.98"/>
<text text-anchor="middle" x="54149" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L7</text>
<text text-anchor="middle" x="54149" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="54149" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="54149" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert3_l7_dp0 -->
<g id="edge279" class="edge">
<title>router_l7_dp0&#45;&gt;expert3_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50710.02,-177C50762.62,-186.1 50819.5,-194.4 50872.5,-198.98 50891.54,-200.63 50896.39,-199.05 50915.5,-198.98 51261.01,-197.76 53684.08,-233.12 54025,-176.98 54040.93,-174.36 54057.6,-170.02 54073.35,-165.13"/>
<polygon fill="black" stroke="black" points="54074.58,-168.41 54083.03,-162.02 54072.44,-161.75 54074.58,-168.41"/>
<text text-anchor="middle" x="50894" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l7_dp0 -->
<g id="node171" class="node">
<title>expert4_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="54016.5,-161.98 53787.5,-161.98 53787.5,-109.98 54016.5,-109.98 54016.5,-161.98"/>
<text text-anchor="middle" x="53902" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L7</text>
<text text-anchor="middle" x="53902" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="53902" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="53902" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert4_l7_dp0 -->
<g id="edge280" class="edge">
<title>router_l7_dp0&#45;&gt;expert4_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50739.85,-161.73C50803,-167.85 50871.58,-173.58 50935,-176.98 51395.14,-201.68 52547.74,-205.57 53008.5,-198.98 53350.6,-194.09 53441.02,-236.2 53778,-176.98 53793.63,-174.24 53809.97,-169.93 53825.48,-165.12"/>
<polygon fill="black" stroke="black" points="53826.56,-168.45 53835.02,-162.07 53824.43,-161.78 53826.56,-168.45"/>
<text text-anchor="middle" x="52987" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l7_dp0 -->
<g id="node172" class="node">
<title>expert5_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="53769.5,-161.98 53540.5,-161.98 53540.5,-109.98 53769.5,-109.98 53769.5,-161.98"/>
<text text-anchor="middle" x="53655" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L7</text>
<text text-anchor="middle" x="53655" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="53655" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="53655" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert5_l7_dp0 -->
<g id="edge281" class="edge">
<title>router_l7_dp0&#45;&gt;expert5_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50736.65,-177.01C50796.23,-186.11 50860.61,-194.4 50920.5,-198.98 50939.55,-200.44 50944.39,-199.06 50963.5,-198.98 51248.78,-197.76 53249.54,-223.55 53531,-176.98 53546.93,-174.35 53563.59,-170 53579.35,-165.11"/>
<polygon fill="black" stroke="black" points="53580.58,-168.39 53589.03,-162 53578.44,-161.73 53580.58,-168.39"/>
<text text-anchor="middle" x="50942" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l7_dp0 -->
<g id="node173" class="node">
<title>expert6_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="53522.5,-161.98 53293.5,-161.98 53293.5,-109.98 53522.5,-109.98 53522.5,-161.98"/>
<text text-anchor="middle" x="53408" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L7</text>
<text text-anchor="middle" x="53408" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="53408" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="53408" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert6_l7_dp0 -->
<g id="edge282" class="edge">
<title>router_l7_dp0&#45;&gt;expert6_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50757.89,-176.28C50825.94,-185.66 50899.91,-194.28 50968.5,-198.98 50987.56,-200.29 50992.39,-199.08 51011.5,-198.98 51264.01,-197.76 53034.9,-218.34 53284,-176.98 53299.93,-174.34 53316.59,-169.99 53332.35,-165.1"/>
<polygon fill="black" stroke="black" points="53333.58,-168.38 53342.03,-161.99 53331.44,-161.71 53333.58,-168.38"/>
<text text-anchor="middle" x="50990" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l7_dp0 -->
<g id="node174" class="node">
<title>expert7_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="53275.5,-161.98 53046.5,-161.98 53046.5,-109.98 53275.5,-109.98 53275.5,-161.98"/>
<text text-anchor="middle" x="53161" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L7</text>
<text text-anchor="middle" x="53161" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="53161" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="53161" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert7_l7_dp0 -->
<g id="edge283" class="edge">
<title>router_l7_dp0&#45;&gt;expert7_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50753.08,-172.34C50836.36,-183.2 50930.33,-193.63 51016.5,-198.98 51035.57,-200.17 51040.39,-199.09 51059.5,-198.98 51279.23,-197.76 52820.26,-213.12 53037,-176.98 53052.83,-174.34 53069.4,-170.03 53085.07,-165.16"/>
<polygon fill="black" stroke="black" points="53086.25,-168.46 53094.7,-162.07 53084.11,-161.8 53086.25,-168.46"/>
<text text-anchor="middle" x="51038" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l7_dp0 -->
<g id="node175" class="node">
<title>expert8_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="53028.5,-161.98 52799.5,-161.98 52799.5,-109.98 53028.5,-109.98 53028.5,-161.98"/>
<text text-anchor="middle" x="52914" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L7</text>
<text text-anchor="middle" x="52914" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="52914" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="52914" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert8_l7_dp0 -->
<g id="edge284" class="edge">
<title>router_l7_dp0&#45;&gt;expert8_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50739.32,-161.37C50802.62,-167.51 50871.41,-173.34 50935,-176.98 51496.16,-209.12 51637.51,-209.45 52199.5,-198.98 52462.08,-194.09 52531.53,-223.56 52790,-176.98 52805.37,-174.21 52821.46,-169.96 52836.75,-165.23"/>
<polygon fill="black" stroke="black" points="52838.21,-168.44 52846.67,-162.06 52836.08,-161.77 52838.21,-168.44"/>
<text text-anchor="middle" x="52178" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l7_dp0 -->
<g id="node176" class="node">
<title>expert9_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="52781.5,-161.98 52552.5,-161.98 52552.5,-109.98 52781.5,-109.98 52781.5,-161.98"/>
<text text-anchor="middle" x="52667" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L7</text>
<text text-anchor="middle" x="52667" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="52667" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="52667" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert9_l7_dp0 -->
<g id="edge285" class="edge">
<title>router_l7_dp0&#45;&gt;expert9_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50748.88,-169.04C50846.47,-181.04 50960.7,-193.09 51064.5,-198.98 51228.53,-208.29 52381,-204.35 52543,-176.98 52558.83,-174.31 52575.39,-169.98 52591.06,-165.11"/>
<polygon fill="black" stroke="black" points="52592.24,-168.41 52600.69,-162.02 52590.1,-161.74 52592.24,-168.41"/>
<text text-anchor="middle" x="51086" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l7_dp0 -->
<g id="node177" class="node">
<title>expert10_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="52534.5,-161.98 52305.5,-161.98 52305.5,-109.98 52534.5,-109.98 52534.5,-161.98"/>
<text text-anchor="middle" x="52420" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L7</text>
<text text-anchor="middle" x="52420" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="52420" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="52420" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert10_l7_dp0 -->
<g id="edge286" class="edge">
<title>router_l7_dp0&#45;&gt;expert10_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50745.51,-166.28C50856.54,-179.16 50991.13,-192.64 51112.5,-198.98 51243.84,-205.84 52166.36,-199.14 52296,-176.98 52311.73,-174.29 52328.19,-169.98 52343.78,-165.15"/>
<polygon fill="black" stroke="black" points="52344.9,-168.46 52353.36,-162.08 52342.77,-161.79 52344.9,-168.46"/>
<text text-anchor="middle" x="51134" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l7_dp0 -->
<g id="node178" class="node">
<title>expert11_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="52287.5,-161.98 52058.5,-161.98 52058.5,-109.98 52287.5,-109.98 52287.5,-161.98"/>
<text text-anchor="middle" x="52173" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L7</text>
<text text-anchor="middle" x="52173" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="52173" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="52173" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert11_l7_dp0 -->
<g id="edge287" class="edge">
<title>router_l7_dp0&#45;&gt;expert11_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50742.44,-163.92C50866.26,-177.47 51021.46,-192.26 51160.5,-198.98 51357.77,-208.53 51854.43,-210.92 52049,-176.98 52064.72,-174.24 52081.17,-169.91 52096.76,-165.06"/>
<polygon fill="black" stroke="black" points="52097.89,-168.38 52106.35,-161.99 52095.75,-161.71 52097.89,-168.38"/>
<text text-anchor="middle" x="51182" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l7_dp0 -->
<g id="node179" class="node">
<title>expert12_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="52040.5,-161.98 51811.5,-161.98 51811.5,-109.98 52040.5,-109.98 52040.5,-161.98"/>
<text text-anchor="middle" x="51926" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L7</text>
<text text-anchor="middle" x="51926" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="51926" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="51926" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert12_l7_dp0 -->
<g id="edge288" class="edge">
<title>router_l7_dp0&#45;&gt;expert12_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50742.66,-164.01C50957.25,-186.58 51285.32,-212.5 51570.5,-198.98 51673.74,-194.09 51700.85,-198.23 51802,-176.98 51816.65,-173.9 51832,-169.69 51846.7,-165.12"/>
<polygon fill="black" stroke="black" points="51847.79,-168.45 51856.26,-162.08 51845.67,-161.78 51847.79,-168.45"/>
<text text-anchor="middle" x="51549" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l7_dp0 -->
<g id="node180" class="node">
<title>expert13_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="51793.5,-161.98 51564.5,-161.98 51564.5,-109.98 51793.5,-109.98 51793.5,-161.98"/>
<text text-anchor="middle" x="51679" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L7</text>
<text text-anchor="middle" x="51679" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="51679" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="51679" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert13_l7_dp0 -->
<g id="edge289" class="edge">
<title>router_l7_dp0&#45;&gt;expert13_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50751.38,-176.99C50964.6,-205.92 51283.44,-230.86 51555,-176.98 51569.96,-174.01 51585.62,-169.78 51600.58,-165.14"/>
<polygon fill="black" stroke="black" points="51601.83,-168.41 51610.29,-162.04 51599.7,-161.74 51601.83,-168.41"/>
<text text-anchor="middle" x="51230" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l7_dp0 -->
<g id="node181" class="node">
<title>expert14_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="51546.5,-161.98 51317.5,-161.98 51317.5,-109.98 51546.5,-109.98 51546.5,-161.98"/>
<text text-anchor="middle" x="51432" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L7</text>
<text text-anchor="middle" x="51432" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="51432" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="51432" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert14_l7_dp0 -->
<g id="edge290" class="edge">
<title>router_l7_dp0&#45;&gt;expert14_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50739.45,-161.26C50886.81,-176.09 51082.71,-193.04 51256.5,-198.98 51275.6,-199.64 51280.86,-203.19 51299.5,-198.98 51327.7,-192.62 51356.94,-179.52 51380.75,-166.9"/>
<polygon fill="black" stroke="black" points="51382.48,-169.94 51389.6,-162.1 51379.14,-163.79 51382.48,-169.94"/>
<text text-anchor="middle" x="51278" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l7_dp0 -->
<g id="node182" class="node">
<title>expert15_l7_dp0</title>
<polygon fill="lightgreen" stroke="black" points="51173.5,-161.98 50944.5,-161.98 50944.5,-109.98 51173.5,-109.98 51173.5,-161.98"/>
<text text-anchor="middle" x="51059" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L7</text>
<text text-anchor="middle" x="51059" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="51059" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="51059" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp0&#45;&gt;expert15_l7_dp0 -->
<g id="edge291" class="edge">
<title>router_l7_dp0&#45;&gt;expert15_l7_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50708.06,-135.98C50783.51,-135.98 50867.43,-135.98 50934.28,-135.98"/>
<polygon fill="black" stroke="black" points="50934.44,-139.48 50944.44,-135.98 50934.44,-132.48 50934.44,-139.48"/>
<text text-anchor="middle" x="50851.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l7_dp0 -->
<g id="node183" class="node">
<title>expert_agg_l7_dp0</title>
<polygon fill="lightyellow" stroke="black" points="55535.57,-176.98 55141.74,-176.98 55040.43,-94.98 55434.26,-94.98 55535.57,-176.98"/>
<text text-anchor="middle" x="55288" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L7</text>
<text text-anchor="middle" x="55288" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="55288" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge292" class="edge">
<title>expert0_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M55004.66,-135.98C55030.06,-135.98 55055.47,-135.98 55080.87,-135.98"/>
<polygon fill="black" stroke="black" points="55080.99,-139.48 55090.99,-135.98 55080.99,-132.48 55080.99,-139.48"/>
</g>
<!-- expert1_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge293" class="edge">
<title>expert1_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M54698.24,-162.02C54721.4,-171.57 54748.96,-181.22 54775,-185.98 54825.06,-195.15 54953.3,-190.41 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert2_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge294" class="edge">
<title>expert2_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M54451.24,-162.02C54474.4,-171.57 54501.96,-181.22 54528,-185.98 54580.02,-195.51 54951.31,-190.59 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert3_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge295" class="edge">
<title>expert3_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M54204.24,-162.02C54227.4,-171.57 54254.96,-181.22 54281,-185.98 54360.02,-200.45 54923.97,-192.97 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert4_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge296" class="edge">
<title>expert4_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M53957.24,-162.02C53980.4,-171.57 54007.96,-181.22 54034,-185.98 54087.01,-195.69 54950.31,-190.67 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert5_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge297" class="edge">
<title>expert5_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M53710.24,-162.02C53733.4,-171.57 53760.96,-181.22 53787,-185.98 53853.5,-198.16 54936.64,-191.87 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert6_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge298" class="edge">
<title>expert6_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M53463.24,-162.02C53486.4,-171.57 53513.96,-181.22 53540,-185.98 53620,-200.63 54922.97,-193.06 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert7_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge299" class="edge">
<title>expert7_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M53216.24,-162.02C53239.4,-171.57 53266.96,-181.22 53293,-185.98 53339.75,-194.54 54956.65,-190.12 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert8_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge300" class="edge">
<title>expert8_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M52969.24,-162.02C52992.4,-171.57 53019.96,-181.22 53046,-185.98 53099.5,-195.78 54949.82,-190.72 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert9_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge301" class="edge">
<title>expert9_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M52722.24,-162.02C52745.4,-171.57 52772.96,-181.22 52799,-185.98 52859.25,-197.01 54942.98,-191.31 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert10_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge302" class="edge">
<title>expert10_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M52475.24,-162.02C52498.4,-171.57 52525.96,-181.22 52552,-185.98 52619,-198.25 54936.15,-191.91 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert11_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge303" class="edge">
<title>expert11_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M52228.24,-162.02C52251.4,-171.57 52278.96,-181.22 52305,-185.98 52378.75,-199.48 54929.31,-192.51 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert12_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge304" class="edge">
<title>expert12_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M51981.24,-162.02C52004.4,-171.57 52031.96,-181.22 52058,-185.98 52138.49,-200.72 54922.48,-193.1 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert13_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge305" class="edge">
<title>expert13_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M51734.24,-162.02C51757.4,-171.57 51784.96,-181.22 51811,-185.98 51854.62,-193.97 54959.82,-189.84 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert14_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge306" class="edge">
<title>expert14_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M51487.24,-162.02C51510.4,-171.57 51537.96,-181.22 51564,-185.98 51611,-194.59 54956.4,-190.14 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- expert15_l7_dp0&#45;&gt;expert_agg_l7_dp0 -->
<g id="edge307" class="edge">
<title>expert15_l7_dp0&#45;&gt;expert_agg_l7_dp0</title>
<path fill="none" stroke="black" d="M51168.49,-162.01C51214.12,-171.59 51267.84,-181.26 51317,-185.98 51418.95,-195.77 54901.97,-194.9 55004,-185.98 55042.11,-182.65 55082.78,-176.86 55121.08,-170.36"/>
<polygon fill="black" stroke="black" points="55122.02,-173.75 55131.29,-168.6 55120.84,-166.85 55122.02,-173.75"/>
</g>
<!-- layer7_output_dp0 -->
<g id="node184" class="node">
<title>layer7_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="55740" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="55740" y="-144.48" font-family="Arial" font-size="10.00">Layer 7 Output</text>
<text text-anchor="middle" x="55740" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="55740" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l7_dp0&#45;&gt;layer7_output_dp0 -->
<g id="edge308" class="edge">
<title>expert_agg_l7_dp0&#45;&gt;layer7_output_dp0</title>
<path fill="none" stroke="black" d="M55485.31,-135.98C55510.49,-135.98 55535.66,-135.98 55560.84,-135.98"/>
<polygon fill="black" stroke="black" points="55560.87,-139.48 55570.87,-135.98 55560.87,-132.48 55560.87,-139.48"/>
</g>
<!-- attn_input_l8_dp0 -->
<g id="node185" class="node">
<title>attn_input_l8_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="56113" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="56113" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L8</text>
<text text-anchor="middle" x="56113" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="56113" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer7_output_dp0&#45;&gt;attn_input_l8_dp0 -->
<g id="edge309" class="edge">
<title>layer7_output_dp0&#45;&gt;attn_input_l8_dp0</title>
<path fill="none" stroke="black" d="M55909.01,-135.98C55917.23,-135.98 55925.44,-135.98 55933.66,-135.98"/>
<polygon fill="black" stroke="black" points="55933.68,-139.48 55943.68,-135.98 55933.68,-132.48 55933.68,-139.48"/>
</g>
<!-- attn_tp0_l8_dp0 -->
<g id="node186" class="node">
<title>attn_tp0_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="57411,-161.98 57151,-161.98 57151,-109.98 57411,-109.98 57411,-161.98"/>
<text text-anchor="middle" x="57281" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L8</text>
<text text-anchor="middle" x="57281" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="57281" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="57281" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp0&#45;&gt;attn_tp0_l8_dp0 -->
<g id="edge310" class="edge">
<title>attn_input_l8_dp0&#45;&gt;attn_tp0_l8_dp0</title>
<path fill="none" stroke="black" d="M56196.52,-161.26C56233.12,-171.09 56276.81,-181.13 56317,-185.98 56362,-191.42 57088.27,-193.33 57133,-185.98 57158.4,-181.81 57185.31,-173.85 57209.12,-165.5"/>
<polygon fill="black" stroke="black" points="57210.55,-168.71 57218.78,-162.03 57208.18,-162.12 57210.55,-168.71"/>
</g>
<!-- attn_tp1_l8_dp0 -->
<g id="node187" class="node">
<title>attn_tp1_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="57133,-161.98 56873,-161.98 56873,-109.98 57133,-109.98 57133,-161.98"/>
<text text-anchor="middle" x="57003" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L8</text>
<text text-anchor="middle" x="57003" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="57003" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="57003" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp0&#45;&gt;attn_tp1_l8_dp0 -->
<g id="edge311" class="edge">
<title>attn_input_l8_dp0&#45;&gt;attn_tp1_l8_dp0</title>
<path fill="none" stroke="black" d="M56196.52,-161.26C56233.12,-171.09 56276.81,-181.13 56317,-185.98 56376.35,-193.15 56796.01,-195.68 56855,-185.98 56880.4,-181.81 56907.31,-173.85 56931.12,-165.5"/>
<polygon fill="black" stroke="black" points="56932.55,-168.71 56940.78,-162.03 56930.18,-162.12 56932.55,-168.71"/>
</g>
<!-- attn_tp2_l8_dp0 -->
<g id="node188" class="node">
<title>attn_tp2_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="56855,-161.98 56595,-161.98 56595,-109.98 56855,-109.98 56855,-161.98"/>
<text text-anchor="middle" x="56725" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L8</text>
<text text-anchor="middle" x="56725" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="56725" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="56725" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp0&#45;&gt;attn_tp2_l8_dp0 -->
<g id="edge312" class="edge">
<title>attn_input_l8_dp0&#45;&gt;attn_tp2_l8_dp0</title>
<path fill="none" stroke="black" d="M56196.52,-161.26C56233.12,-171.09 56276.81,-181.13 56317,-185.98 56374.36,-192.91 56519.99,-195.35 56577,-185.98 56602.4,-181.81 56629.31,-173.85 56653.12,-165.5"/>
<polygon fill="black" stroke="black" points="56654.55,-168.71 56662.78,-162.03 56652.18,-162.12 56654.55,-168.71"/>
</g>
<!-- attn_tp3_l8_dp0 -->
<g id="node189" class="node">
<title>attn_tp3_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="56577,-161.98 56317,-161.98 56317,-109.98 56577,-109.98 56577,-161.98"/>
<text text-anchor="middle" x="56447" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L8</text>
<text text-anchor="middle" x="56447" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="56447" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="56447" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp0&#45;&gt;attn_tp3_l8_dp0 -->
<g id="edge313" class="edge">
<title>attn_input_l8_dp0&#45;&gt;attn_tp3_l8_dp0</title>
<path fill="none" stroke="black" d="M56282.28,-135.98C56290.35,-135.98 56298.42,-135.98 56306.49,-135.98"/>
<polygon fill="black" stroke="black" points="56306.7,-139.48 56316.7,-135.98 56306.7,-132.48 56306.7,-139.48"/>
</g>
<!-- allreduce_l8_dp0 -->
<g id="node190" class="node">
<title>allreduce_l8_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="57615" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="57615" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L8</text>
<text text-anchor="middle" x="57615" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="57615" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l8_dp0&#45;&gt;allreduce_l8_dp0 -->
<g id="edge314" class="edge">
<title>attn_tp0_l8_dp0&#45;&gt;allreduce_l8_dp0</title>
<path fill="none" stroke="black" d="M57411.14,-135.98C57419.35,-135.98 57427.56,-135.98 57435.77,-135.98"/>
<polygon fill="black" stroke="black" points="57435.78,-139.48 57445.78,-135.98 57435.78,-132.48 57435.78,-139.48"/>
</g>
<!-- attn_tp1_l8_dp0&#45;&gt;allreduce_l8_dp0 -->
<g id="edge315" class="edge">
<title>attn_tp1_l8_dp0&#45;&gt;allreduce_l8_dp0</title>
<path fill="none" stroke="black" d="M57065.22,-162.03C57091.24,-171.59 57122.1,-181.23 57151,-185.98 57208.01,-195.35 57353.64,-192.91 57411,-185.98 57447.57,-181.57 57487.05,-172.85 57521.44,-163.91"/>
<polygon fill="black" stroke="black" points="57522.7,-167.2 57531.47,-161.26 57520.91,-160.43 57522.7,-167.2"/>
</g>
<!-- attn_tp2_l8_dp0&#45;&gt;allreduce_l8_dp0 -->
<g id="edge316" class="edge">
<title>attn_tp2_l8_dp0&#45;&gt;allreduce_l8_dp0</title>
<path fill="none" stroke="black" d="M56787.22,-162.03C56813.24,-171.59 56844.1,-181.23 56873,-185.98 56931.98,-195.68 57351.65,-193.15 57411,-185.98 57447.57,-181.57 57487.05,-172.85 57521.44,-163.91"/>
<polygon fill="black" stroke="black" points="57522.7,-167.2 57531.47,-161.26 57520.91,-160.43 57522.7,-167.2"/>
</g>
<!-- attn_tp3_l8_dp0&#45;&gt;allreduce_l8_dp0 -->
<g id="edge317" class="edge">
<title>attn_tp3_l8_dp0&#45;&gt;allreduce_l8_dp0</title>
<path fill="none" stroke="black" d="M56509.22,-162.03C56535.24,-171.59 56566.1,-181.23 56595,-185.98 56639.73,-193.33 57365.99,-191.42 57411,-185.98 57447.57,-181.57 57487.05,-172.85 57521.44,-163.91"/>
<polygon fill="black" stroke="black" points="57522.7,-167.2 57531.47,-161.26 57520.91,-160.43 57522.7,-167.2"/>
</g>
<!-- moe_input_l8_dp0 -->
<g id="node191" class="node">
<title>moe_input_l8_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="57988" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="57988" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L8</text>
<text text-anchor="middle" x="57988" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="57988" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l8_dp0&#45;&gt;moe_input_l8_dp0 -->
<g id="edge318" class="edge">
<title>allreduce_l8_dp0&#45;&gt;moe_input_l8_dp0</title>
<path fill="none" stroke="black" d="M57784.01,-135.98C57792.23,-135.98 57800.44,-135.98 57808.66,-135.98"/>
<polygon fill="black" stroke="black" points="57808.68,-139.48 57818.68,-135.98 57808.68,-132.48 57808.68,-139.48"/>
</g>
<!-- router_l8_dp0 -->
<g id="node192" class="node">
<title>router_l8_dp0</title>
<polygon fill="lightyellow" stroke="black" points="58687.57,-176.98 58293.74,-176.98 58192.43,-94.98 58586.26,-94.98 58687.57,-176.98"/>
<text text-anchor="middle" x="58440" y="-144.48" font-family="Arial" font-size="10.00">Router L8</text>
<text text-anchor="middle" x="58440" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="58440" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l8_dp0&#45;&gt;router_l8_dp0 -->
<g id="edge319" class="edge">
<title>moe_input_l8_dp0&#45;&gt;router_l8_dp0</title>
<path fill="none" stroke="black" d="M58157.06,-135.98C58182.34,-135.98 58207.63,-135.98 58232.92,-135.98"/>
<polygon fill="black" stroke="black" points="58232.99,-139.48 58242.99,-135.98 58232.99,-132.48 58232.99,-139.48"/>
</g>
<!-- expert0_l8_dp0 -->
<g id="node193" class="node">
<title>expert0_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="62885.5,-161.98 62656.5,-161.98 62656.5,-109.98 62885.5,-109.98 62885.5,-161.98"/>
<text text-anchor="middle" x="62771" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L8</text>
<text text-anchor="middle" x="62771" y="-138.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="62771" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="62771" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert0_l8_dp0 -->
<g id="edge320" class="edge">
<title>router_l8_dp0&#45;&gt;expert0_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58671.05,-163.45C58726.32,-168.97 58785.19,-173.99 58840,-176.98 59558.61,-216.16 61358.82,-196.54 62078.5,-198.98 62331.35,-199.84 62398.25,-222.4 62647,-176.98 62662.37,-174.18 62678.45,-169.91 62693.74,-165.17"/>
<polygon fill="black" stroke="black" points="62695.2,-168.38 62703.66,-162 62693.07,-161.71 62695.2,-168.38"/>
<text text-anchor="middle" x="62100" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l8_dp0 -->
<g id="node194" class="node">
<title>expert1_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="62638.5,-161.98 62409.5,-161.98 62409.5,-109.98 62638.5,-109.98 62638.5,-161.98"/>
<text text-anchor="middle" x="62524" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L8</text>
<text text-anchor="middle" x="62524" y="-138.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="62524" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="62524" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert1_l8_dp0 -->
<g id="edge321" class="edge">
<title>router_l8_dp0&#45;&gt;expert1_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58670.79,-163.37C58726.14,-168.9 58785.11,-173.95 58840,-176.98 59442.77,-210.28 60952.86,-206.85 61556.5,-198.98 61743.99,-196.54 62215.28,-209.21 62400,-176.98 62415.72,-174.24 62432.17,-169.91 62447.76,-165.06"/>
<polygon fill="black" stroke="black" points="62448.89,-168.38 62457.35,-161.99 62446.75,-161.71 62448.89,-168.38"/>
<text text-anchor="middle" x="61535" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l8_dp0 -->
<g id="node195" class="node">
<title>expert2_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="62391.5,-161.98 62162.5,-161.98 62162.5,-109.98 62391.5,-109.98 62391.5,-161.98"/>
<text text-anchor="middle" x="62277" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L8</text>
<text text-anchor="middle" x="62277" y="-138.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="62277" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="62277" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert2_l8_dp0 -->
<g id="edge322" class="edge">
<title>router_l8_dp0&#45;&gt;expert2_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58585.67,-176.99C58624.3,-186.08 58666.21,-194.39 58705.5,-198.98 58724.48,-201.2 58729.39,-199.04 58748.5,-198.98 58937.64,-198.37 61966.36,-207.66 62153,-176.98 62168.93,-174.36 62185.6,-170.03 62201.35,-165.14"/>
<polygon fill="black" stroke="black" points="62202.58,-168.42 62211.03,-162.03 62200.44,-161.75 62202.58,-168.42"/>
<text text-anchor="middle" x="58727" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l8_dp0 -->
<g id="node196" class="node">
<title>expert3_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="62144.5,-161.98 61915.5,-161.98 61915.5,-109.98 62144.5,-109.98 62144.5,-161.98"/>
<text text-anchor="middle" x="62030" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L8</text>
<text text-anchor="middle" x="62030" y="-138.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="62030" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="62030" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert3_l8_dp0 -->
<g id="edge323" class="edge">
<title>router_l8_dp0&#45;&gt;expert3_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58612.37,-177C58657.98,-186.1 58707.37,-194.39 58753.5,-198.98 58772.52,-200.87 58777.39,-199.05 58796.5,-198.98 59142.01,-197.76 61565.08,-233.12 61906,-176.98 61921.93,-174.36 61938.6,-170.02 61954.35,-165.13"/>
<polygon fill="black" stroke="black" points="61955.58,-168.41 61964.03,-162.02 61953.44,-161.75 61955.58,-168.41"/>
<text text-anchor="middle" x="58775" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l8_dp0 -->
<g id="node197" class="node">
<title>expert4_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="61897.5,-161.98 61668.5,-161.98 61668.5,-109.98 61897.5,-109.98 61897.5,-161.98"/>
<text text-anchor="middle" x="61783" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L8</text>
<text text-anchor="middle" x="61783" y="-138.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="61783" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="61783" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert4_l8_dp0 -->
<g id="edge324" class="edge">
<title>router_l8_dp0&#45;&gt;expert4_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58639.02,-177C58691.62,-186.1 58748.5,-194.4 58801.5,-198.98 58820.54,-200.63 58825.39,-199.06 58844.5,-198.98 59157.23,-197.76 61350.44,-227.91 61659,-176.98 61674.93,-174.35 61691.6,-170.01 61707.35,-165.12"/>
<polygon fill="black" stroke="black" points="61708.58,-168.4 61717.03,-162.01 61706.44,-161.74 61708.58,-168.4"/>
<text text-anchor="middle" x="58823" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l8_dp0 -->
<g id="node198" class="node">
<title>expert5_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="61650.5,-161.98 61421.5,-161.98 61421.5,-109.98 61650.5,-109.98 61650.5,-161.98"/>
<text text-anchor="middle" x="61536" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L8</text>
<text text-anchor="middle" x="61536" y="-138.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="61536" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="61536" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert5_l8_dp0 -->
<g id="edge325" class="edge">
<title>router_l8_dp0&#45;&gt;expert5_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58670.54,-163.18C58725.96,-168.73 58785.03,-173.83 58840,-176.98 59246.81,-200.28 60266.07,-205.05 60673.5,-198.98 61001.83,-194.09 61088.62,-234.01 61412,-176.98 61427.62,-174.23 61443.97,-169.91 61459.48,-165.1"/>
<polygon fill="black" stroke="black" points="61460.56,-168.43 61469.01,-162.05 61458.42,-161.77 61460.56,-168.43"/>
<text text-anchor="middle" x="60652" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l8_dp0 -->
<g id="node199" class="node">
<title>expert6_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="61403.5,-161.98 61174.5,-161.98 61174.5,-109.98 61403.5,-109.98 61403.5,-161.98"/>
<text text-anchor="middle" x="61289" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L8</text>
<text text-anchor="middle" x="61289" y="-138.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="61289" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="61289" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert6_l8_dp0 -->
<g id="edge326" class="edge">
<title>router_l8_dp0&#45;&gt;expert6_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58665.65,-177.01C58725.23,-186.11 58789.61,-194.4 58849.5,-198.98 58868.55,-200.44 58873.39,-199.08 58892.5,-198.98 59145.01,-197.76 60915.9,-218.34 61165,-176.98 61180.93,-174.34 61197.59,-169.99 61213.35,-165.1"/>
<polygon fill="black" stroke="black" points="61214.58,-168.38 61223.03,-161.99 61212.44,-161.71 61214.58,-168.38"/>
<text text-anchor="middle" x="58871" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l8_dp0 -->
<g id="node200" class="node">
<title>expert7_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="61156.5,-161.98 60927.5,-161.98 60927.5,-109.98 61156.5,-109.98 61156.5,-161.98"/>
<text text-anchor="middle" x="61042" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L8</text>
<text text-anchor="middle" x="61042" y="-138.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="61042" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="61042" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert7_l8_dp0 -->
<g id="edge327" class="edge">
<title>router_l8_dp0&#45;&gt;expert7_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58686.89,-176.28C58754.94,-185.66 58828.91,-194.28 58897.5,-198.98 58916.56,-200.29 58921.39,-199.09 58940.5,-198.98 59160.23,-197.76 60701.26,-213.12 60918,-176.98 60933.83,-174.34 60950.4,-170.03 60966.07,-165.16"/>
<polygon fill="black" stroke="black" points="60967.25,-168.46 60975.7,-162.07 60965.11,-161.8 60967.25,-168.46"/>
<text text-anchor="middle" x="58919" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l8_dp0 -->
<g id="node201" class="node">
<title>expert8_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="60909.5,-161.98 60680.5,-161.98 60680.5,-109.98 60909.5,-109.98 60909.5,-161.98"/>
<text text-anchor="middle" x="60795" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L8</text>
<text text-anchor="middle" x="60795" y="-138.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="60795" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="60795" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert8_l8_dp0 -->
<g id="edge328" class="edge">
<title>router_l8_dp0&#45;&gt;expert8_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58682.08,-172.34C58765.36,-183.2 58859.33,-193.63 58945.5,-198.98 59136.87,-210.86 60481.9,-208.7 60671,-176.98 60686.83,-174.33 60703.39,-170 60719.07,-165.14"/>
<polygon fill="black" stroke="black" points="60720.24,-168.44 60728.7,-162.05 60718.11,-161.77 60720.24,-168.44"/>
<text text-anchor="middle" x="58967" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l8_dp0 -->
<g id="node202" class="node">
<title>expert9_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="60662.5,-161.98 60433.5,-161.98 60433.5,-109.98 60662.5,-109.98 60662.5,-161.98"/>
<text text-anchor="middle" x="60548" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L8</text>
<text text-anchor="middle" x="60548" y="-138.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="60548" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="60548" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert9_l8_dp0 -->
<g id="edge329" class="edge">
<title>router_l8_dp0&#45;&gt;expert9_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58670.03,-162.76C58725.61,-168.34 58784.87,-173.56 58840,-176.98 59308.31,-206.02 59426.39,-208.74 59895.5,-198.98 60130.54,-194.09 60192.72,-219.18 60424,-176.98 60439.37,-174.18 60455.45,-169.91 60470.74,-165.18"/>
<polygon fill="black" stroke="black" points="60472.2,-168.38 60480.66,-162.01 60470.07,-161.72 60472.2,-168.38"/>
<text text-anchor="middle" x="59874" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l8_dp0 -->
<g id="node203" class="node">
<title>expert10_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="60415.5,-161.98 60186.5,-161.98 60186.5,-109.98 60415.5,-109.98 60415.5,-161.98"/>
<text text-anchor="middle" x="60301" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L8</text>
<text text-anchor="middle" x="60301" y="-138.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="60301" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="60301" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert10_l8_dp0 -->
<g id="edge330" class="edge">
<title>router_l8_dp0&#45;&gt;expert10_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58677.88,-169.04C58775.47,-181.04 58889.7,-193.09 58993.5,-198.98 59124.81,-206.43 60047.36,-199.14 60177,-176.98 60192.73,-174.29 60209.19,-169.98 60224.78,-165.15"/>
<polygon fill="black" stroke="black" points="60225.9,-168.46 60234.36,-162.08 60223.77,-161.79 60225.9,-168.46"/>
<text text-anchor="middle" x="59015" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l8_dp0 -->
<g id="node204" class="node">
<title>expert11_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="60168.5,-161.98 59939.5,-161.98 59939.5,-109.98 60168.5,-109.98 60168.5,-161.98"/>
<text text-anchor="middle" x="60054" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L8</text>
<text text-anchor="middle" x="60054" y="-138.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="60054" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="60054" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert11_l8_dp0 -->
<g id="edge331" class="edge">
<title>router_l8_dp0&#45;&gt;expert11_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58674.51,-166.28C58785.54,-179.16 58920.13,-192.64 59041.5,-198.98 59238.73,-209.28 59735.43,-210.92 59930,-176.98 59945.72,-174.24 59962.17,-169.91 59977.76,-165.06"/>
<polygon fill="black" stroke="black" points="59978.89,-168.38 59987.35,-161.99 59976.75,-161.71 59978.89,-168.38"/>
<text text-anchor="middle" x="59063" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l8_dp0 -->
<g id="node205" class="node">
<title>expert12_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="59921.5,-161.98 59692.5,-161.98 59692.5,-109.98 59921.5,-109.98 59921.5,-161.98"/>
<text text-anchor="middle" x="59807" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L8</text>
<text text-anchor="middle" x="59807" y="-138.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="59807" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="59807" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert12_l8_dp0 -->
<g id="edge332" class="edge">
<title>router_l8_dp0&#45;&gt;expert12_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58666.29,-159.74C58723,-165.54 58783.71,-171.62 58840,-176.98 58840,-176.98 59683,-176.98 59683,-176.98 59698.37,-174.19 59714.45,-169.93 59729.75,-165.2"/>
<polygon fill="black" stroke="black" points="59731.21,-168.41 59739.67,-162.03 59729.08,-161.74 59731.21,-168.41"/>
<text text-anchor="middle" x="59111" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l8_dp0 -->
<g id="node206" class="node">
<title>expert13_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="59674.5,-161.98 59445.5,-161.98 59445.5,-109.98 59674.5,-109.98 59674.5,-161.98"/>
<text text-anchor="middle" x="59560" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L8</text>
<text text-anchor="middle" x="59560" y="-138.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="59560" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="59560" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert13_l8_dp0 -->
<g id="edge333" class="edge">
<title>router_l8_dp0&#45;&gt;expert13_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58686.61,-176.06C58864.88,-199.52 59111.36,-220.67 59327.5,-198.98 59378.66,-193.85 59434.31,-179.11 59478.33,-165.18"/>
<polygon fill="black" stroke="black" points="59479.66,-168.43 59488.11,-162.04 59477.52,-161.77 59479.66,-168.43"/>
<text text-anchor="middle" x="59306" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l8_dp0 -->
<g id="node207" class="node">
<title>expert14_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="59427.5,-161.98 59198.5,-161.98 59198.5,-109.98 59427.5,-109.98 59427.5,-161.98"/>
<text text-anchor="middle" x="59313" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L8</text>
<text text-anchor="middle" x="59313" y="-138.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="59313" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="59313" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert14_l8_dp0 -->
<g id="edge334" class="edge">
<title>router_l8_dp0&#45;&gt;expert14_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58670.52,-163.01C58806.24,-177.37 58981.37,-193.22 59137.5,-198.98 59156.6,-199.69 59161.86,-203.19 59180.5,-198.98 59208.7,-192.62 59237.94,-179.52 59261.75,-166.9"/>
<polygon fill="black" stroke="black" points="59263.48,-169.94 59270.6,-162.1 59260.14,-163.79 59263.48,-169.94"/>
<text text-anchor="middle" x="59159" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l8_dp0 -->
<g id="node208" class="node">
<title>expert15_l8_dp0</title>
<polygon fill="lightgreen" stroke="black" points="59078.5,-161.98 58849.5,-161.98 58849.5,-109.98 59078.5,-109.98 59078.5,-161.98"/>
<text text-anchor="middle" x="58964" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L8</text>
<text text-anchor="middle" x="58964" y="-138.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="58964" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="58964" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp0&#45;&gt;expert15_l8_dp0 -->
<g id="edge335" class="edge">
<title>router_l8_dp0&#45;&gt;expert15_l8_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M58636.98,-135.98C58704.75,-135.98 58778.72,-135.98 58839.14,-135.98"/>
<polygon fill="black" stroke="black" points="58839.49,-139.48 58849.49,-135.98 58839.49,-132.48 58839.49,-139.48"/>
<text text-anchor="middle" x="58768.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l8_dp0 -->
<g id="node209" class="node">
<title>expert_agg_l8_dp0</title>
<polygon fill="lightyellow" stroke="black" points="63416.57,-176.98 63022.74,-176.98 62921.43,-94.98 63315.26,-94.98 63416.57,-176.98"/>
<text text-anchor="middle" x="63169" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="63169" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="63169" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge336" class="edge">
<title>expert0_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M62885.66,-135.98C62911.06,-135.98 62936.47,-135.98 62961.87,-135.98"/>
<polygon fill="black" stroke="black" points="62961.99,-139.48 62971.99,-135.98 62961.99,-132.48 62961.99,-139.48"/>
</g>
<!-- expert1_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge337" class="edge">
<title>expert1_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M62579.24,-162.02C62602.4,-171.57 62629.96,-181.22 62656,-185.98 62706.06,-195.15 62834.3,-190.41 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert2_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge338" class="edge">
<title>expert2_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M62332.24,-162.02C62355.4,-171.57 62382.96,-181.22 62409,-185.98 62461.02,-195.51 62832.31,-190.59 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert3_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge339" class="edge">
<title>expert3_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M62085.24,-162.02C62108.4,-171.57 62135.96,-181.22 62162,-185.98 62241.02,-200.45 62804.97,-192.97 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert4_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge340" class="edge">
<title>expert4_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M61838.24,-162.02C61861.4,-171.57 61888.96,-181.22 61915,-185.98 61968.01,-195.69 62831.31,-190.67 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert5_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge341" class="edge">
<title>expert5_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M61591.24,-162.02C61614.4,-171.57 61641.96,-181.22 61668,-185.98 61734.5,-198.16 62817.64,-191.87 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert6_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge342" class="edge">
<title>expert6_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M61344.24,-162.02C61367.4,-171.57 61394.96,-181.22 61421,-185.98 61501,-200.63 62803.97,-193.06 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert7_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge343" class="edge">
<title>expert7_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M61097.24,-162.02C61120.4,-171.57 61147.96,-181.22 61174,-185.98 61220.75,-194.54 62837.65,-190.12 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert8_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge344" class="edge">
<title>expert8_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M60850.24,-162.02C60873.4,-171.57 60900.96,-181.22 60927,-185.98 60980.5,-195.78 62830.82,-190.72 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert9_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge345" class="edge">
<title>expert9_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M60603.24,-162.02C60626.4,-171.57 60653.96,-181.22 60680,-185.98 60740.25,-197.01 62823.98,-191.31 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert10_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge346" class="edge">
<title>expert10_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M60356.24,-162.02C60379.4,-171.57 60406.96,-181.22 60433,-185.98 60500,-198.25 62817.15,-191.91 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert11_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge347" class="edge">
<title>expert11_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M60109.24,-162.02C60132.4,-171.57 60159.96,-181.22 60186,-185.98 60259.75,-199.48 62810.31,-192.51 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert12_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge348" class="edge">
<title>expert12_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M59862.24,-162.02C59885.4,-171.57 59912.96,-181.22 59939,-185.98 60019.49,-200.72 62803.48,-193.1 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert13_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge349" class="edge">
<title>expert13_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M59615.24,-162.02C59638.4,-171.57 59665.96,-181.22 59692,-185.98 59735.62,-193.97 62840.82,-189.84 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert14_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge350" class="edge">
<title>expert14_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M59368.24,-162.02C59391.4,-171.57 59418.96,-181.22 59445,-185.98 59492,-194.59 62837.4,-190.14 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- expert15_l8_dp0&#45;&gt;expert_agg_l8_dp0 -->
<g id="edge351" class="edge">
<title>expert15_l8_dp0&#45;&gt;expert_agg_l8_dp0</title>
<path fill="none" stroke="black" d="M59063.17,-162C59104.54,-171.59 59153.28,-181.26 59198,-185.98 59299.85,-196.74 62782.97,-194.9 62885,-185.98 62923.11,-182.65 62963.78,-176.86 63002.08,-170.36"/>
<polygon fill="black" stroke="black" points="63003.02,-173.75 63012.29,-168.6 63001.84,-166.85 63003.02,-173.75"/>
</g>
<!-- layer8_output_dp0 -->
<g id="node210" class="node">
<title>layer8_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="63621" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="63621" y="-144.48" font-family="Arial" font-size="10.00">Layer 8 Output</text>
<text text-anchor="middle" x="63621" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="63621" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l8_dp0&#45;&gt;layer8_output_dp0 -->
<g id="edge352" class="edge">
<title>expert_agg_l8_dp0&#45;&gt;layer8_output_dp0</title>
<path fill="none" stroke="black" d="M63366.31,-135.98C63391.49,-135.98 63416.66,-135.98 63441.84,-135.98"/>
<polygon fill="black" stroke="black" points="63441.87,-139.48 63451.87,-135.98 63441.87,-132.48 63441.87,-139.48"/>
</g>
<!-- stage1_output_dp0 -->
<g id="node211" class="node">
<title>stage1_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="63994" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="63994" y="-144.48" font-family="Arial" font-size="10.00">Stage 1 Output</text>
<text text-anchor="middle" x="63994" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="63994" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer8_output_dp0&#45;&gt;stage1_output_dp0 -->
<g id="edge353" class="edge">
<title>layer8_output_dp0&#45;&gt;stage1_output_dp0</title>
<path fill="none" stroke="black" d="M63790.01,-135.98C63798.23,-135.98 63806.44,-135.98 63814.66,-135.98"/>
<polygon fill="black" stroke="black" points="63814.68,-139.48 63824.68,-135.98 63814.68,-132.48 63814.68,-139.48"/>
</g>
<!-- stage2_input_dp0 -->
<g id="node212" class="node">
<title>stage2_input_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="64367" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="64367" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Input</text>
<text text-anchor="middle" x="64367" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="64367" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_output_dp0&#45;&gt;stage2_input_dp0 -->
<g id="edge354" class="edge">
<title>stage1_output_dp0&#45;&gt;stage2_input_dp0</title>
<path fill="none" stroke="black" d="M64163.01,-135.98C64171.23,-135.98 64179.44,-135.98 64187.66,-135.98"/>
<polygon fill="black" stroke="black" points="64187.68,-139.48 64197.68,-135.98 64187.68,-132.48 64187.68,-139.48"/>
</g>
<!-- attn_input_l9_dp0 -->
<g id="node213" class="node">
<title>attn_input_l9_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="64740" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="64740" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L9</text>
<text text-anchor="middle" x="64740" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="64740" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage2_input_dp0&#45;&gt;attn_input_l9_dp0 -->
<g id="edge355" class="edge">
<title>stage2_input_dp0&#45;&gt;attn_input_l9_dp0</title>
<path fill="none" stroke="black" d="M64536.01,-135.98C64544.23,-135.98 64552.44,-135.98 64560.66,-135.98"/>
<polygon fill="black" stroke="black" points="64560.68,-139.48 64570.68,-135.98 64560.68,-132.48 64560.68,-139.48"/>
</g>
<!-- attn_tp0_l9_dp0 -->
<g id="node214" class="node">
<title>attn_tp0_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="66038,-161.98 65778,-161.98 65778,-109.98 66038,-109.98 66038,-161.98"/>
<text text-anchor="middle" x="65908" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L9</text>
<text text-anchor="middle" x="65908" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="65908" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65908" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp0&#45;&gt;attn_tp0_l9_dp0 -->
<g id="edge356" class="edge">
<title>attn_input_l9_dp0&#45;&gt;attn_tp0_l9_dp0</title>
<path fill="none" stroke="black" d="M64823.52,-161.26C64860.12,-171.09 64903.81,-181.13 64944,-185.98 64989,-191.42 65715.27,-193.33 65760,-185.98 65785.4,-181.81 65812.31,-173.85 65836.12,-165.5"/>
<polygon fill="black" stroke="black" points="65837.55,-168.71 65845.78,-162.03 65835.18,-162.12 65837.55,-168.71"/>
</g>
<!-- attn_tp1_l9_dp0 -->
<g id="node215" class="node">
<title>attn_tp1_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="65760,-161.98 65500,-161.98 65500,-109.98 65760,-109.98 65760,-161.98"/>
<text text-anchor="middle" x="65630" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L9</text>
<text text-anchor="middle" x="65630" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="65630" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65630" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp0&#45;&gt;attn_tp1_l9_dp0 -->
<g id="edge357" class="edge">
<title>attn_input_l9_dp0&#45;&gt;attn_tp1_l9_dp0</title>
<path fill="none" stroke="black" d="M64823.52,-161.26C64860.12,-171.09 64903.81,-181.13 64944,-185.98 65003.35,-193.15 65423.01,-195.68 65482,-185.98 65507.4,-181.81 65534.31,-173.85 65558.12,-165.5"/>
<polygon fill="black" stroke="black" points="65559.55,-168.71 65567.78,-162.03 65557.18,-162.12 65559.55,-168.71"/>
</g>
<!-- attn_tp2_l9_dp0 -->
<g id="node216" class="node">
<title>attn_tp2_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="65482,-161.98 65222,-161.98 65222,-109.98 65482,-109.98 65482,-161.98"/>
<text text-anchor="middle" x="65352" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L9</text>
<text text-anchor="middle" x="65352" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="65352" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65352" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp0&#45;&gt;attn_tp2_l9_dp0 -->
<g id="edge358" class="edge">
<title>attn_input_l9_dp0&#45;&gt;attn_tp2_l9_dp0</title>
<path fill="none" stroke="black" d="M64823.52,-161.26C64860.12,-171.09 64903.81,-181.13 64944,-185.98 65001.36,-192.91 65146.99,-195.35 65204,-185.98 65229.4,-181.81 65256.31,-173.85 65280.12,-165.5"/>
<polygon fill="black" stroke="black" points="65281.55,-168.71 65289.78,-162.03 65279.18,-162.12 65281.55,-168.71"/>
</g>
<!-- attn_tp3_l9_dp0 -->
<g id="node217" class="node">
<title>attn_tp3_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="65204,-161.98 64944,-161.98 64944,-109.98 65204,-109.98 65204,-161.98"/>
<text text-anchor="middle" x="65074" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L9</text>
<text text-anchor="middle" x="65074" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="65074" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="65074" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp0&#45;&gt;attn_tp3_l9_dp0 -->
<g id="edge359" class="edge">
<title>attn_input_l9_dp0&#45;&gt;attn_tp3_l9_dp0</title>
<path fill="none" stroke="black" d="M64909.28,-135.98C64917.35,-135.98 64925.42,-135.98 64933.49,-135.98"/>
<polygon fill="black" stroke="black" points="64933.7,-139.48 64943.7,-135.98 64933.7,-132.48 64933.7,-139.48"/>
</g>
<!-- allreduce_l9_dp0 -->
<g id="node218" class="node">
<title>allreduce_l9_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="66242" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="66242" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L9</text>
<text text-anchor="middle" x="66242" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="66242" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l9_dp0&#45;&gt;allreduce_l9_dp0 -->
<g id="edge360" class="edge">
<title>attn_tp0_l9_dp0&#45;&gt;allreduce_l9_dp0</title>
<path fill="none" stroke="black" d="M66038.14,-135.98C66046.35,-135.98 66054.56,-135.98 66062.77,-135.98"/>
<polygon fill="black" stroke="black" points="66062.78,-139.48 66072.78,-135.98 66062.78,-132.48 66062.78,-139.48"/>
</g>
<!-- attn_tp1_l9_dp0&#45;&gt;allreduce_l9_dp0 -->
<g id="edge361" class="edge">
<title>attn_tp1_l9_dp0&#45;&gt;allreduce_l9_dp0</title>
<path fill="none" stroke="black" d="M65692.22,-162.03C65718.24,-171.59 65749.1,-181.23 65778,-185.98 65835.01,-195.35 65980.64,-192.91 66038,-185.98 66074.57,-181.57 66114.05,-172.85 66148.44,-163.91"/>
<polygon fill="black" stroke="black" points="66149.7,-167.2 66158.47,-161.26 66147.91,-160.43 66149.7,-167.2"/>
</g>
<!-- attn_tp2_l9_dp0&#45;&gt;allreduce_l9_dp0 -->
<g id="edge362" class="edge">
<title>attn_tp2_l9_dp0&#45;&gt;allreduce_l9_dp0</title>
<path fill="none" stroke="black" d="M65414.22,-162.03C65440.24,-171.59 65471.1,-181.23 65500,-185.98 65558.98,-195.68 65978.65,-193.15 66038,-185.98 66074.57,-181.57 66114.05,-172.85 66148.44,-163.91"/>
<polygon fill="black" stroke="black" points="66149.7,-167.2 66158.47,-161.26 66147.91,-160.43 66149.7,-167.2"/>
</g>
<!-- attn_tp3_l9_dp0&#45;&gt;allreduce_l9_dp0 -->
<g id="edge363" class="edge">
<title>attn_tp3_l9_dp0&#45;&gt;allreduce_l9_dp0</title>
<path fill="none" stroke="black" d="M65136.22,-162.03C65162.24,-171.59 65193.1,-181.23 65222,-185.98 65266.73,-193.33 65992.99,-191.42 66038,-185.98 66074.57,-181.57 66114.05,-172.85 66148.44,-163.91"/>
<polygon fill="black" stroke="black" points="66149.7,-167.2 66158.47,-161.26 66147.91,-160.43 66149.7,-167.2"/>
</g>
<!-- moe_input_l9_dp0 -->
<g id="node219" class="node">
<title>moe_input_l9_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="66615" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="66615" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L9</text>
<text text-anchor="middle" x="66615" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="66615" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l9_dp0&#45;&gt;moe_input_l9_dp0 -->
<g id="edge364" class="edge">
<title>allreduce_l9_dp0&#45;&gt;moe_input_l9_dp0</title>
<path fill="none" stroke="black" d="M66411.01,-135.98C66419.23,-135.98 66427.44,-135.98 66435.66,-135.98"/>
<polygon fill="black" stroke="black" points="66435.68,-139.48 66445.68,-135.98 66435.68,-132.48 66435.68,-139.48"/>
</g>
<!-- router_l9_dp0 -->
<g id="node220" class="node">
<title>router_l9_dp0</title>
<polygon fill="lightyellow" stroke="black" points="67314.57,-176.98 66920.74,-176.98 66819.43,-94.98 67213.26,-94.98 67314.57,-176.98"/>
<text text-anchor="middle" x="67067" y="-144.48" font-family="Arial" font-size="10.00">Router L9</text>
<text text-anchor="middle" x="67067" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="67067" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l9_dp0&#45;&gt;router_l9_dp0 -->
<g id="edge365" class="edge">
<title>moe_input_l9_dp0&#45;&gt;router_l9_dp0</title>
<path fill="none" stroke="black" d="M66784.06,-135.98C66809.34,-135.98 66834.63,-135.98 66859.92,-135.98"/>
<polygon fill="black" stroke="black" points="66859.99,-139.48 66869.99,-135.98 66859.99,-132.48 66859.99,-139.48"/>
</g>
<!-- expert0_l9_dp0 -->
<g id="node221" class="node">
<title>expert0_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="71560.5,-161.98 71331.5,-161.98 71331.5,-109.98 71560.5,-109.98 71560.5,-161.98"/>
<text text-anchor="middle" x="71446" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L9</text>
<text text-anchor="middle" x="71446" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="71446" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="71446" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert0_l9_dp0 -->
<g id="edge366" class="edge">
<title>router_l9_dp0&#45;&gt;expert0_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67296.12,-161.92C67359.19,-168.02 67427.67,-173.71 67491,-176.98 68188.86,-213.09 69936.71,-196.54 70635.5,-198.98 70940.76,-200.05 71021.49,-230.66 71322,-176.98 71337.62,-174.19 71353.96,-169.86 71369.47,-165.05"/>
<polygon fill="black" stroke="black" points="71370.55,-168.38 71379,-161.99 71368.41,-161.71 71370.55,-168.38"/>
<text text-anchor="middle" x="70657" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l9_dp0 -->
<g id="node222" class="node">
<title>expert1_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="71313.5,-161.98 71084.5,-161.98 71084.5,-109.98 71313.5,-109.98 71313.5,-161.98"/>
<text text-anchor="middle" x="71199" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L9</text>
<text text-anchor="middle" x="71199" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="71199" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="71199" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert1_l9_dp0 -->
<g id="edge367" class="edge">
<title>router_l9_dp0&#45;&gt;expert1_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67212.67,-176.99C67251.3,-186.08 67293.21,-194.39 67332.5,-198.98 67351.48,-201.2 67356.39,-199.04 67375.5,-198.98 67581.03,-198.37 70872.18,-210.26 71075,-176.98 71090.93,-174.37 71107.6,-170.03 71123.36,-165.14"/>
<polygon fill="black" stroke="black" points="71124.58,-168.42 71133.03,-162.03 71122.44,-161.76 71124.58,-168.42"/>
<text text-anchor="middle" x="67354" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l9_dp0 -->
<g id="node223" class="node">
<title>expert2_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="71066.5,-161.98 70837.5,-161.98 70837.5,-109.98 71066.5,-109.98 71066.5,-161.98"/>
<text text-anchor="middle" x="70952" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L9</text>
<text text-anchor="middle" x="70952" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="70952" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="70952" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert2_l9_dp0 -->
<g id="edge368" class="edge">
<title>router_l9_dp0&#45;&gt;expert2_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67295.85,-161.81C67359,-167.93 67427.58,-173.64 67491,-176.98 68047.03,-206.29 69439.75,-206.35 69996.5,-198.98 70181.32,-196.54 70645.91,-208.78 70828,-176.98 70843.72,-174.24 70860.17,-169.9 70875.76,-165.06"/>
<polygon fill="black" stroke="black" points="70876.89,-168.37 70885.34,-161.99 70874.75,-161.71 70876.89,-168.37"/>
<text text-anchor="middle" x="69975" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l9_dp0 -->
<g id="node224" class="node">
<title>expert3_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="70819.5,-161.98 70590.5,-161.98 70590.5,-109.98 70819.5,-109.98 70819.5,-161.98"/>
<text text-anchor="middle" x="70705" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L9</text>
<text text-anchor="middle" x="70705" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="70705" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="70705" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert3_l9_dp0 -->
<g id="edge369" class="edge">
<title>router_l9_dp0&#45;&gt;expert3_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67239.37,-177C67284.98,-186.1 67334.37,-194.39 67380.5,-198.98 67399.52,-200.87 67404.39,-199.05 67423.5,-198.98 67774.34,-197.76 70234.82,-233.97 70581,-176.98 70596.93,-174.36 70613.6,-170.02 70629.35,-165.13"/>
<polygon fill="black" stroke="black" points="70630.58,-168.41 70639.03,-162.02 70628.44,-161.75 70630.58,-168.41"/>
<text text-anchor="middle" x="67402" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l9_dp0 -->
<g id="node225" class="node">
<title>expert4_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="70572.5,-161.98 70343.5,-161.98 70343.5,-109.98 70572.5,-109.98 70572.5,-161.98"/>
<text text-anchor="middle" x="70458" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L9</text>
<text text-anchor="middle" x="70458" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="70458" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="70458" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert4_l9_dp0 -->
<g id="edge370" class="edge">
<title>router_l9_dp0&#45;&gt;expert4_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67266.02,-177C67318.62,-186.1 67375.5,-194.4 67428.5,-198.98 67447.54,-200.63 67452.39,-199.06 67471.5,-198.98 67789.56,-197.76 70020.18,-228.76 70334,-176.98 70349.93,-174.35 70366.6,-170.01 70382.35,-165.12"/>
<polygon fill="black" stroke="black" points="70383.58,-168.4 70392.03,-162.01 70381.44,-161.74 70383.58,-168.4"/>
<text text-anchor="middle" x="67450" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l9_dp0 -->
<g id="node226" class="node">
<title>expert5_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="70325.5,-161.98 70096.5,-161.98 70096.5,-109.98 70325.5,-109.98 70325.5,-161.98"/>
<text text-anchor="middle" x="70211" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L9</text>
<text text-anchor="middle" x="70211" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="70211" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="70211" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert5_l9_dp0 -->
<g id="edge371" class="edge">
<title>router_l9_dp0&#45;&gt;expert5_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67292.65,-177.01C67352.23,-186.11 67416.61,-194.4 67476.5,-198.98 67495.55,-200.44 67500.39,-199.06 67519.5,-198.98 67804.78,-197.76 69805.54,-223.55 70087,-176.98 70102.93,-174.35 70119.59,-170 70135.35,-165.11"/>
<polygon fill="black" stroke="black" points="70136.58,-168.39 70145.03,-162 70134.44,-161.73 70136.58,-168.39"/>
<text text-anchor="middle" x="67498" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l9_dp0 -->
<g id="node227" class="node">
<title>expert6_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="70078.5,-161.98 69849.5,-161.98 69849.5,-109.98 70078.5,-109.98 70078.5,-161.98"/>
<text text-anchor="middle" x="69964" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L9</text>
<text text-anchor="middle" x="69964" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="69964" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="69964" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert6_l9_dp0 -->
<g id="edge372" class="edge">
<title>router_l9_dp0&#45;&gt;expert6_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67295.59,-161.58C67358.81,-167.7 67427.49,-173.48 67491,-176.98 68216.85,-217.02 68399.63,-210.19 69126.5,-198.98 69443.72,-194.09 69527.59,-232.24 69840,-176.98 69855.62,-174.22 69871.97,-169.9 69887.48,-165.09"/>
<polygon fill="black" stroke="black" points="69888.55,-168.42 69897.01,-162.04 69886.42,-161.75 69888.55,-168.42"/>
<text text-anchor="middle" x="69105" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l9_dp0 -->
<g id="node228" class="node">
<title>expert7_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="69831.5,-161.98 69602.5,-161.98 69602.5,-109.98 69831.5,-109.98 69831.5,-161.98"/>
<text text-anchor="middle" x="69717" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L9</text>
<text text-anchor="middle" x="69717" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="69717" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="69717" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert7_l9_dp0 -->
<g id="edge373" class="edge">
<title>router_l9_dp0&#45;&gt;expert7_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67313.89,-176.28C67381.94,-185.66 67455.91,-194.28 67524.5,-198.98 67543.56,-200.29 67548.39,-199.09 67567.5,-198.98 67792.56,-197.76 69370.99,-213.97 69593,-176.98 69608.83,-174.34 69625.4,-170.03 69641.07,-165.17"/>
<polygon fill="black" stroke="black" points="69642.25,-168.46 69650.7,-162.08 69640.11,-161.8 69642.25,-168.46"/>
<text text-anchor="middle" x="67546" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l9_dp0 -->
<g id="node229" class="node">
<title>expert8_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="69584.5,-161.98 69355.5,-161.98 69355.5,-109.98 69584.5,-109.98 69584.5,-161.98"/>
<text text-anchor="middle" x="69470" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L9</text>
<text text-anchor="middle" x="69470" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="69470" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="69470" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert8_l9_dp0 -->
<g id="edge374" class="edge">
<title>router_l9_dp0&#45;&gt;expert8_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67309.08,-172.34C67392.36,-183.2 67486.33,-193.63 67572.5,-198.98 67769.19,-211.19 69151.64,-209.55 69346,-176.98 69361.83,-174.33 69378.39,-170.01 69394.07,-165.14"/>
<polygon fill="black" stroke="black" points="69395.24,-168.44 69403.7,-162.05 69393.11,-161.78 69395.24,-168.44"/>
<text text-anchor="middle" x="67594" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l9_dp0 -->
<g id="node230" class="node">
<title>expert9_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="69337.5,-161.98 69108.5,-161.98 69108.5,-109.98 69337.5,-109.98 69337.5,-161.98"/>
<text text-anchor="middle" x="69223" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L9</text>
<text text-anchor="middle" x="69223" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="69223" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="69223" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert9_l9_dp0 -->
<g id="edge375" class="edge">
<title>router_l9_dp0&#45;&gt;expert9_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67304.88,-169.04C67402.47,-181.04 67516.7,-193.09 67620.5,-198.98 67784.53,-208.29 68937,-204.35 69099,-176.98 69114.83,-174.31 69131.39,-169.98 69147.06,-165.11"/>
<polygon fill="black" stroke="black" points="69148.24,-168.41 69156.69,-162.02 69146.1,-161.74 69148.24,-168.41"/>
<text text-anchor="middle" x="67642" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l9_dp0 -->
<g id="node231" class="node">
<title>expert10_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="69090.5,-161.98 68861.5,-161.98 68861.5,-109.98 69090.5,-109.98 69090.5,-161.98"/>
<text text-anchor="middle" x="68976" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L9</text>
<text text-anchor="middle" x="68976" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="68976" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="68976" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert10_l9_dp0 -->
<g id="edge376" class="edge">
<title>router_l9_dp0&#45;&gt;expert10_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67295.06,-161C67358.44,-167.15 67427.33,-173.08 67491,-176.98 67882.61,-201.02 67981.26,-208 68373.5,-198.98 68586.33,-194.09 68642.65,-215.65 68852,-176.98 68867.27,-174.16 68883.25,-169.92 68898.46,-165.21"/>
<polygon fill="black" stroke="black" points="68899.87,-168.43 68908.33,-162.06 68897.74,-161.76 68899.87,-168.43"/>
<text text-anchor="middle" x="68352" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l9_dp0 -->
<g id="node232" class="node">
<title>expert11_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="68843.5,-161.98 68614.5,-161.98 68614.5,-109.98 68843.5,-109.98 68843.5,-161.98"/>
<text text-anchor="middle" x="68729" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L9</text>
<text text-anchor="middle" x="68729" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="68729" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="68729" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert11_l9_dp0 -->
<g id="edge377" class="edge">
<title>router_l9_dp0&#45;&gt;expert11_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67301.51,-166.28C67412.54,-179.16 67547.13,-192.64 67668.5,-198.98 67876.38,-209.84 68399.9,-212.61 68605,-176.98 68620.72,-174.25 68637.18,-169.92 68652.77,-165.08"/>
<polygon fill="black" stroke="black" points="68653.89,-168.39 68662.35,-162.01 68651.76,-161.73 68653.89,-168.39"/>
<text text-anchor="middle" x="67690" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l9_dp0 -->
<g id="node233" class="node">
<title>expert12_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="68596.5,-161.98 68367.5,-161.98 68367.5,-109.98 68596.5,-109.98 68596.5,-161.98"/>
<text text-anchor="middle" x="68482" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L9</text>
<text text-anchor="middle" x="68482" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="68482" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="68482" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert12_l9_dp0 -->
<g id="edge378" class="edge">
<title>router_l9_dp0&#45;&gt;expert12_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67298.44,-163.92C67422.26,-177.47 67577.46,-192.26 67716.5,-198.98 67858.97,-205.88 68217.61,-202.24 68358,-176.98 68373.38,-174.22 68389.46,-169.97 68404.75,-165.24"/>
<polygon fill="black" stroke="black" points="68406.21,-168.44 68414.67,-162.07 68404.08,-161.78 68406.21,-168.44"/>
<text text-anchor="middle" x="67738" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l9_dp0 -->
<g id="node234" class="node">
<title>expert13_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="68349.5,-161.98 68120.5,-161.98 68120.5,-109.98 68349.5,-109.98 68349.5,-161.98"/>
<text text-anchor="middle" x="68235" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L9</text>
<text text-anchor="middle" x="68235" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="68235" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="68235" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert13_l9_dp0 -->
<g id="edge379" class="edge">
<title>router_l9_dp0&#45;&gt;expert13_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67307.38,-176.99C67520.6,-205.92 67839.44,-230.86 68111,-176.98 68125.96,-174.01 68141.62,-169.78 68156.58,-165.14"/>
<polygon fill="black" stroke="black" points="68157.83,-168.41 68166.29,-162.04 68155.7,-161.74 68157.83,-168.41"/>
<text text-anchor="middle" x="67786" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l9_dp0 -->
<g id="node235" class="node">
<title>expert14_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="68102.5,-161.98 67873.5,-161.98 67873.5,-109.98 68102.5,-109.98 68102.5,-161.98"/>
<text text-anchor="middle" x="67988" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L9</text>
<text text-anchor="middle" x="67988" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="67988" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="67988" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert14_l9_dp0 -->
<g id="edge380" class="edge">
<title>router_l9_dp0&#45;&gt;expert14_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67295.45,-161.26C67442.81,-176.09 67638.71,-193.04 67812.5,-198.98 67831.6,-199.64 67836.86,-203.19 67855.5,-198.98 67883.7,-192.62 67912.94,-179.52 67936.75,-166.9"/>
<polygon fill="black" stroke="black" points="67938.48,-169.94 67945.6,-162.1 67935.14,-163.79 67938.48,-169.94"/>
<text text-anchor="middle" x="67834" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l9_dp0 -->
<g id="node236" class="node">
<title>expert15_l9_dp0</title>
<polygon fill="lightgreen" stroke="black" points="67729.5,-161.98 67500.5,-161.98 67500.5,-109.98 67729.5,-109.98 67729.5,-161.98"/>
<text text-anchor="middle" x="67615" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L9</text>
<text text-anchor="middle" x="67615" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="67615" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="67615" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp0&#45;&gt;expert15_l9_dp0 -->
<g id="edge381" class="edge">
<title>router_l9_dp0&#45;&gt;expert15_l9_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M67264.06,-135.98C67339.51,-135.98 67423.43,-135.98 67490.28,-135.98"/>
<polygon fill="black" stroke="black" points="67490.44,-139.48 67500.44,-135.98 67490.44,-132.48 67490.44,-139.48"/>
<text text-anchor="middle" x="67407.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l9_dp0 -->
<g id="node237" class="node">
<title>expert_agg_l9_dp0</title>
<polygon fill="lightyellow" stroke="black" points="72091.57,-176.98 71697.74,-176.98 71596.43,-94.98 71990.26,-94.98 72091.57,-176.98"/>
<text text-anchor="middle" x="71844" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L9</text>
<text text-anchor="middle" x="71844" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="71844" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge382" class="edge">
<title>expert0_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M71560.66,-135.98C71586.06,-135.98 71611.47,-135.98 71636.87,-135.98"/>
<polygon fill="black" stroke="black" points="71636.99,-139.48 71646.99,-135.98 71636.99,-132.48 71636.99,-139.48"/>
</g>
<!-- expert1_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge383" class="edge">
<title>expert1_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M71254.24,-162.02C71277.4,-171.57 71304.96,-181.22 71331,-185.98 71381.06,-195.15 71509.3,-190.41 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert2_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge384" class="edge">
<title>expert2_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M71007.24,-162.02C71030.4,-171.57 71057.96,-181.22 71084,-185.98 71136.02,-195.51 71507.31,-190.59 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert3_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge385" class="edge">
<title>expert3_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M70760.24,-162.02C70783.4,-171.57 70810.96,-181.22 70837,-185.98 70916.02,-200.45 71479.97,-192.97 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert4_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge386" class="edge">
<title>expert4_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M70513.24,-162.02C70536.4,-171.57 70563.96,-181.22 70590,-185.98 70643.01,-195.69 71506.31,-190.67 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert5_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge387" class="edge">
<title>expert5_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M70266.24,-162.02C70289.4,-171.57 70316.96,-181.22 70343,-185.98 70409.5,-198.16 71492.64,-191.87 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert6_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge388" class="edge">
<title>expert6_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M70019.24,-162.02C70042.4,-171.57 70069.96,-181.22 70096,-185.98 70176,-200.63 71478.97,-193.06 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert7_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge389" class="edge">
<title>expert7_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M69772.24,-162.02C69795.4,-171.57 69822.96,-181.22 69849,-185.98 69895.75,-194.54 71512.65,-190.12 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert8_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge390" class="edge">
<title>expert8_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M69525.24,-162.02C69548.4,-171.57 69575.96,-181.22 69602,-185.98 69655.5,-195.78 71505.82,-190.72 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert9_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge391" class="edge">
<title>expert9_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M69278.24,-162.02C69301.4,-171.57 69328.96,-181.22 69355,-185.98 69415.25,-197.01 71498.98,-191.31 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert10_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge392" class="edge">
<title>expert10_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M69031.24,-162.02C69054.4,-171.57 69081.96,-181.22 69108,-185.98 69175,-198.25 71492.15,-191.91 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert11_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge393" class="edge">
<title>expert11_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M68784.24,-162.02C68807.4,-171.57 68834.96,-181.22 68861,-185.98 68934.75,-199.48 71485.31,-192.51 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert12_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge394" class="edge">
<title>expert12_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M68537.24,-162.02C68560.4,-171.57 68587.96,-181.22 68614,-185.98 68694.49,-200.72 71478.48,-193.1 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert13_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge395" class="edge">
<title>expert13_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M68290.24,-162.02C68313.4,-171.57 68340.96,-181.22 68367,-185.98 68410.62,-193.97 71515.82,-189.84 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert14_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge396" class="edge">
<title>expert14_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M68043.24,-162.02C68066.4,-171.57 68093.96,-181.22 68120,-185.98 68167,-194.59 71512.4,-190.14 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- expert15_l9_dp0&#45;&gt;expert_agg_l9_dp0 -->
<g id="edge397" class="edge">
<title>expert15_l9_dp0&#45;&gt;expert_agg_l9_dp0</title>
<path fill="none" stroke="black" d="M67724.49,-162.01C67770.12,-171.59 67823.84,-181.26 67873,-185.98 67974.95,-195.77 71457.97,-194.9 71560,-185.98 71598.11,-182.65 71638.78,-176.86 71677.08,-170.36"/>
<polygon fill="black" stroke="black" points="71678.02,-173.75 71687.29,-168.6 71676.84,-166.85 71678.02,-173.75"/>
</g>
<!-- layer9_output_dp0 -->
<g id="node238" class="node">
<title>layer9_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="72296" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="72296" y="-144.48" font-family="Arial" font-size="10.00">Layer 9 Output</text>
<text text-anchor="middle" x="72296" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="72296" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l9_dp0&#45;&gt;layer9_output_dp0 -->
<g id="edge398" class="edge">
<title>expert_agg_l9_dp0&#45;&gt;layer9_output_dp0</title>
<path fill="none" stroke="black" d="M72041.31,-135.98C72066.49,-135.98 72091.66,-135.98 72116.84,-135.98"/>
<polygon fill="black" stroke="black" points="72116.87,-139.48 72126.87,-135.98 72116.87,-132.48 72116.87,-139.48"/>
</g>
<!-- attn_input_l10_dp0 -->
<g id="node239" class="node">
<title>attn_input_l10_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="72669" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="72669" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L10</text>
<text text-anchor="middle" x="72669" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="72669" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer9_output_dp0&#45;&gt;attn_input_l10_dp0 -->
<g id="edge399" class="edge">
<title>layer9_output_dp0&#45;&gt;attn_input_l10_dp0</title>
<path fill="none" stroke="black" d="M72465.01,-135.98C72473.23,-135.98 72481.44,-135.98 72489.66,-135.98"/>
<polygon fill="black" stroke="black" points="72489.68,-139.48 72499.68,-135.98 72489.68,-132.48 72489.68,-139.48"/>
</g>
<!-- attn_tp0_l10_dp0 -->
<g id="node240" class="node">
<title>attn_tp0_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="73967,-161.98 73707,-161.98 73707,-109.98 73967,-109.98 73967,-161.98"/>
<text text-anchor="middle" x="73837" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L10</text>
<text text-anchor="middle" x="73837" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="73837" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="73837" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp0&#45;&gt;attn_tp0_l10_dp0 -->
<g id="edge400" class="edge">
<title>attn_input_l10_dp0&#45;&gt;attn_tp0_l10_dp0</title>
<path fill="none" stroke="black" d="M72752.52,-161.26C72789.12,-171.09 72832.81,-181.13 72873,-185.98 72918,-191.42 73644.27,-193.33 73689,-185.98 73714.4,-181.81 73741.31,-173.85 73765.12,-165.5"/>
<polygon fill="black" stroke="black" points="73766.55,-168.71 73774.78,-162.03 73764.18,-162.12 73766.55,-168.71"/>
</g>
<!-- attn_tp1_l10_dp0 -->
<g id="node241" class="node">
<title>attn_tp1_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="73689,-161.98 73429,-161.98 73429,-109.98 73689,-109.98 73689,-161.98"/>
<text text-anchor="middle" x="73559" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L10</text>
<text text-anchor="middle" x="73559" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="73559" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="73559" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp0&#45;&gt;attn_tp1_l10_dp0 -->
<g id="edge401" class="edge">
<title>attn_input_l10_dp0&#45;&gt;attn_tp1_l10_dp0</title>
<path fill="none" stroke="black" d="M72752.52,-161.26C72789.12,-171.09 72832.81,-181.13 72873,-185.98 72932.35,-193.15 73352.01,-195.68 73411,-185.98 73436.4,-181.81 73463.31,-173.85 73487.12,-165.5"/>
<polygon fill="black" stroke="black" points="73488.55,-168.71 73496.78,-162.03 73486.18,-162.12 73488.55,-168.71"/>
</g>
<!-- attn_tp2_l10_dp0 -->
<g id="node242" class="node">
<title>attn_tp2_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="73411,-161.98 73151,-161.98 73151,-109.98 73411,-109.98 73411,-161.98"/>
<text text-anchor="middle" x="73281" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L10</text>
<text text-anchor="middle" x="73281" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="73281" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="73281" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp0&#45;&gt;attn_tp2_l10_dp0 -->
<g id="edge402" class="edge">
<title>attn_input_l10_dp0&#45;&gt;attn_tp2_l10_dp0</title>
<path fill="none" stroke="black" d="M72752.52,-161.26C72789.12,-171.09 72832.81,-181.13 72873,-185.98 72930.36,-192.91 73075.99,-195.35 73133,-185.98 73158.4,-181.81 73185.31,-173.85 73209.12,-165.5"/>
<polygon fill="black" stroke="black" points="73210.55,-168.71 73218.78,-162.03 73208.18,-162.12 73210.55,-168.71"/>
</g>
<!-- attn_tp3_l10_dp0 -->
<g id="node243" class="node">
<title>attn_tp3_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="73133,-161.98 72873,-161.98 72873,-109.98 73133,-109.98 73133,-161.98"/>
<text text-anchor="middle" x="73003" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L10</text>
<text text-anchor="middle" x="73003" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="73003" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="73003" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp0&#45;&gt;attn_tp3_l10_dp0 -->
<g id="edge403" class="edge">
<title>attn_input_l10_dp0&#45;&gt;attn_tp3_l10_dp0</title>
<path fill="none" stroke="black" d="M72838.28,-135.98C72846.35,-135.98 72854.42,-135.98 72862.49,-135.98"/>
<polygon fill="black" stroke="black" points="72862.7,-139.48 72872.7,-135.98 72862.7,-132.48 72862.7,-139.48"/>
</g>
<!-- allreduce_l10_dp0 -->
<g id="node244" class="node">
<title>allreduce_l10_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="74171" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="74171" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L10</text>
<text text-anchor="middle" x="74171" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="74171" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l10_dp0&#45;&gt;allreduce_l10_dp0 -->
<g id="edge404" class="edge">
<title>attn_tp0_l10_dp0&#45;&gt;allreduce_l10_dp0</title>
<path fill="none" stroke="black" d="M73967.14,-135.98C73975.35,-135.98 73983.56,-135.98 73991.77,-135.98"/>
<polygon fill="black" stroke="black" points="73991.78,-139.48 74001.78,-135.98 73991.78,-132.48 73991.78,-139.48"/>
</g>
<!-- attn_tp1_l10_dp0&#45;&gt;allreduce_l10_dp0 -->
<g id="edge405" class="edge">
<title>attn_tp1_l10_dp0&#45;&gt;allreduce_l10_dp0</title>
<path fill="none" stroke="black" d="M73621.22,-162.03C73647.24,-171.59 73678.1,-181.23 73707,-185.98 73764.01,-195.35 73909.64,-192.91 73967,-185.98 74003.57,-181.57 74043.05,-172.85 74077.44,-163.91"/>
<polygon fill="black" stroke="black" points="74078.7,-167.2 74087.47,-161.26 74076.91,-160.43 74078.7,-167.2"/>
</g>
<!-- attn_tp2_l10_dp0&#45;&gt;allreduce_l10_dp0 -->
<g id="edge406" class="edge">
<title>attn_tp2_l10_dp0&#45;&gt;allreduce_l10_dp0</title>
<path fill="none" stroke="black" d="M73343.22,-162.03C73369.24,-171.59 73400.1,-181.23 73429,-185.98 73487.98,-195.68 73907.65,-193.15 73967,-185.98 74003.57,-181.57 74043.05,-172.85 74077.44,-163.91"/>
<polygon fill="black" stroke="black" points="74078.7,-167.2 74087.47,-161.26 74076.91,-160.43 74078.7,-167.2"/>
</g>
<!-- attn_tp3_l10_dp0&#45;&gt;allreduce_l10_dp0 -->
<g id="edge407" class="edge">
<title>attn_tp3_l10_dp0&#45;&gt;allreduce_l10_dp0</title>
<path fill="none" stroke="black" d="M73065.22,-162.03C73091.24,-171.59 73122.1,-181.23 73151,-185.98 73195.73,-193.33 73921.99,-191.42 73967,-185.98 74003.57,-181.57 74043.05,-172.85 74077.44,-163.91"/>
<polygon fill="black" stroke="black" points="74078.7,-167.2 74087.47,-161.26 74076.91,-160.43 74078.7,-167.2"/>
</g>
<!-- moe_input_l10_dp0 -->
<g id="node245" class="node">
<title>moe_input_l10_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="74544" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="74544" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L10</text>
<text text-anchor="middle" x="74544" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="74544" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l10_dp0&#45;&gt;moe_input_l10_dp0 -->
<g id="edge408" class="edge">
<title>allreduce_l10_dp0&#45;&gt;moe_input_l10_dp0</title>
<path fill="none" stroke="black" d="M74340.01,-135.98C74348.23,-135.98 74356.44,-135.98 74364.66,-135.98"/>
<polygon fill="black" stroke="black" points="74364.68,-139.48 74374.68,-135.98 74364.68,-132.48 74364.68,-139.48"/>
</g>
<!-- router_l10_dp0 -->
<g id="node246" class="node">
<title>router_l10_dp0</title>
<polygon fill="lightyellow" stroke="black" points="75243.57,-176.98 74849.74,-176.98 74748.43,-94.98 75142.26,-94.98 75243.57,-176.98"/>
<text text-anchor="middle" x="74996" y="-144.48" font-family="Arial" font-size="10.00">Router L10</text>
<text text-anchor="middle" x="74996" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="74996" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l10_dp0&#45;&gt;router_l10_dp0 -->
<g id="edge409" class="edge">
<title>moe_input_l10_dp0&#45;&gt;router_l10_dp0</title>
<path fill="none" stroke="black" d="M74713.06,-135.98C74738.34,-135.98 74763.63,-135.98 74788.92,-135.98"/>
<polygon fill="black" stroke="black" points="74788.99,-139.48 74798.99,-135.98 74788.99,-132.48 74788.99,-139.48"/>
</g>
<!-- expert0_l10_dp0 -->
<g id="node247" class="node">
<title>expert0_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="79489.5,-161.98 79260.5,-161.98 79260.5,-109.98 79489.5,-109.98 79489.5,-161.98"/>
<text text-anchor="middle" x="79375" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L10</text>
<text text-anchor="middle" x="79375" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="79375" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="79375" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert0_l10_dp0 -->
<g id="edge410" class="edge">
<title>router_l10_dp0&#45;&gt;expert0_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75225.12,-161.91C75288.19,-168.01 75356.67,-173.7 75420,-176.98 76093.89,-211.94 77781.71,-196.54 78456.5,-198.98 78633.12,-199.62 79077.05,-207.61 79251,-176.98 79266.62,-174.23 79282.97,-169.92 79298.48,-165.11"/>
<polygon fill="black" stroke="black" points="79299.56,-168.44 79308.02,-162.06 79297.42,-161.77 79299.56,-168.44"/>
<text text-anchor="middle" x="78478" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l10_dp0 -->
<g id="node248" class="node">
<title>expert1_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="79242.5,-161.98 79013.5,-161.98 79013.5,-109.98 79242.5,-109.98 79242.5,-161.98"/>
<text text-anchor="middle" x="79128" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L10</text>
<text text-anchor="middle" x="79128" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="79128" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="79128" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert1_l10_dp0 -->
<g id="edge411" class="edge">
<title>router_l10_dp0&#45;&gt;expert1_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75141.67,-176.99C75180.3,-186.08 75222.21,-194.39 75261.5,-198.98 75280.48,-201.2 75285.39,-199.04 75304.5,-198.98 75510.03,-198.37 78801.18,-210.26 79004,-176.98 79019.93,-174.37 79036.6,-170.03 79052.36,-165.14"/>
<polygon fill="black" stroke="black" points="79053.58,-168.42 79062.03,-162.03 79051.44,-161.76 79053.58,-168.42"/>
<text text-anchor="middle" x="75283" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l10_dp0 -->
<g id="node249" class="node">
<title>expert2_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="78995.5,-161.98 78766.5,-161.98 78766.5,-109.98 78995.5,-109.98 78995.5,-161.98"/>
<text text-anchor="middle" x="78881" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L10</text>
<text text-anchor="middle" x="78881" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="78881" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="78881" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert2_l10_dp0 -->
<g id="edge412" class="edge">
<title>router_l10_dp0&#45;&gt;expert2_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75168.37,-177C75213.98,-186.1 75263.37,-194.39 75309.5,-198.98 75328.52,-200.87 75333.39,-199.04 75352.5,-198.98 75541.64,-198.37 78570.36,-207.66 78757,-176.98 78772.93,-174.36 78789.6,-170.03 78805.35,-165.14"/>
<polygon fill="black" stroke="black" points="78806.58,-168.42 78815.03,-162.03 78804.44,-161.75 78806.58,-168.42"/>
<text text-anchor="middle" x="75331" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l10_dp0 -->
<g id="node250" class="node">
<title>expert3_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="78748.5,-161.98 78519.5,-161.98 78519.5,-109.98 78748.5,-109.98 78748.5,-161.98"/>
<text text-anchor="middle" x="78634" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L10</text>
<text text-anchor="middle" x="78634" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="78634" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="78634" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert3_l10_dp0 -->
<g id="edge413" class="edge">
<title>router_l10_dp0&#45;&gt;expert3_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75224.85,-161.77C75288,-167.89 75356.58,-173.61 75420,-176.98 75928.08,-203.99 77200.75,-205.97 77709.5,-198.98 78065.38,-194.09 78159.42,-238.39 78510,-176.98 78525.63,-174.25 78541.98,-169.94 78557.49,-165.13"/>
<polygon fill="black" stroke="black" points="78558.56,-168.46 78567.02,-162.08 78556.43,-161.79 78558.56,-168.46"/>
<text text-anchor="middle" x="77688" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l10_dp0 -->
<g id="node251" class="node">
<title>expert4_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="78501.5,-161.98 78272.5,-161.98 78272.5,-109.98 78501.5,-109.98 78501.5,-161.98"/>
<text text-anchor="middle" x="78387" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L10</text>
<text text-anchor="middle" x="78387" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="78387" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="78387" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert4_l10_dp0 -->
<g id="edge414" class="edge">
<title>router_l10_dp0&#45;&gt;expert4_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75195.02,-177C75247.62,-186.1 75304.5,-194.4 75357.5,-198.98 75376.54,-200.63 75381.39,-199.06 75400.5,-198.98 75718.56,-197.76 77949.18,-228.76 78263,-176.98 78278.93,-174.35 78295.6,-170.01 78311.35,-165.12"/>
<polygon fill="black" stroke="black" points="78312.58,-168.4 78321.03,-162.01 78310.44,-161.74 78312.58,-168.4"/>
<text text-anchor="middle" x="75379" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l10_dp0 -->
<g id="node252" class="node">
<title>expert5_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="78254.5,-161.98 78025.5,-161.98 78025.5,-109.98 78254.5,-109.98 78254.5,-161.98"/>
<text text-anchor="middle" x="78140" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L10</text>
<text text-anchor="middle" x="78140" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="78140" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="78140" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert5_l10_dp0 -->
<g id="edge415" class="edge">
<title>router_l10_dp0&#45;&gt;expert5_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75221.65,-177.01C75281.23,-186.11 75345.61,-194.4 75405.5,-198.98 75424.55,-200.44 75429.39,-199.06 75448.5,-198.98 75733.78,-197.76 77734.54,-223.55 78016,-176.98 78031.93,-174.35 78048.59,-170 78064.35,-165.11"/>
<polygon fill="black" stroke="black" points="78065.58,-168.39 78074.03,-162 78063.44,-161.73 78065.58,-168.39"/>
<text text-anchor="middle" x="75427" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l10_dp0 -->
<g id="node253" class="node">
<title>expert6_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="78007.5,-161.98 77778.5,-161.98 77778.5,-109.98 78007.5,-109.98 78007.5,-161.98"/>
<text text-anchor="middle" x="77893" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L10</text>
<text text-anchor="middle" x="77893" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="77893" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="77893" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert6_l10_dp0 -->
<g id="edge416" class="edge">
<title>router_l10_dp0&#45;&gt;expert6_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75242.89,-176.28C75310.94,-185.66 75384.91,-194.28 75453.5,-198.98 75472.56,-200.29 75477.39,-199.08 75496.5,-198.98 75749.01,-197.76 77519.9,-218.34 77769,-176.98 77784.93,-174.34 77801.59,-169.99 77817.35,-165.1"/>
<polygon fill="black" stroke="black" points="77818.58,-168.38 77827.03,-161.99 77816.44,-161.71 77818.58,-168.38"/>
<text text-anchor="middle" x="75475" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l10_dp0 -->
<g id="node254" class="node">
<title>expert7_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="77760.5,-161.98 77531.5,-161.98 77531.5,-109.98 77760.5,-109.98 77760.5,-161.98"/>
<text text-anchor="middle" x="77646" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L10</text>
<text text-anchor="middle" x="77646" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="77646" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="77646" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert7_l10_dp0 -->
<g id="edge417" class="edge">
<title>router_l10_dp0&#45;&gt;expert7_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75224.59,-161.5C75287.81,-167.63 75356.5,-173.42 75420,-176.98 76063.28,-213.06 76225.29,-209.84 76869.5,-198.98 77159.62,-194.09 77236.34,-227.94 77522,-176.98 77537.62,-174.2 77553.96,-169.87 77569.47,-165.05"/>
<polygon fill="black" stroke="black" points="77570.55,-168.38 77579.01,-162 77568.41,-161.72 77570.55,-168.38"/>
<text text-anchor="middle" x="76848" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l10_dp0 -->
<g id="node255" class="node">
<title>expert8_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="77513.5,-161.98 77284.5,-161.98 77284.5,-109.98 77513.5,-109.98 77513.5,-161.98"/>
<text text-anchor="middle" x="77399" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L10</text>
<text text-anchor="middle" x="77399" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="77399" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="77399" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert8_l10_dp0 -->
<g id="edge418" class="edge">
<title>router_l10_dp0&#45;&gt;expert8_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75238.08,-172.34C75321.36,-183.2 75415.33,-193.63 75501.5,-198.98 75698.19,-211.19 77080.64,-209.55 77275,-176.98 77290.83,-174.33 77307.39,-170.01 77323.07,-165.14"/>
<polygon fill="black" stroke="black" points="77324.24,-168.44 77332.7,-162.05 77322.11,-161.78 77324.24,-168.44"/>
<text text-anchor="middle" x="75523" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l10_dp0 -->
<g id="node256" class="node">
<title>expert9_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="77266.5,-161.98 77037.5,-161.98 77037.5,-109.98 77266.5,-109.98 77266.5,-161.98"/>
<text text-anchor="middle" x="77152" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L10</text>
<text text-anchor="middle" x="77152" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="77152" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="77152" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert9_l10_dp0 -->
<g id="edge419" class="edge">
<title>router_l10_dp0&#45;&gt;expert9_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75233.88,-169.04C75331.47,-181.04 75445.7,-193.09 75549.5,-198.98 75713.53,-208.29 76866,-204.35 77028,-176.98 77043.83,-174.31 77060.39,-169.98 77076.06,-165.11"/>
<polygon fill="black" stroke="black" points="77077.24,-168.41 77085.69,-162.02 77075.1,-161.74 77077.24,-168.41"/>
<text text-anchor="middle" x="75571" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l10_dp0 -->
<g id="node257" class="node">
<title>expert10_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="77019.5,-161.98 76790.5,-161.98 76790.5,-109.98 77019.5,-109.98 77019.5,-161.98"/>
<text text-anchor="middle" x="76905" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L10</text>
<text text-anchor="middle" x="76905" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="76905" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="76905" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert10_l10_dp0 -->
<g id="edge420" class="edge">
<title>router_l10_dp0&#45;&gt;expert10_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75230.51,-166.28C75341.54,-179.16 75476.13,-192.64 75597.5,-198.98 75728.84,-205.84 76651.36,-199.14 76781,-176.98 76796.73,-174.29 76813.19,-169.98 76828.78,-165.15"/>
<polygon fill="black" stroke="black" points="76829.9,-168.46 76838.36,-162.08 76827.77,-161.79 76829.9,-168.46"/>
<text text-anchor="middle" x="75619" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l10_dp0 -->
<g id="node258" class="node">
<title>expert11_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="76772.5,-161.98 76543.5,-161.98 76543.5,-109.98 76772.5,-109.98 76772.5,-161.98"/>
<text text-anchor="middle" x="76658" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L10</text>
<text text-anchor="middle" x="76658" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="76658" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="76658" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert11_l10_dp0 -->
<g id="edge421" class="edge">
<title>router_l10_dp0&#45;&gt;expert11_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75223.53,-160.76C75287.05,-166.92 75356.16,-172.92 75420,-176.98 75756.57,-198.41 75841.41,-209.4 76178.5,-198.98 76336.73,-194.09 76378.56,-206.97 76534,-176.98 76549.07,-174.08 76564.83,-169.84 76579.88,-165.18"/>
<polygon fill="black" stroke="black" points="76581.18,-168.44 76589.64,-162.07 76579.05,-161.77 76581.18,-168.44"/>
<text text-anchor="middle" x="76157" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l10_dp0 -->
<g id="node259" class="node">
<title>expert12_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="76525.5,-161.98 76296.5,-161.98 76296.5,-109.98 76525.5,-109.98 76525.5,-161.98"/>
<text text-anchor="middle" x="76411" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L10</text>
<text text-anchor="middle" x="76411" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="76411" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="76411" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert12_l10_dp0 -->
<g id="edge422" class="edge">
<title>router_l10_dp0&#45;&gt;expert12_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75227.44,-163.92C75351.26,-177.47 75506.46,-192.26 75645.5,-198.98 75787.97,-205.88 76146.61,-202.24 76287,-176.98 76302.38,-174.22 76318.46,-169.97 76333.75,-165.24"/>
<polygon fill="black" stroke="black" points="76335.21,-168.44 76343.67,-162.07 76333.08,-161.78 76335.21,-168.44"/>
<text text-anchor="middle" x="75667" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l10_dp0 -->
<g id="node260" class="node">
<title>expert13_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="76278.5,-161.98 76049.5,-161.98 76049.5,-109.98 76278.5,-109.98 76278.5,-161.98"/>
<text text-anchor="middle" x="76164" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L10</text>
<text text-anchor="middle" x="76164" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="76164" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="76164" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert13_l10_dp0 -->
<g id="edge423" class="edge">
<title>router_l10_dp0&#45;&gt;expert13_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75236.38,-176.99C75449.6,-205.92 75768.44,-230.86 76040,-176.98 76054.96,-174.01 76070.62,-169.78 76085.58,-165.14"/>
<polygon fill="black" stroke="black" points="76086.83,-168.41 76095.29,-162.04 76084.7,-161.74 76086.83,-168.41"/>
<text text-anchor="middle" x="75715" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l10_dp0 -->
<g id="node261" class="node">
<title>expert14_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="76031.5,-161.98 75802.5,-161.98 75802.5,-109.98 76031.5,-109.98 76031.5,-161.98"/>
<text text-anchor="middle" x="75917" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L10</text>
<text text-anchor="middle" x="75917" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="75917" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="75917" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert14_l10_dp0 -->
<g id="edge424" class="edge">
<title>router_l10_dp0&#45;&gt;expert14_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75224.45,-161.26C75371.81,-176.09 75567.71,-193.04 75741.5,-198.98 75760.6,-199.64 75765.86,-203.19 75784.5,-198.98 75812.7,-192.62 75841.94,-179.52 75865.75,-166.9"/>
<polygon fill="black" stroke="black" points="75867.48,-169.94 75874.6,-162.1 75864.14,-163.79 75867.48,-169.94"/>
<text text-anchor="middle" x="75763" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l10_dp0 -->
<g id="node262" class="node">
<title>expert15_l10_dp0</title>
<polygon fill="lightgreen" stroke="black" points="75658.5,-161.98 75429.5,-161.98 75429.5,-109.98 75658.5,-109.98 75658.5,-161.98"/>
<text text-anchor="middle" x="75544" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L10</text>
<text text-anchor="middle" x="75544" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="75544" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="75544" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp0&#45;&gt;expert15_l10_dp0 -->
<g id="edge425" class="edge">
<title>router_l10_dp0&#45;&gt;expert15_l10_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M75193.06,-135.98C75268.51,-135.98 75352.43,-135.98 75419.28,-135.98"/>
<polygon fill="black" stroke="black" points="75419.44,-139.48 75429.44,-135.98 75419.44,-132.48 75419.44,-139.48"/>
<text text-anchor="middle" x="75336.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l10_dp0 -->
<g id="node263" class="node">
<title>expert_agg_l10_dp0</title>
<polygon fill="lightyellow" stroke="black" points="80020.57,-176.98 79626.74,-176.98 79525.43,-94.98 79919.26,-94.98 80020.57,-176.98"/>
<text text-anchor="middle" x="79773" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L10</text>
<text text-anchor="middle" x="79773" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="79773" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge426" class="edge">
<title>expert0_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M79489.66,-135.98C79515.06,-135.98 79540.47,-135.98 79565.87,-135.98"/>
<polygon fill="black" stroke="black" points="79565.99,-139.48 79575.99,-135.98 79565.99,-132.48 79565.99,-139.48"/>
</g>
<!-- expert1_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge427" class="edge">
<title>expert1_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M79183.24,-162.02C79206.4,-171.57 79233.96,-181.22 79260,-185.98 79310.06,-195.15 79438.3,-190.41 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert2_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge428" class="edge">
<title>expert2_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M78936.24,-162.02C78959.4,-171.57 78986.96,-181.22 79013,-185.98 79065.02,-195.51 79436.31,-190.59 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert3_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge429" class="edge">
<title>expert3_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M78689.24,-162.02C78712.4,-171.57 78739.96,-181.22 78766,-185.98 78845.02,-200.45 79408.97,-192.97 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert4_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge430" class="edge">
<title>expert4_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M78442.24,-162.02C78465.4,-171.57 78492.96,-181.22 78519,-185.98 78572.01,-195.69 79435.31,-190.67 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert5_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge431" class="edge">
<title>expert5_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M78195.24,-162.02C78218.4,-171.57 78245.96,-181.22 78272,-185.98 78338.5,-198.16 79421.64,-191.87 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert6_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge432" class="edge">
<title>expert6_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M77948.24,-162.02C77971.4,-171.57 77998.96,-181.22 78025,-185.98 78105,-200.63 79407.97,-193.06 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert7_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge433" class="edge">
<title>expert7_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M77701.24,-162.02C77724.4,-171.57 77751.96,-181.22 77778,-185.98 77824.75,-194.54 79441.65,-190.12 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert8_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge434" class="edge">
<title>expert8_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M77454.24,-162.02C77477.4,-171.57 77504.96,-181.22 77531,-185.98 77584.5,-195.78 79434.82,-190.72 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert9_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge435" class="edge">
<title>expert9_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M77207.24,-162.02C77230.4,-171.57 77257.96,-181.22 77284,-185.98 77344.25,-197.01 79427.98,-191.31 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert10_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge436" class="edge">
<title>expert10_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M76960.24,-162.02C76983.4,-171.57 77010.96,-181.22 77037,-185.98 77104,-198.25 79421.15,-191.91 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert11_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge437" class="edge">
<title>expert11_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M76713.24,-162.02C76736.4,-171.57 76763.96,-181.22 76790,-185.98 76863.75,-199.48 79414.31,-192.51 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert12_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge438" class="edge">
<title>expert12_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M76466.24,-162.02C76489.4,-171.57 76516.96,-181.22 76543,-185.98 76623.49,-200.72 79407.48,-193.1 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert13_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge439" class="edge">
<title>expert13_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M76219.24,-162.02C76242.4,-171.57 76269.96,-181.22 76296,-185.98 76339.62,-193.97 79444.82,-189.84 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert14_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge440" class="edge">
<title>expert14_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M75972.24,-162.02C75995.4,-171.57 76022.96,-181.22 76049,-185.98 76096,-194.59 79441.4,-190.14 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- expert15_l10_dp0&#45;&gt;expert_agg_l10_dp0 -->
<g id="edge441" class="edge">
<title>expert15_l10_dp0&#45;&gt;expert_agg_l10_dp0</title>
<path fill="none" stroke="black" d="M75653.49,-162.01C75699.12,-171.59 75752.84,-181.26 75802,-185.98 75903.95,-195.77 79386.97,-194.9 79489,-185.98 79527.11,-182.65 79567.78,-176.86 79606.08,-170.36"/>
<polygon fill="black" stroke="black" points="79607.02,-173.75 79616.29,-168.6 79605.84,-166.85 79607.02,-173.75"/>
</g>
<!-- layer10_output_dp0 -->
<g id="node264" class="node">
<title>layer10_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="80225" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="80225" y="-144.48" font-family="Arial" font-size="10.00">Layer 10 Output</text>
<text text-anchor="middle" x="80225" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="80225" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l10_dp0&#45;&gt;layer10_output_dp0 -->
<g id="edge442" class="edge">
<title>expert_agg_l10_dp0&#45;&gt;layer10_output_dp0</title>
<path fill="none" stroke="black" d="M79970.31,-135.98C79995.49,-135.98 80020.66,-135.98 80045.84,-135.98"/>
<polygon fill="black" stroke="black" points="80045.87,-139.48 80055.87,-135.98 80045.87,-132.48 80045.87,-139.48"/>
</g>
<!-- attn_input_l11_dp0 -->
<g id="node265" class="node">
<title>attn_input_l11_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="80598" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="80598" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L11</text>
<text text-anchor="middle" x="80598" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="80598" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer10_output_dp0&#45;&gt;attn_input_l11_dp0 -->
<g id="edge443" class="edge">
<title>layer10_output_dp0&#45;&gt;attn_input_l11_dp0</title>
<path fill="none" stroke="black" d="M80394.01,-135.98C80402.23,-135.98 80410.44,-135.98 80418.66,-135.98"/>
<polygon fill="black" stroke="black" points="80418.68,-139.48 80428.68,-135.98 80418.68,-132.48 80418.68,-139.48"/>
</g>
<!-- attn_tp0_l11_dp0 -->
<g id="node266" class="node">
<title>attn_tp0_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="81896,-161.98 81636,-161.98 81636,-109.98 81896,-109.98 81896,-161.98"/>
<text text-anchor="middle" x="81766" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L11</text>
<text text-anchor="middle" x="81766" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="81766" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="81766" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp0&#45;&gt;attn_tp0_l11_dp0 -->
<g id="edge444" class="edge">
<title>attn_input_l11_dp0&#45;&gt;attn_tp0_l11_dp0</title>
<path fill="none" stroke="black" d="M80681.52,-161.26C80718.12,-171.09 80761.81,-181.13 80802,-185.98 80847,-191.42 81573.27,-193.33 81618,-185.98 81643.4,-181.81 81670.31,-173.85 81694.12,-165.5"/>
<polygon fill="black" stroke="black" points="81695.55,-168.71 81703.78,-162.03 81693.18,-162.12 81695.55,-168.71"/>
</g>
<!-- attn_tp1_l11_dp0 -->
<g id="node267" class="node">
<title>attn_tp1_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="81618,-161.98 81358,-161.98 81358,-109.98 81618,-109.98 81618,-161.98"/>
<text text-anchor="middle" x="81488" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L11</text>
<text text-anchor="middle" x="81488" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="81488" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="81488" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp0&#45;&gt;attn_tp1_l11_dp0 -->
<g id="edge445" class="edge">
<title>attn_input_l11_dp0&#45;&gt;attn_tp1_l11_dp0</title>
<path fill="none" stroke="black" d="M80681.52,-161.26C80718.12,-171.09 80761.81,-181.13 80802,-185.98 80861.35,-193.15 81281.01,-195.68 81340,-185.98 81365.4,-181.81 81392.31,-173.85 81416.12,-165.5"/>
<polygon fill="black" stroke="black" points="81417.55,-168.71 81425.78,-162.03 81415.18,-162.12 81417.55,-168.71"/>
</g>
<!-- attn_tp2_l11_dp0 -->
<g id="node268" class="node">
<title>attn_tp2_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="81340,-161.98 81080,-161.98 81080,-109.98 81340,-109.98 81340,-161.98"/>
<text text-anchor="middle" x="81210" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L11</text>
<text text-anchor="middle" x="81210" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="81210" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="81210" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp0&#45;&gt;attn_tp2_l11_dp0 -->
<g id="edge446" class="edge">
<title>attn_input_l11_dp0&#45;&gt;attn_tp2_l11_dp0</title>
<path fill="none" stroke="black" d="M80681.52,-161.26C80718.12,-171.09 80761.81,-181.13 80802,-185.98 80859.36,-192.91 81004.99,-195.35 81062,-185.98 81087.4,-181.81 81114.31,-173.85 81138.12,-165.5"/>
<polygon fill="black" stroke="black" points="81139.55,-168.71 81147.78,-162.03 81137.18,-162.12 81139.55,-168.71"/>
</g>
<!-- attn_tp3_l11_dp0 -->
<g id="node269" class="node">
<title>attn_tp3_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="81062,-161.98 80802,-161.98 80802,-109.98 81062,-109.98 81062,-161.98"/>
<text text-anchor="middle" x="80932" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L11</text>
<text text-anchor="middle" x="80932" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="80932" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="80932" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp0&#45;&gt;attn_tp3_l11_dp0 -->
<g id="edge447" class="edge">
<title>attn_input_l11_dp0&#45;&gt;attn_tp3_l11_dp0</title>
<path fill="none" stroke="black" d="M80767.28,-135.98C80775.35,-135.98 80783.42,-135.98 80791.49,-135.98"/>
<polygon fill="black" stroke="black" points="80791.7,-139.48 80801.7,-135.98 80791.7,-132.48 80791.7,-139.48"/>
</g>
<!-- allreduce_l11_dp0 -->
<g id="node270" class="node">
<title>allreduce_l11_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="82100" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="82100" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L11</text>
<text text-anchor="middle" x="82100" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="82100" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l11_dp0&#45;&gt;allreduce_l11_dp0 -->
<g id="edge448" class="edge">
<title>attn_tp0_l11_dp0&#45;&gt;allreduce_l11_dp0</title>
<path fill="none" stroke="black" d="M81896.14,-135.98C81904.35,-135.98 81912.56,-135.98 81920.77,-135.98"/>
<polygon fill="black" stroke="black" points="81920.78,-139.48 81930.78,-135.98 81920.78,-132.48 81920.78,-139.48"/>
</g>
<!-- attn_tp1_l11_dp0&#45;&gt;allreduce_l11_dp0 -->
<g id="edge449" class="edge">
<title>attn_tp1_l11_dp0&#45;&gt;allreduce_l11_dp0</title>
<path fill="none" stroke="black" d="M81550.22,-162.03C81576.24,-171.59 81607.1,-181.23 81636,-185.98 81693.01,-195.35 81838.64,-192.91 81896,-185.98 81932.57,-181.57 81972.05,-172.85 82006.44,-163.91"/>
<polygon fill="black" stroke="black" points="82007.7,-167.2 82016.47,-161.26 82005.91,-160.43 82007.7,-167.2"/>
</g>
<!-- attn_tp2_l11_dp0&#45;&gt;allreduce_l11_dp0 -->
<g id="edge450" class="edge">
<title>attn_tp2_l11_dp0&#45;&gt;allreduce_l11_dp0</title>
<path fill="none" stroke="black" d="M81272.22,-162.03C81298.24,-171.59 81329.1,-181.23 81358,-185.98 81416.98,-195.68 81836.65,-193.15 81896,-185.98 81932.57,-181.57 81972.05,-172.85 82006.44,-163.91"/>
<polygon fill="black" stroke="black" points="82007.7,-167.2 82016.47,-161.26 82005.91,-160.43 82007.7,-167.2"/>
</g>
<!-- attn_tp3_l11_dp0&#45;&gt;allreduce_l11_dp0 -->
<g id="edge451" class="edge">
<title>attn_tp3_l11_dp0&#45;&gt;allreduce_l11_dp0</title>
<path fill="none" stroke="black" d="M80994.22,-162.03C81020.24,-171.59 81051.1,-181.23 81080,-185.98 81124.73,-193.33 81850.99,-191.42 81896,-185.98 81932.57,-181.57 81972.05,-172.85 82006.44,-163.91"/>
<polygon fill="black" stroke="black" points="82007.7,-167.2 82016.47,-161.26 82005.91,-160.43 82007.7,-167.2"/>
</g>
<!-- moe_input_l11_dp0 -->
<g id="node271" class="node">
<title>moe_input_l11_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="82473" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="82473" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L11</text>
<text text-anchor="middle" x="82473" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="82473" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l11_dp0&#45;&gt;moe_input_l11_dp0 -->
<g id="edge452" class="edge">
<title>allreduce_l11_dp0&#45;&gt;moe_input_l11_dp0</title>
<path fill="none" stroke="black" d="M82269.01,-135.98C82277.23,-135.98 82285.44,-135.98 82293.66,-135.98"/>
<polygon fill="black" stroke="black" points="82293.68,-139.48 82303.68,-135.98 82293.68,-132.48 82293.68,-139.48"/>
</g>
<!-- router_l11_dp0 -->
<g id="node272" class="node">
<title>router_l11_dp0</title>
<polygon fill="lightyellow" stroke="black" points="83172.57,-176.98 82778.74,-176.98 82677.43,-94.98 83071.26,-94.98 83172.57,-176.98"/>
<text text-anchor="middle" x="82925" y="-144.48" font-family="Arial" font-size="10.00">Router L11</text>
<text text-anchor="middle" x="82925" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="82925" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l11_dp0&#45;&gt;router_l11_dp0 -->
<g id="edge453" class="edge">
<title>moe_input_l11_dp0&#45;&gt;router_l11_dp0</title>
<path fill="none" stroke="black" d="M82642.06,-135.98C82667.34,-135.98 82692.63,-135.98 82717.92,-135.98"/>
<polygon fill="black" stroke="black" points="82717.99,-139.48 82727.99,-135.98 82717.99,-132.48 82717.99,-139.48"/>
</g>
<!-- expert0_l11_dp0 -->
<g id="node273" class="node">
<title>expert0_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="87418.5,-161.98 87189.5,-161.98 87189.5,-109.98 87418.5,-109.98 87418.5,-161.98"/>
<text text-anchor="middle" x="87304" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L11</text>
<text text-anchor="middle" x="87304" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="87304" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="87304" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert0_l11_dp0 -->
<g id="edge454" class="edge">
<title>router_l11_dp0&#45;&gt;expert0_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83154.12,-161.89C83217.19,-168 83285.67,-173.69 83349,-176.98 84008.46,-211.28 85660.2,-207.43 86320.5,-198.98 86511.55,-196.54 86991.77,-209.77 87180,-176.98 87195.72,-174.24 87212.17,-169.91 87227.76,-165.07"/>
<polygon fill="black" stroke="black" points="87228.89,-168.38 87237.35,-162 87226.76,-161.72 87228.89,-168.38"/>
<text text-anchor="middle" x="86299" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l11_dp0 -->
<g id="node274" class="node">
<title>expert1_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="87171.5,-161.98 86942.5,-161.98 86942.5,-109.98 87171.5,-109.98 87171.5,-161.98"/>
<text text-anchor="middle" x="87057" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L11</text>
<text text-anchor="middle" x="87057" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="87057" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="87057" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert1_l11_dp0 -->
<g id="edge455" class="edge">
<title>router_l11_dp0&#45;&gt;expert1_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83070.67,-176.99C83109.3,-186.08 83151.21,-194.39 83190.5,-198.98 83209.48,-201.2 83214.39,-199.04 83233.5,-198.98 83439.03,-198.37 86730.18,-210.26 86933,-176.98 86948.93,-174.37 86965.6,-170.03 86981.36,-165.14"/>
<polygon fill="black" stroke="black" points="86982.58,-168.42 86991.03,-162.03 86980.44,-161.76 86982.58,-168.42"/>
<text text-anchor="middle" x="83212" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l11_dp0 -->
<g id="node275" class="node">
<title>expert2_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="86924.5,-161.98 86695.5,-161.98 86695.5,-109.98 86924.5,-109.98 86924.5,-161.98"/>
<text text-anchor="middle" x="86810" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L11</text>
<text text-anchor="middle" x="86810" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="86810" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="86810" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert2_l11_dp0 -->
<g id="edge456" class="edge">
<title>router_l11_dp0&#45;&gt;expert2_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83097.37,-177C83142.98,-186.1 83192.37,-194.39 83238.5,-198.98 83257.52,-200.87 83262.39,-199.04 83281.5,-198.98 83470.64,-198.37 86499.36,-207.66 86686,-176.98 86701.93,-174.36 86718.6,-170.03 86734.35,-165.14"/>
<polygon fill="black" stroke="black" points="86735.58,-168.42 86744.03,-162.03 86733.44,-161.75 86735.58,-168.42"/>
<text text-anchor="middle" x="83260" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l11_dp0 -->
<g id="node276" class="node">
<title>expert3_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="86677.5,-161.98 86448.5,-161.98 86448.5,-109.98 86677.5,-109.98 86677.5,-161.98"/>
<text text-anchor="middle" x="86563" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L11</text>
<text text-anchor="middle" x="86563" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="86563" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="86563" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert3_l11_dp0 -->
<g id="edge457" class="edge">
<title>router_l11_dp0&#45;&gt;expert3_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83124.02,-177C83176.62,-186.1 83233.5,-194.4 83286.5,-198.98 83305.54,-200.63 83310.39,-199.05 83329.5,-198.98 83675.01,-197.76 86098.08,-233.12 86439,-176.98 86454.93,-174.36 86471.6,-170.02 86487.35,-165.13"/>
<polygon fill="black" stroke="black" points="86488.58,-168.41 86497.03,-162.02 86486.44,-161.75 86488.58,-168.41"/>
<text text-anchor="middle" x="83308" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l11_dp0 -->
<g id="node277" class="node">
<title>expert4_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="86430.5,-161.98 86201.5,-161.98 86201.5,-109.98 86430.5,-109.98 86430.5,-161.98"/>
<text text-anchor="middle" x="86316" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L11</text>
<text text-anchor="middle" x="86316" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="86316" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="86316" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert4_l11_dp0 -->
<g id="edge458" class="edge">
<title>router_l11_dp0&#45;&gt;expert4_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83153.85,-161.73C83217,-167.85 83285.58,-173.58 83349,-176.98 83809.14,-201.68 84961.74,-205.57 85422.5,-198.98 85764.6,-194.09 85855.02,-236.2 86192,-176.98 86207.63,-174.24 86223.97,-169.93 86239.48,-165.12"/>
<polygon fill="black" stroke="black" points="86240.56,-168.45 86249.02,-162.07 86238.43,-161.78 86240.56,-168.45"/>
<text text-anchor="middle" x="85401" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l11_dp0 -->
<g id="node278" class="node">
<title>expert5_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="86183.5,-161.98 85954.5,-161.98 85954.5,-109.98 86183.5,-109.98 86183.5,-161.98"/>
<text text-anchor="middle" x="86069" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L11</text>
<text text-anchor="middle" x="86069" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="86069" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="86069" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert5_l11_dp0 -->
<g id="edge459" class="edge">
<title>router_l11_dp0&#45;&gt;expert5_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83150.65,-177.01C83210.23,-186.11 83274.61,-194.4 83334.5,-198.98 83353.55,-200.44 83358.39,-199.06 83377.5,-198.98 83662.78,-197.76 85663.54,-223.55 85945,-176.98 85960.93,-174.35 85977.59,-170 85993.35,-165.11"/>
<polygon fill="black" stroke="black" points="85994.58,-168.39 86003.03,-162 85992.44,-161.73 85994.58,-168.39"/>
<text text-anchor="middle" x="83356" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l11_dp0 -->
<g id="node279" class="node">
<title>expert6_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="85936.5,-161.98 85707.5,-161.98 85707.5,-109.98 85936.5,-109.98 85936.5,-161.98"/>
<text text-anchor="middle" x="85822" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L11</text>
<text text-anchor="middle" x="85822" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="85822" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="85822" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert6_l11_dp0 -->
<g id="edge460" class="edge">
<title>router_l11_dp0&#45;&gt;expert6_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83171.89,-176.28C83239.94,-185.66 83313.91,-194.28 83382.5,-198.98 83401.56,-200.29 83406.39,-199.08 83425.5,-198.98 83678.01,-197.76 85448.9,-218.34 85698,-176.98 85713.93,-174.34 85730.59,-169.99 85746.35,-165.1"/>
<polygon fill="black" stroke="black" points="85747.58,-168.38 85756.03,-161.99 85745.44,-161.71 85747.58,-168.38"/>
<text text-anchor="middle" x="83404" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l11_dp0 -->
<g id="node280" class="node">
<title>expert7_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="85689.5,-161.98 85460.5,-161.98 85460.5,-109.98 85689.5,-109.98 85689.5,-161.98"/>
<text text-anchor="middle" x="85575" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L11</text>
<text text-anchor="middle" x="85575" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="85575" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="85575" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert7_l11_dp0 -->
<g id="edge461" class="edge">
<title>router_l11_dp0&#45;&gt;expert7_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83167.08,-172.34C83250.36,-183.2 83344.33,-193.63 83430.5,-198.98 83449.57,-200.17 83454.39,-199.09 83473.5,-198.98 83693.23,-197.76 85234.26,-213.12 85451,-176.98 85466.83,-174.34 85483.4,-170.03 85499.07,-165.16"/>
<polygon fill="black" stroke="black" points="85500.25,-168.46 85508.7,-162.07 85498.11,-161.8 85500.25,-168.46"/>
<text text-anchor="middle" x="83452" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l11_dp0 -->
<g id="node281" class="node">
<title>expert8_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="85442.5,-161.98 85213.5,-161.98 85213.5,-109.98 85442.5,-109.98 85442.5,-161.98"/>
<text text-anchor="middle" x="85328" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L11</text>
<text text-anchor="middle" x="85328" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="85328" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="85328" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert8_l11_dp0 -->
<g id="edge462" class="edge">
<title>router_l11_dp0&#45;&gt;expert8_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83153.32,-161.37C83216.62,-167.51 83285.41,-173.34 83349,-176.98 83910.16,-209.12 84051.51,-209.45 84613.5,-198.98 84876.08,-194.09 84945.53,-223.56 85204,-176.98 85219.37,-174.21 85235.46,-169.96 85250.75,-165.23"/>
<polygon fill="black" stroke="black" points="85252.21,-168.44 85260.67,-162.06 85250.08,-161.77 85252.21,-168.44"/>
<text text-anchor="middle" x="84592" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l11_dp0 -->
<g id="node282" class="node">
<title>expert9_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="85195.5,-161.98 84966.5,-161.98 84966.5,-109.98 85195.5,-109.98 85195.5,-161.98"/>
<text text-anchor="middle" x="85081" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L11</text>
<text text-anchor="middle" x="85081" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="85081" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="85081" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert9_l11_dp0 -->
<g id="edge463" class="edge">
<title>router_l11_dp0&#45;&gt;expert9_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83162.88,-169.04C83260.47,-181.04 83374.7,-193.09 83478.5,-198.98 83642.53,-208.29 84795,-204.35 84957,-176.98 84972.83,-174.31 84989.39,-169.98 85005.06,-165.11"/>
<polygon fill="black" stroke="black" points="85006.24,-168.41 85014.69,-162.02 85004.1,-161.74 85006.24,-168.41"/>
<text text-anchor="middle" x="83500" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l11_dp0 -->
<g id="node283" class="node">
<title>expert10_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="84948.5,-161.98 84719.5,-161.98 84719.5,-109.98 84948.5,-109.98 84948.5,-161.98"/>
<text text-anchor="middle" x="84834" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L11</text>
<text text-anchor="middle" x="84834" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="84834" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="84834" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert10_l11_dp0 -->
<g id="edge464" class="edge">
<title>router_l11_dp0&#45;&gt;expert10_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83159.51,-166.28C83270.54,-179.16 83405.13,-192.64 83526.5,-198.98 83657.84,-205.84 84580.36,-199.14 84710,-176.98 84725.73,-174.29 84742.19,-169.98 84757.78,-165.15"/>
<polygon fill="black" stroke="black" points="84758.9,-168.46 84767.36,-162.08 84756.77,-161.79 84758.9,-168.46"/>
<text text-anchor="middle" x="83548" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l11_dp0 -->
<g id="node284" class="node">
<title>expert11_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="84701.5,-161.98 84472.5,-161.98 84472.5,-109.98 84701.5,-109.98 84701.5,-161.98"/>
<text text-anchor="middle" x="84587" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L11</text>
<text text-anchor="middle" x="84587" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="84587" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="84587" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert11_l11_dp0 -->
<g id="edge465" class="edge">
<title>router_l11_dp0&#45;&gt;expert11_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83156.44,-163.92C83280.26,-177.47 83435.46,-192.26 83574.5,-198.98 83771.77,-208.53 84268.43,-210.92 84463,-176.98 84478.72,-174.24 84495.17,-169.91 84510.76,-165.06"/>
<polygon fill="black" stroke="black" points="84511.89,-168.38 84520.35,-161.99 84509.75,-161.71 84511.89,-168.38"/>
<text text-anchor="middle" x="83596" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l11_dp0 -->
<g id="node285" class="node">
<title>expert12_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="84454.5,-161.98 84225.5,-161.98 84225.5,-109.98 84454.5,-109.98 84454.5,-161.98"/>
<text text-anchor="middle" x="84340" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L11</text>
<text text-anchor="middle" x="84340" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="84340" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="84340" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert12_l11_dp0 -->
<g id="edge466" class="edge">
<title>router_l11_dp0&#45;&gt;expert12_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83156.66,-164.01C83371.25,-186.58 83699.32,-212.5 83984.5,-198.98 84087.74,-194.09 84114.85,-198.23 84216,-176.98 84230.65,-173.9 84246,-169.69 84260.7,-165.12"/>
<polygon fill="black" stroke="black" points="84261.79,-168.45 84270.26,-162.08 84259.67,-161.78 84261.79,-168.45"/>
<text text-anchor="middle" x="83963" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l11_dp0 -->
<g id="node286" class="node">
<title>expert13_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="84207.5,-161.98 83978.5,-161.98 83978.5,-109.98 84207.5,-109.98 84207.5,-161.98"/>
<text text-anchor="middle" x="84093" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L11</text>
<text text-anchor="middle" x="84093" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="84093" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="84093" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert13_l11_dp0 -->
<g id="edge467" class="edge">
<title>router_l11_dp0&#45;&gt;expert13_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83165.38,-176.99C83378.6,-205.92 83697.44,-230.86 83969,-176.98 83983.96,-174.01 83999.62,-169.78 84014.58,-165.14"/>
<polygon fill="black" stroke="black" points="84015.83,-168.41 84024.29,-162.04 84013.7,-161.74 84015.83,-168.41"/>
<text text-anchor="middle" x="83644" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l11_dp0 -->
<g id="node287" class="node">
<title>expert14_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="83960.5,-161.98 83731.5,-161.98 83731.5,-109.98 83960.5,-109.98 83960.5,-161.98"/>
<text text-anchor="middle" x="83846" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L11</text>
<text text-anchor="middle" x="83846" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="83846" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="83846" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert14_l11_dp0 -->
<g id="edge468" class="edge">
<title>router_l11_dp0&#45;&gt;expert14_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83153.45,-161.26C83300.81,-176.09 83496.71,-193.04 83670.5,-198.98 83689.6,-199.64 83694.86,-203.19 83713.5,-198.98 83741.7,-192.62 83770.94,-179.52 83794.75,-166.9"/>
<polygon fill="black" stroke="black" points="83796.48,-169.94 83803.6,-162.1 83793.14,-163.79 83796.48,-169.94"/>
<text text-anchor="middle" x="83692" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l11_dp0 -->
<g id="node288" class="node">
<title>expert15_l11_dp0</title>
<polygon fill="lightgreen" stroke="black" points="83587.5,-161.98 83358.5,-161.98 83358.5,-109.98 83587.5,-109.98 83587.5,-161.98"/>
<text text-anchor="middle" x="83473" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L11</text>
<text text-anchor="middle" x="83473" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="83473" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="83473" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp0&#45;&gt;expert15_l11_dp0 -->
<g id="edge469" class="edge">
<title>router_l11_dp0&#45;&gt;expert15_l11_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83122.06,-135.98C83197.51,-135.98 83281.43,-135.98 83348.28,-135.98"/>
<polygon fill="black" stroke="black" points="83348.44,-139.48 83358.44,-135.98 83348.44,-132.48 83348.44,-139.48"/>
<text text-anchor="middle" x="83265.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l11_dp0 -->
<g id="node289" class="node">
<title>expert_agg_l11_dp0</title>
<polygon fill="lightyellow" stroke="black" points="87949.57,-176.98 87555.74,-176.98 87454.43,-94.98 87848.26,-94.98 87949.57,-176.98"/>
<text text-anchor="middle" x="87702" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L11</text>
<text text-anchor="middle" x="87702" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="87702" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge470" class="edge">
<title>expert0_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M87418.66,-135.98C87444.06,-135.98 87469.47,-135.98 87494.87,-135.98"/>
<polygon fill="black" stroke="black" points="87494.99,-139.48 87504.99,-135.98 87494.99,-132.48 87494.99,-139.48"/>
</g>
<!-- expert1_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge471" class="edge">
<title>expert1_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M87112.24,-162.02C87135.4,-171.57 87162.96,-181.22 87189,-185.98 87239.06,-195.15 87367.3,-190.41 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert2_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge472" class="edge">
<title>expert2_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M86865.24,-162.02C86888.4,-171.57 86915.96,-181.22 86942,-185.98 86994.02,-195.51 87365.31,-190.59 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert3_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge473" class="edge">
<title>expert3_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M86618.24,-162.02C86641.4,-171.57 86668.96,-181.22 86695,-185.98 86774.02,-200.45 87337.97,-192.97 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert4_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge474" class="edge">
<title>expert4_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M86371.24,-162.02C86394.4,-171.57 86421.96,-181.22 86448,-185.98 86501.01,-195.69 87364.31,-190.67 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert5_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge475" class="edge">
<title>expert5_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M86124.24,-162.02C86147.4,-171.57 86174.96,-181.22 86201,-185.98 86267.5,-198.16 87350.64,-191.87 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert6_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge476" class="edge">
<title>expert6_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M85877.24,-162.02C85900.4,-171.57 85927.96,-181.22 85954,-185.98 86034,-200.63 87336.97,-193.06 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert7_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge477" class="edge">
<title>expert7_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M85630.24,-162.02C85653.4,-171.57 85680.96,-181.22 85707,-185.98 85753.75,-194.54 87370.65,-190.12 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert8_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge478" class="edge">
<title>expert8_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M85383.24,-162.02C85406.4,-171.57 85433.96,-181.22 85460,-185.98 85513.5,-195.78 87363.82,-190.72 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert9_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge479" class="edge">
<title>expert9_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M85136.24,-162.02C85159.4,-171.57 85186.96,-181.22 85213,-185.98 85273.25,-197.01 87356.98,-191.31 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert10_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge480" class="edge">
<title>expert10_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M84889.24,-162.02C84912.4,-171.57 84939.96,-181.22 84966,-185.98 85033,-198.25 87350.15,-191.91 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert11_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge481" class="edge">
<title>expert11_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M84642.24,-162.02C84665.4,-171.57 84692.96,-181.22 84719,-185.98 84792.75,-199.48 87343.31,-192.51 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert12_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge482" class="edge">
<title>expert12_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M84395.24,-162.02C84418.4,-171.57 84445.96,-181.22 84472,-185.98 84552.49,-200.72 87336.48,-193.1 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert13_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge483" class="edge">
<title>expert13_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M84148.24,-162.02C84171.4,-171.57 84198.96,-181.22 84225,-185.98 84268.62,-193.97 87373.82,-189.84 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert14_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge484" class="edge">
<title>expert14_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M83901.24,-162.02C83924.4,-171.57 83951.96,-181.22 83978,-185.98 84025,-194.59 87370.4,-190.14 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- expert15_l11_dp0&#45;&gt;expert_agg_l11_dp0 -->
<g id="edge485" class="edge">
<title>expert15_l11_dp0&#45;&gt;expert_agg_l11_dp0</title>
<path fill="none" stroke="black" d="M83582.49,-162.01C83628.12,-171.59 83681.84,-181.26 83731,-185.98 83832.95,-195.77 87315.97,-194.9 87418,-185.98 87456.11,-182.65 87496.78,-176.86 87535.08,-170.36"/>
<polygon fill="black" stroke="black" points="87536.02,-173.75 87545.29,-168.6 87534.84,-166.85 87536.02,-173.75"/>
</g>
<!-- layer11_output_dp0 -->
<g id="node290" class="node">
<title>layer11_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="88154" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="88154" y="-144.48" font-family="Arial" font-size="10.00">Layer 11 Output</text>
<text text-anchor="middle" x="88154" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="88154" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l11_dp0&#45;&gt;layer11_output_dp0 -->
<g id="edge486" class="edge">
<title>expert_agg_l11_dp0&#45;&gt;layer11_output_dp0</title>
<path fill="none" stroke="black" d="M87899.31,-135.98C87924.49,-135.98 87949.66,-135.98 87974.84,-135.98"/>
<polygon fill="black" stroke="black" points="87974.87,-139.48 87984.87,-135.98 87974.87,-132.48 87974.87,-139.48"/>
</g>
<!-- attn_input_l12_dp0 -->
<g id="node291" class="node">
<title>attn_input_l12_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="88527" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="88527" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L12</text>
<text text-anchor="middle" x="88527" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="88527" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer11_output_dp0&#45;&gt;attn_input_l12_dp0 -->
<g id="edge487" class="edge">
<title>layer11_output_dp0&#45;&gt;attn_input_l12_dp0</title>
<path fill="none" stroke="black" d="M88323.01,-135.98C88331.23,-135.98 88339.44,-135.98 88347.66,-135.98"/>
<polygon fill="black" stroke="black" points="88347.68,-139.48 88357.68,-135.98 88347.68,-132.48 88347.68,-139.48"/>
</g>
<!-- attn_tp0_l12_dp0 -->
<g id="node292" class="node">
<title>attn_tp0_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="89825,-161.98 89565,-161.98 89565,-109.98 89825,-109.98 89825,-161.98"/>
<text text-anchor="middle" x="89695" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L12</text>
<text text-anchor="middle" x="89695" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="89695" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="89695" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp0&#45;&gt;attn_tp0_l12_dp0 -->
<g id="edge488" class="edge">
<title>attn_input_l12_dp0&#45;&gt;attn_tp0_l12_dp0</title>
<path fill="none" stroke="black" d="M88610.52,-161.26C88647.12,-171.09 88690.81,-181.13 88731,-185.98 88776,-191.42 89502.27,-193.33 89547,-185.98 89572.4,-181.81 89599.31,-173.85 89623.12,-165.5"/>
<polygon fill="black" stroke="black" points="89624.55,-168.71 89632.78,-162.03 89622.18,-162.12 89624.55,-168.71"/>
</g>
<!-- attn_tp1_l12_dp0 -->
<g id="node293" class="node">
<title>attn_tp1_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="89547,-161.98 89287,-161.98 89287,-109.98 89547,-109.98 89547,-161.98"/>
<text text-anchor="middle" x="89417" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L12</text>
<text text-anchor="middle" x="89417" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="89417" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="89417" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp0&#45;&gt;attn_tp1_l12_dp0 -->
<g id="edge489" class="edge">
<title>attn_input_l12_dp0&#45;&gt;attn_tp1_l12_dp0</title>
<path fill="none" stroke="black" d="M88610.52,-161.26C88647.12,-171.09 88690.81,-181.13 88731,-185.98 88790.35,-193.15 89210.01,-195.68 89269,-185.98 89294.4,-181.81 89321.31,-173.85 89345.12,-165.5"/>
<polygon fill="black" stroke="black" points="89346.55,-168.71 89354.78,-162.03 89344.18,-162.12 89346.55,-168.71"/>
</g>
<!-- attn_tp2_l12_dp0 -->
<g id="node294" class="node">
<title>attn_tp2_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="89269,-161.98 89009,-161.98 89009,-109.98 89269,-109.98 89269,-161.98"/>
<text text-anchor="middle" x="89139" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L12</text>
<text text-anchor="middle" x="89139" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="89139" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="89139" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp0&#45;&gt;attn_tp2_l12_dp0 -->
<g id="edge490" class="edge">
<title>attn_input_l12_dp0&#45;&gt;attn_tp2_l12_dp0</title>
<path fill="none" stroke="black" d="M88610.52,-161.26C88647.12,-171.09 88690.81,-181.13 88731,-185.98 88788.36,-192.91 88933.99,-195.35 88991,-185.98 89016.4,-181.81 89043.31,-173.85 89067.12,-165.5"/>
<polygon fill="black" stroke="black" points="89068.55,-168.71 89076.78,-162.03 89066.18,-162.12 89068.55,-168.71"/>
</g>
<!-- attn_tp3_l12_dp0 -->
<g id="node295" class="node">
<title>attn_tp3_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="88991,-161.98 88731,-161.98 88731,-109.98 88991,-109.98 88991,-161.98"/>
<text text-anchor="middle" x="88861" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L12</text>
<text text-anchor="middle" x="88861" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="88861" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="88861" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp0&#45;&gt;attn_tp3_l12_dp0 -->
<g id="edge491" class="edge">
<title>attn_input_l12_dp0&#45;&gt;attn_tp3_l12_dp0</title>
<path fill="none" stroke="black" d="M88696.28,-135.98C88704.35,-135.98 88712.42,-135.98 88720.49,-135.98"/>
<polygon fill="black" stroke="black" points="88720.7,-139.48 88730.7,-135.98 88720.7,-132.48 88720.7,-139.48"/>
</g>
<!-- allreduce_l12_dp0 -->
<g id="node296" class="node">
<title>allreduce_l12_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="90029" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="90029" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L12</text>
<text text-anchor="middle" x="90029" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="90029" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l12_dp0&#45;&gt;allreduce_l12_dp0 -->
<g id="edge492" class="edge">
<title>attn_tp0_l12_dp0&#45;&gt;allreduce_l12_dp0</title>
<path fill="none" stroke="black" d="M89825.14,-135.98C89833.35,-135.98 89841.56,-135.98 89849.77,-135.98"/>
<polygon fill="black" stroke="black" points="89849.78,-139.48 89859.78,-135.98 89849.78,-132.48 89849.78,-139.48"/>
</g>
<!-- attn_tp1_l12_dp0&#45;&gt;allreduce_l12_dp0 -->
<g id="edge493" class="edge">
<title>attn_tp1_l12_dp0&#45;&gt;allreduce_l12_dp0</title>
<path fill="none" stroke="black" d="M89479.22,-162.03C89505.24,-171.59 89536.1,-181.23 89565,-185.98 89622.01,-195.35 89767.64,-192.91 89825,-185.98 89861.57,-181.57 89901.05,-172.85 89935.44,-163.91"/>
<polygon fill="black" stroke="black" points="89936.7,-167.2 89945.47,-161.26 89934.91,-160.43 89936.7,-167.2"/>
</g>
<!-- attn_tp2_l12_dp0&#45;&gt;allreduce_l12_dp0 -->
<g id="edge494" class="edge">
<title>attn_tp2_l12_dp0&#45;&gt;allreduce_l12_dp0</title>
<path fill="none" stroke="black" d="M89201.22,-162.03C89227.24,-171.59 89258.1,-181.23 89287,-185.98 89345.98,-195.68 89765.65,-193.15 89825,-185.98 89861.57,-181.57 89901.05,-172.85 89935.44,-163.91"/>
<polygon fill="black" stroke="black" points="89936.7,-167.2 89945.47,-161.26 89934.91,-160.43 89936.7,-167.2"/>
</g>
<!-- attn_tp3_l12_dp0&#45;&gt;allreduce_l12_dp0 -->
<g id="edge495" class="edge">
<title>attn_tp3_l12_dp0&#45;&gt;allreduce_l12_dp0</title>
<path fill="none" stroke="black" d="M88923.22,-162.03C88949.24,-171.59 88980.1,-181.23 89009,-185.98 89053.73,-193.33 89779.99,-191.42 89825,-185.98 89861.57,-181.57 89901.05,-172.85 89935.44,-163.91"/>
<polygon fill="black" stroke="black" points="89936.7,-167.2 89945.47,-161.26 89934.91,-160.43 89936.7,-167.2"/>
</g>
<!-- moe_input_l12_dp0 -->
<g id="node297" class="node">
<title>moe_input_l12_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="90402" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="90402" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L12</text>
<text text-anchor="middle" x="90402" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="90402" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l12_dp0&#45;&gt;moe_input_l12_dp0 -->
<g id="edge496" class="edge">
<title>allreduce_l12_dp0&#45;&gt;moe_input_l12_dp0</title>
<path fill="none" stroke="black" d="M90198.01,-135.98C90206.23,-135.98 90214.44,-135.98 90222.66,-135.98"/>
<polygon fill="black" stroke="black" points="90222.68,-139.48 90232.68,-135.98 90222.68,-132.48 90222.68,-139.48"/>
</g>
<!-- router_l12_dp0 -->
<g id="node298" class="node">
<title>router_l12_dp0</title>
<polygon fill="lightyellow" stroke="black" points="91101.57,-176.98 90707.74,-176.98 90606.43,-94.98 91000.26,-94.98 91101.57,-176.98"/>
<text text-anchor="middle" x="90854" y="-144.48" font-family="Arial" font-size="10.00">Router L12</text>
<text text-anchor="middle" x="90854" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="90854" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l12_dp0&#45;&gt;router_l12_dp0 -->
<g id="edge497" class="edge">
<title>moe_input_l12_dp0&#45;&gt;router_l12_dp0</title>
<path fill="none" stroke="black" d="M90571.06,-135.98C90596.34,-135.98 90621.63,-135.98 90646.92,-135.98"/>
<polygon fill="black" stroke="black" points="90646.99,-139.48 90656.99,-135.98 90646.99,-132.48 90646.99,-139.48"/>
</g>
<!-- expert0_l12_dp0 -->
<g id="node299" class="node">
<title>expert0_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="95299.5,-161.98 95070.5,-161.98 95070.5,-109.98 95299.5,-109.98 95299.5,-161.98"/>
<text text-anchor="middle" x="95185" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L12</text>
<text text-anchor="middle" x="95185" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="95185" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="95185" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert0_l12_dp0 -->
<g id="edge498" class="edge">
<title>router_l12_dp0&#45;&gt;expert0_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91085.05,-163.45C91140.32,-168.97 91199.19,-173.99 91254,-176.98 91972.61,-216.16 93772.82,-196.54 94492.5,-198.98 94745.35,-199.84 94812.25,-222.4 95061,-176.98 95076.37,-174.18 95092.45,-169.91 95107.74,-165.17"/>
<polygon fill="black" stroke="black" points="95109.2,-168.38 95117.66,-162 95107.07,-161.71 95109.2,-168.38"/>
<text text-anchor="middle" x="94514" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l12_dp0 -->
<g id="node300" class="node">
<title>expert1_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="95052.5,-161.98 94823.5,-161.98 94823.5,-109.98 95052.5,-109.98 95052.5,-161.98"/>
<text text-anchor="middle" x="94938" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L12</text>
<text text-anchor="middle" x="94938" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="94938" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="94938" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert1_l12_dp0 -->
<g id="edge499" class="edge">
<title>router_l12_dp0&#45;&gt;expert1_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91084.79,-163.37C91140.14,-168.9 91199.11,-173.95 91254,-176.98 91856.77,-210.28 93366.86,-206.85 93970.5,-198.98 94157.99,-196.54 94629.28,-209.21 94814,-176.98 94829.72,-174.24 94846.17,-169.91 94861.76,-165.06"/>
<polygon fill="black" stroke="black" points="94862.89,-168.38 94871.35,-161.99 94860.75,-161.71 94862.89,-168.38"/>
<text text-anchor="middle" x="93949" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l12_dp0 -->
<g id="node301" class="node">
<title>expert2_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="94805.5,-161.98 94576.5,-161.98 94576.5,-109.98 94805.5,-109.98 94805.5,-161.98"/>
<text text-anchor="middle" x="94691" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L12</text>
<text text-anchor="middle" x="94691" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="94691" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="94691" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert2_l12_dp0 -->
<g id="edge500" class="edge">
<title>router_l12_dp0&#45;&gt;expert2_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M90999.67,-176.99C91038.3,-186.08 91080.21,-194.39 91119.5,-198.98 91138.48,-201.2 91143.39,-199.04 91162.5,-198.98 91351.64,-198.37 94380.36,-207.66 94567,-176.98 94582.93,-174.36 94599.6,-170.03 94615.35,-165.14"/>
<polygon fill="black" stroke="black" points="94616.58,-168.42 94625.03,-162.03 94614.44,-161.75 94616.58,-168.42"/>
<text text-anchor="middle" x="91141" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l12_dp0 -->
<g id="node302" class="node">
<title>expert3_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="94558.5,-161.98 94329.5,-161.98 94329.5,-109.98 94558.5,-109.98 94558.5,-161.98"/>
<text text-anchor="middle" x="94444" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L12</text>
<text text-anchor="middle" x="94444" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="94444" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="94444" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert3_l12_dp0 -->
<g id="edge501" class="edge">
<title>router_l12_dp0&#45;&gt;expert3_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91026.37,-177C91071.98,-186.1 91121.37,-194.39 91167.5,-198.98 91186.52,-200.87 91191.39,-199.05 91210.5,-198.98 91556.01,-197.76 93979.08,-233.12 94320,-176.98 94335.93,-174.36 94352.6,-170.02 94368.35,-165.13"/>
<polygon fill="black" stroke="black" points="94369.58,-168.41 94378.03,-162.02 94367.44,-161.75 94369.58,-168.41"/>
<text text-anchor="middle" x="91189" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l12_dp0 -->
<g id="node303" class="node">
<title>expert4_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="94311.5,-161.98 94082.5,-161.98 94082.5,-109.98 94311.5,-109.98 94311.5,-161.98"/>
<text text-anchor="middle" x="94197" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L12</text>
<text text-anchor="middle" x="94197" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="94197" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="94197" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert4_l12_dp0 -->
<g id="edge502" class="edge">
<title>router_l12_dp0&#45;&gt;expert4_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91053.02,-177C91105.62,-186.1 91162.5,-194.4 91215.5,-198.98 91234.54,-200.63 91239.39,-199.06 91258.5,-198.98 91571.23,-197.76 93764.44,-227.91 94073,-176.98 94088.93,-174.35 94105.6,-170.01 94121.35,-165.12"/>
<polygon fill="black" stroke="black" points="94122.58,-168.4 94131.03,-162.01 94120.44,-161.74 94122.58,-168.4"/>
<text text-anchor="middle" x="91237" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l12_dp0 -->
<g id="node304" class="node">
<title>expert5_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="94064.5,-161.98 93835.5,-161.98 93835.5,-109.98 94064.5,-109.98 94064.5,-161.98"/>
<text text-anchor="middle" x="93950" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L12</text>
<text text-anchor="middle" x="93950" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="93950" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="93950" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert5_l12_dp0 -->
<g id="edge503" class="edge">
<title>router_l12_dp0&#45;&gt;expert5_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91084.54,-163.18C91139.96,-168.73 91199.03,-173.83 91254,-176.98 91660.81,-200.28 92680.07,-205.05 93087.5,-198.98 93415.83,-194.09 93502.62,-234.01 93826,-176.98 93841.62,-174.23 93857.97,-169.91 93873.48,-165.1"/>
<polygon fill="black" stroke="black" points="93874.56,-168.43 93883.01,-162.05 93872.42,-161.77 93874.56,-168.43"/>
<text text-anchor="middle" x="93066" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l12_dp0 -->
<g id="node305" class="node">
<title>expert6_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="93817.5,-161.98 93588.5,-161.98 93588.5,-109.98 93817.5,-109.98 93817.5,-161.98"/>
<text text-anchor="middle" x="93703" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L12</text>
<text text-anchor="middle" x="93703" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="93703" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="93703" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert6_l12_dp0 -->
<g id="edge504" class="edge">
<title>router_l12_dp0&#45;&gt;expert6_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91079.65,-177.01C91139.23,-186.11 91203.61,-194.4 91263.5,-198.98 91282.55,-200.44 91287.39,-199.08 91306.5,-198.98 91559.01,-197.76 93329.9,-218.34 93579,-176.98 93594.93,-174.34 93611.59,-169.99 93627.35,-165.1"/>
<polygon fill="black" stroke="black" points="93628.58,-168.38 93637.03,-161.99 93626.44,-161.71 93628.58,-168.38"/>
<text text-anchor="middle" x="91285" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l12_dp0 -->
<g id="node306" class="node">
<title>expert7_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="93570.5,-161.98 93341.5,-161.98 93341.5,-109.98 93570.5,-109.98 93570.5,-161.98"/>
<text text-anchor="middle" x="93456" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L12</text>
<text text-anchor="middle" x="93456" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="93456" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="93456" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert7_l12_dp0 -->
<g id="edge505" class="edge">
<title>router_l12_dp0&#45;&gt;expert7_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91100.89,-176.28C91168.94,-185.66 91242.91,-194.28 91311.5,-198.98 91330.56,-200.29 91335.39,-199.09 91354.5,-198.98 91574.23,-197.76 93115.26,-213.12 93332,-176.98 93347.83,-174.34 93364.4,-170.03 93380.07,-165.16"/>
<polygon fill="black" stroke="black" points="93381.25,-168.46 93389.7,-162.07 93379.11,-161.8 93381.25,-168.46"/>
<text text-anchor="middle" x="91333" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l12_dp0 -->
<g id="node307" class="node">
<title>expert8_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="93323.5,-161.98 93094.5,-161.98 93094.5,-109.98 93323.5,-109.98 93323.5,-161.98"/>
<text text-anchor="middle" x="93209" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L12</text>
<text text-anchor="middle" x="93209" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="93209" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="93209" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert8_l12_dp0 -->
<g id="edge506" class="edge">
<title>router_l12_dp0&#45;&gt;expert8_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91096.08,-172.34C91179.36,-183.2 91273.33,-193.63 91359.5,-198.98 91550.87,-210.86 92895.9,-208.7 93085,-176.98 93100.83,-174.33 93117.39,-170 93133.07,-165.14"/>
<polygon fill="black" stroke="black" points="93134.24,-168.44 93142.7,-162.05 93132.11,-161.77 93134.24,-168.44"/>
<text text-anchor="middle" x="91381" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l12_dp0 -->
<g id="node308" class="node">
<title>expert9_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="93076.5,-161.98 92847.5,-161.98 92847.5,-109.98 93076.5,-109.98 93076.5,-161.98"/>
<text text-anchor="middle" x="92962" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L12</text>
<text text-anchor="middle" x="92962" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="92962" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="92962" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert9_l12_dp0 -->
<g id="edge507" class="edge">
<title>router_l12_dp0&#45;&gt;expert9_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91084.03,-162.76C91139.61,-168.34 91198.87,-173.56 91254,-176.98 91722.31,-206.02 91840.39,-208.74 92309.5,-198.98 92544.54,-194.09 92606.72,-219.18 92838,-176.98 92853.37,-174.18 92869.45,-169.91 92884.74,-165.18"/>
<polygon fill="black" stroke="black" points="92886.2,-168.38 92894.66,-162.01 92884.07,-161.72 92886.2,-168.38"/>
<text text-anchor="middle" x="92288" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l12_dp0 -->
<g id="node309" class="node">
<title>expert10_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="92829.5,-161.98 92600.5,-161.98 92600.5,-109.98 92829.5,-109.98 92829.5,-161.98"/>
<text text-anchor="middle" x="92715" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L12</text>
<text text-anchor="middle" x="92715" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="92715" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="92715" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert10_l12_dp0 -->
<g id="edge508" class="edge">
<title>router_l12_dp0&#45;&gt;expert10_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91091.88,-169.04C91189.47,-181.04 91303.7,-193.09 91407.5,-198.98 91538.81,-206.43 92461.36,-199.14 92591,-176.98 92606.73,-174.29 92623.19,-169.98 92638.78,-165.15"/>
<polygon fill="black" stroke="black" points="92639.9,-168.46 92648.36,-162.08 92637.77,-161.79 92639.9,-168.46"/>
<text text-anchor="middle" x="91429" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l12_dp0 -->
<g id="node310" class="node">
<title>expert11_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="92582.5,-161.98 92353.5,-161.98 92353.5,-109.98 92582.5,-109.98 92582.5,-161.98"/>
<text text-anchor="middle" x="92468" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L12</text>
<text text-anchor="middle" x="92468" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="92468" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="92468" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert11_l12_dp0 -->
<g id="edge509" class="edge">
<title>router_l12_dp0&#45;&gt;expert11_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91088.51,-166.28C91199.54,-179.16 91334.13,-192.64 91455.5,-198.98 91652.73,-209.28 92149.43,-210.92 92344,-176.98 92359.72,-174.24 92376.17,-169.91 92391.76,-165.06"/>
<polygon fill="black" stroke="black" points="92392.89,-168.38 92401.35,-161.99 92390.75,-161.71 92392.89,-168.38"/>
<text text-anchor="middle" x="91477" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l12_dp0 -->
<g id="node311" class="node">
<title>expert12_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="92335.5,-161.98 92106.5,-161.98 92106.5,-109.98 92335.5,-109.98 92335.5,-161.98"/>
<text text-anchor="middle" x="92221" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L12</text>
<text text-anchor="middle" x="92221" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="92221" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="92221" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert12_l12_dp0 -->
<g id="edge510" class="edge">
<title>router_l12_dp0&#45;&gt;expert12_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91080.29,-159.74C91137,-165.54 91197.71,-171.62 91254,-176.98 91254,-176.98 92097,-176.98 92097,-176.98 92112.37,-174.19 92128.45,-169.93 92143.75,-165.2"/>
<polygon fill="black" stroke="black" points="92145.21,-168.41 92153.67,-162.03 92143.08,-161.74 92145.21,-168.41"/>
<text text-anchor="middle" x="91525" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l12_dp0 -->
<g id="node312" class="node">
<title>expert13_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="92088.5,-161.98 91859.5,-161.98 91859.5,-109.98 92088.5,-109.98 92088.5,-161.98"/>
<text text-anchor="middle" x="91974" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L12</text>
<text text-anchor="middle" x="91974" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="91974" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="91974" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert13_l12_dp0 -->
<g id="edge511" class="edge">
<title>router_l12_dp0&#45;&gt;expert13_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91100.61,-176.06C91278.88,-199.52 91525.36,-220.67 91741.5,-198.98 91792.66,-193.85 91848.31,-179.11 91892.33,-165.18"/>
<polygon fill="black" stroke="black" points="91893.66,-168.43 91902.11,-162.04 91891.52,-161.77 91893.66,-168.43"/>
<text text-anchor="middle" x="91720" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l12_dp0 -->
<g id="node313" class="node">
<title>expert14_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="91841.5,-161.98 91612.5,-161.98 91612.5,-109.98 91841.5,-109.98 91841.5,-161.98"/>
<text text-anchor="middle" x="91727" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L12</text>
<text text-anchor="middle" x="91727" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="91727" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="91727" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert14_l12_dp0 -->
<g id="edge512" class="edge">
<title>router_l12_dp0&#45;&gt;expert14_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91084.52,-163.01C91220.24,-177.37 91395.37,-193.22 91551.5,-198.98 91570.6,-199.69 91575.86,-203.19 91594.5,-198.98 91622.7,-192.62 91651.94,-179.52 91675.75,-166.9"/>
<polygon fill="black" stroke="black" points="91677.48,-169.94 91684.6,-162.1 91674.14,-163.79 91677.48,-169.94"/>
<text text-anchor="middle" x="91573" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l12_dp0 -->
<g id="node314" class="node">
<title>expert15_l12_dp0</title>
<polygon fill="lightgreen" stroke="black" points="91492.5,-161.98 91263.5,-161.98 91263.5,-109.98 91492.5,-109.98 91492.5,-161.98"/>
<text text-anchor="middle" x="91378" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L12</text>
<text text-anchor="middle" x="91378" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="91378" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="91378" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp0&#45;&gt;expert15_l12_dp0 -->
<g id="edge513" class="edge">
<title>router_l12_dp0&#45;&gt;expert15_l12_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M91050.98,-135.98C91118.75,-135.98 91192.72,-135.98 91253.14,-135.98"/>
<polygon fill="black" stroke="black" points="91253.49,-139.48 91263.49,-135.98 91253.49,-132.48 91253.49,-139.48"/>
<text text-anchor="middle" x="91182.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l12_dp0 -->
<g id="node315" class="node">
<title>expert_agg_l12_dp0</title>
<polygon fill="lightyellow" stroke="black" points="95830.57,-176.98 95436.74,-176.98 95335.43,-94.98 95729.26,-94.98 95830.57,-176.98"/>
<text text-anchor="middle" x="95583" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L12</text>
<text text-anchor="middle" x="95583" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="95583" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge514" class="edge">
<title>expert0_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M95299.66,-135.98C95325.06,-135.98 95350.47,-135.98 95375.87,-135.98"/>
<polygon fill="black" stroke="black" points="95375.99,-139.48 95385.99,-135.98 95375.99,-132.48 95375.99,-139.48"/>
</g>
<!-- expert1_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge515" class="edge">
<title>expert1_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M94993.24,-162.02C95016.4,-171.57 95043.96,-181.22 95070,-185.98 95120.06,-195.15 95248.3,-190.41 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert2_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge516" class="edge">
<title>expert2_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M94746.24,-162.02C94769.4,-171.57 94796.96,-181.22 94823,-185.98 94875.02,-195.51 95246.31,-190.59 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert3_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge517" class="edge">
<title>expert3_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M94499.24,-162.02C94522.4,-171.57 94549.96,-181.22 94576,-185.98 94655.02,-200.45 95218.97,-192.97 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert4_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge518" class="edge">
<title>expert4_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M94252.24,-162.02C94275.4,-171.57 94302.96,-181.22 94329,-185.98 94382.01,-195.69 95245.31,-190.67 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert5_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge519" class="edge">
<title>expert5_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M94005.24,-162.02C94028.4,-171.57 94055.96,-181.22 94082,-185.98 94148.5,-198.16 95231.64,-191.87 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert6_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge520" class="edge">
<title>expert6_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M93758.24,-162.02C93781.4,-171.57 93808.96,-181.22 93835,-185.98 93915,-200.63 95217.97,-193.06 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert7_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge521" class="edge">
<title>expert7_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M93511.24,-162.02C93534.4,-171.57 93561.96,-181.22 93588,-185.98 93634.75,-194.54 95251.65,-190.12 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert8_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge522" class="edge">
<title>expert8_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M93264.24,-162.02C93287.4,-171.57 93314.96,-181.22 93341,-185.98 93394.5,-195.78 95244.82,-190.72 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert9_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge523" class="edge">
<title>expert9_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M93017.24,-162.02C93040.4,-171.57 93067.96,-181.22 93094,-185.98 93154.25,-197.01 95237.98,-191.31 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert10_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge524" class="edge">
<title>expert10_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M92770.24,-162.02C92793.4,-171.57 92820.96,-181.22 92847,-185.98 92914,-198.25 95231.15,-191.91 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert11_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge525" class="edge">
<title>expert11_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M92523.24,-162.02C92546.4,-171.57 92573.96,-181.22 92600,-185.98 92673.75,-199.48 95224.31,-192.51 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert12_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge526" class="edge">
<title>expert12_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M92276.24,-162.02C92299.4,-171.57 92326.96,-181.22 92353,-185.98 92433.49,-200.72 95217.48,-193.1 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert13_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge527" class="edge">
<title>expert13_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M92029.24,-162.02C92052.4,-171.57 92079.96,-181.22 92106,-185.98 92149.62,-193.97 95254.82,-189.84 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert14_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge528" class="edge">
<title>expert14_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M91782.24,-162.02C91805.4,-171.57 91832.96,-181.22 91859,-185.98 91906,-194.59 95251.4,-190.14 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- expert15_l12_dp0&#45;&gt;expert_agg_l12_dp0 -->
<g id="edge529" class="edge">
<title>expert15_l12_dp0&#45;&gt;expert_agg_l12_dp0</title>
<path fill="none" stroke="black" d="M91477.17,-162C91518.54,-171.59 91567.28,-181.26 91612,-185.98 91713.85,-196.74 95196.97,-194.9 95299,-185.98 95337.11,-182.65 95377.78,-176.86 95416.08,-170.36"/>
<polygon fill="black" stroke="black" points="95417.02,-173.75 95426.29,-168.6 95415.84,-166.85 95417.02,-173.75"/>
</g>
<!-- layer12_output_dp0 -->
<g id="node316" class="node">
<title>layer12_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="96035" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="96035" y="-144.48" font-family="Arial" font-size="10.00">Layer 12 Output</text>
<text text-anchor="middle" x="96035" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="96035" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l12_dp0&#45;&gt;layer12_output_dp0 -->
<g id="edge530" class="edge">
<title>expert_agg_l12_dp0&#45;&gt;layer12_output_dp0</title>
<path fill="none" stroke="black" d="M95780.31,-135.98C95805.49,-135.98 95830.66,-135.98 95855.84,-135.98"/>
<polygon fill="black" stroke="black" points="95855.87,-139.48 95865.87,-135.98 95855.87,-132.48 95855.87,-139.48"/>
</g>
<!-- attn_input_l13_dp0 -->
<g id="node317" class="node">
<title>attn_input_l13_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="96408" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="96408" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L13</text>
<text text-anchor="middle" x="96408" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="96408" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer12_output_dp0&#45;&gt;attn_input_l13_dp0 -->
<g id="edge531" class="edge">
<title>layer12_output_dp0&#45;&gt;attn_input_l13_dp0</title>
<path fill="none" stroke="black" d="M96204.01,-135.98C96212.23,-135.98 96220.44,-135.98 96228.66,-135.98"/>
<polygon fill="black" stroke="black" points="96228.68,-139.48 96238.68,-135.98 96228.68,-132.48 96228.68,-139.48"/>
</g>
<!-- attn_tp0_l13_dp0 -->
<g id="node318" class="node">
<title>attn_tp0_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="97706,-161.98 97446,-161.98 97446,-109.98 97706,-109.98 97706,-161.98"/>
<text text-anchor="middle" x="97576" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L13</text>
<text text-anchor="middle" x="97576" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="97576" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="97576" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp0&#45;&gt;attn_tp0_l13_dp0 -->
<g id="edge532" class="edge">
<title>attn_input_l13_dp0&#45;&gt;attn_tp0_l13_dp0</title>
<path fill="none" stroke="black" d="M96491.52,-161.26C96528.12,-171.09 96571.81,-181.13 96612,-185.98 96657,-191.42 97383.27,-193.33 97428,-185.98 97453.4,-181.81 97480.31,-173.85 97504.12,-165.5"/>
<polygon fill="black" stroke="black" points="97505.55,-168.71 97513.78,-162.03 97503.18,-162.12 97505.55,-168.71"/>
</g>
<!-- attn_tp1_l13_dp0 -->
<g id="node319" class="node">
<title>attn_tp1_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="97428,-161.98 97168,-161.98 97168,-109.98 97428,-109.98 97428,-161.98"/>
<text text-anchor="middle" x="97298" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L13</text>
<text text-anchor="middle" x="97298" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="97298" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="97298" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp0&#45;&gt;attn_tp1_l13_dp0 -->
<g id="edge533" class="edge">
<title>attn_input_l13_dp0&#45;&gt;attn_tp1_l13_dp0</title>
<path fill="none" stroke="black" d="M96491.52,-161.26C96528.12,-171.09 96571.81,-181.13 96612,-185.98 96671.35,-193.15 97091.01,-195.68 97150,-185.98 97175.4,-181.81 97202.31,-173.85 97226.12,-165.5"/>
<polygon fill="black" stroke="black" points="97227.55,-168.71 97235.78,-162.03 97225.18,-162.12 97227.55,-168.71"/>
</g>
<!-- attn_tp2_l13_dp0 -->
<g id="node320" class="node">
<title>attn_tp2_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="97150,-161.98 96890,-161.98 96890,-109.98 97150,-109.98 97150,-161.98"/>
<text text-anchor="middle" x="97020" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L13</text>
<text text-anchor="middle" x="97020" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="97020" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="97020" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp0&#45;&gt;attn_tp2_l13_dp0 -->
<g id="edge534" class="edge">
<title>attn_input_l13_dp0&#45;&gt;attn_tp2_l13_dp0</title>
<path fill="none" stroke="black" d="M96491.52,-161.26C96528.12,-171.09 96571.81,-181.13 96612,-185.98 96669.36,-192.91 96814.99,-195.35 96872,-185.98 96897.4,-181.81 96924.31,-173.85 96948.12,-165.5"/>
<polygon fill="black" stroke="black" points="96949.55,-168.71 96957.78,-162.03 96947.18,-162.12 96949.55,-168.71"/>
</g>
<!-- attn_tp3_l13_dp0 -->
<g id="node321" class="node">
<title>attn_tp3_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="96872,-161.98 96612,-161.98 96612,-109.98 96872,-109.98 96872,-161.98"/>
<text text-anchor="middle" x="96742" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L13</text>
<text text-anchor="middle" x="96742" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="96742" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="96742" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp0&#45;&gt;attn_tp3_l13_dp0 -->
<g id="edge535" class="edge">
<title>attn_input_l13_dp0&#45;&gt;attn_tp3_l13_dp0</title>
<path fill="none" stroke="black" d="M96577.28,-135.98C96585.35,-135.98 96593.42,-135.98 96601.49,-135.98"/>
<polygon fill="black" stroke="black" points="96601.7,-139.48 96611.7,-135.98 96601.7,-132.48 96601.7,-139.48"/>
</g>
<!-- allreduce_l13_dp0 -->
<g id="node322" class="node">
<title>allreduce_l13_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="97910" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="97910" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L13</text>
<text text-anchor="middle" x="97910" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="97910" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l13_dp0&#45;&gt;allreduce_l13_dp0 -->
<g id="edge536" class="edge">
<title>attn_tp0_l13_dp0&#45;&gt;allreduce_l13_dp0</title>
<path fill="none" stroke="black" d="M97706.14,-135.98C97714.35,-135.98 97722.56,-135.98 97730.77,-135.98"/>
<polygon fill="black" stroke="black" points="97730.78,-139.48 97740.78,-135.98 97730.78,-132.48 97730.78,-139.48"/>
</g>
<!-- attn_tp1_l13_dp0&#45;&gt;allreduce_l13_dp0 -->
<g id="edge537" class="edge">
<title>attn_tp1_l13_dp0&#45;&gt;allreduce_l13_dp0</title>
<path fill="none" stroke="black" d="M97360.22,-162.03C97386.24,-171.59 97417.1,-181.23 97446,-185.98 97503.01,-195.35 97648.64,-192.91 97706,-185.98 97742.57,-181.57 97782.05,-172.85 97816.44,-163.91"/>
<polygon fill="black" stroke="black" points="97817.7,-167.2 97826.47,-161.26 97815.91,-160.43 97817.7,-167.2"/>
</g>
<!-- attn_tp2_l13_dp0&#45;&gt;allreduce_l13_dp0 -->
<g id="edge538" class="edge">
<title>attn_tp2_l13_dp0&#45;&gt;allreduce_l13_dp0</title>
<path fill="none" stroke="black" d="M97082.22,-162.03C97108.24,-171.59 97139.1,-181.23 97168,-185.98 97226.98,-195.68 97646.65,-193.15 97706,-185.98 97742.57,-181.57 97782.05,-172.85 97816.44,-163.91"/>
<polygon fill="black" stroke="black" points="97817.7,-167.2 97826.47,-161.26 97815.91,-160.43 97817.7,-167.2"/>
</g>
<!-- attn_tp3_l13_dp0&#45;&gt;allreduce_l13_dp0 -->
<g id="edge539" class="edge">
<title>attn_tp3_l13_dp0&#45;&gt;allreduce_l13_dp0</title>
<path fill="none" stroke="black" d="M96804.22,-162.03C96830.24,-171.59 96861.1,-181.23 96890,-185.98 96934.73,-193.33 97660.99,-191.42 97706,-185.98 97742.57,-181.57 97782.05,-172.85 97816.44,-163.91"/>
<polygon fill="black" stroke="black" points="97817.7,-167.2 97826.47,-161.26 97815.91,-160.43 97817.7,-167.2"/>
</g>
<!-- moe_input_l13_dp0 -->
<g id="node323" class="node">
<title>moe_input_l13_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="98283" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="98283" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L13</text>
<text text-anchor="middle" x="98283" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="98283" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l13_dp0&#45;&gt;moe_input_l13_dp0 -->
<g id="edge540" class="edge">
<title>allreduce_l13_dp0&#45;&gt;moe_input_l13_dp0</title>
<path fill="none" stroke="black" d="M98079.01,-135.98C98087.23,-135.98 98095.44,-135.98 98103.66,-135.98"/>
<polygon fill="black" stroke="black" points="98103.68,-139.48 98113.68,-135.98 98103.68,-132.48 98103.68,-139.48"/>
</g>
<!-- router_l13_dp0 -->
<g id="node324" class="node">
<title>router_l13_dp0</title>
<polygon fill="lightyellow" stroke="black" points="98982.57,-176.98 98588.74,-176.98 98487.43,-94.98 98881.26,-94.98 98982.57,-176.98"/>
<text text-anchor="middle" x="98735" y="-144.48" font-family="Arial" font-size="10.00">Router L13</text>
<text text-anchor="middle" x="98735" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="98735" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l13_dp0&#45;&gt;router_l13_dp0 -->
<g id="edge541" class="edge">
<title>moe_input_l13_dp0&#45;&gt;router_l13_dp0</title>
<path fill="none" stroke="black" d="M98452.06,-135.98C98477.34,-135.98 98502.63,-135.98 98527.92,-135.98"/>
<polygon fill="black" stroke="black" points="98527.99,-139.48 98537.99,-135.98 98527.99,-132.48 98527.99,-139.48"/>
</g>
<!-- expert0_l13_dp0 -->
<g id="node325" class="node">
<title>expert0_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="103228.5,-161.98 102999.5,-161.98 102999.5,-109.98 103228.5,-109.98 103228.5,-161.98"/>
<text text-anchor="middle" x="103114" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L13</text>
<text text-anchor="middle" x="103114" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="103114" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="103114" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert0_l13_dp0 -->
<g id="edge542" class="edge">
<title>router_l13_dp0&#45;&gt;expert0_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98964.12,-161.92C99027.19,-168.02 99095.67,-173.71 99159,-176.98 99856.86,-213.09 101604.71,-196.54 102303.5,-198.98 102608.76,-200.05 102689.49,-230.66 102990,-176.98 103005.62,-174.19 103021.96,-169.86 103037.47,-165.05"/>
<polygon fill="black" stroke="black" points="103038.55,-168.38 103047,-161.99 103036.41,-161.71 103038.55,-168.38"/>
<text text-anchor="middle" x="102325" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l13_dp0 -->
<g id="node326" class="node">
<title>expert1_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="102981.5,-161.98 102752.5,-161.98 102752.5,-109.98 102981.5,-109.98 102981.5,-161.98"/>
<text text-anchor="middle" x="102867" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L13</text>
<text text-anchor="middle" x="102867" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="102867" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="102867" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert1_l13_dp0 -->
<g id="edge543" class="edge">
<title>router_l13_dp0&#45;&gt;expert1_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98880.67,-176.99C98919.3,-186.08 98961.21,-194.39 99000.5,-198.98 99019.48,-201.2 99024.39,-199.04 99043.5,-198.98 99249.03,-198.37 102540.18,-210.26 102743,-176.98 102758.93,-174.37 102775.6,-170.03 102791.36,-165.14"/>
<polygon fill="black" stroke="black" points="102792.58,-168.42 102801.03,-162.03 102790.44,-161.76 102792.58,-168.42"/>
<text text-anchor="middle" x="99022" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l13_dp0 -->
<g id="node327" class="node">
<title>expert2_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="102734.5,-161.98 102505.5,-161.98 102505.5,-109.98 102734.5,-109.98 102734.5,-161.98"/>
<text text-anchor="middle" x="102620" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L13</text>
<text text-anchor="middle" x="102620" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="102620" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="102620" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert2_l13_dp0 -->
<g id="edge544" class="edge">
<title>router_l13_dp0&#45;&gt;expert2_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98963.85,-161.81C99027,-167.93 99095.58,-173.64 99159,-176.98 99715.03,-206.29 101107.75,-206.35 101664.5,-198.98 101849.32,-196.54 102313.91,-208.78 102496,-176.98 102511.72,-174.24 102528.17,-169.9 102543.76,-165.06"/>
<polygon fill="black" stroke="black" points="102544.89,-168.37 102553.34,-161.99 102542.75,-161.71 102544.89,-168.37"/>
<text text-anchor="middle" x="101643" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l13_dp0 -->
<g id="node328" class="node">
<title>expert3_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="102487.5,-161.98 102258.5,-161.98 102258.5,-109.98 102487.5,-109.98 102487.5,-161.98"/>
<text text-anchor="middle" x="102373" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L13</text>
<text text-anchor="middle" x="102373" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="102373" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="102373" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert3_l13_dp0 -->
<g id="edge545" class="edge">
<title>router_l13_dp0&#45;&gt;expert3_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98907.37,-177C98952.98,-186.1 99002.37,-194.39 99048.5,-198.98 99067.52,-200.87 99072.39,-199.05 99091.5,-198.98 99442.34,-197.76 101902.82,-233.97 102249,-176.98 102264.93,-174.36 102281.6,-170.02 102297.35,-165.13"/>
<polygon fill="black" stroke="black" points="102298.58,-168.41 102307.03,-162.02 102296.44,-161.75 102298.58,-168.41"/>
<text text-anchor="middle" x="99070" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l13_dp0 -->
<g id="node329" class="node">
<title>expert4_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="102240.5,-161.98 102011.5,-161.98 102011.5,-109.98 102240.5,-109.98 102240.5,-161.98"/>
<text text-anchor="middle" x="102126" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L13</text>
<text text-anchor="middle" x="102126" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="102126" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="102126" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert4_l13_dp0 -->
<g id="edge546" class="edge">
<title>router_l13_dp0&#45;&gt;expert4_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98934.02,-177C98986.62,-186.1 99043.5,-194.4 99096.5,-198.98 99115.54,-200.63 99120.39,-199.06 99139.5,-198.98 99457.56,-197.76 101688.18,-228.76 102002,-176.98 102017.93,-174.35 102034.6,-170.01 102050.35,-165.12"/>
<polygon fill="black" stroke="black" points="102051.58,-168.4 102060.03,-162.01 102049.44,-161.74 102051.58,-168.4"/>
<text text-anchor="middle" x="99118" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l13_dp0 -->
<g id="node330" class="node">
<title>expert5_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="101993.5,-161.98 101764.5,-161.98 101764.5,-109.98 101993.5,-109.98 101993.5,-161.98"/>
<text text-anchor="middle" x="101879" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L13</text>
<text text-anchor="middle" x="101879" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="101879" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="101879" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert5_l13_dp0 -->
<g id="edge547" class="edge">
<title>router_l13_dp0&#45;&gt;expert5_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98960.65,-177.01C99020.23,-186.11 99084.61,-194.4 99144.5,-198.98 99163.55,-200.44 99168.39,-199.06 99187.5,-198.98 99472.78,-197.76 101473.54,-223.55 101755,-176.98 101770.93,-174.35 101787.59,-170 101803.35,-165.11"/>
<polygon fill="black" stroke="black" points="101804.58,-168.39 101813.03,-162 101802.44,-161.73 101804.58,-168.39"/>
<text text-anchor="middle" x="99166" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l13_dp0 -->
<g id="node331" class="node">
<title>expert6_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="101746.5,-161.98 101517.5,-161.98 101517.5,-109.98 101746.5,-109.98 101746.5,-161.98"/>
<text text-anchor="middle" x="101632" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L13</text>
<text text-anchor="middle" x="101632" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="101632" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="101632" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert6_l13_dp0 -->
<g id="edge548" class="edge">
<title>router_l13_dp0&#45;&gt;expert6_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98963.59,-161.58C99026.81,-167.7 99095.49,-173.48 99159,-176.98 99884.85,-217.02 100067.63,-210.19 100794.5,-198.98 101111.72,-194.09 101195.59,-232.24 101508,-176.98 101523.62,-174.22 101539.97,-169.9 101555.48,-165.09"/>
<polygon fill="black" stroke="black" points="101556.55,-168.42 101565.01,-162.04 101554.42,-161.75 101556.55,-168.42"/>
<text text-anchor="middle" x="100773" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l13_dp0 -->
<g id="node332" class="node">
<title>expert7_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="101499.5,-161.98 101270.5,-161.98 101270.5,-109.98 101499.5,-109.98 101499.5,-161.98"/>
<text text-anchor="middle" x="101385" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L13</text>
<text text-anchor="middle" x="101385" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="101385" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="101385" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert7_l13_dp0 -->
<g id="edge549" class="edge">
<title>router_l13_dp0&#45;&gt;expert7_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98981.89,-176.28C99049.94,-185.66 99123.91,-194.28 99192.5,-198.98 99211.56,-200.29 99216.39,-199.09 99235.5,-198.98 99460.56,-197.76 101038.99,-213.97 101261,-176.98 101276.83,-174.34 101293.4,-170.03 101309.07,-165.17"/>
<polygon fill="black" stroke="black" points="101310.25,-168.46 101318.7,-162.08 101308.11,-161.8 101310.25,-168.46"/>
<text text-anchor="middle" x="99214" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l13_dp0 -->
<g id="node333" class="node">
<title>expert8_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="101252.5,-161.98 101023.5,-161.98 101023.5,-109.98 101252.5,-109.98 101252.5,-161.98"/>
<text text-anchor="middle" x="101138" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L13</text>
<text text-anchor="middle" x="101138" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="101138" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="101138" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert8_l13_dp0 -->
<g id="edge550" class="edge">
<title>router_l13_dp0&#45;&gt;expert8_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98977.08,-172.34C99060.36,-183.2 99154.33,-193.63 99240.5,-198.98 99437.19,-211.19 100819.64,-209.55 101014,-176.98 101029.83,-174.33 101046.39,-170.01 101062.07,-165.14"/>
<polygon fill="black" stroke="black" points="101063.24,-168.44 101071.7,-162.05 101061.11,-161.78 101063.24,-168.44"/>
<text text-anchor="middle" x="99262" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l13_dp0 -->
<g id="node334" class="node">
<title>expert9_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="101005.5,-161.98 100776.5,-161.98 100776.5,-109.98 101005.5,-109.98 101005.5,-161.98"/>
<text text-anchor="middle" x="100891" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L13</text>
<text text-anchor="middle" x="100891" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="100891" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="100891" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert9_l13_dp0 -->
<g id="edge551" class="edge">
<title>router_l13_dp0&#45;&gt;expert9_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98972.88,-169.04C99070.47,-181.04 99184.7,-193.09 99288.5,-198.98 99452.53,-208.29 100605,-204.35 100767,-176.98 100782.83,-174.31 100799.39,-169.98 100815.06,-165.11"/>
<polygon fill="black" stroke="black" points="100816.24,-168.41 100824.69,-162.02 100814.1,-161.74 100816.24,-168.41"/>
<text text-anchor="middle" x="99310" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l13_dp0 -->
<g id="node335" class="node">
<title>expert10_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="100758.5,-161.98 100529.5,-161.98 100529.5,-109.98 100758.5,-109.98 100758.5,-161.98"/>
<text text-anchor="middle" x="100644" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L13</text>
<text text-anchor="middle" x="100644" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="100644" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="100644" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert10_l13_dp0 -->
<g id="edge552" class="edge">
<title>router_l13_dp0&#45;&gt;expert10_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98963.06,-161C99026.44,-167.15 99095.33,-173.08 99159,-176.98 99550.61,-201.02 99649.26,-208 100041.5,-198.98 100254.33,-194.09 100310.65,-215.65 100520,-176.98 100535.27,-174.16 100551.25,-169.92 100566.46,-165.21"/>
<polygon fill="black" stroke="black" points="100567.87,-168.43 100576.33,-162.06 100565.74,-161.76 100567.87,-168.43"/>
<text text-anchor="middle" x="100020" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l13_dp0 -->
<g id="node336" class="node">
<title>expert11_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="100511.5,-161.98 100282.5,-161.98 100282.5,-109.98 100511.5,-109.98 100511.5,-161.98"/>
<text text-anchor="middle" x="100397" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L13</text>
<text text-anchor="middle" x="100397" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="100397" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="100397" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert11_l13_dp0 -->
<g id="edge553" class="edge">
<title>router_l13_dp0&#45;&gt;expert11_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98969.51,-166.28C99080.54,-179.16 99215.13,-192.64 99336.5,-198.98 99544.38,-209.84 100067.9,-212.61 100273,-176.98 100288.72,-174.25 100305.18,-169.92 100320.77,-165.08"/>
<polygon fill="black" stroke="black" points="100321.89,-168.39 100330.35,-162.01 100319.76,-161.73 100321.89,-168.39"/>
<text text-anchor="middle" x="99358" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l13_dp0 -->
<g id="node337" class="node">
<title>expert12_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="100264.5,-161.98 100035.5,-161.98 100035.5,-109.98 100264.5,-109.98 100264.5,-161.98"/>
<text text-anchor="middle" x="100150" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L13</text>
<text text-anchor="middle" x="100150" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="100150" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="100150" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert12_l13_dp0 -->
<g id="edge554" class="edge">
<title>router_l13_dp0&#45;&gt;expert12_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98966.44,-163.92C99090.26,-177.47 99245.46,-192.26 99384.5,-198.98 99526.97,-205.88 99885.61,-202.24 100026,-176.98 100041.38,-174.22 100057.46,-169.97 100072.75,-165.24"/>
<polygon fill="black" stroke="black" points="100074.21,-168.44 100082.67,-162.07 100072.08,-161.78 100074.21,-168.44"/>
<text text-anchor="middle" x="99406" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l13_dp0 -->
<g id="node338" class="node">
<title>expert13_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="100017.5,-161.98 99788.5,-161.98 99788.5,-109.98 100017.5,-109.98 100017.5,-161.98"/>
<text text-anchor="middle" x="99903" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L13</text>
<text text-anchor="middle" x="99903" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="99903" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="99903" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert13_l13_dp0 -->
<g id="edge555" class="edge">
<title>router_l13_dp0&#45;&gt;expert13_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98975.38,-176.99C99188.6,-205.92 99507.44,-230.86 99779,-176.98 99793.96,-174.01 99809.62,-169.78 99824.58,-165.14"/>
<polygon fill="black" stroke="black" points="99825.83,-168.41 99834.29,-162.04 99823.7,-161.74 99825.83,-168.41"/>
<text text-anchor="middle" x="99454" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l13_dp0 -->
<g id="node339" class="node">
<title>expert14_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="99770.5,-161.98 99541.5,-161.98 99541.5,-109.98 99770.5,-109.98 99770.5,-161.98"/>
<text text-anchor="middle" x="99656" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L13</text>
<text text-anchor="middle" x="99656" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="99656" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="99656" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert14_l13_dp0 -->
<g id="edge556" class="edge">
<title>router_l13_dp0&#45;&gt;expert14_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98963.45,-161.26C99110.81,-176.09 99306.71,-193.04 99480.5,-198.98 99499.6,-199.64 99504.86,-203.19 99523.5,-198.98 99551.7,-192.62 99580.94,-179.52 99604.75,-166.9"/>
<polygon fill="black" stroke="black" points="99606.48,-169.94 99613.6,-162.1 99603.14,-163.79 99606.48,-169.94"/>
<text text-anchor="middle" x="99502" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l13_dp0 -->
<g id="node340" class="node">
<title>expert15_l13_dp0</title>
<polygon fill="lightgreen" stroke="black" points="99397.5,-161.98 99168.5,-161.98 99168.5,-109.98 99397.5,-109.98 99397.5,-161.98"/>
<text text-anchor="middle" x="99283" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L13</text>
<text text-anchor="middle" x="99283" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="99283" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="99283" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp0&#45;&gt;expert15_l13_dp0 -->
<g id="edge557" class="edge">
<title>router_l13_dp0&#45;&gt;expert15_l13_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M98932.06,-135.98C99007.51,-135.98 99091.43,-135.98 99158.28,-135.98"/>
<polygon fill="black" stroke="black" points="99158.44,-139.48 99168.44,-135.98 99158.44,-132.48 99158.44,-139.48"/>
<text text-anchor="middle" x="99075.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l13_dp0 -->
<g id="node341" class="node">
<title>expert_agg_l13_dp0</title>
<polygon fill="lightyellow" stroke="black" points="103759.57,-176.98 103365.74,-176.98 103264.43,-94.98 103658.26,-94.98 103759.57,-176.98"/>
<text text-anchor="middle" x="103512" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L13</text>
<text text-anchor="middle" x="103512" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="103512" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge558" class="edge">
<title>expert0_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M103228.66,-135.98C103254.06,-135.98 103279.47,-135.98 103304.87,-135.98"/>
<polygon fill="black" stroke="black" points="103304.99,-139.48 103314.99,-135.98 103304.99,-132.48 103304.99,-139.48"/>
</g>
<!-- expert1_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge559" class="edge">
<title>expert1_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M102922.24,-162.02C102945.4,-171.57 102972.96,-181.22 102999,-185.98 103049.06,-195.15 103177.3,-190.41 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert2_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge560" class="edge">
<title>expert2_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M102675.24,-162.02C102698.4,-171.57 102725.96,-181.22 102752,-185.98 102804.02,-195.51 103175.31,-190.59 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert3_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge561" class="edge">
<title>expert3_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M102428.24,-162.02C102451.4,-171.57 102478.96,-181.22 102505,-185.98 102584.02,-200.45 103147.97,-192.97 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert4_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge562" class="edge">
<title>expert4_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M102181.24,-162.02C102204.4,-171.57 102231.96,-181.22 102258,-185.98 102311.01,-195.69 103174.31,-190.67 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert5_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge563" class="edge">
<title>expert5_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M101934.24,-162.02C101957.4,-171.57 101984.96,-181.22 102011,-185.98 102077.5,-198.16 103160.64,-191.87 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert6_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge564" class="edge">
<title>expert6_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M101687.24,-162.02C101710.4,-171.57 101737.96,-181.22 101764,-185.98 101844,-200.63 103146.97,-193.06 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert7_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge565" class="edge">
<title>expert7_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M101440.24,-162.02C101463.4,-171.57 101490.96,-181.22 101517,-185.98 101563.75,-194.54 103180.65,-190.12 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert8_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge566" class="edge">
<title>expert8_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M101193.24,-162.02C101216.4,-171.57 101243.96,-181.22 101270,-185.98 101323.5,-195.78 103173.82,-190.72 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert9_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge567" class="edge">
<title>expert9_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M100946.24,-162.02C100969.4,-171.57 100996.96,-181.22 101023,-185.98 101083.25,-197.01 103166.98,-191.31 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert10_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge568" class="edge">
<title>expert10_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M100699.24,-162.02C100722.4,-171.57 100749.96,-181.22 100776,-185.98 100843,-198.25 103160.15,-191.91 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert11_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge569" class="edge">
<title>expert11_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M100452.24,-162.02C100475.4,-171.57 100502.96,-181.22 100529,-185.98 100602.75,-199.48 103153.31,-192.51 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert12_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge570" class="edge">
<title>expert12_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M100205.24,-162.02C100228.4,-171.57 100255.96,-181.22 100282,-185.98 100362.49,-200.72 103146.48,-193.1 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert13_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge571" class="edge">
<title>expert13_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M99958.24,-162.02C99981.4,-171.57 100008.96,-181.22 100035,-185.98 100078.62,-193.97 103183.82,-189.84 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert14_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge572" class="edge">
<title>expert14_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M99711.24,-162.02C99734.4,-171.57 99761.96,-181.22 99788,-185.98 99835,-194.59 103180.4,-190.14 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- expert15_l13_dp0&#45;&gt;expert_agg_l13_dp0 -->
<g id="edge573" class="edge">
<title>expert15_l13_dp0&#45;&gt;expert_agg_l13_dp0</title>
<path fill="none" stroke="black" d="M99392.49,-162.01C99438.12,-171.59 99491.84,-181.26 99541,-185.98 99642.95,-195.77 103125.97,-194.9 103228,-185.98 103266.11,-182.65 103306.78,-176.86 103345.08,-170.36"/>
<polygon fill="black" stroke="black" points="103346.02,-173.75 103355.29,-168.6 103344.84,-166.85 103346.02,-173.75"/>
</g>
<!-- layer13_output_dp0 -->
<g id="node342" class="node">
<title>layer13_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="103964" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="103964" y="-144.48" font-family="Arial" font-size="10.00">Layer 13 Output</text>
<text text-anchor="middle" x="103964" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="103964" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l13_dp0&#45;&gt;layer13_output_dp0 -->
<g id="edge574" class="edge">
<title>expert_agg_l13_dp0&#45;&gt;layer13_output_dp0</title>
<path fill="none" stroke="black" d="M103709.31,-135.98C103734.49,-135.98 103759.66,-135.98 103784.84,-135.98"/>
<polygon fill="black" stroke="black" points="103784.87,-139.48 103794.87,-135.98 103784.87,-132.48 103784.87,-139.48"/>
</g>
<!-- attn_input_l14_dp0 -->
<g id="node343" class="node">
<title>attn_input_l14_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="104337" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="104337" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L14</text>
<text text-anchor="middle" x="104337" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="104337" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer13_output_dp0&#45;&gt;attn_input_l14_dp0 -->
<g id="edge575" class="edge">
<title>layer13_output_dp0&#45;&gt;attn_input_l14_dp0</title>
<path fill="none" stroke="black" d="M104133.01,-135.98C104141.23,-135.98 104149.44,-135.98 104157.66,-135.98"/>
<polygon fill="black" stroke="black" points="104157.68,-139.48 104167.68,-135.98 104157.68,-132.48 104157.68,-139.48"/>
</g>
<!-- attn_tp0_l14_dp0 -->
<g id="node344" class="node">
<title>attn_tp0_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="105635,-161.98 105375,-161.98 105375,-109.98 105635,-109.98 105635,-161.98"/>
<text text-anchor="middle" x="105505" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L14</text>
<text text-anchor="middle" x="105505" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="105505" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="105505" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp0&#45;&gt;attn_tp0_l14_dp0 -->
<g id="edge576" class="edge">
<title>attn_input_l14_dp0&#45;&gt;attn_tp0_l14_dp0</title>
<path fill="none" stroke="black" d="M104420.52,-161.26C104457.12,-171.09 104500.81,-181.13 104541,-185.98 104586,-191.42 105312.27,-193.33 105357,-185.98 105382.4,-181.81 105409.31,-173.85 105433.12,-165.5"/>
<polygon fill="black" stroke="black" points="105434.55,-168.71 105442.78,-162.03 105432.18,-162.12 105434.55,-168.71"/>
</g>
<!-- attn_tp1_l14_dp0 -->
<g id="node345" class="node">
<title>attn_tp1_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="105357,-161.98 105097,-161.98 105097,-109.98 105357,-109.98 105357,-161.98"/>
<text text-anchor="middle" x="105227" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L14</text>
<text text-anchor="middle" x="105227" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="105227" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="105227" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp0&#45;&gt;attn_tp1_l14_dp0 -->
<g id="edge577" class="edge">
<title>attn_input_l14_dp0&#45;&gt;attn_tp1_l14_dp0</title>
<path fill="none" stroke="black" d="M104420.52,-161.26C104457.12,-171.09 104500.81,-181.13 104541,-185.98 104600.35,-193.15 105020.01,-195.68 105079,-185.98 105104.4,-181.81 105131.31,-173.85 105155.12,-165.5"/>
<polygon fill="black" stroke="black" points="105156.55,-168.71 105164.78,-162.03 105154.18,-162.12 105156.55,-168.71"/>
</g>
<!-- attn_tp2_l14_dp0 -->
<g id="node346" class="node">
<title>attn_tp2_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="105079,-161.98 104819,-161.98 104819,-109.98 105079,-109.98 105079,-161.98"/>
<text text-anchor="middle" x="104949" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L14</text>
<text text-anchor="middle" x="104949" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="104949" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="104949" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp0&#45;&gt;attn_tp2_l14_dp0 -->
<g id="edge578" class="edge">
<title>attn_input_l14_dp0&#45;&gt;attn_tp2_l14_dp0</title>
<path fill="none" stroke="black" d="M104420.52,-161.26C104457.12,-171.09 104500.81,-181.13 104541,-185.98 104598.36,-192.91 104743.99,-195.35 104801,-185.98 104826.4,-181.81 104853.31,-173.85 104877.12,-165.5"/>
<polygon fill="black" stroke="black" points="104878.55,-168.71 104886.78,-162.03 104876.18,-162.12 104878.55,-168.71"/>
</g>
<!-- attn_tp3_l14_dp0 -->
<g id="node347" class="node">
<title>attn_tp3_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="104801,-161.98 104541,-161.98 104541,-109.98 104801,-109.98 104801,-161.98"/>
<text text-anchor="middle" x="104671" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L14</text>
<text text-anchor="middle" x="104671" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="104671" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="104671" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp0&#45;&gt;attn_tp3_l14_dp0 -->
<g id="edge579" class="edge">
<title>attn_input_l14_dp0&#45;&gt;attn_tp3_l14_dp0</title>
<path fill="none" stroke="black" d="M104506.28,-135.98C104514.35,-135.98 104522.42,-135.98 104530.49,-135.98"/>
<polygon fill="black" stroke="black" points="104530.7,-139.48 104540.7,-135.98 104530.7,-132.48 104530.7,-139.48"/>
</g>
<!-- allreduce_l14_dp0 -->
<g id="node348" class="node">
<title>allreduce_l14_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="105839" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="105839" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L14</text>
<text text-anchor="middle" x="105839" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="105839" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l14_dp0&#45;&gt;allreduce_l14_dp0 -->
<g id="edge580" class="edge">
<title>attn_tp0_l14_dp0&#45;&gt;allreduce_l14_dp0</title>
<path fill="none" stroke="black" d="M105635.14,-135.98C105643.35,-135.98 105651.56,-135.98 105659.77,-135.98"/>
<polygon fill="black" stroke="black" points="105659.78,-139.48 105669.78,-135.98 105659.78,-132.48 105659.78,-139.48"/>
</g>
<!-- attn_tp1_l14_dp0&#45;&gt;allreduce_l14_dp0 -->
<g id="edge581" class="edge">
<title>attn_tp1_l14_dp0&#45;&gt;allreduce_l14_dp0</title>
<path fill="none" stroke="black" d="M105289.22,-162.03C105315.24,-171.59 105346.1,-181.23 105375,-185.98 105432.01,-195.35 105577.64,-192.91 105635,-185.98 105671.57,-181.57 105711.05,-172.85 105745.44,-163.91"/>
<polygon fill="black" stroke="black" points="105746.7,-167.2 105755.47,-161.26 105744.91,-160.43 105746.7,-167.2"/>
</g>
<!-- attn_tp2_l14_dp0&#45;&gt;allreduce_l14_dp0 -->
<g id="edge582" class="edge">
<title>attn_tp2_l14_dp0&#45;&gt;allreduce_l14_dp0</title>
<path fill="none" stroke="black" d="M105011.22,-162.03C105037.24,-171.59 105068.1,-181.23 105097,-185.98 105155.98,-195.68 105575.65,-193.15 105635,-185.98 105671.57,-181.57 105711.05,-172.85 105745.44,-163.91"/>
<polygon fill="black" stroke="black" points="105746.7,-167.2 105755.47,-161.26 105744.91,-160.43 105746.7,-167.2"/>
</g>
<!-- attn_tp3_l14_dp0&#45;&gt;allreduce_l14_dp0 -->
<g id="edge583" class="edge">
<title>attn_tp3_l14_dp0&#45;&gt;allreduce_l14_dp0</title>
<path fill="none" stroke="black" d="M104733.22,-162.03C104759.24,-171.59 104790.1,-181.23 104819,-185.98 104863.73,-193.33 105589.99,-191.42 105635,-185.98 105671.57,-181.57 105711.05,-172.85 105745.44,-163.91"/>
<polygon fill="black" stroke="black" points="105746.7,-167.2 105755.47,-161.26 105744.91,-160.43 105746.7,-167.2"/>
</g>
<!-- moe_input_l14_dp0 -->
<g id="node349" class="node">
<title>moe_input_l14_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="106212" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="106212" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L14</text>
<text text-anchor="middle" x="106212" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="106212" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l14_dp0&#45;&gt;moe_input_l14_dp0 -->
<g id="edge584" class="edge">
<title>allreduce_l14_dp0&#45;&gt;moe_input_l14_dp0</title>
<path fill="none" stroke="black" d="M106008.01,-135.98C106016.23,-135.98 106024.44,-135.98 106032.66,-135.98"/>
<polygon fill="black" stroke="black" points="106032.68,-139.48 106042.68,-135.98 106032.68,-132.48 106032.68,-139.48"/>
</g>
<!-- router_l14_dp0 -->
<g id="node350" class="node">
<title>router_l14_dp0</title>
<polygon fill="lightyellow" stroke="black" points="106911.57,-176.98 106517.74,-176.98 106416.43,-94.98 106810.26,-94.98 106911.57,-176.98"/>
<text text-anchor="middle" x="106664" y="-144.48" font-family="Arial" font-size="10.00">Router L14</text>
<text text-anchor="middle" x="106664" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="106664" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l14_dp0&#45;&gt;router_l14_dp0 -->
<g id="edge585" class="edge">
<title>moe_input_l14_dp0&#45;&gt;router_l14_dp0</title>
<path fill="none" stroke="black" d="M106381.06,-135.98C106406.34,-135.98 106431.63,-135.98 106456.92,-135.98"/>
<polygon fill="black" stroke="black" points="106456.99,-139.48 106466.99,-135.98 106456.99,-132.48 106456.99,-139.48"/>
</g>
<!-- expert0_l14_dp0 -->
<g id="node351" class="node">
<title>expert0_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="111157.5,-161.98 110928.5,-161.98 110928.5,-109.98 111157.5,-109.98 111157.5,-161.98"/>
<text text-anchor="middle" x="111043" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L14</text>
<text text-anchor="middle" x="111043" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="111043" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="111043" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert0_l14_dp0 -->
<g id="edge586" class="edge">
<title>router_l14_dp0&#45;&gt;expert0_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106893.12,-161.91C106956.19,-168.01 107024.67,-173.7 107088,-176.98 107761.89,-211.94 109449.71,-196.54 110124.5,-198.98 110301.12,-199.62 110745.05,-207.61 110919,-176.98 110934.62,-174.23 110950.97,-169.92 110966.48,-165.11"/>
<polygon fill="black" stroke="black" points="110967.56,-168.44 110976.02,-162.06 110965.42,-161.77 110967.56,-168.44"/>
<text text-anchor="middle" x="110146" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l14_dp0 -->
<g id="node352" class="node">
<title>expert1_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="110910.5,-161.98 110681.5,-161.98 110681.5,-109.98 110910.5,-109.98 110910.5,-161.98"/>
<text text-anchor="middle" x="110796" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L14</text>
<text text-anchor="middle" x="110796" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="110796" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="110796" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert1_l14_dp0 -->
<g id="edge587" class="edge">
<title>router_l14_dp0&#45;&gt;expert1_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106809.67,-176.99C106848.3,-186.08 106890.21,-194.39 106929.5,-198.98 106948.48,-201.2 106953.39,-199.04 106972.5,-198.98 107178.03,-198.37 110469.18,-210.26 110672,-176.98 110687.93,-174.37 110704.6,-170.03 110720.36,-165.14"/>
<polygon fill="black" stroke="black" points="110721.58,-168.42 110730.03,-162.03 110719.44,-161.76 110721.58,-168.42"/>
<text text-anchor="middle" x="106951" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l14_dp0 -->
<g id="node353" class="node">
<title>expert2_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="110663.5,-161.98 110434.5,-161.98 110434.5,-109.98 110663.5,-109.98 110663.5,-161.98"/>
<text text-anchor="middle" x="110549" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L14</text>
<text text-anchor="middle" x="110549" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="110549" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="110549" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert2_l14_dp0 -->
<g id="edge588" class="edge">
<title>router_l14_dp0&#45;&gt;expert2_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106836.37,-177C106881.98,-186.1 106931.37,-194.39 106977.5,-198.98 106996.52,-200.87 107001.39,-199.04 107020.5,-198.98 107209.64,-198.37 110238.36,-207.66 110425,-176.98 110440.93,-174.36 110457.6,-170.03 110473.35,-165.14"/>
<polygon fill="black" stroke="black" points="110474.58,-168.42 110483.03,-162.03 110472.44,-161.75 110474.58,-168.42"/>
<text text-anchor="middle" x="106999" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l14_dp0 -->
<g id="node354" class="node">
<title>expert3_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="110416.5,-161.98 110187.5,-161.98 110187.5,-109.98 110416.5,-109.98 110416.5,-161.98"/>
<text text-anchor="middle" x="110302" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L14</text>
<text text-anchor="middle" x="110302" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="110302" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="110302" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert3_l14_dp0 -->
<g id="edge589" class="edge">
<title>router_l14_dp0&#45;&gt;expert3_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106892.85,-161.77C106956,-167.89 107024.58,-173.61 107088,-176.98 107596.08,-203.99 108868.75,-205.97 109377.5,-198.98 109733.38,-194.09 109827.42,-238.39 110178,-176.98 110193.63,-174.25 110209.98,-169.94 110225.49,-165.13"/>
<polygon fill="black" stroke="black" points="110226.56,-168.46 110235.02,-162.08 110224.43,-161.79 110226.56,-168.46"/>
<text text-anchor="middle" x="109356" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l14_dp0 -->
<g id="node355" class="node">
<title>expert4_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="110169.5,-161.98 109940.5,-161.98 109940.5,-109.98 110169.5,-109.98 110169.5,-161.98"/>
<text text-anchor="middle" x="110055" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L14</text>
<text text-anchor="middle" x="110055" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="110055" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="110055" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert4_l14_dp0 -->
<g id="edge590" class="edge">
<title>router_l14_dp0&#45;&gt;expert4_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106863.02,-177C106915.62,-186.1 106972.5,-194.4 107025.5,-198.98 107044.54,-200.63 107049.39,-199.06 107068.5,-198.98 107386.56,-197.76 109617.18,-228.76 109931,-176.98 109946.93,-174.35 109963.6,-170.01 109979.35,-165.12"/>
<polygon fill="black" stroke="black" points="109980.58,-168.4 109989.03,-162.01 109978.44,-161.74 109980.58,-168.4"/>
<text text-anchor="middle" x="107047" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l14_dp0 -->
<g id="node356" class="node">
<title>expert5_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="109922.5,-161.98 109693.5,-161.98 109693.5,-109.98 109922.5,-109.98 109922.5,-161.98"/>
<text text-anchor="middle" x="109808" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L14</text>
<text text-anchor="middle" x="109808" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="109808" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="109808" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert5_l14_dp0 -->
<g id="edge591" class="edge">
<title>router_l14_dp0&#45;&gt;expert5_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106889.65,-177.01C106949.23,-186.11 107013.61,-194.4 107073.5,-198.98 107092.55,-200.44 107097.39,-199.06 107116.5,-198.98 107401.78,-197.76 109402.54,-223.55 109684,-176.98 109699.93,-174.35 109716.59,-170 109732.35,-165.11"/>
<polygon fill="black" stroke="black" points="109733.58,-168.39 109742.03,-162 109731.44,-161.73 109733.58,-168.39"/>
<text text-anchor="middle" x="107095" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l14_dp0 -->
<g id="node357" class="node">
<title>expert6_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="109675.5,-161.98 109446.5,-161.98 109446.5,-109.98 109675.5,-109.98 109675.5,-161.98"/>
<text text-anchor="middle" x="109561" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L14</text>
<text text-anchor="middle" x="109561" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="109561" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="109561" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert6_l14_dp0 -->
<g id="edge592" class="edge">
<title>router_l14_dp0&#45;&gt;expert6_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106910.89,-176.28C106978.94,-185.66 107052.91,-194.28 107121.5,-198.98 107140.56,-200.29 107145.39,-199.08 107164.5,-198.98 107417.01,-197.76 109187.9,-218.34 109437,-176.98 109452.93,-174.34 109469.59,-169.99 109485.35,-165.1"/>
<polygon fill="black" stroke="black" points="109486.58,-168.38 109495.03,-161.99 109484.44,-161.71 109486.58,-168.38"/>
<text text-anchor="middle" x="107143" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l14_dp0 -->
<g id="node358" class="node">
<title>expert7_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="109428.5,-161.98 109199.5,-161.98 109199.5,-109.98 109428.5,-109.98 109428.5,-161.98"/>
<text text-anchor="middle" x="109314" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L14</text>
<text text-anchor="middle" x="109314" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="109314" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="109314" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert7_l14_dp0 -->
<g id="edge593" class="edge">
<title>router_l14_dp0&#45;&gt;expert7_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106892.59,-161.5C106955.81,-167.63 107024.5,-173.42 107088,-176.98 107731.28,-213.06 107893.29,-209.84 108537.5,-198.98 108827.62,-194.09 108904.34,-227.94 109190,-176.98 109205.62,-174.2 109221.96,-169.87 109237.47,-165.05"/>
<polygon fill="black" stroke="black" points="109238.55,-168.38 109247.01,-162 109236.41,-161.72 109238.55,-168.38"/>
<text text-anchor="middle" x="108516" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l14_dp0 -->
<g id="node359" class="node">
<title>expert8_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="109181.5,-161.98 108952.5,-161.98 108952.5,-109.98 109181.5,-109.98 109181.5,-161.98"/>
<text text-anchor="middle" x="109067" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L14</text>
<text text-anchor="middle" x="109067" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="109067" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="109067" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert8_l14_dp0 -->
<g id="edge594" class="edge">
<title>router_l14_dp0&#45;&gt;expert8_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106906.08,-172.34C106989.36,-183.2 107083.33,-193.63 107169.5,-198.98 107366.19,-211.19 108748.64,-209.55 108943,-176.98 108958.83,-174.33 108975.39,-170.01 108991.07,-165.14"/>
<polygon fill="black" stroke="black" points="108992.24,-168.44 109000.7,-162.05 108990.11,-161.78 108992.24,-168.44"/>
<text text-anchor="middle" x="107191" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l14_dp0 -->
<g id="node360" class="node">
<title>expert9_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="108934.5,-161.98 108705.5,-161.98 108705.5,-109.98 108934.5,-109.98 108934.5,-161.98"/>
<text text-anchor="middle" x="108820" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L14</text>
<text text-anchor="middle" x="108820" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="108820" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="108820" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert9_l14_dp0 -->
<g id="edge595" class="edge">
<title>router_l14_dp0&#45;&gt;expert9_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106901.88,-169.04C106999.47,-181.04 107113.7,-193.09 107217.5,-198.98 107381.53,-208.29 108534,-204.35 108696,-176.98 108711.83,-174.31 108728.39,-169.98 108744.06,-165.11"/>
<polygon fill="black" stroke="black" points="108745.24,-168.41 108753.69,-162.02 108743.1,-161.74 108745.24,-168.41"/>
<text text-anchor="middle" x="107239" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l14_dp0 -->
<g id="node361" class="node">
<title>expert10_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="108687.5,-161.98 108458.5,-161.98 108458.5,-109.98 108687.5,-109.98 108687.5,-161.98"/>
<text text-anchor="middle" x="108573" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L14</text>
<text text-anchor="middle" x="108573" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="108573" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="108573" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert10_l14_dp0 -->
<g id="edge596" class="edge">
<title>router_l14_dp0&#45;&gt;expert10_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106898.51,-166.28C107009.54,-179.16 107144.13,-192.64 107265.5,-198.98 107396.84,-205.84 108319.36,-199.14 108449,-176.98 108464.73,-174.29 108481.19,-169.98 108496.78,-165.15"/>
<polygon fill="black" stroke="black" points="108497.9,-168.46 108506.36,-162.08 108495.77,-161.79 108497.9,-168.46"/>
<text text-anchor="middle" x="107287" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l14_dp0 -->
<g id="node362" class="node">
<title>expert11_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="108440.5,-161.98 108211.5,-161.98 108211.5,-109.98 108440.5,-109.98 108440.5,-161.98"/>
<text text-anchor="middle" x="108326" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L14</text>
<text text-anchor="middle" x="108326" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="108326" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="108326" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert11_l14_dp0 -->
<g id="edge597" class="edge">
<title>router_l14_dp0&#45;&gt;expert11_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106891.53,-160.76C106955.05,-166.92 107024.16,-172.92 107088,-176.98 107424.57,-198.41 107509.41,-209.4 107846.5,-198.98 108004.73,-194.09 108046.56,-206.97 108202,-176.98 108217.07,-174.08 108232.83,-169.84 108247.88,-165.18"/>
<polygon fill="black" stroke="black" points="108249.18,-168.44 108257.64,-162.07 108247.05,-161.77 108249.18,-168.44"/>
<text text-anchor="middle" x="107825" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l14_dp0 -->
<g id="node363" class="node">
<title>expert12_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="108193.5,-161.98 107964.5,-161.98 107964.5,-109.98 108193.5,-109.98 108193.5,-161.98"/>
<text text-anchor="middle" x="108079" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L14</text>
<text text-anchor="middle" x="108079" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="108079" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="108079" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert12_l14_dp0 -->
<g id="edge598" class="edge">
<title>router_l14_dp0&#45;&gt;expert12_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106895.44,-163.92C107019.26,-177.47 107174.46,-192.26 107313.5,-198.98 107455.97,-205.88 107814.61,-202.24 107955,-176.98 107970.38,-174.22 107986.46,-169.97 108001.75,-165.24"/>
<polygon fill="black" stroke="black" points="108003.21,-168.44 108011.67,-162.07 108001.08,-161.78 108003.21,-168.44"/>
<text text-anchor="middle" x="107335" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l14_dp0 -->
<g id="node364" class="node">
<title>expert13_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="107946.5,-161.98 107717.5,-161.98 107717.5,-109.98 107946.5,-109.98 107946.5,-161.98"/>
<text text-anchor="middle" x="107832" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L14</text>
<text text-anchor="middle" x="107832" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="107832" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="107832" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert13_l14_dp0 -->
<g id="edge599" class="edge">
<title>router_l14_dp0&#45;&gt;expert13_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106904.38,-176.99C107117.6,-205.92 107436.44,-230.86 107708,-176.98 107722.96,-174.01 107738.62,-169.78 107753.58,-165.14"/>
<polygon fill="black" stroke="black" points="107754.83,-168.41 107763.29,-162.04 107752.7,-161.74 107754.83,-168.41"/>
<text text-anchor="middle" x="107383" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l14_dp0 -->
<g id="node365" class="node">
<title>expert14_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="107699.5,-161.98 107470.5,-161.98 107470.5,-109.98 107699.5,-109.98 107699.5,-161.98"/>
<text text-anchor="middle" x="107585" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L14</text>
<text text-anchor="middle" x="107585" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="107585" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="107585" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert14_l14_dp0 -->
<g id="edge600" class="edge">
<title>router_l14_dp0&#45;&gt;expert14_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106892.45,-161.26C107039.81,-176.09 107235.71,-193.04 107409.5,-198.98 107428.6,-199.64 107433.86,-203.19 107452.5,-198.98 107480.7,-192.62 107509.94,-179.52 107533.75,-166.9"/>
<polygon fill="black" stroke="black" points="107535.48,-169.94 107542.6,-162.1 107532.14,-163.79 107535.48,-169.94"/>
<text text-anchor="middle" x="107431" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l14_dp0 -->
<g id="node366" class="node">
<title>expert15_l14_dp0</title>
<polygon fill="lightgreen" stroke="black" points="107326.5,-161.98 107097.5,-161.98 107097.5,-109.98 107326.5,-109.98 107326.5,-161.98"/>
<text text-anchor="middle" x="107212" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L14</text>
<text text-anchor="middle" x="107212" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="107212" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="107212" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp0&#45;&gt;expert15_l14_dp0 -->
<g id="edge601" class="edge">
<title>router_l14_dp0&#45;&gt;expert15_l14_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M106861.06,-135.98C106936.51,-135.98 107020.43,-135.98 107087.28,-135.98"/>
<polygon fill="black" stroke="black" points="107087.44,-139.48 107097.44,-135.98 107087.44,-132.48 107087.44,-139.48"/>
<text text-anchor="middle" x="107004.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l14_dp0 -->
<g id="node367" class="node">
<title>expert_agg_l14_dp0</title>
<polygon fill="lightyellow" stroke="black" points="111688.57,-176.98 111294.74,-176.98 111193.43,-94.98 111587.26,-94.98 111688.57,-176.98"/>
<text text-anchor="middle" x="111441" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L14</text>
<text text-anchor="middle" x="111441" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="111441" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge602" class="edge">
<title>expert0_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M111157.66,-135.98C111183.06,-135.98 111208.47,-135.98 111233.87,-135.98"/>
<polygon fill="black" stroke="black" points="111233.99,-139.48 111243.99,-135.98 111233.99,-132.48 111233.99,-139.48"/>
</g>
<!-- expert1_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge603" class="edge">
<title>expert1_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M110851.24,-162.02C110874.4,-171.57 110901.96,-181.22 110928,-185.98 110978.06,-195.15 111106.3,-190.41 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert2_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge604" class="edge">
<title>expert2_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M110604.24,-162.02C110627.4,-171.57 110654.96,-181.22 110681,-185.98 110733.02,-195.51 111104.31,-190.59 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert3_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge605" class="edge">
<title>expert3_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M110357.24,-162.02C110380.4,-171.57 110407.96,-181.22 110434,-185.98 110513.02,-200.45 111076.97,-192.97 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert4_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge606" class="edge">
<title>expert4_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M110110.24,-162.02C110133.4,-171.57 110160.96,-181.22 110187,-185.98 110240.01,-195.69 111103.31,-190.67 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert5_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge607" class="edge">
<title>expert5_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M109863.24,-162.02C109886.4,-171.57 109913.96,-181.22 109940,-185.98 110006.5,-198.16 111089.64,-191.87 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert6_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge608" class="edge">
<title>expert6_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M109616.24,-162.02C109639.4,-171.57 109666.96,-181.22 109693,-185.98 109773,-200.63 111075.97,-193.06 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert7_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge609" class="edge">
<title>expert7_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M109369.24,-162.02C109392.4,-171.57 109419.96,-181.22 109446,-185.98 109492.75,-194.54 111109.65,-190.12 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert8_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge610" class="edge">
<title>expert8_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M109122.24,-162.02C109145.4,-171.57 109172.96,-181.22 109199,-185.98 109252.5,-195.78 111102.82,-190.72 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert9_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge611" class="edge">
<title>expert9_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M108875.24,-162.02C108898.4,-171.57 108925.96,-181.22 108952,-185.98 109012.25,-197.01 111095.98,-191.31 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert10_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge612" class="edge">
<title>expert10_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M108628.24,-162.02C108651.4,-171.57 108678.96,-181.22 108705,-185.98 108772,-198.25 111089.15,-191.91 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert11_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge613" class="edge">
<title>expert11_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M108381.24,-162.02C108404.4,-171.57 108431.96,-181.22 108458,-185.98 108531.75,-199.48 111082.31,-192.51 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert12_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge614" class="edge">
<title>expert12_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M108134.24,-162.02C108157.4,-171.57 108184.96,-181.22 108211,-185.98 108291.49,-200.72 111075.48,-193.1 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert13_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge615" class="edge">
<title>expert13_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M107887.24,-162.02C107910.4,-171.57 107937.96,-181.22 107964,-185.98 108007.62,-193.97 111112.82,-189.84 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert14_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge616" class="edge">
<title>expert14_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M107640.24,-162.02C107663.4,-171.57 107690.96,-181.22 107717,-185.98 107764,-194.59 111109.4,-190.14 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- expert15_l14_dp0&#45;&gt;expert_agg_l14_dp0 -->
<g id="edge617" class="edge">
<title>expert15_l14_dp0&#45;&gt;expert_agg_l14_dp0</title>
<path fill="none" stroke="black" d="M107321.49,-162.01C107367.12,-171.59 107420.84,-181.26 107470,-185.98 107571.95,-195.77 111054.97,-194.9 111157,-185.98 111195.11,-182.65 111235.78,-176.86 111274.08,-170.36"/>
<polygon fill="black" stroke="black" points="111275.02,-173.75 111284.29,-168.6 111273.84,-166.85 111275.02,-173.75"/>
</g>
<!-- layer14_output_dp0 -->
<g id="node368" class="node">
<title>layer14_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="111893" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="111893" y="-144.48" font-family="Arial" font-size="10.00">Layer 14 Output</text>
<text text-anchor="middle" x="111893" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="111893" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l14_dp0&#45;&gt;layer14_output_dp0 -->
<g id="edge618" class="edge">
<title>expert_agg_l14_dp0&#45;&gt;layer14_output_dp0</title>
<path fill="none" stroke="black" d="M111638.31,-135.98C111663.49,-135.98 111688.66,-135.98 111713.84,-135.98"/>
<polygon fill="black" stroke="black" points="111713.87,-139.48 111723.87,-135.98 111713.87,-132.48 111713.87,-139.48"/>
</g>
<!-- attn_input_l15_dp0 -->
<g id="node369" class="node">
<title>attn_input_l15_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="112266" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="112266" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L15</text>
<text text-anchor="middle" x="112266" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="112266" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer14_output_dp0&#45;&gt;attn_input_l15_dp0 -->
<g id="edge619" class="edge">
<title>layer14_output_dp0&#45;&gt;attn_input_l15_dp0</title>
<path fill="none" stroke="black" d="M112062.01,-135.98C112070.23,-135.98 112078.44,-135.98 112086.66,-135.98"/>
<polygon fill="black" stroke="black" points="112086.68,-139.48 112096.68,-135.98 112086.68,-132.48 112086.68,-139.48"/>
</g>
<!-- attn_tp0_l15_dp0 -->
<g id="node370" class="node">
<title>attn_tp0_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="113564,-161.98 113304,-161.98 113304,-109.98 113564,-109.98 113564,-161.98"/>
<text text-anchor="middle" x="113434" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L15</text>
<text text-anchor="middle" x="113434" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="113434" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="113434" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp0&#45;&gt;attn_tp0_l15_dp0 -->
<g id="edge620" class="edge">
<title>attn_input_l15_dp0&#45;&gt;attn_tp0_l15_dp0</title>
<path fill="none" stroke="black" d="M112349.52,-161.26C112386.12,-171.09 112429.81,-181.13 112470,-185.98 112515,-191.42 113241.27,-193.33 113286,-185.98 113311.4,-181.81 113338.31,-173.85 113362.12,-165.5"/>
<polygon fill="black" stroke="black" points="113363.55,-168.71 113371.78,-162.03 113361.18,-162.12 113363.55,-168.71"/>
</g>
<!-- attn_tp1_l15_dp0 -->
<g id="node371" class="node">
<title>attn_tp1_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="113286,-161.98 113026,-161.98 113026,-109.98 113286,-109.98 113286,-161.98"/>
<text text-anchor="middle" x="113156" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L15</text>
<text text-anchor="middle" x="113156" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="113156" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="113156" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp0&#45;&gt;attn_tp1_l15_dp0 -->
<g id="edge621" class="edge">
<title>attn_input_l15_dp0&#45;&gt;attn_tp1_l15_dp0</title>
<path fill="none" stroke="black" d="M112349.52,-161.26C112386.12,-171.09 112429.81,-181.13 112470,-185.98 112529.35,-193.15 112949.01,-195.68 113008,-185.98 113033.4,-181.81 113060.31,-173.85 113084.12,-165.5"/>
<polygon fill="black" stroke="black" points="113085.55,-168.71 113093.78,-162.03 113083.18,-162.12 113085.55,-168.71"/>
</g>
<!-- attn_tp2_l15_dp0 -->
<g id="node372" class="node">
<title>attn_tp2_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="113008,-161.98 112748,-161.98 112748,-109.98 113008,-109.98 113008,-161.98"/>
<text text-anchor="middle" x="112878" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L15</text>
<text text-anchor="middle" x="112878" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="112878" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="112878" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp0&#45;&gt;attn_tp2_l15_dp0 -->
<g id="edge622" class="edge">
<title>attn_input_l15_dp0&#45;&gt;attn_tp2_l15_dp0</title>
<path fill="none" stroke="black" d="M112349.52,-161.26C112386.12,-171.09 112429.81,-181.13 112470,-185.98 112527.36,-192.91 112672.99,-195.35 112730,-185.98 112755.4,-181.81 112782.31,-173.85 112806.12,-165.5"/>
<polygon fill="black" stroke="black" points="112807.55,-168.71 112815.78,-162.03 112805.18,-162.12 112807.55,-168.71"/>
</g>
<!-- attn_tp3_l15_dp0 -->
<g id="node373" class="node">
<title>attn_tp3_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="112730,-161.98 112470,-161.98 112470,-109.98 112730,-109.98 112730,-161.98"/>
<text text-anchor="middle" x="112600" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L15</text>
<text text-anchor="middle" x="112600" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="112600" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="112600" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp0&#45;&gt;attn_tp3_l15_dp0 -->
<g id="edge623" class="edge">
<title>attn_input_l15_dp0&#45;&gt;attn_tp3_l15_dp0</title>
<path fill="none" stroke="black" d="M112435.28,-135.98C112443.35,-135.98 112451.42,-135.98 112459.49,-135.98"/>
<polygon fill="black" stroke="black" points="112459.7,-139.48 112469.7,-135.98 112459.7,-132.48 112459.7,-139.48"/>
</g>
<!-- allreduce_l15_dp0 -->
<g id="node374" class="node">
<title>allreduce_l15_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="113768" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="113768" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L15</text>
<text text-anchor="middle" x="113768" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="113768" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l15_dp0&#45;&gt;allreduce_l15_dp0 -->
<g id="edge624" class="edge">
<title>attn_tp0_l15_dp0&#45;&gt;allreduce_l15_dp0</title>
<path fill="none" stroke="black" d="M113564.14,-135.98C113572.35,-135.98 113580.56,-135.98 113588.77,-135.98"/>
<polygon fill="black" stroke="black" points="113588.78,-139.48 113598.78,-135.98 113588.78,-132.48 113588.78,-139.48"/>
</g>
<!-- attn_tp1_l15_dp0&#45;&gt;allreduce_l15_dp0 -->
<g id="edge625" class="edge">
<title>attn_tp1_l15_dp0&#45;&gt;allreduce_l15_dp0</title>
<path fill="none" stroke="black" d="M113218.22,-162.03C113244.24,-171.59 113275.1,-181.23 113304,-185.98 113361.01,-195.35 113506.64,-192.91 113564,-185.98 113600.57,-181.57 113640.05,-172.85 113674.44,-163.91"/>
<polygon fill="black" stroke="black" points="113675.7,-167.2 113684.47,-161.26 113673.91,-160.43 113675.7,-167.2"/>
</g>
<!-- attn_tp2_l15_dp0&#45;&gt;allreduce_l15_dp0 -->
<g id="edge626" class="edge">
<title>attn_tp2_l15_dp0&#45;&gt;allreduce_l15_dp0</title>
<path fill="none" stroke="black" d="M112940.22,-162.03C112966.24,-171.59 112997.1,-181.23 113026,-185.98 113084.98,-195.68 113504.65,-193.15 113564,-185.98 113600.57,-181.57 113640.05,-172.85 113674.44,-163.91"/>
<polygon fill="black" stroke="black" points="113675.7,-167.2 113684.47,-161.26 113673.91,-160.43 113675.7,-167.2"/>
</g>
<!-- attn_tp3_l15_dp0&#45;&gt;allreduce_l15_dp0 -->
<g id="edge627" class="edge">
<title>attn_tp3_l15_dp0&#45;&gt;allreduce_l15_dp0</title>
<path fill="none" stroke="black" d="M112662.22,-162.03C112688.24,-171.59 112719.1,-181.23 112748,-185.98 112792.73,-193.33 113518.99,-191.42 113564,-185.98 113600.57,-181.57 113640.05,-172.85 113674.44,-163.91"/>
<polygon fill="black" stroke="black" points="113675.7,-167.2 113684.47,-161.26 113673.91,-160.43 113675.7,-167.2"/>
</g>
<!-- moe_input_l15_dp0 -->
<g id="node375" class="node">
<title>moe_input_l15_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="114141" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="114141" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L15</text>
<text text-anchor="middle" x="114141" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="114141" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l15_dp0&#45;&gt;moe_input_l15_dp0 -->
<g id="edge628" class="edge">
<title>allreduce_l15_dp0&#45;&gt;moe_input_l15_dp0</title>
<path fill="none" stroke="black" d="M113937.01,-135.98C113945.23,-135.98 113953.44,-135.98 113961.66,-135.98"/>
<polygon fill="black" stroke="black" points="113961.68,-139.48 113971.68,-135.98 113961.68,-132.48 113961.68,-139.48"/>
</g>
<!-- router_l15_dp0 -->
<g id="node376" class="node">
<title>router_l15_dp0</title>
<polygon fill="lightyellow" stroke="black" points="114840.57,-176.98 114446.74,-176.98 114345.43,-94.98 114739.26,-94.98 114840.57,-176.98"/>
<text text-anchor="middle" x="114593" y="-144.48" font-family="Arial" font-size="10.00">Router L15</text>
<text text-anchor="middle" x="114593" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="114593" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l15_dp0&#45;&gt;router_l15_dp0 -->
<g id="edge629" class="edge">
<title>moe_input_l15_dp0&#45;&gt;router_l15_dp0</title>
<path fill="none" stroke="black" d="M114310.06,-135.98C114335.34,-135.98 114360.63,-135.98 114385.92,-135.98"/>
<polygon fill="black" stroke="black" points="114385.99,-139.48 114395.99,-135.98 114385.99,-132.48 114385.99,-139.48"/>
</g>
<!-- expert0_l15_dp0 -->
<g id="node377" class="node">
<title>expert0_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="119086.5,-161.98 118857.5,-161.98 118857.5,-109.98 119086.5,-109.98 119086.5,-161.98"/>
<text text-anchor="middle" x="118972" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L15</text>
<text text-anchor="middle" x="118972" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="118972" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="118972" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert0_l15_dp0 -->
<g id="edge630" class="edge">
<title>router_l15_dp0&#45;&gt;expert0_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114822.12,-161.89C114885.19,-168 114953.67,-173.69 115017,-176.98 115676.46,-211.28 117328.2,-207.43 117988.5,-198.98 118179.55,-196.54 118659.77,-209.77 118848,-176.98 118863.72,-174.24 118880.17,-169.91 118895.76,-165.07"/>
<polygon fill="black" stroke="black" points="118896.89,-168.38 118905.35,-162 118894.76,-161.72 118896.89,-168.38"/>
<text text-anchor="middle" x="117967" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l15_dp0 -->
<g id="node378" class="node">
<title>expert1_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="118839.5,-161.98 118610.5,-161.98 118610.5,-109.98 118839.5,-109.98 118839.5,-161.98"/>
<text text-anchor="middle" x="118725" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L15</text>
<text text-anchor="middle" x="118725" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="118725" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="118725" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert1_l15_dp0 -->
<g id="edge631" class="edge">
<title>router_l15_dp0&#45;&gt;expert1_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114738.67,-176.99C114777.3,-186.08 114819.21,-194.39 114858.5,-198.98 114877.48,-201.2 114882.39,-199.04 114901.5,-198.98 115107.03,-198.37 118398.18,-210.26 118601,-176.98 118616.93,-174.37 118633.6,-170.03 118649.36,-165.14"/>
<polygon fill="black" stroke="black" points="118650.58,-168.42 118659.03,-162.03 118648.44,-161.76 118650.58,-168.42"/>
<text text-anchor="middle" x="114880" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l15_dp0 -->
<g id="node379" class="node">
<title>expert2_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="118592.5,-161.98 118363.5,-161.98 118363.5,-109.98 118592.5,-109.98 118592.5,-161.98"/>
<text text-anchor="middle" x="118478" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L15</text>
<text text-anchor="middle" x="118478" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="118478" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="118478" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert2_l15_dp0 -->
<g id="edge632" class="edge">
<title>router_l15_dp0&#45;&gt;expert2_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114765.37,-177C114810.98,-186.1 114860.37,-194.39 114906.5,-198.98 114925.52,-200.87 114930.39,-199.04 114949.5,-198.98 115138.64,-198.37 118167.36,-207.66 118354,-176.98 118369.93,-174.36 118386.6,-170.03 118402.35,-165.14"/>
<polygon fill="black" stroke="black" points="118403.58,-168.42 118412.03,-162.03 118401.44,-161.75 118403.58,-168.42"/>
<text text-anchor="middle" x="114928" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l15_dp0 -->
<g id="node380" class="node">
<title>expert3_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="118345.5,-161.98 118116.5,-161.98 118116.5,-109.98 118345.5,-109.98 118345.5,-161.98"/>
<text text-anchor="middle" x="118231" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L15</text>
<text text-anchor="middle" x="118231" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="118231" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="118231" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert3_l15_dp0 -->
<g id="edge633" class="edge">
<title>router_l15_dp0&#45;&gt;expert3_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114792.02,-177C114844.62,-186.1 114901.5,-194.4 114954.5,-198.98 114973.54,-200.63 114978.39,-199.05 114997.5,-198.98 115343.01,-197.76 117766.08,-233.12 118107,-176.98 118122.93,-174.36 118139.6,-170.02 118155.35,-165.13"/>
<polygon fill="black" stroke="black" points="118156.58,-168.41 118165.03,-162.02 118154.44,-161.75 118156.58,-168.41"/>
<text text-anchor="middle" x="114976" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l15_dp0 -->
<g id="node381" class="node">
<title>expert4_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="118098.5,-161.98 117869.5,-161.98 117869.5,-109.98 118098.5,-109.98 118098.5,-161.98"/>
<text text-anchor="middle" x="117984" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L15</text>
<text text-anchor="middle" x="117984" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="117984" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="117984" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert4_l15_dp0 -->
<g id="edge634" class="edge">
<title>router_l15_dp0&#45;&gt;expert4_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114821.85,-161.73C114885,-167.85 114953.58,-173.58 115017,-176.98 115477.14,-201.68 116629.74,-205.57 117090.5,-198.98 117432.6,-194.09 117523.02,-236.2 117860,-176.98 117875.63,-174.24 117891.97,-169.93 117907.48,-165.12"/>
<polygon fill="black" stroke="black" points="117908.56,-168.45 117917.02,-162.07 117906.43,-161.78 117908.56,-168.45"/>
<text text-anchor="middle" x="117069" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l15_dp0 -->
<g id="node382" class="node">
<title>expert5_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="117851.5,-161.98 117622.5,-161.98 117622.5,-109.98 117851.5,-109.98 117851.5,-161.98"/>
<text text-anchor="middle" x="117737" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L15</text>
<text text-anchor="middle" x="117737" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="117737" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="117737" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert5_l15_dp0 -->
<g id="edge635" class="edge">
<title>router_l15_dp0&#45;&gt;expert5_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114818.65,-177.01C114878.23,-186.11 114942.61,-194.4 115002.5,-198.98 115021.55,-200.44 115026.39,-199.06 115045.5,-198.98 115330.78,-197.76 117331.54,-223.55 117613,-176.98 117628.93,-174.35 117645.59,-170 117661.35,-165.11"/>
<polygon fill="black" stroke="black" points="117662.58,-168.39 117671.03,-162 117660.44,-161.73 117662.58,-168.39"/>
<text text-anchor="middle" x="115024" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l15_dp0 -->
<g id="node383" class="node">
<title>expert6_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="117604.5,-161.98 117375.5,-161.98 117375.5,-109.98 117604.5,-109.98 117604.5,-161.98"/>
<text text-anchor="middle" x="117490" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L15</text>
<text text-anchor="middle" x="117490" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="117490" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="117490" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert6_l15_dp0 -->
<g id="edge636" class="edge">
<title>router_l15_dp0&#45;&gt;expert6_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114839.89,-176.28C114907.94,-185.66 114981.91,-194.28 115050.5,-198.98 115069.56,-200.29 115074.39,-199.08 115093.5,-198.98 115346.01,-197.76 117116.9,-218.34 117366,-176.98 117381.93,-174.34 117398.59,-169.99 117414.35,-165.1"/>
<polygon fill="black" stroke="black" points="117415.58,-168.38 117424.03,-161.99 117413.44,-161.71 117415.58,-168.38"/>
<text text-anchor="middle" x="115072" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l15_dp0 -->
<g id="node384" class="node">
<title>expert7_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="117357.5,-161.98 117128.5,-161.98 117128.5,-109.98 117357.5,-109.98 117357.5,-161.98"/>
<text text-anchor="middle" x="117243" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L15</text>
<text text-anchor="middle" x="117243" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="117243" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="117243" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert7_l15_dp0 -->
<g id="edge637" class="edge">
<title>router_l15_dp0&#45;&gt;expert7_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114835.08,-172.34C114918.36,-183.2 115012.33,-193.63 115098.5,-198.98 115117.57,-200.17 115122.39,-199.09 115141.5,-198.98 115361.23,-197.76 116902.26,-213.12 117119,-176.98 117134.83,-174.34 117151.4,-170.03 117167.07,-165.16"/>
<polygon fill="black" stroke="black" points="117168.25,-168.46 117176.7,-162.07 117166.11,-161.8 117168.25,-168.46"/>
<text text-anchor="middle" x="115120" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l15_dp0 -->
<g id="node385" class="node">
<title>expert8_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="117110.5,-161.98 116881.5,-161.98 116881.5,-109.98 117110.5,-109.98 117110.5,-161.98"/>
<text text-anchor="middle" x="116996" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L15</text>
<text text-anchor="middle" x="116996" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="116996" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="116996" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert8_l15_dp0 -->
<g id="edge638" class="edge">
<title>router_l15_dp0&#45;&gt;expert8_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114821.32,-161.37C114884.62,-167.51 114953.41,-173.34 115017,-176.98 115578.16,-209.12 115719.51,-209.45 116281.5,-198.98 116544.08,-194.09 116613.53,-223.56 116872,-176.98 116887.37,-174.21 116903.46,-169.96 116918.75,-165.23"/>
<polygon fill="black" stroke="black" points="116920.21,-168.44 116928.67,-162.06 116918.08,-161.77 116920.21,-168.44"/>
<text text-anchor="middle" x="116260" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l15_dp0 -->
<g id="node386" class="node">
<title>expert9_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="116863.5,-161.98 116634.5,-161.98 116634.5,-109.98 116863.5,-109.98 116863.5,-161.98"/>
<text text-anchor="middle" x="116749" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L15</text>
<text text-anchor="middle" x="116749" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="116749" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="116749" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert9_l15_dp0 -->
<g id="edge639" class="edge">
<title>router_l15_dp0&#45;&gt;expert9_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114830.88,-169.04C114928.47,-181.04 115042.7,-193.09 115146.5,-198.98 115310.53,-208.29 116463,-204.35 116625,-176.98 116640.83,-174.31 116657.39,-169.98 116673.06,-165.11"/>
<polygon fill="black" stroke="black" points="116674.24,-168.41 116682.69,-162.02 116672.1,-161.74 116674.24,-168.41"/>
<text text-anchor="middle" x="115168" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l15_dp0 -->
<g id="node387" class="node">
<title>expert10_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="116616.5,-161.98 116387.5,-161.98 116387.5,-109.98 116616.5,-109.98 116616.5,-161.98"/>
<text text-anchor="middle" x="116502" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L15</text>
<text text-anchor="middle" x="116502" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="116502" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="116502" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert10_l15_dp0 -->
<g id="edge640" class="edge">
<title>router_l15_dp0&#45;&gt;expert10_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114827.51,-166.28C114938.54,-179.16 115073.13,-192.64 115194.5,-198.98 115325.84,-205.84 116248.36,-199.14 116378,-176.98 116393.73,-174.29 116410.19,-169.98 116425.78,-165.15"/>
<polygon fill="black" stroke="black" points="116426.9,-168.46 116435.36,-162.08 116424.77,-161.79 116426.9,-168.46"/>
<text text-anchor="middle" x="115216" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l15_dp0 -->
<g id="node388" class="node">
<title>expert11_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="116369.5,-161.98 116140.5,-161.98 116140.5,-109.98 116369.5,-109.98 116369.5,-161.98"/>
<text text-anchor="middle" x="116255" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L15</text>
<text text-anchor="middle" x="116255" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="116255" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="116255" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert11_l15_dp0 -->
<g id="edge641" class="edge">
<title>router_l15_dp0&#45;&gt;expert11_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114824.44,-163.92C114948.26,-177.47 115103.46,-192.26 115242.5,-198.98 115439.77,-208.53 115936.43,-210.92 116131,-176.98 116146.72,-174.24 116163.17,-169.91 116178.76,-165.06"/>
<polygon fill="black" stroke="black" points="116179.89,-168.38 116188.35,-161.99 116177.75,-161.71 116179.89,-168.38"/>
<text text-anchor="middle" x="115264" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l15_dp0 -->
<g id="node389" class="node">
<title>expert12_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="116122.5,-161.98 115893.5,-161.98 115893.5,-109.98 116122.5,-109.98 116122.5,-161.98"/>
<text text-anchor="middle" x="116008" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L15</text>
<text text-anchor="middle" x="116008" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="116008" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="116008" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert12_l15_dp0 -->
<g id="edge642" class="edge">
<title>router_l15_dp0&#45;&gt;expert12_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114824.66,-164.01C115039.25,-186.58 115367.32,-212.5 115652.5,-198.98 115755.74,-194.09 115782.85,-198.23 115884,-176.98 115898.65,-173.9 115914,-169.69 115928.7,-165.12"/>
<polygon fill="black" stroke="black" points="115929.79,-168.45 115938.26,-162.08 115927.67,-161.78 115929.79,-168.45"/>
<text text-anchor="middle" x="115631" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l15_dp0 -->
<g id="node390" class="node">
<title>expert13_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="115875.5,-161.98 115646.5,-161.98 115646.5,-109.98 115875.5,-109.98 115875.5,-161.98"/>
<text text-anchor="middle" x="115761" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L15</text>
<text text-anchor="middle" x="115761" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="115761" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="115761" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert13_l15_dp0 -->
<g id="edge643" class="edge">
<title>router_l15_dp0&#45;&gt;expert13_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114833.38,-176.99C115046.6,-205.92 115365.44,-230.86 115637,-176.98 115651.96,-174.01 115667.62,-169.78 115682.58,-165.14"/>
<polygon fill="black" stroke="black" points="115683.83,-168.41 115692.29,-162.04 115681.7,-161.74 115683.83,-168.41"/>
<text text-anchor="middle" x="115312" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l15_dp0 -->
<g id="node391" class="node">
<title>expert14_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="115628.5,-161.98 115399.5,-161.98 115399.5,-109.98 115628.5,-109.98 115628.5,-161.98"/>
<text text-anchor="middle" x="115514" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L15</text>
<text text-anchor="middle" x="115514" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="115514" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="115514" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert14_l15_dp0 -->
<g id="edge644" class="edge">
<title>router_l15_dp0&#45;&gt;expert14_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114821.45,-161.26C114968.81,-176.09 115164.71,-193.04 115338.5,-198.98 115357.6,-199.64 115362.86,-203.19 115381.5,-198.98 115409.7,-192.62 115438.94,-179.52 115462.75,-166.9"/>
<polygon fill="black" stroke="black" points="115464.48,-169.94 115471.6,-162.1 115461.14,-163.79 115464.48,-169.94"/>
<text text-anchor="middle" x="115360" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l15_dp0 -->
<g id="node392" class="node">
<title>expert15_l15_dp0</title>
<polygon fill="lightgreen" stroke="black" points="115255.5,-161.98 115026.5,-161.98 115026.5,-109.98 115255.5,-109.98 115255.5,-161.98"/>
<text text-anchor="middle" x="115141" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L15</text>
<text text-anchor="middle" x="115141" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="115141" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="115141" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp0&#45;&gt;expert15_l15_dp0 -->
<g id="edge645" class="edge">
<title>router_l15_dp0&#45;&gt;expert15_l15_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M114790.06,-135.98C114865.51,-135.98 114949.43,-135.98 115016.28,-135.98"/>
<polygon fill="black" stroke="black" points="115016.44,-139.48 115026.44,-135.98 115016.44,-132.48 115016.44,-139.48"/>
<text text-anchor="middle" x="114933.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l15_dp0 -->
<g id="node393" class="node">
<title>expert_agg_l15_dp0</title>
<polygon fill="lightyellow" stroke="black" points="119617.57,-176.98 119223.74,-176.98 119122.43,-94.98 119516.26,-94.98 119617.57,-176.98"/>
<text text-anchor="middle" x="119370" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L15</text>
<text text-anchor="middle" x="119370" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="119370" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge646" class="edge">
<title>expert0_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M119086.66,-135.98C119112.06,-135.98 119137.47,-135.98 119162.87,-135.98"/>
<polygon fill="black" stroke="black" points="119162.99,-139.48 119172.99,-135.98 119162.99,-132.48 119162.99,-139.48"/>
</g>
<!-- expert1_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge647" class="edge">
<title>expert1_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M118780.24,-162.02C118803.4,-171.57 118830.96,-181.22 118857,-185.98 118907.06,-195.15 119035.3,-190.41 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert2_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge648" class="edge">
<title>expert2_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M118533.24,-162.02C118556.4,-171.57 118583.96,-181.22 118610,-185.98 118662.02,-195.51 119033.31,-190.59 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert3_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge649" class="edge">
<title>expert3_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M118286.24,-162.02C118309.4,-171.57 118336.96,-181.22 118363,-185.98 118442.02,-200.45 119005.97,-192.97 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert4_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge650" class="edge">
<title>expert4_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M118039.24,-162.02C118062.4,-171.57 118089.96,-181.22 118116,-185.98 118169.01,-195.69 119032.31,-190.67 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert5_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge651" class="edge">
<title>expert5_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M117792.24,-162.02C117815.4,-171.57 117842.96,-181.22 117869,-185.98 117935.5,-198.16 119018.64,-191.87 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert6_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge652" class="edge">
<title>expert6_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M117545.24,-162.02C117568.4,-171.57 117595.96,-181.22 117622,-185.98 117702,-200.63 119004.97,-193.06 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert7_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge653" class="edge">
<title>expert7_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M117298.24,-162.02C117321.4,-171.57 117348.96,-181.22 117375,-185.98 117421.75,-194.54 119038.65,-190.12 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert8_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge654" class="edge">
<title>expert8_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M117051.24,-162.02C117074.4,-171.57 117101.96,-181.22 117128,-185.98 117181.5,-195.78 119031.82,-190.72 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert9_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge655" class="edge">
<title>expert9_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M116804.24,-162.02C116827.4,-171.57 116854.96,-181.22 116881,-185.98 116941.25,-197.01 119024.98,-191.31 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert10_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge656" class="edge">
<title>expert10_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M116557.24,-162.02C116580.4,-171.57 116607.96,-181.22 116634,-185.98 116701,-198.25 119018.15,-191.91 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert11_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge657" class="edge">
<title>expert11_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M116310.24,-162.02C116333.4,-171.57 116360.96,-181.22 116387,-185.98 116460.75,-199.48 119011.31,-192.51 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert12_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge658" class="edge">
<title>expert12_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M116063.24,-162.02C116086.4,-171.57 116113.96,-181.22 116140,-185.98 116220.49,-200.72 119004.48,-193.1 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert13_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge659" class="edge">
<title>expert13_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M115816.24,-162.02C115839.4,-171.57 115866.96,-181.22 115893,-185.98 115936.62,-193.97 119041.82,-189.84 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert14_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge660" class="edge">
<title>expert14_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M115569.24,-162.02C115592.4,-171.57 115619.96,-181.22 115646,-185.98 115693,-194.59 119038.4,-190.14 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- expert15_l15_dp0&#45;&gt;expert_agg_l15_dp0 -->
<g id="edge661" class="edge">
<title>expert15_l15_dp0&#45;&gt;expert_agg_l15_dp0</title>
<path fill="none" stroke="black" d="M115250.49,-162.01C115296.12,-171.59 115349.84,-181.26 115399,-185.98 115500.95,-195.77 118983.97,-194.9 119086,-185.98 119124.11,-182.65 119164.78,-176.86 119203.08,-170.36"/>
<polygon fill="black" stroke="black" points="119204.02,-173.75 119213.29,-168.6 119202.84,-166.85 119204.02,-173.75"/>
</g>
<!-- layer15_output_dp0 -->
<g id="node394" class="node">
<title>layer15_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="119822" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="119822" y="-144.48" font-family="Arial" font-size="10.00">Layer 15 Output</text>
<text text-anchor="middle" x="119822" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="119822" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l15_dp0&#45;&gt;layer15_output_dp0 -->
<g id="edge662" class="edge">
<title>expert_agg_l15_dp0&#45;&gt;layer15_output_dp0</title>
<path fill="none" stroke="black" d="M119567.31,-135.98C119592.49,-135.98 119617.66,-135.98 119642.84,-135.98"/>
<polygon fill="black" stroke="black" points="119642.87,-139.48 119652.87,-135.98 119642.87,-132.48 119642.87,-139.48"/>
</g>
<!-- attn_input_l16_dp0 -->
<g id="node395" class="node">
<title>attn_input_l16_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="120195" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="120195" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L16</text>
<text text-anchor="middle" x="120195" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="120195" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer15_output_dp0&#45;&gt;attn_input_l16_dp0 -->
<g id="edge663" class="edge">
<title>layer15_output_dp0&#45;&gt;attn_input_l16_dp0</title>
<path fill="none" stroke="black" d="M119991.01,-135.98C119999.23,-135.98 120007.44,-135.98 120015.66,-135.98"/>
<polygon fill="black" stroke="black" points="120015.68,-139.48 120025.68,-135.98 120015.68,-132.48 120015.68,-139.48"/>
</g>
<!-- attn_tp0_l16_dp0 -->
<g id="node396" class="node">
<title>attn_tp0_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="121493,-161.98 121233,-161.98 121233,-109.98 121493,-109.98 121493,-161.98"/>
<text text-anchor="middle" x="121363" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L16</text>
<text text-anchor="middle" x="121363" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="121363" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="121363" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp0&#45;&gt;attn_tp0_l16_dp0 -->
<g id="edge664" class="edge">
<title>attn_input_l16_dp0&#45;&gt;attn_tp0_l16_dp0</title>
<path fill="none" stroke="black" d="M120278.52,-161.26C120315.12,-171.09 120358.81,-181.13 120399,-185.98 120444,-191.42 121170.27,-193.33 121215,-185.98 121240.4,-181.81 121267.31,-173.85 121291.12,-165.5"/>
<polygon fill="black" stroke="black" points="121292.55,-168.71 121300.78,-162.03 121290.18,-162.12 121292.55,-168.71"/>
</g>
<!-- attn_tp1_l16_dp0 -->
<g id="node397" class="node">
<title>attn_tp1_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="121215,-161.98 120955,-161.98 120955,-109.98 121215,-109.98 121215,-161.98"/>
<text text-anchor="middle" x="121085" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L16</text>
<text text-anchor="middle" x="121085" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="121085" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="121085" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp0&#45;&gt;attn_tp1_l16_dp0 -->
<g id="edge665" class="edge">
<title>attn_input_l16_dp0&#45;&gt;attn_tp1_l16_dp0</title>
<path fill="none" stroke="black" d="M120278.52,-161.26C120315.12,-171.09 120358.81,-181.13 120399,-185.98 120458.35,-193.15 120878.01,-195.68 120937,-185.98 120962.4,-181.81 120989.31,-173.85 121013.12,-165.5"/>
<polygon fill="black" stroke="black" points="121014.55,-168.71 121022.78,-162.03 121012.18,-162.12 121014.55,-168.71"/>
</g>
<!-- attn_tp2_l16_dp0 -->
<g id="node398" class="node">
<title>attn_tp2_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="120937,-161.98 120677,-161.98 120677,-109.98 120937,-109.98 120937,-161.98"/>
<text text-anchor="middle" x="120807" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L16</text>
<text text-anchor="middle" x="120807" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="120807" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="120807" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp0&#45;&gt;attn_tp2_l16_dp0 -->
<g id="edge666" class="edge">
<title>attn_input_l16_dp0&#45;&gt;attn_tp2_l16_dp0</title>
<path fill="none" stroke="black" d="M120278.52,-161.26C120315.12,-171.09 120358.81,-181.13 120399,-185.98 120456.36,-192.91 120601.99,-195.35 120659,-185.98 120684.4,-181.81 120711.31,-173.85 120735.12,-165.5"/>
<polygon fill="black" stroke="black" points="120736.55,-168.71 120744.78,-162.03 120734.18,-162.12 120736.55,-168.71"/>
</g>
<!-- attn_tp3_l16_dp0 -->
<g id="node399" class="node">
<title>attn_tp3_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="120659,-161.98 120399,-161.98 120399,-109.98 120659,-109.98 120659,-161.98"/>
<text text-anchor="middle" x="120529" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L16</text>
<text text-anchor="middle" x="120529" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="120529" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="120529" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp0&#45;&gt;attn_tp3_l16_dp0 -->
<g id="edge667" class="edge">
<title>attn_input_l16_dp0&#45;&gt;attn_tp3_l16_dp0</title>
<path fill="none" stroke="black" d="M120364.28,-135.98C120372.35,-135.98 120380.42,-135.98 120388.49,-135.98"/>
<polygon fill="black" stroke="black" points="120388.7,-139.48 120398.7,-135.98 120388.7,-132.48 120388.7,-139.48"/>
</g>
<!-- allreduce_l16_dp0 -->
<g id="node400" class="node">
<title>allreduce_l16_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="121697" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="121697" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L16</text>
<text text-anchor="middle" x="121697" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="121697" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l16_dp0&#45;&gt;allreduce_l16_dp0 -->
<g id="edge668" class="edge">
<title>attn_tp0_l16_dp0&#45;&gt;allreduce_l16_dp0</title>
<path fill="none" stroke="black" d="M121493.14,-135.98C121501.35,-135.98 121509.56,-135.98 121517.77,-135.98"/>
<polygon fill="black" stroke="black" points="121517.78,-139.48 121527.78,-135.98 121517.78,-132.48 121517.78,-139.48"/>
</g>
<!-- attn_tp1_l16_dp0&#45;&gt;allreduce_l16_dp0 -->
<g id="edge669" class="edge">
<title>attn_tp1_l16_dp0&#45;&gt;allreduce_l16_dp0</title>
<path fill="none" stroke="black" d="M121147.22,-162.03C121173.24,-171.59 121204.1,-181.23 121233,-185.98 121290.01,-195.35 121435.64,-192.91 121493,-185.98 121529.57,-181.57 121569.05,-172.85 121603.44,-163.91"/>
<polygon fill="black" stroke="black" points="121604.7,-167.2 121613.47,-161.26 121602.91,-160.43 121604.7,-167.2"/>
</g>
<!-- attn_tp2_l16_dp0&#45;&gt;allreduce_l16_dp0 -->
<g id="edge670" class="edge">
<title>attn_tp2_l16_dp0&#45;&gt;allreduce_l16_dp0</title>
<path fill="none" stroke="black" d="M120869.22,-162.03C120895.24,-171.59 120926.1,-181.23 120955,-185.98 121013.98,-195.68 121433.65,-193.15 121493,-185.98 121529.57,-181.57 121569.05,-172.85 121603.44,-163.91"/>
<polygon fill="black" stroke="black" points="121604.7,-167.2 121613.47,-161.26 121602.91,-160.43 121604.7,-167.2"/>
</g>
<!-- attn_tp3_l16_dp0&#45;&gt;allreduce_l16_dp0 -->
<g id="edge671" class="edge">
<title>attn_tp3_l16_dp0&#45;&gt;allreduce_l16_dp0</title>
<path fill="none" stroke="black" d="M120591.22,-162.03C120617.24,-171.59 120648.1,-181.23 120677,-185.98 120721.73,-193.33 121447.99,-191.42 121493,-185.98 121529.57,-181.57 121569.05,-172.85 121603.44,-163.91"/>
<polygon fill="black" stroke="black" points="121604.7,-167.2 121613.47,-161.26 121602.91,-160.43 121604.7,-167.2"/>
</g>
<!-- moe_input_l16_dp0 -->
<g id="node401" class="node">
<title>moe_input_l16_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="122070" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="122070" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L16</text>
<text text-anchor="middle" x="122070" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="122070" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l16_dp0&#45;&gt;moe_input_l16_dp0 -->
<g id="edge672" class="edge">
<title>allreduce_l16_dp0&#45;&gt;moe_input_l16_dp0</title>
<path fill="none" stroke="black" d="M121866.01,-135.98C121874.23,-135.98 121882.44,-135.98 121890.66,-135.98"/>
<polygon fill="black" stroke="black" points="121890.68,-139.48 121900.68,-135.98 121890.68,-132.48 121890.68,-139.48"/>
</g>
<!-- router_l16_dp0 -->
<g id="node402" class="node">
<title>router_l16_dp0</title>
<polygon fill="lightyellow" stroke="black" points="122769.57,-176.98 122375.74,-176.98 122274.43,-94.98 122668.26,-94.98 122769.57,-176.98"/>
<text text-anchor="middle" x="122522" y="-144.48" font-family="Arial" font-size="10.00">Router L16</text>
<text text-anchor="middle" x="122522" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="122522" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l16_dp0&#45;&gt;router_l16_dp0 -->
<g id="edge673" class="edge">
<title>moe_input_l16_dp0&#45;&gt;router_l16_dp0</title>
<path fill="none" stroke="black" d="M122239.06,-135.98C122264.34,-135.98 122289.63,-135.98 122314.92,-135.98"/>
<polygon fill="black" stroke="black" points="122314.99,-139.48 122324.99,-135.98 122314.99,-132.48 122314.99,-139.48"/>
</g>
<!-- expert0_l16_dp0 -->
<g id="node403" class="node">
<title>expert0_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="126967.5,-161.98 126738.5,-161.98 126738.5,-109.98 126967.5,-109.98 126967.5,-161.98"/>
<text text-anchor="middle" x="126853" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L16</text>
<text text-anchor="middle" x="126853" y="-138.98" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="126853" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="126853" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert0_l16_dp0 -->
<g id="edge674" class="edge">
<title>router_l16_dp0&#45;&gt;expert0_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122753.05,-163.45C122808.32,-168.97 122867.19,-173.99 122922,-176.98 123640.61,-216.16 125440.82,-196.54 126160.5,-198.98 126413.35,-199.84 126480.25,-222.4 126729,-176.98 126744.37,-174.18 126760.45,-169.91 126775.74,-165.17"/>
<polygon fill="black" stroke="black" points="126777.2,-168.38 126785.66,-162 126775.07,-161.71 126777.2,-168.38"/>
<text text-anchor="middle" x="126182" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l16_dp0 -->
<g id="node404" class="node">
<title>expert1_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="126720.5,-161.98 126491.5,-161.98 126491.5,-109.98 126720.5,-109.98 126720.5,-161.98"/>
<text text-anchor="middle" x="126606" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L16</text>
<text text-anchor="middle" x="126606" y="-138.98" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="126606" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="126606" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert1_l16_dp0 -->
<g id="edge675" class="edge">
<title>router_l16_dp0&#45;&gt;expert1_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122752.79,-163.37C122808.14,-168.9 122867.11,-173.95 122922,-176.98 123524.77,-210.28 125034.86,-206.85 125638.5,-198.98 125825.99,-196.54 126297.28,-209.21 126482,-176.98 126497.72,-174.24 126514.17,-169.91 126529.76,-165.06"/>
<polygon fill="black" stroke="black" points="126530.89,-168.38 126539.35,-161.99 126528.75,-161.71 126530.89,-168.38"/>
<text text-anchor="middle" x="125617" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l16_dp0 -->
<g id="node405" class="node">
<title>expert2_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="126473.5,-161.98 126244.5,-161.98 126244.5,-109.98 126473.5,-109.98 126473.5,-161.98"/>
<text text-anchor="middle" x="126359" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L16</text>
<text text-anchor="middle" x="126359" y="-138.98" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="126359" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="126359" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert2_l16_dp0 -->
<g id="edge676" class="edge">
<title>router_l16_dp0&#45;&gt;expert2_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122667.67,-176.99C122706.3,-186.08 122748.21,-194.39 122787.5,-198.98 122806.48,-201.2 122811.39,-199.04 122830.5,-198.98 123019.64,-198.37 126048.36,-207.66 126235,-176.98 126250.93,-174.36 126267.6,-170.03 126283.35,-165.14"/>
<polygon fill="black" stroke="black" points="126284.58,-168.42 126293.03,-162.03 126282.44,-161.75 126284.58,-168.42"/>
<text text-anchor="middle" x="122809" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l16_dp0 -->
<g id="node406" class="node">
<title>expert3_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="126226.5,-161.98 125997.5,-161.98 125997.5,-109.98 126226.5,-109.98 126226.5,-161.98"/>
<text text-anchor="middle" x="126112" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L16</text>
<text text-anchor="middle" x="126112" y="-138.98" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="126112" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="126112" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert3_l16_dp0 -->
<g id="edge677" class="edge">
<title>router_l16_dp0&#45;&gt;expert3_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122694.37,-177C122739.98,-186.1 122789.37,-194.39 122835.5,-198.98 122854.52,-200.87 122859.39,-199.05 122878.5,-198.98 123224.01,-197.76 125647.08,-233.12 125988,-176.98 126003.93,-174.36 126020.6,-170.02 126036.35,-165.13"/>
<polygon fill="black" stroke="black" points="126037.58,-168.41 126046.03,-162.02 126035.44,-161.75 126037.58,-168.41"/>
<text text-anchor="middle" x="122857" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l16_dp0 -->
<g id="node407" class="node">
<title>expert4_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="125979.5,-161.98 125750.5,-161.98 125750.5,-109.98 125979.5,-109.98 125979.5,-161.98"/>
<text text-anchor="middle" x="125865" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L16</text>
<text text-anchor="middle" x="125865" y="-138.98" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="125865" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="125865" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert4_l16_dp0 -->
<g id="edge678" class="edge">
<title>router_l16_dp0&#45;&gt;expert4_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122721.02,-177C122773.62,-186.1 122830.5,-194.4 122883.5,-198.98 122902.54,-200.63 122907.39,-199.06 122926.5,-198.98 123239.23,-197.76 125432.44,-227.91 125741,-176.98 125756.93,-174.35 125773.6,-170.01 125789.35,-165.12"/>
<polygon fill="black" stroke="black" points="125790.58,-168.4 125799.03,-162.01 125788.44,-161.74 125790.58,-168.4"/>
<text text-anchor="middle" x="122905" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l16_dp0 -->
<g id="node408" class="node">
<title>expert5_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="125732.5,-161.98 125503.5,-161.98 125503.5,-109.98 125732.5,-109.98 125732.5,-161.98"/>
<text text-anchor="middle" x="125618" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L16</text>
<text text-anchor="middle" x="125618" y="-138.98" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="125618" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="125618" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert5_l16_dp0 -->
<g id="edge679" class="edge">
<title>router_l16_dp0&#45;&gt;expert5_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122752.54,-163.18C122807.96,-168.73 122867.03,-173.83 122922,-176.98 123328.81,-200.28 124348.07,-205.05 124755.5,-198.98 125083.83,-194.09 125170.62,-234.01 125494,-176.98 125509.62,-174.23 125525.97,-169.91 125541.48,-165.1"/>
<polygon fill="black" stroke="black" points="125542.56,-168.43 125551.01,-162.05 125540.42,-161.77 125542.56,-168.43"/>
<text text-anchor="middle" x="124734" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l16_dp0 -->
<g id="node409" class="node">
<title>expert6_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="125485.5,-161.98 125256.5,-161.98 125256.5,-109.98 125485.5,-109.98 125485.5,-161.98"/>
<text text-anchor="middle" x="125371" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L16</text>
<text text-anchor="middle" x="125371" y="-138.98" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="125371" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="125371" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert6_l16_dp0 -->
<g id="edge680" class="edge">
<title>router_l16_dp0&#45;&gt;expert6_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122747.65,-177.01C122807.23,-186.11 122871.61,-194.4 122931.5,-198.98 122950.55,-200.44 122955.39,-199.08 122974.5,-198.98 123227.01,-197.76 124997.9,-218.34 125247,-176.98 125262.93,-174.34 125279.59,-169.99 125295.35,-165.1"/>
<polygon fill="black" stroke="black" points="125296.58,-168.38 125305.03,-161.99 125294.44,-161.71 125296.58,-168.38"/>
<text text-anchor="middle" x="122953" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l16_dp0 -->
<g id="node410" class="node">
<title>expert7_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="125238.5,-161.98 125009.5,-161.98 125009.5,-109.98 125238.5,-109.98 125238.5,-161.98"/>
<text text-anchor="middle" x="125124" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L16</text>
<text text-anchor="middle" x="125124" y="-138.98" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="125124" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="125124" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert7_l16_dp0 -->
<g id="edge681" class="edge">
<title>router_l16_dp0&#45;&gt;expert7_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122768.89,-176.28C122836.94,-185.66 122910.91,-194.28 122979.5,-198.98 122998.56,-200.29 123003.39,-199.09 123022.5,-198.98 123242.23,-197.76 124783.26,-213.12 125000,-176.98 125015.83,-174.34 125032.4,-170.03 125048.07,-165.16"/>
<polygon fill="black" stroke="black" points="125049.25,-168.46 125057.7,-162.07 125047.11,-161.8 125049.25,-168.46"/>
<text text-anchor="middle" x="123001" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l16_dp0 -->
<g id="node411" class="node">
<title>expert8_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="124991.5,-161.98 124762.5,-161.98 124762.5,-109.98 124991.5,-109.98 124991.5,-161.98"/>
<text text-anchor="middle" x="124877" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L16</text>
<text text-anchor="middle" x="124877" y="-138.98" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="124877" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="124877" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert8_l16_dp0 -->
<g id="edge682" class="edge">
<title>router_l16_dp0&#45;&gt;expert8_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122764.08,-172.34C122847.36,-183.2 122941.33,-193.63 123027.5,-198.98 123218.87,-210.86 124563.9,-208.7 124753,-176.98 124768.83,-174.33 124785.39,-170 124801.07,-165.14"/>
<polygon fill="black" stroke="black" points="124802.24,-168.44 124810.7,-162.05 124800.11,-161.77 124802.24,-168.44"/>
<text text-anchor="middle" x="123049" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l16_dp0 -->
<g id="node412" class="node">
<title>expert9_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="124744.5,-161.98 124515.5,-161.98 124515.5,-109.98 124744.5,-109.98 124744.5,-161.98"/>
<text text-anchor="middle" x="124630" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L16</text>
<text text-anchor="middle" x="124630" y="-138.98" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="124630" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="124630" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert9_l16_dp0 -->
<g id="edge683" class="edge">
<title>router_l16_dp0&#45;&gt;expert9_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122752.03,-162.76C122807.61,-168.34 122866.87,-173.56 122922,-176.98 123390.31,-206.02 123508.39,-208.74 123977.5,-198.98 124212.54,-194.09 124274.72,-219.18 124506,-176.98 124521.37,-174.18 124537.45,-169.91 124552.74,-165.18"/>
<polygon fill="black" stroke="black" points="124554.2,-168.38 124562.66,-162.01 124552.07,-161.72 124554.2,-168.38"/>
<text text-anchor="middle" x="123956" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l16_dp0 -->
<g id="node413" class="node">
<title>expert10_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="124497.5,-161.98 124268.5,-161.98 124268.5,-109.98 124497.5,-109.98 124497.5,-161.98"/>
<text text-anchor="middle" x="124383" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L16</text>
<text text-anchor="middle" x="124383" y="-138.98" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="124383" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="124383" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert10_l16_dp0 -->
<g id="edge684" class="edge">
<title>router_l16_dp0&#45;&gt;expert10_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122759.88,-169.04C122857.47,-181.04 122971.7,-193.09 123075.5,-198.98 123206.81,-206.43 124129.36,-199.14 124259,-176.98 124274.73,-174.29 124291.19,-169.98 124306.78,-165.15"/>
<polygon fill="black" stroke="black" points="124307.9,-168.46 124316.36,-162.08 124305.77,-161.79 124307.9,-168.46"/>
<text text-anchor="middle" x="123097" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l16_dp0 -->
<g id="node414" class="node">
<title>expert11_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="124250.5,-161.98 124021.5,-161.98 124021.5,-109.98 124250.5,-109.98 124250.5,-161.98"/>
<text text-anchor="middle" x="124136" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L16</text>
<text text-anchor="middle" x="124136" y="-138.98" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="124136" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="124136" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert11_l16_dp0 -->
<g id="edge685" class="edge">
<title>router_l16_dp0&#45;&gt;expert11_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122756.51,-166.28C122867.54,-179.16 123002.13,-192.64 123123.5,-198.98 123320.73,-209.28 123817.43,-210.92 124012,-176.98 124027.72,-174.24 124044.17,-169.91 124059.76,-165.06"/>
<polygon fill="black" stroke="black" points="124060.89,-168.38 124069.35,-161.99 124058.75,-161.71 124060.89,-168.38"/>
<text text-anchor="middle" x="123145" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l16_dp0 -->
<g id="node415" class="node">
<title>expert12_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="124003.5,-161.98 123774.5,-161.98 123774.5,-109.98 124003.5,-109.98 124003.5,-161.98"/>
<text text-anchor="middle" x="123889" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L16</text>
<text text-anchor="middle" x="123889" y="-138.98" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="123889" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="123889" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert12_l16_dp0 -->
<g id="edge686" class="edge">
<title>router_l16_dp0&#45;&gt;expert12_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122748.29,-159.74C122805,-165.54 122865.71,-171.62 122922,-176.98 122922,-176.98 123765,-176.98 123765,-176.98 123780.37,-174.19 123796.45,-169.93 123811.75,-165.2"/>
<polygon fill="black" stroke="black" points="123813.21,-168.41 123821.67,-162.03 123811.08,-161.74 123813.21,-168.41"/>
<text text-anchor="middle" x="123193" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l16_dp0 -->
<g id="node416" class="node">
<title>expert13_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="123756.5,-161.98 123527.5,-161.98 123527.5,-109.98 123756.5,-109.98 123756.5,-161.98"/>
<text text-anchor="middle" x="123642" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L16</text>
<text text-anchor="middle" x="123642" y="-138.98" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="123642" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="123642" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert13_l16_dp0 -->
<g id="edge687" class="edge">
<title>router_l16_dp0&#45;&gt;expert13_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122768.61,-176.06C122946.88,-199.52 123193.36,-220.67 123409.5,-198.98 123460.66,-193.85 123516.31,-179.11 123560.33,-165.18"/>
<polygon fill="black" stroke="black" points="123561.66,-168.43 123570.11,-162.04 123559.52,-161.77 123561.66,-168.43"/>
<text text-anchor="middle" x="123388" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l16_dp0 -->
<g id="node417" class="node">
<title>expert14_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="123509.5,-161.98 123280.5,-161.98 123280.5,-109.98 123509.5,-109.98 123509.5,-161.98"/>
<text text-anchor="middle" x="123395" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L16</text>
<text text-anchor="middle" x="123395" y="-138.98" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="123395" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="123395" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert14_l16_dp0 -->
<g id="edge688" class="edge">
<title>router_l16_dp0&#45;&gt;expert14_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122752.52,-163.01C122888.24,-177.37 123063.37,-193.22 123219.5,-198.98 123238.6,-199.69 123243.86,-203.19 123262.5,-198.98 123290.7,-192.62 123319.94,-179.52 123343.75,-166.9"/>
<polygon fill="black" stroke="black" points="123345.48,-169.94 123352.6,-162.1 123342.14,-163.79 123345.48,-169.94"/>
<text text-anchor="middle" x="123241" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l16_dp0 -->
<g id="node418" class="node">
<title>expert15_l16_dp0</title>
<polygon fill="lightgreen" stroke="black" points="123160.5,-161.98 122931.5,-161.98 122931.5,-109.98 123160.5,-109.98 123160.5,-161.98"/>
<text text-anchor="middle" x="123046" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L16</text>
<text text-anchor="middle" x="123046" y="-138.98" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="123046" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="123046" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp0&#45;&gt;expert15_l16_dp0 -->
<g id="edge689" class="edge">
<title>router_l16_dp0&#45;&gt;expert15_l16_dp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M122718.98,-135.98C122786.75,-135.98 122860.72,-135.98 122921.14,-135.98"/>
<polygon fill="black" stroke="black" points="122921.49,-139.48 122931.49,-135.98 122921.49,-132.48 122921.49,-139.48"/>
<text text-anchor="middle" x="122850.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l16_dp0 -->
<g id="node419" class="node">
<title>expert_agg_l16_dp0</title>
<polygon fill="lightyellow" stroke="black" points="127498.57,-176.98 127104.74,-176.98 127003.43,-94.98 127397.26,-94.98 127498.57,-176.98"/>
<text text-anchor="middle" x="127251" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L16</text>
<text text-anchor="middle" x="127251" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="127251" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge690" class="edge">
<title>expert0_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M126967.66,-135.98C126993.06,-135.98 127018.47,-135.98 127043.87,-135.98"/>
<polygon fill="black" stroke="black" points="127043.99,-139.48 127053.99,-135.98 127043.99,-132.48 127043.99,-139.48"/>
</g>
<!-- expert1_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge691" class="edge">
<title>expert1_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M126661.24,-162.02C126684.4,-171.57 126711.96,-181.22 126738,-185.98 126788.06,-195.15 126916.3,-190.41 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert2_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge692" class="edge">
<title>expert2_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M126414.24,-162.02C126437.4,-171.57 126464.96,-181.22 126491,-185.98 126543.02,-195.51 126914.31,-190.59 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert3_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge693" class="edge">
<title>expert3_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M126167.24,-162.02C126190.4,-171.57 126217.96,-181.22 126244,-185.98 126323.02,-200.45 126886.97,-192.97 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert4_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge694" class="edge">
<title>expert4_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M125920.24,-162.02C125943.4,-171.57 125970.96,-181.22 125997,-185.98 126050.01,-195.69 126913.31,-190.67 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert5_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge695" class="edge">
<title>expert5_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M125673.24,-162.02C125696.4,-171.57 125723.96,-181.22 125750,-185.98 125816.5,-198.16 126899.64,-191.87 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert6_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge696" class="edge">
<title>expert6_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M125426.24,-162.02C125449.4,-171.57 125476.96,-181.22 125503,-185.98 125583,-200.63 126885.97,-193.06 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert7_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge697" class="edge">
<title>expert7_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M125179.24,-162.02C125202.4,-171.57 125229.96,-181.22 125256,-185.98 125302.75,-194.54 126919.65,-190.12 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert8_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge698" class="edge">
<title>expert8_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M124932.24,-162.02C124955.4,-171.57 124982.96,-181.22 125009,-185.98 125062.5,-195.78 126912.82,-190.72 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert9_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge699" class="edge">
<title>expert9_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M124685.24,-162.02C124708.4,-171.57 124735.96,-181.22 124762,-185.98 124822.25,-197.01 126905.98,-191.31 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert10_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge700" class="edge">
<title>expert10_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M124438.24,-162.02C124461.4,-171.57 124488.96,-181.22 124515,-185.98 124582,-198.25 126899.15,-191.91 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert11_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge701" class="edge">
<title>expert11_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M124191.24,-162.02C124214.4,-171.57 124241.96,-181.22 124268,-185.98 124341.75,-199.48 126892.31,-192.51 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert12_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge702" class="edge">
<title>expert12_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M123944.24,-162.02C123967.4,-171.57 123994.96,-181.22 124021,-185.98 124101.49,-200.72 126885.48,-193.1 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert13_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge703" class="edge">
<title>expert13_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M123697.24,-162.02C123720.4,-171.57 123747.96,-181.22 123774,-185.98 123817.62,-193.97 126922.82,-189.84 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert14_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge704" class="edge">
<title>expert14_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M123450.24,-162.02C123473.4,-171.57 123500.96,-181.22 123527,-185.98 123574,-194.59 126919.4,-190.14 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- expert15_l16_dp0&#45;&gt;expert_agg_l16_dp0 -->
<g id="edge705" class="edge">
<title>expert15_l16_dp0&#45;&gt;expert_agg_l16_dp0</title>
<path fill="none" stroke="black" d="M123145.17,-162C123186.54,-171.59 123235.28,-181.26 123280,-185.98 123381.85,-196.74 126864.97,-194.9 126967,-185.98 127005.11,-182.65 127045.78,-176.86 127084.08,-170.36"/>
<polygon fill="black" stroke="black" points="127085.02,-173.75 127094.29,-168.6 127083.84,-166.85 127085.02,-173.75"/>
</g>
<!-- layer16_output_dp0 -->
<g id="node420" class="node">
<title>layer16_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="127703" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="127703" y="-144.48" font-family="Arial" font-size="10.00">Layer 16 Output</text>
<text text-anchor="middle" x="127703" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="127703" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l16_dp0&#45;&gt;layer16_output_dp0 -->
<g id="edge706" class="edge">
<title>expert_agg_l16_dp0&#45;&gt;layer16_output_dp0</title>
<path fill="none" stroke="black" d="M127448.31,-135.98C127473.49,-135.98 127498.66,-135.98 127523.84,-135.98"/>
<polygon fill="black" stroke="black" points="127523.87,-139.48 127533.87,-135.98 127523.87,-132.48 127523.87,-139.48"/>
</g>
<!-- stage2_output_dp0 -->
<g id="node421" class="node">
<title>stage2_output_dp0</title>
<ellipse fill="lightblue" stroke="black" cx="128076" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="128076" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Output</text>
<text text-anchor="middle" x="128076" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="128076" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer16_output_dp0&#45;&gt;stage2_output_dp0 -->
<g id="edge707" class="edge">
<title>layer16_output_dp0&#45;&gt;stage2_output_dp0</title>
<path fill="none" stroke="black" d="M127872.01,-135.98C127880.23,-135.98 127888.44,-135.98 127896.66,-135.98"/>
<polygon fill="black" stroke="black" points="127896.68,-139.48 127906.68,-135.98 127896.68,-132.48 127896.68,-139.48"/>
</g>
<!-- output -->
<g id="node1682" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="316072" cy="-28.99" rx="169" ry="28.98"/>
<text text-anchor="middle" x="316072" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="316072" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=4, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="316072" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=4, seq_len=1024, hidden=512]</text>
</g>
<!-- stage2_output_dp0&#45;&gt;output -->
<g id="edge2829" class="edge">
<title>stage2_output_dp0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M128164.08,-111.15C128192.55,-104.54 128224.41,-98.27 128254,-94.98 128890.5,-24.24 309401.38,-29.76 315892.63,-29.99"/>
<polygon fill="black" stroke="black" points="315892.89,-33.48 315902.89,-29.99 315892.89,-26.48 315892.89,-33.48"/>
</g>
<!-- stage1_input_dp1 -->
<g id="node422" class="node">
<title>stage1_input_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="128432" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="128432" y="-144.48" font-family="Arial" font-size="10.00">Stage1 Input</text>
<text text-anchor="middle" x="128432" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="128432" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_input_l1_dp1 -->
<g id="node423" class="node">
<title>attn_input_l1_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="128805" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="128805" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L1</text>
<text text-anchor="middle" x="128805" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="128805" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_input_dp1&#45;&gt;attn_input_l1_dp1 -->
<g id="edge708" class="edge">
<title>stage1_input_dp1&#45;&gt;attn_input_l1_dp1</title>
<path fill="none" stroke="black" d="M128601.01,-135.98C128609.23,-135.98 128617.44,-135.98 128625.66,-135.98"/>
<polygon fill="black" stroke="black" points="128625.68,-139.48 128635.68,-135.98 128625.68,-132.48 128625.68,-139.48"/>
</g>
<!-- attn_tp0_l1_dp1 -->
<g id="node424" class="node">
<title>attn_tp0_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="130103,-161.98 129843,-161.98 129843,-109.98 130103,-109.98 130103,-161.98"/>
<text text-anchor="middle" x="129973" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L1</text>
<text text-anchor="middle" x="129973" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="129973" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="129973" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp1&#45;&gt;attn_tp0_l1_dp1 -->
<g id="edge709" class="edge">
<title>attn_input_l1_dp1&#45;&gt;attn_tp0_l1_dp1</title>
<path fill="none" stroke="black" d="M128888.52,-161.26C128925.12,-171.09 128968.81,-181.13 129009,-185.98 129054,-191.42 129780.27,-193.33 129825,-185.98 129850.4,-181.81 129877.31,-173.85 129901.12,-165.5"/>
<polygon fill="black" stroke="black" points="129902.55,-168.71 129910.78,-162.03 129900.18,-162.12 129902.55,-168.71"/>
</g>
<!-- attn_tp1_l1_dp1 -->
<g id="node425" class="node">
<title>attn_tp1_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="129825,-161.98 129565,-161.98 129565,-109.98 129825,-109.98 129825,-161.98"/>
<text text-anchor="middle" x="129695" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L1</text>
<text text-anchor="middle" x="129695" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="129695" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="129695" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp1&#45;&gt;attn_tp1_l1_dp1 -->
<g id="edge710" class="edge">
<title>attn_input_l1_dp1&#45;&gt;attn_tp1_l1_dp1</title>
<path fill="none" stroke="black" d="M128888.52,-161.26C128925.12,-171.09 128968.81,-181.13 129009,-185.98 129068.35,-193.15 129488.01,-195.68 129547,-185.98 129572.4,-181.81 129599.31,-173.85 129623.12,-165.5"/>
<polygon fill="black" stroke="black" points="129624.55,-168.71 129632.78,-162.03 129622.18,-162.12 129624.55,-168.71"/>
</g>
<!-- attn_tp2_l1_dp1 -->
<g id="node426" class="node">
<title>attn_tp2_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="129547,-161.98 129287,-161.98 129287,-109.98 129547,-109.98 129547,-161.98"/>
<text text-anchor="middle" x="129417" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L1</text>
<text text-anchor="middle" x="129417" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="129417" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="129417" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp1&#45;&gt;attn_tp2_l1_dp1 -->
<g id="edge711" class="edge">
<title>attn_input_l1_dp1&#45;&gt;attn_tp2_l1_dp1</title>
<path fill="none" stroke="black" d="M128888.52,-161.26C128925.12,-171.09 128968.81,-181.13 129009,-185.98 129066.36,-192.91 129211.99,-195.35 129269,-185.98 129294.4,-181.81 129321.31,-173.85 129345.12,-165.5"/>
<polygon fill="black" stroke="black" points="129346.55,-168.71 129354.78,-162.03 129344.18,-162.12 129346.55,-168.71"/>
</g>
<!-- attn_tp3_l1_dp1 -->
<g id="node427" class="node">
<title>attn_tp3_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="129269,-161.98 129009,-161.98 129009,-109.98 129269,-109.98 129269,-161.98"/>
<text text-anchor="middle" x="129139" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L1</text>
<text text-anchor="middle" x="129139" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="129139" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="129139" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp1&#45;&gt;attn_tp3_l1_dp1 -->
<g id="edge712" class="edge">
<title>attn_input_l1_dp1&#45;&gt;attn_tp3_l1_dp1</title>
<path fill="none" stroke="black" d="M128974.28,-135.98C128982.35,-135.98 128990.42,-135.98 128998.49,-135.98"/>
<polygon fill="black" stroke="black" points="128998.7,-139.48 129008.7,-135.98 128998.7,-132.48 128998.7,-139.48"/>
</g>
<!-- allreduce_l1_dp1 -->
<g id="node428" class="node">
<title>allreduce_l1_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="130307" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="130307" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L1</text>
<text text-anchor="middle" x="130307" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="130307" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l1_dp1&#45;&gt;allreduce_l1_dp1 -->
<g id="edge713" class="edge">
<title>attn_tp0_l1_dp1&#45;&gt;allreduce_l1_dp1</title>
<path fill="none" stroke="black" d="M130103.14,-135.98C130111.35,-135.98 130119.56,-135.98 130127.77,-135.98"/>
<polygon fill="black" stroke="black" points="130127.78,-139.48 130137.78,-135.98 130127.78,-132.48 130127.78,-139.48"/>
</g>
<!-- attn_tp1_l1_dp1&#45;&gt;allreduce_l1_dp1 -->
<g id="edge714" class="edge">
<title>attn_tp1_l1_dp1&#45;&gt;allreduce_l1_dp1</title>
<path fill="none" stroke="black" d="M129757.22,-162.03C129783.24,-171.59 129814.1,-181.23 129843,-185.98 129900.01,-195.35 130045.64,-192.91 130103,-185.98 130139.57,-181.57 130179.05,-172.85 130213.44,-163.91"/>
<polygon fill="black" stroke="black" points="130214.7,-167.2 130223.47,-161.26 130212.91,-160.43 130214.7,-167.2"/>
</g>
<!-- attn_tp2_l1_dp1&#45;&gt;allreduce_l1_dp1 -->
<g id="edge715" class="edge">
<title>attn_tp2_l1_dp1&#45;&gt;allreduce_l1_dp1</title>
<path fill="none" stroke="black" d="M129479.22,-162.03C129505.24,-171.59 129536.1,-181.23 129565,-185.98 129623.98,-195.68 130043.65,-193.15 130103,-185.98 130139.57,-181.57 130179.05,-172.85 130213.44,-163.91"/>
<polygon fill="black" stroke="black" points="130214.7,-167.2 130223.47,-161.26 130212.91,-160.43 130214.7,-167.2"/>
</g>
<!-- attn_tp3_l1_dp1&#45;&gt;allreduce_l1_dp1 -->
<g id="edge716" class="edge">
<title>attn_tp3_l1_dp1&#45;&gt;allreduce_l1_dp1</title>
<path fill="none" stroke="black" d="M129201.22,-162.03C129227.24,-171.59 129258.1,-181.23 129287,-185.98 129331.73,-193.33 130057.99,-191.42 130103,-185.98 130139.57,-181.57 130179.05,-172.85 130213.44,-163.91"/>
<polygon fill="black" stroke="black" points="130214.7,-167.2 130223.47,-161.26 130212.91,-160.43 130214.7,-167.2"/>
</g>
<!-- moe_input_l1_dp1 -->
<g id="node429" class="node">
<title>moe_input_l1_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="130680" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="130680" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L1</text>
<text text-anchor="middle" x="130680" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="130680" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l1_dp1&#45;&gt;moe_input_l1_dp1 -->
<g id="edge717" class="edge">
<title>allreduce_l1_dp1&#45;&gt;moe_input_l1_dp1</title>
<path fill="none" stroke="black" d="M130476.01,-135.98C130484.23,-135.98 130492.44,-135.98 130500.66,-135.98"/>
<polygon fill="black" stroke="black" points="130500.68,-139.48 130510.68,-135.98 130500.68,-132.48 130500.68,-139.48"/>
</g>
<!-- router_l1_dp1 -->
<g id="node430" class="node">
<title>router_l1_dp1</title>
<polygon fill="lightyellow" stroke="black" points="131379.57,-176.98 130985.74,-176.98 130884.43,-94.98 131278.26,-94.98 131379.57,-176.98"/>
<text text-anchor="middle" x="131132" y="-144.48" font-family="Arial" font-size="10.00">Router L1</text>
<text text-anchor="middle" x="131132" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="131132" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l1_dp1&#45;&gt;router_l1_dp1 -->
<g id="edge718" class="edge">
<title>moe_input_l1_dp1&#45;&gt;router_l1_dp1</title>
<path fill="none" stroke="black" d="M130849.06,-135.98C130874.34,-135.98 130899.63,-135.98 130924.92,-135.98"/>
<polygon fill="black" stroke="black" points="130924.99,-139.48 130934.99,-135.98 130924.99,-132.48 130924.99,-139.48"/>
</g>
<!-- expert0_l1_dp1 -->
<g id="node431" class="node">
<title>expert0_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="135433.5,-161.98 135204.5,-161.98 135204.5,-109.98 135433.5,-109.98 135433.5,-161.98"/>
<text text-anchor="middle" x="135319" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L1</text>
<text text-anchor="middle" x="135319" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="135319" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="135319" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert0_l1_dp1 -->
<g id="edge719" class="edge">
<title>router_l1_dp1&#45;&gt;expert0_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.95,-169.07C131400.21,-172.29 131430.79,-175.07 131460,-176.98 132205.86,-225.87 134076.04,-196.54 134823.5,-198.98 134988.9,-199.52 135032.67,-208.72 135195,-176.98 135210.06,-174.04 135225.82,-169.78 135240.86,-165.12"/>
<polygon fill="black" stroke="black" points="135242.17,-168.38 135250.63,-162.01 135240.04,-161.71 135242.17,-168.38"/>
<text text-anchor="middle" x="134845" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l1_dp1 -->
<g id="node432" class="node">
<title>expert1_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="135186.5,-161.98 134957.5,-161.98 134957.5,-109.98 135186.5,-109.98 135186.5,-161.98"/>
<text text-anchor="middle" x="135072" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L1</text>
<text text-anchor="middle" x="135072" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="135072" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="135072" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert1_l1_dp1 -->
<g id="edge720" class="edge">
<title>router_l1_dp1&#45;&gt;expert1_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.95,-169.04C131400.21,-172.27 131430.79,-175.06 131460,-176.98 132124.24,-220.79 133789.82,-196.54 134455.5,-198.98 134674.6,-199.79 134732.59,-217.1 134948,-176.98 134963.27,-174.14 134979.24,-169.88 134994.45,-165.17"/>
<polygon fill="black" stroke="black" points="134995.86,-168.4 135004.32,-162.02 134993.73,-161.73 134995.86,-168.4"/>
<text text-anchor="middle" x="134477" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l1_dp1 -->
<g id="node433" class="node">
<title>expert2_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="134939.5,-161.98 134710.5,-161.98 134710.5,-109.98 134939.5,-109.98 134939.5,-161.98"/>
<text text-anchor="middle" x="134825" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L1</text>
<text text-anchor="middle" x="134825" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="134825" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="134825" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert2_l1_dp1 -->
<g id="edge721" class="edge">
<title>router_l1_dp1&#45;&gt;expert2_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131277.67,-176.99C131316.3,-186.08 131358.21,-194.39 131397.5,-198.98 131416.48,-201.2 131421.39,-199.05 131440.5,-198.98 131802.78,-197.76 134343.52,-235.79 134701,-176.98 134716.93,-174.36 134733.6,-170.03 134749.35,-165.13"/>
<polygon fill="black" stroke="black" points="134750.58,-168.41 134759.03,-162.02 134748.44,-161.75 134750.58,-168.41"/>
<text text-anchor="middle" x="131419" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l1_dp1 -->
<g id="node434" class="node">
<title>expert3_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="134692.5,-161.98 134463.5,-161.98 134463.5,-109.98 134692.5,-109.98 134692.5,-161.98"/>
<text text-anchor="middle" x="134578" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L1</text>
<text text-anchor="middle" x="134578" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="134578" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="134578" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert3_l1_dp1 -->
<g id="edge722" class="edge">
<title>router_l1_dp1&#45;&gt;expert3_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.95,-169C131400.21,-172.24 131430.8,-175.04 131460,-176.98 132015.79,-214.03 133409.48,-196.54 133966.5,-198.98 134183.38,-199.93 134240.79,-216.75 134454,-176.98 134469.27,-174.14 134485.24,-169.88 134500.45,-165.17"/>
<polygon fill="black" stroke="black" points="134501.86,-168.39 134510.32,-162.01 134499.73,-161.72 134501.86,-168.39"/>
<text text-anchor="middle" x="133988" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l1_dp1 -->
<g id="node435" class="node">
<title>expert4_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="134445.5,-161.98 134216.5,-161.98 134216.5,-109.98 134445.5,-109.98 134445.5,-161.98"/>
<text text-anchor="middle" x="134331" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L1</text>
<text text-anchor="middle" x="134331" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="134331" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="134331" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert4_l1_dp1 -->
<g id="edge723" class="edge">
<title>router_l1_dp1&#45;&gt;expert4_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131304.37,-177C131349.98,-186.1 131399.37,-194.39 131445.5,-198.98 131464.52,-200.87 131469.39,-199.06 131488.5,-198.98 131790.56,-197.76 133908.97,-226.21 134207,-176.98 134222.93,-174.35 134239.6,-170.01 134255.35,-165.12"/>
<polygon fill="black" stroke="black" points="134256.58,-168.4 134265.03,-162.01 134254.44,-161.73 134256.58,-168.4"/>
<text text-anchor="middle" x="131467" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l1_dp1 -->
<g id="node436" class="node">
<title>expert5_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="134198.5,-161.98 133969.5,-161.98 133969.5,-109.98 134198.5,-109.98 134198.5,-161.98"/>
<text text-anchor="middle" x="134084" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L1</text>
<text text-anchor="middle" x="134084" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="134084" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="134084" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert5_l1_dp1 -->
<g id="edge724" class="edge">
<title>router_l1_dp1&#45;&gt;expert5_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.96,-168.95C131400.21,-172.19 131430.8,-175.01 131460,-176.98 132357.33,-237.75 132584.13,-194.09 133483.5,-198.98 133695.5,-200.14 133751.61,-215.98 133960,-176.98 133975.26,-174.13 133991.24,-169.86 134006.45,-165.15"/>
<polygon fill="black" stroke="black" points="134007.86,-168.37 134016.32,-162 134005.73,-161.71 134007.86,-168.37"/>
<text text-anchor="middle" x="133505" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l1_dp1 -->
<g id="node437" class="node">
<title>expert6_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="133951.5,-161.98 133722.5,-161.98 133722.5,-109.98 133951.5,-109.98 133951.5,-161.98"/>
<text text-anchor="middle" x="133837" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L1</text>
<text text-anchor="middle" x="133837" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="133837" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="133837" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert6_l1_dp1 -->
<g id="edge725" class="edge">
<title>router_l1_dp1&#45;&gt;expert6_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131331.02,-177C131383.62,-186.1 131440.5,-194.4 131493.5,-198.98 131512.54,-200.63 131517.39,-199.08 131536.5,-198.98 131778.34,-197.76 133474.43,-216.64 133713,-176.98 133728.84,-174.35 133745.4,-170.04 133761.07,-165.18"/>
<polygon fill="black" stroke="black" points="133762.25,-168.47 133770.7,-162.09 133760.11,-161.81 133762.25,-168.47"/>
<text text-anchor="middle" x="131515" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l1_dp1 -->
<g id="node438" class="node">
<title>expert7_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="133704.5,-161.98 133475.5,-161.98 133475.5,-109.98 133704.5,-109.98 133704.5,-161.98"/>
<text text-anchor="middle" x="133590" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L1</text>
<text text-anchor="middle" x="133590" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="133590" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="133590" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert7_l1_dp1 -->
<g id="edge726" class="edge">
<title>router_l1_dp1&#45;&gt;expert7_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.52,-168.8C131399.92,-172.08 131430.66,-174.95 131460,-176.98 131813.52,-201.51 132700.26,-208.45 133054.5,-198.98 133237.58,-194.09 133286.02,-210.92 133466,-176.98 133481.17,-174.12 133497.04,-169.88 133512.17,-165.2"/>
<polygon fill="black" stroke="black" points="133513.52,-168.44 133521.99,-162.07 133511.4,-161.77 133513.52,-168.44"/>
<text text-anchor="middle" x="133033" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l1_dp1 -->
<g id="node439" class="node">
<title>expert8_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="133457.5,-161.98 133228.5,-161.98 133228.5,-109.98 133457.5,-109.98 133457.5,-161.98"/>
<text text-anchor="middle" x="133343" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L1</text>
<text text-anchor="middle" x="133343" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="133343" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="133343" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert8_l1_dp1 -->
<g id="edge727" class="edge">
<title>router_l1_dp1&#45;&gt;expert8_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131357.65,-177.01C131417.23,-186.11 131481.61,-194.4 131541.5,-198.98 131560.55,-200.44 131565.39,-199.11 131584.5,-198.98 131766.12,-197.76 133039.88,-207.07 133219,-176.98 133234.83,-174.32 133251.39,-170 133267.07,-165.13"/>
<polygon fill="black" stroke="black" points="133268.24,-168.43 133276.7,-162.04 133266.1,-161.77 133268.24,-168.43"/>
<text text-anchor="middle" x="131563" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l1_dp1 -->
<g id="node440" class="node">
<title>expert9_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="133210.5,-161.98 132981.5,-161.98 132981.5,-109.98 133210.5,-109.98 133210.5,-161.98"/>
<text text-anchor="middle" x="133096" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L1</text>
<text text-anchor="middle" x="133096" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="133096" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="133096" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert9_l1_dp1 -->
<g id="edge728" class="edge">
<title>router_l1_dp1&#45;&gt;expert9_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.53,-168.64C131399.93,-171.95 131430.66,-174.86 131460,-176.98 131966.99,-213.64 132095.41,-214.14 132603.5,-198.98 132767.49,-194.09 132810.87,-207.88 132972,-176.98 132987.16,-174.08 133003.03,-169.81 133018.15,-165.12"/>
<polygon fill="black" stroke="black" points="133019.51,-168.37 133027.97,-161.99 133017.38,-161.7 133019.51,-168.37"/>
<text text-anchor="middle" x="132582" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l1_dp1 -->
<g id="node441" class="node">
<title>expert10_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="132963.5,-161.98 132734.5,-161.98 132734.5,-109.98 132963.5,-109.98 132963.5,-161.98"/>
<text text-anchor="middle" x="132849" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L1</text>
<text text-anchor="middle" x="132849" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="132849" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="132849" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert10_l1_dp1 -->
<g id="edge729" class="edge">
<title>router_l1_dp1&#45;&gt;expert10_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131378.89,-176.28C131446.94,-185.66 131520.91,-194.28 131589.5,-198.98 131715.39,-207.61 132600.62,-198.3 132725,-176.98 132740.73,-174.29 132757.18,-169.97 132772.78,-165.14"/>
<polygon fill="black" stroke="black" points="132773.9,-168.45 132782.36,-162.07 132771.77,-161.78 132773.9,-168.45"/>
<text text-anchor="middle" x="131611" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l1_dp1 -->
<g id="node442" class="node">
<title>expert11_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="132716.5,-161.98 132487.5,-161.98 132487.5,-109.98 132716.5,-109.98 132716.5,-161.98"/>
<text text-anchor="middle" x="132602" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L1</text>
<text text-anchor="middle" x="132602" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="132602" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="132602" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert11_l1_dp1 -->
<g id="edge730" class="edge">
<title>router_l1_dp1&#45;&gt;expert11_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131369.11,-168.26C131399.65,-171.64 131430.53,-174.68 131460,-176.98 131786.48,-202.51 131869.27,-211.75 132196.5,-198.98 132321.9,-194.09 132354.97,-201.75 132478,-176.98 132492.86,-173.99 132508.42,-169.77 132523.29,-165.16"/>
<polygon fill="black" stroke="black" points="132524.48,-168.45 132532.95,-162.08 132522.36,-161.78 132524.48,-168.45"/>
<text text-anchor="middle" x="132175" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l1_dp1 -->
<g id="node443" class="node">
<title>expert12_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="132469.5,-161.98 132240.5,-161.98 132240.5,-109.98 132469.5,-109.98 132469.5,-161.98"/>
<text text-anchor="middle" x="132355" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L1</text>
<text text-anchor="middle" x="132355" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="132355" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="132355" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert12_l1_dp1 -->
<g id="edge731" class="edge">
<title>router_l1_dp1&#45;&gt;expert12_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131364.93,-165.13C131396.87,-169.12 131429.25,-173.15 131460,-176.98 131460,-176.98 132231,-176.98 132231,-176.98 132246.37,-174.19 132262.45,-169.93 132277.75,-165.2"/>
<polygon fill="black" stroke="black" points="132279.21,-168.41 132287.67,-162.03 132277.08,-161.74 132279.21,-168.41"/>
<text text-anchor="middle" x="131659" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l1_dp1 -->
<g id="node444" class="node">
<title>expert13_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="132222.5,-161.98 131993.5,-161.98 131993.5,-109.98 132222.5,-109.98 132222.5,-161.98"/>
<text text-anchor="middle" x="132108" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L1</text>
<text text-anchor="middle" x="132108" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="132108" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="132108" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert13_l1_dp1 -->
<g id="edge732" class="edge">
<title>router_l1_dp1&#45;&gt;expert13_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131359.54,-177.02C131506.8,-198.21 131702.62,-216.33 131875.5,-198.98 131926.66,-193.85 131982.31,-179.11 132026.33,-165.18"/>
<polygon fill="black" stroke="black" points="132027.66,-168.43 132036.11,-162.04 132025.52,-161.77 132027.66,-168.43"/>
<text text-anchor="middle" x="131854" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l1_dp1 -->
<g id="node445" class="node">
<title>expert14_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="131975.5,-161.98 131746.5,-161.98 131746.5,-109.98 131975.5,-109.98 131975.5,-161.98"/>
<text text-anchor="middle" x="131861" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L1</text>
<text text-anchor="middle" x="131861" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="131861" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="131861" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert14_l1_dp1 -->
<g id="edge733" class="edge">
<title>router_l1_dp1&#45;&gt;expert14_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131371.4,-177C131506.73,-197.08 131661.84,-214.02 131728.5,-198.98 131756.7,-192.62 131785.94,-179.52 131809.75,-166.9"/>
<polygon fill="black" stroke="black" points="131811.48,-169.94 131818.6,-162.1 131808.14,-163.79 131811.48,-169.94"/>
<text text-anchor="middle" x="131707" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l1_dp1 -->
<g id="node446" class="node">
<title>expert15_l1_dp1</title>
<polygon fill="lightgreen" stroke="black" points="131698.5,-161.98 131469.5,-161.98 131469.5,-109.98 131698.5,-109.98 131698.5,-161.98"/>
<text text-anchor="middle" x="131584" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L1</text>
<text text-anchor="middle" x="131584" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="131584" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="131584" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp1&#45;&gt;expert15_l1_dp1 -->
<g id="edge734" class="edge">
<title>router_l1_dp1&#45;&gt;expert15_l1_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M131328.94,-135.98C131373.13,-135.98 131418.83,-135.98 131459.12,-135.98"/>
<polygon fill="black" stroke="black" points="131459.25,-139.48 131469.25,-135.98 131459.25,-132.48 131459.25,-139.48"/>
<text text-anchor="middle" x="131424.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l1_dp1 -->
<g id="node447" class="node">
<title>expert_agg_l1_dp1</title>
<polygon fill="lightyellow" stroke="black" points="135964.57,-176.98 135570.74,-176.98 135469.43,-94.98 135863.26,-94.98 135964.57,-176.98"/>
<text text-anchor="middle" x="135717" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L1</text>
<text text-anchor="middle" x="135717" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="135717" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge735" class="edge">
<title>expert0_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M135433.66,-135.98C135459.06,-135.98 135484.47,-135.98 135509.87,-135.98"/>
<polygon fill="black" stroke="black" points="135509.99,-139.48 135519.99,-135.98 135509.99,-132.48 135509.99,-139.48"/>
</g>
<!-- expert1_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge736" class="edge">
<title>expert1_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M135127.24,-162.02C135150.4,-171.57 135177.96,-181.22 135204,-185.98 135254.06,-195.15 135382.3,-190.41 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert2_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge737" class="edge">
<title>expert2_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M134880.24,-162.02C134903.4,-171.57 134930.96,-181.22 134957,-185.98 135009.02,-195.51 135380.31,-190.59 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert3_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge738" class="edge">
<title>expert3_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M134633.24,-162.02C134656.4,-171.57 134683.96,-181.22 134710,-185.98 134789.02,-200.45 135352.97,-192.97 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert4_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge739" class="edge">
<title>expert4_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M134386.24,-162.02C134409.4,-171.57 134436.96,-181.22 134463,-185.98 134516.01,-195.69 135379.31,-190.67 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert5_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge740" class="edge">
<title>expert5_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M134139.24,-162.02C134162.4,-171.57 134189.96,-181.22 134216,-185.98 134282.5,-198.16 135365.64,-191.87 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert6_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge741" class="edge">
<title>expert6_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M133892.24,-162.02C133915.4,-171.57 133942.96,-181.22 133969,-185.98 134049,-200.63 135351.97,-193.06 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert7_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge742" class="edge">
<title>expert7_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M133645.24,-162.02C133668.4,-171.57 133695.96,-181.22 133722,-185.98 133768.75,-194.54 135385.65,-190.12 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert8_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge743" class="edge">
<title>expert8_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M133398.24,-162.02C133421.4,-171.57 133448.96,-181.22 133475,-185.98 133528.5,-195.78 135378.82,-190.72 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert9_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge744" class="edge">
<title>expert9_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M133151.24,-162.02C133174.4,-171.57 133201.96,-181.22 133228,-185.98 133288.25,-197.01 135371.98,-191.31 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert10_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge745" class="edge">
<title>expert10_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M132904.24,-162.02C132927.4,-171.57 132954.96,-181.22 132981,-185.98 133048,-198.25 135365.15,-191.91 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert11_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge746" class="edge">
<title>expert11_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M132657.24,-162.02C132680.4,-171.57 132707.96,-181.22 132734,-185.98 132807.75,-199.48 135358.31,-192.51 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert12_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge747" class="edge">
<title>expert12_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M132410.24,-162.02C132433.4,-171.57 132460.96,-181.22 132487,-185.98 132567.49,-200.72 135351.48,-193.1 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert13_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge748" class="edge">
<title>expert13_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M132163.24,-162.02C132186.4,-171.57 132213.96,-181.22 132240,-185.98 132283.62,-193.97 135388.82,-189.84 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert14_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge749" class="edge">
<title>expert14_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M131916.24,-162.02C131939.4,-171.57 131966.96,-181.22 131993,-185.98 132040,-194.59 135385.4,-190.14 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- expert15_l1_dp1&#45;&gt;expert_agg_l1_dp1 -->
<g id="edge750" class="edge">
<title>expert15_l1_dp1&#45;&gt;expert_agg_l1_dp1</title>
<path fill="none" stroke="black" d="M131652.31,-162.04C131680.82,-171.6 131714.57,-181.24 131746,-185.98 131796.63,-193.62 135381.98,-190.44 135433,-185.98 135471.11,-182.65 135511.78,-176.86 135550.08,-170.36"/>
<polygon fill="black" stroke="black" points="135551.02,-173.75 135560.29,-168.6 135549.84,-166.85 135551.02,-173.75"/>
</g>
<!-- layer1_output_dp1 -->
<g id="node448" class="node">
<title>layer1_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="136169" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="136169" y="-144.48" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="136169" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="136169" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l1_dp1&#45;&gt;layer1_output_dp1 -->
<g id="edge751" class="edge">
<title>expert_agg_l1_dp1&#45;&gt;layer1_output_dp1</title>
<path fill="none" stroke="black" d="M135914.31,-135.98C135939.49,-135.98 135964.66,-135.98 135989.84,-135.98"/>
<polygon fill="black" stroke="black" points="135989.87,-139.48 135999.87,-135.98 135989.87,-132.48 135989.87,-139.48"/>
</g>
<!-- attn_input_l2_dp1 -->
<g id="node449" class="node">
<title>attn_input_l2_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="136542" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="136542" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L2</text>
<text text-anchor="middle" x="136542" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="136542" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer1_output_dp1&#45;&gt;attn_input_l2_dp1 -->
<g id="edge752" class="edge">
<title>layer1_output_dp1&#45;&gt;attn_input_l2_dp1</title>
<path fill="none" stroke="black" d="M136338.01,-135.98C136346.23,-135.98 136354.44,-135.98 136362.66,-135.98"/>
<polygon fill="black" stroke="black" points="136362.68,-139.48 136372.68,-135.98 136362.68,-132.48 136362.68,-139.48"/>
</g>
<!-- attn_tp0_l2_dp1 -->
<g id="node450" class="node">
<title>attn_tp0_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="137840,-161.98 137580,-161.98 137580,-109.98 137840,-109.98 137840,-161.98"/>
<text text-anchor="middle" x="137710" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L2</text>
<text text-anchor="middle" x="137710" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="137710" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="137710" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp1&#45;&gt;attn_tp0_l2_dp1 -->
<g id="edge753" class="edge">
<title>attn_input_l2_dp1&#45;&gt;attn_tp0_l2_dp1</title>
<path fill="none" stroke="black" d="M136625.52,-161.26C136662.12,-171.09 136705.81,-181.13 136746,-185.98 136791,-191.42 137517.27,-193.33 137562,-185.98 137587.4,-181.81 137614.31,-173.85 137638.12,-165.5"/>
<polygon fill="black" stroke="black" points="137639.55,-168.71 137647.78,-162.03 137637.18,-162.12 137639.55,-168.71"/>
</g>
<!-- attn_tp1_l2_dp1 -->
<g id="node451" class="node">
<title>attn_tp1_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="137562,-161.98 137302,-161.98 137302,-109.98 137562,-109.98 137562,-161.98"/>
<text text-anchor="middle" x="137432" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L2</text>
<text text-anchor="middle" x="137432" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="137432" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="137432" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp1&#45;&gt;attn_tp1_l2_dp1 -->
<g id="edge754" class="edge">
<title>attn_input_l2_dp1&#45;&gt;attn_tp1_l2_dp1</title>
<path fill="none" stroke="black" d="M136625.52,-161.26C136662.12,-171.09 136705.81,-181.13 136746,-185.98 136805.35,-193.15 137225.01,-195.68 137284,-185.98 137309.4,-181.81 137336.31,-173.85 137360.12,-165.5"/>
<polygon fill="black" stroke="black" points="137361.55,-168.71 137369.78,-162.03 137359.18,-162.12 137361.55,-168.71"/>
</g>
<!-- attn_tp2_l2_dp1 -->
<g id="node452" class="node">
<title>attn_tp2_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="137284,-161.98 137024,-161.98 137024,-109.98 137284,-109.98 137284,-161.98"/>
<text text-anchor="middle" x="137154" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L2</text>
<text text-anchor="middle" x="137154" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="137154" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="137154" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp1&#45;&gt;attn_tp2_l2_dp1 -->
<g id="edge755" class="edge">
<title>attn_input_l2_dp1&#45;&gt;attn_tp2_l2_dp1</title>
<path fill="none" stroke="black" d="M136625.52,-161.26C136662.12,-171.09 136705.81,-181.13 136746,-185.98 136803.36,-192.91 136948.99,-195.35 137006,-185.98 137031.4,-181.81 137058.31,-173.85 137082.12,-165.5"/>
<polygon fill="black" stroke="black" points="137083.55,-168.71 137091.78,-162.03 137081.18,-162.12 137083.55,-168.71"/>
</g>
<!-- attn_tp3_l2_dp1 -->
<g id="node453" class="node">
<title>attn_tp3_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="137006,-161.98 136746,-161.98 136746,-109.98 137006,-109.98 137006,-161.98"/>
<text text-anchor="middle" x="136876" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L2</text>
<text text-anchor="middle" x="136876" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="136876" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="136876" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp1&#45;&gt;attn_tp3_l2_dp1 -->
<g id="edge756" class="edge">
<title>attn_input_l2_dp1&#45;&gt;attn_tp3_l2_dp1</title>
<path fill="none" stroke="black" d="M136711.28,-135.98C136719.35,-135.98 136727.42,-135.98 136735.49,-135.98"/>
<polygon fill="black" stroke="black" points="136735.7,-139.48 136745.7,-135.98 136735.7,-132.48 136735.7,-139.48"/>
</g>
<!-- allreduce_l2_dp1 -->
<g id="node454" class="node">
<title>allreduce_l2_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="138044" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="138044" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L2</text>
<text text-anchor="middle" x="138044" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="138044" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l2_dp1&#45;&gt;allreduce_l2_dp1 -->
<g id="edge757" class="edge">
<title>attn_tp0_l2_dp1&#45;&gt;allreduce_l2_dp1</title>
<path fill="none" stroke="black" d="M137840.14,-135.98C137848.35,-135.98 137856.56,-135.98 137864.77,-135.98"/>
<polygon fill="black" stroke="black" points="137864.78,-139.48 137874.78,-135.98 137864.78,-132.48 137864.78,-139.48"/>
</g>
<!-- attn_tp1_l2_dp1&#45;&gt;allreduce_l2_dp1 -->
<g id="edge758" class="edge">
<title>attn_tp1_l2_dp1&#45;&gt;allreduce_l2_dp1</title>
<path fill="none" stroke="black" d="M137494.22,-162.03C137520.24,-171.59 137551.1,-181.23 137580,-185.98 137637.01,-195.35 137782.64,-192.91 137840,-185.98 137876.57,-181.57 137916.05,-172.85 137950.44,-163.91"/>
<polygon fill="black" stroke="black" points="137951.7,-167.2 137960.47,-161.26 137949.91,-160.43 137951.7,-167.2"/>
</g>
<!-- attn_tp2_l2_dp1&#45;&gt;allreduce_l2_dp1 -->
<g id="edge759" class="edge">
<title>attn_tp2_l2_dp1&#45;&gt;allreduce_l2_dp1</title>
<path fill="none" stroke="black" d="M137216.22,-162.03C137242.24,-171.59 137273.1,-181.23 137302,-185.98 137360.98,-195.68 137780.65,-193.15 137840,-185.98 137876.57,-181.57 137916.05,-172.85 137950.44,-163.91"/>
<polygon fill="black" stroke="black" points="137951.7,-167.2 137960.47,-161.26 137949.91,-160.43 137951.7,-167.2"/>
</g>
<!-- attn_tp3_l2_dp1&#45;&gt;allreduce_l2_dp1 -->
<g id="edge760" class="edge">
<title>attn_tp3_l2_dp1&#45;&gt;allreduce_l2_dp1</title>
<path fill="none" stroke="black" d="M136938.22,-162.03C136964.24,-171.59 136995.1,-181.23 137024,-185.98 137068.73,-193.33 137794.99,-191.42 137840,-185.98 137876.57,-181.57 137916.05,-172.85 137950.44,-163.91"/>
<polygon fill="black" stroke="black" points="137951.7,-167.2 137960.47,-161.26 137949.91,-160.43 137951.7,-167.2"/>
</g>
<!-- moe_input_l2_dp1 -->
<g id="node455" class="node">
<title>moe_input_l2_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="138417" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="138417" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L2</text>
<text text-anchor="middle" x="138417" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="138417" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l2_dp1&#45;&gt;moe_input_l2_dp1 -->
<g id="edge761" class="edge">
<title>allreduce_l2_dp1&#45;&gt;moe_input_l2_dp1</title>
<path fill="none" stroke="black" d="M138213.01,-135.98C138221.23,-135.98 138229.44,-135.98 138237.66,-135.98"/>
<polygon fill="black" stroke="black" points="138237.68,-139.48 138247.68,-135.98 138237.68,-132.48 138237.68,-139.48"/>
</g>
<!-- router_l2_dp1 -->
<g id="node456" class="node">
<title>router_l2_dp1</title>
<polygon fill="lightyellow" stroke="black" points="139116.57,-176.98 138722.74,-176.98 138621.43,-94.98 139015.26,-94.98 139116.57,-176.98"/>
<text text-anchor="middle" x="138869" y="-144.48" font-family="Arial" font-size="10.00">Router L2</text>
<text text-anchor="middle" x="138869" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="138869" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l2_dp1&#45;&gt;router_l2_dp1 -->
<g id="edge762" class="edge">
<title>moe_input_l2_dp1&#45;&gt;router_l2_dp1</title>
<path fill="none" stroke="black" d="M138586.06,-135.98C138611.34,-135.98 138636.63,-135.98 138661.92,-135.98"/>
<polygon fill="black" stroke="black" points="138661.99,-139.48 138671.99,-135.98 138661.99,-132.48 138661.99,-139.48"/>
</g>
<!-- expert0_l2_dp1 -->
<g id="node457" class="node">
<title>expert0_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="143170.5,-161.98 142941.5,-161.98 142941.5,-109.98 143170.5,-109.98 143170.5,-161.98"/>
<text text-anchor="middle" x="143056" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L2</text>
<text text-anchor="middle" x="143056" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="143056" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="143056" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert0_l2_dp1 -->
<g id="edge763" class="edge">
<title>router_l2_dp1&#45;&gt;expert0_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.95,-169.07C139137.21,-172.29 139167.79,-175.07 139197,-176.98 139956.17,-226.7 141859.71,-196.54 142620.5,-198.98 142759.29,-199.43 142795.99,-204.63 142932,-176.98 142946.85,-173.96 142962.41,-169.72 142977.28,-165.11"/>
<polygon fill="black" stroke="black" points="142978.48,-168.4 142986.94,-162.03 142976.35,-161.73 142978.48,-168.4"/>
<text text-anchor="middle" x="142642" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l2_dp1 -->
<g id="node458" class="node">
<title>expert1_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="142923.5,-161.98 142694.5,-161.98 142694.5,-109.98 142923.5,-109.98 142923.5,-161.98"/>
<text text-anchor="middle" x="142809" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L2</text>
<text text-anchor="middle" x="142809" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="142809" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="142809" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert1_l2_dp1 -->
<g id="edge764" class="edge">
<title>router_l2_dp1&#45;&gt;expert1_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.95,-169.05C139137.21,-172.28 139167.79,-175.06 139197,-176.98 139888.08,-222.46 141620.93,-196.54 142313.5,-198.98 142478.9,-199.57 142522.67,-208.72 142685,-176.98 142700.06,-174.04 142715.82,-169.78 142730.86,-165.12"/>
<polygon fill="black" stroke="black" points="142732.17,-168.38 142740.63,-162.01 142730.04,-161.71 142732.17,-168.38"/>
<text text-anchor="middle" x="142335" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l2_dp1 -->
<g id="node459" class="node">
<title>expert2_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="142676.5,-161.98 142447.5,-161.98 142447.5,-109.98 142676.5,-109.98 142676.5,-161.98"/>
<text text-anchor="middle" x="142562" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L2</text>
<text text-anchor="middle" x="142562" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="142562" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="142562" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert2_l2_dp1 -->
<g id="edge765" class="edge">
<title>router_l2_dp1&#45;&gt;expert2_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.95,-169.03C139137.21,-172.26 139167.79,-175.05 139197,-176.98 139806.68,-217.39 141335.48,-196.54 141946.5,-198.98 142165.16,-199.86 142223.03,-217.03 142438,-176.98 142453.27,-174.14 142469.24,-169.88 142484.45,-165.17"/>
<polygon fill="black" stroke="black" points="142485.86,-168.4 142494.32,-162.02 142483.73,-161.73 142485.86,-168.4"/>
<text text-anchor="middle" x="141968" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l2_dp1 -->
<g id="node460" class="node">
<title>expert3_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="142429.5,-161.98 142200.5,-161.98 142200.5,-109.98 142429.5,-109.98 142429.5,-161.98"/>
<text text-anchor="middle" x="142315" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L2</text>
<text text-anchor="middle" x="142315" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="142315" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="142315" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert3_l2_dp1 -->
<g id="edge766" class="edge">
<title>router_l2_dp1&#45;&gt;expert3_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139014.67,-176.99C139053.3,-186.08 139095.21,-194.39 139134.5,-198.98 139153.48,-201.2 139158.39,-199.05 139177.5,-198.98 139512.34,-197.76 141860.61,-231.42 142191,-176.98 142206.93,-174.36 142223.6,-170.02 142239.35,-165.13"/>
<polygon fill="black" stroke="black" points="142240.58,-168.41 142249.03,-162.02 142238.44,-161.74 142240.58,-168.41"/>
<text text-anchor="middle" x="139156" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l2_dp1 -->
<g id="node461" class="node">
<title>expert4_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="142182.5,-161.98 141953.5,-161.98 141953.5,-109.98 142182.5,-109.98 142182.5,-161.98"/>
<text text-anchor="middle" x="142068" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L2</text>
<text text-anchor="middle" x="142068" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="142068" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="142068" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert4_l2_dp1 -->
<g id="edge767" class="edge">
<title>router_l2_dp1&#45;&gt;expert4_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.95,-168.98C139137.21,-172.22 139167.8,-175.02 139197,-176.98 139698.67,-210.66 140956.7,-196.54 141459.5,-198.98 141675.05,-200.03 141732.1,-216.54 141944,-176.98 141959.27,-174.13 141975.24,-169.87 141990.45,-165.16"/>
<polygon fill="black" stroke="black" points="141991.86,-168.39 142000.32,-162.01 141989.73,-161.72 141991.86,-168.39"/>
<text text-anchor="middle" x="141481" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l2_dp1 -->
<g id="node462" class="node">
<title>expert5_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="141935.5,-161.98 141706.5,-161.98 141706.5,-109.98 141935.5,-109.98 141935.5,-161.98"/>
<text text-anchor="middle" x="141821" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L2</text>
<text text-anchor="middle" x="141821" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="141821" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="141821" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert5_l2_dp1 -->
<g id="edge768" class="edge">
<title>router_l2_dp1&#45;&gt;expert5_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139041.37,-177C139086.98,-186.1 139136.37,-194.39 139182.5,-198.98 139201.52,-200.87 139206.39,-199.07 139225.5,-198.98 139500.12,-197.76 141426.07,-221.85 141697,-176.98 141712.93,-174.34 141729.59,-170 141745.35,-165.11"/>
<polygon fill="black" stroke="black" points="141746.58,-168.39 141755.03,-162 141744.44,-161.72 141746.58,-168.39"/>
<text text-anchor="middle" x="139204" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l2_dp1 -->
<g id="node463" class="node">
<title>expert6_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="141688.5,-161.98 141459.5,-161.98 141459.5,-109.98 141688.5,-109.98 141688.5,-161.98"/>
<text text-anchor="middle" x="141574" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L2</text>
<text text-anchor="middle" x="141574" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="141574" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="141574" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert6_l2_dp1 -->
<g id="edge769" class="edge">
<title>router_l2_dp1&#45;&gt;expert6_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.96,-168.9C139137.22,-172.15 139167.8,-174.98 139197,-176.98 139601.75,-204.69 140616.94,-209.41 141022.5,-198.98 141212.69,-194.09 141263.01,-212.05 141450,-176.98 141465.26,-174.12 141481.24,-169.85 141496.45,-165.14"/>
<polygon fill="black" stroke="black" points="141497.85,-168.37 141506.32,-161.99 141495.73,-161.7 141497.85,-168.37"/>
<text text-anchor="middle" x="141001" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l2_dp1 -->
<g id="node464" class="node">
<title>expert7_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="141441.5,-161.98 141212.5,-161.98 141212.5,-109.98 141441.5,-109.98 141441.5,-161.98"/>
<text text-anchor="middle" x="141327" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L2</text>
<text text-anchor="middle" x="141327" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="141327" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="141327" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert7_l2_dp1 -->
<g id="edge770" class="edge">
<title>router_l2_dp1&#45;&gt;expert7_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139068.02,-177C139120.62,-186.1 139177.5,-194.4 139230.5,-198.98 139249.54,-200.63 139254.39,-199.09 139273.5,-198.98 139487.9,-197.76 140991.52,-212.28 141203,-176.98 141218.83,-174.34 141235.4,-170.02 141251.07,-165.16"/>
<polygon fill="black" stroke="black" points="141252.25,-168.46 141260.7,-162.07 141250.11,-161.79 141252.25,-168.46"/>
<text text-anchor="middle" x="139252" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l2_dp1 -->
<g id="node465" class="node">
<title>expert8_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="141194.5,-161.98 140965.5,-161.98 140965.5,-109.98 141194.5,-109.98 141194.5,-161.98"/>
<text text-anchor="middle" x="141080" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L2</text>
<text text-anchor="middle" x="141080" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="141080" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="141080" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert8_l2_dp1 -->
<g id="edge771" class="edge">
<title>router_l2_dp1&#45;&gt;expert8_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.52,-168.73C139136.92,-172.02 139167.66,-174.91 139197,-176.98 139498.4,-198.28 140254.46,-207.29 140556.5,-198.98 140734.26,-194.09 140781.28,-210.07 140956,-176.98 140971.17,-174.11 140987.04,-169.87 141002.16,-165.18"/>
<polygon fill="black" stroke="black" points="141003.52,-168.42 141011.98,-162.05 141001.39,-161.75 141003.52,-168.42"/>
<text text-anchor="middle" x="140535" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l2_dp1 -->
<g id="node466" class="node">
<title>expert9_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="140947.5,-161.98 140718.5,-161.98 140718.5,-109.98 140947.5,-109.98 140947.5,-161.98"/>
<text text-anchor="middle" x="140833" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L2</text>
<text text-anchor="middle" x="140833" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="140833" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="140833" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert9_l2_dp1 -->
<g id="edge772" class="edge">
<title>router_l2_dp1&#45;&gt;expert9_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139094.65,-177.01C139154.23,-186.11 139218.61,-194.4 139278.5,-198.98 139437,-211.1 140552.26,-203.5 140709,-176.98 140724.83,-174.3 140741.39,-169.97 140757.06,-165.1"/>
<polygon fill="black" stroke="black" points="140758.24,-168.4 140766.69,-162.01 140756.1,-161.74 140758.24,-168.4"/>
<text text-anchor="middle" x="139300" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l2_dp1 -->
<g id="node467" class="node">
<title>expert10_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="140700.5,-161.98 140471.5,-161.98 140471.5,-109.98 140700.5,-109.98 140700.5,-161.98"/>
<text text-anchor="middle" x="140586" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L2</text>
<text text-anchor="middle" x="140586" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="140586" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="140586" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert10_l2_dp1 -->
<g id="edge773" class="edge">
<title>router_l2_dp1&#45;&gt;expert10_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139106.1,-168.45C139136.64,-171.8 139167.53,-174.78 139197,-176.98 139605.53,-207.56 139709.04,-212.08 140118.5,-198.98 140271.4,-194.09 140311.82,-206.12 140462,-176.98 140477.06,-174.06 140492.83,-169.82 140507.87,-165.16"/>
<polygon fill="black" stroke="black" points="140509.17,-168.42 140517.64,-162.04 140507.05,-161.75 140509.17,-168.42"/>
<text text-anchor="middle" x="140097" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l2_dp1 -->
<g id="node468" class="node">
<title>expert11_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="140453.5,-161.98 140224.5,-161.98 140224.5,-109.98 140453.5,-109.98 140453.5,-161.98"/>
<text text-anchor="middle" x="140339" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L2</text>
<text text-anchor="middle" x="140339" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="140339" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="140339" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert11_l2_dp1 -->
<g id="edge774" class="edge">
<title>router_l2_dp1&#45;&gt;expert11_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139115.89,-176.28C139183.94,-185.66 139257.91,-194.28 139326.5,-198.98 139523.54,-212.49 140020.43,-210.92 140215,-176.98 140230.72,-174.24 140247.17,-169.91 140262.76,-165.06"/>
<polygon fill="black" stroke="black" points="140263.89,-168.38 140272.35,-161.99 140261.75,-161.71 140263.89,-168.38"/>
<text text-anchor="middle" x="139348" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l2_dp1 -->
<g id="node469" class="node">
<title>expert12_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="140206.5,-161.98 139977.5,-161.98 139977.5,-109.98 140206.5,-109.98 140206.5,-161.98"/>
<text text-anchor="middle" x="140092" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L2</text>
<text text-anchor="middle" x="140092" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="140092" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="140092" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert12_l2_dp1 -->
<g id="edge775" class="edge">
<title>router_l2_dp1&#45;&gt;expert12_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139105.25,-167.81C139136.07,-171.29 139167.26,-174.47 139197,-176.98 139197,-176.98 139968,-176.98 139968,-176.98 139982.65,-173.9 139998,-169.69 140012.7,-165.12"/>
<polygon fill="black" stroke="black" points="140013.79,-168.45 140022.26,-162.08 140011.67,-161.78 140013.79,-168.45"/>
<text text-anchor="middle" x="139715" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l2_dp1 -->
<g id="node470" class="node">
<title>expert13_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="139959.5,-161.98 139730.5,-161.98 139730.5,-109.98 139959.5,-109.98 139959.5,-161.98"/>
<text text-anchor="middle" x="139845" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L2</text>
<text text-anchor="middle" x="139845" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="139845" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="139845" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert13_l2_dp1 -->
<g id="edge776" class="edge">
<title>router_l2_dp1&#45;&gt;expert13_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139099.04,-176.98C139271.78,-200.57 139513.28,-218.19 139721,-176.98 139735.96,-174.01 139751.62,-169.78 139766.58,-165.14"/>
<polygon fill="black" stroke="black" points="139767.83,-168.41 139776.29,-162.04 139765.7,-161.74 139767.83,-168.41"/>
<text text-anchor="middle" x="139396" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l2_dp1 -->
<g id="node471" class="node">
<title>expert14_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="139712.5,-161.98 139483.5,-161.98 139483.5,-109.98 139712.5,-109.98 139712.5,-161.98"/>
<text text-anchor="middle" x="139598" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L2</text>
<text text-anchor="middle" x="139598" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="139598" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="139598" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert14_l2_dp1 -->
<g id="edge777" class="edge">
<title>router_l2_dp1&#45;&gt;expert14_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139108.4,-177C139243.73,-197.08 139398.84,-214.02 139465.5,-198.98 139493.7,-192.62 139522.94,-179.52 139546.75,-166.9"/>
<polygon fill="black" stroke="black" points="139548.48,-169.94 139555.6,-162.1 139545.14,-163.79 139548.48,-169.94"/>
<text text-anchor="middle" x="139444" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l2_dp1 -->
<g id="node472" class="node">
<title>expert15_l2_dp1</title>
<polygon fill="lightgreen" stroke="black" points="139435.5,-161.98 139206.5,-161.98 139206.5,-109.98 139435.5,-109.98 139435.5,-161.98"/>
<text text-anchor="middle" x="139321" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L2</text>
<text text-anchor="middle" x="139321" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="139321" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="139321" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp1&#45;&gt;expert15_l2_dp1 -->
<g id="edge778" class="edge">
<title>router_l2_dp1&#45;&gt;expert15_l2_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M139065.94,-135.98C139110.13,-135.98 139155.83,-135.98 139196.12,-135.98"/>
<polygon fill="black" stroke="black" points="139196.25,-139.48 139206.25,-135.98 139196.25,-132.48 139196.25,-139.48"/>
<text text-anchor="middle" x="139161.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l2_dp1 -->
<g id="node473" class="node">
<title>expert_agg_l2_dp1</title>
<polygon fill="lightyellow" stroke="black" points="143701.57,-176.98 143307.74,-176.98 143206.43,-94.98 143600.26,-94.98 143701.57,-176.98"/>
<text text-anchor="middle" x="143454" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L2</text>
<text text-anchor="middle" x="143454" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="143454" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge779" class="edge">
<title>expert0_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M143170.66,-135.98C143196.06,-135.98 143221.47,-135.98 143246.87,-135.98"/>
<polygon fill="black" stroke="black" points="143246.99,-139.48 143256.99,-135.98 143246.99,-132.48 143246.99,-139.48"/>
</g>
<!-- expert1_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge780" class="edge">
<title>expert1_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M142864.24,-162.02C142887.4,-171.57 142914.96,-181.22 142941,-185.98 142991.06,-195.15 143119.3,-190.41 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert2_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge781" class="edge">
<title>expert2_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M142617.24,-162.02C142640.4,-171.57 142667.96,-181.22 142694,-185.98 142746.02,-195.51 143117.31,-190.59 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert3_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge782" class="edge">
<title>expert3_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M142370.24,-162.02C142393.4,-171.57 142420.96,-181.22 142447,-185.98 142526.02,-200.45 143089.97,-192.97 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert4_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge783" class="edge">
<title>expert4_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M142123.24,-162.02C142146.4,-171.57 142173.96,-181.22 142200,-185.98 142253.01,-195.69 143116.31,-190.67 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert5_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge784" class="edge">
<title>expert5_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M141876.24,-162.02C141899.4,-171.57 141926.96,-181.22 141953,-185.98 142019.5,-198.16 143102.64,-191.87 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert6_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge785" class="edge">
<title>expert6_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M141629.24,-162.02C141652.4,-171.57 141679.96,-181.22 141706,-185.98 141786,-200.63 143088.97,-193.06 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert7_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge786" class="edge">
<title>expert7_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M141382.24,-162.02C141405.4,-171.57 141432.96,-181.22 141459,-185.98 141505.75,-194.54 143122.65,-190.12 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert8_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge787" class="edge">
<title>expert8_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M141135.24,-162.02C141158.4,-171.57 141185.96,-181.22 141212,-185.98 141265.5,-195.78 143115.82,-190.72 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert9_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge788" class="edge">
<title>expert9_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M140888.24,-162.02C140911.4,-171.57 140938.96,-181.22 140965,-185.98 141025.25,-197.01 143108.98,-191.31 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert10_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge789" class="edge">
<title>expert10_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M140641.24,-162.02C140664.4,-171.57 140691.96,-181.22 140718,-185.98 140785,-198.25 143102.15,-191.91 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert11_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge790" class="edge">
<title>expert11_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M140394.24,-162.02C140417.4,-171.57 140444.96,-181.22 140471,-185.98 140544.75,-199.48 143095.31,-192.51 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert12_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge791" class="edge">
<title>expert12_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M140147.24,-162.02C140170.4,-171.57 140197.96,-181.22 140224,-185.98 140304.49,-200.72 143088.48,-193.1 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert13_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge792" class="edge">
<title>expert13_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M139900.24,-162.02C139923.4,-171.57 139950.96,-181.22 139977,-185.98 140020.62,-193.97 143125.82,-189.84 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert14_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge793" class="edge">
<title>expert14_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M139653.24,-162.02C139676.4,-171.57 139703.96,-181.22 139730,-185.98 139777,-194.59 143122.4,-190.14 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- expert15_l2_dp1&#45;&gt;expert_agg_l2_dp1 -->
<g id="edge794" class="edge">
<title>expert15_l2_dp1&#45;&gt;expert_agg_l2_dp1</title>
<path fill="none" stroke="black" d="M139389.31,-162.04C139417.82,-171.6 139451.57,-181.24 139483,-185.98 139533.63,-193.62 143118.98,-190.44 143170,-185.98 143208.11,-182.65 143248.78,-176.86 143287.08,-170.36"/>
<polygon fill="black" stroke="black" points="143288.02,-173.75 143297.29,-168.6 143286.84,-166.85 143288.02,-173.75"/>
</g>
<!-- layer2_output_dp1 -->
<g id="node474" class="node">
<title>layer2_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="143906" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="143906" y="-144.48" font-family="Arial" font-size="10.00">Layer 2 Output</text>
<text text-anchor="middle" x="143906" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="143906" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l2_dp1&#45;&gt;layer2_output_dp1 -->
<g id="edge795" class="edge">
<title>expert_agg_l2_dp1&#45;&gt;layer2_output_dp1</title>
<path fill="none" stroke="black" d="M143651.31,-135.98C143676.49,-135.98 143701.66,-135.98 143726.84,-135.98"/>
<polygon fill="black" stroke="black" points="143726.87,-139.48 143736.87,-135.98 143726.87,-132.48 143726.87,-139.48"/>
</g>
<!-- attn_input_l3_dp1 -->
<g id="node475" class="node">
<title>attn_input_l3_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="144279" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="144279" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L3</text>
<text text-anchor="middle" x="144279" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="144279" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer2_output_dp1&#45;&gt;attn_input_l3_dp1 -->
<g id="edge796" class="edge">
<title>layer2_output_dp1&#45;&gt;attn_input_l3_dp1</title>
<path fill="none" stroke="black" d="M144075.01,-135.98C144083.23,-135.98 144091.44,-135.98 144099.66,-135.98"/>
<polygon fill="black" stroke="black" points="144099.68,-139.48 144109.68,-135.98 144099.68,-132.48 144099.68,-139.48"/>
</g>
<!-- attn_tp0_l3_dp1 -->
<g id="node476" class="node">
<title>attn_tp0_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="145577,-161.98 145317,-161.98 145317,-109.98 145577,-109.98 145577,-161.98"/>
<text text-anchor="middle" x="145447" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L3</text>
<text text-anchor="middle" x="145447" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="145447" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="145447" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp1&#45;&gt;attn_tp0_l3_dp1 -->
<g id="edge797" class="edge">
<title>attn_input_l3_dp1&#45;&gt;attn_tp0_l3_dp1</title>
<path fill="none" stroke="black" d="M144362.52,-161.26C144399.12,-171.09 144442.81,-181.13 144483,-185.98 144528,-191.42 145254.27,-193.33 145299,-185.98 145324.4,-181.81 145351.31,-173.85 145375.12,-165.5"/>
<polygon fill="black" stroke="black" points="145376.55,-168.71 145384.78,-162.03 145374.18,-162.12 145376.55,-168.71"/>
</g>
<!-- attn_tp1_l3_dp1 -->
<g id="node477" class="node">
<title>attn_tp1_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="145299,-161.98 145039,-161.98 145039,-109.98 145299,-109.98 145299,-161.98"/>
<text text-anchor="middle" x="145169" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L3</text>
<text text-anchor="middle" x="145169" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="145169" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="145169" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp1&#45;&gt;attn_tp1_l3_dp1 -->
<g id="edge798" class="edge">
<title>attn_input_l3_dp1&#45;&gt;attn_tp1_l3_dp1</title>
<path fill="none" stroke="black" d="M144362.52,-161.26C144399.12,-171.09 144442.81,-181.13 144483,-185.98 144542.35,-193.15 144962.01,-195.68 145021,-185.98 145046.4,-181.81 145073.31,-173.85 145097.12,-165.5"/>
<polygon fill="black" stroke="black" points="145098.55,-168.71 145106.78,-162.03 145096.18,-162.12 145098.55,-168.71"/>
</g>
<!-- attn_tp2_l3_dp1 -->
<g id="node478" class="node">
<title>attn_tp2_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="145021,-161.98 144761,-161.98 144761,-109.98 145021,-109.98 145021,-161.98"/>
<text text-anchor="middle" x="144891" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L3</text>
<text text-anchor="middle" x="144891" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="144891" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="144891" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp1&#45;&gt;attn_tp2_l3_dp1 -->
<g id="edge799" class="edge">
<title>attn_input_l3_dp1&#45;&gt;attn_tp2_l3_dp1</title>
<path fill="none" stroke="black" d="M144362.52,-161.26C144399.12,-171.09 144442.81,-181.13 144483,-185.98 144540.36,-192.91 144685.99,-195.35 144743,-185.98 144768.4,-181.81 144795.31,-173.85 144819.12,-165.5"/>
<polygon fill="black" stroke="black" points="144820.55,-168.71 144828.78,-162.03 144818.18,-162.12 144820.55,-168.71"/>
</g>
<!-- attn_tp3_l3_dp1 -->
<g id="node479" class="node">
<title>attn_tp3_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="144743,-161.98 144483,-161.98 144483,-109.98 144743,-109.98 144743,-161.98"/>
<text text-anchor="middle" x="144613" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L3</text>
<text text-anchor="middle" x="144613" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="144613" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="144613" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp1&#45;&gt;attn_tp3_l3_dp1 -->
<g id="edge800" class="edge">
<title>attn_input_l3_dp1&#45;&gt;attn_tp3_l3_dp1</title>
<path fill="none" stroke="black" d="M144448.28,-135.98C144456.35,-135.98 144464.42,-135.98 144472.49,-135.98"/>
<polygon fill="black" stroke="black" points="144472.7,-139.48 144482.7,-135.98 144472.7,-132.48 144472.7,-139.48"/>
</g>
<!-- allreduce_l3_dp1 -->
<g id="node480" class="node">
<title>allreduce_l3_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="145781" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="145781" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L3</text>
<text text-anchor="middle" x="145781" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="145781" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l3_dp1&#45;&gt;allreduce_l3_dp1 -->
<g id="edge801" class="edge">
<title>attn_tp0_l3_dp1&#45;&gt;allreduce_l3_dp1</title>
<path fill="none" stroke="black" d="M145577.14,-135.98C145585.35,-135.98 145593.56,-135.98 145601.77,-135.98"/>
<polygon fill="black" stroke="black" points="145601.78,-139.48 145611.78,-135.98 145601.78,-132.48 145601.78,-139.48"/>
</g>
<!-- attn_tp1_l3_dp1&#45;&gt;allreduce_l3_dp1 -->
<g id="edge802" class="edge">
<title>attn_tp1_l3_dp1&#45;&gt;allreduce_l3_dp1</title>
<path fill="none" stroke="black" d="M145231.22,-162.03C145257.24,-171.59 145288.1,-181.23 145317,-185.98 145374.01,-195.35 145519.64,-192.91 145577,-185.98 145613.57,-181.57 145653.05,-172.85 145687.44,-163.91"/>
<polygon fill="black" stroke="black" points="145688.7,-167.2 145697.47,-161.26 145686.91,-160.43 145688.7,-167.2"/>
</g>
<!-- attn_tp2_l3_dp1&#45;&gt;allreduce_l3_dp1 -->
<g id="edge803" class="edge">
<title>attn_tp2_l3_dp1&#45;&gt;allreduce_l3_dp1</title>
<path fill="none" stroke="black" d="M144953.22,-162.03C144979.24,-171.59 145010.1,-181.23 145039,-185.98 145097.98,-195.68 145517.65,-193.15 145577,-185.98 145613.57,-181.57 145653.05,-172.85 145687.44,-163.91"/>
<polygon fill="black" stroke="black" points="145688.7,-167.2 145697.47,-161.26 145686.91,-160.43 145688.7,-167.2"/>
</g>
<!-- attn_tp3_l3_dp1&#45;&gt;allreduce_l3_dp1 -->
<g id="edge804" class="edge">
<title>attn_tp3_l3_dp1&#45;&gt;allreduce_l3_dp1</title>
<path fill="none" stroke="black" d="M144675.22,-162.03C144701.24,-171.59 144732.1,-181.23 144761,-185.98 144805.73,-193.33 145531.99,-191.42 145577,-185.98 145613.57,-181.57 145653.05,-172.85 145687.44,-163.91"/>
<polygon fill="black" stroke="black" points="145688.7,-167.2 145697.47,-161.26 145686.91,-160.43 145688.7,-167.2"/>
</g>
<!-- moe_input_l3_dp1 -->
<g id="node481" class="node">
<title>moe_input_l3_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="146154" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="146154" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L3</text>
<text text-anchor="middle" x="146154" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="146154" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l3_dp1&#45;&gt;moe_input_l3_dp1 -->
<g id="edge805" class="edge">
<title>allreduce_l3_dp1&#45;&gt;moe_input_l3_dp1</title>
<path fill="none" stroke="black" d="M145950.01,-135.98C145958.23,-135.98 145966.44,-135.98 145974.66,-135.98"/>
<polygon fill="black" stroke="black" points="145974.68,-139.48 145984.68,-135.98 145974.68,-132.48 145974.68,-139.48"/>
</g>
<!-- router_l3_dp1 -->
<g id="node482" class="node">
<title>router_l3_dp1</title>
<polygon fill="lightyellow" stroke="black" points="146853.57,-176.98 146459.74,-176.98 146358.43,-94.98 146752.26,-94.98 146853.57,-176.98"/>
<text text-anchor="middle" x="146606" y="-144.48" font-family="Arial" font-size="10.00">Router L3</text>
<text text-anchor="middle" x="146606" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="146606" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l3_dp1&#45;&gt;router_l3_dp1 -->
<g id="edge806" class="edge">
<title>moe_input_l3_dp1&#45;&gt;router_l3_dp1</title>
<path fill="none" stroke="black" d="M146323.06,-135.98C146348.34,-135.98 146373.63,-135.98 146398.92,-135.98"/>
<polygon fill="black" stroke="black" points="146398.99,-139.48 146408.99,-135.98 146398.99,-132.48 146398.99,-139.48"/>
</g>
<!-- expert0_l3_dp1 -->
<g id="node483" class="node">
<title>expert0_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="150907.5,-161.98 150678.5,-161.98 150678.5,-109.98 150907.5,-109.98 150907.5,-161.98"/>
<text text-anchor="middle" x="150793" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L3</text>
<text text-anchor="middle" x="150793" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="150793" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="150793" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert0_l3_dp1 -->
<g id="edge807" class="edge">
<title>router_l3_dp1&#45;&gt;expert0_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.95,-169.07C146874.21,-172.29 146904.79,-175.07 146934,-176.98 147679.86,-225.87 149550.04,-196.54 150297.5,-198.98 150462.9,-199.52 150506.67,-208.72 150669,-176.98 150684.06,-174.04 150699.82,-169.78 150714.86,-165.12"/>
<polygon fill="black" stroke="black" points="150716.17,-168.38 150724.63,-162.01 150714.04,-161.71 150716.17,-168.38"/>
<text text-anchor="middle" x="150319" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l3_dp1 -->
<g id="node484" class="node">
<title>expert1_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="150660.5,-161.98 150431.5,-161.98 150431.5,-109.98 150660.5,-109.98 150660.5,-161.98"/>
<text text-anchor="middle" x="150546" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L3</text>
<text text-anchor="middle" x="150546" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="150546" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="150546" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert1_l3_dp1 -->
<g id="edge808" class="edge">
<title>router_l3_dp1&#45;&gt;expert1_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.95,-169.04C146874.21,-172.27 146904.79,-175.06 146934,-176.98 147598.24,-220.79 149263.82,-196.54 149929.5,-198.98 150148.6,-199.79 150206.59,-217.1 150422,-176.98 150437.27,-174.14 150453.24,-169.88 150468.45,-165.17"/>
<polygon fill="black" stroke="black" points="150469.86,-168.4 150478.32,-162.02 150467.73,-161.73 150469.86,-168.4"/>
<text text-anchor="middle" x="149951" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l3_dp1 -->
<g id="node485" class="node">
<title>expert2_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="150413.5,-161.98 150184.5,-161.98 150184.5,-109.98 150413.5,-109.98 150413.5,-161.98"/>
<text text-anchor="middle" x="150299" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L3</text>
<text text-anchor="middle" x="150299" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="150299" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="150299" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert2_l3_dp1 -->
<g id="edge809" class="edge">
<title>router_l3_dp1&#45;&gt;expert2_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146751.67,-176.99C146790.3,-186.08 146832.21,-194.39 146871.5,-198.98 146890.48,-201.2 146895.39,-199.05 146914.5,-198.98 147276.78,-197.76 149817.52,-235.79 150175,-176.98 150190.93,-174.36 150207.6,-170.03 150223.35,-165.13"/>
<polygon fill="black" stroke="black" points="150224.58,-168.41 150233.03,-162.02 150222.44,-161.75 150224.58,-168.41"/>
<text text-anchor="middle" x="146893" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l3_dp1 -->
<g id="node486" class="node">
<title>expert3_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="150166.5,-161.98 149937.5,-161.98 149937.5,-109.98 150166.5,-109.98 150166.5,-161.98"/>
<text text-anchor="middle" x="150052" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L3</text>
<text text-anchor="middle" x="150052" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="150052" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="150052" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert3_l3_dp1 -->
<g id="edge810" class="edge">
<title>router_l3_dp1&#45;&gt;expert3_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.95,-169C146874.21,-172.24 146904.8,-175.04 146934,-176.98 147489.79,-214.03 148883.48,-196.54 149440.5,-198.98 149657.38,-199.93 149714.79,-216.75 149928,-176.98 149943.27,-174.14 149959.24,-169.88 149974.45,-165.17"/>
<polygon fill="black" stroke="black" points="149975.86,-168.39 149984.32,-162.01 149973.73,-161.72 149975.86,-168.39"/>
<text text-anchor="middle" x="149462" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l3_dp1 -->
<g id="node487" class="node">
<title>expert4_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="149919.5,-161.98 149690.5,-161.98 149690.5,-109.98 149919.5,-109.98 149919.5,-161.98"/>
<text text-anchor="middle" x="149805" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L3</text>
<text text-anchor="middle" x="149805" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="149805" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="149805" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert4_l3_dp1 -->
<g id="edge811" class="edge">
<title>router_l3_dp1&#45;&gt;expert4_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146778.37,-177C146823.98,-186.1 146873.37,-194.39 146919.5,-198.98 146938.52,-200.87 146943.39,-199.06 146962.5,-198.98 147264.56,-197.76 149382.97,-226.21 149681,-176.98 149696.93,-174.35 149713.6,-170.01 149729.35,-165.12"/>
<polygon fill="black" stroke="black" points="149730.58,-168.4 149739.03,-162.01 149728.44,-161.73 149730.58,-168.4"/>
<text text-anchor="middle" x="146941" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l3_dp1 -->
<g id="node488" class="node">
<title>expert5_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="149672.5,-161.98 149443.5,-161.98 149443.5,-109.98 149672.5,-109.98 149672.5,-161.98"/>
<text text-anchor="middle" x="149558" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L3</text>
<text text-anchor="middle" x="149558" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="149558" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="149558" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert5_l3_dp1 -->
<g id="edge812" class="edge">
<title>router_l3_dp1&#45;&gt;expert5_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.96,-168.95C146874.21,-172.19 146904.8,-175.01 146934,-176.98 147831.33,-237.75 148058.13,-194.09 148957.5,-198.98 149169.5,-200.14 149225.61,-215.98 149434,-176.98 149449.26,-174.13 149465.24,-169.86 149480.45,-165.15"/>
<polygon fill="black" stroke="black" points="149481.86,-168.37 149490.32,-162 149479.73,-161.71 149481.86,-168.37"/>
<text text-anchor="middle" x="148979" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l3_dp1 -->
<g id="node489" class="node">
<title>expert6_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="149425.5,-161.98 149196.5,-161.98 149196.5,-109.98 149425.5,-109.98 149425.5,-161.98"/>
<text text-anchor="middle" x="149311" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L3</text>
<text text-anchor="middle" x="149311" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="149311" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="149311" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert6_l3_dp1 -->
<g id="edge813" class="edge">
<title>router_l3_dp1&#45;&gt;expert6_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146805.02,-177C146857.62,-186.1 146914.5,-194.4 146967.5,-198.98 146986.54,-200.63 146991.39,-199.08 147010.5,-198.98 147252.34,-197.76 148948.43,-216.64 149187,-176.98 149202.84,-174.35 149219.4,-170.04 149235.07,-165.18"/>
<polygon fill="black" stroke="black" points="149236.25,-168.47 149244.7,-162.09 149234.11,-161.81 149236.25,-168.47"/>
<text text-anchor="middle" x="146989" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l3_dp1 -->
<g id="node490" class="node">
<title>expert7_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="149178.5,-161.98 148949.5,-161.98 148949.5,-109.98 149178.5,-109.98 149178.5,-161.98"/>
<text text-anchor="middle" x="149064" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L3</text>
<text text-anchor="middle" x="149064" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="149064" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="149064" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert7_l3_dp1 -->
<g id="edge814" class="edge">
<title>router_l3_dp1&#45;&gt;expert7_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.52,-168.8C146873.92,-172.08 146904.66,-174.95 146934,-176.98 147287.52,-201.51 148174.26,-208.45 148528.5,-198.98 148711.58,-194.09 148760.02,-210.92 148940,-176.98 148955.17,-174.12 148971.04,-169.88 148986.17,-165.2"/>
<polygon fill="black" stroke="black" points="148987.52,-168.44 148995.99,-162.07 148985.4,-161.77 148987.52,-168.44"/>
<text text-anchor="middle" x="148507" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l3_dp1 -->
<g id="node491" class="node">
<title>expert8_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="148931.5,-161.98 148702.5,-161.98 148702.5,-109.98 148931.5,-109.98 148931.5,-161.98"/>
<text text-anchor="middle" x="148817" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L3</text>
<text text-anchor="middle" x="148817" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="148817" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="148817" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert8_l3_dp1 -->
<g id="edge815" class="edge">
<title>router_l3_dp1&#45;&gt;expert8_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146831.65,-177.01C146891.23,-186.11 146955.61,-194.4 147015.5,-198.98 147034.55,-200.44 147039.39,-199.11 147058.5,-198.98 147240.12,-197.76 148513.88,-207.07 148693,-176.98 148708.83,-174.32 148725.39,-170 148741.07,-165.13"/>
<polygon fill="black" stroke="black" points="148742.24,-168.43 148750.7,-162.04 148740.1,-161.77 148742.24,-168.43"/>
<text text-anchor="middle" x="147037" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l3_dp1 -->
<g id="node492" class="node">
<title>expert9_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="148684.5,-161.98 148455.5,-161.98 148455.5,-109.98 148684.5,-109.98 148684.5,-161.98"/>
<text text-anchor="middle" x="148570" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L3</text>
<text text-anchor="middle" x="148570" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="148570" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="148570" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert9_l3_dp1 -->
<g id="edge816" class="edge">
<title>router_l3_dp1&#45;&gt;expert9_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.53,-168.64C146873.93,-171.95 146904.66,-174.86 146934,-176.98 147440.99,-213.64 147569.41,-214.14 148077.5,-198.98 148241.49,-194.09 148284.87,-207.88 148446,-176.98 148461.16,-174.08 148477.03,-169.81 148492.15,-165.12"/>
<polygon fill="black" stroke="black" points="148493.51,-168.37 148501.97,-161.99 148491.38,-161.7 148493.51,-168.37"/>
<text text-anchor="middle" x="148056" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l3_dp1 -->
<g id="node493" class="node">
<title>expert10_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="148437.5,-161.98 148208.5,-161.98 148208.5,-109.98 148437.5,-109.98 148437.5,-161.98"/>
<text text-anchor="middle" x="148323" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L3</text>
<text text-anchor="middle" x="148323" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="148323" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="148323" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert10_l3_dp1 -->
<g id="edge817" class="edge">
<title>router_l3_dp1&#45;&gt;expert10_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146852.89,-176.28C146920.94,-185.66 146994.91,-194.28 147063.5,-198.98 147189.39,-207.61 148074.62,-198.3 148199,-176.98 148214.73,-174.29 148231.18,-169.97 148246.78,-165.14"/>
<polygon fill="black" stroke="black" points="148247.9,-168.45 148256.36,-162.07 148245.77,-161.78 148247.9,-168.45"/>
<text text-anchor="middle" x="147085" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l3_dp1 -->
<g id="node494" class="node">
<title>expert11_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="148190.5,-161.98 147961.5,-161.98 147961.5,-109.98 148190.5,-109.98 148190.5,-161.98"/>
<text text-anchor="middle" x="148076" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L3</text>
<text text-anchor="middle" x="148076" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="148076" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="148076" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert11_l3_dp1 -->
<g id="edge818" class="edge">
<title>router_l3_dp1&#45;&gt;expert11_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146843.11,-168.26C146873.65,-171.64 146904.53,-174.68 146934,-176.98 147260.48,-202.51 147343.27,-211.75 147670.5,-198.98 147795.9,-194.09 147828.97,-201.75 147952,-176.98 147966.86,-173.99 147982.42,-169.77 147997.29,-165.16"/>
<polygon fill="black" stroke="black" points="147998.48,-168.45 148006.95,-162.08 147996.36,-161.78 147998.48,-168.45"/>
<text text-anchor="middle" x="147649" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l3_dp1 -->
<g id="node495" class="node">
<title>expert12_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="147943.5,-161.98 147714.5,-161.98 147714.5,-109.98 147943.5,-109.98 147943.5,-161.98"/>
<text text-anchor="middle" x="147829" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L3</text>
<text text-anchor="middle" x="147829" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="147829" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="147829" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert12_l3_dp1 -->
<g id="edge819" class="edge">
<title>router_l3_dp1&#45;&gt;expert12_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146838.93,-165.13C146870.87,-169.12 146903.25,-173.15 146934,-176.98 146934,-176.98 147705,-176.98 147705,-176.98 147720.37,-174.19 147736.45,-169.93 147751.75,-165.2"/>
<polygon fill="black" stroke="black" points="147753.21,-168.41 147761.67,-162.03 147751.08,-161.74 147753.21,-168.41"/>
<text text-anchor="middle" x="147133" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l3_dp1 -->
<g id="node496" class="node">
<title>expert13_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="147696.5,-161.98 147467.5,-161.98 147467.5,-109.98 147696.5,-109.98 147696.5,-161.98"/>
<text text-anchor="middle" x="147582" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L3</text>
<text text-anchor="middle" x="147582" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="147582" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="147582" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert13_l3_dp1 -->
<g id="edge820" class="edge">
<title>router_l3_dp1&#45;&gt;expert13_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146833.54,-177.02C146980.8,-198.21 147176.62,-216.33 147349.5,-198.98 147400.66,-193.85 147456.31,-179.11 147500.33,-165.18"/>
<polygon fill="black" stroke="black" points="147501.66,-168.43 147510.11,-162.04 147499.52,-161.77 147501.66,-168.43"/>
<text text-anchor="middle" x="147328" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l3_dp1 -->
<g id="node497" class="node">
<title>expert14_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="147449.5,-161.98 147220.5,-161.98 147220.5,-109.98 147449.5,-109.98 147449.5,-161.98"/>
<text text-anchor="middle" x="147335" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L3</text>
<text text-anchor="middle" x="147335" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="147335" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="147335" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert14_l3_dp1 -->
<g id="edge821" class="edge">
<title>router_l3_dp1&#45;&gt;expert14_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146845.4,-177C146980.73,-197.08 147135.84,-214.02 147202.5,-198.98 147230.7,-192.62 147259.94,-179.52 147283.75,-166.9"/>
<polygon fill="black" stroke="black" points="147285.48,-169.94 147292.6,-162.1 147282.14,-163.79 147285.48,-169.94"/>
<text text-anchor="middle" x="147181" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l3_dp1 -->
<g id="node498" class="node">
<title>expert15_l3_dp1</title>
<polygon fill="lightgreen" stroke="black" points="147172.5,-161.98 146943.5,-161.98 146943.5,-109.98 147172.5,-109.98 147172.5,-161.98"/>
<text text-anchor="middle" x="147058" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L3</text>
<text text-anchor="middle" x="147058" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="147058" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="147058" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp1&#45;&gt;expert15_l3_dp1 -->
<g id="edge822" class="edge">
<title>router_l3_dp1&#45;&gt;expert15_l3_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M146802.94,-135.98C146847.13,-135.98 146892.83,-135.98 146933.12,-135.98"/>
<polygon fill="black" stroke="black" points="146933.25,-139.48 146943.25,-135.98 146933.25,-132.48 146933.25,-139.48"/>
<text text-anchor="middle" x="146898.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l3_dp1 -->
<g id="node499" class="node">
<title>expert_agg_l3_dp1</title>
<polygon fill="lightyellow" stroke="black" points="151438.57,-176.98 151044.74,-176.98 150943.43,-94.98 151337.26,-94.98 151438.57,-176.98"/>
<text text-anchor="middle" x="151191" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L3</text>
<text text-anchor="middle" x="151191" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="151191" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge823" class="edge">
<title>expert0_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M150907.66,-135.98C150933.06,-135.98 150958.47,-135.98 150983.87,-135.98"/>
<polygon fill="black" stroke="black" points="150983.99,-139.48 150993.99,-135.98 150983.99,-132.48 150983.99,-139.48"/>
</g>
<!-- expert1_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge824" class="edge">
<title>expert1_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M150601.24,-162.02C150624.4,-171.57 150651.96,-181.22 150678,-185.98 150728.06,-195.15 150856.3,-190.41 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert2_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge825" class="edge">
<title>expert2_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M150354.24,-162.02C150377.4,-171.57 150404.96,-181.22 150431,-185.98 150483.02,-195.51 150854.31,-190.59 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert3_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge826" class="edge">
<title>expert3_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M150107.24,-162.02C150130.4,-171.57 150157.96,-181.22 150184,-185.98 150263.02,-200.45 150826.97,-192.97 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert4_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge827" class="edge">
<title>expert4_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M149860.24,-162.02C149883.4,-171.57 149910.96,-181.22 149937,-185.98 149990.01,-195.69 150853.31,-190.67 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert5_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge828" class="edge">
<title>expert5_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M149613.24,-162.02C149636.4,-171.57 149663.96,-181.22 149690,-185.98 149756.5,-198.16 150839.64,-191.87 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert6_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge829" class="edge">
<title>expert6_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M149366.24,-162.02C149389.4,-171.57 149416.96,-181.22 149443,-185.98 149523,-200.63 150825.97,-193.06 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert7_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge830" class="edge">
<title>expert7_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M149119.24,-162.02C149142.4,-171.57 149169.96,-181.22 149196,-185.98 149242.75,-194.54 150859.65,-190.12 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert8_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge831" class="edge">
<title>expert8_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M148872.24,-162.02C148895.4,-171.57 148922.96,-181.22 148949,-185.98 149002.5,-195.78 150852.82,-190.72 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert9_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge832" class="edge">
<title>expert9_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M148625.24,-162.02C148648.4,-171.57 148675.96,-181.22 148702,-185.98 148762.25,-197.01 150845.98,-191.31 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert10_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge833" class="edge">
<title>expert10_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M148378.24,-162.02C148401.4,-171.57 148428.96,-181.22 148455,-185.98 148522,-198.25 150839.15,-191.91 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert11_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge834" class="edge">
<title>expert11_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M148131.24,-162.02C148154.4,-171.57 148181.96,-181.22 148208,-185.98 148281.75,-199.48 150832.31,-192.51 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert12_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge835" class="edge">
<title>expert12_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M147884.24,-162.02C147907.4,-171.57 147934.96,-181.22 147961,-185.98 148041.49,-200.72 150825.48,-193.1 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert13_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge836" class="edge">
<title>expert13_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M147637.24,-162.02C147660.4,-171.57 147687.96,-181.22 147714,-185.98 147757.62,-193.97 150862.82,-189.84 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert14_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge837" class="edge">
<title>expert14_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M147390.24,-162.02C147413.4,-171.57 147440.96,-181.22 147467,-185.98 147514,-194.59 150859.4,-190.14 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- expert15_l3_dp1&#45;&gt;expert_agg_l3_dp1 -->
<g id="edge838" class="edge">
<title>expert15_l3_dp1&#45;&gt;expert_agg_l3_dp1</title>
<path fill="none" stroke="black" d="M147126.31,-162.04C147154.82,-171.6 147188.57,-181.24 147220,-185.98 147270.63,-193.62 150855.98,-190.44 150907,-185.98 150945.11,-182.65 150985.78,-176.86 151024.08,-170.36"/>
<polygon fill="black" stroke="black" points="151025.02,-173.75 151034.29,-168.6 151023.84,-166.85 151025.02,-173.75"/>
</g>
<!-- layer3_output_dp1 -->
<g id="node500" class="node">
<title>layer3_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="151643" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="151643" y="-144.48" font-family="Arial" font-size="10.00">Layer 3 Output</text>
<text text-anchor="middle" x="151643" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="151643" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l3_dp1&#45;&gt;layer3_output_dp1 -->
<g id="edge839" class="edge">
<title>expert_agg_l3_dp1&#45;&gt;layer3_output_dp1</title>
<path fill="none" stroke="black" d="M151388.31,-135.98C151413.49,-135.98 151438.66,-135.98 151463.84,-135.98"/>
<polygon fill="black" stroke="black" points="151463.87,-139.48 151473.87,-135.98 151463.87,-132.48 151463.87,-139.48"/>
</g>
<!-- attn_input_l4_dp1 -->
<g id="node501" class="node">
<title>attn_input_l4_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="152016" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="152016" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L4</text>
<text text-anchor="middle" x="152016" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="152016" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer3_output_dp1&#45;&gt;attn_input_l4_dp1 -->
<g id="edge840" class="edge">
<title>layer3_output_dp1&#45;&gt;attn_input_l4_dp1</title>
<path fill="none" stroke="black" d="M151812.01,-135.98C151820.23,-135.98 151828.44,-135.98 151836.66,-135.98"/>
<polygon fill="black" stroke="black" points="151836.68,-139.48 151846.68,-135.98 151836.68,-132.48 151836.68,-139.48"/>
</g>
<!-- attn_tp0_l4_dp1 -->
<g id="node502" class="node">
<title>attn_tp0_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="153314,-161.98 153054,-161.98 153054,-109.98 153314,-109.98 153314,-161.98"/>
<text text-anchor="middle" x="153184" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L4</text>
<text text-anchor="middle" x="153184" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="153184" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="153184" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp1&#45;&gt;attn_tp0_l4_dp1 -->
<g id="edge841" class="edge">
<title>attn_input_l4_dp1&#45;&gt;attn_tp0_l4_dp1</title>
<path fill="none" stroke="black" d="M152099.52,-161.26C152136.12,-171.09 152179.81,-181.13 152220,-185.98 152265,-191.42 152991.27,-193.33 153036,-185.98 153061.4,-181.81 153088.31,-173.85 153112.12,-165.5"/>
<polygon fill="black" stroke="black" points="153113.55,-168.71 153121.78,-162.03 153111.18,-162.12 153113.55,-168.71"/>
</g>
<!-- attn_tp1_l4_dp1 -->
<g id="node503" class="node">
<title>attn_tp1_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="153036,-161.98 152776,-161.98 152776,-109.98 153036,-109.98 153036,-161.98"/>
<text text-anchor="middle" x="152906" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L4</text>
<text text-anchor="middle" x="152906" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="152906" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="152906" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp1&#45;&gt;attn_tp1_l4_dp1 -->
<g id="edge842" class="edge">
<title>attn_input_l4_dp1&#45;&gt;attn_tp1_l4_dp1</title>
<path fill="none" stroke="black" d="M152099.52,-161.26C152136.12,-171.09 152179.81,-181.13 152220,-185.98 152279.35,-193.15 152699.01,-195.68 152758,-185.98 152783.4,-181.81 152810.31,-173.85 152834.12,-165.5"/>
<polygon fill="black" stroke="black" points="152835.55,-168.71 152843.78,-162.03 152833.18,-162.12 152835.55,-168.71"/>
</g>
<!-- attn_tp2_l4_dp1 -->
<g id="node504" class="node">
<title>attn_tp2_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="152758,-161.98 152498,-161.98 152498,-109.98 152758,-109.98 152758,-161.98"/>
<text text-anchor="middle" x="152628" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L4</text>
<text text-anchor="middle" x="152628" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="152628" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="152628" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp1&#45;&gt;attn_tp2_l4_dp1 -->
<g id="edge843" class="edge">
<title>attn_input_l4_dp1&#45;&gt;attn_tp2_l4_dp1</title>
<path fill="none" stroke="black" d="M152099.52,-161.26C152136.12,-171.09 152179.81,-181.13 152220,-185.98 152277.36,-192.91 152422.99,-195.35 152480,-185.98 152505.4,-181.81 152532.31,-173.85 152556.12,-165.5"/>
<polygon fill="black" stroke="black" points="152557.55,-168.71 152565.78,-162.03 152555.18,-162.12 152557.55,-168.71"/>
</g>
<!-- attn_tp3_l4_dp1 -->
<g id="node505" class="node">
<title>attn_tp3_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="152480,-161.98 152220,-161.98 152220,-109.98 152480,-109.98 152480,-161.98"/>
<text text-anchor="middle" x="152350" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L4</text>
<text text-anchor="middle" x="152350" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="152350" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="152350" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp1&#45;&gt;attn_tp3_l4_dp1 -->
<g id="edge844" class="edge">
<title>attn_input_l4_dp1&#45;&gt;attn_tp3_l4_dp1</title>
<path fill="none" stroke="black" d="M152185.28,-135.98C152193.35,-135.98 152201.42,-135.98 152209.49,-135.98"/>
<polygon fill="black" stroke="black" points="152209.7,-139.48 152219.7,-135.98 152209.7,-132.48 152209.7,-139.48"/>
</g>
<!-- allreduce_l4_dp1 -->
<g id="node506" class="node">
<title>allreduce_l4_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="153518" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="153518" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L4</text>
<text text-anchor="middle" x="153518" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="153518" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l4_dp1&#45;&gt;allreduce_l4_dp1 -->
<g id="edge845" class="edge">
<title>attn_tp0_l4_dp1&#45;&gt;allreduce_l4_dp1</title>
<path fill="none" stroke="black" d="M153314.14,-135.98C153322.35,-135.98 153330.56,-135.98 153338.77,-135.98"/>
<polygon fill="black" stroke="black" points="153338.78,-139.48 153348.78,-135.98 153338.78,-132.48 153338.78,-139.48"/>
</g>
<!-- attn_tp1_l4_dp1&#45;&gt;allreduce_l4_dp1 -->
<g id="edge846" class="edge">
<title>attn_tp1_l4_dp1&#45;&gt;allreduce_l4_dp1</title>
<path fill="none" stroke="black" d="M152968.22,-162.03C152994.24,-171.59 153025.1,-181.23 153054,-185.98 153111.01,-195.35 153256.64,-192.91 153314,-185.98 153350.57,-181.57 153390.05,-172.85 153424.44,-163.91"/>
<polygon fill="black" stroke="black" points="153425.7,-167.2 153434.47,-161.26 153423.91,-160.43 153425.7,-167.2"/>
</g>
<!-- attn_tp2_l4_dp1&#45;&gt;allreduce_l4_dp1 -->
<g id="edge847" class="edge">
<title>attn_tp2_l4_dp1&#45;&gt;allreduce_l4_dp1</title>
<path fill="none" stroke="black" d="M152690.22,-162.03C152716.24,-171.59 152747.1,-181.23 152776,-185.98 152834.98,-195.68 153254.65,-193.15 153314,-185.98 153350.57,-181.57 153390.05,-172.85 153424.44,-163.91"/>
<polygon fill="black" stroke="black" points="153425.7,-167.2 153434.47,-161.26 153423.91,-160.43 153425.7,-167.2"/>
</g>
<!-- attn_tp3_l4_dp1&#45;&gt;allreduce_l4_dp1 -->
<g id="edge848" class="edge">
<title>attn_tp3_l4_dp1&#45;&gt;allreduce_l4_dp1</title>
<path fill="none" stroke="black" d="M152412.22,-162.03C152438.24,-171.59 152469.1,-181.23 152498,-185.98 152542.73,-193.33 153268.99,-191.42 153314,-185.98 153350.57,-181.57 153390.05,-172.85 153424.44,-163.91"/>
<polygon fill="black" stroke="black" points="153425.7,-167.2 153434.47,-161.26 153423.91,-160.43 153425.7,-167.2"/>
</g>
<!-- moe_input_l4_dp1 -->
<g id="node507" class="node">
<title>moe_input_l4_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="153891" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="153891" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L4</text>
<text text-anchor="middle" x="153891" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="153891" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l4_dp1&#45;&gt;moe_input_l4_dp1 -->
<g id="edge849" class="edge">
<title>allreduce_l4_dp1&#45;&gt;moe_input_l4_dp1</title>
<path fill="none" stroke="black" d="M153687.01,-135.98C153695.23,-135.98 153703.44,-135.98 153711.66,-135.98"/>
<polygon fill="black" stroke="black" points="153711.68,-139.48 153721.68,-135.98 153711.68,-132.48 153711.68,-139.48"/>
</g>
<!-- router_l4_dp1 -->
<g id="node508" class="node">
<title>router_l4_dp1</title>
<polygon fill="lightyellow" stroke="black" points="154590.57,-176.98 154196.74,-176.98 154095.43,-94.98 154489.26,-94.98 154590.57,-176.98"/>
<text text-anchor="middle" x="154343" y="-144.48" font-family="Arial" font-size="10.00">Router L4</text>
<text text-anchor="middle" x="154343" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="154343" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l4_dp1&#45;&gt;router_l4_dp1 -->
<g id="edge850" class="edge">
<title>moe_input_l4_dp1&#45;&gt;router_l4_dp1</title>
<path fill="none" stroke="black" d="M154060.06,-135.98C154085.34,-135.98 154110.63,-135.98 154135.92,-135.98"/>
<polygon fill="black" stroke="black" points="154135.99,-139.48 154145.99,-135.98 154135.99,-132.48 154135.99,-139.48"/>
</g>
<!-- expert0_l4_dp1 -->
<g id="node509" class="node">
<title>expert0_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="158644.5,-161.98 158415.5,-161.98 158415.5,-109.98 158644.5,-109.98 158644.5,-161.98"/>
<text text-anchor="middle" x="158530" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L4</text>
<text text-anchor="middle" x="158530" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="158530" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="158530" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert0_l4_dp1 -->
<g id="edge851" class="edge">
<title>router_l4_dp1&#45;&gt;expert0_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.95,-169.07C154611.21,-172.29 154641.79,-175.07 154671,-176.98 155430.17,-226.7 157333.71,-196.54 158094.5,-198.98 158233.29,-199.43 158269.99,-204.63 158406,-176.98 158420.85,-173.96 158436.41,-169.72 158451.28,-165.11"/>
<polygon fill="black" stroke="black" points="158452.48,-168.4 158460.94,-162.03 158450.35,-161.73 158452.48,-168.4"/>
<text text-anchor="middle" x="158116" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l4_dp1 -->
<g id="node510" class="node">
<title>expert1_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="158397.5,-161.98 158168.5,-161.98 158168.5,-109.98 158397.5,-109.98 158397.5,-161.98"/>
<text text-anchor="middle" x="158283" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L4</text>
<text text-anchor="middle" x="158283" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="158283" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="158283" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert1_l4_dp1 -->
<g id="edge852" class="edge">
<title>router_l4_dp1&#45;&gt;expert1_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.95,-169.05C154611.21,-172.28 154641.79,-175.06 154671,-176.98 155362.08,-222.46 157094.93,-196.54 157787.5,-198.98 157952.9,-199.57 157996.67,-208.72 158159,-176.98 158174.06,-174.04 158189.82,-169.78 158204.86,-165.12"/>
<polygon fill="black" stroke="black" points="158206.17,-168.38 158214.63,-162.01 158204.04,-161.71 158206.17,-168.38"/>
<text text-anchor="middle" x="157809" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l4_dp1 -->
<g id="node511" class="node">
<title>expert2_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="158150.5,-161.98 157921.5,-161.98 157921.5,-109.98 158150.5,-109.98 158150.5,-161.98"/>
<text text-anchor="middle" x="158036" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L4</text>
<text text-anchor="middle" x="158036" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="158036" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="158036" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert2_l4_dp1 -->
<g id="edge853" class="edge">
<title>router_l4_dp1&#45;&gt;expert2_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.95,-169.03C154611.21,-172.26 154641.79,-175.05 154671,-176.98 155280.68,-217.39 156809.48,-196.54 157420.5,-198.98 157639.16,-199.86 157697.03,-217.03 157912,-176.98 157927.27,-174.14 157943.24,-169.88 157958.45,-165.17"/>
<polygon fill="black" stroke="black" points="157959.86,-168.4 157968.32,-162.02 157957.73,-161.73 157959.86,-168.4"/>
<text text-anchor="middle" x="157442" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l4_dp1 -->
<g id="node512" class="node">
<title>expert3_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="157903.5,-161.98 157674.5,-161.98 157674.5,-109.98 157903.5,-109.98 157903.5,-161.98"/>
<text text-anchor="middle" x="157789" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L4</text>
<text text-anchor="middle" x="157789" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="157789" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="157789" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert3_l4_dp1 -->
<g id="edge854" class="edge">
<title>router_l4_dp1&#45;&gt;expert3_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154488.67,-176.99C154527.3,-186.08 154569.21,-194.39 154608.5,-198.98 154627.48,-201.2 154632.39,-199.05 154651.5,-198.98 154986.34,-197.76 157334.61,-231.42 157665,-176.98 157680.93,-174.36 157697.6,-170.02 157713.35,-165.13"/>
<polygon fill="black" stroke="black" points="157714.58,-168.41 157723.03,-162.02 157712.44,-161.74 157714.58,-168.41"/>
<text text-anchor="middle" x="154630" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l4_dp1 -->
<g id="node513" class="node">
<title>expert4_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="157656.5,-161.98 157427.5,-161.98 157427.5,-109.98 157656.5,-109.98 157656.5,-161.98"/>
<text text-anchor="middle" x="157542" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L4</text>
<text text-anchor="middle" x="157542" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="157542" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="157542" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert4_l4_dp1 -->
<g id="edge855" class="edge">
<title>router_l4_dp1&#45;&gt;expert4_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.95,-168.98C154611.21,-172.22 154641.8,-175.02 154671,-176.98 155172.67,-210.66 156430.7,-196.54 156933.5,-198.98 157149.05,-200.03 157206.1,-216.54 157418,-176.98 157433.27,-174.13 157449.24,-169.87 157464.45,-165.16"/>
<polygon fill="black" stroke="black" points="157465.86,-168.39 157474.32,-162.01 157463.73,-161.72 157465.86,-168.39"/>
<text text-anchor="middle" x="156955" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l4_dp1 -->
<g id="node514" class="node">
<title>expert5_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="157409.5,-161.98 157180.5,-161.98 157180.5,-109.98 157409.5,-109.98 157409.5,-161.98"/>
<text text-anchor="middle" x="157295" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L4</text>
<text text-anchor="middle" x="157295" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="157295" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="157295" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert5_l4_dp1 -->
<g id="edge856" class="edge">
<title>router_l4_dp1&#45;&gt;expert5_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154515.37,-177C154560.98,-186.1 154610.37,-194.39 154656.5,-198.98 154675.52,-200.87 154680.39,-199.07 154699.5,-198.98 154974.12,-197.76 156900.07,-221.85 157171,-176.98 157186.93,-174.34 157203.59,-170 157219.35,-165.11"/>
<polygon fill="black" stroke="black" points="157220.58,-168.39 157229.03,-162 157218.44,-161.72 157220.58,-168.39"/>
<text text-anchor="middle" x="154678" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l4_dp1 -->
<g id="node515" class="node">
<title>expert6_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="157162.5,-161.98 156933.5,-161.98 156933.5,-109.98 157162.5,-109.98 157162.5,-161.98"/>
<text text-anchor="middle" x="157048" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L4</text>
<text text-anchor="middle" x="157048" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="157048" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="157048" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert6_l4_dp1 -->
<g id="edge857" class="edge">
<title>router_l4_dp1&#45;&gt;expert6_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.96,-168.9C154611.22,-172.15 154641.8,-174.98 154671,-176.98 155075.75,-204.69 156090.94,-209.41 156496.5,-198.98 156686.69,-194.09 156737.01,-212.05 156924,-176.98 156939.26,-174.12 156955.24,-169.85 156970.45,-165.14"/>
<polygon fill="black" stroke="black" points="156971.85,-168.37 156980.32,-161.99 156969.73,-161.7 156971.85,-168.37"/>
<text text-anchor="middle" x="156475" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l4_dp1 -->
<g id="node516" class="node">
<title>expert7_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="156915.5,-161.98 156686.5,-161.98 156686.5,-109.98 156915.5,-109.98 156915.5,-161.98"/>
<text text-anchor="middle" x="156801" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L4</text>
<text text-anchor="middle" x="156801" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="156801" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="156801" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert7_l4_dp1 -->
<g id="edge858" class="edge">
<title>router_l4_dp1&#45;&gt;expert7_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154542.02,-177C154594.62,-186.1 154651.5,-194.4 154704.5,-198.98 154723.54,-200.63 154728.39,-199.09 154747.5,-198.98 154961.9,-197.76 156465.52,-212.28 156677,-176.98 156692.83,-174.34 156709.4,-170.02 156725.07,-165.16"/>
<polygon fill="black" stroke="black" points="156726.25,-168.46 156734.7,-162.07 156724.11,-161.79 156726.25,-168.46"/>
<text text-anchor="middle" x="154726" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l4_dp1 -->
<g id="node517" class="node">
<title>expert8_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="156668.5,-161.98 156439.5,-161.98 156439.5,-109.98 156668.5,-109.98 156668.5,-161.98"/>
<text text-anchor="middle" x="156554" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L4</text>
<text text-anchor="middle" x="156554" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="156554" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="156554" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert8_l4_dp1 -->
<g id="edge859" class="edge">
<title>router_l4_dp1&#45;&gt;expert8_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.52,-168.73C154610.92,-172.02 154641.66,-174.91 154671,-176.98 154972.4,-198.28 155728.46,-207.29 156030.5,-198.98 156208.26,-194.09 156255.28,-210.07 156430,-176.98 156445.17,-174.11 156461.04,-169.87 156476.16,-165.18"/>
<polygon fill="black" stroke="black" points="156477.52,-168.42 156485.98,-162.05 156475.39,-161.75 156477.52,-168.42"/>
<text text-anchor="middle" x="156009" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l4_dp1 -->
<g id="node518" class="node">
<title>expert9_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="156421.5,-161.98 156192.5,-161.98 156192.5,-109.98 156421.5,-109.98 156421.5,-161.98"/>
<text text-anchor="middle" x="156307" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L4</text>
<text text-anchor="middle" x="156307" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="156307" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="156307" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert9_l4_dp1 -->
<g id="edge860" class="edge">
<title>router_l4_dp1&#45;&gt;expert9_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154568.65,-177.01C154628.23,-186.11 154692.61,-194.4 154752.5,-198.98 154911,-211.1 156026.26,-203.5 156183,-176.98 156198.83,-174.3 156215.39,-169.97 156231.06,-165.1"/>
<polygon fill="black" stroke="black" points="156232.24,-168.4 156240.69,-162.01 156230.1,-161.74 156232.24,-168.4"/>
<text text-anchor="middle" x="154774" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l4_dp1 -->
<g id="node519" class="node">
<title>expert10_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="156174.5,-161.98 155945.5,-161.98 155945.5,-109.98 156174.5,-109.98 156174.5,-161.98"/>
<text text-anchor="middle" x="156060" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L4</text>
<text text-anchor="middle" x="156060" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="156060" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="156060" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert10_l4_dp1 -->
<g id="edge861" class="edge">
<title>router_l4_dp1&#45;&gt;expert10_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154580.1,-168.45C154610.64,-171.8 154641.53,-174.78 154671,-176.98 155079.53,-207.56 155183.04,-212.08 155592.5,-198.98 155745.4,-194.09 155785.82,-206.12 155936,-176.98 155951.06,-174.06 155966.83,-169.82 155981.87,-165.16"/>
<polygon fill="black" stroke="black" points="155983.17,-168.42 155991.64,-162.04 155981.05,-161.75 155983.17,-168.42"/>
<text text-anchor="middle" x="155571" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l4_dp1 -->
<g id="node520" class="node">
<title>expert11_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="155927.5,-161.98 155698.5,-161.98 155698.5,-109.98 155927.5,-109.98 155927.5,-161.98"/>
<text text-anchor="middle" x="155813" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L4</text>
<text text-anchor="middle" x="155813" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="155813" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="155813" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert11_l4_dp1 -->
<g id="edge862" class="edge">
<title>router_l4_dp1&#45;&gt;expert11_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154589.89,-176.28C154657.94,-185.66 154731.91,-194.28 154800.5,-198.98 154997.54,-212.49 155494.43,-210.92 155689,-176.98 155704.72,-174.24 155721.17,-169.91 155736.76,-165.06"/>
<polygon fill="black" stroke="black" points="155737.89,-168.38 155746.35,-161.99 155735.75,-161.71 155737.89,-168.38"/>
<text text-anchor="middle" x="154822" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l4_dp1 -->
<g id="node521" class="node">
<title>expert12_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="155680.5,-161.98 155451.5,-161.98 155451.5,-109.98 155680.5,-109.98 155680.5,-161.98"/>
<text text-anchor="middle" x="155566" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L4</text>
<text text-anchor="middle" x="155566" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="155566" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="155566" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert12_l4_dp1 -->
<g id="edge863" class="edge">
<title>router_l4_dp1&#45;&gt;expert12_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154579.25,-167.81C154610.07,-171.29 154641.26,-174.47 154671,-176.98 154671,-176.98 155442,-176.98 155442,-176.98 155456.65,-173.9 155472,-169.69 155486.7,-165.12"/>
<polygon fill="black" stroke="black" points="155487.79,-168.45 155496.26,-162.08 155485.67,-161.78 155487.79,-168.45"/>
<text text-anchor="middle" x="155189" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l4_dp1 -->
<g id="node522" class="node">
<title>expert13_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="155433.5,-161.98 155204.5,-161.98 155204.5,-109.98 155433.5,-109.98 155433.5,-161.98"/>
<text text-anchor="middle" x="155319" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L4</text>
<text text-anchor="middle" x="155319" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="155319" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="155319" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert13_l4_dp1 -->
<g id="edge864" class="edge">
<title>router_l4_dp1&#45;&gt;expert13_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154573.04,-176.98C154745.78,-200.57 154987.28,-218.19 155195,-176.98 155209.96,-174.01 155225.62,-169.78 155240.58,-165.14"/>
<polygon fill="black" stroke="black" points="155241.83,-168.41 155250.29,-162.04 155239.7,-161.74 155241.83,-168.41"/>
<text text-anchor="middle" x="154870" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l4_dp1 -->
<g id="node523" class="node">
<title>expert14_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="155186.5,-161.98 154957.5,-161.98 154957.5,-109.98 155186.5,-109.98 155186.5,-161.98"/>
<text text-anchor="middle" x="155072" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L4</text>
<text text-anchor="middle" x="155072" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="155072" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="155072" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert14_l4_dp1 -->
<g id="edge865" class="edge">
<title>router_l4_dp1&#45;&gt;expert14_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154582.4,-177C154717.73,-197.08 154872.84,-214.02 154939.5,-198.98 154967.7,-192.62 154996.94,-179.52 155020.75,-166.9"/>
<polygon fill="black" stroke="black" points="155022.48,-169.94 155029.6,-162.1 155019.14,-163.79 155022.48,-169.94"/>
<text text-anchor="middle" x="154918" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l4_dp1 -->
<g id="node524" class="node">
<title>expert15_l4_dp1</title>
<polygon fill="lightgreen" stroke="black" points="154909.5,-161.98 154680.5,-161.98 154680.5,-109.98 154909.5,-109.98 154909.5,-161.98"/>
<text text-anchor="middle" x="154795" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L4</text>
<text text-anchor="middle" x="154795" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="154795" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="154795" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp1&#45;&gt;expert15_l4_dp1 -->
<g id="edge866" class="edge">
<title>router_l4_dp1&#45;&gt;expert15_l4_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M154539.94,-135.98C154584.13,-135.98 154629.83,-135.98 154670.12,-135.98"/>
<polygon fill="black" stroke="black" points="154670.25,-139.48 154680.25,-135.98 154670.25,-132.48 154670.25,-139.48"/>
<text text-anchor="middle" x="154635.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l4_dp1 -->
<g id="node525" class="node">
<title>expert_agg_l4_dp1</title>
<polygon fill="lightyellow" stroke="black" points="159175.57,-176.98 158781.74,-176.98 158680.43,-94.98 159074.26,-94.98 159175.57,-176.98"/>
<text text-anchor="middle" x="158928" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L4</text>
<text text-anchor="middle" x="158928" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="158928" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge867" class="edge">
<title>expert0_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M158644.66,-135.98C158670.06,-135.98 158695.47,-135.98 158720.87,-135.98"/>
<polygon fill="black" stroke="black" points="158720.99,-139.48 158730.99,-135.98 158720.99,-132.48 158720.99,-139.48"/>
</g>
<!-- expert1_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge868" class="edge">
<title>expert1_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M158338.24,-162.02C158361.4,-171.57 158388.96,-181.22 158415,-185.98 158465.06,-195.15 158593.3,-190.41 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert2_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge869" class="edge">
<title>expert2_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M158091.24,-162.02C158114.4,-171.57 158141.96,-181.22 158168,-185.98 158220.02,-195.51 158591.31,-190.59 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert3_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge870" class="edge">
<title>expert3_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M157844.24,-162.02C157867.4,-171.57 157894.96,-181.22 157921,-185.98 158000.02,-200.45 158563.97,-192.97 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert4_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge871" class="edge">
<title>expert4_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M157597.24,-162.02C157620.4,-171.57 157647.96,-181.22 157674,-185.98 157727.01,-195.69 158590.31,-190.67 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert5_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge872" class="edge">
<title>expert5_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M157350.24,-162.02C157373.4,-171.57 157400.96,-181.22 157427,-185.98 157493.5,-198.16 158576.64,-191.87 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert6_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge873" class="edge">
<title>expert6_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M157103.24,-162.02C157126.4,-171.57 157153.96,-181.22 157180,-185.98 157260,-200.63 158562.97,-193.06 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert7_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge874" class="edge">
<title>expert7_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M156856.24,-162.02C156879.4,-171.57 156906.96,-181.22 156933,-185.98 156979.75,-194.54 158596.65,-190.12 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert8_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge875" class="edge">
<title>expert8_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M156609.24,-162.02C156632.4,-171.57 156659.96,-181.22 156686,-185.98 156739.5,-195.78 158589.82,-190.72 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert9_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge876" class="edge">
<title>expert9_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M156362.24,-162.02C156385.4,-171.57 156412.96,-181.22 156439,-185.98 156499.25,-197.01 158582.98,-191.31 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert10_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge877" class="edge">
<title>expert10_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M156115.24,-162.02C156138.4,-171.57 156165.96,-181.22 156192,-185.98 156259,-198.25 158576.15,-191.91 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert11_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge878" class="edge">
<title>expert11_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M155868.24,-162.02C155891.4,-171.57 155918.96,-181.22 155945,-185.98 156018.75,-199.48 158569.31,-192.51 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert12_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge879" class="edge">
<title>expert12_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M155621.24,-162.02C155644.4,-171.57 155671.96,-181.22 155698,-185.98 155778.49,-200.72 158562.48,-193.1 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert13_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge880" class="edge">
<title>expert13_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M155374.24,-162.02C155397.4,-171.57 155424.96,-181.22 155451,-185.98 155494.62,-193.97 158599.82,-189.84 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert14_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge881" class="edge">
<title>expert14_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M155127.24,-162.02C155150.4,-171.57 155177.96,-181.22 155204,-185.98 155251,-194.59 158596.4,-190.14 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- expert15_l4_dp1&#45;&gt;expert_agg_l4_dp1 -->
<g id="edge882" class="edge">
<title>expert15_l4_dp1&#45;&gt;expert_agg_l4_dp1</title>
<path fill="none" stroke="black" d="M154863.31,-162.04C154891.82,-171.6 154925.57,-181.24 154957,-185.98 155007.63,-193.62 158592.98,-190.44 158644,-185.98 158682.11,-182.65 158722.78,-176.86 158761.08,-170.36"/>
<polygon fill="black" stroke="black" points="158762.02,-173.75 158771.29,-168.6 158760.84,-166.85 158762.02,-173.75"/>
</g>
<!-- layer4_output_dp1 -->
<g id="node526" class="node">
<title>layer4_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="159380" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="159380" y="-144.48" font-family="Arial" font-size="10.00">Layer 4 Output</text>
<text text-anchor="middle" x="159380" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="159380" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l4_dp1&#45;&gt;layer4_output_dp1 -->
<g id="edge883" class="edge">
<title>expert_agg_l4_dp1&#45;&gt;layer4_output_dp1</title>
<path fill="none" stroke="black" d="M159125.31,-135.98C159150.49,-135.98 159175.66,-135.98 159200.84,-135.98"/>
<polygon fill="black" stroke="black" points="159200.87,-139.48 159210.87,-135.98 159200.87,-132.48 159200.87,-139.48"/>
</g>
<!-- attn_input_l5_dp1 -->
<g id="node527" class="node">
<title>attn_input_l5_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="159753" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="159753" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L5</text>
<text text-anchor="middle" x="159753" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="159753" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer4_output_dp1&#45;&gt;attn_input_l5_dp1 -->
<g id="edge884" class="edge">
<title>layer4_output_dp1&#45;&gt;attn_input_l5_dp1</title>
<path fill="none" stroke="black" d="M159549.01,-135.98C159557.23,-135.98 159565.44,-135.98 159573.66,-135.98"/>
<polygon fill="black" stroke="black" points="159573.68,-139.48 159583.68,-135.98 159573.68,-132.48 159573.68,-139.48"/>
</g>
<!-- attn_tp0_l5_dp1 -->
<g id="node528" class="node">
<title>attn_tp0_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="161051,-161.98 160791,-161.98 160791,-109.98 161051,-109.98 161051,-161.98"/>
<text text-anchor="middle" x="160921" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L5</text>
<text text-anchor="middle" x="160921" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="160921" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160921" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp1&#45;&gt;attn_tp0_l5_dp1 -->
<g id="edge885" class="edge">
<title>attn_input_l5_dp1&#45;&gt;attn_tp0_l5_dp1</title>
<path fill="none" stroke="black" d="M159836.52,-161.26C159873.12,-171.09 159916.81,-181.13 159957,-185.98 160002,-191.42 160728.27,-193.33 160773,-185.98 160798.4,-181.81 160825.31,-173.85 160849.12,-165.5"/>
<polygon fill="black" stroke="black" points="160850.55,-168.71 160858.78,-162.03 160848.18,-162.12 160850.55,-168.71"/>
</g>
<!-- attn_tp1_l5_dp1 -->
<g id="node529" class="node">
<title>attn_tp1_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="160773,-161.98 160513,-161.98 160513,-109.98 160773,-109.98 160773,-161.98"/>
<text text-anchor="middle" x="160643" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L5</text>
<text text-anchor="middle" x="160643" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="160643" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160643" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp1&#45;&gt;attn_tp1_l5_dp1 -->
<g id="edge886" class="edge">
<title>attn_input_l5_dp1&#45;&gt;attn_tp1_l5_dp1</title>
<path fill="none" stroke="black" d="M159836.52,-161.26C159873.12,-171.09 159916.81,-181.13 159957,-185.98 160016.35,-193.15 160436.01,-195.68 160495,-185.98 160520.4,-181.81 160547.31,-173.85 160571.12,-165.5"/>
<polygon fill="black" stroke="black" points="160572.55,-168.71 160580.78,-162.03 160570.18,-162.12 160572.55,-168.71"/>
</g>
<!-- attn_tp2_l5_dp1 -->
<g id="node530" class="node">
<title>attn_tp2_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="160495,-161.98 160235,-161.98 160235,-109.98 160495,-109.98 160495,-161.98"/>
<text text-anchor="middle" x="160365" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L5</text>
<text text-anchor="middle" x="160365" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="160365" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160365" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp1&#45;&gt;attn_tp2_l5_dp1 -->
<g id="edge887" class="edge">
<title>attn_input_l5_dp1&#45;&gt;attn_tp2_l5_dp1</title>
<path fill="none" stroke="black" d="M159836.52,-161.26C159873.12,-171.09 159916.81,-181.13 159957,-185.98 160014.36,-192.91 160159.99,-195.35 160217,-185.98 160242.4,-181.81 160269.31,-173.85 160293.12,-165.5"/>
<polygon fill="black" stroke="black" points="160294.55,-168.71 160302.78,-162.03 160292.18,-162.12 160294.55,-168.71"/>
</g>
<!-- attn_tp3_l5_dp1 -->
<g id="node531" class="node">
<title>attn_tp3_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="160217,-161.98 159957,-161.98 159957,-109.98 160217,-109.98 160217,-161.98"/>
<text text-anchor="middle" x="160087" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L5</text>
<text text-anchor="middle" x="160087" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="160087" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="160087" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp1&#45;&gt;attn_tp3_l5_dp1 -->
<g id="edge888" class="edge">
<title>attn_input_l5_dp1&#45;&gt;attn_tp3_l5_dp1</title>
<path fill="none" stroke="black" d="M159922.28,-135.98C159930.35,-135.98 159938.42,-135.98 159946.49,-135.98"/>
<polygon fill="black" stroke="black" points="159946.7,-139.48 159956.7,-135.98 159946.7,-132.48 159946.7,-139.48"/>
</g>
<!-- allreduce_l5_dp1 -->
<g id="node532" class="node">
<title>allreduce_l5_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="161255" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="161255" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L5</text>
<text text-anchor="middle" x="161255" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="161255" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l5_dp1&#45;&gt;allreduce_l5_dp1 -->
<g id="edge889" class="edge">
<title>attn_tp0_l5_dp1&#45;&gt;allreduce_l5_dp1</title>
<path fill="none" stroke="black" d="M161051.14,-135.98C161059.35,-135.98 161067.56,-135.98 161075.77,-135.98"/>
<polygon fill="black" stroke="black" points="161075.78,-139.48 161085.78,-135.98 161075.78,-132.48 161075.78,-139.48"/>
</g>
<!-- attn_tp1_l5_dp1&#45;&gt;allreduce_l5_dp1 -->
<g id="edge890" class="edge">
<title>attn_tp1_l5_dp1&#45;&gt;allreduce_l5_dp1</title>
<path fill="none" stroke="black" d="M160705.22,-162.03C160731.24,-171.59 160762.1,-181.23 160791,-185.98 160848.01,-195.35 160993.64,-192.91 161051,-185.98 161087.57,-181.57 161127.05,-172.85 161161.44,-163.91"/>
<polygon fill="black" stroke="black" points="161162.7,-167.2 161171.47,-161.26 161160.91,-160.43 161162.7,-167.2"/>
</g>
<!-- attn_tp2_l5_dp1&#45;&gt;allreduce_l5_dp1 -->
<g id="edge891" class="edge">
<title>attn_tp2_l5_dp1&#45;&gt;allreduce_l5_dp1</title>
<path fill="none" stroke="black" d="M160427.22,-162.03C160453.24,-171.59 160484.1,-181.23 160513,-185.98 160571.98,-195.68 160991.65,-193.15 161051,-185.98 161087.57,-181.57 161127.05,-172.85 161161.44,-163.91"/>
<polygon fill="black" stroke="black" points="161162.7,-167.2 161171.47,-161.26 161160.91,-160.43 161162.7,-167.2"/>
</g>
<!-- attn_tp3_l5_dp1&#45;&gt;allreduce_l5_dp1 -->
<g id="edge892" class="edge">
<title>attn_tp3_l5_dp1&#45;&gt;allreduce_l5_dp1</title>
<path fill="none" stroke="black" d="M160149.22,-162.03C160175.24,-171.59 160206.1,-181.23 160235,-185.98 160279.73,-193.33 161005.99,-191.42 161051,-185.98 161087.57,-181.57 161127.05,-172.85 161161.44,-163.91"/>
<polygon fill="black" stroke="black" points="161162.7,-167.2 161171.47,-161.26 161160.91,-160.43 161162.7,-167.2"/>
</g>
<!-- moe_input_l5_dp1 -->
<g id="node533" class="node">
<title>moe_input_l5_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="161628" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="161628" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L5</text>
<text text-anchor="middle" x="161628" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="161628" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l5_dp1&#45;&gt;moe_input_l5_dp1 -->
<g id="edge893" class="edge">
<title>allreduce_l5_dp1&#45;&gt;moe_input_l5_dp1</title>
<path fill="none" stroke="black" d="M161424.01,-135.98C161432.23,-135.98 161440.44,-135.98 161448.66,-135.98"/>
<polygon fill="black" stroke="black" points="161448.68,-139.48 161458.68,-135.98 161448.68,-132.48 161448.68,-139.48"/>
</g>
<!-- router_l5_dp1 -->
<g id="node534" class="node">
<title>router_l5_dp1</title>
<polygon fill="lightyellow" stroke="black" points="162327.57,-176.98 161933.74,-176.98 161832.43,-94.98 162226.26,-94.98 162327.57,-176.98"/>
<text text-anchor="middle" x="162080" y="-144.48" font-family="Arial" font-size="10.00">Router L5</text>
<text text-anchor="middle" x="162080" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="162080" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l5_dp1&#45;&gt;router_l5_dp1 -->
<g id="edge894" class="edge">
<title>moe_input_l5_dp1&#45;&gt;router_l5_dp1</title>
<path fill="none" stroke="black" d="M161797.06,-135.98C161822.34,-135.98 161847.63,-135.98 161872.92,-135.98"/>
<polygon fill="black" stroke="black" points="161872.99,-139.48 161882.99,-135.98 161872.99,-132.48 161872.99,-139.48"/>
</g>
<!-- expert0_l5_dp1 -->
<g id="node535" class="node">
<title>expert0_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="166333.5,-161.98 166104.5,-161.98 166104.5,-109.98 166333.5,-109.98 166333.5,-161.98"/>
<text text-anchor="middle" x="166219" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L5</text>
<text text-anchor="middle" x="166219" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="166219" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="166219" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert0_l5_dp1 -->
<g id="edge895" class="edge">
<title>router_l5_dp1&#45;&gt;expert0_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.74,-171.32C162342.09,-173.59 162363.41,-175.53 162384,-176.98 163144.47,-230.48 165052.15,-196.54 165814.5,-198.98 165939.55,-199.38 165972.59,-202.54 166095,-176.98 166109.75,-173.9 166125.19,-169.66 166139.98,-165.07"/>
<polygon fill="black" stroke="black" points="166141.12,-168.37 166149.59,-162 166139,-161.7 166141.12,-168.37"/>
<text text-anchor="middle" x="165836" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l5_dp1 -->
<g id="node536" class="node">
<title>expert1_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="166086.5,-161.98 165857.5,-161.98 165857.5,-109.98 166086.5,-109.98 166086.5,-161.98"/>
<text text-anchor="middle" x="165972" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L5</text>
<text text-anchor="middle" x="165972" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="165972" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="165972" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert1_l5_dp1 -->
<g id="edge896" class="edge">
<title>router_l5_dp1&#45;&gt;expert1_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.74,-171.31C162342.09,-173.58 162363.41,-175.53 162384,-176.98 163083.05,-226.36 164836.71,-196.54 165537.5,-198.98 165675.84,-199.47 165712.43,-204.56 165848,-176.98 165862.85,-173.96 165878.41,-169.72 165893.28,-165.11"/>
<polygon fill="black" stroke="black" points="165894.48,-168.4 165902.94,-162.03 165892.35,-161.73 165894.48,-168.4"/>
<text text-anchor="middle" x="165559" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l5_dp1 -->
<g id="node537" class="node">
<title>expert2_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="165839.5,-161.98 165610.5,-161.98 165610.5,-109.98 165839.5,-109.98 165839.5,-161.98"/>
<text text-anchor="middle" x="165725" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L5</text>
<text text-anchor="middle" x="165725" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="165725" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="165725" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert2_l5_dp1 -->
<g id="edge897" class="edge">
<title>router_l5_dp1&#45;&gt;expert2_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.74,-171.29C162342.1,-173.56 162363.41,-175.52 162384,-176.98 163015.21,-221.81 164598.71,-196.54 165231.5,-198.98 165396.01,-199.62 165439.55,-208.59 165601,-176.98 165616.06,-174.03 165631.82,-169.78 165646.86,-165.12"/>
<polygon fill="black" stroke="black" points="165648.17,-168.37 165656.63,-162 165646.04,-161.71 165648.17,-168.37"/>
<text text-anchor="middle" x="165253" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l5_dp1 -->
<g id="node538" class="node">
<title>expert3_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="165592.5,-161.98 165363.5,-161.98 165363.5,-109.98 165592.5,-109.98 165592.5,-161.98"/>
<text text-anchor="middle" x="165478" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L5</text>
<text text-anchor="middle" x="165478" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="165478" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="165478" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert3_l5_dp1 -->
<g id="edge898" class="edge">
<title>router_l5_dp1&#45;&gt;expert3_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.74,-171.27C162342.1,-173.54 162363.41,-175.51 162384,-176.98 162934.28,-216.37 164314.82,-196.54 164866.5,-198.98 165083.38,-199.94 165140.79,-216.75 165354,-176.98 165369.27,-174.14 165385.24,-169.88 165400.45,-165.17"/>
<polygon fill="black" stroke="black" points="165401.86,-168.39 165410.32,-162.01 165399.73,-161.72 165401.86,-168.39"/>
<text text-anchor="middle" x="164888" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l5_dp1 -->
<g id="node539" class="node">
<title>expert4_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="165345.5,-161.98 165116.5,-161.98 165116.5,-109.98 165345.5,-109.98 165345.5,-161.98"/>
<text text-anchor="middle" x="165231" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L5</text>
<text text-anchor="middle" x="165231" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="165231" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="165231" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert4_l5_dp1 -->
<g id="edge899" class="edge">
<title>router_l5_dp1&#45;&gt;expert4_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162225.67,-176.99C162264.3,-186.08 162306.21,-194.39 162345.5,-198.98 162364.48,-201.2 162369.39,-199.06 162388.5,-198.98 162690.56,-197.76 164808.97,-226.21 165107,-176.98 165122.93,-174.35 165139.6,-170.01 165155.35,-165.12"/>
<polygon fill="black" stroke="black" points="165156.58,-168.4 165165.03,-162.01 165154.44,-161.73 165156.58,-168.4"/>
<text text-anchor="middle" x="162367" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l5_dp1 -->
<g id="node540" class="node">
<title>expert5_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="165098.5,-161.98 164869.5,-161.98 164869.5,-109.98 165098.5,-109.98 165098.5,-161.98"/>
<text text-anchor="middle" x="164984" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L5</text>
<text text-anchor="middle" x="164984" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="164984" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="164984" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert5_l5_dp1 -->
<g id="edge900" class="edge">
<title>router_l5_dp1&#45;&gt;expert5_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.74,-171.22C162342.1,-173.51 162363.42,-175.49 162384,-176.98 162827.19,-209.18 163939.15,-196.54 164383.5,-198.98 164595.5,-200.15 164651.61,-215.98 164860,-176.98 164875.26,-174.13 164891.24,-169.86 164906.45,-165.15"/>
<polygon fill="black" stroke="black" points="164907.86,-168.37 164916.32,-162 164905.73,-161.71 164907.86,-168.37"/>
<text text-anchor="middle" x="164405" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l5_dp1 -->
<g id="node541" class="node">
<title>expert6_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="164851.5,-161.98 164622.5,-161.98 164622.5,-109.98 164851.5,-109.98 164851.5,-161.98"/>
<text text-anchor="middle" x="164737" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L5</text>
<text text-anchor="middle" x="164737" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="164737" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="164737" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert6_l5_dp1 -->
<g id="edge901" class="edge">
<title>router_l5_dp1&#45;&gt;expert6_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162252.37,-177C162297.98,-186.1 162347.37,-194.39 162393.5,-198.98 162412.52,-200.87 162417.39,-199.08 162436.5,-198.98 162678.34,-197.76 164374.43,-216.64 164613,-176.98 164628.84,-174.35 164645.4,-170.04 164661.07,-165.18"/>
<polygon fill="black" stroke="black" points="164662.25,-168.47 164670.7,-162.09 164660.11,-161.81 164662.25,-168.47"/>
<text text-anchor="middle" x="162415" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l5_dp1 -->
<g id="node542" class="node">
<title>expert7_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="164604.5,-161.98 164375.5,-161.98 164375.5,-109.98 164604.5,-109.98 164604.5,-161.98"/>
<text text-anchor="middle" x="164490" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L5</text>
<text text-anchor="middle" x="164490" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="164490" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="164490" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert7_l5_dp1 -->
<g id="edge902" class="edge">
<title>router_l5_dp1&#45;&gt;expert7_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.33,-171.1C162341.83,-173.42 162363.29,-175.44 162384,-176.98 162732.07,-202.87 163605.59,-208.3 163954.5,-198.98 164137.58,-194.09 164186.02,-210.92 164366,-176.98 164381.17,-174.12 164397.04,-169.88 164412.17,-165.2"/>
<polygon fill="black" stroke="black" points="164413.52,-168.44 164421.99,-162.07 164411.4,-161.77 164413.52,-168.44"/>
<text text-anchor="middle" x="163933" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l5_dp1 -->
<g id="node543" class="node">
<title>expert8_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="164357.5,-161.98 164128.5,-161.98 164128.5,-109.98 164357.5,-109.98 164357.5,-161.98"/>
<text text-anchor="middle" x="164243" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L5</text>
<text text-anchor="middle" x="164243" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="164243" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="164243" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert8_l5_dp1 -->
<g id="edge903" class="edge">
<title>router_l5_dp1&#45;&gt;expert8_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162279.02,-177C162331.62,-186.1 162388.5,-194.4 162441.5,-198.98 162460.54,-200.63 162465.39,-199.11 162484.5,-198.98 162666.12,-197.76 163939.88,-207.07 164119,-176.98 164134.83,-174.32 164151.39,-170 164167.07,-165.13"/>
<polygon fill="black" stroke="black" points="164168.24,-168.43 164176.7,-162.04 164166.1,-161.77 164168.24,-168.43"/>
<text text-anchor="middle" x="162463" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l5_dp1 -->
<g id="node544" class="node">
<title>expert9_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="164110.5,-161.98 163881.5,-161.98 163881.5,-109.98 164110.5,-109.98 164110.5,-161.98"/>
<text text-anchor="middle" x="163996" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L5</text>
<text text-anchor="middle" x="163996" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="163996" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="163996" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert9_l5_dp1 -->
<g id="edge904" class="edge">
<title>router_l5_dp1&#45;&gt;expert9_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162320.35,-170.96C162341.84,-173.31 162363.29,-175.38 162384,-176.98 162880.17,-215.39 163006.07,-213.82 163503.5,-198.98 163667.49,-194.09 163710.87,-207.88 163872,-176.98 163887.16,-174.08 163903.03,-169.81 163918.15,-165.12"/>
<polygon fill="black" stroke="black" points="163919.51,-168.37 163927.97,-161.99 163917.38,-161.7 163919.51,-168.37"/>
<text text-anchor="middle" x="163482" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l5_dp1 -->
<g id="node545" class="node">
<title>expert10_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="163863.5,-161.98 163634.5,-161.98 163634.5,-109.98 163863.5,-109.98 163863.5,-161.98"/>
<text text-anchor="middle" x="163749" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L5</text>
<text text-anchor="middle" x="163749" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="163749" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="163749" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert10_l5_dp1 -->
<g id="edge905" class="edge">
<title>router_l5_dp1&#45;&gt;expert10_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162305.65,-177.01C162365.23,-186.11 162429.61,-194.4 162489.5,-198.98 162615.32,-208.6 163500.62,-198.3 163625,-176.98 163640.73,-174.29 163657.18,-169.97 163672.78,-165.14"/>
<polygon fill="black" stroke="black" points="163673.9,-168.45 163682.36,-162.07 163671.77,-161.78 163673.9,-168.45"/>
<text text-anchor="middle" x="162511" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l5_dp1 -->
<g id="node546" class="node">
<title>expert11_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="163616.5,-161.98 163387.5,-161.98 163387.5,-109.98 163616.5,-109.98 163616.5,-161.98"/>
<text text-anchor="middle" x="163502" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L5</text>
<text text-anchor="middle" x="163502" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="163502" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="163502" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert11_l5_dp1 -->
<g id="edge906" class="edge">
<title>router_l5_dp1&#45;&gt;expert11_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162319.95,-170.64C162341.58,-173.07 162363.17,-175.24 162384,-176.98 162699.71,-203.39 162779.92,-211.33 163096.5,-198.98 163221.9,-194.09 163254.97,-201.75 163378,-176.98 163392.86,-173.99 163408.42,-169.77 163423.29,-165.16"/>
<polygon fill="black" stroke="black" points="163424.48,-168.45 163432.95,-162.08 163422.36,-161.78 163424.48,-168.45"/>
<text text-anchor="middle" x="163075" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l5_dp1 -->
<g id="node547" class="node">
<title>expert12_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="163369.5,-161.98 163140.5,-161.98 163140.5,-109.98 163369.5,-109.98 163369.5,-161.98"/>
<text text-anchor="middle" x="163255" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L5</text>
<text text-anchor="middle" x="163255" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="163255" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="163255" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert12_l5_dp1 -->
<g id="edge907" class="edge">
<title>router_l5_dp1&#45;&gt;expert12_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162326.89,-176.28C162394.94,-185.66 162468.91,-194.28 162537.5,-198.98 162669.17,-208.01 163001.14,-200.56 163131,-176.98 163146.37,-174.19 163162.45,-169.93 163177.75,-165.2"/>
<polygon fill="black" stroke="black" points="163179.21,-168.41 163187.67,-162.03 163177.08,-161.74 163179.21,-168.41"/>
<text text-anchor="middle" x="162559" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l5_dp1 -->
<g id="node548" class="node">
<title>expert13_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="163122.5,-161.98 162893.5,-161.98 162893.5,-109.98 163122.5,-109.98 163122.5,-161.98"/>
<text text-anchor="middle" x="163008" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L5</text>
<text text-anchor="middle" x="163008" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="163008" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="163008" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert13_l5_dp1 -->
<g id="edge908" class="edge">
<title>router_l5_dp1&#45;&gt;expert13_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162297.82,-177.02C162434.96,-197.58 162615.66,-215.02 162775.5,-198.98 162826.66,-193.85 162882.31,-179.11 162926.33,-165.18"/>
<polygon fill="black" stroke="black" points="162927.66,-168.43 162936.11,-162.04 162925.52,-161.77 162927.66,-168.43"/>
<text text-anchor="middle" x="162754" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l5_dp1 -->
<g id="node549" class="node">
<title>expert14_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="162875.5,-161.98 162646.5,-161.98 162646.5,-109.98 162875.5,-109.98 162875.5,-161.98"/>
<text text-anchor="middle" x="162761" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L5</text>
<text text-anchor="middle" x="162761" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="162761" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="162761" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert14_l5_dp1 -->
<g id="edge909" class="edge">
<title>router_l5_dp1&#45;&gt;expert14_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162305.44,-176.99C162428.58,-196.39 162568.01,-212.63 162628.5,-198.98 162656.7,-192.62 162685.94,-179.52 162709.75,-166.9"/>
<polygon fill="black" stroke="black" points="162711.48,-169.94 162718.6,-162.1 162708.14,-163.79 162711.48,-169.94"/>
<text text-anchor="middle" x="162607" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l5_dp1 -->
<g id="node550" class="node">
<title>expert15_l5_dp1</title>
<polygon fill="lightgreen" stroke="black" points="162622.5,-161.98 162393.5,-161.98 162393.5,-109.98 162622.5,-109.98 162622.5,-161.98"/>
<text text-anchor="middle" x="162508" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L5</text>
<text text-anchor="middle" x="162508" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="162508" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="162508" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp1&#45;&gt;expert15_l5_dp1 -->
<g id="edge910" class="edge">
<title>router_l5_dp1&#45;&gt;expert15_l5_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M162277.09,-135.98C162313.17,-135.98 162349.91,-135.98 162383.14,-135.98"/>
<polygon fill="black" stroke="black" points="162383.34,-139.48 162393.34,-135.98 162383.34,-132.48 162383.34,-139.48"/>
<text text-anchor="middle" x="162360.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l5_dp1 -->
<g id="node551" class="node">
<title>expert_agg_l5_dp1</title>
<polygon fill="lightyellow" stroke="black" points="166864.57,-176.98 166470.74,-176.98 166369.43,-94.98 166763.26,-94.98 166864.57,-176.98"/>
<text text-anchor="middle" x="166617" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L5</text>
<text text-anchor="middle" x="166617" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="166617" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge911" class="edge">
<title>expert0_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M166333.66,-135.98C166359.06,-135.98 166384.47,-135.98 166409.87,-135.98"/>
<polygon fill="black" stroke="black" points="166409.99,-139.48 166419.99,-135.98 166409.99,-132.48 166409.99,-139.48"/>
</g>
<!-- expert1_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge912" class="edge">
<title>expert1_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M166027.24,-162.02C166050.4,-171.57 166077.96,-181.22 166104,-185.98 166154.06,-195.15 166282.3,-190.41 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert2_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge913" class="edge">
<title>expert2_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M165780.24,-162.02C165803.4,-171.57 165830.96,-181.22 165857,-185.98 165909.02,-195.51 166280.31,-190.59 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert3_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge914" class="edge">
<title>expert3_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M165533.24,-162.02C165556.4,-171.57 165583.96,-181.22 165610,-185.98 165689.02,-200.45 166252.97,-192.97 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert4_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge915" class="edge">
<title>expert4_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M165286.24,-162.02C165309.4,-171.57 165336.96,-181.22 165363,-185.98 165416.01,-195.69 166279.31,-190.67 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert5_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge916" class="edge">
<title>expert5_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M165039.24,-162.02C165062.4,-171.57 165089.96,-181.22 165116,-185.98 165182.5,-198.16 166265.64,-191.87 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert6_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge917" class="edge">
<title>expert6_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M164792.24,-162.02C164815.4,-171.57 164842.96,-181.22 164869,-185.98 164949,-200.63 166251.97,-193.06 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert7_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge918" class="edge">
<title>expert7_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M164545.24,-162.02C164568.4,-171.57 164595.96,-181.22 164622,-185.98 164668.75,-194.54 166285.65,-190.12 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert8_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge919" class="edge">
<title>expert8_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M164298.24,-162.02C164321.4,-171.57 164348.96,-181.22 164375,-185.98 164428.5,-195.78 166278.82,-190.72 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert9_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge920" class="edge">
<title>expert9_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M164051.24,-162.02C164074.4,-171.57 164101.96,-181.22 164128,-185.98 164188.25,-197.01 166271.98,-191.31 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert10_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge921" class="edge">
<title>expert10_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M163804.24,-162.02C163827.4,-171.57 163854.96,-181.22 163881,-185.98 163948,-198.25 166265.15,-191.91 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert11_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge922" class="edge">
<title>expert11_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M163557.24,-162.02C163580.4,-171.57 163607.96,-181.22 163634,-185.98 163707.75,-199.48 166258.31,-192.51 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert12_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge923" class="edge">
<title>expert12_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M163310.24,-162.02C163333.4,-171.57 163360.96,-181.22 163387,-185.98 163467.49,-200.72 166251.48,-193.1 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert13_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge924" class="edge">
<title>expert13_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M163063.24,-162.02C163086.4,-171.57 163113.96,-181.22 163140,-185.98 163183.62,-193.97 166288.82,-189.84 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert14_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge925" class="edge">
<title>expert14_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M162816.24,-162.02C162839.4,-171.57 162866.96,-181.22 162893,-185.98 162940,-194.59 166285.4,-190.14 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- expert15_l5_dp1&#45;&gt;expert_agg_l5_dp1 -->
<g id="edge926" class="edge">
<title>expert15_l5_dp1&#45;&gt;expert_agg_l5_dp1</title>
<path fill="none" stroke="black" d="M162565.86,-162.02C162590.1,-171.58 162618.89,-181.22 162646,-185.98 162696.44,-194.84 166281.98,-190.44 166333,-185.98 166371.11,-182.65 166411.78,-176.86 166450.08,-170.36"/>
<polygon fill="black" stroke="black" points="166451.02,-173.75 166460.29,-168.6 166449.84,-166.85 166451.02,-173.75"/>
</g>
<!-- layer5_output_dp1 -->
<g id="node552" class="node">
<title>layer5_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="167069" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="167069" y="-144.48" font-family="Arial" font-size="10.00">Layer 5 Output</text>
<text text-anchor="middle" x="167069" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="167069" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l5_dp1&#45;&gt;layer5_output_dp1 -->
<g id="edge927" class="edge">
<title>expert_agg_l5_dp1&#45;&gt;layer5_output_dp1</title>
<path fill="none" stroke="black" d="M166814.31,-135.98C166839.49,-135.98 166864.66,-135.98 166889.84,-135.98"/>
<polygon fill="black" stroke="black" points="166889.87,-139.48 166899.87,-135.98 166889.87,-132.48 166889.87,-139.48"/>
</g>
<!-- attn_input_l6_dp1 -->
<g id="node553" class="node">
<title>attn_input_l6_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="167442" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="167442" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L6</text>
<text text-anchor="middle" x="167442" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="167442" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer5_output_dp1&#45;&gt;attn_input_l6_dp1 -->
<g id="edge928" class="edge">
<title>layer5_output_dp1&#45;&gt;attn_input_l6_dp1</title>
<path fill="none" stroke="black" d="M167238.01,-135.98C167246.23,-135.98 167254.44,-135.98 167262.66,-135.98"/>
<polygon fill="black" stroke="black" points="167262.68,-139.48 167272.68,-135.98 167262.68,-132.48 167262.68,-139.48"/>
</g>
<!-- attn_tp0_l6_dp1 -->
<g id="node554" class="node">
<title>attn_tp0_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="168740,-161.98 168480,-161.98 168480,-109.98 168740,-109.98 168740,-161.98"/>
<text text-anchor="middle" x="168610" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L6</text>
<text text-anchor="middle" x="168610" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="168610" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="168610" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp1&#45;&gt;attn_tp0_l6_dp1 -->
<g id="edge929" class="edge">
<title>attn_input_l6_dp1&#45;&gt;attn_tp0_l6_dp1</title>
<path fill="none" stroke="black" d="M167525.52,-161.26C167562.12,-171.09 167605.81,-181.13 167646,-185.98 167691,-191.42 168417.27,-193.33 168462,-185.98 168487.4,-181.81 168514.31,-173.85 168538.12,-165.5"/>
<polygon fill="black" stroke="black" points="168539.55,-168.71 168547.78,-162.03 168537.18,-162.12 168539.55,-168.71"/>
</g>
<!-- attn_tp1_l6_dp1 -->
<g id="node555" class="node">
<title>attn_tp1_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="168462,-161.98 168202,-161.98 168202,-109.98 168462,-109.98 168462,-161.98"/>
<text text-anchor="middle" x="168332" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L6</text>
<text text-anchor="middle" x="168332" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="168332" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="168332" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp1&#45;&gt;attn_tp1_l6_dp1 -->
<g id="edge930" class="edge">
<title>attn_input_l6_dp1&#45;&gt;attn_tp1_l6_dp1</title>
<path fill="none" stroke="black" d="M167525.52,-161.26C167562.12,-171.09 167605.81,-181.13 167646,-185.98 167705.35,-193.15 168125.01,-195.68 168184,-185.98 168209.4,-181.81 168236.31,-173.85 168260.12,-165.5"/>
<polygon fill="black" stroke="black" points="168261.55,-168.71 168269.78,-162.03 168259.18,-162.12 168261.55,-168.71"/>
</g>
<!-- attn_tp2_l6_dp1 -->
<g id="node556" class="node">
<title>attn_tp2_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="168184,-161.98 167924,-161.98 167924,-109.98 168184,-109.98 168184,-161.98"/>
<text text-anchor="middle" x="168054" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L6</text>
<text text-anchor="middle" x="168054" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="168054" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="168054" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp1&#45;&gt;attn_tp2_l6_dp1 -->
<g id="edge931" class="edge">
<title>attn_input_l6_dp1&#45;&gt;attn_tp2_l6_dp1</title>
<path fill="none" stroke="black" d="M167525.52,-161.26C167562.12,-171.09 167605.81,-181.13 167646,-185.98 167703.36,-192.91 167848.99,-195.35 167906,-185.98 167931.4,-181.81 167958.31,-173.85 167982.12,-165.5"/>
<polygon fill="black" stroke="black" points="167983.55,-168.71 167991.78,-162.03 167981.18,-162.12 167983.55,-168.71"/>
</g>
<!-- attn_tp3_l6_dp1 -->
<g id="node557" class="node">
<title>attn_tp3_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="167906,-161.98 167646,-161.98 167646,-109.98 167906,-109.98 167906,-161.98"/>
<text text-anchor="middle" x="167776" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L6</text>
<text text-anchor="middle" x="167776" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="167776" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="167776" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp1&#45;&gt;attn_tp3_l6_dp1 -->
<g id="edge932" class="edge">
<title>attn_input_l6_dp1&#45;&gt;attn_tp3_l6_dp1</title>
<path fill="none" stroke="black" d="M167611.28,-135.98C167619.35,-135.98 167627.42,-135.98 167635.49,-135.98"/>
<polygon fill="black" stroke="black" points="167635.7,-139.48 167645.7,-135.98 167635.7,-132.48 167635.7,-139.48"/>
</g>
<!-- allreduce_l6_dp1 -->
<g id="node558" class="node">
<title>allreduce_l6_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="168944" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="168944" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L6</text>
<text text-anchor="middle" x="168944" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="168944" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l6_dp1&#45;&gt;allreduce_l6_dp1 -->
<g id="edge933" class="edge">
<title>attn_tp0_l6_dp1&#45;&gt;allreduce_l6_dp1</title>
<path fill="none" stroke="black" d="M168740.14,-135.98C168748.35,-135.98 168756.56,-135.98 168764.77,-135.98"/>
<polygon fill="black" stroke="black" points="168764.78,-139.48 168774.78,-135.98 168764.78,-132.48 168764.78,-139.48"/>
</g>
<!-- attn_tp1_l6_dp1&#45;&gt;allreduce_l6_dp1 -->
<g id="edge934" class="edge">
<title>attn_tp1_l6_dp1&#45;&gt;allreduce_l6_dp1</title>
<path fill="none" stroke="black" d="M168394.22,-162.03C168420.24,-171.59 168451.1,-181.23 168480,-185.98 168537.01,-195.35 168682.64,-192.91 168740,-185.98 168776.57,-181.57 168816.05,-172.85 168850.44,-163.91"/>
<polygon fill="black" stroke="black" points="168851.7,-167.2 168860.47,-161.26 168849.91,-160.43 168851.7,-167.2"/>
</g>
<!-- attn_tp2_l6_dp1&#45;&gt;allreduce_l6_dp1 -->
<g id="edge935" class="edge">
<title>attn_tp2_l6_dp1&#45;&gt;allreduce_l6_dp1</title>
<path fill="none" stroke="black" d="M168116.22,-162.03C168142.24,-171.59 168173.1,-181.23 168202,-185.98 168260.98,-195.68 168680.65,-193.15 168740,-185.98 168776.57,-181.57 168816.05,-172.85 168850.44,-163.91"/>
<polygon fill="black" stroke="black" points="168851.7,-167.2 168860.47,-161.26 168849.91,-160.43 168851.7,-167.2"/>
</g>
<!-- attn_tp3_l6_dp1&#45;&gt;allreduce_l6_dp1 -->
<g id="edge936" class="edge">
<title>attn_tp3_l6_dp1&#45;&gt;allreduce_l6_dp1</title>
<path fill="none" stroke="black" d="M167838.22,-162.03C167864.24,-171.59 167895.1,-181.23 167924,-185.98 167968.73,-193.33 168694.99,-191.42 168740,-185.98 168776.57,-181.57 168816.05,-172.85 168850.44,-163.91"/>
<polygon fill="black" stroke="black" points="168851.7,-167.2 168860.47,-161.26 168849.91,-160.43 168851.7,-167.2"/>
</g>
<!-- moe_input_l6_dp1 -->
<g id="node559" class="node">
<title>moe_input_l6_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="169317" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="169317" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L6</text>
<text text-anchor="middle" x="169317" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="169317" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l6_dp1&#45;&gt;moe_input_l6_dp1 -->
<g id="edge937" class="edge">
<title>allreduce_l6_dp1&#45;&gt;moe_input_l6_dp1</title>
<path fill="none" stroke="black" d="M169113.01,-135.98C169121.23,-135.98 169129.44,-135.98 169137.66,-135.98"/>
<polygon fill="black" stroke="black" points="169137.68,-139.48 169147.68,-135.98 169137.68,-132.48 169137.68,-139.48"/>
</g>
<!-- router_l6_dp1 -->
<g id="node560" class="node">
<title>router_l6_dp1</title>
<polygon fill="lightyellow" stroke="black" points="170016.57,-176.98 169622.74,-176.98 169521.43,-94.98 169915.26,-94.98 170016.57,-176.98"/>
<text text-anchor="middle" x="169769" y="-144.48" font-family="Arial" font-size="10.00">Router L6</text>
<text text-anchor="middle" x="169769" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="169769" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l6_dp1&#45;&gt;router_l6_dp1 -->
<g id="edge938" class="edge">
<title>moe_input_l6_dp1&#45;&gt;router_l6_dp1</title>
<path fill="none" stroke="black" d="M169486.06,-135.98C169511.34,-135.98 169536.63,-135.98 169561.92,-135.98"/>
<polygon fill="black" stroke="black" points="169561.99,-139.48 169571.99,-135.98 169561.99,-132.48 169561.99,-139.48"/>
</g>
<!-- expert0_l6_dp1 -->
<g id="node561" class="node">
<title>expert0_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="174070.5,-161.98 173841.5,-161.98 173841.5,-109.98 174070.5,-109.98 174070.5,-161.98"/>
<text text-anchor="middle" x="173956" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L6</text>
<text text-anchor="middle" x="173956" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="173956" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="173956" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert0_l6_dp1 -->
<g id="edge939" class="edge">
<title>router_l6_dp1&#45;&gt;expert0_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.95,-169.07C170037.21,-172.29 170067.79,-175.07 170097,-176.98 170856.17,-226.7 172759.71,-196.54 173520.5,-198.98 173659.29,-199.43 173695.99,-204.63 173832,-176.98 173846.85,-173.96 173862.41,-169.72 173877.28,-165.11"/>
<polygon fill="black" stroke="black" points="173878.48,-168.4 173886.94,-162.03 173876.35,-161.73 173878.48,-168.4"/>
<text text-anchor="middle" x="173542" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l6_dp1 -->
<g id="node562" class="node">
<title>expert1_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="173823.5,-161.98 173594.5,-161.98 173594.5,-109.98 173823.5,-109.98 173823.5,-161.98"/>
<text text-anchor="middle" x="173709" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L6</text>
<text text-anchor="middle" x="173709" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="173709" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="173709" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert1_l6_dp1 -->
<g id="edge940" class="edge">
<title>router_l6_dp1&#45;&gt;expert1_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.95,-169.05C170037.21,-172.28 170067.79,-175.06 170097,-176.98 170788.08,-222.46 172520.93,-196.54 173213.5,-198.98 173378.9,-199.57 173422.67,-208.72 173585,-176.98 173600.06,-174.04 173615.82,-169.78 173630.86,-165.12"/>
<polygon fill="black" stroke="black" points="173632.17,-168.38 173640.63,-162.01 173630.04,-161.71 173632.17,-168.38"/>
<text text-anchor="middle" x="173235" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l6_dp1 -->
<g id="node563" class="node">
<title>expert2_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="173576.5,-161.98 173347.5,-161.98 173347.5,-109.98 173576.5,-109.98 173576.5,-161.98"/>
<text text-anchor="middle" x="173462" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L6</text>
<text text-anchor="middle" x="173462" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="173462" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="173462" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert2_l6_dp1 -->
<g id="edge941" class="edge">
<title>router_l6_dp1&#45;&gt;expert2_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.95,-169.03C170037.21,-172.26 170067.79,-175.05 170097,-176.98 170706.68,-217.39 172235.48,-196.54 172846.5,-198.98 173065.16,-199.86 173123.03,-217.03 173338,-176.98 173353.27,-174.14 173369.24,-169.88 173384.45,-165.17"/>
<polygon fill="black" stroke="black" points="173385.86,-168.4 173394.32,-162.02 173383.73,-161.73 173385.86,-168.4"/>
<text text-anchor="middle" x="172868" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l6_dp1 -->
<g id="node564" class="node">
<title>expert3_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="173329.5,-161.98 173100.5,-161.98 173100.5,-109.98 173329.5,-109.98 173329.5,-161.98"/>
<text text-anchor="middle" x="173215" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L6</text>
<text text-anchor="middle" x="173215" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="173215" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="173215" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert3_l6_dp1 -->
<g id="edge942" class="edge">
<title>router_l6_dp1&#45;&gt;expert3_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169914.67,-176.99C169953.3,-186.08 169995.21,-194.39 170034.5,-198.98 170053.48,-201.2 170058.39,-199.05 170077.5,-198.98 170412.34,-197.76 172760.61,-231.42 173091,-176.98 173106.93,-174.36 173123.6,-170.02 173139.35,-165.13"/>
<polygon fill="black" stroke="black" points="173140.58,-168.41 173149.03,-162.02 173138.44,-161.74 173140.58,-168.41"/>
<text text-anchor="middle" x="170056" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l6_dp1 -->
<g id="node565" class="node">
<title>expert4_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="173082.5,-161.98 172853.5,-161.98 172853.5,-109.98 173082.5,-109.98 173082.5,-161.98"/>
<text text-anchor="middle" x="172968" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L6</text>
<text text-anchor="middle" x="172968" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="172968" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="172968" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert4_l6_dp1 -->
<g id="edge943" class="edge">
<title>router_l6_dp1&#45;&gt;expert4_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.95,-168.98C170037.21,-172.22 170067.8,-175.02 170097,-176.98 170598.67,-210.66 171856.7,-196.54 172359.5,-198.98 172575.05,-200.03 172632.1,-216.54 172844,-176.98 172859.27,-174.13 172875.24,-169.87 172890.45,-165.16"/>
<polygon fill="black" stroke="black" points="172891.86,-168.39 172900.32,-162.01 172889.73,-161.72 172891.86,-168.39"/>
<text text-anchor="middle" x="172381" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l6_dp1 -->
<g id="node566" class="node">
<title>expert5_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="172835.5,-161.98 172606.5,-161.98 172606.5,-109.98 172835.5,-109.98 172835.5,-161.98"/>
<text text-anchor="middle" x="172721" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L6</text>
<text text-anchor="middle" x="172721" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="172721" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="172721" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert5_l6_dp1 -->
<g id="edge944" class="edge">
<title>router_l6_dp1&#45;&gt;expert5_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169941.37,-177C169986.98,-186.1 170036.37,-194.39 170082.5,-198.98 170101.52,-200.87 170106.39,-199.07 170125.5,-198.98 170400.12,-197.76 172326.07,-221.85 172597,-176.98 172612.93,-174.34 172629.59,-170 172645.35,-165.11"/>
<polygon fill="black" stroke="black" points="172646.58,-168.39 172655.03,-162 172644.44,-161.72 172646.58,-168.39"/>
<text text-anchor="middle" x="170104" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l6_dp1 -->
<g id="node567" class="node">
<title>expert6_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="172588.5,-161.98 172359.5,-161.98 172359.5,-109.98 172588.5,-109.98 172588.5,-161.98"/>
<text text-anchor="middle" x="172474" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L6</text>
<text text-anchor="middle" x="172474" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="172474" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="172474" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert6_l6_dp1 -->
<g id="edge945" class="edge">
<title>router_l6_dp1&#45;&gt;expert6_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.96,-168.9C170037.22,-172.15 170067.8,-174.98 170097,-176.98 170501.75,-204.69 171516.94,-209.41 171922.5,-198.98 172112.69,-194.09 172163.01,-212.05 172350,-176.98 172365.26,-174.12 172381.24,-169.85 172396.45,-165.14"/>
<polygon fill="black" stroke="black" points="172397.85,-168.37 172406.32,-161.99 172395.73,-161.7 172397.85,-168.37"/>
<text text-anchor="middle" x="171901" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l6_dp1 -->
<g id="node568" class="node">
<title>expert7_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="172341.5,-161.98 172112.5,-161.98 172112.5,-109.98 172341.5,-109.98 172341.5,-161.98"/>
<text text-anchor="middle" x="172227" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L6</text>
<text text-anchor="middle" x="172227" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="172227" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="172227" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert7_l6_dp1 -->
<g id="edge946" class="edge">
<title>router_l6_dp1&#45;&gt;expert7_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169968.02,-177C170020.62,-186.1 170077.5,-194.4 170130.5,-198.98 170149.54,-200.63 170154.39,-199.09 170173.5,-198.98 170387.9,-197.76 171891.52,-212.28 172103,-176.98 172118.83,-174.34 172135.4,-170.02 172151.07,-165.16"/>
<polygon fill="black" stroke="black" points="172152.25,-168.46 172160.7,-162.07 172150.11,-161.79 172152.25,-168.46"/>
<text text-anchor="middle" x="170152" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l6_dp1 -->
<g id="node569" class="node">
<title>expert8_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="172094.5,-161.98 171865.5,-161.98 171865.5,-109.98 172094.5,-109.98 172094.5,-161.98"/>
<text text-anchor="middle" x="171980" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L6</text>
<text text-anchor="middle" x="171980" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="171980" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="171980" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert8_l6_dp1 -->
<g id="edge947" class="edge">
<title>router_l6_dp1&#45;&gt;expert8_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.52,-168.73C170036.92,-172.02 170067.66,-174.91 170097,-176.98 170398.4,-198.28 171154.46,-207.29 171456.5,-198.98 171634.26,-194.09 171681.28,-210.07 171856,-176.98 171871.17,-174.11 171887.04,-169.87 171902.16,-165.18"/>
<polygon fill="black" stroke="black" points="171903.52,-168.42 171911.98,-162.05 171901.39,-161.75 171903.52,-168.42"/>
<text text-anchor="middle" x="171435" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l6_dp1 -->
<g id="node570" class="node">
<title>expert9_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="171847.5,-161.98 171618.5,-161.98 171618.5,-109.98 171847.5,-109.98 171847.5,-161.98"/>
<text text-anchor="middle" x="171733" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L6</text>
<text text-anchor="middle" x="171733" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="171733" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="171733" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert9_l6_dp1 -->
<g id="edge948" class="edge">
<title>router_l6_dp1&#45;&gt;expert9_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169994.65,-177.01C170054.23,-186.11 170118.61,-194.4 170178.5,-198.98 170337,-211.1 171452.26,-203.5 171609,-176.98 171624.83,-174.3 171641.39,-169.97 171657.06,-165.1"/>
<polygon fill="black" stroke="black" points="171658.24,-168.4 171666.69,-162.01 171656.1,-161.74 171658.24,-168.4"/>
<text text-anchor="middle" x="170200" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l6_dp1 -->
<g id="node571" class="node">
<title>expert10_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="171600.5,-161.98 171371.5,-161.98 171371.5,-109.98 171600.5,-109.98 171600.5,-161.98"/>
<text text-anchor="middle" x="171486" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L6</text>
<text text-anchor="middle" x="171486" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="171486" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="171486" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert10_l6_dp1 -->
<g id="edge949" class="edge">
<title>router_l6_dp1&#45;&gt;expert10_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170006.1,-168.45C170036.64,-171.8 170067.53,-174.78 170097,-176.98 170505.53,-207.56 170609.04,-212.08 171018.5,-198.98 171171.4,-194.09 171211.82,-206.12 171362,-176.98 171377.06,-174.06 171392.83,-169.82 171407.87,-165.16"/>
<polygon fill="black" stroke="black" points="171409.17,-168.42 171417.64,-162.04 171407.05,-161.75 171409.17,-168.42"/>
<text text-anchor="middle" x="170997" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l6_dp1 -->
<g id="node572" class="node">
<title>expert11_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="171353.5,-161.98 171124.5,-161.98 171124.5,-109.98 171353.5,-109.98 171353.5,-161.98"/>
<text text-anchor="middle" x="171239" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L6</text>
<text text-anchor="middle" x="171239" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="171239" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="171239" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert11_l6_dp1 -->
<g id="edge950" class="edge">
<title>router_l6_dp1&#45;&gt;expert11_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170015.89,-176.28C170083.94,-185.66 170157.91,-194.28 170226.5,-198.98 170423.54,-212.49 170920.43,-210.92 171115,-176.98 171130.72,-174.24 171147.17,-169.91 171162.76,-165.06"/>
<polygon fill="black" stroke="black" points="171163.89,-168.38 171172.35,-161.99 171161.75,-161.71 171163.89,-168.38"/>
<text text-anchor="middle" x="170248" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l6_dp1 -->
<g id="node573" class="node">
<title>expert12_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="171106.5,-161.98 170877.5,-161.98 170877.5,-109.98 171106.5,-109.98 171106.5,-161.98"/>
<text text-anchor="middle" x="170992" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L6</text>
<text text-anchor="middle" x="170992" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="170992" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="170992" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert12_l6_dp1 -->
<g id="edge951" class="edge">
<title>router_l6_dp1&#45;&gt;expert12_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170005.25,-167.81C170036.07,-171.29 170067.26,-174.47 170097,-176.98 170097,-176.98 170868,-176.98 170868,-176.98 170882.65,-173.9 170898,-169.69 170912.7,-165.12"/>
<polygon fill="black" stroke="black" points="170913.79,-168.45 170922.26,-162.08 170911.67,-161.78 170913.79,-168.45"/>
<text text-anchor="middle" x="170615" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l6_dp1 -->
<g id="node574" class="node">
<title>expert13_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="170859.5,-161.98 170630.5,-161.98 170630.5,-109.98 170859.5,-109.98 170859.5,-161.98"/>
<text text-anchor="middle" x="170745" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L6</text>
<text text-anchor="middle" x="170745" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="170745" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="170745" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert13_l6_dp1 -->
<g id="edge952" class="edge">
<title>router_l6_dp1&#45;&gt;expert13_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169999.04,-176.98C170171.78,-200.57 170413.28,-218.19 170621,-176.98 170635.96,-174.01 170651.62,-169.78 170666.58,-165.14"/>
<polygon fill="black" stroke="black" points="170667.83,-168.41 170676.29,-162.04 170665.7,-161.74 170667.83,-168.41"/>
<text text-anchor="middle" x="170296" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l6_dp1 -->
<g id="node575" class="node">
<title>expert14_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="170612.5,-161.98 170383.5,-161.98 170383.5,-109.98 170612.5,-109.98 170612.5,-161.98"/>
<text text-anchor="middle" x="170498" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L6</text>
<text text-anchor="middle" x="170498" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="170498" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="170498" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert14_l6_dp1 -->
<g id="edge953" class="edge">
<title>router_l6_dp1&#45;&gt;expert14_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M170008.4,-177C170143.73,-197.08 170298.84,-214.02 170365.5,-198.98 170393.7,-192.62 170422.94,-179.52 170446.75,-166.9"/>
<polygon fill="black" stroke="black" points="170448.48,-169.94 170455.6,-162.1 170445.14,-163.79 170448.48,-169.94"/>
<text text-anchor="middle" x="170344" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l6_dp1 -->
<g id="node576" class="node">
<title>expert15_l6_dp1</title>
<polygon fill="lightgreen" stroke="black" points="170335.5,-161.98 170106.5,-161.98 170106.5,-109.98 170335.5,-109.98 170335.5,-161.98"/>
<text text-anchor="middle" x="170221" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L6</text>
<text text-anchor="middle" x="170221" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="170221" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="170221" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp1&#45;&gt;expert15_l6_dp1 -->
<g id="edge954" class="edge">
<title>router_l6_dp1&#45;&gt;expert15_l6_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M169965.94,-135.98C170010.13,-135.98 170055.83,-135.98 170096.12,-135.98"/>
<polygon fill="black" stroke="black" points="170096.25,-139.48 170106.25,-135.98 170096.25,-132.48 170096.25,-139.48"/>
<text text-anchor="middle" x="170061.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l6_dp1 -->
<g id="node577" class="node">
<title>expert_agg_l6_dp1</title>
<polygon fill="lightyellow" stroke="black" points="174601.57,-176.98 174207.74,-176.98 174106.43,-94.98 174500.26,-94.98 174601.57,-176.98"/>
<text text-anchor="middle" x="174354" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L6</text>
<text text-anchor="middle" x="174354" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="174354" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge955" class="edge">
<title>expert0_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M174070.66,-135.98C174096.06,-135.98 174121.47,-135.98 174146.87,-135.98"/>
<polygon fill="black" stroke="black" points="174146.99,-139.48 174156.99,-135.98 174146.99,-132.48 174146.99,-139.48"/>
</g>
<!-- expert1_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge956" class="edge">
<title>expert1_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M173764.24,-162.02C173787.4,-171.57 173814.96,-181.22 173841,-185.98 173891.06,-195.15 174019.3,-190.41 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert2_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge957" class="edge">
<title>expert2_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M173517.24,-162.02C173540.4,-171.57 173567.96,-181.22 173594,-185.98 173646.02,-195.51 174017.31,-190.59 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert3_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge958" class="edge">
<title>expert3_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M173270.24,-162.02C173293.4,-171.57 173320.96,-181.22 173347,-185.98 173426.02,-200.45 173989.97,-192.97 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert4_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge959" class="edge">
<title>expert4_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M173023.24,-162.02C173046.4,-171.57 173073.96,-181.22 173100,-185.98 173153.01,-195.69 174016.31,-190.67 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert5_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge960" class="edge">
<title>expert5_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M172776.24,-162.02C172799.4,-171.57 172826.96,-181.22 172853,-185.98 172919.5,-198.16 174002.64,-191.87 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert6_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge961" class="edge">
<title>expert6_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M172529.24,-162.02C172552.4,-171.57 172579.96,-181.22 172606,-185.98 172686,-200.63 173988.97,-193.06 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert7_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge962" class="edge">
<title>expert7_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M172282.24,-162.02C172305.4,-171.57 172332.96,-181.22 172359,-185.98 172405.75,-194.54 174022.65,-190.12 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert8_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge963" class="edge">
<title>expert8_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M172035.24,-162.02C172058.4,-171.57 172085.96,-181.22 172112,-185.98 172165.5,-195.78 174015.82,-190.72 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert9_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge964" class="edge">
<title>expert9_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M171788.24,-162.02C171811.4,-171.57 171838.96,-181.22 171865,-185.98 171925.25,-197.01 174008.98,-191.31 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert10_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge965" class="edge">
<title>expert10_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M171541.24,-162.02C171564.4,-171.57 171591.96,-181.22 171618,-185.98 171685,-198.25 174002.15,-191.91 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert11_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge966" class="edge">
<title>expert11_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M171294.24,-162.02C171317.4,-171.57 171344.96,-181.22 171371,-185.98 171444.75,-199.48 173995.31,-192.51 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert12_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge967" class="edge">
<title>expert12_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M171047.24,-162.02C171070.4,-171.57 171097.96,-181.22 171124,-185.98 171204.49,-200.72 173988.48,-193.1 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert13_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge968" class="edge">
<title>expert13_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M170800.24,-162.02C170823.4,-171.57 170850.96,-181.22 170877,-185.98 170920.62,-193.97 174025.82,-189.84 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert14_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge969" class="edge">
<title>expert14_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M170553.24,-162.02C170576.4,-171.57 170603.96,-181.22 170630,-185.98 170677,-194.59 174022.4,-190.14 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- expert15_l6_dp1&#45;&gt;expert_agg_l6_dp1 -->
<g id="edge970" class="edge">
<title>expert15_l6_dp1&#45;&gt;expert_agg_l6_dp1</title>
<path fill="none" stroke="black" d="M170289.31,-162.04C170317.82,-171.6 170351.57,-181.24 170383,-185.98 170433.63,-193.62 174018.98,-190.44 174070,-185.98 174108.11,-182.65 174148.78,-176.86 174187.08,-170.36"/>
<polygon fill="black" stroke="black" points="174188.02,-173.75 174197.29,-168.6 174186.84,-166.85 174188.02,-173.75"/>
</g>
<!-- layer6_output_dp1 -->
<g id="node578" class="node">
<title>layer6_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="174806" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="174806" y="-144.48" font-family="Arial" font-size="10.00">Layer 6 Output</text>
<text text-anchor="middle" x="174806" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="174806" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l6_dp1&#45;&gt;layer6_output_dp1 -->
<g id="edge971" class="edge">
<title>expert_agg_l6_dp1&#45;&gt;layer6_output_dp1</title>
<path fill="none" stroke="black" d="M174551.31,-135.98C174576.49,-135.98 174601.66,-135.98 174626.84,-135.98"/>
<polygon fill="black" stroke="black" points="174626.87,-139.48 174636.87,-135.98 174626.87,-132.48 174626.87,-139.48"/>
</g>
<!-- attn_input_l7_dp1 -->
<g id="node579" class="node">
<title>attn_input_l7_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="175179" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="175179" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L7</text>
<text text-anchor="middle" x="175179" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="175179" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer6_output_dp1&#45;&gt;attn_input_l7_dp1 -->
<g id="edge972" class="edge">
<title>layer6_output_dp1&#45;&gt;attn_input_l7_dp1</title>
<path fill="none" stroke="black" d="M174975.01,-135.98C174983.23,-135.98 174991.44,-135.98 174999.66,-135.98"/>
<polygon fill="black" stroke="black" points="174999.68,-139.48 175009.68,-135.98 174999.68,-132.48 174999.68,-139.48"/>
</g>
<!-- attn_tp0_l7_dp1 -->
<g id="node580" class="node">
<title>attn_tp0_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="176477,-161.98 176217,-161.98 176217,-109.98 176477,-109.98 176477,-161.98"/>
<text text-anchor="middle" x="176347" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L7</text>
<text text-anchor="middle" x="176347" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="176347" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="176347" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp1&#45;&gt;attn_tp0_l7_dp1 -->
<g id="edge973" class="edge">
<title>attn_input_l7_dp1&#45;&gt;attn_tp0_l7_dp1</title>
<path fill="none" stroke="black" d="M175262.52,-161.26C175299.12,-171.09 175342.81,-181.13 175383,-185.98 175428,-191.42 176154.27,-193.33 176199,-185.98 176224.4,-181.81 176251.31,-173.85 176275.12,-165.5"/>
<polygon fill="black" stroke="black" points="176276.55,-168.71 176284.78,-162.03 176274.18,-162.12 176276.55,-168.71"/>
</g>
<!-- attn_tp1_l7_dp1 -->
<g id="node581" class="node">
<title>attn_tp1_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="176199,-161.98 175939,-161.98 175939,-109.98 176199,-109.98 176199,-161.98"/>
<text text-anchor="middle" x="176069" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L7</text>
<text text-anchor="middle" x="176069" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="176069" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="176069" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp1&#45;&gt;attn_tp1_l7_dp1 -->
<g id="edge974" class="edge">
<title>attn_input_l7_dp1&#45;&gt;attn_tp1_l7_dp1</title>
<path fill="none" stroke="black" d="M175262.52,-161.26C175299.12,-171.09 175342.81,-181.13 175383,-185.98 175442.35,-193.15 175862.01,-195.68 175921,-185.98 175946.4,-181.81 175973.31,-173.85 175997.12,-165.5"/>
<polygon fill="black" stroke="black" points="175998.55,-168.71 176006.78,-162.03 175996.18,-162.12 175998.55,-168.71"/>
</g>
<!-- attn_tp2_l7_dp1 -->
<g id="node582" class="node">
<title>attn_tp2_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="175921,-161.98 175661,-161.98 175661,-109.98 175921,-109.98 175921,-161.98"/>
<text text-anchor="middle" x="175791" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L7</text>
<text text-anchor="middle" x="175791" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="175791" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="175791" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp1&#45;&gt;attn_tp2_l7_dp1 -->
<g id="edge975" class="edge">
<title>attn_input_l7_dp1&#45;&gt;attn_tp2_l7_dp1</title>
<path fill="none" stroke="black" d="M175262.52,-161.26C175299.12,-171.09 175342.81,-181.13 175383,-185.98 175440.36,-192.91 175585.99,-195.35 175643,-185.98 175668.4,-181.81 175695.31,-173.85 175719.12,-165.5"/>
<polygon fill="black" stroke="black" points="175720.55,-168.71 175728.78,-162.03 175718.18,-162.12 175720.55,-168.71"/>
</g>
<!-- attn_tp3_l7_dp1 -->
<g id="node583" class="node">
<title>attn_tp3_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="175643,-161.98 175383,-161.98 175383,-109.98 175643,-109.98 175643,-161.98"/>
<text text-anchor="middle" x="175513" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L7</text>
<text text-anchor="middle" x="175513" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="175513" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="175513" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp1&#45;&gt;attn_tp3_l7_dp1 -->
<g id="edge976" class="edge">
<title>attn_input_l7_dp1&#45;&gt;attn_tp3_l7_dp1</title>
<path fill="none" stroke="black" d="M175348.28,-135.98C175356.35,-135.98 175364.42,-135.98 175372.49,-135.98"/>
<polygon fill="black" stroke="black" points="175372.7,-139.48 175382.7,-135.98 175372.7,-132.48 175372.7,-139.48"/>
</g>
<!-- allreduce_l7_dp1 -->
<g id="node584" class="node">
<title>allreduce_l7_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="176681" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="176681" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L7</text>
<text text-anchor="middle" x="176681" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="176681" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l7_dp1&#45;&gt;allreduce_l7_dp1 -->
<g id="edge977" class="edge">
<title>attn_tp0_l7_dp1&#45;&gt;allreduce_l7_dp1</title>
<path fill="none" stroke="black" d="M176477.14,-135.98C176485.35,-135.98 176493.56,-135.98 176501.77,-135.98"/>
<polygon fill="black" stroke="black" points="176501.78,-139.48 176511.78,-135.98 176501.78,-132.48 176501.78,-139.48"/>
</g>
<!-- attn_tp1_l7_dp1&#45;&gt;allreduce_l7_dp1 -->
<g id="edge978" class="edge">
<title>attn_tp1_l7_dp1&#45;&gt;allreduce_l7_dp1</title>
<path fill="none" stroke="black" d="M176131.22,-162.03C176157.24,-171.59 176188.1,-181.23 176217,-185.98 176274.01,-195.35 176419.64,-192.91 176477,-185.98 176513.57,-181.57 176553.05,-172.85 176587.44,-163.91"/>
<polygon fill="black" stroke="black" points="176588.7,-167.2 176597.47,-161.26 176586.91,-160.43 176588.7,-167.2"/>
</g>
<!-- attn_tp2_l7_dp1&#45;&gt;allreduce_l7_dp1 -->
<g id="edge979" class="edge">
<title>attn_tp2_l7_dp1&#45;&gt;allreduce_l7_dp1</title>
<path fill="none" stroke="black" d="M175853.22,-162.03C175879.24,-171.59 175910.1,-181.23 175939,-185.98 175997.98,-195.68 176417.65,-193.15 176477,-185.98 176513.57,-181.57 176553.05,-172.85 176587.44,-163.91"/>
<polygon fill="black" stroke="black" points="176588.7,-167.2 176597.47,-161.26 176586.91,-160.43 176588.7,-167.2"/>
</g>
<!-- attn_tp3_l7_dp1&#45;&gt;allreduce_l7_dp1 -->
<g id="edge980" class="edge">
<title>attn_tp3_l7_dp1&#45;&gt;allreduce_l7_dp1</title>
<path fill="none" stroke="black" d="M175575.22,-162.03C175601.24,-171.59 175632.1,-181.23 175661,-185.98 175705.73,-193.33 176431.99,-191.42 176477,-185.98 176513.57,-181.57 176553.05,-172.85 176587.44,-163.91"/>
<polygon fill="black" stroke="black" points="176588.7,-167.2 176597.47,-161.26 176586.91,-160.43 176588.7,-167.2"/>
</g>
<!-- moe_input_l7_dp1 -->
<g id="node585" class="node">
<title>moe_input_l7_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="177054" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="177054" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L7</text>
<text text-anchor="middle" x="177054" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="177054" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l7_dp1&#45;&gt;moe_input_l7_dp1 -->
<g id="edge981" class="edge">
<title>allreduce_l7_dp1&#45;&gt;moe_input_l7_dp1</title>
<path fill="none" stroke="black" d="M176850.01,-135.98C176858.23,-135.98 176866.44,-135.98 176874.66,-135.98"/>
<polygon fill="black" stroke="black" points="176874.68,-139.48 176884.68,-135.98 176874.68,-132.48 176874.68,-139.48"/>
</g>
<!-- router_l7_dp1 -->
<g id="node586" class="node">
<title>router_l7_dp1</title>
<polygon fill="lightyellow" stroke="black" points="177753.57,-176.98 177359.74,-176.98 177258.43,-94.98 177652.26,-94.98 177753.57,-176.98"/>
<text text-anchor="middle" x="177506" y="-144.48" font-family="Arial" font-size="10.00">Router L7</text>
<text text-anchor="middle" x="177506" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="177506" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l7_dp1&#45;&gt;router_l7_dp1 -->
<g id="edge982" class="edge">
<title>moe_input_l7_dp1&#45;&gt;router_l7_dp1</title>
<path fill="none" stroke="black" d="M177223.06,-135.98C177248.34,-135.98 177273.63,-135.98 177298.92,-135.98"/>
<polygon fill="black" stroke="black" points="177298.99,-139.48 177308.99,-135.98 177298.99,-132.48 177298.99,-139.48"/>
</g>
<!-- expert0_l7_dp1 -->
<g id="node587" class="node">
<title>expert0_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="181759.5,-161.98 181530.5,-161.98 181530.5,-109.98 181759.5,-109.98 181759.5,-161.98"/>
<text text-anchor="middle" x="181645" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L7</text>
<text text-anchor="middle" x="181645" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="181645" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="181645" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert0_l7_dp1 -->
<g id="edge983" class="edge">
<title>router_l7_dp1&#45;&gt;expert0_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.74,-171.32C177768.09,-173.59 177789.41,-175.53 177810,-176.98 178570.47,-230.48 180478.15,-196.54 181240.5,-198.98 181365.55,-199.38 181398.59,-202.54 181521,-176.98 181535.75,-173.9 181551.19,-169.66 181565.98,-165.07"/>
<polygon fill="black" stroke="black" points="181567.12,-168.37 181575.59,-162 181565,-161.7 181567.12,-168.37"/>
<text text-anchor="middle" x="181262" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l7_dp1 -->
<g id="node588" class="node">
<title>expert1_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="181512.5,-161.98 181283.5,-161.98 181283.5,-109.98 181512.5,-109.98 181512.5,-161.98"/>
<text text-anchor="middle" x="181398" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L7</text>
<text text-anchor="middle" x="181398" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="181398" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="181398" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert1_l7_dp1 -->
<g id="edge984" class="edge">
<title>router_l7_dp1&#45;&gt;expert1_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.74,-171.31C177768.09,-173.58 177789.41,-175.53 177810,-176.98 178509.05,-226.36 180262.71,-196.54 180963.5,-198.98 181101.84,-199.47 181138.43,-204.56 181274,-176.98 181288.85,-173.96 181304.41,-169.72 181319.28,-165.11"/>
<polygon fill="black" stroke="black" points="181320.48,-168.4 181328.94,-162.03 181318.35,-161.73 181320.48,-168.4"/>
<text text-anchor="middle" x="180985" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l7_dp1 -->
<g id="node589" class="node">
<title>expert2_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="181265.5,-161.98 181036.5,-161.98 181036.5,-109.98 181265.5,-109.98 181265.5,-161.98"/>
<text text-anchor="middle" x="181151" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L7</text>
<text text-anchor="middle" x="181151" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="181151" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="181151" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert2_l7_dp1 -->
<g id="edge985" class="edge">
<title>router_l7_dp1&#45;&gt;expert2_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.74,-171.29C177768.1,-173.56 177789.41,-175.52 177810,-176.98 178441.21,-221.81 180024.71,-196.54 180657.5,-198.98 180822.01,-199.62 180865.55,-208.59 181027,-176.98 181042.06,-174.03 181057.82,-169.78 181072.86,-165.12"/>
<polygon fill="black" stroke="black" points="181074.17,-168.37 181082.63,-162 181072.04,-161.71 181074.17,-168.37"/>
<text text-anchor="middle" x="180679" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l7_dp1 -->
<g id="node590" class="node">
<title>expert3_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="181018.5,-161.98 180789.5,-161.98 180789.5,-109.98 181018.5,-109.98 181018.5,-161.98"/>
<text text-anchor="middle" x="180904" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L7</text>
<text text-anchor="middle" x="180904" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="180904" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="180904" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert3_l7_dp1 -->
<g id="edge986" class="edge">
<title>router_l7_dp1&#45;&gt;expert3_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.74,-171.27C177768.1,-173.54 177789.41,-175.51 177810,-176.98 178360.28,-216.37 179740.82,-196.54 180292.5,-198.98 180509.38,-199.94 180566.79,-216.75 180780,-176.98 180795.27,-174.14 180811.24,-169.88 180826.45,-165.17"/>
<polygon fill="black" stroke="black" points="180827.86,-168.39 180836.32,-162.01 180825.73,-161.72 180827.86,-168.39"/>
<text text-anchor="middle" x="180314" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l7_dp1 -->
<g id="node591" class="node">
<title>expert4_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="180771.5,-161.98 180542.5,-161.98 180542.5,-109.98 180771.5,-109.98 180771.5,-161.98"/>
<text text-anchor="middle" x="180657" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L7</text>
<text text-anchor="middle" x="180657" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="180657" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="180657" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert4_l7_dp1 -->
<g id="edge987" class="edge">
<title>router_l7_dp1&#45;&gt;expert4_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177651.67,-176.99C177690.3,-186.08 177732.21,-194.39 177771.5,-198.98 177790.48,-201.2 177795.39,-199.06 177814.5,-198.98 178116.56,-197.76 180234.97,-226.21 180533,-176.98 180548.93,-174.35 180565.6,-170.01 180581.35,-165.12"/>
<polygon fill="black" stroke="black" points="180582.58,-168.4 180591.03,-162.01 180580.44,-161.73 180582.58,-168.4"/>
<text text-anchor="middle" x="177793" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l7_dp1 -->
<g id="node592" class="node">
<title>expert5_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="180524.5,-161.98 180295.5,-161.98 180295.5,-109.98 180524.5,-109.98 180524.5,-161.98"/>
<text text-anchor="middle" x="180410" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L7</text>
<text text-anchor="middle" x="180410" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="180410" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="180410" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert5_l7_dp1 -->
<g id="edge988" class="edge">
<title>router_l7_dp1&#45;&gt;expert5_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.74,-171.22C177768.1,-173.51 177789.42,-175.49 177810,-176.98 178253.19,-209.18 179365.15,-196.54 179809.5,-198.98 180021.5,-200.15 180077.61,-215.98 180286,-176.98 180301.26,-174.13 180317.24,-169.86 180332.45,-165.15"/>
<polygon fill="black" stroke="black" points="180333.86,-168.37 180342.32,-162 180331.73,-161.71 180333.86,-168.37"/>
<text text-anchor="middle" x="179831" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l7_dp1 -->
<g id="node593" class="node">
<title>expert6_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="180277.5,-161.98 180048.5,-161.98 180048.5,-109.98 180277.5,-109.98 180277.5,-161.98"/>
<text text-anchor="middle" x="180163" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L7</text>
<text text-anchor="middle" x="180163" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="180163" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="180163" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert6_l7_dp1 -->
<g id="edge989" class="edge">
<title>router_l7_dp1&#45;&gt;expert6_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177678.37,-177C177723.98,-186.1 177773.37,-194.39 177819.5,-198.98 177838.52,-200.87 177843.39,-199.08 177862.5,-198.98 178104.34,-197.76 179800.43,-216.64 180039,-176.98 180054.84,-174.35 180071.4,-170.04 180087.07,-165.18"/>
<polygon fill="black" stroke="black" points="180088.25,-168.47 180096.7,-162.09 180086.11,-161.81 180088.25,-168.47"/>
<text text-anchor="middle" x="177841" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l7_dp1 -->
<g id="node594" class="node">
<title>expert7_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="180030.5,-161.98 179801.5,-161.98 179801.5,-109.98 180030.5,-109.98 180030.5,-161.98"/>
<text text-anchor="middle" x="179916" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L7</text>
<text text-anchor="middle" x="179916" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="179916" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="179916" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert7_l7_dp1 -->
<g id="edge990" class="edge">
<title>router_l7_dp1&#45;&gt;expert7_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.33,-171.1C177767.83,-173.42 177789.29,-175.44 177810,-176.98 178158.07,-202.87 179031.59,-208.3 179380.5,-198.98 179563.58,-194.09 179612.02,-210.92 179792,-176.98 179807.17,-174.12 179823.04,-169.88 179838.17,-165.2"/>
<polygon fill="black" stroke="black" points="179839.52,-168.44 179847.99,-162.07 179837.4,-161.77 179839.52,-168.44"/>
<text text-anchor="middle" x="179359" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l7_dp1 -->
<g id="node595" class="node">
<title>expert8_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="179783.5,-161.98 179554.5,-161.98 179554.5,-109.98 179783.5,-109.98 179783.5,-161.98"/>
<text text-anchor="middle" x="179669" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L7</text>
<text text-anchor="middle" x="179669" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="179669" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="179669" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert8_l7_dp1 -->
<g id="edge991" class="edge">
<title>router_l7_dp1&#45;&gt;expert8_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177705.02,-177C177757.62,-186.1 177814.5,-194.4 177867.5,-198.98 177886.54,-200.63 177891.39,-199.11 177910.5,-198.98 178092.12,-197.76 179365.88,-207.07 179545,-176.98 179560.83,-174.32 179577.39,-170 179593.07,-165.13"/>
<polygon fill="black" stroke="black" points="179594.24,-168.43 179602.7,-162.04 179592.1,-161.77 179594.24,-168.43"/>
<text text-anchor="middle" x="177889" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l7_dp1 -->
<g id="node596" class="node">
<title>expert9_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="179536.5,-161.98 179307.5,-161.98 179307.5,-109.98 179536.5,-109.98 179536.5,-161.98"/>
<text text-anchor="middle" x="179422" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L7</text>
<text text-anchor="middle" x="179422" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="179422" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="179422" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert9_l7_dp1 -->
<g id="edge992" class="edge">
<title>router_l7_dp1&#45;&gt;expert9_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177746.35,-170.96C177767.84,-173.31 177789.29,-175.38 177810,-176.98 178306.17,-215.39 178432.07,-213.82 178929.5,-198.98 179093.49,-194.09 179136.87,-207.88 179298,-176.98 179313.16,-174.08 179329.03,-169.81 179344.15,-165.12"/>
<polygon fill="black" stroke="black" points="179345.51,-168.37 179353.97,-161.99 179343.38,-161.7 179345.51,-168.37"/>
<text text-anchor="middle" x="178908" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l7_dp1 -->
<g id="node597" class="node">
<title>expert10_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="179289.5,-161.98 179060.5,-161.98 179060.5,-109.98 179289.5,-109.98 179289.5,-161.98"/>
<text text-anchor="middle" x="179175" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L7</text>
<text text-anchor="middle" x="179175" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="179175" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="179175" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert10_l7_dp1 -->
<g id="edge993" class="edge">
<title>router_l7_dp1&#45;&gt;expert10_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177731.65,-177.01C177791.23,-186.11 177855.61,-194.4 177915.5,-198.98 178041.32,-208.6 178926.62,-198.3 179051,-176.98 179066.73,-174.29 179083.18,-169.97 179098.78,-165.14"/>
<polygon fill="black" stroke="black" points="179099.9,-168.45 179108.36,-162.07 179097.77,-161.78 179099.9,-168.45"/>
<text text-anchor="middle" x="177937" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l7_dp1 -->
<g id="node598" class="node">
<title>expert11_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="179042.5,-161.98 178813.5,-161.98 178813.5,-109.98 179042.5,-109.98 179042.5,-161.98"/>
<text text-anchor="middle" x="178928" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L7</text>
<text text-anchor="middle" x="178928" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="178928" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="178928" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert11_l7_dp1 -->
<g id="edge994" class="edge">
<title>router_l7_dp1&#45;&gt;expert11_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177745.95,-170.64C177767.58,-173.07 177789.17,-175.24 177810,-176.98 178125.71,-203.39 178205.92,-211.33 178522.5,-198.98 178647.9,-194.09 178680.97,-201.75 178804,-176.98 178818.86,-173.99 178834.42,-169.77 178849.29,-165.16"/>
<polygon fill="black" stroke="black" points="178850.48,-168.45 178858.95,-162.08 178848.36,-161.78 178850.48,-168.45"/>
<text text-anchor="middle" x="178501" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l7_dp1 -->
<g id="node599" class="node">
<title>expert12_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="178795.5,-161.98 178566.5,-161.98 178566.5,-109.98 178795.5,-109.98 178795.5,-161.98"/>
<text text-anchor="middle" x="178681" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L7</text>
<text text-anchor="middle" x="178681" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="178681" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="178681" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert12_l7_dp1 -->
<g id="edge995" class="edge">
<title>router_l7_dp1&#45;&gt;expert12_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177752.89,-176.28C177820.94,-185.66 177894.91,-194.28 177963.5,-198.98 178095.17,-208.01 178427.14,-200.56 178557,-176.98 178572.37,-174.19 178588.45,-169.93 178603.75,-165.2"/>
<polygon fill="black" stroke="black" points="178605.21,-168.41 178613.67,-162.03 178603.08,-161.74 178605.21,-168.41"/>
<text text-anchor="middle" x="177985" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l7_dp1 -->
<g id="node600" class="node">
<title>expert13_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="178548.5,-161.98 178319.5,-161.98 178319.5,-109.98 178548.5,-109.98 178548.5,-161.98"/>
<text text-anchor="middle" x="178434" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L7</text>
<text text-anchor="middle" x="178434" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="178434" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="178434" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert13_l7_dp1 -->
<g id="edge996" class="edge">
<title>router_l7_dp1&#45;&gt;expert13_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177723.82,-177.02C177860.96,-197.58 178041.66,-215.02 178201.5,-198.98 178252.66,-193.85 178308.31,-179.11 178352.33,-165.18"/>
<polygon fill="black" stroke="black" points="178353.66,-168.43 178362.11,-162.04 178351.52,-161.77 178353.66,-168.43"/>
<text text-anchor="middle" x="178180" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l7_dp1 -->
<g id="node601" class="node">
<title>expert14_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="178301.5,-161.98 178072.5,-161.98 178072.5,-109.98 178301.5,-109.98 178301.5,-161.98"/>
<text text-anchor="middle" x="178187" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L7</text>
<text text-anchor="middle" x="178187" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="178187" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="178187" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert14_l7_dp1 -->
<g id="edge997" class="edge">
<title>router_l7_dp1&#45;&gt;expert14_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177731.44,-176.99C177854.58,-196.39 177994.01,-212.63 178054.5,-198.98 178082.7,-192.62 178111.94,-179.52 178135.75,-166.9"/>
<polygon fill="black" stroke="black" points="178137.48,-169.94 178144.6,-162.1 178134.14,-163.79 178137.48,-169.94"/>
<text text-anchor="middle" x="178033" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l7_dp1 -->
<g id="node602" class="node">
<title>expert15_l7_dp1</title>
<polygon fill="lightgreen" stroke="black" points="178048.5,-161.98 177819.5,-161.98 177819.5,-109.98 178048.5,-109.98 178048.5,-161.98"/>
<text text-anchor="middle" x="177934" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L7</text>
<text text-anchor="middle" x="177934" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="177934" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="177934" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp1&#45;&gt;expert15_l7_dp1 -->
<g id="edge998" class="edge">
<title>router_l7_dp1&#45;&gt;expert15_l7_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M177703.09,-135.98C177739.17,-135.98 177775.91,-135.98 177809.14,-135.98"/>
<polygon fill="black" stroke="black" points="177809.34,-139.48 177819.34,-135.98 177809.34,-132.48 177809.34,-139.48"/>
<text text-anchor="middle" x="177786.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l7_dp1 -->
<g id="node603" class="node">
<title>expert_agg_l7_dp1</title>
<polygon fill="lightyellow" stroke="black" points="182290.57,-176.98 181896.74,-176.98 181795.43,-94.98 182189.26,-94.98 182290.57,-176.98"/>
<text text-anchor="middle" x="182043" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L7</text>
<text text-anchor="middle" x="182043" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="182043" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge999" class="edge">
<title>expert0_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M181759.66,-135.98C181785.06,-135.98 181810.47,-135.98 181835.87,-135.98"/>
<polygon fill="black" stroke="black" points="181835.99,-139.48 181845.99,-135.98 181835.99,-132.48 181835.99,-139.48"/>
</g>
<!-- expert1_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1000" class="edge">
<title>expert1_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M181453.24,-162.02C181476.4,-171.57 181503.96,-181.22 181530,-185.98 181580.06,-195.15 181708.3,-190.41 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert2_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1001" class="edge">
<title>expert2_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M181206.24,-162.02C181229.4,-171.57 181256.96,-181.22 181283,-185.98 181335.02,-195.51 181706.31,-190.59 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert3_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1002" class="edge">
<title>expert3_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M180959.24,-162.02C180982.4,-171.57 181009.96,-181.22 181036,-185.98 181115.02,-200.45 181678.97,-192.97 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert4_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1003" class="edge">
<title>expert4_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M180712.24,-162.02C180735.4,-171.57 180762.96,-181.22 180789,-185.98 180842.01,-195.69 181705.31,-190.67 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert5_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1004" class="edge">
<title>expert5_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M180465.24,-162.02C180488.4,-171.57 180515.96,-181.22 180542,-185.98 180608.5,-198.16 181691.64,-191.87 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert6_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1005" class="edge">
<title>expert6_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M180218.24,-162.02C180241.4,-171.57 180268.96,-181.22 180295,-185.98 180375,-200.63 181677.97,-193.06 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert7_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1006" class="edge">
<title>expert7_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M179971.24,-162.02C179994.4,-171.57 180021.96,-181.22 180048,-185.98 180094.75,-194.54 181711.65,-190.12 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert8_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1007" class="edge">
<title>expert8_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M179724.24,-162.02C179747.4,-171.57 179774.96,-181.22 179801,-185.98 179854.5,-195.78 181704.82,-190.72 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert9_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1008" class="edge">
<title>expert9_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M179477.24,-162.02C179500.4,-171.57 179527.96,-181.22 179554,-185.98 179614.25,-197.01 181697.98,-191.31 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert10_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1009" class="edge">
<title>expert10_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M179230.24,-162.02C179253.4,-171.57 179280.96,-181.22 179307,-185.98 179374,-198.25 181691.15,-191.91 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert11_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1010" class="edge">
<title>expert11_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M178983.24,-162.02C179006.4,-171.57 179033.96,-181.22 179060,-185.98 179133.75,-199.48 181684.31,-192.51 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert12_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1011" class="edge">
<title>expert12_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M178736.24,-162.02C178759.4,-171.57 178786.96,-181.22 178813,-185.98 178893.49,-200.72 181677.48,-193.1 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert13_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1012" class="edge">
<title>expert13_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M178489.24,-162.02C178512.4,-171.57 178539.96,-181.22 178566,-185.98 178609.62,-193.97 181714.82,-189.84 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert14_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1013" class="edge">
<title>expert14_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M178242.24,-162.02C178265.4,-171.57 178292.96,-181.22 178319,-185.98 178366,-194.59 181711.4,-190.14 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- expert15_l7_dp1&#45;&gt;expert_agg_l7_dp1 -->
<g id="edge1014" class="edge">
<title>expert15_l7_dp1&#45;&gt;expert_agg_l7_dp1</title>
<path fill="none" stroke="black" d="M177991.86,-162.02C178016.1,-171.58 178044.89,-181.22 178072,-185.98 178122.44,-194.84 181707.98,-190.44 181759,-185.98 181797.11,-182.65 181837.78,-176.86 181876.08,-170.36"/>
<polygon fill="black" stroke="black" points="181877.02,-173.75 181886.29,-168.6 181875.84,-166.85 181877.02,-173.75"/>
</g>
<!-- layer7_output_dp1 -->
<g id="node604" class="node">
<title>layer7_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="182495" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="182495" y="-144.48" font-family="Arial" font-size="10.00">Layer 7 Output</text>
<text text-anchor="middle" x="182495" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="182495" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l7_dp1&#45;&gt;layer7_output_dp1 -->
<g id="edge1015" class="edge">
<title>expert_agg_l7_dp1&#45;&gt;layer7_output_dp1</title>
<path fill="none" stroke="black" d="M182240.31,-135.98C182265.49,-135.98 182290.66,-135.98 182315.84,-135.98"/>
<polygon fill="black" stroke="black" points="182315.87,-139.48 182325.87,-135.98 182315.87,-132.48 182315.87,-139.48"/>
</g>
<!-- attn_input_l8_dp1 -->
<g id="node605" class="node">
<title>attn_input_l8_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="182868" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="182868" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L8</text>
<text text-anchor="middle" x="182868" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="182868" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer7_output_dp1&#45;&gt;attn_input_l8_dp1 -->
<g id="edge1016" class="edge">
<title>layer7_output_dp1&#45;&gt;attn_input_l8_dp1</title>
<path fill="none" stroke="black" d="M182664.01,-135.98C182672.23,-135.98 182680.44,-135.98 182688.66,-135.98"/>
<polygon fill="black" stroke="black" points="182688.68,-139.48 182698.68,-135.98 182688.68,-132.48 182688.68,-139.48"/>
</g>
<!-- attn_tp0_l8_dp1 -->
<g id="node606" class="node">
<title>attn_tp0_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="184166,-161.98 183906,-161.98 183906,-109.98 184166,-109.98 184166,-161.98"/>
<text text-anchor="middle" x="184036" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L8</text>
<text text-anchor="middle" x="184036" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="184036" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="184036" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp1&#45;&gt;attn_tp0_l8_dp1 -->
<g id="edge1017" class="edge">
<title>attn_input_l8_dp1&#45;&gt;attn_tp0_l8_dp1</title>
<path fill="none" stroke="black" d="M182951.52,-161.26C182988.12,-171.09 183031.81,-181.13 183072,-185.98 183117,-191.42 183843.27,-193.33 183888,-185.98 183913.4,-181.81 183940.31,-173.85 183964.12,-165.5"/>
<polygon fill="black" stroke="black" points="183965.55,-168.71 183973.78,-162.03 183963.18,-162.12 183965.55,-168.71"/>
</g>
<!-- attn_tp1_l8_dp1 -->
<g id="node607" class="node">
<title>attn_tp1_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="183888,-161.98 183628,-161.98 183628,-109.98 183888,-109.98 183888,-161.98"/>
<text text-anchor="middle" x="183758" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L8</text>
<text text-anchor="middle" x="183758" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="183758" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="183758" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp1&#45;&gt;attn_tp1_l8_dp1 -->
<g id="edge1018" class="edge">
<title>attn_input_l8_dp1&#45;&gt;attn_tp1_l8_dp1</title>
<path fill="none" stroke="black" d="M182951.52,-161.26C182988.12,-171.09 183031.81,-181.13 183072,-185.98 183131.35,-193.15 183551.01,-195.68 183610,-185.98 183635.4,-181.81 183662.31,-173.85 183686.12,-165.5"/>
<polygon fill="black" stroke="black" points="183687.55,-168.71 183695.78,-162.03 183685.18,-162.12 183687.55,-168.71"/>
</g>
<!-- attn_tp2_l8_dp1 -->
<g id="node608" class="node">
<title>attn_tp2_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="183610,-161.98 183350,-161.98 183350,-109.98 183610,-109.98 183610,-161.98"/>
<text text-anchor="middle" x="183480" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L8</text>
<text text-anchor="middle" x="183480" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="183480" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="183480" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp1&#45;&gt;attn_tp2_l8_dp1 -->
<g id="edge1019" class="edge">
<title>attn_input_l8_dp1&#45;&gt;attn_tp2_l8_dp1</title>
<path fill="none" stroke="black" d="M182951.52,-161.26C182988.12,-171.09 183031.81,-181.13 183072,-185.98 183129.36,-192.91 183274.99,-195.35 183332,-185.98 183357.4,-181.81 183384.31,-173.85 183408.12,-165.5"/>
<polygon fill="black" stroke="black" points="183409.55,-168.71 183417.78,-162.03 183407.18,-162.12 183409.55,-168.71"/>
</g>
<!-- attn_tp3_l8_dp1 -->
<g id="node609" class="node">
<title>attn_tp3_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="183332,-161.98 183072,-161.98 183072,-109.98 183332,-109.98 183332,-161.98"/>
<text text-anchor="middle" x="183202" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L8</text>
<text text-anchor="middle" x="183202" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="183202" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="183202" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp1&#45;&gt;attn_tp3_l8_dp1 -->
<g id="edge1020" class="edge">
<title>attn_input_l8_dp1&#45;&gt;attn_tp3_l8_dp1</title>
<path fill="none" stroke="black" d="M183037.28,-135.98C183045.35,-135.98 183053.42,-135.98 183061.49,-135.98"/>
<polygon fill="black" stroke="black" points="183061.7,-139.48 183071.7,-135.98 183061.7,-132.48 183061.7,-139.48"/>
</g>
<!-- allreduce_l8_dp1 -->
<g id="node610" class="node">
<title>allreduce_l8_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="184370" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="184370" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L8</text>
<text text-anchor="middle" x="184370" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="184370" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l8_dp1&#45;&gt;allreduce_l8_dp1 -->
<g id="edge1021" class="edge">
<title>attn_tp0_l8_dp1&#45;&gt;allreduce_l8_dp1</title>
<path fill="none" stroke="black" d="M184166.14,-135.98C184174.35,-135.98 184182.56,-135.98 184190.77,-135.98"/>
<polygon fill="black" stroke="black" points="184190.78,-139.48 184200.78,-135.98 184190.78,-132.48 184190.78,-139.48"/>
</g>
<!-- attn_tp1_l8_dp1&#45;&gt;allreduce_l8_dp1 -->
<g id="edge1022" class="edge">
<title>attn_tp1_l8_dp1&#45;&gt;allreduce_l8_dp1</title>
<path fill="none" stroke="black" d="M183820.22,-162.03C183846.24,-171.59 183877.1,-181.23 183906,-185.98 183963.01,-195.35 184108.64,-192.91 184166,-185.98 184202.57,-181.57 184242.05,-172.85 184276.44,-163.91"/>
<polygon fill="black" stroke="black" points="184277.7,-167.2 184286.47,-161.26 184275.91,-160.43 184277.7,-167.2"/>
</g>
<!-- attn_tp2_l8_dp1&#45;&gt;allreduce_l8_dp1 -->
<g id="edge1023" class="edge">
<title>attn_tp2_l8_dp1&#45;&gt;allreduce_l8_dp1</title>
<path fill="none" stroke="black" d="M183542.22,-162.03C183568.24,-171.59 183599.1,-181.23 183628,-185.98 183686.98,-195.68 184106.65,-193.15 184166,-185.98 184202.57,-181.57 184242.05,-172.85 184276.44,-163.91"/>
<polygon fill="black" stroke="black" points="184277.7,-167.2 184286.47,-161.26 184275.91,-160.43 184277.7,-167.2"/>
</g>
<!-- attn_tp3_l8_dp1&#45;&gt;allreduce_l8_dp1 -->
<g id="edge1024" class="edge">
<title>attn_tp3_l8_dp1&#45;&gt;allreduce_l8_dp1</title>
<path fill="none" stroke="black" d="M183264.22,-162.03C183290.24,-171.59 183321.1,-181.23 183350,-185.98 183394.73,-193.33 184120.99,-191.42 184166,-185.98 184202.57,-181.57 184242.05,-172.85 184276.44,-163.91"/>
<polygon fill="black" stroke="black" points="184277.7,-167.2 184286.47,-161.26 184275.91,-160.43 184277.7,-167.2"/>
</g>
<!-- moe_input_l8_dp1 -->
<g id="node611" class="node">
<title>moe_input_l8_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="184743" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="184743" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L8</text>
<text text-anchor="middle" x="184743" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="184743" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l8_dp1&#45;&gt;moe_input_l8_dp1 -->
<g id="edge1025" class="edge">
<title>allreduce_l8_dp1&#45;&gt;moe_input_l8_dp1</title>
<path fill="none" stroke="black" d="M184539.01,-135.98C184547.23,-135.98 184555.44,-135.98 184563.66,-135.98"/>
<polygon fill="black" stroke="black" points="184563.68,-139.48 184573.68,-135.98 184563.68,-132.48 184563.68,-139.48"/>
</g>
<!-- router_l8_dp1 -->
<g id="node612" class="node">
<title>router_l8_dp1</title>
<polygon fill="lightyellow" stroke="black" points="185442.57,-176.98 185048.74,-176.98 184947.43,-94.98 185341.26,-94.98 185442.57,-176.98"/>
<text text-anchor="middle" x="185195" y="-144.48" font-family="Arial" font-size="10.00">Router L8</text>
<text text-anchor="middle" x="185195" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="185195" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l8_dp1&#45;&gt;router_l8_dp1 -->
<g id="edge1026" class="edge">
<title>moe_input_l8_dp1&#45;&gt;router_l8_dp1</title>
<path fill="none" stroke="black" d="M184912.06,-135.98C184937.34,-135.98 184962.63,-135.98 184987.92,-135.98"/>
<polygon fill="black" stroke="black" points="184987.99,-139.48 184997.99,-135.98 184987.99,-132.48 184987.99,-139.48"/>
</g>
<!-- expert0_l8_dp1 -->
<g id="node613" class="node">
<title>expert0_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="189437.5,-161.98 189208.5,-161.98 189208.5,-109.98 189437.5,-109.98 189437.5,-161.98"/>
<text text-anchor="middle" x="189323" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L8</text>
<text text-anchor="middle" x="189323" y="-138.98" font-family="Arial" font-size="10.00">GPU 32</text>
<text text-anchor="middle" x="189323" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="189323" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert0_l8_dp1 -->
<g id="edge1027" class="edge">
<title>router_l8_dp1&#45;&gt;expert0_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.24,-171.8C185455.75,-173.86 185475.18,-175.64 185494,-176.98 186251.75,-231.14 188152.82,-196.54 188912.5,-198.98 189040.21,-199.39 189073.96,-202.94 189199,-176.98 189213.75,-173.92 189229.2,-169.69 189243.99,-165.09"/>
<polygon fill="black" stroke="black" points="189245.13,-168.4 189253.59,-162.03 189243,-161.73 189245.13,-168.4"/>
<text text-anchor="middle" x="188934" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l8_dp1 -->
<g id="node614" class="node">
<title>expert1_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="189190.5,-161.98 188961.5,-161.98 188961.5,-109.98 189190.5,-109.98 189190.5,-161.98"/>
<text text-anchor="middle" x="189076" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L8</text>
<text text-anchor="middle" x="189076" y="-138.98" font-family="Arial" font-size="10.00">GPU 33</text>
<text text-anchor="middle" x="189076" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="189076" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert1_l8_dp1 -->
<g id="edge1028" class="edge">
<title>router_l8_dp1&#45;&gt;expert1_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.24,-171.79C185455.75,-173.85 185475.18,-175.63 185494,-176.98 186189.23,-226.88 187933.49,-196.54 188630.5,-198.98 188773.72,-199.49 188811.6,-205.31 188952,-176.98 188966.86,-173.98 188982.41,-169.76 188997.29,-165.14"/>
<polygon fill="black" stroke="black" points="188998.48,-168.44 189006.95,-162.07 188996.36,-161.77 188998.48,-168.44"/>
<text text-anchor="middle" x="188652" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l8_dp1 -->
<g id="node615" class="node">
<title>expert2_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="188943.5,-161.98 188714.5,-161.98 188714.5,-109.98 188943.5,-109.98 188943.5,-161.98"/>
<text text-anchor="middle" x="188829" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L8</text>
<text text-anchor="middle" x="188829" y="-138.98" font-family="Arial" font-size="10.00">GPU 34</text>
<text text-anchor="middle" x="188829" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="188829" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert2_l8_dp1 -->
<g id="edge1029" class="edge">
<title>router_l8_dp1&#45;&gt;expert2_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.24,-171.77C185455.75,-173.84 185475.19,-175.63 185494,-176.98 186118.95,-222.08 187686.93,-196.54 188313.5,-198.98 188487.77,-199.66 188533.9,-210.1 188705,-176.98 188720.06,-174.07 188735.83,-169.83 188750.87,-165.17"/>
<polygon fill="black" stroke="black" points="188752.17,-168.43 188760.64,-162.05 188750.05,-161.76 188752.17,-168.43"/>
<text text-anchor="middle" x="188335" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l8_dp1 -->
<g id="node616" class="node">
<title>expert3_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="188696.5,-161.98 188467.5,-161.98 188467.5,-109.98 188696.5,-109.98 188696.5,-161.98"/>
<text text-anchor="middle" x="188582" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L8</text>
<text text-anchor="middle" x="188582" y="-138.98" font-family="Arial" font-size="10.00">GPU 35</text>
<text text-anchor="middle" x="188582" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="188582" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert3_l8_dp1 -->
<g id="edge1030" class="edge">
<title>router_l8_dp1&#45;&gt;expert3_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185364.03,-177C185408.77,-186.09 185457.23,-194.39 185502.5,-198.98 185521.51,-200.91 185526.39,-199.05 185545.5,-198.98 185869.12,-197.76 188138.69,-229.64 188458,-176.98 188473.93,-174.36 188490.6,-170.02 188506.35,-165.12"/>
<polygon fill="black" stroke="black" points="188507.58,-168.4 188516.03,-162.01 188505.44,-161.74 188507.58,-168.4"/>
<text text-anchor="middle" x="185524" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l8_dp1 -->
<g id="node617" class="node">
<title>expert4_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="188449.5,-161.98 188220.5,-161.98 188220.5,-109.98 188449.5,-109.98 188449.5,-161.98"/>
<text text-anchor="middle" x="188335" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L8</text>
<text text-anchor="middle" x="188335" y="-138.98" font-family="Arial" font-size="10.00">GPU 36</text>
<text text-anchor="middle" x="188335" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="188335" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert4_l8_dp1 -->
<g id="edge1031" class="edge">
<title>router_l8_dp1&#45;&gt;expert4_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.24,-171.74C185455.75,-173.82 185475.19,-175.61 185494,-176.98 186033.15,-216.23 187385.93,-196.54 187926.5,-198.98 188053.32,-199.56 188086.83,-202.81 188211,-176.98 188225.75,-173.91 188241.2,-169.68 188255.98,-165.08"/>
<polygon fill="black" stroke="black" points="188257.13,-168.39 188265.59,-162.02 188255,-161.72 188257.13,-168.39"/>
<text text-anchor="middle" x="187948" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l8_dp1 -->
<g id="node618" class="node">
<title>expert5_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="188202.5,-161.98 187973.5,-161.98 187973.5,-109.98 188202.5,-109.98 188202.5,-161.98"/>
<text text-anchor="middle" x="188088" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L8</text>
<text text-anchor="middle" x="188088" y="-138.98" font-family="Arial" font-size="10.00">GPU 37</text>
<text text-anchor="middle" x="188088" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="188088" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert5_l8_dp1 -->
<g id="edge1032" class="edge">
<title>router_l8_dp1&#45;&gt;expert5_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.24,-171.72C185455.75,-173.8 185475.19,-175.6 185494,-176.98 185970.85,-211.97 187167.37,-196.54 187645.5,-198.98 187787.39,-199.71 187824.92,-205.1 187964,-176.98 187978.86,-173.98 187994.41,-169.75 188009.29,-165.13"/>
<polygon fill="black" stroke="black" points="188010.48,-168.43 188018.95,-162.06 188008.36,-161.76 188010.48,-168.43"/>
<text text-anchor="middle" x="187667" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l8_dp1 -->
<g id="node619" class="node">
<title>expert6_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="187955.5,-161.98 187726.5,-161.98 187726.5,-109.98 187955.5,-109.98 187955.5,-161.98"/>
<text text-anchor="middle" x="187841" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L8</text>
<text text-anchor="middle" x="187841" y="-138.98" font-family="Arial" font-size="10.00">GPU 38</text>
<text text-anchor="middle" x="187841" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="187841" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert6_l8_dp1 -->
<g id="edge1033" class="edge">
<title>router_l8_dp1&#45;&gt;expert6_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.25,-171.68C185455.76,-173.77 185475.19,-175.59 185494,-176.98 186308.04,-237.44 186514.23,-194.09 187330.5,-198.98 187502.55,-200.01 187548.09,-209.75 187717,-176.98 187732.06,-174.06 187747.83,-169.82 187762.87,-165.16"/>
<polygon fill="black" stroke="black" points="187764.17,-168.42 187772.64,-162.04 187762.05,-161.75 187764.17,-168.42"/>
<text text-anchor="middle" x="187352" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l8_dp1 -->
<g id="node620" class="node">
<title>expert7_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="187708.5,-161.98 187479.5,-161.98 187479.5,-109.98 187708.5,-109.98 187708.5,-161.98"/>
<text text-anchor="middle" x="187594" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L8</text>
<text text-anchor="middle" x="187594" y="-138.98" font-family="Arial" font-size="10.00">GPU 39</text>
<text text-anchor="middle" x="187594" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="187594" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert7_l8_dp1 -->
<g id="edge1034" class="edge">
<title>router_l8_dp1&#45;&gt;expert7_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185402.34,-177.01C185457.12,-186.11 185516.35,-194.4 185571.5,-198.98 185590.54,-200.57 185595.39,-199.1 185614.5,-198.98 185820.68,-197.76 187266.64,-210.97 187470,-176.98 187485.83,-174.34 187502.39,-170.02 187518.07,-165.15"/>
<polygon fill="black" stroke="black" points="187519.25,-168.45 187527.7,-162.07 187517.11,-161.79 187519.25,-168.45"/>
<text text-anchor="middle" x="185593" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l8_dp1 -->
<g id="node621" class="node">
<title>expert8_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="187461.5,-161.98 187232.5,-161.98 187232.5,-109.98 187461.5,-109.98 187461.5,-161.98"/>
<text text-anchor="middle" x="187347" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L8</text>
<text text-anchor="middle" x="187347" y="-138.98" font-family="Arial" font-size="10.00">GPU 40</text>
<text text-anchor="middle" x="187347" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="187347" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert8_l8_dp1 -->
<g id="edge1035" class="edge">
<title>router_l8_dp1&#45;&gt;expert8_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.25,-171.62C185455.76,-173.72 185475.19,-175.56 185494,-176.98 186138.22,-225.85 186301.44,-194.09 186947.5,-198.98 187070.33,-199.91 187102.78,-202.21 187223,-176.98 187237.65,-173.91 187253,-169.69 187267.7,-165.13"/>
<polygon fill="black" stroke="black" points="187268.79,-168.45 187277.26,-162.09 187266.67,-161.78 187268.79,-168.45"/>
<text text-anchor="middle" x="186969" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l8_dp1 -->
<g id="node622" class="node">
<title>expert9_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="187214.5,-161.98 186985.5,-161.98 186985.5,-109.98 187214.5,-109.98 187214.5,-161.98"/>
<text text-anchor="middle" x="187100" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L8</text>
<text text-anchor="middle" x="187100" y="-138.98" font-family="Arial" font-size="10.00">GPU 41</text>
<text text-anchor="middle" x="187100" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="187100" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert9_l8_dp1 -->
<g id="edge1036" class="edge">
<title>router_l8_dp1&#45;&gt;expert9_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185435.85,-171.5C185455.49,-173.64 185475.06,-175.51 185494,-176.98 185765.34,-198.04 186446.59,-210.58 186718.5,-198.98 186833.26,-194.09 186863.48,-200.06 186976,-176.98 186990.85,-173.94 187006.4,-169.69 187021.27,-165.07"/>
<polygon fill="black" stroke="black" points="187022.47,-168.36 187030.93,-161.99 187020.34,-161.69 187022.47,-168.36"/>
<text text-anchor="middle" x="186697" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l8_dp1 -->
<g id="node623" class="node">
<title>expert10_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="186967.5,-161.98 186738.5,-161.98 186738.5,-109.98 186967.5,-109.98 186967.5,-161.98"/>
<text text-anchor="middle" x="186853" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L8</text>
<text text-anchor="middle" x="186853" y="-138.98" font-family="Arial" font-size="10.00">GPU 42</text>
<text text-anchor="middle" x="186853" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="186853" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert10_l8_dp1 -->
<g id="edge1037" class="edge">
<title>router_l8_dp1&#45;&gt;expert10_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185435.86,-171.37C185455.5,-173.54 185475.07,-175.45 185494,-176.98 185905,-210.17 186009.42,-213.7 186421.5,-198.98 186558.43,-194.09 186594.59,-203.58 186729,-176.98 186743.96,-174.02 186759.62,-169.79 186774.58,-165.15"/>
<polygon fill="black" stroke="black" points="186775.83,-168.43 186784.29,-162.06 186773.7,-161.76 186775.83,-168.43"/>
<text text-anchor="middle" x="186400" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l8_dp1 -->
<g id="node624" class="node">
<title>expert11_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="186720.5,-161.98 186491.5,-161.98 186491.5,-109.98 186720.5,-109.98 186720.5,-161.98"/>
<text text-anchor="middle" x="186606" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L8</text>
<text text-anchor="middle" x="186606" y="-138.98" font-family="Arial" font-size="10.00">GPU 43</text>
<text text-anchor="middle" x="186606" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="186606" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert11_l8_dp1 -->
<g id="edge1038" class="edge">
<title>router_l8_dp1&#45;&gt;expert11_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185435.06,-177.01C185498.42,-186.11 185566.87,-194.4 185630.5,-198.98 185819.3,-212.57 186295.55,-209.62 186482,-176.98 186497.63,-174.25 186513.98,-169.94 186529.49,-165.13"/>
<polygon fill="black" stroke="black" points="186530.56,-168.46 186539.02,-162.08 186528.43,-161.8 186530.56,-168.46"/>
<text text-anchor="middle" x="185652" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l8_dp1 -->
<g id="node625" class="node">
<title>expert12_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="186473.5,-161.98 186244.5,-161.98 186244.5,-109.98 186473.5,-109.98 186473.5,-161.98"/>
<text text-anchor="middle" x="186359" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L8</text>
<text text-anchor="middle" x="186359" y="-138.98" font-family="Arial" font-size="10.00">GPU 44</text>
<text text-anchor="middle" x="186359" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="186359" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert12_l8_dp1 -->
<g id="edge1039" class="edge">
<title>router_l8_dp1&#45;&gt;expert12_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185436.02,-171.43C185612.96,-193.02 185859.15,-213.83 186075.5,-198.98 186146.89,-194.08 186165.29,-193.17 186235,-176.98 186249,-173.73 186263.66,-169.58 186277.81,-165.17"/>
<polygon fill="black" stroke="black" points="186279.04,-168.45 186287.5,-162.08 186276.91,-161.78 186279.04,-168.45"/>
<text text-anchor="middle" x="186054" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l8_dp1 -->
<g id="node626" class="node">
<title>expert13_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="186226.5,-161.98 185997.5,-161.98 185997.5,-109.98 186226.5,-109.98 186226.5,-161.98"/>
<text text-anchor="middle" x="186112" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L8</text>
<text text-anchor="middle" x="186112" y="-138.98" font-family="Arial" font-size="10.00">GPU 45</text>
<text text-anchor="middle" x="186112" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="186112" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert13_l8_dp1 -->
<g id="edge1040" class="edge">
<title>router_l8_dp1&#45;&gt;expert13_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185411.82,-177.03C185545.76,-197.17 185721.14,-214.16 185876.5,-198.98 185928.5,-193.9 185985.1,-179.07 186029.79,-165.08"/>
<polygon fill="black" stroke="black" points="186030.95,-168.38 186039.42,-162.01 186028.83,-161.71 186030.95,-168.38"/>
<text text-anchor="middle" x="185855" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l8_dp1 -->
<g id="node627" class="node">
<title>expert14_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="185979.5,-161.98 185750.5,-161.98 185750.5,-109.98 185979.5,-109.98 185979.5,-161.98"/>
<text text-anchor="middle" x="185865" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L8</text>
<text text-anchor="middle" x="185865" y="-138.98" font-family="Arial" font-size="10.00">GPU 46</text>
<text text-anchor="middle" x="185865" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="185865" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert14_l8_dp1 -->
<g id="edge1041" class="edge">
<title>router_l8_dp1&#45;&gt;expert14_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185417.51,-176.99C185535.76,-195.86 185668.44,-211.57 185726.5,-198.98 185755.93,-192.6 185786.61,-179.41 185811.6,-166.74"/>
<polygon fill="black" stroke="black" points="185813.26,-169.82 185820.53,-162.11 185810.04,-163.61 185813.26,-169.82"/>
<text text-anchor="middle" x="185705" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l8_dp1 -->
<g id="node628" class="node">
<title>expert15_l8_dp1</title>
<polygon fill="lightgreen" stroke="black" points="185732.5,-161.98 185503.5,-161.98 185503.5,-109.98 185732.5,-109.98 185732.5,-161.98"/>
<text text-anchor="middle" x="185618" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L8</text>
<text text-anchor="middle" x="185618" y="-138.98" font-family="Arial" font-size="10.00">GPU 47</text>
<text text-anchor="middle" x="185618" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="185618" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp1&#45;&gt;expert15_l8_dp1 -->
<g id="edge1042" class="edge">
<title>router_l8_dp1&#45;&gt;expert15_l8_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M185391.95,-135.98C185426.38,-135.98 185461.32,-135.98 185493.11,-135.98"/>
<polygon fill="black" stroke="black" points="185493.32,-139.48 185503.32,-135.98 185493.32,-132.48 185493.32,-139.48"/>
<text text-anchor="middle" x="185473.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l8_dp1 -->
<g id="node629" class="node">
<title>expert_agg_l8_dp1</title>
<polygon fill="lightyellow" stroke="black" points="189968.57,-176.98 189574.74,-176.98 189473.43,-94.98 189867.26,-94.98 189968.57,-176.98"/>
<text text-anchor="middle" x="189721" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="189721" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="189721" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1043" class="edge">
<title>expert0_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M189437.66,-135.98C189463.06,-135.98 189488.47,-135.98 189513.87,-135.98"/>
<polygon fill="black" stroke="black" points="189513.99,-139.48 189523.99,-135.98 189513.99,-132.48 189513.99,-139.48"/>
</g>
<!-- expert1_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1044" class="edge">
<title>expert1_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M189131.24,-162.02C189154.4,-171.57 189181.96,-181.22 189208,-185.98 189258.06,-195.15 189386.3,-190.41 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert2_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1045" class="edge">
<title>expert2_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M188884.24,-162.02C188907.4,-171.57 188934.96,-181.22 188961,-185.98 189013.02,-195.51 189384.31,-190.59 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert3_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1046" class="edge">
<title>expert3_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M188637.24,-162.02C188660.4,-171.57 188687.96,-181.22 188714,-185.98 188793.02,-200.45 189356.97,-192.97 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert4_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1047" class="edge">
<title>expert4_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M188390.24,-162.02C188413.4,-171.57 188440.96,-181.22 188467,-185.98 188520.01,-195.69 189383.31,-190.67 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert5_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1048" class="edge">
<title>expert5_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M188143.24,-162.02C188166.4,-171.57 188193.96,-181.22 188220,-185.98 188286.5,-198.16 189369.64,-191.87 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert6_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1049" class="edge">
<title>expert6_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M187896.24,-162.02C187919.4,-171.57 187946.96,-181.22 187973,-185.98 188053,-200.63 189355.97,-193.06 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert7_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1050" class="edge">
<title>expert7_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M187649.24,-162.02C187672.4,-171.57 187699.96,-181.22 187726,-185.98 187772.75,-194.54 189389.65,-190.12 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert8_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1051" class="edge">
<title>expert8_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M187402.24,-162.02C187425.4,-171.57 187452.96,-181.22 187479,-185.98 187532.5,-195.78 189382.82,-190.72 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert9_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1052" class="edge">
<title>expert9_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M187155.24,-162.02C187178.4,-171.57 187205.96,-181.22 187232,-185.98 187292.25,-197.01 189375.98,-191.31 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert10_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1053" class="edge">
<title>expert10_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M186908.24,-162.02C186931.4,-171.57 186958.96,-181.22 186985,-185.98 187052,-198.25 189369.15,-191.91 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert11_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1054" class="edge">
<title>expert11_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M186661.24,-162.02C186684.4,-171.57 186711.96,-181.22 186738,-185.98 186811.75,-199.48 189362.31,-192.51 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert12_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1055" class="edge">
<title>expert12_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M186414.24,-162.02C186437.4,-171.57 186464.96,-181.22 186491,-185.98 186571.49,-200.72 189355.48,-193.1 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert13_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1056" class="edge">
<title>expert13_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M186167.24,-162.02C186190.4,-171.57 186217.96,-181.22 186244,-185.98 186287.62,-193.97 189392.82,-189.84 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert14_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1057" class="edge">
<title>expert14_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M185920.24,-162.02C185943.4,-171.57 185970.96,-181.22 185997,-185.98 186044,-194.59 189389.4,-190.14 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- expert15_l8_dp1&#45;&gt;expert_agg_l8_dp1 -->
<g id="edge1058" class="edge">
<title>expert15_l8_dp1&#45;&gt;expert_agg_l8_dp1</title>
<path fill="none" stroke="black" d="M185673.24,-162.02C185696.4,-171.57 185723.96,-181.22 185750,-185.98 185800.37,-195.2 189385.98,-190.44 189437,-185.98 189475.11,-182.65 189515.78,-176.86 189554.08,-170.36"/>
<polygon fill="black" stroke="black" points="189555.02,-173.75 189564.29,-168.6 189553.84,-166.85 189555.02,-173.75"/>
</g>
<!-- layer8_output_dp1 -->
<g id="node630" class="node">
<title>layer8_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="190173" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="190173" y="-144.48" font-family="Arial" font-size="10.00">Layer 8 Output</text>
<text text-anchor="middle" x="190173" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="190173" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l8_dp1&#45;&gt;layer8_output_dp1 -->
<g id="edge1059" class="edge">
<title>expert_agg_l8_dp1&#45;&gt;layer8_output_dp1</title>
<path fill="none" stroke="black" d="M189918.31,-135.98C189943.49,-135.98 189968.66,-135.98 189993.84,-135.98"/>
<polygon fill="black" stroke="black" points="189993.87,-139.48 190003.87,-135.98 189993.87,-132.48 189993.87,-139.48"/>
</g>
<!-- stage1_output_dp1 -->
<g id="node631" class="node">
<title>stage1_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="190546" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="190546" y="-144.48" font-family="Arial" font-size="10.00">Stage 1 Output</text>
<text text-anchor="middle" x="190546" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="190546" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer8_output_dp1&#45;&gt;stage1_output_dp1 -->
<g id="edge1060" class="edge">
<title>layer8_output_dp1&#45;&gt;stage1_output_dp1</title>
<path fill="none" stroke="black" d="M190342.01,-135.98C190350.23,-135.98 190358.44,-135.98 190366.66,-135.98"/>
<polygon fill="black" stroke="black" points="190366.68,-139.48 190376.68,-135.98 190366.68,-132.48 190366.68,-139.48"/>
</g>
<!-- stage2_input_dp1 -->
<g id="node632" class="node">
<title>stage2_input_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="190919" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="190919" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Input</text>
<text text-anchor="middle" x="190919" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="190919" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_output_dp1&#45;&gt;stage2_input_dp1 -->
<g id="edge1061" class="edge">
<title>stage1_output_dp1&#45;&gt;stage2_input_dp1</title>
<path fill="none" stroke="black" d="M190715.01,-135.98C190723.23,-135.98 190731.44,-135.98 190739.66,-135.98"/>
<polygon fill="black" stroke="black" points="190739.68,-139.48 190749.68,-135.98 190739.68,-132.48 190739.68,-139.48"/>
</g>
<!-- attn_input_l9_dp1 -->
<g id="node633" class="node">
<title>attn_input_l9_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="191292" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="191292" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L9</text>
<text text-anchor="middle" x="191292" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="191292" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage2_input_dp1&#45;&gt;attn_input_l9_dp1 -->
<g id="edge1062" class="edge">
<title>stage2_input_dp1&#45;&gt;attn_input_l9_dp1</title>
<path fill="none" stroke="black" d="M191088.01,-135.98C191096.23,-135.98 191104.44,-135.98 191112.66,-135.98"/>
<polygon fill="black" stroke="black" points="191112.68,-139.48 191122.68,-135.98 191112.68,-132.48 191112.68,-139.48"/>
</g>
<!-- attn_tp0_l9_dp1 -->
<g id="node634" class="node">
<title>attn_tp0_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="192590,-161.98 192330,-161.98 192330,-109.98 192590,-109.98 192590,-161.98"/>
<text text-anchor="middle" x="192460" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L9</text>
<text text-anchor="middle" x="192460" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="192460" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="192460" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp1&#45;&gt;attn_tp0_l9_dp1 -->
<g id="edge1063" class="edge">
<title>attn_input_l9_dp1&#45;&gt;attn_tp0_l9_dp1</title>
<path fill="none" stroke="black" d="M191375.52,-161.26C191412.12,-171.09 191455.81,-181.13 191496,-185.98 191541,-191.42 192267.27,-193.33 192312,-185.98 192337.4,-181.81 192364.31,-173.85 192388.12,-165.5"/>
<polygon fill="black" stroke="black" points="192389.55,-168.71 192397.78,-162.03 192387.18,-162.12 192389.55,-168.71"/>
</g>
<!-- attn_tp1_l9_dp1 -->
<g id="node635" class="node">
<title>attn_tp1_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="192312,-161.98 192052,-161.98 192052,-109.98 192312,-109.98 192312,-161.98"/>
<text text-anchor="middle" x="192182" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L9</text>
<text text-anchor="middle" x="192182" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="192182" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="192182" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp1&#45;&gt;attn_tp1_l9_dp1 -->
<g id="edge1064" class="edge">
<title>attn_input_l9_dp1&#45;&gt;attn_tp1_l9_dp1</title>
<path fill="none" stroke="black" d="M191375.52,-161.26C191412.12,-171.09 191455.81,-181.13 191496,-185.98 191555.35,-193.15 191975.01,-195.68 192034,-185.98 192059.4,-181.81 192086.31,-173.85 192110.12,-165.5"/>
<polygon fill="black" stroke="black" points="192111.55,-168.71 192119.78,-162.03 192109.18,-162.12 192111.55,-168.71"/>
</g>
<!-- attn_tp2_l9_dp1 -->
<g id="node636" class="node">
<title>attn_tp2_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="192034,-161.98 191774,-161.98 191774,-109.98 192034,-109.98 192034,-161.98"/>
<text text-anchor="middle" x="191904" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L9</text>
<text text-anchor="middle" x="191904" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="191904" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="191904" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp1&#45;&gt;attn_tp2_l9_dp1 -->
<g id="edge1065" class="edge">
<title>attn_input_l9_dp1&#45;&gt;attn_tp2_l9_dp1</title>
<path fill="none" stroke="black" d="M191375.52,-161.26C191412.12,-171.09 191455.81,-181.13 191496,-185.98 191553.36,-192.91 191698.99,-195.35 191756,-185.98 191781.4,-181.81 191808.31,-173.85 191832.12,-165.5"/>
<polygon fill="black" stroke="black" points="191833.55,-168.71 191841.78,-162.03 191831.18,-162.12 191833.55,-168.71"/>
</g>
<!-- attn_tp3_l9_dp1 -->
<g id="node637" class="node">
<title>attn_tp3_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="191756,-161.98 191496,-161.98 191496,-109.98 191756,-109.98 191756,-161.98"/>
<text text-anchor="middle" x="191626" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L9</text>
<text text-anchor="middle" x="191626" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="191626" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="191626" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp1&#45;&gt;attn_tp3_l9_dp1 -->
<g id="edge1066" class="edge">
<title>attn_input_l9_dp1&#45;&gt;attn_tp3_l9_dp1</title>
<path fill="none" stroke="black" d="M191461.28,-135.98C191469.35,-135.98 191477.42,-135.98 191485.49,-135.98"/>
<polygon fill="black" stroke="black" points="191485.7,-139.48 191495.7,-135.98 191485.7,-132.48 191485.7,-139.48"/>
</g>
<!-- allreduce_l9_dp1 -->
<g id="node638" class="node">
<title>allreduce_l9_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="192794" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="192794" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L9</text>
<text text-anchor="middle" x="192794" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="192794" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l9_dp1&#45;&gt;allreduce_l9_dp1 -->
<g id="edge1067" class="edge">
<title>attn_tp0_l9_dp1&#45;&gt;allreduce_l9_dp1</title>
<path fill="none" stroke="black" d="M192590.14,-135.98C192598.35,-135.98 192606.56,-135.98 192614.77,-135.98"/>
<polygon fill="black" stroke="black" points="192614.78,-139.48 192624.78,-135.98 192614.78,-132.48 192614.78,-139.48"/>
</g>
<!-- attn_tp1_l9_dp1&#45;&gt;allreduce_l9_dp1 -->
<g id="edge1068" class="edge">
<title>attn_tp1_l9_dp1&#45;&gt;allreduce_l9_dp1</title>
<path fill="none" stroke="black" d="M192244.22,-162.03C192270.24,-171.59 192301.1,-181.23 192330,-185.98 192387.01,-195.35 192532.64,-192.91 192590,-185.98 192626.57,-181.57 192666.05,-172.85 192700.44,-163.91"/>
<polygon fill="black" stroke="black" points="192701.7,-167.2 192710.47,-161.26 192699.91,-160.43 192701.7,-167.2"/>
</g>
<!-- attn_tp2_l9_dp1&#45;&gt;allreduce_l9_dp1 -->
<g id="edge1069" class="edge">
<title>attn_tp2_l9_dp1&#45;&gt;allreduce_l9_dp1</title>
<path fill="none" stroke="black" d="M191966.22,-162.03C191992.24,-171.59 192023.1,-181.23 192052,-185.98 192110.98,-195.68 192530.65,-193.15 192590,-185.98 192626.57,-181.57 192666.05,-172.85 192700.44,-163.91"/>
<polygon fill="black" stroke="black" points="192701.7,-167.2 192710.47,-161.26 192699.91,-160.43 192701.7,-167.2"/>
</g>
<!-- attn_tp3_l9_dp1&#45;&gt;allreduce_l9_dp1 -->
<g id="edge1070" class="edge">
<title>attn_tp3_l9_dp1&#45;&gt;allreduce_l9_dp1</title>
<path fill="none" stroke="black" d="M191688.22,-162.03C191714.24,-171.59 191745.1,-181.23 191774,-185.98 191818.73,-193.33 192544.99,-191.42 192590,-185.98 192626.57,-181.57 192666.05,-172.85 192700.44,-163.91"/>
<polygon fill="black" stroke="black" points="192701.7,-167.2 192710.47,-161.26 192699.91,-160.43 192701.7,-167.2"/>
</g>
<!-- moe_input_l9_dp1 -->
<g id="node639" class="node">
<title>moe_input_l9_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="193167" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="193167" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L9</text>
<text text-anchor="middle" x="193167" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="193167" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l9_dp1&#45;&gt;moe_input_l9_dp1 -->
<g id="edge1071" class="edge">
<title>allreduce_l9_dp1&#45;&gt;moe_input_l9_dp1</title>
<path fill="none" stroke="black" d="M192963.01,-135.98C192971.23,-135.98 192979.44,-135.98 192987.66,-135.98"/>
<polygon fill="black" stroke="black" points="192987.68,-139.48 192997.68,-135.98 192987.68,-132.48 192987.68,-139.48"/>
</g>
<!-- router_l9_dp1 -->
<g id="node640" class="node">
<title>router_l9_dp1</title>
<polygon fill="lightyellow" stroke="black" points="193866.57,-176.98 193472.74,-176.98 193371.43,-94.98 193765.26,-94.98 193866.57,-176.98"/>
<text text-anchor="middle" x="193619" y="-144.48" font-family="Arial" font-size="10.00">Router L9</text>
<text text-anchor="middle" x="193619" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="193619" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l9_dp1&#45;&gt;router_l9_dp1 -->
<g id="edge1072" class="edge">
<title>moe_input_l9_dp1&#45;&gt;router_l9_dp1</title>
<path fill="none" stroke="black" d="M193336.06,-135.98C193361.34,-135.98 193386.63,-135.98 193411.92,-135.98"/>
<polygon fill="black" stroke="black" points="193411.99,-139.48 193421.99,-135.98 193411.99,-132.48 193411.99,-139.48"/>
</g>
<!-- expert0_l9_dp1 -->
<g id="node641" class="node">
<title>expert0_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="197861.5,-161.98 197632.5,-161.98 197632.5,-109.98 197861.5,-109.98 197861.5,-161.98"/>
<text text-anchor="middle" x="197747" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L9</text>
<text text-anchor="middle" x="197747" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="197747" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="197747" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert0_l9_dp1 -->
<g id="edge1073" class="edge">
<title>router_l9_dp1&#45;&gt;expert0_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.24,-171.8C193879.75,-173.86 193899.18,-175.64 193918,-176.98 194682.62,-231.61 196600.93,-196.54 197367.5,-198.98 197481.47,-199.35 197511.56,-200.88 197623,-176.98 197637.41,-173.89 197652.5,-169.73 197666.99,-165.23"/>
<polygon fill="black" stroke="black" points="197668.44,-168.45 197676.91,-162.08 197666.32,-161.77 197668.44,-168.45"/>
<text text-anchor="middle" x="197389" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l9_dp1 -->
<g id="node642" class="node">
<title>expert1_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="197614.5,-161.98 197385.5,-161.98 197385.5,-109.98 197614.5,-109.98 197614.5,-161.98"/>
<text text-anchor="middle" x="197500" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L9</text>
<text text-anchor="middle" x="197500" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="197500" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="197500" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert1_l9_dp1 -->
<g id="edge1074" class="edge">
<title>router_l9_dp1&#45;&gt;expert1_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.24,-171.79C193879.75,-173.85 193899.18,-175.63 193918,-176.98 194626.97,-227.82 196405.71,-196.54 197116.5,-198.98 197232.24,-199.38 197262.8,-201.15 197376,-176.98 197390.64,-173.86 197405.98,-169.62 197420.68,-165.04"/>
<polygon fill="black" stroke="black" points="197421.77,-168.37 197430.24,-162 197419.65,-161.7 197421.77,-168.37"/>
<text text-anchor="middle" x="197138" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l9_dp1 -->
<g id="node643" class="node">
<title>expert2_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="197367.5,-161.98 197138.5,-161.98 197138.5,-109.98 197367.5,-109.98 197367.5,-161.98"/>
<text text-anchor="middle" x="197253" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L9</text>
<text text-anchor="middle" x="197253" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="197253" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="197253" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert2_l9_dp1 -->
<g id="edge1075" class="edge">
<title>router_l9_dp1&#45;&gt;expert2_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.24,-171.78C193879.75,-173.84 193899.18,-175.63 193918,-176.98 194570.22,-223.94 196206.6,-196.54 196860.5,-198.98 196980.23,-199.43 197011.85,-201.74 197129,-176.98 197143.65,-173.89 197158.99,-169.66 197173.69,-165.09"/>
<polygon fill="black" stroke="black" points="197174.78,-168.42 197183.25,-162.05 197172.66,-161.75 197174.78,-168.42"/>
<text text-anchor="middle" x="196882" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l9_dp1 -->
<g id="node644" class="node">
<title>expert3_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="197120.5,-161.98 196891.5,-161.98 196891.5,-109.98 197120.5,-109.98 197120.5,-161.98"/>
<text text-anchor="middle" x="197006" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L9</text>
<text text-anchor="middle" x="197006" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="197006" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="197006" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert3_l9_dp1 -->
<g id="edge1076" class="edge">
<title>router_l9_dp1&#45;&gt;expert3_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.24,-171.76C193879.75,-173.83 193899.19,-175.62 193918,-176.98 194511.69,-219.95 196001.26,-196.54 196596.5,-198.98 196723.76,-199.51 196757.4,-202.88 196882,-176.98 196896.75,-173.92 196912.2,-169.68 196926.98,-165.09"/>
<polygon fill="black" stroke="black" points="196928.13,-168.4 196936.59,-162.03 196926,-161.73 196928.13,-168.4"/>
<text text-anchor="middle" x="196618" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l9_dp1 -->
<g id="node645" class="node">
<title>expert4_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="196873.5,-161.98 196644.5,-161.98 196644.5,-109.98 196873.5,-109.98 196873.5,-161.98"/>
<text text-anchor="middle" x="196759" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L9</text>
<text text-anchor="middle" x="196759" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="196759" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="196759" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert4_l9_dp1 -->
<g id="edge1077" class="edge">
<title>router_l9_dp1&#45;&gt;expert4_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.24,-171.74C193879.75,-173.82 193899.19,-175.61 193918,-176.98 194449.39,-215.7 195782.7,-196.54 196315.5,-198.98 196457.83,-199.64 196495.48,-205.17 196635,-176.98 196649.86,-173.98 196665.41,-169.75 196680.29,-165.14"/>
<polygon fill="black" stroke="black" points="196681.48,-168.43 196689.95,-162.06 196679.36,-161.76 196681.48,-168.43"/>
<text text-anchor="middle" x="196337" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l9_dp1 -->
<g id="node646" class="node">
<title>expert5_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="196626.5,-161.98 196397.5,-161.98 196397.5,-109.98 196626.5,-109.98 196626.5,-161.98"/>
<text text-anchor="middle" x="196512" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L9</text>
<text text-anchor="middle" x="196512" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="196512" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="196512" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert5_l9_dp1 -->
<g id="edge1078" class="edge">
<title>router_l9_dp1&#45;&gt;expert5_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.24,-171.71C193879.75,-173.79 193899.19,-175.6 193918,-176.98 194379.33,-210.92 195536.92,-196.54 195999.5,-198.98 196172.44,-199.9 196218.22,-209.89 196388,-176.98 196403.06,-174.06 196418.83,-169.82 196433.87,-165.16"/>
<polygon fill="black" stroke="black" points="196435.17,-168.42 196443.64,-162.05 196433.05,-161.75 196435.17,-168.42"/>
<text text-anchor="middle" x="196021" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l9_dp1 -->
<g id="node647" class="node">
<title>expert6_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="196379.5,-161.98 196150.5,-161.98 196150.5,-109.98 196379.5,-109.98 196379.5,-161.98"/>
<text text-anchor="middle" x="196265" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L9</text>
<text text-anchor="middle" x="196265" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="196265" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="196265" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert6_l9_dp1 -->
<g id="edge1079" class="edge">
<title>router_l9_dp1&#45;&gt;expert6_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193801.37,-177C193849.6,-186.1 193901.8,-194.4 193950.5,-198.98 193969.53,-200.77 193974.39,-199.08 193993.5,-198.98 194232.12,-197.76 195905.61,-216.13 196141,-176.98 196156.84,-174.35 196173.4,-170.04 196189.07,-165.17"/>
<polygon fill="black" stroke="black" points="196190.25,-168.47 196198.7,-162.09 196188.11,-161.81 196190.25,-168.47"/>
<text text-anchor="middle" x="193972" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l9_dp1 -->
<g id="node648" class="node">
<title>expert7_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="196132.5,-161.98 195903.5,-161.98 195903.5,-109.98 196132.5,-109.98 196132.5,-161.98"/>
<text text-anchor="middle" x="196018" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L9</text>
<text text-anchor="middle" x="196018" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="196018" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="196018" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert7_l9_dp1 -->
<g id="edge1080" class="edge">
<title>router_l9_dp1&#45;&gt;expert7_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.25,-171.66C193879.76,-173.76 193899.19,-175.58 193918,-176.98 194669.96,-233.2 194860.45,-194.09 195614.5,-198.98 195739.1,-199.79 195772.03,-202.48 195894,-176.98 195908.75,-173.9 195924.19,-169.66 195938.98,-165.06"/>
<polygon fill="black" stroke="black" points="195940.12,-168.37 195948.59,-162 195938,-161.7 195940.12,-168.37"/>
<text text-anchor="middle" x="195636" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l9_dp1 -->
<g id="node649" class="node">
<title>expert8_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="195885.5,-161.98 195656.5,-161.98 195656.5,-109.98 195885.5,-109.98 195885.5,-161.98"/>
<text text-anchor="middle" x="195771" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L9</text>
<text text-anchor="middle" x="195771" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="195771" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="195771" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert8_l9_dp1 -->
<g id="edge1081" class="edge">
<title>router_l9_dp1&#45;&gt;expert8_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193860.25,-171.61C193879.76,-173.71 193899.19,-175.55 193918,-176.98 194548.03,-224.88 194707.66,-194.09 195339.5,-198.98 195476.51,-200.04 195512.75,-204.36 195647,-176.98 195661.85,-173.95 195677.4,-169.71 195692.28,-165.09"/>
<polygon fill="black" stroke="black" points="195693.47,-168.39 195701.94,-162.02 195691.35,-161.72 195693.47,-168.39"/>
<text text-anchor="middle" x="195361" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l9_dp1 -->
<g id="node650" class="node">
<title>expert9_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="195638.5,-161.98 195409.5,-161.98 195409.5,-109.98 195638.5,-109.98 195638.5,-161.98"/>
<text text-anchor="middle" x="195524" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L9</text>
<text text-anchor="middle" x="195524" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="195524" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="195524" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert9_l9_dp1 -->
<g id="edge1082" class="edge">
<title>router_l9_dp1&#45;&gt;expert9_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193859.85,-171.48C193879.49,-173.62 193899.06,-175.5 193918,-176.98 194175.37,-197.09 194821.49,-207.83 195079.5,-198.98 195222.19,-194.09 195259.9,-204.5 195400,-176.98 195415.06,-174.03 195430.82,-169.77 195445.86,-165.1"/>
<polygon fill="black" stroke="black" points="195447.16,-168.36 195455.63,-161.99 195445.03,-161.69 195447.16,-168.36"/>
<text text-anchor="middle" x="195058" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l9_dp1 -->
<g id="node651" class="node">
<title>expert10_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="195391.5,-161.98 195162.5,-161.98 195162.5,-109.98 195391.5,-109.98 195391.5,-161.98"/>
<text text-anchor="middle" x="195277" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L9</text>
<text text-anchor="middle" x="195277" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="195277" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="195277" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert10_l9_dp1 -->
<g id="edge1083" class="edge">
<title>router_l9_dp1&#45;&gt;expert10_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193846.31,-177.01C193906.33,-186.11 193971.18,-194.4 194031.5,-198.98 194155.78,-208.42 195030.16,-198.05 195153,-176.98 195168.73,-174.28 195185.18,-169.97 195200.78,-165.13"/>
<polygon fill="black" stroke="black" points="195201.9,-168.45 195210.36,-162.06 195199.77,-161.78 195201.9,-168.45"/>
<text text-anchor="middle" x="194053" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l9_dp1 -->
<g id="node652" class="node">
<title>expert11_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="195144.5,-161.98 194915.5,-161.98 194915.5,-109.98 195144.5,-109.98 195144.5,-161.98"/>
<text text-anchor="middle" x="195030" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L9</text>
<text text-anchor="middle" x="195030" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="195030" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="195030" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert11_l9_dp1 -->
<g id="edge1084" class="edge">
<title>router_l9_dp1&#45;&gt;expert11_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193859.87,-171.28C193879.51,-173.47 193899.07,-175.42 193918,-176.98 194273.58,-206.43 194364.32,-220.03 194720.5,-198.98 194803.38,-194.09 194824.95,-194.99 194906,-176.98 194920.3,-173.81 194935.27,-169.62 194949.68,-165.14"/>
<polygon fill="black" stroke="black" points="194951.07,-168.37 194959.54,-162 194948.95,-161.7 194951.07,-168.37"/>
<text text-anchor="middle" x="194699" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l9_dp1 -->
<g id="node653" class="node">
<title>expert12_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="194897.5,-161.98 194668.5,-161.98 194668.5,-109.98 194897.5,-109.98 194897.5,-161.98"/>
<text text-anchor="middle" x="194783" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L9</text>
<text text-anchor="middle" x="194783" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="194783" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="194783" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert12_l9_dp1 -->
<g id="edge1085" class="edge">
<title>router_l9_dp1&#45;&gt;expert12_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193859.65,-171.3C194035.95,-192.77 194281.06,-213.5 194496.5,-198.98 194569.21,-194.08 194587.99,-193.38 194659,-176.98 194673.09,-173.73 194687.86,-169.55 194702.09,-165.11"/>
<polygon fill="black" stroke="black" points="194703.37,-168.38 194711.84,-162.01 194701.25,-161.71 194703.37,-168.38"/>
<text text-anchor="middle" x="194475" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l9_dp1 -->
<g id="node654" class="node">
<title>expert13_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="194650.5,-161.98 194421.5,-161.98 194421.5,-109.98 194650.5,-109.98 194650.5,-161.98"/>
<text text-anchor="middle" x="194536" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L9</text>
<text text-anchor="middle" x="194536" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="194536" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="194536" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert13_l9_dp1 -->
<g id="edge1086" class="edge">
<title>router_l9_dp1&#45;&gt;expert13_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193837.6,-177.02C193970.1,-196.74 194142.53,-213.3 194295.5,-198.98 194347.96,-194.07 194360.98,-190.17 194412,-176.98 194425.34,-173.53 194439.33,-169.41 194452.91,-165.13"/>
<polygon fill="black" stroke="black" points="194454.25,-168.38 194462.71,-162 194452.12,-161.71 194454.25,-168.38"/>
<text text-anchor="middle" x="194274" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l9_dp1 -->
<g id="node655" class="node">
<title>expert14_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="194403.5,-161.98 194174.5,-161.98 194174.5,-109.98 194403.5,-109.98 194403.5,-161.98"/>
<text text-anchor="middle" x="194289" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L9</text>
<text text-anchor="middle" x="194289" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="194289" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="194289" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert14_l9_dp1 -->
<g id="edge1087" class="edge">
<title>router_l9_dp1&#45;&gt;expert14_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193841.86,-177.01C193956.32,-195.26 194083.29,-210.34 194139.5,-198.98 194171.11,-192.59 194204.35,-179.32 194231.44,-166.59"/>
<polygon fill="black" stroke="black" points="194233.25,-169.61 194240.75,-162.13 194230.22,-163.29 194233.25,-169.61"/>
<text text-anchor="middle" x="194118" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l9_dp1 -->
<g id="node656" class="node">
<title>expert15_l9_dp1</title>
<polygon fill="lightgreen" stroke="black" points="194156.5,-161.98 193927.5,-161.98 193927.5,-109.98 194156.5,-109.98 194156.5,-161.98"/>
<text text-anchor="middle" x="194042" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L9</text>
<text text-anchor="middle" x="194042" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="194042" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="194042" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp1&#45;&gt;expert15_l9_dp1 -->
<g id="edge1088" class="edge">
<title>router_l9_dp1&#45;&gt;expert15_l9_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M193815.95,-135.98C193850.38,-135.98 193885.32,-135.98 193917.11,-135.98"/>
<polygon fill="black" stroke="black" points="193917.32,-139.48 193927.32,-135.98 193917.32,-132.48 193917.32,-139.48"/>
<text text-anchor="middle" x="193897.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l9_dp1 -->
<g id="node657" class="node">
<title>expert_agg_l9_dp1</title>
<polygon fill="lightyellow" stroke="black" points="198392.57,-176.98 197998.74,-176.98 197897.43,-94.98 198291.26,-94.98 198392.57,-176.98"/>
<text text-anchor="middle" x="198145" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L9</text>
<text text-anchor="middle" x="198145" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="198145" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1089" class="edge">
<title>expert0_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M197861.66,-135.98C197887.06,-135.98 197912.47,-135.98 197937.87,-135.98"/>
<polygon fill="black" stroke="black" points="197937.99,-139.48 197947.99,-135.98 197937.99,-132.48 197937.99,-139.48"/>
</g>
<!-- expert1_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1090" class="edge">
<title>expert1_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M197555.24,-162.02C197578.4,-171.57 197605.96,-181.22 197632,-185.98 197682.06,-195.15 197810.3,-190.41 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert2_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1091" class="edge">
<title>expert2_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M197308.24,-162.02C197331.4,-171.57 197358.96,-181.22 197385,-185.98 197437.02,-195.51 197808.31,-190.59 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert3_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1092" class="edge">
<title>expert3_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M197061.24,-162.02C197084.4,-171.57 197111.96,-181.22 197138,-185.98 197217.02,-200.45 197780.97,-192.97 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert4_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1093" class="edge">
<title>expert4_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M196814.24,-162.02C196837.4,-171.57 196864.96,-181.22 196891,-185.98 196944.01,-195.69 197807.31,-190.67 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert5_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1094" class="edge">
<title>expert5_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M196567.24,-162.02C196590.4,-171.57 196617.96,-181.22 196644,-185.98 196710.5,-198.16 197793.64,-191.87 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert6_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1095" class="edge">
<title>expert6_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M196320.24,-162.02C196343.4,-171.57 196370.96,-181.22 196397,-185.98 196477,-200.63 197779.97,-193.06 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert7_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1096" class="edge">
<title>expert7_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M196073.24,-162.02C196096.4,-171.57 196123.96,-181.22 196150,-185.98 196196.75,-194.54 197813.65,-190.12 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert8_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1097" class="edge">
<title>expert8_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M195826.24,-162.02C195849.4,-171.57 195876.96,-181.22 195903,-185.98 195956.5,-195.78 197806.82,-190.72 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert9_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1098" class="edge">
<title>expert9_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M195579.24,-162.02C195602.4,-171.57 195629.96,-181.22 195656,-185.98 195716.25,-197.01 197799.98,-191.31 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert10_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1099" class="edge">
<title>expert10_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M195332.24,-162.02C195355.4,-171.57 195382.96,-181.22 195409,-185.98 195476,-198.25 197793.15,-191.91 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert11_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1100" class="edge">
<title>expert11_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M195085.24,-162.02C195108.4,-171.57 195135.96,-181.22 195162,-185.98 195235.75,-199.48 197786.31,-192.51 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert12_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1101" class="edge">
<title>expert12_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M194838.24,-162.02C194861.4,-171.57 194888.96,-181.22 194915,-185.98 194995.49,-200.72 197779.48,-193.1 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert13_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1102" class="edge">
<title>expert13_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M194591.24,-162.02C194614.4,-171.57 194641.96,-181.22 194668,-185.98 194711.62,-193.97 197816.82,-189.84 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert14_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1103" class="edge">
<title>expert14_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M194344.24,-162.02C194367.4,-171.57 194394.96,-181.22 194421,-185.98 194468,-194.59 197813.4,-190.14 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- expert15_l9_dp1&#45;&gt;expert_agg_l9_dp1 -->
<g id="edge1104" class="edge">
<title>expert15_l9_dp1&#45;&gt;expert_agg_l9_dp1</title>
<path fill="none" stroke="black" d="M194097.24,-162.02C194120.4,-171.57 194147.96,-181.22 194174,-185.98 194224.37,-195.2 197809.98,-190.44 197861,-185.98 197899.11,-182.65 197939.78,-176.86 197978.08,-170.36"/>
<polygon fill="black" stroke="black" points="197979.02,-173.75 197988.29,-168.6 197977.84,-166.85 197979.02,-173.75"/>
</g>
<!-- layer9_output_dp1 -->
<g id="node658" class="node">
<title>layer9_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="198597" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="198597" y="-144.48" font-family="Arial" font-size="10.00">Layer 9 Output</text>
<text text-anchor="middle" x="198597" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="198597" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l9_dp1&#45;&gt;layer9_output_dp1 -->
<g id="edge1105" class="edge">
<title>expert_agg_l9_dp1&#45;&gt;layer9_output_dp1</title>
<path fill="none" stroke="black" d="M198342.31,-135.98C198367.49,-135.98 198392.66,-135.98 198417.84,-135.98"/>
<polygon fill="black" stroke="black" points="198417.87,-139.48 198427.87,-135.98 198417.87,-132.48 198417.87,-139.48"/>
</g>
<!-- attn_input_l10_dp1 -->
<g id="node659" class="node">
<title>attn_input_l10_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="198970" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="198970" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L10</text>
<text text-anchor="middle" x="198970" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="198970" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer9_output_dp1&#45;&gt;attn_input_l10_dp1 -->
<g id="edge1106" class="edge">
<title>layer9_output_dp1&#45;&gt;attn_input_l10_dp1</title>
<path fill="none" stroke="black" d="M198766.01,-135.98C198774.23,-135.98 198782.44,-135.98 198790.66,-135.98"/>
<polygon fill="black" stroke="black" points="198790.68,-139.48 198800.68,-135.98 198790.68,-132.48 198790.68,-139.48"/>
</g>
<!-- attn_tp0_l10_dp1 -->
<g id="node660" class="node">
<title>attn_tp0_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="200268,-161.98 200008,-161.98 200008,-109.98 200268,-109.98 200268,-161.98"/>
<text text-anchor="middle" x="200138" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L10</text>
<text text-anchor="middle" x="200138" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="200138" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="200138" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp1&#45;&gt;attn_tp0_l10_dp1 -->
<g id="edge1107" class="edge">
<title>attn_input_l10_dp1&#45;&gt;attn_tp0_l10_dp1</title>
<path fill="none" stroke="black" d="M199053.52,-161.26C199090.12,-171.09 199133.81,-181.13 199174,-185.98 199219,-191.42 199945.27,-193.33 199990,-185.98 200015.4,-181.81 200042.31,-173.85 200066.12,-165.5"/>
<polygon fill="black" stroke="black" points="200067.55,-168.71 200075.78,-162.03 200065.18,-162.12 200067.55,-168.71"/>
</g>
<!-- attn_tp1_l10_dp1 -->
<g id="node661" class="node">
<title>attn_tp1_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="199990,-161.98 199730,-161.98 199730,-109.98 199990,-109.98 199990,-161.98"/>
<text text-anchor="middle" x="199860" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L10</text>
<text text-anchor="middle" x="199860" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="199860" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="199860" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp1&#45;&gt;attn_tp1_l10_dp1 -->
<g id="edge1108" class="edge">
<title>attn_input_l10_dp1&#45;&gt;attn_tp1_l10_dp1</title>
<path fill="none" stroke="black" d="M199053.52,-161.26C199090.12,-171.09 199133.81,-181.13 199174,-185.98 199233.35,-193.15 199653.01,-195.68 199712,-185.98 199737.4,-181.81 199764.31,-173.85 199788.12,-165.5"/>
<polygon fill="black" stroke="black" points="199789.55,-168.71 199797.78,-162.03 199787.18,-162.12 199789.55,-168.71"/>
</g>
<!-- attn_tp2_l10_dp1 -->
<g id="node662" class="node">
<title>attn_tp2_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="199712,-161.98 199452,-161.98 199452,-109.98 199712,-109.98 199712,-161.98"/>
<text text-anchor="middle" x="199582" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L10</text>
<text text-anchor="middle" x="199582" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="199582" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="199582" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp1&#45;&gt;attn_tp2_l10_dp1 -->
<g id="edge1109" class="edge">
<title>attn_input_l10_dp1&#45;&gt;attn_tp2_l10_dp1</title>
<path fill="none" stroke="black" d="M199053.52,-161.26C199090.12,-171.09 199133.81,-181.13 199174,-185.98 199231.36,-192.91 199376.99,-195.35 199434,-185.98 199459.4,-181.81 199486.31,-173.85 199510.12,-165.5"/>
<polygon fill="black" stroke="black" points="199511.55,-168.71 199519.78,-162.03 199509.18,-162.12 199511.55,-168.71"/>
</g>
<!-- attn_tp3_l10_dp1 -->
<g id="node663" class="node">
<title>attn_tp3_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="199434,-161.98 199174,-161.98 199174,-109.98 199434,-109.98 199434,-161.98"/>
<text text-anchor="middle" x="199304" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L10</text>
<text text-anchor="middle" x="199304" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="199304" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="199304" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp1&#45;&gt;attn_tp3_l10_dp1 -->
<g id="edge1110" class="edge">
<title>attn_input_l10_dp1&#45;&gt;attn_tp3_l10_dp1</title>
<path fill="none" stroke="black" d="M199139.28,-135.98C199147.35,-135.98 199155.42,-135.98 199163.49,-135.98"/>
<polygon fill="black" stroke="black" points="199163.7,-139.48 199173.7,-135.98 199163.7,-132.48 199163.7,-139.48"/>
</g>
<!-- allreduce_l10_dp1 -->
<g id="node664" class="node">
<title>allreduce_l10_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="200472" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="200472" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L10</text>
<text text-anchor="middle" x="200472" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="200472" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l10_dp1&#45;&gt;allreduce_l10_dp1 -->
<g id="edge1111" class="edge">
<title>attn_tp0_l10_dp1&#45;&gt;allreduce_l10_dp1</title>
<path fill="none" stroke="black" d="M200268.14,-135.98C200276.35,-135.98 200284.56,-135.98 200292.77,-135.98"/>
<polygon fill="black" stroke="black" points="200292.78,-139.48 200302.78,-135.98 200292.78,-132.48 200292.78,-139.48"/>
</g>
<!-- attn_tp1_l10_dp1&#45;&gt;allreduce_l10_dp1 -->
<g id="edge1112" class="edge">
<title>attn_tp1_l10_dp1&#45;&gt;allreduce_l10_dp1</title>
<path fill="none" stroke="black" d="M199922.22,-162.03C199948.24,-171.59 199979.1,-181.23 200008,-185.98 200065.01,-195.35 200210.64,-192.91 200268,-185.98 200304.57,-181.57 200344.05,-172.85 200378.44,-163.91"/>
<polygon fill="black" stroke="black" points="200379.7,-167.2 200388.47,-161.26 200377.91,-160.43 200379.7,-167.2"/>
</g>
<!-- attn_tp2_l10_dp1&#45;&gt;allreduce_l10_dp1 -->
<g id="edge1113" class="edge">
<title>attn_tp2_l10_dp1&#45;&gt;allreduce_l10_dp1</title>
<path fill="none" stroke="black" d="M199644.22,-162.03C199670.24,-171.59 199701.1,-181.23 199730,-185.98 199788.98,-195.68 200208.65,-193.15 200268,-185.98 200304.57,-181.57 200344.05,-172.85 200378.44,-163.91"/>
<polygon fill="black" stroke="black" points="200379.7,-167.2 200388.47,-161.26 200377.91,-160.43 200379.7,-167.2"/>
</g>
<!-- attn_tp3_l10_dp1&#45;&gt;allreduce_l10_dp1 -->
<g id="edge1114" class="edge">
<title>attn_tp3_l10_dp1&#45;&gt;allreduce_l10_dp1</title>
<path fill="none" stroke="black" d="M199366.22,-162.03C199392.24,-171.59 199423.1,-181.23 199452,-185.98 199496.73,-193.33 200222.99,-191.42 200268,-185.98 200304.57,-181.57 200344.05,-172.85 200378.44,-163.91"/>
<polygon fill="black" stroke="black" points="200379.7,-167.2 200388.47,-161.26 200377.91,-160.43 200379.7,-167.2"/>
</g>
<!-- moe_input_l10_dp1 -->
<g id="node665" class="node">
<title>moe_input_l10_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="200845" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="200845" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L10</text>
<text text-anchor="middle" x="200845" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="200845" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l10_dp1&#45;&gt;moe_input_l10_dp1 -->
<g id="edge1115" class="edge">
<title>allreduce_l10_dp1&#45;&gt;moe_input_l10_dp1</title>
<path fill="none" stroke="black" d="M200641.01,-135.98C200649.23,-135.98 200657.44,-135.98 200665.66,-135.98"/>
<polygon fill="black" stroke="black" points="200665.68,-139.48 200675.68,-135.98 200665.68,-132.48 200665.68,-139.48"/>
</g>
<!-- router_l10_dp1 -->
<g id="node666" class="node">
<title>router_l10_dp1</title>
<polygon fill="lightyellow" stroke="black" points="201544.57,-176.98 201150.74,-176.98 201049.43,-94.98 201443.26,-94.98 201544.57,-176.98"/>
<text text-anchor="middle" x="201297" y="-144.48" font-family="Arial" font-size="10.00">Router L10</text>
<text text-anchor="middle" x="201297" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="201297" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l10_dp1&#45;&gt;router_l10_dp1 -->
<g id="edge1116" class="edge">
<title>moe_input_l10_dp1&#45;&gt;router_l10_dp1</title>
<path fill="none" stroke="black" d="M201014.06,-135.98C201039.34,-135.98 201064.63,-135.98 201089.92,-135.98"/>
<polygon fill="black" stroke="black" points="201089.99,-139.48 201099.99,-135.98 201089.99,-132.48 201089.99,-139.48"/>
</g>
<!-- expert0_l10_dp1 -->
<g id="node667" class="node">
<title>expert0_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="205539.5,-161.98 205310.5,-161.98 205310.5,-109.98 205539.5,-109.98 205539.5,-161.98"/>
<text text-anchor="middle" x="205425" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L10</text>
<text text-anchor="middle" x="205425" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="205425" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="205425" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert0_l10_dp1 -->
<g id="edge1117" class="edge">
<title>router_l10_dp1&#45;&gt;expert0_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.24,-171.8C201557.75,-173.86 201577.18,-175.64 201596,-176.98 202359.73,-231.55 204275.82,-196.54 205041.5,-198.98 205157.24,-199.35 205187.8,-201.15 205301,-176.98 205315.64,-173.86 205330.98,-169.62 205345.68,-165.04"/>
<polygon fill="black" stroke="black" points="205346.77,-168.37 205355.24,-162 205344.65,-161.7 205346.77,-168.37"/>
<text text-anchor="middle" x="205063" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l10_dp1 -->
<g id="node668" class="node">
<title>expert1_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="205292.5,-161.98 205063.5,-161.98 205063.5,-109.98 205292.5,-109.98 205292.5,-161.98"/>
<text text-anchor="middle" x="205178" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L10</text>
<text text-anchor="middle" x="205178" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="205178" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="205178" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert1_l10_dp1 -->
<g id="edge1118" class="edge">
<title>router_l10_dp1&#45;&gt;expert1_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.24,-171.79C201557.75,-173.85 201577.18,-175.63 201596,-176.98 202302.98,-227.68 204076.71,-196.54 204785.5,-198.98 204905.23,-199.4 204936.85,-201.74 205054,-176.98 205068.65,-173.89 205083.99,-169.66 205098.69,-165.09"/>
<polygon fill="black" stroke="black" points="205099.78,-168.42 205108.25,-162.05 205097.66,-161.75 205099.78,-168.42"/>
<text text-anchor="middle" x="204807" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l10_dp1 -->
<g id="node669" class="node">
<title>expert2_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="205045.5,-161.98 204816.5,-161.98 204816.5,-109.98 205045.5,-109.98 205045.5,-161.98"/>
<text text-anchor="middle" x="204931" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L10</text>
<text text-anchor="middle" x="204931" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="204931" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="204931" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert2_l10_dp1 -->
<g id="edge1119" class="edge">
<title>router_l10_dp1&#45;&gt;expert2_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.24,-171.78C201557.75,-173.84 201577.18,-175.63 201596,-176.98 202244.45,-223.68 203871.37,-196.54 204521.5,-198.98 204648.76,-199.46 204682.4,-202.88 204807,-176.98 204821.75,-173.92 204837.2,-169.68 204851.98,-165.09"/>
<polygon fill="black" stroke="black" points="204853.13,-168.4 204861.59,-162.03 204851,-161.73 204853.13,-168.4"/>
<text text-anchor="middle" x="204543" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l10_dp1 -->
<g id="node670" class="node">
<title>expert3_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="204798.5,-161.98 204569.5,-161.98 204569.5,-109.98 204798.5,-109.98 204798.5,-161.98"/>
<text text-anchor="middle" x="204684" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L10</text>
<text text-anchor="middle" x="204684" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="204684" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="204684" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert3_l10_dp1 -->
<g id="edge1120" class="edge">
<title>router_l10_dp1&#45;&gt;expert3_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.24,-171.76C201557.75,-173.83 201577.19,-175.62 201596,-176.98 202181.93,-219.42 203652.04,-196.54 204239.5,-198.98 204382.28,-199.58 204420.04,-205.24 204560,-176.98 204574.86,-173.98 204590.41,-169.75 204605.29,-165.14"/>
<polygon fill="black" stroke="black" points="204606.48,-168.43 204614.95,-162.06 204604.36,-161.76 204606.48,-168.43"/>
<text text-anchor="middle" x="204261" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l10_dp1 -->
<g id="node671" class="node">
<title>expert4_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="204551.5,-161.98 204322.5,-161.98 204322.5,-109.98 204551.5,-109.98 204551.5,-161.98"/>
<text text-anchor="middle" x="204437" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L10</text>
<text text-anchor="middle" x="204437" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="204437" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="204437" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert4_l10_dp1 -->
<g id="edge1121" class="edge">
<title>router_l10_dp1&#45;&gt;expert4_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.24,-171.74C201557.75,-173.81 201577.19,-175.61 201596,-176.98 202111.65,-214.62 203405.48,-196.54 203922.5,-198.98 204096.33,-199.8 204142.34,-210.03 204313,-176.98 204328.06,-174.07 204343.83,-169.83 204358.87,-165.17"/>
<polygon fill="black" stroke="black" points="204360.17,-168.42 204368.64,-162.05 204358.05,-161.75 204360.17,-168.42"/>
<text text-anchor="middle" x="203944" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l10_dp1 -->
<g id="node672" class="node">
<title>expert5_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="204304.5,-161.98 204075.5,-161.98 204075.5,-109.98 204304.5,-109.98 204304.5,-161.98"/>
<text text-anchor="middle" x="204190" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L10</text>
<text text-anchor="middle" x="204190" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="204190" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="204190" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert5_l10_dp1 -->
<g id="edge1122" class="edge">
<title>router_l10_dp1&#45;&gt;expert5_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201466.03,-177C201510.77,-186.09 201559.23,-194.39 201604.5,-198.98 201623.51,-200.91 201628.39,-199.07 201647.5,-198.98 201916.23,-197.76 203800.88,-220.91 204066,-176.98 204081.93,-174.34 204098.59,-170 204114.35,-165.1"/>
<polygon fill="black" stroke="black" points="204115.58,-168.38 204124.03,-161.99 204113.44,-161.72 204115.58,-168.38"/>
<text text-anchor="middle" x="201626" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l10_dp1 -->
<g id="node673" class="node">
<title>expert6_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="204057.5,-161.98 203828.5,-161.98 203828.5,-109.98 204057.5,-109.98 204057.5,-161.98"/>
<text text-anchor="middle" x="203943" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L10</text>
<text text-anchor="middle" x="203943" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="203943" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="203943" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert6_l10_dp1 -->
<g id="edge1123" class="edge">
<title>router_l10_dp1&#45;&gt;expert6_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.25,-171.7C201557.75,-173.78 201577.19,-175.59 201596,-176.98 202026.07,-208.78 203105.26,-196.54 203536.5,-198.98 203662.43,-199.7 203695.71,-202.68 203819,-176.98 203833.75,-173.91 203849.19,-169.67 203863.98,-165.07"/>
<polygon fill="black" stroke="black" points="203865.12,-168.38 203873.59,-162.01 203863,-161.71 203865.12,-168.38"/>
<text text-anchor="middle" x="203558" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l10_dp1 -->
<g id="node674" class="node">
<title>expert7_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="203810.5,-161.98 203581.5,-161.98 203581.5,-109.98 203810.5,-109.98 203810.5,-161.98"/>
<text text-anchor="middle" x="203696" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L10</text>
<text text-anchor="middle" x="203696" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="203696" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="203696" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert7_l10_dp1 -->
<g id="edge1124" class="edge">
<title>router_l10_dp1&#45;&gt;expert7_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.25,-171.66C201557.76,-173.75 201577.19,-175.57 201596,-176.98 202332.45,-232.14 202519.01,-194.09 203257.5,-198.98 203397.61,-199.91 203434.67,-204.83 203572,-176.98 203586.85,-173.97 203602.41,-169.73 203617.28,-165.12"/>
<polygon fill="black" stroke="black" points="203618.48,-168.41 203626.94,-162.04 203616.35,-161.74 203618.48,-168.41"/>
<text text-anchor="middle" x="203279" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l10_dp1 -->
<g id="node675" class="node">
<title>expert8_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="203563.5,-161.98 203334.5,-161.98 203334.5,-109.98 203563.5,-109.98 203563.5,-161.98"/>
<text text-anchor="middle" x="203449" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L10</text>
<text text-anchor="middle" x="203449" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="203449" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="203449" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert8_l10_dp1 -->
<g id="edge1125" class="edge">
<title>router_l10_dp1&#45;&gt;expert8_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201538.25,-171.59C201557.76,-173.7 201577.19,-175.55 201596,-176.98 201905.02,-200.6 202680.74,-209.16 202990.5,-198.98 203139.41,-194.09 203178.76,-205.49 203325,-176.98 203340.06,-174.05 203355.82,-169.8 203370.87,-165.14"/>
<polygon fill="black" stroke="black" points="203372.17,-168.39 203380.63,-162.02 203370.04,-161.72 203372.17,-168.39"/>
<text text-anchor="middle" x="202969" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l10_dp1 -->
<g id="node676" class="node">
<title>expert9_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="203316.5,-161.98 203087.5,-161.98 203087.5,-109.98 203316.5,-109.98 203316.5,-161.98"/>
<text text-anchor="middle" x="203202" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L10</text>
<text text-anchor="middle" x="203202" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="203202" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="203202" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert9_l10_dp1 -->
<g id="edge1126" class="edge">
<title>router_l10_dp1&#45;&gt;expert9_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201504.34,-177.01C201559.12,-186.11 201618.35,-194.4 201673.5,-198.98 201692.54,-200.57 201697.39,-199.14 201716.5,-198.98 202019.08,-196.54 202779.65,-227.5 203078,-176.98 203093.83,-174.3 203110.39,-169.97 203126.06,-165.1"/>
<polygon fill="black" stroke="black" points="203127.24,-168.4 203135.69,-162.01 203125.1,-161.73 203127.24,-168.4"/>
<text text-anchor="middle" x="201695" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l10_dp1 -->
<g id="node677" class="node">
<title>expert10_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="203069.5,-161.98 202840.5,-161.98 202840.5,-109.98 203069.5,-109.98 203069.5,-161.98"/>
<text text-anchor="middle" x="202955" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L10</text>
<text text-anchor="middle" x="202955" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="202955" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="202955" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert10_l10_dp1 -->
<g id="edge1127" class="edge">
<title>router_l10_dp1&#45;&gt;expert10_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201537.86,-171.42C201557.5,-173.57 201577.06,-175.48 201596,-176.98 201822.11,-194.97 202389.96,-210.57 202616.5,-198.98 202712.21,-194.09 202737.29,-197.03 202831,-176.98 202845.64,-173.85 202860.98,-169.61 202875.68,-165.03"/>
<polygon fill="black" stroke="black" points="202876.77,-168.36 202885.24,-161.99 202874.65,-161.69 202876.77,-168.36"/>
<text text-anchor="middle" x="202595" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l10_dp1 -->
<g id="node678" class="node">
<title>expert11_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="202822.5,-161.98 202593.5,-161.98 202593.5,-109.98 202822.5,-109.98 202822.5,-161.98"/>
<text text-anchor="middle" x="202708" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L10</text>
<text text-anchor="middle" x="202708" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="202708" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="202708" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert11_l10_dp1 -->
<g id="edge1128" class="edge">
<title>router_l10_dp1&#45;&gt;expert11_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201537.46,-171.21C201557.24,-173.42 201576.94,-175.39 201596,-176.98 201935.62,-205.35 202022.11,-215.85 202362.5,-198.98 202461.31,-194.09 202487.23,-197.52 202584,-176.98 202598.65,-173.87 202613.99,-169.64 202628.69,-165.07"/>
<polygon fill="black" stroke="black" points="202629.78,-168.4 202638.24,-162.03 202627.65,-161.73 202629.78,-168.4"/>
<text text-anchor="middle" x="202341" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l10_dp1 -->
<g id="node679" class="node">
<title>expert12_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="202575.5,-161.98 202346.5,-161.98 202346.5,-109.98 202575.5,-109.98 202575.5,-161.98"/>
<text text-anchor="middle" x="202461" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L10</text>
<text text-anchor="middle" x="202461" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="202461" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="202461" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert12_l10_dp1 -->
<g id="edge1129" class="edge">
<title>router_l10_dp1&#45;&gt;expert12_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201537.09,-170.8C201556.99,-173.11 201576.82,-175.22 201596,-176.98 201596,-176.98 202337,-176.98 202337,-176.98 202351.74,-173.89 202367.19,-169.65 202381.98,-165.05"/>
<polygon fill="black" stroke="black" points="202383.12,-168.36 202391.59,-161.99 202380.99,-161.69 202383.12,-168.36"/>
<text text-anchor="middle" x="202081" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l10_dp1 -->
<g id="node680" class="node">
<title>expert13_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="202328.5,-161.98 202099.5,-161.98 202099.5,-109.98 202328.5,-109.98 202328.5,-161.98"/>
<text text-anchor="middle" x="202214" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L10</text>
<text text-anchor="middle" x="202214" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="202214" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="202214" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert13_l10_dp1 -->
<g id="edge1130" class="edge">
<title>router_l10_dp1&#45;&gt;expert13_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201537.06,-177.01C201600.42,-186.11 201668.87,-194.4 201732.5,-198.98 201848.89,-207.36 201934.04,-207.72 202090,-176.98 202104.96,-174.03 202120.62,-169.8 202135.58,-165.17"/>
<polygon fill="black" stroke="black" points="202136.83,-168.45 202145.3,-162.08 202134.71,-161.78 202136.83,-168.45"/>
<text text-anchor="middle" x="201754" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l10_dp1 -->
<g id="node681" class="node">
<title>expert14_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="202081.5,-161.98 201852.5,-161.98 201852.5,-109.98 202081.5,-109.98 202081.5,-161.98"/>
<text text-anchor="middle" x="201967" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L10</text>
<text text-anchor="middle" x="201967" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="201967" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="201967" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert14_l10_dp1 -->
<g id="edge1131" class="edge">
<title>router_l10_dp1&#45;&gt;expert14_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201519.51,-176.99C201637.76,-195.86 201770.44,-211.57 201828.5,-198.98 201857.93,-192.6 201888.61,-179.41 201913.6,-166.74"/>
<polygon fill="black" stroke="black" points="201915.26,-169.82 201922.53,-162.11 201912.04,-163.61 201915.26,-169.82"/>
<text text-anchor="middle" x="201807" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l10_dp1 -->
<g id="node682" class="node">
<title>expert15_l10_dp1</title>
<polygon fill="lightgreen" stroke="black" points="201834.5,-161.98 201605.5,-161.98 201605.5,-109.98 201834.5,-109.98 201834.5,-161.98"/>
<text text-anchor="middle" x="201720" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L10</text>
<text text-anchor="middle" x="201720" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="201720" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="201720" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp1&#45;&gt;expert15_l10_dp1 -->
<g id="edge1132" class="edge">
<title>router_l10_dp1&#45;&gt;expert15_l10_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M201493.95,-135.98C201528.38,-135.98 201563.32,-135.98 201595.11,-135.98"/>
<polygon fill="black" stroke="black" points="201595.32,-139.48 201605.32,-135.98 201595.32,-132.48 201595.32,-139.48"/>
<text text-anchor="middle" x="201575.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l10_dp1 -->
<g id="node683" class="node">
<title>expert_agg_l10_dp1</title>
<polygon fill="lightyellow" stroke="black" points="206070.57,-176.98 205676.74,-176.98 205575.43,-94.98 205969.26,-94.98 206070.57,-176.98"/>
<text text-anchor="middle" x="205823" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L10</text>
<text text-anchor="middle" x="205823" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="205823" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1133" class="edge">
<title>expert0_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M205539.66,-135.98C205565.06,-135.98 205590.47,-135.98 205615.87,-135.98"/>
<polygon fill="black" stroke="black" points="205615.99,-139.48 205625.99,-135.98 205615.99,-132.48 205615.99,-139.48"/>
</g>
<!-- expert1_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1134" class="edge">
<title>expert1_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M205233.24,-162.02C205256.4,-171.57 205283.96,-181.22 205310,-185.98 205360.06,-195.15 205488.3,-190.41 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert2_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1135" class="edge">
<title>expert2_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M204986.24,-162.02C205009.4,-171.57 205036.96,-181.22 205063,-185.98 205115.02,-195.51 205486.31,-190.59 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert3_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1136" class="edge">
<title>expert3_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M204739.24,-162.02C204762.4,-171.57 204789.96,-181.22 204816,-185.98 204895.02,-200.45 205458.97,-192.97 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert4_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1137" class="edge">
<title>expert4_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M204492.24,-162.02C204515.4,-171.57 204542.96,-181.22 204569,-185.98 204622.01,-195.69 205485.31,-190.67 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert5_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1138" class="edge">
<title>expert5_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M204245.24,-162.02C204268.4,-171.57 204295.96,-181.22 204322,-185.98 204388.5,-198.16 205471.64,-191.87 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert6_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1139" class="edge">
<title>expert6_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M203998.24,-162.02C204021.4,-171.57 204048.96,-181.22 204075,-185.98 204155,-200.63 205457.97,-193.06 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert7_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1140" class="edge">
<title>expert7_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M203751.24,-162.02C203774.4,-171.57 203801.96,-181.22 203828,-185.98 203874.75,-194.54 205491.65,-190.12 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert8_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1141" class="edge">
<title>expert8_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M203504.24,-162.02C203527.4,-171.57 203554.96,-181.22 203581,-185.98 203634.5,-195.78 205484.82,-190.72 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert9_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1142" class="edge">
<title>expert9_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M203257.24,-162.02C203280.4,-171.57 203307.96,-181.22 203334,-185.98 203394.25,-197.01 205477.98,-191.31 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert10_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1143" class="edge">
<title>expert10_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M203010.24,-162.02C203033.4,-171.57 203060.96,-181.22 203087,-185.98 203154,-198.25 205471.15,-191.91 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert11_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1144" class="edge">
<title>expert11_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M202763.24,-162.02C202786.4,-171.57 202813.96,-181.22 202840,-185.98 202913.75,-199.48 205464.31,-192.51 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert12_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1145" class="edge">
<title>expert12_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M202516.24,-162.02C202539.4,-171.57 202566.96,-181.22 202593,-185.98 202673.49,-200.72 205457.48,-193.1 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert13_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1146" class="edge">
<title>expert13_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M202269.24,-162.02C202292.4,-171.57 202319.96,-181.22 202346,-185.98 202389.62,-193.97 205494.82,-189.84 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert14_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1147" class="edge">
<title>expert14_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M202022.24,-162.02C202045.4,-171.57 202072.96,-181.22 202099,-185.98 202146,-194.59 205491.4,-190.14 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- expert15_l10_dp1&#45;&gt;expert_agg_l10_dp1 -->
<g id="edge1148" class="edge">
<title>expert15_l10_dp1&#45;&gt;expert_agg_l10_dp1</title>
<path fill="none" stroke="black" d="M201775.24,-162.02C201798.4,-171.57 201825.96,-181.22 201852,-185.98 201902.37,-195.2 205487.98,-190.44 205539,-185.98 205577.11,-182.65 205617.78,-176.86 205656.08,-170.36"/>
<polygon fill="black" stroke="black" points="205657.02,-173.75 205666.29,-168.6 205655.84,-166.85 205657.02,-173.75"/>
</g>
<!-- layer10_output_dp1 -->
<g id="node684" class="node">
<title>layer10_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="206275" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="206275" y="-144.48" font-family="Arial" font-size="10.00">Layer 10 Output</text>
<text text-anchor="middle" x="206275" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="206275" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l10_dp1&#45;&gt;layer10_output_dp1 -->
<g id="edge1149" class="edge">
<title>expert_agg_l10_dp1&#45;&gt;layer10_output_dp1</title>
<path fill="none" stroke="black" d="M206020.31,-135.98C206045.49,-135.98 206070.66,-135.98 206095.84,-135.98"/>
<polygon fill="black" stroke="black" points="206095.87,-139.48 206105.87,-135.98 206095.87,-132.48 206095.87,-139.48"/>
</g>
<!-- attn_input_l11_dp1 -->
<g id="node685" class="node">
<title>attn_input_l11_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="206648" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="206648" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L11</text>
<text text-anchor="middle" x="206648" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="206648" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer10_output_dp1&#45;&gt;attn_input_l11_dp1 -->
<g id="edge1150" class="edge">
<title>layer10_output_dp1&#45;&gt;attn_input_l11_dp1</title>
<path fill="none" stroke="black" d="M206444.01,-135.98C206452.23,-135.98 206460.44,-135.98 206468.66,-135.98"/>
<polygon fill="black" stroke="black" points="206468.68,-139.48 206478.68,-135.98 206468.68,-132.48 206468.68,-139.48"/>
</g>
<!-- attn_tp0_l11_dp1 -->
<g id="node686" class="node">
<title>attn_tp0_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="207946,-161.98 207686,-161.98 207686,-109.98 207946,-109.98 207946,-161.98"/>
<text text-anchor="middle" x="207816" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L11</text>
<text text-anchor="middle" x="207816" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="207816" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="207816" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp1&#45;&gt;attn_tp0_l11_dp1 -->
<g id="edge1151" class="edge">
<title>attn_input_l11_dp1&#45;&gt;attn_tp0_l11_dp1</title>
<path fill="none" stroke="black" d="M206731.52,-161.26C206768.12,-171.09 206811.81,-181.13 206852,-185.98 206897,-191.42 207623.27,-193.33 207668,-185.98 207693.4,-181.81 207720.31,-173.85 207744.12,-165.5"/>
<polygon fill="black" stroke="black" points="207745.55,-168.71 207753.78,-162.03 207743.18,-162.12 207745.55,-168.71"/>
</g>
<!-- attn_tp1_l11_dp1 -->
<g id="node687" class="node">
<title>attn_tp1_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="207668,-161.98 207408,-161.98 207408,-109.98 207668,-109.98 207668,-161.98"/>
<text text-anchor="middle" x="207538" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L11</text>
<text text-anchor="middle" x="207538" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="207538" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="207538" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp1&#45;&gt;attn_tp1_l11_dp1 -->
<g id="edge1152" class="edge">
<title>attn_input_l11_dp1&#45;&gt;attn_tp1_l11_dp1</title>
<path fill="none" stroke="black" d="M206731.52,-161.26C206768.12,-171.09 206811.81,-181.13 206852,-185.98 206911.35,-193.15 207331.01,-195.68 207390,-185.98 207415.4,-181.81 207442.31,-173.85 207466.12,-165.5"/>
<polygon fill="black" stroke="black" points="207467.55,-168.71 207475.78,-162.03 207465.18,-162.12 207467.55,-168.71"/>
</g>
<!-- attn_tp2_l11_dp1 -->
<g id="node688" class="node">
<title>attn_tp2_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="207390,-161.98 207130,-161.98 207130,-109.98 207390,-109.98 207390,-161.98"/>
<text text-anchor="middle" x="207260" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L11</text>
<text text-anchor="middle" x="207260" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="207260" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="207260" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp1&#45;&gt;attn_tp2_l11_dp1 -->
<g id="edge1153" class="edge">
<title>attn_input_l11_dp1&#45;&gt;attn_tp2_l11_dp1</title>
<path fill="none" stroke="black" d="M206731.52,-161.26C206768.12,-171.09 206811.81,-181.13 206852,-185.98 206909.36,-192.91 207054.99,-195.35 207112,-185.98 207137.4,-181.81 207164.31,-173.85 207188.12,-165.5"/>
<polygon fill="black" stroke="black" points="207189.55,-168.71 207197.78,-162.03 207187.18,-162.12 207189.55,-168.71"/>
</g>
<!-- attn_tp3_l11_dp1 -->
<g id="node689" class="node">
<title>attn_tp3_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="207112,-161.98 206852,-161.98 206852,-109.98 207112,-109.98 207112,-161.98"/>
<text text-anchor="middle" x="206982" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L11</text>
<text text-anchor="middle" x="206982" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="206982" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="206982" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp1&#45;&gt;attn_tp3_l11_dp1 -->
<g id="edge1154" class="edge">
<title>attn_input_l11_dp1&#45;&gt;attn_tp3_l11_dp1</title>
<path fill="none" stroke="black" d="M206817.28,-135.98C206825.35,-135.98 206833.42,-135.98 206841.49,-135.98"/>
<polygon fill="black" stroke="black" points="206841.7,-139.48 206851.7,-135.98 206841.7,-132.48 206841.7,-139.48"/>
</g>
<!-- allreduce_l11_dp1 -->
<g id="node690" class="node">
<title>allreduce_l11_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="208150" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="208150" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L11</text>
<text text-anchor="middle" x="208150" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="208150" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l11_dp1&#45;&gt;allreduce_l11_dp1 -->
<g id="edge1155" class="edge">
<title>attn_tp0_l11_dp1&#45;&gt;allreduce_l11_dp1</title>
<path fill="none" stroke="black" d="M207946.14,-135.98C207954.35,-135.98 207962.56,-135.98 207970.77,-135.98"/>
<polygon fill="black" stroke="black" points="207970.78,-139.48 207980.78,-135.98 207970.78,-132.48 207970.78,-139.48"/>
</g>
<!-- attn_tp1_l11_dp1&#45;&gt;allreduce_l11_dp1 -->
<g id="edge1156" class="edge">
<title>attn_tp1_l11_dp1&#45;&gt;allreduce_l11_dp1</title>
<path fill="none" stroke="black" d="M207600.22,-162.03C207626.24,-171.59 207657.1,-181.23 207686,-185.98 207743.01,-195.35 207888.64,-192.91 207946,-185.98 207982.57,-181.57 208022.05,-172.85 208056.44,-163.91"/>
<polygon fill="black" stroke="black" points="208057.7,-167.2 208066.47,-161.26 208055.91,-160.43 208057.7,-167.2"/>
</g>
<!-- attn_tp2_l11_dp1&#45;&gt;allreduce_l11_dp1 -->
<g id="edge1157" class="edge">
<title>attn_tp2_l11_dp1&#45;&gt;allreduce_l11_dp1</title>
<path fill="none" stroke="black" d="M207322.22,-162.03C207348.24,-171.59 207379.1,-181.23 207408,-185.98 207466.98,-195.68 207886.65,-193.15 207946,-185.98 207982.57,-181.57 208022.05,-172.85 208056.44,-163.91"/>
<polygon fill="black" stroke="black" points="208057.7,-167.2 208066.47,-161.26 208055.91,-160.43 208057.7,-167.2"/>
</g>
<!-- attn_tp3_l11_dp1&#45;&gt;allreduce_l11_dp1 -->
<g id="edge1158" class="edge">
<title>attn_tp3_l11_dp1&#45;&gt;allreduce_l11_dp1</title>
<path fill="none" stroke="black" d="M207044.22,-162.03C207070.24,-171.59 207101.1,-181.23 207130,-185.98 207174.73,-193.33 207900.99,-191.42 207946,-185.98 207982.57,-181.57 208022.05,-172.85 208056.44,-163.91"/>
<polygon fill="black" stroke="black" points="208057.7,-167.2 208066.47,-161.26 208055.91,-160.43 208057.7,-167.2"/>
</g>
<!-- moe_input_l11_dp1 -->
<g id="node691" class="node">
<title>moe_input_l11_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="208523" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="208523" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L11</text>
<text text-anchor="middle" x="208523" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="208523" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l11_dp1&#45;&gt;moe_input_l11_dp1 -->
<g id="edge1159" class="edge">
<title>allreduce_l11_dp1&#45;&gt;moe_input_l11_dp1</title>
<path fill="none" stroke="black" d="M208319.01,-135.98C208327.23,-135.98 208335.44,-135.98 208343.66,-135.98"/>
<polygon fill="black" stroke="black" points="208343.68,-139.48 208353.68,-135.98 208343.68,-132.48 208343.68,-139.48"/>
</g>
<!-- router_l11_dp1 -->
<g id="node692" class="node">
<title>router_l11_dp1</title>
<polygon fill="lightyellow" stroke="black" points="209222.57,-176.98 208828.74,-176.98 208727.43,-94.98 209121.26,-94.98 209222.57,-176.98"/>
<text text-anchor="middle" x="208975" y="-144.48" font-family="Arial" font-size="10.00">Router L11</text>
<text text-anchor="middle" x="208975" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="208975" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l11_dp1&#45;&gt;router_l11_dp1 -->
<g id="edge1160" class="edge">
<title>moe_input_l11_dp1&#45;&gt;router_l11_dp1</title>
<path fill="none" stroke="black" d="M208692.06,-135.98C208717.34,-135.98 208742.63,-135.98 208767.92,-135.98"/>
<polygon fill="black" stroke="black" points="208767.99,-139.48 208777.99,-135.98 208767.99,-132.48 208767.99,-139.48"/>
</g>
<!-- expert0_l11_dp1 -->
<g id="node693" class="node">
<title>expert0_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="213217.5,-161.98 212988.5,-161.98 212988.5,-109.98 213217.5,-109.98 213217.5,-161.98"/>
<text text-anchor="middle" x="213103" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L11</text>
<text text-anchor="middle" x="213103" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="213103" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="213103" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert0_l11_dp1 -->
<g id="edge1161" class="edge">
<title>router_l11_dp1&#45;&gt;expert0_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.24,-171.8C209235.75,-173.86 209255.18,-175.64 209274,-176.98 210035.74,-231.42 211946.82,-196.54 212710.5,-198.98 212830.23,-199.37 212861.85,-201.74 212979,-176.98 212993.65,-173.89 213008.99,-169.66 213023.69,-165.09"/>
<polygon fill="black" stroke="black" points="213024.78,-168.42 213033.25,-162.05 213022.66,-161.75 213024.78,-168.42"/>
<text text-anchor="middle" x="212732" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l11_dp1 -->
<g id="node694" class="node">
<title>expert1_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="212970.5,-161.98 212741.5,-161.98 212741.5,-109.98 212970.5,-109.98 212970.5,-161.98"/>
<text text-anchor="middle" x="212856" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L11</text>
<text text-anchor="middle" x="212856" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="212856" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="212856" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert1_l11_dp1 -->
<g id="edge1162" class="edge">
<title>router_l11_dp1&#45;&gt;expert1_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.24,-171.79C209235.75,-173.85 209255.18,-175.63 209274,-176.98 209976.99,-227.41 211740.71,-196.54 212445.5,-198.98 212573.21,-199.43 212606.96,-202.94 212732,-176.98 212746.75,-173.92 212762.2,-169.69 212776.99,-165.09"/>
<polygon fill="black" stroke="black" points="212778.13,-168.4 212786.59,-162.03 212776,-161.73 212778.13,-168.4"/>
<text text-anchor="middle" x="212467" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l11_dp1 -->
<g id="node695" class="node">
<title>expert2_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="212723.5,-161.98 212494.5,-161.98 212494.5,-109.98 212723.5,-109.98 212723.5,-161.98"/>
<text text-anchor="middle" x="212609" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L11</text>
<text text-anchor="middle" x="212609" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="212609" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="212609" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert2_l11_dp1 -->
<g id="edge1163" class="edge">
<title>router_l11_dp1&#45;&gt;expert2_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.24,-171.77C209235.75,-173.84 209255.18,-175.63 209274,-176.98 209914.47,-223.14 211521.37,-196.54 212163.5,-198.98 212306.72,-199.53 212344.6,-205.31 212485,-176.98 212499.86,-173.98 212515.41,-169.76 212530.29,-165.14"/>
<polygon fill="black" stroke="black" points="212531.48,-168.44 212539.95,-162.07 212529.36,-161.77 212531.48,-168.44"/>
<text text-anchor="middle" x="212185" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l11_dp1 -->
<g id="node696" class="node">
<title>expert3_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="212476.5,-161.98 212247.5,-161.98 212247.5,-109.98 212476.5,-109.98 212476.5,-161.98"/>
<text text-anchor="middle" x="212362" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L11</text>
<text text-anchor="middle" x="212362" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="212362" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="212362" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert3_l11_dp1 -->
<g id="edge1164" class="edge">
<title>router_l11_dp1&#45;&gt;expert3_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.24,-171.75C209235.75,-173.83 209255.19,-175.62 209274,-176.98 209844.19,-218.34 211274.82,-196.54 211846.5,-198.98 212020.77,-199.73 212066.9,-210.1 212238,-176.98 212253.06,-174.07 212268.83,-169.83 212283.87,-165.17"/>
<polygon fill="black" stroke="black" points="212285.17,-168.43 212293.64,-162.05 212283.05,-161.76 212285.17,-168.43"/>
<text text-anchor="middle" x="211868" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l11_dp1 -->
<g id="node697" class="node">
<title>expert4_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="212229.5,-161.98 212000.5,-161.98 212000.5,-109.98 212229.5,-109.98 212229.5,-161.98"/>
<text text-anchor="middle" x="212115" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L11</text>
<text text-anchor="middle" x="212115" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="212115" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="212115" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert4_l11_dp1 -->
<g id="edge1165" class="edge">
<title>router_l11_dp1&#45;&gt;expert4_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209144.03,-177C209188.77,-186.09 209237.23,-194.39 209282.5,-198.98 209301.51,-200.91 209306.39,-199.06 209325.5,-198.98 209621.67,-197.76 211698.79,-225.28 211991,-176.98 212006.93,-174.35 212023.59,-170.01 212039.35,-165.11"/>
<polygon fill="black" stroke="black" points="212040.58,-168.39 212049.03,-162 212038.44,-161.73 212040.58,-168.39"/>
<text text-anchor="middle" x="209304" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l11_dp1 -->
<g id="node698" class="node">
<title>expert5_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="211982.5,-161.98 211753.5,-161.98 211753.5,-109.98 211982.5,-109.98 211982.5,-161.98"/>
<text text-anchor="middle" x="211868" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L11</text>
<text text-anchor="middle" x="211868" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="211868" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="211868" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert5_l11_dp1 -->
<g id="edge1166" class="edge">
<title>router_l11_dp1&#45;&gt;expert5_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.24,-171.72C209235.75,-173.8 209255.19,-175.6 209274,-176.98 209758.39,-212.49 210973.81,-196.54 211459.5,-198.98 211586.32,-199.62 211619.83,-202.81 211744,-176.98 211758.75,-173.91 211774.2,-169.68 211788.98,-165.08"/>
<polygon fill="black" stroke="black" points="211790.13,-168.39 211798.59,-162.02 211788,-161.72 211790.13,-168.39"/>
<text text-anchor="middle" x="211481" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l11_dp1 -->
<g id="node699" class="node">
<title>expert6_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="211735.5,-161.98 211506.5,-161.98 211506.5,-109.98 211735.5,-109.98 211735.5,-161.98"/>
<text text-anchor="middle" x="211621" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L11</text>
<text text-anchor="middle" x="211621" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="211621" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="211621" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert6_l11_dp1 -->
<g id="edge1167" class="edge">
<title>router_l11_dp1&#45;&gt;expert6_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.25,-171.69C209235.75,-173.78 209255.19,-175.59 209274,-176.98 209696.32,-208.25 210756.03,-196.54 211179.5,-198.98 211320.95,-199.8 211358.36,-205.04 211497,-176.98 211511.86,-173.98 211527.41,-169.74 211542.28,-165.13"/>
<polygon fill="black" stroke="black" points="211543.48,-168.42 211551.95,-162.05 211541.36,-161.75 211543.48,-168.42"/>
<text text-anchor="middle" x="211201" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l11_dp1 -->
<g id="node700" class="node">
<title>expert7_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="211488.5,-161.98 211259.5,-161.98 211259.5,-109.98 211488.5,-109.98 211488.5,-161.98"/>
<text text-anchor="middle" x="211374" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L11</text>
<text text-anchor="middle" x="211374" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="211374" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="211374" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert7_l11_dp1 -->
<g id="edge1168" class="edge">
<title>router_l11_dp1&#45;&gt;expert7_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209216.25,-171.65C209235.76,-173.74 209255.19,-175.57 209274,-176.98 209979.85,-230.05 210158.67,-194.09 210866.5,-198.98 211037.22,-200.16 211082.41,-209.55 211250,-176.98 211265.06,-174.06 211280.83,-169.81 211295.87,-165.15"/>
<polygon fill="black" stroke="black" points="211297.17,-168.41 211305.64,-162.04 211295.04,-161.74 211297.17,-168.41"/>
<text text-anchor="middle" x="210888" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l11_dp1 -->
<g id="node701" class="node">
<title>expert8_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="211241.5,-161.98 211012.5,-161.98 211012.5,-109.98 211241.5,-109.98 211241.5,-161.98"/>
<text text-anchor="middle" x="211127" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L11</text>
<text text-anchor="middle" x="211127" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="211127" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="211127" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert8_l11_dp1 -->
<g id="edge1169" class="edge">
<title>router_l11_dp1&#45;&gt;expert8_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209182.34,-177.01C209237.12,-186.11 209296.35,-194.4 209351.5,-198.98 209370.54,-200.57 209375.39,-199.11 209394.5,-198.98 209751.97,-196.54 210650.46,-236.23 211003,-176.98 211018.83,-174.32 211035.39,-170 211051.07,-165.13"/>
<polygon fill="black" stroke="black" points="211052.24,-168.43 211060.7,-162.04 211050.1,-161.76 211052.24,-168.43"/>
<text text-anchor="middle" x="209373" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l11_dp1 -->
<g id="node702" class="node">
<title>expert9_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="210994.5,-161.98 210765.5,-161.98 210765.5,-109.98 210994.5,-109.98 210994.5,-161.98"/>
<text text-anchor="middle" x="210880" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L11</text>
<text text-anchor="middle" x="210880" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="210880" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="210880" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert9_l11_dp1 -->
<g id="edge1170" class="edge">
<title>router_l11_dp1&#45;&gt;expert9_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209215.85,-171.51C209235.49,-173.65 209255.06,-175.52 209274,-176.98 209811.37,-218.55 209947.54,-194.09 210486.5,-198.98 210606.67,-200.07 210638.41,-201.81 210756,-176.98 210770.65,-173.89 210785.99,-169.66 210800.69,-165.1"/>
<polygon fill="black" stroke="black" points="210801.78,-168.42 210810.25,-162.05 210799.66,-161.75 210801.78,-168.42"/>
<text text-anchor="middle" x="210508" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l11_dp1 -->
<g id="node703" class="node">
<title>expert10_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="210747.5,-161.98 210518.5,-161.98 210518.5,-109.98 210747.5,-109.98 210747.5,-161.98"/>
<text text-anchor="middle" x="210633" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L11</text>
<text text-anchor="middle" x="210633" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="210633" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="210633" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert10_l11_dp1 -->
<g id="edge1171" class="edge">
<title>router_l11_dp1&#45;&gt;expert10_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209215.86,-171.4C209235.5,-173.56 209255.07,-175.47 209274,-176.98 209712.49,-212.03 209824.05,-218.63 210263.5,-198.98 210372.94,-194.09 210401.73,-199.21 210509,-176.98 210523.75,-173.93 210539.2,-169.69 210553.99,-165.1"/>
<polygon fill="black" stroke="black" points="210555.13,-168.41 210563.6,-162.04 210553.01,-161.74 210555.13,-168.41"/>
<text text-anchor="middle" x="210242" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l11_dp1 -->
<g id="node704" class="node">
<title>expert11_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="210500.5,-161.98 210271.5,-161.98 210271.5,-109.98 210500.5,-109.98 210500.5,-161.98"/>
<text text-anchor="middle" x="210386" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L11</text>
<text text-anchor="middle" x="210386" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="210386" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="210386" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert11_l11_dp1 -->
<g id="edge1172" class="edge">
<title>router_l11_dp1&#45;&gt;expert11_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209215.47,-171.15C209235.24,-173.37 209254.94,-175.36 209274,-176.98 209586.14,-203.5 209665.47,-211.11 209978.5,-198.98 210104.78,-194.09 210138.1,-201.89 210262,-176.98 210276.86,-174 210292.42,-169.77 210307.29,-165.16"/>
<polygon fill="black" stroke="black" points="210308.49,-168.45 210316.95,-162.09 210306.36,-161.78 210308.49,-168.45"/>
<text text-anchor="middle" x="209957" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l11_dp1 -->
<g id="node705" class="node">
<title>expert12_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="210253.5,-161.98 210024.5,-161.98 210024.5,-109.98 210253.5,-109.98 210253.5,-161.98"/>
<text text-anchor="middle" x="210139" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L11</text>
<text text-anchor="middle" x="210139" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="210139" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="210139" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert12_l11_dp1 -->
<g id="edge1173" class="edge">
<title>router_l11_dp1&#45;&gt;expert12_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209215.06,-177.01C209278.42,-186.11 209346.87,-194.4 209410.5,-198.98 209544.57,-208.63 209882.73,-200.95 210015,-176.98 210030.37,-174.2 210046.45,-169.94 210061.75,-165.21"/>
<polygon fill="black" stroke="black" points="210063.21,-168.41 210071.67,-162.04 210061.08,-161.75 210063.21,-168.41"/>
<text text-anchor="middle" x="209432" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l11_dp1 -->
<g id="node706" class="node">
<title>expert13_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="210006.5,-161.98 209777.5,-161.98 209777.5,-109.98 210006.5,-109.98 210006.5,-161.98"/>
<text text-anchor="middle" x="209892" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L11</text>
<text text-anchor="middle" x="209892" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="209892" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="209892" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert13_l11_dp1 -->
<g id="edge1174" class="edge">
<title>router_l11_dp1&#45;&gt;expert13_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209191.82,-177.03C209325.76,-197.17 209501.14,-214.16 209656.5,-198.98 209708.5,-193.9 209765.1,-179.07 209809.79,-165.08"/>
<polygon fill="black" stroke="black" points="209810.95,-168.38 209819.42,-162.01 209808.83,-161.71 209810.95,-168.38"/>
<text text-anchor="middle" x="209635" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l11_dp1 -->
<g id="node707" class="node">
<title>expert14_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="209759.5,-161.98 209530.5,-161.98 209530.5,-109.98 209759.5,-109.98 209759.5,-161.98"/>
<text text-anchor="middle" x="209645" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L11</text>
<text text-anchor="middle" x="209645" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="209645" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="209645" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert14_l11_dp1 -->
<g id="edge1175" class="edge">
<title>router_l11_dp1&#45;&gt;expert14_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209197.51,-176.99C209315.76,-195.86 209448.44,-211.57 209506.5,-198.98 209535.93,-192.6 209566.61,-179.41 209591.6,-166.74"/>
<polygon fill="black" stroke="black" points="209593.26,-169.82 209600.53,-162.11 209590.04,-163.61 209593.26,-169.82"/>
<text text-anchor="middle" x="209485" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l11_dp1 -->
<g id="node708" class="node">
<title>expert15_l11_dp1</title>
<polygon fill="lightgreen" stroke="black" points="209512.5,-161.98 209283.5,-161.98 209283.5,-109.98 209512.5,-109.98 209512.5,-161.98"/>
<text text-anchor="middle" x="209398" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L11</text>
<text text-anchor="middle" x="209398" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="209398" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="209398" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp1&#45;&gt;expert15_l11_dp1 -->
<g id="edge1176" class="edge">
<title>router_l11_dp1&#45;&gt;expert15_l11_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M209171.95,-135.98C209206.38,-135.98 209241.32,-135.98 209273.11,-135.98"/>
<polygon fill="black" stroke="black" points="209273.32,-139.48 209283.32,-135.98 209273.32,-132.48 209273.32,-139.48"/>
<text text-anchor="middle" x="209253.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l11_dp1 -->
<g id="node709" class="node">
<title>expert_agg_l11_dp1</title>
<polygon fill="lightyellow" stroke="black" points="213748.57,-176.98 213354.74,-176.98 213253.43,-94.98 213647.26,-94.98 213748.57,-176.98"/>
<text text-anchor="middle" x="213501" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L11</text>
<text text-anchor="middle" x="213501" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="213501" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1177" class="edge">
<title>expert0_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M213217.66,-135.98C213243.06,-135.98 213268.47,-135.98 213293.87,-135.98"/>
<polygon fill="black" stroke="black" points="213293.99,-139.48 213303.99,-135.98 213293.99,-132.48 213293.99,-139.48"/>
</g>
<!-- expert1_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1178" class="edge">
<title>expert1_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M212911.24,-162.02C212934.4,-171.57 212961.96,-181.22 212988,-185.98 213038.06,-195.15 213166.3,-190.41 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert2_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1179" class="edge">
<title>expert2_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M212664.24,-162.02C212687.4,-171.57 212714.96,-181.22 212741,-185.98 212793.02,-195.51 213164.31,-190.59 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert3_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1180" class="edge">
<title>expert3_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M212417.24,-162.02C212440.4,-171.57 212467.96,-181.22 212494,-185.98 212573.02,-200.45 213136.97,-192.97 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert4_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1181" class="edge">
<title>expert4_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M212170.24,-162.02C212193.4,-171.57 212220.96,-181.22 212247,-185.98 212300.01,-195.69 213163.31,-190.67 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert5_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1182" class="edge">
<title>expert5_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M211923.24,-162.02C211946.4,-171.57 211973.96,-181.22 212000,-185.98 212066.5,-198.16 213149.64,-191.87 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert6_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1183" class="edge">
<title>expert6_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M211676.24,-162.02C211699.4,-171.57 211726.96,-181.22 211753,-185.98 211833,-200.63 213135.97,-193.06 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert7_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1184" class="edge">
<title>expert7_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M211429.24,-162.02C211452.4,-171.57 211479.96,-181.22 211506,-185.98 211552.75,-194.54 213169.65,-190.12 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert8_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1185" class="edge">
<title>expert8_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M211182.24,-162.02C211205.4,-171.57 211232.96,-181.22 211259,-185.98 211312.5,-195.78 213162.82,-190.72 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert9_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1186" class="edge">
<title>expert9_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M210935.24,-162.02C210958.4,-171.57 210985.96,-181.22 211012,-185.98 211072.25,-197.01 213155.98,-191.31 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert10_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1187" class="edge">
<title>expert10_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M210688.24,-162.02C210711.4,-171.57 210738.96,-181.22 210765,-185.98 210832,-198.25 213149.15,-191.91 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert11_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1188" class="edge">
<title>expert11_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M210441.24,-162.02C210464.4,-171.57 210491.96,-181.22 210518,-185.98 210591.75,-199.48 213142.31,-192.51 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert12_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1189" class="edge">
<title>expert12_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M210194.24,-162.02C210217.4,-171.57 210244.96,-181.22 210271,-185.98 210351.49,-200.72 213135.48,-193.1 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert13_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1190" class="edge">
<title>expert13_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M209947.24,-162.02C209970.4,-171.57 209997.96,-181.22 210024,-185.98 210067.62,-193.97 213172.82,-189.84 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert14_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1191" class="edge">
<title>expert14_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M209700.24,-162.02C209723.4,-171.57 209750.96,-181.22 209777,-185.98 209824,-194.59 213169.4,-190.14 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- expert15_l11_dp1&#45;&gt;expert_agg_l11_dp1 -->
<g id="edge1192" class="edge">
<title>expert15_l11_dp1&#45;&gt;expert_agg_l11_dp1</title>
<path fill="none" stroke="black" d="M209453.24,-162.02C209476.4,-171.57 209503.96,-181.22 209530,-185.98 209580.37,-195.2 213165.98,-190.44 213217,-185.98 213255.11,-182.65 213295.78,-176.86 213334.08,-170.36"/>
<polygon fill="black" stroke="black" points="213335.02,-173.75 213344.29,-168.6 213333.84,-166.85 213335.02,-173.75"/>
</g>
<!-- layer11_output_dp1 -->
<g id="node710" class="node">
<title>layer11_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="213953" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="213953" y="-144.48" font-family="Arial" font-size="10.00">Layer 11 Output</text>
<text text-anchor="middle" x="213953" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="213953" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l11_dp1&#45;&gt;layer11_output_dp1 -->
<g id="edge1193" class="edge">
<title>expert_agg_l11_dp1&#45;&gt;layer11_output_dp1</title>
<path fill="none" stroke="black" d="M213698.31,-135.98C213723.49,-135.98 213748.66,-135.98 213773.84,-135.98"/>
<polygon fill="black" stroke="black" points="213773.87,-139.48 213783.87,-135.98 213773.87,-132.48 213773.87,-139.48"/>
</g>
<!-- attn_input_l12_dp1 -->
<g id="node711" class="node">
<title>attn_input_l12_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="214326" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="214326" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L12</text>
<text text-anchor="middle" x="214326" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="214326" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer11_output_dp1&#45;&gt;attn_input_l12_dp1 -->
<g id="edge1194" class="edge">
<title>layer11_output_dp1&#45;&gt;attn_input_l12_dp1</title>
<path fill="none" stroke="black" d="M214122.01,-135.98C214130.23,-135.98 214138.44,-135.98 214146.66,-135.98"/>
<polygon fill="black" stroke="black" points="214146.68,-139.48 214156.68,-135.98 214146.68,-132.48 214146.68,-139.48"/>
</g>
<!-- attn_tp0_l12_dp1 -->
<g id="node712" class="node">
<title>attn_tp0_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="215624,-161.98 215364,-161.98 215364,-109.98 215624,-109.98 215624,-161.98"/>
<text text-anchor="middle" x="215494" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L12</text>
<text text-anchor="middle" x="215494" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="215494" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="215494" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp1&#45;&gt;attn_tp0_l12_dp1 -->
<g id="edge1195" class="edge">
<title>attn_input_l12_dp1&#45;&gt;attn_tp0_l12_dp1</title>
<path fill="none" stroke="black" d="M214409.52,-161.26C214446.12,-171.09 214489.81,-181.13 214530,-185.98 214575,-191.42 215301.27,-193.33 215346,-185.98 215371.4,-181.81 215398.31,-173.85 215422.12,-165.5"/>
<polygon fill="black" stroke="black" points="215423.55,-168.71 215431.78,-162.03 215421.18,-162.12 215423.55,-168.71"/>
</g>
<!-- attn_tp1_l12_dp1 -->
<g id="node713" class="node">
<title>attn_tp1_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="215346,-161.98 215086,-161.98 215086,-109.98 215346,-109.98 215346,-161.98"/>
<text text-anchor="middle" x="215216" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L12</text>
<text text-anchor="middle" x="215216" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="215216" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="215216" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp1&#45;&gt;attn_tp1_l12_dp1 -->
<g id="edge1196" class="edge">
<title>attn_input_l12_dp1&#45;&gt;attn_tp1_l12_dp1</title>
<path fill="none" stroke="black" d="M214409.52,-161.26C214446.12,-171.09 214489.81,-181.13 214530,-185.98 214589.35,-193.15 215009.01,-195.68 215068,-185.98 215093.4,-181.81 215120.31,-173.85 215144.12,-165.5"/>
<polygon fill="black" stroke="black" points="215145.55,-168.71 215153.78,-162.03 215143.18,-162.12 215145.55,-168.71"/>
</g>
<!-- attn_tp2_l12_dp1 -->
<g id="node714" class="node">
<title>attn_tp2_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="215068,-161.98 214808,-161.98 214808,-109.98 215068,-109.98 215068,-161.98"/>
<text text-anchor="middle" x="214938" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L12</text>
<text text-anchor="middle" x="214938" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="214938" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="214938" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp1&#45;&gt;attn_tp2_l12_dp1 -->
<g id="edge1197" class="edge">
<title>attn_input_l12_dp1&#45;&gt;attn_tp2_l12_dp1</title>
<path fill="none" stroke="black" d="M214409.52,-161.26C214446.12,-171.09 214489.81,-181.13 214530,-185.98 214587.36,-192.91 214732.99,-195.35 214790,-185.98 214815.4,-181.81 214842.31,-173.85 214866.12,-165.5"/>
<polygon fill="black" stroke="black" points="214867.55,-168.71 214875.78,-162.03 214865.18,-162.12 214867.55,-168.71"/>
</g>
<!-- attn_tp3_l12_dp1 -->
<g id="node715" class="node">
<title>attn_tp3_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="214790,-161.98 214530,-161.98 214530,-109.98 214790,-109.98 214790,-161.98"/>
<text text-anchor="middle" x="214660" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L12</text>
<text text-anchor="middle" x="214660" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="214660" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="214660" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp1&#45;&gt;attn_tp3_l12_dp1 -->
<g id="edge1198" class="edge">
<title>attn_input_l12_dp1&#45;&gt;attn_tp3_l12_dp1</title>
<path fill="none" stroke="black" d="M214495.28,-135.98C214503.35,-135.98 214511.42,-135.98 214519.49,-135.98"/>
<polygon fill="black" stroke="black" points="214519.7,-139.48 214529.7,-135.98 214519.7,-132.48 214519.7,-139.48"/>
</g>
<!-- allreduce_l12_dp1 -->
<g id="node716" class="node">
<title>allreduce_l12_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="215828" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="215828" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L12</text>
<text text-anchor="middle" x="215828" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="215828" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l12_dp1&#45;&gt;allreduce_l12_dp1 -->
<g id="edge1199" class="edge">
<title>attn_tp0_l12_dp1&#45;&gt;allreduce_l12_dp1</title>
<path fill="none" stroke="black" d="M215624.14,-135.98C215632.35,-135.98 215640.56,-135.98 215648.77,-135.98"/>
<polygon fill="black" stroke="black" points="215648.78,-139.48 215658.78,-135.98 215648.78,-132.48 215648.78,-139.48"/>
</g>
<!-- attn_tp1_l12_dp1&#45;&gt;allreduce_l12_dp1 -->
<g id="edge1200" class="edge">
<title>attn_tp1_l12_dp1&#45;&gt;allreduce_l12_dp1</title>
<path fill="none" stroke="black" d="M215278.22,-162.03C215304.24,-171.59 215335.1,-181.23 215364,-185.98 215421.01,-195.35 215566.64,-192.91 215624,-185.98 215660.57,-181.57 215700.05,-172.85 215734.44,-163.91"/>
<polygon fill="black" stroke="black" points="215735.7,-167.2 215744.47,-161.26 215733.91,-160.43 215735.7,-167.2"/>
</g>
<!-- attn_tp2_l12_dp1&#45;&gt;allreduce_l12_dp1 -->
<g id="edge1201" class="edge">
<title>attn_tp2_l12_dp1&#45;&gt;allreduce_l12_dp1</title>
<path fill="none" stroke="black" d="M215000.22,-162.03C215026.24,-171.59 215057.1,-181.23 215086,-185.98 215144.98,-195.68 215564.65,-193.15 215624,-185.98 215660.57,-181.57 215700.05,-172.85 215734.44,-163.91"/>
<polygon fill="black" stroke="black" points="215735.7,-167.2 215744.47,-161.26 215733.91,-160.43 215735.7,-167.2"/>
</g>
<!-- attn_tp3_l12_dp1&#45;&gt;allreduce_l12_dp1 -->
<g id="edge1202" class="edge">
<title>attn_tp3_l12_dp1&#45;&gt;allreduce_l12_dp1</title>
<path fill="none" stroke="black" d="M214722.22,-162.03C214748.24,-171.59 214779.1,-181.23 214808,-185.98 214852.73,-193.33 215578.99,-191.42 215624,-185.98 215660.57,-181.57 215700.05,-172.85 215734.44,-163.91"/>
<polygon fill="black" stroke="black" points="215735.7,-167.2 215744.47,-161.26 215733.91,-160.43 215735.7,-167.2"/>
</g>
<!-- moe_input_l12_dp1 -->
<g id="node717" class="node">
<title>moe_input_l12_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="216201" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="216201" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L12</text>
<text text-anchor="middle" x="216201" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="216201" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l12_dp1&#45;&gt;moe_input_l12_dp1 -->
<g id="edge1203" class="edge">
<title>allreduce_l12_dp1&#45;&gt;moe_input_l12_dp1</title>
<path fill="none" stroke="black" d="M215997.01,-135.98C216005.23,-135.98 216013.44,-135.98 216021.66,-135.98"/>
<polygon fill="black" stroke="black" points="216021.68,-139.48 216031.68,-135.98 216021.68,-132.48 216021.68,-139.48"/>
</g>
<!-- router_l12_dp1 -->
<g id="node718" class="node">
<title>router_l12_dp1</title>
<polygon fill="lightyellow" stroke="black" points="216900.57,-176.98 216506.74,-176.98 216405.43,-94.98 216799.26,-94.98 216900.57,-176.98"/>
<text text-anchor="middle" x="216653" y="-144.48" font-family="Arial" font-size="10.00">Router L12</text>
<text text-anchor="middle" x="216653" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="216653" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l12_dp1&#45;&gt;router_l12_dp1 -->
<g id="edge1204" class="edge">
<title>moe_input_l12_dp1&#45;&gt;router_l12_dp1</title>
<path fill="none" stroke="black" d="M216370.06,-135.98C216395.34,-135.98 216420.63,-135.98 216445.92,-135.98"/>
<polygon fill="black" stroke="black" points="216445.99,-139.48 216455.99,-135.98 216445.99,-132.48 216445.99,-139.48"/>
</g>
<!-- expert0_l12_dp1 -->
<g id="node719" class="node">
<title>expert0_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="220895.5,-161.98 220666.5,-161.98 220666.5,-109.98 220895.5,-109.98 220895.5,-161.98"/>
<text text-anchor="middle" x="220781" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L12</text>
<text text-anchor="middle" x="220781" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="220781" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="220781" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert0_l12_dp1 -->
<g id="edge1205" class="edge">
<title>router_l12_dp1&#45;&gt;expert0_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.24,-171.8C216913.75,-173.86 216933.18,-175.64 216952,-176.98 217709.75,-231.14 219610.82,-196.54 220370.5,-198.98 220498.21,-199.39 220531.96,-202.94 220657,-176.98 220671.75,-173.92 220687.2,-169.69 220701.99,-165.09"/>
<polygon fill="black" stroke="black" points="220703.13,-168.4 220711.59,-162.03 220701,-161.73 220703.13,-168.4"/>
<text text-anchor="middle" x="220392" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l12_dp1 -->
<g id="node720" class="node">
<title>expert1_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="220648.5,-161.98 220419.5,-161.98 220419.5,-109.98 220648.5,-109.98 220648.5,-161.98"/>
<text text-anchor="middle" x="220534" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L12</text>
<text text-anchor="middle" x="220534" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="220534" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="220534" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert1_l12_dp1 -->
<g id="edge1206" class="edge">
<title>router_l12_dp1&#45;&gt;expert1_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.24,-171.79C216913.75,-173.85 216933.18,-175.63 216952,-176.98 217647.01,-226.86 219390.71,-196.54 220087.5,-198.98 220231.16,-199.49 220269.17,-205.38 220410,-176.98 220424.86,-173.99 220440.41,-169.76 220455.29,-165.15"/>
<polygon fill="black" stroke="black" points="220456.48,-168.44 220464.95,-162.07 220454.36,-161.77 220456.48,-168.44"/>
<text text-anchor="middle" x="220109" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l12_dp1 -->
<g id="node721" class="node">
<title>expert2_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="220401.5,-161.98 220172.5,-161.98 220172.5,-109.98 220401.5,-109.98 220401.5,-161.98"/>
<text text-anchor="middle" x="220287" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L12</text>
<text text-anchor="middle" x="220287" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="220287" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="220287" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert2_l12_dp1 -->
<g id="edge1207" class="edge">
<title>router_l12_dp1&#45;&gt;expert2_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.24,-171.77C216913.75,-173.84 216933.19,-175.63 216952,-176.98 217576.28,-222.04 219142.6,-196.54 219768.5,-198.98 219944.1,-199.67 219990.58,-210.31 220163,-176.98 220178.06,-174.07 220193.83,-169.83 220208.87,-165.17"/>
<polygon fill="black" stroke="black" points="220210.18,-168.43 220218.64,-162.06 220208.05,-161.76 220210.18,-168.43"/>
<text text-anchor="middle" x="219790" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l12_dp1 -->
<g id="node722" class="node">
<title>expert3_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="220154.5,-161.98 219925.5,-161.98 219925.5,-109.98 220154.5,-109.98 220154.5,-161.98"/>
<text text-anchor="middle" x="220040" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L12</text>
<text text-anchor="middle" x="220040" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="220040" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="220040" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert3_l12_dp1 -->
<g id="edge1208" class="edge">
<title>router_l12_dp1&#45;&gt;expert3_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216808.69,-176.99C216849.94,-186.09 216894.65,-194.39 216936.5,-198.98 216955.5,-201.07 216960.39,-199.05 216979.5,-198.98 217305.78,-197.76 219594.06,-230.06 219916,-176.98 219931.93,-174.36 219948.6,-170.02 219964.35,-165.12"/>
<polygon fill="black" stroke="black" points="219965.58,-168.4 219974.03,-162.01 219963.44,-161.74 219965.58,-168.4"/>
<text text-anchor="middle" x="216958" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l12_dp1 -->
<g id="node723" class="node">
<title>expert4_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="219907.5,-161.98 219678.5,-161.98 219678.5,-109.98 219907.5,-109.98 219907.5,-161.98"/>
<text text-anchor="middle" x="219793" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L12</text>
<text text-anchor="middle" x="219793" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="219793" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="219793" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert4_l12_dp1 -->
<g id="edge1209" class="edge">
<title>router_l12_dp1&#45;&gt;expert4_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.24,-171.74C216913.75,-173.82 216933.19,-175.61 216952,-176.98 217489.6,-216.12 218838.48,-196.54 219377.5,-198.98 219507.42,-199.57 219541.76,-203.28 219669,-176.98 219683.75,-173.93 219699.2,-169.7 219713.99,-165.11"/>
<polygon fill="black" stroke="black" points="219715.13,-168.42 219723.6,-162.05 219713.01,-161.75 219715.13,-168.42"/>
<text text-anchor="middle" x="219399" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l12_dp1 -->
<g id="node724" class="node">
<title>expert5_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="219660.5,-161.98 219431.5,-161.98 219431.5,-109.98 219660.5,-109.98 219660.5,-161.98"/>
<text text-anchor="middle" x="219546" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L12</text>
<text text-anchor="middle" x="219546" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="219546" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="219546" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert5_l12_dp1 -->
<g id="edge1210" class="edge">
<title>router_l12_dp1&#45;&gt;expert5_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.24,-171.72C216913.75,-173.8 216933.19,-175.6 216952,-176.98 217425.75,-211.76 218614.48,-196.54 219089.5,-198.98 219237.6,-199.74 219276.78,-206.06 219422,-176.98 219436.95,-173.99 219452.61,-169.74 219467.57,-165.1"/>
<polygon fill="black" stroke="black" points="219468.82,-168.37 219477.28,-162 219466.69,-161.7 219468.82,-168.37"/>
<text text-anchor="middle" x="219111" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l12_dp1 -->
<g id="node725" class="node">
<title>expert6_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="219413.5,-161.98 219184.5,-161.98 219184.5,-109.98 219413.5,-109.98 219413.5,-161.98"/>
<text text-anchor="middle" x="219299" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L12</text>
<text text-anchor="middle" x="219299" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="219299" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="219299" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert6_l12_dp1 -->
<g id="edge1211" class="edge">
<title>router_l12_dp1&#45;&gt;expert6_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.25,-171.68C216913.76,-173.77 216933.19,-175.58 216952,-176.98 217753.62,-236.59 217956.68,-194.09 218760.5,-198.98 218944.98,-200.1 218993.81,-211.69 219175,-176.98 219190.16,-174.08 219206.03,-169.82 219221.16,-165.13"/>
<polygon fill="black" stroke="black" points="219222.51,-168.37 219230.97,-162 219220.38,-161.7 219222.51,-168.37"/>
<text text-anchor="middle" x="218782" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l12_dp1 -->
<g id="node726" class="node">
<title>expert7_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="219166.5,-161.98 218937.5,-161.98 218937.5,-109.98 219166.5,-109.98 219166.5,-161.98"/>
<text text-anchor="middle" x="219052" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L12</text>
<text text-anchor="middle" x="219052" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="219052" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="219052" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert7_l12_dp1 -->
<g id="edge1212" class="edge">
<title>router_l12_dp1&#45;&gt;expert7_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216840.36,-177C216889.91,-186.1 216943.51,-194.4 216993.5,-198.98 217012.53,-200.73 217017.39,-199.09 217036.5,-198.98 217246.68,-197.76 218720.69,-211.6 218928,-176.98 218943.83,-174.34 218960.39,-170.02 218976.07,-165.16"/>
<polygon fill="black" stroke="black" points="218977.25,-168.45 218985.7,-162.07 218975.11,-161.79 218977.25,-168.45"/>
<text text-anchor="middle" x="217015" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l12_dp1 -->
<g id="node727" class="node">
<title>expert8_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="218919.5,-161.98 218690.5,-161.98 218690.5,-109.98 218919.5,-109.98 218919.5,-161.98"/>
<text text-anchor="middle" x="218805" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L12</text>
<text text-anchor="middle" x="218805" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="218805" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="218805" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert8_l12_dp1 -->
<g id="edge1213" class="edge">
<title>router_l12_dp1&#45;&gt;expert8_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216894.25,-171.61C216913.76,-173.71 216933.19,-175.55 216952,-176.98 217571.39,-224.15 217728.33,-194.09 218349.5,-198.98 218497.15,-200.14 218536.22,-205.99 218681,-176.98 218695.95,-173.99 218711.61,-169.73 218726.57,-165.09"/>
<polygon fill="black" stroke="black" points="218727.82,-168.37 218736.28,-162 218725.69,-161.7 218727.82,-168.37"/>
<text text-anchor="middle" x="218371" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l12_dp1 -->
<g id="node728" class="node">
<title>expert9_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="218672.5,-161.98 218443.5,-161.98 218443.5,-109.98 218672.5,-109.98 218672.5,-161.98"/>
<text text-anchor="middle" x="218558" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L12</text>
<text text-anchor="middle" x="218558" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="218558" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="218558" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert9_l12_dp1 -->
<g id="edge1214" class="edge">
<title>router_l12_dp1&#45;&gt;expert9_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216893.85,-171.46C216913.5,-173.61 216933.06,-175.49 216952,-176.98 217445.46,-215.76 217570.73,-213.74 218065.5,-198.98 218229.49,-194.09 218272.87,-207.88 218434,-176.98 218449.16,-174.08 218465.03,-169.81 218480.15,-165.12"/>
<polygon fill="black" stroke="black" points="218481.51,-168.37 218489.97,-161.99 218479.38,-161.7 218481.51,-168.37"/>
<text text-anchor="middle" x="218044" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l12_dp1 -->
<g id="node729" class="node">
<title>expert10_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="218425.5,-161.98 218196.5,-161.98 218196.5,-109.98 218425.5,-109.98 218425.5,-161.98"/>
<text text-anchor="middle" x="218311" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L12</text>
<text text-anchor="middle" x="218311" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="218311" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="218311" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert10_l12_dp1 -->
<g id="edge1215" class="edge">
<title>router_l12_dp1&#45;&gt;expert10_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216869.77,-177.01C216927.03,-186.11 216988.91,-194.4 217046.5,-198.98 217172.85,-209.03 218062.07,-198.39 218187,-176.98 218202.73,-174.29 218219.18,-169.97 218234.78,-165.14"/>
<polygon fill="black" stroke="black" points="218235.9,-168.45 218244.36,-162.07 218233.77,-161.79 218235.9,-168.45"/>
<text text-anchor="middle" x="217068" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l12_dp1 -->
<g id="node730" class="node">
<title>expert11_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="218178.5,-161.98 217949.5,-161.98 217949.5,-109.98 218178.5,-109.98 218178.5,-161.98"/>
<text text-anchor="middle" x="218064" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L12</text>
<text text-anchor="middle" x="218064" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="218064" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="218064" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert11_l12_dp1 -->
<g id="edge1216" class="edge">
<title>router_l12_dp1&#45;&gt;expert11_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216893.47,-171.15C216913.24,-173.37 216932.94,-175.36 216952,-176.98 217264.58,-203.53 217344.03,-211.17 217657.5,-198.98 217783.34,-194.09 217816.54,-201.82 217940,-176.98 217954.86,-173.99 217970.42,-169.77 217985.29,-165.16"/>
<polygon fill="black" stroke="black" points="217986.49,-168.45 217994.95,-162.08 217984.36,-161.78 217986.49,-168.45"/>
<text text-anchor="middle" x="217636" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l12_dp1 -->
<g id="node731" class="node">
<title>expert12_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="217931.5,-161.98 217702.5,-161.98 217702.5,-109.98 217931.5,-109.98 217931.5,-161.98"/>
<text text-anchor="middle" x="217817" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L12</text>
<text text-anchor="middle" x="217817" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="217817" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="217817" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert12_l12_dp1 -->
<g id="edge1217" class="edge">
<title>router_l12_dp1&#45;&gt;expert12_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216897.5,-177.01C216962.02,-186.11 217031.72,-194.4 217096.5,-198.98 217228.81,-208.33 217562.48,-200.67 217693,-176.98 217708.37,-174.19 217724.45,-169.93 217739.75,-165.2"/>
<polygon fill="black" stroke="black" points="217741.21,-168.41 217749.67,-162.03 217739.08,-161.74 217741.21,-168.41"/>
<text text-anchor="middle" x="217118" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l12_dp1 -->
<g id="node732" class="node">
<title>expert13_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="217684.5,-161.98 217455.5,-161.98 217455.5,-109.98 217684.5,-109.98 217684.5,-161.98"/>
<text text-anchor="middle" x="217570" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L12</text>
<text text-anchor="middle" x="217570" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="217570" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="217570" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert13_l12_dp1 -->
<g id="edge1218" class="edge">
<title>router_l12_dp1&#45;&gt;expert13_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216868.94,-177.02C217003.48,-197.35 217180.12,-214.54 217336.5,-198.98 217387.98,-193.86 217443.99,-179.08 217488.25,-165.12"/>
<polygon fill="black" stroke="black" points="217489.34,-168.44 217497.8,-162.06 217487.21,-161.78 217489.34,-168.44"/>
<text text-anchor="middle" x="217315" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l12_dp1 -->
<g id="node733" class="node">
<title>expert14_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="217437.5,-161.98 217208.5,-161.98 217208.5,-109.98 217437.5,-109.98 217437.5,-161.98"/>
<text text-anchor="middle" x="217323" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L12</text>
<text text-anchor="middle" x="217323" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="217323" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="217323" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert14_l12_dp1 -->
<g id="edge1219" class="edge">
<title>router_l12_dp1&#45;&gt;expert14_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216875.49,-177.02C216995.1,-196.13 217129.79,-212.05 217188.5,-198.98 217217.07,-192.62 217246.74,-179.52 217270.92,-166.9"/>
<polygon fill="black" stroke="black" points="217272.74,-169.9 217279.91,-162.1 217269.44,-163.73 217272.74,-169.9"/>
<text text-anchor="middle" x="217167" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l12_dp1 -->
<g id="node734" class="node">
<title>expert15_l12_dp1</title>
<polygon fill="lightgreen" stroke="black" points="217190.5,-161.98 216961.5,-161.98 216961.5,-109.98 217190.5,-109.98 217190.5,-161.98"/>
<text text-anchor="middle" x="217076" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L12</text>
<text text-anchor="middle" x="217076" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="217076" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="217076" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp1&#45;&gt;expert15_l12_dp1 -->
<g id="edge1220" class="edge">
<title>router_l12_dp1&#45;&gt;expert15_l12_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216849.95,-135.98C216884.38,-135.98 216919.32,-135.98 216951.11,-135.98"/>
<polygon fill="black" stroke="black" points="216951.32,-139.48 216961.32,-135.98 216951.32,-132.48 216951.32,-139.48"/>
<text text-anchor="middle" x="216931.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l12_dp1 -->
<g id="node735" class="node">
<title>expert_agg_l12_dp1</title>
<polygon fill="lightyellow" stroke="black" points="221426.57,-176.98 221032.74,-176.98 220931.43,-94.98 221325.26,-94.98 221426.57,-176.98"/>
<text text-anchor="middle" x="221179" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L12</text>
<text text-anchor="middle" x="221179" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="221179" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1221" class="edge">
<title>expert0_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M220895.66,-135.98C220921.06,-135.98 220946.47,-135.98 220971.87,-135.98"/>
<polygon fill="black" stroke="black" points="220971.99,-139.48 220981.99,-135.98 220971.99,-132.48 220971.99,-139.48"/>
</g>
<!-- expert1_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1222" class="edge">
<title>expert1_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M220589.24,-162.02C220612.4,-171.57 220639.96,-181.22 220666,-185.98 220716.06,-195.15 220844.3,-190.41 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert2_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1223" class="edge">
<title>expert2_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M220342.24,-162.02C220365.4,-171.57 220392.96,-181.22 220419,-185.98 220471.02,-195.51 220842.31,-190.59 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert3_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1224" class="edge">
<title>expert3_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M220095.24,-162.02C220118.4,-171.57 220145.96,-181.22 220172,-185.98 220251.02,-200.45 220814.97,-192.97 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert4_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1225" class="edge">
<title>expert4_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M219848.24,-162.02C219871.4,-171.57 219898.96,-181.22 219925,-185.98 219978.01,-195.69 220841.31,-190.67 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert5_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1226" class="edge">
<title>expert5_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M219601.24,-162.02C219624.4,-171.57 219651.96,-181.22 219678,-185.98 219744.5,-198.16 220827.64,-191.87 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert6_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1227" class="edge">
<title>expert6_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M219354.24,-162.02C219377.4,-171.57 219404.96,-181.22 219431,-185.98 219511,-200.63 220813.97,-193.06 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert7_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1228" class="edge">
<title>expert7_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M219107.24,-162.02C219130.4,-171.57 219157.96,-181.22 219184,-185.98 219230.75,-194.54 220847.65,-190.12 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert8_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1229" class="edge">
<title>expert8_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M218860.24,-162.02C218883.4,-171.57 218910.96,-181.22 218937,-185.98 218990.5,-195.78 220840.82,-190.72 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert9_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1230" class="edge">
<title>expert9_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M218613.24,-162.02C218636.4,-171.57 218663.96,-181.22 218690,-185.98 218750.25,-197.01 220833.98,-191.31 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert10_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1231" class="edge">
<title>expert10_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M218366.24,-162.02C218389.4,-171.57 218416.96,-181.22 218443,-185.98 218510,-198.25 220827.15,-191.91 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert11_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1232" class="edge">
<title>expert11_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M218119.24,-162.02C218142.4,-171.57 218169.96,-181.22 218196,-185.98 218269.75,-199.48 220820.31,-192.51 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert12_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1233" class="edge">
<title>expert12_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M217872.24,-162.02C217895.4,-171.57 217922.96,-181.22 217949,-185.98 218029.49,-200.72 220813.48,-193.1 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert13_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1234" class="edge">
<title>expert13_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M217625.24,-162.02C217648.4,-171.57 217675.96,-181.22 217702,-185.98 217745.62,-193.97 220850.82,-189.84 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert14_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1235" class="edge">
<title>expert14_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M217378.24,-162.02C217401.4,-171.57 217428.96,-181.22 217455,-185.98 217502,-194.59 220847.4,-190.14 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- expert15_l12_dp1&#45;&gt;expert_agg_l12_dp1 -->
<g id="edge1236" class="edge">
<title>expert15_l12_dp1&#45;&gt;expert_agg_l12_dp1</title>
<path fill="none" stroke="black" d="M217131.24,-162.02C217154.4,-171.57 217181.96,-181.22 217208,-185.98 217258.37,-195.2 220843.98,-190.44 220895,-185.98 220933.11,-182.65 220973.78,-176.86 221012.08,-170.36"/>
<polygon fill="black" stroke="black" points="221013.02,-173.75 221022.29,-168.6 221011.84,-166.85 221013.02,-173.75"/>
</g>
<!-- layer12_output_dp1 -->
<g id="node736" class="node">
<title>layer12_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="221631" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="221631" y="-144.48" font-family="Arial" font-size="10.00">Layer 12 Output</text>
<text text-anchor="middle" x="221631" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="221631" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l12_dp1&#45;&gt;layer12_output_dp1 -->
<g id="edge1237" class="edge">
<title>expert_agg_l12_dp1&#45;&gt;layer12_output_dp1</title>
<path fill="none" stroke="black" d="M221376.31,-135.98C221401.49,-135.98 221426.66,-135.98 221451.84,-135.98"/>
<polygon fill="black" stroke="black" points="221451.87,-139.48 221461.87,-135.98 221451.87,-132.48 221451.87,-139.48"/>
</g>
<!-- attn_input_l13_dp1 -->
<g id="node737" class="node">
<title>attn_input_l13_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="222004" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="222004" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L13</text>
<text text-anchor="middle" x="222004" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="222004" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer12_output_dp1&#45;&gt;attn_input_l13_dp1 -->
<g id="edge1238" class="edge">
<title>layer12_output_dp1&#45;&gt;attn_input_l13_dp1</title>
<path fill="none" stroke="black" d="M221800.01,-135.98C221808.23,-135.98 221816.44,-135.98 221824.66,-135.98"/>
<polygon fill="black" stroke="black" points="221824.68,-139.48 221834.68,-135.98 221824.68,-132.48 221824.68,-139.48"/>
</g>
<!-- attn_tp0_l13_dp1 -->
<g id="node738" class="node">
<title>attn_tp0_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="223302,-161.98 223042,-161.98 223042,-109.98 223302,-109.98 223302,-161.98"/>
<text text-anchor="middle" x="223172" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L13</text>
<text text-anchor="middle" x="223172" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="223172" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="223172" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp1&#45;&gt;attn_tp0_l13_dp1 -->
<g id="edge1239" class="edge">
<title>attn_input_l13_dp1&#45;&gt;attn_tp0_l13_dp1</title>
<path fill="none" stroke="black" d="M222087.52,-161.26C222124.12,-171.09 222167.81,-181.13 222208,-185.98 222253,-191.42 222979.27,-193.33 223024,-185.98 223049.4,-181.81 223076.31,-173.85 223100.12,-165.5"/>
<polygon fill="black" stroke="black" points="223101.55,-168.71 223109.78,-162.03 223099.18,-162.12 223101.55,-168.71"/>
</g>
<!-- attn_tp1_l13_dp1 -->
<g id="node739" class="node">
<title>attn_tp1_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="223024,-161.98 222764,-161.98 222764,-109.98 223024,-109.98 223024,-161.98"/>
<text text-anchor="middle" x="222894" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L13</text>
<text text-anchor="middle" x="222894" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="222894" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="222894" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp1&#45;&gt;attn_tp1_l13_dp1 -->
<g id="edge1240" class="edge">
<title>attn_input_l13_dp1&#45;&gt;attn_tp1_l13_dp1</title>
<path fill="none" stroke="black" d="M222087.52,-161.26C222124.12,-171.09 222167.81,-181.13 222208,-185.98 222267.35,-193.15 222687.01,-195.68 222746,-185.98 222771.4,-181.81 222798.31,-173.85 222822.12,-165.5"/>
<polygon fill="black" stroke="black" points="222823.55,-168.71 222831.78,-162.03 222821.18,-162.12 222823.55,-168.71"/>
</g>
<!-- attn_tp2_l13_dp1 -->
<g id="node740" class="node">
<title>attn_tp2_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="222746,-161.98 222486,-161.98 222486,-109.98 222746,-109.98 222746,-161.98"/>
<text text-anchor="middle" x="222616" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L13</text>
<text text-anchor="middle" x="222616" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="222616" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="222616" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp1&#45;&gt;attn_tp2_l13_dp1 -->
<g id="edge1241" class="edge">
<title>attn_input_l13_dp1&#45;&gt;attn_tp2_l13_dp1</title>
<path fill="none" stroke="black" d="M222087.52,-161.26C222124.12,-171.09 222167.81,-181.13 222208,-185.98 222265.36,-192.91 222410.99,-195.35 222468,-185.98 222493.4,-181.81 222520.31,-173.85 222544.12,-165.5"/>
<polygon fill="black" stroke="black" points="222545.55,-168.71 222553.78,-162.03 222543.18,-162.12 222545.55,-168.71"/>
</g>
<!-- attn_tp3_l13_dp1 -->
<g id="node741" class="node">
<title>attn_tp3_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="222468,-161.98 222208,-161.98 222208,-109.98 222468,-109.98 222468,-161.98"/>
<text text-anchor="middle" x="222338" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L13</text>
<text text-anchor="middle" x="222338" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="222338" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="222338" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp1&#45;&gt;attn_tp3_l13_dp1 -->
<g id="edge1242" class="edge">
<title>attn_input_l13_dp1&#45;&gt;attn_tp3_l13_dp1</title>
<path fill="none" stroke="black" d="M222173.28,-135.98C222181.35,-135.98 222189.42,-135.98 222197.49,-135.98"/>
<polygon fill="black" stroke="black" points="222197.7,-139.48 222207.7,-135.98 222197.7,-132.48 222197.7,-139.48"/>
</g>
<!-- allreduce_l13_dp1 -->
<g id="node742" class="node">
<title>allreduce_l13_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="223506" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="223506" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L13</text>
<text text-anchor="middle" x="223506" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="223506" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l13_dp1&#45;&gt;allreduce_l13_dp1 -->
<g id="edge1243" class="edge">
<title>attn_tp0_l13_dp1&#45;&gt;allreduce_l13_dp1</title>
<path fill="none" stroke="black" d="M223302.14,-135.98C223310.35,-135.98 223318.56,-135.98 223326.77,-135.98"/>
<polygon fill="black" stroke="black" points="223326.78,-139.48 223336.78,-135.98 223326.78,-132.48 223326.78,-139.48"/>
</g>
<!-- attn_tp1_l13_dp1&#45;&gt;allreduce_l13_dp1 -->
<g id="edge1244" class="edge">
<title>attn_tp1_l13_dp1&#45;&gt;allreduce_l13_dp1</title>
<path fill="none" stroke="black" d="M222956.22,-162.03C222982.24,-171.59 223013.1,-181.23 223042,-185.98 223099.01,-195.35 223244.64,-192.91 223302,-185.98 223338.57,-181.57 223378.05,-172.85 223412.44,-163.91"/>
<polygon fill="black" stroke="black" points="223413.7,-167.2 223422.47,-161.26 223411.91,-160.43 223413.7,-167.2"/>
</g>
<!-- attn_tp2_l13_dp1&#45;&gt;allreduce_l13_dp1 -->
<g id="edge1245" class="edge">
<title>attn_tp2_l13_dp1&#45;&gt;allreduce_l13_dp1</title>
<path fill="none" stroke="black" d="M222678.22,-162.03C222704.24,-171.59 222735.1,-181.23 222764,-185.98 222822.98,-195.68 223242.65,-193.15 223302,-185.98 223338.57,-181.57 223378.05,-172.85 223412.44,-163.91"/>
<polygon fill="black" stroke="black" points="223413.7,-167.2 223422.47,-161.26 223411.91,-160.43 223413.7,-167.2"/>
</g>
<!-- attn_tp3_l13_dp1&#45;&gt;allreduce_l13_dp1 -->
<g id="edge1246" class="edge">
<title>attn_tp3_l13_dp1&#45;&gt;allreduce_l13_dp1</title>
<path fill="none" stroke="black" d="M222400.22,-162.03C222426.24,-171.59 222457.1,-181.23 222486,-185.98 222530.73,-193.33 223256.99,-191.42 223302,-185.98 223338.57,-181.57 223378.05,-172.85 223412.44,-163.91"/>
<polygon fill="black" stroke="black" points="223413.7,-167.2 223422.47,-161.26 223411.91,-160.43 223413.7,-167.2"/>
</g>
<!-- moe_input_l13_dp1 -->
<g id="node743" class="node">
<title>moe_input_l13_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="223879" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="223879" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L13</text>
<text text-anchor="middle" x="223879" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="223879" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l13_dp1&#45;&gt;moe_input_l13_dp1 -->
<g id="edge1247" class="edge">
<title>allreduce_l13_dp1&#45;&gt;moe_input_l13_dp1</title>
<path fill="none" stroke="black" d="M223675.01,-135.98C223683.23,-135.98 223691.44,-135.98 223699.66,-135.98"/>
<polygon fill="black" stroke="black" points="223699.68,-139.48 223709.68,-135.98 223699.68,-132.48 223699.68,-139.48"/>
</g>
<!-- router_l13_dp1 -->
<g id="node744" class="node">
<title>router_l13_dp1</title>
<polygon fill="lightyellow" stroke="black" points="224578.57,-176.98 224184.74,-176.98 224083.43,-94.98 224477.26,-94.98 224578.57,-176.98"/>
<text text-anchor="middle" x="224331" y="-144.48" font-family="Arial" font-size="10.00">Router L13</text>
<text text-anchor="middle" x="224331" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="224331" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l13_dp1&#45;&gt;router_l13_dp1 -->
<g id="edge1248" class="edge">
<title>moe_input_l13_dp1&#45;&gt;router_l13_dp1</title>
<path fill="none" stroke="black" d="M224048.06,-135.98C224073.34,-135.98 224098.63,-135.98 224123.92,-135.98"/>
<polygon fill="black" stroke="black" points="224123.99,-139.48 224133.99,-135.98 224123.99,-132.48 224123.99,-139.48"/>
</g>
<!-- expert0_l13_dp1 -->
<g id="node745" class="node">
<title>expert0_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="228584.5,-161.98 228355.5,-161.98 228355.5,-109.98 228584.5,-109.98 228584.5,-161.98"/>
<text text-anchor="middle" x="228470" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L13</text>
<text text-anchor="middle" x="228470" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="228470" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="228470" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert0_l13_dp1 -->
<g id="edge1249" class="edge">
<title>router_l13_dp1&#45;&gt;expert0_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.74,-171.32C224593.09,-173.59 224614.41,-175.53 224635,-176.98 225395.47,-230.48 227303.15,-196.54 228065.5,-198.98 228190.55,-199.38 228223.59,-202.54 228346,-176.98 228360.75,-173.9 228376.19,-169.66 228390.98,-165.07"/>
<polygon fill="black" stroke="black" points="228392.12,-168.37 228400.59,-162 228390,-161.7 228392.12,-168.37"/>
<text text-anchor="middle" x="228087" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l13_dp1 -->
<g id="node746" class="node">
<title>expert1_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="228337.5,-161.98 228108.5,-161.98 228108.5,-109.98 228337.5,-109.98 228337.5,-161.98"/>
<text text-anchor="middle" x="228223" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L13</text>
<text text-anchor="middle" x="228223" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="228223" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="228223" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert1_l13_dp1 -->
<g id="edge1250" class="edge">
<title>router_l13_dp1&#45;&gt;expert1_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.74,-171.31C224593.09,-173.58 224614.41,-175.53 224635,-176.98 225334.05,-226.36 227087.71,-196.54 227788.5,-198.98 227926.84,-199.47 227963.43,-204.56 228099,-176.98 228113.85,-173.96 228129.41,-169.72 228144.28,-165.11"/>
<polygon fill="black" stroke="black" points="228145.48,-168.4 228153.94,-162.03 228143.35,-161.73 228145.48,-168.4"/>
<text text-anchor="middle" x="227810" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l13_dp1 -->
<g id="node747" class="node">
<title>expert2_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="228090.5,-161.98 227861.5,-161.98 227861.5,-109.98 228090.5,-109.98 228090.5,-161.98"/>
<text text-anchor="middle" x="227976" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L13</text>
<text text-anchor="middle" x="227976" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="227976" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="227976" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert2_l13_dp1 -->
<g id="edge1251" class="edge">
<title>router_l13_dp1&#45;&gt;expert2_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.74,-171.29C224593.1,-173.56 224614.41,-175.52 224635,-176.98 225266.21,-221.81 226849.71,-196.54 227482.5,-198.98 227647.01,-199.62 227690.55,-208.59 227852,-176.98 227867.06,-174.03 227882.82,-169.78 227897.86,-165.12"/>
<polygon fill="black" stroke="black" points="227899.17,-168.37 227907.63,-162 227897.04,-161.71 227899.17,-168.37"/>
<text text-anchor="middle" x="227504" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l13_dp1 -->
<g id="node748" class="node">
<title>expert3_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="227843.5,-161.98 227614.5,-161.98 227614.5,-109.98 227843.5,-109.98 227843.5,-161.98"/>
<text text-anchor="middle" x="227729" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L13</text>
<text text-anchor="middle" x="227729" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="227729" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="227729" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert3_l13_dp1 -->
<g id="edge1252" class="edge">
<title>router_l13_dp1&#45;&gt;expert3_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.74,-171.27C224593.1,-173.54 224614.41,-175.51 224635,-176.98 225185.28,-216.37 226565.82,-196.54 227117.5,-198.98 227334.38,-199.94 227391.79,-216.75 227605,-176.98 227620.27,-174.14 227636.24,-169.88 227651.45,-165.17"/>
<polygon fill="black" stroke="black" points="227652.86,-168.39 227661.32,-162.01 227650.73,-161.72 227652.86,-168.39"/>
<text text-anchor="middle" x="227139" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l13_dp1 -->
<g id="node749" class="node">
<title>expert4_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="227596.5,-161.98 227367.5,-161.98 227367.5,-109.98 227596.5,-109.98 227596.5,-161.98"/>
<text text-anchor="middle" x="227482" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L13</text>
<text text-anchor="middle" x="227482" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="227482" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="227482" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert4_l13_dp1 -->
<g id="edge1253" class="edge">
<title>router_l13_dp1&#45;&gt;expert4_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224476.67,-176.99C224515.3,-186.08 224557.21,-194.39 224596.5,-198.98 224615.48,-201.2 224620.39,-199.06 224639.5,-198.98 224941.56,-197.76 227059.97,-226.21 227358,-176.98 227373.93,-174.35 227390.6,-170.01 227406.35,-165.12"/>
<polygon fill="black" stroke="black" points="227407.58,-168.4 227416.03,-162.01 227405.44,-161.73 227407.58,-168.4"/>
<text text-anchor="middle" x="224618" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l13_dp1 -->
<g id="node750" class="node">
<title>expert5_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="227349.5,-161.98 227120.5,-161.98 227120.5,-109.98 227349.5,-109.98 227349.5,-161.98"/>
<text text-anchor="middle" x="227235" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L13</text>
<text text-anchor="middle" x="227235" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="227235" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="227235" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert5_l13_dp1 -->
<g id="edge1254" class="edge">
<title>router_l13_dp1&#45;&gt;expert5_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.74,-171.22C224593.1,-173.51 224614.42,-175.49 224635,-176.98 225078.19,-209.18 226190.15,-196.54 226634.5,-198.98 226846.5,-200.15 226902.61,-215.98 227111,-176.98 227126.26,-174.13 227142.24,-169.86 227157.45,-165.15"/>
<polygon fill="black" stroke="black" points="227158.86,-168.37 227167.32,-162 227156.73,-161.71 227158.86,-168.37"/>
<text text-anchor="middle" x="226656" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l13_dp1 -->
<g id="node751" class="node">
<title>expert6_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="227102.5,-161.98 226873.5,-161.98 226873.5,-109.98 227102.5,-109.98 227102.5,-161.98"/>
<text text-anchor="middle" x="226988" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L13</text>
<text text-anchor="middle" x="226988" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="226988" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="226988" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert6_l13_dp1 -->
<g id="edge1255" class="edge">
<title>router_l13_dp1&#45;&gt;expert6_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224503.37,-177C224548.98,-186.1 224598.37,-194.39 224644.5,-198.98 224663.52,-200.87 224668.39,-199.08 224687.5,-198.98 224929.34,-197.76 226625.43,-216.64 226864,-176.98 226879.84,-174.35 226896.4,-170.04 226912.07,-165.18"/>
<polygon fill="black" stroke="black" points="226913.25,-168.47 226921.7,-162.09 226911.11,-161.81 226913.25,-168.47"/>
<text text-anchor="middle" x="224666" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l13_dp1 -->
<g id="node752" class="node">
<title>expert7_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="226855.5,-161.98 226626.5,-161.98 226626.5,-109.98 226855.5,-109.98 226855.5,-161.98"/>
<text text-anchor="middle" x="226741" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L13</text>
<text text-anchor="middle" x="226741" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="226741" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="226741" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert7_l13_dp1 -->
<g id="edge1256" class="edge">
<title>router_l13_dp1&#45;&gt;expert7_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.33,-171.1C224592.83,-173.42 224614.29,-175.44 224635,-176.98 224983.07,-202.87 225856.59,-208.3 226205.5,-198.98 226388.58,-194.09 226437.02,-210.92 226617,-176.98 226632.17,-174.12 226648.04,-169.88 226663.17,-165.2"/>
<polygon fill="black" stroke="black" points="226664.52,-168.44 226672.99,-162.07 226662.4,-161.77 226664.52,-168.44"/>
<text text-anchor="middle" x="226184" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l13_dp1 -->
<g id="node753" class="node">
<title>expert8_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="226608.5,-161.98 226379.5,-161.98 226379.5,-109.98 226608.5,-109.98 226608.5,-161.98"/>
<text text-anchor="middle" x="226494" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L13</text>
<text text-anchor="middle" x="226494" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="226494" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="226494" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert8_l13_dp1 -->
<g id="edge1257" class="edge">
<title>router_l13_dp1&#45;&gt;expert8_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224530.02,-177C224582.62,-186.1 224639.5,-194.4 224692.5,-198.98 224711.54,-200.63 224716.39,-199.11 224735.5,-198.98 224917.12,-197.76 226190.88,-207.07 226370,-176.98 226385.83,-174.32 226402.39,-170 226418.07,-165.13"/>
<polygon fill="black" stroke="black" points="226419.24,-168.43 226427.7,-162.04 226417.1,-161.77 226419.24,-168.43"/>
<text text-anchor="middle" x="224714" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l13_dp1 -->
<g id="node754" class="node">
<title>expert9_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="226361.5,-161.98 226132.5,-161.98 226132.5,-109.98 226361.5,-109.98 226361.5,-161.98"/>
<text text-anchor="middle" x="226247" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L13</text>
<text text-anchor="middle" x="226247" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="226247" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="226247" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert9_l13_dp1 -->
<g id="edge1258" class="edge">
<title>router_l13_dp1&#45;&gt;expert9_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224571.35,-170.96C224592.84,-173.31 224614.29,-175.38 224635,-176.98 225131.17,-215.39 225257.07,-213.82 225754.5,-198.98 225918.49,-194.09 225961.87,-207.88 226123,-176.98 226138.16,-174.08 226154.03,-169.81 226169.15,-165.12"/>
<polygon fill="black" stroke="black" points="226170.51,-168.37 226178.97,-161.99 226168.38,-161.7 226170.51,-168.37"/>
<text text-anchor="middle" x="225733" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l13_dp1 -->
<g id="node755" class="node">
<title>expert10_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="226114.5,-161.98 225885.5,-161.98 225885.5,-109.98 226114.5,-109.98 226114.5,-161.98"/>
<text text-anchor="middle" x="226000" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L13</text>
<text text-anchor="middle" x="226000" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="226000" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="226000" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert10_l13_dp1 -->
<g id="edge1259" class="edge">
<title>router_l13_dp1&#45;&gt;expert10_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224556.65,-177.01C224616.23,-186.11 224680.61,-194.4 224740.5,-198.98 224866.32,-208.6 225751.62,-198.3 225876,-176.98 225891.73,-174.29 225908.18,-169.97 225923.78,-165.14"/>
<polygon fill="black" stroke="black" points="225924.9,-168.45 225933.36,-162.07 225922.77,-161.78 225924.9,-168.45"/>
<text text-anchor="middle" x="224762" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l13_dp1 -->
<g id="node756" class="node">
<title>expert11_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="225867.5,-161.98 225638.5,-161.98 225638.5,-109.98 225867.5,-109.98 225867.5,-161.98"/>
<text text-anchor="middle" x="225753" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L13</text>
<text text-anchor="middle" x="225753" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="225753" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="225753" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert11_l13_dp1 -->
<g id="edge1260" class="edge">
<title>router_l13_dp1&#45;&gt;expert11_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224570.95,-170.64C224592.58,-173.07 224614.17,-175.24 224635,-176.98 224950.71,-203.39 225030.92,-211.33 225347.5,-198.98 225472.9,-194.09 225505.97,-201.75 225629,-176.98 225643.86,-173.99 225659.42,-169.77 225674.29,-165.16"/>
<polygon fill="black" stroke="black" points="225675.48,-168.45 225683.95,-162.08 225673.36,-161.78 225675.48,-168.45"/>
<text text-anchor="middle" x="225326" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l13_dp1 -->
<g id="node757" class="node">
<title>expert12_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="225620.5,-161.98 225391.5,-161.98 225391.5,-109.98 225620.5,-109.98 225620.5,-161.98"/>
<text text-anchor="middle" x="225506" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L13</text>
<text text-anchor="middle" x="225506" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="225506" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="225506" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert12_l13_dp1 -->
<g id="edge1261" class="edge">
<title>router_l13_dp1&#45;&gt;expert12_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224577.89,-176.28C224645.94,-185.66 224719.91,-194.28 224788.5,-198.98 224920.17,-208.01 225252.14,-200.56 225382,-176.98 225397.37,-174.19 225413.45,-169.93 225428.75,-165.2"/>
<polygon fill="black" stroke="black" points="225430.21,-168.41 225438.67,-162.03 225428.08,-161.74 225430.21,-168.41"/>
<text text-anchor="middle" x="224810" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l13_dp1 -->
<g id="node758" class="node">
<title>expert13_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="225373.5,-161.98 225144.5,-161.98 225144.5,-109.98 225373.5,-109.98 225373.5,-161.98"/>
<text text-anchor="middle" x="225259" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L13</text>
<text text-anchor="middle" x="225259" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="225259" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="225259" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert13_l13_dp1 -->
<g id="edge1262" class="edge">
<title>router_l13_dp1&#45;&gt;expert13_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224548.82,-177.02C224685.96,-197.58 224866.66,-215.02 225026.5,-198.98 225077.66,-193.85 225133.31,-179.11 225177.33,-165.18"/>
<polygon fill="black" stroke="black" points="225178.66,-168.43 225187.11,-162.04 225176.52,-161.77 225178.66,-168.43"/>
<text text-anchor="middle" x="225005" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l13_dp1 -->
<g id="node759" class="node">
<title>expert14_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="225126.5,-161.98 224897.5,-161.98 224897.5,-109.98 225126.5,-109.98 225126.5,-161.98"/>
<text text-anchor="middle" x="225012" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L13</text>
<text text-anchor="middle" x="225012" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="225012" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="225012" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert14_l13_dp1 -->
<g id="edge1263" class="edge">
<title>router_l13_dp1&#45;&gt;expert14_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224556.44,-176.99C224679.58,-196.39 224819.01,-212.63 224879.5,-198.98 224907.7,-192.62 224936.94,-179.52 224960.75,-166.9"/>
<polygon fill="black" stroke="black" points="224962.48,-169.94 224969.6,-162.1 224959.14,-163.79 224962.48,-169.94"/>
<text text-anchor="middle" x="224858" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l13_dp1 -->
<g id="node760" class="node">
<title>expert15_l13_dp1</title>
<polygon fill="lightgreen" stroke="black" points="224873.5,-161.98 224644.5,-161.98 224644.5,-109.98 224873.5,-109.98 224873.5,-161.98"/>
<text text-anchor="middle" x="224759" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L13</text>
<text text-anchor="middle" x="224759" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="224759" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="224759" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp1&#45;&gt;expert15_l13_dp1 -->
<g id="edge1264" class="edge">
<title>router_l13_dp1&#45;&gt;expert15_l13_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224528.09,-135.98C224564.17,-135.98 224600.91,-135.98 224634.14,-135.98"/>
<polygon fill="black" stroke="black" points="224634.34,-139.48 224644.34,-135.98 224634.34,-132.48 224634.34,-139.48"/>
<text text-anchor="middle" x="224611.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l13_dp1 -->
<g id="node761" class="node">
<title>expert_agg_l13_dp1</title>
<polygon fill="lightyellow" stroke="black" points="229115.57,-176.98 228721.74,-176.98 228620.43,-94.98 229014.26,-94.98 229115.57,-176.98"/>
<text text-anchor="middle" x="228868" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L13</text>
<text text-anchor="middle" x="228868" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="228868" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1265" class="edge">
<title>expert0_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M228584.66,-135.98C228610.06,-135.98 228635.47,-135.98 228660.87,-135.98"/>
<polygon fill="black" stroke="black" points="228660.99,-139.48 228670.99,-135.98 228660.99,-132.48 228660.99,-139.48"/>
</g>
<!-- expert1_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1266" class="edge">
<title>expert1_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M228278.24,-162.02C228301.4,-171.57 228328.96,-181.22 228355,-185.98 228405.06,-195.15 228533.3,-190.41 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert2_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1267" class="edge">
<title>expert2_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M228031.24,-162.02C228054.4,-171.57 228081.96,-181.22 228108,-185.98 228160.02,-195.51 228531.31,-190.59 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert3_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1268" class="edge">
<title>expert3_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M227784.24,-162.02C227807.4,-171.57 227834.96,-181.22 227861,-185.98 227940.02,-200.45 228503.97,-192.97 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert4_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1269" class="edge">
<title>expert4_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M227537.24,-162.02C227560.4,-171.57 227587.96,-181.22 227614,-185.98 227667.01,-195.69 228530.31,-190.67 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert5_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1270" class="edge">
<title>expert5_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M227290.24,-162.02C227313.4,-171.57 227340.96,-181.22 227367,-185.98 227433.5,-198.16 228516.64,-191.87 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert6_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1271" class="edge">
<title>expert6_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M227043.24,-162.02C227066.4,-171.57 227093.96,-181.22 227120,-185.98 227200,-200.63 228502.97,-193.06 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert7_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1272" class="edge">
<title>expert7_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M226796.24,-162.02C226819.4,-171.57 226846.96,-181.22 226873,-185.98 226919.75,-194.54 228536.65,-190.12 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert8_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1273" class="edge">
<title>expert8_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M226549.24,-162.02C226572.4,-171.57 226599.96,-181.22 226626,-185.98 226679.5,-195.78 228529.82,-190.72 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert9_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1274" class="edge">
<title>expert9_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M226302.24,-162.02C226325.4,-171.57 226352.96,-181.22 226379,-185.98 226439.25,-197.01 228522.98,-191.31 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert10_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1275" class="edge">
<title>expert10_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M226055.24,-162.02C226078.4,-171.57 226105.96,-181.22 226132,-185.98 226199,-198.25 228516.15,-191.91 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert11_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1276" class="edge">
<title>expert11_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M225808.24,-162.02C225831.4,-171.57 225858.96,-181.22 225885,-185.98 225958.75,-199.48 228509.31,-192.51 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert12_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1277" class="edge">
<title>expert12_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M225561.24,-162.02C225584.4,-171.57 225611.96,-181.22 225638,-185.98 225718.49,-200.72 228502.48,-193.1 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert13_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1278" class="edge">
<title>expert13_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M225314.24,-162.02C225337.4,-171.57 225364.96,-181.22 225391,-185.98 225434.62,-193.97 228539.82,-189.84 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert14_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1279" class="edge">
<title>expert14_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M225067.24,-162.02C225090.4,-171.57 225117.96,-181.22 225144,-185.98 225191,-194.59 228536.4,-190.14 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- expert15_l13_dp1&#45;&gt;expert_agg_l13_dp1 -->
<g id="edge1280" class="edge">
<title>expert15_l13_dp1&#45;&gt;expert_agg_l13_dp1</title>
<path fill="none" stroke="black" d="M224816.86,-162.02C224841.1,-171.58 224869.89,-181.22 224897,-185.98 224947.44,-194.84 228532.98,-190.44 228584,-185.98 228622.11,-182.65 228662.78,-176.86 228701.08,-170.36"/>
<polygon fill="black" stroke="black" points="228702.02,-173.75 228711.29,-168.6 228700.84,-166.85 228702.02,-173.75"/>
</g>
<!-- layer13_output_dp1 -->
<g id="node762" class="node">
<title>layer13_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="229320" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="229320" y="-144.48" font-family="Arial" font-size="10.00">Layer 13 Output</text>
<text text-anchor="middle" x="229320" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="229320" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l13_dp1&#45;&gt;layer13_output_dp1 -->
<g id="edge1281" class="edge">
<title>expert_agg_l13_dp1&#45;&gt;layer13_output_dp1</title>
<path fill="none" stroke="black" d="M229065.31,-135.98C229090.49,-135.98 229115.66,-135.98 229140.84,-135.98"/>
<polygon fill="black" stroke="black" points="229140.87,-139.48 229150.87,-135.98 229140.87,-132.48 229140.87,-139.48"/>
</g>
<!-- attn_input_l14_dp1 -->
<g id="node763" class="node">
<title>attn_input_l14_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="229693" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="229693" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L14</text>
<text text-anchor="middle" x="229693" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="229693" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer13_output_dp1&#45;&gt;attn_input_l14_dp1 -->
<g id="edge1282" class="edge">
<title>layer13_output_dp1&#45;&gt;attn_input_l14_dp1</title>
<path fill="none" stroke="black" d="M229489.01,-135.98C229497.23,-135.98 229505.44,-135.98 229513.66,-135.98"/>
<polygon fill="black" stroke="black" points="229513.68,-139.48 229523.68,-135.98 229513.68,-132.48 229513.68,-139.48"/>
</g>
<!-- attn_tp0_l14_dp1 -->
<g id="node764" class="node">
<title>attn_tp0_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="230991,-161.98 230731,-161.98 230731,-109.98 230991,-109.98 230991,-161.98"/>
<text text-anchor="middle" x="230861" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L14</text>
<text text-anchor="middle" x="230861" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="230861" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="230861" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp1&#45;&gt;attn_tp0_l14_dp1 -->
<g id="edge1283" class="edge">
<title>attn_input_l14_dp1&#45;&gt;attn_tp0_l14_dp1</title>
<path fill="none" stroke="black" d="M229776.52,-161.26C229813.12,-171.09 229856.81,-181.13 229897,-185.98 229942,-191.42 230668.27,-193.33 230713,-185.98 230738.4,-181.81 230765.31,-173.85 230789.12,-165.5"/>
<polygon fill="black" stroke="black" points="230790.55,-168.71 230798.78,-162.03 230788.18,-162.12 230790.55,-168.71"/>
</g>
<!-- attn_tp1_l14_dp1 -->
<g id="node765" class="node">
<title>attn_tp1_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="230713,-161.98 230453,-161.98 230453,-109.98 230713,-109.98 230713,-161.98"/>
<text text-anchor="middle" x="230583" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L14</text>
<text text-anchor="middle" x="230583" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="230583" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="230583" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp1&#45;&gt;attn_tp1_l14_dp1 -->
<g id="edge1284" class="edge">
<title>attn_input_l14_dp1&#45;&gt;attn_tp1_l14_dp1</title>
<path fill="none" stroke="black" d="M229776.52,-161.26C229813.12,-171.09 229856.81,-181.13 229897,-185.98 229956.35,-193.15 230376.01,-195.68 230435,-185.98 230460.4,-181.81 230487.31,-173.85 230511.12,-165.5"/>
<polygon fill="black" stroke="black" points="230512.55,-168.71 230520.78,-162.03 230510.18,-162.12 230512.55,-168.71"/>
</g>
<!-- attn_tp2_l14_dp1 -->
<g id="node766" class="node">
<title>attn_tp2_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="230435,-161.98 230175,-161.98 230175,-109.98 230435,-109.98 230435,-161.98"/>
<text text-anchor="middle" x="230305" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L14</text>
<text text-anchor="middle" x="230305" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="230305" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="230305" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp1&#45;&gt;attn_tp2_l14_dp1 -->
<g id="edge1285" class="edge">
<title>attn_input_l14_dp1&#45;&gt;attn_tp2_l14_dp1</title>
<path fill="none" stroke="black" d="M229776.52,-161.26C229813.12,-171.09 229856.81,-181.13 229897,-185.98 229954.36,-192.91 230099.99,-195.35 230157,-185.98 230182.4,-181.81 230209.31,-173.85 230233.12,-165.5"/>
<polygon fill="black" stroke="black" points="230234.55,-168.71 230242.78,-162.03 230232.18,-162.12 230234.55,-168.71"/>
</g>
<!-- attn_tp3_l14_dp1 -->
<g id="node767" class="node">
<title>attn_tp3_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="230157,-161.98 229897,-161.98 229897,-109.98 230157,-109.98 230157,-161.98"/>
<text text-anchor="middle" x="230027" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L14</text>
<text text-anchor="middle" x="230027" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="230027" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="230027" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp1&#45;&gt;attn_tp3_l14_dp1 -->
<g id="edge1286" class="edge">
<title>attn_input_l14_dp1&#45;&gt;attn_tp3_l14_dp1</title>
<path fill="none" stroke="black" d="M229862.28,-135.98C229870.35,-135.98 229878.42,-135.98 229886.49,-135.98"/>
<polygon fill="black" stroke="black" points="229886.7,-139.48 229896.7,-135.98 229886.7,-132.48 229886.7,-139.48"/>
</g>
<!-- allreduce_l14_dp1 -->
<g id="node768" class="node">
<title>allreduce_l14_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="231195" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="231195" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L14</text>
<text text-anchor="middle" x="231195" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="231195" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l14_dp1&#45;&gt;allreduce_l14_dp1 -->
<g id="edge1287" class="edge">
<title>attn_tp0_l14_dp1&#45;&gt;allreduce_l14_dp1</title>
<path fill="none" stroke="black" d="M230991.14,-135.98C230999.35,-135.98 231007.56,-135.98 231015.77,-135.98"/>
<polygon fill="black" stroke="black" points="231015.78,-139.48 231025.78,-135.98 231015.78,-132.48 231015.78,-139.48"/>
</g>
<!-- attn_tp1_l14_dp1&#45;&gt;allreduce_l14_dp1 -->
<g id="edge1288" class="edge">
<title>attn_tp1_l14_dp1&#45;&gt;allreduce_l14_dp1</title>
<path fill="none" stroke="black" d="M230645.22,-162.03C230671.24,-171.59 230702.1,-181.23 230731,-185.98 230788.01,-195.35 230933.64,-192.91 230991,-185.98 231027.57,-181.57 231067.05,-172.85 231101.44,-163.91"/>
<polygon fill="black" stroke="black" points="231102.7,-167.2 231111.47,-161.26 231100.91,-160.43 231102.7,-167.2"/>
</g>
<!-- attn_tp2_l14_dp1&#45;&gt;allreduce_l14_dp1 -->
<g id="edge1289" class="edge">
<title>attn_tp2_l14_dp1&#45;&gt;allreduce_l14_dp1</title>
<path fill="none" stroke="black" d="M230367.22,-162.03C230393.24,-171.59 230424.1,-181.23 230453,-185.98 230511.98,-195.68 230931.65,-193.15 230991,-185.98 231027.57,-181.57 231067.05,-172.85 231101.44,-163.91"/>
<polygon fill="black" stroke="black" points="231102.7,-167.2 231111.47,-161.26 231100.91,-160.43 231102.7,-167.2"/>
</g>
<!-- attn_tp3_l14_dp1&#45;&gt;allreduce_l14_dp1 -->
<g id="edge1290" class="edge">
<title>attn_tp3_l14_dp1&#45;&gt;allreduce_l14_dp1</title>
<path fill="none" stroke="black" d="M230089.22,-162.03C230115.24,-171.59 230146.1,-181.23 230175,-185.98 230219.73,-193.33 230945.99,-191.42 230991,-185.98 231027.57,-181.57 231067.05,-172.85 231101.44,-163.91"/>
<polygon fill="black" stroke="black" points="231102.7,-167.2 231111.47,-161.26 231100.91,-160.43 231102.7,-167.2"/>
</g>
<!-- moe_input_l14_dp1 -->
<g id="node769" class="node">
<title>moe_input_l14_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="231568" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="231568" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L14</text>
<text text-anchor="middle" x="231568" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="231568" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l14_dp1&#45;&gt;moe_input_l14_dp1 -->
<g id="edge1291" class="edge">
<title>allreduce_l14_dp1&#45;&gt;moe_input_l14_dp1</title>
<path fill="none" stroke="black" d="M231364.01,-135.98C231372.23,-135.98 231380.44,-135.98 231388.66,-135.98"/>
<polygon fill="black" stroke="black" points="231388.68,-139.48 231398.68,-135.98 231388.68,-132.48 231388.68,-139.48"/>
</g>
<!-- router_l14_dp1 -->
<g id="node770" class="node">
<title>router_l14_dp1</title>
<polygon fill="lightyellow" stroke="black" points="232267.57,-176.98 231873.74,-176.98 231772.43,-94.98 232166.26,-94.98 232267.57,-176.98"/>
<text text-anchor="middle" x="232020" y="-144.48" font-family="Arial" font-size="10.00">Router L14</text>
<text text-anchor="middle" x="232020" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="232020" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l14_dp1&#45;&gt;router_l14_dp1 -->
<g id="edge1292" class="edge">
<title>moe_input_l14_dp1&#45;&gt;router_l14_dp1</title>
<path fill="none" stroke="black" d="M231737.06,-135.98C231762.34,-135.98 231787.63,-135.98 231812.92,-135.98"/>
<polygon fill="black" stroke="black" points="231812.99,-139.48 231822.99,-135.98 231812.99,-132.48 231812.99,-139.48"/>
</g>
<!-- expert0_l14_dp1 -->
<g id="node771" class="node">
<title>expert0_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="236465.5,-161.98 236236.5,-161.98 236236.5,-109.98 236465.5,-109.98 236465.5,-161.98"/>
<text text-anchor="middle" x="236351" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L14</text>
<text text-anchor="middle" x="236351" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="236351" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="236351" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert0_l14_dp1 -->
<g id="edge1293" class="edge">
<title>router_l14_dp1&#45;&gt;expert0_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232251.05,-163.47C232306.32,-168.99 232365.19,-174 232420,-176.98 233174.57,-218 235064.82,-196.54 235820.5,-198.98 236001.43,-199.57 236049.32,-211.13 236227,-176.98 236242.07,-174.09 236257.84,-169.86 236272.88,-165.2"/>
<polygon fill="black" stroke="black" points="236274.18,-168.46 236282.65,-162.09 236272.05,-161.79 236274.18,-168.46"/>
<text text-anchor="middle" x="235842" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l14_dp1 -->
<g id="node772" class="node">
<title>expert1_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="236218.5,-161.98 235989.5,-161.98 235989.5,-109.98 236218.5,-109.98 236218.5,-161.98"/>
<text text-anchor="middle" x="236104" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L14</text>
<text text-anchor="middle" x="236104" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="236104" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="236104" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert1_l14_dp1 -->
<g id="edge1294" class="edge">
<title>router_l14_dp1&#45;&gt;expert1_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232251.05,-163.43C232306.32,-168.95 232365.19,-173.98 232420,-176.98 233085.13,-213.43 234751.37,-196.54 235417.5,-198.98 235667.69,-199.9 235733.89,-221.98 235980,-176.98 235995.37,-174.17 236011.45,-169.91 236026.74,-165.17"/>
<polygon fill="black" stroke="black" points="236028.2,-168.38 236036.66,-162 236026.07,-161.71 236028.2,-168.38"/>
<text text-anchor="middle" x="235439" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l14_dp1 -->
<g id="node773" class="node">
<title>expert2_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="235971.5,-161.98 235742.5,-161.98 235742.5,-109.98 235971.5,-109.98 235971.5,-161.98"/>
<text text-anchor="middle" x="235857" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L14</text>
<text text-anchor="middle" x="235857" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="235857" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="235857" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert2_l14_dp1 -->
<g id="edge1295" class="edge">
<title>router_l14_dp1&#45;&gt;expert2_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232250.79,-163.34C232306.14,-168.87 232365.11,-173.93 232420,-176.98 232970.61,-207.62 234350.08,-206.28 234901.5,-198.98 235086.32,-196.54 235550.91,-208.78 235733,-176.98 235748.72,-174.24 235765.17,-169.9 235780.76,-165.06"/>
<polygon fill="black" stroke="black" points="235781.89,-168.37 235790.34,-161.99 235779.75,-161.71 235781.89,-168.37"/>
<text text-anchor="middle" x="234880" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l14_dp1 -->
<g id="node774" class="node">
<title>expert3_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="235724.5,-161.98 235495.5,-161.98 235495.5,-109.98 235724.5,-109.98 235724.5,-161.98"/>
<text text-anchor="middle" x="235610" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L14</text>
<text text-anchor="middle" x="235610" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="235610" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="235610" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert3_l14_dp1 -->
<g id="edge1296" class="edge">
<title>router_l14_dp1&#45;&gt;expert3_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232165.67,-176.99C232204.3,-186.08 232246.21,-194.39 232285.5,-198.98 232304.48,-201.2 232309.39,-199.05 232328.5,-198.98 232679.34,-197.76 235139.82,-233.97 235486,-176.98 235501.93,-174.36 235518.6,-170.02 235534.35,-165.13"/>
<polygon fill="black" stroke="black" points="235535.58,-168.41 235544.03,-162.02 235533.44,-161.75 235535.58,-168.41"/>
<text text-anchor="middle" x="232307" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l14_dp1 -->
<g id="node775" class="node">
<title>expert4_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="235477.5,-161.98 235248.5,-161.98 235248.5,-109.98 235477.5,-109.98 235477.5,-161.98"/>
<text text-anchor="middle" x="235363" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L14</text>
<text text-anchor="middle" x="235363" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="235363" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="235363" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert4_l14_dp1 -->
<g id="edge1297" class="edge">
<title>router_l14_dp1&#45;&gt;expert4_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232192.37,-177C232237.98,-186.1 232287.37,-194.39 232333.5,-198.98 232352.52,-200.87 232357.39,-199.06 232376.5,-198.98 232694.56,-197.76 234925.18,-228.76 235239,-176.98 235254.93,-174.35 235271.6,-170.01 235287.35,-165.12"/>
<polygon fill="black" stroke="black" points="235288.58,-168.4 235297.03,-162.01 235286.44,-161.74 235288.58,-168.4"/>
<text text-anchor="middle" x="232355" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l14_dp1 -->
<g id="node776" class="node">
<title>expert5_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="235230.5,-161.98 235001.5,-161.98 235001.5,-109.98 235230.5,-109.98 235230.5,-161.98"/>
<text text-anchor="middle" x="235116" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L14</text>
<text text-anchor="middle" x="235116" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="235116" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="235116" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert5_l14_dp1 -->
<g id="edge1298" class="edge">
<title>router_l14_dp1&#45;&gt;expert5_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232219.02,-177C232271.62,-186.1 232328.5,-194.4 232381.5,-198.98 232400.54,-200.63 232405.39,-199.06 232424.5,-198.98 232709.78,-197.76 234710.54,-223.55 234992,-176.98 235007.93,-174.35 235024.59,-170 235040.35,-165.11"/>
<polygon fill="black" stroke="black" points="235041.58,-168.39 235050.03,-162 235039.44,-161.73 235041.58,-168.39"/>
<text text-anchor="middle" x="232403" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l14_dp1 -->
<g id="node777" class="node">
<title>expert6_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="234983.5,-161.98 234754.5,-161.98 234754.5,-109.98 234983.5,-109.98 234983.5,-161.98"/>
<text text-anchor="middle" x="234869" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L14</text>
<text text-anchor="middle" x="234869" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="234869" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="234869" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert6_l14_dp1 -->
<g id="edge1299" class="edge">
<title>router_l14_dp1&#45;&gt;expert6_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232250.54,-163.11C232305.96,-168.67 232365.03,-173.79 232420,-176.98 233135.08,-218.56 233315.29,-210.02 234031.5,-198.98 234348.72,-194.09 234432.59,-232.24 234745,-176.98 234760.62,-174.22 234776.97,-169.9 234792.48,-165.09"/>
<polygon fill="black" stroke="black" points="234793.55,-168.42 234802.01,-162.04 234791.42,-161.75 234793.55,-168.42"/>
<text text-anchor="middle" x="234010" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l14_dp1 -->
<g id="node778" class="node">
<title>expert7_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="234736.5,-161.98 234507.5,-161.98 234507.5,-109.98 234736.5,-109.98 234736.5,-161.98"/>
<text text-anchor="middle" x="234622" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L14</text>
<text text-anchor="middle" x="234622" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="234622" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="234622" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert7_l14_dp1 -->
<g id="edge1300" class="edge">
<title>router_l14_dp1&#45;&gt;expert7_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232245.65,-177.01C232305.23,-186.11 232369.61,-194.4 232429.5,-198.98 232448.55,-200.44 232453.39,-199.09 232472.5,-198.98 232697.56,-197.76 234275.99,-213.97 234498,-176.98 234513.83,-174.34 234530.4,-170.03 234546.07,-165.17"/>
<polygon fill="black" stroke="black" points="234547.25,-168.46 234555.7,-162.08 234545.11,-161.8 234547.25,-168.46"/>
<text text-anchor="middle" x="232451" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l14_dp1 -->
<g id="node779" class="node">
<title>expert8_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="234489.5,-161.98 234260.5,-161.98 234260.5,-109.98 234489.5,-109.98 234489.5,-161.98"/>
<text text-anchor="middle" x="234375" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L14</text>
<text text-anchor="middle" x="234375" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="234375" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="234375" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert8_l14_dp1 -->
<g id="edge1301" class="edge">
<title>router_l14_dp1&#45;&gt;expert8_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232266.89,-176.28C232334.94,-185.66 232408.91,-194.28 232477.5,-198.98 232496.56,-200.29 232501.39,-199.1 232520.5,-198.98 232712.79,-197.76 234061.35,-208.76 234251,-176.98 234266.83,-174.33 234283.39,-170.01 234299.07,-165.14"/>
<polygon fill="black" stroke="black" points="234300.24,-168.44 234308.7,-162.05 234298.11,-161.78 234300.24,-168.44"/>
<text text-anchor="middle" x="232499" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l14_dp1 -->
<g id="node780" class="node">
<title>expert9_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="234242.5,-161.98 234013.5,-161.98 234013.5,-109.98 234242.5,-109.98 234242.5,-161.98"/>
<text text-anchor="middle" x="234128" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L14</text>
<text text-anchor="middle" x="234128" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="234128" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="234128" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert9_l14_dp1 -->
<g id="edge1302" class="edge">
<title>router_l14_dp1&#45;&gt;expert9_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232262.08,-172.34C232345.36,-183.2 232439.33,-193.63 232525.5,-198.98 232689.48,-209.16 233842,-204.35 234004,-176.98 234019.83,-174.31 234036.39,-169.98 234052.06,-165.11"/>
<polygon fill="black" stroke="black" points="234053.24,-168.41 234061.69,-162.02 234051.1,-161.74 234053.24,-168.41"/>
<text text-anchor="middle" x="232547" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l14_dp1 -->
<g id="node781" class="node">
<title>expert10_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="233995.5,-161.98 233766.5,-161.98 233766.5,-109.98 233995.5,-109.98 233995.5,-161.98"/>
<text text-anchor="middle" x="233881" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L14</text>
<text text-anchor="middle" x="233881" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="233881" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="233881" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert10_l14_dp1 -->
<g id="edge1303" class="edge">
<title>router_l14_dp1&#45;&gt;expert10_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232249.78,-162.52C232305.43,-168.13 232364.79,-173.41 232420,-176.98 232800.88,-201.61 232896.92,-207.75 233278.5,-198.98 233491.33,-194.09 233547.65,-215.65 233757,-176.98 233772.27,-174.16 233788.25,-169.92 233803.46,-165.21"/>
<polygon fill="black" stroke="black" points="233804.87,-168.43 233813.33,-162.06 233802.74,-161.76 233804.87,-168.43"/>
<text text-anchor="middle" x="233257" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l14_dp1 -->
<g id="node782" class="node">
<title>expert11_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="233748.5,-161.98 233519.5,-161.98 233519.5,-109.98 233748.5,-109.98 233748.5,-161.98"/>
<text text-anchor="middle" x="233634" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L14</text>
<text text-anchor="middle" x="233634" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="233634" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="233634" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert11_l14_dp1 -->
<g id="edge1304" class="edge">
<title>router_l14_dp1&#45;&gt;expert11_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232257.88,-169.04C232355.47,-181.04 232469.7,-193.09 232573.5,-198.98 232781.33,-210.77 233304.9,-212.61 233510,-176.98 233525.72,-174.25 233542.18,-169.92 233557.77,-165.08"/>
<polygon fill="black" stroke="black" points="233558.89,-168.39 233567.35,-162.01 233556.76,-161.73 233558.89,-168.39"/>
<text text-anchor="middle" x="232595" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l14_dp1 -->
<g id="node783" class="node">
<title>expert12_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="233501.5,-161.98 233272.5,-161.98 233272.5,-109.98 233501.5,-109.98 233501.5,-161.98"/>
<text text-anchor="middle" x="233387" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L14</text>
<text text-anchor="middle" x="233387" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="233387" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="233387" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert12_l14_dp1 -->
<g id="edge1305" class="edge">
<title>router_l14_dp1&#45;&gt;expert12_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232254.51,-166.28C232365.54,-179.16 232500.13,-192.64 232621.5,-198.98 232763.94,-206.42 233122.61,-202.24 233263,-176.98 233278.38,-174.22 233294.46,-169.97 233309.75,-165.24"/>
<polygon fill="black" stroke="black" points="233311.21,-168.44 233319.67,-162.07 233309.08,-161.78 233311.21,-168.44"/>
<text text-anchor="middle" x="232643" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l14_dp1 -->
<g id="node784" class="node">
<title>expert13_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="233254.5,-161.98 233025.5,-161.98 233025.5,-109.98 233254.5,-109.98 233254.5,-161.98"/>
<text text-anchor="middle" x="233140" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L14</text>
<text text-anchor="middle" x="233140" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="233140" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="233140" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert13_l14_dp1 -->
<g id="edge1306" class="edge">
<title>router_l14_dp1&#45;&gt;expert13_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232258.13,-176.99C232461.44,-204.61 232760.62,-227.65 233016,-176.98 233030.96,-174.01 233046.62,-169.78 233061.58,-165.14"/>
<polygon fill="black" stroke="black" points="233062.83,-168.41 233071.29,-162.04 233060.7,-161.74 233062.83,-168.41"/>
<text text-anchor="middle" x="232691" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l14_dp1 -->
<g id="node785" class="node">
<title>expert14_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="233007.5,-161.98 232778.5,-161.98 232778.5,-109.98 233007.5,-109.98 233007.5,-161.98"/>
<text text-anchor="middle" x="232893" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L14</text>
<text text-anchor="middle" x="232893" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="232893" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="232893" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert14_l14_dp1 -->
<g id="edge1307" class="edge">
<title>router_l14_dp1&#45;&gt;expert14_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232250.52,-163.01C232386.24,-177.37 232561.37,-193.22 232717.5,-198.98 232736.6,-199.69 232741.86,-203.19 232760.5,-198.98 232788.7,-192.62 232817.94,-179.52 232841.75,-166.9"/>
<polygon fill="black" stroke="black" points="232843.48,-169.94 232850.6,-162.1 232840.14,-163.79 232843.48,-169.94"/>
<text text-anchor="middle" x="232739" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l14_dp1 -->
<g id="node786" class="node">
<title>expert15_l14_dp1</title>
<polygon fill="lightgreen" stroke="black" points="232658.5,-161.98 232429.5,-161.98 232429.5,-109.98 232658.5,-109.98 232658.5,-161.98"/>
<text text-anchor="middle" x="232544" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L14</text>
<text text-anchor="middle" x="232544" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="232544" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="232544" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp1&#45;&gt;expert15_l14_dp1 -->
<g id="edge1308" class="edge">
<title>router_l14_dp1&#45;&gt;expert15_l14_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M232216.98,-135.98C232284.75,-135.98 232358.72,-135.98 232419.14,-135.98"/>
<polygon fill="black" stroke="black" points="232419.49,-139.48 232429.49,-135.98 232419.49,-132.48 232419.49,-139.48"/>
<text text-anchor="middle" x="232348.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l14_dp1 -->
<g id="node787" class="node">
<title>expert_agg_l14_dp1</title>
<polygon fill="lightyellow" stroke="black" points="236996.57,-176.98 236602.74,-176.98 236501.43,-94.98 236895.26,-94.98 236996.57,-176.98"/>
<text text-anchor="middle" x="236749" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L14</text>
<text text-anchor="middle" x="236749" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="236749" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1309" class="edge">
<title>expert0_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M236465.66,-135.98C236491.06,-135.98 236516.47,-135.98 236541.87,-135.98"/>
<polygon fill="black" stroke="black" points="236541.99,-139.48 236551.99,-135.98 236541.99,-132.48 236541.99,-139.48"/>
</g>
<!-- expert1_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1310" class="edge">
<title>expert1_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M236159.24,-162.02C236182.4,-171.57 236209.96,-181.22 236236,-185.98 236286.06,-195.15 236414.3,-190.41 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert2_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1311" class="edge">
<title>expert2_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M235912.24,-162.02C235935.4,-171.57 235962.96,-181.22 235989,-185.98 236041.02,-195.51 236412.31,-190.59 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert3_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1312" class="edge">
<title>expert3_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M235665.24,-162.02C235688.4,-171.57 235715.96,-181.22 235742,-185.98 235821.02,-200.45 236384.97,-192.97 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert4_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1313" class="edge">
<title>expert4_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M235418.24,-162.02C235441.4,-171.57 235468.96,-181.22 235495,-185.98 235548.01,-195.69 236411.31,-190.67 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert5_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1314" class="edge">
<title>expert5_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M235171.24,-162.02C235194.4,-171.57 235221.96,-181.22 235248,-185.98 235314.5,-198.16 236397.64,-191.87 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert6_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1315" class="edge">
<title>expert6_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M234924.24,-162.02C234947.4,-171.57 234974.96,-181.22 235001,-185.98 235081,-200.63 236383.97,-193.06 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert7_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1316" class="edge">
<title>expert7_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M234677.24,-162.02C234700.4,-171.57 234727.96,-181.22 234754,-185.98 234800.75,-194.54 236417.65,-190.12 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert8_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1317" class="edge">
<title>expert8_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M234430.24,-162.02C234453.4,-171.57 234480.96,-181.22 234507,-185.98 234560.5,-195.78 236410.82,-190.72 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert9_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1318" class="edge">
<title>expert9_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M234183.24,-162.02C234206.4,-171.57 234233.96,-181.22 234260,-185.98 234320.25,-197.01 236403.98,-191.31 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert10_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1319" class="edge">
<title>expert10_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M233936.24,-162.02C233959.4,-171.57 233986.96,-181.22 234013,-185.98 234080,-198.25 236397.15,-191.91 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert11_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1320" class="edge">
<title>expert11_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M233689.24,-162.02C233712.4,-171.57 233739.96,-181.22 233766,-185.98 233839.75,-199.48 236390.31,-192.51 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert12_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1321" class="edge">
<title>expert12_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M233442.24,-162.02C233465.4,-171.57 233492.96,-181.22 233519,-185.98 233599.49,-200.72 236383.48,-193.1 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert13_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1322" class="edge">
<title>expert13_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M233195.24,-162.02C233218.4,-171.57 233245.96,-181.22 233272,-185.98 233315.62,-193.97 236420.82,-189.84 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert14_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1323" class="edge">
<title>expert14_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M232948.24,-162.02C232971.4,-171.57 232998.96,-181.22 233025,-185.98 233072,-194.59 236417.4,-190.14 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- expert15_l14_dp1&#45;&gt;expert_agg_l14_dp1 -->
<g id="edge1324" class="edge">
<title>expert15_l14_dp1&#45;&gt;expert_agg_l14_dp1</title>
<path fill="none" stroke="black" d="M232643.17,-162C232684.54,-171.59 232733.28,-181.26 232778,-185.98 232879.85,-196.74 236362.97,-194.9 236465,-185.98 236503.11,-182.65 236543.78,-176.86 236582.08,-170.36"/>
<polygon fill="black" stroke="black" points="236583.02,-173.75 236592.29,-168.6 236581.84,-166.85 236583.02,-173.75"/>
</g>
<!-- layer14_output_dp1 -->
<g id="node788" class="node">
<title>layer14_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="237201" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="237201" y="-144.48" font-family="Arial" font-size="10.00">Layer 14 Output</text>
<text text-anchor="middle" x="237201" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="237201" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l14_dp1&#45;&gt;layer14_output_dp1 -->
<g id="edge1325" class="edge">
<title>expert_agg_l14_dp1&#45;&gt;layer14_output_dp1</title>
<path fill="none" stroke="black" d="M236946.31,-135.98C236971.49,-135.98 236996.66,-135.98 237021.84,-135.98"/>
<polygon fill="black" stroke="black" points="237021.87,-139.48 237031.87,-135.98 237021.87,-132.48 237021.87,-139.48"/>
</g>
<!-- attn_input_l15_dp1 -->
<g id="node789" class="node">
<title>attn_input_l15_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="237574" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="237574" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L15</text>
<text text-anchor="middle" x="237574" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="237574" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer14_output_dp1&#45;&gt;attn_input_l15_dp1 -->
<g id="edge1326" class="edge">
<title>layer14_output_dp1&#45;&gt;attn_input_l15_dp1</title>
<path fill="none" stroke="black" d="M237370.01,-135.98C237378.23,-135.98 237386.44,-135.98 237394.66,-135.98"/>
<polygon fill="black" stroke="black" points="237394.68,-139.48 237404.68,-135.98 237394.68,-132.48 237394.68,-139.48"/>
</g>
<!-- attn_tp0_l15_dp1 -->
<g id="node790" class="node">
<title>attn_tp0_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="238872,-161.98 238612,-161.98 238612,-109.98 238872,-109.98 238872,-161.98"/>
<text text-anchor="middle" x="238742" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L15</text>
<text text-anchor="middle" x="238742" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="238742" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="238742" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp1&#45;&gt;attn_tp0_l15_dp1 -->
<g id="edge1327" class="edge">
<title>attn_input_l15_dp1&#45;&gt;attn_tp0_l15_dp1</title>
<path fill="none" stroke="black" d="M237657.52,-161.26C237694.12,-171.09 237737.81,-181.13 237778,-185.98 237823,-191.42 238549.27,-193.33 238594,-185.98 238619.4,-181.81 238646.31,-173.85 238670.12,-165.5"/>
<polygon fill="black" stroke="black" points="238671.55,-168.71 238679.78,-162.03 238669.18,-162.12 238671.55,-168.71"/>
</g>
<!-- attn_tp1_l15_dp1 -->
<g id="node791" class="node">
<title>attn_tp1_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="238594,-161.98 238334,-161.98 238334,-109.98 238594,-109.98 238594,-161.98"/>
<text text-anchor="middle" x="238464" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L15</text>
<text text-anchor="middle" x="238464" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="238464" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="238464" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp1&#45;&gt;attn_tp1_l15_dp1 -->
<g id="edge1328" class="edge">
<title>attn_input_l15_dp1&#45;&gt;attn_tp1_l15_dp1</title>
<path fill="none" stroke="black" d="M237657.52,-161.26C237694.12,-171.09 237737.81,-181.13 237778,-185.98 237837.35,-193.15 238257.01,-195.68 238316,-185.98 238341.4,-181.81 238368.31,-173.85 238392.12,-165.5"/>
<polygon fill="black" stroke="black" points="238393.55,-168.71 238401.78,-162.03 238391.18,-162.12 238393.55,-168.71"/>
</g>
<!-- attn_tp2_l15_dp1 -->
<g id="node792" class="node">
<title>attn_tp2_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="238316,-161.98 238056,-161.98 238056,-109.98 238316,-109.98 238316,-161.98"/>
<text text-anchor="middle" x="238186" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L15</text>
<text text-anchor="middle" x="238186" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="238186" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="238186" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp1&#45;&gt;attn_tp2_l15_dp1 -->
<g id="edge1329" class="edge">
<title>attn_input_l15_dp1&#45;&gt;attn_tp2_l15_dp1</title>
<path fill="none" stroke="black" d="M237657.52,-161.26C237694.12,-171.09 237737.81,-181.13 237778,-185.98 237835.36,-192.91 237980.99,-195.35 238038,-185.98 238063.4,-181.81 238090.31,-173.85 238114.12,-165.5"/>
<polygon fill="black" stroke="black" points="238115.55,-168.71 238123.78,-162.03 238113.18,-162.12 238115.55,-168.71"/>
</g>
<!-- attn_tp3_l15_dp1 -->
<g id="node793" class="node">
<title>attn_tp3_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="238038,-161.98 237778,-161.98 237778,-109.98 238038,-109.98 238038,-161.98"/>
<text text-anchor="middle" x="237908" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L15</text>
<text text-anchor="middle" x="237908" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="237908" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="237908" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp1&#45;&gt;attn_tp3_l15_dp1 -->
<g id="edge1330" class="edge">
<title>attn_input_l15_dp1&#45;&gt;attn_tp3_l15_dp1</title>
<path fill="none" stroke="black" d="M237743.28,-135.98C237751.35,-135.98 237759.42,-135.98 237767.49,-135.98"/>
<polygon fill="black" stroke="black" points="237767.7,-139.48 237777.7,-135.98 237767.7,-132.48 237767.7,-139.48"/>
</g>
<!-- allreduce_l15_dp1 -->
<g id="node794" class="node">
<title>allreduce_l15_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="239076" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="239076" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L15</text>
<text text-anchor="middle" x="239076" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="239076" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l15_dp1&#45;&gt;allreduce_l15_dp1 -->
<g id="edge1331" class="edge">
<title>attn_tp0_l15_dp1&#45;&gt;allreduce_l15_dp1</title>
<path fill="none" stroke="black" d="M238872.14,-135.98C238880.35,-135.98 238888.56,-135.98 238896.77,-135.98"/>
<polygon fill="black" stroke="black" points="238896.78,-139.48 238906.78,-135.98 238896.78,-132.48 238896.78,-139.48"/>
</g>
<!-- attn_tp1_l15_dp1&#45;&gt;allreduce_l15_dp1 -->
<g id="edge1332" class="edge">
<title>attn_tp1_l15_dp1&#45;&gt;allreduce_l15_dp1</title>
<path fill="none" stroke="black" d="M238526.22,-162.03C238552.24,-171.59 238583.1,-181.23 238612,-185.98 238669.01,-195.35 238814.64,-192.91 238872,-185.98 238908.57,-181.57 238948.05,-172.85 238982.44,-163.91"/>
<polygon fill="black" stroke="black" points="238983.7,-167.2 238992.47,-161.26 238981.91,-160.43 238983.7,-167.2"/>
</g>
<!-- attn_tp2_l15_dp1&#45;&gt;allreduce_l15_dp1 -->
<g id="edge1333" class="edge">
<title>attn_tp2_l15_dp1&#45;&gt;allreduce_l15_dp1</title>
<path fill="none" stroke="black" d="M238248.22,-162.03C238274.24,-171.59 238305.1,-181.23 238334,-185.98 238392.98,-195.68 238812.65,-193.15 238872,-185.98 238908.57,-181.57 238948.05,-172.85 238982.44,-163.91"/>
<polygon fill="black" stroke="black" points="238983.7,-167.2 238992.47,-161.26 238981.91,-160.43 238983.7,-167.2"/>
</g>
<!-- attn_tp3_l15_dp1&#45;&gt;allreduce_l15_dp1 -->
<g id="edge1334" class="edge">
<title>attn_tp3_l15_dp1&#45;&gt;allreduce_l15_dp1</title>
<path fill="none" stroke="black" d="M237970.22,-162.03C237996.24,-171.59 238027.1,-181.23 238056,-185.98 238100.73,-193.33 238826.99,-191.42 238872,-185.98 238908.57,-181.57 238948.05,-172.85 238982.44,-163.91"/>
<polygon fill="black" stroke="black" points="238983.7,-167.2 238992.47,-161.26 238981.91,-160.43 238983.7,-167.2"/>
</g>
<!-- moe_input_l15_dp1 -->
<g id="node795" class="node">
<title>moe_input_l15_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="239449" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="239449" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L15</text>
<text text-anchor="middle" x="239449" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="239449" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l15_dp1&#45;&gt;moe_input_l15_dp1 -->
<g id="edge1335" class="edge">
<title>allreduce_l15_dp1&#45;&gt;moe_input_l15_dp1</title>
<path fill="none" stroke="black" d="M239245.01,-135.98C239253.23,-135.98 239261.44,-135.98 239269.66,-135.98"/>
<polygon fill="black" stroke="black" points="239269.68,-139.48 239279.68,-135.98 239269.68,-132.48 239269.68,-139.48"/>
</g>
<!-- router_l15_dp1 -->
<g id="node796" class="node">
<title>router_l15_dp1</title>
<polygon fill="lightyellow" stroke="black" points="240148.57,-176.98 239754.74,-176.98 239653.43,-94.98 240047.26,-94.98 240148.57,-176.98"/>
<text text-anchor="middle" x="239901" y="-144.48" font-family="Arial" font-size="10.00">Router L15</text>
<text text-anchor="middle" x="239901" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="239901" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l15_dp1&#45;&gt;router_l15_dp1 -->
<g id="edge1336" class="edge">
<title>moe_input_l15_dp1&#45;&gt;router_l15_dp1</title>
<path fill="none" stroke="black" d="M239618.06,-135.98C239643.34,-135.98 239668.63,-135.98 239693.92,-135.98"/>
<polygon fill="black" stroke="black" points="239693.99,-139.48 239703.99,-135.98 239693.99,-132.48 239693.99,-139.48"/>
</g>
<!-- expert0_l15_dp1 -->
<g id="node797" class="node">
<title>expert0_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="244346.5,-161.98 244117.5,-161.98 244117.5,-109.98 244346.5,-109.98 244346.5,-161.98"/>
<text text-anchor="middle" x="244232" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L15</text>
<text text-anchor="middle" x="244232" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="244232" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="244232" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert0_l15_dp1 -->
<g id="edge1337" class="edge">
<title>router_l15_dp1&#45;&gt;expert0_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240132.05,-163.45C240187.32,-168.97 240246.19,-173.99 240301,-176.98 241019.61,-216.16 242819.82,-196.54 243539.5,-198.98 243792.35,-199.84 243859.25,-222.4 244108,-176.98 244123.37,-174.18 244139.45,-169.91 244154.74,-165.17"/>
<polygon fill="black" stroke="black" points="244156.2,-168.38 244164.66,-162 244154.07,-161.71 244156.2,-168.38"/>
<text text-anchor="middle" x="243561" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l15_dp1 -->
<g id="node798" class="node">
<title>expert1_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="244099.5,-161.98 243870.5,-161.98 243870.5,-109.98 244099.5,-109.98 244099.5,-161.98"/>
<text text-anchor="middle" x="243985" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L15</text>
<text text-anchor="middle" x="243985" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="243985" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="243985" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert1_l15_dp1 -->
<g id="edge1338" class="edge">
<title>router_l15_dp1&#45;&gt;expert1_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240131.79,-163.37C240187.14,-168.9 240246.11,-173.95 240301,-176.98 240903.77,-210.28 242413.86,-206.85 243017.5,-198.98 243204.99,-196.54 243676.28,-209.21 243861,-176.98 243876.72,-174.24 243893.17,-169.91 243908.76,-165.06"/>
<polygon fill="black" stroke="black" points="243909.89,-168.38 243918.35,-161.99 243907.75,-161.71 243909.89,-168.38"/>
<text text-anchor="middle" x="242996" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l15_dp1 -->
<g id="node799" class="node">
<title>expert2_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="243852.5,-161.98 243623.5,-161.98 243623.5,-109.98 243852.5,-109.98 243852.5,-161.98"/>
<text text-anchor="middle" x="243738" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L15</text>
<text text-anchor="middle" x="243738" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="243738" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="243738" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert2_l15_dp1 -->
<g id="edge1339" class="edge">
<title>router_l15_dp1&#45;&gt;expert2_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240046.67,-176.99C240085.3,-186.08 240127.21,-194.39 240166.5,-198.98 240185.48,-201.2 240190.39,-199.04 240209.5,-198.98 240398.64,-198.37 243427.36,-207.66 243614,-176.98 243629.93,-174.36 243646.6,-170.03 243662.35,-165.14"/>
<polygon fill="black" stroke="black" points="243663.58,-168.42 243672.03,-162.03 243661.44,-161.75 243663.58,-168.42"/>
<text text-anchor="middle" x="240188" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l15_dp1 -->
<g id="node800" class="node">
<title>expert3_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="243605.5,-161.98 243376.5,-161.98 243376.5,-109.98 243605.5,-109.98 243605.5,-161.98"/>
<text text-anchor="middle" x="243491" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L15</text>
<text text-anchor="middle" x="243491" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="243491" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="243491" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert3_l15_dp1 -->
<g id="edge1340" class="edge">
<title>router_l15_dp1&#45;&gt;expert3_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240073.37,-177C240118.98,-186.1 240168.37,-194.39 240214.5,-198.98 240233.52,-200.87 240238.39,-199.05 240257.5,-198.98 240603.01,-197.76 243026.08,-233.12 243367,-176.98 243382.93,-174.36 243399.6,-170.02 243415.35,-165.13"/>
<polygon fill="black" stroke="black" points="243416.58,-168.41 243425.03,-162.02 243414.44,-161.75 243416.58,-168.41"/>
<text text-anchor="middle" x="240236" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l15_dp1 -->
<g id="node801" class="node">
<title>expert4_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="243358.5,-161.98 243129.5,-161.98 243129.5,-109.98 243358.5,-109.98 243358.5,-161.98"/>
<text text-anchor="middle" x="243244" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L15</text>
<text text-anchor="middle" x="243244" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="243244" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="243244" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert4_l15_dp1 -->
<g id="edge1341" class="edge">
<title>router_l15_dp1&#45;&gt;expert4_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240100.02,-177C240152.62,-186.1 240209.5,-194.4 240262.5,-198.98 240281.54,-200.63 240286.39,-199.06 240305.5,-198.98 240618.23,-197.76 242811.44,-227.91 243120,-176.98 243135.93,-174.35 243152.6,-170.01 243168.35,-165.12"/>
<polygon fill="black" stroke="black" points="243169.58,-168.4 243178.03,-162.01 243167.44,-161.74 243169.58,-168.4"/>
<text text-anchor="middle" x="240284" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l15_dp1 -->
<g id="node802" class="node">
<title>expert5_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="243111.5,-161.98 242882.5,-161.98 242882.5,-109.98 243111.5,-109.98 243111.5,-161.98"/>
<text text-anchor="middle" x="242997" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L15</text>
<text text-anchor="middle" x="242997" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="242997" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="242997" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert5_l15_dp1 -->
<g id="edge1342" class="edge">
<title>router_l15_dp1&#45;&gt;expert5_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240131.54,-163.18C240186.96,-168.73 240246.03,-173.83 240301,-176.98 240707.81,-200.28 241727.07,-205.05 242134.5,-198.98 242462.83,-194.09 242549.62,-234.01 242873,-176.98 242888.62,-174.23 242904.97,-169.91 242920.48,-165.1"/>
<polygon fill="black" stroke="black" points="242921.56,-168.43 242930.01,-162.05 242919.42,-161.77 242921.56,-168.43"/>
<text text-anchor="middle" x="242113" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l15_dp1 -->
<g id="node803" class="node">
<title>expert6_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="242864.5,-161.98 242635.5,-161.98 242635.5,-109.98 242864.5,-109.98 242864.5,-161.98"/>
<text text-anchor="middle" x="242750" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L15</text>
<text text-anchor="middle" x="242750" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="242750" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="242750" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert6_l15_dp1 -->
<g id="edge1343" class="edge">
<title>router_l15_dp1&#45;&gt;expert6_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240126.65,-177.01C240186.23,-186.11 240250.61,-194.4 240310.5,-198.98 240329.55,-200.44 240334.39,-199.08 240353.5,-198.98 240606.01,-197.76 242376.9,-218.34 242626,-176.98 242641.93,-174.34 242658.59,-169.99 242674.35,-165.1"/>
<polygon fill="black" stroke="black" points="242675.58,-168.38 242684.03,-161.99 242673.44,-161.71 242675.58,-168.38"/>
<text text-anchor="middle" x="240332" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l15_dp1 -->
<g id="node804" class="node">
<title>expert7_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="242617.5,-161.98 242388.5,-161.98 242388.5,-109.98 242617.5,-109.98 242617.5,-161.98"/>
<text text-anchor="middle" x="242503" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L15</text>
<text text-anchor="middle" x="242503" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="242503" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="242503" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert7_l15_dp1 -->
<g id="edge1344" class="edge">
<title>router_l15_dp1&#45;&gt;expert7_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240147.89,-176.28C240215.94,-185.66 240289.91,-194.28 240358.5,-198.98 240377.56,-200.29 240382.39,-199.09 240401.5,-198.98 240621.23,-197.76 242162.26,-213.12 242379,-176.98 242394.83,-174.34 242411.4,-170.03 242427.07,-165.16"/>
<polygon fill="black" stroke="black" points="242428.25,-168.46 242436.7,-162.07 242426.11,-161.8 242428.25,-168.46"/>
<text text-anchor="middle" x="240380" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l15_dp1 -->
<g id="node805" class="node">
<title>expert8_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="242370.5,-161.98 242141.5,-161.98 242141.5,-109.98 242370.5,-109.98 242370.5,-161.98"/>
<text text-anchor="middle" x="242256" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L15</text>
<text text-anchor="middle" x="242256" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="242256" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="242256" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert8_l15_dp1 -->
<g id="edge1345" class="edge">
<title>router_l15_dp1&#45;&gt;expert8_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240143.08,-172.34C240226.36,-183.2 240320.33,-193.63 240406.5,-198.98 240597.87,-210.86 241942.9,-208.7 242132,-176.98 242147.83,-174.33 242164.39,-170 242180.07,-165.14"/>
<polygon fill="black" stroke="black" points="242181.24,-168.44 242189.7,-162.05 242179.11,-161.77 242181.24,-168.44"/>
<text text-anchor="middle" x="240428" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l15_dp1 -->
<g id="node806" class="node">
<title>expert9_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="242123.5,-161.98 241894.5,-161.98 241894.5,-109.98 242123.5,-109.98 242123.5,-161.98"/>
<text text-anchor="middle" x="242009" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L15</text>
<text text-anchor="middle" x="242009" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="242009" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="242009" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert9_l15_dp1 -->
<g id="edge1346" class="edge">
<title>router_l15_dp1&#45;&gt;expert9_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240131.03,-162.76C240186.61,-168.34 240245.87,-173.56 240301,-176.98 240769.31,-206.02 240887.39,-208.74 241356.5,-198.98 241591.54,-194.09 241653.72,-219.18 241885,-176.98 241900.37,-174.18 241916.45,-169.91 241931.74,-165.18"/>
<polygon fill="black" stroke="black" points="241933.2,-168.38 241941.66,-162.01 241931.07,-161.72 241933.2,-168.38"/>
<text text-anchor="middle" x="241335" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l15_dp1 -->
<g id="node807" class="node">
<title>expert10_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="241876.5,-161.98 241647.5,-161.98 241647.5,-109.98 241876.5,-109.98 241876.5,-161.98"/>
<text text-anchor="middle" x="241762" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L15</text>
<text text-anchor="middle" x="241762" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="241762" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="241762" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert10_l15_dp1 -->
<g id="edge1347" class="edge">
<title>router_l15_dp1&#45;&gt;expert10_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240138.88,-169.04C240236.47,-181.04 240350.7,-193.09 240454.5,-198.98 240585.81,-206.43 241508.36,-199.14 241638,-176.98 241653.73,-174.29 241670.19,-169.98 241685.78,-165.15"/>
<polygon fill="black" stroke="black" points="241686.9,-168.46 241695.36,-162.08 241684.77,-161.79 241686.9,-168.46"/>
<text text-anchor="middle" x="240476" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l15_dp1 -->
<g id="node808" class="node">
<title>expert11_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="241629.5,-161.98 241400.5,-161.98 241400.5,-109.98 241629.5,-109.98 241629.5,-161.98"/>
<text text-anchor="middle" x="241515" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L15</text>
<text text-anchor="middle" x="241515" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="241515" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="241515" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert11_l15_dp1 -->
<g id="edge1348" class="edge">
<title>router_l15_dp1&#45;&gt;expert11_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240135.51,-166.28C240246.54,-179.16 240381.13,-192.64 240502.5,-198.98 240699.73,-209.28 241196.43,-210.92 241391,-176.98 241406.72,-174.24 241423.17,-169.91 241438.76,-165.06"/>
<polygon fill="black" stroke="black" points="241439.89,-168.38 241448.35,-161.99 241437.75,-161.71 241439.89,-168.38"/>
<text text-anchor="middle" x="240524" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l15_dp1 -->
<g id="node809" class="node">
<title>expert12_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="241382.5,-161.98 241153.5,-161.98 241153.5,-109.98 241382.5,-109.98 241382.5,-161.98"/>
<text text-anchor="middle" x="241268" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L15</text>
<text text-anchor="middle" x="241268" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="241268" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="241268" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert12_l15_dp1 -->
<g id="edge1349" class="edge">
<title>router_l15_dp1&#45;&gt;expert12_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240127.29,-159.74C240184,-165.54 240244.71,-171.62 240301,-176.98 240301,-176.98 241144,-176.98 241144,-176.98 241159.37,-174.19 241175.45,-169.93 241190.75,-165.2"/>
<polygon fill="black" stroke="black" points="241192.21,-168.41 241200.67,-162.03 241190.08,-161.74 241192.21,-168.41"/>
<text text-anchor="middle" x="240572" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l15_dp1 -->
<g id="node810" class="node">
<title>expert13_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="241135.5,-161.98 240906.5,-161.98 240906.5,-109.98 241135.5,-109.98 241135.5,-161.98"/>
<text text-anchor="middle" x="241021" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L15</text>
<text text-anchor="middle" x="241021" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="241021" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="241021" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert13_l15_dp1 -->
<g id="edge1350" class="edge">
<title>router_l15_dp1&#45;&gt;expert13_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240147.61,-176.06C240325.88,-199.52 240572.36,-220.67 240788.5,-198.98 240839.66,-193.85 240895.31,-179.11 240939.33,-165.18"/>
<polygon fill="black" stroke="black" points="240940.66,-168.43 240949.11,-162.04 240938.52,-161.77 240940.66,-168.43"/>
<text text-anchor="middle" x="240767" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l15_dp1 -->
<g id="node811" class="node">
<title>expert14_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="240888.5,-161.98 240659.5,-161.98 240659.5,-109.98 240888.5,-109.98 240888.5,-161.98"/>
<text text-anchor="middle" x="240774" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L15</text>
<text text-anchor="middle" x="240774" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="240774" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="240774" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert14_l15_dp1 -->
<g id="edge1351" class="edge">
<title>router_l15_dp1&#45;&gt;expert14_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240131.52,-163.01C240267.24,-177.37 240442.37,-193.22 240598.5,-198.98 240617.6,-199.69 240622.86,-203.19 240641.5,-198.98 240669.7,-192.62 240698.94,-179.52 240722.75,-166.9"/>
<polygon fill="black" stroke="black" points="240724.48,-169.94 240731.6,-162.1 240721.14,-163.79 240724.48,-169.94"/>
<text text-anchor="middle" x="240620" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l15_dp1 -->
<g id="node812" class="node">
<title>expert15_l15_dp1</title>
<polygon fill="lightgreen" stroke="black" points="240539.5,-161.98 240310.5,-161.98 240310.5,-109.98 240539.5,-109.98 240539.5,-161.98"/>
<text text-anchor="middle" x="240425" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L15</text>
<text text-anchor="middle" x="240425" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="240425" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="240425" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp1&#45;&gt;expert15_l15_dp1 -->
<g id="edge1352" class="edge">
<title>router_l15_dp1&#45;&gt;expert15_l15_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240097.98,-135.98C240165.75,-135.98 240239.72,-135.98 240300.14,-135.98"/>
<polygon fill="black" stroke="black" points="240300.49,-139.48 240310.49,-135.98 240300.49,-132.48 240300.49,-139.48"/>
<text text-anchor="middle" x="240229.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l15_dp1 -->
<g id="node813" class="node">
<title>expert_agg_l15_dp1</title>
<polygon fill="lightyellow" stroke="black" points="244877.57,-176.98 244483.74,-176.98 244382.43,-94.98 244776.26,-94.98 244877.57,-176.98"/>
<text text-anchor="middle" x="244630" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L15</text>
<text text-anchor="middle" x="244630" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="244630" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1353" class="edge">
<title>expert0_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M244346.66,-135.98C244372.06,-135.98 244397.47,-135.98 244422.87,-135.98"/>
<polygon fill="black" stroke="black" points="244422.99,-139.48 244432.99,-135.98 244422.99,-132.48 244422.99,-139.48"/>
</g>
<!-- expert1_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1354" class="edge">
<title>expert1_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M244040.24,-162.02C244063.4,-171.57 244090.96,-181.22 244117,-185.98 244167.06,-195.15 244295.3,-190.41 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert2_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1355" class="edge">
<title>expert2_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M243793.24,-162.02C243816.4,-171.57 243843.96,-181.22 243870,-185.98 243922.02,-195.51 244293.31,-190.59 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert3_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1356" class="edge">
<title>expert3_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M243546.24,-162.02C243569.4,-171.57 243596.96,-181.22 243623,-185.98 243702.02,-200.45 244265.97,-192.97 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert4_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1357" class="edge">
<title>expert4_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M243299.24,-162.02C243322.4,-171.57 243349.96,-181.22 243376,-185.98 243429.01,-195.69 244292.31,-190.67 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert5_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1358" class="edge">
<title>expert5_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M243052.24,-162.02C243075.4,-171.57 243102.96,-181.22 243129,-185.98 243195.5,-198.16 244278.64,-191.87 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert6_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1359" class="edge">
<title>expert6_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M242805.24,-162.02C242828.4,-171.57 242855.96,-181.22 242882,-185.98 242962,-200.63 244264.97,-193.06 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert7_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1360" class="edge">
<title>expert7_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M242558.24,-162.02C242581.4,-171.57 242608.96,-181.22 242635,-185.98 242681.75,-194.54 244298.65,-190.12 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert8_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1361" class="edge">
<title>expert8_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M242311.24,-162.02C242334.4,-171.57 242361.96,-181.22 242388,-185.98 242441.5,-195.78 244291.82,-190.72 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert9_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1362" class="edge">
<title>expert9_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M242064.24,-162.02C242087.4,-171.57 242114.96,-181.22 242141,-185.98 242201.25,-197.01 244284.98,-191.31 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert10_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1363" class="edge">
<title>expert10_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M241817.24,-162.02C241840.4,-171.57 241867.96,-181.22 241894,-185.98 241961,-198.25 244278.15,-191.91 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert11_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1364" class="edge">
<title>expert11_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M241570.24,-162.02C241593.4,-171.57 241620.96,-181.22 241647,-185.98 241720.75,-199.48 244271.31,-192.51 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert12_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1365" class="edge">
<title>expert12_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M241323.24,-162.02C241346.4,-171.57 241373.96,-181.22 241400,-185.98 241480.49,-200.72 244264.48,-193.1 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert13_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1366" class="edge">
<title>expert13_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M241076.24,-162.02C241099.4,-171.57 241126.96,-181.22 241153,-185.98 241196.62,-193.97 244301.82,-189.84 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert14_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1367" class="edge">
<title>expert14_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M240829.24,-162.02C240852.4,-171.57 240879.96,-181.22 240906,-185.98 240953,-194.59 244298.4,-190.14 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- expert15_l15_dp1&#45;&gt;expert_agg_l15_dp1 -->
<g id="edge1368" class="edge">
<title>expert15_l15_dp1&#45;&gt;expert_agg_l15_dp1</title>
<path fill="none" stroke="black" d="M240524.17,-162C240565.54,-171.59 240614.28,-181.26 240659,-185.98 240760.85,-196.74 244243.97,-194.9 244346,-185.98 244384.11,-182.65 244424.78,-176.86 244463.08,-170.36"/>
<polygon fill="black" stroke="black" points="244464.02,-173.75 244473.29,-168.6 244462.84,-166.85 244464.02,-173.75"/>
</g>
<!-- layer15_output_dp1 -->
<g id="node814" class="node">
<title>layer15_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="245082" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="245082" y="-144.48" font-family="Arial" font-size="10.00">Layer 15 Output</text>
<text text-anchor="middle" x="245082" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="245082" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l15_dp1&#45;&gt;layer15_output_dp1 -->
<g id="edge1369" class="edge">
<title>expert_agg_l15_dp1&#45;&gt;layer15_output_dp1</title>
<path fill="none" stroke="black" d="M244827.31,-135.98C244852.49,-135.98 244877.66,-135.98 244902.84,-135.98"/>
<polygon fill="black" stroke="black" points="244902.87,-139.48 244912.87,-135.98 244902.87,-132.48 244902.87,-139.48"/>
</g>
<!-- attn_input_l16_dp1 -->
<g id="node815" class="node">
<title>attn_input_l16_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="245455" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="245455" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L16</text>
<text text-anchor="middle" x="245455" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="245455" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer15_output_dp1&#45;&gt;attn_input_l16_dp1 -->
<g id="edge1370" class="edge">
<title>layer15_output_dp1&#45;&gt;attn_input_l16_dp1</title>
<path fill="none" stroke="black" d="M245251.01,-135.98C245259.23,-135.98 245267.44,-135.98 245275.66,-135.98"/>
<polygon fill="black" stroke="black" points="245275.68,-139.48 245285.68,-135.98 245275.68,-132.48 245275.68,-139.48"/>
</g>
<!-- attn_tp0_l16_dp1 -->
<g id="node816" class="node">
<title>attn_tp0_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="246753,-161.98 246493,-161.98 246493,-109.98 246753,-109.98 246753,-161.98"/>
<text text-anchor="middle" x="246623" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L16</text>
<text text-anchor="middle" x="246623" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="246623" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="246623" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp1&#45;&gt;attn_tp0_l16_dp1 -->
<g id="edge1371" class="edge">
<title>attn_input_l16_dp1&#45;&gt;attn_tp0_l16_dp1</title>
<path fill="none" stroke="black" d="M245538.52,-161.26C245575.12,-171.09 245618.81,-181.13 245659,-185.98 245704,-191.42 246430.27,-193.33 246475,-185.98 246500.4,-181.81 246527.31,-173.85 246551.12,-165.5"/>
<polygon fill="black" stroke="black" points="246552.55,-168.71 246560.78,-162.03 246550.18,-162.12 246552.55,-168.71"/>
</g>
<!-- attn_tp1_l16_dp1 -->
<g id="node817" class="node">
<title>attn_tp1_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="246475,-161.98 246215,-161.98 246215,-109.98 246475,-109.98 246475,-161.98"/>
<text text-anchor="middle" x="246345" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L16</text>
<text text-anchor="middle" x="246345" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="246345" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="246345" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp1&#45;&gt;attn_tp1_l16_dp1 -->
<g id="edge1372" class="edge">
<title>attn_input_l16_dp1&#45;&gt;attn_tp1_l16_dp1</title>
<path fill="none" stroke="black" d="M245538.52,-161.26C245575.12,-171.09 245618.81,-181.13 245659,-185.98 245718.35,-193.15 246138.01,-195.68 246197,-185.98 246222.4,-181.81 246249.31,-173.85 246273.12,-165.5"/>
<polygon fill="black" stroke="black" points="246274.55,-168.71 246282.78,-162.03 246272.18,-162.12 246274.55,-168.71"/>
</g>
<!-- attn_tp2_l16_dp1 -->
<g id="node818" class="node">
<title>attn_tp2_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="246197,-161.98 245937,-161.98 245937,-109.98 246197,-109.98 246197,-161.98"/>
<text text-anchor="middle" x="246067" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L16</text>
<text text-anchor="middle" x="246067" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="246067" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="246067" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp1&#45;&gt;attn_tp2_l16_dp1 -->
<g id="edge1373" class="edge">
<title>attn_input_l16_dp1&#45;&gt;attn_tp2_l16_dp1</title>
<path fill="none" stroke="black" d="M245538.52,-161.26C245575.12,-171.09 245618.81,-181.13 245659,-185.98 245716.36,-192.91 245861.99,-195.35 245919,-185.98 245944.4,-181.81 245971.31,-173.85 245995.12,-165.5"/>
<polygon fill="black" stroke="black" points="245996.55,-168.71 246004.78,-162.03 245994.18,-162.12 245996.55,-168.71"/>
</g>
<!-- attn_tp3_l16_dp1 -->
<g id="node819" class="node">
<title>attn_tp3_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="245919,-161.98 245659,-161.98 245659,-109.98 245919,-109.98 245919,-161.98"/>
<text text-anchor="middle" x="245789" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L16</text>
<text text-anchor="middle" x="245789" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="245789" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="245789" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp1&#45;&gt;attn_tp3_l16_dp1 -->
<g id="edge1374" class="edge">
<title>attn_input_l16_dp1&#45;&gt;attn_tp3_l16_dp1</title>
<path fill="none" stroke="black" d="M245624.28,-135.98C245632.35,-135.98 245640.42,-135.98 245648.49,-135.98"/>
<polygon fill="black" stroke="black" points="245648.7,-139.48 245658.7,-135.98 245648.7,-132.48 245648.7,-139.48"/>
</g>
<!-- allreduce_l16_dp1 -->
<g id="node820" class="node">
<title>allreduce_l16_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="246957" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="246957" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L16</text>
<text text-anchor="middle" x="246957" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="246957" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l16_dp1&#45;&gt;allreduce_l16_dp1 -->
<g id="edge1375" class="edge">
<title>attn_tp0_l16_dp1&#45;&gt;allreduce_l16_dp1</title>
<path fill="none" stroke="black" d="M246753.14,-135.98C246761.35,-135.98 246769.56,-135.98 246777.77,-135.98"/>
<polygon fill="black" stroke="black" points="246777.78,-139.48 246787.78,-135.98 246777.78,-132.48 246777.78,-139.48"/>
</g>
<!-- attn_tp1_l16_dp1&#45;&gt;allreduce_l16_dp1 -->
<g id="edge1376" class="edge">
<title>attn_tp1_l16_dp1&#45;&gt;allreduce_l16_dp1</title>
<path fill="none" stroke="black" d="M246407.22,-162.03C246433.24,-171.59 246464.1,-181.23 246493,-185.98 246550.01,-195.35 246695.64,-192.91 246753,-185.98 246789.57,-181.57 246829.05,-172.85 246863.44,-163.91"/>
<polygon fill="black" stroke="black" points="246864.7,-167.2 246873.47,-161.26 246862.91,-160.43 246864.7,-167.2"/>
</g>
<!-- attn_tp2_l16_dp1&#45;&gt;allreduce_l16_dp1 -->
<g id="edge1377" class="edge">
<title>attn_tp2_l16_dp1&#45;&gt;allreduce_l16_dp1</title>
<path fill="none" stroke="black" d="M246129.22,-162.03C246155.24,-171.59 246186.1,-181.23 246215,-185.98 246273.98,-195.68 246693.65,-193.15 246753,-185.98 246789.57,-181.57 246829.05,-172.85 246863.44,-163.91"/>
<polygon fill="black" stroke="black" points="246864.7,-167.2 246873.47,-161.26 246862.91,-160.43 246864.7,-167.2"/>
</g>
<!-- attn_tp3_l16_dp1&#45;&gt;allreduce_l16_dp1 -->
<g id="edge1378" class="edge">
<title>attn_tp3_l16_dp1&#45;&gt;allreduce_l16_dp1</title>
<path fill="none" stroke="black" d="M245851.22,-162.03C245877.24,-171.59 245908.1,-181.23 245937,-185.98 245981.73,-193.33 246707.99,-191.42 246753,-185.98 246789.57,-181.57 246829.05,-172.85 246863.44,-163.91"/>
<polygon fill="black" stroke="black" points="246864.7,-167.2 246873.47,-161.26 246862.91,-160.43 246864.7,-167.2"/>
</g>
<!-- moe_input_l16_dp1 -->
<g id="node821" class="node">
<title>moe_input_l16_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="247330" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="247330" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L16</text>
<text text-anchor="middle" x="247330" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="247330" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l16_dp1&#45;&gt;moe_input_l16_dp1 -->
<g id="edge1379" class="edge">
<title>allreduce_l16_dp1&#45;&gt;moe_input_l16_dp1</title>
<path fill="none" stroke="black" d="M247126.01,-135.98C247134.23,-135.98 247142.44,-135.98 247150.66,-135.98"/>
<polygon fill="black" stroke="black" points="247150.68,-139.48 247160.68,-135.98 247150.68,-132.48 247150.68,-139.48"/>
</g>
<!-- router_l16_dp1 -->
<g id="node822" class="node">
<title>router_l16_dp1</title>
<polygon fill="lightyellow" stroke="black" points="248029.57,-176.98 247635.74,-176.98 247534.43,-94.98 247928.26,-94.98 248029.57,-176.98"/>
<text text-anchor="middle" x="247782" y="-144.48" font-family="Arial" font-size="10.00">Router L16</text>
<text text-anchor="middle" x="247782" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="247782" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l16_dp1&#45;&gt;router_l16_dp1 -->
<g id="edge1380" class="edge">
<title>moe_input_l16_dp1&#45;&gt;router_l16_dp1</title>
<path fill="none" stroke="black" d="M247499.06,-135.98C247524.34,-135.98 247549.63,-135.98 247574.92,-135.98"/>
<polygon fill="black" stroke="black" points="247574.99,-139.48 247584.99,-135.98 247574.99,-132.48 247574.99,-139.48"/>
</g>
<!-- expert0_l16_dp1 -->
<g id="node823" class="node">
<title>expert0_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="252275.5,-161.98 252046.5,-161.98 252046.5,-109.98 252275.5,-109.98 252275.5,-161.98"/>
<text text-anchor="middle" x="252161" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L16</text>
<text text-anchor="middle" x="252161" y="-138.98" font-family="Arial" font-size="10.00">GPU 48</text>
<text text-anchor="middle" x="252161" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="252161" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert0_l16_dp1 -->
<g id="edge1381" class="edge">
<title>router_l16_dp1&#45;&gt;expert0_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248011.12,-161.92C248074.19,-168.02 248142.67,-173.71 248206,-176.98 248903.86,-213.09 250651.71,-196.54 251350.5,-198.98 251655.76,-200.05 251736.49,-230.66 252037,-176.98 252052.62,-174.19 252068.96,-169.86 252084.47,-165.05"/>
<polygon fill="black" stroke="black" points="252085.55,-168.38 252094,-161.99 252083.41,-161.71 252085.55,-168.38"/>
<text text-anchor="middle" x="251372" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l16_dp1 -->
<g id="node824" class="node">
<title>expert1_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="252028.5,-161.98 251799.5,-161.98 251799.5,-109.98 252028.5,-109.98 252028.5,-161.98"/>
<text text-anchor="middle" x="251914" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L16</text>
<text text-anchor="middle" x="251914" y="-138.98" font-family="Arial" font-size="10.00">GPU 49</text>
<text text-anchor="middle" x="251914" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="251914" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert1_l16_dp1 -->
<g id="edge1382" class="edge">
<title>router_l16_dp1&#45;&gt;expert1_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M247927.67,-176.99C247966.3,-186.08 248008.21,-194.39 248047.5,-198.98 248066.48,-201.2 248071.39,-199.04 248090.5,-198.98 248296.03,-198.37 251587.18,-210.26 251790,-176.98 251805.93,-174.37 251822.6,-170.03 251838.36,-165.14"/>
<polygon fill="black" stroke="black" points="251839.58,-168.42 251848.03,-162.03 251837.44,-161.76 251839.58,-168.42"/>
<text text-anchor="middle" x="248069" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l16_dp1 -->
<g id="node825" class="node">
<title>expert2_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="251781.5,-161.98 251552.5,-161.98 251552.5,-109.98 251781.5,-109.98 251781.5,-161.98"/>
<text text-anchor="middle" x="251667" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L16</text>
<text text-anchor="middle" x="251667" y="-138.98" font-family="Arial" font-size="10.00">GPU 50</text>
<text text-anchor="middle" x="251667" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="251667" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert2_l16_dp1 -->
<g id="edge1383" class="edge">
<title>router_l16_dp1&#45;&gt;expert2_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248010.85,-161.81C248074,-167.93 248142.58,-173.64 248206,-176.98 248762.03,-206.29 250154.75,-206.35 250711.5,-198.98 250896.32,-196.54 251360.91,-208.78 251543,-176.98 251558.72,-174.24 251575.17,-169.9 251590.76,-165.06"/>
<polygon fill="black" stroke="black" points="251591.89,-168.37 251600.34,-161.99 251589.75,-161.71 251591.89,-168.37"/>
<text text-anchor="middle" x="250690" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l16_dp1 -->
<g id="node826" class="node">
<title>expert3_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="251534.5,-161.98 251305.5,-161.98 251305.5,-109.98 251534.5,-109.98 251534.5,-161.98"/>
<text text-anchor="middle" x="251420" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L16</text>
<text text-anchor="middle" x="251420" y="-138.98" font-family="Arial" font-size="10.00">GPU 51</text>
<text text-anchor="middle" x="251420" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="251420" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert3_l16_dp1 -->
<g id="edge1384" class="edge">
<title>router_l16_dp1&#45;&gt;expert3_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M247954.37,-177C247999.98,-186.1 248049.37,-194.39 248095.5,-198.98 248114.52,-200.87 248119.39,-199.05 248138.5,-198.98 248489.34,-197.76 250949.82,-233.97 251296,-176.98 251311.93,-174.36 251328.6,-170.02 251344.35,-165.13"/>
<polygon fill="black" stroke="black" points="251345.58,-168.41 251354.03,-162.02 251343.44,-161.75 251345.58,-168.41"/>
<text text-anchor="middle" x="248117" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l16_dp1 -->
<g id="node827" class="node">
<title>expert4_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="251287.5,-161.98 251058.5,-161.98 251058.5,-109.98 251287.5,-109.98 251287.5,-161.98"/>
<text text-anchor="middle" x="251173" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L16</text>
<text text-anchor="middle" x="251173" y="-138.98" font-family="Arial" font-size="10.00">GPU 52</text>
<text text-anchor="middle" x="251173" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="251173" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert4_l16_dp1 -->
<g id="edge1385" class="edge">
<title>router_l16_dp1&#45;&gt;expert4_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M247981.02,-177C248033.62,-186.1 248090.5,-194.4 248143.5,-198.98 248162.54,-200.63 248167.39,-199.06 248186.5,-198.98 248504.56,-197.76 250735.18,-228.76 251049,-176.98 251064.93,-174.35 251081.6,-170.01 251097.35,-165.12"/>
<polygon fill="black" stroke="black" points="251098.58,-168.4 251107.03,-162.01 251096.44,-161.74 251098.58,-168.4"/>
<text text-anchor="middle" x="248165" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l16_dp1 -->
<g id="node828" class="node">
<title>expert5_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="251040.5,-161.98 250811.5,-161.98 250811.5,-109.98 251040.5,-109.98 251040.5,-161.98"/>
<text text-anchor="middle" x="250926" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L16</text>
<text text-anchor="middle" x="250926" y="-138.98" font-family="Arial" font-size="10.00">GPU 53</text>
<text text-anchor="middle" x="250926" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="250926" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert5_l16_dp1 -->
<g id="edge1386" class="edge">
<title>router_l16_dp1&#45;&gt;expert5_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248007.65,-177.01C248067.23,-186.11 248131.61,-194.4 248191.5,-198.98 248210.55,-200.44 248215.39,-199.06 248234.5,-198.98 248519.78,-197.76 250520.54,-223.55 250802,-176.98 250817.93,-174.35 250834.59,-170 250850.35,-165.11"/>
<polygon fill="black" stroke="black" points="250851.58,-168.39 250860.03,-162 250849.44,-161.73 250851.58,-168.39"/>
<text text-anchor="middle" x="248213" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l16_dp1 -->
<g id="node829" class="node">
<title>expert6_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="250793.5,-161.98 250564.5,-161.98 250564.5,-109.98 250793.5,-109.98 250793.5,-161.98"/>
<text text-anchor="middle" x="250679" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L16</text>
<text text-anchor="middle" x="250679" y="-138.98" font-family="Arial" font-size="10.00">GPU 54</text>
<text text-anchor="middle" x="250679" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="250679" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert6_l16_dp1 -->
<g id="edge1387" class="edge">
<title>router_l16_dp1&#45;&gt;expert6_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248010.59,-161.58C248073.81,-167.7 248142.49,-173.48 248206,-176.98 248931.85,-217.02 249114.63,-210.19 249841.5,-198.98 250158.72,-194.09 250242.59,-232.24 250555,-176.98 250570.62,-174.22 250586.97,-169.9 250602.48,-165.09"/>
<polygon fill="black" stroke="black" points="250603.55,-168.42 250612.01,-162.04 250601.42,-161.75 250603.55,-168.42"/>
<text text-anchor="middle" x="249820" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l16_dp1 -->
<g id="node830" class="node">
<title>expert7_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="250546.5,-161.98 250317.5,-161.98 250317.5,-109.98 250546.5,-109.98 250546.5,-161.98"/>
<text text-anchor="middle" x="250432" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L16</text>
<text text-anchor="middle" x="250432" y="-138.98" font-family="Arial" font-size="10.00">GPU 55</text>
<text text-anchor="middle" x="250432" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="250432" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert7_l16_dp1 -->
<g id="edge1388" class="edge">
<title>router_l16_dp1&#45;&gt;expert7_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248028.89,-176.28C248096.94,-185.66 248170.91,-194.28 248239.5,-198.98 248258.56,-200.29 248263.39,-199.09 248282.5,-198.98 248507.56,-197.76 250085.99,-213.97 250308,-176.98 250323.83,-174.34 250340.4,-170.03 250356.07,-165.17"/>
<polygon fill="black" stroke="black" points="250357.25,-168.46 250365.7,-162.08 250355.11,-161.8 250357.25,-168.46"/>
<text text-anchor="middle" x="248261" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l16_dp1 -->
<g id="node831" class="node">
<title>expert8_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="250299.5,-161.98 250070.5,-161.98 250070.5,-109.98 250299.5,-109.98 250299.5,-161.98"/>
<text text-anchor="middle" x="250185" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L16</text>
<text text-anchor="middle" x="250185" y="-138.98" font-family="Arial" font-size="10.00">GPU 56</text>
<text text-anchor="middle" x="250185" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="250185" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert8_l16_dp1 -->
<g id="edge1389" class="edge">
<title>router_l16_dp1&#45;&gt;expert8_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248024.08,-172.34C248107.36,-183.2 248201.33,-193.63 248287.5,-198.98 248484.19,-211.19 249866.64,-209.55 250061,-176.98 250076.83,-174.33 250093.39,-170.01 250109.07,-165.14"/>
<polygon fill="black" stroke="black" points="250110.24,-168.44 250118.7,-162.05 250108.11,-161.78 250110.24,-168.44"/>
<text text-anchor="middle" x="248309" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l16_dp1 -->
<g id="node832" class="node">
<title>expert9_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="250052.5,-161.98 249823.5,-161.98 249823.5,-109.98 250052.5,-109.98 250052.5,-161.98"/>
<text text-anchor="middle" x="249938" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L16</text>
<text text-anchor="middle" x="249938" y="-138.98" font-family="Arial" font-size="10.00">GPU 57</text>
<text text-anchor="middle" x="249938" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="249938" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert9_l16_dp1 -->
<g id="edge1390" class="edge">
<title>router_l16_dp1&#45;&gt;expert9_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248019.88,-169.04C248117.47,-181.04 248231.7,-193.09 248335.5,-198.98 248499.53,-208.29 249652,-204.35 249814,-176.98 249829.83,-174.31 249846.39,-169.98 249862.06,-165.11"/>
<polygon fill="black" stroke="black" points="249863.24,-168.41 249871.69,-162.02 249861.1,-161.74 249863.24,-168.41"/>
<text text-anchor="middle" x="248357" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l16_dp1 -->
<g id="node833" class="node">
<title>expert10_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="249805.5,-161.98 249576.5,-161.98 249576.5,-109.98 249805.5,-109.98 249805.5,-161.98"/>
<text text-anchor="middle" x="249691" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L16</text>
<text text-anchor="middle" x="249691" y="-138.98" font-family="Arial" font-size="10.00">GPU 58</text>
<text text-anchor="middle" x="249691" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="249691" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert10_l16_dp1 -->
<g id="edge1391" class="edge">
<title>router_l16_dp1&#45;&gt;expert10_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248010.06,-161C248073.44,-167.15 248142.33,-173.08 248206,-176.98 248597.61,-201.02 248696.26,-208 249088.5,-198.98 249301.33,-194.09 249357.65,-215.65 249567,-176.98 249582.27,-174.16 249598.25,-169.92 249613.46,-165.21"/>
<polygon fill="black" stroke="black" points="249614.87,-168.43 249623.33,-162.06 249612.74,-161.76 249614.87,-168.43"/>
<text text-anchor="middle" x="249067" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l16_dp1 -->
<g id="node834" class="node">
<title>expert11_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="249558.5,-161.98 249329.5,-161.98 249329.5,-109.98 249558.5,-109.98 249558.5,-161.98"/>
<text text-anchor="middle" x="249444" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L16</text>
<text text-anchor="middle" x="249444" y="-138.98" font-family="Arial" font-size="10.00">GPU 59</text>
<text text-anchor="middle" x="249444" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="249444" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert11_l16_dp1 -->
<g id="edge1392" class="edge">
<title>router_l16_dp1&#45;&gt;expert11_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248016.51,-166.28C248127.54,-179.16 248262.13,-192.64 248383.5,-198.98 248591.38,-209.84 249114.9,-212.61 249320,-176.98 249335.72,-174.25 249352.18,-169.92 249367.77,-165.08"/>
<polygon fill="black" stroke="black" points="249368.89,-168.39 249377.35,-162.01 249366.76,-161.73 249368.89,-168.39"/>
<text text-anchor="middle" x="248405" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l16_dp1 -->
<g id="node835" class="node">
<title>expert12_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="249311.5,-161.98 249082.5,-161.98 249082.5,-109.98 249311.5,-109.98 249311.5,-161.98"/>
<text text-anchor="middle" x="249197" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L16</text>
<text text-anchor="middle" x="249197" y="-138.98" font-family="Arial" font-size="10.00">GPU 60</text>
<text text-anchor="middle" x="249197" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="249197" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert12_l16_dp1 -->
<g id="edge1393" class="edge">
<title>router_l16_dp1&#45;&gt;expert12_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248013.44,-163.92C248137.26,-177.47 248292.46,-192.26 248431.5,-198.98 248573.97,-205.88 248932.61,-202.24 249073,-176.98 249088.38,-174.22 249104.46,-169.97 249119.75,-165.24"/>
<polygon fill="black" stroke="black" points="249121.21,-168.44 249129.67,-162.07 249119.08,-161.78 249121.21,-168.44"/>
<text text-anchor="middle" x="248453" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l16_dp1 -->
<g id="node836" class="node">
<title>expert13_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="249064.5,-161.98 248835.5,-161.98 248835.5,-109.98 249064.5,-109.98 249064.5,-161.98"/>
<text text-anchor="middle" x="248950" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L16</text>
<text text-anchor="middle" x="248950" y="-138.98" font-family="Arial" font-size="10.00">GPU 61</text>
<text text-anchor="middle" x="248950" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="248950" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert13_l16_dp1 -->
<g id="edge1394" class="edge">
<title>router_l16_dp1&#45;&gt;expert13_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248022.38,-176.99C248235.6,-205.92 248554.44,-230.86 248826,-176.98 248840.96,-174.01 248856.62,-169.78 248871.58,-165.14"/>
<polygon fill="black" stroke="black" points="248872.83,-168.41 248881.29,-162.04 248870.7,-161.74 248872.83,-168.41"/>
<text text-anchor="middle" x="248501" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l16_dp1 -->
<g id="node837" class="node">
<title>expert14_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="248817.5,-161.98 248588.5,-161.98 248588.5,-109.98 248817.5,-109.98 248817.5,-161.98"/>
<text text-anchor="middle" x="248703" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L16</text>
<text text-anchor="middle" x="248703" y="-138.98" font-family="Arial" font-size="10.00">GPU 62</text>
<text text-anchor="middle" x="248703" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="248703" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert14_l16_dp1 -->
<g id="edge1395" class="edge">
<title>router_l16_dp1&#45;&gt;expert14_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M248010.45,-161.26C248157.81,-176.09 248353.71,-193.04 248527.5,-198.98 248546.6,-199.64 248551.86,-203.19 248570.5,-198.98 248598.7,-192.62 248627.94,-179.52 248651.75,-166.9"/>
<polygon fill="black" stroke="black" points="248653.48,-169.94 248660.6,-162.1 248650.14,-163.79 248653.48,-169.94"/>
<text text-anchor="middle" x="248549" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l16_dp1 -->
<g id="node838" class="node">
<title>expert15_l16_dp1</title>
<polygon fill="lightgreen" stroke="black" points="248444.5,-161.98 248215.5,-161.98 248215.5,-109.98 248444.5,-109.98 248444.5,-161.98"/>
<text text-anchor="middle" x="248330" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L16</text>
<text text-anchor="middle" x="248330" y="-138.98" font-family="Arial" font-size="10.00">GPU 63</text>
<text text-anchor="middle" x="248330" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="248330" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp1&#45;&gt;expert15_l16_dp1 -->
<g id="edge1396" class="edge">
<title>router_l16_dp1&#45;&gt;expert15_l16_dp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M247979.06,-135.98C248054.51,-135.98 248138.43,-135.98 248205.28,-135.98"/>
<polygon fill="black" stroke="black" points="248205.44,-139.48 248215.44,-135.98 248205.44,-132.48 248205.44,-139.48"/>
<text text-anchor="middle" x="248122.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l16_dp1 -->
<g id="node839" class="node">
<title>expert_agg_l16_dp1</title>
<polygon fill="lightyellow" stroke="black" points="252806.57,-176.98 252412.74,-176.98 252311.43,-94.98 252705.26,-94.98 252806.57,-176.98"/>
<text text-anchor="middle" x="252559" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L16</text>
<text text-anchor="middle" x="252559" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="252559" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1397" class="edge">
<title>expert0_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M252275.66,-135.98C252301.06,-135.98 252326.47,-135.98 252351.87,-135.98"/>
<polygon fill="black" stroke="black" points="252351.99,-139.48 252361.99,-135.98 252351.99,-132.48 252351.99,-139.48"/>
</g>
<!-- expert1_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1398" class="edge">
<title>expert1_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M251969.24,-162.02C251992.4,-171.57 252019.96,-181.22 252046,-185.98 252096.06,-195.15 252224.3,-190.41 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert2_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1399" class="edge">
<title>expert2_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M251722.24,-162.02C251745.4,-171.57 251772.96,-181.22 251799,-185.98 251851.02,-195.51 252222.31,-190.59 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert3_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1400" class="edge">
<title>expert3_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M251475.24,-162.02C251498.4,-171.57 251525.96,-181.22 251552,-185.98 251631.02,-200.45 252194.97,-192.97 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert4_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1401" class="edge">
<title>expert4_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M251228.24,-162.02C251251.4,-171.57 251278.96,-181.22 251305,-185.98 251358.01,-195.69 252221.31,-190.67 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert5_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1402" class="edge">
<title>expert5_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M250981.24,-162.02C251004.4,-171.57 251031.96,-181.22 251058,-185.98 251124.5,-198.16 252207.64,-191.87 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert6_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1403" class="edge">
<title>expert6_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M250734.24,-162.02C250757.4,-171.57 250784.96,-181.22 250811,-185.98 250891,-200.63 252193.97,-193.06 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert7_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1404" class="edge">
<title>expert7_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M250487.24,-162.02C250510.4,-171.57 250537.96,-181.22 250564,-185.98 250610.75,-194.54 252227.65,-190.12 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert8_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1405" class="edge">
<title>expert8_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M250240.24,-162.02C250263.4,-171.57 250290.96,-181.22 250317,-185.98 250370.5,-195.78 252220.82,-190.72 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert9_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1406" class="edge">
<title>expert9_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M249993.24,-162.02C250016.4,-171.57 250043.96,-181.22 250070,-185.98 250130.25,-197.01 252213.98,-191.31 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert10_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1407" class="edge">
<title>expert10_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M249746.24,-162.02C249769.4,-171.57 249796.96,-181.22 249823,-185.98 249890,-198.25 252207.15,-191.91 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert11_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1408" class="edge">
<title>expert11_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M249499.24,-162.02C249522.4,-171.57 249549.96,-181.22 249576,-185.98 249649.75,-199.48 252200.31,-192.51 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert12_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1409" class="edge">
<title>expert12_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M249252.24,-162.02C249275.4,-171.57 249302.96,-181.22 249329,-185.98 249409.49,-200.72 252193.48,-193.1 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert13_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1410" class="edge">
<title>expert13_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M249005.24,-162.02C249028.4,-171.57 249055.96,-181.22 249082,-185.98 249125.62,-193.97 252230.82,-189.84 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert14_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1411" class="edge">
<title>expert14_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M248758.24,-162.02C248781.4,-171.57 248808.96,-181.22 248835,-185.98 248882,-194.59 252227.4,-190.14 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- expert15_l16_dp1&#45;&gt;expert_agg_l16_dp1 -->
<g id="edge1412" class="edge">
<title>expert15_l16_dp1&#45;&gt;expert_agg_l16_dp1</title>
<path fill="none" stroke="black" d="M248439.49,-162.01C248485.12,-171.59 248538.84,-181.26 248588,-185.98 248689.95,-195.77 252172.97,-194.9 252275,-185.98 252313.11,-182.65 252353.78,-176.86 252392.08,-170.36"/>
<polygon fill="black" stroke="black" points="252393.02,-173.75 252402.29,-168.6 252391.84,-166.85 252393.02,-173.75"/>
</g>
<!-- layer16_output_dp1 -->
<g id="node840" class="node">
<title>layer16_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="253011" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="253011" y="-144.48" font-family="Arial" font-size="10.00">Layer 16 Output</text>
<text text-anchor="middle" x="253011" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="253011" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l16_dp1&#45;&gt;layer16_output_dp1 -->
<g id="edge1413" class="edge">
<title>expert_agg_l16_dp1&#45;&gt;layer16_output_dp1</title>
<path fill="none" stroke="black" d="M252756.31,-135.98C252781.49,-135.98 252806.66,-135.98 252831.84,-135.98"/>
<polygon fill="black" stroke="black" points="252831.87,-139.48 252841.87,-135.98 252831.87,-132.48 252831.87,-139.48"/>
</g>
<!-- stage2_output_dp1 -->
<g id="node841" class="node">
<title>stage2_output_dp1</title>
<ellipse fill="lightblue" stroke="black" cx="253384" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="253384" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Output</text>
<text text-anchor="middle" x="253384" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="253384" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer16_output_dp1&#45;&gt;stage2_output_dp1 -->
<g id="edge1414" class="edge">
<title>layer16_output_dp1&#45;&gt;stage2_output_dp1</title>
<path fill="none" stroke="black" d="M253180.01,-135.98C253188.23,-135.98 253196.44,-135.98 253204.66,-135.98"/>
<polygon fill="black" stroke="black" points="253204.68,-139.48 253214.68,-135.98 253204.68,-132.48 253204.68,-139.48"/>
</g>
<!-- stage2_output_dp1&#45;&gt;output -->
<g id="edge2830" class="edge">
<title>stage2_output_dp1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M253472.08,-111.17C253500.55,-104.55 253532.41,-98.28 253562,-94.98 253979.9,-48.39 312241.07,-31.08 315892.85,-30.04"/>
<polygon fill="black" stroke="black" points="315893.08,-33.54 315903.08,-30.04 315893.08,-26.54 315893.08,-33.54"/>
</g>
<!-- stage1_input_dp2 -->
<g id="node842" class="node">
<title>stage1_input_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="253740" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="253740" y="-144.48" font-family="Arial" font-size="10.00">Stage1 Input</text>
<text text-anchor="middle" x="253740" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="253740" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_input_l1_dp2 -->
<g id="node843" class="node">
<title>attn_input_l1_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="254113" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="254113" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L1</text>
<text text-anchor="middle" x="254113" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="254113" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_input_dp2&#45;&gt;attn_input_l1_dp2 -->
<g id="edge1415" class="edge">
<title>stage1_input_dp2&#45;&gt;attn_input_l1_dp2</title>
<path fill="none" stroke="black" d="M253909.01,-135.98C253917.23,-135.98 253925.44,-135.98 253933.66,-135.98"/>
<polygon fill="black" stroke="black" points="253933.68,-139.48 253943.68,-135.98 253933.68,-132.48 253933.68,-139.48"/>
</g>
<!-- attn_tp0_l1_dp2 -->
<g id="node844" class="node">
<title>attn_tp0_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="255411,-161.98 255151,-161.98 255151,-109.98 255411,-109.98 255411,-161.98"/>
<text text-anchor="middle" x="255281" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L1</text>
<text text-anchor="middle" x="255281" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="255281" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="255281" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp2&#45;&gt;attn_tp0_l1_dp2 -->
<g id="edge1416" class="edge">
<title>attn_input_l1_dp2&#45;&gt;attn_tp0_l1_dp2</title>
<path fill="none" stroke="black" d="M254196.52,-161.26C254233.12,-171.09 254276.81,-181.13 254317,-185.98 254362,-191.42 255088.27,-193.33 255133,-185.98 255158.4,-181.81 255185.31,-173.85 255209.12,-165.5"/>
<polygon fill="black" stroke="black" points="255210.55,-168.71 255218.78,-162.03 255208.18,-162.12 255210.55,-168.71"/>
</g>
<!-- attn_tp1_l1_dp2 -->
<g id="node845" class="node">
<title>attn_tp1_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="255133,-161.98 254873,-161.98 254873,-109.98 255133,-109.98 255133,-161.98"/>
<text text-anchor="middle" x="255003" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L1</text>
<text text-anchor="middle" x="255003" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="255003" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="255003" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp2&#45;&gt;attn_tp1_l1_dp2 -->
<g id="edge1417" class="edge">
<title>attn_input_l1_dp2&#45;&gt;attn_tp1_l1_dp2</title>
<path fill="none" stroke="black" d="M254196.52,-161.26C254233.12,-171.09 254276.81,-181.13 254317,-185.98 254376.35,-193.15 254796.01,-195.68 254855,-185.98 254880.4,-181.81 254907.31,-173.85 254931.12,-165.5"/>
<polygon fill="black" stroke="black" points="254932.55,-168.71 254940.78,-162.03 254930.18,-162.12 254932.55,-168.71"/>
</g>
<!-- attn_tp2_l1_dp2 -->
<g id="node846" class="node">
<title>attn_tp2_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="254855,-161.98 254595,-161.98 254595,-109.98 254855,-109.98 254855,-161.98"/>
<text text-anchor="middle" x="254725" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L1</text>
<text text-anchor="middle" x="254725" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="254725" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="254725" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp2&#45;&gt;attn_tp2_l1_dp2 -->
<g id="edge1418" class="edge">
<title>attn_input_l1_dp2&#45;&gt;attn_tp2_l1_dp2</title>
<path fill="none" stroke="black" d="M254196.52,-161.26C254233.12,-171.09 254276.81,-181.13 254317,-185.98 254374.36,-192.91 254519.99,-195.35 254577,-185.98 254602.4,-181.81 254629.31,-173.85 254653.12,-165.5"/>
<polygon fill="black" stroke="black" points="254654.55,-168.71 254662.78,-162.03 254652.18,-162.12 254654.55,-168.71"/>
</g>
<!-- attn_tp3_l1_dp2 -->
<g id="node847" class="node">
<title>attn_tp3_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="254577,-161.98 254317,-161.98 254317,-109.98 254577,-109.98 254577,-161.98"/>
<text text-anchor="middle" x="254447" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L1</text>
<text text-anchor="middle" x="254447" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="254447" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="254447" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp2&#45;&gt;attn_tp3_l1_dp2 -->
<g id="edge1419" class="edge">
<title>attn_input_l1_dp2&#45;&gt;attn_tp3_l1_dp2</title>
<path fill="none" stroke="black" d="M254282.28,-135.98C254290.35,-135.98 254298.42,-135.98 254306.49,-135.98"/>
<polygon fill="black" stroke="black" points="254306.7,-139.48 254316.7,-135.98 254306.7,-132.48 254306.7,-139.48"/>
</g>
<!-- allreduce_l1_dp2 -->
<g id="node848" class="node">
<title>allreduce_l1_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="255615" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="255615" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L1</text>
<text text-anchor="middle" x="255615" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="255615" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l1_dp2&#45;&gt;allreduce_l1_dp2 -->
<g id="edge1420" class="edge">
<title>attn_tp0_l1_dp2&#45;&gt;allreduce_l1_dp2</title>
<path fill="none" stroke="black" d="M255411.14,-135.98C255419.35,-135.98 255427.56,-135.98 255435.77,-135.98"/>
<polygon fill="black" stroke="black" points="255435.78,-139.48 255445.78,-135.98 255435.78,-132.48 255435.78,-139.48"/>
</g>
<!-- attn_tp1_l1_dp2&#45;&gt;allreduce_l1_dp2 -->
<g id="edge1421" class="edge">
<title>attn_tp1_l1_dp2&#45;&gt;allreduce_l1_dp2</title>
<path fill="none" stroke="black" d="M255065.22,-162.03C255091.24,-171.59 255122.1,-181.23 255151,-185.98 255208.01,-195.35 255353.64,-192.91 255411,-185.98 255447.57,-181.57 255487.05,-172.85 255521.44,-163.91"/>
<polygon fill="black" stroke="black" points="255522.7,-167.2 255531.47,-161.26 255520.91,-160.43 255522.7,-167.2"/>
</g>
<!-- attn_tp2_l1_dp2&#45;&gt;allreduce_l1_dp2 -->
<g id="edge1422" class="edge">
<title>attn_tp2_l1_dp2&#45;&gt;allreduce_l1_dp2</title>
<path fill="none" stroke="black" d="M254787.22,-162.03C254813.24,-171.59 254844.1,-181.23 254873,-185.98 254931.98,-195.68 255351.65,-193.15 255411,-185.98 255447.57,-181.57 255487.05,-172.85 255521.44,-163.91"/>
<polygon fill="black" stroke="black" points="255522.7,-167.2 255531.47,-161.26 255520.91,-160.43 255522.7,-167.2"/>
</g>
<!-- attn_tp3_l1_dp2&#45;&gt;allreduce_l1_dp2 -->
<g id="edge1423" class="edge">
<title>attn_tp3_l1_dp2&#45;&gt;allreduce_l1_dp2</title>
<path fill="none" stroke="black" d="M254509.22,-162.03C254535.24,-171.59 254566.1,-181.23 254595,-185.98 254639.73,-193.33 255365.99,-191.42 255411,-185.98 255447.57,-181.57 255487.05,-172.85 255521.44,-163.91"/>
<polygon fill="black" stroke="black" points="255522.7,-167.2 255531.47,-161.26 255520.91,-160.43 255522.7,-167.2"/>
</g>
<!-- moe_input_l1_dp2 -->
<g id="node849" class="node">
<title>moe_input_l1_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="255988" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="255988" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L1</text>
<text text-anchor="middle" x="255988" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="255988" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l1_dp2&#45;&gt;moe_input_l1_dp2 -->
<g id="edge1424" class="edge">
<title>allreduce_l1_dp2&#45;&gt;moe_input_l1_dp2</title>
<path fill="none" stroke="black" d="M255784.01,-135.98C255792.23,-135.98 255800.44,-135.98 255808.66,-135.98"/>
<polygon fill="black" stroke="black" points="255808.68,-139.48 255818.68,-135.98 255808.68,-132.48 255808.68,-139.48"/>
</g>
<!-- router_l1_dp2 -->
<g id="node850" class="node">
<title>router_l1_dp2</title>
<polygon fill="lightyellow" stroke="black" points="256687.57,-176.98 256293.74,-176.98 256192.43,-94.98 256586.26,-94.98 256687.57,-176.98"/>
<text text-anchor="middle" x="256440" y="-144.48" font-family="Arial" font-size="10.00">Router L1</text>
<text text-anchor="middle" x="256440" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="256440" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l1_dp2&#45;&gt;router_l1_dp2 -->
<g id="edge1425" class="edge">
<title>moe_input_l1_dp2&#45;&gt;router_l1_dp2</title>
<path fill="none" stroke="black" d="M256157.06,-135.98C256182.34,-135.98 256207.63,-135.98 256232.92,-135.98"/>
<polygon fill="black" stroke="black" points="256232.99,-139.48 256242.99,-135.98 256232.99,-132.48 256232.99,-139.48"/>
</g>
<!-- expert0_l1_dp2 -->
<g id="node851" class="node">
<title>expert0_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="260693.5,-161.98 260464.5,-161.98 260464.5,-109.98 260693.5,-109.98 260693.5,-161.98"/>
<text text-anchor="middle" x="260579" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L1</text>
<text text-anchor="middle" x="260579" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="260579" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="260579" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert0_l1_dp2 -->
<g id="edge1426" class="edge">
<title>router_l1_dp2&#45;&gt;expert0_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.74,-171.32C256702.09,-173.59 256723.41,-175.53 256744,-176.98 257504.47,-230.48 259412.15,-196.54 260174.5,-198.98 260299.55,-199.38 260332.59,-202.54 260455,-176.98 260469.75,-173.9 260485.19,-169.66 260499.98,-165.07"/>
<polygon fill="black" stroke="black" points="260501.12,-168.37 260509.59,-162 260499,-161.7 260501.12,-168.37"/>
<text text-anchor="middle" x="260196" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l1_dp2 -->
<g id="node852" class="node">
<title>expert1_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="260446.5,-161.98 260217.5,-161.98 260217.5,-109.98 260446.5,-109.98 260446.5,-161.98"/>
<text text-anchor="middle" x="260332" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L1</text>
<text text-anchor="middle" x="260332" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="260332" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="260332" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert1_l1_dp2 -->
<g id="edge1427" class="edge">
<title>router_l1_dp2&#45;&gt;expert1_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.74,-171.31C256702.09,-173.58 256723.41,-175.53 256744,-176.98 257443.05,-226.36 259196.71,-196.54 259897.5,-198.98 260035.84,-199.47 260072.43,-204.56 260208,-176.98 260222.85,-173.96 260238.41,-169.72 260253.28,-165.11"/>
<polygon fill="black" stroke="black" points="260254.48,-168.4 260262.94,-162.03 260252.35,-161.73 260254.48,-168.4"/>
<text text-anchor="middle" x="259919" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l1_dp2 -->
<g id="node853" class="node">
<title>expert2_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="260199.5,-161.98 259970.5,-161.98 259970.5,-109.98 260199.5,-109.98 260199.5,-161.98"/>
<text text-anchor="middle" x="260085" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L1</text>
<text text-anchor="middle" x="260085" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="260085" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="260085" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert2_l1_dp2 -->
<g id="edge1428" class="edge">
<title>router_l1_dp2&#45;&gt;expert2_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.74,-171.29C256702.1,-173.56 256723.41,-175.52 256744,-176.98 257375.21,-221.81 258958.71,-196.54 259591.5,-198.98 259756.01,-199.62 259799.55,-208.59 259961,-176.98 259976.06,-174.03 259991.82,-169.78 260006.86,-165.12"/>
<polygon fill="black" stroke="black" points="260008.17,-168.37 260016.63,-162 260006.04,-161.71 260008.17,-168.37"/>
<text text-anchor="middle" x="259613" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l1_dp2 -->
<g id="node854" class="node">
<title>expert3_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="259952.5,-161.98 259723.5,-161.98 259723.5,-109.98 259952.5,-109.98 259952.5,-161.98"/>
<text text-anchor="middle" x="259838" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L1</text>
<text text-anchor="middle" x="259838" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="259838" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="259838" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert3_l1_dp2 -->
<g id="edge1429" class="edge">
<title>router_l1_dp2&#45;&gt;expert3_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.74,-171.27C256702.1,-173.54 256723.41,-175.51 256744,-176.98 257294.28,-216.37 258674.82,-196.54 259226.5,-198.98 259443.38,-199.94 259500.79,-216.75 259714,-176.98 259729.27,-174.14 259745.24,-169.88 259760.45,-165.17"/>
<polygon fill="black" stroke="black" points="259761.86,-168.39 259770.32,-162.01 259759.73,-161.72 259761.86,-168.39"/>
<text text-anchor="middle" x="259248" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l1_dp2 -->
<g id="node855" class="node">
<title>expert4_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="259705.5,-161.98 259476.5,-161.98 259476.5,-109.98 259705.5,-109.98 259705.5,-161.98"/>
<text text-anchor="middle" x="259591" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L1</text>
<text text-anchor="middle" x="259591" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="259591" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="259591" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert4_l1_dp2 -->
<g id="edge1430" class="edge">
<title>router_l1_dp2&#45;&gt;expert4_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256585.67,-176.99C256624.3,-186.08 256666.21,-194.39 256705.5,-198.98 256724.48,-201.2 256729.39,-199.06 256748.5,-198.98 257050.56,-197.76 259168.97,-226.21 259467,-176.98 259482.93,-174.35 259499.6,-170.01 259515.35,-165.12"/>
<polygon fill="black" stroke="black" points="259516.58,-168.4 259525.03,-162.01 259514.44,-161.73 259516.58,-168.4"/>
<text text-anchor="middle" x="256727" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l1_dp2 -->
<g id="node856" class="node">
<title>expert5_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="259458.5,-161.98 259229.5,-161.98 259229.5,-109.98 259458.5,-109.98 259458.5,-161.98"/>
<text text-anchor="middle" x="259344" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L1</text>
<text text-anchor="middle" x="259344" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="259344" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="259344" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert5_l1_dp2 -->
<g id="edge1431" class="edge">
<title>router_l1_dp2&#45;&gt;expert5_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.74,-171.22C256702.1,-173.51 256723.42,-175.49 256744,-176.98 257187.19,-209.18 258299.15,-196.54 258743.5,-198.98 258955.5,-200.15 259011.61,-215.98 259220,-176.98 259235.26,-174.13 259251.24,-169.86 259266.45,-165.15"/>
<polygon fill="black" stroke="black" points="259267.86,-168.37 259276.32,-162 259265.73,-161.71 259267.86,-168.37"/>
<text text-anchor="middle" x="258765" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l1_dp2 -->
<g id="node857" class="node">
<title>expert6_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="259211.5,-161.98 258982.5,-161.98 258982.5,-109.98 259211.5,-109.98 259211.5,-161.98"/>
<text text-anchor="middle" x="259097" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L1</text>
<text text-anchor="middle" x="259097" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="259097" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="259097" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert6_l1_dp2 -->
<g id="edge1432" class="edge">
<title>router_l1_dp2&#45;&gt;expert6_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256612.37,-177C256657.98,-186.1 256707.37,-194.39 256753.5,-198.98 256772.52,-200.87 256777.39,-199.08 256796.5,-198.98 257038.34,-197.76 258734.43,-216.64 258973,-176.98 258988.84,-174.35 259005.4,-170.04 259021.07,-165.18"/>
<polygon fill="black" stroke="black" points="259022.25,-168.47 259030.7,-162.09 259020.11,-161.81 259022.25,-168.47"/>
<text text-anchor="middle" x="256775" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l1_dp2 -->
<g id="node858" class="node">
<title>expert7_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="258964.5,-161.98 258735.5,-161.98 258735.5,-109.98 258964.5,-109.98 258964.5,-161.98"/>
<text text-anchor="middle" x="258850" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L1</text>
<text text-anchor="middle" x="258850" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="258850" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="258850" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert7_l1_dp2 -->
<g id="edge1433" class="edge">
<title>router_l1_dp2&#45;&gt;expert7_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.33,-171.1C256701.83,-173.42 256723.29,-175.44 256744,-176.98 257092.07,-202.87 257965.59,-208.3 258314.5,-198.98 258497.58,-194.09 258546.02,-210.92 258726,-176.98 258741.17,-174.12 258757.04,-169.88 258772.17,-165.2"/>
<polygon fill="black" stroke="black" points="258773.52,-168.44 258781.99,-162.07 258771.4,-161.77 258773.52,-168.44"/>
<text text-anchor="middle" x="258293" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l1_dp2 -->
<g id="node859" class="node">
<title>expert8_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="258717.5,-161.98 258488.5,-161.98 258488.5,-109.98 258717.5,-109.98 258717.5,-161.98"/>
<text text-anchor="middle" x="258603" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L1</text>
<text text-anchor="middle" x="258603" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="258603" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="258603" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert8_l1_dp2 -->
<g id="edge1434" class="edge">
<title>router_l1_dp2&#45;&gt;expert8_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256639.02,-177C256691.62,-186.1 256748.5,-194.4 256801.5,-198.98 256820.54,-200.63 256825.39,-199.11 256844.5,-198.98 257026.12,-197.76 258299.88,-207.07 258479,-176.98 258494.83,-174.32 258511.39,-170 258527.07,-165.13"/>
<polygon fill="black" stroke="black" points="258528.24,-168.43 258536.7,-162.04 258526.1,-161.77 258528.24,-168.43"/>
<text text-anchor="middle" x="256823" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l1_dp2 -->
<g id="node860" class="node">
<title>expert9_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="258470.5,-161.98 258241.5,-161.98 258241.5,-109.98 258470.5,-109.98 258470.5,-161.98"/>
<text text-anchor="middle" x="258356" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L1</text>
<text text-anchor="middle" x="258356" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="258356" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="258356" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert9_l1_dp2 -->
<g id="edge1435" class="edge">
<title>router_l1_dp2&#45;&gt;expert9_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256680.35,-170.96C256701.84,-173.31 256723.29,-175.38 256744,-176.98 257240.17,-215.39 257366.07,-213.82 257863.5,-198.98 258027.49,-194.09 258070.87,-207.88 258232,-176.98 258247.16,-174.08 258263.03,-169.81 258278.15,-165.12"/>
<polygon fill="black" stroke="black" points="258279.51,-168.37 258287.97,-161.99 258277.38,-161.7 258279.51,-168.37"/>
<text text-anchor="middle" x="257842" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l1_dp2 -->
<g id="node861" class="node">
<title>expert10_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="258223.5,-161.98 257994.5,-161.98 257994.5,-109.98 258223.5,-109.98 258223.5,-161.98"/>
<text text-anchor="middle" x="258109" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L1</text>
<text text-anchor="middle" x="258109" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="258109" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="258109" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert10_l1_dp2 -->
<g id="edge1436" class="edge">
<title>router_l1_dp2&#45;&gt;expert10_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256665.65,-177.01C256725.23,-186.11 256789.61,-194.4 256849.5,-198.98 256975.32,-208.6 257860.62,-198.3 257985,-176.98 258000.73,-174.29 258017.18,-169.97 258032.78,-165.14"/>
<polygon fill="black" stroke="black" points="258033.9,-168.45 258042.36,-162.07 258031.77,-161.78 258033.9,-168.45"/>
<text text-anchor="middle" x="256871" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l1_dp2 -->
<g id="node862" class="node">
<title>expert11_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="257976.5,-161.98 257747.5,-161.98 257747.5,-109.98 257976.5,-109.98 257976.5,-161.98"/>
<text text-anchor="middle" x="257862" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L1</text>
<text text-anchor="middle" x="257862" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="257862" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="257862" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert11_l1_dp2 -->
<g id="edge1437" class="edge">
<title>router_l1_dp2&#45;&gt;expert11_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256679.95,-170.64C256701.58,-173.07 256723.17,-175.24 256744,-176.98 257059.71,-203.39 257139.92,-211.33 257456.5,-198.98 257581.9,-194.09 257614.97,-201.75 257738,-176.98 257752.86,-173.99 257768.42,-169.77 257783.29,-165.16"/>
<polygon fill="black" stroke="black" points="257784.48,-168.45 257792.95,-162.08 257782.36,-161.78 257784.48,-168.45"/>
<text text-anchor="middle" x="257435" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l1_dp2 -->
<g id="node863" class="node">
<title>expert12_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="257729.5,-161.98 257500.5,-161.98 257500.5,-109.98 257729.5,-109.98 257729.5,-161.98"/>
<text text-anchor="middle" x="257615" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L1</text>
<text text-anchor="middle" x="257615" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="257615" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="257615" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert12_l1_dp2 -->
<g id="edge1438" class="edge">
<title>router_l1_dp2&#45;&gt;expert12_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256686.89,-176.28C256754.94,-185.66 256828.91,-194.28 256897.5,-198.98 257029.17,-208.01 257361.14,-200.56 257491,-176.98 257506.37,-174.19 257522.45,-169.93 257537.75,-165.2"/>
<polygon fill="black" stroke="black" points="257539.21,-168.41 257547.67,-162.03 257537.08,-161.74 257539.21,-168.41"/>
<text text-anchor="middle" x="256919" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l1_dp2 -->
<g id="node864" class="node">
<title>expert13_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="257482.5,-161.98 257253.5,-161.98 257253.5,-109.98 257482.5,-109.98 257482.5,-161.98"/>
<text text-anchor="middle" x="257368" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L1</text>
<text text-anchor="middle" x="257368" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="257368" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="257368" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert13_l1_dp2 -->
<g id="edge1439" class="edge">
<title>router_l1_dp2&#45;&gt;expert13_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256657.82,-177.02C256794.96,-197.58 256975.66,-215.02 257135.5,-198.98 257186.66,-193.85 257242.31,-179.11 257286.33,-165.18"/>
<polygon fill="black" stroke="black" points="257287.66,-168.43 257296.11,-162.04 257285.52,-161.77 257287.66,-168.43"/>
<text text-anchor="middle" x="257114" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l1_dp2 -->
<g id="node865" class="node">
<title>expert14_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="257235.5,-161.98 257006.5,-161.98 257006.5,-109.98 257235.5,-109.98 257235.5,-161.98"/>
<text text-anchor="middle" x="257121" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L1</text>
<text text-anchor="middle" x="257121" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="257121" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="257121" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert14_l1_dp2 -->
<g id="edge1440" class="edge">
<title>router_l1_dp2&#45;&gt;expert14_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256665.44,-176.99C256788.58,-196.39 256928.01,-212.63 256988.5,-198.98 257016.7,-192.62 257045.94,-179.52 257069.75,-166.9"/>
<polygon fill="black" stroke="black" points="257071.48,-169.94 257078.6,-162.1 257068.14,-163.79 257071.48,-169.94"/>
<text text-anchor="middle" x="256967" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l1_dp2 -->
<g id="node866" class="node">
<title>expert15_l1_dp2</title>
<polygon fill="lightgreen" stroke="black" points="256982.5,-161.98 256753.5,-161.98 256753.5,-109.98 256982.5,-109.98 256982.5,-161.98"/>
<text text-anchor="middle" x="256868" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L1</text>
<text text-anchor="middle" x="256868" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="256868" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="256868" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp2&#45;&gt;expert15_l1_dp2 -->
<g id="edge1441" class="edge">
<title>router_l1_dp2&#45;&gt;expert15_l1_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M256637.09,-135.98C256673.17,-135.98 256709.91,-135.98 256743.14,-135.98"/>
<polygon fill="black" stroke="black" points="256743.34,-139.48 256753.34,-135.98 256743.34,-132.48 256743.34,-139.48"/>
<text text-anchor="middle" x="256720.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l1_dp2 -->
<g id="node867" class="node">
<title>expert_agg_l1_dp2</title>
<polygon fill="lightyellow" stroke="black" points="261224.57,-176.98 260830.74,-176.98 260729.43,-94.98 261123.26,-94.98 261224.57,-176.98"/>
<text text-anchor="middle" x="260977" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L1</text>
<text text-anchor="middle" x="260977" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="260977" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1442" class="edge">
<title>expert0_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M260693.66,-135.98C260719.06,-135.98 260744.47,-135.98 260769.87,-135.98"/>
<polygon fill="black" stroke="black" points="260769.99,-139.48 260779.99,-135.98 260769.99,-132.48 260769.99,-139.48"/>
</g>
<!-- expert1_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1443" class="edge">
<title>expert1_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M260387.24,-162.02C260410.4,-171.57 260437.96,-181.22 260464,-185.98 260514.06,-195.15 260642.3,-190.41 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert2_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1444" class="edge">
<title>expert2_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M260140.24,-162.02C260163.4,-171.57 260190.96,-181.22 260217,-185.98 260269.02,-195.51 260640.31,-190.59 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert3_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1445" class="edge">
<title>expert3_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M259893.24,-162.02C259916.4,-171.57 259943.96,-181.22 259970,-185.98 260049.02,-200.45 260612.97,-192.97 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert4_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1446" class="edge">
<title>expert4_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M259646.24,-162.02C259669.4,-171.57 259696.96,-181.22 259723,-185.98 259776.01,-195.69 260639.31,-190.67 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert5_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1447" class="edge">
<title>expert5_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M259399.24,-162.02C259422.4,-171.57 259449.96,-181.22 259476,-185.98 259542.5,-198.16 260625.64,-191.87 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert6_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1448" class="edge">
<title>expert6_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M259152.24,-162.02C259175.4,-171.57 259202.96,-181.22 259229,-185.98 259309,-200.63 260611.97,-193.06 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert7_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1449" class="edge">
<title>expert7_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M258905.24,-162.02C258928.4,-171.57 258955.96,-181.22 258982,-185.98 259028.75,-194.54 260645.65,-190.12 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert8_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1450" class="edge">
<title>expert8_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M258658.24,-162.02C258681.4,-171.57 258708.96,-181.22 258735,-185.98 258788.5,-195.78 260638.82,-190.72 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert9_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1451" class="edge">
<title>expert9_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M258411.24,-162.02C258434.4,-171.57 258461.96,-181.22 258488,-185.98 258548.25,-197.01 260631.98,-191.31 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert10_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1452" class="edge">
<title>expert10_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M258164.24,-162.02C258187.4,-171.57 258214.96,-181.22 258241,-185.98 258308,-198.25 260625.15,-191.91 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert11_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1453" class="edge">
<title>expert11_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M257917.24,-162.02C257940.4,-171.57 257967.96,-181.22 257994,-185.98 258067.75,-199.48 260618.31,-192.51 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert12_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1454" class="edge">
<title>expert12_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M257670.24,-162.02C257693.4,-171.57 257720.96,-181.22 257747,-185.98 257827.49,-200.72 260611.48,-193.1 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert13_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1455" class="edge">
<title>expert13_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M257423.24,-162.02C257446.4,-171.57 257473.96,-181.22 257500,-185.98 257543.62,-193.97 260648.82,-189.84 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert14_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1456" class="edge">
<title>expert14_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M257176.24,-162.02C257199.4,-171.57 257226.96,-181.22 257253,-185.98 257300,-194.59 260645.4,-190.14 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- expert15_l1_dp2&#45;&gt;expert_agg_l1_dp2 -->
<g id="edge1457" class="edge">
<title>expert15_l1_dp2&#45;&gt;expert_agg_l1_dp2</title>
<path fill="none" stroke="black" d="M256925.86,-162.02C256950.1,-171.58 256978.89,-181.22 257006,-185.98 257056.44,-194.84 260641.98,-190.44 260693,-185.98 260731.11,-182.65 260771.78,-176.86 260810.08,-170.36"/>
<polygon fill="black" stroke="black" points="260811.02,-173.75 260820.29,-168.6 260809.84,-166.85 260811.02,-173.75"/>
</g>
<!-- layer1_output_dp2 -->
<g id="node868" class="node">
<title>layer1_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="261429" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="261429" y="-144.48" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="261429" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="261429" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l1_dp2&#45;&gt;layer1_output_dp2 -->
<g id="edge1458" class="edge">
<title>expert_agg_l1_dp2&#45;&gt;layer1_output_dp2</title>
<path fill="none" stroke="black" d="M261174.31,-135.98C261199.49,-135.98 261224.66,-135.98 261249.84,-135.98"/>
<polygon fill="black" stroke="black" points="261249.87,-139.48 261259.87,-135.98 261249.87,-132.48 261249.87,-139.48"/>
</g>
<!-- attn_input_l2_dp2 -->
<g id="node869" class="node">
<title>attn_input_l2_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="261802" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="261802" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L2</text>
<text text-anchor="middle" x="261802" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="261802" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer1_output_dp2&#45;&gt;attn_input_l2_dp2 -->
<g id="edge1459" class="edge">
<title>layer1_output_dp2&#45;&gt;attn_input_l2_dp2</title>
<path fill="none" stroke="black" d="M261598.01,-135.98C261606.23,-135.98 261614.44,-135.98 261622.66,-135.98"/>
<polygon fill="black" stroke="black" points="261622.68,-139.48 261632.68,-135.98 261622.68,-132.48 261622.68,-139.48"/>
</g>
<!-- attn_tp0_l2_dp2 -->
<g id="node870" class="node">
<title>attn_tp0_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="263100,-161.98 262840,-161.98 262840,-109.98 263100,-109.98 263100,-161.98"/>
<text text-anchor="middle" x="262970" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L2</text>
<text text-anchor="middle" x="262970" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="262970" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="262970" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp2&#45;&gt;attn_tp0_l2_dp2 -->
<g id="edge1460" class="edge">
<title>attn_input_l2_dp2&#45;&gt;attn_tp0_l2_dp2</title>
<path fill="none" stroke="black" d="M261885.52,-161.26C261922.12,-171.09 261965.81,-181.13 262006,-185.98 262051,-191.42 262777.27,-193.33 262822,-185.98 262847.4,-181.81 262874.31,-173.85 262898.12,-165.5"/>
<polygon fill="black" stroke="black" points="262899.55,-168.71 262907.78,-162.03 262897.18,-162.12 262899.55,-168.71"/>
</g>
<!-- attn_tp1_l2_dp2 -->
<g id="node871" class="node">
<title>attn_tp1_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="262822,-161.98 262562,-161.98 262562,-109.98 262822,-109.98 262822,-161.98"/>
<text text-anchor="middle" x="262692" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L2</text>
<text text-anchor="middle" x="262692" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="262692" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="262692" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp2&#45;&gt;attn_tp1_l2_dp2 -->
<g id="edge1461" class="edge">
<title>attn_input_l2_dp2&#45;&gt;attn_tp1_l2_dp2</title>
<path fill="none" stroke="black" d="M261885.52,-161.26C261922.12,-171.09 261965.81,-181.13 262006,-185.98 262065.35,-193.15 262485.01,-195.68 262544,-185.98 262569.4,-181.81 262596.31,-173.85 262620.12,-165.5"/>
<polygon fill="black" stroke="black" points="262621.55,-168.71 262629.78,-162.03 262619.18,-162.12 262621.55,-168.71"/>
</g>
<!-- attn_tp2_l2_dp2 -->
<g id="node872" class="node">
<title>attn_tp2_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="262544,-161.98 262284,-161.98 262284,-109.98 262544,-109.98 262544,-161.98"/>
<text text-anchor="middle" x="262414" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L2</text>
<text text-anchor="middle" x="262414" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="262414" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="262414" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp2&#45;&gt;attn_tp2_l2_dp2 -->
<g id="edge1462" class="edge">
<title>attn_input_l2_dp2&#45;&gt;attn_tp2_l2_dp2</title>
<path fill="none" stroke="black" d="M261885.52,-161.26C261922.12,-171.09 261965.81,-181.13 262006,-185.98 262063.36,-192.91 262208.99,-195.35 262266,-185.98 262291.4,-181.81 262318.31,-173.85 262342.12,-165.5"/>
<polygon fill="black" stroke="black" points="262343.55,-168.71 262351.78,-162.03 262341.18,-162.12 262343.55,-168.71"/>
</g>
<!-- attn_tp3_l2_dp2 -->
<g id="node873" class="node">
<title>attn_tp3_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="262266,-161.98 262006,-161.98 262006,-109.98 262266,-109.98 262266,-161.98"/>
<text text-anchor="middle" x="262136" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L2</text>
<text text-anchor="middle" x="262136" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="262136" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="262136" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp2&#45;&gt;attn_tp3_l2_dp2 -->
<g id="edge1463" class="edge">
<title>attn_input_l2_dp2&#45;&gt;attn_tp3_l2_dp2</title>
<path fill="none" stroke="black" d="M261971.28,-135.98C261979.35,-135.98 261987.42,-135.98 261995.49,-135.98"/>
<polygon fill="black" stroke="black" points="261995.7,-139.48 262005.7,-135.98 261995.7,-132.48 261995.7,-139.48"/>
</g>
<!-- allreduce_l2_dp2 -->
<g id="node874" class="node">
<title>allreduce_l2_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="263304" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="263304" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L2</text>
<text text-anchor="middle" x="263304" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="263304" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l2_dp2&#45;&gt;allreduce_l2_dp2 -->
<g id="edge1464" class="edge">
<title>attn_tp0_l2_dp2&#45;&gt;allreduce_l2_dp2</title>
<path fill="none" stroke="black" d="M263100.14,-135.98C263108.35,-135.98 263116.56,-135.98 263124.77,-135.98"/>
<polygon fill="black" stroke="black" points="263124.78,-139.48 263134.78,-135.98 263124.78,-132.48 263124.78,-139.48"/>
</g>
<!-- attn_tp1_l2_dp2&#45;&gt;allreduce_l2_dp2 -->
<g id="edge1465" class="edge">
<title>attn_tp1_l2_dp2&#45;&gt;allreduce_l2_dp2</title>
<path fill="none" stroke="black" d="M262754.22,-162.03C262780.24,-171.59 262811.1,-181.23 262840,-185.98 262897.01,-195.35 263042.64,-192.91 263100,-185.98 263136.57,-181.57 263176.05,-172.85 263210.44,-163.91"/>
<polygon fill="black" stroke="black" points="263211.7,-167.2 263220.47,-161.26 263209.91,-160.43 263211.7,-167.2"/>
</g>
<!-- attn_tp2_l2_dp2&#45;&gt;allreduce_l2_dp2 -->
<g id="edge1466" class="edge">
<title>attn_tp2_l2_dp2&#45;&gt;allreduce_l2_dp2</title>
<path fill="none" stroke="black" d="M262476.22,-162.03C262502.24,-171.59 262533.1,-181.23 262562,-185.98 262620.98,-195.68 263040.65,-193.15 263100,-185.98 263136.57,-181.57 263176.05,-172.85 263210.44,-163.91"/>
<polygon fill="black" stroke="black" points="263211.7,-167.2 263220.47,-161.26 263209.91,-160.43 263211.7,-167.2"/>
</g>
<!-- attn_tp3_l2_dp2&#45;&gt;allreduce_l2_dp2 -->
<g id="edge1467" class="edge">
<title>attn_tp3_l2_dp2&#45;&gt;allreduce_l2_dp2</title>
<path fill="none" stroke="black" d="M262198.22,-162.03C262224.24,-171.59 262255.1,-181.23 262284,-185.98 262328.73,-193.33 263054.99,-191.42 263100,-185.98 263136.57,-181.57 263176.05,-172.85 263210.44,-163.91"/>
<polygon fill="black" stroke="black" points="263211.7,-167.2 263220.47,-161.26 263209.91,-160.43 263211.7,-167.2"/>
</g>
<!-- moe_input_l2_dp2 -->
<g id="node875" class="node">
<title>moe_input_l2_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="263677" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="263677" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L2</text>
<text text-anchor="middle" x="263677" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="263677" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l2_dp2&#45;&gt;moe_input_l2_dp2 -->
<g id="edge1468" class="edge">
<title>allreduce_l2_dp2&#45;&gt;moe_input_l2_dp2</title>
<path fill="none" stroke="black" d="M263473.01,-135.98C263481.23,-135.98 263489.44,-135.98 263497.66,-135.98"/>
<polygon fill="black" stroke="black" points="263497.68,-139.48 263507.68,-135.98 263497.68,-132.48 263497.68,-139.48"/>
</g>
<!-- router_l2_dp2 -->
<g id="node876" class="node">
<title>router_l2_dp2</title>
<polygon fill="lightyellow" stroke="black" points="264376.57,-176.98 263982.74,-176.98 263881.43,-94.98 264275.26,-94.98 264376.57,-176.98"/>
<text text-anchor="middle" x="264129" y="-144.48" font-family="Arial" font-size="10.00">Router L2</text>
<text text-anchor="middle" x="264129" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="264129" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l2_dp2&#45;&gt;router_l2_dp2 -->
<g id="edge1469" class="edge">
<title>moe_input_l2_dp2&#45;&gt;router_l2_dp2</title>
<path fill="none" stroke="black" d="M263846.06,-135.98C263871.34,-135.98 263896.63,-135.98 263921.92,-135.98"/>
<polygon fill="black" stroke="black" points="263921.99,-139.48 263931.99,-135.98 263921.99,-132.48 263921.99,-139.48"/>
</g>
<!-- expert0_l2_dp2 -->
<g id="node877" class="node">
<title>expert0_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="268430.5,-161.98 268201.5,-161.98 268201.5,-109.98 268430.5,-109.98 268430.5,-161.98"/>
<text text-anchor="middle" x="268316" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L2</text>
<text text-anchor="middle" x="268316" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="268316" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="268316" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert0_l2_dp2 -->
<g id="edge1470" class="edge">
<title>router_l2_dp2&#45;&gt;expert0_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.95,-169.07C264397.21,-172.29 264427.79,-175.07 264457,-176.98 265216.17,-226.7 267119.71,-196.54 267880.5,-198.98 268019.29,-199.43 268055.99,-204.63 268192,-176.98 268206.85,-173.96 268222.41,-169.72 268237.28,-165.11"/>
<polygon fill="black" stroke="black" points="268238.48,-168.4 268246.94,-162.03 268236.35,-161.73 268238.48,-168.4"/>
<text text-anchor="middle" x="267902" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l2_dp2 -->
<g id="node878" class="node">
<title>expert1_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="268183.5,-161.98 267954.5,-161.98 267954.5,-109.98 268183.5,-109.98 268183.5,-161.98"/>
<text text-anchor="middle" x="268069" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L2</text>
<text text-anchor="middle" x="268069" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="268069" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="268069" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert1_l2_dp2 -->
<g id="edge1471" class="edge">
<title>router_l2_dp2&#45;&gt;expert1_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.95,-169.05C264397.21,-172.28 264427.79,-175.06 264457,-176.98 265148.08,-222.46 266880.93,-196.54 267573.5,-198.98 267738.9,-199.57 267782.67,-208.72 267945,-176.98 267960.06,-174.04 267975.82,-169.78 267990.86,-165.12"/>
<polygon fill="black" stroke="black" points="267992.17,-168.38 268000.63,-162.01 267990.04,-161.71 267992.17,-168.38"/>
<text text-anchor="middle" x="267595" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l2_dp2 -->
<g id="node879" class="node">
<title>expert2_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="267936.5,-161.98 267707.5,-161.98 267707.5,-109.98 267936.5,-109.98 267936.5,-161.98"/>
<text text-anchor="middle" x="267822" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L2</text>
<text text-anchor="middle" x="267822" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="267822" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="267822" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert2_l2_dp2 -->
<g id="edge1472" class="edge">
<title>router_l2_dp2&#45;&gt;expert2_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.95,-169.03C264397.21,-172.26 264427.79,-175.05 264457,-176.98 265066.68,-217.39 266595.48,-196.54 267206.5,-198.98 267425.16,-199.86 267483.03,-217.03 267698,-176.98 267713.27,-174.14 267729.24,-169.88 267744.45,-165.17"/>
<polygon fill="black" stroke="black" points="267745.86,-168.4 267754.32,-162.02 267743.73,-161.73 267745.86,-168.4"/>
<text text-anchor="middle" x="267228" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l2_dp2 -->
<g id="node880" class="node">
<title>expert3_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="267689.5,-161.98 267460.5,-161.98 267460.5,-109.98 267689.5,-109.98 267689.5,-161.98"/>
<text text-anchor="middle" x="267575" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L2</text>
<text text-anchor="middle" x="267575" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="267575" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="267575" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert3_l2_dp2 -->
<g id="edge1473" class="edge">
<title>router_l2_dp2&#45;&gt;expert3_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264274.67,-176.99C264313.3,-186.08 264355.21,-194.39 264394.5,-198.98 264413.48,-201.2 264418.39,-199.05 264437.5,-198.98 264772.34,-197.76 267120.61,-231.42 267451,-176.98 267466.93,-174.36 267483.6,-170.02 267499.35,-165.13"/>
<polygon fill="black" stroke="black" points="267500.58,-168.41 267509.03,-162.02 267498.44,-161.74 267500.58,-168.41"/>
<text text-anchor="middle" x="264416" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l2_dp2 -->
<g id="node881" class="node">
<title>expert4_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="267442.5,-161.98 267213.5,-161.98 267213.5,-109.98 267442.5,-109.98 267442.5,-161.98"/>
<text text-anchor="middle" x="267328" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L2</text>
<text text-anchor="middle" x="267328" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="267328" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="267328" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert4_l2_dp2 -->
<g id="edge1474" class="edge">
<title>router_l2_dp2&#45;&gt;expert4_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.95,-168.98C264397.21,-172.22 264427.8,-175.02 264457,-176.98 264958.67,-210.66 266216.7,-196.54 266719.5,-198.98 266935.05,-200.03 266992.1,-216.54 267204,-176.98 267219.27,-174.13 267235.24,-169.87 267250.45,-165.16"/>
<polygon fill="black" stroke="black" points="267251.86,-168.39 267260.32,-162.01 267249.73,-161.72 267251.86,-168.39"/>
<text text-anchor="middle" x="266741" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l2_dp2 -->
<g id="node882" class="node">
<title>expert5_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="267195.5,-161.98 266966.5,-161.98 266966.5,-109.98 267195.5,-109.98 267195.5,-161.98"/>
<text text-anchor="middle" x="267081" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L2</text>
<text text-anchor="middle" x="267081" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="267081" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="267081" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert5_l2_dp2 -->
<g id="edge1475" class="edge">
<title>router_l2_dp2&#45;&gt;expert5_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264301.37,-177C264346.98,-186.1 264396.37,-194.39 264442.5,-198.98 264461.52,-200.87 264466.39,-199.07 264485.5,-198.98 264760.12,-197.76 266686.07,-221.85 266957,-176.98 266972.93,-174.34 266989.59,-170 267005.35,-165.11"/>
<polygon fill="black" stroke="black" points="267006.58,-168.39 267015.03,-162 267004.44,-161.72 267006.58,-168.39"/>
<text text-anchor="middle" x="264464" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l2_dp2 -->
<g id="node883" class="node">
<title>expert6_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="266948.5,-161.98 266719.5,-161.98 266719.5,-109.98 266948.5,-109.98 266948.5,-161.98"/>
<text text-anchor="middle" x="266834" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L2</text>
<text text-anchor="middle" x="266834" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="266834" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="266834" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert6_l2_dp2 -->
<g id="edge1476" class="edge">
<title>router_l2_dp2&#45;&gt;expert6_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.96,-168.9C264397.22,-172.15 264427.8,-174.98 264457,-176.98 264861.75,-204.69 265876.94,-209.41 266282.5,-198.98 266472.69,-194.09 266523.01,-212.05 266710,-176.98 266725.26,-174.12 266741.24,-169.85 266756.45,-165.14"/>
<polygon fill="black" stroke="black" points="266757.85,-168.37 266766.32,-161.99 266755.73,-161.7 266757.85,-168.37"/>
<text text-anchor="middle" x="266261" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l2_dp2 -->
<g id="node884" class="node">
<title>expert7_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="266701.5,-161.98 266472.5,-161.98 266472.5,-109.98 266701.5,-109.98 266701.5,-161.98"/>
<text text-anchor="middle" x="266587" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L2</text>
<text text-anchor="middle" x="266587" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="266587" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="266587" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert7_l2_dp2 -->
<g id="edge1477" class="edge">
<title>router_l2_dp2&#45;&gt;expert7_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264328.02,-177C264380.62,-186.1 264437.5,-194.4 264490.5,-198.98 264509.54,-200.63 264514.39,-199.09 264533.5,-198.98 264747.9,-197.76 266251.52,-212.28 266463,-176.98 266478.83,-174.34 266495.4,-170.02 266511.07,-165.16"/>
<polygon fill="black" stroke="black" points="266512.25,-168.46 266520.7,-162.07 266510.11,-161.79 266512.25,-168.46"/>
<text text-anchor="middle" x="264512" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l2_dp2 -->
<g id="node885" class="node">
<title>expert8_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="266454.5,-161.98 266225.5,-161.98 266225.5,-109.98 266454.5,-109.98 266454.5,-161.98"/>
<text text-anchor="middle" x="266340" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L2</text>
<text text-anchor="middle" x="266340" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="266340" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="266340" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert8_l2_dp2 -->
<g id="edge1478" class="edge">
<title>router_l2_dp2&#45;&gt;expert8_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.52,-168.73C264396.92,-172.02 264427.66,-174.91 264457,-176.98 264758.4,-198.28 265514.46,-207.29 265816.5,-198.98 265994.26,-194.09 266041.28,-210.07 266216,-176.98 266231.17,-174.11 266247.04,-169.87 266262.16,-165.18"/>
<polygon fill="black" stroke="black" points="266263.52,-168.42 266271.98,-162.05 266261.39,-161.75 266263.52,-168.42"/>
<text text-anchor="middle" x="265795" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l2_dp2 -->
<g id="node886" class="node">
<title>expert9_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="266207.5,-161.98 265978.5,-161.98 265978.5,-109.98 266207.5,-109.98 266207.5,-161.98"/>
<text text-anchor="middle" x="266093" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L2</text>
<text text-anchor="middle" x="266093" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="266093" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="266093" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert9_l2_dp2 -->
<g id="edge1479" class="edge">
<title>router_l2_dp2&#45;&gt;expert9_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264354.65,-177.01C264414.23,-186.11 264478.61,-194.4 264538.5,-198.98 264697,-211.1 265812.26,-203.5 265969,-176.98 265984.83,-174.3 266001.39,-169.97 266017.06,-165.1"/>
<polygon fill="black" stroke="black" points="266018.24,-168.4 266026.69,-162.01 266016.1,-161.74 266018.24,-168.4"/>
<text text-anchor="middle" x="264560" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l2_dp2 -->
<g id="node887" class="node">
<title>expert10_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="265960.5,-161.98 265731.5,-161.98 265731.5,-109.98 265960.5,-109.98 265960.5,-161.98"/>
<text text-anchor="middle" x="265846" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L2</text>
<text text-anchor="middle" x="265846" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="265846" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="265846" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert10_l2_dp2 -->
<g id="edge1480" class="edge">
<title>router_l2_dp2&#45;&gt;expert10_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264366.1,-168.45C264396.64,-171.8 264427.53,-174.78 264457,-176.98 264865.53,-207.56 264969.04,-212.08 265378.5,-198.98 265531.4,-194.09 265571.82,-206.12 265722,-176.98 265737.06,-174.06 265752.83,-169.82 265767.87,-165.16"/>
<polygon fill="black" stroke="black" points="265769.17,-168.42 265777.64,-162.04 265767.05,-161.75 265769.17,-168.42"/>
<text text-anchor="middle" x="265357" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l2_dp2 -->
<g id="node888" class="node">
<title>expert11_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="265713.5,-161.98 265484.5,-161.98 265484.5,-109.98 265713.5,-109.98 265713.5,-161.98"/>
<text text-anchor="middle" x="265599" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L2</text>
<text text-anchor="middle" x="265599" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="265599" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="265599" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert11_l2_dp2 -->
<g id="edge1481" class="edge">
<title>router_l2_dp2&#45;&gt;expert11_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264375.89,-176.28C264443.94,-185.66 264517.91,-194.28 264586.5,-198.98 264783.54,-212.49 265280.43,-210.92 265475,-176.98 265490.72,-174.24 265507.17,-169.91 265522.76,-165.06"/>
<polygon fill="black" stroke="black" points="265523.89,-168.38 265532.35,-161.99 265521.75,-161.71 265523.89,-168.38"/>
<text text-anchor="middle" x="264608" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l2_dp2 -->
<g id="node889" class="node">
<title>expert12_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="265466.5,-161.98 265237.5,-161.98 265237.5,-109.98 265466.5,-109.98 265466.5,-161.98"/>
<text text-anchor="middle" x="265352" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L2</text>
<text text-anchor="middle" x="265352" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="265352" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="265352" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert12_l2_dp2 -->
<g id="edge1482" class="edge">
<title>router_l2_dp2&#45;&gt;expert12_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264365.25,-167.81C264396.07,-171.29 264427.26,-174.47 264457,-176.98 264457,-176.98 265228,-176.98 265228,-176.98 265242.65,-173.9 265258,-169.69 265272.7,-165.12"/>
<polygon fill="black" stroke="black" points="265273.79,-168.45 265282.26,-162.08 265271.67,-161.78 265273.79,-168.45"/>
<text text-anchor="middle" x="264975" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l2_dp2 -->
<g id="node890" class="node">
<title>expert13_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="265219.5,-161.98 264990.5,-161.98 264990.5,-109.98 265219.5,-109.98 265219.5,-161.98"/>
<text text-anchor="middle" x="265105" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L2</text>
<text text-anchor="middle" x="265105" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="265105" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="265105" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert13_l2_dp2 -->
<g id="edge1483" class="edge">
<title>router_l2_dp2&#45;&gt;expert13_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264359.04,-176.98C264531.78,-200.57 264773.28,-218.19 264981,-176.98 264995.96,-174.01 265011.62,-169.78 265026.58,-165.14"/>
<polygon fill="black" stroke="black" points="265027.83,-168.41 265036.29,-162.04 265025.7,-161.74 265027.83,-168.41"/>
<text text-anchor="middle" x="264656" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l2_dp2 -->
<g id="node891" class="node">
<title>expert14_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="264972.5,-161.98 264743.5,-161.98 264743.5,-109.98 264972.5,-109.98 264972.5,-161.98"/>
<text text-anchor="middle" x="264858" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L2</text>
<text text-anchor="middle" x="264858" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="264858" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="264858" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert14_l2_dp2 -->
<g id="edge1484" class="edge">
<title>router_l2_dp2&#45;&gt;expert14_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264368.4,-177C264503.73,-197.08 264658.84,-214.02 264725.5,-198.98 264753.7,-192.62 264782.94,-179.52 264806.75,-166.9"/>
<polygon fill="black" stroke="black" points="264808.48,-169.94 264815.6,-162.1 264805.14,-163.79 264808.48,-169.94"/>
<text text-anchor="middle" x="264704" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l2_dp2 -->
<g id="node892" class="node">
<title>expert15_l2_dp2</title>
<polygon fill="lightgreen" stroke="black" points="264695.5,-161.98 264466.5,-161.98 264466.5,-109.98 264695.5,-109.98 264695.5,-161.98"/>
<text text-anchor="middle" x="264581" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L2</text>
<text text-anchor="middle" x="264581" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="264581" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="264581" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp2&#45;&gt;expert15_l2_dp2 -->
<g id="edge1485" class="edge">
<title>router_l2_dp2&#45;&gt;expert15_l2_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M264325.94,-135.98C264370.13,-135.98 264415.83,-135.98 264456.12,-135.98"/>
<polygon fill="black" stroke="black" points="264456.25,-139.48 264466.25,-135.98 264456.25,-132.48 264456.25,-139.48"/>
<text text-anchor="middle" x="264421.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l2_dp2 -->
<g id="node893" class="node">
<title>expert_agg_l2_dp2</title>
<polygon fill="lightyellow" stroke="black" points="268961.57,-176.98 268567.74,-176.98 268466.43,-94.98 268860.26,-94.98 268961.57,-176.98"/>
<text text-anchor="middle" x="268714" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L2</text>
<text text-anchor="middle" x="268714" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="268714" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1486" class="edge">
<title>expert0_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M268430.66,-135.98C268456.06,-135.98 268481.47,-135.98 268506.87,-135.98"/>
<polygon fill="black" stroke="black" points="268506.99,-139.48 268516.99,-135.98 268506.99,-132.48 268506.99,-139.48"/>
</g>
<!-- expert1_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1487" class="edge">
<title>expert1_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M268124.24,-162.02C268147.4,-171.57 268174.96,-181.22 268201,-185.98 268251.06,-195.15 268379.3,-190.41 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert2_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1488" class="edge">
<title>expert2_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M267877.24,-162.02C267900.4,-171.57 267927.96,-181.22 267954,-185.98 268006.02,-195.51 268377.31,-190.59 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert3_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1489" class="edge">
<title>expert3_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M267630.24,-162.02C267653.4,-171.57 267680.96,-181.22 267707,-185.98 267786.02,-200.45 268349.97,-192.97 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert4_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1490" class="edge">
<title>expert4_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M267383.24,-162.02C267406.4,-171.57 267433.96,-181.22 267460,-185.98 267513.01,-195.69 268376.31,-190.67 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert5_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1491" class="edge">
<title>expert5_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M267136.24,-162.02C267159.4,-171.57 267186.96,-181.22 267213,-185.98 267279.5,-198.16 268362.64,-191.87 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert6_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1492" class="edge">
<title>expert6_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M266889.24,-162.02C266912.4,-171.57 266939.96,-181.22 266966,-185.98 267046,-200.63 268348.97,-193.06 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert7_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1493" class="edge">
<title>expert7_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M266642.24,-162.02C266665.4,-171.57 266692.96,-181.22 266719,-185.98 266765.75,-194.54 268382.65,-190.12 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert8_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1494" class="edge">
<title>expert8_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M266395.24,-162.02C266418.4,-171.57 266445.96,-181.22 266472,-185.98 266525.5,-195.78 268375.82,-190.72 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert9_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1495" class="edge">
<title>expert9_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M266148.24,-162.02C266171.4,-171.57 266198.96,-181.22 266225,-185.98 266285.25,-197.01 268368.98,-191.31 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert10_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1496" class="edge">
<title>expert10_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M265901.24,-162.02C265924.4,-171.57 265951.96,-181.22 265978,-185.98 266045,-198.25 268362.15,-191.91 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert11_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1497" class="edge">
<title>expert11_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M265654.24,-162.02C265677.4,-171.57 265704.96,-181.22 265731,-185.98 265804.75,-199.48 268355.31,-192.51 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert12_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1498" class="edge">
<title>expert12_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M265407.24,-162.02C265430.4,-171.57 265457.96,-181.22 265484,-185.98 265564.49,-200.72 268348.48,-193.1 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert13_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1499" class="edge">
<title>expert13_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M265160.24,-162.02C265183.4,-171.57 265210.96,-181.22 265237,-185.98 265280.62,-193.97 268385.82,-189.84 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert14_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1500" class="edge">
<title>expert14_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M264913.24,-162.02C264936.4,-171.57 264963.96,-181.22 264990,-185.98 265037,-194.59 268382.4,-190.14 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- expert15_l2_dp2&#45;&gt;expert_agg_l2_dp2 -->
<g id="edge1501" class="edge">
<title>expert15_l2_dp2&#45;&gt;expert_agg_l2_dp2</title>
<path fill="none" stroke="black" d="M264649.31,-162.04C264677.82,-171.6 264711.57,-181.24 264743,-185.98 264793.63,-193.62 268378.98,-190.44 268430,-185.98 268468.11,-182.65 268508.78,-176.86 268547.08,-170.36"/>
<polygon fill="black" stroke="black" points="268548.02,-173.75 268557.29,-168.6 268546.84,-166.85 268548.02,-173.75"/>
</g>
<!-- layer2_output_dp2 -->
<g id="node894" class="node">
<title>layer2_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="269166" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="269166" y="-144.48" font-family="Arial" font-size="10.00">Layer 2 Output</text>
<text text-anchor="middle" x="269166" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="269166" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l2_dp2&#45;&gt;layer2_output_dp2 -->
<g id="edge1502" class="edge">
<title>expert_agg_l2_dp2&#45;&gt;layer2_output_dp2</title>
<path fill="none" stroke="black" d="M268911.31,-135.98C268936.49,-135.98 268961.66,-135.98 268986.84,-135.98"/>
<polygon fill="black" stroke="black" points="268986.87,-139.48 268996.87,-135.98 268986.87,-132.48 268986.87,-139.48"/>
</g>
<!-- attn_input_l3_dp2 -->
<g id="node895" class="node">
<title>attn_input_l3_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="269539" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="269539" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L3</text>
<text text-anchor="middle" x="269539" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="269539" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer2_output_dp2&#45;&gt;attn_input_l3_dp2 -->
<g id="edge1503" class="edge">
<title>layer2_output_dp2&#45;&gt;attn_input_l3_dp2</title>
<path fill="none" stroke="black" d="M269335.01,-135.98C269343.23,-135.98 269351.44,-135.98 269359.66,-135.98"/>
<polygon fill="black" stroke="black" points="269359.68,-139.48 269369.68,-135.98 269359.68,-132.48 269359.68,-139.48"/>
</g>
<!-- attn_tp0_l3_dp2 -->
<g id="node896" class="node">
<title>attn_tp0_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="270837,-161.98 270577,-161.98 270577,-109.98 270837,-109.98 270837,-161.98"/>
<text text-anchor="middle" x="270707" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L3</text>
<text text-anchor="middle" x="270707" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="270707" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="270707" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp2&#45;&gt;attn_tp0_l3_dp2 -->
<g id="edge1504" class="edge">
<title>attn_input_l3_dp2&#45;&gt;attn_tp0_l3_dp2</title>
<path fill="none" stroke="black" d="M269622.52,-161.26C269659.12,-171.09 269702.81,-181.13 269743,-185.98 269788,-191.42 270514.27,-193.33 270559,-185.98 270584.4,-181.81 270611.31,-173.85 270635.12,-165.5"/>
<polygon fill="black" stroke="black" points="270636.55,-168.71 270644.78,-162.03 270634.18,-162.12 270636.55,-168.71"/>
</g>
<!-- attn_tp1_l3_dp2 -->
<g id="node897" class="node">
<title>attn_tp1_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="270559,-161.98 270299,-161.98 270299,-109.98 270559,-109.98 270559,-161.98"/>
<text text-anchor="middle" x="270429" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L3</text>
<text text-anchor="middle" x="270429" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="270429" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="270429" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp2&#45;&gt;attn_tp1_l3_dp2 -->
<g id="edge1505" class="edge">
<title>attn_input_l3_dp2&#45;&gt;attn_tp1_l3_dp2</title>
<path fill="none" stroke="black" d="M269622.52,-161.26C269659.12,-171.09 269702.81,-181.13 269743,-185.98 269802.35,-193.15 270222.01,-195.68 270281,-185.98 270306.4,-181.81 270333.31,-173.85 270357.12,-165.5"/>
<polygon fill="black" stroke="black" points="270358.55,-168.71 270366.78,-162.03 270356.18,-162.12 270358.55,-168.71"/>
</g>
<!-- attn_tp2_l3_dp2 -->
<g id="node898" class="node">
<title>attn_tp2_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="270281,-161.98 270021,-161.98 270021,-109.98 270281,-109.98 270281,-161.98"/>
<text text-anchor="middle" x="270151" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L3</text>
<text text-anchor="middle" x="270151" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="270151" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="270151" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp2&#45;&gt;attn_tp2_l3_dp2 -->
<g id="edge1506" class="edge">
<title>attn_input_l3_dp2&#45;&gt;attn_tp2_l3_dp2</title>
<path fill="none" stroke="black" d="M269622.52,-161.26C269659.12,-171.09 269702.81,-181.13 269743,-185.98 269800.36,-192.91 269945.99,-195.35 270003,-185.98 270028.4,-181.81 270055.31,-173.85 270079.12,-165.5"/>
<polygon fill="black" stroke="black" points="270080.55,-168.71 270088.78,-162.03 270078.18,-162.12 270080.55,-168.71"/>
</g>
<!-- attn_tp3_l3_dp2 -->
<g id="node899" class="node">
<title>attn_tp3_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="270003,-161.98 269743,-161.98 269743,-109.98 270003,-109.98 270003,-161.98"/>
<text text-anchor="middle" x="269873" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L3</text>
<text text-anchor="middle" x="269873" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="269873" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="269873" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp2&#45;&gt;attn_tp3_l3_dp2 -->
<g id="edge1507" class="edge">
<title>attn_input_l3_dp2&#45;&gt;attn_tp3_l3_dp2</title>
<path fill="none" stroke="black" d="M269708.28,-135.98C269716.35,-135.98 269724.42,-135.98 269732.49,-135.98"/>
<polygon fill="black" stroke="black" points="269732.7,-139.48 269742.7,-135.98 269732.7,-132.48 269732.7,-139.48"/>
</g>
<!-- allreduce_l3_dp2 -->
<g id="node900" class="node">
<title>allreduce_l3_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="271041" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="271041" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L3</text>
<text text-anchor="middle" x="271041" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="271041" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l3_dp2&#45;&gt;allreduce_l3_dp2 -->
<g id="edge1508" class="edge">
<title>attn_tp0_l3_dp2&#45;&gt;allreduce_l3_dp2</title>
<path fill="none" stroke="black" d="M270837.14,-135.98C270845.35,-135.98 270853.56,-135.98 270861.77,-135.98"/>
<polygon fill="black" stroke="black" points="270861.78,-139.48 270871.78,-135.98 270861.78,-132.48 270861.78,-139.48"/>
</g>
<!-- attn_tp1_l3_dp2&#45;&gt;allreduce_l3_dp2 -->
<g id="edge1509" class="edge">
<title>attn_tp1_l3_dp2&#45;&gt;allreduce_l3_dp2</title>
<path fill="none" stroke="black" d="M270491.22,-162.03C270517.24,-171.59 270548.1,-181.23 270577,-185.98 270634.01,-195.35 270779.64,-192.91 270837,-185.98 270873.57,-181.57 270913.05,-172.85 270947.44,-163.91"/>
<polygon fill="black" stroke="black" points="270948.7,-167.2 270957.47,-161.26 270946.91,-160.43 270948.7,-167.2"/>
</g>
<!-- attn_tp2_l3_dp2&#45;&gt;allreduce_l3_dp2 -->
<g id="edge1510" class="edge">
<title>attn_tp2_l3_dp2&#45;&gt;allreduce_l3_dp2</title>
<path fill="none" stroke="black" d="M270213.22,-162.03C270239.24,-171.59 270270.1,-181.23 270299,-185.98 270357.98,-195.68 270777.65,-193.15 270837,-185.98 270873.57,-181.57 270913.05,-172.85 270947.44,-163.91"/>
<polygon fill="black" stroke="black" points="270948.7,-167.2 270957.47,-161.26 270946.91,-160.43 270948.7,-167.2"/>
</g>
<!-- attn_tp3_l3_dp2&#45;&gt;allreduce_l3_dp2 -->
<g id="edge1511" class="edge">
<title>attn_tp3_l3_dp2&#45;&gt;allreduce_l3_dp2</title>
<path fill="none" stroke="black" d="M269935.22,-162.03C269961.24,-171.59 269992.1,-181.23 270021,-185.98 270065.73,-193.33 270791.99,-191.42 270837,-185.98 270873.57,-181.57 270913.05,-172.85 270947.44,-163.91"/>
<polygon fill="black" stroke="black" points="270948.7,-167.2 270957.47,-161.26 270946.91,-160.43 270948.7,-167.2"/>
</g>
<!-- moe_input_l3_dp2 -->
<g id="node901" class="node">
<title>moe_input_l3_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="271414" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="271414" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L3</text>
<text text-anchor="middle" x="271414" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="271414" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l3_dp2&#45;&gt;moe_input_l3_dp2 -->
<g id="edge1512" class="edge">
<title>allreduce_l3_dp2&#45;&gt;moe_input_l3_dp2</title>
<path fill="none" stroke="black" d="M271210.01,-135.98C271218.23,-135.98 271226.44,-135.98 271234.66,-135.98"/>
<polygon fill="black" stroke="black" points="271234.68,-139.48 271244.68,-135.98 271234.68,-132.48 271234.68,-139.48"/>
</g>
<!-- router_l3_dp2 -->
<g id="node902" class="node">
<title>router_l3_dp2</title>
<polygon fill="lightyellow" stroke="black" points="272113.57,-176.98 271719.74,-176.98 271618.43,-94.98 272012.26,-94.98 272113.57,-176.98"/>
<text text-anchor="middle" x="271866" y="-144.48" font-family="Arial" font-size="10.00">Router L3</text>
<text text-anchor="middle" x="271866" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="271866" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l3_dp2&#45;&gt;router_l3_dp2 -->
<g id="edge1513" class="edge">
<title>moe_input_l3_dp2&#45;&gt;router_l3_dp2</title>
<path fill="none" stroke="black" d="M271583.06,-135.98C271608.34,-135.98 271633.63,-135.98 271658.92,-135.98"/>
<polygon fill="black" stroke="black" points="271658.99,-139.48 271668.99,-135.98 271658.99,-132.48 271658.99,-139.48"/>
</g>
<!-- expert0_l3_dp2 -->
<g id="node903" class="node">
<title>expert0_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="276119.5,-161.98 275890.5,-161.98 275890.5,-109.98 276119.5,-109.98 276119.5,-161.98"/>
<text text-anchor="middle" x="276005" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L3</text>
<text text-anchor="middle" x="276005" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="276005" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="276005" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert0_l3_dp2 -->
<g id="edge1514" class="edge">
<title>router_l3_dp2&#45;&gt;expert0_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.74,-171.32C272128.09,-173.59 272149.41,-175.53 272170,-176.98 272930.47,-230.48 274838.15,-196.54 275600.5,-198.98 275725.55,-199.38 275758.59,-202.54 275881,-176.98 275895.75,-173.9 275911.19,-169.66 275925.98,-165.07"/>
<polygon fill="black" stroke="black" points="275927.12,-168.37 275935.59,-162 275925,-161.7 275927.12,-168.37"/>
<text text-anchor="middle" x="275622" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l3_dp2 -->
<g id="node904" class="node">
<title>expert1_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="275872.5,-161.98 275643.5,-161.98 275643.5,-109.98 275872.5,-109.98 275872.5,-161.98"/>
<text text-anchor="middle" x="275758" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L3</text>
<text text-anchor="middle" x="275758" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="275758" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="275758" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert1_l3_dp2 -->
<g id="edge1515" class="edge">
<title>router_l3_dp2&#45;&gt;expert1_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.74,-171.31C272128.09,-173.58 272149.41,-175.53 272170,-176.98 272869.05,-226.36 274622.71,-196.54 275323.5,-198.98 275461.84,-199.47 275498.43,-204.56 275634,-176.98 275648.85,-173.96 275664.41,-169.72 275679.28,-165.11"/>
<polygon fill="black" stroke="black" points="275680.48,-168.4 275688.94,-162.03 275678.35,-161.73 275680.48,-168.4"/>
<text text-anchor="middle" x="275345" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l3_dp2 -->
<g id="node905" class="node">
<title>expert2_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="275625.5,-161.98 275396.5,-161.98 275396.5,-109.98 275625.5,-109.98 275625.5,-161.98"/>
<text text-anchor="middle" x="275511" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L3</text>
<text text-anchor="middle" x="275511" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="275511" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="275511" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert2_l3_dp2 -->
<g id="edge1516" class="edge">
<title>router_l3_dp2&#45;&gt;expert2_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.74,-171.29C272128.1,-173.56 272149.41,-175.52 272170,-176.98 272801.21,-221.81 274384.71,-196.54 275017.5,-198.98 275182.01,-199.62 275225.55,-208.59 275387,-176.98 275402.06,-174.03 275417.82,-169.78 275432.86,-165.12"/>
<polygon fill="black" stroke="black" points="275434.17,-168.37 275442.63,-162 275432.04,-161.71 275434.17,-168.37"/>
<text text-anchor="middle" x="275039" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l3_dp2 -->
<g id="node906" class="node">
<title>expert3_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="275378.5,-161.98 275149.5,-161.98 275149.5,-109.98 275378.5,-109.98 275378.5,-161.98"/>
<text text-anchor="middle" x="275264" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L3</text>
<text text-anchor="middle" x="275264" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="275264" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="275264" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert3_l3_dp2 -->
<g id="edge1517" class="edge">
<title>router_l3_dp2&#45;&gt;expert3_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.74,-171.27C272128.1,-173.54 272149.41,-175.51 272170,-176.98 272720.28,-216.37 274100.82,-196.54 274652.5,-198.98 274869.38,-199.94 274926.79,-216.75 275140,-176.98 275155.27,-174.14 275171.24,-169.88 275186.45,-165.17"/>
<polygon fill="black" stroke="black" points="275187.86,-168.39 275196.32,-162.01 275185.73,-161.72 275187.86,-168.39"/>
<text text-anchor="middle" x="274674" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l3_dp2 -->
<g id="node907" class="node">
<title>expert4_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="275131.5,-161.98 274902.5,-161.98 274902.5,-109.98 275131.5,-109.98 275131.5,-161.98"/>
<text text-anchor="middle" x="275017" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L3</text>
<text text-anchor="middle" x="275017" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="275017" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="275017" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert4_l3_dp2 -->
<g id="edge1518" class="edge">
<title>router_l3_dp2&#45;&gt;expert4_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272011.67,-176.99C272050.3,-186.08 272092.21,-194.39 272131.5,-198.98 272150.48,-201.2 272155.39,-199.06 272174.5,-198.98 272476.56,-197.76 274594.97,-226.21 274893,-176.98 274908.93,-174.35 274925.6,-170.01 274941.35,-165.12"/>
<polygon fill="black" stroke="black" points="274942.58,-168.4 274951.03,-162.01 274940.44,-161.73 274942.58,-168.4"/>
<text text-anchor="middle" x="272153" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l3_dp2 -->
<g id="node908" class="node">
<title>expert5_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="274884.5,-161.98 274655.5,-161.98 274655.5,-109.98 274884.5,-109.98 274884.5,-161.98"/>
<text text-anchor="middle" x="274770" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L3</text>
<text text-anchor="middle" x="274770" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="274770" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="274770" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert5_l3_dp2 -->
<g id="edge1519" class="edge">
<title>router_l3_dp2&#45;&gt;expert5_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.74,-171.22C272128.1,-173.51 272149.42,-175.49 272170,-176.98 272613.19,-209.18 273725.15,-196.54 274169.5,-198.98 274381.5,-200.15 274437.61,-215.98 274646,-176.98 274661.26,-174.13 274677.24,-169.86 274692.45,-165.15"/>
<polygon fill="black" stroke="black" points="274693.86,-168.37 274702.32,-162 274691.73,-161.71 274693.86,-168.37"/>
<text text-anchor="middle" x="274191" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l3_dp2 -->
<g id="node909" class="node">
<title>expert6_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="274637.5,-161.98 274408.5,-161.98 274408.5,-109.98 274637.5,-109.98 274637.5,-161.98"/>
<text text-anchor="middle" x="274523" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L3</text>
<text text-anchor="middle" x="274523" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="274523" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="274523" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert6_l3_dp2 -->
<g id="edge1520" class="edge">
<title>router_l3_dp2&#45;&gt;expert6_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272038.37,-177C272083.98,-186.1 272133.37,-194.39 272179.5,-198.98 272198.52,-200.87 272203.39,-199.08 272222.5,-198.98 272464.34,-197.76 274160.43,-216.64 274399,-176.98 274414.84,-174.35 274431.4,-170.04 274447.07,-165.18"/>
<polygon fill="black" stroke="black" points="274448.25,-168.47 274456.7,-162.09 274446.11,-161.81 274448.25,-168.47"/>
<text text-anchor="middle" x="272201" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l3_dp2 -->
<g id="node910" class="node">
<title>expert7_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="274390.5,-161.98 274161.5,-161.98 274161.5,-109.98 274390.5,-109.98 274390.5,-161.98"/>
<text text-anchor="middle" x="274276" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L3</text>
<text text-anchor="middle" x="274276" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="274276" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="274276" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert7_l3_dp2 -->
<g id="edge1521" class="edge">
<title>router_l3_dp2&#45;&gt;expert7_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.33,-171.1C272127.83,-173.42 272149.29,-175.44 272170,-176.98 272518.07,-202.87 273391.59,-208.3 273740.5,-198.98 273923.58,-194.09 273972.02,-210.92 274152,-176.98 274167.17,-174.12 274183.04,-169.88 274198.17,-165.2"/>
<polygon fill="black" stroke="black" points="274199.52,-168.44 274207.99,-162.07 274197.4,-161.77 274199.52,-168.44"/>
<text text-anchor="middle" x="273719" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l3_dp2 -->
<g id="node911" class="node">
<title>expert8_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="274143.5,-161.98 273914.5,-161.98 273914.5,-109.98 274143.5,-109.98 274143.5,-161.98"/>
<text text-anchor="middle" x="274029" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L3</text>
<text text-anchor="middle" x="274029" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="274029" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="274029" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert8_l3_dp2 -->
<g id="edge1522" class="edge">
<title>router_l3_dp2&#45;&gt;expert8_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272065.02,-177C272117.62,-186.1 272174.5,-194.4 272227.5,-198.98 272246.54,-200.63 272251.39,-199.11 272270.5,-198.98 272452.12,-197.76 273725.88,-207.07 273905,-176.98 273920.83,-174.32 273937.39,-170 273953.07,-165.13"/>
<polygon fill="black" stroke="black" points="273954.24,-168.43 273962.7,-162.04 273952.1,-161.77 273954.24,-168.43"/>
<text text-anchor="middle" x="272249" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l3_dp2 -->
<g id="node912" class="node">
<title>expert9_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="273896.5,-161.98 273667.5,-161.98 273667.5,-109.98 273896.5,-109.98 273896.5,-161.98"/>
<text text-anchor="middle" x="273782" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L3</text>
<text text-anchor="middle" x="273782" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="273782" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="273782" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert9_l3_dp2 -->
<g id="edge1523" class="edge">
<title>router_l3_dp2&#45;&gt;expert9_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272106.35,-170.96C272127.84,-173.31 272149.29,-175.38 272170,-176.98 272666.17,-215.39 272792.07,-213.82 273289.5,-198.98 273453.49,-194.09 273496.87,-207.88 273658,-176.98 273673.16,-174.08 273689.03,-169.81 273704.15,-165.12"/>
<polygon fill="black" stroke="black" points="273705.51,-168.37 273713.97,-161.99 273703.38,-161.7 273705.51,-168.37"/>
<text text-anchor="middle" x="273268" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l3_dp2 -->
<g id="node913" class="node">
<title>expert10_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="273649.5,-161.98 273420.5,-161.98 273420.5,-109.98 273649.5,-109.98 273649.5,-161.98"/>
<text text-anchor="middle" x="273535" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L3</text>
<text text-anchor="middle" x="273535" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="273535" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="273535" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert10_l3_dp2 -->
<g id="edge1524" class="edge">
<title>router_l3_dp2&#45;&gt;expert10_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272091.65,-177.01C272151.23,-186.11 272215.61,-194.4 272275.5,-198.98 272401.32,-208.6 273286.62,-198.3 273411,-176.98 273426.73,-174.29 273443.18,-169.97 273458.78,-165.14"/>
<polygon fill="black" stroke="black" points="273459.9,-168.45 273468.36,-162.07 273457.77,-161.78 273459.9,-168.45"/>
<text text-anchor="middle" x="272297" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l3_dp2 -->
<g id="node914" class="node">
<title>expert11_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="273402.5,-161.98 273173.5,-161.98 273173.5,-109.98 273402.5,-109.98 273402.5,-161.98"/>
<text text-anchor="middle" x="273288" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L3</text>
<text text-anchor="middle" x="273288" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="273288" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="273288" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert11_l3_dp2 -->
<g id="edge1525" class="edge">
<title>router_l3_dp2&#45;&gt;expert11_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272105.95,-170.64C272127.58,-173.07 272149.17,-175.24 272170,-176.98 272485.71,-203.39 272565.92,-211.33 272882.5,-198.98 273007.9,-194.09 273040.97,-201.75 273164,-176.98 273178.86,-173.99 273194.42,-169.77 273209.29,-165.16"/>
<polygon fill="black" stroke="black" points="273210.48,-168.45 273218.95,-162.08 273208.36,-161.78 273210.48,-168.45"/>
<text text-anchor="middle" x="272861" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l3_dp2 -->
<g id="node915" class="node">
<title>expert12_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="273155.5,-161.98 272926.5,-161.98 272926.5,-109.98 273155.5,-109.98 273155.5,-161.98"/>
<text text-anchor="middle" x="273041" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L3</text>
<text text-anchor="middle" x="273041" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="273041" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="273041" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert12_l3_dp2 -->
<g id="edge1526" class="edge">
<title>router_l3_dp2&#45;&gt;expert12_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272112.89,-176.28C272180.94,-185.66 272254.91,-194.28 272323.5,-198.98 272455.17,-208.01 272787.14,-200.56 272917,-176.98 272932.37,-174.19 272948.45,-169.93 272963.75,-165.2"/>
<polygon fill="black" stroke="black" points="272965.21,-168.41 272973.67,-162.03 272963.08,-161.74 272965.21,-168.41"/>
<text text-anchor="middle" x="272345" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l3_dp2 -->
<g id="node916" class="node">
<title>expert13_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="272908.5,-161.98 272679.5,-161.98 272679.5,-109.98 272908.5,-109.98 272908.5,-161.98"/>
<text text-anchor="middle" x="272794" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L3</text>
<text text-anchor="middle" x="272794" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="272794" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="272794" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert13_l3_dp2 -->
<g id="edge1527" class="edge">
<title>router_l3_dp2&#45;&gt;expert13_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272083.82,-177.02C272220.96,-197.58 272401.66,-215.02 272561.5,-198.98 272612.66,-193.85 272668.31,-179.11 272712.33,-165.18"/>
<polygon fill="black" stroke="black" points="272713.66,-168.43 272722.11,-162.04 272711.52,-161.77 272713.66,-168.43"/>
<text text-anchor="middle" x="272540" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l3_dp2 -->
<g id="node917" class="node">
<title>expert14_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="272661.5,-161.98 272432.5,-161.98 272432.5,-109.98 272661.5,-109.98 272661.5,-161.98"/>
<text text-anchor="middle" x="272547" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L3</text>
<text text-anchor="middle" x="272547" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="272547" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="272547" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert14_l3_dp2 -->
<g id="edge1528" class="edge">
<title>router_l3_dp2&#45;&gt;expert14_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272091.44,-176.99C272214.58,-196.39 272354.01,-212.63 272414.5,-198.98 272442.7,-192.62 272471.94,-179.52 272495.75,-166.9"/>
<polygon fill="black" stroke="black" points="272497.48,-169.94 272504.6,-162.1 272494.14,-163.79 272497.48,-169.94"/>
<text text-anchor="middle" x="272393" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l3_dp2 -->
<g id="node918" class="node">
<title>expert15_l3_dp2</title>
<polygon fill="lightgreen" stroke="black" points="272408.5,-161.98 272179.5,-161.98 272179.5,-109.98 272408.5,-109.98 272408.5,-161.98"/>
<text text-anchor="middle" x="272294" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L3</text>
<text text-anchor="middle" x="272294" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="272294" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="272294" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp2&#45;&gt;expert15_l3_dp2 -->
<g id="edge1529" class="edge">
<title>router_l3_dp2&#45;&gt;expert15_l3_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M272063.09,-135.98C272099.17,-135.98 272135.91,-135.98 272169.14,-135.98"/>
<polygon fill="black" stroke="black" points="272169.34,-139.48 272179.34,-135.98 272169.34,-132.48 272169.34,-139.48"/>
<text text-anchor="middle" x="272146.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l3_dp2 -->
<g id="node919" class="node">
<title>expert_agg_l3_dp2</title>
<polygon fill="lightyellow" stroke="black" points="276650.57,-176.98 276256.74,-176.98 276155.43,-94.98 276549.26,-94.98 276650.57,-176.98"/>
<text text-anchor="middle" x="276403" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L3</text>
<text text-anchor="middle" x="276403" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="276403" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1530" class="edge">
<title>expert0_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M276119.66,-135.98C276145.06,-135.98 276170.47,-135.98 276195.87,-135.98"/>
<polygon fill="black" stroke="black" points="276195.99,-139.48 276205.99,-135.98 276195.99,-132.48 276195.99,-139.48"/>
</g>
<!-- expert1_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1531" class="edge">
<title>expert1_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M275813.24,-162.02C275836.4,-171.57 275863.96,-181.22 275890,-185.98 275940.06,-195.15 276068.3,-190.41 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert2_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1532" class="edge">
<title>expert2_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M275566.24,-162.02C275589.4,-171.57 275616.96,-181.22 275643,-185.98 275695.02,-195.51 276066.31,-190.59 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert3_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1533" class="edge">
<title>expert3_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M275319.24,-162.02C275342.4,-171.57 275369.96,-181.22 275396,-185.98 275475.02,-200.45 276038.97,-192.97 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert4_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1534" class="edge">
<title>expert4_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M275072.24,-162.02C275095.4,-171.57 275122.96,-181.22 275149,-185.98 275202.01,-195.69 276065.31,-190.67 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert5_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1535" class="edge">
<title>expert5_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M274825.24,-162.02C274848.4,-171.57 274875.96,-181.22 274902,-185.98 274968.5,-198.16 276051.64,-191.87 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert6_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1536" class="edge">
<title>expert6_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M274578.24,-162.02C274601.4,-171.57 274628.96,-181.22 274655,-185.98 274735,-200.63 276037.97,-193.06 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert7_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1537" class="edge">
<title>expert7_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M274331.24,-162.02C274354.4,-171.57 274381.96,-181.22 274408,-185.98 274454.75,-194.54 276071.65,-190.12 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert8_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1538" class="edge">
<title>expert8_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M274084.24,-162.02C274107.4,-171.57 274134.96,-181.22 274161,-185.98 274214.5,-195.78 276064.82,-190.72 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert9_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1539" class="edge">
<title>expert9_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M273837.24,-162.02C273860.4,-171.57 273887.96,-181.22 273914,-185.98 273974.25,-197.01 276057.98,-191.31 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert10_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1540" class="edge">
<title>expert10_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M273590.24,-162.02C273613.4,-171.57 273640.96,-181.22 273667,-185.98 273734,-198.25 276051.15,-191.91 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert11_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1541" class="edge">
<title>expert11_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M273343.24,-162.02C273366.4,-171.57 273393.96,-181.22 273420,-185.98 273493.75,-199.48 276044.31,-192.51 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert12_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1542" class="edge">
<title>expert12_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M273096.24,-162.02C273119.4,-171.57 273146.96,-181.22 273173,-185.98 273253.49,-200.72 276037.48,-193.1 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert13_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1543" class="edge">
<title>expert13_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M272849.24,-162.02C272872.4,-171.57 272899.96,-181.22 272926,-185.98 272969.62,-193.97 276074.82,-189.84 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert14_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1544" class="edge">
<title>expert14_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M272602.24,-162.02C272625.4,-171.57 272652.96,-181.22 272679,-185.98 272726,-194.59 276071.4,-190.14 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- expert15_l3_dp2&#45;&gt;expert_agg_l3_dp2 -->
<g id="edge1545" class="edge">
<title>expert15_l3_dp2&#45;&gt;expert_agg_l3_dp2</title>
<path fill="none" stroke="black" d="M272351.86,-162.02C272376.1,-171.58 272404.89,-181.22 272432,-185.98 272482.44,-194.84 276067.98,-190.44 276119,-185.98 276157.11,-182.65 276197.78,-176.86 276236.08,-170.36"/>
<polygon fill="black" stroke="black" points="276237.02,-173.75 276246.29,-168.6 276235.84,-166.85 276237.02,-173.75"/>
</g>
<!-- layer3_output_dp2 -->
<g id="node920" class="node">
<title>layer3_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="276855" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="276855" y="-144.48" font-family="Arial" font-size="10.00">Layer 3 Output</text>
<text text-anchor="middle" x="276855" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="276855" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l3_dp2&#45;&gt;layer3_output_dp2 -->
<g id="edge1546" class="edge">
<title>expert_agg_l3_dp2&#45;&gt;layer3_output_dp2</title>
<path fill="none" stroke="black" d="M276600.31,-135.98C276625.49,-135.98 276650.66,-135.98 276675.84,-135.98"/>
<polygon fill="black" stroke="black" points="276675.87,-139.48 276685.87,-135.98 276675.87,-132.48 276675.87,-139.48"/>
</g>
<!-- attn_input_l4_dp2 -->
<g id="node921" class="node">
<title>attn_input_l4_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="277228" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="277228" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L4</text>
<text text-anchor="middle" x="277228" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="277228" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer3_output_dp2&#45;&gt;attn_input_l4_dp2 -->
<g id="edge1547" class="edge">
<title>layer3_output_dp2&#45;&gt;attn_input_l4_dp2</title>
<path fill="none" stroke="black" d="M277024.01,-135.98C277032.23,-135.98 277040.44,-135.98 277048.66,-135.98"/>
<polygon fill="black" stroke="black" points="277048.68,-139.48 277058.68,-135.98 277048.68,-132.48 277048.68,-139.48"/>
</g>
<!-- attn_tp0_l4_dp2 -->
<g id="node922" class="node">
<title>attn_tp0_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="278526,-161.98 278266,-161.98 278266,-109.98 278526,-109.98 278526,-161.98"/>
<text text-anchor="middle" x="278396" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L4</text>
<text text-anchor="middle" x="278396" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="278396" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="278396" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp2&#45;&gt;attn_tp0_l4_dp2 -->
<g id="edge1548" class="edge">
<title>attn_input_l4_dp2&#45;&gt;attn_tp0_l4_dp2</title>
<path fill="none" stroke="black" d="M277311.52,-161.26C277348.12,-171.09 277391.81,-181.13 277432,-185.98 277477,-191.42 278203.27,-193.33 278248,-185.98 278273.4,-181.81 278300.31,-173.85 278324.12,-165.5"/>
<polygon fill="black" stroke="black" points="278325.55,-168.71 278333.78,-162.03 278323.18,-162.12 278325.55,-168.71"/>
</g>
<!-- attn_tp1_l4_dp2 -->
<g id="node923" class="node">
<title>attn_tp1_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="278248,-161.98 277988,-161.98 277988,-109.98 278248,-109.98 278248,-161.98"/>
<text text-anchor="middle" x="278118" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L4</text>
<text text-anchor="middle" x="278118" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="278118" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="278118" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp2&#45;&gt;attn_tp1_l4_dp2 -->
<g id="edge1549" class="edge">
<title>attn_input_l4_dp2&#45;&gt;attn_tp1_l4_dp2</title>
<path fill="none" stroke="black" d="M277311.52,-161.26C277348.12,-171.09 277391.81,-181.13 277432,-185.98 277491.35,-193.15 277911.01,-195.68 277970,-185.98 277995.4,-181.81 278022.31,-173.85 278046.12,-165.5"/>
<polygon fill="black" stroke="black" points="278047.55,-168.71 278055.78,-162.03 278045.18,-162.12 278047.55,-168.71"/>
</g>
<!-- attn_tp2_l4_dp2 -->
<g id="node924" class="node">
<title>attn_tp2_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="277970,-161.98 277710,-161.98 277710,-109.98 277970,-109.98 277970,-161.98"/>
<text text-anchor="middle" x="277840" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L4</text>
<text text-anchor="middle" x="277840" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="277840" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="277840" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp2&#45;&gt;attn_tp2_l4_dp2 -->
<g id="edge1550" class="edge">
<title>attn_input_l4_dp2&#45;&gt;attn_tp2_l4_dp2</title>
<path fill="none" stroke="black" d="M277311.52,-161.26C277348.12,-171.09 277391.81,-181.13 277432,-185.98 277489.36,-192.91 277634.99,-195.35 277692,-185.98 277717.4,-181.81 277744.31,-173.85 277768.12,-165.5"/>
<polygon fill="black" stroke="black" points="277769.55,-168.71 277777.78,-162.03 277767.18,-162.12 277769.55,-168.71"/>
</g>
<!-- attn_tp3_l4_dp2 -->
<g id="node925" class="node">
<title>attn_tp3_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="277692,-161.98 277432,-161.98 277432,-109.98 277692,-109.98 277692,-161.98"/>
<text text-anchor="middle" x="277562" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L4</text>
<text text-anchor="middle" x="277562" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="277562" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="277562" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp2&#45;&gt;attn_tp3_l4_dp2 -->
<g id="edge1551" class="edge">
<title>attn_input_l4_dp2&#45;&gt;attn_tp3_l4_dp2</title>
<path fill="none" stroke="black" d="M277397.28,-135.98C277405.35,-135.98 277413.42,-135.98 277421.49,-135.98"/>
<polygon fill="black" stroke="black" points="277421.7,-139.48 277431.7,-135.98 277421.7,-132.48 277421.7,-139.48"/>
</g>
<!-- allreduce_l4_dp2 -->
<g id="node926" class="node">
<title>allreduce_l4_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="278730" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="278730" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L4</text>
<text text-anchor="middle" x="278730" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="278730" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l4_dp2&#45;&gt;allreduce_l4_dp2 -->
<g id="edge1552" class="edge">
<title>attn_tp0_l4_dp2&#45;&gt;allreduce_l4_dp2</title>
<path fill="none" stroke="black" d="M278526.14,-135.98C278534.35,-135.98 278542.56,-135.98 278550.77,-135.98"/>
<polygon fill="black" stroke="black" points="278550.78,-139.48 278560.78,-135.98 278550.78,-132.48 278550.78,-139.48"/>
</g>
<!-- attn_tp1_l4_dp2&#45;&gt;allreduce_l4_dp2 -->
<g id="edge1553" class="edge">
<title>attn_tp1_l4_dp2&#45;&gt;allreduce_l4_dp2</title>
<path fill="none" stroke="black" d="M278180.22,-162.03C278206.24,-171.59 278237.1,-181.23 278266,-185.98 278323.01,-195.35 278468.64,-192.91 278526,-185.98 278562.57,-181.57 278602.05,-172.85 278636.44,-163.91"/>
<polygon fill="black" stroke="black" points="278637.7,-167.2 278646.47,-161.26 278635.91,-160.43 278637.7,-167.2"/>
</g>
<!-- attn_tp2_l4_dp2&#45;&gt;allreduce_l4_dp2 -->
<g id="edge1554" class="edge">
<title>attn_tp2_l4_dp2&#45;&gt;allreduce_l4_dp2</title>
<path fill="none" stroke="black" d="M277902.22,-162.03C277928.24,-171.59 277959.1,-181.23 277988,-185.98 278046.98,-195.68 278466.65,-193.15 278526,-185.98 278562.57,-181.57 278602.05,-172.85 278636.44,-163.91"/>
<polygon fill="black" stroke="black" points="278637.7,-167.2 278646.47,-161.26 278635.91,-160.43 278637.7,-167.2"/>
</g>
<!-- attn_tp3_l4_dp2&#45;&gt;allreduce_l4_dp2 -->
<g id="edge1555" class="edge">
<title>attn_tp3_l4_dp2&#45;&gt;allreduce_l4_dp2</title>
<path fill="none" stroke="black" d="M277624.22,-162.03C277650.24,-171.59 277681.1,-181.23 277710,-185.98 277754.73,-193.33 278480.99,-191.42 278526,-185.98 278562.57,-181.57 278602.05,-172.85 278636.44,-163.91"/>
<polygon fill="black" stroke="black" points="278637.7,-167.2 278646.47,-161.26 278635.91,-160.43 278637.7,-167.2"/>
</g>
<!-- moe_input_l4_dp2 -->
<g id="node927" class="node">
<title>moe_input_l4_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="279103" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="279103" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L4</text>
<text text-anchor="middle" x="279103" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="279103" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l4_dp2&#45;&gt;moe_input_l4_dp2 -->
<g id="edge1556" class="edge">
<title>allreduce_l4_dp2&#45;&gt;moe_input_l4_dp2</title>
<path fill="none" stroke="black" d="M278899.01,-135.98C278907.23,-135.98 278915.44,-135.98 278923.66,-135.98"/>
<polygon fill="black" stroke="black" points="278923.68,-139.48 278933.68,-135.98 278923.68,-132.48 278923.68,-139.48"/>
</g>
<!-- router_l4_dp2 -->
<g id="node928" class="node">
<title>router_l4_dp2</title>
<polygon fill="lightyellow" stroke="black" points="279802.57,-176.98 279408.74,-176.98 279307.43,-94.98 279701.26,-94.98 279802.57,-176.98"/>
<text text-anchor="middle" x="279555" y="-144.48" font-family="Arial" font-size="10.00">Router L4</text>
<text text-anchor="middle" x="279555" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="279555" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l4_dp2&#45;&gt;router_l4_dp2 -->
<g id="edge1557" class="edge">
<title>moe_input_l4_dp2&#45;&gt;router_l4_dp2</title>
<path fill="none" stroke="black" d="M279272.06,-135.98C279297.34,-135.98 279322.63,-135.98 279347.92,-135.98"/>
<polygon fill="black" stroke="black" points="279347.99,-139.48 279357.99,-135.98 279347.99,-132.48 279347.99,-139.48"/>
</g>
<!-- expert0_l4_dp2 -->
<g id="node929" class="node">
<title>expert0_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="283856.5,-161.98 283627.5,-161.98 283627.5,-109.98 283856.5,-109.98 283856.5,-161.98"/>
<text text-anchor="middle" x="283742" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L4</text>
<text text-anchor="middle" x="283742" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="283742" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="283742" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert0_l4_dp2 -->
<g id="edge1558" class="edge">
<title>router_l4_dp2&#45;&gt;expert0_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.95,-169.07C279823.21,-172.29 279853.79,-175.07 279883,-176.98 280642.17,-226.7 282545.71,-196.54 283306.5,-198.98 283445.29,-199.43 283481.99,-204.63 283618,-176.98 283632.85,-173.96 283648.41,-169.72 283663.28,-165.11"/>
<polygon fill="black" stroke="black" points="283664.48,-168.4 283672.94,-162.03 283662.35,-161.73 283664.48,-168.4"/>
<text text-anchor="middle" x="283328" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l4_dp2 -->
<g id="node930" class="node">
<title>expert1_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="283609.5,-161.98 283380.5,-161.98 283380.5,-109.98 283609.5,-109.98 283609.5,-161.98"/>
<text text-anchor="middle" x="283495" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L4</text>
<text text-anchor="middle" x="283495" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="283495" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="283495" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert1_l4_dp2 -->
<g id="edge1559" class="edge">
<title>router_l4_dp2&#45;&gt;expert1_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.95,-169.05C279823.21,-172.28 279853.79,-175.06 279883,-176.98 280574.08,-222.46 282306.93,-196.54 282999.5,-198.98 283164.9,-199.57 283208.67,-208.72 283371,-176.98 283386.06,-174.04 283401.82,-169.78 283416.86,-165.12"/>
<polygon fill="black" stroke="black" points="283418.17,-168.38 283426.63,-162.01 283416.04,-161.71 283418.17,-168.38"/>
<text text-anchor="middle" x="283021" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l4_dp2 -->
<g id="node931" class="node">
<title>expert2_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="283362.5,-161.98 283133.5,-161.98 283133.5,-109.98 283362.5,-109.98 283362.5,-161.98"/>
<text text-anchor="middle" x="283248" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L4</text>
<text text-anchor="middle" x="283248" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="283248" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="283248" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert2_l4_dp2 -->
<g id="edge1560" class="edge">
<title>router_l4_dp2&#45;&gt;expert2_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.95,-169.03C279823.21,-172.26 279853.79,-175.05 279883,-176.98 280492.68,-217.39 282021.48,-196.54 282632.5,-198.98 282851.16,-199.86 282909.03,-217.03 283124,-176.98 283139.27,-174.14 283155.24,-169.88 283170.45,-165.17"/>
<polygon fill="black" stroke="black" points="283171.86,-168.4 283180.32,-162.02 283169.73,-161.73 283171.86,-168.4"/>
<text text-anchor="middle" x="282654" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l4_dp2 -->
<g id="node932" class="node">
<title>expert3_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="283115.5,-161.98 282886.5,-161.98 282886.5,-109.98 283115.5,-109.98 283115.5,-161.98"/>
<text text-anchor="middle" x="283001" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L4</text>
<text text-anchor="middle" x="283001" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="283001" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="283001" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert3_l4_dp2 -->
<g id="edge1561" class="edge">
<title>router_l4_dp2&#45;&gt;expert3_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279700.67,-176.99C279739.3,-186.08 279781.21,-194.39 279820.5,-198.98 279839.48,-201.2 279844.39,-199.05 279863.5,-198.98 280198.34,-197.76 282546.61,-231.42 282877,-176.98 282892.93,-174.36 282909.6,-170.02 282925.35,-165.13"/>
<polygon fill="black" stroke="black" points="282926.58,-168.41 282935.03,-162.02 282924.44,-161.74 282926.58,-168.41"/>
<text text-anchor="middle" x="279842" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l4_dp2 -->
<g id="node933" class="node">
<title>expert4_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="282868.5,-161.98 282639.5,-161.98 282639.5,-109.98 282868.5,-109.98 282868.5,-161.98"/>
<text text-anchor="middle" x="282754" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L4</text>
<text text-anchor="middle" x="282754" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="282754" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="282754" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert4_l4_dp2 -->
<g id="edge1562" class="edge">
<title>router_l4_dp2&#45;&gt;expert4_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.95,-168.98C279823.21,-172.22 279853.8,-175.02 279883,-176.98 280384.67,-210.66 281642.7,-196.54 282145.5,-198.98 282361.05,-200.03 282418.1,-216.54 282630,-176.98 282645.27,-174.13 282661.24,-169.87 282676.45,-165.16"/>
<polygon fill="black" stroke="black" points="282677.86,-168.39 282686.32,-162.01 282675.73,-161.72 282677.86,-168.39"/>
<text text-anchor="middle" x="282167" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l4_dp2 -->
<g id="node934" class="node">
<title>expert5_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="282621.5,-161.98 282392.5,-161.98 282392.5,-109.98 282621.5,-109.98 282621.5,-161.98"/>
<text text-anchor="middle" x="282507" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L4</text>
<text text-anchor="middle" x="282507" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="282507" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="282507" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert5_l4_dp2 -->
<g id="edge1563" class="edge">
<title>router_l4_dp2&#45;&gt;expert5_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279727.37,-177C279772.98,-186.1 279822.37,-194.39 279868.5,-198.98 279887.52,-200.87 279892.39,-199.07 279911.5,-198.98 280186.12,-197.76 282112.07,-221.85 282383,-176.98 282398.93,-174.34 282415.59,-170 282431.35,-165.11"/>
<polygon fill="black" stroke="black" points="282432.58,-168.39 282441.03,-162 282430.44,-161.72 282432.58,-168.39"/>
<text text-anchor="middle" x="279890" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l4_dp2 -->
<g id="node935" class="node">
<title>expert6_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="282374.5,-161.98 282145.5,-161.98 282145.5,-109.98 282374.5,-109.98 282374.5,-161.98"/>
<text text-anchor="middle" x="282260" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L4</text>
<text text-anchor="middle" x="282260" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="282260" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="282260" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert6_l4_dp2 -->
<g id="edge1564" class="edge">
<title>router_l4_dp2&#45;&gt;expert6_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.96,-168.9C279823.22,-172.15 279853.8,-174.98 279883,-176.98 280287.75,-204.69 281302.94,-209.41 281708.5,-198.98 281898.69,-194.09 281949.01,-212.05 282136,-176.98 282151.26,-174.12 282167.24,-169.85 282182.45,-165.14"/>
<polygon fill="black" stroke="black" points="282183.85,-168.37 282192.32,-161.99 282181.73,-161.7 282183.85,-168.37"/>
<text text-anchor="middle" x="281687" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l4_dp2 -->
<g id="node936" class="node">
<title>expert7_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="282127.5,-161.98 281898.5,-161.98 281898.5,-109.98 282127.5,-109.98 282127.5,-161.98"/>
<text text-anchor="middle" x="282013" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L4</text>
<text text-anchor="middle" x="282013" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="282013" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="282013" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert7_l4_dp2 -->
<g id="edge1565" class="edge">
<title>router_l4_dp2&#45;&gt;expert7_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279754.02,-177C279806.62,-186.1 279863.5,-194.4 279916.5,-198.98 279935.54,-200.63 279940.39,-199.09 279959.5,-198.98 280173.9,-197.76 281677.52,-212.28 281889,-176.98 281904.83,-174.34 281921.4,-170.02 281937.07,-165.16"/>
<polygon fill="black" stroke="black" points="281938.25,-168.46 281946.7,-162.07 281936.11,-161.79 281938.25,-168.46"/>
<text text-anchor="middle" x="279938" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l4_dp2 -->
<g id="node937" class="node">
<title>expert8_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="281880.5,-161.98 281651.5,-161.98 281651.5,-109.98 281880.5,-109.98 281880.5,-161.98"/>
<text text-anchor="middle" x="281766" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L4</text>
<text text-anchor="middle" x="281766" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="281766" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="281766" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert8_l4_dp2 -->
<g id="edge1566" class="edge">
<title>router_l4_dp2&#45;&gt;expert8_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.52,-168.73C279822.92,-172.02 279853.66,-174.91 279883,-176.98 280184.4,-198.28 280940.46,-207.29 281242.5,-198.98 281420.26,-194.09 281467.28,-210.07 281642,-176.98 281657.17,-174.11 281673.04,-169.87 281688.16,-165.18"/>
<polygon fill="black" stroke="black" points="281689.52,-168.42 281697.98,-162.05 281687.39,-161.75 281689.52,-168.42"/>
<text text-anchor="middle" x="281221" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l4_dp2 -->
<g id="node938" class="node">
<title>expert9_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="281633.5,-161.98 281404.5,-161.98 281404.5,-109.98 281633.5,-109.98 281633.5,-161.98"/>
<text text-anchor="middle" x="281519" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L4</text>
<text text-anchor="middle" x="281519" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="281519" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="281519" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert9_l4_dp2 -->
<g id="edge1567" class="edge">
<title>router_l4_dp2&#45;&gt;expert9_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279780.65,-177.01C279840.23,-186.11 279904.61,-194.4 279964.5,-198.98 280123,-211.1 281238.26,-203.5 281395,-176.98 281410.83,-174.3 281427.39,-169.97 281443.06,-165.1"/>
<polygon fill="black" stroke="black" points="281444.24,-168.4 281452.69,-162.01 281442.1,-161.74 281444.24,-168.4"/>
<text text-anchor="middle" x="279986" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l4_dp2 -->
<g id="node939" class="node">
<title>expert10_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="281386.5,-161.98 281157.5,-161.98 281157.5,-109.98 281386.5,-109.98 281386.5,-161.98"/>
<text text-anchor="middle" x="281272" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L4</text>
<text text-anchor="middle" x="281272" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="281272" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="281272" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert10_l4_dp2 -->
<g id="edge1568" class="edge">
<title>router_l4_dp2&#45;&gt;expert10_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279792.1,-168.45C279822.64,-171.8 279853.53,-174.78 279883,-176.98 280291.53,-207.56 280395.04,-212.08 280804.5,-198.98 280957.4,-194.09 280997.82,-206.12 281148,-176.98 281163.06,-174.06 281178.83,-169.82 281193.87,-165.16"/>
<polygon fill="black" stroke="black" points="281195.17,-168.42 281203.64,-162.04 281193.05,-161.75 281195.17,-168.42"/>
<text text-anchor="middle" x="280783" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l4_dp2 -->
<g id="node940" class="node">
<title>expert11_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="281139.5,-161.98 280910.5,-161.98 280910.5,-109.98 281139.5,-109.98 281139.5,-161.98"/>
<text text-anchor="middle" x="281025" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L4</text>
<text text-anchor="middle" x="281025" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="281025" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="281025" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert11_l4_dp2 -->
<g id="edge1569" class="edge">
<title>router_l4_dp2&#45;&gt;expert11_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279801.89,-176.28C279869.94,-185.66 279943.91,-194.28 280012.5,-198.98 280209.54,-212.49 280706.43,-210.92 280901,-176.98 280916.72,-174.24 280933.17,-169.91 280948.76,-165.06"/>
<polygon fill="black" stroke="black" points="280949.89,-168.38 280958.35,-161.99 280947.75,-161.71 280949.89,-168.38"/>
<text text-anchor="middle" x="280034" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l4_dp2 -->
<g id="node941" class="node">
<title>expert12_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="280892.5,-161.98 280663.5,-161.98 280663.5,-109.98 280892.5,-109.98 280892.5,-161.98"/>
<text text-anchor="middle" x="280778" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L4</text>
<text text-anchor="middle" x="280778" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="280778" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="280778" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert12_l4_dp2 -->
<g id="edge1570" class="edge">
<title>router_l4_dp2&#45;&gt;expert12_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279791.25,-167.81C279822.07,-171.29 279853.26,-174.47 279883,-176.98 279883,-176.98 280654,-176.98 280654,-176.98 280668.65,-173.9 280684,-169.69 280698.7,-165.12"/>
<polygon fill="black" stroke="black" points="280699.79,-168.45 280708.26,-162.08 280697.67,-161.78 280699.79,-168.45"/>
<text text-anchor="middle" x="280401" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l4_dp2 -->
<g id="node942" class="node">
<title>expert13_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="280645.5,-161.98 280416.5,-161.98 280416.5,-109.98 280645.5,-109.98 280645.5,-161.98"/>
<text text-anchor="middle" x="280531" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L4</text>
<text text-anchor="middle" x="280531" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="280531" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="280531" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert13_l4_dp2 -->
<g id="edge1571" class="edge">
<title>router_l4_dp2&#45;&gt;expert13_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279785.04,-176.98C279957.78,-200.57 280199.28,-218.19 280407,-176.98 280421.96,-174.01 280437.62,-169.78 280452.58,-165.14"/>
<polygon fill="black" stroke="black" points="280453.83,-168.41 280462.29,-162.04 280451.7,-161.74 280453.83,-168.41"/>
<text text-anchor="middle" x="280082" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l4_dp2 -->
<g id="node943" class="node">
<title>expert14_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="280398.5,-161.98 280169.5,-161.98 280169.5,-109.98 280398.5,-109.98 280398.5,-161.98"/>
<text text-anchor="middle" x="280284" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L4</text>
<text text-anchor="middle" x="280284" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="280284" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="280284" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert14_l4_dp2 -->
<g id="edge1572" class="edge">
<title>router_l4_dp2&#45;&gt;expert14_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279794.4,-177C279929.73,-197.08 280084.84,-214.02 280151.5,-198.98 280179.7,-192.62 280208.94,-179.52 280232.75,-166.9"/>
<polygon fill="black" stroke="black" points="280234.48,-169.94 280241.6,-162.1 280231.14,-163.79 280234.48,-169.94"/>
<text text-anchor="middle" x="280130" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l4_dp2 -->
<g id="node944" class="node">
<title>expert15_l4_dp2</title>
<polygon fill="lightgreen" stroke="black" points="280121.5,-161.98 279892.5,-161.98 279892.5,-109.98 280121.5,-109.98 280121.5,-161.98"/>
<text text-anchor="middle" x="280007" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L4</text>
<text text-anchor="middle" x="280007" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="280007" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="280007" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp2&#45;&gt;expert15_l4_dp2 -->
<g id="edge1573" class="edge">
<title>router_l4_dp2&#45;&gt;expert15_l4_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M279751.94,-135.98C279796.13,-135.98 279841.83,-135.98 279882.12,-135.98"/>
<polygon fill="black" stroke="black" points="279882.25,-139.48 279892.25,-135.98 279882.25,-132.48 279882.25,-139.48"/>
<text text-anchor="middle" x="279847.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l4_dp2 -->
<g id="node945" class="node">
<title>expert_agg_l4_dp2</title>
<polygon fill="lightyellow" stroke="black" points="284387.57,-176.98 283993.74,-176.98 283892.43,-94.98 284286.26,-94.98 284387.57,-176.98"/>
<text text-anchor="middle" x="284140" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L4</text>
<text text-anchor="middle" x="284140" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="284140" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1574" class="edge">
<title>expert0_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M283856.66,-135.98C283882.06,-135.98 283907.47,-135.98 283932.87,-135.98"/>
<polygon fill="black" stroke="black" points="283932.99,-139.48 283942.99,-135.98 283932.99,-132.48 283932.99,-139.48"/>
</g>
<!-- expert1_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1575" class="edge">
<title>expert1_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M283550.24,-162.02C283573.4,-171.57 283600.96,-181.22 283627,-185.98 283677.06,-195.15 283805.3,-190.41 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert2_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1576" class="edge">
<title>expert2_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M283303.24,-162.02C283326.4,-171.57 283353.96,-181.22 283380,-185.98 283432.02,-195.51 283803.31,-190.59 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert3_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1577" class="edge">
<title>expert3_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M283056.24,-162.02C283079.4,-171.57 283106.96,-181.22 283133,-185.98 283212.02,-200.45 283775.97,-192.97 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert4_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1578" class="edge">
<title>expert4_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M282809.24,-162.02C282832.4,-171.57 282859.96,-181.22 282886,-185.98 282939.01,-195.69 283802.31,-190.67 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert5_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1579" class="edge">
<title>expert5_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M282562.24,-162.02C282585.4,-171.57 282612.96,-181.22 282639,-185.98 282705.5,-198.16 283788.64,-191.87 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert6_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1580" class="edge">
<title>expert6_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M282315.24,-162.02C282338.4,-171.57 282365.96,-181.22 282392,-185.98 282472,-200.63 283774.97,-193.06 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert7_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1581" class="edge">
<title>expert7_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M282068.24,-162.02C282091.4,-171.57 282118.96,-181.22 282145,-185.98 282191.75,-194.54 283808.65,-190.12 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert8_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1582" class="edge">
<title>expert8_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M281821.24,-162.02C281844.4,-171.57 281871.96,-181.22 281898,-185.98 281951.5,-195.78 283801.82,-190.72 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert9_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1583" class="edge">
<title>expert9_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M281574.24,-162.02C281597.4,-171.57 281624.96,-181.22 281651,-185.98 281711.25,-197.01 283794.98,-191.31 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert10_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1584" class="edge">
<title>expert10_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M281327.24,-162.02C281350.4,-171.57 281377.96,-181.22 281404,-185.98 281471,-198.25 283788.15,-191.91 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert11_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1585" class="edge">
<title>expert11_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M281080.24,-162.02C281103.4,-171.57 281130.96,-181.22 281157,-185.98 281230.75,-199.48 283781.31,-192.51 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert12_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1586" class="edge">
<title>expert12_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M280833.24,-162.02C280856.4,-171.57 280883.96,-181.22 280910,-185.98 280990.49,-200.72 283774.48,-193.1 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert13_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1587" class="edge">
<title>expert13_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M280586.24,-162.02C280609.4,-171.57 280636.96,-181.22 280663,-185.98 280706.62,-193.97 283811.82,-189.84 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert14_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1588" class="edge">
<title>expert14_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M280339.24,-162.02C280362.4,-171.57 280389.96,-181.22 280416,-185.98 280463,-194.59 283808.4,-190.14 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- expert15_l4_dp2&#45;&gt;expert_agg_l4_dp2 -->
<g id="edge1589" class="edge">
<title>expert15_l4_dp2&#45;&gt;expert_agg_l4_dp2</title>
<path fill="none" stroke="black" d="M280075.31,-162.04C280103.82,-171.6 280137.57,-181.24 280169,-185.98 280219.63,-193.62 283804.98,-190.44 283856,-185.98 283894.11,-182.65 283934.78,-176.86 283973.08,-170.36"/>
<polygon fill="black" stroke="black" points="283974.02,-173.75 283983.29,-168.6 283972.84,-166.85 283974.02,-173.75"/>
</g>
<!-- layer4_output_dp2 -->
<g id="node946" class="node">
<title>layer4_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="284592" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="284592" y="-144.48" font-family="Arial" font-size="10.00">Layer 4 Output</text>
<text text-anchor="middle" x="284592" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="284592" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l4_dp2&#45;&gt;layer4_output_dp2 -->
<g id="edge1590" class="edge">
<title>expert_agg_l4_dp2&#45;&gt;layer4_output_dp2</title>
<path fill="none" stroke="black" d="M284337.31,-135.98C284362.49,-135.98 284387.66,-135.98 284412.84,-135.98"/>
<polygon fill="black" stroke="black" points="284412.87,-139.48 284422.87,-135.98 284412.87,-132.48 284412.87,-139.48"/>
</g>
<!-- attn_input_l5_dp2 -->
<g id="node947" class="node">
<title>attn_input_l5_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="284965" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="284965" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L5</text>
<text text-anchor="middle" x="284965" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="284965" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer4_output_dp2&#45;&gt;attn_input_l5_dp2 -->
<g id="edge1591" class="edge">
<title>layer4_output_dp2&#45;&gt;attn_input_l5_dp2</title>
<path fill="none" stroke="black" d="M284761.01,-135.98C284769.23,-135.98 284777.44,-135.98 284785.66,-135.98"/>
<polygon fill="black" stroke="black" points="284785.68,-139.48 284795.68,-135.98 284785.68,-132.48 284785.68,-139.48"/>
</g>
<!-- attn_tp0_l5_dp2 -->
<g id="node948" class="node">
<title>attn_tp0_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="286263,-161.98 286003,-161.98 286003,-109.98 286263,-109.98 286263,-161.98"/>
<text text-anchor="middle" x="286133" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L5</text>
<text text-anchor="middle" x="286133" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="286133" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="286133" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp2&#45;&gt;attn_tp0_l5_dp2 -->
<g id="edge1592" class="edge">
<title>attn_input_l5_dp2&#45;&gt;attn_tp0_l5_dp2</title>
<path fill="none" stroke="black" d="M285048.52,-161.26C285085.12,-171.09 285128.81,-181.13 285169,-185.98 285214,-191.42 285940.27,-193.33 285985,-185.98 286010.4,-181.81 286037.31,-173.85 286061.12,-165.5"/>
<polygon fill="black" stroke="black" points="286062.55,-168.71 286070.78,-162.03 286060.18,-162.12 286062.55,-168.71"/>
</g>
<!-- attn_tp1_l5_dp2 -->
<g id="node949" class="node">
<title>attn_tp1_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="285985,-161.98 285725,-161.98 285725,-109.98 285985,-109.98 285985,-161.98"/>
<text text-anchor="middle" x="285855" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L5</text>
<text text-anchor="middle" x="285855" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="285855" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="285855" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp2&#45;&gt;attn_tp1_l5_dp2 -->
<g id="edge1593" class="edge">
<title>attn_input_l5_dp2&#45;&gt;attn_tp1_l5_dp2</title>
<path fill="none" stroke="black" d="M285048.52,-161.26C285085.12,-171.09 285128.81,-181.13 285169,-185.98 285228.35,-193.15 285648.01,-195.68 285707,-185.98 285732.4,-181.81 285759.31,-173.85 285783.12,-165.5"/>
<polygon fill="black" stroke="black" points="285784.55,-168.71 285792.78,-162.03 285782.18,-162.12 285784.55,-168.71"/>
</g>
<!-- attn_tp2_l5_dp2 -->
<g id="node950" class="node">
<title>attn_tp2_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="285707,-161.98 285447,-161.98 285447,-109.98 285707,-109.98 285707,-161.98"/>
<text text-anchor="middle" x="285577" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L5</text>
<text text-anchor="middle" x="285577" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="285577" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="285577" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp2&#45;&gt;attn_tp2_l5_dp2 -->
<g id="edge1594" class="edge">
<title>attn_input_l5_dp2&#45;&gt;attn_tp2_l5_dp2</title>
<path fill="none" stroke="black" d="M285048.52,-161.26C285085.12,-171.09 285128.81,-181.13 285169,-185.98 285226.36,-192.91 285371.99,-195.35 285429,-185.98 285454.4,-181.81 285481.31,-173.85 285505.12,-165.5"/>
<polygon fill="black" stroke="black" points="285506.55,-168.71 285514.78,-162.03 285504.18,-162.12 285506.55,-168.71"/>
</g>
<!-- attn_tp3_l5_dp2 -->
<g id="node951" class="node">
<title>attn_tp3_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="285429,-161.98 285169,-161.98 285169,-109.98 285429,-109.98 285429,-161.98"/>
<text text-anchor="middle" x="285299" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L5</text>
<text text-anchor="middle" x="285299" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="285299" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="285299" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp2&#45;&gt;attn_tp3_l5_dp2 -->
<g id="edge1595" class="edge">
<title>attn_input_l5_dp2&#45;&gt;attn_tp3_l5_dp2</title>
<path fill="none" stroke="black" d="M285134.28,-135.98C285142.35,-135.98 285150.42,-135.98 285158.49,-135.98"/>
<polygon fill="black" stroke="black" points="285158.7,-139.48 285168.7,-135.98 285158.7,-132.48 285158.7,-139.48"/>
</g>
<!-- allreduce_l5_dp2 -->
<g id="node952" class="node">
<title>allreduce_l5_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="286467" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="286467" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L5</text>
<text text-anchor="middle" x="286467" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="286467" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l5_dp2&#45;&gt;allreduce_l5_dp2 -->
<g id="edge1596" class="edge">
<title>attn_tp0_l5_dp2&#45;&gt;allreduce_l5_dp2</title>
<path fill="none" stroke="black" d="M286263.14,-135.98C286271.35,-135.98 286279.56,-135.98 286287.77,-135.98"/>
<polygon fill="black" stroke="black" points="286287.78,-139.48 286297.78,-135.98 286287.78,-132.48 286287.78,-139.48"/>
</g>
<!-- attn_tp1_l5_dp2&#45;&gt;allreduce_l5_dp2 -->
<g id="edge1597" class="edge">
<title>attn_tp1_l5_dp2&#45;&gt;allreduce_l5_dp2</title>
<path fill="none" stroke="black" d="M285917.22,-162.03C285943.24,-171.59 285974.1,-181.23 286003,-185.98 286060.01,-195.35 286205.64,-192.91 286263,-185.98 286299.57,-181.57 286339.05,-172.85 286373.44,-163.91"/>
<polygon fill="black" stroke="black" points="286374.7,-167.2 286383.47,-161.26 286372.91,-160.43 286374.7,-167.2"/>
</g>
<!-- attn_tp2_l5_dp2&#45;&gt;allreduce_l5_dp2 -->
<g id="edge1598" class="edge">
<title>attn_tp2_l5_dp2&#45;&gt;allreduce_l5_dp2</title>
<path fill="none" stroke="black" d="M285639.22,-162.03C285665.24,-171.59 285696.1,-181.23 285725,-185.98 285783.98,-195.68 286203.65,-193.15 286263,-185.98 286299.57,-181.57 286339.05,-172.85 286373.44,-163.91"/>
<polygon fill="black" stroke="black" points="286374.7,-167.2 286383.47,-161.26 286372.91,-160.43 286374.7,-167.2"/>
</g>
<!-- attn_tp3_l5_dp2&#45;&gt;allreduce_l5_dp2 -->
<g id="edge1599" class="edge">
<title>attn_tp3_l5_dp2&#45;&gt;allreduce_l5_dp2</title>
<path fill="none" stroke="black" d="M285361.22,-162.03C285387.24,-171.59 285418.1,-181.23 285447,-185.98 285491.73,-193.33 286217.99,-191.42 286263,-185.98 286299.57,-181.57 286339.05,-172.85 286373.44,-163.91"/>
<polygon fill="black" stroke="black" points="286374.7,-167.2 286383.47,-161.26 286372.91,-160.43 286374.7,-167.2"/>
</g>
<!-- moe_input_l5_dp2 -->
<g id="node953" class="node">
<title>moe_input_l5_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="286840" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="286840" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L5</text>
<text text-anchor="middle" x="286840" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="286840" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l5_dp2&#45;&gt;moe_input_l5_dp2 -->
<g id="edge1600" class="edge">
<title>allreduce_l5_dp2&#45;&gt;moe_input_l5_dp2</title>
<path fill="none" stroke="black" d="M286636.01,-135.98C286644.23,-135.98 286652.44,-135.98 286660.66,-135.98"/>
<polygon fill="black" stroke="black" points="286660.68,-139.48 286670.68,-135.98 286660.68,-132.48 286660.68,-139.48"/>
</g>
<!-- router_l5_dp2 -->
<g id="node954" class="node">
<title>router_l5_dp2</title>
<polygon fill="lightyellow" stroke="black" points="287539.57,-176.98 287145.74,-176.98 287044.43,-94.98 287438.26,-94.98 287539.57,-176.98"/>
<text text-anchor="middle" x="287292" y="-144.48" font-family="Arial" font-size="10.00">Router L5</text>
<text text-anchor="middle" x="287292" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="287292" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l5_dp2&#45;&gt;router_l5_dp2 -->
<g id="edge1601" class="edge">
<title>moe_input_l5_dp2&#45;&gt;router_l5_dp2</title>
<path fill="none" stroke="black" d="M287009.06,-135.98C287034.34,-135.98 287059.63,-135.98 287084.92,-135.98"/>
<polygon fill="black" stroke="black" points="287084.99,-139.48 287094.99,-135.98 287084.99,-132.48 287084.99,-139.48"/>
</g>
<!-- expert0_l5_dp2 -->
<g id="node955" class="node">
<title>expert0_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="291545.5,-161.98 291316.5,-161.98 291316.5,-109.98 291545.5,-109.98 291545.5,-161.98"/>
<text text-anchor="middle" x="291431" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L5</text>
<text text-anchor="middle" x="291431" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="291431" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="291431" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert0_l5_dp2 -->
<g id="edge1602" class="edge">
<title>router_l5_dp2&#45;&gt;expert0_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.74,-171.32C287554.09,-173.59 287575.41,-175.53 287596,-176.98 288356.47,-230.48 290264.15,-196.54 291026.5,-198.98 291151.55,-199.38 291184.59,-202.54 291307,-176.98 291321.75,-173.9 291337.19,-169.66 291351.98,-165.07"/>
<polygon fill="black" stroke="black" points="291353.12,-168.37 291361.59,-162 291351,-161.7 291353.12,-168.37"/>
<text text-anchor="middle" x="291048" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l5_dp2 -->
<g id="node956" class="node">
<title>expert1_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="291298.5,-161.98 291069.5,-161.98 291069.5,-109.98 291298.5,-109.98 291298.5,-161.98"/>
<text text-anchor="middle" x="291184" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L5</text>
<text text-anchor="middle" x="291184" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="291184" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="291184" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert1_l5_dp2 -->
<g id="edge1603" class="edge">
<title>router_l5_dp2&#45;&gt;expert1_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.74,-171.31C287554.09,-173.58 287575.41,-175.53 287596,-176.98 288295.05,-226.36 290048.71,-196.54 290749.5,-198.98 290887.84,-199.47 290924.43,-204.56 291060,-176.98 291074.85,-173.96 291090.41,-169.72 291105.28,-165.11"/>
<polygon fill="black" stroke="black" points="291106.48,-168.4 291114.94,-162.03 291104.35,-161.73 291106.48,-168.4"/>
<text text-anchor="middle" x="290771" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l5_dp2 -->
<g id="node957" class="node">
<title>expert2_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="291051.5,-161.98 290822.5,-161.98 290822.5,-109.98 291051.5,-109.98 291051.5,-161.98"/>
<text text-anchor="middle" x="290937" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L5</text>
<text text-anchor="middle" x="290937" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="290937" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="290937" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert2_l5_dp2 -->
<g id="edge1604" class="edge">
<title>router_l5_dp2&#45;&gt;expert2_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.74,-171.29C287554.1,-173.56 287575.41,-175.52 287596,-176.98 288227.21,-221.81 289810.71,-196.54 290443.5,-198.98 290608.01,-199.62 290651.55,-208.59 290813,-176.98 290828.06,-174.03 290843.82,-169.78 290858.86,-165.12"/>
<polygon fill="black" stroke="black" points="290860.17,-168.37 290868.63,-162 290858.04,-161.71 290860.17,-168.37"/>
<text text-anchor="middle" x="290465" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l5_dp2 -->
<g id="node958" class="node">
<title>expert3_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="290804.5,-161.98 290575.5,-161.98 290575.5,-109.98 290804.5,-109.98 290804.5,-161.98"/>
<text text-anchor="middle" x="290690" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L5</text>
<text text-anchor="middle" x="290690" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="290690" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="290690" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert3_l5_dp2 -->
<g id="edge1605" class="edge">
<title>router_l5_dp2&#45;&gt;expert3_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.74,-171.27C287554.1,-173.54 287575.41,-175.51 287596,-176.98 288146.28,-216.37 289526.82,-196.54 290078.5,-198.98 290295.38,-199.94 290352.79,-216.75 290566,-176.98 290581.27,-174.14 290597.24,-169.88 290612.45,-165.17"/>
<polygon fill="black" stroke="black" points="290613.86,-168.39 290622.32,-162.01 290611.73,-161.72 290613.86,-168.39"/>
<text text-anchor="middle" x="290100" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l5_dp2 -->
<g id="node959" class="node">
<title>expert4_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="290557.5,-161.98 290328.5,-161.98 290328.5,-109.98 290557.5,-109.98 290557.5,-161.98"/>
<text text-anchor="middle" x="290443" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L5</text>
<text text-anchor="middle" x="290443" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="290443" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="290443" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert4_l5_dp2 -->
<g id="edge1606" class="edge">
<title>router_l5_dp2&#45;&gt;expert4_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287437.67,-176.99C287476.3,-186.08 287518.21,-194.39 287557.5,-198.98 287576.48,-201.2 287581.39,-199.06 287600.5,-198.98 287902.56,-197.76 290020.97,-226.21 290319,-176.98 290334.93,-174.35 290351.6,-170.01 290367.35,-165.12"/>
<polygon fill="black" stroke="black" points="290368.58,-168.4 290377.03,-162.01 290366.44,-161.73 290368.58,-168.4"/>
<text text-anchor="middle" x="287579" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l5_dp2 -->
<g id="node960" class="node">
<title>expert5_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="290310.5,-161.98 290081.5,-161.98 290081.5,-109.98 290310.5,-109.98 290310.5,-161.98"/>
<text text-anchor="middle" x="290196" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L5</text>
<text text-anchor="middle" x="290196" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="290196" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="290196" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert5_l5_dp2 -->
<g id="edge1607" class="edge">
<title>router_l5_dp2&#45;&gt;expert5_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.74,-171.22C287554.1,-173.51 287575.42,-175.49 287596,-176.98 288039.19,-209.18 289151.15,-196.54 289595.5,-198.98 289807.5,-200.15 289863.61,-215.98 290072,-176.98 290087.26,-174.13 290103.24,-169.86 290118.45,-165.15"/>
<polygon fill="black" stroke="black" points="290119.86,-168.37 290128.32,-162 290117.73,-161.71 290119.86,-168.37"/>
<text text-anchor="middle" x="289617" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l5_dp2 -->
<g id="node961" class="node">
<title>expert6_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="290063.5,-161.98 289834.5,-161.98 289834.5,-109.98 290063.5,-109.98 290063.5,-161.98"/>
<text text-anchor="middle" x="289949" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L5</text>
<text text-anchor="middle" x="289949" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="289949" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="289949" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert6_l5_dp2 -->
<g id="edge1608" class="edge">
<title>router_l5_dp2&#45;&gt;expert6_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287464.37,-177C287509.98,-186.1 287559.37,-194.39 287605.5,-198.98 287624.52,-200.87 287629.39,-199.08 287648.5,-198.98 287890.34,-197.76 289586.43,-216.64 289825,-176.98 289840.84,-174.35 289857.4,-170.04 289873.07,-165.18"/>
<polygon fill="black" stroke="black" points="289874.25,-168.47 289882.7,-162.09 289872.11,-161.81 289874.25,-168.47"/>
<text text-anchor="middle" x="287627" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l5_dp2 -->
<g id="node962" class="node">
<title>expert7_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="289816.5,-161.98 289587.5,-161.98 289587.5,-109.98 289816.5,-109.98 289816.5,-161.98"/>
<text text-anchor="middle" x="289702" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L5</text>
<text text-anchor="middle" x="289702" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="289702" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="289702" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert7_l5_dp2 -->
<g id="edge1609" class="edge">
<title>router_l5_dp2&#45;&gt;expert7_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.33,-171.1C287553.83,-173.42 287575.29,-175.44 287596,-176.98 287944.07,-202.87 288817.59,-208.3 289166.5,-198.98 289349.58,-194.09 289398.02,-210.92 289578,-176.98 289593.17,-174.12 289609.04,-169.88 289624.17,-165.2"/>
<polygon fill="black" stroke="black" points="289625.52,-168.44 289633.99,-162.07 289623.4,-161.77 289625.52,-168.44"/>
<text text-anchor="middle" x="289145" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l5_dp2 -->
<g id="node963" class="node">
<title>expert8_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="289569.5,-161.98 289340.5,-161.98 289340.5,-109.98 289569.5,-109.98 289569.5,-161.98"/>
<text text-anchor="middle" x="289455" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L5</text>
<text text-anchor="middle" x="289455" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="289455" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="289455" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert8_l5_dp2 -->
<g id="edge1610" class="edge">
<title>router_l5_dp2&#45;&gt;expert8_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287491.02,-177C287543.62,-186.1 287600.5,-194.4 287653.5,-198.98 287672.54,-200.63 287677.39,-199.11 287696.5,-198.98 287878.12,-197.76 289151.88,-207.07 289331,-176.98 289346.83,-174.32 289363.39,-170 289379.07,-165.13"/>
<polygon fill="black" stroke="black" points="289380.24,-168.43 289388.7,-162.04 289378.1,-161.77 289380.24,-168.43"/>
<text text-anchor="middle" x="287675" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l5_dp2 -->
<g id="node964" class="node">
<title>expert9_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="289322.5,-161.98 289093.5,-161.98 289093.5,-109.98 289322.5,-109.98 289322.5,-161.98"/>
<text text-anchor="middle" x="289208" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L5</text>
<text text-anchor="middle" x="289208" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="289208" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="289208" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert9_l5_dp2 -->
<g id="edge1611" class="edge">
<title>router_l5_dp2&#45;&gt;expert9_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287532.35,-170.96C287553.84,-173.31 287575.29,-175.38 287596,-176.98 288092.17,-215.39 288218.07,-213.82 288715.5,-198.98 288879.49,-194.09 288922.87,-207.88 289084,-176.98 289099.16,-174.08 289115.03,-169.81 289130.15,-165.12"/>
<polygon fill="black" stroke="black" points="289131.51,-168.37 289139.97,-161.99 289129.38,-161.7 289131.51,-168.37"/>
<text text-anchor="middle" x="288694" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l5_dp2 -->
<g id="node965" class="node">
<title>expert10_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="289075.5,-161.98 288846.5,-161.98 288846.5,-109.98 289075.5,-109.98 289075.5,-161.98"/>
<text text-anchor="middle" x="288961" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L5</text>
<text text-anchor="middle" x="288961" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="288961" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="288961" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert10_l5_dp2 -->
<g id="edge1612" class="edge">
<title>router_l5_dp2&#45;&gt;expert10_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287517.65,-177.01C287577.23,-186.11 287641.61,-194.4 287701.5,-198.98 287827.32,-208.6 288712.62,-198.3 288837,-176.98 288852.73,-174.29 288869.18,-169.97 288884.78,-165.14"/>
<polygon fill="black" stroke="black" points="288885.9,-168.45 288894.36,-162.07 288883.77,-161.78 288885.9,-168.45"/>
<text text-anchor="middle" x="287723" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l5_dp2 -->
<g id="node966" class="node">
<title>expert11_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="288828.5,-161.98 288599.5,-161.98 288599.5,-109.98 288828.5,-109.98 288828.5,-161.98"/>
<text text-anchor="middle" x="288714" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L5</text>
<text text-anchor="middle" x="288714" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="288714" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="288714" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert11_l5_dp2 -->
<g id="edge1613" class="edge">
<title>router_l5_dp2&#45;&gt;expert11_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287531.95,-170.64C287553.58,-173.07 287575.17,-175.24 287596,-176.98 287911.71,-203.39 287991.92,-211.33 288308.5,-198.98 288433.9,-194.09 288466.97,-201.75 288590,-176.98 288604.86,-173.99 288620.42,-169.77 288635.29,-165.16"/>
<polygon fill="black" stroke="black" points="288636.48,-168.45 288644.95,-162.08 288634.36,-161.78 288636.48,-168.45"/>
<text text-anchor="middle" x="288287" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l5_dp2 -->
<g id="node967" class="node">
<title>expert12_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="288581.5,-161.98 288352.5,-161.98 288352.5,-109.98 288581.5,-109.98 288581.5,-161.98"/>
<text text-anchor="middle" x="288467" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L5</text>
<text text-anchor="middle" x="288467" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="288467" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="288467" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert12_l5_dp2 -->
<g id="edge1614" class="edge">
<title>router_l5_dp2&#45;&gt;expert12_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287538.89,-176.28C287606.94,-185.66 287680.91,-194.28 287749.5,-198.98 287881.17,-208.01 288213.14,-200.56 288343,-176.98 288358.37,-174.19 288374.45,-169.93 288389.75,-165.2"/>
<polygon fill="black" stroke="black" points="288391.21,-168.41 288399.67,-162.03 288389.08,-161.74 288391.21,-168.41"/>
<text text-anchor="middle" x="287771" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l5_dp2 -->
<g id="node968" class="node">
<title>expert13_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="288334.5,-161.98 288105.5,-161.98 288105.5,-109.98 288334.5,-109.98 288334.5,-161.98"/>
<text text-anchor="middle" x="288220" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L5</text>
<text text-anchor="middle" x="288220" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="288220" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="288220" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert13_l5_dp2 -->
<g id="edge1615" class="edge">
<title>router_l5_dp2&#45;&gt;expert13_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287509.82,-177.02C287646.96,-197.58 287827.66,-215.02 287987.5,-198.98 288038.66,-193.85 288094.31,-179.11 288138.33,-165.18"/>
<polygon fill="black" stroke="black" points="288139.66,-168.43 288148.11,-162.04 288137.52,-161.77 288139.66,-168.43"/>
<text text-anchor="middle" x="287966" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l5_dp2 -->
<g id="node969" class="node">
<title>expert14_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="288087.5,-161.98 287858.5,-161.98 287858.5,-109.98 288087.5,-109.98 288087.5,-161.98"/>
<text text-anchor="middle" x="287973" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L5</text>
<text text-anchor="middle" x="287973" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="287973" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="287973" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert14_l5_dp2 -->
<g id="edge1616" class="edge">
<title>router_l5_dp2&#45;&gt;expert14_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287517.44,-176.99C287640.58,-196.39 287780.01,-212.63 287840.5,-198.98 287868.7,-192.62 287897.94,-179.52 287921.75,-166.9"/>
<polygon fill="black" stroke="black" points="287923.48,-169.94 287930.6,-162.1 287920.14,-163.79 287923.48,-169.94"/>
<text text-anchor="middle" x="287819" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l5_dp2 -->
<g id="node970" class="node">
<title>expert15_l5_dp2</title>
<polygon fill="lightgreen" stroke="black" points="287834.5,-161.98 287605.5,-161.98 287605.5,-109.98 287834.5,-109.98 287834.5,-161.98"/>
<text text-anchor="middle" x="287720" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L5</text>
<text text-anchor="middle" x="287720" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="287720" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="287720" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp2&#45;&gt;expert15_l5_dp2 -->
<g id="edge1617" class="edge">
<title>router_l5_dp2&#45;&gt;expert15_l5_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M287489.09,-135.98C287525.17,-135.98 287561.91,-135.98 287595.14,-135.98"/>
<polygon fill="black" stroke="black" points="287595.34,-139.48 287605.34,-135.98 287595.34,-132.48 287595.34,-139.48"/>
<text text-anchor="middle" x="287572.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l5_dp2 -->
<g id="node971" class="node">
<title>expert_agg_l5_dp2</title>
<polygon fill="lightyellow" stroke="black" points="292076.57,-176.98 291682.74,-176.98 291581.43,-94.98 291975.26,-94.98 292076.57,-176.98"/>
<text text-anchor="middle" x="291829" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L5</text>
<text text-anchor="middle" x="291829" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="291829" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1618" class="edge">
<title>expert0_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M291545.66,-135.98C291571.06,-135.98 291596.47,-135.98 291621.87,-135.98"/>
<polygon fill="black" stroke="black" points="291621.99,-139.48 291631.99,-135.98 291621.99,-132.48 291621.99,-139.48"/>
</g>
<!-- expert1_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1619" class="edge">
<title>expert1_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M291239.24,-162.02C291262.4,-171.57 291289.96,-181.22 291316,-185.98 291366.06,-195.15 291494.3,-190.41 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert2_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1620" class="edge">
<title>expert2_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M290992.24,-162.02C291015.4,-171.57 291042.96,-181.22 291069,-185.98 291121.02,-195.51 291492.31,-190.59 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert3_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1621" class="edge">
<title>expert3_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M290745.24,-162.02C290768.4,-171.57 290795.96,-181.22 290822,-185.98 290901.02,-200.45 291464.97,-192.97 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert4_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1622" class="edge">
<title>expert4_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M290498.24,-162.02C290521.4,-171.57 290548.96,-181.22 290575,-185.98 290628.01,-195.69 291491.31,-190.67 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert5_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1623" class="edge">
<title>expert5_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M290251.24,-162.02C290274.4,-171.57 290301.96,-181.22 290328,-185.98 290394.5,-198.16 291477.64,-191.87 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert6_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1624" class="edge">
<title>expert6_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M290004.24,-162.02C290027.4,-171.57 290054.96,-181.22 290081,-185.98 290161,-200.63 291463.97,-193.06 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert7_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1625" class="edge">
<title>expert7_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M289757.24,-162.02C289780.4,-171.57 289807.96,-181.22 289834,-185.98 289880.75,-194.54 291497.65,-190.12 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert8_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1626" class="edge">
<title>expert8_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M289510.24,-162.02C289533.4,-171.57 289560.96,-181.22 289587,-185.98 289640.5,-195.78 291490.82,-190.72 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert9_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1627" class="edge">
<title>expert9_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M289263.24,-162.02C289286.4,-171.57 289313.96,-181.22 289340,-185.98 289400.25,-197.01 291483.98,-191.31 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert10_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1628" class="edge">
<title>expert10_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M289016.24,-162.02C289039.4,-171.57 289066.96,-181.22 289093,-185.98 289160,-198.25 291477.15,-191.91 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert11_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1629" class="edge">
<title>expert11_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M288769.24,-162.02C288792.4,-171.57 288819.96,-181.22 288846,-185.98 288919.75,-199.48 291470.31,-192.51 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert12_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1630" class="edge">
<title>expert12_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M288522.24,-162.02C288545.4,-171.57 288572.96,-181.22 288599,-185.98 288679.49,-200.72 291463.48,-193.1 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert13_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1631" class="edge">
<title>expert13_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M288275.24,-162.02C288298.4,-171.57 288325.96,-181.22 288352,-185.98 288395.62,-193.97 291500.82,-189.84 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert14_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1632" class="edge">
<title>expert14_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M288028.24,-162.02C288051.4,-171.57 288078.96,-181.22 288105,-185.98 288152,-194.59 291497.4,-190.14 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- expert15_l5_dp2&#45;&gt;expert_agg_l5_dp2 -->
<g id="edge1633" class="edge">
<title>expert15_l5_dp2&#45;&gt;expert_agg_l5_dp2</title>
<path fill="none" stroke="black" d="M287777.86,-162.02C287802.1,-171.58 287830.89,-181.22 287858,-185.98 287908.44,-194.84 291493.98,-190.44 291545,-185.98 291583.11,-182.65 291623.78,-176.86 291662.08,-170.36"/>
<polygon fill="black" stroke="black" points="291663.02,-173.75 291672.29,-168.6 291661.84,-166.85 291663.02,-173.75"/>
</g>
<!-- layer5_output_dp2 -->
<g id="node972" class="node">
<title>layer5_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="292281" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="292281" y="-144.48" font-family="Arial" font-size="10.00">Layer 5 Output</text>
<text text-anchor="middle" x="292281" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="292281" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l5_dp2&#45;&gt;layer5_output_dp2 -->
<g id="edge1634" class="edge">
<title>expert_agg_l5_dp2&#45;&gt;layer5_output_dp2</title>
<path fill="none" stroke="black" d="M292026.31,-135.98C292051.49,-135.98 292076.66,-135.98 292101.84,-135.98"/>
<polygon fill="black" stroke="black" points="292101.87,-139.48 292111.87,-135.98 292101.87,-132.48 292101.87,-139.48"/>
</g>
<!-- attn_input_l6_dp2 -->
<g id="node973" class="node">
<title>attn_input_l6_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="292654" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="292654" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L6</text>
<text text-anchor="middle" x="292654" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="292654" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer5_output_dp2&#45;&gt;attn_input_l6_dp2 -->
<g id="edge1635" class="edge">
<title>layer5_output_dp2&#45;&gt;attn_input_l6_dp2</title>
<path fill="none" stroke="black" d="M292450.01,-135.98C292458.23,-135.98 292466.44,-135.98 292474.66,-135.98"/>
<polygon fill="black" stroke="black" points="292474.68,-139.48 292484.68,-135.98 292474.68,-132.48 292474.68,-139.48"/>
</g>
<!-- attn_tp0_l6_dp2 -->
<g id="node974" class="node">
<title>attn_tp0_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="293952,-161.98 293692,-161.98 293692,-109.98 293952,-109.98 293952,-161.98"/>
<text text-anchor="middle" x="293822" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L6</text>
<text text-anchor="middle" x="293822" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="293822" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="293822" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp2&#45;&gt;attn_tp0_l6_dp2 -->
<g id="edge1636" class="edge">
<title>attn_input_l6_dp2&#45;&gt;attn_tp0_l6_dp2</title>
<path fill="none" stroke="black" d="M292737.52,-161.26C292774.12,-171.09 292817.81,-181.13 292858,-185.98 292903,-191.42 293629.27,-193.33 293674,-185.98 293699.4,-181.81 293726.31,-173.85 293750.12,-165.5"/>
<polygon fill="black" stroke="black" points="293751.55,-168.71 293759.78,-162.03 293749.18,-162.12 293751.55,-168.71"/>
</g>
<!-- attn_tp1_l6_dp2 -->
<g id="node975" class="node">
<title>attn_tp1_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="293674,-161.98 293414,-161.98 293414,-109.98 293674,-109.98 293674,-161.98"/>
<text text-anchor="middle" x="293544" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L6</text>
<text text-anchor="middle" x="293544" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="293544" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="293544" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp2&#45;&gt;attn_tp1_l6_dp2 -->
<g id="edge1637" class="edge">
<title>attn_input_l6_dp2&#45;&gt;attn_tp1_l6_dp2</title>
<path fill="none" stroke="black" d="M292737.52,-161.26C292774.12,-171.09 292817.81,-181.13 292858,-185.98 292917.35,-193.15 293337.01,-195.68 293396,-185.98 293421.4,-181.81 293448.31,-173.85 293472.12,-165.5"/>
<polygon fill="black" stroke="black" points="293473.55,-168.71 293481.78,-162.03 293471.18,-162.12 293473.55,-168.71"/>
</g>
<!-- attn_tp2_l6_dp2 -->
<g id="node976" class="node">
<title>attn_tp2_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="293396,-161.98 293136,-161.98 293136,-109.98 293396,-109.98 293396,-161.98"/>
<text text-anchor="middle" x="293266" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L6</text>
<text text-anchor="middle" x="293266" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="293266" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="293266" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp2&#45;&gt;attn_tp2_l6_dp2 -->
<g id="edge1638" class="edge">
<title>attn_input_l6_dp2&#45;&gt;attn_tp2_l6_dp2</title>
<path fill="none" stroke="black" d="M292737.52,-161.26C292774.12,-171.09 292817.81,-181.13 292858,-185.98 292915.36,-192.91 293060.99,-195.35 293118,-185.98 293143.4,-181.81 293170.31,-173.85 293194.12,-165.5"/>
<polygon fill="black" stroke="black" points="293195.55,-168.71 293203.78,-162.03 293193.18,-162.12 293195.55,-168.71"/>
</g>
<!-- attn_tp3_l6_dp2 -->
<g id="node977" class="node">
<title>attn_tp3_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="293118,-161.98 292858,-161.98 292858,-109.98 293118,-109.98 293118,-161.98"/>
<text text-anchor="middle" x="292988" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L6</text>
<text text-anchor="middle" x="292988" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="292988" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="292988" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp2&#45;&gt;attn_tp3_l6_dp2 -->
<g id="edge1639" class="edge">
<title>attn_input_l6_dp2&#45;&gt;attn_tp3_l6_dp2</title>
<path fill="none" stroke="black" d="M292823.28,-135.98C292831.35,-135.98 292839.42,-135.98 292847.49,-135.98"/>
<polygon fill="black" stroke="black" points="292847.7,-139.48 292857.7,-135.98 292847.7,-132.48 292847.7,-139.48"/>
</g>
<!-- allreduce_l6_dp2 -->
<g id="node978" class="node">
<title>allreduce_l6_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="294156" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="294156" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L6</text>
<text text-anchor="middle" x="294156" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="294156" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l6_dp2&#45;&gt;allreduce_l6_dp2 -->
<g id="edge1640" class="edge">
<title>attn_tp0_l6_dp2&#45;&gt;allreduce_l6_dp2</title>
<path fill="none" stroke="black" d="M293952.14,-135.98C293960.35,-135.98 293968.56,-135.98 293976.77,-135.98"/>
<polygon fill="black" stroke="black" points="293976.78,-139.48 293986.78,-135.98 293976.78,-132.48 293976.78,-139.48"/>
</g>
<!-- attn_tp1_l6_dp2&#45;&gt;allreduce_l6_dp2 -->
<g id="edge1641" class="edge">
<title>attn_tp1_l6_dp2&#45;&gt;allreduce_l6_dp2</title>
<path fill="none" stroke="black" d="M293606.22,-162.03C293632.24,-171.59 293663.1,-181.23 293692,-185.98 293749.01,-195.35 293894.64,-192.91 293952,-185.98 293988.57,-181.57 294028.05,-172.85 294062.44,-163.91"/>
<polygon fill="black" stroke="black" points="294063.7,-167.2 294072.47,-161.26 294061.91,-160.43 294063.7,-167.2"/>
</g>
<!-- attn_tp2_l6_dp2&#45;&gt;allreduce_l6_dp2 -->
<g id="edge1642" class="edge">
<title>attn_tp2_l6_dp2&#45;&gt;allreduce_l6_dp2</title>
<path fill="none" stroke="black" d="M293328.22,-162.03C293354.24,-171.59 293385.1,-181.23 293414,-185.98 293472.98,-195.68 293892.65,-193.15 293952,-185.98 293988.57,-181.57 294028.05,-172.85 294062.44,-163.91"/>
<polygon fill="black" stroke="black" points="294063.7,-167.2 294072.47,-161.26 294061.91,-160.43 294063.7,-167.2"/>
</g>
<!-- attn_tp3_l6_dp2&#45;&gt;allreduce_l6_dp2 -->
<g id="edge1643" class="edge">
<title>attn_tp3_l6_dp2&#45;&gt;allreduce_l6_dp2</title>
<path fill="none" stroke="black" d="M293050.22,-162.03C293076.24,-171.59 293107.1,-181.23 293136,-185.98 293180.73,-193.33 293906.99,-191.42 293952,-185.98 293988.57,-181.57 294028.05,-172.85 294062.44,-163.91"/>
<polygon fill="black" stroke="black" points="294063.7,-167.2 294072.47,-161.26 294061.91,-160.43 294063.7,-167.2"/>
</g>
<!-- moe_input_l6_dp2 -->
<g id="node979" class="node">
<title>moe_input_l6_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="294529" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="294529" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L6</text>
<text text-anchor="middle" x="294529" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="294529" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l6_dp2&#45;&gt;moe_input_l6_dp2 -->
<g id="edge1644" class="edge">
<title>allreduce_l6_dp2&#45;&gt;moe_input_l6_dp2</title>
<path fill="none" stroke="black" d="M294325.01,-135.98C294333.23,-135.98 294341.44,-135.98 294349.66,-135.98"/>
<polygon fill="black" stroke="black" points="294349.68,-139.48 294359.68,-135.98 294349.68,-132.48 294349.68,-139.48"/>
</g>
<!-- router_l6_dp2 -->
<g id="node980" class="node">
<title>router_l6_dp2</title>
<polygon fill="lightyellow" stroke="black" points="295228.57,-176.98 294834.74,-176.98 294733.43,-94.98 295127.26,-94.98 295228.57,-176.98"/>
<text text-anchor="middle" x="294981" y="-144.48" font-family="Arial" font-size="10.00">Router L6</text>
<text text-anchor="middle" x="294981" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="294981" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l6_dp2&#45;&gt;router_l6_dp2 -->
<g id="edge1645" class="edge">
<title>moe_input_l6_dp2&#45;&gt;router_l6_dp2</title>
<path fill="none" stroke="black" d="M294698.06,-135.98C294723.34,-135.98 294748.63,-135.98 294773.92,-135.98"/>
<polygon fill="black" stroke="black" points="294773.99,-139.48 294783.99,-135.98 294773.99,-132.48 294773.99,-139.48"/>
</g>
<!-- expert0_l6_dp2 -->
<g id="node981" class="node">
<title>expert0_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="299282.5,-161.98 299053.5,-161.98 299053.5,-109.98 299282.5,-109.98 299282.5,-161.98"/>
<text text-anchor="middle" x="299168" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L6</text>
<text text-anchor="middle" x="299168" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="299168" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="299168" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert0_l6_dp2 -->
<g id="edge1646" class="edge">
<title>router_l6_dp2&#45;&gt;expert0_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.95,-169.07C295249.21,-172.29 295279.79,-175.07 295309,-176.98 296068.17,-226.7 297971.71,-196.54 298732.5,-198.98 298871.29,-199.43 298907.99,-204.63 299044,-176.98 299058.85,-173.96 299074.41,-169.72 299089.28,-165.11"/>
<polygon fill="black" stroke="black" points="299090.48,-168.4 299098.94,-162.03 299088.35,-161.73 299090.48,-168.4"/>
<text text-anchor="middle" x="298754" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l6_dp2 -->
<g id="node982" class="node">
<title>expert1_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="299035.5,-161.98 298806.5,-161.98 298806.5,-109.98 299035.5,-109.98 299035.5,-161.98"/>
<text text-anchor="middle" x="298921" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L6</text>
<text text-anchor="middle" x="298921" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="298921" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="298921" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert1_l6_dp2 -->
<g id="edge1647" class="edge">
<title>router_l6_dp2&#45;&gt;expert1_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.95,-169.05C295249.21,-172.28 295279.79,-175.06 295309,-176.98 296000.08,-222.46 297732.93,-196.54 298425.5,-198.98 298590.9,-199.57 298634.67,-208.72 298797,-176.98 298812.06,-174.04 298827.82,-169.78 298842.86,-165.12"/>
<polygon fill="black" stroke="black" points="298844.17,-168.38 298852.63,-162.01 298842.04,-161.71 298844.17,-168.38"/>
<text text-anchor="middle" x="298447" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l6_dp2 -->
<g id="node983" class="node">
<title>expert2_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="298788.5,-161.98 298559.5,-161.98 298559.5,-109.98 298788.5,-109.98 298788.5,-161.98"/>
<text text-anchor="middle" x="298674" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L6</text>
<text text-anchor="middle" x="298674" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="298674" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="298674" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert2_l6_dp2 -->
<g id="edge1648" class="edge">
<title>router_l6_dp2&#45;&gt;expert2_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.95,-169.03C295249.21,-172.26 295279.79,-175.05 295309,-176.98 295918.68,-217.39 297447.48,-196.54 298058.5,-198.98 298277.16,-199.86 298335.03,-217.03 298550,-176.98 298565.27,-174.14 298581.24,-169.88 298596.45,-165.17"/>
<polygon fill="black" stroke="black" points="298597.86,-168.4 298606.32,-162.02 298595.73,-161.73 298597.86,-168.4"/>
<text text-anchor="middle" x="298080" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l6_dp2 -->
<g id="node984" class="node">
<title>expert3_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="298541.5,-161.98 298312.5,-161.98 298312.5,-109.98 298541.5,-109.98 298541.5,-161.98"/>
<text text-anchor="middle" x="298427" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L6</text>
<text text-anchor="middle" x="298427" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="298427" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="298427" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert3_l6_dp2 -->
<g id="edge1649" class="edge">
<title>router_l6_dp2&#45;&gt;expert3_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295126.67,-176.99C295165.3,-186.08 295207.21,-194.39 295246.5,-198.98 295265.48,-201.2 295270.39,-199.05 295289.5,-198.98 295624.34,-197.76 297972.61,-231.42 298303,-176.98 298318.93,-174.36 298335.6,-170.02 298351.35,-165.13"/>
<polygon fill="black" stroke="black" points="298352.58,-168.41 298361.03,-162.02 298350.44,-161.74 298352.58,-168.41"/>
<text text-anchor="middle" x="295268" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l6_dp2 -->
<g id="node985" class="node">
<title>expert4_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="298294.5,-161.98 298065.5,-161.98 298065.5,-109.98 298294.5,-109.98 298294.5,-161.98"/>
<text text-anchor="middle" x="298180" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L6</text>
<text text-anchor="middle" x="298180" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="298180" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="298180" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert4_l6_dp2 -->
<g id="edge1650" class="edge">
<title>router_l6_dp2&#45;&gt;expert4_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.95,-168.98C295249.21,-172.22 295279.8,-175.02 295309,-176.98 295810.67,-210.66 297068.7,-196.54 297571.5,-198.98 297787.05,-200.03 297844.1,-216.54 298056,-176.98 298071.27,-174.13 298087.24,-169.87 298102.45,-165.16"/>
<polygon fill="black" stroke="black" points="298103.86,-168.39 298112.32,-162.01 298101.73,-161.72 298103.86,-168.39"/>
<text text-anchor="middle" x="297593" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l6_dp2 -->
<g id="node986" class="node">
<title>expert5_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="298047.5,-161.98 297818.5,-161.98 297818.5,-109.98 298047.5,-109.98 298047.5,-161.98"/>
<text text-anchor="middle" x="297933" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L6</text>
<text text-anchor="middle" x="297933" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="297933" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="297933" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert5_l6_dp2 -->
<g id="edge1651" class="edge">
<title>router_l6_dp2&#45;&gt;expert5_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295153.37,-177C295198.98,-186.1 295248.37,-194.39 295294.5,-198.98 295313.52,-200.87 295318.39,-199.07 295337.5,-198.98 295612.12,-197.76 297538.07,-221.85 297809,-176.98 297824.93,-174.34 297841.59,-170 297857.35,-165.11"/>
<polygon fill="black" stroke="black" points="297858.58,-168.39 297867.03,-162 297856.44,-161.72 297858.58,-168.39"/>
<text text-anchor="middle" x="295316" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l6_dp2 -->
<g id="node987" class="node">
<title>expert6_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="297800.5,-161.98 297571.5,-161.98 297571.5,-109.98 297800.5,-109.98 297800.5,-161.98"/>
<text text-anchor="middle" x="297686" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L6</text>
<text text-anchor="middle" x="297686" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="297686" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="297686" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert6_l6_dp2 -->
<g id="edge1652" class="edge">
<title>router_l6_dp2&#45;&gt;expert6_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.96,-168.9C295249.22,-172.15 295279.8,-174.98 295309,-176.98 295713.75,-204.69 296728.94,-209.41 297134.5,-198.98 297324.69,-194.09 297375.01,-212.05 297562,-176.98 297577.26,-174.12 297593.24,-169.85 297608.45,-165.14"/>
<polygon fill="black" stroke="black" points="297609.85,-168.37 297618.32,-161.99 297607.73,-161.7 297609.85,-168.37"/>
<text text-anchor="middle" x="297113" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l6_dp2 -->
<g id="node988" class="node">
<title>expert7_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="297553.5,-161.98 297324.5,-161.98 297324.5,-109.98 297553.5,-109.98 297553.5,-161.98"/>
<text text-anchor="middle" x="297439" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L6</text>
<text text-anchor="middle" x="297439" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="297439" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="297439" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert7_l6_dp2 -->
<g id="edge1653" class="edge">
<title>router_l6_dp2&#45;&gt;expert7_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295180.02,-177C295232.62,-186.1 295289.5,-194.4 295342.5,-198.98 295361.54,-200.63 295366.39,-199.09 295385.5,-198.98 295599.9,-197.76 297103.52,-212.28 297315,-176.98 297330.83,-174.34 297347.4,-170.02 297363.07,-165.16"/>
<polygon fill="black" stroke="black" points="297364.25,-168.46 297372.7,-162.07 297362.11,-161.79 297364.25,-168.46"/>
<text text-anchor="middle" x="295364" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l6_dp2 -->
<g id="node989" class="node">
<title>expert8_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="297306.5,-161.98 297077.5,-161.98 297077.5,-109.98 297306.5,-109.98 297306.5,-161.98"/>
<text text-anchor="middle" x="297192" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L6</text>
<text text-anchor="middle" x="297192" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="297192" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="297192" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert8_l6_dp2 -->
<g id="edge1654" class="edge">
<title>router_l6_dp2&#45;&gt;expert8_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.52,-168.73C295248.92,-172.02 295279.66,-174.91 295309,-176.98 295610.4,-198.28 296366.46,-207.29 296668.5,-198.98 296846.26,-194.09 296893.28,-210.07 297068,-176.98 297083.17,-174.11 297099.04,-169.87 297114.16,-165.18"/>
<polygon fill="black" stroke="black" points="297115.52,-168.42 297123.98,-162.05 297113.39,-161.75 297115.52,-168.42"/>
<text text-anchor="middle" x="296647" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l6_dp2 -->
<g id="node990" class="node">
<title>expert9_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="297059.5,-161.98 296830.5,-161.98 296830.5,-109.98 297059.5,-109.98 297059.5,-161.98"/>
<text text-anchor="middle" x="296945" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L6</text>
<text text-anchor="middle" x="296945" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="296945" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="296945" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert9_l6_dp2 -->
<g id="edge1655" class="edge">
<title>router_l6_dp2&#45;&gt;expert9_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295206.65,-177.01C295266.23,-186.11 295330.61,-194.4 295390.5,-198.98 295549,-211.1 296664.26,-203.5 296821,-176.98 296836.83,-174.3 296853.39,-169.97 296869.06,-165.1"/>
<polygon fill="black" stroke="black" points="296870.24,-168.4 296878.69,-162.01 296868.1,-161.74 296870.24,-168.4"/>
<text text-anchor="middle" x="295412" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l6_dp2 -->
<g id="node991" class="node">
<title>expert10_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="296812.5,-161.98 296583.5,-161.98 296583.5,-109.98 296812.5,-109.98 296812.5,-161.98"/>
<text text-anchor="middle" x="296698" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L6</text>
<text text-anchor="middle" x="296698" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="296698" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="296698" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert10_l6_dp2 -->
<g id="edge1656" class="edge">
<title>router_l6_dp2&#45;&gt;expert10_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295218.1,-168.45C295248.64,-171.8 295279.53,-174.78 295309,-176.98 295717.53,-207.56 295821.04,-212.08 296230.5,-198.98 296383.4,-194.09 296423.82,-206.12 296574,-176.98 296589.06,-174.06 296604.83,-169.82 296619.87,-165.16"/>
<polygon fill="black" stroke="black" points="296621.17,-168.42 296629.64,-162.04 296619.05,-161.75 296621.17,-168.42"/>
<text text-anchor="middle" x="296209" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l6_dp2 -->
<g id="node992" class="node">
<title>expert11_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="296565.5,-161.98 296336.5,-161.98 296336.5,-109.98 296565.5,-109.98 296565.5,-161.98"/>
<text text-anchor="middle" x="296451" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L6</text>
<text text-anchor="middle" x="296451" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="296451" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="296451" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert11_l6_dp2 -->
<g id="edge1657" class="edge">
<title>router_l6_dp2&#45;&gt;expert11_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295227.89,-176.28C295295.94,-185.66 295369.91,-194.28 295438.5,-198.98 295635.54,-212.49 296132.43,-210.92 296327,-176.98 296342.72,-174.24 296359.17,-169.91 296374.76,-165.06"/>
<polygon fill="black" stroke="black" points="296375.89,-168.38 296384.35,-161.99 296373.75,-161.71 296375.89,-168.38"/>
<text text-anchor="middle" x="295460" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l6_dp2 -->
<g id="node993" class="node">
<title>expert12_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="296318.5,-161.98 296089.5,-161.98 296089.5,-109.98 296318.5,-109.98 296318.5,-161.98"/>
<text text-anchor="middle" x="296204" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L6</text>
<text text-anchor="middle" x="296204" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="296204" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="296204" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert12_l6_dp2 -->
<g id="edge1658" class="edge">
<title>router_l6_dp2&#45;&gt;expert12_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295217.25,-167.81C295248.07,-171.29 295279.26,-174.47 295309,-176.98 295309,-176.98 296080,-176.98 296080,-176.98 296094.65,-173.9 296110,-169.69 296124.7,-165.12"/>
<polygon fill="black" stroke="black" points="296125.79,-168.45 296134.26,-162.08 296123.67,-161.78 296125.79,-168.45"/>
<text text-anchor="middle" x="295827" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l6_dp2 -->
<g id="node994" class="node">
<title>expert13_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="296071.5,-161.98 295842.5,-161.98 295842.5,-109.98 296071.5,-109.98 296071.5,-161.98"/>
<text text-anchor="middle" x="295957" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L6</text>
<text text-anchor="middle" x="295957" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="295957" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="295957" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert13_l6_dp2 -->
<g id="edge1659" class="edge">
<title>router_l6_dp2&#45;&gt;expert13_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295211.04,-176.98C295383.78,-200.57 295625.28,-218.19 295833,-176.98 295847.96,-174.01 295863.62,-169.78 295878.58,-165.14"/>
<polygon fill="black" stroke="black" points="295879.83,-168.41 295888.29,-162.04 295877.7,-161.74 295879.83,-168.41"/>
<text text-anchor="middle" x="295508" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l6_dp2 -->
<g id="node995" class="node">
<title>expert14_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="295824.5,-161.98 295595.5,-161.98 295595.5,-109.98 295824.5,-109.98 295824.5,-161.98"/>
<text text-anchor="middle" x="295710" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L6</text>
<text text-anchor="middle" x="295710" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="295710" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="295710" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert14_l6_dp2 -->
<g id="edge1660" class="edge">
<title>router_l6_dp2&#45;&gt;expert14_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295220.4,-177C295355.73,-197.08 295510.84,-214.02 295577.5,-198.98 295605.7,-192.62 295634.94,-179.52 295658.75,-166.9"/>
<polygon fill="black" stroke="black" points="295660.48,-169.94 295667.6,-162.1 295657.14,-163.79 295660.48,-169.94"/>
<text text-anchor="middle" x="295556" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l6_dp2 -->
<g id="node996" class="node">
<title>expert15_l6_dp2</title>
<polygon fill="lightgreen" stroke="black" points="295547.5,-161.98 295318.5,-161.98 295318.5,-109.98 295547.5,-109.98 295547.5,-161.98"/>
<text text-anchor="middle" x="295433" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L6</text>
<text text-anchor="middle" x="295433" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="295433" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="295433" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp2&#45;&gt;expert15_l6_dp2 -->
<g id="edge1661" class="edge">
<title>router_l6_dp2&#45;&gt;expert15_l6_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M295177.94,-135.98C295222.13,-135.98 295267.83,-135.98 295308.12,-135.98"/>
<polygon fill="black" stroke="black" points="295308.25,-139.48 295318.25,-135.98 295308.25,-132.48 295308.25,-139.48"/>
<text text-anchor="middle" x="295273.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l6_dp2 -->
<g id="node997" class="node">
<title>expert_agg_l6_dp2</title>
<polygon fill="lightyellow" stroke="black" points="299813.57,-176.98 299419.74,-176.98 299318.43,-94.98 299712.26,-94.98 299813.57,-176.98"/>
<text text-anchor="middle" x="299566" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L6</text>
<text text-anchor="middle" x="299566" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="299566" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1662" class="edge">
<title>expert0_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M299282.66,-135.98C299308.06,-135.98 299333.47,-135.98 299358.87,-135.98"/>
<polygon fill="black" stroke="black" points="299358.99,-139.48 299368.99,-135.98 299358.99,-132.48 299358.99,-139.48"/>
</g>
<!-- expert1_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1663" class="edge">
<title>expert1_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M298976.24,-162.02C298999.4,-171.57 299026.96,-181.22 299053,-185.98 299103.06,-195.15 299231.3,-190.41 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert2_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1664" class="edge">
<title>expert2_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M298729.24,-162.02C298752.4,-171.57 298779.96,-181.22 298806,-185.98 298858.02,-195.51 299229.31,-190.59 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert3_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1665" class="edge">
<title>expert3_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M298482.24,-162.02C298505.4,-171.57 298532.96,-181.22 298559,-185.98 298638.02,-200.45 299201.97,-192.97 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert4_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1666" class="edge">
<title>expert4_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M298235.24,-162.02C298258.4,-171.57 298285.96,-181.22 298312,-185.98 298365.01,-195.69 299228.31,-190.67 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert5_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1667" class="edge">
<title>expert5_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M297988.24,-162.02C298011.4,-171.57 298038.96,-181.22 298065,-185.98 298131.5,-198.16 299214.64,-191.87 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert6_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1668" class="edge">
<title>expert6_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M297741.24,-162.02C297764.4,-171.57 297791.96,-181.22 297818,-185.98 297898,-200.63 299200.97,-193.06 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert7_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1669" class="edge">
<title>expert7_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M297494.24,-162.02C297517.4,-171.57 297544.96,-181.22 297571,-185.98 297617.75,-194.54 299234.65,-190.12 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert8_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1670" class="edge">
<title>expert8_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M297247.24,-162.02C297270.4,-171.57 297297.96,-181.22 297324,-185.98 297377.5,-195.78 299227.82,-190.72 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert9_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1671" class="edge">
<title>expert9_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M297000.24,-162.02C297023.4,-171.57 297050.96,-181.22 297077,-185.98 297137.25,-197.01 299220.98,-191.31 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert10_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1672" class="edge">
<title>expert10_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M296753.24,-162.02C296776.4,-171.57 296803.96,-181.22 296830,-185.98 296897,-198.25 299214.15,-191.91 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert11_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1673" class="edge">
<title>expert11_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M296506.24,-162.02C296529.4,-171.57 296556.96,-181.22 296583,-185.98 296656.75,-199.48 299207.31,-192.51 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert12_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1674" class="edge">
<title>expert12_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M296259.24,-162.02C296282.4,-171.57 296309.96,-181.22 296336,-185.98 296416.49,-200.72 299200.48,-193.1 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert13_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1675" class="edge">
<title>expert13_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M296012.24,-162.02C296035.4,-171.57 296062.96,-181.22 296089,-185.98 296132.62,-193.97 299237.82,-189.84 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert14_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1676" class="edge">
<title>expert14_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M295765.24,-162.02C295788.4,-171.57 295815.96,-181.22 295842,-185.98 295889,-194.59 299234.4,-190.14 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- expert15_l6_dp2&#45;&gt;expert_agg_l6_dp2 -->
<g id="edge1677" class="edge">
<title>expert15_l6_dp2&#45;&gt;expert_agg_l6_dp2</title>
<path fill="none" stroke="black" d="M295501.31,-162.04C295529.82,-171.6 295563.57,-181.24 295595,-185.98 295645.63,-193.62 299230.98,-190.44 299282,-185.98 299320.11,-182.65 299360.78,-176.86 299399.08,-170.36"/>
<polygon fill="black" stroke="black" points="299400.02,-173.75 299409.29,-168.6 299398.84,-166.85 299400.02,-173.75"/>
</g>
<!-- layer6_output_dp2 -->
<g id="node998" class="node">
<title>layer6_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="300018" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="300018" y="-144.48" font-family="Arial" font-size="10.00">Layer 6 Output</text>
<text text-anchor="middle" x="300018" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="300018" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l6_dp2&#45;&gt;layer6_output_dp2 -->
<g id="edge1678" class="edge">
<title>expert_agg_l6_dp2&#45;&gt;layer6_output_dp2</title>
<path fill="none" stroke="black" d="M299763.31,-135.98C299788.49,-135.98 299813.66,-135.98 299838.84,-135.98"/>
<polygon fill="black" stroke="black" points="299838.87,-139.48 299848.87,-135.98 299838.87,-132.48 299838.87,-139.48"/>
</g>
<!-- attn_input_l7_dp2 -->
<g id="node999" class="node">
<title>attn_input_l7_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="300391" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="300391" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L7</text>
<text text-anchor="middle" x="300391" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="300391" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer6_output_dp2&#45;&gt;attn_input_l7_dp2 -->
<g id="edge1679" class="edge">
<title>layer6_output_dp2&#45;&gt;attn_input_l7_dp2</title>
<path fill="none" stroke="black" d="M300187.01,-135.98C300195.23,-135.98 300203.44,-135.98 300211.66,-135.98"/>
<polygon fill="black" stroke="black" points="300211.68,-139.48 300221.68,-135.98 300211.68,-132.48 300211.68,-139.48"/>
</g>
<!-- attn_tp0_l7_dp2 -->
<g id="node1000" class="node">
<title>attn_tp0_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="301689,-161.98 301429,-161.98 301429,-109.98 301689,-109.98 301689,-161.98"/>
<text text-anchor="middle" x="301559" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L7</text>
<text text-anchor="middle" x="301559" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="301559" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="301559" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp2&#45;&gt;attn_tp0_l7_dp2 -->
<g id="edge1680" class="edge">
<title>attn_input_l7_dp2&#45;&gt;attn_tp0_l7_dp2</title>
<path fill="none" stroke="black" d="M300474.52,-161.26C300511.12,-171.09 300554.81,-181.13 300595,-185.98 300640,-191.42 301366.27,-193.33 301411,-185.98 301436.4,-181.81 301463.31,-173.85 301487.12,-165.5"/>
<polygon fill="black" stroke="black" points="301488.55,-168.71 301496.78,-162.03 301486.18,-162.12 301488.55,-168.71"/>
</g>
<!-- attn_tp1_l7_dp2 -->
<g id="node1001" class="node">
<title>attn_tp1_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="301411,-161.98 301151,-161.98 301151,-109.98 301411,-109.98 301411,-161.98"/>
<text text-anchor="middle" x="301281" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L7</text>
<text text-anchor="middle" x="301281" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="301281" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="301281" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp2&#45;&gt;attn_tp1_l7_dp2 -->
<g id="edge1681" class="edge">
<title>attn_input_l7_dp2&#45;&gt;attn_tp1_l7_dp2</title>
<path fill="none" stroke="black" d="M300474.52,-161.26C300511.12,-171.09 300554.81,-181.13 300595,-185.98 300654.35,-193.15 301074.01,-195.68 301133,-185.98 301158.4,-181.81 301185.31,-173.85 301209.12,-165.5"/>
<polygon fill="black" stroke="black" points="301210.55,-168.71 301218.78,-162.03 301208.18,-162.12 301210.55,-168.71"/>
</g>
<!-- attn_tp2_l7_dp2 -->
<g id="node1002" class="node">
<title>attn_tp2_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="301133,-161.98 300873,-161.98 300873,-109.98 301133,-109.98 301133,-161.98"/>
<text text-anchor="middle" x="301003" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L7</text>
<text text-anchor="middle" x="301003" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="301003" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="301003" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp2&#45;&gt;attn_tp2_l7_dp2 -->
<g id="edge1682" class="edge">
<title>attn_input_l7_dp2&#45;&gt;attn_tp2_l7_dp2</title>
<path fill="none" stroke="black" d="M300474.52,-161.26C300511.12,-171.09 300554.81,-181.13 300595,-185.98 300652.36,-192.91 300797.99,-195.35 300855,-185.98 300880.4,-181.81 300907.31,-173.85 300931.12,-165.5"/>
<polygon fill="black" stroke="black" points="300932.55,-168.71 300940.78,-162.03 300930.18,-162.12 300932.55,-168.71"/>
</g>
<!-- attn_tp3_l7_dp2 -->
<g id="node1003" class="node">
<title>attn_tp3_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="300855,-161.98 300595,-161.98 300595,-109.98 300855,-109.98 300855,-161.98"/>
<text text-anchor="middle" x="300725" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L7</text>
<text text-anchor="middle" x="300725" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="300725" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="300725" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp2&#45;&gt;attn_tp3_l7_dp2 -->
<g id="edge1683" class="edge">
<title>attn_input_l7_dp2&#45;&gt;attn_tp3_l7_dp2</title>
<path fill="none" stroke="black" d="M300560.28,-135.98C300568.35,-135.98 300576.42,-135.98 300584.49,-135.98"/>
<polygon fill="black" stroke="black" points="300584.7,-139.48 300594.7,-135.98 300584.7,-132.48 300584.7,-139.48"/>
</g>
<!-- allreduce_l7_dp2 -->
<g id="node1004" class="node">
<title>allreduce_l7_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="301893" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="301893" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L7</text>
<text text-anchor="middle" x="301893" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="301893" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l7_dp2&#45;&gt;allreduce_l7_dp2 -->
<g id="edge1684" class="edge">
<title>attn_tp0_l7_dp2&#45;&gt;allreduce_l7_dp2</title>
<path fill="none" stroke="black" d="M301689.14,-135.98C301697.35,-135.98 301705.56,-135.98 301713.77,-135.98"/>
<polygon fill="black" stroke="black" points="301713.78,-139.48 301723.78,-135.98 301713.78,-132.48 301713.78,-139.48"/>
</g>
<!-- attn_tp1_l7_dp2&#45;&gt;allreduce_l7_dp2 -->
<g id="edge1685" class="edge">
<title>attn_tp1_l7_dp2&#45;&gt;allreduce_l7_dp2</title>
<path fill="none" stroke="black" d="M301343.22,-162.03C301369.24,-171.59 301400.1,-181.23 301429,-185.98 301486.01,-195.35 301631.64,-192.91 301689,-185.98 301725.57,-181.57 301765.05,-172.85 301799.44,-163.91"/>
<polygon fill="black" stroke="black" points="301800.7,-167.2 301809.47,-161.26 301798.91,-160.43 301800.7,-167.2"/>
</g>
<!-- attn_tp2_l7_dp2&#45;&gt;allreduce_l7_dp2 -->
<g id="edge1686" class="edge">
<title>attn_tp2_l7_dp2&#45;&gt;allreduce_l7_dp2</title>
<path fill="none" stroke="black" d="M301065.22,-162.03C301091.24,-171.59 301122.1,-181.23 301151,-185.98 301209.98,-195.68 301629.65,-193.15 301689,-185.98 301725.57,-181.57 301765.05,-172.85 301799.44,-163.91"/>
<polygon fill="black" stroke="black" points="301800.7,-167.2 301809.47,-161.26 301798.91,-160.43 301800.7,-167.2"/>
</g>
<!-- attn_tp3_l7_dp2&#45;&gt;allreduce_l7_dp2 -->
<g id="edge1687" class="edge">
<title>attn_tp3_l7_dp2&#45;&gt;allreduce_l7_dp2</title>
<path fill="none" stroke="black" d="M300787.22,-162.03C300813.24,-171.59 300844.1,-181.23 300873,-185.98 300917.73,-193.33 301643.99,-191.42 301689,-185.98 301725.57,-181.57 301765.05,-172.85 301799.44,-163.91"/>
<polygon fill="black" stroke="black" points="301800.7,-167.2 301809.47,-161.26 301798.91,-160.43 301800.7,-167.2"/>
</g>
<!-- moe_input_l7_dp2 -->
<g id="node1005" class="node">
<title>moe_input_l7_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="302266" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="302266" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L7</text>
<text text-anchor="middle" x="302266" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="302266" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l7_dp2&#45;&gt;moe_input_l7_dp2 -->
<g id="edge1688" class="edge">
<title>allreduce_l7_dp2&#45;&gt;moe_input_l7_dp2</title>
<path fill="none" stroke="black" d="M302062.01,-135.98C302070.23,-135.98 302078.44,-135.98 302086.66,-135.98"/>
<polygon fill="black" stroke="black" points="302086.68,-139.48 302096.68,-135.98 302086.68,-132.48 302086.68,-139.48"/>
</g>
<!-- router_l7_dp2 -->
<g id="node1006" class="node">
<title>router_l7_dp2</title>
<polygon fill="lightyellow" stroke="black" points="302965.57,-176.98 302571.74,-176.98 302470.43,-94.98 302864.26,-94.98 302965.57,-176.98"/>
<text text-anchor="middle" x="302718" y="-144.48" font-family="Arial" font-size="10.00">Router L7</text>
<text text-anchor="middle" x="302718" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="302718" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l7_dp2&#45;&gt;router_l7_dp2 -->
<g id="edge1689" class="edge">
<title>moe_input_l7_dp2&#45;&gt;router_l7_dp2</title>
<path fill="none" stroke="black" d="M302435.06,-135.98C302460.34,-135.98 302485.63,-135.98 302510.92,-135.98"/>
<polygon fill="black" stroke="black" points="302510.99,-139.48 302520.99,-135.98 302510.99,-132.48 302510.99,-139.48"/>
</g>
<!-- expert0_l7_dp2 -->
<g id="node1007" class="node">
<title>expert0_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="306971.5,-161.98 306742.5,-161.98 306742.5,-109.98 306971.5,-109.98 306971.5,-161.98"/>
<text text-anchor="middle" x="306857" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L7</text>
<text text-anchor="middle" x="306857" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="306857" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="306857" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert0_l7_dp2 -->
<g id="edge1690" class="edge">
<title>router_l7_dp2&#45;&gt;expert0_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.74,-171.32C302980.09,-173.59 303001.41,-175.53 303022,-176.98 303782.47,-230.48 305690.15,-196.54 306452.5,-198.98 306577.55,-199.38 306610.59,-202.54 306733,-176.98 306747.75,-173.9 306763.19,-169.66 306777.98,-165.07"/>
<polygon fill="black" stroke="black" points="306779.12,-168.37 306787.59,-162 306777,-161.7 306779.12,-168.37"/>
<text text-anchor="middle" x="306474" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l7_dp2 -->
<g id="node1008" class="node">
<title>expert1_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="306724.5,-161.98 306495.5,-161.98 306495.5,-109.98 306724.5,-109.98 306724.5,-161.98"/>
<text text-anchor="middle" x="306610" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L7</text>
<text text-anchor="middle" x="306610" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="306610" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="306610" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert1_l7_dp2 -->
<g id="edge1691" class="edge">
<title>router_l7_dp2&#45;&gt;expert1_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.74,-171.31C302980.09,-173.58 303001.41,-175.53 303022,-176.98 303721.05,-226.36 305474.71,-196.54 306175.5,-198.98 306313.84,-199.47 306350.43,-204.56 306486,-176.98 306500.85,-173.96 306516.41,-169.72 306531.28,-165.11"/>
<polygon fill="black" stroke="black" points="306532.48,-168.4 306540.94,-162.03 306530.35,-161.73 306532.48,-168.4"/>
<text text-anchor="middle" x="306197" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l7_dp2 -->
<g id="node1009" class="node">
<title>expert2_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="306477.5,-161.98 306248.5,-161.98 306248.5,-109.98 306477.5,-109.98 306477.5,-161.98"/>
<text text-anchor="middle" x="306363" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L7</text>
<text text-anchor="middle" x="306363" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="306363" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="306363" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert2_l7_dp2 -->
<g id="edge1692" class="edge">
<title>router_l7_dp2&#45;&gt;expert2_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.74,-171.29C302980.1,-173.56 303001.41,-175.52 303022,-176.98 303653.21,-221.81 305236.71,-196.54 305869.5,-198.98 306034.01,-199.62 306077.55,-208.59 306239,-176.98 306254.06,-174.03 306269.82,-169.78 306284.86,-165.12"/>
<polygon fill="black" stroke="black" points="306286.17,-168.37 306294.63,-162 306284.04,-161.71 306286.17,-168.37"/>
<text text-anchor="middle" x="305891" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l7_dp2 -->
<g id="node1010" class="node">
<title>expert3_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="306230.5,-161.98 306001.5,-161.98 306001.5,-109.98 306230.5,-109.98 306230.5,-161.98"/>
<text text-anchor="middle" x="306116" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L7</text>
<text text-anchor="middle" x="306116" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="306116" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="306116" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert3_l7_dp2 -->
<g id="edge1693" class="edge">
<title>router_l7_dp2&#45;&gt;expert3_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.74,-171.27C302980.1,-173.54 303001.41,-175.51 303022,-176.98 303572.28,-216.37 304952.82,-196.54 305504.5,-198.98 305721.38,-199.94 305778.79,-216.75 305992,-176.98 306007.27,-174.14 306023.24,-169.88 306038.45,-165.17"/>
<polygon fill="black" stroke="black" points="306039.86,-168.39 306048.32,-162.01 306037.73,-161.72 306039.86,-168.39"/>
<text text-anchor="middle" x="305526" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l7_dp2 -->
<g id="node1011" class="node">
<title>expert4_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="305983.5,-161.98 305754.5,-161.98 305754.5,-109.98 305983.5,-109.98 305983.5,-161.98"/>
<text text-anchor="middle" x="305869" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L7</text>
<text text-anchor="middle" x="305869" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="305869" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="305869" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert4_l7_dp2 -->
<g id="edge1694" class="edge">
<title>router_l7_dp2&#45;&gt;expert4_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302863.67,-176.99C302902.3,-186.08 302944.21,-194.39 302983.5,-198.98 303002.48,-201.2 303007.39,-199.06 303026.5,-198.98 303328.56,-197.76 305446.97,-226.21 305745,-176.98 305760.93,-174.35 305777.6,-170.01 305793.35,-165.12"/>
<polygon fill="black" stroke="black" points="305794.58,-168.4 305803.03,-162.01 305792.44,-161.73 305794.58,-168.4"/>
<text text-anchor="middle" x="303005" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l7_dp2 -->
<g id="node1012" class="node">
<title>expert5_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="305736.5,-161.98 305507.5,-161.98 305507.5,-109.98 305736.5,-109.98 305736.5,-161.98"/>
<text text-anchor="middle" x="305622" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L7</text>
<text text-anchor="middle" x="305622" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="305622" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="305622" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert5_l7_dp2 -->
<g id="edge1695" class="edge">
<title>router_l7_dp2&#45;&gt;expert5_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.74,-171.22C302980.1,-173.51 303001.42,-175.49 303022,-176.98 303465.19,-209.18 304577.15,-196.54 305021.5,-198.98 305233.5,-200.15 305289.61,-215.98 305498,-176.98 305513.26,-174.13 305529.24,-169.86 305544.45,-165.15"/>
<polygon fill="black" stroke="black" points="305545.86,-168.37 305554.32,-162 305543.73,-161.71 305545.86,-168.37"/>
<text text-anchor="middle" x="305043" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l7_dp2 -->
<g id="node1013" class="node">
<title>expert6_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="305489.5,-161.98 305260.5,-161.98 305260.5,-109.98 305489.5,-109.98 305489.5,-161.98"/>
<text text-anchor="middle" x="305375" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L7</text>
<text text-anchor="middle" x="305375" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="305375" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="305375" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert6_l7_dp2 -->
<g id="edge1696" class="edge">
<title>router_l7_dp2&#45;&gt;expert6_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302890.37,-177C302935.98,-186.1 302985.37,-194.39 303031.5,-198.98 303050.52,-200.87 303055.39,-199.08 303074.5,-198.98 303316.34,-197.76 305012.43,-216.64 305251,-176.98 305266.84,-174.35 305283.4,-170.04 305299.07,-165.18"/>
<polygon fill="black" stroke="black" points="305300.25,-168.47 305308.7,-162.09 305298.11,-161.81 305300.25,-168.47"/>
<text text-anchor="middle" x="303053" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l7_dp2 -->
<g id="node1014" class="node">
<title>expert7_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="305242.5,-161.98 305013.5,-161.98 305013.5,-109.98 305242.5,-109.98 305242.5,-161.98"/>
<text text-anchor="middle" x="305128" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L7</text>
<text text-anchor="middle" x="305128" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="305128" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="305128" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert7_l7_dp2 -->
<g id="edge1697" class="edge">
<title>router_l7_dp2&#45;&gt;expert7_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.33,-171.1C302979.83,-173.42 303001.29,-175.44 303022,-176.98 303370.07,-202.87 304243.59,-208.3 304592.5,-198.98 304775.58,-194.09 304824.02,-210.92 305004,-176.98 305019.17,-174.12 305035.04,-169.88 305050.17,-165.2"/>
<polygon fill="black" stroke="black" points="305051.52,-168.44 305059.99,-162.07 305049.4,-161.77 305051.52,-168.44"/>
<text text-anchor="middle" x="304571" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l7_dp2 -->
<g id="node1015" class="node">
<title>expert8_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="304995.5,-161.98 304766.5,-161.98 304766.5,-109.98 304995.5,-109.98 304995.5,-161.98"/>
<text text-anchor="middle" x="304881" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L7</text>
<text text-anchor="middle" x="304881" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="304881" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="304881" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert8_l7_dp2 -->
<g id="edge1698" class="edge">
<title>router_l7_dp2&#45;&gt;expert8_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302917.02,-177C302969.62,-186.1 303026.5,-194.4 303079.5,-198.98 303098.54,-200.63 303103.39,-199.11 303122.5,-198.98 303304.12,-197.76 304577.88,-207.07 304757,-176.98 304772.83,-174.32 304789.39,-170 304805.07,-165.13"/>
<polygon fill="black" stroke="black" points="304806.24,-168.43 304814.7,-162.04 304804.1,-161.77 304806.24,-168.43"/>
<text text-anchor="middle" x="303101" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l7_dp2 -->
<g id="node1016" class="node">
<title>expert9_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="304748.5,-161.98 304519.5,-161.98 304519.5,-109.98 304748.5,-109.98 304748.5,-161.98"/>
<text text-anchor="middle" x="304634" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L7</text>
<text text-anchor="middle" x="304634" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="304634" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="304634" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert9_l7_dp2 -->
<g id="edge1699" class="edge">
<title>router_l7_dp2&#45;&gt;expert9_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302958.35,-170.96C302979.84,-173.31 303001.29,-175.38 303022,-176.98 303518.17,-215.39 303644.07,-213.82 304141.5,-198.98 304305.49,-194.09 304348.87,-207.88 304510,-176.98 304525.16,-174.08 304541.03,-169.81 304556.15,-165.12"/>
<polygon fill="black" stroke="black" points="304557.51,-168.37 304565.97,-161.99 304555.38,-161.7 304557.51,-168.37"/>
<text text-anchor="middle" x="304120" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l7_dp2 -->
<g id="node1017" class="node">
<title>expert10_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="304501.5,-161.98 304272.5,-161.98 304272.5,-109.98 304501.5,-109.98 304501.5,-161.98"/>
<text text-anchor="middle" x="304387" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L7</text>
<text text-anchor="middle" x="304387" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="304387" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="304387" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert10_l7_dp2 -->
<g id="edge1700" class="edge">
<title>router_l7_dp2&#45;&gt;expert10_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302943.65,-177.01C303003.23,-186.11 303067.61,-194.4 303127.5,-198.98 303253.32,-208.6 304138.62,-198.3 304263,-176.98 304278.73,-174.29 304295.18,-169.97 304310.78,-165.14"/>
<polygon fill="black" stroke="black" points="304311.9,-168.45 304320.36,-162.07 304309.77,-161.78 304311.9,-168.45"/>
<text text-anchor="middle" x="303149" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l7_dp2 -->
<g id="node1018" class="node">
<title>expert11_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="304254.5,-161.98 304025.5,-161.98 304025.5,-109.98 304254.5,-109.98 304254.5,-161.98"/>
<text text-anchor="middle" x="304140" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L7</text>
<text text-anchor="middle" x="304140" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="304140" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="304140" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert11_l7_dp2 -->
<g id="edge1701" class="edge">
<title>router_l7_dp2&#45;&gt;expert11_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302957.95,-170.64C302979.58,-173.07 303001.17,-175.24 303022,-176.98 303337.71,-203.39 303417.92,-211.33 303734.5,-198.98 303859.9,-194.09 303892.97,-201.75 304016,-176.98 304030.86,-173.99 304046.42,-169.77 304061.29,-165.16"/>
<polygon fill="black" stroke="black" points="304062.48,-168.45 304070.95,-162.08 304060.36,-161.78 304062.48,-168.45"/>
<text text-anchor="middle" x="303713" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l7_dp2 -->
<g id="node1019" class="node">
<title>expert12_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="304007.5,-161.98 303778.5,-161.98 303778.5,-109.98 304007.5,-109.98 304007.5,-161.98"/>
<text text-anchor="middle" x="303893" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L7</text>
<text text-anchor="middle" x="303893" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="303893" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="303893" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert12_l7_dp2 -->
<g id="edge1702" class="edge">
<title>router_l7_dp2&#45;&gt;expert12_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302964.89,-176.28C303032.94,-185.66 303106.91,-194.28 303175.5,-198.98 303307.17,-208.01 303639.14,-200.56 303769,-176.98 303784.37,-174.19 303800.45,-169.93 303815.75,-165.2"/>
<polygon fill="black" stroke="black" points="303817.21,-168.41 303825.67,-162.03 303815.08,-161.74 303817.21,-168.41"/>
<text text-anchor="middle" x="303197" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l7_dp2 -->
<g id="node1020" class="node">
<title>expert13_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="303760.5,-161.98 303531.5,-161.98 303531.5,-109.98 303760.5,-109.98 303760.5,-161.98"/>
<text text-anchor="middle" x="303646" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L7</text>
<text text-anchor="middle" x="303646" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="303646" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="303646" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert13_l7_dp2 -->
<g id="edge1703" class="edge">
<title>router_l7_dp2&#45;&gt;expert13_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302935.82,-177.02C303072.96,-197.58 303253.66,-215.02 303413.5,-198.98 303464.66,-193.85 303520.31,-179.11 303564.33,-165.18"/>
<polygon fill="black" stroke="black" points="303565.66,-168.43 303574.11,-162.04 303563.52,-161.77 303565.66,-168.43"/>
<text text-anchor="middle" x="303392" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l7_dp2 -->
<g id="node1021" class="node">
<title>expert14_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="303513.5,-161.98 303284.5,-161.98 303284.5,-109.98 303513.5,-109.98 303513.5,-161.98"/>
<text text-anchor="middle" x="303399" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L7</text>
<text text-anchor="middle" x="303399" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="303399" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="303399" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert14_l7_dp2 -->
<g id="edge1704" class="edge">
<title>router_l7_dp2&#45;&gt;expert14_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302943.44,-176.99C303066.58,-196.39 303206.01,-212.63 303266.5,-198.98 303294.7,-192.62 303323.94,-179.52 303347.75,-166.9"/>
<polygon fill="black" stroke="black" points="303349.48,-169.94 303356.6,-162.1 303346.14,-163.79 303349.48,-169.94"/>
<text text-anchor="middle" x="303245" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l7_dp2 -->
<g id="node1022" class="node">
<title>expert15_l7_dp2</title>
<polygon fill="lightgreen" stroke="black" points="303260.5,-161.98 303031.5,-161.98 303031.5,-109.98 303260.5,-109.98 303260.5,-161.98"/>
<text text-anchor="middle" x="303146" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L7</text>
<text text-anchor="middle" x="303146" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="303146" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="303146" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp2&#45;&gt;expert15_l7_dp2 -->
<g id="edge1705" class="edge">
<title>router_l7_dp2&#45;&gt;expert15_l7_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M302915.09,-135.98C302951.17,-135.98 302987.91,-135.98 303021.14,-135.98"/>
<polygon fill="black" stroke="black" points="303021.34,-139.48 303031.34,-135.98 303021.34,-132.48 303021.34,-139.48"/>
<text text-anchor="middle" x="302998.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l7_dp2 -->
<g id="node1023" class="node">
<title>expert_agg_l7_dp2</title>
<polygon fill="lightyellow" stroke="black" points="307502.57,-176.98 307108.74,-176.98 307007.43,-94.98 307401.26,-94.98 307502.57,-176.98"/>
<text text-anchor="middle" x="307255" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L7</text>
<text text-anchor="middle" x="307255" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="307255" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1706" class="edge">
<title>expert0_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M306971.66,-135.98C306997.06,-135.98 307022.47,-135.98 307047.87,-135.98"/>
<polygon fill="black" stroke="black" points="307047.99,-139.48 307057.99,-135.98 307047.99,-132.48 307047.99,-139.48"/>
</g>
<!-- expert1_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1707" class="edge">
<title>expert1_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M306665.24,-162.02C306688.4,-171.57 306715.96,-181.22 306742,-185.98 306792.06,-195.15 306920.3,-190.41 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert2_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1708" class="edge">
<title>expert2_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M306418.24,-162.02C306441.4,-171.57 306468.96,-181.22 306495,-185.98 306547.02,-195.51 306918.31,-190.59 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert3_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1709" class="edge">
<title>expert3_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M306171.24,-162.02C306194.4,-171.57 306221.96,-181.22 306248,-185.98 306327.02,-200.45 306890.97,-192.97 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert4_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1710" class="edge">
<title>expert4_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M305924.24,-162.02C305947.4,-171.57 305974.96,-181.22 306001,-185.98 306054.01,-195.69 306917.31,-190.67 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert5_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1711" class="edge">
<title>expert5_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M305677.24,-162.02C305700.4,-171.57 305727.96,-181.22 305754,-185.98 305820.5,-198.16 306903.64,-191.87 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert6_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1712" class="edge">
<title>expert6_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M305430.24,-162.02C305453.4,-171.57 305480.96,-181.22 305507,-185.98 305587,-200.63 306889.97,-193.06 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert7_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1713" class="edge">
<title>expert7_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M305183.24,-162.02C305206.4,-171.57 305233.96,-181.22 305260,-185.98 305306.75,-194.54 306923.65,-190.12 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert8_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1714" class="edge">
<title>expert8_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M304936.24,-162.02C304959.4,-171.57 304986.96,-181.22 305013,-185.98 305066.5,-195.78 306916.82,-190.72 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert9_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1715" class="edge">
<title>expert9_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M304689.24,-162.02C304712.4,-171.57 304739.96,-181.22 304766,-185.98 304826.25,-197.01 306909.98,-191.31 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert10_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1716" class="edge">
<title>expert10_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M304442.24,-162.02C304465.4,-171.57 304492.96,-181.22 304519,-185.98 304586,-198.25 306903.15,-191.91 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert11_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1717" class="edge">
<title>expert11_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M304195.24,-162.02C304218.4,-171.57 304245.96,-181.22 304272,-185.98 304345.75,-199.48 306896.31,-192.51 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert12_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1718" class="edge">
<title>expert12_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M303948.24,-162.02C303971.4,-171.57 303998.96,-181.22 304025,-185.98 304105.49,-200.72 306889.48,-193.1 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert13_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1719" class="edge">
<title>expert13_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M303701.24,-162.02C303724.4,-171.57 303751.96,-181.22 303778,-185.98 303821.62,-193.97 306926.82,-189.84 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert14_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1720" class="edge">
<title>expert14_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M303454.24,-162.02C303477.4,-171.57 303504.96,-181.22 303531,-185.98 303578,-194.59 306923.4,-190.14 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- expert15_l7_dp2&#45;&gt;expert_agg_l7_dp2 -->
<g id="edge1721" class="edge">
<title>expert15_l7_dp2&#45;&gt;expert_agg_l7_dp2</title>
<path fill="none" stroke="black" d="M303203.86,-162.02C303228.1,-171.58 303256.89,-181.22 303284,-185.98 303334.44,-194.84 306919.98,-190.44 306971,-185.98 307009.11,-182.65 307049.78,-176.86 307088.08,-170.36"/>
<polygon fill="black" stroke="black" points="307089.02,-173.75 307098.29,-168.6 307087.84,-166.85 307089.02,-173.75"/>
</g>
<!-- layer7_output_dp2 -->
<g id="node1024" class="node">
<title>layer7_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="307707" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="307707" y="-144.48" font-family="Arial" font-size="10.00">Layer 7 Output</text>
<text text-anchor="middle" x="307707" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="307707" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l7_dp2&#45;&gt;layer7_output_dp2 -->
<g id="edge1722" class="edge">
<title>expert_agg_l7_dp2&#45;&gt;layer7_output_dp2</title>
<path fill="none" stroke="black" d="M307452.31,-135.98C307477.49,-135.98 307502.66,-135.98 307527.84,-135.98"/>
<polygon fill="black" stroke="black" points="307527.87,-139.48 307537.87,-135.98 307527.87,-132.48 307527.87,-139.48"/>
</g>
<!-- attn_input_l8_dp2 -->
<g id="node1025" class="node">
<title>attn_input_l8_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="308080" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="308080" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L8</text>
<text text-anchor="middle" x="308080" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="308080" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer7_output_dp2&#45;&gt;attn_input_l8_dp2 -->
<g id="edge1723" class="edge">
<title>layer7_output_dp2&#45;&gt;attn_input_l8_dp2</title>
<path fill="none" stroke="black" d="M307876.01,-135.98C307884.23,-135.98 307892.44,-135.98 307900.66,-135.98"/>
<polygon fill="black" stroke="black" points="307900.68,-139.48 307910.68,-135.98 307900.68,-132.48 307900.68,-139.48"/>
</g>
<!-- attn_tp0_l8_dp2 -->
<g id="node1026" class="node">
<title>attn_tp0_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="309378,-161.98 309118,-161.98 309118,-109.98 309378,-109.98 309378,-161.98"/>
<text text-anchor="middle" x="309248" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L8</text>
<text text-anchor="middle" x="309248" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="309248" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="309248" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp2&#45;&gt;attn_tp0_l8_dp2 -->
<g id="edge1724" class="edge">
<title>attn_input_l8_dp2&#45;&gt;attn_tp0_l8_dp2</title>
<path fill="none" stroke="black" d="M308163.52,-161.26C308200.12,-171.09 308243.81,-181.13 308284,-185.98 308329,-191.42 309055.27,-193.33 309100,-185.98 309125.4,-181.81 309152.31,-173.85 309176.12,-165.5"/>
<polygon fill="black" stroke="black" points="309177.55,-168.71 309185.78,-162.03 309175.18,-162.12 309177.55,-168.71"/>
</g>
<!-- attn_tp1_l8_dp2 -->
<g id="node1027" class="node">
<title>attn_tp1_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="309100,-161.98 308840,-161.98 308840,-109.98 309100,-109.98 309100,-161.98"/>
<text text-anchor="middle" x="308970" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L8</text>
<text text-anchor="middle" x="308970" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="308970" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="308970" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp2&#45;&gt;attn_tp1_l8_dp2 -->
<g id="edge1725" class="edge">
<title>attn_input_l8_dp2&#45;&gt;attn_tp1_l8_dp2</title>
<path fill="none" stroke="black" d="M308163.52,-161.26C308200.12,-171.09 308243.81,-181.13 308284,-185.98 308343.35,-193.15 308763.01,-195.68 308822,-185.98 308847.4,-181.81 308874.31,-173.85 308898.12,-165.5"/>
<polygon fill="black" stroke="black" points="308899.55,-168.71 308907.78,-162.03 308897.18,-162.12 308899.55,-168.71"/>
</g>
<!-- attn_tp2_l8_dp2 -->
<g id="node1028" class="node">
<title>attn_tp2_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="308822,-161.98 308562,-161.98 308562,-109.98 308822,-109.98 308822,-161.98"/>
<text text-anchor="middle" x="308692" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L8</text>
<text text-anchor="middle" x="308692" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="308692" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="308692" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp2&#45;&gt;attn_tp2_l8_dp2 -->
<g id="edge1726" class="edge">
<title>attn_input_l8_dp2&#45;&gt;attn_tp2_l8_dp2</title>
<path fill="none" stroke="black" d="M308163.52,-161.26C308200.12,-171.09 308243.81,-181.13 308284,-185.98 308341.36,-192.91 308486.99,-195.35 308544,-185.98 308569.4,-181.81 308596.31,-173.85 308620.12,-165.5"/>
<polygon fill="black" stroke="black" points="308621.55,-168.71 308629.78,-162.03 308619.18,-162.12 308621.55,-168.71"/>
</g>
<!-- attn_tp3_l8_dp2 -->
<g id="node1029" class="node">
<title>attn_tp3_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="308544,-161.98 308284,-161.98 308284,-109.98 308544,-109.98 308544,-161.98"/>
<text text-anchor="middle" x="308414" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L8</text>
<text text-anchor="middle" x="308414" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="308414" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="308414" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp2&#45;&gt;attn_tp3_l8_dp2 -->
<g id="edge1727" class="edge">
<title>attn_input_l8_dp2&#45;&gt;attn_tp3_l8_dp2</title>
<path fill="none" stroke="black" d="M308249.28,-135.98C308257.35,-135.98 308265.42,-135.98 308273.49,-135.98"/>
<polygon fill="black" stroke="black" points="308273.7,-139.48 308283.7,-135.98 308273.7,-132.48 308273.7,-139.48"/>
</g>
<!-- allreduce_l8_dp2 -->
<g id="node1030" class="node">
<title>allreduce_l8_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="309582" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="309582" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L8</text>
<text text-anchor="middle" x="309582" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="309582" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l8_dp2&#45;&gt;allreduce_l8_dp2 -->
<g id="edge1728" class="edge">
<title>attn_tp0_l8_dp2&#45;&gt;allreduce_l8_dp2</title>
<path fill="none" stroke="black" d="M309378.14,-135.98C309386.35,-135.98 309394.56,-135.98 309402.77,-135.98"/>
<polygon fill="black" stroke="black" points="309402.78,-139.48 309412.78,-135.98 309402.78,-132.48 309402.78,-139.48"/>
</g>
<!-- attn_tp1_l8_dp2&#45;&gt;allreduce_l8_dp2 -->
<g id="edge1729" class="edge">
<title>attn_tp1_l8_dp2&#45;&gt;allreduce_l8_dp2</title>
<path fill="none" stroke="black" d="M309032.22,-162.03C309058.24,-171.59 309089.1,-181.23 309118,-185.98 309175.01,-195.35 309320.64,-192.91 309378,-185.98 309414.57,-181.57 309454.05,-172.85 309488.44,-163.91"/>
<polygon fill="black" stroke="black" points="309489.7,-167.2 309498.47,-161.26 309487.91,-160.43 309489.7,-167.2"/>
</g>
<!-- attn_tp2_l8_dp2&#45;&gt;allreduce_l8_dp2 -->
<g id="edge1730" class="edge">
<title>attn_tp2_l8_dp2&#45;&gt;allreduce_l8_dp2</title>
<path fill="none" stroke="black" d="M308754.22,-162.03C308780.24,-171.59 308811.1,-181.23 308840,-185.98 308898.98,-195.68 309318.65,-193.15 309378,-185.98 309414.57,-181.57 309454.05,-172.85 309488.44,-163.91"/>
<polygon fill="black" stroke="black" points="309489.7,-167.2 309498.47,-161.26 309487.91,-160.43 309489.7,-167.2"/>
</g>
<!-- attn_tp3_l8_dp2&#45;&gt;allreduce_l8_dp2 -->
<g id="edge1731" class="edge">
<title>attn_tp3_l8_dp2&#45;&gt;allreduce_l8_dp2</title>
<path fill="none" stroke="black" d="M308476.22,-162.03C308502.24,-171.59 308533.1,-181.23 308562,-185.98 308606.73,-193.33 309332.99,-191.42 309378,-185.98 309414.57,-181.57 309454.05,-172.85 309488.44,-163.91"/>
<polygon fill="black" stroke="black" points="309489.7,-167.2 309498.47,-161.26 309487.91,-160.43 309489.7,-167.2"/>
</g>
<!-- moe_input_l8_dp2 -->
<g id="node1031" class="node">
<title>moe_input_l8_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="309955" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="309955" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L8</text>
<text text-anchor="middle" x="309955" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="309955" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l8_dp2&#45;&gt;moe_input_l8_dp2 -->
<g id="edge1732" class="edge">
<title>allreduce_l8_dp2&#45;&gt;moe_input_l8_dp2</title>
<path fill="none" stroke="black" d="M309751.01,-135.98C309759.23,-135.98 309767.44,-135.98 309775.66,-135.98"/>
<polygon fill="black" stroke="black" points="309775.68,-139.48 309785.68,-135.98 309775.68,-132.48 309775.68,-139.48"/>
</g>
<!-- router_l8_dp2 -->
<g id="node1032" class="node">
<title>router_l8_dp2</title>
<polygon fill="lightyellow" stroke="black" points="310654.57,-176.98 310260.74,-176.98 310159.43,-94.98 310553.26,-94.98 310654.57,-176.98"/>
<text text-anchor="middle" x="310407" y="-144.48" font-family="Arial" font-size="10.00">Router L8</text>
<text text-anchor="middle" x="310407" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="310407" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l8_dp2&#45;&gt;router_l8_dp2 -->
<g id="edge1733" class="edge">
<title>moe_input_l8_dp2&#45;&gt;router_l8_dp2</title>
<path fill="none" stroke="black" d="M310124.06,-135.98C310149.34,-135.98 310174.63,-135.98 310199.92,-135.98"/>
<polygon fill="black" stroke="black" points="310199.99,-139.48 310209.99,-135.98 310199.99,-132.48 310199.99,-139.48"/>
</g>
<!-- expert0_l8_dp2 -->
<g id="node1033" class="node">
<title>expert0_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="314660.5,-161.98 314431.5,-161.98 314431.5,-109.98 314660.5,-109.98 314660.5,-161.98"/>
<text text-anchor="middle" x="314546" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L8</text>
<text text-anchor="middle" x="314546" y="-138.98" font-family="Arial" font-size="10.00">GPU 64</text>
<text text-anchor="middle" x="314546" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="314546" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert0_l8_dp2 -->
<g id="edge1734" class="edge">
<title>router_l8_dp2&#45;&gt;expert0_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.74,-171.32C310669.09,-173.59 310690.41,-175.53 310711,-176.98 311474.79,-230.71 313390.82,-196.54 314156.5,-198.98 314274.9,-199.36 314306.17,-201.54 314422,-176.98 314436.65,-173.88 314451.99,-169.65 314466.69,-165.08"/>
<polygon fill="black" stroke="black" points="314467.78,-168.4 314476.25,-162.03 314465.66,-161.73 314467.78,-168.4"/>
<text text-anchor="middle" x="314178" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l8_dp2 -->
<g id="node1034" class="node">
<title>expert1_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="314413.5,-161.98 314184.5,-161.98 314184.5,-109.98 314413.5,-109.98 314413.5,-161.98"/>
<text text-anchor="middle" x="314299" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L8</text>
<text text-anchor="middle" x="314299" y="-138.98" font-family="Arial" font-size="10.00">GPU 65</text>
<text text-anchor="middle" x="314299" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="314299" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert1_l8_dp2 -->
<g id="edge1735" class="edge">
<title>router_l8_dp2&#45;&gt;expert1_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.74,-171.31C310669.09,-173.58 310690.41,-175.53 310711,-176.98 311416.7,-226.81 313187.04,-196.54 313894.5,-198.98 314019.55,-199.41 314052.59,-202.54 314175,-176.98 314189.75,-173.9 314205.19,-169.66 314219.98,-165.07"/>
<polygon fill="black" stroke="black" points="314221.12,-168.37 314229.59,-162 314219,-161.7 314221.12,-168.37"/>
<text text-anchor="middle" x="313916" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l8_dp2 -->
<g id="node1035" class="node">
<title>expert2_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="314166.5,-161.98 313937.5,-161.98 313937.5,-109.98 314166.5,-109.98 314166.5,-161.98"/>
<text text-anchor="middle" x="314052" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L8</text>
<text text-anchor="middle" x="314052" y="-138.98" font-family="Arial" font-size="10.00">GPU 66</text>
<text text-anchor="middle" x="314052" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="314052" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert2_l8_dp2 -->
<g id="edge1736" class="edge">
<title>router_l8_dp2&#45;&gt;expert2_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.74,-171.29C310669.1,-173.57 310690.41,-175.52 310711,-176.98 311355.51,-222.7 312972.37,-196.54 313618.5,-198.98 313756.4,-199.5 313792.87,-204.49 313928,-176.98 313942.85,-173.96 313958.41,-169.72 313973.28,-165.1"/>
<polygon fill="black" stroke="black" points="313974.47,-168.39 313982.94,-162.02 313972.35,-161.72 313974.47,-168.39"/>
<text text-anchor="middle" x="313640" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l8_dp2 -->
<g id="node1036" class="node">
<title>expert3_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="313919.5,-161.98 313690.5,-161.98 313690.5,-109.98 313919.5,-109.98 313919.5,-161.98"/>
<text text-anchor="middle" x="313805" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L8</text>
<text text-anchor="middle" x="313805" y="-138.98" font-family="Arial" font-size="10.00">GPU 67</text>
<text text-anchor="middle" x="313805" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="313805" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert3_l8_dp2 -->
<g id="edge1737" class="edge">
<title>router_l8_dp2&#45;&gt;expert3_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.74,-171.27C310669.1,-173.55 310690.41,-175.51 310711,-176.98 311287.88,-218.16 312735.15,-196.54 313313.5,-198.98 313477.12,-199.67 313520.43,-208.45 313681,-176.98 313696.06,-174.03 313711.82,-169.78 313726.86,-165.11"/>
<polygon fill="black" stroke="black" points="313728.16,-168.37 313736.63,-162 313726.04,-161.7 313728.16,-168.37"/>
<text text-anchor="middle" x="313335" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l8_dp2 -->
<g id="node1037" class="node">
<title>expert4_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="313672.5,-161.98 313443.5,-161.98 313443.5,-109.98 313672.5,-109.98 313672.5,-161.98"/>
<text text-anchor="middle" x="313558" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L8</text>
<text text-anchor="middle" x="313558" y="-138.98" font-family="Arial" font-size="10.00">GPU 68</text>
<text text-anchor="middle" x="313558" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="313558" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert4_l8_dp2 -->
<g id="edge1738" class="edge">
<title>router_l8_dp2&#45;&gt;expert4_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.74,-171.24C310669.1,-173.53 310690.42,-175.5 310711,-176.98 311207.18,-212.74 312452.04,-196.54 312949.5,-198.98 313165.05,-200.04 313222.1,-216.54 313434,-176.98 313449.27,-174.13 313465.24,-169.87 313480.45,-165.16"/>
<polygon fill="black" stroke="black" points="313481.86,-168.39 313490.32,-162.01 313479.73,-161.72 313481.86,-168.39"/>
<text text-anchor="middle" x="312971" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l8_dp2 -->
<g id="node1038" class="node">
<title>expert5_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="313425.5,-161.98 313196.5,-161.98 313196.5,-109.98 313425.5,-109.98 313425.5,-161.98"/>
<text text-anchor="middle" x="313311" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L8</text>
<text text-anchor="middle" x="313311" y="-138.98" font-family="Arial" font-size="10.00">GPU 69</text>
<text text-anchor="middle" x="313311" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="313311" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert5_l8_dp2 -->
<g id="edge1739" class="edge">
<title>router_l8_dp2&#45;&gt;expert5_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310552.67,-176.99C310591.3,-186.08 310633.21,-194.39 310672.5,-198.98 310691.48,-201.2 310696.39,-199.07 310715.5,-198.98 310990.12,-197.76 312916.07,-221.85 313187,-176.98 313202.93,-174.34 313219.59,-170 313235.35,-165.11"/>
<polygon fill="black" stroke="black" points="313236.58,-168.39 313245.03,-162 313234.44,-161.72 313236.58,-168.39"/>
<text text-anchor="middle" x="310694" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l8_dp2 -->
<g id="node1039" class="node">
<title>expert6_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="313178.5,-161.98 312949.5,-161.98 312949.5,-109.98 313178.5,-109.98 313178.5,-161.98"/>
<text text-anchor="middle" x="313064" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L8</text>
<text text-anchor="middle" x="313064" y="-138.98" font-family="Arial" font-size="10.00">GPU 70</text>
<text text-anchor="middle" x="313064" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="313064" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert6_l8_dp2 -->
<g id="edge1740" class="edge">
<title>router_l8_dp2&#45;&gt;expert6_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.75,-171.18C310669.1,-173.48 310690.42,-175.47 310711,-176.98 311110.29,-206.3 312112.27,-209.27 312512.5,-198.98 312702.69,-194.09 312753.01,-212.05 312940,-176.98 312955.26,-174.12 312971.24,-169.85 312986.45,-165.14"/>
<polygon fill="black" stroke="black" points="312987.85,-168.37 312996.32,-161.99 312985.73,-161.7 312987.85,-168.37"/>
<text text-anchor="middle" x="312491" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l8_dp2 -->
<g id="node1040" class="node">
<title>expert7_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="312931.5,-161.98 312702.5,-161.98 312702.5,-109.98 312931.5,-109.98 312931.5,-161.98"/>
<text text-anchor="middle" x="312817" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L8</text>
<text text-anchor="middle" x="312817" y="-138.98" font-family="Arial" font-size="10.00">GPU 71</text>
<text text-anchor="middle" x="312817" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="312817" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert7_l8_dp2 -->
<g id="edge1741" class="edge">
<title>router_l8_dp2&#45;&gt;expert7_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310579.37,-177C310624.98,-186.1 310674.37,-194.39 310720.5,-198.98 310739.52,-200.87 310744.39,-199.09 310763.5,-198.98 310977.9,-197.76 312481.52,-212.28 312693,-176.98 312708.83,-174.34 312725.4,-170.02 312741.07,-165.16"/>
<polygon fill="black" stroke="black" points="312742.25,-168.46 312750.7,-162.07 312740.11,-161.79 312742.25,-168.46"/>
<text text-anchor="middle" x="310742" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l8_dp2 -->
<g id="node1041" class="node">
<title>expert8_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="312684.5,-161.98 312455.5,-161.98 312455.5,-109.98 312684.5,-109.98 312684.5,-161.98"/>
<text text-anchor="middle" x="312570" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L8</text>
<text text-anchor="middle" x="312570" y="-138.98" font-family="Arial" font-size="10.00">GPU 72</text>
<text text-anchor="middle" x="312570" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="312570" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert8_l8_dp2 -->
<g id="edge1742" class="edge">
<title>router_l8_dp2&#45;&gt;expert8_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310647.34,-171.04C310668.83,-173.37 310690.29,-175.42 310711,-176.98 311006.97,-199.38 311749.79,-207.15 312046.5,-198.98 312224.26,-194.09 312271.28,-210.07 312446,-176.98 312461.17,-174.11 312477.04,-169.87 312492.16,-165.18"/>
<polygon fill="black" stroke="black" points="312493.52,-168.42 312501.98,-162.05 312491.39,-161.75 312493.52,-168.42"/>
<text text-anchor="middle" x="312025" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l8_dp2 -->
<g id="node1042" class="node">
<title>expert9_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="312437.5,-161.98 312208.5,-161.98 312208.5,-109.98 312437.5,-109.98 312437.5,-161.98"/>
<text text-anchor="middle" x="312323" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L8</text>
<text text-anchor="middle" x="312323" y="-138.98" font-family="Arial" font-size="10.00">GPU 73</text>
<text text-anchor="middle" x="312323" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="312323" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert9_l8_dp2 -->
<g id="edge1743" class="edge">
<title>router_l8_dp2&#45;&gt;expert9_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310606.02,-177C310658.62,-186.1 310715.5,-194.4 310768.5,-198.98 310787.54,-200.63 310792.39,-199.13 310811.5,-198.98 311119.86,-196.54 311894.95,-228.42 312199,-176.98 312214.83,-174.3 312231.39,-169.97 312247.06,-165.1"/>
<polygon fill="black" stroke="black" points="312248.24,-168.4 312256.69,-162.01 312246.1,-161.74 312248.24,-168.4"/>
<text text-anchor="middle" x="310790" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l8_dp2 -->
<g id="node1043" class="node">
<title>expert10_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="312190.5,-161.98 311961.5,-161.98 311961.5,-109.98 312190.5,-109.98 312190.5,-161.98"/>
<text text-anchor="middle" x="312076" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L8</text>
<text text-anchor="middle" x="312076" y="-138.98" font-family="Arial" font-size="10.00">GPU 74</text>
<text text-anchor="middle" x="312076" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="312076" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert10_l8_dp2 -->
<g id="edge1744" class="edge">
<title>router_l8_dp2&#45;&gt;expert10_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310646.94,-170.8C310668.57,-173.19 310690.16,-175.31 310711,-176.98 311108.73,-208.83 311209.69,-211.74 311608.5,-198.98 311761.4,-194.09 311801.82,-206.12 311952,-176.98 311967.06,-174.06 311982.83,-169.82 311997.87,-165.16"/>
<polygon fill="black" stroke="black" points="311999.17,-168.42 312007.64,-162.04 311997.05,-161.75 311999.17,-168.42"/>
<text text-anchor="middle" x="311587" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l8_dp2 -->
<g id="node1044" class="node">
<title>expert11_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="311943.5,-161.98 311714.5,-161.98 311714.5,-109.98 311943.5,-109.98 311943.5,-161.98"/>
<text text-anchor="middle" x="311829" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L8</text>
<text text-anchor="middle" x="311829" y="-138.98" font-family="Arial" font-size="10.00">GPU 75</text>
<text text-anchor="middle" x="311829" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="311829" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert11_l8_dp2 -->
<g id="edge1745" class="edge">
<title>router_l8_dp2&#45;&gt;expert11_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310632.65,-177.01C310692.23,-186.11 310756.61,-194.4 310816.5,-198.98 311013.43,-214.04 311510.43,-210.92 311705,-176.98 311720.72,-174.24 311737.17,-169.91 311752.76,-165.06"/>
<polygon fill="black" stroke="black" points="311753.89,-168.38 311762.35,-161.99 311751.75,-161.71 311753.89,-168.38"/>
<text text-anchor="middle" x="310838" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l8_dp2 -->
<g id="node1045" class="node">
<title>expert12_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="311696.5,-161.98 311467.5,-161.98 311467.5,-109.98 311696.5,-109.98 311696.5,-161.98"/>
<text text-anchor="middle" x="311582" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L8</text>
<text text-anchor="middle" x="311582" y="-138.98" font-family="Arial" font-size="10.00">GPU 76</text>
<text text-anchor="middle" x="311582" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="311582" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert12_l8_dp2 -->
<g id="edge1746" class="edge">
<title>router_l8_dp2&#45;&gt;expert12_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310646.57,-170.29C310668.33,-172.8 310690.05,-175.09 310711,-176.98 310711,-176.98 311458,-176.98 311458,-176.98 311472.65,-173.9 311488,-169.69 311502.7,-165.12"/>
<polygon fill="black" stroke="black" points="311503.79,-168.45 311512.26,-162.08 311501.67,-161.78 311503.79,-168.45"/>
<text text-anchor="middle" x="311205" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l8_dp2 -->
<g id="node1046" class="node">
<title>expert13_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="311449.5,-161.98 311220.5,-161.98 311220.5,-109.98 311449.5,-109.98 311449.5,-161.98"/>
<text text-anchor="middle" x="311335" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L8</text>
<text text-anchor="middle" x="311335" y="-138.98" font-family="Arial" font-size="10.00">GPU 77</text>
<text text-anchor="middle" x="311335" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="311335" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert13_l8_dp2 -->
<g id="edge1747" class="edge">
<title>router_l8_dp2&#45;&gt;expert13_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310653.89,-176.28C310721.94,-185.66 310795.91,-194.28 310864.5,-198.98 310979.39,-206.86 311084.97,-201.98 311211,-176.98 311225.96,-174.01 311241.62,-169.78 311256.58,-165.14"/>
<polygon fill="black" stroke="black" points="311257.83,-168.41 311266.29,-162.04 311255.7,-161.74 311257.83,-168.41"/>
<text text-anchor="middle" x="310886" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l8_dp2 -->
<g id="node1047" class="node">
<title>expert14_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="311202.5,-161.98 310973.5,-161.98 310973.5,-109.98 311202.5,-109.98 311202.5,-161.98"/>
<text text-anchor="middle" x="311088" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L8</text>
<text text-anchor="middle" x="311088" y="-138.98" font-family="Arial" font-size="10.00">GPU 78</text>
<text text-anchor="middle" x="311088" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="311088" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert14_l8_dp2 -->
<g id="edge1748" class="edge">
<title>router_l8_dp2&#45;&gt;expert14_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310632.44,-176.99C310755.58,-196.39 310895.01,-212.63 310955.5,-198.98 310983.7,-192.62 311012.94,-179.52 311036.75,-166.9"/>
<polygon fill="black" stroke="black" points="311038.48,-169.94 311045.6,-162.1 311035.14,-163.79 311038.48,-169.94"/>
<text text-anchor="middle" x="310934" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l8_dp2 -->
<g id="node1048" class="node">
<title>expert15_l8_dp2</title>
<polygon fill="lightgreen" stroke="black" points="310949.5,-161.98 310720.5,-161.98 310720.5,-109.98 310949.5,-109.98 310949.5,-161.98"/>
<text text-anchor="middle" x="310835" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L8</text>
<text text-anchor="middle" x="310835" y="-138.98" font-family="Arial" font-size="10.00">GPU 79</text>
<text text-anchor="middle" x="310835" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="310835" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp2&#45;&gt;expert15_l8_dp2 -->
<g id="edge1749" class="edge">
<title>router_l8_dp2&#45;&gt;expert15_l8_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M310604.09,-135.98C310640.17,-135.98 310676.91,-135.98 310710.14,-135.98"/>
<polygon fill="black" stroke="black" points="310710.34,-139.48 310720.34,-135.98 310710.34,-132.48 310710.34,-139.48"/>
<text text-anchor="middle" x="310687.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l8_dp2 -->
<g id="node1049" class="node">
<title>expert_agg_l8_dp2</title>
<polygon fill="lightyellow" stroke="black" points="315191.57,-176.98 314797.74,-176.98 314696.43,-94.98 315090.26,-94.98 315191.57,-176.98"/>
<text text-anchor="middle" x="314944" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="314944" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="314944" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1750" class="edge">
<title>expert0_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M314660.66,-135.98C314686.06,-135.98 314711.47,-135.98 314736.87,-135.98"/>
<polygon fill="black" stroke="black" points="314736.99,-139.48 314746.99,-135.98 314736.99,-132.48 314736.99,-139.48"/>
</g>
<!-- expert1_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1751" class="edge">
<title>expert1_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M314354.24,-162.02C314377.4,-171.57 314404.96,-181.22 314431,-185.98 314481.06,-195.15 314609.3,-190.41 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert2_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1752" class="edge">
<title>expert2_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M314107.24,-162.02C314130.4,-171.57 314157.96,-181.22 314184,-185.98 314236.02,-195.51 314607.31,-190.59 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert3_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1753" class="edge">
<title>expert3_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M313860.24,-162.02C313883.4,-171.57 313910.96,-181.22 313937,-185.98 314016.02,-200.45 314579.97,-192.97 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert4_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1754" class="edge">
<title>expert4_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M313613.24,-162.02C313636.4,-171.57 313663.96,-181.22 313690,-185.98 313743.01,-195.69 314606.31,-190.67 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert5_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1755" class="edge">
<title>expert5_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M313366.24,-162.02C313389.4,-171.57 313416.96,-181.22 313443,-185.98 313509.5,-198.16 314592.64,-191.87 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert6_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1756" class="edge">
<title>expert6_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M313119.24,-162.02C313142.4,-171.57 313169.96,-181.22 313196,-185.98 313276,-200.63 314578.97,-193.06 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert7_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1757" class="edge">
<title>expert7_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M312872.24,-162.02C312895.4,-171.57 312922.96,-181.22 312949,-185.98 312995.75,-194.54 314612.65,-190.12 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert8_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1758" class="edge">
<title>expert8_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M312625.24,-162.02C312648.4,-171.57 312675.96,-181.22 312702,-185.98 312755.5,-195.78 314605.82,-190.72 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert9_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1759" class="edge">
<title>expert9_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M312378.24,-162.02C312401.4,-171.57 312428.96,-181.22 312455,-185.98 312515.25,-197.01 314598.98,-191.31 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert10_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1760" class="edge">
<title>expert10_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M312131.24,-162.02C312154.4,-171.57 312181.96,-181.22 312208,-185.98 312275,-198.25 314592.15,-191.91 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert11_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1761" class="edge">
<title>expert11_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M311884.24,-162.02C311907.4,-171.57 311934.96,-181.22 311961,-185.98 312034.75,-199.48 314585.31,-192.51 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert12_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1762" class="edge">
<title>expert12_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M311637.24,-162.02C311660.4,-171.57 311687.96,-181.22 311714,-185.98 311794.49,-200.72 314578.48,-193.1 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert13_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1763" class="edge">
<title>expert13_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M311390.24,-162.02C311413.4,-171.57 311440.96,-181.22 311467,-185.98 311510.62,-193.97 314615.82,-189.84 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert14_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1764" class="edge">
<title>expert14_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M311143.24,-162.02C311166.4,-171.57 311193.96,-181.22 311220,-185.98 311267,-194.59 314612.4,-190.14 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- expert15_l8_dp2&#45;&gt;expert_agg_l8_dp2 -->
<g id="edge1765" class="edge">
<title>expert15_l8_dp2&#45;&gt;expert_agg_l8_dp2</title>
<path fill="none" stroke="black" d="M310892.86,-162.02C310917.1,-171.58 310945.89,-181.22 310973,-185.98 311023.44,-194.84 314608.98,-190.44 314660,-185.98 314698.11,-182.65 314738.78,-176.86 314777.08,-170.36"/>
<polygon fill="black" stroke="black" points="314778.02,-173.75 314787.29,-168.6 314776.84,-166.85 314778.02,-173.75"/>
</g>
<!-- layer8_output_dp2 -->
<g id="node1050" class="node">
<title>layer8_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="315396" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="315396" y="-144.48" font-family="Arial" font-size="10.00">Layer 8 Output</text>
<text text-anchor="middle" x="315396" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="315396" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l8_dp2&#45;&gt;layer8_output_dp2 -->
<g id="edge1766" class="edge">
<title>expert_agg_l8_dp2&#45;&gt;layer8_output_dp2</title>
<path fill="none" stroke="black" d="M315141.31,-135.98C315166.49,-135.98 315191.66,-135.98 315216.84,-135.98"/>
<polygon fill="black" stroke="black" points="315216.87,-139.48 315226.87,-135.98 315216.87,-132.48 315216.87,-139.48"/>
</g>
<!-- stage1_output_dp2 -->
<g id="node1051" class="node">
<title>stage1_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="315769" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="315769" y="-144.48" font-family="Arial" font-size="10.00">Stage 1 Output</text>
<text text-anchor="middle" x="315769" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="315769" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer8_output_dp2&#45;&gt;stage1_output_dp2 -->
<g id="edge1767" class="edge">
<title>layer8_output_dp2&#45;&gt;stage1_output_dp2</title>
<path fill="none" stroke="black" d="M315565.01,-135.98C315573.23,-135.98 315581.44,-135.98 315589.66,-135.98"/>
<polygon fill="black" stroke="black" points="315589.68,-139.48 315599.68,-135.98 315589.68,-132.48 315589.68,-139.48"/>
</g>
<!-- stage2_input_dp2 -->
<g id="node1052" class="node">
<title>stage2_input_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="316142" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="316142" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Input</text>
<text text-anchor="middle" x="316142" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="316142" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_output_dp2&#45;&gt;stage2_input_dp2 -->
<g id="edge1768" class="edge">
<title>stage1_output_dp2&#45;&gt;stage2_input_dp2</title>
<path fill="none" stroke="black" d="M315938.01,-135.98C315946.23,-135.98 315954.44,-135.98 315962.66,-135.98"/>
<polygon fill="black" stroke="black" points="315962.68,-139.48 315972.68,-135.98 315962.68,-132.48 315962.68,-139.48"/>
</g>
<!-- attn_input_l9_dp2 -->
<g id="node1053" class="node">
<title>attn_input_l9_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="316515" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="316515" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L9</text>
<text text-anchor="middle" x="316515" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="316515" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage2_input_dp2&#45;&gt;attn_input_l9_dp2 -->
<g id="edge1769" class="edge">
<title>stage2_input_dp2&#45;&gt;attn_input_l9_dp2</title>
<path fill="none" stroke="black" d="M316311.01,-135.98C316319.23,-135.98 316327.44,-135.98 316335.66,-135.98"/>
<polygon fill="black" stroke="black" points="316335.68,-139.48 316345.68,-135.98 316335.68,-132.48 316335.68,-139.48"/>
</g>
<!-- attn_tp0_l9_dp2 -->
<g id="node1054" class="node">
<title>attn_tp0_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="317813,-161.98 317553,-161.98 317553,-109.98 317813,-109.98 317813,-161.98"/>
<text text-anchor="middle" x="317683" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L9</text>
<text text-anchor="middle" x="317683" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="317683" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="317683" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp2&#45;&gt;attn_tp0_l9_dp2 -->
<g id="edge1770" class="edge">
<title>attn_input_l9_dp2&#45;&gt;attn_tp0_l9_dp2</title>
<path fill="none" stroke="black" d="M316598.52,-161.26C316635.12,-171.09 316678.81,-181.13 316719,-185.98 316764,-191.42 317490.27,-193.33 317535,-185.98 317560.4,-181.81 317587.31,-173.85 317611.12,-165.5"/>
<polygon fill="black" stroke="black" points="317612.55,-168.71 317620.78,-162.03 317610.18,-162.12 317612.55,-168.71"/>
</g>
<!-- attn_tp1_l9_dp2 -->
<g id="node1055" class="node">
<title>attn_tp1_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="317535,-161.98 317275,-161.98 317275,-109.98 317535,-109.98 317535,-161.98"/>
<text text-anchor="middle" x="317405" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L9</text>
<text text-anchor="middle" x="317405" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="317405" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="317405" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp2&#45;&gt;attn_tp1_l9_dp2 -->
<g id="edge1771" class="edge">
<title>attn_input_l9_dp2&#45;&gt;attn_tp1_l9_dp2</title>
<path fill="none" stroke="black" d="M316598.52,-161.26C316635.12,-171.09 316678.81,-181.13 316719,-185.98 316778.35,-193.15 317198.01,-195.68 317257,-185.98 317282.4,-181.81 317309.31,-173.85 317333.12,-165.5"/>
<polygon fill="black" stroke="black" points="317334.55,-168.71 317342.78,-162.03 317332.18,-162.12 317334.55,-168.71"/>
</g>
<!-- attn_tp2_l9_dp2 -->
<g id="node1056" class="node">
<title>attn_tp2_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="317257,-161.98 316997,-161.98 316997,-109.98 317257,-109.98 317257,-161.98"/>
<text text-anchor="middle" x="317127" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L9</text>
<text text-anchor="middle" x="317127" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="317127" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="317127" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp2&#45;&gt;attn_tp2_l9_dp2 -->
<g id="edge1772" class="edge">
<title>attn_input_l9_dp2&#45;&gt;attn_tp2_l9_dp2</title>
<path fill="none" stroke="black" d="M316598.52,-161.26C316635.12,-171.09 316678.81,-181.13 316719,-185.98 316776.36,-192.91 316921.99,-195.35 316979,-185.98 317004.4,-181.81 317031.31,-173.85 317055.12,-165.5"/>
<polygon fill="black" stroke="black" points="317056.55,-168.71 317064.78,-162.03 317054.18,-162.12 317056.55,-168.71"/>
</g>
<!-- attn_tp3_l9_dp2 -->
<g id="node1057" class="node">
<title>attn_tp3_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="316979,-161.98 316719,-161.98 316719,-109.98 316979,-109.98 316979,-161.98"/>
<text text-anchor="middle" x="316849" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L9</text>
<text text-anchor="middle" x="316849" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="316849" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="316849" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp2&#45;&gt;attn_tp3_l9_dp2 -->
<g id="edge1773" class="edge">
<title>attn_input_l9_dp2&#45;&gt;attn_tp3_l9_dp2</title>
<path fill="none" stroke="black" d="M316684.28,-135.98C316692.35,-135.98 316700.42,-135.98 316708.49,-135.98"/>
<polygon fill="black" stroke="black" points="316708.7,-139.48 316718.7,-135.98 316708.7,-132.48 316708.7,-139.48"/>
</g>
<!-- allreduce_l9_dp2 -->
<g id="node1058" class="node">
<title>allreduce_l9_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="318017" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="318017" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L9</text>
<text text-anchor="middle" x="318017" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="318017" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l9_dp2&#45;&gt;allreduce_l9_dp2 -->
<g id="edge1774" class="edge">
<title>attn_tp0_l9_dp2&#45;&gt;allreduce_l9_dp2</title>
<path fill="none" stroke="black" d="M317813.14,-135.98C317821.35,-135.98 317829.56,-135.98 317837.77,-135.98"/>
<polygon fill="black" stroke="black" points="317837.78,-139.48 317847.78,-135.98 317837.78,-132.48 317837.78,-139.48"/>
</g>
<!-- attn_tp1_l9_dp2&#45;&gt;allreduce_l9_dp2 -->
<g id="edge1775" class="edge">
<title>attn_tp1_l9_dp2&#45;&gt;allreduce_l9_dp2</title>
<path fill="none" stroke="black" d="M317467.22,-162.03C317493.24,-171.59 317524.1,-181.23 317553,-185.98 317610.01,-195.35 317755.64,-192.91 317813,-185.98 317849.57,-181.57 317889.05,-172.85 317923.44,-163.91"/>
<polygon fill="black" stroke="black" points="317924.7,-167.2 317933.47,-161.26 317922.91,-160.43 317924.7,-167.2"/>
</g>
<!-- attn_tp2_l9_dp2&#45;&gt;allreduce_l9_dp2 -->
<g id="edge1776" class="edge">
<title>attn_tp2_l9_dp2&#45;&gt;allreduce_l9_dp2</title>
<path fill="none" stroke="black" d="M317189.22,-162.03C317215.24,-171.59 317246.1,-181.23 317275,-185.98 317333.98,-195.68 317753.65,-193.15 317813,-185.98 317849.57,-181.57 317889.05,-172.85 317923.44,-163.91"/>
<polygon fill="black" stroke="black" points="317924.7,-167.2 317933.47,-161.26 317922.91,-160.43 317924.7,-167.2"/>
</g>
<!-- attn_tp3_l9_dp2&#45;&gt;allreduce_l9_dp2 -->
<g id="edge1777" class="edge">
<title>attn_tp3_l9_dp2&#45;&gt;allreduce_l9_dp2</title>
<path fill="none" stroke="black" d="M316911.22,-162.03C316937.24,-171.59 316968.1,-181.23 316997,-185.98 317041.73,-193.33 317767.99,-191.42 317813,-185.98 317849.57,-181.57 317889.05,-172.85 317923.44,-163.91"/>
<polygon fill="black" stroke="black" points="317924.7,-167.2 317933.47,-161.26 317922.91,-160.43 317924.7,-167.2"/>
</g>
<!-- moe_input_l9_dp2 -->
<g id="node1059" class="node">
<title>moe_input_l9_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="318390" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="318390" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L9</text>
<text text-anchor="middle" x="318390" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="318390" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l9_dp2&#45;&gt;moe_input_l9_dp2 -->
<g id="edge1778" class="edge">
<title>allreduce_l9_dp2&#45;&gt;moe_input_l9_dp2</title>
<path fill="none" stroke="black" d="M318186.01,-135.98C318194.23,-135.98 318202.44,-135.98 318210.66,-135.98"/>
<polygon fill="black" stroke="black" points="318210.68,-139.48 318220.68,-135.98 318210.68,-132.48 318210.68,-139.48"/>
</g>
<!-- router_l9_dp2 -->
<g id="node1060" class="node">
<title>router_l9_dp2</title>
<polygon fill="lightyellow" stroke="black" points="319089.57,-176.98 318695.74,-176.98 318594.43,-94.98 318988.26,-94.98 319089.57,-176.98"/>
<text text-anchor="middle" x="318842" y="-144.48" font-family="Arial" font-size="10.00">Router L9</text>
<text text-anchor="middle" x="318842" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="318842" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l9_dp2&#45;&gt;router_l9_dp2 -->
<g id="edge1779" class="edge">
<title>moe_input_l9_dp2&#45;&gt;router_l9_dp2</title>
<path fill="none" stroke="black" d="M318559.06,-135.98C318584.34,-135.98 318609.63,-135.98 318634.92,-135.98"/>
<polygon fill="black" stroke="black" points="318634.99,-139.48 318644.99,-135.98 318634.99,-132.48 318634.99,-139.48"/>
</g>
<!-- expert0_l9_dp2 -->
<g id="node1061" class="node">
<title>expert0_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="323084.5,-161.98 322855.5,-161.98 322855.5,-109.98 323084.5,-109.98 323084.5,-161.98"/>
<text text-anchor="middle" x="322970" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L9</text>
<text text-anchor="middle" x="322970" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="322970" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="322970" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert0_l9_dp2 -->
<g id="edge1780" class="edge">
<title>router_l9_dp2&#45;&gt;expert0_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.24,-171.8C319102.75,-173.86 319122.18,-175.64 319141,-176.98 319902.74,-231.42 321813.82,-196.54 322577.5,-198.98 322697.23,-199.37 322728.85,-201.74 322846,-176.98 322860.65,-173.89 322875.99,-169.66 322890.69,-165.09"/>
<polygon fill="black" stroke="black" points="322891.78,-168.42 322900.25,-162.05 322889.66,-161.75 322891.78,-168.42"/>
<text text-anchor="middle" x="322599" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l9_dp2 -->
<g id="node1062" class="node">
<title>expert1_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="322837.5,-161.98 322608.5,-161.98 322608.5,-109.98 322837.5,-109.98 322837.5,-161.98"/>
<text text-anchor="middle" x="322723" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L9</text>
<text text-anchor="middle" x="322723" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="322723" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="322723" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert1_l9_dp2 -->
<g id="edge1781" class="edge">
<title>router_l9_dp2&#45;&gt;expert1_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.24,-171.79C319102.75,-173.85 319122.18,-175.63 319141,-176.98 319843.99,-227.41 321607.71,-196.54 322312.5,-198.98 322440.21,-199.43 322473.96,-202.94 322599,-176.98 322613.75,-173.92 322629.2,-169.69 322643.99,-165.09"/>
<polygon fill="black" stroke="black" points="322645.13,-168.4 322653.59,-162.03 322643,-161.73 322645.13,-168.4"/>
<text text-anchor="middle" x="322334" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l9_dp2 -->
<g id="node1063" class="node">
<title>expert2_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="322590.5,-161.98 322361.5,-161.98 322361.5,-109.98 322590.5,-109.98 322590.5,-161.98"/>
<text text-anchor="middle" x="322476" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L9</text>
<text text-anchor="middle" x="322476" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="322476" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="322476" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert2_l9_dp2 -->
<g id="edge1782" class="edge">
<title>router_l9_dp2&#45;&gt;expert2_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.24,-171.77C319102.75,-173.84 319122.18,-175.63 319141,-176.98 319781.47,-223.14 321388.37,-196.54 322030.5,-198.98 322173.72,-199.53 322211.6,-205.31 322352,-176.98 322366.86,-173.98 322382.41,-169.76 322397.29,-165.14"/>
<polygon fill="black" stroke="black" points="322398.48,-168.44 322406.95,-162.07 322396.36,-161.77 322398.48,-168.44"/>
<text text-anchor="middle" x="322052" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l9_dp2 -->
<g id="node1064" class="node">
<title>expert3_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="322343.5,-161.98 322114.5,-161.98 322114.5,-109.98 322343.5,-109.98 322343.5,-161.98"/>
<text text-anchor="middle" x="322229" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L9</text>
<text text-anchor="middle" x="322229" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="322229" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="322229" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert3_l9_dp2 -->
<g id="edge1783" class="edge">
<title>router_l9_dp2&#45;&gt;expert3_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.24,-171.75C319102.75,-173.83 319122.19,-175.62 319141,-176.98 319711.19,-218.34 321141.82,-196.54 321713.5,-198.98 321887.77,-199.73 321933.9,-210.1 322105,-176.98 322120.06,-174.07 322135.83,-169.83 322150.87,-165.17"/>
<polygon fill="black" stroke="black" points="322152.17,-168.43 322160.64,-162.05 322150.05,-161.76 322152.17,-168.43"/>
<text text-anchor="middle" x="321735" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l9_dp2 -->
<g id="node1065" class="node">
<title>expert4_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="322096.5,-161.98 321867.5,-161.98 321867.5,-109.98 322096.5,-109.98 322096.5,-161.98"/>
<text text-anchor="middle" x="321982" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L9</text>
<text text-anchor="middle" x="321982" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="321982" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="321982" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert4_l9_dp2 -->
<g id="edge1784" class="edge">
<title>router_l9_dp2&#45;&gt;expert4_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319011.03,-177C319055.77,-186.09 319104.23,-194.39 319149.5,-198.98 319168.51,-200.91 319173.39,-199.06 319192.5,-198.98 319488.67,-197.76 321565.79,-225.28 321858,-176.98 321873.93,-174.35 321890.59,-170.01 321906.35,-165.11"/>
<polygon fill="black" stroke="black" points="321907.58,-168.39 321916.03,-162 321905.44,-161.73 321907.58,-168.39"/>
<text text-anchor="middle" x="319171" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l9_dp2 -->
<g id="node1066" class="node">
<title>expert5_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="321849.5,-161.98 321620.5,-161.98 321620.5,-109.98 321849.5,-109.98 321849.5,-161.98"/>
<text text-anchor="middle" x="321735" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L9</text>
<text text-anchor="middle" x="321735" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="321735" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="321735" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert5_l9_dp2 -->
<g id="edge1785" class="edge">
<title>router_l9_dp2&#45;&gt;expert5_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.24,-171.72C319102.75,-173.8 319122.19,-175.6 319141,-176.98 319625.39,-212.49 320840.81,-196.54 321326.5,-198.98 321453.32,-199.62 321486.83,-202.81 321611,-176.98 321625.75,-173.91 321641.2,-169.68 321655.98,-165.08"/>
<polygon fill="black" stroke="black" points="321657.13,-168.39 321665.59,-162.02 321655,-161.72 321657.13,-168.39"/>
<text text-anchor="middle" x="321348" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l9_dp2 -->
<g id="node1067" class="node">
<title>expert6_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="321602.5,-161.98 321373.5,-161.98 321373.5,-109.98 321602.5,-109.98 321602.5,-161.98"/>
<text text-anchor="middle" x="321488" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L9</text>
<text text-anchor="middle" x="321488" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="321488" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="321488" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert6_l9_dp2 -->
<g id="edge1786" class="edge">
<title>router_l9_dp2&#45;&gt;expert6_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.25,-171.69C319102.75,-173.78 319122.19,-175.59 319141,-176.98 319563.32,-208.25 320623.03,-196.54 321046.5,-198.98 321187.95,-199.8 321225.36,-205.04 321364,-176.98 321378.86,-173.98 321394.41,-169.74 321409.28,-165.13"/>
<polygon fill="black" stroke="black" points="321410.48,-168.42 321418.95,-162.05 321408.36,-161.75 321410.48,-168.42"/>
<text text-anchor="middle" x="321068" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l9_dp2 -->
<g id="node1068" class="node">
<title>expert7_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="321355.5,-161.98 321126.5,-161.98 321126.5,-109.98 321355.5,-109.98 321355.5,-161.98"/>
<text text-anchor="middle" x="321241" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L9</text>
<text text-anchor="middle" x="321241" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="321241" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="321241" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert7_l9_dp2 -->
<g id="edge1787" class="edge">
<title>router_l9_dp2&#45;&gt;expert7_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319083.25,-171.65C319102.76,-173.74 319122.19,-175.57 319141,-176.98 319846.85,-230.05 320025.67,-194.09 320733.5,-198.98 320904.22,-200.16 320949.41,-209.55 321117,-176.98 321132.06,-174.06 321147.83,-169.81 321162.87,-165.15"/>
<polygon fill="black" stroke="black" points="321164.17,-168.41 321172.64,-162.04 321162.04,-161.74 321164.17,-168.41"/>
<text text-anchor="middle" x="320755" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l9_dp2 -->
<g id="node1069" class="node">
<title>expert8_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="321108.5,-161.98 320879.5,-161.98 320879.5,-109.98 321108.5,-109.98 321108.5,-161.98"/>
<text text-anchor="middle" x="320994" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L9</text>
<text text-anchor="middle" x="320994" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="320994" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="320994" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert8_l9_dp2 -->
<g id="edge1788" class="edge">
<title>router_l9_dp2&#45;&gt;expert8_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319049.34,-177.01C319104.12,-186.11 319163.35,-194.4 319218.5,-198.98 319237.54,-200.57 319242.39,-199.11 319261.5,-198.98 319618.97,-196.54 320517.46,-236.23 320870,-176.98 320885.83,-174.32 320902.39,-170 320918.07,-165.13"/>
<polygon fill="black" stroke="black" points="320919.24,-168.43 320927.7,-162.04 320917.1,-161.76 320919.24,-168.43"/>
<text text-anchor="middle" x="319240" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l9_dp2 -->
<g id="node1070" class="node">
<title>expert9_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="320861.5,-161.98 320632.5,-161.98 320632.5,-109.98 320861.5,-109.98 320861.5,-161.98"/>
<text text-anchor="middle" x="320747" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L9</text>
<text text-anchor="middle" x="320747" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="320747" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="320747" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert9_l9_dp2 -->
<g id="edge1789" class="edge">
<title>router_l9_dp2&#45;&gt;expert9_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319082.85,-171.51C319102.49,-173.65 319122.06,-175.52 319141,-176.98 319678.37,-218.55 319814.54,-194.09 320353.5,-198.98 320473.67,-200.07 320505.41,-201.81 320623,-176.98 320637.65,-173.89 320652.99,-169.66 320667.69,-165.1"/>
<polygon fill="black" stroke="black" points="320668.78,-168.42 320677.25,-162.05 320666.66,-161.75 320668.78,-168.42"/>
<text text-anchor="middle" x="320375" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l9_dp2 -->
<g id="node1071" class="node">
<title>expert10_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="320614.5,-161.98 320385.5,-161.98 320385.5,-109.98 320614.5,-109.98 320614.5,-161.98"/>
<text text-anchor="middle" x="320500" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L9</text>
<text text-anchor="middle" x="320500" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="320500" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="320500" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert10_l9_dp2 -->
<g id="edge1790" class="edge">
<title>router_l9_dp2&#45;&gt;expert10_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319082.86,-171.4C319102.5,-173.56 319122.07,-175.47 319141,-176.98 319579.49,-212.03 319691.05,-218.63 320130.5,-198.98 320239.94,-194.09 320268.73,-199.21 320376,-176.98 320390.75,-173.93 320406.2,-169.69 320420.99,-165.1"/>
<polygon fill="black" stroke="black" points="320422.13,-168.41 320430.6,-162.04 320420.01,-161.74 320422.13,-168.41"/>
<text text-anchor="middle" x="320109" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l9_dp2 -->
<g id="node1072" class="node">
<title>expert11_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="320367.5,-161.98 320138.5,-161.98 320138.5,-109.98 320367.5,-109.98 320367.5,-161.98"/>
<text text-anchor="middle" x="320253" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L9</text>
<text text-anchor="middle" x="320253" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="320253" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="320253" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert11_l9_dp2 -->
<g id="edge1791" class="edge">
<title>router_l9_dp2&#45;&gt;expert11_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319082.47,-171.15C319102.24,-173.37 319121.94,-175.36 319141,-176.98 319453.14,-203.5 319532.47,-211.11 319845.5,-198.98 319971.78,-194.09 320005.1,-201.89 320129,-176.98 320143.86,-174 320159.42,-169.77 320174.29,-165.16"/>
<polygon fill="black" stroke="black" points="320175.49,-168.45 320183.95,-162.09 320173.36,-161.78 320175.49,-168.45"/>
<text text-anchor="middle" x="319824" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l9_dp2 -->
<g id="node1073" class="node">
<title>expert12_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="320120.5,-161.98 319891.5,-161.98 319891.5,-109.98 320120.5,-109.98 320120.5,-161.98"/>
<text text-anchor="middle" x="320006" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L9</text>
<text text-anchor="middle" x="320006" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="320006" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="320006" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert12_l9_dp2 -->
<g id="edge1792" class="edge">
<title>router_l9_dp2&#45;&gt;expert12_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319082.06,-177.01C319145.42,-186.11 319213.87,-194.4 319277.5,-198.98 319411.57,-208.63 319749.73,-200.95 319882,-176.98 319897.37,-174.2 319913.45,-169.94 319928.75,-165.21"/>
<polygon fill="black" stroke="black" points="319930.21,-168.41 319938.67,-162.04 319928.08,-161.75 319930.21,-168.41"/>
<text text-anchor="middle" x="319299" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l9_dp2 -->
<g id="node1074" class="node">
<title>expert13_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="319873.5,-161.98 319644.5,-161.98 319644.5,-109.98 319873.5,-109.98 319873.5,-161.98"/>
<text text-anchor="middle" x="319759" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L9</text>
<text text-anchor="middle" x="319759" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="319759" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="319759" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert13_l9_dp2 -->
<g id="edge1793" class="edge">
<title>router_l9_dp2&#45;&gt;expert13_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319058.82,-177.03C319192.76,-197.17 319368.14,-214.16 319523.5,-198.98 319575.5,-193.9 319632.1,-179.07 319676.79,-165.08"/>
<polygon fill="black" stroke="black" points="319677.95,-168.38 319686.42,-162.01 319675.83,-161.71 319677.95,-168.38"/>
<text text-anchor="middle" x="319502" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l9_dp2 -->
<g id="node1075" class="node">
<title>expert14_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="319626.5,-161.98 319397.5,-161.98 319397.5,-109.98 319626.5,-109.98 319626.5,-161.98"/>
<text text-anchor="middle" x="319512" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L9</text>
<text text-anchor="middle" x="319512" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="319512" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="319512" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert14_l9_dp2 -->
<g id="edge1794" class="edge">
<title>router_l9_dp2&#45;&gt;expert14_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319064.51,-176.99C319182.76,-195.86 319315.44,-211.57 319373.5,-198.98 319402.93,-192.6 319433.61,-179.41 319458.6,-166.74"/>
<polygon fill="black" stroke="black" points="319460.26,-169.82 319467.53,-162.11 319457.04,-163.61 319460.26,-169.82"/>
<text text-anchor="middle" x="319352" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l9_dp2 -->
<g id="node1076" class="node">
<title>expert15_l9_dp2</title>
<polygon fill="lightgreen" stroke="black" points="319379.5,-161.98 319150.5,-161.98 319150.5,-109.98 319379.5,-109.98 319379.5,-161.98"/>
<text text-anchor="middle" x="319265" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L9</text>
<text text-anchor="middle" x="319265" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="319265" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="319265" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp2&#45;&gt;expert15_l9_dp2 -->
<g id="edge1795" class="edge">
<title>router_l9_dp2&#45;&gt;expert15_l9_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M319038.95,-135.98C319073.38,-135.98 319108.32,-135.98 319140.11,-135.98"/>
<polygon fill="black" stroke="black" points="319140.32,-139.48 319150.32,-135.98 319140.32,-132.48 319140.32,-139.48"/>
<text text-anchor="middle" x="319120.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l9_dp2 -->
<g id="node1077" class="node">
<title>expert_agg_l9_dp2</title>
<polygon fill="lightyellow" stroke="black" points="323615.57,-176.98 323221.74,-176.98 323120.43,-94.98 323514.26,-94.98 323615.57,-176.98"/>
<text text-anchor="middle" x="323368" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L9</text>
<text text-anchor="middle" x="323368" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="323368" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1796" class="edge">
<title>expert0_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M323084.66,-135.98C323110.06,-135.98 323135.47,-135.98 323160.87,-135.98"/>
<polygon fill="black" stroke="black" points="323160.99,-139.48 323170.99,-135.98 323160.99,-132.48 323160.99,-139.48"/>
</g>
<!-- expert1_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1797" class="edge">
<title>expert1_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M322778.24,-162.02C322801.4,-171.57 322828.96,-181.22 322855,-185.98 322905.06,-195.15 323033.3,-190.41 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert2_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1798" class="edge">
<title>expert2_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M322531.24,-162.02C322554.4,-171.57 322581.96,-181.22 322608,-185.98 322660.02,-195.51 323031.31,-190.59 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert3_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1799" class="edge">
<title>expert3_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M322284.24,-162.02C322307.4,-171.57 322334.96,-181.22 322361,-185.98 322440.02,-200.45 323003.97,-192.97 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert4_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1800" class="edge">
<title>expert4_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M322037.24,-162.02C322060.4,-171.57 322087.96,-181.22 322114,-185.98 322167.01,-195.69 323030.31,-190.67 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert5_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1801" class="edge">
<title>expert5_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M321790.24,-162.02C321813.4,-171.57 321840.96,-181.22 321867,-185.98 321933.5,-198.16 323016.64,-191.87 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert6_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1802" class="edge">
<title>expert6_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M321543.24,-162.02C321566.4,-171.57 321593.96,-181.22 321620,-185.98 321700,-200.63 323002.97,-193.06 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert7_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1803" class="edge">
<title>expert7_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M321296.24,-162.02C321319.4,-171.57 321346.96,-181.22 321373,-185.98 321419.75,-194.54 323036.65,-190.12 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert8_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1804" class="edge">
<title>expert8_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M321049.24,-162.02C321072.4,-171.57 321099.96,-181.22 321126,-185.98 321179.5,-195.78 323029.82,-190.72 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert9_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1805" class="edge">
<title>expert9_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M320802.24,-162.02C320825.4,-171.57 320852.96,-181.22 320879,-185.98 320939.25,-197.01 323022.98,-191.31 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert10_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1806" class="edge">
<title>expert10_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M320555.24,-162.02C320578.4,-171.57 320605.96,-181.22 320632,-185.98 320699,-198.25 323016.15,-191.91 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert11_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1807" class="edge">
<title>expert11_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M320308.24,-162.02C320331.4,-171.57 320358.96,-181.22 320385,-185.98 320458.75,-199.48 323009.31,-192.51 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert12_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1808" class="edge">
<title>expert12_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M320061.24,-162.02C320084.4,-171.57 320111.96,-181.22 320138,-185.98 320218.49,-200.72 323002.48,-193.1 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert13_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1809" class="edge">
<title>expert13_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M319814.24,-162.02C319837.4,-171.57 319864.96,-181.22 319891,-185.98 319934.62,-193.97 323039.82,-189.84 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert14_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1810" class="edge">
<title>expert14_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M319567.24,-162.02C319590.4,-171.57 319617.96,-181.22 319644,-185.98 319691,-194.59 323036.4,-190.14 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- expert15_l9_dp2&#45;&gt;expert_agg_l9_dp2 -->
<g id="edge1811" class="edge">
<title>expert15_l9_dp2&#45;&gt;expert_agg_l9_dp2</title>
<path fill="none" stroke="black" d="M319320.24,-162.02C319343.4,-171.57 319370.96,-181.22 319397,-185.98 319447.37,-195.2 323032.98,-190.44 323084,-185.98 323122.11,-182.65 323162.78,-176.86 323201.08,-170.36"/>
<polygon fill="black" stroke="black" points="323202.02,-173.75 323211.29,-168.6 323200.84,-166.85 323202.02,-173.75"/>
</g>
<!-- layer9_output_dp2 -->
<g id="node1078" class="node">
<title>layer9_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="323820" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="323820" y="-144.48" font-family="Arial" font-size="10.00">Layer 9 Output</text>
<text text-anchor="middle" x="323820" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="323820" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l9_dp2&#45;&gt;layer9_output_dp2 -->
<g id="edge1812" class="edge">
<title>expert_agg_l9_dp2&#45;&gt;layer9_output_dp2</title>
<path fill="none" stroke="black" d="M323565.31,-135.98C323590.49,-135.98 323615.66,-135.98 323640.84,-135.98"/>
<polygon fill="black" stroke="black" points="323640.87,-139.48 323650.87,-135.98 323640.87,-132.48 323640.87,-139.48"/>
</g>
<!-- attn_input_l10_dp2 -->
<g id="node1079" class="node">
<title>attn_input_l10_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="324193" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="324193" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L10</text>
<text text-anchor="middle" x="324193" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="324193" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer9_output_dp2&#45;&gt;attn_input_l10_dp2 -->
<g id="edge1813" class="edge">
<title>layer9_output_dp2&#45;&gt;attn_input_l10_dp2</title>
<path fill="none" stroke="black" d="M323989.01,-135.98C323997.23,-135.98 324005.44,-135.98 324013.66,-135.98"/>
<polygon fill="black" stroke="black" points="324013.68,-139.48 324023.68,-135.98 324013.68,-132.48 324013.68,-139.48"/>
</g>
<!-- attn_tp0_l10_dp2 -->
<g id="node1080" class="node">
<title>attn_tp0_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="325491,-161.98 325231,-161.98 325231,-109.98 325491,-109.98 325491,-161.98"/>
<text text-anchor="middle" x="325361" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L10</text>
<text text-anchor="middle" x="325361" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="325361" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="325361" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp2&#45;&gt;attn_tp0_l10_dp2 -->
<g id="edge1814" class="edge">
<title>attn_input_l10_dp2&#45;&gt;attn_tp0_l10_dp2</title>
<path fill="none" stroke="black" d="M324276.52,-161.26C324313.12,-171.09 324356.81,-181.13 324397,-185.98 324442,-191.42 325168.27,-193.33 325213,-185.98 325238.4,-181.81 325265.31,-173.85 325289.12,-165.5"/>
<polygon fill="black" stroke="black" points="325290.55,-168.71 325298.78,-162.03 325288.18,-162.12 325290.55,-168.71"/>
</g>
<!-- attn_tp1_l10_dp2 -->
<g id="node1081" class="node">
<title>attn_tp1_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="325213,-161.98 324953,-161.98 324953,-109.98 325213,-109.98 325213,-161.98"/>
<text text-anchor="middle" x="325083" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L10</text>
<text text-anchor="middle" x="325083" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="325083" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="325083" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp2&#45;&gt;attn_tp1_l10_dp2 -->
<g id="edge1815" class="edge">
<title>attn_input_l10_dp2&#45;&gt;attn_tp1_l10_dp2</title>
<path fill="none" stroke="black" d="M324276.52,-161.26C324313.12,-171.09 324356.81,-181.13 324397,-185.98 324456.35,-193.15 324876.01,-195.68 324935,-185.98 324960.4,-181.81 324987.31,-173.85 325011.12,-165.5"/>
<polygon fill="black" stroke="black" points="325012.55,-168.71 325020.78,-162.03 325010.18,-162.12 325012.55,-168.71"/>
</g>
<!-- attn_tp2_l10_dp2 -->
<g id="node1082" class="node">
<title>attn_tp2_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="324935,-161.98 324675,-161.98 324675,-109.98 324935,-109.98 324935,-161.98"/>
<text text-anchor="middle" x="324805" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L10</text>
<text text-anchor="middle" x="324805" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="324805" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="324805" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp2&#45;&gt;attn_tp2_l10_dp2 -->
<g id="edge1816" class="edge">
<title>attn_input_l10_dp2&#45;&gt;attn_tp2_l10_dp2</title>
<path fill="none" stroke="black" d="M324276.52,-161.26C324313.12,-171.09 324356.81,-181.13 324397,-185.98 324454.36,-192.91 324599.99,-195.35 324657,-185.98 324682.4,-181.81 324709.31,-173.85 324733.12,-165.5"/>
<polygon fill="black" stroke="black" points="324734.55,-168.71 324742.78,-162.03 324732.18,-162.12 324734.55,-168.71"/>
</g>
<!-- attn_tp3_l10_dp2 -->
<g id="node1083" class="node">
<title>attn_tp3_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="324657,-161.98 324397,-161.98 324397,-109.98 324657,-109.98 324657,-161.98"/>
<text text-anchor="middle" x="324527" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L10</text>
<text text-anchor="middle" x="324527" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="324527" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="324527" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp2&#45;&gt;attn_tp3_l10_dp2 -->
<g id="edge1817" class="edge">
<title>attn_input_l10_dp2&#45;&gt;attn_tp3_l10_dp2</title>
<path fill="none" stroke="black" d="M324362.28,-135.98C324370.35,-135.98 324378.42,-135.98 324386.49,-135.98"/>
<polygon fill="black" stroke="black" points="324386.7,-139.48 324396.7,-135.98 324386.7,-132.48 324386.7,-139.48"/>
</g>
<!-- allreduce_l10_dp2 -->
<g id="node1084" class="node">
<title>allreduce_l10_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="325695" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="325695" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L10</text>
<text text-anchor="middle" x="325695" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="325695" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l10_dp2&#45;&gt;allreduce_l10_dp2 -->
<g id="edge1818" class="edge">
<title>attn_tp0_l10_dp2&#45;&gt;allreduce_l10_dp2</title>
<path fill="none" stroke="black" d="M325491.14,-135.98C325499.35,-135.98 325507.56,-135.98 325515.77,-135.98"/>
<polygon fill="black" stroke="black" points="325515.78,-139.48 325525.78,-135.98 325515.78,-132.48 325515.78,-139.48"/>
</g>
<!-- attn_tp1_l10_dp2&#45;&gt;allreduce_l10_dp2 -->
<g id="edge1819" class="edge">
<title>attn_tp1_l10_dp2&#45;&gt;allreduce_l10_dp2</title>
<path fill="none" stroke="black" d="M325145.22,-162.03C325171.24,-171.59 325202.1,-181.23 325231,-185.98 325288.01,-195.35 325433.64,-192.91 325491,-185.98 325527.57,-181.57 325567.05,-172.85 325601.44,-163.91"/>
<polygon fill="black" stroke="black" points="325602.7,-167.2 325611.47,-161.26 325600.91,-160.43 325602.7,-167.2"/>
</g>
<!-- attn_tp2_l10_dp2&#45;&gt;allreduce_l10_dp2 -->
<g id="edge1820" class="edge">
<title>attn_tp2_l10_dp2&#45;&gt;allreduce_l10_dp2</title>
<path fill="none" stroke="black" d="M324867.22,-162.03C324893.24,-171.59 324924.1,-181.23 324953,-185.98 325011.98,-195.68 325431.65,-193.15 325491,-185.98 325527.57,-181.57 325567.05,-172.85 325601.44,-163.91"/>
<polygon fill="black" stroke="black" points="325602.7,-167.2 325611.47,-161.26 325600.91,-160.43 325602.7,-167.2"/>
</g>
<!-- attn_tp3_l10_dp2&#45;&gt;allreduce_l10_dp2 -->
<g id="edge1821" class="edge">
<title>attn_tp3_l10_dp2&#45;&gt;allreduce_l10_dp2</title>
<path fill="none" stroke="black" d="M324589.22,-162.03C324615.24,-171.59 324646.1,-181.23 324675,-185.98 324719.73,-193.33 325445.99,-191.42 325491,-185.98 325527.57,-181.57 325567.05,-172.85 325601.44,-163.91"/>
<polygon fill="black" stroke="black" points="325602.7,-167.2 325611.47,-161.26 325600.91,-160.43 325602.7,-167.2"/>
</g>
<!-- moe_input_l10_dp2 -->
<g id="node1085" class="node">
<title>moe_input_l10_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="326068" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="326068" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L10</text>
<text text-anchor="middle" x="326068" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="326068" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l10_dp2&#45;&gt;moe_input_l10_dp2 -->
<g id="edge1822" class="edge">
<title>allreduce_l10_dp2&#45;&gt;moe_input_l10_dp2</title>
<path fill="none" stroke="black" d="M325864.01,-135.98C325872.23,-135.98 325880.44,-135.98 325888.66,-135.98"/>
<polygon fill="black" stroke="black" points="325888.68,-139.48 325898.68,-135.98 325888.68,-132.48 325888.68,-139.48"/>
</g>
<!-- router_l10_dp2 -->
<g id="node1086" class="node">
<title>router_l10_dp2</title>
<polygon fill="lightyellow" stroke="black" points="326767.57,-176.98 326373.74,-176.98 326272.43,-94.98 326666.26,-94.98 326767.57,-176.98"/>
<text text-anchor="middle" x="326520" y="-144.48" font-family="Arial" font-size="10.00">Router L10</text>
<text text-anchor="middle" x="326520" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="326520" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l10_dp2&#45;&gt;router_l10_dp2 -->
<g id="edge1823" class="edge">
<title>moe_input_l10_dp2&#45;&gt;router_l10_dp2</title>
<path fill="none" stroke="black" d="M326237.06,-135.98C326262.34,-135.98 326287.63,-135.98 326312.92,-135.98"/>
<polygon fill="black" stroke="black" points="326312.99,-139.48 326322.99,-135.98 326312.99,-132.48 326312.99,-139.48"/>
</g>
<!-- expert0_l10_dp2 -->
<g id="node1087" class="node">
<title>expert0_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="330762.5,-161.98 330533.5,-161.98 330533.5,-109.98 330762.5,-109.98 330762.5,-161.98"/>
<text text-anchor="middle" x="330648" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L10</text>
<text text-anchor="middle" x="330648" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="330648" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="330648" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert0_l10_dp2 -->
<g id="edge1824" class="edge">
<title>router_l10_dp2&#45;&gt;expert0_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.24,-171.8C326780.75,-173.86 326800.18,-175.64 326819,-176.98 327584.06,-231.64 329503.49,-196.54 330270.5,-198.98 330383.59,-199.34 330413.43,-200.75 330524,-176.98 330538.41,-173.89 330553.49,-169.72 330567.98,-165.22"/>
<polygon fill="black" stroke="black" points="330569.44,-168.43 330577.9,-162.07 330567.31,-161.76 330569.44,-168.43"/>
<text text-anchor="middle" x="330292" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l10_dp2 -->
<g id="node1088" class="node">
<title>expert1_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="330515.5,-161.98 330286.5,-161.98 330286.5,-109.98 330515.5,-109.98 330515.5,-161.98"/>
<text text-anchor="middle" x="330401" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L10</text>
<text text-anchor="middle" x="330401" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="330401" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="330401" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert1_l10_dp2 -->
<g id="edge1825" class="edge">
<title>router_l10_dp2&#45;&gt;expert1_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.24,-171.79C326780.75,-173.85 326800.18,-175.63 326819,-176.98 327528.86,-227.88 329309.82,-196.54 330021.5,-198.98 330135.47,-199.37 330165.56,-200.88 330277,-176.98 330291.41,-173.89 330306.5,-169.73 330320.99,-165.23"/>
<polygon fill="black" stroke="black" points="330322.44,-168.45 330330.91,-162.08 330320.32,-161.77 330322.44,-168.45"/>
<text text-anchor="middle" x="330043" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l10_dp2 -->
<g id="node1089" class="node">
<title>expert2_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="330268.5,-161.98 330039.5,-161.98 330039.5,-109.98 330268.5,-109.98 330268.5,-161.98"/>
<text text-anchor="middle" x="330154" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L10</text>
<text text-anchor="middle" x="330154" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="330154" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="330154" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert2_l10_dp2 -->
<g id="edge1826" class="edge">
<title>router_l10_dp2&#45;&gt;expert2_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.24,-171.78C326780.75,-173.84 326800.18,-175.63 326819,-176.98 327473.21,-224.08 329114.6,-196.54 329770.5,-198.98 329886.24,-199.41 329916.8,-201.15 330030,-176.98 330044.64,-173.86 330059.98,-169.62 330074.68,-165.04"/>
<polygon fill="black" stroke="black" points="330075.77,-168.37 330084.24,-162 330073.65,-161.7 330075.77,-168.37"/>
<text text-anchor="middle" x="329792" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l10_dp2 -->
<g id="node1090" class="node">
<title>expert3_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="330021.5,-161.98 329792.5,-161.98 329792.5,-109.98 330021.5,-109.98 330021.5,-161.98"/>
<text text-anchor="middle" x="329907" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L10</text>
<text text-anchor="middle" x="329907" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="329907" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="329907" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert3_l10_dp2 -->
<g id="edge1827" class="edge">
<title>router_l10_dp2&#45;&gt;expert3_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.24,-171.76C326780.75,-173.83 326800.19,-175.62 326819,-176.98 327416.46,-220.21 328915.48,-196.54 329514.5,-198.98 329634.23,-199.47 329665.85,-201.74 329783,-176.98 329797.65,-173.89 329812.99,-169.66 329827.69,-165.09"/>
<polygon fill="black" stroke="black" points="329828.78,-168.42 329837.25,-162.05 329826.66,-161.75 329828.78,-168.42"/>
<text text-anchor="middle" x="329536" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l10_dp2 -->
<g id="node1091" class="node">
<title>expert4_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="329774.5,-161.98 329545.5,-161.98 329545.5,-109.98 329774.5,-109.98 329774.5,-161.98"/>
<text text-anchor="middle" x="329660" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L10</text>
<text text-anchor="middle" x="329660" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="329660" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="329660" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert4_l10_dp2 -->
<g id="edge1828" class="edge">
<title>router_l10_dp2&#45;&gt;expert4_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.24,-171.74C326780.75,-173.82 326800.19,-175.61 326819,-176.98 327357.93,-216.21 328710.15,-196.54 329250.5,-198.98 329377.76,-199.56 329411.4,-202.88 329536,-176.98 329550.75,-173.92 329566.2,-169.68 329580.98,-165.09"/>
<polygon fill="black" stroke="black" points="329582.13,-168.4 329590.59,-162.03 329580,-161.73 329582.13,-168.4"/>
<text text-anchor="middle" x="329272" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l10_dp2 -->
<g id="node1092" class="node">
<title>expert5_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="329527.5,-161.98 329298.5,-161.98 329298.5,-109.98 329527.5,-109.98 329527.5,-161.98"/>
<text text-anchor="middle" x="329413" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L10</text>
<text text-anchor="middle" x="329413" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="329413" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="329413" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert5_l10_dp2 -->
<g id="edge1829" class="edge">
<title>router_l10_dp2&#45;&gt;expert5_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.24,-171.72C326780.75,-173.8 326800.19,-175.6 326819,-176.98 327295.63,-211.96 328491.59,-196.54 328969.5,-198.98 329111.83,-199.71 329149.48,-205.17 329289,-176.98 329303.86,-173.98 329319.41,-169.75 329334.29,-165.14"/>
<polygon fill="black" stroke="black" points="329335.48,-168.43 329343.95,-162.06 329333.36,-161.76 329335.48,-168.43"/>
<text text-anchor="middle" x="328991" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l10_dp2 -->
<g id="node1093" class="node">
<title>expert6_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="329280.5,-161.98 329051.5,-161.98 329051.5,-109.98 329280.5,-109.98 329280.5,-161.98"/>
<text text-anchor="middle" x="329166" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L10</text>
<text text-anchor="middle" x="329166" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="329166" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="329166" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert6_l10_dp2 -->
<g id="edge1830" class="edge">
<title>router_l10_dp2&#45;&gt;expert6_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.25,-171.68C326780.76,-173.77 326800.19,-175.59 326819,-176.98 327632.59,-237.4 327838.68,-194.09 328654.5,-198.98 328826.99,-200.02 328872.65,-209.82 329042,-176.98 329057.06,-174.06 329072.83,-169.82 329087.87,-165.16"/>
<polygon fill="black" stroke="black" points="329089.17,-168.42 329097.64,-162.05 329087.05,-161.75 329089.17,-168.42"/>
<text text-anchor="middle" x="328676" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l10_dp2 -->
<g id="node1094" class="node">
<title>expert7_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="329033.5,-161.98 328804.5,-161.98 328804.5,-109.98 329033.5,-109.98 329033.5,-161.98"/>
<text text-anchor="middle" x="328919" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L10</text>
<text text-anchor="middle" x="328919" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="328919" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="328919" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert7_l10_dp2 -->
<g id="edge1831" class="edge">
<title>router_l10_dp2&#45;&gt;expert7_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326702.37,-177C326750.6,-186.1 326802.8,-194.4 326851.5,-198.98 326870.53,-200.77 326875.39,-199.09 326894.5,-198.98 327105.68,-197.76 328586.7,-211.76 328795,-176.98 328810.83,-174.34 328827.39,-170.02 328843.07,-165.16"/>
<polygon fill="black" stroke="black" points="328844.25,-168.46 328852.7,-162.07 328842.11,-161.79 328844.25,-168.46"/>
<text text-anchor="middle" x="326873" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l10_dp2 -->
<g id="node1095" class="node">
<title>expert8_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="328786.5,-161.98 328557.5,-161.98 328557.5,-109.98 328786.5,-109.98 328786.5,-161.98"/>
<text text-anchor="middle" x="328672" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L10</text>
<text text-anchor="middle" x="328672" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="328672" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="328672" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert8_l10_dp2 -->
<g id="edge1832" class="edge">
<title>router_l10_dp2&#45;&gt;expert8_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326761.25,-171.62C326780.76,-173.72 326800.19,-175.56 326819,-176.98 327462.78,-225.82 327625.89,-194.09 328271.5,-198.98 328394.77,-199.92 328427.34,-202.28 328548,-176.98 328562.74,-173.89 328578.19,-169.64 328592.98,-165.05"/>
<polygon fill="black" stroke="black" points="328594.12,-168.36 328602.58,-161.98 328591.99,-161.69 328594.12,-168.36"/>
<text text-anchor="middle" x="328293" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l10_dp2 -->
<g id="node1096" class="node">
<title>expert9_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="328539.5,-161.98 328310.5,-161.98 328310.5,-109.98 328539.5,-109.98 328539.5,-161.98"/>
<text text-anchor="middle" x="328425" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L10</text>
<text text-anchor="middle" x="328425" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="328425" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="328425" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert9_l10_dp2 -->
<g id="edge1833" class="edge">
<title>router_l10_dp2&#45;&gt;expert9_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326760.85,-171.5C326780.49,-173.64 326800.06,-175.51 326819,-176.98 327090.12,-198.02 327770.81,-210.52 328042.5,-198.98 328157.7,-194.09 328188.04,-200.13 328301,-176.98 328315.85,-173.94 328331.4,-169.69 328346.27,-165.07"/>
<polygon fill="black" stroke="black" points="328347.47,-168.36 328355.93,-161.99 328345.34,-161.69 328347.47,-168.36"/>
<text text-anchor="middle" x="328021" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l10_dp2 -->
<g id="node1097" class="node">
<title>expert10_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="328292.5,-161.98 328063.5,-161.98 328063.5,-109.98 328292.5,-109.98 328292.5,-161.98"/>
<text text-anchor="middle" x="328178" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L10</text>
<text text-anchor="middle" x="328178" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="328178" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="328178" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert10_l10_dp2 -->
<g id="edge1834" class="edge">
<title>router_l10_dp2&#45;&gt;expert10_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326760.86,-171.37C326780.5,-173.54 326800.07,-175.45 326819,-176.98 327229.56,-210.14 327333.87,-213.64 327745.5,-198.98 327882.87,-194.09 327919.15,-203.65 328054,-176.98 328068.96,-174.02 328084.62,-169.79 328099.58,-165.15"/>
<polygon fill="black" stroke="black" points="328100.83,-168.43 328109.29,-162.06 328098.7,-161.76 328100.83,-168.43"/>
<text text-anchor="middle" x="327724" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l10_dp2 -->
<g id="node1098" class="node">
<title>expert11_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="328045.5,-161.98 327816.5,-161.98 327816.5,-109.98 328045.5,-109.98 328045.5,-161.98"/>
<text text-anchor="middle" x="327931" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L10</text>
<text text-anchor="middle" x="327931" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="327931" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="327931" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert11_l10_dp2 -->
<g id="edge1835" class="edge">
<title>router_l10_dp2&#45;&gt;expert11_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326747.31,-177.01C326807.33,-186.11 326872.18,-194.4 326932.5,-198.98 327126.34,-213.7 327615.5,-210.42 327807,-176.98 327822.72,-174.24 327839.17,-169.9 327854.76,-165.06"/>
<polygon fill="black" stroke="black" points="327855.89,-168.37 327864.34,-161.99 327853.75,-161.71 327855.89,-168.37"/>
<text text-anchor="middle" x="326954" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l10_dp2 -->
<g id="node1099" class="node">
<title>expert12_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="327798.5,-161.98 327569.5,-161.98 327569.5,-109.98 327798.5,-109.98 327798.5,-161.98"/>
<text text-anchor="middle" x="327684" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L10</text>
<text text-anchor="middle" x="327684" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="327684" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="327684" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert12_l10_dp2 -->
<g id="edge1836" class="edge">
<title>router_l10_dp2&#45;&gt;expert12_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326760.65,-171.3C326936.95,-192.77 327182.06,-213.5 327397.5,-198.98 327470.21,-194.08 327488.99,-193.38 327560,-176.98 327574.09,-173.73 327588.86,-169.55 327603.09,-165.11"/>
<polygon fill="black" stroke="black" points="327604.37,-168.38 327612.84,-162.01 327602.25,-161.71 327604.37,-168.38"/>
<text text-anchor="middle" x="327376" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l10_dp2 -->
<g id="node1100" class="node">
<title>expert13_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="327551.5,-161.98 327322.5,-161.98 327322.5,-109.98 327551.5,-109.98 327551.5,-161.98"/>
<text text-anchor="middle" x="327437" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L10</text>
<text text-anchor="middle" x="327437" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="327437" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="327437" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert13_l10_dp2 -->
<g id="edge1837" class="edge">
<title>router_l10_dp2&#45;&gt;expert13_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326738.6,-177.02C326871.1,-196.74 327043.53,-213.3 327196.5,-198.98 327248.96,-194.07 327261.98,-190.17 327313,-176.98 327326.34,-173.53 327340.33,-169.41 327353.91,-165.13"/>
<polygon fill="black" stroke="black" points="327355.25,-168.38 327363.71,-162 327353.12,-161.71 327355.25,-168.38"/>
<text text-anchor="middle" x="327175" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l10_dp2 -->
<g id="node1101" class="node">
<title>expert14_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="327304.5,-161.98 327075.5,-161.98 327075.5,-109.98 327304.5,-109.98 327304.5,-161.98"/>
<text text-anchor="middle" x="327190" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L10</text>
<text text-anchor="middle" x="327190" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="327190" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="327190" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert14_l10_dp2 -->
<g id="edge1838" class="edge">
<title>router_l10_dp2&#45;&gt;expert14_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326742.86,-177.01C326857.32,-195.26 326984.29,-210.34 327040.5,-198.98 327072.11,-192.59 327105.35,-179.32 327132.44,-166.59"/>
<polygon fill="black" stroke="black" points="327134.25,-169.61 327141.75,-162.13 327131.22,-163.29 327134.25,-169.61"/>
<text text-anchor="middle" x="327019" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l10_dp2 -->
<g id="node1102" class="node">
<title>expert15_l10_dp2</title>
<polygon fill="lightgreen" stroke="black" points="327057.5,-161.98 326828.5,-161.98 326828.5,-109.98 327057.5,-109.98 327057.5,-161.98"/>
<text text-anchor="middle" x="326943" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L10</text>
<text text-anchor="middle" x="326943" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="326943" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="326943" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp2&#45;&gt;expert15_l10_dp2 -->
<g id="edge1839" class="edge">
<title>router_l10_dp2&#45;&gt;expert15_l10_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M326716.95,-135.98C326751.38,-135.98 326786.32,-135.98 326818.11,-135.98"/>
<polygon fill="black" stroke="black" points="326818.32,-139.48 326828.32,-135.98 326818.32,-132.48 326818.32,-139.48"/>
<text text-anchor="middle" x="326798.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l10_dp2 -->
<g id="node1103" class="node">
<title>expert_agg_l10_dp2</title>
<polygon fill="lightyellow" stroke="black" points="331293.57,-176.98 330899.74,-176.98 330798.43,-94.98 331192.26,-94.98 331293.57,-176.98"/>
<text text-anchor="middle" x="331046" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L10</text>
<text text-anchor="middle" x="331046" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="331046" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1840" class="edge">
<title>expert0_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M330762.66,-135.98C330788.06,-135.98 330813.47,-135.98 330838.87,-135.98"/>
<polygon fill="black" stroke="black" points="330838.99,-139.48 330848.99,-135.98 330838.99,-132.48 330838.99,-139.48"/>
</g>
<!-- expert1_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1841" class="edge">
<title>expert1_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M330456.24,-162.02C330479.4,-171.57 330506.96,-181.22 330533,-185.98 330583.06,-195.15 330711.3,-190.41 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert2_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1842" class="edge">
<title>expert2_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M330209.24,-162.02C330232.4,-171.57 330259.96,-181.22 330286,-185.98 330338.02,-195.51 330709.31,-190.59 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert3_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1843" class="edge">
<title>expert3_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M329962.24,-162.02C329985.4,-171.57 330012.96,-181.22 330039,-185.98 330118.02,-200.45 330681.97,-192.97 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert4_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1844" class="edge">
<title>expert4_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M329715.24,-162.02C329738.4,-171.57 329765.96,-181.22 329792,-185.98 329845.01,-195.69 330708.31,-190.67 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert5_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1845" class="edge">
<title>expert5_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M329468.24,-162.02C329491.4,-171.57 329518.96,-181.22 329545,-185.98 329611.5,-198.16 330694.64,-191.87 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert6_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1846" class="edge">
<title>expert6_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M329221.24,-162.02C329244.4,-171.57 329271.96,-181.22 329298,-185.98 329378,-200.63 330680.97,-193.06 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert7_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1847" class="edge">
<title>expert7_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M328974.24,-162.02C328997.4,-171.57 329024.96,-181.22 329051,-185.98 329097.75,-194.54 330714.65,-190.12 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert8_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1848" class="edge">
<title>expert8_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M328727.24,-162.02C328750.4,-171.57 328777.96,-181.22 328804,-185.98 328857.5,-195.78 330707.82,-190.72 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert9_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1849" class="edge">
<title>expert9_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M328480.24,-162.02C328503.4,-171.57 328530.96,-181.22 328557,-185.98 328617.25,-197.01 330700.98,-191.31 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert10_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1850" class="edge">
<title>expert10_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M328233.24,-162.02C328256.4,-171.57 328283.96,-181.22 328310,-185.98 328377,-198.25 330694.15,-191.91 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert11_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1851" class="edge">
<title>expert11_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M327986.24,-162.02C328009.4,-171.57 328036.96,-181.22 328063,-185.98 328136.75,-199.48 330687.31,-192.51 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert12_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1852" class="edge">
<title>expert12_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M327739.24,-162.02C327762.4,-171.57 327789.96,-181.22 327816,-185.98 327896.49,-200.72 330680.48,-193.1 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert13_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1853" class="edge">
<title>expert13_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M327492.24,-162.02C327515.4,-171.57 327542.96,-181.22 327569,-185.98 327612.62,-193.97 330717.82,-189.84 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert14_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1854" class="edge">
<title>expert14_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M327245.24,-162.02C327268.4,-171.57 327295.96,-181.22 327322,-185.98 327369,-194.59 330714.4,-190.14 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- expert15_l10_dp2&#45;&gt;expert_agg_l10_dp2 -->
<g id="edge1855" class="edge">
<title>expert15_l10_dp2&#45;&gt;expert_agg_l10_dp2</title>
<path fill="none" stroke="black" d="M326998.24,-162.02C327021.4,-171.57 327048.96,-181.22 327075,-185.98 327125.37,-195.2 330710.98,-190.44 330762,-185.98 330800.11,-182.65 330840.78,-176.86 330879.08,-170.36"/>
<polygon fill="black" stroke="black" points="330880.02,-173.75 330889.29,-168.6 330878.84,-166.85 330880.02,-173.75"/>
</g>
<!-- layer10_output_dp2 -->
<g id="node1104" class="node">
<title>layer10_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="331498" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="331498" y="-144.48" font-family="Arial" font-size="10.00">Layer 10 Output</text>
<text text-anchor="middle" x="331498" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="331498" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l10_dp2&#45;&gt;layer10_output_dp2 -->
<g id="edge1856" class="edge">
<title>expert_agg_l10_dp2&#45;&gt;layer10_output_dp2</title>
<path fill="none" stroke="black" d="M331243.31,-135.98C331268.49,-135.98 331293.66,-135.98 331318.84,-135.98"/>
<polygon fill="black" stroke="black" points="331318.87,-139.48 331328.87,-135.98 331318.87,-132.48 331318.87,-139.48"/>
</g>
<!-- attn_input_l11_dp2 -->
<g id="node1105" class="node">
<title>attn_input_l11_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="331871" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="331871" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L11</text>
<text text-anchor="middle" x="331871" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="331871" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer10_output_dp2&#45;&gt;attn_input_l11_dp2 -->
<g id="edge1857" class="edge">
<title>layer10_output_dp2&#45;&gt;attn_input_l11_dp2</title>
<path fill="none" stroke="black" d="M331667.01,-135.98C331675.23,-135.98 331683.44,-135.98 331691.66,-135.98"/>
<polygon fill="black" stroke="black" points="331691.68,-139.48 331701.68,-135.98 331691.68,-132.48 331691.68,-139.48"/>
</g>
<!-- attn_tp0_l11_dp2 -->
<g id="node1106" class="node">
<title>attn_tp0_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="333169,-161.98 332909,-161.98 332909,-109.98 333169,-109.98 333169,-161.98"/>
<text text-anchor="middle" x="333039" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L11</text>
<text text-anchor="middle" x="333039" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="333039" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="333039" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp2&#45;&gt;attn_tp0_l11_dp2 -->
<g id="edge1858" class="edge">
<title>attn_input_l11_dp2&#45;&gt;attn_tp0_l11_dp2</title>
<path fill="none" stroke="black" d="M331954.52,-161.26C331991.12,-171.09 332034.81,-181.13 332075,-185.98 332120,-191.42 332846.27,-193.33 332891,-185.98 332916.4,-181.81 332943.31,-173.85 332967.12,-165.5"/>
<polygon fill="black" stroke="black" points="332968.55,-168.71 332976.78,-162.03 332966.18,-162.12 332968.55,-168.71"/>
</g>
<!-- attn_tp1_l11_dp2 -->
<g id="node1107" class="node">
<title>attn_tp1_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="332891,-161.98 332631,-161.98 332631,-109.98 332891,-109.98 332891,-161.98"/>
<text text-anchor="middle" x="332761" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L11</text>
<text text-anchor="middle" x="332761" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="332761" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="332761" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp2&#45;&gt;attn_tp1_l11_dp2 -->
<g id="edge1859" class="edge">
<title>attn_input_l11_dp2&#45;&gt;attn_tp1_l11_dp2</title>
<path fill="none" stroke="black" d="M331954.52,-161.26C331991.12,-171.09 332034.81,-181.13 332075,-185.98 332134.35,-193.15 332554.01,-195.68 332613,-185.98 332638.4,-181.81 332665.31,-173.85 332689.12,-165.5"/>
<polygon fill="black" stroke="black" points="332690.55,-168.71 332698.78,-162.03 332688.18,-162.12 332690.55,-168.71"/>
</g>
<!-- attn_tp2_l11_dp2 -->
<g id="node1108" class="node">
<title>attn_tp2_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="332613,-161.98 332353,-161.98 332353,-109.98 332613,-109.98 332613,-161.98"/>
<text text-anchor="middle" x="332483" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L11</text>
<text text-anchor="middle" x="332483" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="332483" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="332483" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp2&#45;&gt;attn_tp2_l11_dp2 -->
<g id="edge1860" class="edge">
<title>attn_input_l11_dp2&#45;&gt;attn_tp2_l11_dp2</title>
<path fill="none" stroke="black" d="M331954.52,-161.26C331991.12,-171.09 332034.81,-181.13 332075,-185.98 332132.36,-192.91 332277.99,-195.35 332335,-185.98 332360.4,-181.81 332387.31,-173.85 332411.12,-165.5"/>
<polygon fill="black" stroke="black" points="332412.55,-168.71 332420.78,-162.03 332410.18,-162.12 332412.55,-168.71"/>
</g>
<!-- attn_tp3_l11_dp2 -->
<g id="node1109" class="node">
<title>attn_tp3_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="332335,-161.98 332075,-161.98 332075,-109.98 332335,-109.98 332335,-161.98"/>
<text text-anchor="middle" x="332205" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L11</text>
<text text-anchor="middle" x="332205" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="332205" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="332205" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp2&#45;&gt;attn_tp3_l11_dp2 -->
<g id="edge1861" class="edge">
<title>attn_input_l11_dp2&#45;&gt;attn_tp3_l11_dp2</title>
<path fill="none" stroke="black" d="M332040.28,-135.98C332048.35,-135.98 332056.42,-135.98 332064.49,-135.98"/>
<polygon fill="black" stroke="black" points="332064.7,-139.48 332074.7,-135.98 332064.7,-132.48 332064.7,-139.48"/>
</g>
<!-- allreduce_l11_dp2 -->
<g id="node1110" class="node">
<title>allreduce_l11_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="333373" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="333373" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L11</text>
<text text-anchor="middle" x="333373" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="333373" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l11_dp2&#45;&gt;allreduce_l11_dp2 -->
<g id="edge1862" class="edge">
<title>attn_tp0_l11_dp2&#45;&gt;allreduce_l11_dp2</title>
<path fill="none" stroke="black" d="M333169.14,-135.98C333177.35,-135.98 333185.56,-135.98 333193.77,-135.98"/>
<polygon fill="black" stroke="black" points="333193.78,-139.48 333203.78,-135.98 333193.78,-132.48 333193.78,-139.48"/>
</g>
<!-- attn_tp1_l11_dp2&#45;&gt;allreduce_l11_dp2 -->
<g id="edge1863" class="edge">
<title>attn_tp1_l11_dp2&#45;&gt;allreduce_l11_dp2</title>
<path fill="none" stroke="black" d="M332823.22,-162.03C332849.24,-171.59 332880.1,-181.23 332909,-185.98 332966.01,-195.35 333111.64,-192.91 333169,-185.98 333205.57,-181.57 333245.05,-172.85 333279.44,-163.91"/>
<polygon fill="black" stroke="black" points="333280.7,-167.2 333289.47,-161.26 333278.91,-160.43 333280.7,-167.2"/>
</g>
<!-- attn_tp2_l11_dp2&#45;&gt;allreduce_l11_dp2 -->
<g id="edge1864" class="edge">
<title>attn_tp2_l11_dp2&#45;&gt;allreduce_l11_dp2</title>
<path fill="none" stroke="black" d="M332545.22,-162.03C332571.24,-171.59 332602.1,-181.23 332631,-185.98 332689.98,-195.68 333109.65,-193.15 333169,-185.98 333205.57,-181.57 333245.05,-172.85 333279.44,-163.91"/>
<polygon fill="black" stroke="black" points="333280.7,-167.2 333289.47,-161.26 333278.91,-160.43 333280.7,-167.2"/>
</g>
<!-- attn_tp3_l11_dp2&#45;&gt;allreduce_l11_dp2 -->
<g id="edge1865" class="edge">
<title>attn_tp3_l11_dp2&#45;&gt;allreduce_l11_dp2</title>
<path fill="none" stroke="black" d="M332267.22,-162.03C332293.24,-171.59 332324.1,-181.23 332353,-185.98 332397.73,-193.33 333123.99,-191.42 333169,-185.98 333205.57,-181.57 333245.05,-172.85 333279.44,-163.91"/>
<polygon fill="black" stroke="black" points="333280.7,-167.2 333289.47,-161.26 333278.91,-160.43 333280.7,-167.2"/>
</g>
<!-- moe_input_l11_dp2 -->
<g id="node1111" class="node">
<title>moe_input_l11_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="333746" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="333746" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L11</text>
<text text-anchor="middle" x="333746" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="333746" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l11_dp2&#45;&gt;moe_input_l11_dp2 -->
<g id="edge1866" class="edge">
<title>allreduce_l11_dp2&#45;&gt;moe_input_l11_dp2</title>
<path fill="none" stroke="black" d="M333542.01,-135.98C333550.23,-135.98 333558.44,-135.98 333566.66,-135.98"/>
<polygon fill="black" stroke="black" points="333566.68,-139.48 333576.68,-135.98 333566.68,-132.48 333566.68,-139.48"/>
</g>
<!-- router_l11_dp2 -->
<g id="node1112" class="node">
<title>router_l11_dp2</title>
<polygon fill="lightyellow" stroke="black" points="334445.57,-176.98 334051.74,-176.98 333950.43,-94.98 334344.26,-94.98 334445.57,-176.98"/>
<text text-anchor="middle" x="334198" y="-144.48" font-family="Arial" font-size="10.00">Router L11</text>
<text text-anchor="middle" x="334198" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="334198" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l11_dp2&#45;&gt;router_l11_dp2 -->
<g id="edge1867" class="edge">
<title>moe_input_l11_dp2&#45;&gt;router_l11_dp2</title>
<path fill="none" stroke="black" d="M333915.06,-135.98C333940.34,-135.98 333965.63,-135.98 333990.92,-135.98"/>
<polygon fill="black" stroke="black" points="333990.99,-139.48 334000.99,-135.98 333990.99,-132.48 333990.99,-139.48"/>
</g>
<!-- expert0_l11_dp2 -->
<g id="node1113" class="node">
<title>expert0_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="338440.5,-161.98 338211.5,-161.98 338211.5,-109.98 338440.5,-109.98 338440.5,-161.98"/>
<text text-anchor="middle" x="338326" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L11</text>
<text text-anchor="middle" x="338326" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="338326" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="338326" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert0_l11_dp2 -->
<g id="edge1868" class="edge">
<title>router_l11_dp2&#45;&gt;expert0_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.24,-171.8C334458.75,-173.86 334478.18,-175.64 334497,-176.98 335261.62,-231.61 337179.93,-196.54 337946.5,-198.98 338060.47,-199.35 338090.56,-200.88 338202,-176.98 338216.41,-173.89 338231.5,-169.73 338245.99,-165.23"/>
<polygon fill="black" stroke="black" points="338247.44,-168.45 338255.91,-162.08 338245.32,-161.77 338247.44,-168.45"/>
<text text-anchor="middle" x="337968" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l11_dp2 -->
<g id="node1114" class="node">
<title>expert1_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="338193.5,-161.98 337964.5,-161.98 337964.5,-109.98 338193.5,-109.98 338193.5,-161.98"/>
<text text-anchor="middle" x="338079" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L11</text>
<text text-anchor="middle" x="338079" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="338079" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="338079" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert1_l11_dp2 -->
<g id="edge1869" class="edge">
<title>router_l11_dp2&#45;&gt;expert1_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.24,-171.79C334458.75,-173.85 334478.18,-175.63 334497,-176.98 335205.97,-227.82 336984.71,-196.54 337695.5,-198.98 337811.24,-199.38 337841.8,-201.15 337955,-176.98 337969.64,-173.86 337984.98,-169.62 337999.68,-165.04"/>
<polygon fill="black" stroke="black" points="338000.77,-168.37 338009.24,-162 337998.65,-161.7 338000.77,-168.37"/>
<text text-anchor="middle" x="337717" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l11_dp2 -->
<g id="node1115" class="node">
<title>expert2_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="337946.5,-161.98 337717.5,-161.98 337717.5,-109.98 337946.5,-109.98 337946.5,-161.98"/>
<text text-anchor="middle" x="337832" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L11</text>
<text text-anchor="middle" x="337832" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="337832" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="337832" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert2_l11_dp2 -->
<g id="edge1870" class="edge">
<title>router_l11_dp2&#45;&gt;expert2_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.24,-171.78C334458.75,-173.84 334478.18,-175.63 334497,-176.98 335149.22,-223.94 336785.6,-196.54 337439.5,-198.98 337559.23,-199.43 337590.85,-201.74 337708,-176.98 337722.65,-173.89 337737.99,-169.66 337752.69,-165.09"/>
<polygon fill="black" stroke="black" points="337753.78,-168.42 337762.25,-162.05 337751.66,-161.75 337753.78,-168.42"/>
<text text-anchor="middle" x="337461" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l11_dp2 -->
<g id="node1116" class="node">
<title>expert3_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="337699.5,-161.98 337470.5,-161.98 337470.5,-109.98 337699.5,-109.98 337699.5,-161.98"/>
<text text-anchor="middle" x="337585" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L11</text>
<text text-anchor="middle" x="337585" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="337585" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="337585" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert3_l11_dp2 -->
<g id="edge1871" class="edge">
<title>router_l11_dp2&#45;&gt;expert3_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.24,-171.76C334458.75,-173.83 334478.19,-175.62 334497,-176.98 335090.47,-219.93 336579.48,-196.54 337174.5,-198.98 337302.21,-199.51 337335.96,-202.94 337461,-176.98 337475.75,-173.92 337491.2,-169.69 337505.99,-165.09"/>
<polygon fill="black" stroke="black" points="337507.13,-168.4 337515.59,-162.03 337505,-161.73 337507.13,-168.4"/>
<text text-anchor="middle" x="337196" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l11_dp2 -->
<g id="node1117" class="node">
<title>expert4_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="337452.5,-161.98 337223.5,-161.98 337223.5,-109.98 337452.5,-109.98 337452.5,-161.98"/>
<text text-anchor="middle" x="337338" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L11</text>
<text text-anchor="middle" x="337338" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="337338" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="337338" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert4_l11_dp2 -->
<g id="edge1872" class="edge">
<title>router_l11_dp2&#45;&gt;expert4_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.24,-171.74C334458.75,-173.82 334478.19,-175.61 334497,-176.98 335027.73,-215.65 336359.37,-196.54 336891.5,-198.98 337035.16,-199.64 337073.17,-205.38 337214,-176.98 337228.86,-173.99 337244.41,-169.76 337259.29,-165.15"/>
<polygon fill="black" stroke="black" points="337260.48,-168.44 337268.95,-162.07 337258.36,-161.77 337260.48,-168.44"/>
<text text-anchor="middle" x="336913" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l11_dp2 -->
<g id="node1118" class="node">
<title>expert5_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="337205.5,-161.98 336976.5,-161.98 336976.5,-109.98 337205.5,-109.98 337205.5,-161.98"/>
<text text-anchor="middle" x="337091" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L11</text>
<text text-anchor="middle" x="337091" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="337091" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="337091" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert5_l11_dp2 -->
<g id="edge1873" class="edge">
<title>router_l11_dp2&#45;&gt;expert5_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.24,-171.71C334458.75,-173.79 334478.19,-175.6 334497,-176.98 334957,-210.82 336111.26,-196.54 336572.5,-198.98 336748.1,-199.91 336794.58,-210.31 336967,-176.98 336982.06,-174.07 336997.83,-169.83 337012.87,-165.17"/>
<polygon fill="black" stroke="black" points="337014.18,-168.43 337022.64,-162.06 337012.05,-161.76 337014.18,-168.43"/>
<text text-anchor="middle" x="336594" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l11_dp2 -->
<g id="node1119" class="node">
<title>expert6_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="336958.5,-161.98 336729.5,-161.98 336729.5,-109.98 336958.5,-109.98 336958.5,-161.98"/>
<text text-anchor="middle" x="336844" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L11</text>
<text text-anchor="middle" x="336844" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="336844" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="336844" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert6_l11_dp2 -->
<g id="edge1874" class="edge">
<title>router_l11_dp2&#45;&gt;expert6_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334367.03,-177C334411.77,-186.09 334460.23,-194.39 334505.5,-198.98 334524.51,-200.91 334529.39,-199.08 334548.5,-198.98 334789.79,-197.76 336481.97,-216.55 336720,-176.98 336735.84,-174.35 336752.4,-170.04 336768.07,-165.18"/>
<polygon fill="black" stroke="black" points="336769.25,-168.47 336777.7,-162.09 336767.11,-161.81 336769.25,-168.47"/>
<text text-anchor="middle" x="334527" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l11_dp2 -->
<g id="node1120" class="node">
<title>expert7_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="336711.5,-161.98 336482.5,-161.98 336482.5,-109.98 336711.5,-109.98 336711.5,-161.98"/>
<text text-anchor="middle" x="336597" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L11</text>
<text text-anchor="middle" x="336597" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="336597" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="336597" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert7_l11_dp2 -->
<g id="edge1875" class="edge">
<title>router_l11_dp2&#45;&gt;expert7_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.25,-171.66C334458.76,-173.75 334478.19,-175.58 334497,-176.98 335243.64,-232.84 335432.78,-194.09 336181.5,-198.98 336311.42,-199.83 336345.76,-203.28 336473,-176.98 336487.75,-173.93 336503.2,-169.7 336517.99,-165.11"/>
<polygon fill="black" stroke="black" points="336519.13,-168.42 336527.6,-162.05 336517.01,-161.75 336519.13,-168.42"/>
<text text-anchor="middle" x="336203" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l11_dp2 -->
<g id="node1121" class="node">
<title>expert8_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="336464.5,-161.98 336235.5,-161.98 336235.5,-109.98 336464.5,-109.98 336464.5,-161.98"/>
<text text-anchor="middle" x="336350" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L11</text>
<text text-anchor="middle" x="336350" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="336350" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="336350" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert8_l11_dp2 -->
<g id="edge1876" class="edge">
<title>router_l11_dp2&#45;&gt;expert8_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334439.25,-171.61C334458.76,-173.71 334478.19,-175.55 334497,-176.98 335116.39,-224.15 335273.33,-194.09 335894.5,-198.98 336042.15,-200.14 336081.22,-205.99 336226,-176.98 336240.95,-173.99 336256.61,-169.73 336271.57,-165.09"/>
<polygon fill="black" stroke="black" points="336272.82,-168.37 336281.28,-162 336270.69,-161.7 336272.82,-168.37"/>
<text text-anchor="middle" x="335916" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l11_dp2 -->
<g id="node1122" class="node">
<title>expert9_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="336217.5,-161.98 335988.5,-161.98 335988.5,-109.98 336217.5,-109.98 336217.5,-161.98"/>
<text text-anchor="middle" x="336103" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L11</text>
<text text-anchor="middle" x="336103" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="336103" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="336103" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert9_l11_dp2 -->
<g id="edge1877" class="edge">
<title>router_l11_dp2&#45;&gt;expert9_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334438.85,-171.46C334458.5,-173.61 334478.06,-175.49 334497,-176.98 334990.02,-215.73 335115.18,-213.69 335609.5,-198.98 335773.94,-194.09 335817.43,-207.96 335979,-176.98 335994.16,-174.08 336010.03,-169.82 336025.15,-165.13"/>
<polygon fill="black" stroke="black" points="336026.51,-168.37 336034.97,-161.99 336024.38,-161.7 336026.51,-168.37"/>
<text text-anchor="middle" x="335588" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l11_dp2 -->
<g id="node1123" class="node">
<title>expert10_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="335970.5,-161.98 335741.5,-161.98 335741.5,-109.98 335970.5,-109.98 335970.5,-161.98"/>
<text text-anchor="middle" x="335856" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L11</text>
<text text-anchor="middle" x="335856" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="335856" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="335856" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert10_l11_dp2 -->
<g id="edge1878" class="edge">
<title>router_l11_dp2&#45;&gt;expert10_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334405.34,-177.01C334460.12,-186.11 334519.35,-194.4 334574.5,-198.98 334702.69,-209.63 335605.21,-198.69 335732,-176.98 335747.73,-174.29 335764.19,-169.98 335779.78,-165.14"/>
<polygon fill="black" stroke="black" points="335780.9,-168.46 335789.36,-162.07 335778.77,-161.79 335780.9,-168.46"/>
<text text-anchor="middle" x="334596" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l11_dp2 -->
<g id="node1124" class="node">
<title>expert11_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="335723.5,-161.98 335494.5,-161.98 335494.5,-109.98 335723.5,-109.98 335723.5,-161.98"/>
<text text-anchor="middle" x="335609" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L11</text>
<text text-anchor="middle" x="335609" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="335609" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="335609" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert11_l11_dp2 -->
<g id="edge1879" class="edge">
<title>router_l11_dp2&#45;&gt;expert11_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334438.47,-171.15C334458.24,-173.37 334477.94,-175.36 334497,-176.98 334809.14,-203.5 334888.47,-211.11 335201.5,-198.98 335327.78,-194.09 335361.1,-201.89 335485,-176.98 335499.86,-174 335515.42,-169.77 335530.29,-165.16"/>
<polygon fill="black" stroke="black" points="335531.49,-168.45 335539.95,-162.09 335529.36,-161.78 335531.49,-168.45"/>
<text text-anchor="middle" x="335180" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l11_dp2 -->
<g id="node1125" class="node">
<title>expert12_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="335476.5,-161.98 335247.5,-161.98 335247.5,-109.98 335476.5,-109.98 335476.5,-161.98"/>
<text text-anchor="middle" x="335362" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L11</text>
<text text-anchor="middle" x="335362" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="335362" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="335362" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert12_l11_dp2 -->
<g id="edge1880" class="edge">
<title>router_l11_dp2&#45;&gt;expert12_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334438.06,-177.01C334501.42,-186.11 334569.87,-194.4 334633.5,-198.98 334767.57,-208.63 335105.73,-200.95 335238,-176.98 335253.37,-174.2 335269.45,-169.94 335284.75,-165.21"/>
<polygon fill="black" stroke="black" points="335286.21,-168.41 335294.67,-162.04 335284.08,-161.75 335286.21,-168.41"/>
<text text-anchor="middle" x="334655" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l11_dp2 -->
<g id="node1126" class="node">
<title>expert13_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="335229.5,-161.98 335000.5,-161.98 335000.5,-109.98 335229.5,-109.98 335229.5,-161.98"/>
<text text-anchor="middle" x="335115" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L11</text>
<text text-anchor="middle" x="335115" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="335115" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="335115" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert13_l11_dp2 -->
<g id="edge1881" class="edge">
<title>router_l11_dp2&#45;&gt;expert13_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334414.82,-177.03C334548.76,-197.17 334724.14,-214.16 334879.5,-198.98 334931.5,-193.9 334988.1,-179.07 335032.79,-165.08"/>
<polygon fill="black" stroke="black" points="335033.95,-168.38 335042.42,-162.01 335031.83,-161.71 335033.95,-168.38"/>
<text text-anchor="middle" x="334858" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l11_dp2 -->
<g id="node1127" class="node">
<title>expert14_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="334982.5,-161.98 334753.5,-161.98 334753.5,-109.98 334982.5,-109.98 334982.5,-161.98"/>
<text text-anchor="middle" x="334868" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L11</text>
<text text-anchor="middle" x="334868" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="334868" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="334868" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert14_l11_dp2 -->
<g id="edge1882" class="edge">
<title>router_l11_dp2&#45;&gt;expert14_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334420.51,-176.99C334538.76,-195.86 334671.44,-211.57 334729.5,-198.98 334758.93,-192.6 334789.61,-179.41 334814.6,-166.74"/>
<polygon fill="black" stroke="black" points="334816.26,-169.82 334823.53,-162.11 334813.04,-163.61 334816.26,-169.82"/>
<text text-anchor="middle" x="334708" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l11_dp2 -->
<g id="node1128" class="node">
<title>expert15_l11_dp2</title>
<polygon fill="lightgreen" stroke="black" points="334735.5,-161.98 334506.5,-161.98 334506.5,-109.98 334735.5,-109.98 334735.5,-161.98"/>
<text text-anchor="middle" x="334621" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L11</text>
<text text-anchor="middle" x="334621" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="334621" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="334621" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp2&#45;&gt;expert15_l11_dp2 -->
<g id="edge1883" class="edge">
<title>router_l11_dp2&#45;&gt;expert15_l11_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M334394.95,-135.98C334429.38,-135.98 334464.32,-135.98 334496.11,-135.98"/>
<polygon fill="black" stroke="black" points="334496.32,-139.48 334506.32,-135.98 334496.32,-132.48 334496.32,-139.48"/>
<text text-anchor="middle" x="334476.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l11_dp2 -->
<g id="node1129" class="node">
<title>expert_agg_l11_dp2</title>
<polygon fill="lightyellow" stroke="black" points="338971.57,-176.98 338577.74,-176.98 338476.43,-94.98 338870.26,-94.98 338971.57,-176.98"/>
<text text-anchor="middle" x="338724" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L11</text>
<text text-anchor="middle" x="338724" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="338724" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1884" class="edge">
<title>expert0_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M338440.66,-135.98C338466.06,-135.98 338491.47,-135.98 338516.87,-135.98"/>
<polygon fill="black" stroke="black" points="338516.99,-139.48 338526.99,-135.98 338516.99,-132.48 338516.99,-139.48"/>
</g>
<!-- expert1_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1885" class="edge">
<title>expert1_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M338134.24,-162.02C338157.4,-171.57 338184.96,-181.22 338211,-185.98 338261.06,-195.15 338389.3,-190.41 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert2_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1886" class="edge">
<title>expert2_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M337887.24,-162.02C337910.4,-171.57 337937.96,-181.22 337964,-185.98 338016.02,-195.51 338387.31,-190.59 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert3_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1887" class="edge">
<title>expert3_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M337640.24,-162.02C337663.4,-171.57 337690.96,-181.22 337717,-185.98 337796.02,-200.45 338359.97,-192.97 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert4_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1888" class="edge">
<title>expert4_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M337393.24,-162.02C337416.4,-171.57 337443.96,-181.22 337470,-185.98 337523.01,-195.69 338386.31,-190.67 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert5_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1889" class="edge">
<title>expert5_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M337146.24,-162.02C337169.4,-171.57 337196.96,-181.22 337223,-185.98 337289.5,-198.16 338372.64,-191.87 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert6_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1890" class="edge">
<title>expert6_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M336899.24,-162.02C336922.4,-171.57 336949.96,-181.22 336976,-185.98 337056,-200.63 338358.97,-193.06 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert7_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1891" class="edge">
<title>expert7_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M336652.24,-162.02C336675.4,-171.57 336702.96,-181.22 336729,-185.98 336775.75,-194.54 338392.65,-190.12 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert8_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1892" class="edge">
<title>expert8_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M336405.24,-162.02C336428.4,-171.57 336455.96,-181.22 336482,-185.98 336535.5,-195.78 338385.82,-190.72 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert9_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1893" class="edge">
<title>expert9_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M336158.24,-162.02C336181.4,-171.57 336208.96,-181.22 336235,-185.98 336295.25,-197.01 338378.98,-191.31 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert10_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1894" class="edge">
<title>expert10_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M335911.24,-162.02C335934.4,-171.57 335961.96,-181.22 335988,-185.98 336055,-198.25 338372.15,-191.91 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert11_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1895" class="edge">
<title>expert11_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M335664.24,-162.02C335687.4,-171.57 335714.96,-181.22 335741,-185.98 335814.75,-199.48 338365.31,-192.51 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert12_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1896" class="edge">
<title>expert12_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M335417.24,-162.02C335440.4,-171.57 335467.96,-181.22 335494,-185.98 335574.49,-200.72 338358.48,-193.1 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert13_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1897" class="edge">
<title>expert13_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M335170.24,-162.02C335193.4,-171.57 335220.96,-181.22 335247,-185.98 335290.62,-193.97 338395.82,-189.84 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert14_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1898" class="edge">
<title>expert14_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M334923.24,-162.02C334946.4,-171.57 334973.96,-181.22 335000,-185.98 335047,-194.59 338392.4,-190.14 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- expert15_l11_dp2&#45;&gt;expert_agg_l11_dp2 -->
<g id="edge1899" class="edge">
<title>expert15_l11_dp2&#45;&gt;expert_agg_l11_dp2</title>
<path fill="none" stroke="black" d="M334676.24,-162.02C334699.4,-171.57 334726.96,-181.22 334753,-185.98 334803.37,-195.2 338388.98,-190.44 338440,-185.98 338478.11,-182.65 338518.78,-176.86 338557.08,-170.36"/>
<polygon fill="black" stroke="black" points="338558.02,-173.75 338567.29,-168.6 338556.84,-166.85 338558.02,-173.75"/>
</g>
<!-- layer11_output_dp2 -->
<g id="node1130" class="node">
<title>layer11_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="339176" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="339176" y="-144.48" font-family="Arial" font-size="10.00">Layer 11 Output</text>
<text text-anchor="middle" x="339176" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="339176" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l11_dp2&#45;&gt;layer11_output_dp2 -->
<g id="edge1900" class="edge">
<title>expert_agg_l11_dp2&#45;&gt;layer11_output_dp2</title>
<path fill="none" stroke="black" d="M338921.31,-135.98C338946.49,-135.98 338971.66,-135.98 338996.84,-135.98"/>
<polygon fill="black" stroke="black" points="338996.87,-139.48 339006.87,-135.98 338996.87,-132.48 338996.87,-139.48"/>
</g>
<!-- attn_input_l12_dp2 -->
<g id="node1131" class="node">
<title>attn_input_l12_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="339549" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="339549" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L12</text>
<text text-anchor="middle" x="339549" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="339549" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer11_output_dp2&#45;&gt;attn_input_l12_dp2 -->
<g id="edge1901" class="edge">
<title>layer11_output_dp2&#45;&gt;attn_input_l12_dp2</title>
<path fill="none" stroke="black" d="M339345.01,-135.98C339353.23,-135.98 339361.44,-135.98 339369.66,-135.98"/>
<polygon fill="black" stroke="black" points="339369.68,-139.48 339379.68,-135.98 339369.68,-132.48 339369.68,-139.48"/>
</g>
<!-- attn_tp0_l12_dp2 -->
<g id="node1132" class="node">
<title>attn_tp0_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="340847,-161.98 340587,-161.98 340587,-109.98 340847,-109.98 340847,-161.98"/>
<text text-anchor="middle" x="340717" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L12</text>
<text text-anchor="middle" x="340717" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="340717" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="340717" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp2&#45;&gt;attn_tp0_l12_dp2 -->
<g id="edge1902" class="edge">
<title>attn_input_l12_dp2&#45;&gt;attn_tp0_l12_dp2</title>
<path fill="none" stroke="black" d="M339632.52,-161.26C339669.12,-171.09 339712.81,-181.13 339753,-185.98 339798,-191.42 340524.27,-193.33 340569,-185.98 340594.4,-181.81 340621.31,-173.85 340645.12,-165.5"/>
<polygon fill="black" stroke="black" points="340646.55,-168.71 340654.78,-162.03 340644.18,-162.12 340646.55,-168.71"/>
</g>
<!-- attn_tp1_l12_dp2 -->
<g id="node1133" class="node">
<title>attn_tp1_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="340569,-161.98 340309,-161.98 340309,-109.98 340569,-109.98 340569,-161.98"/>
<text text-anchor="middle" x="340439" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L12</text>
<text text-anchor="middle" x="340439" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="340439" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="340439" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp2&#45;&gt;attn_tp1_l12_dp2 -->
<g id="edge1903" class="edge">
<title>attn_input_l12_dp2&#45;&gt;attn_tp1_l12_dp2</title>
<path fill="none" stroke="black" d="M339632.52,-161.26C339669.12,-171.09 339712.81,-181.13 339753,-185.98 339812.35,-193.15 340232.01,-195.68 340291,-185.98 340316.4,-181.81 340343.31,-173.85 340367.12,-165.5"/>
<polygon fill="black" stroke="black" points="340368.55,-168.71 340376.78,-162.03 340366.18,-162.12 340368.55,-168.71"/>
</g>
<!-- attn_tp2_l12_dp2 -->
<g id="node1134" class="node">
<title>attn_tp2_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="340291,-161.98 340031,-161.98 340031,-109.98 340291,-109.98 340291,-161.98"/>
<text text-anchor="middle" x="340161" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L12</text>
<text text-anchor="middle" x="340161" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="340161" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="340161" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp2&#45;&gt;attn_tp2_l12_dp2 -->
<g id="edge1904" class="edge">
<title>attn_input_l12_dp2&#45;&gt;attn_tp2_l12_dp2</title>
<path fill="none" stroke="black" d="M339632.52,-161.26C339669.12,-171.09 339712.81,-181.13 339753,-185.98 339810.36,-192.91 339955.99,-195.35 340013,-185.98 340038.4,-181.81 340065.31,-173.85 340089.12,-165.5"/>
<polygon fill="black" stroke="black" points="340090.55,-168.71 340098.78,-162.03 340088.18,-162.12 340090.55,-168.71"/>
</g>
<!-- attn_tp3_l12_dp2 -->
<g id="node1135" class="node">
<title>attn_tp3_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="340013,-161.98 339753,-161.98 339753,-109.98 340013,-109.98 340013,-161.98"/>
<text text-anchor="middle" x="339883" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L12</text>
<text text-anchor="middle" x="339883" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="339883" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="339883" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp2&#45;&gt;attn_tp3_l12_dp2 -->
<g id="edge1905" class="edge">
<title>attn_input_l12_dp2&#45;&gt;attn_tp3_l12_dp2</title>
<path fill="none" stroke="black" d="M339718.28,-135.98C339726.35,-135.98 339734.42,-135.98 339742.49,-135.98"/>
<polygon fill="black" stroke="black" points="339742.7,-139.48 339752.7,-135.98 339742.7,-132.48 339742.7,-139.48"/>
</g>
<!-- allreduce_l12_dp2 -->
<g id="node1136" class="node">
<title>allreduce_l12_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="341051" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="341051" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L12</text>
<text text-anchor="middle" x="341051" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="341051" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l12_dp2&#45;&gt;allreduce_l12_dp2 -->
<g id="edge1906" class="edge">
<title>attn_tp0_l12_dp2&#45;&gt;allreduce_l12_dp2</title>
<path fill="none" stroke="black" d="M340847.14,-135.98C340855.35,-135.98 340863.56,-135.98 340871.77,-135.98"/>
<polygon fill="black" stroke="black" points="340871.78,-139.48 340881.78,-135.98 340871.78,-132.48 340871.78,-139.48"/>
</g>
<!-- attn_tp1_l12_dp2&#45;&gt;allreduce_l12_dp2 -->
<g id="edge1907" class="edge">
<title>attn_tp1_l12_dp2&#45;&gt;allreduce_l12_dp2</title>
<path fill="none" stroke="black" d="M340501.22,-162.03C340527.24,-171.59 340558.1,-181.23 340587,-185.98 340644.01,-195.35 340789.64,-192.91 340847,-185.98 340883.57,-181.57 340923.05,-172.85 340957.44,-163.91"/>
<polygon fill="black" stroke="black" points="340958.7,-167.2 340967.47,-161.26 340956.91,-160.43 340958.7,-167.2"/>
</g>
<!-- attn_tp2_l12_dp2&#45;&gt;allreduce_l12_dp2 -->
<g id="edge1908" class="edge">
<title>attn_tp2_l12_dp2&#45;&gt;allreduce_l12_dp2</title>
<path fill="none" stroke="black" d="M340223.22,-162.03C340249.24,-171.59 340280.1,-181.23 340309,-185.98 340367.98,-195.68 340787.65,-193.15 340847,-185.98 340883.57,-181.57 340923.05,-172.85 340957.44,-163.91"/>
<polygon fill="black" stroke="black" points="340958.7,-167.2 340967.47,-161.26 340956.91,-160.43 340958.7,-167.2"/>
</g>
<!-- attn_tp3_l12_dp2&#45;&gt;allreduce_l12_dp2 -->
<g id="edge1909" class="edge">
<title>attn_tp3_l12_dp2&#45;&gt;allreduce_l12_dp2</title>
<path fill="none" stroke="black" d="M339945.22,-162.03C339971.24,-171.59 340002.1,-181.23 340031,-185.98 340075.73,-193.33 340801.99,-191.42 340847,-185.98 340883.57,-181.57 340923.05,-172.85 340957.44,-163.91"/>
<polygon fill="black" stroke="black" points="340958.7,-167.2 340967.47,-161.26 340956.91,-160.43 340958.7,-167.2"/>
</g>
<!-- moe_input_l12_dp2 -->
<g id="node1137" class="node">
<title>moe_input_l12_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="341424" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="341424" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L12</text>
<text text-anchor="middle" x="341424" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="341424" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l12_dp2&#45;&gt;moe_input_l12_dp2 -->
<g id="edge1910" class="edge">
<title>allreduce_l12_dp2&#45;&gt;moe_input_l12_dp2</title>
<path fill="none" stroke="black" d="M341220.01,-135.98C341228.23,-135.98 341236.44,-135.98 341244.66,-135.98"/>
<polygon fill="black" stroke="black" points="341244.68,-139.48 341254.68,-135.98 341244.68,-132.48 341244.68,-139.48"/>
</g>
<!-- router_l12_dp2 -->
<g id="node1138" class="node">
<title>router_l12_dp2</title>
<polygon fill="lightyellow" stroke="black" points="342123.57,-176.98 341729.74,-176.98 341628.43,-94.98 342022.26,-94.98 342123.57,-176.98"/>
<text text-anchor="middle" x="341876" y="-144.48" font-family="Arial" font-size="10.00">Router L12</text>
<text text-anchor="middle" x="341876" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="341876" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l12_dp2&#45;&gt;router_l12_dp2 -->
<g id="edge1911" class="edge">
<title>moe_input_l12_dp2&#45;&gt;router_l12_dp2</title>
<path fill="none" stroke="black" d="M341593.06,-135.98C341618.34,-135.98 341643.63,-135.98 341668.92,-135.98"/>
<polygon fill="black" stroke="black" points="341668.99,-139.48 341678.99,-135.98 341668.99,-132.48 341668.99,-139.48"/>
</g>
<!-- expert0_l12_dp2 -->
<g id="node1139" class="node">
<title>expert0_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="346129.5,-161.98 345900.5,-161.98 345900.5,-109.98 346129.5,-109.98 346129.5,-161.98"/>
<text text-anchor="middle" x="346015" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L12</text>
<text text-anchor="middle" x="346015" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="346015" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="346015" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert0_l12_dp2 -->
<g id="edge1912" class="edge">
<title>router_l12_dp2&#45;&gt;expert0_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.74,-171.32C342138.09,-173.59 342159.41,-175.53 342180,-176.98 342943.79,-230.71 344859.82,-196.54 345625.5,-198.98 345743.9,-199.36 345775.17,-201.54 345891,-176.98 345905.65,-173.88 345920.99,-169.65 345935.69,-165.08"/>
<polygon fill="black" stroke="black" points="345936.78,-168.4 345945.25,-162.03 345934.66,-161.73 345936.78,-168.4"/>
<text text-anchor="middle" x="345647" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l12_dp2 -->
<g id="node1140" class="node">
<title>expert1_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="345882.5,-161.98 345653.5,-161.98 345653.5,-109.98 345882.5,-109.98 345882.5,-161.98"/>
<text text-anchor="middle" x="345768" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L12</text>
<text text-anchor="middle" x="345768" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="345768" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="345768" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert1_l12_dp2 -->
<g id="edge1913" class="edge">
<title>router_l12_dp2&#45;&gt;expert1_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.74,-171.31C342138.09,-173.58 342159.41,-175.53 342180,-176.98 342885.7,-226.81 344656.04,-196.54 345363.5,-198.98 345488.55,-199.41 345521.59,-202.54 345644,-176.98 345658.75,-173.9 345674.19,-169.66 345688.98,-165.07"/>
<polygon fill="black" stroke="black" points="345690.12,-168.37 345698.59,-162 345688,-161.7 345690.12,-168.37"/>
<text text-anchor="middle" x="345385" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l12_dp2 -->
<g id="node1141" class="node">
<title>expert2_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="345635.5,-161.98 345406.5,-161.98 345406.5,-109.98 345635.5,-109.98 345635.5,-161.98"/>
<text text-anchor="middle" x="345521" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L12</text>
<text text-anchor="middle" x="345521" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="345521" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="345521" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert2_l12_dp2 -->
<g id="edge1914" class="edge">
<title>router_l12_dp2&#45;&gt;expert2_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.74,-171.29C342138.1,-173.57 342159.41,-175.52 342180,-176.98 342824.51,-222.7 344441.37,-196.54 345087.5,-198.98 345225.4,-199.5 345261.87,-204.49 345397,-176.98 345411.85,-173.96 345427.41,-169.72 345442.28,-165.1"/>
<polygon fill="black" stroke="black" points="345443.47,-168.39 345451.94,-162.02 345441.35,-161.72 345443.47,-168.39"/>
<text text-anchor="middle" x="345109" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l12_dp2 -->
<g id="node1142" class="node">
<title>expert3_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="345388.5,-161.98 345159.5,-161.98 345159.5,-109.98 345388.5,-109.98 345388.5,-161.98"/>
<text text-anchor="middle" x="345274" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L12</text>
<text text-anchor="middle" x="345274" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="345274" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="345274" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert3_l12_dp2 -->
<g id="edge1915" class="edge">
<title>router_l12_dp2&#45;&gt;expert3_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.74,-171.27C342138.1,-173.55 342159.41,-175.51 342180,-176.98 342756.88,-218.16 344204.15,-196.54 344782.5,-198.98 344946.12,-199.67 344989.43,-208.45 345150,-176.98 345165.06,-174.03 345180.82,-169.78 345195.86,-165.11"/>
<polygon fill="black" stroke="black" points="345197.16,-168.37 345205.63,-162 345195.04,-161.7 345197.16,-168.37"/>
<text text-anchor="middle" x="344804" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l12_dp2 -->
<g id="node1143" class="node">
<title>expert4_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="345141.5,-161.98 344912.5,-161.98 344912.5,-109.98 345141.5,-109.98 345141.5,-161.98"/>
<text text-anchor="middle" x="345027" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L12</text>
<text text-anchor="middle" x="345027" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="345027" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="345027" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert4_l12_dp2 -->
<g id="edge1916" class="edge">
<title>router_l12_dp2&#45;&gt;expert4_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.74,-171.24C342138.1,-173.53 342159.42,-175.5 342180,-176.98 342676.18,-212.74 343921.04,-196.54 344418.5,-198.98 344634.05,-200.04 344691.1,-216.54 344903,-176.98 344918.27,-174.13 344934.24,-169.87 344949.45,-165.16"/>
<polygon fill="black" stroke="black" points="344950.86,-168.39 344959.32,-162.01 344948.73,-161.72 344950.86,-168.39"/>
<text text-anchor="middle" x="344440" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l12_dp2 -->
<g id="node1144" class="node">
<title>expert5_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="344894.5,-161.98 344665.5,-161.98 344665.5,-109.98 344894.5,-109.98 344894.5,-161.98"/>
<text text-anchor="middle" x="344780" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L12</text>
<text text-anchor="middle" x="344780" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="344780" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="344780" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert5_l12_dp2 -->
<g id="edge1917" class="edge">
<title>router_l12_dp2&#45;&gt;expert5_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342021.67,-176.99C342060.3,-186.08 342102.21,-194.39 342141.5,-198.98 342160.48,-201.2 342165.39,-199.07 342184.5,-198.98 342459.12,-197.76 344385.07,-221.85 344656,-176.98 344671.93,-174.34 344688.59,-170 344704.35,-165.11"/>
<polygon fill="black" stroke="black" points="344705.58,-168.39 344714.03,-162 344703.44,-161.72 344705.58,-168.39"/>
<text text-anchor="middle" x="342163" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l12_dp2 -->
<g id="node1145" class="node">
<title>expert6_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="344647.5,-161.98 344418.5,-161.98 344418.5,-109.98 344647.5,-109.98 344647.5,-161.98"/>
<text text-anchor="middle" x="344533" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L12</text>
<text text-anchor="middle" x="344533" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="344533" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="344533" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert6_l12_dp2 -->
<g id="edge1918" class="edge">
<title>router_l12_dp2&#45;&gt;expert6_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.75,-171.18C342138.1,-173.48 342159.42,-175.47 342180,-176.98 342579.29,-206.3 343581.27,-209.27 343981.5,-198.98 344171.69,-194.09 344222.01,-212.05 344409,-176.98 344424.26,-174.12 344440.24,-169.85 344455.45,-165.14"/>
<polygon fill="black" stroke="black" points="344456.85,-168.37 344465.32,-161.99 344454.73,-161.7 344456.85,-168.37"/>
<text text-anchor="middle" x="343960" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l12_dp2 -->
<g id="node1146" class="node">
<title>expert7_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="344400.5,-161.98 344171.5,-161.98 344171.5,-109.98 344400.5,-109.98 344400.5,-161.98"/>
<text text-anchor="middle" x="344286" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L12</text>
<text text-anchor="middle" x="344286" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="344286" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="344286" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert7_l12_dp2 -->
<g id="edge1919" class="edge">
<title>router_l12_dp2&#45;&gt;expert7_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342048.37,-177C342093.98,-186.1 342143.37,-194.39 342189.5,-198.98 342208.52,-200.87 342213.39,-199.09 342232.5,-198.98 342446.9,-197.76 343950.52,-212.28 344162,-176.98 344177.83,-174.34 344194.4,-170.02 344210.07,-165.16"/>
<polygon fill="black" stroke="black" points="344211.25,-168.46 344219.7,-162.07 344209.11,-161.79 344211.25,-168.46"/>
<text text-anchor="middle" x="342211" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l12_dp2 -->
<g id="node1147" class="node">
<title>expert8_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="344153.5,-161.98 343924.5,-161.98 343924.5,-109.98 344153.5,-109.98 344153.5,-161.98"/>
<text text-anchor="middle" x="344039" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L12</text>
<text text-anchor="middle" x="344039" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="344039" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="344039" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert8_l12_dp2 -->
<g id="edge1920" class="edge">
<title>router_l12_dp2&#45;&gt;expert8_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342116.34,-171.04C342137.83,-173.37 342159.29,-175.42 342180,-176.98 342475.97,-199.38 343218.79,-207.15 343515.5,-198.98 343693.26,-194.09 343740.28,-210.07 343915,-176.98 343930.17,-174.11 343946.04,-169.87 343961.16,-165.18"/>
<polygon fill="black" stroke="black" points="343962.52,-168.42 343970.98,-162.05 343960.39,-161.75 343962.52,-168.42"/>
<text text-anchor="middle" x="343494" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l12_dp2 -->
<g id="node1148" class="node">
<title>expert9_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="343906.5,-161.98 343677.5,-161.98 343677.5,-109.98 343906.5,-109.98 343906.5,-161.98"/>
<text text-anchor="middle" x="343792" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L12</text>
<text text-anchor="middle" x="343792" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="343792" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="343792" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert9_l12_dp2 -->
<g id="edge1921" class="edge">
<title>router_l12_dp2&#45;&gt;expert9_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342075.02,-177C342127.62,-186.1 342184.5,-194.4 342237.5,-198.98 342256.54,-200.63 342261.39,-199.13 342280.5,-198.98 342588.86,-196.54 343363.95,-228.42 343668,-176.98 343683.83,-174.3 343700.39,-169.97 343716.06,-165.1"/>
<polygon fill="black" stroke="black" points="343717.24,-168.4 343725.69,-162.01 343715.1,-161.74 343717.24,-168.4"/>
<text text-anchor="middle" x="342259" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l12_dp2 -->
<g id="node1149" class="node">
<title>expert10_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="343659.5,-161.98 343430.5,-161.98 343430.5,-109.98 343659.5,-109.98 343659.5,-161.98"/>
<text text-anchor="middle" x="343545" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L12</text>
<text text-anchor="middle" x="343545" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="343545" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="343545" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert10_l12_dp2 -->
<g id="edge1922" class="edge">
<title>router_l12_dp2&#45;&gt;expert10_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342115.94,-170.8C342137.57,-173.19 342159.16,-175.31 342180,-176.98 342577.73,-208.83 342678.69,-211.74 343077.5,-198.98 343230.4,-194.09 343270.82,-206.12 343421,-176.98 343436.06,-174.06 343451.83,-169.82 343466.87,-165.16"/>
<polygon fill="black" stroke="black" points="343468.17,-168.42 343476.64,-162.04 343466.05,-161.75 343468.17,-168.42"/>
<text text-anchor="middle" x="343056" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l12_dp2 -->
<g id="node1150" class="node">
<title>expert11_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="343412.5,-161.98 343183.5,-161.98 343183.5,-109.98 343412.5,-109.98 343412.5,-161.98"/>
<text text-anchor="middle" x="343298" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L12</text>
<text text-anchor="middle" x="343298" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="343298" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="343298" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert11_l12_dp2 -->
<g id="edge1923" class="edge">
<title>router_l12_dp2&#45;&gt;expert11_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342101.65,-177.01C342161.23,-186.11 342225.61,-194.4 342285.5,-198.98 342482.43,-214.04 342979.43,-210.92 343174,-176.98 343189.72,-174.24 343206.17,-169.91 343221.76,-165.06"/>
<polygon fill="black" stroke="black" points="343222.89,-168.38 343231.35,-161.99 343220.75,-161.71 343222.89,-168.38"/>
<text text-anchor="middle" x="342307" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l12_dp2 -->
<g id="node1151" class="node">
<title>expert12_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="343165.5,-161.98 342936.5,-161.98 342936.5,-109.98 343165.5,-109.98 343165.5,-161.98"/>
<text text-anchor="middle" x="343051" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L12</text>
<text text-anchor="middle" x="343051" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="343051" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="343051" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert12_l12_dp2 -->
<g id="edge1924" class="edge">
<title>router_l12_dp2&#45;&gt;expert12_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342115.57,-170.29C342137.33,-172.8 342159.05,-175.09 342180,-176.98 342180,-176.98 342927,-176.98 342927,-176.98 342941.65,-173.9 342957,-169.69 342971.7,-165.12"/>
<polygon fill="black" stroke="black" points="342972.79,-168.45 342981.26,-162.08 342970.67,-161.78 342972.79,-168.45"/>
<text text-anchor="middle" x="342674" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l12_dp2 -->
<g id="node1152" class="node">
<title>expert13_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="342918.5,-161.98 342689.5,-161.98 342689.5,-109.98 342918.5,-109.98 342918.5,-161.98"/>
<text text-anchor="middle" x="342804" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L12</text>
<text text-anchor="middle" x="342804" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="342804" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="342804" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert13_l12_dp2 -->
<g id="edge1925" class="edge">
<title>router_l12_dp2&#45;&gt;expert13_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342122.89,-176.28C342190.94,-185.66 342264.91,-194.28 342333.5,-198.98 342448.39,-206.86 342553.97,-201.98 342680,-176.98 342694.96,-174.01 342710.62,-169.78 342725.58,-165.14"/>
<polygon fill="black" stroke="black" points="342726.83,-168.41 342735.29,-162.04 342724.7,-161.74 342726.83,-168.41"/>
<text text-anchor="middle" x="342355" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l12_dp2 -->
<g id="node1153" class="node">
<title>expert14_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="342671.5,-161.98 342442.5,-161.98 342442.5,-109.98 342671.5,-109.98 342671.5,-161.98"/>
<text text-anchor="middle" x="342557" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L12</text>
<text text-anchor="middle" x="342557" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="342557" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="342557" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert14_l12_dp2 -->
<g id="edge1926" class="edge">
<title>router_l12_dp2&#45;&gt;expert14_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342101.44,-176.99C342224.58,-196.39 342364.01,-212.63 342424.5,-198.98 342452.7,-192.62 342481.94,-179.52 342505.75,-166.9"/>
<polygon fill="black" stroke="black" points="342507.48,-169.94 342514.6,-162.1 342504.14,-163.79 342507.48,-169.94"/>
<text text-anchor="middle" x="342403" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l12_dp2 -->
<g id="node1154" class="node">
<title>expert15_l12_dp2</title>
<polygon fill="lightgreen" stroke="black" points="342418.5,-161.98 342189.5,-161.98 342189.5,-109.98 342418.5,-109.98 342418.5,-161.98"/>
<text text-anchor="middle" x="342304" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L12</text>
<text text-anchor="middle" x="342304" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="342304" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="342304" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp2&#45;&gt;expert15_l12_dp2 -->
<g id="edge1927" class="edge">
<title>router_l12_dp2&#45;&gt;expert15_l12_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M342073.09,-135.98C342109.17,-135.98 342145.91,-135.98 342179.14,-135.98"/>
<polygon fill="black" stroke="black" points="342179.34,-139.48 342189.34,-135.98 342179.34,-132.48 342179.34,-139.48"/>
<text text-anchor="middle" x="342156.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l12_dp2 -->
<g id="node1155" class="node">
<title>expert_agg_l12_dp2</title>
<polygon fill="lightyellow" stroke="black" points="346660.57,-176.98 346266.74,-176.98 346165.43,-94.98 346559.26,-94.98 346660.57,-176.98"/>
<text text-anchor="middle" x="346413" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L12</text>
<text text-anchor="middle" x="346413" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="346413" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1928" class="edge">
<title>expert0_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M346129.66,-135.98C346155.06,-135.98 346180.47,-135.98 346205.87,-135.98"/>
<polygon fill="black" stroke="black" points="346205.99,-139.48 346215.99,-135.98 346205.99,-132.48 346205.99,-139.48"/>
</g>
<!-- expert1_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1929" class="edge">
<title>expert1_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M345823.24,-162.02C345846.4,-171.57 345873.96,-181.22 345900,-185.98 345950.06,-195.15 346078.3,-190.41 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert2_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1930" class="edge">
<title>expert2_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M345576.24,-162.02C345599.4,-171.57 345626.96,-181.22 345653,-185.98 345705.02,-195.51 346076.31,-190.59 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert3_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1931" class="edge">
<title>expert3_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M345329.24,-162.02C345352.4,-171.57 345379.96,-181.22 345406,-185.98 345485.02,-200.45 346048.97,-192.97 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert4_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1932" class="edge">
<title>expert4_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M345082.24,-162.02C345105.4,-171.57 345132.96,-181.22 345159,-185.98 345212.01,-195.69 346075.31,-190.67 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert5_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1933" class="edge">
<title>expert5_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M344835.24,-162.02C344858.4,-171.57 344885.96,-181.22 344912,-185.98 344978.5,-198.16 346061.64,-191.87 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert6_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1934" class="edge">
<title>expert6_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M344588.24,-162.02C344611.4,-171.57 344638.96,-181.22 344665,-185.98 344745,-200.63 346047.97,-193.06 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert7_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1935" class="edge">
<title>expert7_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M344341.24,-162.02C344364.4,-171.57 344391.96,-181.22 344418,-185.98 344464.75,-194.54 346081.65,-190.12 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert8_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1936" class="edge">
<title>expert8_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M344094.24,-162.02C344117.4,-171.57 344144.96,-181.22 344171,-185.98 344224.5,-195.78 346074.82,-190.72 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert9_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1937" class="edge">
<title>expert9_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M343847.24,-162.02C343870.4,-171.57 343897.96,-181.22 343924,-185.98 343984.25,-197.01 346067.98,-191.31 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert10_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1938" class="edge">
<title>expert10_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M343600.24,-162.02C343623.4,-171.57 343650.96,-181.22 343677,-185.98 343744,-198.25 346061.15,-191.91 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert11_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1939" class="edge">
<title>expert11_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M343353.24,-162.02C343376.4,-171.57 343403.96,-181.22 343430,-185.98 343503.75,-199.48 346054.31,-192.51 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert12_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1940" class="edge">
<title>expert12_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M343106.24,-162.02C343129.4,-171.57 343156.96,-181.22 343183,-185.98 343263.49,-200.72 346047.48,-193.1 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert13_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1941" class="edge">
<title>expert13_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M342859.24,-162.02C342882.4,-171.57 342909.96,-181.22 342936,-185.98 342979.62,-193.97 346084.82,-189.84 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert14_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1942" class="edge">
<title>expert14_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M342612.24,-162.02C342635.4,-171.57 342662.96,-181.22 342689,-185.98 342736,-194.59 346081.4,-190.14 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- expert15_l12_dp2&#45;&gt;expert_agg_l12_dp2 -->
<g id="edge1943" class="edge">
<title>expert15_l12_dp2&#45;&gt;expert_agg_l12_dp2</title>
<path fill="none" stroke="black" d="M342361.86,-162.02C342386.1,-171.58 342414.89,-181.22 342442,-185.98 342492.44,-194.84 346077.98,-190.44 346129,-185.98 346167.11,-182.65 346207.78,-176.86 346246.08,-170.36"/>
<polygon fill="black" stroke="black" points="346247.02,-173.75 346256.29,-168.6 346245.84,-166.85 346247.02,-173.75"/>
</g>
<!-- layer12_output_dp2 -->
<g id="node1156" class="node">
<title>layer12_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="346865" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="346865" y="-144.48" font-family="Arial" font-size="10.00">Layer 12 Output</text>
<text text-anchor="middle" x="346865" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="346865" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l12_dp2&#45;&gt;layer12_output_dp2 -->
<g id="edge1944" class="edge">
<title>expert_agg_l12_dp2&#45;&gt;layer12_output_dp2</title>
<path fill="none" stroke="black" d="M346610.31,-135.98C346635.49,-135.98 346660.66,-135.98 346685.84,-135.98"/>
<polygon fill="black" stroke="black" points="346685.87,-139.48 346695.87,-135.98 346685.87,-132.48 346685.87,-139.48"/>
</g>
<!-- attn_input_l13_dp2 -->
<g id="node1157" class="node">
<title>attn_input_l13_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="347238" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="347238" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L13</text>
<text text-anchor="middle" x="347238" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="347238" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer12_output_dp2&#45;&gt;attn_input_l13_dp2 -->
<g id="edge1945" class="edge">
<title>layer12_output_dp2&#45;&gt;attn_input_l13_dp2</title>
<path fill="none" stroke="black" d="M347034.01,-135.98C347042.23,-135.98 347050.44,-135.98 347058.66,-135.98"/>
<polygon fill="black" stroke="black" points="347058.68,-139.48 347068.68,-135.98 347058.68,-132.48 347058.68,-139.48"/>
</g>
<!-- attn_tp0_l13_dp2 -->
<g id="node1158" class="node">
<title>attn_tp0_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="348536,-161.98 348276,-161.98 348276,-109.98 348536,-109.98 348536,-161.98"/>
<text text-anchor="middle" x="348406" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L13</text>
<text text-anchor="middle" x="348406" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="348406" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="348406" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp2&#45;&gt;attn_tp0_l13_dp2 -->
<g id="edge1946" class="edge">
<title>attn_input_l13_dp2&#45;&gt;attn_tp0_l13_dp2</title>
<path fill="none" stroke="black" d="M347321.52,-161.26C347358.12,-171.09 347401.81,-181.13 347442,-185.98 347487,-191.42 348213.27,-193.33 348258,-185.98 348283.4,-181.81 348310.31,-173.85 348334.12,-165.5"/>
<polygon fill="black" stroke="black" points="348335.55,-168.71 348343.78,-162.03 348333.18,-162.12 348335.55,-168.71"/>
</g>
<!-- attn_tp1_l13_dp2 -->
<g id="node1159" class="node">
<title>attn_tp1_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="348258,-161.98 347998,-161.98 347998,-109.98 348258,-109.98 348258,-161.98"/>
<text text-anchor="middle" x="348128" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L13</text>
<text text-anchor="middle" x="348128" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="348128" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="348128" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp2&#45;&gt;attn_tp1_l13_dp2 -->
<g id="edge1947" class="edge">
<title>attn_input_l13_dp2&#45;&gt;attn_tp1_l13_dp2</title>
<path fill="none" stroke="black" d="M347321.52,-161.26C347358.12,-171.09 347401.81,-181.13 347442,-185.98 347501.35,-193.15 347921.01,-195.68 347980,-185.98 348005.4,-181.81 348032.31,-173.85 348056.12,-165.5"/>
<polygon fill="black" stroke="black" points="348057.55,-168.71 348065.78,-162.03 348055.18,-162.12 348057.55,-168.71"/>
</g>
<!-- attn_tp2_l13_dp2 -->
<g id="node1160" class="node">
<title>attn_tp2_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="347980,-161.98 347720,-161.98 347720,-109.98 347980,-109.98 347980,-161.98"/>
<text text-anchor="middle" x="347850" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L13</text>
<text text-anchor="middle" x="347850" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="347850" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="347850" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp2&#45;&gt;attn_tp2_l13_dp2 -->
<g id="edge1948" class="edge">
<title>attn_input_l13_dp2&#45;&gt;attn_tp2_l13_dp2</title>
<path fill="none" stroke="black" d="M347321.52,-161.26C347358.12,-171.09 347401.81,-181.13 347442,-185.98 347499.36,-192.91 347644.99,-195.35 347702,-185.98 347727.4,-181.81 347754.31,-173.85 347778.12,-165.5"/>
<polygon fill="black" stroke="black" points="347779.55,-168.71 347787.78,-162.03 347777.18,-162.12 347779.55,-168.71"/>
</g>
<!-- attn_tp3_l13_dp2 -->
<g id="node1161" class="node">
<title>attn_tp3_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="347702,-161.98 347442,-161.98 347442,-109.98 347702,-109.98 347702,-161.98"/>
<text text-anchor="middle" x="347572" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L13</text>
<text text-anchor="middle" x="347572" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="347572" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="347572" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp2&#45;&gt;attn_tp3_l13_dp2 -->
<g id="edge1949" class="edge">
<title>attn_input_l13_dp2&#45;&gt;attn_tp3_l13_dp2</title>
<path fill="none" stroke="black" d="M347407.28,-135.98C347415.35,-135.98 347423.42,-135.98 347431.49,-135.98"/>
<polygon fill="black" stroke="black" points="347431.7,-139.48 347441.7,-135.98 347431.7,-132.48 347431.7,-139.48"/>
</g>
<!-- allreduce_l13_dp2 -->
<g id="node1162" class="node">
<title>allreduce_l13_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="348740" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="348740" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L13</text>
<text text-anchor="middle" x="348740" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="348740" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l13_dp2&#45;&gt;allreduce_l13_dp2 -->
<g id="edge1950" class="edge">
<title>attn_tp0_l13_dp2&#45;&gt;allreduce_l13_dp2</title>
<path fill="none" stroke="black" d="M348536.14,-135.98C348544.35,-135.98 348552.56,-135.98 348560.77,-135.98"/>
<polygon fill="black" stroke="black" points="348560.78,-139.48 348570.78,-135.98 348560.78,-132.48 348560.78,-139.48"/>
</g>
<!-- attn_tp1_l13_dp2&#45;&gt;allreduce_l13_dp2 -->
<g id="edge1951" class="edge">
<title>attn_tp1_l13_dp2&#45;&gt;allreduce_l13_dp2</title>
<path fill="none" stroke="black" d="M348190.22,-162.03C348216.24,-171.59 348247.1,-181.23 348276,-185.98 348333.01,-195.35 348478.64,-192.91 348536,-185.98 348572.57,-181.57 348612.05,-172.85 348646.44,-163.91"/>
<polygon fill="black" stroke="black" points="348647.7,-167.2 348656.47,-161.26 348645.91,-160.43 348647.7,-167.2"/>
</g>
<!-- attn_tp2_l13_dp2&#45;&gt;allreduce_l13_dp2 -->
<g id="edge1952" class="edge">
<title>attn_tp2_l13_dp2&#45;&gt;allreduce_l13_dp2</title>
<path fill="none" stroke="black" d="M347912.22,-162.03C347938.24,-171.59 347969.1,-181.23 347998,-185.98 348056.98,-195.68 348476.65,-193.15 348536,-185.98 348572.57,-181.57 348612.05,-172.85 348646.44,-163.91"/>
<polygon fill="black" stroke="black" points="348647.7,-167.2 348656.47,-161.26 348645.91,-160.43 348647.7,-167.2"/>
</g>
<!-- attn_tp3_l13_dp2&#45;&gt;allreduce_l13_dp2 -->
<g id="edge1953" class="edge">
<title>attn_tp3_l13_dp2&#45;&gt;allreduce_l13_dp2</title>
<path fill="none" stroke="black" d="M347634.22,-162.03C347660.24,-171.59 347691.1,-181.23 347720,-185.98 347764.73,-193.33 348490.99,-191.42 348536,-185.98 348572.57,-181.57 348612.05,-172.85 348646.44,-163.91"/>
<polygon fill="black" stroke="black" points="348647.7,-167.2 348656.47,-161.26 348645.91,-160.43 348647.7,-167.2"/>
</g>
<!-- moe_input_l13_dp2 -->
<g id="node1163" class="node">
<title>moe_input_l13_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="349113" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="349113" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L13</text>
<text text-anchor="middle" x="349113" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="349113" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l13_dp2&#45;&gt;moe_input_l13_dp2 -->
<g id="edge1954" class="edge">
<title>allreduce_l13_dp2&#45;&gt;moe_input_l13_dp2</title>
<path fill="none" stroke="black" d="M348909.01,-135.98C348917.23,-135.98 348925.44,-135.98 348933.66,-135.98"/>
<polygon fill="black" stroke="black" points="348933.68,-139.48 348943.68,-135.98 348933.68,-132.48 348933.68,-139.48"/>
</g>
<!-- router_l13_dp2 -->
<g id="node1164" class="node">
<title>router_l13_dp2</title>
<polygon fill="lightyellow" stroke="black" points="349812.57,-176.98 349418.74,-176.98 349317.43,-94.98 349711.26,-94.98 349812.57,-176.98"/>
<text text-anchor="middle" x="349565" y="-144.48" font-family="Arial" font-size="10.00">Router L13</text>
<text text-anchor="middle" x="349565" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="349565" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l13_dp2&#45;&gt;router_l13_dp2 -->
<g id="edge1955" class="edge">
<title>moe_input_l13_dp2&#45;&gt;router_l13_dp2</title>
<path fill="none" stroke="black" d="M349282.06,-135.98C349307.34,-135.98 349332.63,-135.98 349357.92,-135.98"/>
<polygon fill="black" stroke="black" points="349357.99,-139.48 349367.99,-135.98 349357.99,-132.48 349357.99,-139.48"/>
</g>
<!-- expert0_l13_dp2 -->
<g id="node1165" class="node">
<title>expert0_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="353962.5,-161.98 353733.5,-161.98 353733.5,-109.98 353962.5,-109.98 353962.5,-161.98"/>
<text text-anchor="middle" x="353848" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L13</text>
<text text-anchor="middle" x="353848" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="353848" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="353848" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert0_l13_dp2 -->
<g id="edge1956" class="edge">
<title>router_l13_dp2&#45;&gt;expert0_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349798.11,-165.15C349845.33,-170 349894.7,-174.32 349941,-176.98 350708.08,-221.13 352630.15,-196.54 353398.5,-198.98 353543.49,-199.44 353581.85,-205.58 353724,-176.98 353738.86,-173.99 353754.42,-169.77 353769.29,-165.16"/>
<polygon fill="black" stroke="black" points="353770.49,-168.45 353778.95,-162.08 353768.36,-161.78 353770.49,-168.45"/>
<text text-anchor="middle" x="353420" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l13_dp2 -->
<g id="node1166" class="node">
<title>expert1_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="353715.5,-161.98 353486.5,-161.98 353486.5,-109.98 353715.5,-109.98 353715.5,-161.98"/>
<text text-anchor="middle" x="353601" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L13</text>
<text text-anchor="middle" x="353601" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="353601" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="353601" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert1_l13_dp2 -->
<g id="edge1957" class="edge">
<title>router_l13_dp2&#45;&gt;expert1_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349798.11,-165.13C349845.33,-169.98 349894.7,-174.3 349941,-176.98 350636.85,-217.26 352380.49,-196.54 353077.5,-198.98 353255.32,-199.61 353302.39,-210.65 353477,-176.98 353492.07,-174.08 353507.83,-169.84 353522.88,-165.19"/>
<polygon fill="black" stroke="black" points="353524.18,-168.44 353532.64,-162.07 353522.05,-161.77 353524.18,-168.44"/>
<text text-anchor="middle" x="353099" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l13_dp2 -->
<g id="node1167" class="node">
<title>expert2_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="353468.5,-161.98 353239.5,-161.98 353239.5,-109.98 353468.5,-109.98 353468.5,-161.98"/>
<text text-anchor="middle" x="353354" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L13</text>
<text text-anchor="middle" x="353354" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="353354" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="353354" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert2_l13_dp2 -->
<g id="edge1958" class="edge">
<title>router_l13_dp2&#45;&gt;expert2_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349797.86,-165.07C349845.16,-169.93 349894.62,-174.27 349941,-176.98 350549.2,-212.49 352073.26,-196.54 352682.5,-198.98 352926.03,-199.96 352990.47,-220.93 353230,-176.98 353245.27,-174.18 353261.25,-169.94 353276.46,-165.24"/>
<polygon fill="black" stroke="black" points="353277.87,-168.46 353286.33,-162.09 353275.74,-161.79 353277.87,-168.46"/>
<text text-anchor="middle" x="352704" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l13_dp2 -->
<g id="node1168" class="node">
<title>expert3_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="353221.5,-161.98 352992.5,-161.98 352992.5,-109.98 353221.5,-109.98 353221.5,-161.98"/>
<text text-anchor="middle" x="353107" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L13</text>
<text text-anchor="middle" x="353107" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="353107" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="353107" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert3_l13_dp2 -->
<g id="edge1959" class="edge">
<title>router_l13_dp2&#45;&gt;expert3_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349797.86,-164.99C349845.16,-169.87 349894.62,-174.23 349941,-176.98 350438.26,-206.51 351684.41,-205.83 352182.5,-198.98 352538.38,-194.09 352632.42,-238.39 352983,-176.98 352998.63,-174.25 353014.98,-169.94 353030.49,-165.13"/>
<polygon fill="black" stroke="black" points="353031.56,-168.46 353040.02,-162.08 353029.43,-161.79 353031.56,-168.46"/>
<text text-anchor="middle" x="352161" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l13_dp2 -->
<g id="node1169" class="node">
<title>expert4_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="352974.5,-161.98 352745.5,-161.98 352745.5,-109.98 352974.5,-109.98 352974.5,-161.98"/>
<text text-anchor="middle" x="352860" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L13</text>
<text text-anchor="middle" x="352860" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="352860" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="352860" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert4_l13_dp2 -->
<g id="edge1960" class="edge">
<title>router_l13_dp2&#45;&gt;expert4_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349710.67,-176.99C349749.3,-186.08 349791.21,-194.39 349830.5,-198.98 349849.48,-201.2 349854.39,-199.06 349873.5,-198.98 350191.56,-197.76 352422.18,-228.76 352736,-176.98 352751.93,-174.35 352768.6,-170.01 352784.35,-165.12"/>
<polygon fill="black" stroke="black" points="352785.58,-168.4 352794.03,-162.01 352783.44,-161.74 352785.58,-168.4"/>
<text text-anchor="middle" x="349852" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l13_dp2 -->
<g id="node1170" class="node">
<title>expert5_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="352727.5,-161.98 352498.5,-161.98 352498.5,-109.98 352727.5,-109.98 352727.5,-161.98"/>
<text text-anchor="middle" x="352613" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L13</text>
<text text-anchor="middle" x="352613" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="352613" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="352613" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert5_l13_dp2 -->
<g id="edge1961" class="edge">
<title>router_l13_dp2&#45;&gt;expert5_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349737.37,-177C349782.98,-186.1 349832.37,-194.39 349878.5,-198.98 349897.52,-200.87 349902.39,-199.06 349921.5,-198.98 350206.78,-197.76 352207.54,-223.55 352489,-176.98 352504.93,-174.35 352521.59,-170 352537.35,-165.11"/>
<polygon fill="black" stroke="black" points="352538.58,-168.39 352547.03,-162 352536.44,-161.73 352538.58,-168.39"/>
<text text-anchor="middle" x="349900" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l13_dp2 -->
<g id="node1171" class="node">
<title>expert6_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="352480.5,-161.98 352251.5,-161.98 352251.5,-109.98 352480.5,-109.98 352480.5,-161.98"/>
<text text-anchor="middle" x="352366" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L13</text>
<text text-anchor="middle" x="352366" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="352366" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="352366" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert6_l13_dp2 -->
<g id="edge1962" class="edge">
<title>router_l13_dp2&#45;&gt;expert6_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349764.02,-177C349816.62,-186.1 349873.5,-194.4 349926.5,-198.98 349945.54,-200.63 349950.39,-199.08 349969.5,-198.98 350222.01,-197.76 351992.9,-218.34 352242,-176.98 352257.93,-174.34 352274.59,-169.99 352290.35,-165.1"/>
<polygon fill="black" stroke="black" points="352291.58,-168.38 352300.03,-161.99 352289.44,-161.71 352291.58,-168.38"/>
<text text-anchor="middle" x="349948" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l13_dp2 -->
<g id="node1172" class="node">
<title>expert7_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="352233.5,-161.98 352004.5,-161.98 352004.5,-109.98 352233.5,-109.98 352233.5,-161.98"/>
<text text-anchor="middle" x="352119" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L13</text>
<text text-anchor="middle" x="352119" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="352119" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="352119" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert7_l13_dp2 -->
<g id="edge1963" class="edge">
<title>router_l13_dp2&#45;&gt;expert7_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349797.63,-164.74C349845,-169.64 349894.55,-174.08 349941,-176.98 350562.75,-215.83 350719.62,-209.48 351342.5,-198.98 351632.62,-194.09 351709.34,-227.94 351995,-176.98 352010.62,-174.2 352026.96,-169.87 352042.47,-165.05"/>
<polygon fill="black" stroke="black" points="352043.55,-168.38 352052.01,-162 352041.41,-161.72 352043.55,-168.38"/>
<text text-anchor="middle" x="351321" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l13_dp2 -->
<g id="node1173" class="node">
<title>expert8_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="351986.5,-161.98 351757.5,-161.98 351757.5,-109.98 351986.5,-109.98 351986.5,-161.98"/>
<text text-anchor="middle" x="351872" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L13</text>
<text text-anchor="middle" x="351872" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="351872" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="351872" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert8_l13_dp2 -->
<g id="edge1964" class="edge">
<title>router_l13_dp2&#45;&gt;expert8_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349790.65,-177.01C349850.23,-186.11 349914.61,-194.4 349974.5,-198.98 349993.55,-200.44 349998.39,-199.1 350017.5,-198.98 350209.79,-197.76 351558.35,-208.76 351748,-176.98 351763.83,-174.33 351780.39,-170.01 351796.07,-165.14"/>
<polygon fill="black" stroke="black" points="351797.24,-168.44 351805.7,-162.05 351795.11,-161.78 351797.24,-168.44"/>
<text text-anchor="middle" x="349996" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l13_dp2 -->
<g id="node1174" class="node">
<title>expert9_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="351739.5,-161.98 351510.5,-161.98 351510.5,-109.98 351739.5,-109.98 351739.5,-161.98"/>
<text text-anchor="middle" x="351625" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L13</text>
<text text-anchor="middle" x="351625" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="351625" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="351625" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert9_l13_dp2 -->
<g id="edge1965" class="edge">
<title>router_l13_dp2&#45;&gt;expert9_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349811.89,-176.28C349879.94,-185.66 349953.91,-194.28 350022.5,-198.98 350186.41,-210.22 351339,-204.35 351501,-176.98 351516.83,-174.31 351533.39,-169.98 351549.06,-165.11"/>
<polygon fill="black" stroke="black" points="351550.24,-168.41 351558.69,-162.02 351548.1,-161.74 351550.24,-168.41"/>
<text text-anchor="middle" x="350044" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l13_dp2 -->
<g id="node1175" class="node">
<title>expert10_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="351492.5,-161.98 351263.5,-161.98 351263.5,-109.98 351492.5,-109.98 351492.5,-161.98"/>
<text text-anchor="middle" x="351378" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L13</text>
<text text-anchor="middle" x="351378" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="351378" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="351378" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert10_l13_dp2 -->
<g id="edge1966" class="edge">
<title>router_l13_dp2&#45;&gt;expert10_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349807.08,-172.34C349890.36,-183.2 349984.33,-193.63 350070.5,-198.98 350201.77,-207.13 351124.36,-199.14 351254,-176.98 351269.73,-174.29 351286.19,-169.98 351301.78,-165.15"/>
<polygon fill="black" stroke="black" points="351302.9,-168.46 351311.36,-162.08 351300.77,-161.79 351302.9,-168.46"/>
<text text-anchor="middle" x="350092" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l13_dp2 -->
<g id="node1176" class="node">
<title>expert11_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="351245.5,-161.98 351016.5,-161.98 351016.5,-109.98 351245.5,-109.98 351245.5,-161.98"/>
<text text-anchor="middle" x="351131" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L13</text>
<text text-anchor="middle" x="351131" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="351131" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="351131" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert11_l13_dp2 -->
<g id="edge1967" class="edge">
<title>router_l13_dp2&#45;&gt;expert11_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349796.66,-164.03C349844.34,-169.01 349894.25,-173.67 349941,-176.98 350256.14,-199.33 350335.72,-208.74 350651.5,-198.98 350809.73,-194.09 350851.56,-206.97 351007,-176.98 351022.07,-174.08 351037.83,-169.84 351052.88,-165.18"/>
<polygon fill="black" stroke="black" points="351054.18,-168.44 351062.64,-162.07 351052.05,-161.77 351054.18,-168.44"/>
<text text-anchor="middle" x="350630" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l13_dp2 -->
<g id="node1177" class="node">
<title>expert12_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="350998.5,-161.98 350769.5,-161.98 350769.5,-109.98 350998.5,-109.98 350998.5,-161.98"/>
<text text-anchor="middle" x="350884" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L13</text>
<text text-anchor="middle" x="350884" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="350884" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="350884" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert12_l13_dp2 -->
<g id="edge1968" class="edge">
<title>router_l13_dp2&#45;&gt;expert12_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349802.88,-169.04C349900.47,-181.04 350014.7,-193.09 350118.5,-198.98 350260.91,-207.06 350619.61,-202.24 350760,-176.98 350775.38,-174.22 350791.46,-169.97 350806.75,-165.24"/>
<polygon fill="black" stroke="black" points="350808.21,-168.44 350816.67,-162.07 350806.08,-161.78 350808.21,-168.44"/>
<text text-anchor="middle" x="350140" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l13_dp2 -->
<g id="node1178" class="node">
<title>expert13_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="350751.5,-161.98 350522.5,-161.98 350522.5,-109.98 350751.5,-109.98 350751.5,-161.98"/>
<text text-anchor="middle" x="350637" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L13</text>
<text text-anchor="middle" x="350637" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="350637" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="350637" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert13_l13_dp2 -->
<g id="edge1969" class="edge">
<title>router_l13_dp2&#45;&gt;expert13_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349800.63,-176.98C349993.89,-203.28 350273.65,-224.47 350513,-176.98 350527.96,-174.01 350543.62,-169.78 350558.58,-165.14"/>
<polygon fill="black" stroke="black" points="350559.83,-168.41 350568.29,-162.04 350557.7,-161.74 350559.83,-168.41"/>
<text text-anchor="middle" x="350188" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l13_dp2 -->
<g id="node1179" class="node">
<title>expert14_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="350504.5,-161.98 350275.5,-161.98 350275.5,-109.98 350504.5,-109.98 350504.5,-161.98"/>
<text text-anchor="middle" x="350390" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L13</text>
<text text-anchor="middle" x="350390" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="350390" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="350390" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert14_l13_dp2 -->
<g id="edge1970" class="edge">
<title>router_l13_dp2&#45;&gt;expert14_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349797.91,-165.01C349921.47,-178.78 350075.97,-193.42 350214.5,-198.98 350233.59,-199.75 350238.86,-203.19 350257.5,-198.98 350285.7,-192.62 350314.94,-179.52 350338.75,-166.9"/>
<polygon fill="black" stroke="black" points="350340.48,-169.94 350347.6,-162.1 350337.14,-163.79 350340.48,-169.94"/>
<text text-anchor="middle" x="350236" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l13_dp2 -->
<g id="node1180" class="node">
<title>expert15_l13_dp2</title>
<polygon fill="lightgreen" stroke="black" points="350179.5,-161.98 349950.5,-161.98 349950.5,-109.98 350179.5,-109.98 350179.5,-161.98"/>
<text text-anchor="middle" x="350065" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L13</text>
<text text-anchor="middle" x="350065" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="350065" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="350065" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp2&#45;&gt;expert15_l13_dp2 -->
<g id="edge1971" class="edge">
<title>router_l13_dp2&#45;&gt;expert15_l13_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M349762.25,-135.98C349822.17,-135.98 349886.31,-135.98 349940.07,-135.98"/>
<polygon fill="black" stroke="black" points="349940.33,-139.48 349950.33,-135.98 349940.33,-132.48 349940.33,-139.48"/>
<text text-anchor="middle" x="349881.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l13_dp2 -->
<g id="node1181" class="node">
<title>expert_agg_l13_dp2</title>
<polygon fill="lightyellow" stroke="black" points="354493.57,-176.98 354099.74,-176.98 353998.43,-94.98 354392.26,-94.98 354493.57,-176.98"/>
<text text-anchor="middle" x="354246" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L13</text>
<text text-anchor="middle" x="354246" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="354246" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1972" class="edge">
<title>expert0_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M353962.66,-135.98C353988.06,-135.98 354013.47,-135.98 354038.87,-135.98"/>
<polygon fill="black" stroke="black" points="354038.99,-139.48 354048.99,-135.98 354038.99,-132.48 354038.99,-139.48"/>
</g>
<!-- expert1_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1973" class="edge">
<title>expert1_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M353656.24,-162.02C353679.4,-171.57 353706.96,-181.22 353733,-185.98 353783.06,-195.15 353911.3,-190.41 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert2_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1974" class="edge">
<title>expert2_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M353409.24,-162.02C353432.4,-171.57 353459.96,-181.22 353486,-185.98 353538.02,-195.51 353909.31,-190.59 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert3_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1975" class="edge">
<title>expert3_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M353162.24,-162.02C353185.4,-171.57 353212.96,-181.22 353239,-185.98 353318.02,-200.45 353881.97,-192.97 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert4_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1976" class="edge">
<title>expert4_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M352915.24,-162.02C352938.4,-171.57 352965.96,-181.22 352992,-185.98 353045.01,-195.69 353908.31,-190.67 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert5_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1977" class="edge">
<title>expert5_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M352668.24,-162.02C352691.4,-171.57 352718.96,-181.22 352745,-185.98 352811.5,-198.16 353894.64,-191.87 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert6_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1978" class="edge">
<title>expert6_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M352421.24,-162.02C352444.4,-171.57 352471.96,-181.22 352498,-185.98 352578,-200.63 353880.97,-193.06 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert7_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1979" class="edge">
<title>expert7_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M352174.24,-162.02C352197.4,-171.57 352224.96,-181.22 352251,-185.98 352297.75,-194.54 353914.65,-190.12 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert8_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1980" class="edge">
<title>expert8_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M351927.24,-162.02C351950.4,-171.57 351977.96,-181.22 352004,-185.98 352057.5,-195.78 353907.82,-190.72 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert9_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1981" class="edge">
<title>expert9_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M351680.24,-162.02C351703.4,-171.57 351730.96,-181.22 351757,-185.98 351817.25,-197.01 353900.98,-191.31 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert10_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1982" class="edge">
<title>expert10_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M351433.24,-162.02C351456.4,-171.57 351483.96,-181.22 351510,-185.98 351577,-198.25 353894.15,-191.91 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert11_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1983" class="edge">
<title>expert11_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M351186.24,-162.02C351209.4,-171.57 351236.96,-181.22 351263,-185.98 351336.75,-199.48 353887.31,-192.51 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert12_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1984" class="edge">
<title>expert12_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M350939.24,-162.02C350962.4,-171.57 350989.96,-181.22 351016,-185.98 351096.49,-200.72 353880.48,-193.1 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert13_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1985" class="edge">
<title>expert13_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M350692.24,-162.02C350715.4,-171.57 350742.96,-181.22 350769,-185.98 350812.62,-193.97 353917.82,-189.84 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert14_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1986" class="edge">
<title>expert14_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M350445.24,-162.02C350468.4,-171.57 350495.96,-181.22 350522,-185.98 350569,-194.59 353914.4,-190.14 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- expert15_l13_dp2&#45;&gt;expert_agg_l13_dp2 -->
<g id="edge1987" class="edge">
<title>expert15_l13_dp2&#45;&gt;expert_agg_l13_dp2</title>
<path fill="none" stroke="black" d="M350153.84,-162C350190.94,-171.58 350234.71,-181.25 350275,-185.98 350376.72,-197.93 353859.97,-194.9 353962,-185.98 354000.11,-182.65 354040.78,-176.86 354079.08,-170.36"/>
<polygon fill="black" stroke="black" points="354080.02,-173.75 354089.29,-168.6 354078.84,-166.85 354080.02,-173.75"/>
</g>
<!-- layer13_output_dp2 -->
<g id="node1182" class="node">
<title>layer13_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="354698" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="354698" y="-144.48" font-family="Arial" font-size="10.00">Layer 13 Output</text>
<text text-anchor="middle" x="354698" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="354698" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l13_dp2&#45;&gt;layer13_output_dp2 -->
<g id="edge1988" class="edge">
<title>expert_agg_l13_dp2&#45;&gt;layer13_output_dp2</title>
<path fill="none" stroke="black" d="M354443.31,-135.98C354468.49,-135.98 354493.66,-135.98 354518.84,-135.98"/>
<polygon fill="black" stroke="black" points="354518.87,-139.48 354528.87,-135.98 354518.87,-132.48 354518.87,-139.48"/>
</g>
<!-- attn_input_l14_dp2 -->
<g id="node1183" class="node">
<title>attn_input_l14_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="355071" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="355071" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L14</text>
<text text-anchor="middle" x="355071" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="355071" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer13_output_dp2&#45;&gt;attn_input_l14_dp2 -->
<g id="edge1989" class="edge">
<title>layer13_output_dp2&#45;&gt;attn_input_l14_dp2</title>
<path fill="none" stroke="black" d="M354867.01,-135.98C354875.23,-135.98 354883.44,-135.98 354891.66,-135.98"/>
<polygon fill="black" stroke="black" points="354891.68,-139.48 354901.68,-135.98 354891.68,-132.48 354891.68,-139.48"/>
</g>
<!-- attn_tp0_l14_dp2 -->
<g id="node1184" class="node">
<title>attn_tp0_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="356369,-161.98 356109,-161.98 356109,-109.98 356369,-109.98 356369,-161.98"/>
<text text-anchor="middle" x="356239" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L14</text>
<text text-anchor="middle" x="356239" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="356239" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="356239" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp2&#45;&gt;attn_tp0_l14_dp2 -->
<g id="edge1990" class="edge">
<title>attn_input_l14_dp2&#45;&gt;attn_tp0_l14_dp2</title>
<path fill="none" stroke="black" d="M355154.52,-161.26C355191.12,-171.09 355234.81,-181.13 355275,-185.98 355320,-191.42 356046.27,-193.33 356091,-185.98 356116.4,-181.81 356143.31,-173.85 356167.12,-165.5"/>
<polygon fill="black" stroke="black" points="356168.55,-168.71 356176.78,-162.03 356166.18,-162.12 356168.55,-168.71"/>
</g>
<!-- attn_tp1_l14_dp2 -->
<g id="node1185" class="node">
<title>attn_tp1_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="356091,-161.98 355831,-161.98 355831,-109.98 356091,-109.98 356091,-161.98"/>
<text text-anchor="middle" x="355961" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L14</text>
<text text-anchor="middle" x="355961" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="355961" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="355961" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp2&#45;&gt;attn_tp1_l14_dp2 -->
<g id="edge1991" class="edge">
<title>attn_input_l14_dp2&#45;&gt;attn_tp1_l14_dp2</title>
<path fill="none" stroke="black" d="M355154.52,-161.26C355191.12,-171.09 355234.81,-181.13 355275,-185.98 355334.35,-193.15 355754.01,-195.68 355813,-185.98 355838.4,-181.81 355865.31,-173.85 355889.12,-165.5"/>
<polygon fill="black" stroke="black" points="355890.55,-168.71 355898.78,-162.03 355888.18,-162.12 355890.55,-168.71"/>
</g>
<!-- attn_tp2_l14_dp2 -->
<g id="node1186" class="node">
<title>attn_tp2_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="355813,-161.98 355553,-161.98 355553,-109.98 355813,-109.98 355813,-161.98"/>
<text text-anchor="middle" x="355683" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L14</text>
<text text-anchor="middle" x="355683" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="355683" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="355683" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp2&#45;&gt;attn_tp2_l14_dp2 -->
<g id="edge1992" class="edge">
<title>attn_input_l14_dp2&#45;&gt;attn_tp2_l14_dp2</title>
<path fill="none" stroke="black" d="M355154.52,-161.26C355191.12,-171.09 355234.81,-181.13 355275,-185.98 355332.36,-192.91 355477.99,-195.35 355535,-185.98 355560.4,-181.81 355587.31,-173.85 355611.12,-165.5"/>
<polygon fill="black" stroke="black" points="355612.55,-168.71 355620.78,-162.03 355610.18,-162.12 355612.55,-168.71"/>
</g>
<!-- attn_tp3_l14_dp2 -->
<g id="node1187" class="node">
<title>attn_tp3_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="355535,-161.98 355275,-161.98 355275,-109.98 355535,-109.98 355535,-161.98"/>
<text text-anchor="middle" x="355405" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L14</text>
<text text-anchor="middle" x="355405" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="355405" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="355405" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp2&#45;&gt;attn_tp3_l14_dp2 -->
<g id="edge1993" class="edge">
<title>attn_input_l14_dp2&#45;&gt;attn_tp3_l14_dp2</title>
<path fill="none" stroke="black" d="M355240.28,-135.98C355248.35,-135.98 355256.42,-135.98 355264.49,-135.98"/>
<polygon fill="black" stroke="black" points="355264.7,-139.48 355274.7,-135.98 355264.7,-132.48 355264.7,-139.48"/>
</g>
<!-- allreduce_l14_dp2 -->
<g id="node1188" class="node">
<title>allreduce_l14_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="356573" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="356573" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L14</text>
<text text-anchor="middle" x="356573" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="356573" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l14_dp2&#45;&gt;allreduce_l14_dp2 -->
<g id="edge1994" class="edge">
<title>attn_tp0_l14_dp2&#45;&gt;allreduce_l14_dp2</title>
<path fill="none" stroke="black" d="M356369.14,-135.98C356377.35,-135.98 356385.56,-135.98 356393.77,-135.98"/>
<polygon fill="black" stroke="black" points="356393.78,-139.48 356403.78,-135.98 356393.78,-132.48 356393.78,-139.48"/>
</g>
<!-- attn_tp1_l14_dp2&#45;&gt;allreduce_l14_dp2 -->
<g id="edge1995" class="edge">
<title>attn_tp1_l14_dp2&#45;&gt;allreduce_l14_dp2</title>
<path fill="none" stroke="black" d="M356023.22,-162.03C356049.24,-171.59 356080.1,-181.23 356109,-185.98 356166.01,-195.35 356311.64,-192.91 356369,-185.98 356405.57,-181.57 356445.05,-172.85 356479.44,-163.91"/>
<polygon fill="black" stroke="black" points="356480.7,-167.2 356489.47,-161.26 356478.91,-160.43 356480.7,-167.2"/>
</g>
<!-- attn_tp2_l14_dp2&#45;&gt;allreduce_l14_dp2 -->
<g id="edge1996" class="edge">
<title>attn_tp2_l14_dp2&#45;&gt;allreduce_l14_dp2</title>
<path fill="none" stroke="black" d="M355745.22,-162.03C355771.24,-171.59 355802.1,-181.23 355831,-185.98 355889.98,-195.68 356309.65,-193.15 356369,-185.98 356405.57,-181.57 356445.05,-172.85 356479.44,-163.91"/>
<polygon fill="black" stroke="black" points="356480.7,-167.2 356489.47,-161.26 356478.91,-160.43 356480.7,-167.2"/>
</g>
<!-- attn_tp3_l14_dp2&#45;&gt;allreduce_l14_dp2 -->
<g id="edge1997" class="edge">
<title>attn_tp3_l14_dp2&#45;&gt;allreduce_l14_dp2</title>
<path fill="none" stroke="black" d="M355467.22,-162.03C355493.24,-171.59 355524.1,-181.23 355553,-185.98 355597.73,-193.33 356323.99,-191.42 356369,-185.98 356405.57,-181.57 356445.05,-172.85 356479.44,-163.91"/>
<polygon fill="black" stroke="black" points="356480.7,-167.2 356489.47,-161.26 356478.91,-160.43 356480.7,-167.2"/>
</g>
<!-- moe_input_l14_dp2 -->
<g id="node1189" class="node">
<title>moe_input_l14_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="356946" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="356946" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L14</text>
<text text-anchor="middle" x="356946" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="356946" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l14_dp2&#45;&gt;moe_input_l14_dp2 -->
<g id="edge1998" class="edge">
<title>allreduce_l14_dp2&#45;&gt;moe_input_l14_dp2</title>
<path fill="none" stroke="black" d="M356742.01,-135.98C356750.23,-135.98 356758.44,-135.98 356766.66,-135.98"/>
<polygon fill="black" stroke="black" points="356766.68,-139.48 356776.68,-135.98 356766.68,-132.48 356766.68,-139.48"/>
</g>
<!-- router_l14_dp2 -->
<g id="node1190" class="node">
<title>router_l14_dp2</title>
<polygon fill="lightyellow" stroke="black" points="357645.57,-176.98 357251.74,-176.98 357150.43,-94.98 357544.26,-94.98 357645.57,-176.98"/>
<text text-anchor="middle" x="357398" y="-144.48" font-family="Arial" font-size="10.00">Router L14</text>
<text text-anchor="middle" x="357398" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="357398" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l14_dp2&#45;&gt;router_l14_dp2 -->
<g id="edge1999" class="edge">
<title>moe_input_l14_dp2&#45;&gt;router_l14_dp2</title>
<path fill="none" stroke="black" d="M357115.06,-135.98C357140.34,-135.98 357165.63,-135.98 357190.92,-135.98"/>
<polygon fill="black" stroke="black" points="357190.99,-139.48 357200.99,-135.98 357190.99,-132.48 357190.99,-139.48"/>
</g>
<!-- expert0_l14_dp2 -->
<g id="node1191" class="node">
<title>expert0_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="361843.5,-161.98 361614.5,-161.98 361614.5,-109.98 361843.5,-109.98 361843.5,-161.98"/>
<text text-anchor="middle" x="361729" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L14</text>
<text text-anchor="middle" x="361729" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="361729" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="361729" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert0_l14_dp2 -->
<g id="edge2000" class="edge">
<title>router_l14_dp2&#45;&gt;expert0_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357629.05,-163.47C357684.32,-168.99 357743.19,-174 357798,-176.98 358552.57,-218 360442.82,-196.54 361198.5,-198.98 361379.43,-199.57 361427.32,-211.13 361605,-176.98 361620.07,-174.09 361635.84,-169.86 361650.88,-165.2"/>
<polygon fill="black" stroke="black" points="361652.18,-168.46 361660.65,-162.09 361650.05,-161.79 361652.18,-168.46"/>
<text text-anchor="middle" x="361220" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l14_dp2 -->
<g id="node1192" class="node">
<title>expert1_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="361596.5,-161.98 361367.5,-161.98 361367.5,-109.98 361596.5,-109.98 361596.5,-161.98"/>
<text text-anchor="middle" x="361482" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L14</text>
<text text-anchor="middle" x="361482" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="361482" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="361482" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert1_l14_dp2 -->
<g id="edge2001" class="edge">
<title>router_l14_dp2&#45;&gt;expert1_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357629.05,-163.43C357684.32,-168.95 357743.19,-173.98 357798,-176.98 358463.13,-213.43 360129.37,-196.54 360795.5,-198.98 361045.69,-199.9 361111.89,-221.98 361358,-176.98 361373.37,-174.17 361389.45,-169.91 361404.74,-165.17"/>
<polygon fill="black" stroke="black" points="361406.2,-168.38 361414.66,-162 361404.07,-161.71 361406.2,-168.38"/>
<text text-anchor="middle" x="360817" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l14_dp2 -->
<g id="node1193" class="node">
<title>expert2_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="361349.5,-161.98 361120.5,-161.98 361120.5,-109.98 361349.5,-109.98 361349.5,-161.98"/>
<text text-anchor="middle" x="361235" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L14</text>
<text text-anchor="middle" x="361235" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="361235" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="361235" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert2_l14_dp2 -->
<g id="edge2002" class="edge">
<title>router_l14_dp2&#45;&gt;expert2_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357628.79,-163.34C357684.14,-168.87 357743.11,-173.93 357798,-176.98 358348.61,-207.62 359728.08,-206.28 360279.5,-198.98 360464.32,-196.54 360928.91,-208.78 361111,-176.98 361126.72,-174.24 361143.17,-169.9 361158.76,-165.06"/>
<polygon fill="black" stroke="black" points="361159.89,-168.37 361168.34,-161.99 361157.75,-161.71 361159.89,-168.37"/>
<text text-anchor="middle" x="360258" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l14_dp2 -->
<g id="node1194" class="node">
<title>expert3_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="361102.5,-161.98 360873.5,-161.98 360873.5,-109.98 361102.5,-109.98 361102.5,-161.98"/>
<text text-anchor="middle" x="360988" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L14</text>
<text text-anchor="middle" x="360988" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="360988" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="360988" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert3_l14_dp2 -->
<g id="edge2003" class="edge">
<title>router_l14_dp2&#45;&gt;expert3_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357543.67,-176.99C357582.3,-186.08 357624.21,-194.39 357663.5,-198.98 357682.48,-201.2 357687.39,-199.05 357706.5,-198.98 358057.34,-197.76 360517.82,-233.97 360864,-176.98 360879.93,-174.36 360896.6,-170.02 360912.35,-165.13"/>
<polygon fill="black" stroke="black" points="360913.58,-168.41 360922.03,-162.02 360911.44,-161.75 360913.58,-168.41"/>
<text text-anchor="middle" x="357685" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l14_dp2 -->
<g id="node1195" class="node">
<title>expert4_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="360855.5,-161.98 360626.5,-161.98 360626.5,-109.98 360855.5,-109.98 360855.5,-161.98"/>
<text text-anchor="middle" x="360741" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L14</text>
<text text-anchor="middle" x="360741" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="360741" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="360741" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert4_l14_dp2 -->
<g id="edge2004" class="edge">
<title>router_l14_dp2&#45;&gt;expert4_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357570.37,-177C357615.98,-186.1 357665.37,-194.39 357711.5,-198.98 357730.52,-200.87 357735.39,-199.06 357754.5,-198.98 358072.56,-197.76 360303.18,-228.76 360617,-176.98 360632.93,-174.35 360649.6,-170.01 360665.35,-165.12"/>
<polygon fill="black" stroke="black" points="360666.58,-168.4 360675.03,-162.01 360664.44,-161.74 360666.58,-168.4"/>
<text text-anchor="middle" x="357733" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l14_dp2 -->
<g id="node1196" class="node">
<title>expert5_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="360608.5,-161.98 360379.5,-161.98 360379.5,-109.98 360608.5,-109.98 360608.5,-161.98"/>
<text text-anchor="middle" x="360494" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L14</text>
<text text-anchor="middle" x="360494" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="360494" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="360494" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert5_l14_dp2 -->
<g id="edge2005" class="edge">
<title>router_l14_dp2&#45;&gt;expert5_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357597.02,-177C357649.62,-186.1 357706.5,-194.4 357759.5,-198.98 357778.54,-200.63 357783.39,-199.06 357802.5,-198.98 358087.78,-197.76 360088.54,-223.55 360370,-176.98 360385.93,-174.35 360402.59,-170 360418.35,-165.11"/>
<polygon fill="black" stroke="black" points="360419.58,-168.39 360428.03,-162 360417.44,-161.73 360419.58,-168.39"/>
<text text-anchor="middle" x="357781" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l14_dp2 -->
<g id="node1197" class="node">
<title>expert6_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="360361.5,-161.98 360132.5,-161.98 360132.5,-109.98 360361.5,-109.98 360361.5,-161.98"/>
<text text-anchor="middle" x="360247" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L14</text>
<text text-anchor="middle" x="360247" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="360247" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="360247" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert6_l14_dp2 -->
<g id="edge2006" class="edge">
<title>router_l14_dp2&#45;&gt;expert6_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357628.54,-163.11C357683.96,-168.67 357743.03,-173.79 357798,-176.98 358513.08,-218.56 358693.29,-210.02 359409.5,-198.98 359726.72,-194.09 359810.59,-232.24 360123,-176.98 360138.62,-174.22 360154.97,-169.9 360170.48,-165.09"/>
<polygon fill="black" stroke="black" points="360171.55,-168.42 360180.01,-162.04 360169.42,-161.75 360171.55,-168.42"/>
<text text-anchor="middle" x="359388" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l14_dp2 -->
<g id="node1198" class="node">
<title>expert7_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="360114.5,-161.98 359885.5,-161.98 359885.5,-109.98 360114.5,-109.98 360114.5,-161.98"/>
<text text-anchor="middle" x="360000" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L14</text>
<text text-anchor="middle" x="360000" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="360000" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="360000" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert7_l14_dp2 -->
<g id="edge2007" class="edge">
<title>router_l14_dp2&#45;&gt;expert7_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357623.65,-177.01C357683.23,-186.11 357747.61,-194.4 357807.5,-198.98 357826.55,-200.44 357831.39,-199.09 357850.5,-198.98 358075.56,-197.76 359653.99,-213.97 359876,-176.98 359891.83,-174.34 359908.4,-170.03 359924.07,-165.17"/>
<polygon fill="black" stroke="black" points="359925.25,-168.46 359933.7,-162.08 359923.11,-161.8 359925.25,-168.46"/>
<text text-anchor="middle" x="357829" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l14_dp2 -->
<g id="node1199" class="node">
<title>expert8_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="359867.5,-161.98 359638.5,-161.98 359638.5,-109.98 359867.5,-109.98 359867.5,-161.98"/>
<text text-anchor="middle" x="359753" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L14</text>
<text text-anchor="middle" x="359753" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="359753" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="359753" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert8_l14_dp2 -->
<g id="edge2008" class="edge">
<title>router_l14_dp2&#45;&gt;expert8_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357644.89,-176.28C357712.94,-185.66 357786.91,-194.28 357855.5,-198.98 357874.56,-200.29 357879.39,-199.1 357898.5,-198.98 358090.79,-197.76 359439.35,-208.76 359629,-176.98 359644.83,-174.33 359661.39,-170.01 359677.07,-165.14"/>
<polygon fill="black" stroke="black" points="359678.24,-168.44 359686.7,-162.05 359676.11,-161.78 359678.24,-168.44"/>
<text text-anchor="middle" x="357877" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l14_dp2 -->
<g id="node1200" class="node">
<title>expert9_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="359620.5,-161.98 359391.5,-161.98 359391.5,-109.98 359620.5,-109.98 359620.5,-161.98"/>
<text text-anchor="middle" x="359506" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L14</text>
<text text-anchor="middle" x="359506" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="359506" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="359506" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert9_l14_dp2 -->
<g id="edge2009" class="edge">
<title>router_l14_dp2&#45;&gt;expert9_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357640.08,-172.34C357723.36,-183.2 357817.33,-193.63 357903.5,-198.98 358067.48,-209.16 359220,-204.35 359382,-176.98 359397.83,-174.31 359414.39,-169.98 359430.06,-165.11"/>
<polygon fill="black" stroke="black" points="359431.24,-168.41 359439.69,-162.02 359429.1,-161.74 359431.24,-168.41"/>
<text text-anchor="middle" x="357925" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l14_dp2 -->
<g id="node1201" class="node">
<title>expert10_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="359373.5,-161.98 359144.5,-161.98 359144.5,-109.98 359373.5,-109.98 359373.5,-161.98"/>
<text text-anchor="middle" x="359259" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L14</text>
<text text-anchor="middle" x="359259" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="359259" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="359259" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert10_l14_dp2 -->
<g id="edge2010" class="edge">
<title>router_l14_dp2&#45;&gt;expert10_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357627.78,-162.52C357683.43,-168.13 357742.79,-173.41 357798,-176.98 358178.88,-201.61 358274.92,-207.75 358656.5,-198.98 358869.33,-194.09 358925.65,-215.65 359135,-176.98 359150.27,-174.16 359166.25,-169.92 359181.46,-165.21"/>
<polygon fill="black" stroke="black" points="359182.87,-168.43 359191.33,-162.06 359180.74,-161.76 359182.87,-168.43"/>
<text text-anchor="middle" x="358635" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l14_dp2 -->
<g id="node1202" class="node">
<title>expert11_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="359126.5,-161.98 358897.5,-161.98 358897.5,-109.98 359126.5,-109.98 359126.5,-161.98"/>
<text text-anchor="middle" x="359012" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L14</text>
<text text-anchor="middle" x="359012" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="359012" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="359012" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert11_l14_dp2 -->
<g id="edge2011" class="edge">
<title>router_l14_dp2&#45;&gt;expert11_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357635.88,-169.04C357733.47,-181.04 357847.7,-193.09 357951.5,-198.98 358159.33,-210.77 358682.9,-212.61 358888,-176.98 358903.72,-174.25 358920.18,-169.92 358935.77,-165.08"/>
<polygon fill="black" stroke="black" points="358936.89,-168.39 358945.35,-162.01 358934.76,-161.73 358936.89,-168.39"/>
<text text-anchor="middle" x="357973" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l14_dp2 -->
<g id="node1203" class="node">
<title>expert12_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="358879.5,-161.98 358650.5,-161.98 358650.5,-109.98 358879.5,-109.98 358879.5,-161.98"/>
<text text-anchor="middle" x="358765" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L14</text>
<text text-anchor="middle" x="358765" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="358765" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="358765" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert12_l14_dp2 -->
<g id="edge2012" class="edge">
<title>router_l14_dp2&#45;&gt;expert12_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357632.51,-166.28C357743.54,-179.16 357878.13,-192.64 357999.5,-198.98 358141.94,-206.42 358500.61,-202.24 358641,-176.98 358656.38,-174.22 358672.46,-169.97 358687.75,-165.24"/>
<polygon fill="black" stroke="black" points="358689.21,-168.44 358697.67,-162.07 358687.08,-161.78 358689.21,-168.44"/>
<text text-anchor="middle" x="358021" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l14_dp2 -->
<g id="node1204" class="node">
<title>expert13_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="358632.5,-161.98 358403.5,-161.98 358403.5,-109.98 358632.5,-109.98 358632.5,-161.98"/>
<text text-anchor="middle" x="358518" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L14</text>
<text text-anchor="middle" x="358518" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="358518" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="358518" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert13_l14_dp2 -->
<g id="edge2013" class="edge">
<title>router_l14_dp2&#45;&gt;expert13_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357636.13,-176.99C357839.44,-204.61 358138.62,-227.65 358394,-176.98 358408.96,-174.01 358424.62,-169.78 358439.58,-165.14"/>
<polygon fill="black" stroke="black" points="358440.83,-168.41 358449.29,-162.04 358438.7,-161.74 358440.83,-168.41"/>
<text text-anchor="middle" x="358069" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l14_dp2 -->
<g id="node1205" class="node">
<title>expert14_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="358385.5,-161.98 358156.5,-161.98 358156.5,-109.98 358385.5,-109.98 358385.5,-161.98"/>
<text text-anchor="middle" x="358271" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L14</text>
<text text-anchor="middle" x="358271" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="358271" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="358271" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert14_l14_dp2 -->
<g id="edge2014" class="edge">
<title>router_l14_dp2&#45;&gt;expert14_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357628.52,-163.01C357764.24,-177.37 357939.37,-193.22 358095.5,-198.98 358114.6,-199.69 358119.86,-203.19 358138.5,-198.98 358166.7,-192.62 358195.94,-179.52 358219.75,-166.9"/>
<polygon fill="black" stroke="black" points="358221.48,-169.94 358228.6,-162.1 358218.14,-163.79 358221.48,-169.94"/>
<text text-anchor="middle" x="358117" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l14_dp2 -->
<g id="node1206" class="node">
<title>expert15_l14_dp2</title>
<polygon fill="lightgreen" stroke="black" points="358036.5,-161.98 357807.5,-161.98 357807.5,-109.98 358036.5,-109.98 358036.5,-161.98"/>
<text text-anchor="middle" x="357922" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L14</text>
<text text-anchor="middle" x="357922" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="357922" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="357922" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp2&#45;&gt;expert15_l14_dp2 -->
<g id="edge2015" class="edge">
<title>router_l14_dp2&#45;&gt;expert15_l14_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M357594.98,-135.98C357662.75,-135.98 357736.72,-135.98 357797.14,-135.98"/>
<polygon fill="black" stroke="black" points="357797.49,-139.48 357807.49,-135.98 357797.49,-132.48 357797.49,-139.48"/>
<text text-anchor="middle" x="357726.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l14_dp2 -->
<g id="node1207" class="node">
<title>expert_agg_l14_dp2</title>
<polygon fill="lightyellow" stroke="black" points="362374.57,-176.98 361980.74,-176.98 361879.43,-94.98 362273.26,-94.98 362374.57,-176.98"/>
<text text-anchor="middle" x="362127" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L14</text>
<text text-anchor="middle" x="362127" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="362127" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2016" class="edge">
<title>expert0_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M361843.66,-135.98C361869.06,-135.98 361894.47,-135.98 361919.87,-135.98"/>
<polygon fill="black" stroke="black" points="361919.99,-139.48 361929.99,-135.98 361919.99,-132.48 361919.99,-139.48"/>
</g>
<!-- expert1_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2017" class="edge">
<title>expert1_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M361537.24,-162.02C361560.4,-171.57 361587.96,-181.22 361614,-185.98 361664.06,-195.15 361792.3,-190.41 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert2_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2018" class="edge">
<title>expert2_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M361290.24,-162.02C361313.4,-171.57 361340.96,-181.22 361367,-185.98 361419.02,-195.51 361790.31,-190.59 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert3_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2019" class="edge">
<title>expert3_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M361043.24,-162.02C361066.4,-171.57 361093.96,-181.22 361120,-185.98 361199.02,-200.45 361762.97,-192.97 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert4_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2020" class="edge">
<title>expert4_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M360796.24,-162.02C360819.4,-171.57 360846.96,-181.22 360873,-185.98 360926.01,-195.69 361789.31,-190.67 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert5_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2021" class="edge">
<title>expert5_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M360549.24,-162.02C360572.4,-171.57 360599.96,-181.22 360626,-185.98 360692.5,-198.16 361775.64,-191.87 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert6_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2022" class="edge">
<title>expert6_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M360302.24,-162.02C360325.4,-171.57 360352.96,-181.22 360379,-185.98 360459,-200.63 361761.97,-193.06 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert7_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2023" class="edge">
<title>expert7_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M360055.24,-162.02C360078.4,-171.57 360105.96,-181.22 360132,-185.98 360178.75,-194.54 361795.65,-190.12 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert8_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2024" class="edge">
<title>expert8_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M359808.24,-162.02C359831.4,-171.57 359858.96,-181.22 359885,-185.98 359938.5,-195.78 361788.82,-190.72 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert9_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2025" class="edge">
<title>expert9_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M359561.24,-162.02C359584.4,-171.57 359611.96,-181.22 359638,-185.98 359698.25,-197.01 361781.98,-191.31 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert10_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2026" class="edge">
<title>expert10_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M359314.24,-162.02C359337.4,-171.57 359364.96,-181.22 359391,-185.98 359458,-198.25 361775.15,-191.91 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert11_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2027" class="edge">
<title>expert11_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M359067.24,-162.02C359090.4,-171.57 359117.96,-181.22 359144,-185.98 359217.75,-199.48 361768.31,-192.51 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert12_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2028" class="edge">
<title>expert12_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M358820.24,-162.02C358843.4,-171.57 358870.96,-181.22 358897,-185.98 358977.49,-200.72 361761.48,-193.1 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert13_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2029" class="edge">
<title>expert13_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M358573.24,-162.02C358596.4,-171.57 358623.96,-181.22 358650,-185.98 358693.62,-193.97 361798.82,-189.84 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert14_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2030" class="edge">
<title>expert14_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M358326.24,-162.02C358349.4,-171.57 358376.96,-181.22 358403,-185.98 358450,-194.59 361795.4,-190.14 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- expert15_l14_dp2&#45;&gt;expert_agg_l14_dp2 -->
<g id="edge2031" class="edge">
<title>expert15_l14_dp2&#45;&gt;expert_agg_l14_dp2</title>
<path fill="none" stroke="black" d="M358021.17,-162C358062.54,-171.59 358111.28,-181.26 358156,-185.98 358257.85,-196.74 361740.97,-194.9 361843,-185.98 361881.11,-182.65 361921.78,-176.86 361960.08,-170.36"/>
<polygon fill="black" stroke="black" points="361961.02,-173.75 361970.29,-168.6 361959.84,-166.85 361961.02,-173.75"/>
</g>
<!-- layer14_output_dp2 -->
<g id="node1208" class="node">
<title>layer14_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="362579" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="362579" y="-144.48" font-family="Arial" font-size="10.00">Layer 14 Output</text>
<text text-anchor="middle" x="362579" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="362579" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l14_dp2&#45;&gt;layer14_output_dp2 -->
<g id="edge2032" class="edge">
<title>expert_agg_l14_dp2&#45;&gt;layer14_output_dp2</title>
<path fill="none" stroke="black" d="M362324.31,-135.98C362349.49,-135.98 362374.66,-135.98 362399.84,-135.98"/>
<polygon fill="black" stroke="black" points="362399.87,-139.48 362409.87,-135.98 362399.87,-132.48 362399.87,-139.48"/>
</g>
<!-- attn_input_l15_dp2 -->
<g id="node1209" class="node">
<title>attn_input_l15_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="362952" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="362952" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L15</text>
<text text-anchor="middle" x="362952" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="362952" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer14_output_dp2&#45;&gt;attn_input_l15_dp2 -->
<g id="edge2033" class="edge">
<title>layer14_output_dp2&#45;&gt;attn_input_l15_dp2</title>
<path fill="none" stroke="black" d="M362748.01,-135.98C362756.23,-135.98 362764.44,-135.98 362772.66,-135.98"/>
<polygon fill="black" stroke="black" points="362772.68,-139.48 362782.68,-135.98 362772.68,-132.48 362772.68,-139.48"/>
</g>
<!-- attn_tp0_l15_dp2 -->
<g id="node1210" class="node">
<title>attn_tp0_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="364250,-161.98 363990,-161.98 363990,-109.98 364250,-109.98 364250,-161.98"/>
<text text-anchor="middle" x="364120" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L15</text>
<text text-anchor="middle" x="364120" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="364120" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="364120" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp2&#45;&gt;attn_tp0_l15_dp2 -->
<g id="edge2034" class="edge">
<title>attn_input_l15_dp2&#45;&gt;attn_tp0_l15_dp2</title>
<path fill="none" stroke="black" d="M363035.52,-161.26C363072.12,-171.09 363115.81,-181.13 363156,-185.98 363201,-191.42 363927.27,-193.33 363972,-185.98 363997.4,-181.81 364024.31,-173.85 364048.12,-165.5"/>
<polygon fill="black" stroke="black" points="364049.55,-168.71 364057.78,-162.03 364047.18,-162.12 364049.55,-168.71"/>
</g>
<!-- attn_tp1_l15_dp2 -->
<g id="node1211" class="node">
<title>attn_tp1_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="363972,-161.98 363712,-161.98 363712,-109.98 363972,-109.98 363972,-161.98"/>
<text text-anchor="middle" x="363842" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L15</text>
<text text-anchor="middle" x="363842" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="363842" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="363842" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp2&#45;&gt;attn_tp1_l15_dp2 -->
<g id="edge2035" class="edge">
<title>attn_input_l15_dp2&#45;&gt;attn_tp1_l15_dp2</title>
<path fill="none" stroke="black" d="M363035.52,-161.26C363072.12,-171.09 363115.81,-181.13 363156,-185.98 363215.35,-193.15 363635.01,-195.68 363694,-185.98 363719.4,-181.81 363746.31,-173.85 363770.12,-165.5"/>
<polygon fill="black" stroke="black" points="363771.55,-168.71 363779.78,-162.03 363769.18,-162.12 363771.55,-168.71"/>
</g>
<!-- attn_tp2_l15_dp2 -->
<g id="node1212" class="node">
<title>attn_tp2_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="363694,-161.98 363434,-161.98 363434,-109.98 363694,-109.98 363694,-161.98"/>
<text text-anchor="middle" x="363564" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L15</text>
<text text-anchor="middle" x="363564" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="363564" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="363564" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp2&#45;&gt;attn_tp2_l15_dp2 -->
<g id="edge2036" class="edge">
<title>attn_input_l15_dp2&#45;&gt;attn_tp2_l15_dp2</title>
<path fill="none" stroke="black" d="M363035.52,-161.26C363072.12,-171.09 363115.81,-181.13 363156,-185.98 363213.36,-192.91 363358.99,-195.35 363416,-185.98 363441.4,-181.81 363468.31,-173.85 363492.12,-165.5"/>
<polygon fill="black" stroke="black" points="363493.55,-168.71 363501.78,-162.03 363491.18,-162.12 363493.55,-168.71"/>
</g>
<!-- attn_tp3_l15_dp2 -->
<g id="node1213" class="node">
<title>attn_tp3_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="363416,-161.98 363156,-161.98 363156,-109.98 363416,-109.98 363416,-161.98"/>
<text text-anchor="middle" x="363286" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L15</text>
<text text-anchor="middle" x="363286" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="363286" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="363286" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp2&#45;&gt;attn_tp3_l15_dp2 -->
<g id="edge2037" class="edge">
<title>attn_input_l15_dp2&#45;&gt;attn_tp3_l15_dp2</title>
<path fill="none" stroke="black" d="M363121.28,-135.98C363129.35,-135.98 363137.42,-135.98 363145.49,-135.98"/>
<polygon fill="black" stroke="black" points="363145.7,-139.48 363155.7,-135.98 363145.7,-132.48 363145.7,-139.48"/>
</g>
<!-- allreduce_l15_dp2 -->
<g id="node1214" class="node">
<title>allreduce_l15_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="364454" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="364454" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L15</text>
<text text-anchor="middle" x="364454" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="364454" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l15_dp2&#45;&gt;allreduce_l15_dp2 -->
<g id="edge2038" class="edge">
<title>attn_tp0_l15_dp2&#45;&gt;allreduce_l15_dp2</title>
<path fill="none" stroke="black" d="M364250.14,-135.98C364258.35,-135.98 364266.56,-135.98 364274.77,-135.98"/>
<polygon fill="black" stroke="black" points="364274.78,-139.48 364284.78,-135.98 364274.78,-132.48 364274.78,-139.48"/>
</g>
<!-- attn_tp1_l15_dp2&#45;&gt;allreduce_l15_dp2 -->
<g id="edge2039" class="edge">
<title>attn_tp1_l15_dp2&#45;&gt;allreduce_l15_dp2</title>
<path fill="none" stroke="black" d="M363904.22,-162.03C363930.24,-171.59 363961.1,-181.23 363990,-185.98 364047.01,-195.35 364192.64,-192.91 364250,-185.98 364286.57,-181.57 364326.05,-172.85 364360.44,-163.91"/>
<polygon fill="black" stroke="black" points="364361.7,-167.2 364370.47,-161.26 364359.91,-160.43 364361.7,-167.2"/>
</g>
<!-- attn_tp2_l15_dp2&#45;&gt;allreduce_l15_dp2 -->
<g id="edge2040" class="edge">
<title>attn_tp2_l15_dp2&#45;&gt;allreduce_l15_dp2</title>
<path fill="none" stroke="black" d="M363626.22,-162.03C363652.24,-171.59 363683.1,-181.23 363712,-185.98 363770.98,-195.68 364190.65,-193.15 364250,-185.98 364286.57,-181.57 364326.05,-172.85 364360.44,-163.91"/>
<polygon fill="black" stroke="black" points="364361.7,-167.2 364370.47,-161.26 364359.91,-160.43 364361.7,-167.2"/>
</g>
<!-- attn_tp3_l15_dp2&#45;&gt;allreduce_l15_dp2 -->
<g id="edge2041" class="edge">
<title>attn_tp3_l15_dp2&#45;&gt;allreduce_l15_dp2</title>
<path fill="none" stroke="black" d="M363348.22,-162.03C363374.24,-171.59 363405.1,-181.23 363434,-185.98 363478.73,-193.33 364204.99,-191.42 364250,-185.98 364286.57,-181.57 364326.05,-172.85 364360.44,-163.91"/>
<polygon fill="black" stroke="black" points="364361.7,-167.2 364370.47,-161.26 364359.91,-160.43 364361.7,-167.2"/>
</g>
<!-- moe_input_l15_dp2 -->
<g id="node1215" class="node">
<title>moe_input_l15_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="364827" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="364827" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L15</text>
<text text-anchor="middle" x="364827" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="364827" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l15_dp2&#45;&gt;moe_input_l15_dp2 -->
<g id="edge2042" class="edge">
<title>allreduce_l15_dp2&#45;&gt;moe_input_l15_dp2</title>
<path fill="none" stroke="black" d="M364623.01,-135.98C364631.23,-135.98 364639.44,-135.98 364647.66,-135.98"/>
<polygon fill="black" stroke="black" points="364647.68,-139.48 364657.68,-135.98 364647.68,-132.48 364647.68,-139.48"/>
</g>
<!-- router_l15_dp2 -->
<g id="node1216" class="node">
<title>router_l15_dp2</title>
<polygon fill="lightyellow" stroke="black" points="365526.57,-176.98 365132.74,-176.98 365031.43,-94.98 365425.26,-94.98 365526.57,-176.98"/>
<text text-anchor="middle" x="365279" y="-144.48" font-family="Arial" font-size="10.00">Router L15</text>
<text text-anchor="middle" x="365279" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="365279" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l15_dp2&#45;&gt;router_l15_dp2 -->
<g id="edge2043" class="edge">
<title>moe_input_l15_dp2&#45;&gt;router_l15_dp2</title>
<path fill="none" stroke="black" d="M364996.06,-135.98C365021.34,-135.98 365046.63,-135.98 365071.92,-135.98"/>
<polygon fill="black" stroke="black" points="365071.99,-139.48 365081.99,-135.98 365071.99,-132.48 365071.99,-139.48"/>
</g>
<!-- expert0_l15_dp2 -->
<g id="node1217" class="node">
<title>expert0_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="369724.5,-161.98 369495.5,-161.98 369495.5,-109.98 369724.5,-109.98 369724.5,-161.98"/>
<text text-anchor="middle" x="369610" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L15</text>
<text text-anchor="middle" x="369610" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="369610" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="369610" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert0_l15_dp2 -->
<g id="edge2044" class="edge">
<title>router_l15_dp2&#45;&gt;expert0_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365510.05,-163.45C365565.32,-168.97 365624.19,-173.99 365679,-176.98 366397.61,-216.16 368197.82,-196.54 368917.5,-198.98 369170.35,-199.84 369237.25,-222.4 369486,-176.98 369501.37,-174.18 369517.45,-169.91 369532.74,-165.17"/>
<polygon fill="black" stroke="black" points="369534.2,-168.38 369542.66,-162 369532.07,-161.71 369534.2,-168.38"/>
<text text-anchor="middle" x="368939" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l15_dp2 -->
<g id="node1218" class="node">
<title>expert1_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="369477.5,-161.98 369248.5,-161.98 369248.5,-109.98 369477.5,-109.98 369477.5,-161.98"/>
<text text-anchor="middle" x="369363" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L15</text>
<text text-anchor="middle" x="369363" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="369363" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="369363" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert1_l15_dp2 -->
<g id="edge2045" class="edge">
<title>router_l15_dp2&#45;&gt;expert1_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365509.79,-163.37C365565.14,-168.9 365624.11,-173.95 365679,-176.98 366281.77,-210.28 367791.86,-206.85 368395.5,-198.98 368582.99,-196.54 369054.28,-209.21 369239,-176.98 369254.72,-174.24 369271.17,-169.91 369286.76,-165.06"/>
<polygon fill="black" stroke="black" points="369287.89,-168.38 369296.35,-161.99 369285.75,-161.71 369287.89,-168.38"/>
<text text-anchor="middle" x="368374" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l15_dp2 -->
<g id="node1219" class="node">
<title>expert2_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="369230.5,-161.98 369001.5,-161.98 369001.5,-109.98 369230.5,-109.98 369230.5,-161.98"/>
<text text-anchor="middle" x="369116" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L15</text>
<text text-anchor="middle" x="369116" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="369116" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="369116" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert2_l15_dp2 -->
<g id="edge2046" class="edge">
<title>router_l15_dp2&#45;&gt;expert2_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365424.67,-176.99C365463.3,-186.08 365505.21,-194.39 365544.5,-198.98 365563.48,-201.2 365568.39,-199.04 365587.5,-198.98 365776.64,-198.37 368805.36,-207.66 368992,-176.98 369007.93,-174.36 369024.6,-170.03 369040.35,-165.14"/>
<polygon fill="black" stroke="black" points="369041.58,-168.42 369050.03,-162.03 369039.44,-161.75 369041.58,-168.42"/>
<text text-anchor="middle" x="365566" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l15_dp2 -->
<g id="node1220" class="node">
<title>expert3_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="368983.5,-161.98 368754.5,-161.98 368754.5,-109.98 368983.5,-109.98 368983.5,-161.98"/>
<text text-anchor="middle" x="368869" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L15</text>
<text text-anchor="middle" x="368869" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="368869" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="368869" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert3_l15_dp2 -->
<g id="edge2047" class="edge">
<title>router_l15_dp2&#45;&gt;expert3_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365451.37,-177C365496.98,-186.1 365546.37,-194.39 365592.5,-198.98 365611.52,-200.87 365616.39,-199.05 365635.5,-198.98 365981.01,-197.76 368404.08,-233.12 368745,-176.98 368760.93,-174.36 368777.6,-170.02 368793.35,-165.13"/>
<polygon fill="black" stroke="black" points="368794.58,-168.41 368803.03,-162.02 368792.44,-161.75 368794.58,-168.41"/>
<text text-anchor="middle" x="365614" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l15_dp2 -->
<g id="node1221" class="node">
<title>expert4_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="368736.5,-161.98 368507.5,-161.98 368507.5,-109.98 368736.5,-109.98 368736.5,-161.98"/>
<text text-anchor="middle" x="368622" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L15</text>
<text text-anchor="middle" x="368622" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="368622" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="368622" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert4_l15_dp2 -->
<g id="edge2048" class="edge">
<title>router_l15_dp2&#45;&gt;expert4_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365478.02,-177C365530.62,-186.1 365587.5,-194.4 365640.5,-198.98 365659.54,-200.63 365664.39,-199.06 365683.5,-198.98 365996.23,-197.76 368189.44,-227.91 368498,-176.98 368513.93,-174.35 368530.6,-170.01 368546.35,-165.12"/>
<polygon fill="black" stroke="black" points="368547.58,-168.4 368556.03,-162.01 368545.44,-161.74 368547.58,-168.4"/>
<text text-anchor="middle" x="365662" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l15_dp2 -->
<g id="node1222" class="node">
<title>expert5_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="368489.5,-161.98 368260.5,-161.98 368260.5,-109.98 368489.5,-109.98 368489.5,-161.98"/>
<text text-anchor="middle" x="368375" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L15</text>
<text text-anchor="middle" x="368375" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="368375" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="368375" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert5_l15_dp2 -->
<g id="edge2049" class="edge">
<title>router_l15_dp2&#45;&gt;expert5_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365509.54,-163.18C365564.96,-168.73 365624.03,-173.83 365679,-176.98 366085.81,-200.28 367105.07,-205.05 367512.5,-198.98 367840.83,-194.09 367927.62,-234.01 368251,-176.98 368266.62,-174.23 368282.97,-169.91 368298.48,-165.1"/>
<polygon fill="black" stroke="black" points="368299.56,-168.43 368308.01,-162.05 368297.42,-161.77 368299.56,-168.43"/>
<text text-anchor="middle" x="367491" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l15_dp2 -->
<g id="node1223" class="node">
<title>expert6_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="368242.5,-161.98 368013.5,-161.98 368013.5,-109.98 368242.5,-109.98 368242.5,-161.98"/>
<text text-anchor="middle" x="368128" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L15</text>
<text text-anchor="middle" x="368128" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="368128" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="368128" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert6_l15_dp2 -->
<g id="edge2050" class="edge">
<title>router_l15_dp2&#45;&gt;expert6_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365504.65,-177.01C365564.23,-186.11 365628.61,-194.4 365688.5,-198.98 365707.55,-200.44 365712.39,-199.08 365731.5,-198.98 365984.01,-197.76 367754.9,-218.34 368004,-176.98 368019.93,-174.34 368036.59,-169.99 368052.35,-165.1"/>
<polygon fill="black" stroke="black" points="368053.58,-168.38 368062.03,-161.99 368051.44,-161.71 368053.58,-168.38"/>
<text text-anchor="middle" x="365710" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l15_dp2 -->
<g id="node1224" class="node">
<title>expert7_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="367995.5,-161.98 367766.5,-161.98 367766.5,-109.98 367995.5,-109.98 367995.5,-161.98"/>
<text text-anchor="middle" x="367881" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L15</text>
<text text-anchor="middle" x="367881" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="367881" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="367881" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert7_l15_dp2 -->
<g id="edge2051" class="edge">
<title>router_l15_dp2&#45;&gt;expert7_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365525.89,-176.28C365593.94,-185.66 365667.91,-194.28 365736.5,-198.98 365755.56,-200.29 365760.39,-199.09 365779.5,-198.98 365999.23,-197.76 367540.26,-213.12 367757,-176.98 367772.83,-174.34 367789.4,-170.03 367805.07,-165.16"/>
<polygon fill="black" stroke="black" points="367806.25,-168.46 367814.7,-162.07 367804.11,-161.8 367806.25,-168.46"/>
<text text-anchor="middle" x="365758" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l15_dp2 -->
<g id="node1225" class="node">
<title>expert8_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="367748.5,-161.98 367519.5,-161.98 367519.5,-109.98 367748.5,-109.98 367748.5,-161.98"/>
<text text-anchor="middle" x="367634" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L15</text>
<text text-anchor="middle" x="367634" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="367634" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="367634" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert8_l15_dp2 -->
<g id="edge2052" class="edge">
<title>router_l15_dp2&#45;&gt;expert8_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365521.08,-172.34C365604.36,-183.2 365698.33,-193.63 365784.5,-198.98 365975.87,-210.86 367320.9,-208.7 367510,-176.98 367525.83,-174.33 367542.39,-170 367558.07,-165.14"/>
<polygon fill="black" stroke="black" points="367559.24,-168.44 367567.7,-162.05 367557.11,-161.77 367559.24,-168.44"/>
<text text-anchor="middle" x="365806" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l15_dp2 -->
<g id="node1226" class="node">
<title>expert9_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="367501.5,-161.98 367272.5,-161.98 367272.5,-109.98 367501.5,-109.98 367501.5,-161.98"/>
<text text-anchor="middle" x="367387" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L15</text>
<text text-anchor="middle" x="367387" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="367387" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="367387" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert9_l15_dp2 -->
<g id="edge2053" class="edge">
<title>router_l15_dp2&#45;&gt;expert9_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365509.03,-162.76C365564.61,-168.34 365623.87,-173.56 365679,-176.98 366147.31,-206.02 366265.39,-208.74 366734.5,-198.98 366969.54,-194.09 367031.72,-219.18 367263,-176.98 367278.37,-174.18 367294.45,-169.91 367309.74,-165.18"/>
<polygon fill="black" stroke="black" points="367311.2,-168.38 367319.66,-162.01 367309.07,-161.72 367311.2,-168.38"/>
<text text-anchor="middle" x="366713" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l15_dp2 -->
<g id="node1227" class="node">
<title>expert10_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="367254.5,-161.98 367025.5,-161.98 367025.5,-109.98 367254.5,-109.98 367254.5,-161.98"/>
<text text-anchor="middle" x="367140" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L15</text>
<text text-anchor="middle" x="367140" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="367140" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="367140" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert10_l15_dp2 -->
<g id="edge2054" class="edge">
<title>router_l15_dp2&#45;&gt;expert10_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365516.88,-169.04C365614.47,-181.04 365728.7,-193.09 365832.5,-198.98 365963.81,-206.43 366886.36,-199.14 367016,-176.98 367031.73,-174.29 367048.19,-169.98 367063.78,-165.15"/>
<polygon fill="black" stroke="black" points="367064.9,-168.46 367073.36,-162.08 367062.77,-161.79 367064.9,-168.46"/>
<text text-anchor="middle" x="365854" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l15_dp2 -->
<g id="node1228" class="node">
<title>expert11_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="367007.5,-161.98 366778.5,-161.98 366778.5,-109.98 367007.5,-109.98 367007.5,-161.98"/>
<text text-anchor="middle" x="366893" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L15</text>
<text text-anchor="middle" x="366893" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="366893" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="366893" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert11_l15_dp2 -->
<g id="edge2055" class="edge">
<title>router_l15_dp2&#45;&gt;expert11_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365513.51,-166.28C365624.54,-179.16 365759.13,-192.64 365880.5,-198.98 366077.73,-209.28 366574.43,-210.92 366769,-176.98 366784.72,-174.24 366801.17,-169.91 366816.76,-165.06"/>
<polygon fill="black" stroke="black" points="366817.89,-168.38 366826.35,-161.99 366815.75,-161.71 366817.89,-168.38"/>
<text text-anchor="middle" x="365902" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l15_dp2 -->
<g id="node1229" class="node">
<title>expert12_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="366760.5,-161.98 366531.5,-161.98 366531.5,-109.98 366760.5,-109.98 366760.5,-161.98"/>
<text text-anchor="middle" x="366646" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L15</text>
<text text-anchor="middle" x="366646" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="366646" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="366646" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert12_l15_dp2 -->
<g id="edge2056" class="edge">
<title>router_l15_dp2&#45;&gt;expert12_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365505.29,-159.74C365562,-165.54 365622.71,-171.62 365679,-176.98 365679,-176.98 366522,-176.98 366522,-176.98 366537.37,-174.19 366553.45,-169.93 366568.75,-165.2"/>
<polygon fill="black" stroke="black" points="366570.21,-168.41 366578.67,-162.03 366568.08,-161.74 366570.21,-168.41"/>
<text text-anchor="middle" x="365950" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l15_dp2 -->
<g id="node1230" class="node">
<title>expert13_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="366513.5,-161.98 366284.5,-161.98 366284.5,-109.98 366513.5,-109.98 366513.5,-161.98"/>
<text text-anchor="middle" x="366399" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L15</text>
<text text-anchor="middle" x="366399" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="366399" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="366399" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert13_l15_dp2 -->
<g id="edge2057" class="edge">
<title>router_l15_dp2&#45;&gt;expert13_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365525.61,-176.06C365703.88,-199.52 365950.36,-220.67 366166.5,-198.98 366217.66,-193.85 366273.31,-179.11 366317.33,-165.18"/>
<polygon fill="black" stroke="black" points="366318.66,-168.43 366327.11,-162.04 366316.52,-161.77 366318.66,-168.43"/>
<text text-anchor="middle" x="366145" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l15_dp2 -->
<g id="node1231" class="node">
<title>expert14_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="366266.5,-161.98 366037.5,-161.98 366037.5,-109.98 366266.5,-109.98 366266.5,-161.98"/>
<text text-anchor="middle" x="366152" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L15</text>
<text text-anchor="middle" x="366152" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="366152" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="366152" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert14_l15_dp2 -->
<g id="edge2058" class="edge">
<title>router_l15_dp2&#45;&gt;expert14_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365509.52,-163.01C365645.24,-177.37 365820.37,-193.22 365976.5,-198.98 365995.6,-199.69 366000.86,-203.19 366019.5,-198.98 366047.7,-192.62 366076.94,-179.52 366100.75,-166.9"/>
<polygon fill="black" stroke="black" points="366102.48,-169.94 366109.6,-162.1 366099.14,-163.79 366102.48,-169.94"/>
<text text-anchor="middle" x="365998" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l15_dp2 -->
<g id="node1232" class="node">
<title>expert15_l15_dp2</title>
<polygon fill="lightgreen" stroke="black" points="365917.5,-161.98 365688.5,-161.98 365688.5,-109.98 365917.5,-109.98 365917.5,-161.98"/>
<text text-anchor="middle" x="365803" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L15</text>
<text text-anchor="middle" x="365803" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="365803" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="365803" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp2&#45;&gt;expert15_l15_dp2 -->
<g id="edge2059" class="edge">
<title>router_l15_dp2&#45;&gt;expert15_l15_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M365475.98,-135.98C365543.75,-135.98 365617.72,-135.98 365678.14,-135.98"/>
<polygon fill="black" stroke="black" points="365678.49,-139.48 365688.49,-135.98 365678.49,-132.48 365678.49,-139.48"/>
<text text-anchor="middle" x="365607.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l15_dp2 -->
<g id="node1233" class="node">
<title>expert_agg_l15_dp2</title>
<polygon fill="lightyellow" stroke="black" points="370255.57,-176.98 369861.74,-176.98 369760.43,-94.98 370154.26,-94.98 370255.57,-176.98"/>
<text text-anchor="middle" x="370008" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L15</text>
<text text-anchor="middle" x="370008" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="370008" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2060" class="edge">
<title>expert0_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M369724.66,-135.98C369750.06,-135.98 369775.47,-135.98 369800.87,-135.98"/>
<polygon fill="black" stroke="black" points="369800.99,-139.48 369810.99,-135.98 369800.99,-132.48 369800.99,-139.48"/>
</g>
<!-- expert1_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2061" class="edge">
<title>expert1_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M369418.24,-162.02C369441.4,-171.57 369468.96,-181.22 369495,-185.98 369545.06,-195.15 369673.3,-190.41 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert2_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2062" class="edge">
<title>expert2_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M369171.24,-162.02C369194.4,-171.57 369221.96,-181.22 369248,-185.98 369300.02,-195.51 369671.31,-190.59 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert3_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2063" class="edge">
<title>expert3_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M368924.24,-162.02C368947.4,-171.57 368974.96,-181.22 369001,-185.98 369080.02,-200.45 369643.97,-192.97 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert4_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2064" class="edge">
<title>expert4_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M368677.24,-162.02C368700.4,-171.57 368727.96,-181.22 368754,-185.98 368807.01,-195.69 369670.31,-190.67 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert5_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2065" class="edge">
<title>expert5_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M368430.24,-162.02C368453.4,-171.57 368480.96,-181.22 368507,-185.98 368573.5,-198.16 369656.64,-191.87 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert6_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2066" class="edge">
<title>expert6_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M368183.24,-162.02C368206.4,-171.57 368233.96,-181.22 368260,-185.98 368340,-200.63 369642.97,-193.06 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert7_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2067" class="edge">
<title>expert7_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M367936.24,-162.02C367959.4,-171.57 367986.96,-181.22 368013,-185.98 368059.75,-194.54 369676.65,-190.12 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert8_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2068" class="edge">
<title>expert8_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M367689.24,-162.02C367712.4,-171.57 367739.96,-181.22 367766,-185.98 367819.5,-195.78 369669.82,-190.72 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert9_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2069" class="edge">
<title>expert9_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M367442.24,-162.02C367465.4,-171.57 367492.96,-181.22 367519,-185.98 367579.25,-197.01 369662.98,-191.31 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert10_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2070" class="edge">
<title>expert10_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M367195.24,-162.02C367218.4,-171.57 367245.96,-181.22 367272,-185.98 367339,-198.25 369656.15,-191.91 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert11_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2071" class="edge">
<title>expert11_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M366948.24,-162.02C366971.4,-171.57 366998.96,-181.22 367025,-185.98 367098.75,-199.48 369649.31,-192.51 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert12_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2072" class="edge">
<title>expert12_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M366701.24,-162.02C366724.4,-171.57 366751.96,-181.22 366778,-185.98 366858.49,-200.72 369642.48,-193.1 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert13_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2073" class="edge">
<title>expert13_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M366454.24,-162.02C366477.4,-171.57 366504.96,-181.22 366531,-185.98 366574.62,-193.97 369679.82,-189.84 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert14_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2074" class="edge">
<title>expert14_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M366207.24,-162.02C366230.4,-171.57 366257.96,-181.22 366284,-185.98 366331,-194.59 369676.4,-190.14 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- expert15_l15_dp2&#45;&gt;expert_agg_l15_dp2 -->
<g id="edge2075" class="edge">
<title>expert15_l15_dp2&#45;&gt;expert_agg_l15_dp2</title>
<path fill="none" stroke="black" d="M365902.17,-162C365943.54,-171.59 365992.28,-181.26 366037,-185.98 366138.85,-196.74 369621.97,-194.9 369724,-185.98 369762.11,-182.65 369802.78,-176.86 369841.08,-170.36"/>
<polygon fill="black" stroke="black" points="369842.02,-173.75 369851.29,-168.6 369840.84,-166.85 369842.02,-173.75"/>
</g>
<!-- layer15_output_dp2 -->
<g id="node1234" class="node">
<title>layer15_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="370460" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="370460" y="-144.48" font-family="Arial" font-size="10.00">Layer 15 Output</text>
<text text-anchor="middle" x="370460" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="370460" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l15_dp2&#45;&gt;layer15_output_dp2 -->
<g id="edge2076" class="edge">
<title>expert_agg_l15_dp2&#45;&gt;layer15_output_dp2</title>
<path fill="none" stroke="black" d="M370205.31,-135.98C370230.49,-135.98 370255.66,-135.98 370280.84,-135.98"/>
<polygon fill="black" stroke="black" points="370280.87,-139.48 370290.87,-135.98 370280.87,-132.48 370280.87,-139.48"/>
</g>
<!-- attn_input_l16_dp2 -->
<g id="node1235" class="node">
<title>attn_input_l16_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="370833" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="370833" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L16</text>
<text text-anchor="middle" x="370833" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="370833" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer15_output_dp2&#45;&gt;attn_input_l16_dp2 -->
<g id="edge2077" class="edge">
<title>layer15_output_dp2&#45;&gt;attn_input_l16_dp2</title>
<path fill="none" stroke="black" d="M370629.01,-135.98C370637.23,-135.98 370645.44,-135.98 370653.66,-135.98"/>
<polygon fill="black" stroke="black" points="370653.68,-139.48 370663.68,-135.98 370653.68,-132.48 370653.68,-139.48"/>
</g>
<!-- attn_tp0_l16_dp2 -->
<g id="node1236" class="node">
<title>attn_tp0_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="372131,-161.98 371871,-161.98 371871,-109.98 372131,-109.98 372131,-161.98"/>
<text text-anchor="middle" x="372001" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L16</text>
<text text-anchor="middle" x="372001" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="372001" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="372001" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp2&#45;&gt;attn_tp0_l16_dp2 -->
<g id="edge2078" class="edge">
<title>attn_input_l16_dp2&#45;&gt;attn_tp0_l16_dp2</title>
<path fill="none" stroke="black" d="M370916.52,-161.26C370953.12,-171.09 370996.81,-181.13 371037,-185.98 371082,-191.42 371808.27,-193.33 371853,-185.98 371878.4,-181.81 371905.31,-173.85 371929.12,-165.5"/>
<polygon fill="black" stroke="black" points="371930.55,-168.71 371938.78,-162.03 371928.18,-162.12 371930.55,-168.71"/>
</g>
<!-- attn_tp1_l16_dp2 -->
<g id="node1237" class="node">
<title>attn_tp1_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="371853,-161.98 371593,-161.98 371593,-109.98 371853,-109.98 371853,-161.98"/>
<text text-anchor="middle" x="371723" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L16</text>
<text text-anchor="middle" x="371723" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="371723" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="371723" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp2&#45;&gt;attn_tp1_l16_dp2 -->
<g id="edge2079" class="edge">
<title>attn_input_l16_dp2&#45;&gt;attn_tp1_l16_dp2</title>
<path fill="none" stroke="black" d="M370916.52,-161.26C370953.12,-171.09 370996.81,-181.13 371037,-185.98 371096.35,-193.15 371516.01,-195.68 371575,-185.98 371600.4,-181.81 371627.31,-173.85 371651.12,-165.5"/>
<polygon fill="black" stroke="black" points="371652.55,-168.71 371660.78,-162.03 371650.18,-162.12 371652.55,-168.71"/>
</g>
<!-- attn_tp2_l16_dp2 -->
<g id="node1238" class="node">
<title>attn_tp2_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="371575,-161.98 371315,-161.98 371315,-109.98 371575,-109.98 371575,-161.98"/>
<text text-anchor="middle" x="371445" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L16</text>
<text text-anchor="middle" x="371445" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="371445" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="371445" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp2&#45;&gt;attn_tp2_l16_dp2 -->
<g id="edge2080" class="edge">
<title>attn_input_l16_dp2&#45;&gt;attn_tp2_l16_dp2</title>
<path fill="none" stroke="black" d="M370916.52,-161.26C370953.12,-171.09 370996.81,-181.13 371037,-185.98 371094.36,-192.91 371239.99,-195.35 371297,-185.98 371322.4,-181.81 371349.31,-173.85 371373.12,-165.5"/>
<polygon fill="black" stroke="black" points="371374.55,-168.71 371382.78,-162.03 371372.18,-162.12 371374.55,-168.71"/>
</g>
<!-- attn_tp3_l16_dp2 -->
<g id="node1239" class="node">
<title>attn_tp3_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="371297,-161.98 371037,-161.98 371037,-109.98 371297,-109.98 371297,-161.98"/>
<text text-anchor="middle" x="371167" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L16</text>
<text text-anchor="middle" x="371167" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="371167" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="371167" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp2&#45;&gt;attn_tp3_l16_dp2 -->
<g id="edge2081" class="edge">
<title>attn_input_l16_dp2&#45;&gt;attn_tp3_l16_dp2</title>
<path fill="none" stroke="black" d="M371002.28,-135.98C371010.35,-135.98 371018.42,-135.98 371026.49,-135.98"/>
<polygon fill="black" stroke="black" points="371026.7,-139.48 371036.7,-135.98 371026.7,-132.48 371026.7,-139.48"/>
</g>
<!-- allreduce_l16_dp2 -->
<g id="node1240" class="node">
<title>allreduce_l16_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="372335" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="372335" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L16</text>
<text text-anchor="middle" x="372335" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="372335" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l16_dp2&#45;&gt;allreduce_l16_dp2 -->
<g id="edge2082" class="edge">
<title>attn_tp0_l16_dp2&#45;&gt;allreduce_l16_dp2</title>
<path fill="none" stroke="black" d="M372131.14,-135.98C372139.35,-135.98 372147.56,-135.98 372155.77,-135.98"/>
<polygon fill="black" stroke="black" points="372155.78,-139.48 372165.78,-135.98 372155.78,-132.48 372155.78,-139.48"/>
</g>
<!-- attn_tp1_l16_dp2&#45;&gt;allreduce_l16_dp2 -->
<g id="edge2083" class="edge">
<title>attn_tp1_l16_dp2&#45;&gt;allreduce_l16_dp2</title>
<path fill="none" stroke="black" d="M371785.22,-162.03C371811.24,-171.59 371842.1,-181.23 371871,-185.98 371928.01,-195.35 372073.64,-192.91 372131,-185.98 372167.57,-181.57 372207.05,-172.85 372241.44,-163.91"/>
<polygon fill="black" stroke="black" points="372242.7,-167.2 372251.47,-161.26 372240.91,-160.43 372242.7,-167.2"/>
</g>
<!-- attn_tp2_l16_dp2&#45;&gt;allreduce_l16_dp2 -->
<g id="edge2084" class="edge">
<title>attn_tp2_l16_dp2&#45;&gt;allreduce_l16_dp2</title>
<path fill="none" stroke="black" d="M371507.22,-162.03C371533.24,-171.59 371564.1,-181.23 371593,-185.98 371651.98,-195.68 372071.65,-193.15 372131,-185.98 372167.57,-181.57 372207.05,-172.85 372241.44,-163.91"/>
<polygon fill="black" stroke="black" points="372242.7,-167.2 372251.47,-161.26 372240.91,-160.43 372242.7,-167.2"/>
</g>
<!-- attn_tp3_l16_dp2&#45;&gt;allreduce_l16_dp2 -->
<g id="edge2085" class="edge">
<title>attn_tp3_l16_dp2&#45;&gt;allreduce_l16_dp2</title>
<path fill="none" stroke="black" d="M371229.22,-162.03C371255.24,-171.59 371286.1,-181.23 371315,-185.98 371359.73,-193.33 372085.99,-191.42 372131,-185.98 372167.57,-181.57 372207.05,-172.85 372241.44,-163.91"/>
<polygon fill="black" stroke="black" points="372242.7,-167.2 372251.47,-161.26 372240.91,-160.43 372242.7,-167.2"/>
</g>
<!-- moe_input_l16_dp2 -->
<g id="node1241" class="node">
<title>moe_input_l16_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="372708" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="372708" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L16</text>
<text text-anchor="middle" x="372708" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="372708" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l16_dp2&#45;&gt;moe_input_l16_dp2 -->
<g id="edge2086" class="edge">
<title>allreduce_l16_dp2&#45;&gt;moe_input_l16_dp2</title>
<path fill="none" stroke="black" d="M372504.01,-135.98C372512.23,-135.98 372520.44,-135.98 372528.66,-135.98"/>
<polygon fill="black" stroke="black" points="372528.68,-139.48 372538.68,-135.98 372528.68,-132.48 372528.68,-139.48"/>
</g>
<!-- router_l16_dp2 -->
<g id="node1242" class="node">
<title>router_l16_dp2</title>
<polygon fill="lightyellow" stroke="black" points="373407.57,-176.98 373013.74,-176.98 372912.43,-94.98 373306.26,-94.98 373407.57,-176.98"/>
<text text-anchor="middle" x="373160" y="-144.48" font-family="Arial" font-size="10.00">Router L16</text>
<text text-anchor="middle" x="373160" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="373160" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l16_dp2&#45;&gt;router_l16_dp2 -->
<g id="edge2087" class="edge">
<title>moe_input_l16_dp2&#45;&gt;router_l16_dp2</title>
<path fill="none" stroke="black" d="M372877.06,-135.98C372902.34,-135.98 372927.63,-135.98 372952.92,-135.98"/>
<polygon fill="black" stroke="black" points="372952.99,-139.48 372962.99,-135.98 372952.99,-132.48 372952.99,-139.48"/>
</g>
<!-- expert0_l16_dp2 -->
<g id="node1243" class="node">
<title>expert0_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="377653.5,-161.98 377424.5,-161.98 377424.5,-109.98 377653.5,-109.98 377653.5,-161.98"/>
<text text-anchor="middle" x="377539" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L16</text>
<text text-anchor="middle" x="377539" y="-138.98" font-family="Arial" font-size="10.00">GPU 80</text>
<text text-anchor="middle" x="377539" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="377539" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert0_l16_dp2 -->
<g id="edge2088" class="edge">
<title>router_l16_dp2&#45;&gt;expert0_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373389.12,-161.92C373452.19,-168.02 373520.67,-173.71 373584,-176.98 374281.86,-213.09 376029.71,-196.54 376728.5,-198.98 377033.76,-200.05 377114.49,-230.66 377415,-176.98 377430.62,-174.19 377446.96,-169.86 377462.47,-165.05"/>
<polygon fill="black" stroke="black" points="377463.55,-168.38 377472,-161.99 377461.41,-161.71 377463.55,-168.38"/>
<text text-anchor="middle" x="376750" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l16_dp2 -->
<g id="node1244" class="node">
<title>expert1_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="377406.5,-161.98 377177.5,-161.98 377177.5,-109.98 377406.5,-109.98 377406.5,-161.98"/>
<text text-anchor="middle" x="377292" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L16</text>
<text text-anchor="middle" x="377292" y="-138.98" font-family="Arial" font-size="10.00">GPU 81</text>
<text text-anchor="middle" x="377292" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="377292" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert1_l16_dp2 -->
<g id="edge2089" class="edge">
<title>router_l16_dp2&#45;&gt;expert1_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373305.67,-176.99C373344.3,-186.08 373386.21,-194.39 373425.5,-198.98 373444.48,-201.2 373449.39,-199.04 373468.5,-198.98 373674.03,-198.37 376965.18,-210.26 377168,-176.98 377183.93,-174.37 377200.6,-170.03 377216.36,-165.14"/>
<polygon fill="black" stroke="black" points="377217.58,-168.42 377226.03,-162.03 377215.44,-161.76 377217.58,-168.42"/>
<text text-anchor="middle" x="373447" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l16_dp2 -->
<g id="node1245" class="node">
<title>expert2_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="377159.5,-161.98 376930.5,-161.98 376930.5,-109.98 377159.5,-109.98 377159.5,-161.98"/>
<text text-anchor="middle" x="377045" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L16</text>
<text text-anchor="middle" x="377045" y="-138.98" font-family="Arial" font-size="10.00">GPU 82</text>
<text text-anchor="middle" x="377045" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="377045" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert2_l16_dp2 -->
<g id="edge2090" class="edge">
<title>router_l16_dp2&#45;&gt;expert2_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373388.85,-161.81C373452,-167.93 373520.58,-173.64 373584,-176.98 374140.03,-206.29 375532.75,-206.35 376089.5,-198.98 376274.32,-196.54 376738.91,-208.78 376921,-176.98 376936.72,-174.24 376953.17,-169.9 376968.76,-165.06"/>
<polygon fill="black" stroke="black" points="376969.89,-168.37 376978.34,-161.99 376967.75,-161.71 376969.89,-168.37"/>
<text text-anchor="middle" x="376068" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l16_dp2 -->
<g id="node1246" class="node">
<title>expert3_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="376912.5,-161.98 376683.5,-161.98 376683.5,-109.98 376912.5,-109.98 376912.5,-161.98"/>
<text text-anchor="middle" x="376798" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L16</text>
<text text-anchor="middle" x="376798" y="-138.98" font-family="Arial" font-size="10.00">GPU 83</text>
<text text-anchor="middle" x="376798" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="376798" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert3_l16_dp2 -->
<g id="edge2091" class="edge">
<title>router_l16_dp2&#45;&gt;expert3_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373332.37,-177C373377.98,-186.1 373427.37,-194.39 373473.5,-198.98 373492.52,-200.87 373497.39,-199.05 373516.5,-198.98 373867.34,-197.76 376327.82,-233.97 376674,-176.98 376689.93,-174.36 376706.6,-170.02 376722.35,-165.13"/>
<polygon fill="black" stroke="black" points="376723.58,-168.41 376732.03,-162.02 376721.44,-161.75 376723.58,-168.41"/>
<text text-anchor="middle" x="373495" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l16_dp2 -->
<g id="node1247" class="node">
<title>expert4_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="376665.5,-161.98 376436.5,-161.98 376436.5,-109.98 376665.5,-109.98 376665.5,-161.98"/>
<text text-anchor="middle" x="376551" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L16</text>
<text text-anchor="middle" x="376551" y="-138.98" font-family="Arial" font-size="10.00">GPU 84</text>
<text text-anchor="middle" x="376551" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="376551" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert4_l16_dp2 -->
<g id="edge2092" class="edge">
<title>router_l16_dp2&#45;&gt;expert4_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373359.02,-177C373411.62,-186.1 373468.5,-194.4 373521.5,-198.98 373540.54,-200.63 373545.39,-199.06 373564.5,-198.98 373882.56,-197.76 376113.18,-228.76 376427,-176.98 376442.93,-174.35 376459.6,-170.01 376475.35,-165.12"/>
<polygon fill="black" stroke="black" points="376476.58,-168.4 376485.03,-162.01 376474.44,-161.74 376476.58,-168.4"/>
<text text-anchor="middle" x="373543" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l16_dp2 -->
<g id="node1248" class="node">
<title>expert5_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="376418.5,-161.98 376189.5,-161.98 376189.5,-109.98 376418.5,-109.98 376418.5,-161.98"/>
<text text-anchor="middle" x="376304" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L16</text>
<text text-anchor="middle" x="376304" y="-138.98" font-family="Arial" font-size="10.00">GPU 85</text>
<text text-anchor="middle" x="376304" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="376304" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert5_l16_dp2 -->
<g id="edge2093" class="edge">
<title>router_l16_dp2&#45;&gt;expert5_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373385.65,-177.01C373445.23,-186.11 373509.61,-194.4 373569.5,-198.98 373588.55,-200.44 373593.39,-199.06 373612.5,-198.98 373897.78,-197.76 375898.54,-223.55 376180,-176.98 376195.93,-174.35 376212.59,-170 376228.35,-165.11"/>
<polygon fill="black" stroke="black" points="376229.58,-168.39 376238.03,-162 376227.44,-161.73 376229.58,-168.39"/>
<text text-anchor="middle" x="373591" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l16_dp2 -->
<g id="node1249" class="node">
<title>expert6_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="376171.5,-161.98 375942.5,-161.98 375942.5,-109.98 376171.5,-109.98 376171.5,-161.98"/>
<text text-anchor="middle" x="376057" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L16</text>
<text text-anchor="middle" x="376057" y="-138.98" font-family="Arial" font-size="10.00">GPU 86</text>
<text text-anchor="middle" x="376057" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="376057" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert6_l16_dp2 -->
<g id="edge2094" class="edge">
<title>router_l16_dp2&#45;&gt;expert6_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373388.59,-161.58C373451.81,-167.7 373520.49,-173.48 373584,-176.98 374309.85,-217.02 374492.63,-210.19 375219.5,-198.98 375536.72,-194.09 375620.59,-232.24 375933,-176.98 375948.62,-174.22 375964.97,-169.9 375980.48,-165.09"/>
<polygon fill="black" stroke="black" points="375981.55,-168.42 375990.01,-162.04 375979.42,-161.75 375981.55,-168.42"/>
<text text-anchor="middle" x="375198" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l16_dp2 -->
<g id="node1250" class="node">
<title>expert7_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="375924.5,-161.98 375695.5,-161.98 375695.5,-109.98 375924.5,-109.98 375924.5,-161.98"/>
<text text-anchor="middle" x="375810" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L16</text>
<text text-anchor="middle" x="375810" y="-138.98" font-family="Arial" font-size="10.00">GPU 87</text>
<text text-anchor="middle" x="375810" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="375810" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert7_l16_dp2 -->
<g id="edge2095" class="edge">
<title>router_l16_dp2&#45;&gt;expert7_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373406.89,-176.28C373474.94,-185.66 373548.91,-194.28 373617.5,-198.98 373636.56,-200.29 373641.39,-199.09 373660.5,-198.98 373885.56,-197.76 375463.99,-213.97 375686,-176.98 375701.83,-174.34 375718.4,-170.03 375734.07,-165.17"/>
<polygon fill="black" stroke="black" points="375735.25,-168.46 375743.7,-162.08 375733.11,-161.8 375735.25,-168.46"/>
<text text-anchor="middle" x="373639" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l16_dp2 -->
<g id="node1251" class="node">
<title>expert8_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="375677.5,-161.98 375448.5,-161.98 375448.5,-109.98 375677.5,-109.98 375677.5,-161.98"/>
<text text-anchor="middle" x="375563" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L16</text>
<text text-anchor="middle" x="375563" y="-138.98" font-family="Arial" font-size="10.00">GPU 88</text>
<text text-anchor="middle" x="375563" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="375563" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert8_l16_dp2 -->
<g id="edge2096" class="edge">
<title>router_l16_dp2&#45;&gt;expert8_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373402.08,-172.34C373485.36,-183.2 373579.33,-193.63 373665.5,-198.98 373862.19,-211.19 375244.64,-209.55 375439,-176.98 375454.83,-174.33 375471.39,-170.01 375487.07,-165.14"/>
<polygon fill="black" stroke="black" points="375488.24,-168.44 375496.7,-162.05 375486.11,-161.78 375488.24,-168.44"/>
<text text-anchor="middle" x="373687" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l16_dp2 -->
<g id="node1252" class="node">
<title>expert9_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="375430.5,-161.98 375201.5,-161.98 375201.5,-109.98 375430.5,-109.98 375430.5,-161.98"/>
<text text-anchor="middle" x="375316" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L16</text>
<text text-anchor="middle" x="375316" y="-138.98" font-family="Arial" font-size="10.00">GPU 89</text>
<text text-anchor="middle" x="375316" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="375316" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert9_l16_dp2 -->
<g id="edge2097" class="edge">
<title>router_l16_dp2&#45;&gt;expert9_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373397.88,-169.04C373495.47,-181.04 373609.7,-193.09 373713.5,-198.98 373877.53,-208.29 375030,-204.35 375192,-176.98 375207.83,-174.31 375224.39,-169.98 375240.06,-165.11"/>
<polygon fill="black" stroke="black" points="375241.24,-168.41 375249.69,-162.02 375239.1,-161.74 375241.24,-168.41"/>
<text text-anchor="middle" x="373735" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l16_dp2 -->
<g id="node1253" class="node">
<title>expert10_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="375183.5,-161.98 374954.5,-161.98 374954.5,-109.98 375183.5,-109.98 375183.5,-161.98"/>
<text text-anchor="middle" x="375069" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L16</text>
<text text-anchor="middle" x="375069" y="-138.98" font-family="Arial" font-size="10.00">GPU 90</text>
<text text-anchor="middle" x="375069" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="375069" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert10_l16_dp2 -->
<g id="edge2098" class="edge">
<title>router_l16_dp2&#45;&gt;expert10_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373388.06,-161C373451.44,-167.15 373520.33,-173.08 373584,-176.98 373975.61,-201.02 374074.26,-208 374466.5,-198.98 374679.33,-194.09 374735.65,-215.65 374945,-176.98 374960.27,-174.16 374976.25,-169.92 374991.46,-165.21"/>
<polygon fill="black" stroke="black" points="374992.87,-168.43 375001.33,-162.06 374990.74,-161.76 374992.87,-168.43"/>
<text text-anchor="middle" x="374445" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l16_dp2 -->
<g id="node1254" class="node">
<title>expert11_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="374936.5,-161.98 374707.5,-161.98 374707.5,-109.98 374936.5,-109.98 374936.5,-161.98"/>
<text text-anchor="middle" x="374822" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L16</text>
<text text-anchor="middle" x="374822" y="-138.98" font-family="Arial" font-size="10.00">GPU 91</text>
<text text-anchor="middle" x="374822" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="374822" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert11_l16_dp2 -->
<g id="edge2099" class="edge">
<title>router_l16_dp2&#45;&gt;expert11_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373394.51,-166.28C373505.54,-179.16 373640.13,-192.64 373761.5,-198.98 373969.38,-209.84 374492.9,-212.61 374698,-176.98 374713.72,-174.25 374730.18,-169.92 374745.77,-165.08"/>
<polygon fill="black" stroke="black" points="374746.89,-168.39 374755.35,-162.01 374744.76,-161.73 374746.89,-168.39"/>
<text text-anchor="middle" x="373783" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l16_dp2 -->
<g id="node1255" class="node">
<title>expert12_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="374689.5,-161.98 374460.5,-161.98 374460.5,-109.98 374689.5,-109.98 374689.5,-161.98"/>
<text text-anchor="middle" x="374575" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L16</text>
<text text-anchor="middle" x="374575" y="-138.98" font-family="Arial" font-size="10.00">GPU 92</text>
<text text-anchor="middle" x="374575" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="374575" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert12_l16_dp2 -->
<g id="edge2100" class="edge">
<title>router_l16_dp2&#45;&gt;expert12_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373391.44,-163.92C373515.26,-177.47 373670.46,-192.26 373809.5,-198.98 373951.97,-205.88 374310.61,-202.24 374451,-176.98 374466.38,-174.22 374482.46,-169.97 374497.75,-165.24"/>
<polygon fill="black" stroke="black" points="374499.21,-168.44 374507.67,-162.07 374497.08,-161.78 374499.21,-168.44"/>
<text text-anchor="middle" x="373831" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l16_dp2 -->
<g id="node1256" class="node">
<title>expert13_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="374442.5,-161.98 374213.5,-161.98 374213.5,-109.98 374442.5,-109.98 374442.5,-161.98"/>
<text text-anchor="middle" x="374328" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L16</text>
<text text-anchor="middle" x="374328" y="-138.98" font-family="Arial" font-size="10.00">GPU 93</text>
<text text-anchor="middle" x="374328" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="374328" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert13_l16_dp2 -->
<g id="edge2101" class="edge">
<title>router_l16_dp2&#45;&gt;expert13_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373400.38,-176.99C373613.6,-205.92 373932.44,-230.86 374204,-176.98 374218.96,-174.01 374234.62,-169.78 374249.58,-165.14"/>
<polygon fill="black" stroke="black" points="374250.83,-168.41 374259.29,-162.04 374248.7,-161.74 374250.83,-168.41"/>
<text text-anchor="middle" x="373879" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l16_dp2 -->
<g id="node1257" class="node">
<title>expert14_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="374195.5,-161.98 373966.5,-161.98 373966.5,-109.98 374195.5,-109.98 374195.5,-161.98"/>
<text text-anchor="middle" x="374081" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L16</text>
<text text-anchor="middle" x="374081" y="-138.98" font-family="Arial" font-size="10.00">GPU 94</text>
<text text-anchor="middle" x="374081" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="374081" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert14_l16_dp2 -->
<g id="edge2102" class="edge">
<title>router_l16_dp2&#45;&gt;expert14_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373388.45,-161.26C373535.81,-176.09 373731.71,-193.04 373905.5,-198.98 373924.6,-199.64 373929.86,-203.19 373948.5,-198.98 373976.7,-192.62 374005.94,-179.52 374029.75,-166.9"/>
<polygon fill="black" stroke="black" points="374031.48,-169.94 374038.6,-162.1 374028.14,-163.79 374031.48,-169.94"/>
<text text-anchor="middle" x="373927" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l16_dp2 -->
<g id="node1258" class="node">
<title>expert15_l16_dp2</title>
<polygon fill="lightgreen" stroke="black" points="373822.5,-161.98 373593.5,-161.98 373593.5,-109.98 373822.5,-109.98 373822.5,-161.98"/>
<text text-anchor="middle" x="373708" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L16</text>
<text text-anchor="middle" x="373708" y="-138.98" font-family="Arial" font-size="10.00">GPU 95</text>
<text text-anchor="middle" x="373708" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="373708" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp2&#45;&gt;expert15_l16_dp2 -->
<g id="edge2103" class="edge">
<title>router_l16_dp2&#45;&gt;expert15_l16_dp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M373357.06,-135.98C373432.51,-135.98 373516.43,-135.98 373583.28,-135.98"/>
<polygon fill="black" stroke="black" points="373583.44,-139.48 373593.44,-135.98 373583.44,-132.48 373583.44,-139.48"/>
<text text-anchor="middle" x="373500.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l16_dp2 -->
<g id="node1259" class="node">
<title>expert_agg_l16_dp2</title>
<polygon fill="lightyellow" stroke="black" points="378184.57,-176.98 377790.74,-176.98 377689.43,-94.98 378083.26,-94.98 378184.57,-176.98"/>
<text text-anchor="middle" x="377937" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L16</text>
<text text-anchor="middle" x="377937" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="377937" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2104" class="edge">
<title>expert0_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M377653.66,-135.98C377679.06,-135.98 377704.47,-135.98 377729.87,-135.98"/>
<polygon fill="black" stroke="black" points="377729.99,-139.48 377739.99,-135.98 377729.99,-132.48 377729.99,-139.48"/>
</g>
<!-- expert1_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2105" class="edge">
<title>expert1_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M377347.24,-162.02C377370.4,-171.57 377397.96,-181.22 377424,-185.98 377474.06,-195.15 377602.3,-190.41 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert2_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2106" class="edge">
<title>expert2_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M377100.24,-162.02C377123.4,-171.57 377150.96,-181.22 377177,-185.98 377229.02,-195.51 377600.31,-190.59 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert3_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2107" class="edge">
<title>expert3_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M376853.24,-162.02C376876.4,-171.57 376903.96,-181.22 376930,-185.98 377009.02,-200.45 377572.97,-192.97 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert4_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2108" class="edge">
<title>expert4_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M376606.24,-162.02C376629.4,-171.57 376656.96,-181.22 376683,-185.98 376736.01,-195.69 377599.31,-190.67 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert5_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2109" class="edge">
<title>expert5_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M376359.24,-162.02C376382.4,-171.57 376409.96,-181.22 376436,-185.98 376502.5,-198.16 377585.64,-191.87 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert6_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2110" class="edge">
<title>expert6_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M376112.24,-162.02C376135.4,-171.57 376162.96,-181.22 376189,-185.98 376269,-200.63 377571.97,-193.06 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert7_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2111" class="edge">
<title>expert7_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M375865.24,-162.02C375888.4,-171.57 375915.96,-181.22 375942,-185.98 375988.75,-194.54 377605.65,-190.12 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert8_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2112" class="edge">
<title>expert8_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M375618.24,-162.02C375641.4,-171.57 375668.96,-181.22 375695,-185.98 375748.5,-195.78 377598.82,-190.72 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert9_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2113" class="edge">
<title>expert9_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M375371.24,-162.02C375394.4,-171.57 375421.96,-181.22 375448,-185.98 375508.25,-197.01 377591.98,-191.31 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert10_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2114" class="edge">
<title>expert10_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M375124.24,-162.02C375147.4,-171.57 375174.96,-181.22 375201,-185.98 375268,-198.25 377585.15,-191.91 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert11_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2115" class="edge">
<title>expert11_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M374877.24,-162.02C374900.4,-171.57 374927.96,-181.22 374954,-185.98 375027.75,-199.48 377578.31,-192.51 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert12_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2116" class="edge">
<title>expert12_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M374630.24,-162.02C374653.4,-171.57 374680.96,-181.22 374707,-185.98 374787.49,-200.72 377571.48,-193.1 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert13_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2117" class="edge">
<title>expert13_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M374383.24,-162.02C374406.4,-171.57 374433.96,-181.22 374460,-185.98 374503.62,-193.97 377608.82,-189.84 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert14_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2118" class="edge">
<title>expert14_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M374136.24,-162.02C374159.4,-171.57 374186.96,-181.22 374213,-185.98 374260,-194.59 377605.4,-190.14 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- expert15_l16_dp2&#45;&gt;expert_agg_l16_dp2 -->
<g id="edge2119" class="edge">
<title>expert15_l16_dp2&#45;&gt;expert_agg_l16_dp2</title>
<path fill="none" stroke="black" d="M373817.49,-162.01C373863.12,-171.59 373916.84,-181.26 373966,-185.98 374067.95,-195.77 377550.97,-194.9 377653,-185.98 377691.11,-182.65 377731.78,-176.86 377770.08,-170.36"/>
<polygon fill="black" stroke="black" points="377771.02,-173.75 377780.29,-168.6 377769.84,-166.85 377771.02,-173.75"/>
</g>
<!-- layer16_output_dp2 -->
<g id="node1260" class="node">
<title>layer16_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="378389" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="378389" y="-144.48" font-family="Arial" font-size="10.00">Layer 16 Output</text>
<text text-anchor="middle" x="378389" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="378389" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l16_dp2&#45;&gt;layer16_output_dp2 -->
<g id="edge2120" class="edge">
<title>expert_agg_l16_dp2&#45;&gt;layer16_output_dp2</title>
<path fill="none" stroke="black" d="M378134.31,-135.98C378159.49,-135.98 378184.66,-135.98 378209.84,-135.98"/>
<polygon fill="black" stroke="black" points="378209.87,-139.48 378219.87,-135.98 378209.87,-132.48 378209.87,-139.48"/>
</g>
<!-- stage2_output_dp2 -->
<g id="node1261" class="node">
<title>stage2_output_dp2</title>
<ellipse fill="lightblue" stroke="black" cx="378762" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="378762" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Output</text>
<text text-anchor="middle" x="378762" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="378762" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer16_output_dp2&#45;&gt;stage2_output_dp2 -->
<g id="edge2121" class="edge">
<title>layer16_output_dp2&#45;&gt;stage2_output_dp2</title>
<path fill="none" stroke="black" d="M378558.01,-135.98C378566.23,-135.98 378574.44,-135.98 378582.66,-135.98"/>
<polygon fill="black" stroke="black" points="378582.68,-139.48 378592.68,-135.98 378582.68,-132.48 378582.68,-139.48"/>
</g>
<!-- stage2_output_dp2&#45;&gt;output -->
<g id="edge2831" class="edge">
<title>stage2_output_dp2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M378668.37,-111.8C378636.42,-104.95 378600.35,-98.39 378567,-94.98 378148.79,-52.31 319905.65,-31.33 316251.45,-30.05"/>
<polygon fill="black" stroke="black" points="316251.22,-26.55 316241.21,-30.05 316251.21,-33.55 316251.22,-26.55"/>
</g>
<!-- stage1_input_dp3 -->
<g id="node1262" class="node">
<title>stage1_input_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="379118" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="379118" y="-144.48" font-family="Arial" font-size="10.00">Stage1 Input</text>
<text text-anchor="middle" x="379118" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="379118" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_input_l1_dp3 -->
<g id="node1263" class="node">
<title>attn_input_l1_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="379491" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="379491" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L1</text>
<text text-anchor="middle" x="379491" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="379491" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_input_dp3&#45;&gt;attn_input_l1_dp3 -->
<g id="edge2122" class="edge">
<title>stage1_input_dp3&#45;&gt;attn_input_l1_dp3</title>
<path fill="none" stroke="black" d="M379287.01,-135.98C379295.23,-135.98 379303.44,-135.98 379311.66,-135.98"/>
<polygon fill="black" stroke="black" points="379311.68,-139.48 379321.68,-135.98 379311.68,-132.48 379311.68,-139.48"/>
</g>
<!-- attn_tp0_l1_dp3 -->
<g id="node1264" class="node">
<title>attn_tp0_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="380789,-161.98 380529,-161.98 380529,-109.98 380789,-109.98 380789,-161.98"/>
<text text-anchor="middle" x="380659" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L1</text>
<text text-anchor="middle" x="380659" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="380659" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="380659" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp3&#45;&gt;attn_tp0_l1_dp3 -->
<g id="edge2123" class="edge">
<title>attn_input_l1_dp3&#45;&gt;attn_tp0_l1_dp3</title>
<path fill="none" stroke="black" d="M379574.52,-161.26C379611.12,-171.09 379654.81,-181.13 379695,-185.98 379740,-191.42 380466.27,-193.33 380511,-185.98 380536.4,-181.81 380563.31,-173.85 380587.12,-165.5"/>
<polygon fill="black" stroke="black" points="380588.55,-168.71 380596.78,-162.03 380586.18,-162.12 380588.55,-168.71"/>
</g>
<!-- attn_tp1_l1_dp3 -->
<g id="node1265" class="node">
<title>attn_tp1_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="380511,-161.98 380251,-161.98 380251,-109.98 380511,-109.98 380511,-161.98"/>
<text text-anchor="middle" x="380381" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L1</text>
<text text-anchor="middle" x="380381" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="380381" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="380381" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp3&#45;&gt;attn_tp1_l1_dp3 -->
<g id="edge2124" class="edge">
<title>attn_input_l1_dp3&#45;&gt;attn_tp1_l1_dp3</title>
<path fill="none" stroke="black" d="M379574.52,-161.26C379611.12,-171.09 379654.81,-181.13 379695,-185.98 379754.35,-193.15 380174.01,-195.68 380233,-185.98 380258.4,-181.81 380285.31,-173.85 380309.12,-165.5"/>
<polygon fill="black" stroke="black" points="380310.55,-168.71 380318.78,-162.03 380308.18,-162.12 380310.55,-168.71"/>
</g>
<!-- attn_tp2_l1_dp3 -->
<g id="node1266" class="node">
<title>attn_tp2_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="380233,-161.98 379973,-161.98 379973,-109.98 380233,-109.98 380233,-161.98"/>
<text text-anchor="middle" x="380103" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L1</text>
<text text-anchor="middle" x="380103" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="380103" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="380103" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp3&#45;&gt;attn_tp2_l1_dp3 -->
<g id="edge2125" class="edge">
<title>attn_input_l1_dp3&#45;&gt;attn_tp2_l1_dp3</title>
<path fill="none" stroke="black" d="M379574.52,-161.26C379611.12,-171.09 379654.81,-181.13 379695,-185.98 379752.36,-192.91 379897.99,-195.35 379955,-185.98 379980.4,-181.81 380007.31,-173.85 380031.12,-165.5"/>
<polygon fill="black" stroke="black" points="380032.55,-168.71 380040.78,-162.03 380030.18,-162.12 380032.55,-168.71"/>
</g>
<!-- attn_tp3_l1_dp3 -->
<g id="node1267" class="node">
<title>attn_tp3_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="379955,-161.98 379695,-161.98 379695,-109.98 379955,-109.98 379955,-161.98"/>
<text text-anchor="middle" x="379825" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L1</text>
<text text-anchor="middle" x="379825" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="379825" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="379825" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l1_dp3&#45;&gt;attn_tp3_l1_dp3 -->
<g id="edge2126" class="edge">
<title>attn_input_l1_dp3&#45;&gt;attn_tp3_l1_dp3</title>
<path fill="none" stroke="black" d="M379660.28,-135.98C379668.35,-135.98 379676.42,-135.98 379684.49,-135.98"/>
<polygon fill="black" stroke="black" points="379684.7,-139.48 379694.7,-135.98 379684.7,-132.48 379684.7,-139.48"/>
</g>
<!-- allreduce_l1_dp3 -->
<g id="node1268" class="node">
<title>allreduce_l1_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="380993" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="380993" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L1</text>
<text text-anchor="middle" x="380993" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="380993" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l1_dp3&#45;&gt;allreduce_l1_dp3 -->
<g id="edge2127" class="edge">
<title>attn_tp0_l1_dp3&#45;&gt;allreduce_l1_dp3</title>
<path fill="none" stroke="black" d="M380789.14,-135.98C380797.35,-135.98 380805.56,-135.98 380813.77,-135.98"/>
<polygon fill="black" stroke="black" points="380813.78,-139.48 380823.78,-135.98 380813.78,-132.48 380813.78,-139.48"/>
</g>
<!-- attn_tp1_l1_dp3&#45;&gt;allreduce_l1_dp3 -->
<g id="edge2128" class="edge">
<title>attn_tp1_l1_dp3&#45;&gt;allreduce_l1_dp3</title>
<path fill="none" stroke="black" d="M380443.22,-162.03C380469.24,-171.59 380500.1,-181.23 380529,-185.98 380586.01,-195.35 380731.64,-192.91 380789,-185.98 380825.57,-181.57 380865.05,-172.85 380899.44,-163.91"/>
<polygon fill="black" stroke="black" points="380900.7,-167.2 380909.47,-161.26 380898.91,-160.43 380900.7,-167.2"/>
</g>
<!-- attn_tp2_l1_dp3&#45;&gt;allreduce_l1_dp3 -->
<g id="edge2129" class="edge">
<title>attn_tp2_l1_dp3&#45;&gt;allreduce_l1_dp3</title>
<path fill="none" stroke="black" d="M380165.22,-162.03C380191.24,-171.59 380222.1,-181.23 380251,-185.98 380309.98,-195.68 380729.65,-193.15 380789,-185.98 380825.57,-181.57 380865.05,-172.85 380899.44,-163.91"/>
<polygon fill="black" stroke="black" points="380900.7,-167.2 380909.47,-161.26 380898.91,-160.43 380900.7,-167.2"/>
</g>
<!-- attn_tp3_l1_dp3&#45;&gt;allreduce_l1_dp3 -->
<g id="edge2130" class="edge">
<title>attn_tp3_l1_dp3&#45;&gt;allreduce_l1_dp3</title>
<path fill="none" stroke="black" d="M379887.22,-162.03C379913.24,-171.59 379944.1,-181.23 379973,-185.98 380017.73,-193.33 380743.99,-191.42 380789,-185.98 380825.57,-181.57 380865.05,-172.85 380899.44,-163.91"/>
<polygon fill="black" stroke="black" points="380900.7,-167.2 380909.47,-161.26 380898.91,-160.43 380900.7,-167.2"/>
</g>
<!-- moe_input_l1_dp3 -->
<g id="node1269" class="node">
<title>moe_input_l1_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="381366" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="381366" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L1</text>
<text text-anchor="middle" x="381366" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="381366" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l1_dp3&#45;&gt;moe_input_l1_dp3 -->
<g id="edge2131" class="edge">
<title>allreduce_l1_dp3&#45;&gt;moe_input_l1_dp3</title>
<path fill="none" stroke="black" d="M381162.01,-135.98C381170.23,-135.98 381178.44,-135.98 381186.66,-135.98"/>
<polygon fill="black" stroke="black" points="381186.68,-139.48 381196.68,-135.98 381186.68,-132.48 381186.68,-139.48"/>
</g>
<!-- router_l1_dp3 -->
<g id="node1270" class="node">
<title>router_l1_dp3</title>
<polygon fill="lightyellow" stroke="black" points="382065.57,-176.98 381671.74,-176.98 381570.43,-94.98 381964.26,-94.98 382065.57,-176.98"/>
<text text-anchor="middle" x="381818" y="-144.48" font-family="Arial" font-size="10.00">Router L1</text>
<text text-anchor="middle" x="381818" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="381818" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l1_dp3&#45;&gt;router_l1_dp3 -->
<g id="edge2132" class="edge">
<title>moe_input_l1_dp3&#45;&gt;router_l1_dp3</title>
<path fill="none" stroke="black" d="M381535.06,-135.98C381560.34,-135.98 381585.63,-135.98 381610.92,-135.98"/>
<polygon fill="black" stroke="black" points="381610.99,-139.48 381620.99,-135.98 381610.99,-132.48 381610.99,-139.48"/>
</g>
<!-- expert0_l1_dp3 -->
<g id="node1271" class="node">
<title>expert0_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="386071.5,-161.98 385842.5,-161.98 385842.5,-109.98 386071.5,-109.98 386071.5,-161.98"/>
<text text-anchor="middle" x="385957" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L1</text>
<text text-anchor="middle" x="385957" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="385957" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="385957" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert0_l1_dp3 -->
<g id="edge2133" class="edge">
<title>router_l1_dp3&#45;&gt;expert0_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.74,-171.32C382080.09,-173.59 382101.41,-175.53 382122,-176.98 382882.47,-230.48 384790.15,-196.54 385552.5,-198.98 385677.55,-199.38 385710.59,-202.54 385833,-176.98 385847.75,-173.9 385863.19,-169.66 385877.98,-165.07"/>
<polygon fill="black" stroke="black" points="385879.12,-168.37 385887.59,-162 385877,-161.7 385879.12,-168.37"/>
<text text-anchor="middle" x="385574" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l1_dp3 -->
<g id="node1272" class="node">
<title>expert1_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="385824.5,-161.98 385595.5,-161.98 385595.5,-109.98 385824.5,-109.98 385824.5,-161.98"/>
<text text-anchor="middle" x="385710" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L1</text>
<text text-anchor="middle" x="385710" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="385710" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="385710" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert1_l1_dp3 -->
<g id="edge2134" class="edge">
<title>router_l1_dp3&#45;&gt;expert1_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.74,-171.31C382080.09,-173.58 382101.41,-175.53 382122,-176.98 382821.05,-226.36 384574.71,-196.54 385275.5,-198.98 385413.84,-199.47 385450.43,-204.56 385586,-176.98 385600.85,-173.96 385616.41,-169.72 385631.28,-165.11"/>
<polygon fill="black" stroke="black" points="385632.48,-168.4 385640.94,-162.03 385630.35,-161.73 385632.48,-168.4"/>
<text text-anchor="middle" x="385297" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l1_dp3 -->
<g id="node1273" class="node">
<title>expert2_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="385577.5,-161.98 385348.5,-161.98 385348.5,-109.98 385577.5,-109.98 385577.5,-161.98"/>
<text text-anchor="middle" x="385463" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L1</text>
<text text-anchor="middle" x="385463" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="385463" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="385463" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert2_l1_dp3 -->
<g id="edge2135" class="edge">
<title>router_l1_dp3&#45;&gt;expert2_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.74,-171.29C382080.1,-173.56 382101.41,-175.52 382122,-176.98 382753.21,-221.81 384336.71,-196.54 384969.5,-198.98 385134.01,-199.62 385177.55,-208.59 385339,-176.98 385354.06,-174.03 385369.82,-169.78 385384.86,-165.12"/>
<polygon fill="black" stroke="black" points="385386.17,-168.37 385394.63,-162 385384.04,-161.71 385386.17,-168.37"/>
<text text-anchor="middle" x="384991" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l1_dp3 -->
<g id="node1274" class="node">
<title>expert3_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="385330.5,-161.98 385101.5,-161.98 385101.5,-109.98 385330.5,-109.98 385330.5,-161.98"/>
<text text-anchor="middle" x="385216" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L1</text>
<text text-anchor="middle" x="385216" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="385216" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="385216" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert3_l1_dp3 -->
<g id="edge2136" class="edge">
<title>router_l1_dp3&#45;&gt;expert3_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.74,-171.27C382080.1,-173.54 382101.41,-175.51 382122,-176.98 382672.28,-216.37 384052.82,-196.54 384604.5,-198.98 384821.38,-199.94 384878.79,-216.75 385092,-176.98 385107.27,-174.14 385123.24,-169.88 385138.45,-165.17"/>
<polygon fill="black" stroke="black" points="385139.86,-168.39 385148.32,-162.01 385137.73,-161.72 385139.86,-168.39"/>
<text text-anchor="middle" x="384626" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l1_dp3 -->
<g id="node1275" class="node">
<title>expert4_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="385083.5,-161.98 384854.5,-161.98 384854.5,-109.98 385083.5,-109.98 385083.5,-161.98"/>
<text text-anchor="middle" x="384969" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L1</text>
<text text-anchor="middle" x="384969" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="384969" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="384969" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert4_l1_dp3 -->
<g id="edge2137" class="edge">
<title>router_l1_dp3&#45;&gt;expert4_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381963.67,-176.99C382002.3,-186.08 382044.21,-194.39 382083.5,-198.98 382102.48,-201.2 382107.39,-199.06 382126.5,-198.98 382428.56,-197.76 384546.97,-226.21 384845,-176.98 384860.93,-174.35 384877.6,-170.01 384893.35,-165.12"/>
<polygon fill="black" stroke="black" points="384894.58,-168.4 384903.03,-162.01 384892.44,-161.73 384894.58,-168.4"/>
<text text-anchor="middle" x="382105" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l1_dp3 -->
<g id="node1276" class="node">
<title>expert5_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="384836.5,-161.98 384607.5,-161.98 384607.5,-109.98 384836.5,-109.98 384836.5,-161.98"/>
<text text-anchor="middle" x="384722" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L1</text>
<text text-anchor="middle" x="384722" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="384722" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="384722" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert5_l1_dp3 -->
<g id="edge2138" class="edge">
<title>router_l1_dp3&#45;&gt;expert5_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.74,-171.22C382080.1,-173.51 382101.42,-175.49 382122,-176.98 382565.19,-209.18 383677.15,-196.54 384121.5,-198.98 384333.5,-200.15 384389.61,-215.98 384598,-176.98 384613.26,-174.13 384629.24,-169.86 384644.45,-165.15"/>
<polygon fill="black" stroke="black" points="384645.86,-168.37 384654.32,-162 384643.73,-161.71 384645.86,-168.37"/>
<text text-anchor="middle" x="384143" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l1_dp3 -->
<g id="node1277" class="node">
<title>expert6_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="384589.5,-161.98 384360.5,-161.98 384360.5,-109.98 384589.5,-109.98 384589.5,-161.98"/>
<text text-anchor="middle" x="384475" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L1</text>
<text text-anchor="middle" x="384475" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="384475" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="384475" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert6_l1_dp3 -->
<g id="edge2139" class="edge">
<title>router_l1_dp3&#45;&gt;expert6_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M381990.37,-177C382035.98,-186.1 382085.37,-194.39 382131.5,-198.98 382150.52,-200.87 382155.39,-199.08 382174.5,-198.98 382416.34,-197.76 384112.43,-216.64 384351,-176.98 384366.84,-174.35 384383.4,-170.04 384399.07,-165.18"/>
<polygon fill="black" stroke="black" points="384400.25,-168.47 384408.7,-162.09 384398.11,-161.81 384400.25,-168.47"/>
<text text-anchor="middle" x="382153" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l1_dp3 -->
<g id="node1278" class="node">
<title>expert7_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="384342.5,-161.98 384113.5,-161.98 384113.5,-109.98 384342.5,-109.98 384342.5,-161.98"/>
<text text-anchor="middle" x="384228" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L1</text>
<text text-anchor="middle" x="384228" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="384228" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="384228" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert7_l1_dp3 -->
<g id="edge2140" class="edge">
<title>router_l1_dp3&#45;&gt;expert7_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.33,-171.1C382079.83,-173.42 382101.29,-175.44 382122,-176.98 382470.07,-202.87 383343.59,-208.3 383692.5,-198.98 383875.58,-194.09 383924.02,-210.92 384104,-176.98 384119.17,-174.12 384135.04,-169.88 384150.17,-165.2"/>
<polygon fill="black" stroke="black" points="384151.52,-168.44 384159.99,-162.07 384149.4,-161.77 384151.52,-168.44"/>
<text text-anchor="middle" x="383671" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l1_dp3 -->
<g id="node1279" class="node">
<title>expert8_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="384095.5,-161.98 383866.5,-161.98 383866.5,-109.98 384095.5,-109.98 384095.5,-161.98"/>
<text text-anchor="middle" x="383981" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L1</text>
<text text-anchor="middle" x="383981" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="383981" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="383981" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert8_l1_dp3 -->
<g id="edge2141" class="edge">
<title>router_l1_dp3&#45;&gt;expert8_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382017.02,-177C382069.62,-186.1 382126.5,-194.4 382179.5,-198.98 382198.54,-200.63 382203.39,-199.11 382222.5,-198.98 382404.12,-197.76 383677.88,-207.07 383857,-176.98 383872.83,-174.32 383889.39,-170 383905.07,-165.13"/>
<polygon fill="black" stroke="black" points="383906.24,-168.43 383914.7,-162.04 383904.1,-161.77 383906.24,-168.43"/>
<text text-anchor="middle" x="382201" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l1_dp3 -->
<g id="node1280" class="node">
<title>expert9_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="383848.5,-161.98 383619.5,-161.98 383619.5,-109.98 383848.5,-109.98 383848.5,-161.98"/>
<text text-anchor="middle" x="383734" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L1</text>
<text text-anchor="middle" x="383734" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="383734" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="383734" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert9_l1_dp3 -->
<g id="edge2142" class="edge">
<title>router_l1_dp3&#45;&gt;expert9_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382058.35,-170.96C382079.84,-173.31 382101.29,-175.38 382122,-176.98 382618.17,-215.39 382744.07,-213.82 383241.5,-198.98 383405.49,-194.09 383448.87,-207.88 383610,-176.98 383625.16,-174.08 383641.03,-169.81 383656.15,-165.12"/>
<polygon fill="black" stroke="black" points="383657.51,-168.37 383665.97,-161.99 383655.38,-161.7 383657.51,-168.37"/>
<text text-anchor="middle" x="383220" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l1_dp3 -->
<g id="node1281" class="node">
<title>expert10_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="383601.5,-161.98 383372.5,-161.98 383372.5,-109.98 383601.5,-109.98 383601.5,-161.98"/>
<text text-anchor="middle" x="383487" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L1</text>
<text text-anchor="middle" x="383487" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="383487" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="383487" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert10_l1_dp3 -->
<g id="edge2143" class="edge">
<title>router_l1_dp3&#45;&gt;expert10_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382043.65,-177.01C382103.23,-186.11 382167.61,-194.4 382227.5,-198.98 382353.32,-208.6 383238.62,-198.3 383363,-176.98 383378.73,-174.29 383395.18,-169.97 383410.78,-165.14"/>
<polygon fill="black" stroke="black" points="383411.9,-168.45 383420.36,-162.07 383409.77,-161.78 383411.9,-168.45"/>
<text text-anchor="middle" x="382249" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l1_dp3 -->
<g id="node1282" class="node">
<title>expert11_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="383354.5,-161.98 383125.5,-161.98 383125.5,-109.98 383354.5,-109.98 383354.5,-161.98"/>
<text text-anchor="middle" x="383240" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L1</text>
<text text-anchor="middle" x="383240" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="383240" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="383240" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert11_l1_dp3 -->
<g id="edge2144" class="edge">
<title>router_l1_dp3&#45;&gt;expert11_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382057.95,-170.64C382079.58,-173.07 382101.17,-175.24 382122,-176.98 382437.71,-203.39 382517.92,-211.33 382834.5,-198.98 382959.9,-194.09 382992.97,-201.75 383116,-176.98 383130.86,-173.99 383146.42,-169.77 383161.29,-165.16"/>
<polygon fill="black" stroke="black" points="383162.48,-168.45 383170.95,-162.08 383160.36,-161.78 383162.48,-168.45"/>
<text text-anchor="middle" x="382813" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l1_dp3 -->
<g id="node1283" class="node">
<title>expert12_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="383107.5,-161.98 382878.5,-161.98 382878.5,-109.98 383107.5,-109.98 383107.5,-161.98"/>
<text text-anchor="middle" x="382993" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L1</text>
<text text-anchor="middle" x="382993" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="382993" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="382993" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert12_l1_dp3 -->
<g id="edge2145" class="edge">
<title>router_l1_dp3&#45;&gt;expert12_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382064.89,-176.28C382132.94,-185.66 382206.91,-194.28 382275.5,-198.98 382407.17,-208.01 382739.14,-200.56 382869,-176.98 382884.37,-174.19 382900.45,-169.93 382915.75,-165.2"/>
<polygon fill="black" stroke="black" points="382917.21,-168.41 382925.67,-162.03 382915.08,-161.74 382917.21,-168.41"/>
<text text-anchor="middle" x="382297" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l1_dp3 -->
<g id="node1284" class="node">
<title>expert13_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="382860.5,-161.98 382631.5,-161.98 382631.5,-109.98 382860.5,-109.98 382860.5,-161.98"/>
<text text-anchor="middle" x="382746" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L1</text>
<text text-anchor="middle" x="382746" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="382746" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="382746" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert13_l1_dp3 -->
<g id="edge2146" class="edge">
<title>router_l1_dp3&#45;&gt;expert13_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382035.82,-177.02C382172.96,-197.58 382353.66,-215.02 382513.5,-198.98 382564.66,-193.85 382620.31,-179.11 382664.33,-165.18"/>
<polygon fill="black" stroke="black" points="382665.66,-168.43 382674.11,-162.04 382663.52,-161.77 382665.66,-168.43"/>
<text text-anchor="middle" x="382492" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l1_dp3 -->
<g id="node1285" class="node">
<title>expert14_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="382613.5,-161.98 382384.5,-161.98 382384.5,-109.98 382613.5,-109.98 382613.5,-161.98"/>
<text text-anchor="middle" x="382499" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L1</text>
<text text-anchor="middle" x="382499" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="382499" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="382499" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert14_l1_dp3 -->
<g id="edge2147" class="edge">
<title>router_l1_dp3&#45;&gt;expert14_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382043.44,-176.99C382166.58,-196.39 382306.01,-212.63 382366.5,-198.98 382394.7,-192.62 382423.94,-179.52 382447.75,-166.9"/>
<polygon fill="black" stroke="black" points="382449.48,-169.94 382456.6,-162.1 382446.14,-163.79 382449.48,-169.94"/>
<text text-anchor="middle" x="382345" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l1_dp3 -->
<g id="node1286" class="node">
<title>expert15_l1_dp3</title>
<polygon fill="lightgreen" stroke="black" points="382360.5,-161.98 382131.5,-161.98 382131.5,-109.98 382360.5,-109.98 382360.5,-161.98"/>
<text text-anchor="middle" x="382246" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L1</text>
<text text-anchor="middle" x="382246" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="382246" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="382246" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l1_dp3&#45;&gt;expert15_l1_dp3 -->
<g id="edge2148" class="edge">
<title>router_l1_dp3&#45;&gt;expert15_l1_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M382015.09,-135.98C382051.17,-135.98 382087.91,-135.98 382121.14,-135.98"/>
<polygon fill="black" stroke="black" points="382121.34,-139.48 382131.34,-135.98 382121.34,-132.48 382121.34,-139.48"/>
<text text-anchor="middle" x="382098.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l1_dp3 -->
<g id="node1287" class="node">
<title>expert_agg_l1_dp3</title>
<polygon fill="lightyellow" stroke="black" points="386602.57,-176.98 386208.74,-176.98 386107.43,-94.98 386501.26,-94.98 386602.57,-176.98"/>
<text text-anchor="middle" x="386355" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L1</text>
<text text-anchor="middle" x="386355" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="386355" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2149" class="edge">
<title>expert0_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M386071.66,-135.98C386097.06,-135.98 386122.47,-135.98 386147.87,-135.98"/>
<polygon fill="black" stroke="black" points="386147.99,-139.48 386157.99,-135.98 386147.99,-132.48 386147.99,-139.48"/>
</g>
<!-- expert1_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2150" class="edge">
<title>expert1_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M385765.24,-162.02C385788.4,-171.57 385815.96,-181.22 385842,-185.98 385892.06,-195.15 386020.3,-190.41 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert2_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2151" class="edge">
<title>expert2_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M385518.24,-162.02C385541.4,-171.57 385568.96,-181.22 385595,-185.98 385647.02,-195.51 386018.31,-190.59 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert3_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2152" class="edge">
<title>expert3_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M385271.24,-162.02C385294.4,-171.57 385321.96,-181.22 385348,-185.98 385427.02,-200.45 385990.97,-192.97 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert4_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2153" class="edge">
<title>expert4_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M385024.24,-162.02C385047.4,-171.57 385074.96,-181.22 385101,-185.98 385154.01,-195.69 386017.31,-190.67 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert5_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2154" class="edge">
<title>expert5_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M384777.24,-162.02C384800.4,-171.57 384827.96,-181.22 384854,-185.98 384920.5,-198.16 386003.64,-191.87 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert6_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2155" class="edge">
<title>expert6_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M384530.24,-162.02C384553.4,-171.57 384580.96,-181.22 384607,-185.98 384687,-200.63 385989.97,-193.06 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert7_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2156" class="edge">
<title>expert7_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M384283.24,-162.02C384306.4,-171.57 384333.96,-181.22 384360,-185.98 384406.75,-194.54 386023.65,-190.12 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert8_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2157" class="edge">
<title>expert8_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M384036.24,-162.02C384059.4,-171.57 384086.96,-181.22 384113,-185.98 384166.5,-195.78 386016.82,-190.72 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert9_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2158" class="edge">
<title>expert9_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M383789.24,-162.02C383812.4,-171.57 383839.96,-181.22 383866,-185.98 383926.25,-197.01 386009.98,-191.31 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert10_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2159" class="edge">
<title>expert10_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M383542.24,-162.02C383565.4,-171.57 383592.96,-181.22 383619,-185.98 383686,-198.25 386003.15,-191.91 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert11_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2160" class="edge">
<title>expert11_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M383295.24,-162.02C383318.4,-171.57 383345.96,-181.22 383372,-185.98 383445.75,-199.48 385996.31,-192.51 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert12_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2161" class="edge">
<title>expert12_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M383048.24,-162.02C383071.4,-171.57 383098.96,-181.22 383125,-185.98 383205.49,-200.72 385989.48,-193.1 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert13_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2162" class="edge">
<title>expert13_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M382801.24,-162.02C382824.4,-171.57 382851.96,-181.22 382878,-185.98 382921.62,-193.97 386026.82,-189.84 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert14_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2163" class="edge">
<title>expert14_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M382554.24,-162.02C382577.4,-171.57 382604.96,-181.22 382631,-185.98 382678,-194.59 386023.4,-190.14 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- expert15_l1_dp3&#45;&gt;expert_agg_l1_dp3 -->
<g id="edge2164" class="edge">
<title>expert15_l1_dp3&#45;&gt;expert_agg_l1_dp3</title>
<path fill="none" stroke="black" d="M382303.86,-162.02C382328.1,-171.58 382356.89,-181.22 382384,-185.98 382434.44,-194.84 386019.98,-190.44 386071,-185.98 386109.11,-182.65 386149.78,-176.86 386188.08,-170.36"/>
<polygon fill="black" stroke="black" points="386189.02,-173.75 386198.29,-168.6 386187.84,-166.85 386189.02,-173.75"/>
</g>
<!-- layer1_output_dp3 -->
<g id="node1288" class="node">
<title>layer1_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="386807" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="386807" y="-144.48" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="386807" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="386807" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l1_dp3&#45;&gt;layer1_output_dp3 -->
<g id="edge2165" class="edge">
<title>expert_agg_l1_dp3&#45;&gt;layer1_output_dp3</title>
<path fill="none" stroke="black" d="M386552.31,-135.98C386577.49,-135.98 386602.66,-135.98 386627.84,-135.98"/>
<polygon fill="black" stroke="black" points="386627.87,-139.48 386637.87,-135.98 386627.87,-132.48 386627.87,-139.48"/>
</g>
<!-- attn_input_l2_dp3 -->
<g id="node1289" class="node">
<title>attn_input_l2_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="387180" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="387180" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L2</text>
<text text-anchor="middle" x="387180" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="387180" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer1_output_dp3&#45;&gt;attn_input_l2_dp3 -->
<g id="edge2166" class="edge">
<title>layer1_output_dp3&#45;&gt;attn_input_l2_dp3</title>
<path fill="none" stroke="black" d="M386976.01,-135.98C386984.23,-135.98 386992.44,-135.98 387000.66,-135.98"/>
<polygon fill="black" stroke="black" points="387000.68,-139.48 387010.68,-135.98 387000.68,-132.48 387000.68,-139.48"/>
</g>
<!-- attn_tp0_l2_dp3 -->
<g id="node1290" class="node">
<title>attn_tp0_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="388478,-161.98 388218,-161.98 388218,-109.98 388478,-109.98 388478,-161.98"/>
<text text-anchor="middle" x="388348" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L2</text>
<text text-anchor="middle" x="388348" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="388348" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="388348" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp3&#45;&gt;attn_tp0_l2_dp3 -->
<g id="edge2167" class="edge">
<title>attn_input_l2_dp3&#45;&gt;attn_tp0_l2_dp3</title>
<path fill="none" stroke="black" d="M387263.52,-161.26C387300.12,-171.09 387343.81,-181.13 387384,-185.98 387429,-191.42 388155.27,-193.33 388200,-185.98 388225.4,-181.81 388252.31,-173.85 388276.12,-165.5"/>
<polygon fill="black" stroke="black" points="388277.55,-168.71 388285.78,-162.03 388275.18,-162.12 388277.55,-168.71"/>
</g>
<!-- attn_tp1_l2_dp3 -->
<g id="node1291" class="node">
<title>attn_tp1_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="388200,-161.98 387940,-161.98 387940,-109.98 388200,-109.98 388200,-161.98"/>
<text text-anchor="middle" x="388070" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L2</text>
<text text-anchor="middle" x="388070" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="388070" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="388070" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp3&#45;&gt;attn_tp1_l2_dp3 -->
<g id="edge2168" class="edge">
<title>attn_input_l2_dp3&#45;&gt;attn_tp1_l2_dp3</title>
<path fill="none" stroke="black" d="M387263.52,-161.26C387300.12,-171.09 387343.81,-181.13 387384,-185.98 387443.35,-193.15 387863.01,-195.68 387922,-185.98 387947.4,-181.81 387974.31,-173.85 387998.12,-165.5"/>
<polygon fill="black" stroke="black" points="387999.55,-168.71 388007.78,-162.03 387997.18,-162.12 387999.55,-168.71"/>
</g>
<!-- attn_tp2_l2_dp3 -->
<g id="node1292" class="node">
<title>attn_tp2_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="387922,-161.98 387662,-161.98 387662,-109.98 387922,-109.98 387922,-161.98"/>
<text text-anchor="middle" x="387792" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L2</text>
<text text-anchor="middle" x="387792" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="387792" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="387792" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp3&#45;&gt;attn_tp2_l2_dp3 -->
<g id="edge2169" class="edge">
<title>attn_input_l2_dp3&#45;&gt;attn_tp2_l2_dp3</title>
<path fill="none" stroke="black" d="M387263.52,-161.26C387300.12,-171.09 387343.81,-181.13 387384,-185.98 387441.36,-192.91 387586.99,-195.35 387644,-185.98 387669.4,-181.81 387696.31,-173.85 387720.12,-165.5"/>
<polygon fill="black" stroke="black" points="387721.55,-168.71 387729.78,-162.03 387719.18,-162.12 387721.55,-168.71"/>
</g>
<!-- attn_tp3_l2_dp3 -->
<g id="node1293" class="node">
<title>attn_tp3_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="387644,-161.98 387384,-161.98 387384,-109.98 387644,-109.98 387644,-161.98"/>
<text text-anchor="middle" x="387514" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L2</text>
<text text-anchor="middle" x="387514" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="387514" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="387514" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l2_dp3&#45;&gt;attn_tp3_l2_dp3 -->
<g id="edge2170" class="edge">
<title>attn_input_l2_dp3&#45;&gt;attn_tp3_l2_dp3</title>
<path fill="none" stroke="black" d="M387349.28,-135.98C387357.35,-135.98 387365.42,-135.98 387373.49,-135.98"/>
<polygon fill="black" stroke="black" points="387373.7,-139.48 387383.7,-135.98 387373.7,-132.48 387373.7,-139.48"/>
</g>
<!-- allreduce_l2_dp3 -->
<g id="node1294" class="node">
<title>allreduce_l2_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="388682" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="388682" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L2</text>
<text text-anchor="middle" x="388682" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="388682" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l2_dp3&#45;&gt;allreduce_l2_dp3 -->
<g id="edge2171" class="edge">
<title>attn_tp0_l2_dp3&#45;&gt;allreduce_l2_dp3</title>
<path fill="none" stroke="black" d="M388478.14,-135.98C388486.35,-135.98 388494.56,-135.98 388502.77,-135.98"/>
<polygon fill="black" stroke="black" points="388502.78,-139.48 388512.78,-135.98 388502.78,-132.48 388502.78,-139.48"/>
</g>
<!-- attn_tp1_l2_dp3&#45;&gt;allreduce_l2_dp3 -->
<g id="edge2172" class="edge">
<title>attn_tp1_l2_dp3&#45;&gt;allreduce_l2_dp3</title>
<path fill="none" stroke="black" d="M388132.22,-162.03C388158.24,-171.59 388189.1,-181.23 388218,-185.98 388275.01,-195.35 388420.64,-192.91 388478,-185.98 388514.57,-181.57 388554.05,-172.85 388588.44,-163.91"/>
<polygon fill="black" stroke="black" points="388589.7,-167.2 388598.47,-161.26 388587.91,-160.43 388589.7,-167.2"/>
</g>
<!-- attn_tp2_l2_dp3&#45;&gt;allreduce_l2_dp3 -->
<g id="edge2173" class="edge">
<title>attn_tp2_l2_dp3&#45;&gt;allreduce_l2_dp3</title>
<path fill="none" stroke="black" d="M387854.22,-162.03C387880.24,-171.59 387911.1,-181.23 387940,-185.98 387998.98,-195.68 388418.65,-193.15 388478,-185.98 388514.57,-181.57 388554.05,-172.85 388588.44,-163.91"/>
<polygon fill="black" stroke="black" points="388589.7,-167.2 388598.47,-161.26 388587.91,-160.43 388589.7,-167.2"/>
</g>
<!-- attn_tp3_l2_dp3&#45;&gt;allreduce_l2_dp3 -->
<g id="edge2174" class="edge">
<title>attn_tp3_l2_dp3&#45;&gt;allreduce_l2_dp3</title>
<path fill="none" stroke="black" d="M387576.22,-162.03C387602.24,-171.59 387633.1,-181.23 387662,-185.98 387706.73,-193.33 388432.99,-191.42 388478,-185.98 388514.57,-181.57 388554.05,-172.85 388588.44,-163.91"/>
<polygon fill="black" stroke="black" points="388589.7,-167.2 388598.47,-161.26 388587.91,-160.43 388589.7,-167.2"/>
</g>
<!-- moe_input_l2_dp3 -->
<g id="node1295" class="node">
<title>moe_input_l2_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="389055" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="389055" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L2</text>
<text text-anchor="middle" x="389055" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="389055" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l2_dp3&#45;&gt;moe_input_l2_dp3 -->
<g id="edge2175" class="edge">
<title>allreduce_l2_dp3&#45;&gt;moe_input_l2_dp3</title>
<path fill="none" stroke="black" d="M388851.01,-135.98C388859.23,-135.98 388867.44,-135.98 388875.66,-135.98"/>
<polygon fill="black" stroke="black" points="388875.68,-139.48 388885.68,-135.98 388875.68,-132.48 388875.68,-139.48"/>
</g>
<!-- router_l2_dp3 -->
<g id="node1296" class="node">
<title>router_l2_dp3</title>
<polygon fill="lightyellow" stroke="black" points="389754.57,-176.98 389360.74,-176.98 389259.43,-94.98 389653.26,-94.98 389754.57,-176.98"/>
<text text-anchor="middle" x="389507" y="-144.48" font-family="Arial" font-size="10.00">Router L2</text>
<text text-anchor="middle" x="389507" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="389507" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l2_dp3&#45;&gt;router_l2_dp3 -->
<g id="edge2176" class="edge">
<title>moe_input_l2_dp3&#45;&gt;router_l2_dp3</title>
<path fill="none" stroke="black" d="M389224.06,-135.98C389249.34,-135.98 389274.63,-135.98 389299.92,-135.98"/>
<polygon fill="black" stroke="black" points="389299.99,-139.48 389309.99,-135.98 389299.99,-132.48 389299.99,-139.48"/>
</g>
<!-- expert0_l2_dp3 -->
<g id="node1297" class="node">
<title>expert0_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="393760.5,-161.98 393531.5,-161.98 393531.5,-109.98 393760.5,-109.98 393760.5,-161.98"/>
<text text-anchor="middle" x="393646" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L2</text>
<text text-anchor="middle" x="393646" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="393646" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="393646" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert0_l2_dp3 -->
<g id="edge2177" class="edge">
<title>router_l2_dp3&#45;&gt;expert0_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.74,-171.32C389769.09,-173.59 389790.41,-175.53 389811,-176.98 390574.79,-230.71 392490.82,-196.54 393256.5,-198.98 393374.9,-199.36 393406.17,-201.54 393522,-176.98 393536.65,-173.88 393551.99,-169.65 393566.69,-165.08"/>
<polygon fill="black" stroke="black" points="393567.78,-168.4 393576.25,-162.03 393565.66,-161.73 393567.78,-168.4"/>
<text text-anchor="middle" x="393278" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l2_dp3 -->
<g id="node1298" class="node">
<title>expert1_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="393513.5,-161.98 393284.5,-161.98 393284.5,-109.98 393513.5,-109.98 393513.5,-161.98"/>
<text text-anchor="middle" x="393399" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L2</text>
<text text-anchor="middle" x="393399" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="393399" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="393399" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert1_l2_dp3 -->
<g id="edge2178" class="edge">
<title>router_l2_dp3&#45;&gt;expert1_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.74,-171.31C389769.09,-173.58 389790.41,-175.53 389811,-176.98 390516.7,-226.81 392287.04,-196.54 392994.5,-198.98 393119.55,-199.41 393152.59,-202.54 393275,-176.98 393289.75,-173.9 393305.19,-169.66 393319.98,-165.07"/>
<polygon fill="black" stroke="black" points="393321.12,-168.37 393329.59,-162 393319,-161.7 393321.12,-168.37"/>
<text text-anchor="middle" x="393016" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l2_dp3 -->
<g id="node1299" class="node">
<title>expert2_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="393266.5,-161.98 393037.5,-161.98 393037.5,-109.98 393266.5,-109.98 393266.5,-161.98"/>
<text text-anchor="middle" x="393152" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L2</text>
<text text-anchor="middle" x="393152" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="393152" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="393152" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert2_l2_dp3 -->
<g id="edge2179" class="edge">
<title>router_l2_dp3&#45;&gt;expert2_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.74,-171.29C389769.1,-173.57 389790.41,-175.52 389811,-176.98 390455.51,-222.7 392072.37,-196.54 392718.5,-198.98 392856.4,-199.5 392892.87,-204.49 393028,-176.98 393042.85,-173.96 393058.41,-169.72 393073.28,-165.1"/>
<polygon fill="black" stroke="black" points="393074.47,-168.39 393082.94,-162.02 393072.35,-161.72 393074.47,-168.39"/>
<text text-anchor="middle" x="392740" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l2_dp3 -->
<g id="node1300" class="node">
<title>expert3_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="393019.5,-161.98 392790.5,-161.98 392790.5,-109.98 393019.5,-109.98 393019.5,-161.98"/>
<text text-anchor="middle" x="392905" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L2</text>
<text text-anchor="middle" x="392905" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="392905" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="392905" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert3_l2_dp3 -->
<g id="edge2180" class="edge">
<title>router_l2_dp3&#45;&gt;expert3_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.74,-171.27C389769.1,-173.55 389790.41,-175.51 389811,-176.98 390387.88,-218.16 391835.15,-196.54 392413.5,-198.98 392577.12,-199.67 392620.43,-208.45 392781,-176.98 392796.06,-174.03 392811.82,-169.78 392826.86,-165.11"/>
<polygon fill="black" stroke="black" points="392828.16,-168.37 392836.63,-162 392826.04,-161.7 392828.16,-168.37"/>
<text text-anchor="middle" x="392435" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l2_dp3 -->
<g id="node1301" class="node">
<title>expert4_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="392772.5,-161.98 392543.5,-161.98 392543.5,-109.98 392772.5,-109.98 392772.5,-161.98"/>
<text text-anchor="middle" x="392658" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L2</text>
<text text-anchor="middle" x="392658" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="392658" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="392658" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert4_l2_dp3 -->
<g id="edge2181" class="edge">
<title>router_l2_dp3&#45;&gt;expert4_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.74,-171.24C389769.1,-173.53 389790.42,-175.5 389811,-176.98 390307.18,-212.74 391552.04,-196.54 392049.5,-198.98 392265.05,-200.04 392322.1,-216.54 392534,-176.98 392549.27,-174.13 392565.24,-169.87 392580.45,-165.16"/>
<polygon fill="black" stroke="black" points="392581.86,-168.39 392590.32,-162.01 392579.73,-161.72 392581.86,-168.39"/>
<text text-anchor="middle" x="392071" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l2_dp3 -->
<g id="node1302" class="node">
<title>expert5_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="392525.5,-161.98 392296.5,-161.98 392296.5,-109.98 392525.5,-109.98 392525.5,-161.98"/>
<text text-anchor="middle" x="392411" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L2</text>
<text text-anchor="middle" x="392411" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="392411" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="392411" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert5_l2_dp3 -->
<g id="edge2182" class="edge">
<title>router_l2_dp3&#45;&gt;expert5_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389652.67,-176.99C389691.3,-186.08 389733.21,-194.39 389772.5,-198.98 389791.48,-201.2 389796.39,-199.07 389815.5,-198.98 390090.12,-197.76 392016.07,-221.85 392287,-176.98 392302.93,-174.34 392319.59,-170 392335.35,-165.11"/>
<polygon fill="black" stroke="black" points="392336.58,-168.39 392345.03,-162 392334.44,-161.72 392336.58,-168.39"/>
<text text-anchor="middle" x="389794" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l2_dp3 -->
<g id="node1303" class="node">
<title>expert6_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="392278.5,-161.98 392049.5,-161.98 392049.5,-109.98 392278.5,-109.98 392278.5,-161.98"/>
<text text-anchor="middle" x="392164" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L2</text>
<text text-anchor="middle" x="392164" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="392164" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="392164" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert6_l2_dp3 -->
<g id="edge2183" class="edge">
<title>router_l2_dp3&#45;&gt;expert6_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.75,-171.18C389769.1,-173.48 389790.42,-175.47 389811,-176.98 390210.29,-206.3 391212.27,-209.27 391612.5,-198.98 391802.69,-194.09 391853.01,-212.05 392040,-176.98 392055.26,-174.12 392071.24,-169.85 392086.45,-165.14"/>
<polygon fill="black" stroke="black" points="392087.85,-168.37 392096.32,-161.99 392085.73,-161.7 392087.85,-168.37"/>
<text text-anchor="middle" x="391591" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l2_dp3 -->
<g id="node1304" class="node">
<title>expert7_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="392031.5,-161.98 391802.5,-161.98 391802.5,-109.98 392031.5,-109.98 392031.5,-161.98"/>
<text text-anchor="middle" x="391917" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L2</text>
<text text-anchor="middle" x="391917" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="391917" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="391917" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert7_l2_dp3 -->
<g id="edge2184" class="edge">
<title>router_l2_dp3&#45;&gt;expert7_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389679.37,-177C389724.98,-186.1 389774.37,-194.39 389820.5,-198.98 389839.52,-200.87 389844.39,-199.09 389863.5,-198.98 390077.9,-197.76 391581.52,-212.28 391793,-176.98 391808.83,-174.34 391825.4,-170.02 391841.07,-165.16"/>
<polygon fill="black" stroke="black" points="391842.25,-168.46 391850.7,-162.07 391840.11,-161.79 391842.25,-168.46"/>
<text text-anchor="middle" x="389842" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l2_dp3 -->
<g id="node1305" class="node">
<title>expert8_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="391784.5,-161.98 391555.5,-161.98 391555.5,-109.98 391784.5,-109.98 391784.5,-161.98"/>
<text text-anchor="middle" x="391670" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L2</text>
<text text-anchor="middle" x="391670" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="391670" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="391670" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert8_l2_dp3 -->
<g id="edge2185" class="edge">
<title>router_l2_dp3&#45;&gt;expert8_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389747.34,-171.04C389768.83,-173.37 389790.29,-175.42 389811,-176.98 390106.97,-199.38 390849.79,-207.15 391146.5,-198.98 391324.26,-194.09 391371.28,-210.07 391546,-176.98 391561.17,-174.11 391577.04,-169.87 391592.16,-165.18"/>
<polygon fill="black" stroke="black" points="391593.52,-168.42 391601.98,-162.05 391591.39,-161.75 391593.52,-168.42"/>
<text text-anchor="middle" x="391125" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l2_dp3 -->
<g id="node1306" class="node">
<title>expert9_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="391537.5,-161.98 391308.5,-161.98 391308.5,-109.98 391537.5,-109.98 391537.5,-161.98"/>
<text text-anchor="middle" x="391423" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L2</text>
<text text-anchor="middle" x="391423" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="391423" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="391423" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert9_l2_dp3 -->
<g id="edge2186" class="edge">
<title>router_l2_dp3&#45;&gt;expert9_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389706.02,-177C389758.62,-186.1 389815.5,-194.4 389868.5,-198.98 389887.54,-200.63 389892.39,-199.13 389911.5,-198.98 390219.86,-196.54 390994.95,-228.42 391299,-176.98 391314.83,-174.3 391331.39,-169.97 391347.06,-165.1"/>
<polygon fill="black" stroke="black" points="391348.24,-168.4 391356.69,-162.01 391346.1,-161.74 391348.24,-168.4"/>
<text text-anchor="middle" x="389890" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l2_dp3 -->
<g id="node1307" class="node">
<title>expert10_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="391290.5,-161.98 391061.5,-161.98 391061.5,-109.98 391290.5,-109.98 391290.5,-161.98"/>
<text text-anchor="middle" x="391176" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L2</text>
<text text-anchor="middle" x="391176" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="391176" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="391176" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert10_l2_dp3 -->
<g id="edge2187" class="edge">
<title>router_l2_dp3&#45;&gt;expert10_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389746.94,-170.8C389768.57,-173.19 389790.16,-175.31 389811,-176.98 390208.73,-208.83 390309.69,-211.74 390708.5,-198.98 390861.4,-194.09 390901.82,-206.12 391052,-176.98 391067.06,-174.06 391082.83,-169.82 391097.87,-165.16"/>
<polygon fill="black" stroke="black" points="391099.17,-168.42 391107.64,-162.04 391097.05,-161.75 391099.17,-168.42"/>
<text text-anchor="middle" x="390687" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l2_dp3 -->
<g id="node1308" class="node">
<title>expert11_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="391043.5,-161.98 390814.5,-161.98 390814.5,-109.98 391043.5,-109.98 391043.5,-161.98"/>
<text text-anchor="middle" x="390929" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L2</text>
<text text-anchor="middle" x="390929" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="390929" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="390929" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert11_l2_dp3 -->
<g id="edge2188" class="edge">
<title>router_l2_dp3&#45;&gt;expert11_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389732.65,-177.01C389792.23,-186.11 389856.61,-194.4 389916.5,-198.98 390113.43,-214.04 390610.43,-210.92 390805,-176.98 390820.72,-174.24 390837.17,-169.91 390852.76,-165.06"/>
<polygon fill="black" stroke="black" points="390853.89,-168.38 390862.35,-161.99 390851.75,-161.71 390853.89,-168.38"/>
<text text-anchor="middle" x="389938" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l2_dp3 -->
<g id="node1309" class="node">
<title>expert12_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="390796.5,-161.98 390567.5,-161.98 390567.5,-109.98 390796.5,-109.98 390796.5,-161.98"/>
<text text-anchor="middle" x="390682" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L2</text>
<text text-anchor="middle" x="390682" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="390682" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="390682" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert12_l2_dp3 -->
<g id="edge2189" class="edge">
<title>router_l2_dp3&#45;&gt;expert12_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389746.57,-170.29C389768.33,-172.8 389790.05,-175.09 389811,-176.98 389811,-176.98 390558,-176.98 390558,-176.98 390572.65,-173.9 390588,-169.69 390602.7,-165.12"/>
<polygon fill="black" stroke="black" points="390603.79,-168.45 390612.26,-162.08 390601.67,-161.78 390603.79,-168.45"/>
<text text-anchor="middle" x="390305" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l2_dp3 -->
<g id="node1310" class="node">
<title>expert13_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="390549.5,-161.98 390320.5,-161.98 390320.5,-109.98 390549.5,-109.98 390549.5,-161.98"/>
<text text-anchor="middle" x="390435" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L2</text>
<text text-anchor="middle" x="390435" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="390435" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="390435" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert13_l2_dp3 -->
<g id="edge2190" class="edge">
<title>router_l2_dp3&#45;&gt;expert13_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389753.89,-176.28C389821.94,-185.66 389895.91,-194.28 389964.5,-198.98 390079.39,-206.86 390184.97,-201.98 390311,-176.98 390325.96,-174.01 390341.62,-169.78 390356.58,-165.14"/>
<polygon fill="black" stroke="black" points="390357.83,-168.41 390366.29,-162.04 390355.7,-161.74 390357.83,-168.41"/>
<text text-anchor="middle" x="389986" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l2_dp3 -->
<g id="node1311" class="node">
<title>expert14_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="390302.5,-161.98 390073.5,-161.98 390073.5,-109.98 390302.5,-109.98 390302.5,-161.98"/>
<text text-anchor="middle" x="390188" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L2</text>
<text text-anchor="middle" x="390188" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="390188" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="390188" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert14_l2_dp3 -->
<g id="edge2191" class="edge">
<title>router_l2_dp3&#45;&gt;expert14_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389732.44,-176.99C389855.58,-196.39 389995.01,-212.63 390055.5,-198.98 390083.7,-192.62 390112.94,-179.52 390136.75,-166.9"/>
<polygon fill="black" stroke="black" points="390138.48,-169.94 390145.6,-162.1 390135.14,-163.79 390138.48,-169.94"/>
<text text-anchor="middle" x="390034" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l2_dp3 -->
<g id="node1312" class="node">
<title>expert15_l2_dp3</title>
<polygon fill="lightgreen" stroke="black" points="390049.5,-161.98 389820.5,-161.98 389820.5,-109.98 390049.5,-109.98 390049.5,-161.98"/>
<text text-anchor="middle" x="389935" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L2</text>
<text text-anchor="middle" x="389935" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="389935" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="389935" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l2_dp3&#45;&gt;expert15_l2_dp3 -->
<g id="edge2192" class="edge">
<title>router_l2_dp3&#45;&gt;expert15_l2_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M389704.09,-135.98C389740.17,-135.98 389776.91,-135.98 389810.14,-135.98"/>
<polygon fill="black" stroke="black" points="389810.34,-139.48 389820.34,-135.98 389810.34,-132.48 389810.34,-139.48"/>
<text text-anchor="middle" x="389787.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l2_dp3 -->
<g id="node1313" class="node">
<title>expert_agg_l2_dp3</title>
<polygon fill="lightyellow" stroke="black" points="394291.57,-176.98 393897.74,-176.98 393796.43,-94.98 394190.26,-94.98 394291.57,-176.98"/>
<text text-anchor="middle" x="394044" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L2</text>
<text text-anchor="middle" x="394044" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="394044" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2193" class="edge">
<title>expert0_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M393760.66,-135.98C393786.06,-135.98 393811.47,-135.98 393836.87,-135.98"/>
<polygon fill="black" stroke="black" points="393836.99,-139.48 393846.99,-135.98 393836.99,-132.48 393836.99,-139.48"/>
</g>
<!-- expert1_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2194" class="edge">
<title>expert1_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M393454.24,-162.02C393477.4,-171.57 393504.96,-181.22 393531,-185.98 393581.06,-195.15 393709.3,-190.41 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert2_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2195" class="edge">
<title>expert2_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M393207.24,-162.02C393230.4,-171.57 393257.96,-181.22 393284,-185.98 393336.02,-195.51 393707.31,-190.59 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert3_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2196" class="edge">
<title>expert3_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M392960.24,-162.02C392983.4,-171.57 393010.96,-181.22 393037,-185.98 393116.02,-200.45 393679.97,-192.97 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert4_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2197" class="edge">
<title>expert4_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M392713.24,-162.02C392736.4,-171.57 392763.96,-181.22 392790,-185.98 392843.01,-195.69 393706.31,-190.67 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert5_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2198" class="edge">
<title>expert5_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M392466.24,-162.02C392489.4,-171.57 392516.96,-181.22 392543,-185.98 392609.5,-198.16 393692.64,-191.87 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert6_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2199" class="edge">
<title>expert6_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M392219.24,-162.02C392242.4,-171.57 392269.96,-181.22 392296,-185.98 392376,-200.63 393678.97,-193.06 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert7_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2200" class="edge">
<title>expert7_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M391972.24,-162.02C391995.4,-171.57 392022.96,-181.22 392049,-185.98 392095.75,-194.54 393712.65,-190.12 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert8_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2201" class="edge">
<title>expert8_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M391725.24,-162.02C391748.4,-171.57 391775.96,-181.22 391802,-185.98 391855.5,-195.78 393705.82,-190.72 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert9_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2202" class="edge">
<title>expert9_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M391478.24,-162.02C391501.4,-171.57 391528.96,-181.22 391555,-185.98 391615.25,-197.01 393698.98,-191.31 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert10_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2203" class="edge">
<title>expert10_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M391231.24,-162.02C391254.4,-171.57 391281.96,-181.22 391308,-185.98 391375,-198.25 393692.15,-191.91 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert11_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2204" class="edge">
<title>expert11_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M390984.24,-162.02C391007.4,-171.57 391034.96,-181.22 391061,-185.98 391134.75,-199.48 393685.31,-192.51 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert12_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2205" class="edge">
<title>expert12_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M390737.24,-162.02C390760.4,-171.57 390787.96,-181.22 390814,-185.98 390894.49,-200.72 393678.48,-193.1 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert13_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2206" class="edge">
<title>expert13_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M390490.24,-162.02C390513.4,-171.57 390540.96,-181.22 390567,-185.98 390610.62,-193.97 393715.82,-189.84 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert14_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2207" class="edge">
<title>expert14_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M390243.24,-162.02C390266.4,-171.57 390293.96,-181.22 390320,-185.98 390367,-194.59 393712.4,-190.14 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- expert15_l2_dp3&#45;&gt;expert_agg_l2_dp3 -->
<g id="edge2208" class="edge">
<title>expert15_l2_dp3&#45;&gt;expert_agg_l2_dp3</title>
<path fill="none" stroke="black" d="M389992.86,-162.02C390017.1,-171.58 390045.89,-181.22 390073,-185.98 390123.44,-194.84 393708.98,-190.44 393760,-185.98 393798.11,-182.65 393838.78,-176.86 393877.08,-170.36"/>
<polygon fill="black" stroke="black" points="393878.02,-173.75 393887.29,-168.6 393876.84,-166.85 393878.02,-173.75"/>
</g>
<!-- layer2_output_dp3 -->
<g id="node1314" class="node">
<title>layer2_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="394496" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="394496" y="-144.48" font-family="Arial" font-size="10.00">Layer 2 Output</text>
<text text-anchor="middle" x="394496" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="394496" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l2_dp3&#45;&gt;layer2_output_dp3 -->
<g id="edge2209" class="edge">
<title>expert_agg_l2_dp3&#45;&gt;layer2_output_dp3</title>
<path fill="none" stroke="black" d="M394241.31,-135.98C394266.49,-135.98 394291.66,-135.98 394316.84,-135.98"/>
<polygon fill="black" stroke="black" points="394316.87,-139.48 394326.87,-135.98 394316.87,-132.48 394316.87,-139.48"/>
</g>
<!-- attn_input_l3_dp3 -->
<g id="node1315" class="node">
<title>attn_input_l3_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="394869" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="394869" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L3</text>
<text text-anchor="middle" x="394869" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="394869" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer2_output_dp3&#45;&gt;attn_input_l3_dp3 -->
<g id="edge2210" class="edge">
<title>layer2_output_dp3&#45;&gt;attn_input_l3_dp3</title>
<path fill="none" stroke="black" d="M394665.01,-135.98C394673.23,-135.98 394681.44,-135.98 394689.66,-135.98"/>
<polygon fill="black" stroke="black" points="394689.68,-139.48 394699.68,-135.98 394689.68,-132.48 394689.68,-139.48"/>
</g>
<!-- attn_tp0_l3_dp3 -->
<g id="node1316" class="node">
<title>attn_tp0_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="396167,-161.98 395907,-161.98 395907,-109.98 396167,-109.98 396167,-161.98"/>
<text text-anchor="middle" x="396037" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L3</text>
<text text-anchor="middle" x="396037" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="396037" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="396037" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp3&#45;&gt;attn_tp0_l3_dp3 -->
<g id="edge2211" class="edge">
<title>attn_input_l3_dp3&#45;&gt;attn_tp0_l3_dp3</title>
<path fill="none" stroke="black" d="M394952.52,-161.26C394989.12,-171.09 395032.81,-181.13 395073,-185.98 395118,-191.42 395844.27,-193.33 395889,-185.98 395914.4,-181.81 395941.31,-173.85 395965.12,-165.5"/>
<polygon fill="black" stroke="black" points="395966.55,-168.71 395974.78,-162.03 395964.18,-162.12 395966.55,-168.71"/>
</g>
<!-- attn_tp1_l3_dp3 -->
<g id="node1317" class="node">
<title>attn_tp1_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="395889,-161.98 395629,-161.98 395629,-109.98 395889,-109.98 395889,-161.98"/>
<text text-anchor="middle" x="395759" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L3</text>
<text text-anchor="middle" x="395759" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="395759" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="395759" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp3&#45;&gt;attn_tp1_l3_dp3 -->
<g id="edge2212" class="edge">
<title>attn_input_l3_dp3&#45;&gt;attn_tp1_l3_dp3</title>
<path fill="none" stroke="black" d="M394952.52,-161.26C394989.12,-171.09 395032.81,-181.13 395073,-185.98 395132.35,-193.15 395552.01,-195.68 395611,-185.98 395636.4,-181.81 395663.31,-173.85 395687.12,-165.5"/>
<polygon fill="black" stroke="black" points="395688.55,-168.71 395696.78,-162.03 395686.18,-162.12 395688.55,-168.71"/>
</g>
<!-- attn_tp2_l3_dp3 -->
<g id="node1318" class="node">
<title>attn_tp2_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="395611,-161.98 395351,-161.98 395351,-109.98 395611,-109.98 395611,-161.98"/>
<text text-anchor="middle" x="395481" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L3</text>
<text text-anchor="middle" x="395481" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="395481" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="395481" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp3&#45;&gt;attn_tp2_l3_dp3 -->
<g id="edge2213" class="edge">
<title>attn_input_l3_dp3&#45;&gt;attn_tp2_l3_dp3</title>
<path fill="none" stroke="black" d="M394952.52,-161.26C394989.12,-171.09 395032.81,-181.13 395073,-185.98 395130.36,-192.91 395275.99,-195.35 395333,-185.98 395358.4,-181.81 395385.31,-173.85 395409.12,-165.5"/>
<polygon fill="black" stroke="black" points="395410.55,-168.71 395418.78,-162.03 395408.18,-162.12 395410.55,-168.71"/>
</g>
<!-- attn_tp3_l3_dp3 -->
<g id="node1319" class="node">
<title>attn_tp3_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="395333,-161.98 395073,-161.98 395073,-109.98 395333,-109.98 395333,-161.98"/>
<text text-anchor="middle" x="395203" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L3</text>
<text text-anchor="middle" x="395203" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="395203" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="395203" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l3_dp3&#45;&gt;attn_tp3_l3_dp3 -->
<g id="edge2214" class="edge">
<title>attn_input_l3_dp3&#45;&gt;attn_tp3_l3_dp3</title>
<path fill="none" stroke="black" d="M395038.28,-135.98C395046.35,-135.98 395054.42,-135.98 395062.49,-135.98"/>
<polygon fill="black" stroke="black" points="395062.7,-139.48 395072.7,-135.98 395062.7,-132.48 395062.7,-139.48"/>
</g>
<!-- allreduce_l3_dp3 -->
<g id="node1320" class="node">
<title>allreduce_l3_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="396371" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="396371" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L3</text>
<text text-anchor="middle" x="396371" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="396371" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l3_dp3&#45;&gt;allreduce_l3_dp3 -->
<g id="edge2215" class="edge">
<title>attn_tp0_l3_dp3&#45;&gt;allreduce_l3_dp3</title>
<path fill="none" stroke="black" d="M396167.14,-135.98C396175.35,-135.98 396183.56,-135.98 396191.77,-135.98"/>
<polygon fill="black" stroke="black" points="396191.78,-139.48 396201.78,-135.98 396191.78,-132.48 396191.78,-139.48"/>
</g>
<!-- attn_tp1_l3_dp3&#45;&gt;allreduce_l3_dp3 -->
<g id="edge2216" class="edge">
<title>attn_tp1_l3_dp3&#45;&gt;allreduce_l3_dp3</title>
<path fill="none" stroke="black" d="M395821.22,-162.03C395847.24,-171.59 395878.1,-181.23 395907,-185.98 395964.01,-195.35 396109.64,-192.91 396167,-185.98 396203.57,-181.57 396243.05,-172.85 396277.44,-163.91"/>
<polygon fill="black" stroke="black" points="396278.7,-167.2 396287.47,-161.26 396276.91,-160.43 396278.7,-167.2"/>
</g>
<!-- attn_tp2_l3_dp3&#45;&gt;allreduce_l3_dp3 -->
<g id="edge2217" class="edge">
<title>attn_tp2_l3_dp3&#45;&gt;allreduce_l3_dp3</title>
<path fill="none" stroke="black" d="M395543.22,-162.03C395569.24,-171.59 395600.1,-181.23 395629,-185.98 395687.98,-195.68 396107.65,-193.15 396167,-185.98 396203.57,-181.57 396243.05,-172.85 396277.44,-163.91"/>
<polygon fill="black" stroke="black" points="396278.7,-167.2 396287.47,-161.26 396276.91,-160.43 396278.7,-167.2"/>
</g>
<!-- attn_tp3_l3_dp3&#45;&gt;allreduce_l3_dp3 -->
<g id="edge2218" class="edge">
<title>attn_tp3_l3_dp3&#45;&gt;allreduce_l3_dp3</title>
<path fill="none" stroke="black" d="M395265.22,-162.03C395291.24,-171.59 395322.1,-181.23 395351,-185.98 395395.73,-193.33 396121.99,-191.42 396167,-185.98 396203.57,-181.57 396243.05,-172.85 396277.44,-163.91"/>
<polygon fill="black" stroke="black" points="396278.7,-167.2 396287.47,-161.26 396276.91,-160.43 396278.7,-167.2"/>
</g>
<!-- moe_input_l3_dp3 -->
<g id="node1321" class="node">
<title>moe_input_l3_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="396744" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="396744" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L3</text>
<text text-anchor="middle" x="396744" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="396744" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l3_dp3&#45;&gt;moe_input_l3_dp3 -->
<g id="edge2219" class="edge">
<title>allreduce_l3_dp3&#45;&gt;moe_input_l3_dp3</title>
<path fill="none" stroke="black" d="M396540.01,-135.98C396548.23,-135.98 396556.44,-135.98 396564.66,-135.98"/>
<polygon fill="black" stroke="black" points="396564.68,-139.48 396574.68,-135.98 396564.68,-132.48 396564.68,-139.48"/>
</g>
<!-- router_l3_dp3 -->
<g id="node1322" class="node">
<title>router_l3_dp3</title>
<polygon fill="lightyellow" stroke="black" points="397443.57,-176.98 397049.74,-176.98 396948.43,-94.98 397342.26,-94.98 397443.57,-176.98"/>
<text text-anchor="middle" x="397196" y="-144.48" font-family="Arial" font-size="10.00">Router L3</text>
<text text-anchor="middle" x="397196" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="397196" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l3_dp3&#45;&gt;router_l3_dp3 -->
<g id="edge2220" class="edge">
<title>moe_input_l3_dp3&#45;&gt;router_l3_dp3</title>
<path fill="none" stroke="black" d="M396913.06,-135.98C396938.34,-135.98 396963.63,-135.98 396988.92,-135.98"/>
<polygon fill="black" stroke="black" points="396988.99,-139.48 396998.99,-135.98 396988.99,-132.48 396988.99,-139.48"/>
</g>
<!-- expert0_l3_dp3 -->
<g id="node1323" class="node">
<title>expert0_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="401449.5,-161.98 401220.5,-161.98 401220.5,-109.98 401449.5,-109.98 401449.5,-161.98"/>
<text text-anchor="middle" x="401335" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L3</text>
<text text-anchor="middle" x="401335" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="401335" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="401335" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert0_l3_dp3 -->
<g id="edge2221" class="edge">
<title>router_l3_dp3&#45;&gt;expert0_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.74,-171.32C397458.09,-173.59 397479.41,-175.53 397500,-176.98 398260.47,-230.48 400168.15,-196.54 400930.5,-198.98 401055.55,-199.38 401088.59,-202.54 401211,-176.98 401225.75,-173.9 401241.19,-169.66 401255.98,-165.07"/>
<polygon fill="black" stroke="black" points="401257.12,-168.37 401265.59,-162 401255,-161.7 401257.12,-168.37"/>
<text text-anchor="middle" x="400952" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l3_dp3 -->
<g id="node1324" class="node">
<title>expert1_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="401202.5,-161.98 400973.5,-161.98 400973.5,-109.98 401202.5,-109.98 401202.5,-161.98"/>
<text text-anchor="middle" x="401088" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L3</text>
<text text-anchor="middle" x="401088" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="401088" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="401088" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert1_l3_dp3 -->
<g id="edge2222" class="edge">
<title>router_l3_dp3&#45;&gt;expert1_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.74,-171.31C397458.09,-173.58 397479.41,-175.53 397500,-176.98 398199.05,-226.36 399952.71,-196.54 400653.5,-198.98 400791.84,-199.47 400828.43,-204.56 400964,-176.98 400978.85,-173.96 400994.41,-169.72 401009.28,-165.11"/>
<polygon fill="black" stroke="black" points="401010.48,-168.4 401018.94,-162.03 401008.35,-161.73 401010.48,-168.4"/>
<text text-anchor="middle" x="400675" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l3_dp3 -->
<g id="node1325" class="node">
<title>expert2_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="400955.5,-161.98 400726.5,-161.98 400726.5,-109.98 400955.5,-109.98 400955.5,-161.98"/>
<text text-anchor="middle" x="400841" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L3</text>
<text text-anchor="middle" x="400841" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="400841" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="400841" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert2_l3_dp3 -->
<g id="edge2223" class="edge">
<title>router_l3_dp3&#45;&gt;expert2_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.74,-171.29C397458.1,-173.56 397479.41,-175.52 397500,-176.98 398131.21,-221.81 399714.71,-196.54 400347.5,-198.98 400512.01,-199.62 400555.55,-208.59 400717,-176.98 400732.06,-174.03 400747.82,-169.78 400762.86,-165.12"/>
<polygon fill="black" stroke="black" points="400764.17,-168.37 400772.63,-162 400762.04,-161.71 400764.17,-168.37"/>
<text text-anchor="middle" x="400369" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l3_dp3 -->
<g id="node1326" class="node">
<title>expert3_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="400708.5,-161.98 400479.5,-161.98 400479.5,-109.98 400708.5,-109.98 400708.5,-161.98"/>
<text text-anchor="middle" x="400594" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L3</text>
<text text-anchor="middle" x="400594" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="400594" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="400594" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert3_l3_dp3 -->
<g id="edge2224" class="edge">
<title>router_l3_dp3&#45;&gt;expert3_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.74,-171.27C397458.1,-173.54 397479.41,-175.51 397500,-176.98 398050.28,-216.37 399430.82,-196.54 399982.5,-198.98 400199.38,-199.94 400256.79,-216.75 400470,-176.98 400485.27,-174.14 400501.24,-169.88 400516.45,-165.17"/>
<polygon fill="black" stroke="black" points="400517.86,-168.39 400526.32,-162.01 400515.73,-161.72 400517.86,-168.39"/>
<text text-anchor="middle" x="400004" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l3_dp3 -->
<g id="node1327" class="node">
<title>expert4_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="400461.5,-161.98 400232.5,-161.98 400232.5,-109.98 400461.5,-109.98 400461.5,-161.98"/>
<text text-anchor="middle" x="400347" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L3</text>
<text text-anchor="middle" x="400347" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="400347" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="400347" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert4_l3_dp3 -->
<g id="edge2225" class="edge">
<title>router_l3_dp3&#45;&gt;expert4_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397341.67,-176.99C397380.3,-186.08 397422.21,-194.39 397461.5,-198.98 397480.48,-201.2 397485.39,-199.06 397504.5,-198.98 397806.56,-197.76 399924.97,-226.21 400223,-176.98 400238.93,-174.35 400255.6,-170.01 400271.35,-165.12"/>
<polygon fill="black" stroke="black" points="400272.58,-168.4 400281.03,-162.01 400270.44,-161.73 400272.58,-168.4"/>
<text text-anchor="middle" x="397483" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l3_dp3 -->
<g id="node1328" class="node">
<title>expert5_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="400214.5,-161.98 399985.5,-161.98 399985.5,-109.98 400214.5,-109.98 400214.5,-161.98"/>
<text text-anchor="middle" x="400100" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L3</text>
<text text-anchor="middle" x="400100" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="400100" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="400100" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert5_l3_dp3 -->
<g id="edge2226" class="edge">
<title>router_l3_dp3&#45;&gt;expert5_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.74,-171.22C397458.1,-173.51 397479.42,-175.49 397500,-176.98 397943.19,-209.18 399055.15,-196.54 399499.5,-198.98 399711.5,-200.15 399767.61,-215.98 399976,-176.98 399991.26,-174.13 400007.24,-169.86 400022.45,-165.15"/>
<polygon fill="black" stroke="black" points="400023.86,-168.37 400032.32,-162 400021.73,-161.71 400023.86,-168.37"/>
<text text-anchor="middle" x="399521" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l3_dp3 -->
<g id="node1329" class="node">
<title>expert6_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="399967.5,-161.98 399738.5,-161.98 399738.5,-109.98 399967.5,-109.98 399967.5,-161.98"/>
<text text-anchor="middle" x="399853" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L3</text>
<text text-anchor="middle" x="399853" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="399853" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="399853" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert6_l3_dp3 -->
<g id="edge2227" class="edge">
<title>router_l3_dp3&#45;&gt;expert6_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397368.37,-177C397413.98,-186.1 397463.37,-194.39 397509.5,-198.98 397528.52,-200.87 397533.39,-199.08 397552.5,-198.98 397794.34,-197.76 399490.43,-216.64 399729,-176.98 399744.84,-174.35 399761.4,-170.04 399777.07,-165.18"/>
<polygon fill="black" stroke="black" points="399778.25,-168.47 399786.7,-162.09 399776.11,-161.81 399778.25,-168.47"/>
<text text-anchor="middle" x="397531" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l3_dp3 -->
<g id="node1330" class="node">
<title>expert7_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="399720.5,-161.98 399491.5,-161.98 399491.5,-109.98 399720.5,-109.98 399720.5,-161.98"/>
<text text-anchor="middle" x="399606" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L3</text>
<text text-anchor="middle" x="399606" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="399606" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="399606" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert7_l3_dp3 -->
<g id="edge2228" class="edge">
<title>router_l3_dp3&#45;&gt;expert7_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.33,-171.1C397457.83,-173.42 397479.29,-175.44 397500,-176.98 397848.07,-202.87 398721.59,-208.3 399070.5,-198.98 399253.58,-194.09 399302.02,-210.92 399482,-176.98 399497.17,-174.12 399513.04,-169.88 399528.17,-165.2"/>
<polygon fill="black" stroke="black" points="399529.52,-168.44 399537.99,-162.07 399527.4,-161.77 399529.52,-168.44"/>
<text text-anchor="middle" x="399049" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l3_dp3 -->
<g id="node1331" class="node">
<title>expert8_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="399473.5,-161.98 399244.5,-161.98 399244.5,-109.98 399473.5,-109.98 399473.5,-161.98"/>
<text text-anchor="middle" x="399359" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L3</text>
<text text-anchor="middle" x="399359" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="399359" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="399359" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert8_l3_dp3 -->
<g id="edge2229" class="edge">
<title>router_l3_dp3&#45;&gt;expert8_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397395.02,-177C397447.62,-186.1 397504.5,-194.4 397557.5,-198.98 397576.54,-200.63 397581.39,-199.11 397600.5,-198.98 397782.12,-197.76 399055.88,-207.07 399235,-176.98 399250.83,-174.32 399267.39,-170 399283.07,-165.13"/>
<polygon fill="black" stroke="black" points="399284.24,-168.43 399292.7,-162.04 399282.1,-161.77 399284.24,-168.43"/>
<text text-anchor="middle" x="397579" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l3_dp3 -->
<g id="node1332" class="node">
<title>expert9_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="399226.5,-161.98 398997.5,-161.98 398997.5,-109.98 399226.5,-109.98 399226.5,-161.98"/>
<text text-anchor="middle" x="399112" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L3</text>
<text text-anchor="middle" x="399112" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="399112" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="399112" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert9_l3_dp3 -->
<g id="edge2230" class="edge">
<title>router_l3_dp3&#45;&gt;expert9_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397436.35,-170.96C397457.84,-173.31 397479.29,-175.38 397500,-176.98 397996.17,-215.39 398122.07,-213.82 398619.5,-198.98 398783.49,-194.09 398826.87,-207.88 398988,-176.98 399003.16,-174.08 399019.03,-169.81 399034.15,-165.12"/>
<polygon fill="black" stroke="black" points="399035.51,-168.37 399043.97,-161.99 399033.38,-161.7 399035.51,-168.37"/>
<text text-anchor="middle" x="398598" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l3_dp3 -->
<g id="node1333" class="node">
<title>expert10_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="398979.5,-161.98 398750.5,-161.98 398750.5,-109.98 398979.5,-109.98 398979.5,-161.98"/>
<text text-anchor="middle" x="398865" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L3</text>
<text text-anchor="middle" x="398865" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="398865" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="398865" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert10_l3_dp3 -->
<g id="edge2231" class="edge">
<title>router_l3_dp3&#45;&gt;expert10_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397421.65,-177.01C397481.23,-186.11 397545.61,-194.4 397605.5,-198.98 397731.32,-208.6 398616.62,-198.3 398741,-176.98 398756.73,-174.29 398773.18,-169.97 398788.78,-165.14"/>
<polygon fill="black" stroke="black" points="398789.9,-168.45 398798.36,-162.07 398787.77,-161.78 398789.9,-168.45"/>
<text text-anchor="middle" x="397627" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l3_dp3 -->
<g id="node1334" class="node">
<title>expert11_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="398732.5,-161.98 398503.5,-161.98 398503.5,-109.98 398732.5,-109.98 398732.5,-161.98"/>
<text text-anchor="middle" x="398618" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L3</text>
<text text-anchor="middle" x="398618" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="398618" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="398618" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert11_l3_dp3 -->
<g id="edge2232" class="edge">
<title>router_l3_dp3&#45;&gt;expert11_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397435.95,-170.64C397457.58,-173.07 397479.17,-175.24 397500,-176.98 397815.71,-203.39 397895.92,-211.33 398212.5,-198.98 398337.9,-194.09 398370.97,-201.75 398494,-176.98 398508.86,-173.99 398524.42,-169.77 398539.29,-165.16"/>
<polygon fill="black" stroke="black" points="398540.48,-168.45 398548.95,-162.08 398538.36,-161.78 398540.48,-168.45"/>
<text text-anchor="middle" x="398191" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l3_dp3 -->
<g id="node1335" class="node">
<title>expert12_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="398485.5,-161.98 398256.5,-161.98 398256.5,-109.98 398485.5,-109.98 398485.5,-161.98"/>
<text text-anchor="middle" x="398371" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L3</text>
<text text-anchor="middle" x="398371" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="398371" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="398371" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert12_l3_dp3 -->
<g id="edge2233" class="edge">
<title>router_l3_dp3&#45;&gt;expert12_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397442.89,-176.28C397510.94,-185.66 397584.91,-194.28 397653.5,-198.98 397785.17,-208.01 398117.14,-200.56 398247,-176.98 398262.37,-174.19 398278.45,-169.93 398293.75,-165.2"/>
<polygon fill="black" stroke="black" points="398295.21,-168.41 398303.67,-162.03 398293.08,-161.74 398295.21,-168.41"/>
<text text-anchor="middle" x="397675" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l3_dp3 -->
<g id="node1336" class="node">
<title>expert13_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="398238.5,-161.98 398009.5,-161.98 398009.5,-109.98 398238.5,-109.98 398238.5,-161.98"/>
<text text-anchor="middle" x="398124" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L3</text>
<text text-anchor="middle" x="398124" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="398124" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="398124" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert13_l3_dp3 -->
<g id="edge2234" class="edge">
<title>router_l3_dp3&#45;&gt;expert13_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397413.82,-177.02C397550.96,-197.58 397731.66,-215.02 397891.5,-198.98 397942.66,-193.85 397998.31,-179.11 398042.33,-165.18"/>
<polygon fill="black" stroke="black" points="398043.66,-168.43 398052.11,-162.04 398041.52,-161.77 398043.66,-168.43"/>
<text text-anchor="middle" x="397870" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l3_dp3 -->
<g id="node1337" class="node">
<title>expert14_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="397991.5,-161.98 397762.5,-161.98 397762.5,-109.98 397991.5,-109.98 397991.5,-161.98"/>
<text text-anchor="middle" x="397877" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L3</text>
<text text-anchor="middle" x="397877" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="397877" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="397877" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert14_l3_dp3 -->
<g id="edge2235" class="edge">
<title>router_l3_dp3&#45;&gt;expert14_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397421.44,-176.99C397544.58,-196.39 397684.01,-212.63 397744.5,-198.98 397772.7,-192.62 397801.94,-179.52 397825.75,-166.9"/>
<polygon fill="black" stroke="black" points="397827.48,-169.94 397834.6,-162.1 397824.14,-163.79 397827.48,-169.94"/>
<text text-anchor="middle" x="397723" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l3_dp3 -->
<g id="node1338" class="node">
<title>expert15_l3_dp3</title>
<polygon fill="lightgreen" stroke="black" points="397738.5,-161.98 397509.5,-161.98 397509.5,-109.98 397738.5,-109.98 397738.5,-161.98"/>
<text text-anchor="middle" x="397624" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L3</text>
<text text-anchor="middle" x="397624" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="397624" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="397624" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l3_dp3&#45;&gt;expert15_l3_dp3 -->
<g id="edge2236" class="edge">
<title>router_l3_dp3&#45;&gt;expert15_l3_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M397393.09,-135.98C397429.17,-135.98 397465.91,-135.98 397499.14,-135.98"/>
<polygon fill="black" stroke="black" points="397499.34,-139.48 397509.34,-135.98 397499.34,-132.48 397499.34,-139.48"/>
<text text-anchor="middle" x="397476.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l3_dp3 -->
<g id="node1339" class="node">
<title>expert_agg_l3_dp3</title>
<polygon fill="lightyellow" stroke="black" points="401980.57,-176.98 401586.74,-176.98 401485.43,-94.98 401879.26,-94.98 401980.57,-176.98"/>
<text text-anchor="middle" x="401733" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L3</text>
<text text-anchor="middle" x="401733" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="401733" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2237" class="edge">
<title>expert0_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M401449.66,-135.98C401475.06,-135.98 401500.47,-135.98 401525.87,-135.98"/>
<polygon fill="black" stroke="black" points="401525.99,-139.48 401535.99,-135.98 401525.99,-132.48 401525.99,-139.48"/>
</g>
<!-- expert1_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2238" class="edge">
<title>expert1_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M401143.24,-162.02C401166.4,-171.57 401193.96,-181.22 401220,-185.98 401270.06,-195.15 401398.3,-190.41 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert2_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2239" class="edge">
<title>expert2_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M400896.24,-162.02C400919.4,-171.57 400946.96,-181.22 400973,-185.98 401025.02,-195.51 401396.31,-190.59 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert3_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2240" class="edge">
<title>expert3_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M400649.24,-162.02C400672.4,-171.57 400699.96,-181.22 400726,-185.98 400805.02,-200.45 401368.97,-192.97 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert4_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2241" class="edge">
<title>expert4_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M400402.24,-162.02C400425.4,-171.57 400452.96,-181.22 400479,-185.98 400532.01,-195.69 401395.31,-190.67 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert5_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2242" class="edge">
<title>expert5_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M400155.24,-162.02C400178.4,-171.57 400205.96,-181.22 400232,-185.98 400298.5,-198.16 401381.64,-191.87 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert6_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2243" class="edge">
<title>expert6_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M399908.24,-162.02C399931.4,-171.57 399958.96,-181.22 399985,-185.98 400065,-200.63 401367.97,-193.06 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert7_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2244" class="edge">
<title>expert7_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M399661.24,-162.02C399684.4,-171.57 399711.96,-181.22 399738,-185.98 399784.75,-194.54 401401.65,-190.12 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert8_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2245" class="edge">
<title>expert8_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M399414.24,-162.02C399437.4,-171.57 399464.96,-181.22 399491,-185.98 399544.5,-195.78 401394.82,-190.72 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert9_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2246" class="edge">
<title>expert9_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M399167.24,-162.02C399190.4,-171.57 399217.96,-181.22 399244,-185.98 399304.25,-197.01 401387.98,-191.31 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert10_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2247" class="edge">
<title>expert10_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M398920.24,-162.02C398943.4,-171.57 398970.96,-181.22 398997,-185.98 399064,-198.25 401381.15,-191.91 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert11_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2248" class="edge">
<title>expert11_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M398673.24,-162.02C398696.4,-171.57 398723.96,-181.22 398750,-185.98 398823.75,-199.48 401374.31,-192.51 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert12_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2249" class="edge">
<title>expert12_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M398426.24,-162.02C398449.4,-171.57 398476.96,-181.22 398503,-185.98 398583.49,-200.72 401367.48,-193.1 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert13_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2250" class="edge">
<title>expert13_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M398179.24,-162.02C398202.4,-171.57 398229.96,-181.22 398256,-185.98 398299.62,-193.97 401404.82,-189.84 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert14_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2251" class="edge">
<title>expert14_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M397932.24,-162.02C397955.4,-171.57 397982.96,-181.22 398009,-185.98 398056,-194.59 401401.4,-190.14 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- expert15_l3_dp3&#45;&gt;expert_agg_l3_dp3 -->
<g id="edge2252" class="edge">
<title>expert15_l3_dp3&#45;&gt;expert_agg_l3_dp3</title>
<path fill="none" stroke="black" d="M397681.86,-162.02C397706.1,-171.58 397734.89,-181.22 397762,-185.98 397812.44,-194.84 401397.98,-190.44 401449,-185.98 401487.11,-182.65 401527.78,-176.86 401566.08,-170.36"/>
<polygon fill="black" stroke="black" points="401567.02,-173.75 401576.29,-168.6 401565.84,-166.85 401567.02,-173.75"/>
</g>
<!-- layer3_output_dp3 -->
<g id="node1340" class="node">
<title>layer3_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="402185" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="402185" y="-144.48" font-family="Arial" font-size="10.00">Layer 3 Output</text>
<text text-anchor="middle" x="402185" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="402185" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l3_dp3&#45;&gt;layer3_output_dp3 -->
<g id="edge2253" class="edge">
<title>expert_agg_l3_dp3&#45;&gt;layer3_output_dp3</title>
<path fill="none" stroke="black" d="M401930.31,-135.98C401955.49,-135.98 401980.66,-135.98 402005.84,-135.98"/>
<polygon fill="black" stroke="black" points="402005.87,-139.48 402015.87,-135.98 402005.87,-132.48 402005.87,-139.48"/>
</g>
<!-- attn_input_l4_dp3 -->
<g id="node1341" class="node">
<title>attn_input_l4_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="402558" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="402558" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L4</text>
<text text-anchor="middle" x="402558" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="402558" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer3_output_dp3&#45;&gt;attn_input_l4_dp3 -->
<g id="edge2254" class="edge">
<title>layer3_output_dp3&#45;&gt;attn_input_l4_dp3</title>
<path fill="none" stroke="black" d="M402354.01,-135.98C402362.23,-135.98 402370.44,-135.98 402378.66,-135.98"/>
<polygon fill="black" stroke="black" points="402378.68,-139.48 402388.68,-135.98 402378.68,-132.48 402378.68,-139.48"/>
</g>
<!-- attn_tp0_l4_dp3 -->
<g id="node1342" class="node">
<title>attn_tp0_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="403856,-161.98 403596,-161.98 403596,-109.98 403856,-109.98 403856,-161.98"/>
<text text-anchor="middle" x="403726" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L4</text>
<text text-anchor="middle" x="403726" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="403726" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="403726" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp3&#45;&gt;attn_tp0_l4_dp3 -->
<g id="edge2255" class="edge">
<title>attn_input_l4_dp3&#45;&gt;attn_tp0_l4_dp3</title>
<path fill="none" stroke="black" d="M402641.52,-161.26C402678.12,-171.09 402721.81,-181.13 402762,-185.98 402807,-191.42 403533.27,-193.33 403578,-185.98 403603.4,-181.81 403630.31,-173.85 403654.12,-165.5"/>
<polygon fill="black" stroke="black" points="403655.55,-168.71 403663.78,-162.03 403653.18,-162.12 403655.55,-168.71"/>
</g>
<!-- attn_tp1_l4_dp3 -->
<g id="node1343" class="node">
<title>attn_tp1_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="403578,-161.98 403318,-161.98 403318,-109.98 403578,-109.98 403578,-161.98"/>
<text text-anchor="middle" x="403448" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L4</text>
<text text-anchor="middle" x="403448" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="403448" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="403448" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp3&#45;&gt;attn_tp1_l4_dp3 -->
<g id="edge2256" class="edge">
<title>attn_input_l4_dp3&#45;&gt;attn_tp1_l4_dp3</title>
<path fill="none" stroke="black" d="M402641.52,-161.26C402678.12,-171.09 402721.81,-181.13 402762,-185.98 402821.35,-193.15 403241.01,-195.68 403300,-185.98 403325.4,-181.81 403352.31,-173.85 403376.12,-165.5"/>
<polygon fill="black" stroke="black" points="403377.55,-168.71 403385.78,-162.03 403375.18,-162.12 403377.55,-168.71"/>
</g>
<!-- attn_tp2_l4_dp3 -->
<g id="node1344" class="node">
<title>attn_tp2_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="403300,-161.98 403040,-161.98 403040,-109.98 403300,-109.98 403300,-161.98"/>
<text text-anchor="middle" x="403170" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L4</text>
<text text-anchor="middle" x="403170" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="403170" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="403170" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp3&#45;&gt;attn_tp2_l4_dp3 -->
<g id="edge2257" class="edge">
<title>attn_input_l4_dp3&#45;&gt;attn_tp2_l4_dp3</title>
<path fill="none" stroke="black" d="M402641.52,-161.26C402678.12,-171.09 402721.81,-181.13 402762,-185.98 402819.36,-192.91 402964.99,-195.35 403022,-185.98 403047.4,-181.81 403074.31,-173.85 403098.12,-165.5"/>
<polygon fill="black" stroke="black" points="403099.55,-168.71 403107.78,-162.03 403097.18,-162.12 403099.55,-168.71"/>
</g>
<!-- attn_tp3_l4_dp3 -->
<g id="node1345" class="node">
<title>attn_tp3_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="403022,-161.98 402762,-161.98 402762,-109.98 403022,-109.98 403022,-161.98"/>
<text text-anchor="middle" x="402892" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L4</text>
<text text-anchor="middle" x="402892" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="402892" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="402892" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l4_dp3&#45;&gt;attn_tp3_l4_dp3 -->
<g id="edge2258" class="edge">
<title>attn_input_l4_dp3&#45;&gt;attn_tp3_l4_dp3</title>
<path fill="none" stroke="black" d="M402727.28,-135.98C402735.35,-135.98 402743.42,-135.98 402751.49,-135.98"/>
<polygon fill="black" stroke="black" points="402751.7,-139.48 402761.7,-135.98 402751.7,-132.48 402751.7,-139.48"/>
</g>
<!-- allreduce_l4_dp3 -->
<g id="node1346" class="node">
<title>allreduce_l4_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="404060" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="404060" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L4</text>
<text text-anchor="middle" x="404060" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="404060" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l4_dp3&#45;&gt;allreduce_l4_dp3 -->
<g id="edge2259" class="edge">
<title>attn_tp0_l4_dp3&#45;&gt;allreduce_l4_dp3</title>
<path fill="none" stroke="black" d="M403856.14,-135.98C403864.35,-135.98 403872.56,-135.98 403880.77,-135.98"/>
<polygon fill="black" stroke="black" points="403880.78,-139.48 403890.78,-135.98 403880.78,-132.48 403880.78,-139.48"/>
</g>
<!-- attn_tp1_l4_dp3&#45;&gt;allreduce_l4_dp3 -->
<g id="edge2260" class="edge">
<title>attn_tp1_l4_dp3&#45;&gt;allreduce_l4_dp3</title>
<path fill="none" stroke="black" d="M403510.22,-162.03C403536.24,-171.59 403567.1,-181.23 403596,-185.98 403653.01,-195.35 403798.64,-192.91 403856,-185.98 403892.57,-181.57 403932.05,-172.85 403966.44,-163.91"/>
<polygon fill="black" stroke="black" points="403967.7,-167.2 403976.47,-161.26 403965.91,-160.43 403967.7,-167.2"/>
</g>
<!-- attn_tp2_l4_dp3&#45;&gt;allreduce_l4_dp3 -->
<g id="edge2261" class="edge">
<title>attn_tp2_l4_dp3&#45;&gt;allreduce_l4_dp3</title>
<path fill="none" stroke="black" d="M403232.22,-162.03C403258.24,-171.59 403289.1,-181.23 403318,-185.98 403376.98,-195.68 403796.65,-193.15 403856,-185.98 403892.57,-181.57 403932.05,-172.85 403966.44,-163.91"/>
<polygon fill="black" stroke="black" points="403967.7,-167.2 403976.47,-161.26 403965.91,-160.43 403967.7,-167.2"/>
</g>
<!-- attn_tp3_l4_dp3&#45;&gt;allreduce_l4_dp3 -->
<g id="edge2262" class="edge">
<title>attn_tp3_l4_dp3&#45;&gt;allreduce_l4_dp3</title>
<path fill="none" stroke="black" d="M402954.22,-162.03C402980.24,-171.59 403011.1,-181.23 403040,-185.98 403084.73,-193.33 403810.99,-191.42 403856,-185.98 403892.57,-181.57 403932.05,-172.85 403966.44,-163.91"/>
<polygon fill="black" stroke="black" points="403967.7,-167.2 403976.47,-161.26 403965.91,-160.43 403967.7,-167.2"/>
</g>
<!-- moe_input_l4_dp3 -->
<g id="node1347" class="node">
<title>moe_input_l4_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="404433" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="404433" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L4</text>
<text text-anchor="middle" x="404433" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="404433" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l4_dp3&#45;&gt;moe_input_l4_dp3 -->
<g id="edge2263" class="edge">
<title>allreduce_l4_dp3&#45;&gt;moe_input_l4_dp3</title>
<path fill="none" stroke="black" d="M404229.01,-135.98C404237.23,-135.98 404245.44,-135.98 404253.66,-135.98"/>
<polygon fill="black" stroke="black" points="404253.68,-139.48 404263.68,-135.98 404253.68,-132.48 404253.68,-139.48"/>
</g>
<!-- router_l4_dp3 -->
<g id="node1348" class="node">
<title>router_l4_dp3</title>
<polygon fill="lightyellow" stroke="black" points="405132.57,-176.98 404738.74,-176.98 404637.43,-94.98 405031.26,-94.98 405132.57,-176.98"/>
<text text-anchor="middle" x="404885" y="-144.48" font-family="Arial" font-size="10.00">Router L4</text>
<text text-anchor="middle" x="404885" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="404885" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l4_dp3&#45;&gt;router_l4_dp3 -->
<g id="edge2264" class="edge">
<title>moe_input_l4_dp3&#45;&gt;router_l4_dp3</title>
<path fill="none" stroke="black" d="M404602.06,-135.98C404627.34,-135.98 404652.63,-135.98 404677.92,-135.98"/>
<polygon fill="black" stroke="black" points="404677.99,-139.48 404687.99,-135.98 404677.99,-132.48 404677.99,-139.48"/>
</g>
<!-- expert0_l4_dp3 -->
<g id="node1349" class="node">
<title>expert0_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="409138.5,-161.98 408909.5,-161.98 408909.5,-109.98 409138.5,-109.98 409138.5,-161.98"/>
<text text-anchor="middle" x="409024" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L4</text>
<text text-anchor="middle" x="409024" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="409024" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="409024" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert0_l4_dp3 -->
<g id="edge2265" class="edge">
<title>router_l4_dp3&#45;&gt;expert0_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.74,-171.32C405147.09,-173.59 405168.41,-175.53 405189,-176.98 405952.79,-230.71 407868.82,-196.54 408634.5,-198.98 408752.9,-199.36 408784.17,-201.54 408900,-176.98 408914.65,-173.88 408929.99,-169.65 408944.69,-165.08"/>
<polygon fill="black" stroke="black" points="408945.78,-168.4 408954.25,-162.03 408943.66,-161.73 408945.78,-168.4"/>
<text text-anchor="middle" x="408656" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l4_dp3 -->
<g id="node1350" class="node">
<title>expert1_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="408891.5,-161.98 408662.5,-161.98 408662.5,-109.98 408891.5,-109.98 408891.5,-161.98"/>
<text text-anchor="middle" x="408777" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L4</text>
<text text-anchor="middle" x="408777" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="408777" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="408777" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert1_l4_dp3 -->
<g id="edge2266" class="edge">
<title>router_l4_dp3&#45;&gt;expert1_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.74,-171.31C405147.09,-173.58 405168.41,-175.53 405189,-176.98 405894.7,-226.81 407665.04,-196.54 408372.5,-198.98 408497.55,-199.41 408530.59,-202.54 408653,-176.98 408667.75,-173.9 408683.19,-169.66 408697.98,-165.07"/>
<polygon fill="black" stroke="black" points="408699.12,-168.37 408707.59,-162 408697,-161.7 408699.12,-168.37"/>
<text text-anchor="middle" x="408394" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l4_dp3 -->
<g id="node1351" class="node">
<title>expert2_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="408644.5,-161.98 408415.5,-161.98 408415.5,-109.98 408644.5,-109.98 408644.5,-161.98"/>
<text text-anchor="middle" x="408530" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L4</text>
<text text-anchor="middle" x="408530" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="408530" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="408530" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert2_l4_dp3 -->
<g id="edge2267" class="edge">
<title>router_l4_dp3&#45;&gt;expert2_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.74,-171.29C405147.1,-173.57 405168.41,-175.52 405189,-176.98 405833.51,-222.7 407450.37,-196.54 408096.5,-198.98 408234.4,-199.5 408270.87,-204.49 408406,-176.98 408420.85,-173.96 408436.41,-169.72 408451.28,-165.1"/>
<polygon fill="black" stroke="black" points="408452.47,-168.39 408460.94,-162.02 408450.35,-161.72 408452.47,-168.39"/>
<text text-anchor="middle" x="408118" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l4_dp3 -->
<g id="node1352" class="node">
<title>expert3_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="408397.5,-161.98 408168.5,-161.98 408168.5,-109.98 408397.5,-109.98 408397.5,-161.98"/>
<text text-anchor="middle" x="408283" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L4</text>
<text text-anchor="middle" x="408283" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="408283" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="408283" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert3_l4_dp3 -->
<g id="edge2268" class="edge">
<title>router_l4_dp3&#45;&gt;expert3_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.74,-171.27C405147.1,-173.55 405168.41,-175.51 405189,-176.98 405765.88,-218.16 407213.15,-196.54 407791.5,-198.98 407955.12,-199.67 407998.43,-208.45 408159,-176.98 408174.06,-174.03 408189.82,-169.78 408204.86,-165.11"/>
<polygon fill="black" stroke="black" points="408206.16,-168.37 408214.63,-162 408204.04,-161.7 408206.16,-168.37"/>
<text text-anchor="middle" x="407813" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l4_dp3 -->
<g id="node1353" class="node">
<title>expert4_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="408150.5,-161.98 407921.5,-161.98 407921.5,-109.98 408150.5,-109.98 408150.5,-161.98"/>
<text text-anchor="middle" x="408036" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L4</text>
<text text-anchor="middle" x="408036" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="408036" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="408036" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert4_l4_dp3 -->
<g id="edge2269" class="edge">
<title>router_l4_dp3&#45;&gt;expert4_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.74,-171.24C405147.1,-173.53 405168.42,-175.5 405189,-176.98 405685.18,-212.74 406930.04,-196.54 407427.5,-198.98 407643.05,-200.04 407700.1,-216.54 407912,-176.98 407927.27,-174.13 407943.24,-169.87 407958.45,-165.16"/>
<polygon fill="black" stroke="black" points="407959.86,-168.39 407968.32,-162.01 407957.73,-161.72 407959.86,-168.39"/>
<text text-anchor="middle" x="407449" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l4_dp3 -->
<g id="node1354" class="node">
<title>expert5_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="407903.5,-161.98 407674.5,-161.98 407674.5,-109.98 407903.5,-109.98 407903.5,-161.98"/>
<text text-anchor="middle" x="407789" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L4</text>
<text text-anchor="middle" x="407789" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="407789" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="407789" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert5_l4_dp3 -->
<g id="edge2270" class="edge">
<title>router_l4_dp3&#45;&gt;expert5_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405030.67,-176.99C405069.3,-186.08 405111.21,-194.39 405150.5,-198.98 405169.48,-201.2 405174.39,-199.07 405193.5,-198.98 405468.12,-197.76 407394.07,-221.85 407665,-176.98 407680.93,-174.34 407697.59,-170 407713.35,-165.11"/>
<polygon fill="black" stroke="black" points="407714.58,-168.39 407723.03,-162 407712.44,-161.72 407714.58,-168.39"/>
<text text-anchor="middle" x="405172" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l4_dp3 -->
<g id="node1355" class="node">
<title>expert6_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="407656.5,-161.98 407427.5,-161.98 407427.5,-109.98 407656.5,-109.98 407656.5,-161.98"/>
<text text-anchor="middle" x="407542" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L4</text>
<text text-anchor="middle" x="407542" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="407542" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="407542" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert6_l4_dp3 -->
<g id="edge2271" class="edge">
<title>router_l4_dp3&#45;&gt;expert6_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.75,-171.18C405147.1,-173.48 405168.42,-175.47 405189,-176.98 405588.29,-206.3 406590.27,-209.27 406990.5,-198.98 407180.69,-194.09 407231.01,-212.05 407418,-176.98 407433.26,-174.12 407449.24,-169.85 407464.45,-165.14"/>
<polygon fill="black" stroke="black" points="407465.85,-168.37 407474.32,-161.99 407463.73,-161.7 407465.85,-168.37"/>
<text text-anchor="middle" x="406969" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l4_dp3 -->
<g id="node1356" class="node">
<title>expert7_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="407409.5,-161.98 407180.5,-161.98 407180.5,-109.98 407409.5,-109.98 407409.5,-161.98"/>
<text text-anchor="middle" x="407295" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L4</text>
<text text-anchor="middle" x="407295" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="407295" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="407295" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert7_l4_dp3 -->
<g id="edge2272" class="edge">
<title>router_l4_dp3&#45;&gt;expert7_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405057.37,-177C405102.98,-186.1 405152.37,-194.39 405198.5,-198.98 405217.52,-200.87 405222.39,-199.09 405241.5,-198.98 405455.9,-197.76 406959.52,-212.28 407171,-176.98 407186.83,-174.34 407203.4,-170.02 407219.07,-165.16"/>
<polygon fill="black" stroke="black" points="407220.25,-168.46 407228.7,-162.07 407218.11,-161.79 407220.25,-168.46"/>
<text text-anchor="middle" x="405220" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l4_dp3 -->
<g id="node1357" class="node">
<title>expert8_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="407162.5,-161.98 406933.5,-161.98 406933.5,-109.98 407162.5,-109.98 407162.5,-161.98"/>
<text text-anchor="middle" x="407048" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L4</text>
<text text-anchor="middle" x="407048" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="407048" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="407048" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert8_l4_dp3 -->
<g id="edge2273" class="edge">
<title>router_l4_dp3&#45;&gt;expert8_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405125.34,-171.04C405146.83,-173.37 405168.29,-175.42 405189,-176.98 405484.97,-199.38 406227.79,-207.15 406524.5,-198.98 406702.26,-194.09 406749.28,-210.07 406924,-176.98 406939.17,-174.11 406955.04,-169.87 406970.16,-165.18"/>
<polygon fill="black" stroke="black" points="406971.52,-168.42 406979.98,-162.05 406969.39,-161.75 406971.52,-168.42"/>
<text text-anchor="middle" x="406503" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l4_dp3 -->
<g id="node1358" class="node">
<title>expert9_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="406915.5,-161.98 406686.5,-161.98 406686.5,-109.98 406915.5,-109.98 406915.5,-161.98"/>
<text text-anchor="middle" x="406801" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L4</text>
<text text-anchor="middle" x="406801" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="406801" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="406801" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert9_l4_dp3 -->
<g id="edge2274" class="edge">
<title>router_l4_dp3&#45;&gt;expert9_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405084.02,-177C405136.62,-186.1 405193.5,-194.4 405246.5,-198.98 405265.54,-200.63 405270.39,-199.13 405289.5,-198.98 405597.86,-196.54 406372.95,-228.42 406677,-176.98 406692.83,-174.3 406709.39,-169.97 406725.06,-165.1"/>
<polygon fill="black" stroke="black" points="406726.24,-168.4 406734.69,-162.01 406724.1,-161.74 406726.24,-168.4"/>
<text text-anchor="middle" x="405268" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l4_dp3 -->
<g id="node1359" class="node">
<title>expert10_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="406668.5,-161.98 406439.5,-161.98 406439.5,-109.98 406668.5,-109.98 406668.5,-161.98"/>
<text text-anchor="middle" x="406554" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L4</text>
<text text-anchor="middle" x="406554" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="406554" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="406554" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert10_l4_dp3 -->
<g id="edge2275" class="edge">
<title>router_l4_dp3&#45;&gt;expert10_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405124.94,-170.8C405146.57,-173.19 405168.16,-175.31 405189,-176.98 405586.73,-208.83 405687.69,-211.74 406086.5,-198.98 406239.4,-194.09 406279.82,-206.12 406430,-176.98 406445.06,-174.06 406460.83,-169.82 406475.87,-165.16"/>
<polygon fill="black" stroke="black" points="406477.17,-168.42 406485.64,-162.04 406475.05,-161.75 406477.17,-168.42"/>
<text text-anchor="middle" x="406065" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l4_dp3 -->
<g id="node1360" class="node">
<title>expert11_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="406421.5,-161.98 406192.5,-161.98 406192.5,-109.98 406421.5,-109.98 406421.5,-161.98"/>
<text text-anchor="middle" x="406307" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L4</text>
<text text-anchor="middle" x="406307" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="406307" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="406307" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert11_l4_dp3 -->
<g id="edge2276" class="edge">
<title>router_l4_dp3&#45;&gt;expert11_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405110.65,-177.01C405170.23,-186.11 405234.61,-194.4 405294.5,-198.98 405491.43,-214.04 405988.43,-210.92 406183,-176.98 406198.72,-174.24 406215.17,-169.91 406230.76,-165.06"/>
<polygon fill="black" stroke="black" points="406231.89,-168.38 406240.35,-161.99 406229.75,-161.71 406231.89,-168.38"/>
<text text-anchor="middle" x="405316" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l4_dp3 -->
<g id="node1361" class="node">
<title>expert12_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="406174.5,-161.98 405945.5,-161.98 405945.5,-109.98 406174.5,-109.98 406174.5,-161.98"/>
<text text-anchor="middle" x="406060" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L4</text>
<text text-anchor="middle" x="406060" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="406060" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="406060" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert12_l4_dp3 -->
<g id="edge2277" class="edge">
<title>router_l4_dp3&#45;&gt;expert12_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405124.57,-170.29C405146.33,-172.8 405168.05,-175.09 405189,-176.98 405189,-176.98 405936,-176.98 405936,-176.98 405950.65,-173.9 405966,-169.69 405980.7,-165.12"/>
<polygon fill="black" stroke="black" points="405981.79,-168.45 405990.26,-162.08 405979.67,-161.78 405981.79,-168.45"/>
<text text-anchor="middle" x="405683" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l4_dp3 -->
<g id="node1362" class="node">
<title>expert13_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="405927.5,-161.98 405698.5,-161.98 405698.5,-109.98 405927.5,-109.98 405927.5,-161.98"/>
<text text-anchor="middle" x="405813" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L4</text>
<text text-anchor="middle" x="405813" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="405813" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="405813" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert13_l4_dp3 -->
<g id="edge2278" class="edge">
<title>router_l4_dp3&#45;&gt;expert13_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405131.89,-176.28C405199.94,-185.66 405273.91,-194.28 405342.5,-198.98 405457.39,-206.86 405562.97,-201.98 405689,-176.98 405703.96,-174.01 405719.62,-169.78 405734.58,-165.14"/>
<polygon fill="black" stroke="black" points="405735.83,-168.41 405744.29,-162.04 405733.7,-161.74 405735.83,-168.41"/>
<text text-anchor="middle" x="405364" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l4_dp3 -->
<g id="node1363" class="node">
<title>expert14_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="405680.5,-161.98 405451.5,-161.98 405451.5,-109.98 405680.5,-109.98 405680.5,-161.98"/>
<text text-anchor="middle" x="405566" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L4</text>
<text text-anchor="middle" x="405566" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="405566" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="405566" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert14_l4_dp3 -->
<g id="edge2279" class="edge">
<title>router_l4_dp3&#45;&gt;expert14_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405110.44,-176.99C405233.58,-196.39 405373.01,-212.63 405433.5,-198.98 405461.7,-192.62 405490.94,-179.52 405514.75,-166.9"/>
<polygon fill="black" stroke="black" points="405516.48,-169.94 405523.6,-162.1 405513.14,-163.79 405516.48,-169.94"/>
<text text-anchor="middle" x="405412" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l4_dp3 -->
<g id="node1364" class="node">
<title>expert15_l4_dp3</title>
<polygon fill="lightgreen" stroke="black" points="405427.5,-161.98 405198.5,-161.98 405198.5,-109.98 405427.5,-109.98 405427.5,-161.98"/>
<text text-anchor="middle" x="405313" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L4</text>
<text text-anchor="middle" x="405313" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="405313" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="405313" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l4_dp3&#45;&gt;expert15_l4_dp3 -->
<g id="edge2280" class="edge">
<title>router_l4_dp3&#45;&gt;expert15_l4_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M405082.09,-135.98C405118.17,-135.98 405154.91,-135.98 405188.14,-135.98"/>
<polygon fill="black" stroke="black" points="405188.34,-139.48 405198.34,-135.98 405188.34,-132.48 405188.34,-139.48"/>
<text text-anchor="middle" x="405165.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l4_dp3 -->
<g id="node1365" class="node">
<title>expert_agg_l4_dp3</title>
<polygon fill="lightyellow" stroke="black" points="409669.57,-176.98 409275.74,-176.98 409174.43,-94.98 409568.26,-94.98 409669.57,-176.98"/>
<text text-anchor="middle" x="409422" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L4</text>
<text text-anchor="middle" x="409422" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="409422" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2281" class="edge">
<title>expert0_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M409138.66,-135.98C409164.06,-135.98 409189.47,-135.98 409214.87,-135.98"/>
<polygon fill="black" stroke="black" points="409214.99,-139.48 409224.99,-135.98 409214.99,-132.48 409214.99,-139.48"/>
</g>
<!-- expert1_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2282" class="edge">
<title>expert1_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M408832.24,-162.02C408855.4,-171.57 408882.96,-181.22 408909,-185.98 408959.06,-195.15 409087.3,-190.41 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert2_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2283" class="edge">
<title>expert2_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M408585.24,-162.02C408608.4,-171.57 408635.96,-181.22 408662,-185.98 408714.02,-195.51 409085.31,-190.59 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert3_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2284" class="edge">
<title>expert3_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M408338.24,-162.02C408361.4,-171.57 408388.96,-181.22 408415,-185.98 408494.02,-200.45 409057.97,-192.97 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert4_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2285" class="edge">
<title>expert4_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M408091.24,-162.02C408114.4,-171.57 408141.96,-181.22 408168,-185.98 408221.01,-195.69 409084.31,-190.67 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert5_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2286" class="edge">
<title>expert5_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M407844.24,-162.02C407867.4,-171.57 407894.96,-181.22 407921,-185.98 407987.5,-198.16 409070.64,-191.87 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert6_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2287" class="edge">
<title>expert6_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M407597.24,-162.02C407620.4,-171.57 407647.96,-181.22 407674,-185.98 407754,-200.63 409056.97,-193.06 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert7_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2288" class="edge">
<title>expert7_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M407350.24,-162.02C407373.4,-171.57 407400.96,-181.22 407427,-185.98 407473.75,-194.54 409090.65,-190.12 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert8_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2289" class="edge">
<title>expert8_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M407103.24,-162.02C407126.4,-171.57 407153.96,-181.22 407180,-185.98 407233.5,-195.78 409083.82,-190.72 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert9_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2290" class="edge">
<title>expert9_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M406856.24,-162.02C406879.4,-171.57 406906.96,-181.22 406933,-185.98 406993.25,-197.01 409076.98,-191.31 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert10_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2291" class="edge">
<title>expert10_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M406609.24,-162.02C406632.4,-171.57 406659.96,-181.22 406686,-185.98 406753,-198.25 409070.15,-191.91 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert11_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2292" class="edge">
<title>expert11_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M406362.24,-162.02C406385.4,-171.57 406412.96,-181.22 406439,-185.98 406512.75,-199.48 409063.31,-192.51 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert12_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2293" class="edge">
<title>expert12_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M406115.24,-162.02C406138.4,-171.57 406165.96,-181.22 406192,-185.98 406272.49,-200.72 409056.48,-193.1 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert13_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2294" class="edge">
<title>expert13_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M405868.24,-162.02C405891.4,-171.57 405918.96,-181.22 405945,-185.98 405988.62,-193.97 409093.82,-189.84 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert14_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2295" class="edge">
<title>expert14_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M405621.24,-162.02C405644.4,-171.57 405671.96,-181.22 405698,-185.98 405745,-194.59 409090.4,-190.14 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- expert15_l4_dp3&#45;&gt;expert_agg_l4_dp3 -->
<g id="edge2296" class="edge">
<title>expert15_l4_dp3&#45;&gt;expert_agg_l4_dp3</title>
<path fill="none" stroke="black" d="M405370.86,-162.02C405395.1,-171.58 405423.89,-181.22 405451,-185.98 405501.44,-194.84 409086.98,-190.44 409138,-185.98 409176.11,-182.65 409216.78,-176.86 409255.08,-170.36"/>
<polygon fill="black" stroke="black" points="409256.02,-173.75 409265.29,-168.6 409254.84,-166.85 409256.02,-173.75"/>
</g>
<!-- layer4_output_dp3 -->
<g id="node1366" class="node">
<title>layer4_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="409874" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="409874" y="-144.48" font-family="Arial" font-size="10.00">Layer 4 Output</text>
<text text-anchor="middle" x="409874" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="409874" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l4_dp3&#45;&gt;layer4_output_dp3 -->
<g id="edge2297" class="edge">
<title>expert_agg_l4_dp3&#45;&gt;layer4_output_dp3</title>
<path fill="none" stroke="black" d="M409619.31,-135.98C409644.49,-135.98 409669.66,-135.98 409694.84,-135.98"/>
<polygon fill="black" stroke="black" points="409694.87,-139.48 409704.87,-135.98 409694.87,-132.48 409694.87,-139.48"/>
</g>
<!-- attn_input_l5_dp3 -->
<g id="node1367" class="node">
<title>attn_input_l5_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="410247" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="410247" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L5</text>
<text text-anchor="middle" x="410247" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="410247" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer4_output_dp3&#45;&gt;attn_input_l5_dp3 -->
<g id="edge2298" class="edge">
<title>layer4_output_dp3&#45;&gt;attn_input_l5_dp3</title>
<path fill="none" stroke="black" d="M410043.01,-135.98C410051.23,-135.98 410059.44,-135.98 410067.66,-135.98"/>
<polygon fill="black" stroke="black" points="410067.68,-139.48 410077.68,-135.98 410067.68,-132.48 410067.68,-139.48"/>
</g>
<!-- attn_tp0_l5_dp3 -->
<g id="node1368" class="node">
<title>attn_tp0_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="411545,-161.98 411285,-161.98 411285,-109.98 411545,-109.98 411545,-161.98"/>
<text text-anchor="middle" x="411415" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L5</text>
<text text-anchor="middle" x="411415" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="411415" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="411415" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp3&#45;&gt;attn_tp0_l5_dp3 -->
<g id="edge2299" class="edge">
<title>attn_input_l5_dp3&#45;&gt;attn_tp0_l5_dp3</title>
<path fill="none" stroke="black" d="M410330.52,-161.26C410367.12,-171.09 410410.81,-181.13 410451,-185.98 410496,-191.42 411222.27,-193.33 411267,-185.98 411292.4,-181.81 411319.31,-173.85 411343.12,-165.5"/>
<polygon fill="black" stroke="black" points="411344.55,-168.71 411352.78,-162.03 411342.18,-162.12 411344.55,-168.71"/>
</g>
<!-- attn_tp1_l5_dp3 -->
<g id="node1369" class="node">
<title>attn_tp1_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="411267,-161.98 411007,-161.98 411007,-109.98 411267,-109.98 411267,-161.98"/>
<text text-anchor="middle" x="411137" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L5</text>
<text text-anchor="middle" x="411137" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="411137" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="411137" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp3&#45;&gt;attn_tp1_l5_dp3 -->
<g id="edge2300" class="edge">
<title>attn_input_l5_dp3&#45;&gt;attn_tp1_l5_dp3</title>
<path fill="none" stroke="black" d="M410330.52,-161.26C410367.12,-171.09 410410.81,-181.13 410451,-185.98 410510.35,-193.15 410930.01,-195.68 410989,-185.98 411014.4,-181.81 411041.31,-173.85 411065.12,-165.5"/>
<polygon fill="black" stroke="black" points="411066.55,-168.71 411074.78,-162.03 411064.18,-162.12 411066.55,-168.71"/>
</g>
<!-- attn_tp2_l5_dp3 -->
<g id="node1370" class="node">
<title>attn_tp2_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="410989,-161.98 410729,-161.98 410729,-109.98 410989,-109.98 410989,-161.98"/>
<text text-anchor="middle" x="410859" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L5</text>
<text text-anchor="middle" x="410859" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="410859" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="410859" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp3&#45;&gt;attn_tp2_l5_dp3 -->
<g id="edge2301" class="edge">
<title>attn_input_l5_dp3&#45;&gt;attn_tp2_l5_dp3</title>
<path fill="none" stroke="black" d="M410330.52,-161.26C410367.12,-171.09 410410.81,-181.13 410451,-185.98 410508.36,-192.91 410653.99,-195.35 410711,-185.98 410736.4,-181.81 410763.31,-173.85 410787.12,-165.5"/>
<polygon fill="black" stroke="black" points="410788.55,-168.71 410796.78,-162.03 410786.18,-162.12 410788.55,-168.71"/>
</g>
<!-- attn_tp3_l5_dp3 -->
<g id="node1371" class="node">
<title>attn_tp3_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="410711,-161.98 410451,-161.98 410451,-109.98 410711,-109.98 410711,-161.98"/>
<text text-anchor="middle" x="410581" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L5</text>
<text text-anchor="middle" x="410581" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="410581" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="410581" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l5_dp3&#45;&gt;attn_tp3_l5_dp3 -->
<g id="edge2302" class="edge">
<title>attn_input_l5_dp3&#45;&gt;attn_tp3_l5_dp3</title>
<path fill="none" stroke="black" d="M410416.28,-135.98C410424.35,-135.98 410432.42,-135.98 410440.49,-135.98"/>
<polygon fill="black" stroke="black" points="410440.7,-139.48 410450.7,-135.98 410440.7,-132.48 410440.7,-139.48"/>
</g>
<!-- allreduce_l5_dp3 -->
<g id="node1372" class="node">
<title>allreduce_l5_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="411749" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="411749" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L5</text>
<text text-anchor="middle" x="411749" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="411749" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l5_dp3&#45;&gt;allreduce_l5_dp3 -->
<g id="edge2303" class="edge">
<title>attn_tp0_l5_dp3&#45;&gt;allreduce_l5_dp3</title>
<path fill="none" stroke="black" d="M411545.14,-135.98C411553.35,-135.98 411561.56,-135.98 411569.77,-135.98"/>
<polygon fill="black" stroke="black" points="411569.78,-139.48 411579.78,-135.98 411569.78,-132.48 411569.78,-139.48"/>
</g>
<!-- attn_tp1_l5_dp3&#45;&gt;allreduce_l5_dp3 -->
<g id="edge2304" class="edge">
<title>attn_tp1_l5_dp3&#45;&gt;allreduce_l5_dp3</title>
<path fill="none" stroke="black" d="M411199.22,-162.03C411225.24,-171.59 411256.1,-181.23 411285,-185.98 411342.01,-195.35 411487.64,-192.91 411545,-185.98 411581.57,-181.57 411621.05,-172.85 411655.44,-163.91"/>
<polygon fill="black" stroke="black" points="411656.7,-167.2 411665.47,-161.26 411654.91,-160.43 411656.7,-167.2"/>
</g>
<!-- attn_tp2_l5_dp3&#45;&gt;allreduce_l5_dp3 -->
<g id="edge2305" class="edge">
<title>attn_tp2_l5_dp3&#45;&gt;allreduce_l5_dp3</title>
<path fill="none" stroke="black" d="M410921.22,-162.03C410947.24,-171.59 410978.1,-181.23 411007,-185.98 411065.98,-195.68 411485.65,-193.15 411545,-185.98 411581.57,-181.57 411621.05,-172.85 411655.44,-163.91"/>
<polygon fill="black" stroke="black" points="411656.7,-167.2 411665.47,-161.26 411654.91,-160.43 411656.7,-167.2"/>
</g>
<!-- attn_tp3_l5_dp3&#45;&gt;allreduce_l5_dp3 -->
<g id="edge2306" class="edge">
<title>attn_tp3_l5_dp3&#45;&gt;allreduce_l5_dp3</title>
<path fill="none" stroke="black" d="M410643.22,-162.03C410669.24,-171.59 410700.1,-181.23 410729,-185.98 410773.73,-193.33 411499.99,-191.42 411545,-185.98 411581.57,-181.57 411621.05,-172.85 411655.44,-163.91"/>
<polygon fill="black" stroke="black" points="411656.7,-167.2 411665.47,-161.26 411654.91,-160.43 411656.7,-167.2"/>
</g>
<!-- moe_input_l5_dp3 -->
<g id="node1373" class="node">
<title>moe_input_l5_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="412122" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="412122" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L5</text>
<text text-anchor="middle" x="412122" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="412122" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l5_dp3&#45;&gt;moe_input_l5_dp3 -->
<g id="edge2307" class="edge">
<title>allreduce_l5_dp3&#45;&gt;moe_input_l5_dp3</title>
<path fill="none" stroke="black" d="M411918.01,-135.98C411926.23,-135.98 411934.44,-135.98 411942.66,-135.98"/>
<polygon fill="black" stroke="black" points="411942.68,-139.48 411952.68,-135.98 411942.68,-132.48 411942.68,-139.48"/>
</g>
<!-- router_l5_dp3 -->
<g id="node1374" class="node">
<title>router_l5_dp3</title>
<polygon fill="lightyellow" stroke="black" points="412821.57,-176.98 412427.74,-176.98 412326.43,-94.98 412720.26,-94.98 412821.57,-176.98"/>
<text text-anchor="middle" x="412574" y="-144.48" font-family="Arial" font-size="10.00">Router L5</text>
<text text-anchor="middle" x="412574" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="412574" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l5_dp3&#45;&gt;router_l5_dp3 -->
<g id="edge2308" class="edge">
<title>moe_input_l5_dp3&#45;&gt;router_l5_dp3</title>
<path fill="none" stroke="black" d="M412291.06,-135.98C412316.34,-135.98 412341.63,-135.98 412366.92,-135.98"/>
<polygon fill="black" stroke="black" points="412366.99,-139.48 412376.99,-135.98 412366.99,-132.48 412366.99,-139.48"/>
</g>
<!-- expert0_l5_dp3 -->
<g id="node1375" class="node">
<title>expert0_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="416827.5,-161.98 416598.5,-161.98 416598.5,-109.98 416827.5,-109.98 416827.5,-161.98"/>
<text text-anchor="middle" x="416713" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L5</text>
<text text-anchor="middle" x="416713" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="416713" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="416713" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert0_l5_dp3 -->
<g id="edge2309" class="edge">
<title>router_l5_dp3&#45;&gt;expert0_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.74,-171.32C412836.09,-173.59 412857.41,-175.53 412878,-176.98 413638.47,-230.48 415546.15,-196.54 416308.5,-198.98 416433.55,-199.38 416466.59,-202.54 416589,-176.98 416603.75,-173.9 416619.19,-169.66 416633.98,-165.07"/>
<polygon fill="black" stroke="black" points="416635.12,-168.37 416643.59,-162 416633,-161.7 416635.12,-168.37"/>
<text text-anchor="middle" x="416330" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l5_dp3 -->
<g id="node1376" class="node">
<title>expert1_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="416580.5,-161.98 416351.5,-161.98 416351.5,-109.98 416580.5,-109.98 416580.5,-161.98"/>
<text text-anchor="middle" x="416466" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L5</text>
<text text-anchor="middle" x="416466" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="416466" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="416466" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert1_l5_dp3 -->
<g id="edge2310" class="edge">
<title>router_l5_dp3&#45;&gt;expert1_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.74,-171.31C412836.09,-173.58 412857.41,-175.53 412878,-176.98 413577.05,-226.36 415330.71,-196.54 416031.5,-198.98 416169.84,-199.47 416206.43,-204.56 416342,-176.98 416356.85,-173.96 416372.41,-169.72 416387.28,-165.11"/>
<polygon fill="black" stroke="black" points="416388.48,-168.4 416396.94,-162.03 416386.35,-161.73 416388.48,-168.4"/>
<text text-anchor="middle" x="416053" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l5_dp3 -->
<g id="node1377" class="node">
<title>expert2_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="416333.5,-161.98 416104.5,-161.98 416104.5,-109.98 416333.5,-109.98 416333.5,-161.98"/>
<text text-anchor="middle" x="416219" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L5</text>
<text text-anchor="middle" x="416219" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="416219" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="416219" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert2_l5_dp3 -->
<g id="edge2311" class="edge">
<title>router_l5_dp3&#45;&gt;expert2_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.74,-171.29C412836.1,-173.56 412857.41,-175.52 412878,-176.98 413509.21,-221.81 415092.71,-196.54 415725.5,-198.98 415890.01,-199.62 415933.55,-208.59 416095,-176.98 416110.06,-174.03 416125.82,-169.78 416140.86,-165.12"/>
<polygon fill="black" stroke="black" points="416142.17,-168.37 416150.63,-162 416140.04,-161.71 416142.17,-168.37"/>
<text text-anchor="middle" x="415747" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l5_dp3 -->
<g id="node1378" class="node">
<title>expert3_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="416086.5,-161.98 415857.5,-161.98 415857.5,-109.98 416086.5,-109.98 416086.5,-161.98"/>
<text text-anchor="middle" x="415972" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L5</text>
<text text-anchor="middle" x="415972" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="415972" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="415972" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert3_l5_dp3 -->
<g id="edge2312" class="edge">
<title>router_l5_dp3&#45;&gt;expert3_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.74,-171.27C412836.1,-173.54 412857.41,-175.51 412878,-176.98 413428.28,-216.37 414808.82,-196.54 415360.5,-198.98 415577.38,-199.94 415634.79,-216.75 415848,-176.98 415863.27,-174.14 415879.24,-169.88 415894.45,-165.17"/>
<polygon fill="black" stroke="black" points="415895.86,-168.39 415904.32,-162.01 415893.73,-161.72 415895.86,-168.39"/>
<text text-anchor="middle" x="415382" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l5_dp3 -->
<g id="node1379" class="node">
<title>expert4_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="415839.5,-161.98 415610.5,-161.98 415610.5,-109.98 415839.5,-109.98 415839.5,-161.98"/>
<text text-anchor="middle" x="415725" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L5</text>
<text text-anchor="middle" x="415725" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="415725" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="415725" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert4_l5_dp3 -->
<g id="edge2313" class="edge">
<title>router_l5_dp3&#45;&gt;expert4_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412719.67,-176.99C412758.3,-186.08 412800.21,-194.39 412839.5,-198.98 412858.48,-201.2 412863.39,-199.06 412882.5,-198.98 413184.56,-197.76 415302.97,-226.21 415601,-176.98 415616.93,-174.35 415633.6,-170.01 415649.35,-165.12"/>
<polygon fill="black" stroke="black" points="415650.58,-168.4 415659.03,-162.01 415648.44,-161.73 415650.58,-168.4"/>
<text text-anchor="middle" x="412861" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l5_dp3 -->
<g id="node1380" class="node">
<title>expert5_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="415592.5,-161.98 415363.5,-161.98 415363.5,-109.98 415592.5,-109.98 415592.5,-161.98"/>
<text text-anchor="middle" x="415478" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L5</text>
<text text-anchor="middle" x="415478" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="415478" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="415478" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert5_l5_dp3 -->
<g id="edge2314" class="edge">
<title>router_l5_dp3&#45;&gt;expert5_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.74,-171.22C412836.1,-173.51 412857.42,-175.49 412878,-176.98 413321.19,-209.18 414433.15,-196.54 414877.5,-198.98 415089.5,-200.15 415145.61,-215.98 415354,-176.98 415369.26,-174.13 415385.24,-169.86 415400.45,-165.15"/>
<polygon fill="black" stroke="black" points="415401.86,-168.37 415410.32,-162 415399.73,-161.71 415401.86,-168.37"/>
<text text-anchor="middle" x="414899" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l5_dp3 -->
<g id="node1381" class="node">
<title>expert6_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="415345.5,-161.98 415116.5,-161.98 415116.5,-109.98 415345.5,-109.98 415345.5,-161.98"/>
<text text-anchor="middle" x="415231" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L5</text>
<text text-anchor="middle" x="415231" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="415231" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="415231" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert6_l5_dp3 -->
<g id="edge2315" class="edge">
<title>router_l5_dp3&#45;&gt;expert6_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412746.37,-177C412791.98,-186.1 412841.37,-194.39 412887.5,-198.98 412906.52,-200.87 412911.39,-199.08 412930.5,-198.98 413172.34,-197.76 414868.43,-216.64 415107,-176.98 415122.84,-174.35 415139.4,-170.04 415155.07,-165.18"/>
<polygon fill="black" stroke="black" points="415156.25,-168.47 415164.7,-162.09 415154.11,-161.81 415156.25,-168.47"/>
<text text-anchor="middle" x="412909" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l5_dp3 -->
<g id="node1382" class="node">
<title>expert7_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="415098.5,-161.98 414869.5,-161.98 414869.5,-109.98 415098.5,-109.98 415098.5,-161.98"/>
<text text-anchor="middle" x="414984" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L5</text>
<text text-anchor="middle" x="414984" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="414984" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="414984" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert7_l5_dp3 -->
<g id="edge2316" class="edge">
<title>router_l5_dp3&#45;&gt;expert7_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.33,-171.1C412835.83,-173.42 412857.29,-175.44 412878,-176.98 413226.07,-202.87 414099.59,-208.3 414448.5,-198.98 414631.58,-194.09 414680.02,-210.92 414860,-176.98 414875.17,-174.12 414891.04,-169.88 414906.17,-165.2"/>
<polygon fill="black" stroke="black" points="414907.52,-168.44 414915.99,-162.07 414905.4,-161.77 414907.52,-168.44"/>
<text text-anchor="middle" x="414427" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l5_dp3 -->
<g id="node1383" class="node">
<title>expert8_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="414851.5,-161.98 414622.5,-161.98 414622.5,-109.98 414851.5,-109.98 414851.5,-161.98"/>
<text text-anchor="middle" x="414737" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L5</text>
<text text-anchor="middle" x="414737" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="414737" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="414737" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert8_l5_dp3 -->
<g id="edge2317" class="edge">
<title>router_l5_dp3&#45;&gt;expert8_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412773.02,-177C412825.62,-186.1 412882.5,-194.4 412935.5,-198.98 412954.54,-200.63 412959.39,-199.11 412978.5,-198.98 413160.12,-197.76 414433.88,-207.07 414613,-176.98 414628.83,-174.32 414645.39,-170 414661.07,-165.13"/>
<polygon fill="black" stroke="black" points="414662.24,-168.43 414670.7,-162.04 414660.1,-161.77 414662.24,-168.43"/>
<text text-anchor="middle" x="412957" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l5_dp3 -->
<g id="node1384" class="node">
<title>expert9_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="414604.5,-161.98 414375.5,-161.98 414375.5,-109.98 414604.5,-109.98 414604.5,-161.98"/>
<text text-anchor="middle" x="414490" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L5</text>
<text text-anchor="middle" x="414490" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="414490" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="414490" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert9_l5_dp3 -->
<g id="edge2318" class="edge">
<title>router_l5_dp3&#45;&gt;expert9_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412814.35,-170.96C412835.84,-173.31 412857.29,-175.38 412878,-176.98 413374.17,-215.39 413500.07,-213.82 413997.5,-198.98 414161.49,-194.09 414204.87,-207.88 414366,-176.98 414381.16,-174.08 414397.03,-169.81 414412.15,-165.12"/>
<polygon fill="black" stroke="black" points="414413.51,-168.37 414421.97,-161.99 414411.38,-161.7 414413.51,-168.37"/>
<text text-anchor="middle" x="413976" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l5_dp3 -->
<g id="node1385" class="node">
<title>expert10_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="414357.5,-161.98 414128.5,-161.98 414128.5,-109.98 414357.5,-109.98 414357.5,-161.98"/>
<text text-anchor="middle" x="414243" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L5</text>
<text text-anchor="middle" x="414243" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="414243" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="414243" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert10_l5_dp3 -->
<g id="edge2319" class="edge">
<title>router_l5_dp3&#45;&gt;expert10_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412799.65,-177.01C412859.23,-186.11 412923.61,-194.4 412983.5,-198.98 413109.32,-208.6 413994.62,-198.3 414119,-176.98 414134.73,-174.29 414151.18,-169.97 414166.78,-165.14"/>
<polygon fill="black" stroke="black" points="414167.9,-168.45 414176.36,-162.07 414165.77,-161.78 414167.9,-168.45"/>
<text text-anchor="middle" x="413005" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l5_dp3 -->
<g id="node1386" class="node">
<title>expert11_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="414110.5,-161.98 413881.5,-161.98 413881.5,-109.98 414110.5,-109.98 414110.5,-161.98"/>
<text text-anchor="middle" x="413996" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L5</text>
<text text-anchor="middle" x="413996" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="413996" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="413996" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert11_l5_dp3 -->
<g id="edge2320" class="edge">
<title>router_l5_dp3&#45;&gt;expert11_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412813.95,-170.64C412835.58,-173.07 412857.17,-175.24 412878,-176.98 413193.71,-203.39 413273.92,-211.33 413590.5,-198.98 413715.9,-194.09 413748.97,-201.75 413872,-176.98 413886.86,-173.99 413902.42,-169.77 413917.29,-165.16"/>
<polygon fill="black" stroke="black" points="413918.48,-168.45 413926.95,-162.08 413916.36,-161.78 413918.48,-168.45"/>
<text text-anchor="middle" x="413569" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l5_dp3 -->
<g id="node1387" class="node">
<title>expert12_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="413863.5,-161.98 413634.5,-161.98 413634.5,-109.98 413863.5,-109.98 413863.5,-161.98"/>
<text text-anchor="middle" x="413749" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L5</text>
<text text-anchor="middle" x="413749" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="413749" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="413749" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert12_l5_dp3 -->
<g id="edge2321" class="edge">
<title>router_l5_dp3&#45;&gt;expert12_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412820.89,-176.28C412888.94,-185.66 412962.91,-194.28 413031.5,-198.98 413163.17,-208.01 413495.14,-200.56 413625,-176.98 413640.37,-174.19 413656.45,-169.93 413671.75,-165.2"/>
<polygon fill="black" stroke="black" points="413673.21,-168.41 413681.67,-162.03 413671.08,-161.74 413673.21,-168.41"/>
<text text-anchor="middle" x="413053" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l5_dp3 -->
<g id="node1388" class="node">
<title>expert13_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="413616.5,-161.98 413387.5,-161.98 413387.5,-109.98 413616.5,-109.98 413616.5,-161.98"/>
<text text-anchor="middle" x="413502" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L5</text>
<text text-anchor="middle" x="413502" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="413502" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="413502" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert13_l5_dp3 -->
<g id="edge2322" class="edge">
<title>router_l5_dp3&#45;&gt;expert13_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412791.82,-177.02C412928.96,-197.58 413109.66,-215.02 413269.5,-198.98 413320.66,-193.85 413376.31,-179.11 413420.33,-165.18"/>
<polygon fill="black" stroke="black" points="413421.66,-168.43 413430.11,-162.04 413419.52,-161.77 413421.66,-168.43"/>
<text text-anchor="middle" x="413248" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l5_dp3 -->
<g id="node1389" class="node">
<title>expert14_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="413369.5,-161.98 413140.5,-161.98 413140.5,-109.98 413369.5,-109.98 413369.5,-161.98"/>
<text text-anchor="middle" x="413255" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L5</text>
<text text-anchor="middle" x="413255" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="413255" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="413255" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert14_l5_dp3 -->
<g id="edge2323" class="edge">
<title>router_l5_dp3&#45;&gt;expert14_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412799.44,-176.99C412922.58,-196.39 413062.01,-212.63 413122.5,-198.98 413150.7,-192.62 413179.94,-179.52 413203.75,-166.9"/>
<polygon fill="black" stroke="black" points="413205.48,-169.94 413212.6,-162.1 413202.14,-163.79 413205.48,-169.94"/>
<text text-anchor="middle" x="413101" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l5_dp3 -->
<g id="node1390" class="node">
<title>expert15_l5_dp3</title>
<polygon fill="lightgreen" stroke="black" points="413116.5,-161.98 412887.5,-161.98 412887.5,-109.98 413116.5,-109.98 413116.5,-161.98"/>
<text text-anchor="middle" x="413002" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L5</text>
<text text-anchor="middle" x="413002" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="413002" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="413002" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l5_dp3&#45;&gt;expert15_l5_dp3 -->
<g id="edge2324" class="edge">
<title>router_l5_dp3&#45;&gt;expert15_l5_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M412771.09,-135.98C412807.17,-135.98 412843.91,-135.98 412877.14,-135.98"/>
<polygon fill="black" stroke="black" points="412877.34,-139.48 412887.34,-135.98 412877.34,-132.48 412877.34,-139.48"/>
<text text-anchor="middle" x="412854.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l5_dp3 -->
<g id="node1391" class="node">
<title>expert_agg_l5_dp3</title>
<polygon fill="lightyellow" stroke="black" points="417358.57,-176.98 416964.74,-176.98 416863.43,-94.98 417257.26,-94.98 417358.57,-176.98"/>
<text text-anchor="middle" x="417111" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L5</text>
<text text-anchor="middle" x="417111" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="417111" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2325" class="edge">
<title>expert0_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M416827.66,-135.98C416853.06,-135.98 416878.47,-135.98 416903.87,-135.98"/>
<polygon fill="black" stroke="black" points="416903.99,-139.48 416913.99,-135.98 416903.99,-132.48 416903.99,-139.48"/>
</g>
<!-- expert1_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2326" class="edge">
<title>expert1_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M416521.24,-162.02C416544.4,-171.57 416571.96,-181.22 416598,-185.98 416648.06,-195.15 416776.3,-190.41 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert2_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2327" class="edge">
<title>expert2_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M416274.24,-162.02C416297.4,-171.57 416324.96,-181.22 416351,-185.98 416403.02,-195.51 416774.31,-190.59 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert3_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2328" class="edge">
<title>expert3_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M416027.24,-162.02C416050.4,-171.57 416077.96,-181.22 416104,-185.98 416183.02,-200.45 416746.97,-192.97 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert4_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2329" class="edge">
<title>expert4_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M415780.24,-162.02C415803.4,-171.57 415830.96,-181.22 415857,-185.98 415910.01,-195.69 416773.31,-190.67 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert5_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2330" class="edge">
<title>expert5_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M415533.24,-162.02C415556.4,-171.57 415583.96,-181.22 415610,-185.98 415676.5,-198.16 416759.64,-191.87 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert6_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2331" class="edge">
<title>expert6_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M415286.24,-162.02C415309.4,-171.57 415336.96,-181.22 415363,-185.98 415443,-200.63 416745.97,-193.06 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert7_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2332" class="edge">
<title>expert7_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M415039.24,-162.02C415062.4,-171.57 415089.96,-181.22 415116,-185.98 415162.75,-194.54 416779.65,-190.12 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert8_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2333" class="edge">
<title>expert8_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M414792.24,-162.02C414815.4,-171.57 414842.96,-181.22 414869,-185.98 414922.5,-195.78 416772.82,-190.72 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert9_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2334" class="edge">
<title>expert9_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M414545.24,-162.02C414568.4,-171.57 414595.96,-181.22 414622,-185.98 414682.25,-197.01 416765.98,-191.31 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert10_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2335" class="edge">
<title>expert10_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M414298.24,-162.02C414321.4,-171.57 414348.96,-181.22 414375,-185.98 414442,-198.25 416759.15,-191.91 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert11_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2336" class="edge">
<title>expert11_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M414051.24,-162.02C414074.4,-171.57 414101.96,-181.22 414128,-185.98 414201.75,-199.48 416752.31,-192.51 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert12_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2337" class="edge">
<title>expert12_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M413804.24,-162.02C413827.4,-171.57 413854.96,-181.22 413881,-185.98 413961.49,-200.72 416745.48,-193.1 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert13_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2338" class="edge">
<title>expert13_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M413557.24,-162.02C413580.4,-171.57 413607.96,-181.22 413634,-185.98 413677.62,-193.97 416782.82,-189.84 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert14_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2339" class="edge">
<title>expert14_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M413310.24,-162.02C413333.4,-171.57 413360.96,-181.22 413387,-185.98 413434,-194.59 416779.4,-190.14 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- expert15_l5_dp3&#45;&gt;expert_agg_l5_dp3 -->
<g id="edge2340" class="edge">
<title>expert15_l5_dp3&#45;&gt;expert_agg_l5_dp3</title>
<path fill="none" stroke="black" d="M413059.86,-162.02C413084.1,-171.58 413112.89,-181.22 413140,-185.98 413190.44,-194.84 416775.98,-190.44 416827,-185.98 416865.11,-182.65 416905.78,-176.86 416944.08,-170.36"/>
<polygon fill="black" stroke="black" points="416945.02,-173.75 416954.29,-168.6 416943.84,-166.85 416945.02,-173.75"/>
</g>
<!-- layer5_output_dp3 -->
<g id="node1392" class="node">
<title>layer5_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="417563" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="417563" y="-144.48" font-family="Arial" font-size="10.00">Layer 5 Output</text>
<text text-anchor="middle" x="417563" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="417563" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l5_dp3&#45;&gt;layer5_output_dp3 -->
<g id="edge2341" class="edge">
<title>expert_agg_l5_dp3&#45;&gt;layer5_output_dp3</title>
<path fill="none" stroke="black" d="M417308.31,-135.98C417333.49,-135.98 417358.66,-135.98 417383.84,-135.98"/>
<polygon fill="black" stroke="black" points="417383.87,-139.48 417393.87,-135.98 417383.87,-132.48 417383.87,-139.48"/>
</g>
<!-- attn_input_l6_dp3 -->
<g id="node1393" class="node">
<title>attn_input_l6_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="417936" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="417936" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L6</text>
<text text-anchor="middle" x="417936" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="417936" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer5_output_dp3&#45;&gt;attn_input_l6_dp3 -->
<g id="edge2342" class="edge">
<title>layer5_output_dp3&#45;&gt;attn_input_l6_dp3</title>
<path fill="none" stroke="black" d="M417732.01,-135.98C417740.23,-135.98 417748.44,-135.98 417756.66,-135.98"/>
<polygon fill="black" stroke="black" points="417756.68,-139.48 417766.68,-135.98 417756.68,-132.48 417756.68,-139.48"/>
</g>
<!-- attn_tp0_l6_dp3 -->
<g id="node1394" class="node">
<title>attn_tp0_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="419234,-161.98 418974,-161.98 418974,-109.98 419234,-109.98 419234,-161.98"/>
<text text-anchor="middle" x="419104" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L6</text>
<text text-anchor="middle" x="419104" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="419104" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="419104" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp3&#45;&gt;attn_tp0_l6_dp3 -->
<g id="edge2343" class="edge">
<title>attn_input_l6_dp3&#45;&gt;attn_tp0_l6_dp3</title>
<path fill="none" stroke="black" d="M418019.52,-161.26C418056.12,-171.09 418099.81,-181.13 418140,-185.98 418185,-191.42 418911.27,-193.33 418956,-185.98 418981.4,-181.81 419008.31,-173.85 419032.12,-165.5"/>
<polygon fill="black" stroke="black" points="419033.55,-168.71 419041.78,-162.03 419031.18,-162.12 419033.55,-168.71"/>
</g>
<!-- attn_tp1_l6_dp3 -->
<g id="node1395" class="node">
<title>attn_tp1_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="418956,-161.98 418696,-161.98 418696,-109.98 418956,-109.98 418956,-161.98"/>
<text text-anchor="middle" x="418826" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L6</text>
<text text-anchor="middle" x="418826" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="418826" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="418826" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp3&#45;&gt;attn_tp1_l6_dp3 -->
<g id="edge2344" class="edge">
<title>attn_input_l6_dp3&#45;&gt;attn_tp1_l6_dp3</title>
<path fill="none" stroke="black" d="M418019.52,-161.26C418056.12,-171.09 418099.81,-181.13 418140,-185.98 418199.35,-193.15 418619.01,-195.68 418678,-185.98 418703.4,-181.81 418730.31,-173.85 418754.12,-165.5"/>
<polygon fill="black" stroke="black" points="418755.55,-168.71 418763.78,-162.03 418753.18,-162.12 418755.55,-168.71"/>
</g>
<!-- attn_tp2_l6_dp3 -->
<g id="node1396" class="node">
<title>attn_tp2_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="418678,-161.98 418418,-161.98 418418,-109.98 418678,-109.98 418678,-161.98"/>
<text text-anchor="middle" x="418548" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L6</text>
<text text-anchor="middle" x="418548" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="418548" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="418548" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp3&#45;&gt;attn_tp2_l6_dp3 -->
<g id="edge2345" class="edge">
<title>attn_input_l6_dp3&#45;&gt;attn_tp2_l6_dp3</title>
<path fill="none" stroke="black" d="M418019.52,-161.26C418056.12,-171.09 418099.81,-181.13 418140,-185.98 418197.36,-192.91 418342.99,-195.35 418400,-185.98 418425.4,-181.81 418452.31,-173.85 418476.12,-165.5"/>
<polygon fill="black" stroke="black" points="418477.55,-168.71 418485.78,-162.03 418475.18,-162.12 418477.55,-168.71"/>
</g>
<!-- attn_tp3_l6_dp3 -->
<g id="node1397" class="node">
<title>attn_tp3_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="418400,-161.98 418140,-161.98 418140,-109.98 418400,-109.98 418400,-161.98"/>
<text text-anchor="middle" x="418270" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L6</text>
<text text-anchor="middle" x="418270" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="418270" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="418270" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l6_dp3&#45;&gt;attn_tp3_l6_dp3 -->
<g id="edge2346" class="edge">
<title>attn_input_l6_dp3&#45;&gt;attn_tp3_l6_dp3</title>
<path fill="none" stroke="black" d="M418105.28,-135.98C418113.35,-135.98 418121.42,-135.98 418129.49,-135.98"/>
<polygon fill="black" stroke="black" points="418129.7,-139.48 418139.7,-135.98 418129.7,-132.48 418129.7,-139.48"/>
</g>
<!-- allreduce_l6_dp3 -->
<g id="node1398" class="node">
<title>allreduce_l6_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="419438" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="419438" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L6</text>
<text text-anchor="middle" x="419438" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="419438" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l6_dp3&#45;&gt;allreduce_l6_dp3 -->
<g id="edge2347" class="edge">
<title>attn_tp0_l6_dp3&#45;&gt;allreduce_l6_dp3</title>
<path fill="none" stroke="black" d="M419234.14,-135.98C419242.35,-135.98 419250.56,-135.98 419258.77,-135.98"/>
<polygon fill="black" stroke="black" points="419258.78,-139.48 419268.78,-135.98 419258.78,-132.48 419258.78,-139.48"/>
</g>
<!-- attn_tp1_l6_dp3&#45;&gt;allreduce_l6_dp3 -->
<g id="edge2348" class="edge">
<title>attn_tp1_l6_dp3&#45;&gt;allreduce_l6_dp3</title>
<path fill="none" stroke="black" d="M418888.22,-162.03C418914.24,-171.59 418945.1,-181.23 418974,-185.98 419031.01,-195.35 419176.64,-192.91 419234,-185.98 419270.57,-181.57 419310.05,-172.85 419344.44,-163.91"/>
<polygon fill="black" stroke="black" points="419345.7,-167.2 419354.47,-161.26 419343.91,-160.43 419345.7,-167.2"/>
</g>
<!-- attn_tp2_l6_dp3&#45;&gt;allreduce_l6_dp3 -->
<g id="edge2349" class="edge">
<title>attn_tp2_l6_dp3&#45;&gt;allreduce_l6_dp3</title>
<path fill="none" stroke="black" d="M418610.22,-162.03C418636.24,-171.59 418667.1,-181.23 418696,-185.98 418754.98,-195.68 419174.65,-193.15 419234,-185.98 419270.57,-181.57 419310.05,-172.85 419344.44,-163.91"/>
<polygon fill="black" stroke="black" points="419345.7,-167.2 419354.47,-161.26 419343.91,-160.43 419345.7,-167.2"/>
</g>
<!-- attn_tp3_l6_dp3&#45;&gt;allreduce_l6_dp3 -->
<g id="edge2350" class="edge">
<title>attn_tp3_l6_dp3&#45;&gt;allreduce_l6_dp3</title>
<path fill="none" stroke="black" d="M418332.22,-162.03C418358.24,-171.59 418389.1,-181.23 418418,-185.98 418462.73,-193.33 419188.99,-191.42 419234,-185.98 419270.57,-181.57 419310.05,-172.85 419344.44,-163.91"/>
<polygon fill="black" stroke="black" points="419345.7,-167.2 419354.47,-161.26 419343.91,-160.43 419345.7,-167.2"/>
</g>
<!-- moe_input_l6_dp3 -->
<g id="node1399" class="node">
<title>moe_input_l6_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="419811" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="419811" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L6</text>
<text text-anchor="middle" x="419811" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="419811" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l6_dp3&#45;&gt;moe_input_l6_dp3 -->
<g id="edge2351" class="edge">
<title>allreduce_l6_dp3&#45;&gt;moe_input_l6_dp3</title>
<path fill="none" stroke="black" d="M419607.01,-135.98C419615.23,-135.98 419623.44,-135.98 419631.66,-135.98"/>
<polygon fill="black" stroke="black" points="419631.68,-139.48 419641.68,-135.98 419631.68,-132.48 419631.68,-139.48"/>
</g>
<!-- router_l6_dp3 -->
<g id="node1400" class="node">
<title>router_l6_dp3</title>
<polygon fill="lightyellow" stroke="black" points="420510.57,-176.98 420116.74,-176.98 420015.43,-94.98 420409.26,-94.98 420510.57,-176.98"/>
<text text-anchor="middle" x="420263" y="-144.48" font-family="Arial" font-size="10.00">Router L6</text>
<text text-anchor="middle" x="420263" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="420263" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l6_dp3&#45;&gt;router_l6_dp3 -->
<g id="edge2352" class="edge">
<title>moe_input_l6_dp3&#45;&gt;router_l6_dp3</title>
<path fill="none" stroke="black" d="M419980.06,-135.98C420005.34,-135.98 420030.63,-135.98 420055.92,-135.98"/>
<polygon fill="black" stroke="black" points="420055.99,-139.48 420065.99,-135.98 420055.99,-132.48 420055.99,-139.48"/>
</g>
<!-- expert0_l6_dp3 -->
<g id="node1401" class="node">
<title>expert0_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="424516.5,-161.98 424287.5,-161.98 424287.5,-109.98 424516.5,-109.98 424516.5,-161.98"/>
<text text-anchor="middle" x="424402" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L6</text>
<text text-anchor="middle" x="424402" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="424402" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="424402" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert0_l6_dp3 -->
<g id="edge2353" class="edge">
<title>router_l6_dp3&#45;&gt;expert0_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.74,-171.32C420525.09,-173.59 420546.41,-175.53 420567,-176.98 421330.79,-230.71 423246.82,-196.54 424012.5,-198.98 424130.9,-199.36 424162.17,-201.54 424278,-176.98 424292.65,-173.88 424307.99,-169.65 424322.69,-165.08"/>
<polygon fill="black" stroke="black" points="424323.78,-168.4 424332.25,-162.03 424321.66,-161.73 424323.78,-168.4"/>
<text text-anchor="middle" x="424034" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l6_dp3 -->
<g id="node1402" class="node">
<title>expert1_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="424269.5,-161.98 424040.5,-161.98 424040.5,-109.98 424269.5,-109.98 424269.5,-161.98"/>
<text text-anchor="middle" x="424155" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L6</text>
<text text-anchor="middle" x="424155" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="424155" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="424155" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert1_l6_dp3 -->
<g id="edge2354" class="edge">
<title>router_l6_dp3&#45;&gt;expert1_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.74,-171.31C420525.09,-173.58 420546.41,-175.53 420567,-176.98 421272.7,-226.81 423043.04,-196.54 423750.5,-198.98 423875.55,-199.41 423908.59,-202.54 424031,-176.98 424045.75,-173.9 424061.19,-169.66 424075.98,-165.07"/>
<polygon fill="black" stroke="black" points="424077.12,-168.37 424085.59,-162 424075,-161.7 424077.12,-168.37"/>
<text text-anchor="middle" x="423772" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l6_dp3 -->
<g id="node1403" class="node">
<title>expert2_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="424022.5,-161.98 423793.5,-161.98 423793.5,-109.98 424022.5,-109.98 424022.5,-161.98"/>
<text text-anchor="middle" x="423908" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L6</text>
<text text-anchor="middle" x="423908" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="423908" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="423908" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert2_l6_dp3 -->
<g id="edge2355" class="edge">
<title>router_l6_dp3&#45;&gt;expert2_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.74,-171.29C420525.1,-173.57 420546.41,-175.52 420567,-176.98 421211.51,-222.7 422828.37,-196.54 423474.5,-198.98 423612.4,-199.5 423648.87,-204.49 423784,-176.98 423798.85,-173.96 423814.41,-169.72 423829.28,-165.1"/>
<polygon fill="black" stroke="black" points="423830.47,-168.39 423838.94,-162.02 423828.35,-161.72 423830.47,-168.39"/>
<text text-anchor="middle" x="423496" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l6_dp3 -->
<g id="node1404" class="node">
<title>expert3_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="423775.5,-161.98 423546.5,-161.98 423546.5,-109.98 423775.5,-109.98 423775.5,-161.98"/>
<text text-anchor="middle" x="423661" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L6</text>
<text text-anchor="middle" x="423661" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="423661" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="423661" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert3_l6_dp3 -->
<g id="edge2356" class="edge">
<title>router_l6_dp3&#45;&gt;expert3_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.74,-171.27C420525.1,-173.55 420546.41,-175.51 420567,-176.98 421143.88,-218.16 422591.15,-196.54 423169.5,-198.98 423333.12,-199.67 423376.43,-208.45 423537,-176.98 423552.06,-174.03 423567.82,-169.78 423582.86,-165.11"/>
<polygon fill="black" stroke="black" points="423584.16,-168.37 423592.63,-162 423582.04,-161.7 423584.16,-168.37"/>
<text text-anchor="middle" x="423191" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l6_dp3 -->
<g id="node1405" class="node">
<title>expert4_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="423528.5,-161.98 423299.5,-161.98 423299.5,-109.98 423528.5,-109.98 423528.5,-161.98"/>
<text text-anchor="middle" x="423414" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L6</text>
<text text-anchor="middle" x="423414" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="423414" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="423414" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert4_l6_dp3 -->
<g id="edge2357" class="edge">
<title>router_l6_dp3&#45;&gt;expert4_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.74,-171.24C420525.1,-173.53 420546.42,-175.5 420567,-176.98 421063.18,-212.74 422308.04,-196.54 422805.5,-198.98 423021.05,-200.04 423078.1,-216.54 423290,-176.98 423305.27,-174.13 423321.24,-169.87 423336.45,-165.16"/>
<polygon fill="black" stroke="black" points="423337.86,-168.39 423346.32,-162.01 423335.73,-161.72 423337.86,-168.39"/>
<text text-anchor="middle" x="422827" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l6_dp3 -->
<g id="node1406" class="node">
<title>expert5_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="423281.5,-161.98 423052.5,-161.98 423052.5,-109.98 423281.5,-109.98 423281.5,-161.98"/>
<text text-anchor="middle" x="423167" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L6</text>
<text text-anchor="middle" x="423167" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="423167" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="423167" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert5_l6_dp3 -->
<g id="edge2358" class="edge">
<title>router_l6_dp3&#45;&gt;expert5_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420408.67,-176.99C420447.3,-186.08 420489.21,-194.39 420528.5,-198.98 420547.48,-201.2 420552.39,-199.07 420571.5,-198.98 420846.12,-197.76 422772.07,-221.85 423043,-176.98 423058.93,-174.34 423075.59,-170 423091.35,-165.11"/>
<polygon fill="black" stroke="black" points="423092.58,-168.39 423101.03,-162 423090.44,-161.72 423092.58,-168.39"/>
<text text-anchor="middle" x="420550" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l6_dp3 -->
<g id="node1407" class="node">
<title>expert6_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="423034.5,-161.98 422805.5,-161.98 422805.5,-109.98 423034.5,-109.98 423034.5,-161.98"/>
<text text-anchor="middle" x="422920" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L6</text>
<text text-anchor="middle" x="422920" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="422920" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="422920" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert6_l6_dp3 -->
<g id="edge2359" class="edge">
<title>router_l6_dp3&#45;&gt;expert6_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.75,-171.18C420525.1,-173.48 420546.42,-175.47 420567,-176.98 420966.29,-206.3 421968.27,-209.27 422368.5,-198.98 422558.69,-194.09 422609.01,-212.05 422796,-176.98 422811.26,-174.12 422827.24,-169.85 422842.45,-165.14"/>
<polygon fill="black" stroke="black" points="422843.85,-168.37 422852.32,-161.99 422841.73,-161.7 422843.85,-168.37"/>
<text text-anchor="middle" x="422347" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l6_dp3 -->
<g id="node1408" class="node">
<title>expert7_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="422787.5,-161.98 422558.5,-161.98 422558.5,-109.98 422787.5,-109.98 422787.5,-161.98"/>
<text text-anchor="middle" x="422673" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L6</text>
<text text-anchor="middle" x="422673" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="422673" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="422673" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert7_l6_dp3 -->
<g id="edge2360" class="edge">
<title>router_l6_dp3&#45;&gt;expert7_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420435.37,-177C420480.98,-186.1 420530.37,-194.39 420576.5,-198.98 420595.52,-200.87 420600.39,-199.09 420619.5,-198.98 420833.9,-197.76 422337.52,-212.28 422549,-176.98 422564.83,-174.34 422581.4,-170.02 422597.07,-165.16"/>
<polygon fill="black" stroke="black" points="422598.25,-168.46 422606.7,-162.07 422596.11,-161.79 422598.25,-168.46"/>
<text text-anchor="middle" x="420598" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l6_dp3 -->
<g id="node1409" class="node">
<title>expert8_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="422540.5,-161.98 422311.5,-161.98 422311.5,-109.98 422540.5,-109.98 422540.5,-161.98"/>
<text text-anchor="middle" x="422426" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L6</text>
<text text-anchor="middle" x="422426" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="422426" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="422426" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert8_l6_dp3 -->
<g id="edge2361" class="edge">
<title>router_l6_dp3&#45;&gt;expert8_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420503.34,-171.04C420524.83,-173.37 420546.29,-175.42 420567,-176.98 420862.97,-199.38 421605.79,-207.15 421902.5,-198.98 422080.26,-194.09 422127.28,-210.07 422302,-176.98 422317.17,-174.11 422333.04,-169.87 422348.16,-165.18"/>
<polygon fill="black" stroke="black" points="422349.52,-168.42 422357.98,-162.05 422347.39,-161.75 422349.52,-168.42"/>
<text text-anchor="middle" x="421881" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l6_dp3 -->
<g id="node1410" class="node">
<title>expert9_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="422293.5,-161.98 422064.5,-161.98 422064.5,-109.98 422293.5,-109.98 422293.5,-161.98"/>
<text text-anchor="middle" x="422179" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L6</text>
<text text-anchor="middle" x="422179" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="422179" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="422179" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert9_l6_dp3 -->
<g id="edge2362" class="edge">
<title>router_l6_dp3&#45;&gt;expert9_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420462.02,-177C420514.62,-186.1 420571.5,-194.4 420624.5,-198.98 420643.54,-200.63 420648.39,-199.13 420667.5,-198.98 420975.86,-196.54 421750.95,-228.42 422055,-176.98 422070.83,-174.3 422087.39,-169.97 422103.06,-165.1"/>
<polygon fill="black" stroke="black" points="422104.24,-168.4 422112.69,-162.01 422102.1,-161.74 422104.24,-168.4"/>
<text text-anchor="middle" x="420646" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l6_dp3 -->
<g id="node1411" class="node">
<title>expert10_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="422046.5,-161.98 421817.5,-161.98 421817.5,-109.98 422046.5,-109.98 422046.5,-161.98"/>
<text text-anchor="middle" x="421932" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L6</text>
<text text-anchor="middle" x="421932" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="421932" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="421932" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert10_l6_dp3 -->
<g id="edge2363" class="edge">
<title>router_l6_dp3&#45;&gt;expert10_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420502.94,-170.8C420524.57,-173.19 420546.16,-175.31 420567,-176.98 420964.73,-208.83 421065.69,-211.74 421464.5,-198.98 421617.4,-194.09 421657.82,-206.12 421808,-176.98 421823.06,-174.06 421838.83,-169.82 421853.87,-165.16"/>
<polygon fill="black" stroke="black" points="421855.17,-168.42 421863.64,-162.04 421853.05,-161.75 421855.17,-168.42"/>
<text text-anchor="middle" x="421443" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l6_dp3 -->
<g id="node1412" class="node">
<title>expert11_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="421799.5,-161.98 421570.5,-161.98 421570.5,-109.98 421799.5,-109.98 421799.5,-161.98"/>
<text text-anchor="middle" x="421685" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L6</text>
<text text-anchor="middle" x="421685" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="421685" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="421685" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert11_l6_dp3 -->
<g id="edge2364" class="edge">
<title>router_l6_dp3&#45;&gt;expert11_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420488.65,-177.01C420548.23,-186.11 420612.61,-194.4 420672.5,-198.98 420869.43,-214.04 421366.43,-210.92 421561,-176.98 421576.72,-174.24 421593.17,-169.91 421608.76,-165.06"/>
<polygon fill="black" stroke="black" points="421609.89,-168.38 421618.35,-161.99 421607.75,-161.71 421609.89,-168.38"/>
<text text-anchor="middle" x="420694" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l6_dp3 -->
<g id="node1413" class="node">
<title>expert12_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="421552.5,-161.98 421323.5,-161.98 421323.5,-109.98 421552.5,-109.98 421552.5,-161.98"/>
<text text-anchor="middle" x="421438" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L6</text>
<text text-anchor="middle" x="421438" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="421438" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="421438" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert12_l6_dp3 -->
<g id="edge2365" class="edge">
<title>router_l6_dp3&#45;&gt;expert12_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420502.57,-170.29C420524.33,-172.8 420546.05,-175.09 420567,-176.98 420567,-176.98 421314,-176.98 421314,-176.98 421328.65,-173.9 421344,-169.69 421358.7,-165.12"/>
<polygon fill="black" stroke="black" points="421359.79,-168.45 421368.26,-162.08 421357.67,-161.78 421359.79,-168.45"/>
<text text-anchor="middle" x="421061" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l6_dp3 -->
<g id="node1414" class="node">
<title>expert13_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="421305.5,-161.98 421076.5,-161.98 421076.5,-109.98 421305.5,-109.98 421305.5,-161.98"/>
<text text-anchor="middle" x="421191" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L6</text>
<text text-anchor="middle" x="421191" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="421191" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="421191" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert13_l6_dp3 -->
<g id="edge2366" class="edge">
<title>router_l6_dp3&#45;&gt;expert13_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420509.89,-176.28C420577.94,-185.66 420651.91,-194.28 420720.5,-198.98 420835.39,-206.86 420940.97,-201.98 421067,-176.98 421081.96,-174.01 421097.62,-169.78 421112.58,-165.14"/>
<polygon fill="black" stroke="black" points="421113.83,-168.41 421122.29,-162.04 421111.7,-161.74 421113.83,-168.41"/>
<text text-anchor="middle" x="420742" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l6_dp3 -->
<g id="node1415" class="node">
<title>expert14_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="421058.5,-161.98 420829.5,-161.98 420829.5,-109.98 421058.5,-109.98 421058.5,-161.98"/>
<text text-anchor="middle" x="420944" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L6</text>
<text text-anchor="middle" x="420944" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="420944" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="420944" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert14_l6_dp3 -->
<g id="edge2367" class="edge">
<title>router_l6_dp3&#45;&gt;expert14_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420488.44,-176.99C420611.58,-196.39 420751.01,-212.63 420811.5,-198.98 420839.7,-192.62 420868.94,-179.52 420892.75,-166.9"/>
<polygon fill="black" stroke="black" points="420894.48,-169.94 420901.6,-162.1 420891.14,-163.79 420894.48,-169.94"/>
<text text-anchor="middle" x="420790" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l6_dp3 -->
<g id="node1416" class="node">
<title>expert15_l6_dp3</title>
<polygon fill="lightgreen" stroke="black" points="420805.5,-161.98 420576.5,-161.98 420576.5,-109.98 420805.5,-109.98 420805.5,-161.98"/>
<text text-anchor="middle" x="420691" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L6</text>
<text text-anchor="middle" x="420691" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="420691" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="420691" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l6_dp3&#45;&gt;expert15_l6_dp3 -->
<g id="edge2368" class="edge">
<title>router_l6_dp3&#45;&gt;expert15_l6_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M420460.09,-135.98C420496.17,-135.98 420532.91,-135.98 420566.14,-135.98"/>
<polygon fill="black" stroke="black" points="420566.34,-139.48 420576.34,-135.98 420566.34,-132.48 420566.34,-139.48"/>
<text text-anchor="middle" x="420543.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l6_dp3 -->
<g id="node1417" class="node">
<title>expert_agg_l6_dp3</title>
<polygon fill="lightyellow" stroke="black" points="425047.57,-176.98 424653.74,-176.98 424552.43,-94.98 424946.26,-94.98 425047.57,-176.98"/>
<text text-anchor="middle" x="424800" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L6</text>
<text text-anchor="middle" x="424800" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="424800" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2369" class="edge">
<title>expert0_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M424516.66,-135.98C424542.06,-135.98 424567.47,-135.98 424592.87,-135.98"/>
<polygon fill="black" stroke="black" points="424592.99,-139.48 424602.99,-135.98 424592.99,-132.48 424592.99,-139.48"/>
</g>
<!-- expert1_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2370" class="edge">
<title>expert1_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M424210.24,-162.02C424233.4,-171.57 424260.96,-181.22 424287,-185.98 424337.06,-195.15 424465.3,-190.41 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert2_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2371" class="edge">
<title>expert2_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M423963.24,-162.02C423986.4,-171.57 424013.96,-181.22 424040,-185.98 424092.02,-195.51 424463.31,-190.59 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert3_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2372" class="edge">
<title>expert3_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M423716.24,-162.02C423739.4,-171.57 423766.96,-181.22 423793,-185.98 423872.02,-200.45 424435.97,-192.97 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert4_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2373" class="edge">
<title>expert4_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M423469.24,-162.02C423492.4,-171.57 423519.96,-181.22 423546,-185.98 423599.01,-195.69 424462.31,-190.67 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert5_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2374" class="edge">
<title>expert5_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M423222.24,-162.02C423245.4,-171.57 423272.96,-181.22 423299,-185.98 423365.5,-198.16 424448.64,-191.87 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert6_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2375" class="edge">
<title>expert6_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M422975.24,-162.02C422998.4,-171.57 423025.96,-181.22 423052,-185.98 423132,-200.63 424434.97,-193.06 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert7_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2376" class="edge">
<title>expert7_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M422728.24,-162.02C422751.4,-171.57 422778.96,-181.22 422805,-185.98 422851.75,-194.54 424468.65,-190.12 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert8_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2377" class="edge">
<title>expert8_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M422481.24,-162.02C422504.4,-171.57 422531.96,-181.22 422558,-185.98 422611.5,-195.78 424461.82,-190.72 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert9_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2378" class="edge">
<title>expert9_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M422234.24,-162.02C422257.4,-171.57 422284.96,-181.22 422311,-185.98 422371.25,-197.01 424454.98,-191.31 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert10_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2379" class="edge">
<title>expert10_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M421987.24,-162.02C422010.4,-171.57 422037.96,-181.22 422064,-185.98 422131,-198.25 424448.15,-191.91 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert11_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2380" class="edge">
<title>expert11_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M421740.24,-162.02C421763.4,-171.57 421790.96,-181.22 421817,-185.98 421890.75,-199.48 424441.31,-192.51 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert12_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2381" class="edge">
<title>expert12_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M421493.24,-162.02C421516.4,-171.57 421543.96,-181.22 421570,-185.98 421650.49,-200.72 424434.48,-193.1 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert13_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2382" class="edge">
<title>expert13_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M421246.24,-162.02C421269.4,-171.57 421296.96,-181.22 421323,-185.98 421366.62,-193.97 424471.82,-189.84 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert14_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2383" class="edge">
<title>expert14_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M420999.24,-162.02C421022.4,-171.57 421049.96,-181.22 421076,-185.98 421123,-194.59 424468.4,-190.14 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- expert15_l6_dp3&#45;&gt;expert_agg_l6_dp3 -->
<g id="edge2384" class="edge">
<title>expert15_l6_dp3&#45;&gt;expert_agg_l6_dp3</title>
<path fill="none" stroke="black" d="M420748.86,-162.02C420773.1,-171.58 420801.89,-181.22 420829,-185.98 420879.44,-194.84 424464.98,-190.44 424516,-185.98 424554.11,-182.65 424594.78,-176.86 424633.08,-170.36"/>
<polygon fill="black" stroke="black" points="424634.02,-173.75 424643.29,-168.6 424632.84,-166.85 424634.02,-173.75"/>
</g>
<!-- layer6_output_dp3 -->
<g id="node1418" class="node">
<title>layer6_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="425252" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="425252" y="-144.48" font-family="Arial" font-size="10.00">Layer 6 Output</text>
<text text-anchor="middle" x="425252" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="425252" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l6_dp3&#45;&gt;layer6_output_dp3 -->
<g id="edge2385" class="edge">
<title>expert_agg_l6_dp3&#45;&gt;layer6_output_dp3</title>
<path fill="none" stroke="black" d="M424997.31,-135.98C425022.49,-135.98 425047.66,-135.98 425072.84,-135.98"/>
<polygon fill="black" stroke="black" points="425072.87,-139.48 425082.87,-135.98 425072.87,-132.48 425072.87,-139.48"/>
</g>
<!-- attn_input_l7_dp3 -->
<g id="node1419" class="node">
<title>attn_input_l7_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="425625" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="425625" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L7</text>
<text text-anchor="middle" x="425625" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="425625" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer6_output_dp3&#45;&gt;attn_input_l7_dp3 -->
<g id="edge2386" class="edge">
<title>layer6_output_dp3&#45;&gt;attn_input_l7_dp3</title>
<path fill="none" stroke="black" d="M425421.01,-135.98C425429.23,-135.98 425437.44,-135.98 425445.66,-135.98"/>
<polygon fill="black" stroke="black" points="425445.68,-139.48 425455.68,-135.98 425445.68,-132.48 425445.68,-139.48"/>
</g>
<!-- attn_tp0_l7_dp3 -->
<g id="node1420" class="node">
<title>attn_tp0_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="426923,-161.98 426663,-161.98 426663,-109.98 426923,-109.98 426923,-161.98"/>
<text text-anchor="middle" x="426793" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L7</text>
<text text-anchor="middle" x="426793" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="426793" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="426793" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp3&#45;&gt;attn_tp0_l7_dp3 -->
<g id="edge2387" class="edge">
<title>attn_input_l7_dp3&#45;&gt;attn_tp0_l7_dp3</title>
<path fill="none" stroke="black" d="M425708.52,-161.26C425745.12,-171.09 425788.81,-181.13 425829,-185.98 425874,-191.42 426600.27,-193.33 426645,-185.98 426670.4,-181.81 426697.31,-173.85 426721.12,-165.5"/>
<polygon fill="black" stroke="black" points="426722.55,-168.71 426730.78,-162.03 426720.18,-162.12 426722.55,-168.71"/>
</g>
<!-- attn_tp1_l7_dp3 -->
<g id="node1421" class="node">
<title>attn_tp1_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="426645,-161.98 426385,-161.98 426385,-109.98 426645,-109.98 426645,-161.98"/>
<text text-anchor="middle" x="426515" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L7</text>
<text text-anchor="middle" x="426515" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="426515" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="426515" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp3&#45;&gt;attn_tp1_l7_dp3 -->
<g id="edge2388" class="edge">
<title>attn_input_l7_dp3&#45;&gt;attn_tp1_l7_dp3</title>
<path fill="none" stroke="black" d="M425708.52,-161.26C425745.12,-171.09 425788.81,-181.13 425829,-185.98 425888.35,-193.15 426308.01,-195.68 426367,-185.98 426392.4,-181.81 426419.31,-173.85 426443.12,-165.5"/>
<polygon fill="black" stroke="black" points="426444.55,-168.71 426452.78,-162.03 426442.18,-162.12 426444.55,-168.71"/>
</g>
<!-- attn_tp2_l7_dp3 -->
<g id="node1422" class="node">
<title>attn_tp2_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="426367,-161.98 426107,-161.98 426107,-109.98 426367,-109.98 426367,-161.98"/>
<text text-anchor="middle" x="426237" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L7</text>
<text text-anchor="middle" x="426237" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="426237" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="426237" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp3&#45;&gt;attn_tp2_l7_dp3 -->
<g id="edge2389" class="edge">
<title>attn_input_l7_dp3&#45;&gt;attn_tp2_l7_dp3</title>
<path fill="none" stroke="black" d="M425708.52,-161.26C425745.12,-171.09 425788.81,-181.13 425829,-185.98 425886.36,-192.91 426031.99,-195.35 426089,-185.98 426114.4,-181.81 426141.31,-173.85 426165.12,-165.5"/>
<polygon fill="black" stroke="black" points="426166.55,-168.71 426174.78,-162.03 426164.18,-162.12 426166.55,-168.71"/>
</g>
<!-- attn_tp3_l7_dp3 -->
<g id="node1423" class="node">
<title>attn_tp3_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="426089,-161.98 425829,-161.98 425829,-109.98 426089,-109.98 426089,-161.98"/>
<text text-anchor="middle" x="425959" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L7</text>
<text text-anchor="middle" x="425959" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="425959" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="425959" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l7_dp3&#45;&gt;attn_tp3_l7_dp3 -->
<g id="edge2390" class="edge">
<title>attn_input_l7_dp3&#45;&gt;attn_tp3_l7_dp3</title>
<path fill="none" stroke="black" d="M425794.28,-135.98C425802.35,-135.98 425810.42,-135.98 425818.49,-135.98"/>
<polygon fill="black" stroke="black" points="425818.7,-139.48 425828.7,-135.98 425818.7,-132.48 425818.7,-139.48"/>
</g>
<!-- allreduce_l7_dp3 -->
<g id="node1424" class="node">
<title>allreduce_l7_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="427127" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="427127" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L7</text>
<text text-anchor="middle" x="427127" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="427127" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l7_dp3&#45;&gt;allreduce_l7_dp3 -->
<g id="edge2391" class="edge">
<title>attn_tp0_l7_dp3&#45;&gt;allreduce_l7_dp3</title>
<path fill="none" stroke="black" d="M426923.14,-135.98C426931.35,-135.98 426939.56,-135.98 426947.77,-135.98"/>
<polygon fill="black" stroke="black" points="426947.78,-139.48 426957.78,-135.98 426947.78,-132.48 426947.78,-139.48"/>
</g>
<!-- attn_tp1_l7_dp3&#45;&gt;allreduce_l7_dp3 -->
<g id="edge2392" class="edge">
<title>attn_tp1_l7_dp3&#45;&gt;allreduce_l7_dp3</title>
<path fill="none" stroke="black" d="M426577.22,-162.03C426603.24,-171.59 426634.1,-181.23 426663,-185.98 426720.01,-195.35 426865.64,-192.91 426923,-185.98 426959.57,-181.57 426999.05,-172.85 427033.44,-163.91"/>
<polygon fill="black" stroke="black" points="427034.7,-167.2 427043.47,-161.26 427032.91,-160.43 427034.7,-167.2"/>
</g>
<!-- attn_tp2_l7_dp3&#45;&gt;allreduce_l7_dp3 -->
<g id="edge2393" class="edge">
<title>attn_tp2_l7_dp3&#45;&gt;allreduce_l7_dp3</title>
<path fill="none" stroke="black" d="M426299.22,-162.03C426325.24,-171.59 426356.1,-181.23 426385,-185.98 426443.98,-195.68 426863.65,-193.15 426923,-185.98 426959.57,-181.57 426999.05,-172.85 427033.44,-163.91"/>
<polygon fill="black" stroke="black" points="427034.7,-167.2 427043.47,-161.26 427032.91,-160.43 427034.7,-167.2"/>
</g>
<!-- attn_tp3_l7_dp3&#45;&gt;allreduce_l7_dp3 -->
<g id="edge2394" class="edge">
<title>attn_tp3_l7_dp3&#45;&gt;allreduce_l7_dp3</title>
<path fill="none" stroke="black" d="M426021.22,-162.03C426047.24,-171.59 426078.1,-181.23 426107,-185.98 426151.73,-193.33 426877.99,-191.42 426923,-185.98 426959.57,-181.57 426999.05,-172.85 427033.44,-163.91"/>
<polygon fill="black" stroke="black" points="427034.7,-167.2 427043.47,-161.26 427032.91,-160.43 427034.7,-167.2"/>
</g>
<!-- moe_input_l7_dp3 -->
<g id="node1425" class="node">
<title>moe_input_l7_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="427500" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="427500" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L7</text>
<text text-anchor="middle" x="427500" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="427500" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l7_dp3&#45;&gt;moe_input_l7_dp3 -->
<g id="edge2395" class="edge">
<title>allreduce_l7_dp3&#45;&gt;moe_input_l7_dp3</title>
<path fill="none" stroke="black" d="M427296.01,-135.98C427304.23,-135.98 427312.44,-135.98 427320.66,-135.98"/>
<polygon fill="black" stroke="black" points="427320.68,-139.48 427330.68,-135.98 427320.68,-132.48 427320.68,-139.48"/>
</g>
<!-- router_l7_dp3 -->
<g id="node1426" class="node">
<title>router_l7_dp3</title>
<polygon fill="lightyellow" stroke="black" points="428199.57,-176.98 427805.74,-176.98 427704.43,-94.98 428098.26,-94.98 428199.57,-176.98"/>
<text text-anchor="middle" x="427952" y="-144.48" font-family="Arial" font-size="10.00">Router L7</text>
<text text-anchor="middle" x="427952" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="427952" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l7_dp3&#45;&gt;router_l7_dp3 -->
<g id="edge2396" class="edge">
<title>moe_input_l7_dp3&#45;&gt;router_l7_dp3</title>
<path fill="none" stroke="black" d="M427669.06,-135.98C427694.34,-135.98 427719.63,-135.98 427744.92,-135.98"/>
<polygon fill="black" stroke="black" points="427744.99,-139.48 427754.99,-135.98 427744.99,-132.48 427744.99,-139.48"/>
</g>
<!-- expert0_l7_dp3 -->
<g id="node1427" class="node">
<title>expert0_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="432205.5,-161.98 431976.5,-161.98 431976.5,-109.98 432205.5,-109.98 432205.5,-161.98"/>
<text text-anchor="middle" x="432091" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L7</text>
<text text-anchor="middle" x="432091" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="432091" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="432091" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert0_l7_dp3 -->
<g id="edge2397" class="edge">
<title>router_l7_dp3&#45;&gt;expert0_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.74,-171.32C428214.09,-173.59 428235.41,-175.53 428256,-176.98 429016.47,-230.48 430924.15,-196.54 431686.5,-198.98 431811.55,-199.38 431844.59,-202.54 431967,-176.98 431981.75,-173.9 431997.19,-169.66 432011.98,-165.07"/>
<polygon fill="black" stroke="black" points="432013.12,-168.37 432021.59,-162 432011,-161.7 432013.12,-168.37"/>
<text text-anchor="middle" x="431708" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l7_dp3 -->
<g id="node1428" class="node">
<title>expert1_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="431958.5,-161.98 431729.5,-161.98 431729.5,-109.98 431958.5,-109.98 431958.5,-161.98"/>
<text text-anchor="middle" x="431844" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L7</text>
<text text-anchor="middle" x="431844" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="431844" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="431844" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert1_l7_dp3 -->
<g id="edge2398" class="edge">
<title>router_l7_dp3&#45;&gt;expert1_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.74,-171.31C428214.09,-173.58 428235.41,-175.53 428256,-176.98 428955.05,-226.36 430708.71,-196.54 431409.5,-198.98 431547.84,-199.47 431584.43,-204.56 431720,-176.98 431734.85,-173.96 431750.41,-169.72 431765.28,-165.11"/>
<polygon fill="black" stroke="black" points="431766.48,-168.4 431774.94,-162.03 431764.35,-161.73 431766.48,-168.4"/>
<text text-anchor="middle" x="431431" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l7_dp3 -->
<g id="node1429" class="node">
<title>expert2_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="431711.5,-161.98 431482.5,-161.98 431482.5,-109.98 431711.5,-109.98 431711.5,-161.98"/>
<text text-anchor="middle" x="431597" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L7</text>
<text text-anchor="middle" x="431597" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="431597" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="431597" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert2_l7_dp3 -->
<g id="edge2399" class="edge">
<title>router_l7_dp3&#45;&gt;expert2_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.74,-171.29C428214.1,-173.56 428235.41,-175.52 428256,-176.98 428887.21,-221.81 430470.71,-196.54 431103.5,-198.98 431268.01,-199.62 431311.55,-208.59 431473,-176.98 431488.06,-174.03 431503.82,-169.78 431518.86,-165.12"/>
<polygon fill="black" stroke="black" points="431520.17,-168.37 431528.63,-162 431518.04,-161.71 431520.17,-168.37"/>
<text text-anchor="middle" x="431125" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l7_dp3 -->
<g id="node1430" class="node">
<title>expert3_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="431464.5,-161.98 431235.5,-161.98 431235.5,-109.98 431464.5,-109.98 431464.5,-161.98"/>
<text text-anchor="middle" x="431350" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L7</text>
<text text-anchor="middle" x="431350" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="431350" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="431350" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert3_l7_dp3 -->
<g id="edge2400" class="edge">
<title>router_l7_dp3&#45;&gt;expert3_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.74,-171.27C428214.1,-173.54 428235.41,-175.51 428256,-176.98 428806.28,-216.37 430186.82,-196.54 430738.5,-198.98 430955.38,-199.94 431012.79,-216.75 431226,-176.98 431241.27,-174.14 431257.24,-169.88 431272.45,-165.17"/>
<polygon fill="black" stroke="black" points="431273.86,-168.39 431282.32,-162.01 431271.73,-161.72 431273.86,-168.39"/>
<text text-anchor="middle" x="430760" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l7_dp3 -->
<g id="node1431" class="node">
<title>expert4_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="431217.5,-161.98 430988.5,-161.98 430988.5,-109.98 431217.5,-109.98 431217.5,-161.98"/>
<text text-anchor="middle" x="431103" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L7</text>
<text text-anchor="middle" x="431103" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="431103" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="431103" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert4_l7_dp3 -->
<g id="edge2401" class="edge">
<title>router_l7_dp3&#45;&gt;expert4_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428097.67,-176.99C428136.3,-186.08 428178.21,-194.39 428217.5,-198.98 428236.48,-201.2 428241.39,-199.06 428260.5,-198.98 428562.56,-197.76 430680.97,-226.21 430979,-176.98 430994.93,-174.35 431011.6,-170.01 431027.35,-165.12"/>
<polygon fill="black" stroke="black" points="431028.58,-168.4 431037.03,-162.01 431026.44,-161.73 431028.58,-168.4"/>
<text text-anchor="middle" x="428239" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l7_dp3 -->
<g id="node1432" class="node">
<title>expert5_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="430970.5,-161.98 430741.5,-161.98 430741.5,-109.98 430970.5,-109.98 430970.5,-161.98"/>
<text text-anchor="middle" x="430856" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L7</text>
<text text-anchor="middle" x="430856" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="430856" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="430856" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert5_l7_dp3 -->
<g id="edge2402" class="edge">
<title>router_l7_dp3&#45;&gt;expert5_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.74,-171.22C428214.1,-173.51 428235.42,-175.49 428256,-176.98 428699.19,-209.18 429811.15,-196.54 430255.5,-198.98 430467.5,-200.15 430523.61,-215.98 430732,-176.98 430747.26,-174.13 430763.24,-169.86 430778.45,-165.15"/>
<polygon fill="black" stroke="black" points="430779.86,-168.37 430788.32,-162 430777.73,-161.71 430779.86,-168.37"/>
<text text-anchor="middle" x="430277" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l7_dp3 -->
<g id="node1433" class="node">
<title>expert6_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="430723.5,-161.98 430494.5,-161.98 430494.5,-109.98 430723.5,-109.98 430723.5,-161.98"/>
<text text-anchor="middle" x="430609" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L7</text>
<text text-anchor="middle" x="430609" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="430609" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="430609" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert6_l7_dp3 -->
<g id="edge2403" class="edge">
<title>router_l7_dp3&#45;&gt;expert6_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428124.37,-177C428169.98,-186.1 428219.37,-194.39 428265.5,-198.98 428284.52,-200.87 428289.39,-199.08 428308.5,-198.98 428550.34,-197.76 430246.43,-216.64 430485,-176.98 430500.84,-174.35 430517.4,-170.04 430533.07,-165.18"/>
<polygon fill="black" stroke="black" points="430534.25,-168.47 430542.7,-162.09 430532.11,-161.81 430534.25,-168.47"/>
<text text-anchor="middle" x="428287" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l7_dp3 -->
<g id="node1434" class="node">
<title>expert7_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="430476.5,-161.98 430247.5,-161.98 430247.5,-109.98 430476.5,-109.98 430476.5,-161.98"/>
<text text-anchor="middle" x="430362" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L7</text>
<text text-anchor="middle" x="430362" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="430362" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="430362" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert7_l7_dp3 -->
<g id="edge2404" class="edge">
<title>router_l7_dp3&#45;&gt;expert7_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.33,-171.1C428213.83,-173.42 428235.29,-175.44 428256,-176.98 428604.07,-202.87 429477.59,-208.3 429826.5,-198.98 430009.58,-194.09 430058.02,-210.92 430238,-176.98 430253.17,-174.12 430269.04,-169.88 430284.17,-165.2"/>
<polygon fill="black" stroke="black" points="430285.52,-168.44 430293.99,-162.07 430283.4,-161.77 430285.52,-168.44"/>
<text text-anchor="middle" x="429805" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l7_dp3 -->
<g id="node1435" class="node">
<title>expert8_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="430229.5,-161.98 430000.5,-161.98 430000.5,-109.98 430229.5,-109.98 430229.5,-161.98"/>
<text text-anchor="middle" x="430115" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L7</text>
<text text-anchor="middle" x="430115" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="430115" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="430115" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert8_l7_dp3 -->
<g id="edge2405" class="edge">
<title>router_l7_dp3&#45;&gt;expert8_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428151.02,-177C428203.62,-186.1 428260.5,-194.4 428313.5,-198.98 428332.54,-200.63 428337.39,-199.11 428356.5,-198.98 428538.12,-197.76 429811.88,-207.07 429991,-176.98 430006.83,-174.32 430023.39,-170 430039.07,-165.13"/>
<polygon fill="black" stroke="black" points="430040.24,-168.43 430048.7,-162.04 430038.1,-161.77 430040.24,-168.43"/>
<text text-anchor="middle" x="428335" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l7_dp3 -->
<g id="node1436" class="node">
<title>expert9_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="429982.5,-161.98 429753.5,-161.98 429753.5,-109.98 429982.5,-109.98 429982.5,-161.98"/>
<text text-anchor="middle" x="429868" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L7</text>
<text text-anchor="middle" x="429868" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="429868" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="429868" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert9_l7_dp3 -->
<g id="edge2406" class="edge">
<title>router_l7_dp3&#45;&gt;expert9_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428192.35,-170.96C428213.84,-173.31 428235.29,-175.38 428256,-176.98 428752.17,-215.39 428878.07,-213.82 429375.5,-198.98 429539.49,-194.09 429582.87,-207.88 429744,-176.98 429759.16,-174.08 429775.03,-169.81 429790.15,-165.12"/>
<polygon fill="black" stroke="black" points="429791.51,-168.37 429799.97,-161.99 429789.38,-161.7 429791.51,-168.37"/>
<text text-anchor="middle" x="429354" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l7_dp3 -->
<g id="node1437" class="node">
<title>expert10_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="429735.5,-161.98 429506.5,-161.98 429506.5,-109.98 429735.5,-109.98 429735.5,-161.98"/>
<text text-anchor="middle" x="429621" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L7</text>
<text text-anchor="middle" x="429621" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="429621" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="429621" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert10_l7_dp3 -->
<g id="edge2407" class="edge">
<title>router_l7_dp3&#45;&gt;expert10_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428177.65,-177.01C428237.23,-186.11 428301.61,-194.4 428361.5,-198.98 428487.32,-208.6 429372.62,-198.3 429497,-176.98 429512.73,-174.29 429529.18,-169.97 429544.78,-165.14"/>
<polygon fill="black" stroke="black" points="429545.9,-168.45 429554.36,-162.07 429543.77,-161.78 429545.9,-168.45"/>
<text text-anchor="middle" x="428383" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l7_dp3 -->
<g id="node1438" class="node">
<title>expert11_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="429488.5,-161.98 429259.5,-161.98 429259.5,-109.98 429488.5,-109.98 429488.5,-161.98"/>
<text text-anchor="middle" x="429374" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L7</text>
<text text-anchor="middle" x="429374" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="429374" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="429374" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert11_l7_dp3 -->
<g id="edge2408" class="edge">
<title>router_l7_dp3&#45;&gt;expert11_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428191.95,-170.64C428213.58,-173.07 428235.17,-175.24 428256,-176.98 428571.71,-203.39 428651.92,-211.33 428968.5,-198.98 429093.9,-194.09 429126.97,-201.75 429250,-176.98 429264.86,-173.99 429280.42,-169.77 429295.29,-165.16"/>
<polygon fill="black" stroke="black" points="429296.48,-168.45 429304.95,-162.08 429294.36,-161.78 429296.48,-168.45"/>
<text text-anchor="middle" x="428947" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l7_dp3 -->
<g id="node1439" class="node">
<title>expert12_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="429241.5,-161.98 429012.5,-161.98 429012.5,-109.98 429241.5,-109.98 429241.5,-161.98"/>
<text text-anchor="middle" x="429127" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L7</text>
<text text-anchor="middle" x="429127" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="429127" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="429127" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert12_l7_dp3 -->
<g id="edge2409" class="edge">
<title>router_l7_dp3&#45;&gt;expert12_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428198.89,-176.28C428266.94,-185.66 428340.91,-194.28 428409.5,-198.98 428541.17,-208.01 428873.14,-200.56 429003,-176.98 429018.37,-174.19 429034.45,-169.93 429049.75,-165.2"/>
<polygon fill="black" stroke="black" points="429051.21,-168.41 429059.67,-162.03 429049.08,-161.74 429051.21,-168.41"/>
<text text-anchor="middle" x="428431" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l7_dp3 -->
<g id="node1440" class="node">
<title>expert13_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="428994.5,-161.98 428765.5,-161.98 428765.5,-109.98 428994.5,-109.98 428994.5,-161.98"/>
<text text-anchor="middle" x="428880" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L7</text>
<text text-anchor="middle" x="428880" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="428880" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="428880" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert13_l7_dp3 -->
<g id="edge2410" class="edge">
<title>router_l7_dp3&#45;&gt;expert13_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428169.82,-177.02C428306.96,-197.58 428487.66,-215.02 428647.5,-198.98 428698.66,-193.85 428754.31,-179.11 428798.33,-165.18"/>
<polygon fill="black" stroke="black" points="428799.66,-168.43 428808.11,-162.04 428797.52,-161.77 428799.66,-168.43"/>
<text text-anchor="middle" x="428626" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l7_dp3 -->
<g id="node1441" class="node">
<title>expert14_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="428747.5,-161.98 428518.5,-161.98 428518.5,-109.98 428747.5,-109.98 428747.5,-161.98"/>
<text text-anchor="middle" x="428633" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L7</text>
<text text-anchor="middle" x="428633" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="428633" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="428633" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert14_l7_dp3 -->
<g id="edge2411" class="edge">
<title>router_l7_dp3&#45;&gt;expert14_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428177.44,-176.99C428300.58,-196.39 428440.01,-212.63 428500.5,-198.98 428528.7,-192.62 428557.94,-179.52 428581.75,-166.9"/>
<polygon fill="black" stroke="black" points="428583.48,-169.94 428590.6,-162.1 428580.14,-163.79 428583.48,-169.94"/>
<text text-anchor="middle" x="428479" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l7_dp3 -->
<g id="node1442" class="node">
<title>expert15_l7_dp3</title>
<polygon fill="lightgreen" stroke="black" points="428494.5,-161.98 428265.5,-161.98 428265.5,-109.98 428494.5,-109.98 428494.5,-161.98"/>
<text text-anchor="middle" x="428380" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L7</text>
<text text-anchor="middle" x="428380" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="428380" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="428380" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l7_dp3&#45;&gt;expert15_l7_dp3 -->
<g id="edge2412" class="edge">
<title>router_l7_dp3&#45;&gt;expert15_l7_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428149.09,-135.98C428185.17,-135.98 428221.91,-135.98 428255.14,-135.98"/>
<polygon fill="black" stroke="black" points="428255.34,-139.48 428265.34,-135.98 428255.34,-132.48 428255.34,-139.48"/>
<text text-anchor="middle" x="428232.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l7_dp3 -->
<g id="node1443" class="node">
<title>expert_agg_l7_dp3</title>
<polygon fill="lightyellow" stroke="black" points="432736.57,-176.98 432342.74,-176.98 432241.43,-94.98 432635.26,-94.98 432736.57,-176.98"/>
<text text-anchor="middle" x="432489" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L7</text>
<text text-anchor="middle" x="432489" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="432489" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2413" class="edge">
<title>expert0_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M432205.66,-135.98C432231.06,-135.98 432256.47,-135.98 432281.87,-135.98"/>
<polygon fill="black" stroke="black" points="432281.99,-139.48 432291.99,-135.98 432281.99,-132.48 432281.99,-139.48"/>
</g>
<!-- expert1_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2414" class="edge">
<title>expert1_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M431899.24,-162.02C431922.4,-171.57 431949.96,-181.22 431976,-185.98 432026.06,-195.15 432154.3,-190.41 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert2_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2415" class="edge">
<title>expert2_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M431652.24,-162.02C431675.4,-171.57 431702.96,-181.22 431729,-185.98 431781.02,-195.51 432152.31,-190.59 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert3_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2416" class="edge">
<title>expert3_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M431405.24,-162.02C431428.4,-171.57 431455.96,-181.22 431482,-185.98 431561.02,-200.45 432124.97,-192.97 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert4_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2417" class="edge">
<title>expert4_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M431158.24,-162.02C431181.4,-171.57 431208.96,-181.22 431235,-185.98 431288.01,-195.69 432151.31,-190.67 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert5_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2418" class="edge">
<title>expert5_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M430911.24,-162.02C430934.4,-171.57 430961.96,-181.22 430988,-185.98 431054.5,-198.16 432137.64,-191.87 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert6_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2419" class="edge">
<title>expert6_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M430664.24,-162.02C430687.4,-171.57 430714.96,-181.22 430741,-185.98 430821,-200.63 432123.97,-193.06 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert7_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2420" class="edge">
<title>expert7_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M430417.24,-162.02C430440.4,-171.57 430467.96,-181.22 430494,-185.98 430540.75,-194.54 432157.65,-190.12 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert8_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2421" class="edge">
<title>expert8_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M430170.24,-162.02C430193.4,-171.57 430220.96,-181.22 430247,-185.98 430300.5,-195.78 432150.82,-190.72 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert9_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2422" class="edge">
<title>expert9_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M429923.24,-162.02C429946.4,-171.57 429973.96,-181.22 430000,-185.98 430060.25,-197.01 432143.98,-191.31 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert10_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2423" class="edge">
<title>expert10_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M429676.24,-162.02C429699.4,-171.57 429726.96,-181.22 429753,-185.98 429820,-198.25 432137.15,-191.91 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert11_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2424" class="edge">
<title>expert11_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M429429.24,-162.02C429452.4,-171.57 429479.96,-181.22 429506,-185.98 429579.75,-199.48 432130.31,-192.51 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert12_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2425" class="edge">
<title>expert12_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M429182.24,-162.02C429205.4,-171.57 429232.96,-181.22 429259,-185.98 429339.49,-200.72 432123.48,-193.1 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert13_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2426" class="edge">
<title>expert13_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M428935.24,-162.02C428958.4,-171.57 428985.96,-181.22 429012,-185.98 429055.62,-193.97 432160.82,-189.84 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert14_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2427" class="edge">
<title>expert14_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M428688.24,-162.02C428711.4,-171.57 428738.96,-181.22 428765,-185.98 428812,-194.59 432157.4,-190.14 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- expert15_l7_dp3&#45;&gt;expert_agg_l7_dp3 -->
<g id="edge2428" class="edge">
<title>expert15_l7_dp3&#45;&gt;expert_agg_l7_dp3</title>
<path fill="none" stroke="black" d="M428437.86,-162.02C428462.1,-171.58 428490.89,-181.22 428518,-185.98 428568.44,-194.84 432153.98,-190.44 432205,-185.98 432243.11,-182.65 432283.78,-176.86 432322.08,-170.36"/>
<polygon fill="black" stroke="black" points="432323.02,-173.75 432332.29,-168.6 432321.84,-166.85 432323.02,-173.75"/>
</g>
<!-- layer7_output_dp3 -->
<g id="node1444" class="node">
<title>layer7_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="432941" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="432941" y="-144.48" font-family="Arial" font-size="10.00">Layer 7 Output</text>
<text text-anchor="middle" x="432941" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="432941" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l7_dp3&#45;&gt;layer7_output_dp3 -->
<g id="edge2429" class="edge">
<title>expert_agg_l7_dp3&#45;&gt;layer7_output_dp3</title>
<path fill="none" stroke="black" d="M432686.31,-135.98C432711.49,-135.98 432736.66,-135.98 432761.84,-135.98"/>
<polygon fill="black" stroke="black" points="432761.87,-139.48 432771.87,-135.98 432761.87,-132.48 432761.87,-139.48"/>
</g>
<!-- attn_input_l8_dp3 -->
<g id="node1445" class="node">
<title>attn_input_l8_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="433314" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="433314" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L8</text>
<text text-anchor="middle" x="433314" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="433314" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer7_output_dp3&#45;&gt;attn_input_l8_dp3 -->
<g id="edge2430" class="edge">
<title>layer7_output_dp3&#45;&gt;attn_input_l8_dp3</title>
<path fill="none" stroke="black" d="M433110.01,-135.98C433118.23,-135.98 433126.44,-135.98 433134.66,-135.98"/>
<polygon fill="black" stroke="black" points="433134.68,-139.48 433144.68,-135.98 433134.68,-132.48 433134.68,-139.48"/>
</g>
<!-- attn_tp0_l8_dp3 -->
<g id="node1446" class="node">
<title>attn_tp0_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="434612,-161.98 434352,-161.98 434352,-109.98 434612,-109.98 434612,-161.98"/>
<text text-anchor="middle" x="434482" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L8</text>
<text text-anchor="middle" x="434482" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="434482" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="434482" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp3&#45;&gt;attn_tp0_l8_dp3 -->
<g id="edge2431" class="edge">
<title>attn_input_l8_dp3&#45;&gt;attn_tp0_l8_dp3</title>
<path fill="none" stroke="black" d="M433397.52,-161.26C433434.12,-171.09 433477.81,-181.13 433518,-185.98 433563,-191.42 434289.27,-193.33 434334,-185.98 434359.4,-181.81 434386.31,-173.85 434410.12,-165.5"/>
<polygon fill="black" stroke="black" points="434411.55,-168.71 434419.78,-162.03 434409.18,-162.12 434411.55,-168.71"/>
</g>
<!-- attn_tp1_l8_dp3 -->
<g id="node1447" class="node">
<title>attn_tp1_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="434334,-161.98 434074,-161.98 434074,-109.98 434334,-109.98 434334,-161.98"/>
<text text-anchor="middle" x="434204" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L8</text>
<text text-anchor="middle" x="434204" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="434204" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="434204" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp3&#45;&gt;attn_tp1_l8_dp3 -->
<g id="edge2432" class="edge">
<title>attn_input_l8_dp3&#45;&gt;attn_tp1_l8_dp3</title>
<path fill="none" stroke="black" d="M433397.52,-161.26C433434.12,-171.09 433477.81,-181.13 433518,-185.98 433577.35,-193.15 433997.01,-195.68 434056,-185.98 434081.4,-181.81 434108.31,-173.85 434132.12,-165.5"/>
<polygon fill="black" stroke="black" points="434133.55,-168.71 434141.78,-162.03 434131.18,-162.12 434133.55,-168.71"/>
</g>
<!-- attn_tp2_l8_dp3 -->
<g id="node1448" class="node">
<title>attn_tp2_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="434056,-161.98 433796,-161.98 433796,-109.98 434056,-109.98 434056,-161.98"/>
<text text-anchor="middle" x="433926" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L8</text>
<text text-anchor="middle" x="433926" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="433926" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="433926" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp3&#45;&gt;attn_tp2_l8_dp3 -->
<g id="edge2433" class="edge">
<title>attn_input_l8_dp3&#45;&gt;attn_tp2_l8_dp3</title>
<path fill="none" stroke="black" d="M433397.52,-161.26C433434.12,-171.09 433477.81,-181.13 433518,-185.98 433575.36,-192.91 433720.99,-195.35 433778,-185.98 433803.4,-181.81 433830.31,-173.85 433854.12,-165.5"/>
<polygon fill="black" stroke="black" points="433855.55,-168.71 433863.78,-162.03 433853.18,-162.12 433855.55,-168.71"/>
</g>
<!-- attn_tp3_l8_dp3 -->
<g id="node1449" class="node">
<title>attn_tp3_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="433778,-161.98 433518,-161.98 433518,-109.98 433778,-109.98 433778,-161.98"/>
<text text-anchor="middle" x="433648" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L8</text>
<text text-anchor="middle" x="433648" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="433648" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="433648" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l8_dp3&#45;&gt;attn_tp3_l8_dp3 -->
<g id="edge2434" class="edge">
<title>attn_input_l8_dp3&#45;&gt;attn_tp3_l8_dp3</title>
<path fill="none" stroke="black" d="M433483.28,-135.98C433491.35,-135.98 433499.42,-135.98 433507.49,-135.98"/>
<polygon fill="black" stroke="black" points="433507.7,-139.48 433517.7,-135.98 433507.7,-132.48 433507.7,-139.48"/>
</g>
<!-- allreduce_l8_dp3 -->
<g id="node1450" class="node">
<title>allreduce_l8_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="434816" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="434816" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L8</text>
<text text-anchor="middle" x="434816" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="434816" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l8_dp3&#45;&gt;allreduce_l8_dp3 -->
<g id="edge2435" class="edge">
<title>attn_tp0_l8_dp3&#45;&gt;allreduce_l8_dp3</title>
<path fill="none" stroke="black" d="M434612.14,-135.98C434620.35,-135.98 434628.56,-135.98 434636.77,-135.98"/>
<polygon fill="black" stroke="black" points="434636.78,-139.48 434646.78,-135.98 434636.78,-132.48 434636.78,-139.48"/>
</g>
<!-- attn_tp1_l8_dp3&#45;&gt;allreduce_l8_dp3 -->
<g id="edge2436" class="edge">
<title>attn_tp1_l8_dp3&#45;&gt;allreduce_l8_dp3</title>
<path fill="none" stroke="black" d="M434266.22,-162.03C434292.24,-171.59 434323.1,-181.23 434352,-185.98 434409.01,-195.35 434554.64,-192.91 434612,-185.98 434648.57,-181.57 434688.05,-172.85 434722.44,-163.91"/>
<polygon fill="black" stroke="black" points="434723.7,-167.2 434732.47,-161.26 434721.91,-160.43 434723.7,-167.2"/>
</g>
<!-- attn_tp2_l8_dp3&#45;&gt;allreduce_l8_dp3 -->
<g id="edge2437" class="edge">
<title>attn_tp2_l8_dp3&#45;&gt;allreduce_l8_dp3</title>
<path fill="none" stroke="black" d="M433988.22,-162.03C434014.24,-171.59 434045.1,-181.23 434074,-185.98 434132.98,-195.68 434552.65,-193.15 434612,-185.98 434648.57,-181.57 434688.05,-172.85 434722.44,-163.91"/>
<polygon fill="black" stroke="black" points="434723.7,-167.2 434732.47,-161.26 434721.91,-160.43 434723.7,-167.2"/>
</g>
<!-- attn_tp3_l8_dp3&#45;&gt;allreduce_l8_dp3 -->
<g id="edge2438" class="edge">
<title>attn_tp3_l8_dp3&#45;&gt;allreduce_l8_dp3</title>
<path fill="none" stroke="black" d="M433710.22,-162.03C433736.24,-171.59 433767.1,-181.23 433796,-185.98 433840.73,-193.33 434566.99,-191.42 434612,-185.98 434648.57,-181.57 434688.05,-172.85 434722.44,-163.91"/>
<polygon fill="black" stroke="black" points="434723.7,-167.2 434732.47,-161.26 434721.91,-160.43 434723.7,-167.2"/>
</g>
<!-- moe_input_l8_dp3 -->
<g id="node1451" class="node">
<title>moe_input_l8_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="435189" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="435189" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L8</text>
<text text-anchor="middle" x="435189" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="435189" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l8_dp3&#45;&gt;moe_input_l8_dp3 -->
<g id="edge2439" class="edge">
<title>allreduce_l8_dp3&#45;&gt;moe_input_l8_dp3</title>
<path fill="none" stroke="black" d="M434985.01,-135.98C434993.23,-135.98 435001.44,-135.98 435009.66,-135.98"/>
<polygon fill="black" stroke="black" points="435009.68,-139.48 435019.68,-135.98 435009.68,-132.48 435009.68,-139.48"/>
</g>
<!-- router_l8_dp3 -->
<g id="node1452" class="node">
<title>router_l8_dp3</title>
<polygon fill="lightyellow" stroke="black" points="435888.57,-176.98 435494.74,-176.98 435393.43,-94.98 435787.26,-94.98 435888.57,-176.98"/>
<text text-anchor="middle" x="435641" y="-144.48" font-family="Arial" font-size="10.00">Router L8</text>
<text text-anchor="middle" x="435641" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="435641" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l8_dp3&#45;&gt;router_l8_dp3 -->
<g id="edge2440" class="edge">
<title>moe_input_l8_dp3&#45;&gt;router_l8_dp3</title>
<path fill="none" stroke="black" d="M435358.06,-135.98C435383.34,-135.98 435408.63,-135.98 435433.92,-135.98"/>
<polygon fill="black" stroke="black" points="435433.99,-139.48 435443.99,-135.98 435433.99,-132.48 435433.99,-139.48"/>
</g>
<!-- expert0_l8_dp3 -->
<g id="node1453" class="node">
<title>expert0_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="439894.5,-161.98 439665.5,-161.98 439665.5,-109.98 439894.5,-109.98 439894.5,-161.98"/>
<text text-anchor="middle" x="439780" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L8</text>
<text text-anchor="middle" x="439780" y="-138.98" font-family="Arial" font-size="10.00">GPU 96</text>
<text text-anchor="middle" x="439780" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="439780" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert0_l8_dp3 -->
<g id="edge2441" class="edge">
<title>router_l8_dp3&#45;&gt;expert0_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.74,-171.32C435903.09,-173.59 435924.41,-175.53 435945,-176.98 436708.79,-230.71 438624.82,-196.54 439390.5,-198.98 439508.9,-199.36 439540.17,-201.54 439656,-176.98 439670.65,-173.88 439685.99,-169.65 439700.69,-165.08"/>
<polygon fill="black" stroke="black" points="439701.78,-168.4 439710.25,-162.03 439699.66,-161.73 439701.78,-168.4"/>
<text text-anchor="middle" x="439412" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l8_dp3 -->
<g id="node1454" class="node">
<title>expert1_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="439647.5,-161.98 439418.5,-161.98 439418.5,-109.98 439647.5,-109.98 439647.5,-161.98"/>
<text text-anchor="middle" x="439533" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L8</text>
<text text-anchor="middle" x="439533" y="-138.98" font-family="Arial" font-size="10.00">GPU 97</text>
<text text-anchor="middle" x="439533" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="439533" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert1_l8_dp3 -->
<g id="edge2442" class="edge">
<title>router_l8_dp3&#45;&gt;expert1_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.74,-171.31C435903.09,-173.58 435924.41,-175.53 435945,-176.98 436650.7,-226.81 438421.04,-196.54 439128.5,-198.98 439253.55,-199.41 439286.59,-202.54 439409,-176.98 439423.75,-173.9 439439.19,-169.66 439453.98,-165.07"/>
<polygon fill="black" stroke="black" points="439455.12,-168.37 439463.59,-162 439453,-161.7 439455.12,-168.37"/>
<text text-anchor="middle" x="439150" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l8_dp3 -->
<g id="node1455" class="node">
<title>expert2_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="439400.5,-161.98 439171.5,-161.98 439171.5,-109.98 439400.5,-109.98 439400.5,-161.98"/>
<text text-anchor="middle" x="439286" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L8</text>
<text text-anchor="middle" x="439286" y="-138.98" font-family="Arial" font-size="10.00">GPU 98</text>
<text text-anchor="middle" x="439286" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="439286" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert2_l8_dp3 -->
<g id="edge2443" class="edge">
<title>router_l8_dp3&#45;&gt;expert2_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.74,-171.29C435903.1,-173.57 435924.41,-175.52 435945,-176.98 436589.51,-222.7 438206.37,-196.54 438852.5,-198.98 438990.4,-199.5 439026.87,-204.49 439162,-176.98 439176.85,-173.96 439192.41,-169.72 439207.28,-165.1"/>
<polygon fill="black" stroke="black" points="439208.47,-168.39 439216.94,-162.02 439206.35,-161.72 439208.47,-168.39"/>
<text text-anchor="middle" x="438874" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l8_dp3 -->
<g id="node1456" class="node">
<title>expert3_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="439153.5,-161.98 438924.5,-161.98 438924.5,-109.98 439153.5,-109.98 439153.5,-161.98"/>
<text text-anchor="middle" x="439039" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L8</text>
<text text-anchor="middle" x="439039" y="-138.98" font-family="Arial" font-size="10.00">GPU 99</text>
<text text-anchor="middle" x="439039" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="439039" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert3_l8_dp3 -->
<g id="edge2444" class="edge">
<title>router_l8_dp3&#45;&gt;expert3_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.74,-171.27C435903.1,-173.55 435924.41,-175.51 435945,-176.98 436521.88,-218.16 437969.15,-196.54 438547.5,-198.98 438711.12,-199.67 438754.43,-208.45 438915,-176.98 438930.06,-174.03 438945.82,-169.78 438960.86,-165.11"/>
<polygon fill="black" stroke="black" points="438962.16,-168.37 438970.63,-162 438960.04,-161.7 438962.16,-168.37"/>
<text text-anchor="middle" x="438569" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l8_dp3 -->
<g id="node1457" class="node">
<title>expert4_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="438906.5,-161.98 438677.5,-161.98 438677.5,-109.98 438906.5,-109.98 438906.5,-161.98"/>
<text text-anchor="middle" x="438792" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L8</text>
<text text-anchor="middle" x="438792" y="-138.98" font-family="Arial" font-size="10.00">GPU 100</text>
<text text-anchor="middle" x="438792" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="438792" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert4_l8_dp3 -->
<g id="edge2445" class="edge">
<title>router_l8_dp3&#45;&gt;expert4_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.74,-171.24C435903.1,-173.53 435924.42,-175.5 435945,-176.98 436441.18,-212.74 437686.04,-196.54 438183.5,-198.98 438399.05,-200.04 438456.1,-216.54 438668,-176.98 438683.27,-174.13 438699.24,-169.87 438714.45,-165.16"/>
<polygon fill="black" stroke="black" points="438715.86,-168.39 438724.32,-162.01 438713.73,-161.72 438715.86,-168.39"/>
<text text-anchor="middle" x="438205" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l8_dp3 -->
<g id="node1458" class="node">
<title>expert5_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="438659.5,-161.98 438430.5,-161.98 438430.5,-109.98 438659.5,-109.98 438659.5,-161.98"/>
<text text-anchor="middle" x="438545" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L8</text>
<text text-anchor="middle" x="438545" y="-138.98" font-family="Arial" font-size="10.00">GPU 101</text>
<text text-anchor="middle" x="438545" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="438545" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert5_l8_dp3 -->
<g id="edge2446" class="edge">
<title>router_l8_dp3&#45;&gt;expert5_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435786.67,-176.99C435825.3,-186.08 435867.21,-194.39 435906.5,-198.98 435925.48,-201.2 435930.39,-199.07 435949.5,-198.98 436224.12,-197.76 438150.07,-221.85 438421,-176.98 438436.93,-174.34 438453.59,-170 438469.35,-165.11"/>
<polygon fill="black" stroke="black" points="438470.58,-168.39 438479.03,-162 438468.44,-161.72 438470.58,-168.39"/>
<text text-anchor="middle" x="435928" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l8_dp3 -->
<g id="node1459" class="node">
<title>expert6_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="438412.5,-161.98 438183.5,-161.98 438183.5,-109.98 438412.5,-109.98 438412.5,-161.98"/>
<text text-anchor="middle" x="438298" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L8</text>
<text text-anchor="middle" x="438298" y="-138.98" font-family="Arial" font-size="10.00">GPU 102</text>
<text text-anchor="middle" x="438298" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="438298" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert6_l8_dp3 -->
<g id="edge2447" class="edge">
<title>router_l8_dp3&#45;&gt;expert6_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.75,-171.18C435903.1,-173.48 435924.42,-175.47 435945,-176.98 436344.29,-206.3 437346.27,-209.27 437746.5,-198.98 437936.69,-194.09 437987.01,-212.05 438174,-176.98 438189.26,-174.12 438205.24,-169.85 438220.45,-165.14"/>
<polygon fill="black" stroke="black" points="438221.85,-168.37 438230.32,-161.99 438219.73,-161.7 438221.85,-168.37"/>
<text text-anchor="middle" x="437725" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l8_dp3 -->
<g id="node1460" class="node">
<title>expert7_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="438165.5,-161.98 437936.5,-161.98 437936.5,-109.98 438165.5,-109.98 438165.5,-161.98"/>
<text text-anchor="middle" x="438051" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L8</text>
<text text-anchor="middle" x="438051" y="-138.98" font-family="Arial" font-size="10.00">GPU 103</text>
<text text-anchor="middle" x="438051" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="438051" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert7_l8_dp3 -->
<g id="edge2448" class="edge">
<title>router_l8_dp3&#45;&gt;expert7_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435813.37,-177C435858.98,-186.1 435908.37,-194.39 435954.5,-198.98 435973.52,-200.87 435978.39,-199.09 435997.5,-198.98 436211.9,-197.76 437715.52,-212.28 437927,-176.98 437942.83,-174.34 437959.4,-170.02 437975.07,-165.16"/>
<polygon fill="black" stroke="black" points="437976.25,-168.46 437984.7,-162.07 437974.11,-161.79 437976.25,-168.46"/>
<text text-anchor="middle" x="435976" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l8_dp3 -->
<g id="node1461" class="node">
<title>expert8_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="437918.5,-161.98 437689.5,-161.98 437689.5,-109.98 437918.5,-109.98 437918.5,-161.98"/>
<text text-anchor="middle" x="437804" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L8</text>
<text text-anchor="middle" x="437804" y="-138.98" font-family="Arial" font-size="10.00">GPU 104</text>
<text text-anchor="middle" x="437804" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="437804" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert8_l8_dp3 -->
<g id="edge2449" class="edge">
<title>router_l8_dp3&#45;&gt;expert8_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435881.34,-171.04C435902.83,-173.37 435924.29,-175.42 435945,-176.98 436240.97,-199.38 436983.79,-207.15 437280.5,-198.98 437458.26,-194.09 437505.28,-210.07 437680,-176.98 437695.17,-174.11 437711.04,-169.87 437726.16,-165.18"/>
<polygon fill="black" stroke="black" points="437727.52,-168.42 437735.98,-162.05 437725.39,-161.75 437727.52,-168.42"/>
<text text-anchor="middle" x="437259" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l8_dp3 -->
<g id="node1462" class="node">
<title>expert9_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="437671.5,-161.98 437442.5,-161.98 437442.5,-109.98 437671.5,-109.98 437671.5,-161.98"/>
<text text-anchor="middle" x="437557" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L8</text>
<text text-anchor="middle" x="437557" y="-138.98" font-family="Arial" font-size="10.00">GPU 105</text>
<text text-anchor="middle" x="437557" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="437557" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert9_l8_dp3 -->
<g id="edge2450" class="edge">
<title>router_l8_dp3&#45;&gt;expert9_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435840.02,-177C435892.62,-186.1 435949.5,-194.4 436002.5,-198.98 436021.54,-200.63 436026.39,-199.13 436045.5,-198.98 436353.86,-196.54 437128.95,-228.42 437433,-176.98 437448.83,-174.3 437465.39,-169.97 437481.06,-165.1"/>
<polygon fill="black" stroke="black" points="437482.24,-168.4 437490.69,-162.01 437480.1,-161.74 437482.24,-168.4"/>
<text text-anchor="middle" x="436024" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l8_dp3 -->
<g id="node1463" class="node">
<title>expert10_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="437424.5,-161.98 437195.5,-161.98 437195.5,-109.98 437424.5,-109.98 437424.5,-161.98"/>
<text text-anchor="middle" x="437310" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L8</text>
<text text-anchor="middle" x="437310" y="-138.98" font-family="Arial" font-size="10.00">GPU 106</text>
<text text-anchor="middle" x="437310" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="437310" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert10_l8_dp3 -->
<g id="edge2451" class="edge">
<title>router_l8_dp3&#45;&gt;expert10_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435880.94,-170.8C435902.57,-173.19 435924.16,-175.31 435945,-176.98 436342.73,-208.83 436443.69,-211.74 436842.5,-198.98 436995.4,-194.09 437035.82,-206.12 437186,-176.98 437201.06,-174.06 437216.83,-169.82 437231.87,-165.16"/>
<polygon fill="black" stroke="black" points="437233.17,-168.42 437241.64,-162.04 437231.05,-161.75 437233.17,-168.42"/>
<text text-anchor="middle" x="436821" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l8_dp3 -->
<g id="node1464" class="node">
<title>expert11_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="437177.5,-161.98 436948.5,-161.98 436948.5,-109.98 437177.5,-109.98 437177.5,-161.98"/>
<text text-anchor="middle" x="437063" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L8</text>
<text text-anchor="middle" x="437063" y="-138.98" font-family="Arial" font-size="10.00">GPU 107</text>
<text text-anchor="middle" x="437063" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="437063" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert11_l8_dp3 -->
<g id="edge2452" class="edge">
<title>router_l8_dp3&#45;&gt;expert11_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435866.65,-177.01C435926.23,-186.11 435990.61,-194.4 436050.5,-198.98 436247.43,-214.04 436744.43,-210.92 436939,-176.98 436954.72,-174.24 436971.17,-169.91 436986.76,-165.06"/>
<polygon fill="black" stroke="black" points="436987.89,-168.38 436996.35,-161.99 436985.75,-161.71 436987.89,-168.38"/>
<text text-anchor="middle" x="436072" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l8_dp3 -->
<g id="node1465" class="node">
<title>expert12_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="436930.5,-161.98 436701.5,-161.98 436701.5,-109.98 436930.5,-109.98 436930.5,-161.98"/>
<text text-anchor="middle" x="436816" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L8</text>
<text text-anchor="middle" x="436816" y="-138.98" font-family="Arial" font-size="10.00">GPU 108</text>
<text text-anchor="middle" x="436816" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="436816" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert12_l8_dp3 -->
<g id="edge2453" class="edge">
<title>router_l8_dp3&#45;&gt;expert12_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435880.57,-170.29C435902.33,-172.8 435924.05,-175.09 435945,-176.98 435945,-176.98 436692,-176.98 436692,-176.98 436706.65,-173.9 436722,-169.69 436736.7,-165.12"/>
<polygon fill="black" stroke="black" points="436737.79,-168.45 436746.26,-162.08 436735.67,-161.78 436737.79,-168.45"/>
<text text-anchor="middle" x="436439" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l8_dp3 -->
<g id="node1466" class="node">
<title>expert13_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="436683.5,-161.98 436454.5,-161.98 436454.5,-109.98 436683.5,-109.98 436683.5,-161.98"/>
<text text-anchor="middle" x="436569" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L8</text>
<text text-anchor="middle" x="436569" y="-138.98" font-family="Arial" font-size="10.00">GPU 109</text>
<text text-anchor="middle" x="436569" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="436569" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert13_l8_dp3 -->
<g id="edge2454" class="edge">
<title>router_l8_dp3&#45;&gt;expert13_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435887.89,-176.28C435955.94,-185.66 436029.91,-194.28 436098.5,-198.98 436213.39,-206.86 436318.97,-201.98 436445,-176.98 436459.96,-174.01 436475.62,-169.78 436490.58,-165.14"/>
<polygon fill="black" stroke="black" points="436491.83,-168.41 436500.29,-162.04 436489.7,-161.74 436491.83,-168.41"/>
<text text-anchor="middle" x="436120" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l8_dp3 -->
<g id="node1467" class="node">
<title>expert14_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="436436.5,-161.98 436207.5,-161.98 436207.5,-109.98 436436.5,-109.98 436436.5,-161.98"/>
<text text-anchor="middle" x="436322" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L8</text>
<text text-anchor="middle" x="436322" y="-138.98" font-family="Arial" font-size="10.00">GPU 110</text>
<text text-anchor="middle" x="436322" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="436322" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert14_l8_dp3 -->
<g id="edge2455" class="edge">
<title>router_l8_dp3&#45;&gt;expert14_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435866.44,-176.99C435989.58,-196.39 436129.01,-212.63 436189.5,-198.98 436217.7,-192.62 436246.94,-179.52 436270.75,-166.9"/>
<polygon fill="black" stroke="black" points="436272.48,-169.94 436279.6,-162.1 436269.14,-163.79 436272.48,-169.94"/>
<text text-anchor="middle" x="436168" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l8_dp3 -->
<g id="node1468" class="node">
<title>expert15_l8_dp3</title>
<polygon fill="lightgreen" stroke="black" points="436183.5,-161.98 435954.5,-161.98 435954.5,-109.98 436183.5,-109.98 436183.5,-161.98"/>
<text text-anchor="middle" x="436069" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L8</text>
<text text-anchor="middle" x="436069" y="-138.98" font-family="Arial" font-size="10.00">GPU 111</text>
<text text-anchor="middle" x="436069" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="436069" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l8_dp3&#45;&gt;expert15_l8_dp3 -->
<g id="edge2456" class="edge">
<title>router_l8_dp3&#45;&gt;expert15_l8_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M435838.09,-135.98C435874.17,-135.98 435910.91,-135.98 435944.14,-135.98"/>
<polygon fill="black" stroke="black" points="435944.34,-139.48 435954.34,-135.98 435944.34,-132.48 435944.34,-139.48"/>
<text text-anchor="middle" x="435921.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l8_dp3 -->
<g id="node1469" class="node">
<title>expert_agg_l8_dp3</title>
<polygon fill="lightyellow" stroke="black" points="440425.57,-176.98 440031.74,-176.98 439930.43,-94.98 440324.26,-94.98 440425.57,-176.98"/>
<text text-anchor="middle" x="440178" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L8</text>
<text text-anchor="middle" x="440178" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="440178" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2457" class="edge">
<title>expert0_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M439894.66,-135.98C439920.06,-135.98 439945.47,-135.98 439970.87,-135.98"/>
<polygon fill="black" stroke="black" points="439970.99,-139.48 439980.99,-135.98 439970.99,-132.48 439970.99,-139.48"/>
</g>
<!-- expert1_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2458" class="edge">
<title>expert1_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M439588.24,-162.02C439611.4,-171.57 439638.96,-181.22 439665,-185.98 439715.06,-195.15 439843.3,-190.41 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert2_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2459" class="edge">
<title>expert2_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M439341.24,-162.02C439364.4,-171.57 439391.96,-181.22 439418,-185.98 439470.02,-195.51 439841.31,-190.59 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert3_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2460" class="edge">
<title>expert3_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M439094.24,-162.02C439117.4,-171.57 439144.96,-181.22 439171,-185.98 439250.02,-200.45 439813.97,-192.97 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert4_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2461" class="edge">
<title>expert4_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M438847.24,-162.02C438870.4,-171.57 438897.96,-181.22 438924,-185.98 438977.01,-195.69 439840.31,-190.67 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert5_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2462" class="edge">
<title>expert5_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M438600.24,-162.02C438623.4,-171.57 438650.96,-181.22 438677,-185.98 438743.5,-198.16 439826.64,-191.87 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert6_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2463" class="edge">
<title>expert6_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M438353.24,-162.02C438376.4,-171.57 438403.96,-181.22 438430,-185.98 438510,-200.63 439812.97,-193.06 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert7_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2464" class="edge">
<title>expert7_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M438106.24,-162.02C438129.4,-171.57 438156.96,-181.22 438183,-185.98 438229.75,-194.54 439846.65,-190.12 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert8_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2465" class="edge">
<title>expert8_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M437859.24,-162.02C437882.4,-171.57 437909.96,-181.22 437936,-185.98 437989.5,-195.78 439839.82,-190.72 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert9_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2466" class="edge">
<title>expert9_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M437612.24,-162.02C437635.4,-171.57 437662.96,-181.22 437689,-185.98 437749.25,-197.01 439832.98,-191.31 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert10_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2467" class="edge">
<title>expert10_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M437365.24,-162.02C437388.4,-171.57 437415.96,-181.22 437442,-185.98 437509,-198.25 439826.15,-191.91 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert11_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2468" class="edge">
<title>expert11_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M437118.24,-162.02C437141.4,-171.57 437168.96,-181.22 437195,-185.98 437268.75,-199.48 439819.31,-192.51 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert12_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2469" class="edge">
<title>expert12_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M436871.24,-162.02C436894.4,-171.57 436921.96,-181.22 436948,-185.98 437028.49,-200.72 439812.48,-193.1 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert13_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2470" class="edge">
<title>expert13_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M436624.24,-162.02C436647.4,-171.57 436674.96,-181.22 436701,-185.98 436744.62,-193.97 439849.82,-189.84 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert14_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2471" class="edge">
<title>expert14_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M436377.24,-162.02C436400.4,-171.57 436427.96,-181.22 436454,-185.98 436501,-194.59 439846.4,-190.14 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- expert15_l8_dp3&#45;&gt;expert_agg_l8_dp3 -->
<g id="edge2472" class="edge">
<title>expert15_l8_dp3&#45;&gt;expert_agg_l8_dp3</title>
<path fill="none" stroke="black" d="M436126.86,-162.02C436151.1,-171.58 436179.89,-181.22 436207,-185.98 436257.44,-194.84 439842.98,-190.44 439894,-185.98 439932.11,-182.65 439972.78,-176.86 440011.08,-170.36"/>
<polygon fill="black" stroke="black" points="440012.02,-173.75 440021.29,-168.6 440010.84,-166.85 440012.02,-173.75"/>
</g>
<!-- layer8_output_dp3 -->
<g id="node1470" class="node">
<title>layer8_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="440630" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="440630" y="-144.48" font-family="Arial" font-size="10.00">Layer 8 Output</text>
<text text-anchor="middle" x="440630" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="440630" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l8_dp3&#45;&gt;layer8_output_dp3 -->
<g id="edge2473" class="edge">
<title>expert_agg_l8_dp3&#45;&gt;layer8_output_dp3</title>
<path fill="none" stroke="black" d="M440375.31,-135.98C440400.49,-135.98 440425.66,-135.98 440450.84,-135.98"/>
<polygon fill="black" stroke="black" points="440450.87,-139.48 440460.87,-135.98 440450.87,-132.48 440450.87,-139.48"/>
</g>
<!-- stage1_output_dp3 -->
<g id="node1471" class="node">
<title>stage1_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="441003" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="441003" y="-144.48" font-family="Arial" font-size="10.00">Stage 1 Output</text>
<text text-anchor="middle" x="441003" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="441003" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer8_output_dp3&#45;&gt;stage1_output_dp3 -->
<g id="edge2474" class="edge">
<title>layer8_output_dp3&#45;&gt;stage1_output_dp3</title>
<path fill="none" stroke="black" d="M440799.01,-135.98C440807.23,-135.98 440815.44,-135.98 440823.66,-135.98"/>
<polygon fill="black" stroke="black" points="440823.68,-139.48 440833.68,-135.98 440823.68,-132.48 440823.68,-139.48"/>
</g>
<!-- stage2_input_dp3 -->
<g id="node1472" class="node">
<title>stage2_input_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="441376" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="441376" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Input</text>
<text text-anchor="middle" x="441376" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="441376" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage1_output_dp3&#45;&gt;stage2_input_dp3 -->
<g id="edge2475" class="edge">
<title>stage1_output_dp3&#45;&gt;stage2_input_dp3</title>
<path fill="none" stroke="black" d="M441172.01,-135.98C441180.23,-135.98 441188.44,-135.98 441196.66,-135.98"/>
<polygon fill="black" stroke="black" points="441196.68,-139.48 441206.68,-135.98 441196.68,-132.48 441196.68,-139.48"/>
</g>
<!-- attn_input_l9_dp3 -->
<g id="node1473" class="node">
<title>attn_input_l9_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="441749" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="441749" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L9</text>
<text text-anchor="middle" x="441749" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="441749" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- stage2_input_dp3&#45;&gt;attn_input_l9_dp3 -->
<g id="edge2476" class="edge">
<title>stage2_input_dp3&#45;&gt;attn_input_l9_dp3</title>
<path fill="none" stroke="black" d="M441545.01,-135.98C441553.23,-135.98 441561.44,-135.98 441569.66,-135.98"/>
<polygon fill="black" stroke="black" points="441569.68,-139.48 441579.68,-135.98 441569.68,-132.48 441569.68,-139.48"/>
</g>
<!-- attn_tp0_l9_dp3 -->
<g id="node1474" class="node">
<title>attn_tp0_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="443047,-161.98 442787,-161.98 442787,-109.98 443047,-109.98 443047,-161.98"/>
<text text-anchor="middle" x="442917" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L9</text>
<text text-anchor="middle" x="442917" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="442917" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="442917" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp3&#45;&gt;attn_tp0_l9_dp3 -->
<g id="edge2477" class="edge">
<title>attn_input_l9_dp3&#45;&gt;attn_tp0_l9_dp3</title>
<path fill="none" stroke="black" d="M441832.52,-161.26C441869.12,-171.09 441912.81,-181.13 441953,-185.98 441998,-191.42 442724.27,-193.33 442769,-185.98 442794.4,-181.81 442821.31,-173.85 442845.12,-165.5"/>
<polygon fill="black" stroke="black" points="442846.55,-168.71 442854.78,-162.03 442844.18,-162.12 442846.55,-168.71"/>
</g>
<!-- attn_tp1_l9_dp3 -->
<g id="node1475" class="node">
<title>attn_tp1_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="442769,-161.98 442509,-161.98 442509,-109.98 442769,-109.98 442769,-161.98"/>
<text text-anchor="middle" x="442639" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L9</text>
<text text-anchor="middle" x="442639" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="442639" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="442639" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp3&#45;&gt;attn_tp1_l9_dp3 -->
<g id="edge2478" class="edge">
<title>attn_input_l9_dp3&#45;&gt;attn_tp1_l9_dp3</title>
<path fill="none" stroke="black" d="M441832.52,-161.26C441869.12,-171.09 441912.81,-181.13 441953,-185.98 442012.35,-193.15 442432.01,-195.68 442491,-185.98 442516.4,-181.81 442543.31,-173.85 442567.12,-165.5"/>
<polygon fill="black" stroke="black" points="442568.55,-168.71 442576.78,-162.03 442566.18,-162.12 442568.55,-168.71"/>
</g>
<!-- attn_tp2_l9_dp3 -->
<g id="node1476" class="node">
<title>attn_tp2_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="442491,-161.98 442231,-161.98 442231,-109.98 442491,-109.98 442491,-161.98"/>
<text text-anchor="middle" x="442361" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L9</text>
<text text-anchor="middle" x="442361" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="442361" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="442361" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp3&#45;&gt;attn_tp2_l9_dp3 -->
<g id="edge2479" class="edge">
<title>attn_input_l9_dp3&#45;&gt;attn_tp2_l9_dp3</title>
<path fill="none" stroke="black" d="M441832.52,-161.26C441869.12,-171.09 441912.81,-181.13 441953,-185.98 442010.36,-192.91 442155.99,-195.35 442213,-185.98 442238.4,-181.81 442265.31,-173.85 442289.12,-165.5"/>
<polygon fill="black" stroke="black" points="442290.55,-168.71 442298.78,-162.03 442288.18,-162.12 442290.55,-168.71"/>
</g>
<!-- attn_tp3_l9_dp3 -->
<g id="node1477" class="node">
<title>attn_tp3_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="442213,-161.98 441953,-161.98 441953,-109.98 442213,-109.98 442213,-161.98"/>
<text text-anchor="middle" x="442083" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L9</text>
<text text-anchor="middle" x="442083" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="442083" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="442083" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l9_dp3&#45;&gt;attn_tp3_l9_dp3 -->
<g id="edge2480" class="edge">
<title>attn_input_l9_dp3&#45;&gt;attn_tp3_l9_dp3</title>
<path fill="none" stroke="black" d="M441918.28,-135.98C441926.35,-135.98 441934.42,-135.98 441942.49,-135.98"/>
<polygon fill="black" stroke="black" points="441942.7,-139.48 441952.7,-135.98 441942.7,-132.48 441942.7,-139.48"/>
</g>
<!-- allreduce_l9_dp3 -->
<g id="node1478" class="node">
<title>allreduce_l9_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="443251" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="443251" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L9</text>
<text text-anchor="middle" x="443251" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="443251" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l9_dp3&#45;&gt;allreduce_l9_dp3 -->
<g id="edge2481" class="edge">
<title>attn_tp0_l9_dp3&#45;&gt;allreduce_l9_dp3</title>
<path fill="none" stroke="black" d="M443047.14,-135.98C443055.35,-135.98 443063.56,-135.98 443071.77,-135.98"/>
<polygon fill="black" stroke="black" points="443071.78,-139.48 443081.78,-135.98 443071.78,-132.48 443071.78,-139.48"/>
</g>
<!-- attn_tp1_l9_dp3&#45;&gt;allreduce_l9_dp3 -->
<g id="edge2482" class="edge">
<title>attn_tp1_l9_dp3&#45;&gt;allreduce_l9_dp3</title>
<path fill="none" stroke="black" d="M442701.22,-162.03C442727.24,-171.59 442758.1,-181.23 442787,-185.98 442844.01,-195.35 442989.64,-192.91 443047,-185.98 443083.57,-181.57 443123.05,-172.85 443157.44,-163.91"/>
<polygon fill="black" stroke="black" points="443158.7,-167.2 443167.47,-161.26 443156.91,-160.43 443158.7,-167.2"/>
</g>
<!-- attn_tp2_l9_dp3&#45;&gt;allreduce_l9_dp3 -->
<g id="edge2483" class="edge">
<title>attn_tp2_l9_dp3&#45;&gt;allreduce_l9_dp3</title>
<path fill="none" stroke="black" d="M442423.22,-162.03C442449.24,-171.59 442480.1,-181.23 442509,-185.98 442567.98,-195.68 442987.65,-193.15 443047,-185.98 443083.57,-181.57 443123.05,-172.85 443157.44,-163.91"/>
<polygon fill="black" stroke="black" points="443158.7,-167.2 443167.47,-161.26 443156.91,-160.43 443158.7,-167.2"/>
</g>
<!-- attn_tp3_l9_dp3&#45;&gt;allreduce_l9_dp3 -->
<g id="edge2484" class="edge">
<title>attn_tp3_l9_dp3&#45;&gt;allreduce_l9_dp3</title>
<path fill="none" stroke="black" d="M442145.22,-162.03C442171.24,-171.59 442202.1,-181.23 442231,-185.98 442275.73,-193.33 443001.99,-191.42 443047,-185.98 443083.57,-181.57 443123.05,-172.85 443157.44,-163.91"/>
<polygon fill="black" stroke="black" points="443158.7,-167.2 443167.47,-161.26 443156.91,-160.43 443158.7,-167.2"/>
</g>
<!-- moe_input_l9_dp3 -->
<g id="node1479" class="node">
<title>moe_input_l9_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="443624" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="443624" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L9</text>
<text text-anchor="middle" x="443624" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="443624" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l9_dp3&#45;&gt;moe_input_l9_dp3 -->
<g id="edge2485" class="edge">
<title>allreduce_l9_dp3&#45;&gt;moe_input_l9_dp3</title>
<path fill="none" stroke="black" d="M443420.01,-135.98C443428.23,-135.98 443436.44,-135.98 443444.66,-135.98"/>
<polygon fill="black" stroke="black" points="443444.68,-139.48 443454.68,-135.98 443444.68,-132.48 443444.68,-139.48"/>
</g>
<!-- router_l9_dp3 -->
<g id="node1480" class="node">
<title>router_l9_dp3</title>
<polygon fill="lightyellow" stroke="black" points="444323.57,-176.98 443929.74,-176.98 443828.43,-94.98 444222.26,-94.98 444323.57,-176.98"/>
<text text-anchor="middle" x="444076" y="-144.48" font-family="Arial" font-size="10.00">Router L9</text>
<text text-anchor="middle" x="444076" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="444076" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l9_dp3&#45;&gt;router_l9_dp3 -->
<g id="edge2486" class="edge">
<title>moe_input_l9_dp3&#45;&gt;router_l9_dp3</title>
<path fill="none" stroke="black" d="M443793.06,-135.98C443818.34,-135.98 443843.63,-135.98 443868.92,-135.98"/>
<polygon fill="black" stroke="black" points="443868.99,-139.48 443878.99,-135.98 443868.99,-132.48 443868.99,-139.48"/>
</g>
<!-- expert0_l9_dp3 -->
<g id="node1481" class="node">
<title>expert0_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="448329.5,-161.98 448100.5,-161.98 448100.5,-109.98 448329.5,-109.98 448329.5,-161.98"/>
<text text-anchor="middle" x="448215" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L9</text>
<text text-anchor="middle" x="448215" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="448215" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="448215" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert0_l9_dp3 -->
<g id="edge2487" class="edge">
<title>router_l9_dp3&#45;&gt;expert0_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.7,-171.23C444338.41,-173.53 444360.08,-175.52 444381,-176.98 445141.26,-230.3 447048.38,-196.54 447810.5,-198.98 447935.99,-199.39 447969.18,-202.76 448092,-176.98 448106.64,-173.91 448121.96,-169.67 448136.63,-165.08"/>
<polygon fill="black" stroke="black" points="448137.71,-168.41 448146.16,-162.02 448135.57,-161.74 448137.71,-168.41"/>
<text text-anchor="middle" x="447832" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l9_dp3 -->
<g id="node1482" class="node">
<title>expert1_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="448082.5,-161.98 447853.5,-161.98 447853.5,-109.98 448082.5,-109.98 448082.5,-161.98"/>
<text text-anchor="middle" x="447968" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L9</text>
<text text-anchor="middle" x="447968" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="447968" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="447968" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert1_l9_dp3 -->
<g id="edge2488" class="edge">
<title>router_l9_dp3&#45;&gt;expert1_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.7,-171.22C444338.41,-173.52 444360.08,-175.51 444381,-176.98 445079.84,-226.19 446832.93,-196.54 447533.5,-198.98 447672.29,-199.47 447709.02,-204.79 447845,-176.98 447859.74,-173.97 447875.17,-169.73 447889.93,-165.12"/>
<polygon fill="black" stroke="black" points="447891.06,-168.43 447899.51,-162.04 447888.92,-161.76 447891.06,-168.43"/>
<text text-anchor="middle" x="447555" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l9_dp3 -->
<g id="node1483" class="node">
<title>expert2_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="447835.5,-161.98 447606.5,-161.98 447606.5,-109.98 447835.5,-109.98 447835.5,-161.98"/>
<text text-anchor="middle" x="447721" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L9</text>
<text text-anchor="middle" x="447721" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="447721" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="447721" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert2_l9_dp3 -->
<g id="edge2489" class="edge">
<title>router_l9_dp3&#45;&gt;expert2_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.7,-171.2C444338.41,-173.51 444360.08,-175.5 444381,-176.98 445011.99,-221.65 446594.93,-196.54 447227.5,-198.98 447392.45,-199.62 447436.15,-208.85 447598,-176.98 447612.94,-174.04 447628.58,-169.79 447643.51,-165.12"/>
<polygon fill="black" stroke="black" points="447644.75,-168.4 447653.19,-162.01 447642.6,-161.74 447644.75,-168.4"/>
<text text-anchor="middle" x="447249" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l9_dp3 -->
<g id="node1484" class="node">
<title>expert3_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="447588.5,-161.98 447359.5,-161.98 447359.5,-109.98 447588.5,-109.98 447588.5,-161.98"/>
<text text-anchor="middle" x="447474" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L9</text>
<text text-anchor="middle" x="447474" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="447474" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="447474" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert3_l9_dp3 -->
<g id="edge2490" class="edge">
<title>router_l9_dp3&#45;&gt;expert3_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.7,-171.18C444338.41,-173.49 444360.08,-175.49 444381,-176.98 444931.07,-216.24 446311.04,-196.54 446862.5,-198.98 447079.83,-199.95 447137.4,-217.08 447351,-176.98 447366.15,-174.14 447382,-169.88 447397.09,-165.17"/>
<polygon fill="black" stroke="black" points="447398.43,-168.41 447406.88,-162.02 447396.29,-161.75 447398.43,-168.41"/>
<text text-anchor="middle" x="446884" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l9_dp3 -->
<g id="node1485" class="node">
<title>expert4_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="447341.5,-161.98 447112.5,-161.98 447112.5,-109.98 447341.5,-109.98 447341.5,-161.98"/>
<text text-anchor="middle" x="447227" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L9</text>
<text text-anchor="middle" x="447227" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="447227" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="447227" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert4_l9_dp3 -->
<g id="edge2491" class="edge">
<title>router_l9_dp3&#45;&gt;expert4_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444221.67,-176.99C444260.3,-186.08 444302.21,-194.39 444341.5,-198.98 444360.48,-201.2 444365.39,-199.06 444384.5,-198.98 444686.67,-197.76 446805.92,-226.59 447104,-176.98 447119.81,-174.35 447136.35,-170.01 447151.98,-165.12"/>
<polygon fill="black" stroke="black" points="447153.14,-168.42 447161.58,-162.01 447150.99,-161.76 447153.14,-168.42"/>
<text text-anchor="middle" x="444363" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l9_dp3 -->
<g id="node1486" class="node">
<title>expert5_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="447094.5,-161.98 446865.5,-161.98 446865.5,-109.98 447094.5,-109.98 447094.5,-161.98"/>
<text text-anchor="middle" x="446980" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L9</text>
<text text-anchor="middle" x="446980" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="446980" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="446980" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert5_l9_dp3 -->
<g id="edge2492" class="edge">
<title>router_l9_dp3&#45;&gt;expert5_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.29,-171.08C444338.14,-173.43 444359.95,-175.46 444381,-176.98 444823.98,-209.07 445935.37,-196.54 446379.5,-198.98 446591.94,-200.15 446648.22,-216.31 446857,-176.98 446872.15,-174.13 446888,-169.87 446903.09,-165.15"/>
<polygon fill="black" stroke="black" points="446904.43,-168.4 446912.88,-162 446902.29,-161.74 446904.43,-168.4"/>
<text text-anchor="middle" x="446401" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l9_dp3 -->
<g id="node1487" class="node">
<title>expert6_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="446847.5,-161.98 446618.5,-161.98 446618.5,-109.98 446847.5,-109.98 446847.5,-161.98"/>
<text text-anchor="middle" x="446733" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L9</text>
<text text-anchor="middle" x="446733" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="446733" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="446733" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert6_l9_dp3 -->
<g id="edge2493" class="edge">
<title>router_l9_dp3&#45;&gt;expert6_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444248.37,-177C444293.98,-186.1 444343.37,-194.39 444389.5,-198.98 444408.52,-200.87 444413.39,-199.08 444432.5,-198.98 444674.45,-197.76 446371.36,-216.95 446610,-176.98 446625.72,-174.35 446642.15,-170.04 446657.7,-165.18"/>
<polygon fill="black" stroke="black" points="446658.81,-168.49 446667.25,-162.09 446656.66,-161.83 446658.81,-168.49"/>
<text text-anchor="middle" x="444411" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l9_dp3 -->
<g id="node1488" class="node">
<title>expert7_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="446600.5,-161.98 446371.5,-161.98 446371.5,-109.98 446600.5,-109.98 446600.5,-161.98"/>
<text text-anchor="middle" x="446486" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L9</text>
<text text-anchor="middle" x="446486" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="446486" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="446486" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert7_l9_dp3 -->
<g id="edge2494" class="edge">
<title>router_l9_dp3&#45;&gt;expert7_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.3,-171.01C444338.14,-173.37 444359.95,-175.42 444381,-176.98 444728.86,-202.78 445601.81,-208.27 445950.5,-198.98 446134.03,-194.09 446182.62,-211.21 446363,-176.98 446378.06,-174.13 446393.8,-169.89 446408.81,-165.21"/>
<polygon fill="black" stroke="black" points="446410.1,-168.47 446418.55,-162.08 446407.96,-161.8 446410.1,-168.47"/>
<text text-anchor="middle" x="445929" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l9_dp3 -->
<g id="node1489" class="node">
<title>expert8_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="446353.5,-161.98 446124.5,-161.98 446124.5,-109.98 446353.5,-109.98 446353.5,-161.98"/>
<text text-anchor="middle" x="446239" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L9</text>
<text text-anchor="middle" x="446239" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="446239" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="446239" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert8_l9_dp3 -->
<g id="edge2495" class="edge">
<title>router_l9_dp3&#45;&gt;expert8_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444275.02,-177C444327.62,-186.1 444384.5,-194.4 444437.5,-198.98 444456.54,-200.63 444461.39,-199.11 444480.5,-198.98 444662.23,-197.76 445936.81,-207.3 446116,-176.98 446131.71,-174.32 446148.14,-170 446163.69,-165.13"/>
<polygon fill="black" stroke="black" points="446164.81,-168.45 446173.25,-162.05 446162.65,-161.79 446164.81,-168.45"/>
<text text-anchor="middle" x="444459" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l9_dp3 -->
<g id="node1490" class="node">
<title>expert9_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="446106.5,-161.98 445877.5,-161.98 445877.5,-109.98 446106.5,-109.98 446106.5,-161.98"/>
<text text-anchor="middle" x="445992" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L9</text>
<text text-anchor="middle" x="445992" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="445992" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="445992" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert9_l9_dp3 -->
<g id="edge2496" class="edge">
<title>router_l9_dp3&#45;&gt;expert9_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444316.31,-170.87C444338.15,-173.26 444359.96,-175.36 444381,-176.98 444876.73,-215.25 445002.51,-213.76 445499.5,-198.98 445663.94,-194.09 445707.46,-208.15 445869,-176.98 445884.05,-174.08 445899.79,-169.82 445914.8,-165.13"/>
<polygon fill="black" stroke="black" points="445916.09,-168.39 445924.54,-162 445913.94,-161.73 445916.09,-168.39"/>
<text text-anchor="middle" x="445478" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l9_dp3 -->
<g id="node1491" class="node">
<title>expert10_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="445859.5,-161.98 445630.5,-161.98 445630.5,-109.98 445859.5,-109.98 445859.5,-161.98"/>
<text text-anchor="middle" x="445745" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L9</text>
<text text-anchor="middle" x="445745" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="445745" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="445745" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert10_l9_dp3 -->
<g id="edge2497" class="edge">
<title>router_l9_dp3&#45;&gt;expert10_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444301.65,-177.01C444361.23,-186.11 444425.61,-194.4 444485.5,-198.98 444611.43,-208.61 445497.54,-198.47 445622,-176.98 445637.46,-174.31 445653.63,-170.06 445668.97,-165.27"/>
<polygon fill="black" stroke="black" points="445670.47,-168.47 445678.91,-162.07 445668.32,-161.81 445670.47,-168.47"/>
<text text-anchor="middle" x="444507" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l9_dp3 -->
<g id="node1492" class="node">
<title>expert11_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="445612.5,-161.98 445383.5,-161.98 445383.5,-109.98 445612.5,-109.98 445612.5,-161.98"/>
<text text-anchor="middle" x="445498" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L9</text>
<text text-anchor="middle" x="445498" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="445498" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="445498" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert11_l9_dp3 -->
<g id="edge2498" class="edge">
<title>router_l9_dp3&#45;&gt;expert11_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444315.92,-170.54C444337.89,-173.01 444359.83,-175.22 444381,-176.98 444696.28,-203.29 444776.36,-211.27 445092.5,-198.98 445218.34,-194.09 445251.57,-201.97 445375,-176.98 445389.75,-174 445405.18,-169.77 445419.94,-165.16"/>
<polygon fill="black" stroke="black" points="445421.07,-168.48 445429.52,-162.09 445418.93,-161.81 445421.07,-168.48"/>
<text text-anchor="middle" x="445071" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l9_dp3 -->
<g id="node1493" class="node">
<title>expert12_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="445365.5,-161.98 445136.5,-161.98 445136.5,-109.98 445365.5,-109.98 445365.5,-161.98"/>
<text text-anchor="middle" x="445251" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L9</text>
<text text-anchor="middle" x="445251" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="445251" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="445251" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert12_l9_dp3 -->
<g id="edge2499" class="edge">
<title>router_l9_dp3&#45;&gt;expert12_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444322.89,-176.28C444390.94,-185.66 444464.91,-194.28 444533.5,-198.98 444665.39,-208.02 444997.95,-200.76 445128,-176.98 445143.26,-174.19 445159.21,-169.94 445174.38,-165.2"/>
<polygon fill="black" stroke="black" points="445175.78,-168.43 445184.23,-162.03 445173.63,-161.77 445175.78,-168.43"/>
<text text-anchor="middle" x="444555" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l9_dp3 -->
<g id="node1494" class="node">
<title>expert13_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="445118.5,-161.98 444889.5,-161.98 444889.5,-109.98 445118.5,-109.98 445118.5,-161.98"/>
<text text-anchor="middle" x="445004" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L9</text>
<text text-anchor="middle" x="445004" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="445004" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="445004" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert13_l9_dp3 -->
<g id="edge2500" class="edge">
<title>router_l9_dp3&#45;&gt;expert13_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444294.58,-177.04C444431.63,-197.51 444611.94,-214.85 444771.5,-198.98 444822.76,-193.88 444878.52,-179.11 444922.59,-165.14"/>
<polygon fill="black" stroke="black" points="444923.93,-168.39 444932.37,-161.99 444921.78,-161.72 444923.93,-168.39"/>
<text text-anchor="middle" x="444750" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l9_dp3 -->
<g id="node1495" class="node">
<title>expert14_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="444871.5,-161.98 444642.5,-161.98 444642.5,-109.98 444871.5,-109.98 444871.5,-161.98"/>
<text text-anchor="middle" x="444757" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L9</text>
<text text-anchor="middle" x="444757" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="444757" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="444757" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert14_l9_dp3 -->
<g id="edge2501" class="edge">
<title>router_l9_dp3&#45;&gt;expert14_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444301.44,-176.99C444424.58,-196.39 444564.01,-212.63 444624.5,-198.98 444652.7,-192.62 444681.94,-179.52 444705.75,-166.9"/>
<polygon fill="black" stroke="black" points="444707.48,-169.94 444714.6,-162.1 444704.14,-163.79 444707.48,-169.94"/>
<text text-anchor="middle" x="444603" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l9_dp3 -->
<g id="node1496" class="node">
<title>expert15_l9_dp3</title>
<polygon fill="lightgreen" stroke="black" points="444618.5,-161.98 444389.5,-161.98 444389.5,-109.98 444618.5,-109.98 444618.5,-161.98"/>
<text text-anchor="middle" x="444504" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L9</text>
<text text-anchor="middle" x="444504" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="444504" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="444504" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l9_dp3&#45;&gt;expert15_l9_dp3 -->
<g id="edge2502" class="edge">
<title>router_l9_dp3&#45;&gt;expert15_l9_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M444273.09,-135.98C444309.17,-135.98 444345.91,-135.98 444379.14,-135.98"/>
<polygon fill="black" stroke="black" points="444379.34,-139.48 444389.34,-135.98 444379.34,-132.48 444379.34,-139.48"/>
<text text-anchor="middle" x="444356.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l9_dp3 -->
<g id="node1497" class="node">
<title>expert_agg_l9_dp3</title>
<polygon fill="lightyellow" stroke="black" points="448860.57,-176.98 448466.74,-176.98 448365.43,-94.98 448759.26,-94.98 448860.57,-176.98"/>
<text text-anchor="middle" x="448613" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L9</text>
<text text-anchor="middle" x="448613" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="448613" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2503" class="edge">
<title>expert0_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M448329.66,-135.98C448355.06,-135.98 448380.47,-135.98 448405.87,-135.98"/>
<polygon fill="black" stroke="black" points="448405.99,-139.48 448415.99,-135.98 448405.99,-132.48 448405.99,-139.48"/>
</g>
<!-- expert1_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2504" class="edge">
<title>expert1_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M448023.68,-162.02C448047.02,-171.58 448074.79,-181.22 448101,-185.98 448151.07,-195.08 448279.3,-190.43 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert2_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2505" class="edge">
<title>expert2_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M447776.68,-162.02C447800.02,-171.58 447827.79,-181.22 447854,-185.98 447906.03,-195.44 448277.31,-190.6 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert3_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2506" class="edge">
<title>expert3_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M447529.68,-162.02C447553.02,-171.58 447580.79,-181.22 447607,-185.98 447686.04,-200.35 448249.97,-193 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert4_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2507" class="edge">
<title>expert4_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M447282.68,-162.02C447306.02,-171.58 447333.79,-181.22 447360,-185.98 447413.02,-195.62 448276.32,-190.69 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert5_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2508" class="edge">
<title>expert5_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M447035.68,-162.02C447059.02,-171.58 447086.79,-181.22 447113,-185.98 447179.52,-198.07 448262.65,-191.89 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert6_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2509" class="edge">
<title>expert6_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M446788.68,-162.02C446812.02,-171.58 446839.79,-181.22 446866,-185.98 446946.02,-200.53 448248.98,-193.09 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert7_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2510" class="edge">
<title>expert7_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M446541.68,-162.02C446565.02,-171.58 446592.79,-181.22 446619,-185.98 446665.76,-194.48 448282.65,-190.13 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert8_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2511" class="edge">
<title>expert8_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M446294.68,-162.02C446318.02,-171.58 446345.79,-181.22 446372,-185.98 446425.51,-195.71 448275.82,-190.73 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert9_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2512" class="edge">
<title>expert9_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M446047.68,-162.02C446071.02,-171.58 446098.79,-181.22 446125,-185.98 446185.26,-196.94 448268.98,-191.33 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert10_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2513" class="edge">
<title>expert10_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M445800.68,-162.02C445824.02,-171.58 445851.79,-181.22 445878,-185.98 445945.01,-198.16 448262.15,-191.93 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert11_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2514" class="edge">
<title>expert11_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M445553.68,-162.02C445577.02,-171.58 445604.79,-181.22 445631,-185.98 445704.76,-199.39 448255.31,-192.53 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert12_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2515" class="edge">
<title>expert12_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M445306.68,-162.02C445330.02,-171.58 445357.79,-181.22 445384,-185.98 445464.51,-200.62 448248.48,-193.13 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert13_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2516" class="edge">
<title>expert13_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M445059.68,-162.02C445083.02,-171.58 445110.79,-181.22 445137,-185.98 445180.63,-193.91 448285.82,-189.86 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert14_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2517" class="edge">
<title>expert14_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M444812.68,-162.02C444836.02,-171.58 444863.79,-181.22 444890,-185.98 444937.01,-194.53 448282.4,-190.15 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- expert15_l9_dp3&#45;&gt;expert_agg_l9_dp3 -->
<g id="edge2518" class="edge">
<title>expert15_l9_dp3&#45;&gt;expert_agg_l9_dp3</title>
<path fill="none" stroke="black" d="M444562.3,-162.02C444586.71,-171.58 444615.71,-181.22 444643,-185.98 444693.45,-194.78 448278.99,-190.45 448330,-185.98 448367.75,-182.67 448408.02,-176.93 448445.98,-170.48"/>
<polygon fill="black" stroke="black" points="448446.84,-173.88 448456.1,-168.73 448445.65,-166.98 448446.84,-173.88"/>
</g>
<!-- layer9_output_dp3 -->
<g id="node1498" class="node">
<title>layer9_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="449065" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="449065" y="-144.48" font-family="Arial" font-size="10.00">Layer 9 Output</text>
<text text-anchor="middle" x="449065" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="449065" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l9_dp3&#45;&gt;layer9_output_dp3 -->
<g id="edge2519" class="edge">
<title>expert_agg_l9_dp3&#45;&gt;layer9_output_dp3</title>
<path fill="none" stroke="black" d="M448810.31,-135.98C448835.49,-135.98 448860.66,-135.98 448885.84,-135.98"/>
<polygon fill="black" stroke="black" points="448885.87,-139.48 448895.87,-135.98 448885.87,-132.48 448885.87,-139.48"/>
</g>
<!-- attn_input_l10_dp3 -->
<g id="node1499" class="node">
<title>attn_input_l10_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="449438" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="449438" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L10</text>
<text text-anchor="middle" x="449438" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="449438" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer9_output_dp3&#45;&gt;attn_input_l10_dp3 -->
<g id="edge2520" class="edge">
<title>layer9_output_dp3&#45;&gt;attn_input_l10_dp3</title>
<path fill="none" stroke="black" d="M449234.01,-135.98C449242.23,-135.98 449250.44,-135.98 449258.66,-135.98"/>
<polygon fill="black" stroke="black" points="449258.68,-139.48 449268.68,-135.98 449258.68,-132.48 449258.68,-139.48"/>
</g>
<!-- attn_tp0_l10_dp3 -->
<g id="node1500" class="node">
<title>attn_tp0_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="450736,-161.98 450476,-161.98 450476,-109.98 450736,-109.98 450736,-161.98"/>
<text text-anchor="middle" x="450606" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L10</text>
<text text-anchor="middle" x="450606" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="450606" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="450606" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp3&#45;&gt;attn_tp0_l10_dp3 -->
<g id="edge2521" class="edge">
<title>attn_input_l10_dp3&#45;&gt;attn_tp0_l10_dp3</title>
<path fill="none" stroke="black" d="M449521.52,-161.26C449558.12,-171.09 449601.81,-181.13 449642,-185.98 449687,-191.42 450413.27,-193.33 450458,-185.98 450483.4,-181.81 450510.31,-173.85 450534.12,-165.5"/>
<polygon fill="black" stroke="black" points="450535.55,-168.71 450543.78,-162.03 450533.18,-162.12 450535.55,-168.71"/>
</g>
<!-- attn_tp1_l10_dp3 -->
<g id="node1501" class="node">
<title>attn_tp1_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="450458,-161.98 450198,-161.98 450198,-109.98 450458,-109.98 450458,-161.98"/>
<text text-anchor="middle" x="450328" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L10</text>
<text text-anchor="middle" x="450328" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="450328" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="450328" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp3&#45;&gt;attn_tp1_l10_dp3 -->
<g id="edge2522" class="edge">
<title>attn_input_l10_dp3&#45;&gt;attn_tp1_l10_dp3</title>
<path fill="none" stroke="black" d="M449521.52,-161.26C449558.12,-171.09 449601.81,-181.13 449642,-185.98 449701.35,-193.15 450121.01,-195.68 450180,-185.98 450205.4,-181.81 450232.31,-173.85 450256.12,-165.5"/>
<polygon fill="black" stroke="black" points="450257.55,-168.71 450265.78,-162.03 450255.18,-162.12 450257.55,-168.71"/>
</g>
<!-- attn_tp2_l10_dp3 -->
<g id="node1502" class="node">
<title>attn_tp2_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="450180,-161.98 449920,-161.98 449920,-109.98 450180,-109.98 450180,-161.98"/>
<text text-anchor="middle" x="450050" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L10</text>
<text text-anchor="middle" x="450050" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="450050" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="450050" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp3&#45;&gt;attn_tp2_l10_dp3 -->
<g id="edge2523" class="edge">
<title>attn_input_l10_dp3&#45;&gt;attn_tp2_l10_dp3</title>
<path fill="none" stroke="black" d="M449521.52,-161.26C449558.12,-171.09 449601.81,-181.13 449642,-185.98 449699.36,-192.91 449844.99,-195.35 449902,-185.98 449927.4,-181.81 449954.31,-173.85 449978.12,-165.5"/>
<polygon fill="black" stroke="black" points="449979.55,-168.71 449987.78,-162.03 449977.18,-162.12 449979.55,-168.71"/>
</g>
<!-- attn_tp3_l10_dp3 -->
<g id="node1503" class="node">
<title>attn_tp3_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="449902,-161.98 449642,-161.98 449642,-109.98 449902,-109.98 449902,-161.98"/>
<text text-anchor="middle" x="449772" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L10</text>
<text text-anchor="middle" x="449772" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="449772" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="449772" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l10_dp3&#45;&gt;attn_tp3_l10_dp3 -->
<g id="edge2524" class="edge">
<title>attn_input_l10_dp3&#45;&gt;attn_tp3_l10_dp3</title>
<path fill="none" stroke="black" d="M449607.28,-135.98C449615.35,-135.98 449623.42,-135.98 449631.49,-135.98"/>
<polygon fill="black" stroke="black" points="449631.7,-139.48 449641.7,-135.98 449631.7,-132.48 449631.7,-139.48"/>
</g>
<!-- allreduce_l10_dp3 -->
<g id="node1504" class="node">
<title>allreduce_l10_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="450940" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="450940" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L10</text>
<text text-anchor="middle" x="450940" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="450940" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l10_dp3&#45;&gt;allreduce_l10_dp3 -->
<g id="edge2525" class="edge">
<title>attn_tp0_l10_dp3&#45;&gt;allreduce_l10_dp3</title>
<path fill="none" stroke="black" d="M450736.14,-135.98C450744.35,-135.98 450752.56,-135.98 450760.77,-135.98"/>
<polygon fill="black" stroke="black" points="450760.78,-139.48 450770.78,-135.98 450760.78,-132.48 450760.78,-139.48"/>
</g>
<!-- attn_tp1_l10_dp3&#45;&gt;allreduce_l10_dp3 -->
<g id="edge2526" class="edge">
<title>attn_tp1_l10_dp3&#45;&gt;allreduce_l10_dp3</title>
<path fill="none" stroke="black" d="M450390.22,-162.03C450416.24,-171.59 450447.1,-181.23 450476,-185.98 450533.01,-195.35 450678.64,-192.91 450736,-185.98 450772.57,-181.57 450812.05,-172.85 450846.44,-163.91"/>
<polygon fill="black" stroke="black" points="450847.7,-167.2 450856.47,-161.26 450845.91,-160.43 450847.7,-167.2"/>
</g>
<!-- attn_tp2_l10_dp3&#45;&gt;allreduce_l10_dp3 -->
<g id="edge2527" class="edge">
<title>attn_tp2_l10_dp3&#45;&gt;allreduce_l10_dp3</title>
<path fill="none" stroke="black" d="M450112.22,-162.03C450138.24,-171.59 450169.1,-181.23 450198,-185.98 450256.98,-195.68 450676.65,-193.15 450736,-185.98 450772.57,-181.57 450812.05,-172.85 450846.44,-163.91"/>
<polygon fill="black" stroke="black" points="450847.7,-167.2 450856.47,-161.26 450845.91,-160.43 450847.7,-167.2"/>
</g>
<!-- attn_tp3_l10_dp3&#45;&gt;allreduce_l10_dp3 -->
<g id="edge2528" class="edge">
<title>attn_tp3_l10_dp3&#45;&gt;allreduce_l10_dp3</title>
<path fill="none" stroke="black" d="M449834.22,-162.03C449860.24,-171.59 449891.1,-181.23 449920,-185.98 449964.73,-193.33 450690.99,-191.42 450736,-185.98 450772.57,-181.57 450812.05,-172.85 450846.44,-163.91"/>
<polygon fill="black" stroke="black" points="450847.7,-167.2 450856.47,-161.26 450845.91,-160.43 450847.7,-167.2"/>
</g>
<!-- moe_input_l10_dp3 -->
<g id="node1505" class="node">
<title>moe_input_l10_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="451313" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="451313" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L10</text>
<text text-anchor="middle" x="451313" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="451313" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l10_dp3&#45;&gt;moe_input_l10_dp3 -->
<g id="edge2529" class="edge">
<title>allreduce_l10_dp3&#45;&gt;moe_input_l10_dp3</title>
<path fill="none" stroke="black" d="M451109.01,-135.98C451117.23,-135.98 451125.44,-135.98 451133.66,-135.98"/>
<polygon fill="black" stroke="black" points="451133.68,-139.48 451143.68,-135.98 451133.68,-132.48 451133.68,-139.48"/>
</g>
<!-- router_l10_dp3 -->
<g id="node1506" class="node">
<title>router_l10_dp3</title>
<polygon fill="lightyellow" stroke="black" points="452012.57,-176.98 451618.74,-176.98 451517.43,-94.98 451911.26,-94.98 452012.57,-176.98"/>
<text text-anchor="middle" x="451765" y="-144.48" font-family="Arial" font-size="10.00">Router L10</text>
<text text-anchor="middle" x="451765" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="451765" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l10_dp3&#45;&gt;router_l10_dp3 -->
<g id="edge2530" class="edge">
<title>moe_input_l10_dp3&#45;&gt;router_l10_dp3</title>
<path fill="none" stroke="black" d="M451482.06,-135.98C451507.34,-135.98 451532.63,-135.98 451557.92,-135.98"/>
<polygon fill="black" stroke="black" points="451557.99,-139.48 451567.99,-135.98 451557.99,-132.48 451557.99,-139.48"/>
</g>
<!-- expert0_l10_dp3 -->
<g id="node1507" class="node">
<title>expert0_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="456018.5,-161.98 455789.5,-161.98 455789.5,-109.98 456018.5,-109.98 456018.5,-161.98"/>
<text text-anchor="middle" x="455904" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L10</text>
<text text-anchor="middle" x="455904" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="455904" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="455904" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert0_l10_dp3 -->
<g id="edge2531" class="edge">
<title>router_l10_dp3&#45;&gt;expert0_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.7,-171.23C452027.41,-173.54 452049.08,-175.52 452070,-176.98 452833.58,-230.53 454749.04,-196.54 455514.5,-198.98 455633.35,-199.36 455664.76,-201.75 455781,-176.98 455795.4,-173.91 455810.47,-169.74 455824.93,-165.22"/>
<polygon fill="black" stroke="black" points="455826.37,-168.43 455834.82,-162.05 455824.23,-161.77 455826.37,-168.43"/>
<text text-anchor="middle" x="455536" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l10_dp3 -->
<g id="node1508" class="node">
<title>expert1_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="455771.5,-161.98 455542.5,-161.98 455542.5,-109.98 455771.5,-109.98 455771.5,-161.98"/>
<text text-anchor="middle" x="455657" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L10</text>
<text text-anchor="middle" x="455657" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="455657" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="455657" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert1_l10_dp3 -->
<g id="edge2532" class="edge">
<title>router_l10_dp3&#45;&gt;expert1_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.7,-171.22C452027.41,-173.53 452049.08,-175.51 452070,-176.98 452775.49,-226.64 454545.26,-196.54 455252.5,-198.98 455377.99,-199.42 455411.18,-202.76 455534,-176.98 455548.64,-173.91 455563.96,-169.67 455578.63,-165.08"/>
<polygon fill="black" stroke="black" points="455579.71,-168.41 455588.16,-162.02 455577.57,-161.74 455579.71,-168.41"/>
<text text-anchor="middle" x="455274" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l10_dp3 -->
<g id="node1509" class="node">
<title>expert2_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="455524.5,-161.98 455295.5,-161.98 455295.5,-109.98 455524.5,-109.98 455524.5,-161.98"/>
<text text-anchor="middle" x="455410" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L10</text>
<text text-anchor="middle" x="455410" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="455410" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="455410" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert2_l10_dp3 -->
<g id="edge2533" class="edge">
<title>router_l10_dp3&#45;&gt;expert2_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.7,-171.21C452027.41,-173.51 452049.08,-175.5 452070,-176.98 452714.3,-222.54 454330.6,-196.54 454976.5,-198.98 455114.84,-199.51 455151.46,-204.73 455287,-176.98 455301.74,-173.96 455317.17,-169.73 455331.93,-165.11"/>
<polygon fill="black" stroke="black" points="455333.06,-168.42 455341.51,-162.03 455330.92,-161.76 455333.06,-168.42"/>
<text text-anchor="middle" x="454998" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l10_dp3 -->
<g id="node1510" class="node">
<title>expert3_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="455277.5,-161.98 455048.5,-161.98 455048.5,-109.98 455277.5,-109.98 455277.5,-161.98"/>
<text text-anchor="middle" x="455163" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L10</text>
<text text-anchor="middle" x="455163" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="455163" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="455163" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert3_l10_dp3 -->
<g id="edge2534" class="edge">
<title>router_l10_dp3&#45;&gt;expert3_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.7,-171.19C452027.41,-173.5 452049.08,-175.49 452070,-176.98 452646.67,-218.02 454093.37,-196.54 454671.5,-198.98 454835.57,-199.68 454879.03,-208.71 455040,-176.98 455054.94,-174.04 455070.58,-169.78 455085.51,-165.12"/>
<polygon fill="black" stroke="black" points="455086.74,-168.4 455095.19,-162 455084.6,-161.73 455086.74,-168.4"/>
<text text-anchor="middle" x="454693" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l10_dp3 -->
<g id="node1511" class="node">
<title>expert4_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="455030.5,-161.98 454801.5,-161.98 454801.5,-109.98 455030.5,-109.98 455030.5,-161.98"/>
<text text-anchor="middle" x="454916" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L10</text>
<text text-anchor="middle" x="454916" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="454916" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="454916" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert4_l10_dp3 -->
<g id="edge2535" class="edge">
<title>router_l10_dp3&#45;&gt;expert4_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.71,-171.15C452027.41,-173.47 452049.08,-175.48 452070,-176.98 452565.97,-212.62 453810.26,-196.54 454307.5,-198.98 454523.5,-200.04 454580.71,-216.87 454793,-176.98 454808.15,-174.14 454824,-169.88 454839.09,-165.17"/>
<polygon fill="black" stroke="black" points="454840.43,-168.41 454848.88,-162.02 454838.29,-161.75 454840.43,-168.41"/>
<text text-anchor="middle" x="454329" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l10_dp3 -->
<g id="node1512" class="node">
<title>expert5_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="454783.5,-161.98 454554.5,-161.98 454554.5,-109.98 454783.5,-109.98 454783.5,-161.98"/>
<text text-anchor="middle" x="454669" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L10</text>
<text text-anchor="middle" x="454669" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="454669" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="454669" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert5_l10_dp3 -->
<g id="edge2536" class="edge">
<title>router_l10_dp3&#45;&gt;expert5_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451910.67,-176.99C451949.3,-186.08 451991.21,-194.39 452030.5,-198.98 452049.48,-201.2 452054.39,-199.07 452073.5,-198.98 452348.23,-197.76 454275.01,-222.2 454546,-176.98 454561.81,-174.34 454578.34,-170 454593.97,-165.11"/>
<polygon fill="black" stroke="black" points="454595.14,-168.41 454603.58,-162 454592.98,-161.75 454595.14,-168.41"/>
<text text-anchor="middle" x="452052" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l10_dp3 -->
<g id="node1513" class="node">
<title>expert6_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="454536.5,-161.98 454307.5,-161.98 454307.5,-109.98 454536.5,-109.98 454536.5,-161.98"/>
<text text-anchor="middle" x="454422" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L10</text>
<text text-anchor="middle" x="454422" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="454422" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="454422" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert6_l10_dp3 -->
<g id="edge2537" class="edge">
<title>router_l10_dp3&#45;&gt;expert6_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.29,-171.05C452027.14,-173.4 452048.95,-175.44 452070,-176.98 452469.07,-206.2 453470.49,-209.24 453870.5,-198.98 454061.13,-194.09 454111.61,-212.35 454299,-176.98 454314.15,-174.12 454330,-169.86 454345.09,-165.15"/>
<polygon fill="black" stroke="black" points="454346.43,-168.39 454354.88,-161.99 454344.29,-161.73 454346.43,-168.39"/>
<text text-anchor="middle" x="453849" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l10_dp3 -->
<g id="node1514" class="node">
<title>expert7_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="454289.5,-161.98 454060.5,-161.98 454060.5,-109.98 454289.5,-109.98 454289.5,-161.98"/>
<text text-anchor="middle" x="454175" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L10</text>
<text text-anchor="middle" x="454175" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="454175" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="454175" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert7_l10_dp3 -->
<g id="edge2538" class="edge">
<title>router_l10_dp3&#45;&gt;expert7_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451937.37,-177C451982.98,-186.1 452032.37,-194.39 452078.5,-198.98 452097.52,-200.87 452102.39,-199.09 452121.5,-198.98 452336.01,-197.76 453840.45,-212.55 454052,-176.98 454067.72,-174.34 454084.15,-170.02 454099.7,-165.16"/>
<polygon fill="black" stroke="black" points="454100.81,-168.48 454109.25,-162.07 454098.66,-161.82 454100.81,-168.48"/>
<text text-anchor="middle" x="452100" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l10_dp3 -->
<g id="node1515" class="node">
<title>expert8_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="454042.5,-161.98 453813.5,-161.98 453813.5,-109.98 454042.5,-109.98 454042.5,-161.98"/>
<text text-anchor="middle" x="453928" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L10</text>
<text text-anchor="middle" x="453928" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="453928" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="453928" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert8_l10_dp3 -->
<g id="edge2539" class="edge">
<title>router_l10_dp3&#45;&gt;expert8_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452005.3,-170.95C452027.14,-173.32 452048.95,-175.39 452070,-176.98 452365.75,-199.3 453108.01,-207.12 453404.5,-198.98 453582.7,-194.09 453629.88,-210.36 453805,-176.98 453820.05,-174.11 453835.8,-169.87 453850.81,-165.19"/>
<polygon fill="black" stroke="black" points="453852.1,-168.45 453860.55,-162.06 453849.96,-161.78 453852.1,-168.45"/>
<text text-anchor="middle" x="453383" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l10_dp3 -->
<g id="node1516" class="node">
<title>expert9_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="453795.5,-161.98 453566.5,-161.98 453566.5,-109.98 453795.5,-109.98 453795.5,-161.98"/>
<text text-anchor="middle" x="453681" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L10</text>
<text text-anchor="middle" x="453681" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="453681" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="453681" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert9_l10_dp3 -->
<g id="edge2540" class="edge">
<title>router_l10_dp3&#45;&gt;expert9_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451964.02,-177C452016.62,-186.1 452073.5,-194.4 452126.5,-198.98 452145.54,-200.63 452150.39,-199.13 452169.5,-198.98 452478.08,-196.54 453253.79,-228.83 453558,-176.98 453573.71,-174.31 453590.14,-169.97 453605.69,-165.1"/>
<polygon fill="black" stroke="black" points="453606.8,-168.42 453615.24,-162.02 453604.65,-161.76 453606.8,-168.42"/>
<text text-anchor="middle" x="452148" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l10_dp3 -->
<g id="node1517" class="node">
<title>expert10_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="453548.5,-161.98 453319.5,-161.98 453319.5,-109.98 453548.5,-109.98 453548.5,-161.98"/>
<text text-anchor="middle" x="453434" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L10</text>
<text text-anchor="middle" x="453434" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="453434" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="453434" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert10_l10_dp3 -->
<g id="edge2541" class="edge">
<title>router_l10_dp3&#45;&gt;expert10_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452004.9,-170.7C452026.88,-173.14 452048.83,-175.29 452070,-176.98 452467.3,-208.71 452568.14,-211.69 452966.5,-198.98 453119.84,-194.09 453160.42,-206.37 453311,-176.98 453325.95,-174.06 453341.59,-169.82 453356.51,-165.16"/>
<polygon fill="black" stroke="black" points="453357.75,-168.44 453366.2,-162.05 453355.61,-161.78 453357.75,-168.44"/>
<text text-anchor="middle" x="452945" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l10_dp3 -->
<g id="node1518" class="node">
<title>expert11_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="453301.5,-161.98 453072.5,-161.98 453072.5,-109.98 453301.5,-109.98 453301.5,-161.98"/>
<text text-anchor="middle" x="453187" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L10</text>
<text text-anchor="middle" x="453187" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="453187" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="453187" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert11_l10_dp3 -->
<g id="edge2542" class="edge">
<title>router_l10_dp3&#45;&gt;expert11_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451990.65,-177.01C452050.23,-186.11 452114.61,-194.4 452174.5,-198.98 452371.65,-214.06 452869.25,-211.19 453064,-176.98 453079.46,-174.27 453095.62,-169.99 453110.96,-165.2"/>
<polygon fill="black" stroke="black" points="453112.46,-168.4 453120.9,-161.99 453110.31,-161.73 453112.46,-168.4"/>
<text text-anchor="middle" x="452196" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l10_dp3 -->
<g id="node1519" class="node">
<title>expert12_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="453054.5,-161.98 452825.5,-161.98 452825.5,-109.98 453054.5,-109.98 453054.5,-161.98"/>
<text text-anchor="middle" x="452940" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L10</text>
<text text-anchor="middle" x="452940" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="452940" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="452940" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert12_l10_dp3 -->
<g id="edge2543" class="edge">
<title>router_l10_dp3&#45;&gt;expert12_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452004.11,-170.14C452026.36,-172.71 452048.58,-175.05 452070,-176.98 452070,-176.98 452817,-176.98 452817,-176.98 452831.63,-173.89 452846.96,-169.65 452861.63,-165.05"/>
<polygon fill="black" stroke="black" points="452862.71,-168.38 452871.16,-161.99 452860.57,-161.71 452862.71,-168.38"/>
<text text-anchor="middle" x="452563" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l10_dp3 -->
<g id="node1520" class="node">
<title>expert13_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="452807.5,-161.98 452578.5,-161.98 452578.5,-109.98 452807.5,-109.98 452807.5,-161.98"/>
<text text-anchor="middle" x="452693" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L10</text>
<text text-anchor="middle" x="452693" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="452693" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="452693" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert13_l10_dp3 -->
<g id="edge2544" class="edge">
<title>router_l10_dp3&#45;&gt;expert13_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M452011.89,-176.28C452079.94,-185.66 452153.91,-194.28 452222.5,-198.98 452337.75,-206.88 452442.88,-202.35 452570,-176.98 452584.85,-174.02 452600.38,-169.78 452615.22,-165.15"/>
<polygon fill="black" stroke="black" points="452616.41,-168.44 452624.86,-162.05 452614.27,-161.78 452616.41,-168.44"/>
<text text-anchor="middle" x="452244" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l10_dp3 -->
<g id="node1521" class="node">
<title>expert14_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="452560.5,-161.98 452331.5,-161.98 452331.5,-109.98 452560.5,-109.98 452560.5,-161.98"/>
<text text-anchor="middle" x="452446" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L10</text>
<text text-anchor="middle" x="452446" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="452446" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="452446" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert14_l10_dp3 -->
<g id="edge2545" class="edge">
<title>router_l10_dp3&#45;&gt;expert14_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451990.44,-176.99C452113.58,-196.39 452253.01,-212.63 452313.5,-198.98 452341.7,-192.62 452370.94,-179.52 452394.75,-166.9"/>
<polygon fill="black" stroke="black" points="452396.48,-169.94 452403.6,-162.1 452393.14,-163.79 452396.48,-169.94"/>
<text text-anchor="middle" x="452292" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l10_dp3 -->
<g id="node1522" class="node">
<title>expert15_l10_dp3</title>
<polygon fill="lightgreen" stroke="black" points="452307.5,-161.98 452078.5,-161.98 452078.5,-109.98 452307.5,-109.98 452307.5,-161.98"/>
<text text-anchor="middle" x="452193" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L10</text>
<text text-anchor="middle" x="452193" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="452193" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="452193" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l10_dp3&#45;&gt;expert15_l10_dp3 -->
<g id="edge2546" class="edge">
<title>router_l10_dp3&#45;&gt;expert15_l10_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M451962.09,-135.98C451998.17,-135.98 452034.91,-135.98 452068.14,-135.98"/>
<polygon fill="black" stroke="black" points="452068.34,-139.48 452078.34,-135.98 452068.34,-132.48 452068.34,-139.48"/>
<text text-anchor="middle" x="452045.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l10_dp3 -->
<g id="node1523" class="node">
<title>expert_agg_l10_dp3</title>
<polygon fill="lightyellow" stroke="black" points="456549.57,-176.98 456155.74,-176.98 456054.43,-94.98 456448.26,-94.98 456549.57,-176.98"/>
<text text-anchor="middle" x="456302" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L10</text>
<text text-anchor="middle" x="456302" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="456302" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2547" class="edge">
<title>expert0_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M456018.66,-135.98C456044.06,-135.98 456069.47,-135.98 456094.87,-135.98"/>
<polygon fill="black" stroke="black" points="456094.99,-139.48 456104.99,-135.98 456094.99,-132.48 456094.99,-139.48"/>
</g>
<!-- expert1_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2548" class="edge">
<title>expert1_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M455712.68,-162.02C455736.02,-171.58 455763.79,-181.22 455790,-185.98 455840.07,-195.08 455968.3,-190.43 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert2_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2549" class="edge">
<title>expert2_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M455465.68,-162.02C455489.02,-171.58 455516.79,-181.22 455543,-185.98 455595.03,-195.44 455966.31,-190.6 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert3_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2550" class="edge">
<title>expert3_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M455218.68,-162.02C455242.02,-171.58 455269.79,-181.22 455296,-185.98 455375.04,-200.35 455938.97,-193 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert4_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2551" class="edge">
<title>expert4_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M454971.68,-162.02C454995.02,-171.58 455022.79,-181.22 455049,-185.98 455102.02,-195.62 455965.32,-190.69 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert5_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2552" class="edge">
<title>expert5_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M454724.68,-162.02C454748.02,-171.58 454775.79,-181.22 454802,-185.98 454868.52,-198.07 455951.65,-191.89 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert6_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2553" class="edge">
<title>expert6_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M454477.68,-162.02C454501.02,-171.58 454528.79,-181.22 454555,-185.98 454635.02,-200.53 455937.98,-193.09 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert7_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2554" class="edge">
<title>expert7_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M454230.68,-162.02C454254.02,-171.58 454281.79,-181.22 454308,-185.98 454354.76,-194.48 455971.65,-190.13 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert8_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2555" class="edge">
<title>expert8_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M453983.68,-162.02C454007.02,-171.58 454034.79,-181.22 454061,-185.98 454114.51,-195.71 455964.82,-190.73 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert9_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2556" class="edge">
<title>expert9_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M453736.68,-162.02C453760.02,-171.58 453787.79,-181.22 453814,-185.98 453874.26,-196.94 455957.98,-191.33 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert10_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2557" class="edge">
<title>expert10_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M453489.68,-162.02C453513.02,-171.58 453540.79,-181.22 453567,-185.98 453634.01,-198.16 455951.15,-191.93 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert11_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2558" class="edge">
<title>expert11_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M453242.68,-162.02C453266.02,-171.58 453293.79,-181.22 453320,-185.98 453393.76,-199.39 455944.31,-192.53 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert12_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2559" class="edge">
<title>expert12_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M452995.68,-162.02C453019.02,-171.58 453046.79,-181.22 453073,-185.98 453153.51,-200.62 455937.48,-193.13 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert13_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2560" class="edge">
<title>expert13_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M452748.68,-162.02C452772.02,-171.58 452799.79,-181.22 452826,-185.98 452869.63,-193.91 455974.82,-189.86 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert14_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2561" class="edge">
<title>expert14_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M452501.68,-162.02C452525.02,-171.58 452552.79,-181.22 452579,-185.98 452626.01,-194.53 455971.4,-190.15 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- expert15_l10_dp3&#45;&gt;expert_agg_l10_dp3 -->
<g id="edge2562" class="edge">
<title>expert15_l10_dp3&#45;&gt;expert_agg_l10_dp3</title>
<path fill="none" stroke="black" d="M452251.3,-162.02C452275.71,-171.58 452304.71,-181.22 452332,-185.98 452382.45,-194.78 455967.99,-190.45 456019,-185.98 456056.75,-182.67 456097.02,-176.93 456134.98,-170.48"/>
<polygon fill="black" stroke="black" points="456135.84,-173.88 456145.1,-168.73 456134.65,-166.98 456135.84,-173.88"/>
</g>
<!-- layer10_output_dp3 -->
<g id="node1524" class="node">
<title>layer10_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="456754" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="456754" y="-144.48" font-family="Arial" font-size="10.00">Layer 10 Output</text>
<text text-anchor="middle" x="456754" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="456754" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l10_dp3&#45;&gt;layer10_output_dp3 -->
<g id="edge2563" class="edge">
<title>expert_agg_l10_dp3&#45;&gt;layer10_output_dp3</title>
<path fill="none" stroke="black" d="M456499.31,-135.98C456524.49,-135.98 456549.66,-135.98 456574.84,-135.98"/>
<polygon fill="black" stroke="black" points="456574.87,-139.48 456584.87,-135.98 456574.87,-132.48 456574.87,-139.48"/>
</g>
<!-- attn_input_l11_dp3 -->
<g id="node1525" class="node">
<title>attn_input_l11_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="457127" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="457127" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L11</text>
<text text-anchor="middle" x="457127" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="457127" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer10_output_dp3&#45;&gt;attn_input_l11_dp3 -->
<g id="edge2564" class="edge">
<title>layer10_output_dp3&#45;&gt;attn_input_l11_dp3</title>
<path fill="none" stroke="black" d="M456923.01,-135.98C456931.23,-135.98 456939.44,-135.98 456947.66,-135.98"/>
<polygon fill="black" stroke="black" points="456947.68,-139.48 456957.68,-135.98 456947.68,-132.48 456947.68,-139.48"/>
</g>
<!-- attn_tp0_l11_dp3 -->
<g id="node1526" class="node">
<title>attn_tp0_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="458425,-161.98 458165,-161.98 458165,-109.98 458425,-109.98 458425,-161.98"/>
<text text-anchor="middle" x="458295" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L11</text>
<text text-anchor="middle" x="458295" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="458295" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="458295" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp3&#45;&gt;attn_tp0_l11_dp3 -->
<g id="edge2565" class="edge">
<title>attn_input_l11_dp3&#45;&gt;attn_tp0_l11_dp3</title>
<path fill="none" stroke="black" d="M457210.52,-161.26C457247.12,-171.09 457290.81,-181.13 457331,-185.98 457376,-191.42 458102.27,-193.33 458147,-185.98 458172.4,-181.81 458199.31,-173.85 458223.12,-165.5"/>
<polygon fill="black" stroke="black" points="458224.55,-168.71 458232.78,-162.03 458222.18,-162.12 458224.55,-168.71"/>
</g>
<!-- attn_tp1_l11_dp3 -->
<g id="node1527" class="node">
<title>attn_tp1_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="458147,-161.98 457887,-161.98 457887,-109.98 458147,-109.98 458147,-161.98"/>
<text text-anchor="middle" x="458017" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L11</text>
<text text-anchor="middle" x="458017" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="458017" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="458017" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp3&#45;&gt;attn_tp1_l11_dp3 -->
<g id="edge2566" class="edge">
<title>attn_input_l11_dp3&#45;&gt;attn_tp1_l11_dp3</title>
<path fill="none" stroke="black" d="M457210.52,-161.26C457247.12,-171.09 457290.81,-181.13 457331,-185.98 457390.35,-193.15 457810.01,-195.68 457869,-185.98 457894.4,-181.81 457921.31,-173.85 457945.12,-165.5"/>
<polygon fill="black" stroke="black" points="457946.55,-168.71 457954.78,-162.03 457944.18,-162.12 457946.55,-168.71"/>
</g>
<!-- attn_tp2_l11_dp3 -->
<g id="node1528" class="node">
<title>attn_tp2_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="457869,-161.98 457609,-161.98 457609,-109.98 457869,-109.98 457869,-161.98"/>
<text text-anchor="middle" x="457739" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L11</text>
<text text-anchor="middle" x="457739" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="457739" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="457739" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp3&#45;&gt;attn_tp2_l11_dp3 -->
<g id="edge2567" class="edge">
<title>attn_input_l11_dp3&#45;&gt;attn_tp2_l11_dp3</title>
<path fill="none" stroke="black" d="M457210.52,-161.26C457247.12,-171.09 457290.81,-181.13 457331,-185.98 457388.36,-192.91 457533.99,-195.35 457591,-185.98 457616.4,-181.81 457643.31,-173.85 457667.12,-165.5"/>
<polygon fill="black" stroke="black" points="457668.55,-168.71 457676.78,-162.03 457666.18,-162.12 457668.55,-168.71"/>
</g>
<!-- attn_tp3_l11_dp3 -->
<g id="node1529" class="node">
<title>attn_tp3_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="457591,-161.98 457331,-161.98 457331,-109.98 457591,-109.98 457591,-161.98"/>
<text text-anchor="middle" x="457461" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L11</text>
<text text-anchor="middle" x="457461" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="457461" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="457461" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l11_dp3&#45;&gt;attn_tp3_l11_dp3 -->
<g id="edge2568" class="edge">
<title>attn_input_l11_dp3&#45;&gt;attn_tp3_l11_dp3</title>
<path fill="none" stroke="black" d="M457296.28,-135.98C457304.35,-135.98 457312.42,-135.98 457320.49,-135.98"/>
<polygon fill="black" stroke="black" points="457320.7,-139.48 457330.7,-135.98 457320.7,-132.48 457320.7,-139.48"/>
</g>
<!-- allreduce_l11_dp3 -->
<g id="node1530" class="node">
<title>allreduce_l11_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="458629" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="458629" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L11</text>
<text text-anchor="middle" x="458629" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="458629" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l11_dp3&#45;&gt;allreduce_l11_dp3 -->
<g id="edge2569" class="edge">
<title>attn_tp0_l11_dp3&#45;&gt;allreduce_l11_dp3</title>
<path fill="none" stroke="black" d="M458425.14,-135.98C458433.35,-135.98 458441.56,-135.98 458449.77,-135.98"/>
<polygon fill="black" stroke="black" points="458449.78,-139.48 458459.78,-135.98 458449.78,-132.48 458449.78,-139.48"/>
</g>
<!-- attn_tp1_l11_dp3&#45;&gt;allreduce_l11_dp3 -->
<g id="edge2570" class="edge">
<title>attn_tp1_l11_dp3&#45;&gt;allreduce_l11_dp3</title>
<path fill="none" stroke="black" d="M458079.22,-162.03C458105.24,-171.59 458136.1,-181.23 458165,-185.98 458222.01,-195.35 458367.64,-192.91 458425,-185.98 458461.57,-181.57 458501.05,-172.85 458535.44,-163.91"/>
<polygon fill="black" stroke="black" points="458536.7,-167.2 458545.47,-161.26 458534.91,-160.43 458536.7,-167.2"/>
</g>
<!-- attn_tp2_l11_dp3&#45;&gt;allreduce_l11_dp3 -->
<g id="edge2571" class="edge">
<title>attn_tp2_l11_dp3&#45;&gt;allreduce_l11_dp3</title>
<path fill="none" stroke="black" d="M457801.22,-162.03C457827.24,-171.59 457858.1,-181.23 457887,-185.98 457945.98,-195.68 458365.65,-193.15 458425,-185.98 458461.57,-181.57 458501.05,-172.85 458535.44,-163.91"/>
<polygon fill="black" stroke="black" points="458536.7,-167.2 458545.47,-161.26 458534.91,-160.43 458536.7,-167.2"/>
</g>
<!-- attn_tp3_l11_dp3&#45;&gt;allreduce_l11_dp3 -->
<g id="edge2572" class="edge">
<title>attn_tp3_l11_dp3&#45;&gt;allreduce_l11_dp3</title>
<path fill="none" stroke="black" d="M457523.22,-162.03C457549.24,-171.59 457580.1,-181.23 457609,-185.98 457653.73,-193.33 458379.99,-191.42 458425,-185.98 458461.57,-181.57 458501.05,-172.85 458535.44,-163.91"/>
<polygon fill="black" stroke="black" points="458536.7,-167.2 458545.47,-161.26 458534.91,-160.43 458536.7,-167.2"/>
</g>
<!-- moe_input_l11_dp3 -->
<g id="node1531" class="node">
<title>moe_input_l11_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="459002" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="459002" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L11</text>
<text text-anchor="middle" x="459002" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="459002" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l11_dp3&#45;&gt;moe_input_l11_dp3 -->
<g id="edge2573" class="edge">
<title>allreduce_l11_dp3&#45;&gt;moe_input_l11_dp3</title>
<path fill="none" stroke="black" d="M458798.01,-135.98C458806.23,-135.98 458814.44,-135.98 458822.66,-135.98"/>
<polygon fill="black" stroke="black" points="458822.68,-139.48 458832.68,-135.98 458822.68,-132.48 458822.68,-139.48"/>
</g>
<!-- router_l11_dp3 -->
<g id="node1532" class="node">
<title>router_l11_dp3</title>
<polygon fill="lightyellow" stroke="black" points="459701.57,-176.98 459307.74,-176.98 459206.43,-94.98 459600.26,-94.98 459701.57,-176.98"/>
<text text-anchor="middle" x="459454" y="-144.48" font-family="Arial" font-size="10.00">Router L11</text>
<text text-anchor="middle" x="459454" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="459454" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l11_dp3&#45;&gt;router_l11_dp3 -->
<g id="edge2574" class="edge">
<title>moe_input_l11_dp3&#45;&gt;router_l11_dp3</title>
<path fill="none" stroke="black" d="M459171.06,-135.98C459196.34,-135.98 459221.63,-135.98 459246.92,-135.98"/>
<polygon fill="black" stroke="black" points="459246.99,-139.48 459256.99,-135.98 459246.99,-132.48 459246.99,-139.48"/>
</g>
<!-- expert0_l11_dp3 -->
<g id="node1533" class="node">
<title>expert0_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="463696.5,-161.98 463467.5,-161.98 463467.5,-109.98 463696.5,-109.98 463696.5,-161.98"/>
<text text-anchor="middle" x="463582" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L11</text>
<text text-anchor="middle" x="463582" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="463582" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="463582" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert0_l11_dp3 -->
<g id="edge2575" class="edge">
<title>router_l11_dp3&#45;&gt;expert0_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459695.23,-171.71C459715.08,-173.81 459734.86,-175.62 459754,-176.98 460518.19,-231.41 462435.38,-196.54 463201.5,-198.98 463316.36,-199.35 463346.71,-201.15 463459,-176.98 463473.39,-173.89 463488.46,-169.69 463502.92,-165.17"/>
<polygon fill="black" stroke="black" points="463504.36,-168.38 463512.81,-161.99 463502.22,-161.72 463504.36,-168.38"/>
<text text-anchor="middle" x="463223" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l11_dp3 -->
<g id="node1534" class="node">
<title>expert1_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="463449.5,-161.98 463220.5,-161.98 463220.5,-109.98 463449.5,-109.98 463449.5,-161.98"/>
<text text-anchor="middle" x="463335" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L11</text>
<text text-anchor="middle" x="463335" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="463335" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="463335" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert1_l11_dp3 -->
<g id="edge2576" class="edge">
<title>router_l11_dp3&#45;&gt;expert1_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459695.23,-171.7C459715.08,-173.8 459734.86,-175.61 459754,-176.98 460462.32,-227.61 462239.37,-196.54 462949.5,-198.98 463066.57,-199.39 463097.51,-201.48 463212,-176.98 463226.4,-173.9 463241.46,-169.72 463255.92,-165.2"/>
<polygon fill="black" stroke="black" points="463257.37,-168.41 463265.82,-162.02 463255.23,-161.75 463257.37,-168.41"/>
<text text-anchor="middle" x="462971" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l11_dp3 -->
<g id="node1535" class="node">
<title>expert2_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="463202.5,-161.98 462973.5,-161.98 462973.5,-109.98 463202.5,-109.98 463202.5,-161.98"/>
<text text-anchor="middle" x="463088" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L11</text>
<text text-anchor="middle" x="463088" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="463088" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="463088" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert2_l11_dp3 -->
<g id="edge2577" class="edge">
<title>router_l11_dp3&#45;&gt;expert2_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459695.23,-171.69C459715.08,-173.79 459734.86,-175.61 459754,-176.98 460405.12,-223.72 462038.71,-196.54 462691.5,-198.98 462813.45,-199.44 462845.69,-202.22 462965,-176.98 462979.4,-173.94 462994.47,-169.77 463008.93,-165.25"/>
<polygon fill="black" stroke="black" points="463010.38,-168.47 463018.83,-162.08 463008.24,-161.8 463010.38,-168.47"/>
<text text-anchor="middle" x="462713" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l11_dp3 -->
<g id="node1536" class="node">
<title>expert3_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="462955.5,-161.98 462726.5,-161.98 462726.5,-109.98 462955.5,-109.98 462955.5,-161.98"/>
<text text-anchor="middle" x="462841" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L11</text>
<text text-anchor="middle" x="462841" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="462841" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="462841" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert3_l11_dp3 -->
<g id="edge2578" class="edge">
<title>router_l11_dp3&#45;&gt;expert3_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459695.23,-171.67C459715.08,-173.78 459734.86,-175.6 459754,-176.98 460345.7,-219.68 461830.26,-196.54 462423.5,-198.98 462554.75,-199.52 462589.48,-203.64 462718,-176.98 462732.64,-173.95 462747.97,-169.72 462762.64,-165.13"/>
<polygon fill="black" stroke="black" points="462763.72,-168.46 462772.18,-162.08 462761.58,-161.8 462763.72,-168.46"/>
<text text-anchor="middle" x="462445" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l11_dp3 -->
<g id="node1537" class="node">
<title>expert4_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="462708.5,-161.98 462479.5,-161.98 462479.5,-109.98 462708.5,-109.98 462708.5,-161.98"/>
<text text-anchor="middle" x="462594" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L11</text>
<text text-anchor="middle" x="462594" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="462594" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="462594" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert4_l11_dp3 -->
<g id="edge2579" class="edge">
<title>router_l11_dp3&#45;&gt;expert4_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459695.24,-171.65C459715.08,-173.76 459734.86,-175.59 459754,-176.98 460281.41,-215.31 461604.7,-196.54 462133.5,-198.98 462283.82,-199.68 462323.62,-206.57 462471,-176.98 462485.84,-174 462501.38,-169.76 462516.22,-165.12"/>
<polygon fill="black" stroke="black" points="462517.4,-168.41 462525.85,-162.02 462515.26,-161.75 462517.4,-168.41"/>
<text text-anchor="middle" x="462155" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l11_dp3 -->
<g id="node1538" class="node">
<title>expert5_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="462461.5,-161.98 462232.5,-161.98 462232.5,-109.98 462461.5,-109.98 462461.5,-161.98"/>
<text text-anchor="middle" x="462347" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L11</text>
<text text-anchor="middle" x="462347" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="462347" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="462347" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert5_l11_dp3 -->
<g id="edge2580" class="edge">
<title>router_l11_dp3&#45;&gt;expert5_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459695.24,-171.62C459715.09,-173.74 459734.86,-175.58 459754,-176.98 460207.58,-210.28 461345.7,-196.54 461800.5,-198.98 461988.97,-200 462038.91,-212.53 462224,-176.98 462239.05,-174.09 462254.79,-169.84 462269.8,-165.15"/>
<polygon fill="black" stroke="black" points="462271.09,-168.41 462279.54,-162.02 462268.95,-161.75 462271.09,-168.41"/>
<text text-anchor="middle" x="461822" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l11_dp3 -->
<g id="node1539" class="node">
<title>expert6_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="462214.5,-161.98 461985.5,-161.98 461985.5,-109.98 462214.5,-109.98 462214.5,-161.98"/>
<text text-anchor="middle" x="462100" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L11</text>
<text text-anchor="middle" x="462100" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="462100" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="462100" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert6_l11_dp3 -->
<g id="edge2581" class="edge">
<title>router_l11_dp3&#45;&gt;expert6_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459609.69,-176.99C459650.94,-186.09 459695.65,-194.39 459737.5,-198.98 459756.5,-201.07 459761.39,-199.08 459780.5,-198.98 460024.56,-197.76 461736.28,-217.28 461977,-176.98 461992.72,-174.35 462009.15,-170.04 462024.7,-165.18"/>
<polygon fill="black" stroke="black" points="462025.81,-168.49 462034.25,-162.09 462023.66,-161.83 462025.81,-168.49"/>
<text text-anchor="middle" x="459759" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l11_dp3 -->
<g id="node1540" class="node">
<title>expert7_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="461967.5,-161.98 461738.5,-161.98 461738.5,-109.98 461967.5,-109.98 461967.5,-161.98"/>
<text text-anchor="middle" x="461853" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L11</text>
<text text-anchor="middle" x="461853" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="461853" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="461853" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert7_l11_dp3 -->
<g id="edge2582" class="edge">
<title>router_l11_dp3&#45;&gt;expert7_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459694.83,-171.52C459714.82,-173.67 459734.73,-175.54 459754,-176.98 460475.83,-230.98 460658.67,-194.09 461382.5,-198.98 461537.25,-200.03 461578.24,-207.26 461730,-176.98 461744.85,-174.02 461760.38,-169.78 461775.22,-165.15"/>
<polygon fill="black" stroke="black" points="461776.41,-168.44 461784.86,-162.05 461774.27,-161.78 461776.41,-168.44"/>
<text text-anchor="middle" x="461404" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l11_dp3 -->
<g id="node1541" class="node">
<title>expert8_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="461720.5,-161.98 461491.5,-161.98 461491.5,-109.98 461720.5,-109.98 461720.5,-161.98"/>
<text text-anchor="middle" x="461606" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L11</text>
<text text-anchor="middle" x="461606" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="461606" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="461606" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert8_l11_dp3 -->
<g id="edge2583" class="edge">
<title>router_l11_dp3&#45;&gt;expert8_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459694.84,-171.44C459714.82,-173.61 459734.74,-175.51 459754,-176.98 460048.4,-199.54 460787.35,-207.08 461082.5,-198.98 461260.7,-194.09 461307.88,-210.36 461483,-176.98 461498.05,-174.11 461513.8,-169.87 461528.81,-165.19"/>
<polygon fill="black" stroke="black" points="461530.1,-168.45 461538.55,-162.06 461527.96,-161.78 461530.1,-168.45"/>
<text text-anchor="middle" x="461061" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l11_dp3 -->
<g id="node1542" class="node">
<title>expert9_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="461473.5,-161.98 461244.5,-161.98 461244.5,-109.98 461473.5,-109.98 461473.5,-161.98"/>
<text text-anchor="middle" x="461359" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L11</text>
<text text-anchor="middle" x="461359" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="461359" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="461359" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert9_l11_dp3 -->
<g id="edge2584" class="edge">
<title>router_l11_dp3&#45;&gt;expert9_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459641.36,-177C459690.91,-186.1 459744.51,-194.4 459794.5,-198.98 459813.53,-200.73 459818.39,-199.13 459837.5,-198.98 460148.31,-196.54 460929.6,-229.18 461236,-176.98 461251.71,-174.31 461268.14,-169.97 461283.69,-165.11"/>
<polygon fill="black" stroke="black" points="461284.8,-168.42 461293.24,-162.02 461282.65,-161.76 461284.8,-168.42"/>
<text text-anchor="middle" x="459816" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l11_dp3 -->
<g id="node1543" class="node">
<title>expert10_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="461226.5,-161.98 460997.5,-161.98 460997.5,-109.98 461226.5,-109.98 461226.5,-161.98"/>
<text text-anchor="middle" x="461112" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L11</text>
<text text-anchor="middle" x="461112" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="461112" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="461112" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert10_l11_dp3 -->
<g id="edge2585" class="edge">
<title>router_l11_dp3&#45;&gt;expert10_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459694.45,-171.21C459714.56,-173.44 459734.61,-175.41 459754,-176.98 460148.6,-208.97 460248.8,-211.6 460644.5,-198.98 460797.84,-194.09 460838.42,-206.37 460989,-176.98 461003.95,-174.06 461019.59,-169.82 461034.51,-165.16"/>
<polygon fill="black" stroke="black" points="461035.75,-168.44 461044.2,-162.05 461033.61,-161.78 461035.75,-168.44"/>
<text text-anchor="middle" x="460623" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l11_dp3 -->
<g id="node1544" class="node">
<title>expert11_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="460979.5,-161.98 460750.5,-161.98 460750.5,-109.98 460979.5,-109.98 460979.5,-161.98"/>
<text text-anchor="middle" x="460865" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L11</text>
<text text-anchor="middle" x="460865" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="460865" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="460865" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert11_l11_dp3 -->
<g id="edge2586" class="edge">
<title>router_l11_dp3&#45;&gt;expert11_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459670.77,-177.01C459728.03,-186.11 459789.91,-194.4 459847.5,-198.98 460045.71,-214.75 460546.16,-211.37 460742,-176.98 460757.46,-174.27 460773.62,-169.99 460788.96,-165.2"/>
<polygon fill="black" stroke="black" points="460790.46,-168.4 460798.9,-162 460788.31,-161.74 460790.46,-168.4"/>
<text text-anchor="middle" x="459869" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l11_dp3 -->
<g id="node1545" class="node">
<title>expert12_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="460732.5,-161.98 460503.5,-161.98 460503.5,-109.98 460732.5,-109.98 460732.5,-161.98"/>
<text text-anchor="middle" x="460618" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L11</text>
<text text-anchor="middle" x="460618" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="460618" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="460618" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert12_l11_dp3 -->
<g id="edge2587" class="edge">
<title>router_l11_dp3&#45;&gt;expert12_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459694.08,-170.71C459714.32,-173.05 459734.5,-175.19 459754,-176.98 459754,-176.98 460495,-176.98 460495,-176.98 460509.63,-173.9 460524.96,-169.65 460539.63,-165.05"/>
<polygon fill="black" stroke="black" points="460540.71,-168.38 460549.16,-161.99 460538.57,-161.72 460540.71,-168.38"/>
<text text-anchor="middle" x="460240" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l11_dp3 -->
<g id="node1546" class="node">
<title>expert13_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="460485.5,-161.98 460256.5,-161.98 460256.5,-109.98 460485.5,-109.98 460485.5,-161.98"/>
<text text-anchor="middle" x="460371" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L11</text>
<text text-anchor="middle" x="460371" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="460371" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="460371" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert13_l11_dp3 -->
<g id="edge2588" class="edge">
<title>router_l11_dp3&#45;&gt;expert13_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459698.5,-177.01C459763.02,-186.11 459832.72,-194.4 459897.5,-198.98 460012.64,-207.12 460109.2,-204.63 460248,-176.98 460262.85,-174.03 460278.39,-169.79 460293.23,-165.16"/>
<polygon fill="black" stroke="black" points="460294.41,-168.45 460302.86,-162.06 460292.27,-161.79 460294.41,-168.45"/>
<text text-anchor="middle" x="459919" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l11_dp3 -->
<g id="node1547" class="node">
<title>expert14_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="460238.5,-161.98 460009.5,-161.98 460009.5,-109.98 460238.5,-109.98 460238.5,-161.98"/>
<text text-anchor="middle" x="460124" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L11</text>
<text text-anchor="middle" x="460124" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="460124" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="460124" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert14_l11_dp3 -->
<g id="edge2589" class="edge">
<title>router_l11_dp3&#45;&gt;expert14_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459676.49,-177.02C459796.1,-196.13 459930.79,-212.05 459989.5,-198.98 460018.07,-192.62 460047.74,-179.52 460071.92,-166.9"/>
<polygon fill="black" stroke="black" points="460073.74,-169.9 460080.91,-162.1 460070.44,-163.73 460073.74,-169.9"/>
<text text-anchor="middle" x="459968" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l11_dp3 -->
<g id="node1548" class="node">
<title>expert15_l11_dp3</title>
<polygon fill="lightgreen" stroke="black" points="459991.5,-161.98 459762.5,-161.98 459762.5,-109.98 459991.5,-109.98 459991.5,-161.98"/>
<text text-anchor="middle" x="459877" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L11</text>
<text text-anchor="middle" x="459877" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="459877" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="459877" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l11_dp3&#45;&gt;expert15_l11_dp3 -->
<g id="edge2590" class="edge">
<title>router_l11_dp3&#45;&gt;expert15_l11_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459650.95,-135.98C459685.38,-135.98 459720.32,-135.98 459752.11,-135.98"/>
<polygon fill="black" stroke="black" points="459752.32,-139.48 459762.32,-135.98 459752.32,-132.48 459752.32,-139.48"/>
<text text-anchor="middle" x="459732.14" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l11_dp3 -->
<g id="node1549" class="node">
<title>expert_agg_l11_dp3</title>
<polygon fill="lightyellow" stroke="black" points="464227.57,-176.98 463833.74,-176.98 463732.43,-94.98 464126.26,-94.98 464227.57,-176.98"/>
<text text-anchor="middle" x="463980" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L11</text>
<text text-anchor="middle" x="463980" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="463980" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2591" class="edge">
<title>expert0_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M463696.66,-135.98C463722.06,-135.98 463747.47,-135.98 463772.87,-135.98"/>
<polygon fill="black" stroke="black" points="463772.99,-139.48 463782.99,-135.98 463772.99,-132.48 463772.99,-139.48"/>
</g>
<!-- expert1_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2592" class="edge">
<title>expert1_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M463390.68,-162.02C463414.02,-171.58 463441.79,-181.22 463468,-185.98 463518.07,-195.08 463646.3,-190.43 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert2_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2593" class="edge">
<title>expert2_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M463143.68,-162.02C463167.02,-171.58 463194.79,-181.22 463221,-185.98 463273.03,-195.44 463644.31,-190.6 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert3_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2594" class="edge">
<title>expert3_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M462896.68,-162.02C462920.02,-171.58 462947.79,-181.22 462974,-185.98 463053.04,-200.35 463616.97,-193 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert4_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2595" class="edge">
<title>expert4_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M462649.68,-162.02C462673.02,-171.58 462700.79,-181.22 462727,-185.98 462780.02,-195.62 463643.32,-190.69 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert5_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2596" class="edge">
<title>expert5_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M462402.68,-162.02C462426.02,-171.58 462453.79,-181.22 462480,-185.98 462546.52,-198.07 463629.65,-191.89 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert6_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2597" class="edge">
<title>expert6_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M462155.68,-162.02C462179.02,-171.58 462206.79,-181.22 462233,-185.98 462313.02,-200.53 463615.98,-193.09 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert7_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2598" class="edge">
<title>expert7_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M461908.68,-162.02C461932.02,-171.58 461959.79,-181.22 461986,-185.98 462032.76,-194.48 463649.65,-190.13 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert8_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2599" class="edge">
<title>expert8_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M461661.68,-162.02C461685.02,-171.58 461712.79,-181.22 461739,-185.98 461792.51,-195.71 463642.82,-190.73 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert9_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2600" class="edge">
<title>expert9_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M461414.68,-162.02C461438.02,-171.58 461465.79,-181.22 461492,-185.98 461552.26,-196.94 463635.98,-191.33 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert10_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2601" class="edge">
<title>expert10_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M461167.68,-162.02C461191.02,-171.58 461218.79,-181.22 461245,-185.98 461312.01,-198.16 463629.15,-191.93 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert11_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2602" class="edge">
<title>expert11_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M460920.68,-162.02C460944.02,-171.58 460971.79,-181.22 460998,-185.98 461071.76,-199.39 463622.31,-192.53 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert12_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2603" class="edge">
<title>expert12_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M460673.68,-162.02C460697.02,-171.58 460724.79,-181.22 460751,-185.98 460831.51,-200.62 463615.48,-193.13 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert13_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2604" class="edge">
<title>expert13_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M460426.68,-162.02C460450.02,-171.58 460477.79,-181.22 460504,-185.98 460547.63,-193.91 463652.82,-189.86 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert14_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2605" class="edge">
<title>expert14_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M460179.68,-162.02C460203.02,-171.58 460230.79,-181.22 460257,-185.98 460304.01,-194.53 463649.4,-190.15 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- expert15_l11_dp3&#45;&gt;expert_agg_l11_dp3 -->
<g id="edge2606" class="edge">
<title>expert15_l11_dp3&#45;&gt;expert_agg_l11_dp3</title>
<path fill="none" stroke="black" d="M459932.68,-162.02C459956.02,-171.58 459983.79,-181.22 460010,-185.98 460060.38,-195.14 463645.99,-190.45 463697,-185.98 463734.75,-182.67 463775.02,-176.93 463812.98,-170.48"/>
<polygon fill="black" stroke="black" points="463813.84,-173.88 463823.1,-168.73 463812.65,-166.98 463813.84,-173.88"/>
</g>
<!-- layer11_output_dp3 -->
<g id="node1550" class="node">
<title>layer11_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="464432" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="464432" y="-144.48" font-family="Arial" font-size="10.00">Layer 11 Output</text>
<text text-anchor="middle" x="464432" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="464432" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l11_dp3&#45;&gt;layer11_output_dp3 -->
<g id="edge2607" class="edge">
<title>expert_agg_l11_dp3&#45;&gt;layer11_output_dp3</title>
<path fill="none" stroke="black" d="M464177.31,-135.98C464202.49,-135.98 464227.66,-135.98 464252.84,-135.98"/>
<polygon fill="black" stroke="black" points="464252.87,-139.48 464262.87,-135.98 464252.87,-132.48 464252.87,-139.48"/>
</g>
<!-- attn_input_l12_dp3 -->
<g id="node1551" class="node">
<title>attn_input_l12_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="464805" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="464805" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L12</text>
<text text-anchor="middle" x="464805" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="464805" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer11_output_dp3&#45;&gt;attn_input_l12_dp3 -->
<g id="edge2608" class="edge">
<title>layer11_output_dp3&#45;&gt;attn_input_l12_dp3</title>
<path fill="none" stroke="black" d="M464601.01,-135.98C464609.23,-135.98 464617.44,-135.98 464625.66,-135.98"/>
<polygon fill="black" stroke="black" points="464625.68,-139.48 464635.68,-135.98 464625.68,-132.48 464625.68,-139.48"/>
</g>
<!-- attn_tp0_l12_dp3 -->
<g id="node1552" class="node">
<title>attn_tp0_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="466103,-161.98 465843,-161.98 465843,-109.98 466103,-109.98 466103,-161.98"/>
<text text-anchor="middle" x="465973" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L12</text>
<text text-anchor="middle" x="465973" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="465973" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="465973" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp3&#45;&gt;attn_tp0_l12_dp3 -->
<g id="edge2609" class="edge">
<title>attn_input_l12_dp3&#45;&gt;attn_tp0_l12_dp3</title>
<path fill="none" stroke="black" d="M464888.52,-161.26C464925.12,-171.09 464968.81,-181.13 465009,-185.98 465054,-191.42 465780.27,-193.33 465825,-185.98 465850.4,-181.81 465877.31,-173.85 465901.12,-165.5"/>
<polygon fill="black" stroke="black" points="465902.55,-168.71 465910.78,-162.03 465900.18,-162.12 465902.55,-168.71"/>
</g>
<!-- attn_tp1_l12_dp3 -->
<g id="node1553" class="node">
<title>attn_tp1_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="465825,-161.98 465565,-161.98 465565,-109.98 465825,-109.98 465825,-161.98"/>
<text text-anchor="middle" x="465695" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L12</text>
<text text-anchor="middle" x="465695" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="465695" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="465695" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp3&#45;&gt;attn_tp1_l12_dp3 -->
<g id="edge2610" class="edge">
<title>attn_input_l12_dp3&#45;&gt;attn_tp1_l12_dp3</title>
<path fill="none" stroke="black" d="M464888.52,-161.26C464925.12,-171.09 464968.81,-181.13 465009,-185.98 465068.35,-193.15 465488.01,-195.68 465547,-185.98 465572.4,-181.81 465599.31,-173.85 465623.12,-165.5"/>
<polygon fill="black" stroke="black" points="465624.55,-168.71 465632.78,-162.03 465622.18,-162.12 465624.55,-168.71"/>
</g>
<!-- attn_tp2_l12_dp3 -->
<g id="node1554" class="node">
<title>attn_tp2_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="465547,-161.98 465287,-161.98 465287,-109.98 465547,-109.98 465547,-161.98"/>
<text text-anchor="middle" x="465417" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L12</text>
<text text-anchor="middle" x="465417" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="465417" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="465417" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp3&#45;&gt;attn_tp2_l12_dp3 -->
<g id="edge2611" class="edge">
<title>attn_input_l12_dp3&#45;&gt;attn_tp2_l12_dp3</title>
<path fill="none" stroke="black" d="M464888.52,-161.26C464925.12,-171.09 464968.81,-181.13 465009,-185.98 465066.36,-192.91 465211.99,-195.35 465269,-185.98 465294.4,-181.81 465321.31,-173.85 465345.12,-165.5"/>
<polygon fill="black" stroke="black" points="465346.55,-168.71 465354.78,-162.03 465344.18,-162.12 465346.55,-168.71"/>
</g>
<!-- attn_tp3_l12_dp3 -->
<g id="node1555" class="node">
<title>attn_tp3_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="465269,-161.98 465009,-161.98 465009,-109.98 465269,-109.98 465269,-161.98"/>
<text text-anchor="middle" x="465139" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L12</text>
<text text-anchor="middle" x="465139" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="465139" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="465139" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l12_dp3&#45;&gt;attn_tp3_l12_dp3 -->
<g id="edge2612" class="edge">
<title>attn_input_l12_dp3&#45;&gt;attn_tp3_l12_dp3</title>
<path fill="none" stroke="black" d="M464974.28,-135.98C464982.35,-135.98 464990.42,-135.98 464998.49,-135.98"/>
<polygon fill="black" stroke="black" points="464998.7,-139.48 465008.7,-135.98 464998.7,-132.48 464998.7,-139.48"/>
</g>
<!-- allreduce_l12_dp3 -->
<g id="node1556" class="node">
<title>allreduce_l12_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="466307" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="466307" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L12</text>
<text text-anchor="middle" x="466307" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="466307" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l12_dp3&#45;&gt;allreduce_l12_dp3 -->
<g id="edge2613" class="edge">
<title>attn_tp0_l12_dp3&#45;&gt;allreduce_l12_dp3</title>
<path fill="none" stroke="black" d="M466103.14,-135.98C466111.35,-135.98 466119.56,-135.98 466127.77,-135.98"/>
<polygon fill="black" stroke="black" points="466127.78,-139.48 466137.78,-135.98 466127.78,-132.48 466127.78,-139.48"/>
</g>
<!-- attn_tp1_l12_dp3&#45;&gt;allreduce_l12_dp3 -->
<g id="edge2614" class="edge">
<title>attn_tp1_l12_dp3&#45;&gt;allreduce_l12_dp3</title>
<path fill="none" stroke="black" d="M465757.22,-162.03C465783.24,-171.59 465814.1,-181.23 465843,-185.98 465900.01,-195.35 466045.64,-192.91 466103,-185.98 466139.57,-181.57 466179.05,-172.85 466213.44,-163.91"/>
<polygon fill="black" stroke="black" points="466214.7,-167.2 466223.47,-161.26 466212.91,-160.43 466214.7,-167.2"/>
</g>
<!-- attn_tp2_l12_dp3&#45;&gt;allreduce_l12_dp3 -->
<g id="edge2615" class="edge">
<title>attn_tp2_l12_dp3&#45;&gt;allreduce_l12_dp3</title>
<path fill="none" stroke="black" d="M465479.22,-162.03C465505.24,-171.59 465536.1,-181.23 465565,-185.98 465623.98,-195.68 466043.65,-193.15 466103,-185.98 466139.57,-181.57 466179.05,-172.85 466213.44,-163.91"/>
<polygon fill="black" stroke="black" points="466214.7,-167.2 466223.47,-161.26 466212.91,-160.43 466214.7,-167.2"/>
</g>
<!-- attn_tp3_l12_dp3&#45;&gt;allreduce_l12_dp3 -->
<g id="edge2616" class="edge">
<title>attn_tp3_l12_dp3&#45;&gt;allreduce_l12_dp3</title>
<path fill="none" stroke="black" d="M465201.22,-162.03C465227.24,-171.59 465258.1,-181.23 465287,-185.98 465331.73,-193.33 466057.99,-191.42 466103,-185.98 466139.57,-181.57 466179.05,-172.85 466213.44,-163.91"/>
<polygon fill="black" stroke="black" points="466214.7,-167.2 466223.47,-161.26 466212.91,-160.43 466214.7,-167.2"/>
</g>
<!-- moe_input_l12_dp3 -->
<g id="node1557" class="node">
<title>moe_input_l12_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="466680" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="466680" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L12</text>
<text text-anchor="middle" x="466680" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="466680" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l12_dp3&#45;&gt;moe_input_l12_dp3 -->
<g id="edge2617" class="edge">
<title>allreduce_l12_dp3&#45;&gt;moe_input_l12_dp3</title>
<path fill="none" stroke="black" d="M466476.01,-135.98C466484.23,-135.98 466492.44,-135.98 466500.66,-135.98"/>
<polygon fill="black" stroke="black" points="466500.68,-139.48 466510.68,-135.98 466500.68,-132.48 466500.68,-139.48"/>
</g>
<!-- router_l12_dp3 -->
<g id="node1558" class="node">
<title>router_l12_dp3</title>
<polygon fill="lightyellow" stroke="black" points="467379.57,-176.98 466985.74,-176.98 466884.43,-94.98 467278.26,-94.98 467379.57,-176.98"/>
<text text-anchor="middle" x="467132" y="-144.48" font-family="Arial" font-size="10.00">Router L12</text>
<text text-anchor="middle" x="467132" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="467132" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l12_dp3&#45;&gt;router_l12_dp3 -->
<g id="edge2618" class="edge">
<title>moe_input_l12_dp3&#45;&gt;router_l12_dp3</title>
<path fill="none" stroke="black" d="M466849.06,-135.98C466874.34,-135.98 466899.63,-135.98 466924.92,-135.98"/>
<polygon fill="black" stroke="black" points="466924.99,-139.48 466934.99,-135.98 466924.99,-132.48 466924.99,-139.48"/>
</g>
<!-- expert0_l12_dp3 -->
<g id="node1559" class="node">
<title>expert0_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="471481.5,-161.98 471252.5,-161.98 471252.5,-109.98 471481.5,-109.98 471481.5,-161.98"/>
<text text-anchor="middle" x="471367" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L12</text>
<text text-anchor="middle" x="471367" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="471367" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="471367" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert0_l12_dp3 -->
<g id="edge2619" class="edge">
<title>router_l12_dp3&#45;&gt;expert0_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.13,-166.92C467406.43,-171.04 467446.82,-174.65 467485,-176.98 468255.02,-224 470185.04,-196.54 470956.5,-198.98 471084.65,-199.39 471118.55,-203.16 471244,-176.98 471258.64,-173.93 471273.97,-169.7 471288.64,-165.1"/>
<polygon fill="black" stroke="black" points="471289.72,-168.43 471298.17,-162.04 471287.58,-161.77 471289.72,-168.43"/>
<text text-anchor="middle" x="470978" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l12_dp3 -->
<g id="node1560" class="node">
<title>expert1_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="471234.5,-161.98 471005.5,-161.98 471005.5,-109.98 471234.5,-109.98 471234.5,-161.98"/>
<text text-anchor="middle" x="471120" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L12</text>
<text text-anchor="middle" x="471120" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="471120" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="471120" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert1_l12_dp3 -->
<g id="edge2620" class="edge">
<title>router_l12_dp3&#45;&gt;expert1_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.13,-166.9C467406.43,-171.03 467446.82,-174.64 467485,-176.98 468192.46,-220.38 469965.71,-196.54 470674.5,-198.98 470818.16,-199.48 470856.2,-205.55 470997,-176.98 471011.75,-173.99 471027.18,-169.77 471041.94,-165.15"/>
<polygon fill="black" stroke="black" points="471043.07,-168.47 471051.52,-162.08 471040.93,-161.8 471043.07,-168.47"/>
<text text-anchor="middle" x="470696" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l12_dp3 -->
<g id="node1561" class="node">
<title>expert2_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="470987.5,-161.98 470758.5,-161.98 470758.5,-109.98 470987.5,-109.98 470987.5,-161.98"/>
<text text-anchor="middle" x="470873" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L12</text>
<text text-anchor="middle" x="470873" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="470873" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="470873" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert2_l12_dp3 -->
<g id="edge2621" class="edge">
<title>router_l12_dp3&#45;&gt;expert2_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.14,-166.87C467406.43,-171.01 467446.82,-174.63 467485,-176.98 468122.14,-216.31 469719.15,-196.54 470357.5,-198.98 470532.22,-199.65 470578.5,-210.38 470750,-176.98 470764.95,-174.07 470780.59,-169.83 470795.52,-165.18"/>
<polygon fill="black" stroke="black" points="470796.76,-168.45 470805.21,-162.06 470794.61,-161.79 470796.76,-168.45"/>
<text text-anchor="middle" x="470379" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l12_dp3 -->
<g id="node1562" class="node">
<title>expert3_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="470740.5,-161.98 470511.5,-161.98 470511.5,-109.98 470740.5,-109.98 470740.5,-161.98"/>
<text text-anchor="middle" x="470626" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L12</text>
<text text-anchor="middle" x="470626" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="470626" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="470626" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert3_l12_dp3 -->
<g id="edge2622" class="edge">
<title>router_l12_dp3&#45;&gt;expert3_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.14,-166.83C467406.43,-170.97 467446.82,-174.6 467485,-176.98 468036.28,-211.34 469418.15,-196.54 469970.5,-198.98 470207.36,-200.03 470270.1,-220.17 470503,-176.98 470518.16,-174.17 470534.01,-169.93 470549.1,-165.22"/>
<polygon fill="black" stroke="black" points="470550.44,-168.47 470558.89,-162.08 470548.3,-161.81 470550.44,-168.47"/>
<text text-anchor="middle" x="469992" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l12_dp3 -->
<g id="node1563" class="node">
<title>expert4_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="470493.5,-161.98 470264.5,-161.98 470264.5,-109.98 470493.5,-109.98 470493.5,-161.98"/>
<text text-anchor="middle" x="470379" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L12</text>
<text text-anchor="middle" x="470379" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="470379" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="470379" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert4_l12_dp3 -->
<g id="edge2623" class="edge">
<title>router_l12_dp3&#45;&gt;expert4_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.14,-166.76C467406.43,-170.9 467446.82,-174.56 467485,-176.98 467928.69,-205.17 469040.96,-205.33 469485.5,-198.98 469828.05,-194.09 469918.66,-236.68 470256,-176.98 470271.36,-174.26 470287.42,-170.01 470302.68,-165.26"/>
<polygon fill="black" stroke="black" points="470304.13,-168.47 470312.57,-162.07 470301.98,-161.8 470304.13,-168.47"/>
<text text-anchor="middle" x="469464" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l12_dp3 -->
<g id="node1564" class="node">
<title>expert5_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="470246.5,-161.98 470017.5,-161.98 470017.5,-109.98 470246.5,-109.98 470246.5,-161.98"/>
<text text-anchor="middle" x="470132" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L12</text>
<text text-anchor="middle" x="470132" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="470132" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="470132" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert5_l12_dp3 -->
<g id="edge2624" class="edge">
<title>router_l12_dp3&#45;&gt;expert5_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467277.67,-176.99C467316.3,-186.08 467358.21,-194.39 467397.5,-198.98 467416.48,-201.2 467421.39,-199.06 467440.5,-198.98 467725.9,-197.76 469727.48,-223.9 470009,-176.98 470024.81,-174.35 470041.35,-170 470056.98,-165.11"/>
<polygon fill="black" stroke="black" points="470058.14,-168.41 470066.58,-162 470055.98,-161.75 470058.14,-168.41"/>
<text text-anchor="middle" x="467419" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l12_dp3 -->
<g id="node1565" class="node">
<title>expert6_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="469999.5,-161.98 469770.5,-161.98 469770.5,-109.98 469999.5,-109.98 469999.5,-161.98"/>
<text text-anchor="middle" x="469885" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L12</text>
<text text-anchor="middle" x="469885" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="469885" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="469885" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert6_l12_dp3 -->
<g id="edge2625" class="edge">
<title>router_l12_dp3&#45;&gt;expert6_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467304.37,-177C467349.98,-186.1 467399.37,-194.39 467445.5,-198.98 467464.52,-200.87 467469.39,-199.08 467488.5,-198.98 467741.12,-197.76 469512.84,-218.65 469762,-176.98 469777.81,-174.34 469794.34,-169.99 469809.97,-165.1"/>
<polygon fill="black" stroke="black" points="469811.14,-168.4 469819.57,-161.99 469808.98,-161.74 469811.14,-168.4"/>
<text text-anchor="middle" x="467467" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l12_dp3 -->
<g id="node1566" class="node">
<title>expert7_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="469752.5,-161.98 469523.5,-161.98 469523.5,-109.98 469752.5,-109.98 469752.5,-161.98"/>
<text text-anchor="middle" x="469638" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L12</text>
<text text-anchor="middle" x="469638" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="469638" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="469638" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert7_l12_dp3 -->
<g id="edge2626" class="edge">
<title>router_l12_dp3&#45;&gt;expert7_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467331.02,-177C467383.62,-186.1 467440.5,-194.4 467493.5,-198.98 467512.54,-200.63 467517.39,-199.09 467536.5,-198.98 467756.34,-197.76 469298.19,-213.4 469515,-176.98 469530.72,-174.34 469547.15,-170.03 469562.7,-165.16"/>
<polygon fill="black" stroke="black" points="469563.81,-168.48 469572.25,-162.07 469561.66,-161.82 469563.81,-168.48"/>
<text text-anchor="middle" x="467515" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l12_dp3 -->
<g id="node1567" class="node">
<title>expert8_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="469505.5,-161.98 469276.5,-161.98 469276.5,-109.98 469505.5,-109.98 469505.5,-161.98"/>
<text text-anchor="middle" x="469391" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L12</text>
<text text-anchor="middle" x="469391" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="469391" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="469391" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert8_l12_dp3 -->
<g id="edge2627" class="edge">
<title>router_l12_dp3&#45;&gt;expert8_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467366.68,-166.44C467406.12,-170.64 467446.68,-174.4 467485,-176.98 468013.44,-212.65 468146.94,-208.83 468676.5,-198.98 468939.52,-194.09 469009.15,-223.94 469268,-176.98 469283.26,-174.21 469299.22,-169.97 469314.39,-165.23"/>
<polygon fill="black" stroke="black" points="469315.78,-168.46 469324.23,-162.07 469313.64,-161.8 469315.78,-168.46"/>
<text text-anchor="middle" x="468655" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l12_dp3 -->
<g id="node1568" class="node">
<title>expert9_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="469258.5,-161.98 469029.5,-161.98 469029.5,-109.98 469258.5,-109.98 469258.5,-161.98"/>
<text text-anchor="middle" x="469144" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L12</text>
<text text-anchor="middle" x="469144" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="469144" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="469144" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert9_l12_dp3 -->
<g id="edge2628" class="edge">
<title>router_l12_dp3&#45;&gt;expert9_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467357.65,-177.01C467417.23,-186.11 467481.61,-194.4 467541.5,-198.98 467705.43,-211.52 468858.92,-204.56 469021,-176.98 469036.71,-174.31 469053.14,-169.98 469068.69,-165.11"/>
<polygon fill="black" stroke="black" points="469069.8,-168.43 469078.24,-162.02 469067.65,-161.77 469069.8,-168.43"/>
<text text-anchor="middle" x="467563" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l12_dp3 -->
<g id="node1569" class="node">
<title>expert10_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="469011.5,-161.98 468782.5,-161.98 468782.5,-109.98 469011.5,-109.98 469011.5,-161.98"/>
<text text-anchor="middle" x="468897" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L12</text>
<text text-anchor="middle" x="468897" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="468897" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="468897" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert10_l12_dp3 -->
<g id="edge2629" class="edge">
<title>router_l12_dp3&#45;&gt;expert10_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467378.89,-176.28C467446.94,-185.66 467520.91,-194.28 467589.5,-198.98 467720.82,-207.98 468644.27,-199.32 468774,-176.98 468789.47,-174.32 468805.63,-170.07 468820.97,-165.28"/>
<polygon fill="black" stroke="black" points="468822.47,-168.48 468830.91,-162.08 468820.32,-161.82 468822.47,-168.48"/>
<text text-anchor="middle" x="467611" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l12_dp3 -->
<g id="node1570" class="node">
<title>expert11_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="468764.5,-161.98 468535.5,-161.98 468535.5,-109.98 468764.5,-109.98 468764.5,-161.98"/>
<text text-anchor="middle" x="468650" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L12</text>
<text text-anchor="middle" x="468650" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="468650" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="468650" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert11_l12_dp3 -->
<g id="edge2630" class="edge">
<title>router_l12_dp3&#45;&gt;expert11_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467374.08,-172.34C467457.36,-183.2 467551.33,-193.63 467637.5,-198.98 467834.85,-211.23 468332.25,-211.19 468527,-176.98 468542.46,-174.27 468558.62,-169.99 468573.96,-165.2"/>
<polygon fill="black" stroke="black" points="468575.46,-168.4 468583.9,-161.99 468573.31,-161.73 468575.46,-168.4"/>
<text text-anchor="middle" x="467659" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l12_dp3 -->
<g id="node1571" class="node">
<title>expert12_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="468517.5,-161.98 468288.5,-161.98 468288.5,-109.98 468517.5,-109.98 468517.5,-161.98"/>
<text text-anchor="middle" x="468403" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L12</text>
<text text-anchor="middle" x="468403" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="468403" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="468403" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert12_l12_dp3 -->
<g id="edge2631" class="edge">
<title>router_l12_dp3&#45;&gt;expert12_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.51,-167.23C467552.32,-188.11 467816.15,-209.9 468047.5,-198.98 468151.18,-194.09 468178.44,-198.42 468280,-176.98 468294.63,-173.89 468309.96,-169.65 468324.63,-165.05"/>
<polygon fill="black" stroke="black" points="468325.71,-168.38 468334.16,-161.99 468323.57,-161.71 468325.71,-168.38"/>
<text text-anchor="middle" x="468026" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l12_dp3 -->
<g id="node1572" class="node">
<title>expert13_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="468270.5,-161.98 468041.5,-161.98 468041.5,-109.98 468270.5,-109.98 468270.5,-161.98"/>
<text text-anchor="middle" x="468156" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L12</text>
<text text-anchor="middle" x="468156" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="468156" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="468156" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert13_l12_dp3 -->
<g id="edge2632" class="edge">
<title>router_l12_dp3&#45;&gt;expert13_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467364.39,-177.03C467547.72,-202.12 467808.99,-221.68 468033,-176.98 468047.85,-174.02 468063.38,-169.78 468078.22,-165.15"/>
<polygon fill="black" stroke="black" points="468079.41,-168.44 468087.86,-162.05 468077.27,-161.78 468079.41,-168.44"/>
<text text-anchor="middle" x="467707" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l12_dp3 -->
<g id="node1573" class="node">
<title>expert14_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="468023.5,-161.98 467794.5,-161.98 467794.5,-109.98 468023.5,-109.98 468023.5,-161.98"/>
<text text-anchor="middle" x="467909" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L12</text>
<text text-anchor="middle" x="467909" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="467909" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="467909" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert14_l12_dp3 -->
<g id="edge2633" class="edge">
<title>router_l12_dp3&#45;&gt;expert14_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467367.9,-167.33C467478.65,-180.34 467612.61,-193.64 467733.5,-198.98 467752.59,-199.83 467757.86,-203.19 467776.5,-198.98 467804.7,-192.62 467833.94,-179.52 467857.75,-166.9"/>
<polygon fill="black" stroke="black" points="467859.48,-169.94 467866.6,-162.1 467856.14,-163.79 467859.48,-169.94"/>
<text text-anchor="middle" x="467755" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l12_dp3 -->
<g id="node1574" class="node">
<title>expert15_l12_dp3</title>
<polygon fill="lightgreen" stroke="black" points="467722.5,-161.98 467493.5,-161.98 467493.5,-109.98 467722.5,-109.98 467722.5,-161.98"/>
<text text-anchor="middle" x="467608" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L12</text>
<text text-anchor="middle" x="467608" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="467608" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="467608" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l12_dp3&#45;&gt;expert15_l12_dp3 -->
<g id="edge2634" class="edge">
<title>router_l12_dp3&#45;&gt;expert15_l12_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M467329.04,-135.98C467381.11,-135.98 467435.87,-135.98 467482.95,-135.98"/>
<polygon fill="black" stroke="black" points="467483.18,-139.48 467493.18,-135.98 467483.18,-132.48 467483.18,-139.48"/>
<text text-anchor="middle" x="467436.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l12_dp3 -->
<g id="node1575" class="node">
<title>expert_agg_l12_dp3</title>
<polygon fill="lightyellow" stroke="black" points="472012.57,-176.98 471618.74,-176.98 471517.43,-94.98 471911.26,-94.98 472012.57,-176.98"/>
<text text-anchor="middle" x="471765" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L12</text>
<text text-anchor="middle" x="471765" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="471765" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2635" class="edge">
<title>expert0_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M471481.66,-135.98C471507.06,-135.98 471532.47,-135.98 471557.87,-135.98"/>
<polygon fill="black" stroke="black" points="471557.99,-139.48 471567.99,-135.98 471557.99,-132.48 471557.99,-139.48"/>
</g>
<!-- expert1_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2636" class="edge">
<title>expert1_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M471175.68,-162.02C471199.02,-171.58 471226.79,-181.22 471253,-185.98 471303.07,-195.08 471431.3,-190.43 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert2_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2637" class="edge">
<title>expert2_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M470928.68,-162.02C470952.02,-171.58 470979.79,-181.22 471006,-185.98 471058.03,-195.44 471429.31,-190.6 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert3_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2638" class="edge">
<title>expert3_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M470681.68,-162.02C470705.02,-171.58 470732.79,-181.22 470759,-185.98 470838.04,-200.35 471401.97,-193 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert4_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2639" class="edge">
<title>expert4_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M470434.68,-162.02C470458.02,-171.58 470485.79,-181.22 470512,-185.98 470565.02,-195.62 471428.32,-190.69 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert5_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2640" class="edge">
<title>expert5_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M470187.68,-162.02C470211.02,-171.58 470238.79,-181.22 470265,-185.98 470331.52,-198.07 471414.65,-191.89 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert6_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2641" class="edge">
<title>expert6_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M469940.68,-162.02C469964.02,-171.58 469991.79,-181.22 470018,-185.98 470098.02,-200.53 471400.98,-193.09 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert7_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2642" class="edge">
<title>expert7_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M469693.68,-162.02C469717.02,-171.58 469744.79,-181.22 469771,-185.98 469817.76,-194.48 471434.65,-190.13 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert8_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2643" class="edge">
<title>expert8_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M469446.68,-162.02C469470.02,-171.58 469497.79,-181.22 469524,-185.98 469577.51,-195.71 471427.82,-190.73 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert9_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2644" class="edge">
<title>expert9_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M469199.68,-162.02C469223.02,-171.58 469250.79,-181.22 469277,-185.98 469337.26,-196.94 471420.98,-191.33 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert10_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2645" class="edge">
<title>expert10_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M468952.68,-162.02C468976.02,-171.58 469003.79,-181.22 469030,-185.98 469097.01,-198.16 471414.15,-191.93 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert11_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2646" class="edge">
<title>expert11_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M468705.68,-162.02C468729.02,-171.58 468756.79,-181.22 468783,-185.98 468856.76,-199.39 471407.31,-192.53 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert12_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2647" class="edge">
<title>expert12_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M468458.68,-162.02C468482.02,-171.58 468509.79,-181.22 468536,-185.98 468616.51,-200.62 471400.48,-193.13 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert13_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2648" class="edge">
<title>expert13_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M468211.68,-162.02C468235.02,-171.58 468262.79,-181.22 468289,-185.98 468332.63,-193.91 471437.82,-189.86 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert14_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2649" class="edge">
<title>expert14_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M467964.68,-162.02C467988.02,-171.58 468015.79,-181.22 468042,-185.98 468089.01,-194.53 471434.4,-190.15 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- expert15_l12_dp3&#45;&gt;expert_agg_l12_dp3 -->
<g id="edge2650" class="edge">
<title>expert15_l12_dp3&#45;&gt;expert_agg_l12_dp3</title>
<path fill="none" stroke="black" d="M467687.15,-162.05C467720.11,-171.62 467759.01,-181.25 467795,-185.98 467896.54,-199.32 471379.97,-194.93 471482,-185.98 471519.75,-182.67 471560.02,-176.93 471597.98,-170.48"/>
<polygon fill="black" stroke="black" points="471598.84,-173.88 471608.1,-168.73 471597.65,-166.98 471598.84,-173.88"/>
</g>
<!-- layer12_output_dp3 -->
<g id="node1576" class="node">
<title>layer12_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="472217" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="472217" y="-144.48" font-family="Arial" font-size="10.00">Layer 12 Output</text>
<text text-anchor="middle" x="472217" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="472217" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l12_dp3&#45;&gt;layer12_output_dp3 -->
<g id="edge2651" class="edge">
<title>expert_agg_l12_dp3&#45;&gt;layer12_output_dp3</title>
<path fill="none" stroke="black" d="M471962.31,-135.98C471987.49,-135.98 472012.66,-135.98 472037.84,-135.98"/>
<polygon fill="black" stroke="black" points="472037.87,-139.48 472047.87,-135.98 472037.87,-132.48 472037.87,-139.48"/>
</g>
<!-- attn_input_l13_dp3 -->
<g id="node1577" class="node">
<title>attn_input_l13_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="472590" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="472590" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L13</text>
<text text-anchor="middle" x="472590" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="472590" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer12_output_dp3&#45;&gt;attn_input_l13_dp3 -->
<g id="edge2652" class="edge">
<title>layer12_output_dp3&#45;&gt;attn_input_l13_dp3</title>
<path fill="none" stroke="black" d="M472386.01,-135.98C472394.23,-135.98 472402.44,-135.98 472410.66,-135.98"/>
<polygon fill="black" stroke="black" points="472410.68,-139.48 472420.68,-135.98 472410.68,-132.48 472410.68,-139.48"/>
</g>
<!-- attn_tp0_l13_dp3 -->
<g id="node1578" class="node">
<title>attn_tp0_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="473888,-161.98 473628,-161.98 473628,-109.98 473888,-109.98 473888,-161.98"/>
<text text-anchor="middle" x="473758" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L13</text>
<text text-anchor="middle" x="473758" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="473758" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="473758" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp3&#45;&gt;attn_tp0_l13_dp3 -->
<g id="edge2653" class="edge">
<title>attn_input_l13_dp3&#45;&gt;attn_tp0_l13_dp3</title>
<path fill="none" stroke="black" d="M472673.52,-161.26C472710.12,-171.09 472753.81,-181.13 472794,-185.98 472839,-191.42 473565.27,-193.33 473610,-185.98 473635.4,-181.81 473662.31,-173.85 473686.12,-165.5"/>
<polygon fill="black" stroke="black" points="473687.55,-168.71 473695.78,-162.03 473685.18,-162.12 473687.55,-168.71"/>
</g>
<!-- attn_tp1_l13_dp3 -->
<g id="node1579" class="node">
<title>attn_tp1_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="473610,-161.98 473350,-161.98 473350,-109.98 473610,-109.98 473610,-161.98"/>
<text text-anchor="middle" x="473480" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L13</text>
<text text-anchor="middle" x="473480" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="473480" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="473480" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp3&#45;&gt;attn_tp1_l13_dp3 -->
<g id="edge2654" class="edge">
<title>attn_input_l13_dp3&#45;&gt;attn_tp1_l13_dp3</title>
<path fill="none" stroke="black" d="M472673.52,-161.26C472710.12,-171.09 472753.81,-181.13 472794,-185.98 472853.35,-193.15 473273.01,-195.68 473332,-185.98 473357.4,-181.81 473384.31,-173.85 473408.12,-165.5"/>
<polygon fill="black" stroke="black" points="473409.55,-168.71 473417.78,-162.03 473407.18,-162.12 473409.55,-168.71"/>
</g>
<!-- attn_tp2_l13_dp3 -->
<g id="node1580" class="node">
<title>attn_tp2_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="473332,-161.98 473072,-161.98 473072,-109.98 473332,-109.98 473332,-161.98"/>
<text text-anchor="middle" x="473202" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L13</text>
<text text-anchor="middle" x="473202" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="473202" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="473202" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp3&#45;&gt;attn_tp2_l13_dp3 -->
<g id="edge2655" class="edge">
<title>attn_input_l13_dp3&#45;&gt;attn_tp2_l13_dp3</title>
<path fill="none" stroke="black" d="M472673.52,-161.26C472710.12,-171.09 472753.81,-181.13 472794,-185.98 472851.36,-192.91 472996.99,-195.35 473054,-185.98 473079.4,-181.81 473106.31,-173.85 473130.12,-165.5"/>
<polygon fill="black" stroke="black" points="473131.55,-168.71 473139.78,-162.03 473129.18,-162.12 473131.55,-168.71"/>
</g>
<!-- attn_tp3_l13_dp3 -->
<g id="node1581" class="node">
<title>attn_tp3_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="473054,-161.98 472794,-161.98 472794,-109.98 473054,-109.98 473054,-161.98"/>
<text text-anchor="middle" x="472924" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L13</text>
<text text-anchor="middle" x="472924" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="472924" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="472924" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l13_dp3&#45;&gt;attn_tp3_l13_dp3 -->
<g id="edge2656" class="edge">
<title>attn_input_l13_dp3&#45;&gt;attn_tp3_l13_dp3</title>
<path fill="none" stroke="black" d="M472759.28,-135.98C472767.35,-135.98 472775.42,-135.98 472783.49,-135.98"/>
<polygon fill="black" stroke="black" points="472783.7,-139.48 472793.7,-135.98 472783.7,-132.48 472783.7,-139.48"/>
</g>
<!-- allreduce_l13_dp3 -->
<g id="node1582" class="node">
<title>allreduce_l13_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="474092" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="474092" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L13</text>
<text text-anchor="middle" x="474092" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="474092" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l13_dp3&#45;&gt;allreduce_l13_dp3 -->
<g id="edge2657" class="edge">
<title>attn_tp0_l13_dp3&#45;&gt;allreduce_l13_dp3</title>
<path fill="none" stroke="black" d="M473888.14,-135.98C473896.35,-135.98 473904.56,-135.98 473912.77,-135.98"/>
<polygon fill="black" stroke="black" points="473912.78,-139.48 473922.78,-135.98 473912.78,-132.48 473912.78,-139.48"/>
</g>
<!-- attn_tp1_l13_dp3&#45;&gt;allreduce_l13_dp3 -->
<g id="edge2658" class="edge">
<title>attn_tp1_l13_dp3&#45;&gt;allreduce_l13_dp3</title>
<path fill="none" stroke="black" d="M473542.22,-162.03C473568.24,-171.59 473599.1,-181.23 473628,-185.98 473685.01,-195.35 473830.64,-192.91 473888,-185.98 473924.57,-181.57 473964.05,-172.85 473998.44,-163.91"/>
<polygon fill="black" stroke="black" points="473999.7,-167.2 474008.47,-161.26 473997.91,-160.43 473999.7,-167.2"/>
</g>
<!-- attn_tp2_l13_dp3&#45;&gt;allreduce_l13_dp3 -->
<g id="edge2659" class="edge">
<title>attn_tp2_l13_dp3&#45;&gt;allreduce_l13_dp3</title>
<path fill="none" stroke="black" d="M473264.22,-162.03C473290.24,-171.59 473321.1,-181.23 473350,-185.98 473408.98,-195.68 473828.65,-193.15 473888,-185.98 473924.57,-181.57 473964.05,-172.85 473998.44,-163.91"/>
<polygon fill="black" stroke="black" points="473999.7,-167.2 474008.47,-161.26 473997.91,-160.43 473999.7,-167.2"/>
</g>
<!-- attn_tp3_l13_dp3&#45;&gt;allreduce_l13_dp3 -->
<g id="edge2660" class="edge">
<title>attn_tp3_l13_dp3&#45;&gt;allreduce_l13_dp3</title>
<path fill="none" stroke="black" d="M472986.22,-162.03C473012.24,-171.59 473043.1,-181.23 473072,-185.98 473116.73,-193.33 473842.99,-191.42 473888,-185.98 473924.57,-181.57 473964.05,-172.85 473998.44,-163.91"/>
<polygon fill="black" stroke="black" points="473999.7,-167.2 474008.47,-161.26 473997.91,-160.43 473999.7,-167.2"/>
</g>
<!-- moe_input_l13_dp3 -->
<g id="node1583" class="node">
<title>moe_input_l13_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="474465" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="474465" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L13</text>
<text text-anchor="middle" x="474465" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="474465" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l13_dp3&#45;&gt;moe_input_l13_dp3 -->
<g id="edge2661" class="edge">
<title>allreduce_l13_dp3&#45;&gt;moe_input_l13_dp3</title>
<path fill="none" stroke="black" d="M474261.01,-135.98C474269.23,-135.98 474277.44,-135.98 474285.66,-135.98"/>
<polygon fill="black" stroke="black" points="474285.68,-139.48 474295.68,-135.98 474285.68,-132.48 474285.68,-139.48"/>
</g>
<!-- router_l13_dp3 -->
<g id="node1584" class="node">
<title>router_l13_dp3</title>
<polygon fill="lightyellow" stroke="black" points="475164.57,-176.98 474770.74,-176.98 474669.43,-94.98 475063.26,-94.98 475164.57,-176.98"/>
<text text-anchor="middle" x="474917" y="-144.48" font-family="Arial" font-size="10.00">Router L13</text>
<text text-anchor="middle" x="474917" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="474917" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l13_dp3&#45;&gt;router_l13_dp3 -->
<g id="edge2662" class="edge">
<title>moe_input_l13_dp3&#45;&gt;router_l13_dp3</title>
<path fill="none" stroke="black" d="M474634.06,-135.98C474659.34,-135.98 474684.63,-135.98 474709.92,-135.98"/>
<polygon fill="black" stroke="black" points="474709.99,-139.48 474719.99,-135.98 474709.99,-132.48 474709.99,-139.48"/>
</g>
<!-- expert0_l13_dp3 -->
<g id="node1585" class="node">
<title>expert0_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="479266.5,-161.98 479037.5,-161.98 479037.5,-109.98 479266.5,-109.98 479266.5,-161.98"/>
<text text-anchor="middle" x="479152" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L13</text>
<text text-anchor="middle" x="479152" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="479152" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="479152" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert0_l13_dp3 -->
<g id="edge2663" class="edge">
<title>router_l13_dp3&#45;&gt;expert0_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475152.13,-166.92C475191.43,-171.04 475231.82,-174.65 475270,-176.98 476037.14,-223.83 477959.93,-196.54 478728.5,-198.98 478862.41,-199.41 478897.85,-204.05 479029,-176.98 479043.74,-173.94 479059.17,-169.69 479073.92,-165.07"/>
<polygon fill="black" stroke="black" points="479075.05,-168.39 479083.5,-161.99 479072.91,-161.72 479075.05,-168.39"/>
<text text-anchor="middle" x="478750" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l13_dp3 -->
<g id="node1586" class="node">
<title>expert1_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="479019.5,-161.98 478790.5,-161.98 478790.5,-109.98 479019.5,-109.98 479019.5,-161.98"/>
<text text-anchor="middle" x="478905" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L13</text>
<text text-anchor="middle" x="478905" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="478905" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="478905" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert1_l13_dp3 -->
<g id="edge2664" class="edge">
<title>router_l13_dp3&#45;&gt;expert1_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475152.13,-166.9C475191.43,-171.03 475231.82,-174.64 475270,-176.98 475971.47,-220.03 477729.71,-196.54 478432.5,-198.98 478588.14,-199.52 478629.36,-207.4 478782,-176.98 478796.85,-174.02 478812.39,-169.79 478827.22,-165.15"/>
<polygon fill="black" stroke="black" points="478828.41,-168.45 478836.86,-162.06 478826.27,-161.78 478828.41,-168.45"/>
<text text-anchor="middle" x="478454" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l13_dp3 -->
<g id="node1587" class="node">
<title>expert2_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="478772.5,-161.98 478543.5,-161.98 478543.5,-109.98 478772.5,-109.98 478772.5,-161.98"/>
<text text-anchor="middle" x="478658" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L13</text>
<text text-anchor="middle" x="478658" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="478658" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="478658" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert2_l13_dp3 -->
<g id="edge2665" class="edge">
<title>router_l13_dp3&#45;&gt;expert2_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475152.14,-166.87C475191.43,-171 475231.82,-174.62 475270,-176.98 475895.16,-215.62 477462.15,-196.54 478088.5,-198.98 478287.18,-199.76 478339.82,-214.14 478535,-176.98 478550.05,-174.12 478565.8,-169.88 478580.81,-165.19"/>
<polygon fill="black" stroke="black" points="478582.1,-168.45 478590.55,-162.06 478579.96,-161.79 478582.1,-168.45"/>
<text text-anchor="middle" x="478110" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l13_dp3 -->
<g id="node1588" class="node">
<title>expert3_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="478525.5,-161.98 478296.5,-161.98 478296.5,-109.98 478525.5,-109.98 478525.5,-161.98"/>
<text text-anchor="middle" x="478411" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L13</text>
<text text-anchor="middle" x="478411" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="478411" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="478411" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert3_l13_dp3 -->
<g id="edge2666" class="edge">
<title>router_l13_dp3&#45;&gt;expert3_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475152.14,-166.82C475191.43,-170.96 475231.82,-174.6 475270,-176.98 475806.86,-210.55 477152.68,-208.88 477690.5,-198.98 477956.19,-194.09 478026.52,-224.37 478288,-176.98 478303.26,-174.22 478319.22,-169.97 478334.39,-165.24"/>
<polygon fill="black" stroke="black" points="478335.79,-168.47 478344.23,-162.07 478333.64,-161.8 478335.79,-168.47"/>
<text text-anchor="middle" x="477669" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l13_dp3 -->
<g id="node1589" class="node">
<title>expert4_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="478278.5,-161.98 478049.5,-161.98 478049.5,-109.98 478278.5,-109.98 478278.5,-161.98"/>
<text text-anchor="middle" x="478164" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L13</text>
<text text-anchor="middle" x="478164" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="478164" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="478164" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert4_l13_dp3 -->
<g id="edge2667" class="edge">
<title>router_l13_dp3&#45;&gt;expert4_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475062.67,-176.99C475101.3,-186.08 475143.21,-194.39 475182.5,-198.98 475201.48,-201.2 475206.39,-199.06 475225.5,-198.98 475538.34,-197.76 477732.39,-228.3 478041,-176.98 478056.81,-174.35 478073.35,-170.01 478088.98,-165.12"/>
<polygon fill="black" stroke="black" points="478090.14,-168.42 478098.58,-162.01 478087.99,-161.76 478090.14,-168.42"/>
<text text-anchor="middle" x="475204" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l13_dp3 -->
<g id="node1590" class="node">
<title>expert5_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="478031.5,-161.98 477802.5,-161.98 477802.5,-109.98 478031.5,-109.98 478031.5,-161.98"/>
<text text-anchor="middle" x="477917" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L13</text>
<text text-anchor="middle" x="477917" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="477917" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="477917" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert5_l13_dp3 -->
<g id="edge2668" class="edge">
<title>router_l13_dp3&#45;&gt;expert5_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475152.15,-166.71C475191.44,-170.86 475231.83,-174.53 475270,-176.98 475665.77,-202.4 476657.96,-204.88 477054.5,-198.98 477383.27,-194.09 477470.25,-234.47 477794,-176.98 477809.36,-174.25 477825.42,-170 477840.68,-165.24"/>
<polygon fill="black" stroke="black" points="477842.12,-168.45 477850.57,-162.05 477839.98,-161.79 477842.12,-168.45"/>
<text text-anchor="middle" x="477033" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l13_dp3 -->
<g id="node1591" class="node">
<title>expert6_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="477784.5,-161.98 477555.5,-161.98 477555.5,-109.98 477784.5,-109.98 477784.5,-161.98"/>
<text text-anchor="middle" x="477670" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L13</text>
<text text-anchor="middle" x="477670" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="477670" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="477670" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert6_l13_dp3 -->
<g id="edge2669" class="edge">
<title>router_l13_dp3&#45;&gt;expert6_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475089.37,-177C475134.98,-186.1 475184.37,-194.39 475230.5,-198.98 475249.52,-200.87 475254.39,-199.08 475273.5,-198.98 475526.12,-197.76 477297.84,-218.65 477547,-176.98 477562.81,-174.34 477579.34,-169.99 477594.97,-165.1"/>
<polygon fill="black" stroke="black" points="477596.14,-168.4 477604.57,-161.99 477593.98,-161.74 477596.14,-168.4"/>
<text text-anchor="middle" x="475252" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l13_dp3 -->
<g id="node1592" class="node">
<title>expert7_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="477537.5,-161.98 477308.5,-161.98 477308.5,-109.98 477537.5,-109.98 477537.5,-161.98"/>
<text text-anchor="middle" x="477423" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L13</text>
<text text-anchor="middle" x="477423" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="477423" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="477423" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert7_l13_dp3 -->
<g id="edge2670" class="edge">
<title>router_l13_dp3&#45;&gt;expert7_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475116.02,-177C475168.62,-186.1 475225.5,-194.4 475278.5,-198.98 475297.54,-200.63 475302.39,-199.09 475321.5,-198.98 475541.34,-197.76 477083.19,-213.4 477300,-176.98 477315.72,-174.34 477332.15,-170.03 477347.7,-165.16"/>
<polygon fill="black" stroke="black" points="477348.81,-168.48 477357.25,-162.07 477346.66,-161.82 477348.81,-168.48"/>
<text text-anchor="middle" x="475300" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l13_dp3 -->
<g id="node1593" class="node">
<title>expert8_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="477290.5,-161.98 477061.5,-161.98 477061.5,-109.98 477290.5,-109.98 477290.5,-161.98"/>
<text text-anchor="middle" x="477176" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L13</text>
<text text-anchor="middle" x="477176" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="477176" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="477176" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert8_l13_dp3 -->
<g id="edge2671" class="edge">
<title>router_l13_dp3&#45;&gt;expert8_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475142.65,-177.01C475202.23,-186.11 475266.61,-194.4 475326.5,-198.98 475345.55,-200.44 475350.39,-199.11 475369.5,-198.98 475556.57,-197.76 476868.54,-208.15 477053,-176.98 477068.71,-174.33 477085.14,-170 477100.69,-165.14"/>
<polygon fill="black" stroke="black" points="477101.81,-168.46 477110.25,-162.05 477099.65,-161.8 477101.81,-168.46"/>
<text text-anchor="middle" x="475348" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l13_dp3 -->
<g id="node1594" class="node">
<title>expert9_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="477043.5,-161.98 476814.5,-161.98 476814.5,-109.98 477043.5,-109.98 477043.5,-161.98"/>
<text text-anchor="middle" x="476929" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L13</text>
<text text-anchor="middle" x="476929" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="476929" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="476929" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert9_l13_dp3 -->
<g id="edge2672" class="edge">
<title>router_l13_dp3&#45;&gt;expert9_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475151.69,-166.32C475191.13,-170.54 475231.68,-174.33 475270,-176.98 475716.37,-207.93 475829.15,-208.27 476276.5,-198.98 476511.98,-194.09 476574.34,-219.53 476806,-176.98 476821.25,-174.18 476837.21,-169.92 476852.38,-165.18"/>
<polygon fill="black" stroke="black" points="476853.78,-168.41 476862.22,-162.01 476851.63,-161.75 476853.78,-168.41"/>
<text text-anchor="middle" x="476255" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l13_dp3 -->
<g id="node1595" class="node">
<title>expert10_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="476796.5,-161.98 476567.5,-161.98 476567.5,-109.98 476796.5,-109.98 476796.5,-161.98"/>
<text text-anchor="middle" x="476682" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L13</text>
<text text-anchor="middle" x="476682" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="476682" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="476682" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert10_l13_dp3 -->
<g id="edge2673" class="edge">
<title>router_l13_dp3&#45;&gt;expert10_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475163.89,-176.28C475231.94,-185.66 475305.91,-194.28 475374.5,-198.98 475505.82,-207.98 476429.27,-199.32 476559,-176.98 476574.47,-174.32 476590.63,-170.07 476605.97,-165.28"/>
<polygon fill="black" stroke="black" points="476607.47,-168.48 476615.91,-162.08 476605.32,-161.82 476607.47,-168.48"/>
<text text-anchor="middle" x="475396" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l13_dp3 -->
<g id="node1596" class="node">
<title>expert11_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="476549.5,-161.98 476320.5,-161.98 476320.5,-109.98 476549.5,-109.98 476549.5,-161.98"/>
<text text-anchor="middle" x="476435" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L13</text>
<text text-anchor="middle" x="476435" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="476435" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="476435" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert11_l13_dp3 -->
<g id="edge2674" class="edge">
<title>router_l13_dp3&#45;&gt;expert11_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475159.08,-172.34C475242.36,-183.2 475336.33,-193.63 475422.5,-198.98 475619.85,-211.23 476117.25,-211.19 476312,-176.98 476327.46,-174.27 476343.62,-169.99 476358.96,-165.2"/>
<polygon fill="black" stroke="black" points="476360.46,-168.4 476368.9,-161.99 476358.31,-161.73 476360.46,-168.4"/>
<text text-anchor="middle" x="475444" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l13_dp3 -->
<g id="node1597" class="node">
<title>expert12_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="476302.5,-161.98 476073.5,-161.98 476073.5,-109.98 476302.5,-109.98 476302.5,-161.98"/>
<text text-anchor="middle" x="476188" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L13</text>
<text text-anchor="middle" x="476188" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="476188" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="476188" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert12_l13_dp3 -->
<g id="edge2675" class="edge">
<title>router_l13_dp3&#45;&gt;expert12_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475147.68,-162.99C475188.43,-167.7 475230.46,-172.52 475270,-176.98 475270,-176.98 476065,-176.98 476065,-176.98 476080.26,-174.19 476096.21,-169.94 476111.38,-165.2"/>
<polygon fill="black" stroke="black" points="476112.78,-168.43 476121.23,-162.03 476110.63,-161.77 476112.78,-168.43"/>
<text text-anchor="middle" x="475492" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l13_dp3 -->
<g id="node1598" class="node">
<title>expert13_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="476055.5,-161.98 475826.5,-161.98 475826.5,-109.98 476055.5,-109.98 476055.5,-161.98"/>
<text text-anchor="middle" x="475941" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L13</text>
<text text-anchor="middle" x="475941" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="475941" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="475941" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert13_l13_dp3 -->
<g id="edge2676" class="edge">
<title>router_l13_dp3&#45;&gt;expert13_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475154.46,-177.01C475311.78,-198.74 475522.63,-217.47 475708.5,-198.98 475759.76,-193.88 475815.52,-179.11 475859.59,-165.14"/>
<polygon fill="black" stroke="black" points="475860.93,-168.39 475869.37,-161.99 475858.78,-161.72 475860.93,-168.39"/>
<text text-anchor="middle" x="475687" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l13_dp3 -->
<g id="node1599" class="node">
<title>expert14_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="475808.5,-161.98 475579.5,-161.98 475579.5,-109.98 475808.5,-109.98 475808.5,-161.98"/>
<text text-anchor="middle" x="475694" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L13</text>
<text text-anchor="middle" x="475694" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="475694" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="475694" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert14_l13_dp3 -->
<g id="edge2677" class="edge">
<title>router_l13_dp3&#45;&gt;expert14_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475152.9,-167.33C475263.65,-180.34 475397.61,-193.64 475518.5,-198.98 475537.59,-199.83 475542.86,-203.19 475561.5,-198.98 475589.7,-192.62 475618.94,-179.52 475642.75,-166.9"/>
<polygon fill="black" stroke="black" points="475644.48,-169.94 475651.6,-162.1 475641.14,-163.79 475644.48,-169.94"/>
<text text-anchor="middle" x="475540" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l13_dp3 -->
<g id="node1600" class="node">
<title>expert15_l13_dp3</title>
<polygon fill="lightgreen" stroke="black" points="475507.5,-161.98 475278.5,-161.98 475278.5,-109.98 475507.5,-109.98 475507.5,-161.98"/>
<text text-anchor="middle" x="475393" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L13</text>
<text text-anchor="middle" x="475393" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="475393" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="475393" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l13_dp3&#45;&gt;expert15_l13_dp3 -->
<g id="edge2678" class="edge">
<title>router_l13_dp3&#45;&gt;expert15_l13_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M475114.04,-135.98C475166.11,-135.98 475220.87,-135.98 475267.95,-135.98"/>
<polygon fill="black" stroke="black" points="475268.18,-139.48 475278.18,-135.98 475268.18,-132.48 475268.18,-139.48"/>
<text text-anchor="middle" x="475221.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l13_dp3 -->
<g id="node1601" class="node">
<title>expert_agg_l13_dp3</title>
<polygon fill="lightyellow" stroke="black" points="479797.57,-176.98 479403.74,-176.98 479302.43,-94.98 479696.26,-94.98 479797.57,-176.98"/>
<text text-anchor="middle" x="479550" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L13</text>
<text text-anchor="middle" x="479550" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="479550" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2679" class="edge">
<title>expert0_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M479266.66,-135.98C479292.06,-135.98 479317.47,-135.98 479342.87,-135.98"/>
<polygon fill="black" stroke="black" points="479342.99,-139.48 479352.99,-135.98 479342.99,-132.48 479342.99,-139.48"/>
</g>
<!-- expert1_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2680" class="edge">
<title>expert1_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M478960.68,-162.02C478984.02,-171.58 479011.79,-181.22 479038,-185.98 479088.07,-195.08 479216.3,-190.43 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert2_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2681" class="edge">
<title>expert2_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M478713.68,-162.02C478737.02,-171.58 478764.79,-181.22 478791,-185.98 478843.03,-195.44 479214.31,-190.6 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert3_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2682" class="edge">
<title>expert3_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M478466.68,-162.02C478490.02,-171.58 478517.79,-181.22 478544,-185.98 478623.04,-200.35 479186.97,-193 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert4_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2683" class="edge">
<title>expert4_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M478219.68,-162.02C478243.02,-171.58 478270.79,-181.22 478297,-185.98 478350.02,-195.62 479213.32,-190.69 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert5_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2684" class="edge">
<title>expert5_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M477972.68,-162.02C477996.02,-171.58 478023.79,-181.22 478050,-185.98 478116.52,-198.07 479199.65,-191.89 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert6_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2685" class="edge">
<title>expert6_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M477725.68,-162.02C477749.02,-171.58 477776.79,-181.22 477803,-185.98 477883.02,-200.53 479185.98,-193.09 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert7_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2686" class="edge">
<title>expert7_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M477478.68,-162.02C477502.02,-171.58 477529.79,-181.22 477556,-185.98 477602.76,-194.48 479219.65,-190.13 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert8_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2687" class="edge">
<title>expert8_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M477231.68,-162.02C477255.02,-171.58 477282.79,-181.22 477309,-185.98 477362.51,-195.71 479212.82,-190.73 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert9_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2688" class="edge">
<title>expert9_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M476984.68,-162.02C477008.02,-171.58 477035.79,-181.22 477062,-185.98 477122.26,-196.94 479205.98,-191.33 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert10_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2689" class="edge">
<title>expert10_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M476737.68,-162.02C476761.02,-171.58 476788.79,-181.22 476815,-185.98 476882.01,-198.16 479199.15,-191.93 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert11_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2690" class="edge">
<title>expert11_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M476490.68,-162.02C476514.02,-171.58 476541.79,-181.22 476568,-185.98 476641.76,-199.39 479192.31,-192.53 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert12_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2691" class="edge">
<title>expert12_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M476243.68,-162.02C476267.02,-171.58 476294.79,-181.22 476321,-185.98 476401.51,-200.62 479185.48,-193.13 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert13_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2692" class="edge">
<title>expert13_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M475996.68,-162.02C476020.02,-171.58 476047.79,-181.22 476074,-185.98 476117.63,-193.91 479222.82,-189.86 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert14_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2693" class="edge">
<title>expert14_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M475749.68,-162.02C475773.02,-171.58 475800.79,-181.22 475827,-185.98 475874.01,-194.53 479219.4,-190.15 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- expert15_l13_dp3&#45;&gt;expert_agg_l13_dp3 -->
<g id="edge2694" class="edge">
<title>expert15_l13_dp3&#45;&gt;expert_agg_l13_dp3</title>
<path fill="none" stroke="black" d="M475472.15,-162.05C475505.11,-171.62 475544.01,-181.25 475580,-185.98 475681.54,-199.32 479164.97,-194.93 479267,-185.98 479304.75,-182.67 479345.02,-176.93 479382.98,-170.48"/>
<polygon fill="black" stroke="black" points="479383.84,-173.88 479393.1,-168.73 479382.65,-166.98 479383.84,-173.88"/>
</g>
<!-- layer13_output_dp3 -->
<g id="node1602" class="node">
<title>layer13_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="480002" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="480002" y="-144.48" font-family="Arial" font-size="10.00">Layer 13 Output</text>
<text text-anchor="middle" x="480002" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="480002" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l13_dp3&#45;&gt;layer13_output_dp3 -->
<g id="edge2695" class="edge">
<title>expert_agg_l13_dp3&#45;&gt;layer13_output_dp3</title>
<path fill="none" stroke="black" d="M479747.31,-135.98C479772.49,-135.98 479797.66,-135.98 479822.84,-135.98"/>
<polygon fill="black" stroke="black" points="479822.87,-139.48 479832.87,-135.98 479822.87,-132.48 479822.87,-139.48"/>
</g>
<!-- attn_input_l14_dp3 -->
<g id="node1603" class="node">
<title>attn_input_l14_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="480375" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="480375" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L14</text>
<text text-anchor="middle" x="480375" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="480375" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer13_output_dp3&#45;&gt;attn_input_l14_dp3 -->
<g id="edge2696" class="edge">
<title>layer13_output_dp3&#45;&gt;attn_input_l14_dp3</title>
<path fill="none" stroke="black" d="M480171.01,-135.98C480179.23,-135.98 480187.44,-135.98 480195.66,-135.98"/>
<polygon fill="black" stroke="black" points="480195.68,-139.48 480205.68,-135.98 480195.68,-132.48 480195.68,-139.48"/>
</g>
<!-- attn_tp0_l14_dp3 -->
<g id="node1604" class="node">
<title>attn_tp0_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="481673,-161.98 481413,-161.98 481413,-109.98 481673,-109.98 481673,-161.98"/>
<text text-anchor="middle" x="481543" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L14</text>
<text text-anchor="middle" x="481543" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="481543" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="481543" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp3&#45;&gt;attn_tp0_l14_dp3 -->
<g id="edge2697" class="edge">
<title>attn_input_l14_dp3&#45;&gt;attn_tp0_l14_dp3</title>
<path fill="none" stroke="black" d="M480458.52,-161.26C480495.12,-171.09 480538.81,-181.13 480579,-185.98 480624,-191.42 481350.27,-193.33 481395,-185.98 481420.4,-181.81 481447.31,-173.85 481471.12,-165.5"/>
<polygon fill="black" stroke="black" points="481472.55,-168.71 481480.78,-162.03 481470.18,-162.12 481472.55,-168.71"/>
</g>
<!-- attn_tp1_l14_dp3 -->
<g id="node1605" class="node">
<title>attn_tp1_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="481395,-161.98 481135,-161.98 481135,-109.98 481395,-109.98 481395,-161.98"/>
<text text-anchor="middle" x="481265" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L14</text>
<text text-anchor="middle" x="481265" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="481265" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="481265" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp3&#45;&gt;attn_tp1_l14_dp3 -->
<g id="edge2698" class="edge">
<title>attn_input_l14_dp3&#45;&gt;attn_tp1_l14_dp3</title>
<path fill="none" stroke="black" d="M480458.52,-161.26C480495.12,-171.09 480538.81,-181.13 480579,-185.98 480638.35,-193.15 481058.01,-195.68 481117,-185.98 481142.4,-181.81 481169.31,-173.85 481193.12,-165.5"/>
<polygon fill="black" stroke="black" points="481194.55,-168.71 481202.78,-162.03 481192.18,-162.12 481194.55,-168.71"/>
</g>
<!-- attn_tp2_l14_dp3 -->
<g id="node1606" class="node">
<title>attn_tp2_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="481117,-161.98 480857,-161.98 480857,-109.98 481117,-109.98 481117,-161.98"/>
<text text-anchor="middle" x="480987" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L14</text>
<text text-anchor="middle" x="480987" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="480987" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="480987" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp3&#45;&gt;attn_tp2_l14_dp3 -->
<g id="edge2699" class="edge">
<title>attn_input_l14_dp3&#45;&gt;attn_tp2_l14_dp3</title>
<path fill="none" stroke="black" d="M480458.52,-161.26C480495.12,-171.09 480538.81,-181.13 480579,-185.98 480636.36,-192.91 480781.99,-195.35 480839,-185.98 480864.4,-181.81 480891.31,-173.85 480915.12,-165.5"/>
<polygon fill="black" stroke="black" points="480916.55,-168.71 480924.78,-162.03 480914.18,-162.12 480916.55,-168.71"/>
</g>
<!-- attn_tp3_l14_dp3 -->
<g id="node1607" class="node">
<title>attn_tp3_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="480839,-161.98 480579,-161.98 480579,-109.98 480839,-109.98 480839,-161.98"/>
<text text-anchor="middle" x="480709" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L14</text>
<text text-anchor="middle" x="480709" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="480709" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="480709" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l14_dp3&#45;&gt;attn_tp3_l14_dp3 -->
<g id="edge2700" class="edge">
<title>attn_input_l14_dp3&#45;&gt;attn_tp3_l14_dp3</title>
<path fill="none" stroke="black" d="M480544.28,-135.98C480552.35,-135.98 480560.42,-135.98 480568.49,-135.98"/>
<polygon fill="black" stroke="black" points="480568.7,-139.48 480578.7,-135.98 480568.7,-132.48 480568.7,-139.48"/>
</g>
<!-- allreduce_l14_dp3 -->
<g id="node1608" class="node">
<title>allreduce_l14_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="481877" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="481877" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L14</text>
<text text-anchor="middle" x="481877" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="481877" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l14_dp3&#45;&gt;allreduce_l14_dp3 -->
<g id="edge2701" class="edge">
<title>attn_tp0_l14_dp3&#45;&gt;allreduce_l14_dp3</title>
<path fill="none" stroke="black" d="M481673.14,-135.98C481681.35,-135.98 481689.56,-135.98 481697.77,-135.98"/>
<polygon fill="black" stroke="black" points="481697.78,-139.48 481707.78,-135.98 481697.78,-132.48 481697.78,-139.48"/>
</g>
<!-- attn_tp1_l14_dp3&#45;&gt;allreduce_l14_dp3 -->
<g id="edge2702" class="edge">
<title>attn_tp1_l14_dp3&#45;&gt;allreduce_l14_dp3</title>
<path fill="none" stroke="black" d="M481327.22,-162.03C481353.24,-171.59 481384.1,-181.23 481413,-185.98 481470.01,-195.35 481615.64,-192.91 481673,-185.98 481709.57,-181.57 481749.05,-172.85 481783.44,-163.91"/>
<polygon fill="black" stroke="black" points="481784.7,-167.2 481793.47,-161.26 481782.91,-160.43 481784.7,-167.2"/>
</g>
<!-- attn_tp2_l14_dp3&#45;&gt;allreduce_l14_dp3 -->
<g id="edge2703" class="edge">
<title>attn_tp2_l14_dp3&#45;&gt;allreduce_l14_dp3</title>
<path fill="none" stroke="black" d="M481049.22,-162.03C481075.24,-171.59 481106.1,-181.23 481135,-185.98 481193.98,-195.68 481613.65,-193.15 481673,-185.98 481709.57,-181.57 481749.05,-172.85 481783.44,-163.91"/>
<polygon fill="black" stroke="black" points="481784.7,-167.2 481793.47,-161.26 481782.91,-160.43 481784.7,-167.2"/>
</g>
<!-- attn_tp3_l14_dp3&#45;&gt;allreduce_l14_dp3 -->
<g id="edge2704" class="edge">
<title>attn_tp3_l14_dp3&#45;&gt;allreduce_l14_dp3</title>
<path fill="none" stroke="black" d="M480771.22,-162.03C480797.24,-171.59 480828.1,-181.23 480857,-185.98 480901.73,-193.33 481627.99,-191.42 481673,-185.98 481709.57,-181.57 481749.05,-172.85 481783.44,-163.91"/>
<polygon fill="black" stroke="black" points="481784.7,-167.2 481793.47,-161.26 481782.91,-160.43 481784.7,-167.2"/>
</g>
<!-- moe_input_l14_dp3 -->
<g id="node1609" class="node">
<title>moe_input_l14_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="482250" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="482250" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L14</text>
<text text-anchor="middle" x="482250" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="482250" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l14_dp3&#45;&gt;moe_input_l14_dp3 -->
<g id="edge2705" class="edge">
<title>allreduce_l14_dp3&#45;&gt;moe_input_l14_dp3</title>
<path fill="none" stroke="black" d="M482046.01,-135.98C482054.23,-135.98 482062.44,-135.98 482070.66,-135.98"/>
<polygon fill="black" stroke="black" points="482070.68,-139.48 482080.68,-135.98 482070.68,-132.48 482070.68,-139.48"/>
</g>
<!-- router_l14_dp3 -->
<g id="node1610" class="node">
<title>router_l14_dp3</title>
<polygon fill="lightyellow" stroke="black" points="482949.57,-176.98 482555.74,-176.98 482454.43,-94.98 482848.26,-94.98 482949.57,-176.98"/>
<text text-anchor="middle" x="482702" y="-144.48" font-family="Arial" font-size="10.00">Router L14</text>
<text text-anchor="middle" x="482702" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="482702" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l14_dp3&#45;&gt;router_l14_dp3 -->
<g id="edge2706" class="edge">
<title>moe_input_l14_dp3&#45;&gt;router_l14_dp3</title>
<path fill="none" stroke="black" d="M482419.06,-135.98C482444.34,-135.98 482469.63,-135.98 482494.92,-135.98"/>
<polygon fill="black" stroke="black" points="482494.99,-139.48 482504.99,-135.98 482494.99,-132.48 482494.99,-139.48"/>
</g>
<!-- expert0_l14_dp3 -->
<g id="node1611" class="node">
<title>expert0_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="487147.5,-161.98 486918.5,-161.98 486918.5,-109.98 487147.5,-109.98 487147.5,-161.98"/>
<text text-anchor="middle" x="487033" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L14</text>
<text text-anchor="middle" x="487033" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="487033" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="487033" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert0_l14_dp3 -->
<g id="edge2707" class="edge">
<title>router_l14_dp3&#45;&gt;expert0_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482932.84,-163.39C482988.47,-168.94 483047.79,-173.99 483103,-176.98 483857.35,-217.89 485747.04,-196.54 486502.5,-198.98 486683.87,-199.57 486731.92,-211.42 486910,-176.98 486925.05,-174.07 486940.79,-169.81 486955.79,-165.12"/>
<polygon fill="black" stroke="black" points="486957.09,-168.38 486965.53,-161.99 486954.94,-161.72 486957.09,-168.38"/>
<text text-anchor="middle" x="486524" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l14_dp3 -->
<g id="node1612" class="node">
<title>expert1_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="486900.5,-161.98 486671.5,-161.98 486671.5,-109.98 486900.5,-109.98 486900.5,-161.98"/>
<text text-anchor="middle" x="486786" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L14</text>
<text text-anchor="middle" x="486786" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="486786" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="486786" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert1_l14_dp3 -->
<g id="edge2708" class="edge">
<title>router_l14_dp3&#45;&gt;expert1_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482932.84,-163.35C482988.48,-168.91 483047.8,-173.96 483103,-176.98 483767.91,-213.33 485433.6,-196.54 486099.5,-198.98 486350.13,-199.9 486416.5,-222.35 486663,-176.98 486678.25,-174.18 486694.21,-169.91 486709.38,-165.17"/>
<polygon fill="black" stroke="black" points="486710.77,-168.4 486719.22,-162 486708.63,-161.74 486710.77,-168.4"/>
<text text-anchor="middle" x="486121" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l14_dp3 -->
<g id="node1613" class="node">
<title>expert2_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="486653.5,-161.98 486424.5,-161.98 486424.5,-109.98 486653.5,-109.98 486653.5,-161.98"/>
<text text-anchor="middle" x="486539" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L14</text>
<text text-anchor="middle" x="486539" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="486539" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="486539" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert2_l14_dp3 -->
<g id="edge2709" class="edge">
<title>router_l14_dp3&#45;&gt;expert2_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482932.84,-163.28C482988.48,-168.84 483047.8,-173.92 483103,-176.98 483653.39,-207.54 485032.3,-206.26 485583.5,-198.98 485768.55,-196.54 486233.73,-209.04 486416,-176.98 486431.46,-174.26 486447.62,-169.99 486462.95,-165.2"/>
<polygon fill="black" stroke="black" points="486464.46,-168.39 486472.9,-161.99 486462.31,-161.73 486464.46,-168.39"/>
<text text-anchor="middle" x="485562" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l14_dp3 -->
<g id="node1614" class="node">
<title>expert3_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="486406.5,-161.98 486177.5,-161.98 486177.5,-109.98 486406.5,-109.98 486406.5,-161.98"/>
<text text-anchor="middle" x="486292" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L14</text>
<text text-anchor="middle" x="486292" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="486292" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="486292" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert3_l14_dp3 -->
<g id="edge2710" class="edge">
<title>router_l14_dp3&#45;&gt;expert3_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482847.67,-176.99C482886.3,-186.08 482928.21,-194.39 482967.5,-198.98 482986.48,-201.2 482991.39,-199.05 483010.5,-198.98 483361.45,-197.76 485822.78,-234.41 486169,-176.98 486184.81,-174.36 486201.35,-170.02 486216.98,-165.13"/>
<polygon fill="black" stroke="black" points="486218.14,-168.43 486226.58,-162.02 486215.99,-161.77 486218.14,-168.43"/>
<text text-anchor="middle" x="482989" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l14_dp3 -->
<g id="node1615" class="node">
<title>expert4_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="486159.5,-161.98 485930.5,-161.98 485930.5,-109.98 486159.5,-109.98 486159.5,-161.98"/>
<text text-anchor="middle" x="486045" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L14</text>
<text text-anchor="middle" x="486045" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="486045" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="486045" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert4_l14_dp3 -->
<g id="edge2711" class="edge">
<title>router_l14_dp3&#45;&gt;expert4_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482874.37,-177C482919.98,-186.1 482969.37,-194.39 483015.5,-198.98 483034.52,-200.87 483039.39,-199.06 483058.5,-198.98 483376.67,-197.76 485608.13,-229.15 485922,-176.98 485937.81,-174.35 485954.35,-170.01 485969.98,-165.12"/>
<polygon fill="black" stroke="black" points="485971.14,-168.42 485979.58,-162.01 485968.99,-161.76 485971.14,-168.42"/>
<text text-anchor="middle" x="483037" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l14_dp3 -->
<g id="node1616" class="node">
<title>expert5_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="485912.5,-161.98 485683.5,-161.98 485683.5,-109.98 485912.5,-109.98 485912.5,-161.98"/>
<text text-anchor="middle" x="485798" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L14</text>
<text text-anchor="middle" x="485798" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="485798" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="485798" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert5_l14_dp3 -->
<g id="edge2712" class="edge">
<title>router_l14_dp3&#45;&gt;expert5_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482901.02,-177C482953.62,-186.1 483010.5,-194.4 483063.5,-198.98 483082.54,-200.63 483087.39,-199.06 483106.5,-198.98 483391.9,-197.76 485393.48,-223.9 485675,-176.98 485690.81,-174.35 485707.35,-170 485722.98,-165.11"/>
<polygon fill="black" stroke="black" points="485724.14,-168.41 485732.58,-162 485721.98,-161.75 485724.14,-168.41"/>
<text text-anchor="middle" x="483085" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l14_dp3 -->
<g id="node1617" class="node">
<title>expert6_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="485665.5,-161.98 485436.5,-161.98 485436.5,-109.98 485665.5,-109.98 485665.5,-161.98"/>
<text text-anchor="middle" x="485551" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L14</text>
<text text-anchor="middle" x="485551" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="485551" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="485551" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert6_l14_dp3 -->
<g id="edge2713" class="edge">
<title>router_l14_dp3&#45;&gt;expert6_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482932.59,-163.06C482988.3,-168.63 483047.72,-173.78 483103,-176.98 483817.64,-218.45 483997.74,-210 484713.5,-198.98 485031.17,-194.09 485115.22,-232.69 485428,-176.98 485443.36,-174.25 485459.42,-169.99 485474.67,-165.23"/>
<polygon fill="black" stroke="black" points="485476.12,-168.44 485484.57,-162.04 485473.98,-161.78 485476.12,-168.44"/>
<text text-anchor="middle" x="484692" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l14_dp3 -->
<g id="node1618" class="node">
<title>expert7_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="485418.5,-161.98 485189.5,-161.98 485189.5,-109.98 485418.5,-109.98 485418.5,-161.98"/>
<text text-anchor="middle" x="485304" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L14</text>
<text text-anchor="middle" x="485304" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="485304" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="485304" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert7_l14_dp3 -->
<g id="edge2714" class="edge">
<title>router_l14_dp3&#45;&gt;expert7_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482927.65,-177.01C482987.23,-186.11 483051.61,-194.4 483111.5,-198.98 483130.55,-200.44 483135.39,-199.09 483154.5,-198.98 483379.68,-197.76 484958.93,-214.26 485181,-176.98 485196.72,-174.34 485213.15,-170.03 485228.7,-165.17"/>
<polygon fill="black" stroke="black" points="485229.81,-168.48 485238.25,-162.08 485227.66,-161.82 485229.81,-168.48"/>
<text text-anchor="middle" x="483133" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l14_dp3 -->
<g id="node1619" class="node">
<title>expert8_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="485171.5,-161.98 484942.5,-161.98 484942.5,-109.98 485171.5,-109.98 485171.5,-161.98"/>
<text text-anchor="middle" x="485057" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L14</text>
<text text-anchor="middle" x="485057" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="485057" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="485057" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert8_l14_dp3 -->
<g id="edge2715" class="edge">
<title>router_l14_dp3&#45;&gt;expert8_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482948.89,-176.28C483016.94,-185.66 483090.91,-194.28 483159.5,-198.98 483178.56,-200.29 483183.39,-199.1 483202.5,-198.98 483394.9,-197.76 484744.28,-209.01 484934,-176.98 484949.71,-174.33 484966.15,-170.01 484981.69,-165.14"/>
<polygon fill="black" stroke="black" points="484982.81,-168.46 484991.25,-162.05 484980.66,-161.8 484982.81,-168.46"/>
<text text-anchor="middle" x="483181" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l14_dp3 -->
<g id="node1620" class="node">
<title>expert9_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="484924.5,-161.98 484695.5,-161.98 484695.5,-109.98 484924.5,-109.98 484924.5,-161.98"/>
<text text-anchor="middle" x="484810" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L14</text>
<text text-anchor="middle" x="484810" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="484810" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="484810" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert9_l14_dp3 -->
<g id="edge2716" class="edge">
<title>router_l14_dp3&#45;&gt;expert9_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482944.08,-172.34C483027.36,-183.2 483121.33,-193.63 483207.5,-198.98 483371.59,-209.17 484524.92,-204.56 484687,-176.98 484702.71,-174.31 484719.14,-169.98 484734.69,-165.11"/>
<polygon fill="black" stroke="black" points="484735.8,-168.43 484744.24,-162.02 484733.65,-161.77 484735.8,-168.43"/>
<text text-anchor="middle" x="483229" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l14_dp3 -->
<g id="node1621" class="node">
<title>expert10_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="484677.5,-161.98 484448.5,-161.98 484448.5,-109.98 484677.5,-109.98 484677.5,-161.98"/>
<text text-anchor="middle" x="484563" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L14</text>
<text text-anchor="middle" x="484563" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="484563" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="484563" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert10_l14_dp3 -->
<g id="edge2717" class="edge">
<title>router_l14_dp3&#45;&gt;expert10_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482931.83,-162.47C482987.77,-168.09 483047.48,-173.4 483103,-176.98 483483.44,-201.54 483579.36,-207.72 483960.5,-198.98 484173.78,-194.09 484230.26,-215.97 484440,-176.98 484455.16,-174.16 484471.01,-169.92 484486.1,-165.21"/>
<polygon fill="black" stroke="black" points="484487.44,-168.46 484495.89,-162.06 484485.3,-161.79 484487.44,-168.46"/>
<text text-anchor="middle" x="483939" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l14_dp3 -->
<g id="node1622" class="node">
<title>expert11_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="484430.5,-161.98 484201.5,-161.98 484201.5,-109.98 484430.5,-109.98 484430.5,-161.98"/>
<text text-anchor="middle" x="484316" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L14</text>
<text text-anchor="middle" x="484316" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="484316" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="484316" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert11_l14_dp3 -->
<g id="edge2718" class="edge">
<title>router_l14_dp3&#45;&gt;expert11_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482939.88,-169.04C483037.47,-181.04 483151.7,-193.09 483255.5,-198.98 483463.55,-210.79 483987.72,-212.89 484193,-176.98 484208.46,-174.28 484224.62,-170.01 484239.96,-165.22"/>
<polygon fill="black" stroke="black" points="484241.46,-168.41 484249.9,-162.01 484239.31,-161.75 484241.46,-168.41"/>
<text text-anchor="middle" x="483277" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l14_dp3 -->
<g id="node1623" class="node">
<title>expert12_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="484183.5,-161.98 483954.5,-161.98 483954.5,-109.98 484183.5,-109.98 484183.5,-161.98"/>
<text text-anchor="middle" x="484069" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L14</text>
<text text-anchor="middle" x="484069" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="484069" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="484069" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert12_l14_dp3 -->
<g id="edge2719" class="edge">
<title>router_l14_dp3&#45;&gt;expert12_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482936.51,-166.28C483047.54,-179.16 483182.13,-192.64 483303.5,-198.98 483446.17,-206.43 483805.43,-202.45 483946,-176.98 483961.26,-174.22 483977.22,-169.97 483992.39,-165.24"/>
<polygon fill="black" stroke="black" points="483993.79,-168.47 484002.23,-162.07 483991.64,-161.8 483993.79,-168.47"/>
<text text-anchor="middle" x="483325" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l14_dp3 -->
<g id="node1624" class="node">
<title>expert13_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="483936.5,-161.98 483707.5,-161.98 483707.5,-109.98 483936.5,-109.98 483936.5,-161.98"/>
<text text-anchor="middle" x="483822" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L14</text>
<text text-anchor="middle" x="483822" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="483822" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="483822" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert13_l14_dp3 -->
<g id="edge2720" class="edge">
<title>router_l14_dp3&#45;&gt;expert13_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482939.13,-176.99C483142.69,-204.78 483442.89,-228.08 483699,-176.98 483713.85,-174.02 483729.38,-169.78 483744.22,-165.15"/>
<polygon fill="black" stroke="black" points="483745.41,-168.44 483753.86,-162.05 483743.27,-161.78 483745.41,-168.44"/>
<text text-anchor="middle" x="483373" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l14_dp3 -->
<g id="node1625" class="node">
<title>expert14_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="483689.5,-161.98 483460.5,-161.98 483460.5,-109.98 483689.5,-109.98 483689.5,-161.98"/>
<text text-anchor="middle" x="483575" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L14</text>
<text text-anchor="middle" x="483575" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="483575" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="483575" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert14_l14_dp3 -->
<g id="edge2721" class="edge">
<title>router_l14_dp3&#45;&gt;expert14_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482932.52,-162.99C483068.24,-177.35 483243.37,-193.2 483399.5,-198.98 483418.6,-199.69 483423.86,-203.19 483442.5,-198.98 483470.7,-192.62 483499.94,-179.52 483523.75,-166.9"/>
<polygon fill="black" stroke="black" points="483525.48,-169.94 483532.6,-162.1 483522.14,-163.79 483525.48,-169.94"/>
<text text-anchor="middle" x="483421" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l14_dp3 -->
<g id="node1626" class="node">
<title>expert15_l14_dp3</title>
<polygon fill="lightgreen" stroke="black" points="483340.5,-161.98 483111.5,-161.98 483111.5,-109.98 483340.5,-109.98 483340.5,-161.98"/>
<text text-anchor="middle" x="483226" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L14</text>
<text text-anchor="middle" x="483226" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="483226" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="483226" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l14_dp3&#45;&gt;expert15_l14_dp3 -->
<g id="edge2722" class="edge">
<title>router_l14_dp3&#45;&gt;expert15_l14_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M482898.98,-135.98C482966.75,-135.98 483040.72,-135.98 483101.14,-135.98"/>
<polygon fill="black" stroke="black" points="483101.49,-139.48 483111.49,-135.98 483101.49,-132.48 483101.49,-139.48"/>
<text text-anchor="middle" x="483030.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l14_dp3 -->
<g id="node1627" class="node">
<title>expert_agg_l14_dp3</title>
<polygon fill="lightyellow" stroke="black" points="487678.57,-176.98 487284.74,-176.98 487183.43,-94.98 487577.26,-94.98 487678.57,-176.98"/>
<text text-anchor="middle" x="487431" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L14</text>
<text text-anchor="middle" x="487431" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="487431" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2723" class="edge">
<title>expert0_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M487147.66,-135.98C487173.06,-135.98 487198.47,-135.98 487223.87,-135.98"/>
<polygon fill="black" stroke="black" points="487223.99,-139.48 487233.99,-135.98 487223.99,-132.48 487223.99,-139.48"/>
</g>
<!-- expert1_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2724" class="edge">
<title>expert1_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M486841.68,-162.02C486865.02,-171.58 486892.79,-181.22 486919,-185.98 486969.07,-195.08 487097.3,-190.43 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert2_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2725" class="edge">
<title>expert2_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M486594.68,-162.02C486618.02,-171.58 486645.79,-181.22 486672,-185.98 486724.03,-195.44 487095.31,-190.6 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert3_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2726" class="edge">
<title>expert3_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M486347.68,-162.02C486371.02,-171.58 486398.79,-181.22 486425,-185.98 486504.04,-200.35 487067.97,-193 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert4_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2727" class="edge">
<title>expert4_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M486100.68,-162.02C486124.02,-171.58 486151.79,-181.22 486178,-185.98 486231.02,-195.62 487094.32,-190.69 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert5_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2728" class="edge">
<title>expert5_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M485853.68,-162.02C485877.02,-171.58 485904.79,-181.22 485931,-185.98 485997.52,-198.07 487080.65,-191.89 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert6_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2729" class="edge">
<title>expert6_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M485606.68,-162.02C485630.02,-171.58 485657.79,-181.22 485684,-185.98 485764.02,-200.53 487066.98,-193.09 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert7_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2730" class="edge">
<title>expert7_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M485359.68,-162.02C485383.02,-171.58 485410.79,-181.22 485437,-185.98 485483.76,-194.48 487100.65,-190.13 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert8_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2731" class="edge">
<title>expert8_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M485112.68,-162.02C485136.02,-171.58 485163.79,-181.22 485190,-185.98 485243.51,-195.71 487093.82,-190.73 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert9_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2732" class="edge">
<title>expert9_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M484865.68,-162.02C484889.02,-171.58 484916.79,-181.22 484943,-185.98 485003.26,-196.94 487086.98,-191.33 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert10_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2733" class="edge">
<title>expert10_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M484618.68,-162.02C484642.02,-171.58 484669.79,-181.22 484696,-185.98 484763.01,-198.16 487080.15,-191.93 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert11_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2734" class="edge">
<title>expert11_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M484371.68,-162.02C484395.02,-171.58 484422.79,-181.22 484449,-185.98 484522.76,-199.39 487073.31,-192.53 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert12_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2735" class="edge">
<title>expert12_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M484124.68,-162.02C484148.02,-171.58 484175.79,-181.22 484202,-185.98 484282.51,-200.62 487066.48,-193.13 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert13_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2736" class="edge">
<title>expert13_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M483877.68,-162.02C483901.02,-171.58 483928.79,-181.22 483955,-185.98 483998.63,-193.91 487103.82,-189.86 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert14_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2737" class="edge">
<title>expert14_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M483630.68,-162.02C483654.02,-171.58 483681.79,-181.22 483708,-185.98 483755.01,-194.53 487100.4,-190.15 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- expert15_l14_dp3&#45;&gt;expert_agg_l14_dp3 -->
<g id="edge2738" class="edge">
<title>expert15_l14_dp3&#45;&gt;expert_agg_l14_dp3</title>
<path fill="none" stroke="black" d="M483325.6,-162C483367.15,-171.59 483416.09,-181.26 483461,-185.98 483562.85,-196.7 487045.97,-194.93 487148,-185.98 487185.75,-182.67 487226.02,-176.93 487263.98,-170.48"/>
<polygon fill="black" stroke="black" points="487264.84,-173.88 487274.1,-168.73 487263.65,-166.98 487264.84,-173.88"/>
</g>
<!-- layer14_output_dp3 -->
<g id="node1628" class="node">
<title>layer14_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="487883" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="487883" y="-144.48" font-family="Arial" font-size="10.00">Layer 14 Output</text>
<text text-anchor="middle" x="487883" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="487883" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l14_dp3&#45;&gt;layer14_output_dp3 -->
<g id="edge2739" class="edge">
<title>expert_agg_l14_dp3&#45;&gt;layer14_output_dp3</title>
<path fill="none" stroke="black" d="M487628.31,-135.98C487653.49,-135.98 487678.66,-135.98 487703.84,-135.98"/>
<polygon fill="black" stroke="black" points="487703.87,-139.48 487713.87,-135.98 487703.87,-132.48 487703.87,-139.48"/>
</g>
<!-- attn_input_l15_dp3 -->
<g id="node1629" class="node">
<title>attn_input_l15_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="488256" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="488256" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L15</text>
<text text-anchor="middle" x="488256" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="488256" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer14_output_dp3&#45;&gt;attn_input_l15_dp3 -->
<g id="edge2740" class="edge">
<title>layer14_output_dp3&#45;&gt;attn_input_l15_dp3</title>
<path fill="none" stroke="black" d="M488052.01,-135.98C488060.23,-135.98 488068.44,-135.98 488076.66,-135.98"/>
<polygon fill="black" stroke="black" points="488076.68,-139.48 488086.68,-135.98 488076.68,-132.48 488076.68,-139.48"/>
</g>
<!-- attn_tp0_l15_dp3 -->
<g id="node1630" class="node">
<title>attn_tp0_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="489554,-161.98 489294,-161.98 489294,-109.98 489554,-109.98 489554,-161.98"/>
<text text-anchor="middle" x="489424" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L15</text>
<text text-anchor="middle" x="489424" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="489424" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="489424" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp3&#45;&gt;attn_tp0_l15_dp3 -->
<g id="edge2741" class="edge">
<title>attn_input_l15_dp3&#45;&gt;attn_tp0_l15_dp3</title>
<path fill="none" stroke="black" d="M488339.52,-161.26C488376.12,-171.09 488419.81,-181.13 488460,-185.98 488505,-191.42 489231.27,-193.33 489276,-185.98 489301.4,-181.81 489328.31,-173.85 489352.12,-165.5"/>
<polygon fill="black" stroke="black" points="489353.55,-168.71 489361.78,-162.03 489351.18,-162.12 489353.55,-168.71"/>
</g>
<!-- attn_tp1_l15_dp3 -->
<g id="node1631" class="node">
<title>attn_tp1_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="489276,-161.98 489016,-161.98 489016,-109.98 489276,-109.98 489276,-161.98"/>
<text text-anchor="middle" x="489146" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L15</text>
<text text-anchor="middle" x="489146" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="489146" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="489146" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp3&#45;&gt;attn_tp1_l15_dp3 -->
<g id="edge2742" class="edge">
<title>attn_input_l15_dp3&#45;&gt;attn_tp1_l15_dp3</title>
<path fill="none" stroke="black" d="M488339.52,-161.26C488376.12,-171.09 488419.81,-181.13 488460,-185.98 488519.35,-193.15 488939.01,-195.68 488998,-185.98 489023.4,-181.81 489050.31,-173.85 489074.12,-165.5"/>
<polygon fill="black" stroke="black" points="489075.55,-168.71 489083.78,-162.03 489073.18,-162.12 489075.55,-168.71"/>
</g>
<!-- attn_tp2_l15_dp3 -->
<g id="node1632" class="node">
<title>attn_tp2_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="488998,-161.98 488738,-161.98 488738,-109.98 488998,-109.98 488998,-161.98"/>
<text text-anchor="middle" x="488868" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L15</text>
<text text-anchor="middle" x="488868" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="488868" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="488868" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp3&#45;&gt;attn_tp2_l15_dp3 -->
<g id="edge2743" class="edge">
<title>attn_input_l15_dp3&#45;&gt;attn_tp2_l15_dp3</title>
<path fill="none" stroke="black" d="M488339.52,-161.26C488376.12,-171.09 488419.81,-181.13 488460,-185.98 488517.36,-192.91 488662.99,-195.35 488720,-185.98 488745.4,-181.81 488772.31,-173.85 488796.12,-165.5"/>
<polygon fill="black" stroke="black" points="488797.55,-168.71 488805.78,-162.03 488795.18,-162.12 488797.55,-168.71"/>
</g>
<!-- attn_tp3_l15_dp3 -->
<g id="node1633" class="node">
<title>attn_tp3_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="488720,-161.98 488460,-161.98 488460,-109.98 488720,-109.98 488720,-161.98"/>
<text text-anchor="middle" x="488590" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L15</text>
<text text-anchor="middle" x="488590" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="488590" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="488590" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l15_dp3&#45;&gt;attn_tp3_l15_dp3 -->
<g id="edge2744" class="edge">
<title>attn_input_l15_dp3&#45;&gt;attn_tp3_l15_dp3</title>
<path fill="none" stroke="black" d="M488425.28,-135.98C488433.35,-135.98 488441.42,-135.98 488449.49,-135.98"/>
<polygon fill="black" stroke="black" points="488449.7,-139.48 488459.7,-135.98 488449.7,-132.48 488449.7,-139.48"/>
</g>
<!-- allreduce_l15_dp3 -->
<g id="node1634" class="node">
<title>allreduce_l15_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="489758" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="489758" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L15</text>
<text text-anchor="middle" x="489758" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="489758" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l15_dp3&#45;&gt;allreduce_l15_dp3 -->
<g id="edge2745" class="edge">
<title>attn_tp0_l15_dp3&#45;&gt;allreduce_l15_dp3</title>
<path fill="none" stroke="black" d="M489554.14,-135.98C489562.35,-135.98 489570.56,-135.98 489578.77,-135.98"/>
<polygon fill="black" stroke="black" points="489578.78,-139.48 489588.78,-135.98 489578.78,-132.48 489578.78,-139.48"/>
</g>
<!-- attn_tp1_l15_dp3&#45;&gt;allreduce_l15_dp3 -->
<g id="edge2746" class="edge">
<title>attn_tp1_l15_dp3&#45;&gt;allreduce_l15_dp3</title>
<path fill="none" stroke="black" d="M489208.22,-162.03C489234.24,-171.59 489265.1,-181.23 489294,-185.98 489351.01,-195.35 489496.64,-192.91 489554,-185.98 489590.57,-181.57 489630.05,-172.85 489664.44,-163.91"/>
<polygon fill="black" stroke="black" points="489665.7,-167.2 489674.47,-161.26 489663.91,-160.43 489665.7,-167.2"/>
</g>
<!-- attn_tp2_l15_dp3&#45;&gt;allreduce_l15_dp3 -->
<g id="edge2747" class="edge">
<title>attn_tp2_l15_dp3&#45;&gt;allreduce_l15_dp3</title>
<path fill="none" stroke="black" d="M488930.22,-162.03C488956.24,-171.59 488987.1,-181.23 489016,-185.98 489074.98,-195.68 489494.65,-193.15 489554,-185.98 489590.57,-181.57 489630.05,-172.85 489664.44,-163.91"/>
<polygon fill="black" stroke="black" points="489665.7,-167.2 489674.47,-161.26 489663.91,-160.43 489665.7,-167.2"/>
</g>
<!-- attn_tp3_l15_dp3&#45;&gt;allreduce_l15_dp3 -->
<g id="edge2748" class="edge">
<title>attn_tp3_l15_dp3&#45;&gt;allreduce_l15_dp3</title>
<path fill="none" stroke="black" d="M488652.22,-162.03C488678.24,-171.59 488709.1,-181.23 488738,-185.98 488782.73,-193.33 489508.99,-191.42 489554,-185.98 489590.57,-181.57 489630.05,-172.85 489664.44,-163.91"/>
<polygon fill="black" stroke="black" points="489665.7,-167.2 489674.47,-161.26 489663.91,-160.43 489665.7,-167.2"/>
</g>
<!-- moe_input_l15_dp3 -->
<g id="node1635" class="node">
<title>moe_input_l15_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="490131" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="490131" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L15</text>
<text text-anchor="middle" x="490131" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="490131" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l15_dp3&#45;&gt;moe_input_l15_dp3 -->
<g id="edge2749" class="edge">
<title>allreduce_l15_dp3&#45;&gt;moe_input_l15_dp3</title>
<path fill="none" stroke="black" d="M489927.01,-135.98C489935.23,-135.98 489943.44,-135.98 489951.66,-135.98"/>
<polygon fill="black" stroke="black" points="489951.68,-139.48 489961.68,-135.98 489951.68,-132.48 489951.68,-139.48"/>
</g>
<!-- router_l15_dp3 -->
<g id="node1636" class="node">
<title>router_l15_dp3</title>
<polygon fill="lightyellow" stroke="black" points="490830.57,-176.98 490436.74,-176.98 490335.43,-94.98 490729.26,-94.98 490830.57,-176.98"/>
<text text-anchor="middle" x="490583" y="-144.48" font-family="Arial" font-size="10.00">Router L15</text>
<text text-anchor="middle" x="490583" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="490583" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l15_dp3&#45;&gt;router_l15_dp3 -->
<g id="edge2750" class="edge">
<title>moe_input_l15_dp3&#45;&gt;router_l15_dp3</title>
<path fill="none" stroke="black" d="M490300.06,-135.98C490325.34,-135.98 490350.63,-135.98 490375.92,-135.98"/>
<polygon fill="black" stroke="black" points="490375.99,-139.48 490385.99,-135.98 490375.99,-132.48 490375.99,-139.48"/>
</g>
<!-- expert0_l15_dp3 -->
<g id="node1637" class="node">
<title>expert0_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="495028.5,-161.98 494799.5,-161.98 494799.5,-109.98 495028.5,-109.98 495028.5,-161.98"/>
<text text-anchor="middle" x="494914" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L15</text>
<text text-anchor="middle" x="494914" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="494914" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="494914" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert0_l15_dp3 -->
<g id="edge2751" class="edge">
<title>router_l15_dp3&#45;&gt;expert0_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490813.84,-163.37C490869.48,-168.93 490928.8,-173.98 490984,-176.98 491702.4,-216.06 493502.04,-196.54 494221.5,-198.98 494474.8,-199.84 494541.87,-222.77 494791,-176.98 494806.25,-174.18 494822.21,-169.91 494837.38,-165.18"/>
<polygon fill="black" stroke="black" points="494838.78,-168.41 494847.22,-162.01 494836.63,-161.74 494838.78,-168.41"/>
<text text-anchor="middle" x="494243" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l15_dp3 -->
<g id="node1638" class="node">
<title>expert1_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="494781.5,-161.98 494552.5,-161.98 494552.5,-109.98 494781.5,-109.98 494781.5,-161.98"/>
<text text-anchor="middle" x="494667" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L15</text>
<text text-anchor="middle" x="494667" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="494667" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="494667" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert1_l15_dp3 -->
<g id="edge2752" class="edge">
<title>router_l15_dp3&#45;&gt;expert1_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490813.84,-163.32C490869.48,-168.87 490928.8,-173.94 490984,-176.98 491586.55,-210.19 493096.09,-206.84 493699.5,-198.98 493887.21,-196.54 494359.1,-209.46 494544,-176.98 494559.46,-174.27 494575.62,-169.99 494590.96,-165.2"/>
<polygon fill="black" stroke="black" points="494592.46,-168.4 494600.9,-161.99 494590.31,-161.73 494592.46,-168.4"/>
<text text-anchor="middle" x="493678" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l15_dp3 -->
<g id="node1639" class="node">
<title>expert2_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="494534.5,-161.98 494305.5,-161.98 494305.5,-109.98 494534.5,-109.98 494534.5,-161.98"/>
<text text-anchor="middle" x="494420" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L15</text>
<text text-anchor="middle" x="494420" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="494420" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="494420" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert2_l15_dp3 -->
<g id="edge2753" class="edge">
<title>router_l15_dp3&#45;&gt;expert2_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490728.67,-176.99C490767.3,-186.08 490809.21,-194.39 490848.5,-198.98 490867.48,-201.2 490872.39,-199.04 490891.5,-198.98 491080.7,-198.37 494110.34,-207.89 494297,-176.98 494312.81,-174.36 494329.35,-170.03 494344.98,-165.14"/>
<polygon fill="black" stroke="black" points="494346.15,-168.44 494354.58,-162.03 494343.99,-161.78 494346.15,-168.44"/>
<text text-anchor="middle" x="490870" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l15_dp3 -->
<g id="node1640" class="node">
<title>expert3_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="494287.5,-161.98 494058.5,-161.98 494058.5,-109.98 494287.5,-109.98 494287.5,-161.98"/>
<text text-anchor="middle" x="494173" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L15</text>
<text text-anchor="middle" x="494173" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="494173" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="494173" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert3_l15_dp3 -->
<g id="edge2754" class="edge">
<title>router_l15_dp3&#45;&gt;expert3_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490755.37,-177C490800.98,-186.1 490850.37,-194.39 490896.5,-198.98 490915.52,-200.87 490920.39,-199.05 490939.5,-198.98 491285.12,-197.76 493709.04,-233.55 494050,-176.98 494065.81,-174.36 494082.35,-170.02 494097.98,-165.13"/>
<polygon fill="black" stroke="black" points="494099.14,-168.43 494107.58,-162.02 494096.99,-161.77 494099.14,-168.43"/>
<text text-anchor="middle" x="490918" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l15_dp3 -->
<g id="node1641" class="node">
<title>expert4_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="494040.5,-161.98 493811.5,-161.98 493811.5,-109.98 494040.5,-109.98 494040.5,-161.98"/>
<text text-anchor="middle" x="493926" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L15</text>
<text text-anchor="middle" x="493926" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="493926" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="493926" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert4_l15_dp3 -->
<g id="edge2755" class="edge">
<title>router_l15_dp3&#45;&gt;expert4_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490782.02,-177C490834.62,-186.1 490891.5,-194.4 490944.5,-198.98 490963.54,-200.63 490968.39,-199.06 490987.5,-198.98 491300.34,-197.76 493494.39,-228.3 493803,-176.98 493818.81,-174.35 493835.35,-170.01 493850.98,-165.12"/>
<polygon fill="black" stroke="black" points="493852.14,-168.42 493860.58,-162.01 493849.99,-161.76 493852.14,-168.42"/>
<text text-anchor="middle" x="490966" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l15_dp3 -->
<g id="node1642" class="node">
<title>expert5_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="493793.5,-161.98 493564.5,-161.98 493564.5,-109.98 493793.5,-109.98 493793.5,-161.98"/>
<text text-anchor="middle" x="493679" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L15</text>
<text text-anchor="middle" x="493679" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="493679" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="493679" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert5_l15_dp3 -->
<g id="edge2756" class="edge">
<title>router_l15_dp3&#45;&gt;expert5_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490813.58,-163.13C490869.3,-168.7 490928.72,-173.82 490984,-176.98 491390.59,-200.22 492409.29,-205.04 492816.5,-198.98 493145.27,-194.09 493232.25,-234.47 493556,-176.98 493571.36,-174.25 493587.42,-170 493602.68,-165.24"/>
<polygon fill="black" stroke="black" points="493604.12,-168.45 493612.57,-162.05 493601.98,-161.79 493604.12,-168.45"/>
<text text-anchor="middle" x="492795" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l15_dp3 -->
<g id="node1643" class="node">
<title>expert6_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="493546.5,-161.98 493317.5,-161.98 493317.5,-109.98 493546.5,-109.98 493546.5,-161.98"/>
<text text-anchor="middle" x="493432" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L15</text>
<text text-anchor="middle" x="493432" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="493432" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="493432" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert6_l15_dp3 -->
<g id="edge2757" class="edge">
<title>router_l15_dp3&#45;&gt;expert6_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490808.65,-177.01C490868.23,-186.11 490932.61,-194.4 490992.5,-198.98 491011.55,-200.44 491016.39,-199.08 491035.5,-198.98 491288.12,-197.76 493059.84,-218.65 493309,-176.98 493324.81,-174.34 493341.34,-169.99 493356.97,-165.1"/>
<polygon fill="black" stroke="black" points="493358.14,-168.4 493366.57,-161.99 493355.98,-161.74 493358.14,-168.4"/>
<text text-anchor="middle" x="491014" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l15_dp3 -->
<g id="node1644" class="node">
<title>expert7_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="493299.5,-161.98 493070.5,-161.98 493070.5,-109.98 493299.5,-109.98 493299.5,-161.98"/>
<text text-anchor="middle" x="493185" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L15</text>
<text text-anchor="middle" x="493185" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="493185" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="493185" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert7_l15_dp3 -->
<g id="edge2758" class="edge">
<title>router_l15_dp3&#45;&gt;expert7_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490829.89,-176.28C490897.94,-185.66 490971.91,-194.28 491040.5,-198.98 491059.56,-200.29 491064.39,-199.09 491083.5,-198.98 491303.34,-197.76 492845.19,-213.4 493062,-176.98 493077.72,-174.34 493094.15,-170.03 493109.7,-165.16"/>
<polygon fill="black" stroke="black" points="493110.81,-168.48 493119.25,-162.07 493108.66,-161.82 493110.81,-168.48"/>
<text text-anchor="middle" x="491062" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l15_dp3 -->
<g id="node1645" class="node">
<title>expert8_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="493052.5,-161.98 492823.5,-161.98 492823.5,-109.98 493052.5,-109.98 493052.5,-161.98"/>
<text text-anchor="middle" x="492938" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L15</text>
<text text-anchor="middle" x="492938" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="492938" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="492938" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert8_l15_dp3 -->
<g id="edge2759" class="edge">
<title>router_l15_dp3&#45;&gt;expert8_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490825.08,-172.34C490908.36,-183.2 491002.33,-193.63 491088.5,-198.98 491279.98,-210.87 492625.83,-208.95 492815,-176.98 492830.71,-174.33 492847.14,-170 492862.69,-165.14"/>
<polygon fill="black" stroke="black" points="492863.81,-168.46 492872.25,-162.05 492861.65,-161.8 492863.81,-168.46"/>
<text text-anchor="middle" x="491110" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l15_dp3 -->
<g id="node1646" class="node">
<title>expert9_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="492805.5,-161.98 492576.5,-161.98 492576.5,-109.98 492805.5,-109.98 492805.5,-161.98"/>
<text text-anchor="middle" x="492691" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L15</text>
<text text-anchor="middle" x="492691" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="492691" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="492691" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert9_l15_dp3 -->
<g id="edge2760" class="edge">
<title>router_l15_dp3&#45;&gt;expert9_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490813.08,-162.7C490868.95,-168.31 490928.56,-173.55 490984,-176.98 491451.87,-205.94 491569.83,-208.71 492038.5,-198.98 492273.98,-194.09 492336.34,-219.53 492568,-176.98 492583.25,-174.18 492599.21,-169.92 492614.38,-165.18"/>
<polygon fill="black" stroke="black" points="492615.78,-168.41 492624.22,-162.01 492613.63,-161.75 492615.78,-168.41"/>
<text text-anchor="middle" x="492017" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l15_dp3 -->
<g id="node1647" class="node">
<title>expert10_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="492558.5,-161.98 492329.5,-161.98 492329.5,-109.98 492558.5,-109.98 492558.5,-161.98"/>
<text text-anchor="middle" x="492444" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L15</text>
<text text-anchor="middle" x="492444" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="492444" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="492444" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert10_l15_dp3 -->
<g id="edge2761" class="edge">
<title>router_l15_dp3&#45;&gt;expert10_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490820.88,-169.04C490918.47,-181.04 491032.7,-193.09 491136.5,-198.98 491267.92,-206.44 492191.27,-199.32 492321,-176.98 492336.47,-174.32 492352.63,-170.07 492367.97,-165.28"/>
<polygon fill="black" stroke="black" points="492369.47,-168.48 492377.91,-162.08 492367.32,-161.82 492369.47,-168.48"/>
<text text-anchor="middle" x="491158" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l15_dp3 -->
<g id="node1648" class="node">
<title>expert11_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="492311.5,-161.98 492082.5,-161.98 492082.5,-109.98 492311.5,-109.98 492311.5,-161.98"/>
<text text-anchor="middle" x="492197" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L15</text>
<text text-anchor="middle" x="492197" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="492197" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="492197" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert11_l15_dp3 -->
<g id="edge2762" class="edge">
<title>router_l15_dp3&#45;&gt;expert11_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490817.51,-166.28C490928.54,-179.16 491063.13,-192.64 491184.5,-198.98 491381.96,-209.3 491879.25,-211.19 492074,-176.98 492089.46,-174.27 492105.62,-169.99 492120.96,-165.2"/>
<polygon fill="black" stroke="black" points="492122.46,-168.4 492130.9,-161.99 492120.31,-161.73 492122.46,-168.4"/>
<text text-anchor="middle" x="491206" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l15_dp3 -->
<g id="node1649" class="node">
<title>expert12_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="492064.5,-161.98 491835.5,-161.98 491835.5,-109.98 492064.5,-109.98 492064.5,-161.98"/>
<text text-anchor="middle" x="491950" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L15</text>
<text text-anchor="middle" x="491950" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="491950" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="491950" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert12_l15_dp3 -->
<g id="edge2763" class="edge">
<title>router_l15_dp3&#45;&gt;expert12_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490809.33,-159.67C490866.33,-165.48 490927.4,-171.58 490984,-176.98 490984,-176.98 491827,-176.98 491827,-176.98 491842.26,-174.19 491858.21,-169.94 491873.38,-165.2"/>
<polygon fill="black" stroke="black" points="491874.78,-168.43 491883.23,-162.03 491872.63,-161.77 491874.78,-168.43"/>
<text text-anchor="middle" x="491254" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l15_dp3 -->
<g id="node1650" class="node">
<title>expert13_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="491817.5,-161.98 491588.5,-161.98 491588.5,-109.98 491817.5,-109.98 491817.5,-161.98"/>
<text text-anchor="middle" x="491703" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L15</text>
<text text-anchor="middle" x="491703" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="491703" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="491703" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert13_l15_dp3 -->
<g id="edge2764" class="edge">
<title>router_l15_dp3&#45;&gt;expert13_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490829.6,-175.94C491007.86,-199.35 491254.35,-220.48 491470.5,-198.98 491521.76,-193.88 491577.52,-179.11 491621.59,-165.14"/>
<polygon fill="black" stroke="black" points="491622.93,-168.39 491631.37,-161.99 491620.78,-161.72 491622.93,-168.39"/>
<text text-anchor="middle" x="491449" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l15_dp3 -->
<g id="node1651" class="node">
<title>expert14_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="491570.5,-161.98 491341.5,-161.98 491341.5,-109.98 491570.5,-109.98 491570.5,-161.98"/>
<text text-anchor="middle" x="491456" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L15</text>
<text text-anchor="middle" x="491456" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="491456" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="491456" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert14_l15_dp3 -->
<g id="edge2765" class="edge">
<title>router_l15_dp3&#45;&gt;expert14_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490813.52,-162.99C490949.24,-177.35 491124.37,-193.2 491280.5,-198.98 491299.6,-199.69 491304.86,-203.19 491323.5,-198.98 491351.7,-192.62 491380.94,-179.52 491404.75,-166.9"/>
<polygon fill="black" stroke="black" points="491406.48,-169.94 491413.6,-162.1 491403.14,-163.79 491406.48,-169.94"/>
<text text-anchor="middle" x="491302" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l15_dp3 -->
<g id="node1652" class="node">
<title>expert15_l15_dp3</title>
<polygon fill="lightgreen" stroke="black" points="491221.5,-161.98 490992.5,-161.98 490992.5,-109.98 491221.5,-109.98 491221.5,-161.98"/>
<text text-anchor="middle" x="491107" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L15</text>
<text text-anchor="middle" x="491107" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="491107" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="491107" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l15_dp3&#45;&gt;expert15_l15_dp3 -->
<g id="edge2766" class="edge">
<title>router_l15_dp3&#45;&gt;expert15_l15_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M490779.98,-135.98C490847.75,-135.98 490921.72,-135.98 490982.14,-135.98"/>
<polygon fill="black" stroke="black" points="490982.49,-139.48 490992.49,-135.98 490982.49,-132.48 490982.49,-139.48"/>
<text text-anchor="middle" x="490911.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l15_dp3 -->
<g id="node1653" class="node">
<title>expert_agg_l15_dp3</title>
<polygon fill="lightyellow" stroke="black" points="495559.57,-176.98 495165.74,-176.98 495064.43,-94.98 495458.26,-94.98 495559.57,-176.98"/>
<text text-anchor="middle" x="495312" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L15</text>
<text text-anchor="middle" x="495312" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="495312" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2767" class="edge">
<title>expert0_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M495028.66,-135.98C495054.06,-135.98 495079.47,-135.98 495104.87,-135.98"/>
<polygon fill="black" stroke="black" points="495104.99,-139.48 495114.99,-135.98 495104.99,-132.48 495104.99,-139.48"/>
</g>
<!-- expert1_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2768" class="edge">
<title>expert1_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M494722.68,-162.02C494746.02,-171.58 494773.79,-181.22 494800,-185.98 494850.07,-195.08 494978.3,-190.43 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert2_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2769" class="edge">
<title>expert2_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M494475.68,-162.02C494499.02,-171.58 494526.79,-181.22 494553,-185.98 494605.03,-195.44 494976.31,-190.6 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert3_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2770" class="edge">
<title>expert3_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M494228.68,-162.02C494252.02,-171.58 494279.79,-181.22 494306,-185.98 494385.04,-200.35 494948.97,-193 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert4_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2771" class="edge">
<title>expert4_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M493981.68,-162.02C494005.02,-171.58 494032.79,-181.22 494059,-185.98 494112.02,-195.62 494975.32,-190.69 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert5_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2772" class="edge">
<title>expert5_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M493734.68,-162.02C493758.02,-171.58 493785.79,-181.22 493812,-185.98 493878.52,-198.07 494961.65,-191.89 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert6_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2773" class="edge">
<title>expert6_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M493487.68,-162.02C493511.02,-171.58 493538.79,-181.22 493565,-185.98 493645.02,-200.53 494947.98,-193.09 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert7_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2774" class="edge">
<title>expert7_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M493240.68,-162.02C493264.02,-171.58 493291.79,-181.22 493318,-185.98 493364.76,-194.48 494981.65,-190.13 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert8_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2775" class="edge">
<title>expert8_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M492993.68,-162.02C493017.02,-171.58 493044.79,-181.22 493071,-185.98 493124.51,-195.71 494974.82,-190.73 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert9_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2776" class="edge">
<title>expert9_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M492746.68,-162.02C492770.02,-171.58 492797.79,-181.22 492824,-185.98 492884.26,-196.94 494967.98,-191.33 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert10_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2777" class="edge">
<title>expert10_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M492499.68,-162.02C492523.02,-171.58 492550.79,-181.22 492577,-185.98 492644.01,-198.16 494961.15,-191.93 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert11_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2778" class="edge">
<title>expert11_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M492252.68,-162.02C492276.02,-171.58 492303.79,-181.22 492330,-185.98 492403.76,-199.39 494954.31,-192.53 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert12_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2779" class="edge">
<title>expert12_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M492005.68,-162.02C492029.02,-171.58 492056.79,-181.22 492083,-185.98 492163.51,-200.62 494947.48,-193.13 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert13_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2780" class="edge">
<title>expert13_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M491758.68,-162.02C491782.02,-171.58 491809.79,-181.22 491836,-185.98 491879.63,-193.91 494984.82,-189.86 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert14_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2781" class="edge">
<title>expert14_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M491511.68,-162.02C491535.02,-171.58 491562.79,-181.22 491589,-185.98 491636.01,-194.53 494981.4,-190.15 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- expert15_l15_dp3&#45;&gt;expert_agg_l15_dp3 -->
<g id="edge2782" class="edge">
<title>expert15_l15_dp3&#45;&gt;expert_agg_l15_dp3</title>
<path fill="none" stroke="black" d="M491206.6,-162C491248.15,-171.59 491297.09,-181.26 491342,-185.98 491443.85,-196.7 494926.97,-194.93 495029,-185.98 495066.75,-182.67 495107.02,-176.93 495144.98,-170.48"/>
<polygon fill="black" stroke="black" points="495145.84,-173.88 495155.1,-168.73 495144.65,-166.98 495145.84,-173.88"/>
</g>
<!-- layer15_output_dp3 -->
<g id="node1654" class="node">
<title>layer15_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="495764" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="495764" y="-144.48" font-family="Arial" font-size="10.00">Layer 15 Output</text>
<text text-anchor="middle" x="495764" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="495764" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l15_dp3&#45;&gt;layer15_output_dp3 -->
<g id="edge2783" class="edge">
<title>expert_agg_l15_dp3&#45;&gt;layer15_output_dp3</title>
<path fill="none" stroke="black" d="M495509.31,-135.98C495534.49,-135.98 495559.66,-135.98 495584.84,-135.98"/>
<polygon fill="black" stroke="black" points="495584.87,-139.48 495594.87,-135.98 495584.87,-132.48 495584.87,-139.48"/>
</g>
<!-- attn_input_l16_dp3 -->
<g id="node1655" class="node">
<title>attn_input_l16_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="496137" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="496137" y="-144.48" font-family="Arial" font-size="10.00">Attention Input L16</text>
<text text-anchor="middle" x="496137" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="496137" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer15_output_dp3&#45;&gt;attn_input_l16_dp3 -->
<g id="edge2784" class="edge">
<title>layer15_output_dp3&#45;&gt;attn_input_l16_dp3</title>
<path fill="none" stroke="black" d="M495933.01,-135.98C495941.23,-135.98 495949.44,-135.98 495957.66,-135.98"/>
<polygon fill="black" stroke="black" points="495957.68,-139.48 495967.68,-135.98 495957.68,-132.48 495957.68,-139.48"/>
</g>
<!-- attn_tp0_l16_dp3 -->
<g id="node1656" class="node">
<title>attn_tp0_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="497435,-161.98 497175,-161.98 497175,-109.98 497435,-109.98 497435,-161.98"/>
<text text-anchor="middle" x="497305" y="-149.98" font-family="Arial" font-size="10.00">Attention TP0 L16</text>
<text text-anchor="middle" x="497305" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="497305" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="497305" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp3&#45;&gt;attn_tp0_l16_dp3 -->
<g id="edge2785" class="edge">
<title>attn_input_l16_dp3&#45;&gt;attn_tp0_l16_dp3</title>
<path fill="none" stroke="black" d="M496220.52,-161.26C496257.12,-171.09 496300.81,-181.13 496341,-185.98 496386,-191.42 497112.27,-193.33 497157,-185.98 497182.4,-181.81 497209.31,-173.85 497233.12,-165.5"/>
<polygon fill="black" stroke="black" points="497234.55,-168.71 497242.78,-162.03 497232.18,-162.12 497234.55,-168.71"/>
</g>
<!-- attn_tp1_l16_dp3 -->
<g id="node1657" class="node">
<title>attn_tp1_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="497157,-161.98 496897,-161.98 496897,-109.98 497157,-109.98 497157,-161.98"/>
<text text-anchor="middle" x="497027" y="-149.98" font-family="Arial" font-size="10.00">Attention TP1 L16</text>
<text text-anchor="middle" x="497027" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="497027" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="497027" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp3&#45;&gt;attn_tp1_l16_dp3 -->
<g id="edge2786" class="edge">
<title>attn_input_l16_dp3&#45;&gt;attn_tp1_l16_dp3</title>
<path fill="none" stroke="black" d="M496220.52,-161.26C496257.12,-171.09 496300.81,-181.13 496341,-185.98 496400.35,-193.15 496820.01,-195.68 496879,-185.98 496904.4,-181.81 496931.31,-173.85 496955.12,-165.5"/>
<polygon fill="black" stroke="black" points="496956.55,-168.71 496964.78,-162.03 496954.18,-162.12 496956.55,-168.71"/>
</g>
<!-- attn_tp2_l16_dp3 -->
<g id="node1658" class="node">
<title>attn_tp2_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="496879,-161.98 496619,-161.98 496619,-109.98 496879,-109.98 496879,-161.98"/>
<text text-anchor="middle" x="496749" y="-149.98" font-family="Arial" font-size="10.00">Attention TP2 L16</text>
<text text-anchor="middle" x="496749" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="496749" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="496749" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp3&#45;&gt;attn_tp2_l16_dp3 -->
<g id="edge2787" class="edge">
<title>attn_input_l16_dp3&#45;&gt;attn_tp2_l16_dp3</title>
<path fill="none" stroke="black" d="M496220.52,-161.26C496257.12,-171.09 496300.81,-181.13 496341,-185.98 496398.36,-192.91 496543.99,-195.35 496601,-185.98 496626.4,-181.81 496653.31,-173.85 496677.12,-165.5"/>
<polygon fill="black" stroke="black" points="496678.55,-168.71 496686.78,-162.03 496676.18,-162.12 496678.55,-168.71"/>
</g>
<!-- attn_tp3_l16_dp3 -->
<g id="node1659" class="node">
<title>attn_tp3_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="496601,-161.98 496341,-161.98 496341,-109.98 496601,-109.98 496601,-161.98"/>
<text text-anchor="middle" x="496471" y="-149.98" font-family="Arial" font-size="10.00">Attention TP3 L16</text>
<text text-anchor="middle" x="496471" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="496471" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
<text text-anchor="middle" x="496471" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=256, heads=4, d_k=32]</text>
</g>
<!-- attn_input_l16_dp3&#45;&gt;attn_tp3_l16_dp3 -->
<g id="edge2788" class="edge">
<title>attn_input_l16_dp3&#45;&gt;attn_tp3_l16_dp3</title>
<path fill="none" stroke="black" d="M496306.28,-135.98C496314.35,-135.98 496322.42,-135.98 496330.49,-135.98"/>
<polygon fill="black" stroke="black" points="496330.7,-139.48 496340.7,-135.98 496330.7,-132.48 496330.7,-139.48"/>
</g>
<!-- allreduce_l16_dp3 -->
<g id="node1660" class="node">
<title>allreduce_l16_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="497639" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="497639" y="-144.48" font-family="Arial" font-size="10.00">AllReduce L16</text>
<text text-anchor="middle" x="497639" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="497639" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- attn_tp0_l16_dp3&#45;&gt;allreduce_l16_dp3 -->
<g id="edge2789" class="edge">
<title>attn_tp0_l16_dp3&#45;&gt;allreduce_l16_dp3</title>
<path fill="none" stroke="black" d="M497435.14,-135.98C497443.35,-135.98 497451.56,-135.98 497459.77,-135.98"/>
<polygon fill="black" stroke="black" points="497459.78,-139.48 497469.78,-135.98 497459.78,-132.48 497459.78,-139.48"/>
</g>
<!-- attn_tp1_l16_dp3&#45;&gt;allreduce_l16_dp3 -->
<g id="edge2790" class="edge">
<title>attn_tp1_l16_dp3&#45;&gt;allreduce_l16_dp3</title>
<path fill="none" stroke="black" d="M497089.22,-162.03C497115.24,-171.59 497146.1,-181.23 497175,-185.98 497232.01,-195.35 497377.64,-192.91 497435,-185.98 497471.57,-181.57 497511.05,-172.85 497545.44,-163.91"/>
<polygon fill="black" stroke="black" points="497546.7,-167.2 497555.47,-161.26 497544.91,-160.43 497546.7,-167.2"/>
</g>
<!-- attn_tp2_l16_dp3&#45;&gt;allreduce_l16_dp3 -->
<g id="edge2791" class="edge">
<title>attn_tp2_l16_dp3&#45;&gt;allreduce_l16_dp3</title>
<path fill="none" stroke="black" d="M496811.22,-162.03C496837.24,-171.59 496868.1,-181.23 496897,-185.98 496955.98,-195.68 497375.65,-193.15 497435,-185.98 497471.57,-181.57 497511.05,-172.85 497545.44,-163.91"/>
<polygon fill="black" stroke="black" points="497546.7,-167.2 497555.47,-161.26 497544.91,-160.43 497546.7,-167.2"/>
</g>
<!-- attn_tp3_l16_dp3&#45;&gt;allreduce_l16_dp3 -->
<g id="edge2792" class="edge">
<title>attn_tp3_l16_dp3&#45;&gt;allreduce_l16_dp3</title>
<path fill="none" stroke="black" d="M496533.22,-162.03C496559.24,-171.59 496590.1,-181.23 496619,-185.98 496663.73,-193.33 497389.99,-191.42 497435,-185.98 497471.57,-181.57 497511.05,-172.85 497545.44,-163.91"/>
<polygon fill="black" stroke="black" points="497546.7,-167.2 497555.47,-161.26 497544.91,-160.43 497546.7,-167.2"/>
</g>
<!-- moe_input_l16_dp3 -->
<g id="node1661" class="node">
<title>moe_input_l16_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="498012" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="498012" y="-144.48" font-family="Arial" font-size="10.00">MoE Input L16</text>
<text text-anchor="middle" x="498012" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="498012" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- allreduce_l16_dp3&#45;&gt;moe_input_l16_dp3 -->
<g id="edge2793" class="edge">
<title>allreduce_l16_dp3&#45;&gt;moe_input_l16_dp3</title>
<path fill="none" stroke="black" d="M497808.01,-135.98C497816.23,-135.98 497824.44,-135.98 497832.66,-135.98"/>
<polygon fill="black" stroke="black" points="497832.68,-139.48 497842.68,-135.98 497832.68,-132.48 497832.68,-139.48"/>
</g>
<!-- router_l16_dp3 -->
<g id="node1662" class="node">
<title>router_l16_dp3</title>
<polygon fill="lightyellow" stroke="black" points="498711.57,-176.98 498317.74,-176.98 498216.43,-94.98 498610.26,-94.98 498711.57,-176.98"/>
<text text-anchor="middle" x="498464" y="-144.48" font-family="Arial" font-size="10.00">Router L16</text>
<text text-anchor="middle" x="498464" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="498464" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- moe_input_l16_dp3&#45;&gt;router_l16_dp3 -->
<g id="edge2794" class="edge">
<title>moe_input_l16_dp3&#45;&gt;router_l16_dp3</title>
<path fill="none" stroke="black" d="M498181.06,-135.98C498206.34,-135.98 498231.63,-135.98 498256.92,-135.98"/>
<polygon fill="black" stroke="black" points="498256.99,-139.48 498266.99,-135.98 498256.99,-132.48 498256.99,-139.48"/>
</g>
<!-- expert0_l16_dp3 -->
<g id="node1663" class="node">
<title>expert0_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="502957.5,-161.98 502728.5,-161.98 502728.5,-109.98 502957.5,-109.98 502957.5,-161.98"/>
<text text-anchor="middle" x="502843" y="-149.98" font-family="Arial" font-size="10.00">Expert 0 L16</text>
<text text-anchor="middle" x="502843" y="-138.98" font-family="Arial" font-size="10.00">GPU 112</text>
<text text-anchor="middle" x="502843" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="502843" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert0_l16_dp3 -->
<g id="edge2795" class="edge">
<title>router_l16_dp3&#45;&gt;expert0_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498693.11,-161.86C498756.48,-167.99 498825.33,-173.7 498889,-176.98 499586.64,-213 501333.93,-196.54 502032.5,-198.98 502338.21,-200.05 502419.11,-231.09 502720,-176.98 502735.35,-174.22 502751.41,-169.95 502766.67,-165.19"/>
<polygon fill="black" stroke="black" points="502768.12,-168.4 502776.56,-162 502765.97,-161.74 502768.12,-168.4"/>
<text text-anchor="middle" x="502054" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert1_l16_dp3 -->
<g id="node1664" class="node">
<title>expert1_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="502710.5,-161.98 502481.5,-161.98 502481.5,-109.98 502710.5,-109.98 502710.5,-161.98"/>
<text text-anchor="middle" x="502596" y="-149.98" font-family="Arial" font-size="10.00">Expert 1 L16</text>
<text text-anchor="middle" x="502596" y="-138.98" font-family="Arial" font-size="10.00">GPU 113</text>
<text text-anchor="middle" x="502596" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="502596" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert1_l16_dp3 -->
<g id="edge2796" class="edge">
<title>router_l16_dp3&#45;&gt;expert1_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498609.67,-176.99C498648.3,-186.08 498690.21,-194.39 498729.5,-198.98 498748.48,-201.2 498753.39,-199.04 498772.5,-198.98 498978.08,-198.37 502270.16,-210.52 502473,-176.98 502488.81,-174.37 502505.35,-170.03 502520.98,-165.14"/>
<polygon fill="black" stroke="black" points="502522.15,-168.44 502530.58,-162.03 502519.99,-161.78 502522.15,-168.44"/>
<text text-anchor="middle" x="498751" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert2_l16_dp3 -->
<g id="node1665" class="node">
<title>expert2_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="502463.5,-161.98 502234.5,-161.98 502234.5,-109.98 502463.5,-109.98 502463.5,-161.98"/>
<text text-anchor="middle" x="502349" y="-149.98" font-family="Arial" font-size="10.00">Expert 2 L16</text>
<text text-anchor="middle" x="502349" y="-138.98" font-family="Arial" font-size="10.00">GPU 114</text>
<text text-anchor="middle" x="502349" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="502349" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert2_l16_dp3 -->
<g id="edge2797" class="edge">
<title>router_l16_dp3&#45;&gt;expert2_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498692.84,-161.75C498756.29,-167.89 498825.24,-173.63 498889,-176.98 499444.81,-206.22 500836.97,-206.34 501393.5,-198.98 501578.55,-196.54 502043.73,-209.04 502226,-176.98 502241.46,-174.26 502257.62,-169.99 502272.95,-165.2"/>
<polygon fill="black" stroke="black" points="502274.46,-168.39 502282.9,-161.99 502272.31,-161.73 502274.46,-168.39"/>
<text text-anchor="middle" x="501372" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert3_l16_dp3 -->
<g id="node1666" class="node">
<title>expert3_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="502216.5,-161.98 501987.5,-161.98 501987.5,-109.98 502216.5,-109.98 502216.5,-161.98"/>
<text text-anchor="middle" x="502102" y="-149.98" font-family="Arial" font-size="10.00">Expert 3 L16</text>
<text text-anchor="middle" x="502102" y="-138.98" font-family="Arial" font-size="10.00">GPU 115</text>
<text text-anchor="middle" x="502102" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="502102" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert3_l16_dp3 -->
<g id="edge2798" class="edge">
<title>router_l16_dp3&#45;&gt;expert3_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498636.37,-177C498681.98,-186.1 498731.37,-194.39 498777.5,-198.98 498796.52,-200.87 498801.39,-199.05 498820.5,-198.98 499171.45,-197.76 501632.78,-234.41 501979,-176.98 501994.81,-174.36 502011.35,-170.02 502026.98,-165.13"/>
<polygon fill="black" stroke="black" points="502028.14,-168.43 502036.58,-162.02 502025.99,-161.77 502028.14,-168.43"/>
<text text-anchor="middle" x="498799" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert4_l16_dp3 -->
<g id="node1667" class="node">
<title>expert4_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="501969.5,-161.98 501740.5,-161.98 501740.5,-109.98 501969.5,-109.98 501969.5,-161.98"/>
<text text-anchor="middle" x="501855" y="-149.98" font-family="Arial" font-size="10.00">Expert 4 L16</text>
<text text-anchor="middle" x="501855" y="-138.98" font-family="Arial" font-size="10.00">GPU 116</text>
<text text-anchor="middle" x="501855" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="501855" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert4_l16_dp3 -->
<g id="edge2799" class="edge">
<title>router_l16_dp3&#45;&gt;expert4_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498663.02,-177C498715.62,-186.1 498772.5,-194.4 498825.5,-198.98 498844.54,-200.63 498849.39,-199.06 498868.5,-198.98 499186.67,-197.76 501418.13,-229.15 501732,-176.98 501747.81,-174.35 501764.35,-170.01 501779.98,-165.12"/>
<polygon fill="black" stroke="black" points="501781.14,-168.42 501789.58,-162.01 501778.99,-161.76 501781.14,-168.42"/>
<text text-anchor="middle" x="498847" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert5_l16_dp3 -->
<g id="node1668" class="node">
<title>expert5_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="501722.5,-161.98 501493.5,-161.98 501493.5,-109.98 501722.5,-109.98 501722.5,-161.98"/>
<text text-anchor="middle" x="501608" y="-149.98" font-family="Arial" font-size="10.00">Expert 5 L16</text>
<text text-anchor="middle" x="501608" y="-138.98" font-family="Arial" font-size="10.00">GPU 117</text>
<text text-anchor="middle" x="501608" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="501608" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert5_l16_dp3 -->
<g id="edge2800" class="edge">
<title>router_l16_dp3&#45;&gt;expert5_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498689.65,-177.01C498749.23,-186.11 498813.61,-194.4 498873.5,-198.98 498892.55,-200.44 498897.39,-199.06 498916.5,-198.98 499201.9,-197.76 501203.48,-223.9 501485,-176.98 501500.81,-174.35 501517.35,-170 501532.98,-165.11"/>
<polygon fill="black" stroke="black" points="501534.14,-168.41 501542.58,-162 501531.98,-161.75 501534.14,-168.41"/>
<text text-anchor="middle" x="498895" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert6_l16_dp3 -->
<g id="node1669" class="node">
<title>expert6_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="501475.5,-161.98 501246.5,-161.98 501246.5,-109.98 501475.5,-109.98 501475.5,-161.98"/>
<text text-anchor="middle" x="501361" y="-149.98" font-family="Arial" font-size="10.00">Expert 6 L16</text>
<text text-anchor="middle" x="501361" y="-138.98" font-family="Arial" font-size="10.00">GPU 118</text>
<text text-anchor="middle" x="501361" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="501361" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert6_l16_dp3 -->
<g id="edge2801" class="edge">
<title>router_l16_dp3&#45;&gt;expert6_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498692.57,-161.52C498756.1,-167.67 498825.16,-173.47 498889,-176.98 499614.41,-216.92 499797.07,-210.16 500523.5,-198.98 500841.17,-194.09 500925.22,-232.69 501238,-176.98 501253.36,-174.25 501269.42,-169.99 501284.67,-165.23"/>
<polygon fill="black" stroke="black" points="501286.12,-168.44 501294.57,-162.04 501283.98,-161.78 501286.12,-168.44"/>
<text text-anchor="middle" x="500502" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert7_l16_dp3 -->
<g id="node1670" class="node">
<title>expert7_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="501228.5,-161.98 500999.5,-161.98 500999.5,-109.98 501228.5,-109.98 501228.5,-161.98"/>
<text text-anchor="middle" x="501114" y="-149.98" font-family="Arial" font-size="10.00">Expert 7 L16</text>
<text text-anchor="middle" x="501114" y="-138.98" font-family="Arial" font-size="10.00">GPU 119</text>
<text text-anchor="middle" x="501114" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="501114" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert7_l16_dp3 -->
<g id="edge2802" class="edge">
<title>router_l16_dp3&#45;&gt;expert7_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498710.89,-176.28C498778.94,-185.66 498852.91,-194.28 498921.5,-198.98 498940.56,-200.29 498945.39,-199.09 498964.5,-198.98 499189.68,-197.76 500768.93,-214.26 500991,-176.98 501006.72,-174.34 501023.15,-170.03 501038.7,-165.17"/>
<polygon fill="black" stroke="black" points="501039.81,-168.48 501048.25,-162.08 501037.66,-161.82 501039.81,-168.48"/>
<text text-anchor="middle" x="498943" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert8_l16_dp3 -->
<g id="node1671" class="node">
<title>expert8_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="500981.5,-161.98 500752.5,-161.98 500752.5,-109.98 500981.5,-109.98 500981.5,-161.98"/>
<text text-anchor="middle" x="500867" y="-149.98" font-family="Arial" font-size="10.00">Expert 8 L16</text>
<text text-anchor="middle" x="500867" y="-138.98" font-family="Arial" font-size="10.00">GPU 120</text>
<text text-anchor="middle" x="500867" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="500867" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert8_l16_dp3 -->
<g id="edge2803" class="edge">
<title>router_l16_dp3&#45;&gt;expert8_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498706.08,-172.34C498789.36,-183.2 498883.33,-193.63 498969.5,-198.98 499166.3,-211.2 500549.57,-209.8 500744,-176.98 500759.71,-174.33 500776.15,-170.01 500791.69,-165.14"/>
<polygon fill="black" stroke="black" points="500792.81,-168.46 500801.25,-162.05 500790.66,-161.8 500792.81,-168.46"/>
<text text-anchor="middle" x="498991" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert9_l16_dp3 -->
<g id="node1672" class="node">
<title>expert9_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="500734.5,-161.98 500505.5,-161.98 500505.5,-109.98 500734.5,-109.98 500734.5,-161.98"/>
<text text-anchor="middle" x="500620" y="-149.98" font-family="Arial" font-size="10.00">Expert 9 L16</text>
<text text-anchor="middle" x="500620" y="-138.98" font-family="Arial" font-size="10.00">GPU 121</text>
<text text-anchor="middle" x="500620" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="500620" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert9_l16_dp3 -->
<g id="edge2804" class="edge">
<title>router_l16_dp3&#45;&gt;expert9_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498701.88,-169.04C498799.47,-181.04 498913.7,-193.09 499017.5,-198.98 499181.64,-208.29 500334.92,-204.56 500497,-176.98 500512.71,-174.31 500529.14,-169.98 500544.69,-165.11"/>
<polygon fill="black" stroke="black" points="500545.8,-168.43 500554.24,-162.02 500543.65,-161.77 500545.8,-168.43"/>
<text text-anchor="middle" x="499039" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert10_l16_dp3 -->
<g id="node1673" class="node">
<title>expert10_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="500487.5,-161.98 500258.5,-161.98 500258.5,-109.98 500487.5,-109.98 500487.5,-161.98"/>
<text text-anchor="middle" x="500373" y="-149.98" font-family="Arial" font-size="10.00">Expert 10 L16</text>
<text text-anchor="middle" x="500373" y="-138.98" font-family="Arial" font-size="10.00">GPU 122</text>
<text text-anchor="middle" x="500373" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="500373" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert10_l16_dp3 -->
<g id="edge2805" class="edge">
<title>router_l16_dp3&#45;&gt;expert10_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498691.78,-160.92C498755.53,-167.09 498824.91,-173.06 498889,-176.98 499280.16,-200.95 499378.7,-207.97 499770.5,-198.98 499983.78,-194.09 500040.26,-215.97 500250,-176.98 500265.16,-174.16 500281.01,-169.92 500296.1,-165.21"/>
<polygon fill="black" stroke="black" points="500297.44,-168.46 500305.89,-162.06 500295.3,-161.79 500297.44,-168.46"/>
<text text-anchor="middle" x="499749" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert11_l16_dp3 -->
<g id="node1674" class="node">
<title>expert11_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="500240.5,-161.98 500011.5,-161.98 500011.5,-109.98 500240.5,-109.98 500240.5,-161.98"/>
<text text-anchor="middle" x="500126" y="-149.98" font-family="Arial" font-size="10.00">Expert 11 L16</text>
<text text-anchor="middle" x="500126" y="-138.98" font-family="Arial" font-size="10.00">GPU 123</text>
<text text-anchor="middle" x="500126" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="500126" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert11_l16_dp3 -->
<g id="edge2806" class="edge">
<title>router_l16_dp3&#45;&gt;expert11_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498698.51,-166.28C498809.54,-179.16 498944.13,-192.64 499065.5,-198.98 499273.61,-209.85 499797.72,-212.89 500003,-176.98 500018.46,-174.28 500034.62,-170.01 500049.96,-165.22"/>
<polygon fill="black" stroke="black" points="500051.46,-168.41 500059.9,-162.01 500049.31,-161.75 500051.46,-168.41"/>
<text text-anchor="middle" x="499087" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert12_l16_dp3 -->
<g id="node1675" class="node">
<title>expert12_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="499993.5,-161.98 499764.5,-161.98 499764.5,-109.98 499993.5,-109.98 499993.5,-161.98"/>
<text text-anchor="middle" x="499879" y="-149.98" font-family="Arial" font-size="10.00">Expert 12 L16</text>
<text text-anchor="middle" x="499879" y="-138.98" font-family="Arial" font-size="10.00">GPU 124</text>
<text text-anchor="middle" x="499879" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="499879" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert12_l16_dp3 -->
<g id="edge2807" class="edge">
<title>router_l16_dp3&#45;&gt;expert12_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498695.44,-163.92C498819.26,-177.47 498974.46,-192.26 499113.5,-198.98 499256.19,-205.89 499615.43,-202.45 499756,-176.98 499771.26,-174.22 499787.22,-169.97 499802.39,-165.24"/>
<polygon fill="black" stroke="black" points="499803.79,-168.47 499812.23,-162.07 499801.64,-161.8 499803.79,-168.47"/>
<text text-anchor="middle" x="499135" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert13_l16_dp3 -->
<g id="node1676" class="node">
<title>expert13_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="499746.5,-161.98 499517.5,-161.98 499517.5,-109.98 499746.5,-109.98 499746.5,-161.98"/>
<text text-anchor="middle" x="499632" y="-149.98" font-family="Arial" font-size="10.00">Expert 13 L16</text>
<text text-anchor="middle" x="499632" y="-138.98" font-family="Arial" font-size="10.00">GPU 125</text>
<text text-anchor="middle" x="499632" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="499632" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert13_l16_dp3 -->
<g id="edge2808" class="edge">
<title>router_l16_dp3&#45;&gt;expert13_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498703.33,-176.99C498916.78,-206.1 499236.69,-231.32 499509,-176.98 499523.85,-174.02 499539.38,-169.78 499554.22,-165.15"/>
<polygon fill="black" stroke="black" points="499555.41,-168.44 499563.86,-162.05 499553.27,-161.78 499555.41,-168.44"/>
<text text-anchor="middle" x="499183" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert14_l16_dp3 -->
<g id="node1677" class="node">
<title>expert14_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="499499.5,-161.98 499270.5,-161.98 499270.5,-109.98 499499.5,-109.98 499499.5,-161.98"/>
<text text-anchor="middle" x="499385" y="-149.98" font-family="Arial" font-size="10.00">Expert 14 L16</text>
<text text-anchor="middle" x="499385" y="-138.98" font-family="Arial" font-size="10.00">GPU 126</text>
<text text-anchor="middle" x="499385" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="499385" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert14_l16_dp3 -->
<g id="edge2809" class="edge">
<title>router_l16_dp3&#45;&gt;expert14_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498692.45,-161.25C498839.81,-176.07 499035.71,-193.03 499209.5,-198.98 499228.6,-199.64 499233.86,-203.19 499252.5,-198.98 499280.7,-192.62 499309.94,-179.52 499333.75,-166.9"/>
<polygon fill="black" stroke="black" points="499335.48,-169.94 499342.6,-162.1 499332.14,-163.79 499335.48,-169.94"/>
<text text-anchor="middle" x="499231" y="-198.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert15_l16_dp3 -->
<g id="node1678" class="node">
<title>expert15_l16_dp3</title>
<polygon fill="lightgreen" stroke="black" points="499126.5,-161.98 498897.5,-161.98 498897.5,-109.98 499126.5,-109.98 499126.5,-161.98"/>
<text text-anchor="middle" x="499012" y="-149.98" font-family="Arial" font-size="10.00">Expert 15 L16</text>
<text text-anchor="middle" x="499012" y="-138.98" font-family="Arial" font-size="10.00">GPU 127</text>
<text text-anchor="middle" x="499012" y="-127.98" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=64, hidden=512]</text>
<text text-anchor="middle" x="499012" y="-116.98" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=64, hidden=512]</text>
</g>
<!-- router_l16_dp3&#45;&gt;expert15_l16_dp3 -->
<g id="edge2810" class="edge">
<title>router_l16_dp3&#45;&gt;expert15_l16_dp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M498661.06,-135.98C498736.51,-135.98 498820.43,-135.98 498887.28,-135.98"/>
<polygon fill="black" stroke="black" points="498887.44,-139.48 498897.44,-135.98 498887.44,-132.48 498887.44,-139.48"/>
<text text-anchor="middle" x="498804.64" y="-142.78" font-family="Times,serif" font-size="14.00">select</text>
</g>
<!-- expert_agg_l16_dp3 -->
<g id="node1679" class="node">
<title>expert_agg_l16_dp3</title>
<polygon fill="lightyellow" stroke="black" points="503488.57,-176.98 503094.74,-176.98 502993.43,-94.98 503387.26,-94.98 503488.57,-176.98"/>
<text text-anchor="middle" x="503241" y="-144.48" font-family="Arial" font-size="10.00">Expert Aggregation L16</text>
<text text-anchor="middle" x="503241" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="503241" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert0_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2811" class="edge">
<title>expert0_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M502957.66,-135.98C502983.06,-135.98 503008.47,-135.98 503033.87,-135.98"/>
<polygon fill="black" stroke="black" points="503033.99,-139.48 503043.99,-135.98 503033.99,-132.48 503033.99,-139.48"/>
</g>
<!-- expert1_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2812" class="edge">
<title>expert1_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M502651.68,-162.02C502675.02,-171.58 502702.79,-181.22 502729,-185.98 502779.07,-195.08 502907.3,-190.43 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert2_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2813" class="edge">
<title>expert2_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M502404.68,-162.02C502428.02,-171.58 502455.79,-181.22 502482,-185.98 502534.03,-195.44 502905.31,-190.6 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert3_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2814" class="edge">
<title>expert3_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M502157.68,-162.02C502181.02,-171.58 502208.79,-181.22 502235,-185.98 502314.04,-200.35 502877.97,-193 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert4_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2815" class="edge">
<title>expert4_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M501910.68,-162.02C501934.02,-171.58 501961.79,-181.22 501988,-185.98 502041.02,-195.62 502904.32,-190.69 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert5_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2816" class="edge">
<title>expert5_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M501663.68,-162.02C501687.02,-171.58 501714.79,-181.22 501741,-185.98 501807.52,-198.07 502890.65,-191.89 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert6_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2817" class="edge">
<title>expert6_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M501416.68,-162.02C501440.02,-171.58 501467.79,-181.22 501494,-185.98 501574.02,-200.53 502876.98,-193.09 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert7_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2818" class="edge">
<title>expert7_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M501169.68,-162.02C501193.02,-171.58 501220.79,-181.22 501247,-185.98 501293.76,-194.48 502910.65,-190.13 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert8_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2819" class="edge">
<title>expert8_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M500922.68,-162.02C500946.02,-171.58 500973.79,-181.22 501000,-185.98 501053.51,-195.71 502903.82,-190.73 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert9_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2820" class="edge">
<title>expert9_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M500675.68,-162.02C500699.02,-171.58 500726.79,-181.22 500753,-185.98 500813.26,-196.94 502896.98,-191.33 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert10_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2821" class="edge">
<title>expert10_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M500428.68,-162.02C500452.02,-171.58 500479.79,-181.22 500506,-185.98 500573.01,-198.16 502890.15,-191.93 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert11_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2822" class="edge">
<title>expert11_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M500181.68,-162.02C500205.02,-171.58 500232.79,-181.22 500259,-185.98 500332.76,-199.39 502883.31,-192.53 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert12_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2823" class="edge">
<title>expert12_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M499934.68,-162.02C499958.02,-171.58 499985.79,-181.22 500012,-185.98 500092.51,-200.62 502876.48,-193.13 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert13_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2824" class="edge">
<title>expert13_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M499687.68,-162.02C499711.02,-171.58 499738.79,-181.22 499765,-185.98 499808.63,-193.91 502913.82,-189.86 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert14_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2825" class="edge">
<title>expert14_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M499440.68,-162.02C499464.02,-171.58 499491.79,-181.22 499518,-185.98 499565.01,-194.53 502910.4,-190.15 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- expert15_l16_dp3&#45;&gt;expert_agg_l16_dp3 -->
<g id="edge2826" class="edge">
<title>expert15_l16_dp3&#45;&gt;expert_agg_l16_dp3</title>
<path fill="none" stroke="black" d="M499121.92,-162.01C499167.73,-171.59 499221.65,-181.26 499271,-185.98 499372.95,-195.73 502855.97,-194.93 502958,-185.98 502995.75,-182.67 503036.02,-176.93 503073.98,-170.48"/>
<polygon fill="black" stroke="black" points="503074.84,-173.88 503084.1,-168.73 503073.65,-166.98 503074.84,-173.88"/>
</g>
<!-- layer16_output_dp3 -->
<g id="node1680" class="node">
<title>layer16_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="503693" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="503693" y="-144.48" font-family="Arial" font-size="10.00">Layer 16 Output</text>
<text text-anchor="middle" x="503693" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="503693" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- expert_agg_l16_dp3&#45;&gt;layer16_output_dp3 -->
<g id="edge2827" class="edge">
<title>expert_agg_l16_dp3&#45;&gt;layer16_output_dp3</title>
<path fill="none" stroke="black" d="M503438.31,-135.98C503463.49,-135.98 503488.66,-135.98 503513.84,-135.98"/>
<polygon fill="black" stroke="black" points="503513.87,-139.48 503523.87,-135.98 503513.87,-132.48 503513.87,-139.48"/>
</g>
<!-- stage2_output_dp3 -->
<g id="node1681" class="node">
<title>stage2_output_dp3</title>
<ellipse fill="lightblue" stroke="black" cx="504066" cy="-135.98" rx="169" ry="28.98"/>
<text text-anchor="middle" x="504066" y="-144.48" font-family="Arial" font-size="10.00">Stage 2 Output</text>
<text text-anchor="middle" x="504066" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=1, seq_len=1024, hidden=512]</text>
<text text-anchor="middle" x="504066" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=1, seq_len=1024, hidden=512]</text>
</g>
<!-- layer16_output_dp3&#45;&gt;stage2_output_dp3 -->
<g id="edge2828" class="edge">
<title>layer16_output_dp3&#45;&gt;stage2_output_dp3</title>
<path fill="none" stroke="black" d="M503862.01,-135.98C503870.23,-135.98 503878.44,-135.98 503886.66,-135.98"/>
<polygon fill="black" stroke="black" points="503886.68,-139.48 503896.68,-135.98 503886.68,-132.48 503886.68,-139.48"/>
</g>
<!-- stage2_output_dp3&#45;&gt;output -->
<g id="edge2832" class="edge">
<title>stage2_output_dp3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M503972.37,-111.78C503940.42,-104.94 503904.35,-98.37 503871,-94.98 503233.93,-30.2 322741.92,-29.98 316251.35,-29.99"/>
<polygon fill="black" stroke="black" points="316251.09,-26.49 316241.09,-29.99 316251.09,-33.49 316251.09,-26.49"/>
</g>
</g>
</svg>
