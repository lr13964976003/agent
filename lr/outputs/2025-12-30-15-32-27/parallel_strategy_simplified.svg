<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Parallel Strategy Deployment DAG &#45; Simplified -->
<!-- Title: Parallel Strategy Deployment DAG &#45; Simplified Pages: 1 -->
<svg width="961pt" height="15000pt"
 viewBox="0.00 0.00 230.65 3600.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.91 1.91) rotate(0) translate(4 7855.72)">
<title>Parallel Strategy Deployment DAG &#45; Simplified</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-7855.72 499.57,-7855.72 499.57,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="362.78,-7851.72 132.78,-7851.72 132.78,-7815.72 362.78,-7815.72 362.78,-7851.72"/>
<text text-anchor="middle" x="247.78" y="-7836.72" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="247.78" y="-7825.72" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=32]</text>
</g>
<!-- mha_0 -->
<g id="node2" class="node">
<title>mha_0</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-7779.72 130.28,-7779.72 130.28,-7738.72 365.28,-7738.72 365.28,-7779.72"/>
<text text-anchor="middle" x="247.78" y="-7767.72" font-family="Arial" font-size="10.00">MHA Layer 0</text>
<text text-anchor="middle" x="247.78" y="-7756.72" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-7745.72" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;mha_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M247.78,-7815.54C247.78,-7807.92 247.78,-7798.73 247.78,-7790.04"/>
<polygon fill="black" stroke="black" points="251.28,-7789.84 247.78,-7779.84 244.28,-7789.84 251.28,-7789.84"/>
</g>
<!-- gate_0 -->
<g id="node3" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-7702.72 101.53,-7702.72 0.22,-7620.72 394.04,-7620.72 495.35,-7702.72"/>
<text text-anchor="middle" x="247.78" y="-7670.22" font-family="Arial" font-size="10.00">Gate Layer 0</text>
<text text-anchor="middle" x="247.78" y="-7659.22" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-7648.22" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_0&#45;&gt;gate_0 -->
<g id="edge2" class="edge">
<title>mha_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M247.78,-7738.44C247.78,-7730.97 247.78,-7722.1 247.78,-7713.11"/>
<polygon fill="black" stroke="black" points="251.28,-7712.97 247.78,-7702.97 244.28,-7712.97 251.28,-7712.97"/>
</g>
<!-- comm_0 -->
<g id="node4" class="node">
<title>comm_0</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-7555.73" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-7564.23" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-7553.23" font-family="Arial" font-size="10.00">GPUs: 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-7542.23" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_0&#45;&gt;comm_0 -->
<g id="edge3" class="edge">
<title>gate_0&#45;&gt;comm_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-7620.52C247.78,-7612.16 247.78,-7603.37 247.78,-7595.08"/>
<polygon fill="red" stroke="red" points="251.28,-7594.92 247.78,-7584.92 244.28,-7594.92 251.28,-7594.92"/>
</g>
<!-- experts_0 -->
<g id="node5" class="node">
<title>experts_0</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-7490.74 135.78,-7490.74 135.78,-7449.74 359.78,-7449.74 359.78,-7490.74"/>
<text text-anchor="middle" x="247.78" y="-7478.74" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-7467.74" font-family="Arial" font-size="10.00">GPUs: 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-7456.74" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0&#45;&gt;experts_0 -->
<g id="edge4" class="edge">
<title>comm_0&#45;&gt;experts_0</title>
<path fill="none" stroke="black" d="M247.78,-7526.47C247.78,-7518.22 247.78,-7509.18 247.78,-7500.85"/>
<polygon fill="black" stroke="black" points="251.28,-7500.79 247.78,-7490.79 244.28,-7500.79 251.28,-7500.79"/>
</g>
<!-- agg_0 -->
<g id="node6" class="node">
<title>agg_0</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-7413.74 103.77,-7413.74 4.01,-7331.74 391.8,-7331.74 491.56,-7413.74"/>
<text text-anchor="middle" x="247.78" y="-7381.24" font-family="Arial" font-size="10.00">Aggregate Layer 0</text>
<text text-anchor="middle" x="247.78" y="-7370.24" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-7359.24" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_0&#45;&gt;agg_0 -->
<g id="edge5" class="edge">
<title>experts_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M247.78,-7449.45C247.78,-7441.99 247.78,-7433.12 247.78,-7424.13"/>
<polygon fill="black" stroke="black" points="251.28,-7423.99 247.78,-7413.99 244.28,-7423.99 251.28,-7423.99"/>
</g>
<!-- mha_1 -->
<g id="node7" class="node">
<title>mha_1</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-7295.74 130.28,-7295.74 130.28,-7254.74 365.28,-7254.74 365.28,-7295.74"/>
<text text-anchor="middle" x="247.78" y="-7283.74" font-family="Arial" font-size="10.00">MHA Layer 1</text>
<text text-anchor="middle" x="247.78" y="-7272.74" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-7261.74" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_0&#45;&gt;mha_1 -->
<g id="edge6" class="edge">
<title>agg_0&#45;&gt;mha_1</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-7331.52C247.78,-7322.94 247.78,-7314.03 247.78,-7305.93"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-7305.85 247.78,-7295.85 244.28,-7305.85 251.28,-7305.85"/>
</g>
<!-- gate_1 -->
<g id="node8" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-7218.74 101.53,-7218.74 0.22,-7136.74 394.04,-7136.74 495.35,-7218.74"/>
<text text-anchor="middle" x="247.78" y="-7186.24" font-family="Arial" font-size="10.00">Gate Layer 1</text>
<text text-anchor="middle" x="247.78" y="-7175.24" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-7164.24" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_1&#45;&gt;gate_1 -->
<g id="edge7" class="edge">
<title>mha_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M247.78,-7254.45C247.78,-7246.99 247.78,-7238.12 247.78,-7229.13"/>
<polygon fill="black" stroke="black" points="251.28,-7228.99 247.78,-7218.99 244.28,-7228.99 251.28,-7228.99"/>
</g>
<!-- comm_1 -->
<g id="node9" class="node">
<title>comm_1</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-7071.75" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-7080.25" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-7069.25" font-family="Arial" font-size="10.00">GPUs: 16&#45;31</text>
<text text-anchor="middle" x="247.78" y="-7058.25" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_1&#45;&gt;comm_1 -->
<g id="edge8" class="edge">
<title>gate_1&#45;&gt;comm_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-7136.54C247.78,-7128.18 247.78,-7119.39 247.78,-7111.1"/>
<polygon fill="red" stroke="red" points="251.28,-7110.93 247.78,-7100.93 244.28,-7110.93 251.28,-7110.93"/>
</g>
<!-- experts_1 -->
<g id="node10" class="node">
<title>experts_1</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-7006.76 135.78,-7006.76 135.78,-6965.76 359.78,-6965.76 359.78,-7006.76"/>
<text text-anchor="middle" x="247.78" y="-6994.76" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-6983.76" font-family="Arial" font-size="10.00">GPUs: 16&#45;31</text>
<text text-anchor="middle" x="247.78" y="-6972.76" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1&#45;&gt;experts_1 -->
<g id="edge9" class="edge">
<title>comm_1&#45;&gt;experts_1</title>
<path fill="none" stroke="black" d="M247.78,-7042.48C247.78,-7034.23 247.78,-7025.2 247.78,-7016.87"/>
<polygon fill="black" stroke="black" points="251.28,-7016.81 247.78,-7006.81 244.28,-7016.81 251.28,-7016.81"/>
</g>
<!-- agg_1 -->
<g id="node11" class="node">
<title>agg_1</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-6929.76 103.77,-6929.76 4.01,-6847.76 391.8,-6847.76 491.56,-6929.76"/>
<text text-anchor="middle" x="247.78" y="-6897.26" font-family="Arial" font-size="10.00">Aggregate Layer 1</text>
<text text-anchor="middle" x="247.78" y="-6886.26" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-6875.26" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_1&#45;&gt;agg_1 -->
<g id="edge10" class="edge">
<title>experts_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M247.78,-6965.47C247.78,-6958.01 247.78,-6949.14 247.78,-6940.14"/>
<polygon fill="black" stroke="black" points="251.28,-6940 247.78,-6930 244.28,-6940 251.28,-6940"/>
</g>
<!-- mha_2 -->
<g id="node12" class="node">
<title>mha_2</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-6811.76 130.28,-6811.76 130.28,-6770.76 365.28,-6770.76 365.28,-6811.76"/>
<text text-anchor="middle" x="247.78" y="-6799.76" font-family="Arial" font-size="10.00">MHA Layer 2</text>
<text text-anchor="middle" x="247.78" y="-6788.76" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-6777.76" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_1&#45;&gt;mha_2 -->
<g id="edge11" class="edge">
<title>agg_1&#45;&gt;mha_2</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-6847.53C247.78,-6838.96 247.78,-6830.05 247.78,-6821.95"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-6821.87 247.78,-6811.87 244.28,-6821.87 251.28,-6821.87"/>
</g>
<!-- gate_2 -->
<g id="node13" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-6734.76 101.53,-6734.76 0.22,-6652.76 394.04,-6652.76 495.35,-6734.76"/>
<text text-anchor="middle" x="247.78" y="-6702.26" font-family="Arial" font-size="10.00">Gate Layer 2</text>
<text text-anchor="middle" x="247.78" y="-6691.26" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-6680.26" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_2&#45;&gt;gate_2 -->
<g id="edge12" class="edge">
<title>mha_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M247.78,-6770.47C247.78,-6763.01 247.78,-6754.14 247.78,-6745.14"/>
<polygon fill="black" stroke="black" points="251.28,-6745 247.78,-6735 244.28,-6745 251.28,-6745"/>
</g>
<!-- comm_2 -->
<g id="node14" class="node">
<title>comm_2</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-6587.77" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-6596.27" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-6585.27" font-family="Arial" font-size="10.00">GPUs: 32&#45;47</text>
<text text-anchor="middle" x="247.78" y="-6574.27" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_2&#45;&gt;comm_2 -->
<g id="edge13" class="edge">
<title>gate_2&#45;&gt;comm_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-6652.55C247.78,-6644.19 247.78,-6635.41 247.78,-6627.12"/>
<polygon fill="red" stroke="red" points="251.28,-6626.95 247.78,-6616.95 244.28,-6626.95 251.28,-6626.95"/>
</g>
<!-- experts_2 -->
<g id="node15" class="node">
<title>experts_2</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-6522.78 135.78,-6522.78 135.78,-6481.78 359.78,-6481.78 359.78,-6522.78"/>
<text text-anchor="middle" x="247.78" y="-6510.78" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-6499.78" font-family="Arial" font-size="10.00">GPUs: 32&#45;47</text>
<text text-anchor="middle" x="247.78" y="-6488.78" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_2&#45;&gt;experts_2 -->
<g id="edge14" class="edge">
<title>comm_2&#45;&gt;experts_2</title>
<path fill="none" stroke="black" d="M247.78,-6558.5C247.78,-6550.25 247.78,-6541.22 247.78,-6532.89"/>
<polygon fill="black" stroke="black" points="251.28,-6532.82 247.78,-6522.82 244.28,-6532.82 251.28,-6532.82"/>
</g>
<!-- agg_2 -->
<g id="node16" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-6445.78 103.77,-6445.78 4.01,-6363.78 391.8,-6363.78 491.56,-6445.78"/>
<text text-anchor="middle" x="247.78" y="-6413.28" font-family="Arial" font-size="10.00">Aggregate Layer 2</text>
<text text-anchor="middle" x="247.78" y="-6402.28" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-6391.28" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_2&#45;&gt;agg_2 -->
<g id="edge15" class="edge">
<title>experts_2&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M247.78,-6481.49C247.78,-6474.03 247.78,-6465.16 247.78,-6456.16"/>
<polygon fill="black" stroke="black" points="251.28,-6456.02 247.78,-6446.02 244.28,-6456.02 251.28,-6456.02"/>
</g>
<!-- mha_3 -->
<g id="node17" class="node">
<title>mha_3</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-6327.78 130.28,-6327.78 130.28,-6286.78 365.28,-6286.78 365.28,-6327.78"/>
<text text-anchor="middle" x="247.78" y="-6315.78" font-family="Arial" font-size="10.00">MHA Layer 3</text>
<text text-anchor="middle" x="247.78" y="-6304.78" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-6293.78" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_2&#45;&gt;mha_3 -->
<g id="edge16" class="edge">
<title>agg_2&#45;&gt;mha_3</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-6363.55C247.78,-6354.97 247.78,-6346.06 247.78,-6337.97"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-6337.89 247.78,-6327.89 244.28,-6337.89 251.28,-6337.89"/>
</g>
<!-- gate_3 -->
<g id="node18" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-6250.78 101.53,-6250.78 0.22,-6168.78 394.04,-6168.78 495.35,-6250.78"/>
<text text-anchor="middle" x="247.78" y="-6218.28" font-family="Arial" font-size="10.00">Gate Layer 3</text>
<text text-anchor="middle" x="247.78" y="-6207.28" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-6196.28" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_3&#45;&gt;gate_3 -->
<g id="edge17" class="edge">
<title>mha_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M247.78,-6286.49C247.78,-6279.03 247.78,-6270.16 247.78,-6261.16"/>
<polygon fill="black" stroke="black" points="251.28,-6261.02 247.78,-6251.02 244.28,-6261.02 251.28,-6261.02"/>
</g>
<!-- comm_3 -->
<g id="node19" class="node">
<title>comm_3</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-6103.78" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-6112.28" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-6101.28" font-family="Arial" font-size="10.00">GPUs: 48&#45;63</text>
<text text-anchor="middle" x="247.78" y="-6090.28" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_3&#45;&gt;comm_3 -->
<g id="edge18" class="edge">
<title>gate_3&#45;&gt;comm_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-6168.57C247.78,-6160.21 247.78,-6151.42 247.78,-6143.13"/>
<polygon fill="red" stroke="red" points="251.28,-6142.97 247.78,-6132.97 244.28,-6142.97 251.28,-6142.97"/>
</g>
<!-- experts_3 -->
<g id="node20" class="node">
<title>experts_3</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-6038.79 135.78,-6038.79 135.78,-5997.79 359.78,-5997.79 359.78,-6038.79"/>
<text text-anchor="middle" x="247.78" y="-6026.79" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-6015.79" font-family="Arial" font-size="10.00">GPUs: 48&#45;63</text>
<text text-anchor="middle" x="247.78" y="-6004.79" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_3&#45;&gt;experts_3 -->
<g id="edge19" class="edge">
<title>comm_3&#45;&gt;experts_3</title>
<path fill="none" stroke="black" d="M247.78,-6074.52C247.78,-6066.27 247.78,-6057.23 247.78,-6048.9"/>
<polygon fill="black" stroke="black" points="251.28,-6048.84 247.78,-6038.84 244.28,-6048.84 251.28,-6048.84"/>
</g>
<!-- agg_3 -->
<g id="node21" class="node">
<title>agg_3</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-5961.79 103.77,-5961.79 4.01,-5879.79 391.8,-5879.79 491.56,-5961.79"/>
<text text-anchor="middle" x="247.78" y="-5929.29" font-family="Arial" font-size="10.00">Aggregate Layer 3</text>
<text text-anchor="middle" x="247.78" y="-5918.29" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-5907.29" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_3&#45;&gt;agg_3 -->
<g id="edge20" class="edge">
<title>experts_3&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M247.78,-5997.51C247.78,-5990.04 247.78,-5981.17 247.78,-5972.18"/>
<polygon fill="black" stroke="black" points="251.28,-5972.04 247.78,-5962.04 244.28,-5972.04 251.28,-5972.04"/>
</g>
<!-- mha_4 -->
<g id="node22" class="node">
<title>mha_4</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-5843.79 130.28,-5843.79 130.28,-5802.79 365.28,-5802.79 365.28,-5843.79"/>
<text text-anchor="middle" x="247.78" y="-5831.79" font-family="Arial" font-size="10.00">MHA Layer 4</text>
<text text-anchor="middle" x="247.78" y="-5820.79" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-5809.79" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_3&#45;&gt;mha_4 -->
<g id="edge21" class="edge">
<title>agg_3&#45;&gt;mha_4</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-5879.57C247.78,-5870.99 247.78,-5862.08 247.78,-5853.98"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-5853.9 247.78,-5843.9 244.28,-5853.9 251.28,-5853.9"/>
</g>
<!-- gate_4 -->
<g id="node23" class="node">
<title>gate_4</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-5766.79 101.53,-5766.79 0.22,-5684.79 394.04,-5684.79 495.35,-5766.79"/>
<text text-anchor="middle" x="247.78" y="-5734.29" font-family="Arial" font-size="10.00">Gate Layer 4</text>
<text text-anchor="middle" x="247.78" y="-5723.29" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-5712.29" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_4&#45;&gt;gate_4 -->
<g id="edge22" class="edge">
<title>mha_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M247.78,-5802.51C247.78,-5795.04 247.78,-5786.17 247.78,-5777.18"/>
<polygon fill="black" stroke="black" points="251.28,-5777.04 247.78,-5767.04 244.28,-5777.04 251.28,-5777.04"/>
</g>
<!-- comm_4 -->
<g id="node24" class="node">
<title>comm_4</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-5619.8" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-5628.3" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-5617.3" font-family="Arial" font-size="10.00">GPUs: 64&#45;79</text>
<text text-anchor="middle" x="247.78" y="-5606.3" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_4&#45;&gt;comm_4 -->
<g id="edge23" class="edge">
<title>gate_4&#45;&gt;comm_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-5684.59C247.78,-5676.23 247.78,-5667.44 247.78,-5659.15"/>
<polygon fill="red" stroke="red" points="251.28,-5658.99 247.78,-5648.99 244.28,-5658.99 251.28,-5658.99"/>
</g>
<!-- experts_4 -->
<g id="node25" class="node">
<title>experts_4</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-5554.81 135.78,-5554.81 135.78,-5513.81 359.78,-5513.81 359.78,-5554.81"/>
<text text-anchor="middle" x="247.78" y="-5542.81" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-5531.81" font-family="Arial" font-size="10.00">GPUs: 64&#45;79</text>
<text text-anchor="middle" x="247.78" y="-5520.81" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_4&#45;&gt;experts_4 -->
<g id="edge24" class="edge">
<title>comm_4&#45;&gt;experts_4</title>
<path fill="none" stroke="black" d="M247.78,-5590.54C247.78,-5582.29 247.78,-5573.25 247.78,-5564.92"/>
<polygon fill="black" stroke="black" points="251.28,-5564.86 247.78,-5554.86 244.28,-5564.86 251.28,-5564.86"/>
</g>
<!-- agg_4 -->
<g id="node26" class="node">
<title>agg_4</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-5477.81 103.77,-5477.81 4.01,-5395.81 391.8,-5395.81 491.56,-5477.81"/>
<text text-anchor="middle" x="247.78" y="-5445.31" font-family="Arial" font-size="10.00">Aggregate Layer 4</text>
<text text-anchor="middle" x="247.78" y="-5434.31" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-5423.31" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_4&#45;&gt;agg_4 -->
<g id="edge25" class="edge">
<title>experts_4&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M247.78,-5513.52C247.78,-5506.06 247.78,-5497.19 247.78,-5488.2"/>
<polygon fill="black" stroke="black" points="251.28,-5488.06 247.78,-5478.06 244.28,-5488.06 251.28,-5488.06"/>
</g>
<!-- mha_5 -->
<g id="node27" class="node">
<title>mha_5</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-5359.81 130.28,-5359.81 130.28,-5318.81 365.28,-5318.81 365.28,-5359.81"/>
<text text-anchor="middle" x="247.78" y="-5347.81" font-family="Arial" font-size="10.00">MHA Layer 5</text>
<text text-anchor="middle" x="247.78" y="-5336.81" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-5325.81" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_4&#45;&gt;mha_5 -->
<g id="edge26" class="edge">
<title>agg_4&#45;&gt;mha_5</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-5395.59C247.78,-5387.01 247.78,-5378.1 247.78,-5370"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-5369.92 247.78,-5359.92 244.28,-5369.92 251.28,-5369.92"/>
</g>
<!-- gate_5 -->
<g id="node28" class="node">
<title>gate_5</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-5282.81 101.53,-5282.81 0.22,-5200.81 394.04,-5200.81 495.35,-5282.81"/>
<text text-anchor="middle" x="247.78" y="-5250.31" font-family="Arial" font-size="10.00">Gate Layer 5</text>
<text text-anchor="middle" x="247.78" y="-5239.31" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-5228.31" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_5&#45;&gt;gate_5 -->
<g id="edge27" class="edge">
<title>mha_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M247.78,-5318.52C247.78,-5311.06 247.78,-5302.19 247.78,-5293.2"/>
<polygon fill="black" stroke="black" points="251.28,-5293.06 247.78,-5283.06 244.28,-5293.06 251.28,-5293.06"/>
</g>
<!-- comm_5 -->
<g id="node29" class="node">
<title>comm_5</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-5135.82" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-5144.32" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-5133.32" font-family="Arial" font-size="10.00">GPUs: 80&#45;95</text>
<text text-anchor="middle" x="247.78" y="-5122.32" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_5&#45;&gt;comm_5 -->
<g id="edge28" class="edge">
<title>gate_5&#45;&gt;comm_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-5200.6C247.78,-5192.25 247.78,-5183.46 247.78,-5175.17"/>
<polygon fill="red" stroke="red" points="251.28,-5175 247.78,-5165 244.28,-5175 251.28,-5175"/>
</g>
<!-- experts_5 -->
<g id="node30" class="node">
<title>experts_5</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-5070.83 135.78,-5070.83 135.78,-5029.83 359.78,-5029.83 359.78,-5070.83"/>
<text text-anchor="middle" x="247.78" y="-5058.83" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-5047.83" font-family="Arial" font-size="10.00">GPUs: 80&#45;95</text>
<text text-anchor="middle" x="247.78" y="-5036.83" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_5&#45;&gt;experts_5 -->
<g id="edge29" class="edge">
<title>comm_5&#45;&gt;experts_5</title>
<path fill="none" stroke="black" d="M247.78,-5106.55C247.78,-5098.3 247.78,-5089.27 247.78,-5080.94"/>
<polygon fill="black" stroke="black" points="251.28,-5080.88 247.78,-5070.88 244.28,-5080.88 251.28,-5080.88"/>
</g>
<!-- agg_5 -->
<g id="node31" class="node">
<title>agg_5</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-4993.83 103.77,-4993.83 4.01,-4911.83 391.8,-4911.83 491.56,-4993.83"/>
<text text-anchor="middle" x="247.78" y="-4961.33" font-family="Arial" font-size="10.00">Aggregate Layer 5</text>
<text text-anchor="middle" x="247.78" y="-4950.33" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-4939.33" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_5&#45;&gt;agg_5 -->
<g id="edge30" class="edge">
<title>experts_5&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M247.78,-5029.54C247.78,-5022.08 247.78,-5013.21 247.78,-5004.21"/>
<polygon fill="black" stroke="black" points="251.28,-5004.07 247.78,-4994.07 244.28,-5004.07 251.28,-5004.07"/>
</g>
<!-- mha_6 -->
<g id="node32" class="node">
<title>mha_6</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-4875.83 130.28,-4875.83 130.28,-4834.83 365.28,-4834.83 365.28,-4875.83"/>
<text text-anchor="middle" x="247.78" y="-4863.83" font-family="Arial" font-size="10.00">MHA Layer 6</text>
<text text-anchor="middle" x="247.78" y="-4852.83" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-4841.83" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_5&#45;&gt;mha_6 -->
<g id="edge31" class="edge">
<title>agg_5&#45;&gt;mha_6</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-4911.6C247.78,-4903.03 247.78,-4894.12 247.78,-4886.02"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-4885.94 247.78,-4875.94 244.28,-4885.94 251.28,-4885.94"/>
</g>
<!-- gate_6 -->
<g id="node33" class="node">
<title>gate_6</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-4798.83 101.53,-4798.83 0.22,-4716.83 394.04,-4716.83 495.35,-4798.83"/>
<text text-anchor="middle" x="247.78" y="-4766.33" font-family="Arial" font-size="10.00">Gate Layer 6</text>
<text text-anchor="middle" x="247.78" y="-4755.33" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-4744.33" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_6&#45;&gt;gate_6 -->
<g id="edge32" class="edge">
<title>mha_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M247.78,-4834.54C247.78,-4827.08 247.78,-4818.21 247.78,-4809.21"/>
<polygon fill="black" stroke="black" points="251.28,-4809.07 247.78,-4799.07 244.28,-4809.07 251.28,-4809.07"/>
</g>
<!-- comm_6 -->
<g id="node34" class="node">
<title>comm_6</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-4651.84" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-4660.34" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-4649.34" font-family="Arial" font-size="10.00">GPUs: 96&#45;111</text>
<text text-anchor="middle" x="247.78" y="-4638.34" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_6&#45;&gt;comm_6 -->
<g id="edge33" class="edge">
<title>gate_6&#45;&gt;comm_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-4716.62C247.78,-4708.26 247.78,-4699.47 247.78,-4691.19"/>
<polygon fill="red" stroke="red" points="251.28,-4691.02 247.78,-4681.02 244.28,-4691.02 251.28,-4691.02"/>
</g>
<!-- experts_6 -->
<g id="node35" class="node">
<title>experts_6</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-4586.84 135.78,-4586.84 135.78,-4545.84 359.78,-4545.84 359.78,-4586.84"/>
<text text-anchor="middle" x="247.78" y="-4574.84" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-4563.84" font-family="Arial" font-size="10.00">GPUs: 96&#45;111</text>
<text text-anchor="middle" x="247.78" y="-4552.84" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_6&#45;&gt;experts_6 -->
<g id="edge34" class="edge">
<title>comm_6&#45;&gt;experts_6</title>
<path fill="none" stroke="black" d="M247.78,-4622.57C247.78,-4614.32 247.78,-4605.28 247.78,-4596.95"/>
<polygon fill="black" stroke="black" points="251.28,-4596.89 247.78,-4586.89 244.28,-4596.89 251.28,-4596.89"/>
</g>
<!-- agg_6 -->
<g id="node36" class="node">
<title>agg_6</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-4509.84 103.77,-4509.84 4.01,-4427.84 391.8,-4427.84 491.56,-4509.84"/>
<text text-anchor="middle" x="247.78" y="-4477.34" font-family="Arial" font-size="10.00">Aggregate Layer 6</text>
<text text-anchor="middle" x="247.78" y="-4466.34" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-4455.34" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_6&#45;&gt;agg_6 -->
<g id="edge35" class="edge">
<title>experts_6&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M247.78,-4545.56C247.78,-4538.09 247.78,-4529.22 247.78,-4520.23"/>
<polygon fill="black" stroke="black" points="251.28,-4520.09 247.78,-4510.09 244.28,-4520.09 251.28,-4520.09"/>
</g>
<!-- mha_7 -->
<g id="node37" class="node">
<title>mha_7</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-4391.84 130.28,-4391.84 130.28,-4350.84 365.28,-4350.84 365.28,-4391.84"/>
<text text-anchor="middle" x="247.78" y="-4379.84" font-family="Arial" font-size="10.00">MHA Layer 7</text>
<text text-anchor="middle" x="247.78" y="-4368.84" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-4357.84" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_6&#45;&gt;mha_7 -->
<g id="edge36" class="edge">
<title>agg_6&#45;&gt;mha_7</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-4427.62C247.78,-4419.04 247.78,-4410.13 247.78,-4402.04"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-4401.96 247.78,-4391.96 244.28,-4401.96 251.28,-4401.96"/>
</g>
<!-- gate_7 -->
<g id="node38" class="node">
<title>gate_7</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-4314.84 101.53,-4314.84 0.22,-4232.84 394.04,-4232.84 495.35,-4314.84"/>
<text text-anchor="middle" x="247.78" y="-4282.34" font-family="Arial" font-size="10.00">Gate Layer 7</text>
<text text-anchor="middle" x="247.78" y="-4271.34" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-4260.34" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_7&#45;&gt;gate_7 -->
<g id="edge37" class="edge">
<title>mha_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M247.78,-4350.56C247.78,-4343.09 247.78,-4334.22 247.78,-4325.23"/>
<polygon fill="black" stroke="black" points="251.28,-4325.09 247.78,-4315.09 244.28,-4325.09 251.28,-4325.09"/>
</g>
<!-- comm_7 -->
<g id="node39" class="node">
<title>comm_7</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-4167.85" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-4176.35" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-4165.35" font-family="Arial" font-size="10.00">GPUs: 112&#45;127</text>
<text text-anchor="middle" x="247.78" y="-4154.35" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_7&#45;&gt;comm_7 -->
<g id="edge38" class="edge">
<title>gate_7&#45;&gt;comm_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-4232.64C247.78,-4224.28 247.78,-4215.49 247.78,-4207.2"/>
<polygon fill="red" stroke="red" points="251.28,-4207.04 247.78,-4197.04 244.28,-4207.04 251.28,-4207.04"/>
</g>
<!-- experts_7 -->
<g id="node40" class="node">
<title>experts_7</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-4102.86 135.78,-4102.86 135.78,-4061.86 359.78,-4061.86 359.78,-4102.86"/>
<text text-anchor="middle" x="247.78" y="-4090.86" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-4079.86" font-family="Arial" font-size="10.00">GPUs: 112&#45;127</text>
<text text-anchor="middle" x="247.78" y="-4068.86" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_7&#45;&gt;experts_7 -->
<g id="edge39" class="edge">
<title>comm_7&#45;&gt;experts_7</title>
<path fill="none" stroke="black" d="M247.78,-4138.59C247.78,-4130.34 247.78,-4121.3 247.78,-4112.97"/>
<polygon fill="black" stroke="black" points="251.28,-4112.91 247.78,-4102.91 244.28,-4112.91 251.28,-4112.91"/>
</g>
<!-- agg_7 -->
<g id="node41" class="node">
<title>agg_7</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-4025.86 103.77,-4025.86 4.01,-3943.86 391.8,-3943.86 491.56,-4025.86"/>
<text text-anchor="middle" x="247.78" y="-3993.36" font-family="Arial" font-size="10.00">Aggregate Layer 7</text>
<text text-anchor="middle" x="247.78" y="-3982.36" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3971.36" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_7&#45;&gt;agg_7 -->
<g id="edge40" class="edge">
<title>experts_7&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M247.78,-4061.57C247.78,-4054.11 247.78,-4045.24 247.78,-4036.25"/>
<polygon fill="black" stroke="black" points="251.28,-4036.11 247.78,-4026.11 244.28,-4036.11 251.28,-4036.11"/>
</g>
<!-- mha_8 -->
<g id="node42" class="node">
<title>mha_8</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-3907.86 130.28,-3907.86 130.28,-3866.86 365.28,-3866.86 365.28,-3907.86"/>
<text text-anchor="middle" x="247.78" y="-3895.86" font-family="Arial" font-size="10.00">MHA Layer 8</text>
<text text-anchor="middle" x="247.78" y="-3884.86" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3873.86" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_7&#45;&gt;mha_8 -->
<g id="edge41" class="edge">
<title>agg_7&#45;&gt;mha_8</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-3943.64C247.78,-3935.06 247.78,-3926.15 247.78,-3918.05"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-3917.97 247.78,-3907.97 244.28,-3917.97 251.28,-3917.97"/>
</g>
<!-- gate_8 -->
<g id="node43" class="node">
<title>gate_8</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-3830.86 101.53,-3830.86 0.22,-3748.86 394.04,-3748.86 495.35,-3830.86"/>
<text text-anchor="middle" x="247.78" y="-3798.36" font-family="Arial" font-size="10.00">Gate Layer 8</text>
<text text-anchor="middle" x="247.78" y="-3787.36" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3776.36" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_8&#45;&gt;gate_8 -->
<g id="edge42" class="edge">
<title>mha_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M247.78,-3866.57C247.78,-3859.11 247.78,-3850.24 247.78,-3841.25"/>
<polygon fill="black" stroke="black" points="251.28,-3841.11 247.78,-3831.11 244.28,-3841.11 251.28,-3841.11"/>
</g>
<!-- comm_8 -->
<g id="node44" class="node">
<title>comm_8</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-3683.87" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-3692.37" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-3681.37" font-family="Arial" font-size="10.00">GPUs: 128&#45;143</text>
<text text-anchor="middle" x="247.78" y="-3670.37" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_8&#45;&gt;comm_8 -->
<g id="edge43" class="edge">
<title>gate_8&#45;&gt;comm_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-3748.66C247.78,-3740.3 247.78,-3731.51 247.78,-3723.22"/>
<polygon fill="red" stroke="red" points="251.28,-3723.06 247.78,-3713.06 244.28,-3723.06 251.28,-3723.06"/>
</g>
<!-- experts_8 -->
<g id="node45" class="node">
<title>experts_8</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-3618.88 135.78,-3618.88 135.78,-3577.88 359.78,-3577.88 359.78,-3618.88"/>
<text text-anchor="middle" x="247.78" y="-3606.88" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-3595.88" font-family="Arial" font-size="10.00">GPUs: 128&#45;143</text>
<text text-anchor="middle" x="247.78" y="-3584.88" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_8&#45;&gt;experts_8 -->
<g id="edge44" class="edge">
<title>comm_8&#45;&gt;experts_8</title>
<path fill="none" stroke="black" d="M247.78,-3654.6C247.78,-3646.36 247.78,-3637.32 247.78,-3628.99"/>
<polygon fill="black" stroke="black" points="251.28,-3628.93 247.78,-3618.93 244.28,-3628.93 251.28,-3628.93"/>
</g>
<!-- agg_8 -->
<g id="node46" class="node">
<title>agg_8</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-3541.88 103.77,-3541.88 4.01,-3459.88 391.8,-3459.88 491.56,-3541.88"/>
<text text-anchor="middle" x="247.78" y="-3509.38" font-family="Arial" font-size="10.00">Aggregate Layer 8</text>
<text text-anchor="middle" x="247.78" y="-3498.38" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3487.38" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_8&#45;&gt;agg_8 -->
<g id="edge45" class="edge">
<title>experts_8&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M247.78,-3577.59C247.78,-3570.13 247.78,-3561.26 247.78,-3552.26"/>
<polygon fill="black" stroke="black" points="251.28,-3552.12 247.78,-3542.12 244.28,-3552.12 251.28,-3552.12"/>
</g>
<!-- mha_9 -->
<g id="node47" class="node">
<title>mha_9</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-3423.88 130.28,-3423.88 130.28,-3382.88 365.28,-3382.88 365.28,-3423.88"/>
<text text-anchor="middle" x="247.78" y="-3411.88" font-family="Arial" font-size="10.00">MHA Layer 9</text>
<text text-anchor="middle" x="247.78" y="-3400.88" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3389.88" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_8&#45;&gt;mha_9 -->
<g id="edge46" class="edge">
<title>agg_8&#45;&gt;mha_9</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-3459.66C247.78,-3451.08 247.78,-3442.17 247.78,-3434.07"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-3433.99 247.78,-3423.99 244.28,-3433.99 251.28,-3433.99"/>
</g>
<!-- gate_9 -->
<g id="node48" class="node">
<title>gate_9</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-3346.88 101.53,-3346.88 0.22,-3264.88 394.04,-3264.88 495.35,-3346.88"/>
<text text-anchor="middle" x="247.78" y="-3314.38" font-family="Arial" font-size="10.00">Gate Layer 9</text>
<text text-anchor="middle" x="247.78" y="-3303.38" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3292.38" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_9&#45;&gt;gate_9 -->
<g id="edge47" class="edge">
<title>mha_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M247.78,-3382.59C247.78,-3375.13 247.78,-3366.26 247.78,-3357.26"/>
<polygon fill="black" stroke="black" points="251.28,-3357.12 247.78,-3347.12 244.28,-3357.12 251.28,-3357.12"/>
</g>
<!-- comm_9 -->
<g id="node49" class="node">
<title>comm_9</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-3199.89" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-3208.39" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-3197.39" font-family="Arial" font-size="10.00">GPUs: 144&#45;159</text>
<text text-anchor="middle" x="247.78" y="-3186.39" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_9&#45;&gt;comm_9 -->
<g id="edge48" class="edge">
<title>gate_9&#45;&gt;comm_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-3264.67C247.78,-3256.31 247.78,-3247.53 247.78,-3239.24"/>
<polygon fill="red" stroke="red" points="251.28,-3239.07 247.78,-3229.07 244.28,-3239.07 251.28,-3239.07"/>
</g>
<!-- experts_9 -->
<g id="node50" class="node">
<title>experts_9</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-3134.9 135.78,-3134.9 135.78,-3093.9 359.78,-3093.9 359.78,-3134.9"/>
<text text-anchor="middle" x="247.78" y="-3122.9" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-3111.9" font-family="Arial" font-size="10.00">GPUs: 144&#45;159</text>
<text text-anchor="middle" x="247.78" y="-3100.9" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_9&#45;&gt;experts_9 -->
<g id="edge49" class="edge">
<title>comm_9&#45;&gt;experts_9</title>
<path fill="none" stroke="black" d="M247.78,-3170.62C247.78,-3162.37 247.78,-3153.34 247.78,-3145.01"/>
<polygon fill="black" stroke="black" points="251.28,-3144.95 247.78,-3134.95 244.28,-3144.95 251.28,-3144.95"/>
</g>
<!-- agg_9 -->
<g id="node51" class="node">
<title>agg_9</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-3057.9 103.77,-3057.9 4.01,-2975.9 391.8,-2975.9 491.56,-3057.9"/>
<text text-anchor="middle" x="247.78" y="-3025.4" font-family="Arial" font-size="10.00">Aggregate Layer 9</text>
<text text-anchor="middle" x="247.78" y="-3014.4" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-3003.4" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_9&#45;&gt;agg_9 -->
<g id="edge50" class="edge">
<title>experts_9&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M247.78,-3093.61C247.78,-3086.15 247.78,-3077.28 247.78,-3068.28"/>
<polygon fill="black" stroke="black" points="251.28,-3068.14 247.78,-3058.14 244.28,-3068.14 251.28,-3068.14"/>
</g>
<!-- mha_10 -->
<g id="node52" class="node">
<title>mha_10</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-2939.9 130.28,-2939.9 130.28,-2898.9 365.28,-2898.9 365.28,-2939.9"/>
<text text-anchor="middle" x="247.78" y="-2927.9" font-family="Arial" font-size="10.00">MHA Layer 10</text>
<text text-anchor="middle" x="247.78" y="-2916.9" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-2905.9" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_9&#45;&gt;mha_10 -->
<g id="edge51" class="edge">
<title>agg_9&#45;&gt;mha_10</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-2975.67C247.78,-2967.1 247.78,-2958.19 247.78,-2950.09"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-2950.01 247.78,-2940.01 244.28,-2950.01 251.28,-2950.01"/>
</g>
<!-- gate_10 -->
<g id="node53" class="node">
<title>gate_10</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-2862.9 101.53,-2862.9 0.22,-2780.9 394.04,-2780.9 495.35,-2862.9"/>
<text text-anchor="middle" x="247.78" y="-2830.4" font-family="Arial" font-size="10.00">Gate Layer 10</text>
<text text-anchor="middle" x="247.78" y="-2819.4" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-2808.4" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_10&#45;&gt;gate_10 -->
<g id="edge52" class="edge">
<title>mha_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M247.78,-2898.61C247.78,-2891.15 247.78,-2882.28 247.78,-2873.28"/>
<polygon fill="black" stroke="black" points="251.28,-2873.14 247.78,-2863.14 244.28,-2873.14 251.28,-2873.14"/>
</g>
<!-- comm_10 -->
<g id="node54" class="node">
<title>comm_10</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-2715.91" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-2724.41" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-2713.41" font-family="Arial" font-size="10.00">GPUs: 160&#45;175</text>
<text text-anchor="middle" x="247.78" y="-2702.41" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_10&#45;&gt;comm_10 -->
<g id="edge53" class="edge">
<title>gate_10&#45;&gt;comm_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-2780.69C247.78,-2772.33 247.78,-2763.54 247.78,-2755.25"/>
<polygon fill="red" stroke="red" points="251.28,-2755.09 247.78,-2745.09 244.28,-2755.09 251.28,-2755.09"/>
</g>
<!-- experts_10 -->
<g id="node55" class="node">
<title>experts_10</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-2650.91 135.78,-2650.91 135.78,-2609.91 359.78,-2609.91 359.78,-2650.91"/>
<text text-anchor="middle" x="247.78" y="-2638.91" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-2627.91" font-family="Arial" font-size="10.00">GPUs: 160&#45;175</text>
<text text-anchor="middle" x="247.78" y="-2616.91" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_10&#45;&gt;experts_10 -->
<g id="edge54" class="edge">
<title>comm_10&#45;&gt;experts_10</title>
<path fill="none" stroke="black" d="M247.78,-2686.64C247.78,-2678.39 247.78,-2669.35 247.78,-2661.02"/>
<polygon fill="black" stroke="black" points="251.28,-2660.96 247.78,-2650.96 244.28,-2660.96 251.28,-2660.96"/>
</g>
<!-- agg_10 -->
<g id="node56" class="node">
<title>agg_10</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-2573.91 103.77,-2573.91 4.01,-2491.91 391.8,-2491.91 491.56,-2573.91"/>
<text text-anchor="middle" x="247.78" y="-2541.41" font-family="Arial" font-size="10.00">Aggregate Layer 10</text>
<text text-anchor="middle" x="247.78" y="-2530.41" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-2519.41" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_10&#45;&gt;agg_10 -->
<g id="edge55" class="edge">
<title>experts_10&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M247.78,-2609.63C247.78,-2602.16 247.78,-2593.29 247.78,-2584.3"/>
<polygon fill="black" stroke="black" points="251.28,-2584.16 247.78,-2574.16 244.28,-2584.16 251.28,-2584.16"/>
</g>
<!-- mha_11 -->
<g id="node57" class="node">
<title>mha_11</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-2455.91 130.28,-2455.91 130.28,-2414.91 365.28,-2414.91 365.28,-2455.91"/>
<text text-anchor="middle" x="247.78" y="-2443.91" font-family="Arial" font-size="10.00">MHA Layer 11</text>
<text text-anchor="middle" x="247.78" y="-2432.91" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-2421.91" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_10&#45;&gt;mha_11 -->
<g id="edge56" class="edge">
<title>agg_10&#45;&gt;mha_11</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-2491.69C247.78,-2483.11 247.78,-2474.2 247.78,-2466.11"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-2466.03 247.78,-2456.03 244.28,-2466.03 251.28,-2466.03"/>
</g>
<!-- gate_11 -->
<g id="node58" class="node">
<title>gate_11</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-2378.91 101.53,-2378.91 0.22,-2296.91 394.04,-2296.91 495.35,-2378.91"/>
<text text-anchor="middle" x="247.78" y="-2346.41" font-family="Arial" font-size="10.00">Gate Layer 11</text>
<text text-anchor="middle" x="247.78" y="-2335.41" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-2324.41" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_11&#45;&gt;gate_11 -->
<g id="edge57" class="edge">
<title>mha_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M247.78,-2414.63C247.78,-2407.16 247.78,-2398.29 247.78,-2389.3"/>
<polygon fill="black" stroke="black" points="251.28,-2389.16 247.78,-2379.16 244.28,-2389.16 251.28,-2389.16"/>
</g>
<!-- comm_11 -->
<g id="node59" class="node">
<title>comm_11</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-2231.92" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-2240.42" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-2229.42" font-family="Arial" font-size="10.00">GPUs: 176&#45;191</text>
<text text-anchor="middle" x="247.78" y="-2218.42" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_11&#45;&gt;comm_11 -->
<g id="edge58" class="edge">
<title>gate_11&#45;&gt;comm_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-2296.71C247.78,-2288.35 247.78,-2279.56 247.78,-2271.27"/>
<polygon fill="red" stroke="red" points="251.28,-2271.11 247.78,-2261.11 244.28,-2271.11 251.28,-2271.11"/>
</g>
<!-- experts_11 -->
<g id="node60" class="node">
<title>experts_11</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-2166.93 135.78,-2166.93 135.78,-2125.93 359.78,-2125.93 359.78,-2166.93"/>
<text text-anchor="middle" x="247.78" y="-2154.93" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-2143.93" font-family="Arial" font-size="10.00">GPUs: 176&#45;191</text>
<text text-anchor="middle" x="247.78" y="-2132.93" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_11&#45;&gt;experts_11 -->
<g id="edge59" class="edge">
<title>comm_11&#45;&gt;experts_11</title>
<path fill="none" stroke="black" d="M247.78,-2202.66C247.78,-2194.41 247.78,-2185.37 247.78,-2177.04"/>
<polygon fill="black" stroke="black" points="251.28,-2176.98 247.78,-2166.98 244.28,-2176.98 251.28,-2176.98"/>
</g>
<!-- agg_11 -->
<g id="node61" class="node">
<title>agg_11</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-2089.93 103.77,-2089.93 4.01,-2007.93 391.8,-2007.93 491.56,-2089.93"/>
<text text-anchor="middle" x="247.78" y="-2057.43" font-family="Arial" font-size="10.00">Aggregate Layer 11</text>
<text text-anchor="middle" x="247.78" y="-2046.43" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-2035.43" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_11&#45;&gt;agg_11 -->
<g id="edge60" class="edge">
<title>experts_11&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M247.78,-2125.64C247.78,-2118.18 247.78,-2109.31 247.78,-2100.32"/>
<polygon fill="black" stroke="black" points="251.28,-2100.18 247.78,-2090.18 244.28,-2100.18 251.28,-2100.18"/>
</g>
<!-- mha_12 -->
<g id="node62" class="node">
<title>mha_12</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-1971.93 130.28,-1971.93 130.28,-1930.93 365.28,-1930.93 365.28,-1971.93"/>
<text text-anchor="middle" x="247.78" y="-1959.93" font-family="Arial" font-size="10.00">MHA Layer 12</text>
<text text-anchor="middle" x="247.78" y="-1948.93" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-1937.93" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_11&#45;&gt;mha_12 -->
<g id="edge61" class="edge">
<title>agg_11&#45;&gt;mha_12</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-2007.71C247.78,-1999.13 247.78,-1990.22 247.78,-1982.12"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-1982.04 247.78,-1972.04 244.28,-1982.04 251.28,-1982.04"/>
</g>
<!-- gate_12 -->
<g id="node63" class="node">
<title>gate_12</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-1894.93 101.53,-1894.93 0.22,-1812.93 394.04,-1812.93 495.35,-1894.93"/>
<text text-anchor="middle" x="247.78" y="-1862.43" font-family="Arial" font-size="10.00">Gate Layer 12</text>
<text text-anchor="middle" x="247.78" y="-1851.43" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-1840.43" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_12&#45;&gt;gate_12 -->
<g id="edge62" class="edge">
<title>mha_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M247.78,-1930.64C247.78,-1923.18 247.78,-1914.31 247.78,-1905.32"/>
<polygon fill="black" stroke="black" points="251.28,-1905.18 247.78,-1895.18 244.28,-1905.18 251.28,-1905.18"/>
</g>
<!-- comm_12 -->
<g id="node64" class="node">
<title>comm_12</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-1747.94" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-1756.44" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-1745.44" font-family="Arial" font-size="10.00">GPUs: 192&#45;207</text>
<text text-anchor="middle" x="247.78" y="-1734.44" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_12&#45;&gt;comm_12 -->
<g id="edge63" class="edge">
<title>gate_12&#45;&gt;comm_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-1812.73C247.78,-1804.37 247.78,-1795.58 247.78,-1787.29"/>
<polygon fill="red" stroke="red" points="251.28,-1787.12 247.78,-1777.12 244.28,-1787.12 251.28,-1787.12"/>
</g>
<!-- experts_12 -->
<g id="node65" class="node">
<title>experts_12</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-1682.95 135.78,-1682.95 135.78,-1641.95 359.78,-1641.95 359.78,-1682.95"/>
<text text-anchor="middle" x="247.78" y="-1670.95" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-1659.95" font-family="Arial" font-size="10.00">GPUs: 192&#45;207</text>
<text text-anchor="middle" x="247.78" y="-1648.95" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_12&#45;&gt;experts_12 -->
<g id="edge64" class="edge">
<title>comm_12&#45;&gt;experts_12</title>
<path fill="none" stroke="black" d="M247.78,-1718.67C247.78,-1710.42 247.78,-1701.39 247.78,-1693.06"/>
<polygon fill="black" stroke="black" points="251.28,-1693 247.78,-1683 244.28,-1693 251.28,-1693"/>
</g>
<!-- agg_12 -->
<g id="node66" class="node">
<title>agg_12</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-1605.95 103.77,-1605.95 4.01,-1523.95 391.8,-1523.95 491.56,-1605.95"/>
<text text-anchor="middle" x="247.78" y="-1573.45" font-family="Arial" font-size="10.00">Aggregate Layer 12</text>
<text text-anchor="middle" x="247.78" y="-1562.45" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-1551.45" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_12&#45;&gt;agg_12 -->
<g id="edge65" class="edge">
<title>experts_12&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M247.78,-1641.66C247.78,-1634.2 247.78,-1625.33 247.78,-1616.33"/>
<polygon fill="black" stroke="black" points="251.28,-1616.19 247.78,-1606.19 244.28,-1616.19 251.28,-1616.19"/>
</g>
<!-- mha_13 -->
<g id="node67" class="node">
<title>mha_13</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-1487.95 130.28,-1487.95 130.28,-1446.95 365.28,-1446.95 365.28,-1487.95"/>
<text text-anchor="middle" x="247.78" y="-1475.95" font-family="Arial" font-size="10.00">MHA Layer 13</text>
<text text-anchor="middle" x="247.78" y="-1464.95" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-1453.95" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_12&#45;&gt;mha_13 -->
<g id="edge66" class="edge">
<title>agg_12&#45;&gt;mha_13</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-1523.72C247.78,-1515.15 247.78,-1506.24 247.78,-1498.14"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-1498.06 247.78,-1488.06 244.28,-1498.06 251.28,-1498.06"/>
</g>
<!-- gate_13 -->
<g id="node68" class="node">
<title>gate_13</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-1410.95 101.53,-1410.95 0.22,-1328.95 394.04,-1328.95 495.35,-1410.95"/>
<text text-anchor="middle" x="247.78" y="-1378.45" font-family="Arial" font-size="10.00">Gate Layer 13</text>
<text text-anchor="middle" x="247.78" y="-1367.45" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-1356.45" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_13&#45;&gt;gate_13 -->
<g id="edge67" class="edge">
<title>mha_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M247.78,-1446.66C247.78,-1439.2 247.78,-1430.33 247.78,-1421.33"/>
<polygon fill="black" stroke="black" points="251.28,-1421.19 247.78,-1411.19 244.28,-1421.19 251.28,-1421.19"/>
</g>
<!-- comm_13 -->
<g id="node69" class="node">
<title>comm_13</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-1263.96" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-1272.46" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-1261.46" font-family="Arial" font-size="10.00">GPUs: 208&#45;223</text>
<text text-anchor="middle" x="247.78" y="-1250.46" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_13&#45;&gt;comm_13 -->
<g id="edge68" class="edge">
<title>gate_13&#45;&gt;comm_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-1328.74C247.78,-1320.38 247.78,-1311.6 247.78,-1303.31"/>
<polygon fill="red" stroke="red" points="251.28,-1303.14 247.78,-1293.14 244.28,-1303.14 251.28,-1303.14"/>
</g>
<!-- experts_13 -->
<g id="node70" class="node">
<title>experts_13</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-1198.97 135.78,-1198.97 135.78,-1157.97 359.78,-1157.97 359.78,-1198.97"/>
<text text-anchor="middle" x="247.78" y="-1186.97" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-1175.97" font-family="Arial" font-size="10.00">GPUs: 208&#45;223</text>
<text text-anchor="middle" x="247.78" y="-1164.97" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_13&#45;&gt;experts_13 -->
<g id="edge69" class="edge">
<title>comm_13&#45;&gt;experts_13</title>
<path fill="none" stroke="black" d="M247.78,-1234.69C247.78,-1226.44 247.78,-1217.41 247.78,-1209.08"/>
<polygon fill="black" stroke="black" points="251.28,-1209.01 247.78,-1199.01 244.28,-1209.01 251.28,-1209.01"/>
</g>
<!-- agg_13 -->
<g id="node71" class="node">
<title>agg_13</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-1121.97 103.77,-1121.97 4.01,-1039.97 391.8,-1039.97 491.56,-1121.97"/>
<text text-anchor="middle" x="247.78" y="-1089.47" font-family="Arial" font-size="10.00">Aggregate Layer 13</text>
<text text-anchor="middle" x="247.78" y="-1078.47" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-1067.47" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_13&#45;&gt;agg_13 -->
<g id="edge70" class="edge">
<title>experts_13&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M247.78,-1157.68C247.78,-1150.22 247.78,-1141.35 247.78,-1132.35"/>
<polygon fill="black" stroke="black" points="251.28,-1132.21 247.78,-1122.21 244.28,-1132.21 251.28,-1132.21"/>
</g>
<!-- mha_14 -->
<g id="node72" class="node">
<title>mha_14</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-1003.97 130.28,-1003.97 130.28,-962.97 365.28,-962.97 365.28,-1003.97"/>
<text text-anchor="middle" x="247.78" y="-991.97" font-family="Arial" font-size="10.00">MHA Layer 14</text>
<text text-anchor="middle" x="247.78" y="-980.97" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-969.97" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_13&#45;&gt;mha_14 -->
<g id="edge71" class="edge">
<title>agg_13&#45;&gt;mha_14</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-1039.74C247.78,-1031.16 247.78,-1022.25 247.78,-1014.16"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-1014.08 247.78,-1004.08 244.28,-1014.08 251.28,-1014.08"/>
</g>
<!-- gate_14 -->
<g id="node73" class="node">
<title>gate_14</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-926.97 101.53,-926.97 0.22,-844.97 394.04,-844.97 495.35,-926.97"/>
<text text-anchor="middle" x="247.78" y="-894.47" font-family="Arial" font-size="10.00">Gate Layer 14</text>
<text text-anchor="middle" x="247.78" y="-883.47" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-872.47" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_14&#45;&gt;gate_14 -->
<g id="edge72" class="edge">
<title>mha_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M247.78,-962.68C247.78,-955.22 247.78,-946.35 247.78,-937.35"/>
<polygon fill="black" stroke="black" points="251.28,-937.21 247.78,-927.21 244.28,-937.21 251.28,-937.21"/>
</g>
<!-- comm_14 -->
<g id="node74" class="node">
<title>comm_14</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-779.97" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-788.47" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-777.47" font-family="Arial" font-size="10.00">GPUs: 224&#45;239</text>
<text text-anchor="middle" x="247.78" y="-766.47" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_14&#45;&gt;comm_14 -->
<g id="edge73" class="edge">
<title>gate_14&#45;&gt;comm_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-844.76C247.78,-836.4 247.78,-827.61 247.78,-819.32"/>
<polygon fill="red" stroke="red" points="251.28,-819.16 247.78,-809.16 244.28,-819.16 251.28,-819.16"/>
</g>
<!-- experts_14 -->
<g id="node75" class="node">
<title>experts_14</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-714.98 135.78,-714.98 135.78,-673.98 359.78,-673.98 359.78,-714.98"/>
<text text-anchor="middle" x="247.78" y="-702.98" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-691.98" font-family="Arial" font-size="10.00">GPUs: 224&#45;239</text>
<text text-anchor="middle" x="247.78" y="-680.98" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_14&#45;&gt;experts_14 -->
<g id="edge74" class="edge">
<title>comm_14&#45;&gt;experts_14</title>
<path fill="none" stroke="black" d="M247.78,-750.71C247.78,-742.46 247.78,-733.42 247.78,-725.09"/>
<polygon fill="black" stroke="black" points="251.28,-725.03 247.78,-715.03 244.28,-725.03 251.28,-725.03"/>
</g>
<!-- agg_14 -->
<g id="node76" class="node">
<title>agg_14</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-637.98 103.77,-637.98 4.01,-555.98 391.8,-555.98 491.56,-637.98"/>
<text text-anchor="middle" x="247.78" y="-605.48" font-family="Arial" font-size="10.00">Aggregate Layer 14</text>
<text text-anchor="middle" x="247.78" y="-594.48" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-583.48" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_14&#45;&gt;agg_14 -->
<g id="edge75" class="edge">
<title>experts_14&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M247.78,-673.7C247.78,-666.23 247.78,-657.36 247.78,-648.37"/>
<polygon fill="black" stroke="black" points="251.28,-648.23 247.78,-638.23 244.28,-648.23 251.28,-648.23"/>
</g>
<!-- mha_15 -->
<g id="node77" class="node">
<title>mha_15</title>
<polygon fill="lightgreen" stroke="black" points="365.28,-519.98 130.28,-519.98 130.28,-478.98 365.28,-478.98 365.28,-519.98"/>
<text text-anchor="middle" x="247.78" y="-507.98" font-family="Arial" font-size="10.00">MHA Layer 15</text>
<text text-anchor="middle" x="247.78" y="-496.98" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-485.98" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_14&#45;&gt;mha_15 -->
<g id="edge76" class="edge">
<title>agg_14&#45;&gt;mha_15</title>
<path fill="none" stroke="blue" stroke-width="2" d="M247.78,-555.76C247.78,-547.18 247.78,-538.27 247.78,-530.17"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="251.28,-530.09 247.78,-520.09 244.28,-530.09 251.28,-530.09"/>
</g>
<!-- gate_15 -->
<g id="node78" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="495.35,-442.98 101.53,-442.98 0.22,-360.98 394.04,-360.98 495.35,-442.98"/>
<text text-anchor="middle" x="247.78" y="-410.48" font-family="Arial" font-size="10.00">Gate Layer 15</text>
<text text-anchor="middle" x="247.78" y="-399.48" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-388.48" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_15&#45;&gt;gate_15 -->
<g id="edge77" class="edge">
<title>mha_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M247.78,-478.7C247.78,-471.23 247.78,-462.36 247.78,-453.37"/>
<polygon fill="black" stroke="black" points="251.28,-453.23 247.78,-443.23 244.28,-453.23 251.28,-453.23"/>
</g>
<!-- comm_15 -->
<g id="node79" class="node">
<title>comm_15</title>
<ellipse fill="lightblue" stroke="black" cx="247.78" cy="-295.99" rx="122.16" ry="28.98"/>
<text text-anchor="middle" x="247.78" y="-304.49" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="247.78" y="-293.49" font-family="Arial" font-size="10.00">GPUs: 240&#45;255</text>
<text text-anchor="middle" x="247.78" y="-282.49" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, top_k=2]</text>
</g>
<!-- gate_15&#45;&gt;comm_15 -->
<g id="edge78" class="edge">
<title>gate_15&#45;&gt;comm_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M247.78,-360.78C247.78,-352.42 247.78,-343.63 247.78,-335.34"/>
<polygon fill="red" stroke="red" points="251.28,-335.18 247.78,-325.18 244.28,-335.18 251.28,-335.18"/>
</g>
<!-- experts_15 -->
<g id="node80" class="node">
<title>experts_15</title>
<polygon fill="lightgreen" stroke="black" points="359.78,-231 135.78,-231 135.78,-190 359.78,-190 359.78,-231"/>
<text text-anchor="middle" x="247.78" y="-219" font-family="Arial" font-size="10.00">Experts 0&#45;15</text>
<text text-anchor="middle" x="247.78" y="-208" font-family="Arial" font-size="10.00">GPUs: 240&#45;255</text>
<text text-anchor="middle" x="247.78" y="-197" font-family="Arial" font-size="10.00">[batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_15&#45;&gt;experts_15 -->
<g id="edge79" class="edge">
<title>comm_15&#45;&gt;experts_15</title>
<path fill="none" stroke="black" d="M247.78,-266.73C247.78,-258.48 247.78,-249.44 247.78,-241.11"/>
<polygon fill="black" stroke="black" points="251.28,-241.05 247.78,-231.05 244.28,-241.05 251.28,-241.05"/>
</g>
<!-- agg_15 -->
<g id="node81" class="node">
<title>agg_15</title>
<polygon fill="lightyellow" stroke="black" points="491.56,-154 103.77,-154 4.01,-72 391.8,-72 491.56,-154"/>
<text text-anchor="middle" x="247.78" y="-121.5" font-family="Arial" font-size="10.00">Aggregate Layer 15</text>
<text text-anchor="middle" x="247.78" y="-110.5" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="247.78" y="-99.5" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_15&#45;&gt;agg_15 -->
<g id="edge80" class="edge">
<title>experts_15&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M247.78,-189.71C247.78,-182.25 247.78,-173.38 247.78,-164.39"/>
<polygon fill="black" stroke="black" points="251.28,-164.25 247.78,-154.25 244.28,-164.25 251.28,-164.25"/>
</g>
<!-- output -->
<g id="node82" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="352.28,-36 143.28,-36 143.28,0 352.28,0 352.28,-36"/>
<text text-anchor="middle" x="247.78" y="-21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="247.78" y="-10" font-family="Arial" font-size="10.00">[batch_size=128, seq_len=?, vocab_size=?]</text>
</g>
<!-- agg_15&#45;&gt;output -->
<g id="edge81" class="edge">
<title>agg_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M247.78,-71.75C247.78,-63.24 247.78,-54.46 247.78,-46.55"/>
<polygon fill="black" stroke="black" points="251.28,-46.42 247.78,-36.42 244.28,-46.42 251.28,-46.42"/>
</g>
</g>
</svg>
