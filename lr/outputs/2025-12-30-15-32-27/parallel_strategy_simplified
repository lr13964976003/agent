// Parallel Strategy Deployment DAG - Simplified
digraph {
	dpi=300 rankdir=TB size="50,50"
	node [fontname=Arial fontsize=8]
	input [label="Input\n[128, ?, 16, 32]" fillcolor=lightgreen shape=rectangle style=filled]
	mha_0 [label="MHA L0\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_0 [label="Gate L0\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_0 [label="Experts L0\nGPUs 0-15\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_0 [label="Expert Routing L0\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_0 [label="Aggregate L0\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_1 [label="MHA L1\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_1 [label="Gate L1\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_1 [label="Experts L1\nGPUs 16-31\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_1 [label="Expert Routing L1\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_1 [label="Aggregate L1\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_2 [label="MHA L2\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_2 [label="Gate L2\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_2 [label="Experts L2\nGPUs 32-47\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_2 [label="Expert Routing L2\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_2 [label="Aggregate L2\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_3 [label="MHA L3\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_3 [label="Gate L3\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_3 [label="Experts L3\nGPUs 48-63\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_3 [label="Expert Routing L3\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_3 [label="Aggregate L3\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_4 [label="MHA L4\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_4 [label="Gate L4\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_4 [label="Experts L4\nGPUs 64-79\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_4 [label="Expert Routing L4\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_4 [label="Aggregate L4\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_5 [label="MHA L5\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_5 [label="Gate L5\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_5 [label="Experts L5\nGPUs 80-95\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_5 [label="Expert Routing L5\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_5 [label="Aggregate L5\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_6 [label="MHA L6\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_6 [label="Gate L6\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_6 [label="Experts L6\nGPUs 96-111\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_6 [label="Expert Routing L6\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_6 [label="Aggregate L6\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_7 [label="MHA L7\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_7 [label="Gate L7\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_7 [label="Experts L7\nGPUs 112-127\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_7 [label="Expert Routing L7\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_7 [label="Aggregate L7\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_8 [label="MHA L8\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_8 [label="Gate L8\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_8 [label="Experts L8\nGPUs 128-143\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_8 [label="Expert Routing L8\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_8 [label="Aggregate L8\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_9 [label="MHA L9\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_9 [label="Gate L9\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_9 [label="Experts L9\nGPUs 144-159\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_9 [label="Expert Routing L9\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_9 [label="Aggregate L9\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_10 [label="MHA L10\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_10 [label="Gate L10\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_10 [label="Experts L10\nGPUs 160-175\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_10 [label="Expert Routing L10\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_10 [label="Aggregate L10\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_11 [label="MHA L11\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_11 [label="Gate L11\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_11 [label="Experts L11\nGPUs 176-191\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_11 [label="Expert Routing L11\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_11 [label="Aggregate L11\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_12 [label="MHA L12\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_12 [label="Gate L12\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_12 [label="Experts L12\nGPUs 192-207\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_12 [label="Expert Routing L12\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_12 [label="Aggregate L12\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_13 [label="MHA L13\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_13 [label="Gate L13\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_13 [label="Experts L13\nGPUs 208-223\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_13 [label="Expert Routing L13\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_13 [label="Aggregate L13\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_14 [label="MHA L14\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_14 [label="Gate L14\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_14 [label="Experts L14\nGPUs 224-239\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_14 [label="Expert Routing L14\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_14 [label="Aggregate L14\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	mha_15 [label="MHA L15\n[128, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	gate_15 [label="Gate L15\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	experts_15 [label="Experts L15\nGPUs 240-255\n[?, ?, 16, 512]" fillcolor=lightgreen shape=rectangle style=filled]
	comm_15 [label="Expert Routing L15\n[?, ?, 2, 16]" fillcolor=lightblue shape=ellipse style=filled]
	agg_15 [label="Aggregate L15\n[128, ?, 16, 512]" fillcolor=lightyellow shape=parallelogram style=filled]
	output [label="Output\n[128, ?, vocab]" fillcolor=lightgreen shape=rectangle style=filled]
	input -> mha_0
	mha_0 -> gate_0
	gate_0 -> comm_0 [color=red style=dashed]
	comm_0 -> experts_0
	experts_0 -> agg_0
	agg_0 -> mha_1 [color=blue penwidth=2]
	mha_1 -> gate_1
	gate_1 -> comm_1 [color=red style=dashed]
	comm_1 -> experts_1
	experts_1 -> agg_1
	agg_1 -> mha_2 [color=blue penwidth=2]
	mha_2 -> gate_2
	gate_2 -> comm_2 [color=red style=dashed]
	comm_2 -> experts_2
	experts_2 -> agg_2
	agg_2 -> mha_3 [color=blue penwidth=2]
	mha_3 -> gate_3
	gate_3 -> comm_3 [color=red style=dashed]
	comm_3 -> experts_3
	experts_3 -> agg_3
	agg_3 -> mha_4 [color=blue penwidth=2]
	mha_4 -> gate_4
	gate_4 -> comm_4 [color=red style=dashed]
	comm_4 -> experts_4
	experts_4 -> agg_4
	agg_4 -> mha_5 [color=blue penwidth=2]
	mha_5 -> gate_5
	gate_5 -> comm_5 [color=red style=dashed]
	comm_5 -> experts_5
	experts_5 -> agg_5
	agg_5 -> mha_6 [color=blue penwidth=2]
	mha_6 -> gate_6
	gate_6 -> comm_6 [color=red style=dashed]
	comm_6 -> experts_6
	experts_6 -> agg_6
	agg_6 -> mha_7 [color=blue penwidth=2]
	mha_7 -> gate_7
	gate_7 -> comm_7 [color=red style=dashed]
	comm_7 -> experts_7
	experts_7 -> agg_7
	agg_7 -> mha_8 [color=blue penwidth=2]
	mha_8 -> gate_8
	gate_8 -> comm_8 [color=red style=dashed]
	comm_8 -> experts_8
	experts_8 -> agg_8
	agg_8 -> mha_9 [color=blue penwidth=2]
	mha_9 -> gate_9
	gate_9 -> comm_9 [color=red style=dashed]
	comm_9 -> experts_9
	experts_9 -> agg_9
	agg_9 -> mha_10 [color=blue penwidth=2]
	mha_10 -> gate_10
	gate_10 -> comm_10 [color=red style=dashed]
	comm_10 -> experts_10
	experts_10 -> agg_10
	agg_10 -> mha_11 [color=blue penwidth=2]
	mha_11 -> gate_11
	gate_11 -> comm_11 [color=red style=dashed]
	comm_11 -> experts_11
	experts_11 -> agg_11
	agg_11 -> mha_12 [color=blue penwidth=2]
	mha_12 -> gate_12
	gate_12 -> comm_12 [color=red style=dashed]
	comm_12 -> experts_12
	experts_12 -> agg_12
	agg_12 -> mha_13 [color=blue penwidth=2]
	mha_13 -> gate_13
	gate_13 -> comm_13 [color=red style=dashed]
	comm_13 -> experts_13
	experts_13 -> agg_13
	agg_13 -> mha_14 [color=blue penwidth=2]
	mha_14 -> gate_14
	gate_14 -> comm_14 [color=red style=dashed]
	comm_14 -> experts_14
	experts_14 -> agg_14
	agg_14 -> mha_15 [color=blue penwidth=2]
	mha_15 -> gate_15
	gate_15 -> comm_15 [color=red style=dashed]
	comm_15 -> experts_15
	experts_15 -> agg_15
	agg_15 -> output
}
