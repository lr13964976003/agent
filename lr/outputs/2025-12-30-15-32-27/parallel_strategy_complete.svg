<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Parallel Strategy Deployment DAG -->
<!-- Title: Parallel Strategy Deployment DAG Pages: 1 -->
<svg width="22925pt" height="7432pt"
 viewBox="0.00 0.00 5502.00 1783.68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(4.17 4.17) rotate(0) translate(4 1779.68)">
<title>Parallel Strategy Deployment DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1779.68 5498,-1779.68 5498,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="lightgray" stroke="black" points="2386,-1692.68 2386,-1767.68 2620,-1767.68 2620,-1692.68 2386,-1692.68"/>
<text text-anchor="middle" x="2503" y="-1752.48" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_0</title>
<polygon fill="lightcyan" stroke="black" points="8,-1175.45 8,-1684.68 4998,-1684.68 4998,-1175.45 8,-1175.45"/>
<text text-anchor="middle" x="2503" y="-1669.48" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layer 0) &#45; GPUs 0&#45;15</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_1</title>
<polygon fill="lightcyan" stroke="black" points="8,-581.23 8,-1156.45 4998,-1156.45 4998,-581.23 8,-581.23"/>
<text text-anchor="middle" x="2503" y="-1141.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layer 1) &#45; GPUs 16&#45;31</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_2</title>
<polygon fill="lightcyan" stroke="black" points="2262,-64 2262,-573.23 2742,-573.23 2742,-64 2262,-64"/>
<text text-anchor="middle" x="2502" y="-558.03" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (Layer 2) &#45; GPUs 32&#45;47</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage_15</title>
<polygon fill="lightcyan" stroke="black" points="5006,-705.23 5006,-1280.45 5486,-1280.45 5486,-705.23 5006,-705.23"/>
<text text-anchor="middle" x="5246" y="-1265.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 15 (Layer 15) &#45; GPUs 240&#45;255</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<polygon fill="lightgray" stroke="black" points="5130,-607.23 5130,-682.23 5362,-682.23 5362,-607.23 5130,-607.23"/>
<text text-anchor="middle" x="5246" y="-667.03" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="2611.5,-1736.68 2394.5,-1736.68 2394.5,-1700.68 2611.5,-1700.68 2611.5,-1736.68"/>
<text text-anchor="middle" x="2503" y="-1725.78" font-family="Arial" font-size="8.00">Input</text>
<text text-anchor="middle" x="2503" y="-1716.78" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2503" y="-1707.78" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=32]</text>
</g>
<!-- mha_0 -->
<g id="node2" class="node">
<title>mha_0</title>
<polygon fill="lightgreen" stroke="black" points="2613.5,-1653.68 2392.5,-1653.68 2392.5,-1609.68 2613.5,-1609.68 2613.5,-1653.68"/>
<text text-anchor="middle" x="2503" y="-1643.28" font-family="Arial" font-size="8.00">MHA Layer 0</text>
<text text-anchor="middle" x="2503" y="-1634.28" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2503" y="-1625.28" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2503" y="-1616.28" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- input&#45;&gt;mha_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M2503,-1700.48C2503,-1690.04 2503,-1676.42 2503,-1664.12"/>
<polygon fill="black" stroke="black" points="2506.5,-1663.77 2503,-1653.77 2499.5,-1663.77 2506.5,-1663.77"/>
</g>
<!-- gate_0 -->
<g id="node3" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="2735.47,-1573.68 2365.66,-1573.68 2270.53,-1485.68 2640.34,-1485.68 2735.47,-1573.68"/>
<text text-anchor="middle" x="2503" y="-1541.28" font-family="Arial" font-size="8.00">Gate Layer 0</text>
<text text-anchor="middle" x="2503" y="-1532.28" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2503" y="-1523.28" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2503" y="-1514.28" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_0&#45;&gt;gate_0 -->
<g id="edge2" class="edge">
<title>mha_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M2503,-1609.47C2503,-1601.97 2503,-1593.16 2503,-1584.2"/>
<polygon fill="black" stroke="black" points="2506.5,-1584.08 2503,-1574.08 2499.5,-1584.08 2506.5,-1584.08"/>
</g>
<!-- comm_0_0 -->
<g id="node4" class="node">
<title>comm_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="163" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="163" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 0</text>
<text text-anchor="middle" x="163" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="163" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="163" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_0 -->
<g id="edge3" class="edge">
<title>gate_0&#45;&gt;comm_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.51,-1525.58C1856.4,-1517.52 702.57,-1493.37 319,-1449.68 304.27,-1448 288.86,-1445.7 273.69,-1443.11"/>
<polygon fill="red" stroke="red" points="274.22,-1439.65 263.77,-1441.37 273.01,-1446.55 274.22,-1439.65"/>
</g>
<!-- comm_0_1 -->
<g id="node5" class="node">
<title>comm_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="475" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="475" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 1</text>
<text text-anchor="middle" x="475" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="475" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="475" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_1 -->
<g id="edge4" class="edge">
<title>gate_0&#45;&gt;comm_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2312.18,-1524.22C1902.94,-1514.09 952.07,-1487.23 631,-1449.68 616.28,-1447.95 600.87,-1445.63 585.7,-1443.03"/>
<polygon fill="red" stroke="red" points="586.23,-1439.57 575.78,-1441.28 585.02,-1446.46 586.23,-1439.57"/>
</g>
<!-- comm_0_2 -->
<g id="node6" class="node">
<title>comm_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="787" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="787" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 2</text>
<text text-anchor="middle" x="787" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="787" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="787" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_2 -->
<g id="edge5" class="edge">
<title>gate_0&#45;&gt;comm_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2315.88,-1527.65C2022.33,-1524.14 1436.16,-1509.46 943,-1449.68 928.4,-1447.91 913.11,-1445.57 898.06,-1442.97"/>
<polygon fill="red" stroke="red" points="898.67,-1439.53 888.21,-1441.23 897.45,-1446.42 898.67,-1439.53"/>
</g>
<!-- comm_0_3 -->
<g id="node7" class="node">
<title>comm_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="1099" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="1099" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 3</text>
<text text-anchor="middle" x="1099" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1099" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1099" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_3 -->
<g id="edge6" class="edge">
<title>gate_0&#45;&gt;comm_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2311.99,-1524.14C2066.52,-1516.59 1627.56,-1497.23 1255,-1449.68 1240.66,-1447.85 1225.66,-1445.5 1210.86,-1442.93"/>
<polygon fill="red" stroke="red" points="1211.11,-1439.43 1200.66,-1441.12 1209.89,-1446.32 1211.11,-1439.43"/>
</g>
<!-- comm_0_4 -->
<g id="node8" class="node">
<title>comm_0_4</title>
<ellipse fill="lightblue" stroke="black" cx="1411" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="1411" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 4</text>
<text text-anchor="middle" x="1411" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1411" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1411" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_4 -->
<g id="edge7" class="edge">
<title>gate_0&#45;&gt;comm_0_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2305.57,-1518.14C2115.67,-1506.56 1820.82,-1484.78 1567,-1449.68 1552.9,-1447.73 1538.15,-1445.34 1523.58,-1442.77"/>
<polygon fill="red" stroke="red" points="1524,-1439.29 1513.54,-1440.97 1522.76,-1446.18 1524,-1439.29"/>
</g>
<!-- comm_0_5 -->
<g id="node9" class="node">
<title>comm_0_5</title>
<ellipse fill="lightblue" stroke="black" cx="1723" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="1723" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 5</text>
<text text-anchor="middle" x="1723" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="1723" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1723" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_5 -->
<g id="edge8" class="edge">
<title>gate_0&#45;&gt;comm_0_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2291.67,-1505.37C2170.59,-1491.15 2015.95,-1471.54 1879,-1449.68 1865.41,-1447.51 1851.19,-1445.04 1837.11,-1442.47"/>
<polygon fill="red" stroke="red" points="1837.36,-1438.96 1826.89,-1440.59 1836.09,-1445.84 1837.36,-1438.96"/>
</g>
<!-- comm_0_6 -->
<g id="node10" class="node">
<title>comm_0_6</title>
<ellipse fill="lightblue" stroke="black" cx="2035" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2035" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 6</text>
<text text-anchor="middle" x="2035" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2035" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2035" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_6 -->
<g id="edge9" class="edge">
<title>gate_0&#45;&gt;comm_0_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2318.37,-1485.63C2258.33,-1471.63 2193.74,-1456.57 2141.42,-1444.37"/>
<polygon fill="red" stroke="red" points="2141.99,-1440.91 2131.46,-1442.05 2140.4,-1447.73 2141.99,-1440.91"/>
</g>
<!-- comm_0_7 -->
<g id="node11" class="node">
<title>comm_0_7</title>
<ellipse fill="lightblue" stroke="black" cx="2347" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2347" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 7</text>
<text text-anchor="middle" x="2347" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2347" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2347" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_7 -->
<g id="edge10" class="edge">
<title>gate_0&#45;&gt;comm_0_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2441.34,-1485.55C2426.67,-1475.29 2411.2,-1464.47 2397.12,-1454.62"/>
<polygon fill="red" stroke="red" points="2398.75,-1451.49 2388.55,-1448.62 2394.74,-1457.22 2398.75,-1451.49"/>
</g>
<!-- comm_0_8 -->
<g id="node12" class="node">
<title>comm_0_8</title>
<ellipse fill="lightblue" stroke="black" cx="2659" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2659" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 8</text>
<text text-anchor="middle" x="2659" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="2659" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2659" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_8 -->
<g id="edge11" class="edge">
<title>gate_0&#45;&gt;comm_0_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2564.66,-1485.55C2579.33,-1475.29 2594.8,-1464.47 2608.88,-1454.62"/>
<polygon fill="red" stroke="red" points="2611.26,-1457.22 2617.45,-1448.62 2607.25,-1451.49 2611.26,-1457.22"/>
</g>
<!-- comm_0_9 -->
<g id="node13" class="node">
<title>comm_0_9</title>
<ellipse fill="lightblue" stroke="black" cx="2971" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2971" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 9</text>
<text text-anchor="middle" x="2971" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="2971" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2971" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_9 -->
<g id="edge12" class="edge">
<title>gate_0&#45;&gt;comm_0_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2650.11,-1494.38C2719.56,-1478.19 2800.91,-1459.22 2864.32,-1444.43"/>
<polygon fill="red" stroke="red" points="2865.4,-1447.78 2874.34,-1442.1 2863.81,-1440.96 2865.4,-1447.78"/>
</g>
<!-- comm_0_10 -->
<g id="node14" class="node">
<title>comm_0_10</title>
<ellipse fill="lightblue" stroke="black" cx="3283" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="3283" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 10</text>
<text text-anchor="middle" x="3283" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3283" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3283" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_10 -->
<g id="edge13" class="edge">
<title>gate_0&#45;&gt;comm_0_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2667.64,-1510.78C2793.69,-1496.36 2971.72,-1474.47 3127,-1449.68 3140.59,-1447.51 3154.81,-1445.04 3168.89,-1442.47"/>
<polygon fill="red" stroke="red" points="3169.91,-1445.84 3179.11,-1440.59 3168.64,-1438.96 3169.91,-1445.84"/>
</g>
<!-- comm_0_11 -->
<g id="node15" class="node">
<title>comm_0_11</title>
<ellipse fill="lightblue" stroke="black" cx="3595" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="3595" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 11</text>
<text text-anchor="middle" x="3595" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="3595" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3595" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_11 -->
<g id="edge14" class="edge">
<title>gate_0&#45;&gt;comm_0_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2676.98,-1519.55C2865.39,-1508.37 3174.48,-1486.26 3439,-1449.68 3453.1,-1447.73 3467.85,-1445.34 3482.42,-1442.77"/>
<polygon fill="red" stroke="red" points="3483.24,-1446.18 3492.46,-1440.97 3482,-1439.29 3483.24,-1446.18"/>
</g>
<!-- comm_0_12 -->
<g id="node16" class="node">
<title>comm_0_12</title>
<ellipse fill="lightblue" stroke="black" cx="3907" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="3907" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 12</text>
<text text-anchor="middle" x="3907" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="3907" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3907" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_12 -->
<g id="edge15" class="edge">
<title>gate_0&#45;&gt;comm_0_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2682.45,-1524.5C2925.51,-1517.2 3372.52,-1497.98 3751,-1449.68 3765.34,-1447.85 3780.34,-1445.5 3795.14,-1442.93"/>
<polygon fill="red" stroke="red" points="3796.11,-1446.32 3805.34,-1441.12 3794.89,-1439.43 3796.11,-1446.32"/>
</g>
<!-- comm_0_13 -->
<g id="node17" class="node">
<title>comm_0_13</title>
<ellipse fill="lightblue" stroke="black" cx="4219" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="4219" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 13</text>
<text text-anchor="middle" x="4219" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4219" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="4219" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_13 -->
<g id="edge16" class="edge">
<title>gate_0&#45;&gt;comm_0_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2685.94,-1527.7C2978.07,-1524.28 3567.49,-1509.75 4063,-1449.68 4077.6,-1447.91 4092.89,-1445.57 4107.94,-1442.97"/>
<polygon fill="red" stroke="red" points="4108.55,-1446.42 4117.79,-1441.23 4107.33,-1439.53 4108.55,-1446.42"/>
</g>
<!-- comm_0_14 -->
<g id="node18" class="node">
<title>comm_0_14</title>
<ellipse fill="lightblue" stroke="black" cx="4531" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="4531" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 14</text>
<text text-anchor="middle" x="4531" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="4531" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="4531" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_14 -->
<g id="edge17" class="edge">
<title>gate_0&#45;&gt;comm_0_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2682.38,-1524.51C3085.06,-1514.59 4050.9,-1487.58 4375,-1449.68 4389.72,-1447.95 4405.13,-1445.63 4420.3,-1443.03"/>
<polygon fill="red" stroke="red" points="4420.98,-1446.46 4430.22,-1441.28 4419.77,-1439.57 4420.98,-1446.46"/>
</g>
<!-- comm_0_15 -->
<g id="node19" class="node">
<title>comm_0_15</title>
<ellipse fill="lightblue" stroke="black" cx="4843" cy="-1418.56" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="4843" y="-1430.16" font-family="Arial" font-size="8.00">Route to Expert 15</text>
<text text-anchor="middle" x="4843" y="-1421.16" font-family="Arial" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="4843" y="-1412.16" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="4843" y="-1403.16" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_0&#45;&gt;comm_0_15 -->
<g id="edge18" class="edge">
<title>gate_0&#45;&gt;comm_0_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2683.73,-1525.74C3134.69,-1517.83 4300.95,-1493.65 4687,-1449.68 4701.73,-1448 4717.14,-1445.7 4732.31,-1443.11"/>
<polygon fill="red" stroke="red" points="4732.99,-1446.55 4742.23,-1441.37 4731.78,-1439.65 4732.99,-1446.55"/>
</g>
<!-- expert_0_0 -->
<g id="node20" class="node">
<title>expert_0_0</title>
<polygon fill="lightgreen" stroke="black" points="310,-1351.45 98,-1351.45 98,-1307.45 310,-1307.45 310,-1351.45"/>
<text text-anchor="middle" x="204" y="-1341.05" font-family="Arial" font-size="8.00">Expert 0 Layer 0</text>
<text text-anchor="middle" x="204" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 0</text>
<text text-anchor="middle" x="204" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="204" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_0&#45;&gt;expert_0_0 -->
<g id="edge19" class="edge">
<title>comm_0_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" d="M177.11,-1387.58C181.19,-1378.91 185.65,-1369.44 189.74,-1360.74"/>
<polygon fill="black" stroke="black" points="192.91,-1362.23 194,-1351.69 186.58,-1359.25 192.91,-1362.23"/>
</g>
<!-- expert_0_1 -->
<g id="node21" class="node">
<title>expert_0_1</title>
<polygon fill="lightgreen" stroke="black" points="662,-1351.45 450,-1351.45 450,-1307.45 662,-1307.45 662,-1351.45"/>
<text text-anchor="middle" x="556" y="-1341.05" font-family="Arial" font-size="8.00">Expert 1 Layer 0</text>
<text text-anchor="middle" x="556" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 1</text>
<text text-anchor="middle" x="556" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="556" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_1&#45;&gt;expert_0_1 -->
<g id="edge20" class="edge">
<title>comm_0_1&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" d="M502.88,-1387.58C511.46,-1378.36 520.88,-1368.22 529.37,-1359.09"/>
<polygon fill="black" stroke="black" points="532,-1361.4 536.25,-1351.69 526.88,-1356.63 532,-1361.4"/>
</g>
<!-- expert_0_2 -->
<g id="node22" class="node">
<title>expert_0_2</title>
<polygon fill="lightgreen" stroke="black" points="973,-1351.45 761,-1351.45 761,-1307.45 973,-1307.45 973,-1351.45"/>
<text text-anchor="middle" x="867" y="-1341.05" font-family="Arial" font-size="8.00">Expert 2 Layer 0</text>
<text text-anchor="middle" x="867" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 2</text>
<text text-anchor="middle" x="867" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="867" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_2&#45;&gt;expert_0_2 -->
<g id="edge21" class="edge">
<title>comm_0_2&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" d="M814.53,-1387.58C823.01,-1378.36 832.31,-1368.22 840.7,-1359.09"/>
<polygon fill="black" stroke="black" points="843.31,-1361.42 847.49,-1351.69 838.15,-1356.69 843.31,-1361.42"/>
</g>
<!-- expert_0_3 -->
<g id="node23" class="node">
<title>expert_0_3</title>
<polygon fill="lightgreen" stroke="black" points="1283,-1351.45 1071,-1351.45 1071,-1307.45 1283,-1307.45 1283,-1351.45"/>
<text text-anchor="middle" x="1177" y="-1341.05" font-family="Arial" font-size="8.00">Expert 3 Layer 0</text>
<text text-anchor="middle" x="1177" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 3</text>
<text text-anchor="middle" x="1177" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1177" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_3&#45;&gt;expert_0_3 -->
<g id="edge22" class="edge">
<title>comm_0_3&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" d="M1125.84,-1387.58C1134.02,-1378.45 1143,-1368.43 1151.11,-1359.36"/>
<polygon fill="black" stroke="black" points="1153.92,-1361.48 1157.98,-1351.69 1148.7,-1356.81 1153.92,-1361.48"/>
</g>
<!-- expert_0_4 -->
<g id="node24" class="node">
<title>expert_0_4</title>
<polygon fill="lightgreen" stroke="black" points="1591,-1351.45 1379,-1351.45 1379,-1307.45 1591,-1307.45 1591,-1351.45"/>
<text text-anchor="middle" x="1485" y="-1341.05" font-family="Arial" font-size="8.00">Expert 4 Layer 0</text>
<text text-anchor="middle" x="1485" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 4</text>
<text text-anchor="middle" x="1485" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1485" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_4&#45;&gt;expert_0_4 -->
<g id="edge23" class="edge">
<title>comm_0_4&#45;&gt;expert_0_4</title>
<path fill="none" stroke="black" d="M1436.47,-1387.58C1444.23,-1378.45 1452.74,-1368.43 1460.44,-1359.36"/>
<polygon fill="black" stroke="black" points="1463.15,-1361.58 1466.96,-1351.69 1457.82,-1357.05 1463.15,-1361.58"/>
</g>
<!-- expert_0_5 -->
<g id="node25" class="node">
<title>expert_0_5</title>
<polygon fill="lightgreen" stroke="black" points="1895,-1351.45 1683,-1351.45 1683,-1307.45 1895,-1307.45 1895,-1351.45"/>
<text text-anchor="middle" x="1789" y="-1341.05" font-family="Arial" font-size="8.00">Expert 5 Layer 0</text>
<text text-anchor="middle" x="1789" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 5</text>
<text text-anchor="middle" x="1789" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1789" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_5&#45;&gt;expert_0_5 -->
<g id="edge24" class="edge">
<title>comm_0_5&#45;&gt;expert_0_5</title>
<path fill="none" stroke="black" d="M1745.71,-1387.58C1752.5,-1378.63 1759.92,-1368.83 1766.68,-1359.91"/>
<polygon fill="black" stroke="black" points="1769.66,-1361.78 1772.91,-1351.69 1764.08,-1357.55 1769.66,-1361.78"/>
</g>
<!-- expert_0_6 -->
<g id="node26" class="node">
<title>expert_0_6</title>
<polygon fill="lightgreen" stroke="black" points="2192,-1351.45 1980,-1351.45 1980,-1307.45 2192,-1307.45 2192,-1351.45"/>
<text text-anchor="middle" x="2086" y="-1341.05" font-family="Arial" font-size="8.00">Expert 6 Layer 0</text>
<text text-anchor="middle" x="2086" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 6</text>
<text text-anchor="middle" x="2086" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2086" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_6&#45;&gt;expert_0_6 -->
<g id="edge25" class="edge">
<title>comm_0_6&#45;&gt;expert_0_6</title>
<path fill="none" stroke="black" d="M2052.55,-1387.58C2057.68,-1378.82 2063.29,-1369.24 2068.43,-1360.47"/>
<polygon fill="black" stroke="black" points="2071.53,-1362.09 2073.56,-1351.69 2065.49,-1358.55 2071.53,-1362.09"/>
</g>
<!-- expert_0_7 -->
<g id="node27" class="node">
<title>expert_0_7</title>
<polygon fill="lightgreen" stroke="black" points="2473,-1351.45 2261,-1351.45 2261,-1307.45 2473,-1307.45 2473,-1351.45"/>
<text text-anchor="middle" x="2367" y="-1341.05" font-family="Arial" font-size="8.00">Expert 7 Layer 0</text>
<text text-anchor="middle" x="2367" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 7</text>
<text text-anchor="middle" x="2367" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2367" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_7&#45;&gt;expert_0_7 -->
<g id="edge26" class="edge">
<title>comm_0_7&#45;&gt;expert_0_7</title>
<path fill="none" stroke="black" d="M2354,-1387.1C2355.92,-1378.72 2358,-1369.64 2359.93,-1361.25"/>
<polygon fill="black" stroke="black" points="2363.35,-1361.98 2362.18,-1351.46 2356.53,-1360.42 2363.35,-1361.98"/>
</g>
<!-- expert_0_8 -->
<g id="node28" class="node">
<title>expert_0_8</title>
<polygon fill="lightgreen" stroke="black" points="2744,-1351.45 2532,-1351.45 2532,-1307.45 2744,-1307.45 2744,-1351.45"/>
<text text-anchor="middle" x="2638" y="-1341.05" font-family="Arial" font-size="8.00">Expert 8 Layer 0</text>
<text text-anchor="middle" x="2638" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 8</text>
<text text-anchor="middle" x="2638" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2638" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_8&#45;&gt;expert_0_8 -->
<g id="edge27" class="edge">
<title>comm_0_8&#45;&gt;expert_0_8</title>
<path fill="none" stroke="black" d="M2651.66,-1387.1C2649.64,-1378.72 2647.45,-1369.64 2645.42,-1361.25"/>
<polygon fill="black" stroke="black" points="2648.81,-1360.36 2643.06,-1351.46 2642,-1362 2648.81,-1360.36"/>
</g>
<!-- expert_0_9 -->
<g id="node29" class="node">
<title>expert_0_9</title>
<polygon fill="lightgreen" stroke="black" points="3035,-1351.45 2823,-1351.45 2823,-1307.45 3035,-1307.45 3035,-1351.45"/>
<text text-anchor="middle" x="2929" y="-1341.05" font-family="Arial" font-size="8.00">Expert 9 Layer 0</text>
<text text-anchor="middle" x="2929" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 9</text>
<text text-anchor="middle" x="2929" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2929" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_9&#45;&gt;expert_0_9 -->
<g id="edge28" class="edge">
<title>comm_0_9&#45;&gt;expert_0_9</title>
<path fill="none" stroke="black" d="M2956.55,-1387.58C2952.36,-1378.91 2947.8,-1369.44 2943.61,-1360.74"/>
<polygon fill="black" stroke="black" points="2946.74,-1359.18 2939.24,-1351.69 2940.43,-1362.22 2946.74,-1359.18"/>
</g>
<!-- expert_0_10 -->
<g id="node30" class="node">
<title>expert_0_10</title>
<polygon fill="lightgreen" stroke="black" points="3337,-1351.45 3125,-1351.45 3125,-1307.45 3337,-1307.45 3337,-1351.45"/>
<text text-anchor="middle" x="3231" y="-1341.05" font-family="Arial" font-size="8.00">Expert 10 Layer 0</text>
<text text-anchor="middle" x="3231" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 10</text>
<text text-anchor="middle" x="3231" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3231" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_10&#45;&gt;expert_0_10 -->
<g id="edge29" class="edge">
<title>comm_0_10&#45;&gt;expert_0_10</title>
<path fill="none" stroke="black" d="M3265.1,-1387.58C3259.87,-1378.82 3254.15,-1369.24 3248.92,-1360.47"/>
<polygon fill="black" stroke="black" points="3251.81,-1358.48 3243.68,-1351.69 3245.8,-1362.07 3251.81,-1358.48"/>
</g>
<!-- expert_0_11 -->
<g id="node31" class="node">
<title>expert_0_11</title>
<polygon fill="lightgreen" stroke="black" points="3644,-1351.45 3432,-1351.45 3432,-1307.45 3644,-1307.45 3644,-1351.45"/>
<text text-anchor="middle" x="3538" y="-1341.05" font-family="Arial" font-size="8.00">Expert 11 Layer 0</text>
<text text-anchor="middle" x="3538" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 11</text>
<text text-anchor="middle" x="3538" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3538" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_11&#45;&gt;expert_0_11 -->
<g id="edge30" class="edge">
<title>comm_0_11&#45;&gt;expert_0_11</title>
<path fill="none" stroke="black" d="M3575.38,-1387.58C3569.59,-1378.73 3563.25,-1369.03 3557.46,-1360.19"/>
<polygon fill="black" stroke="black" points="3560.3,-1358.14 3551.9,-1351.69 3554.44,-1361.98 3560.3,-1358.14"/>
</g>
<!-- expert_0_12 -->
<g id="node32" class="node">
<title>expert_0_12</title>
<polygon fill="lightgreen" stroke="black" points="3953,-1351.45 3741,-1351.45 3741,-1307.45 3953,-1307.45 3953,-1351.45"/>
<text text-anchor="middle" x="3847" y="-1341.05" font-family="Arial" font-size="8.00">Expert 12 Layer 0</text>
<text text-anchor="middle" x="3847" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 12</text>
<text text-anchor="middle" x="3847" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3847" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_12&#45;&gt;expert_0_12 -->
<g id="edge31" class="edge">
<title>comm_0_12&#45;&gt;expert_0_12</title>
<path fill="none" stroke="black" d="M3886.35,-1387.58C3880.25,-1378.73 3873.57,-1369.03 3867.48,-1360.19"/>
<polygon fill="black" stroke="black" points="3870.18,-1357.94 3861.63,-1351.69 3864.42,-1361.91 3870.18,-1357.94"/>
</g>
<!-- expert_0_13 -->
<g id="node33" class="node">
<title>expert_0_13</title>
<polygon fill="lightgreen" stroke="black" points="4264,-1351.45 4052,-1351.45 4052,-1307.45 4264,-1307.45 4264,-1351.45"/>
<text text-anchor="middle" x="4158" y="-1341.05" font-family="Arial" font-size="8.00">Expert 13 Layer 0</text>
<text text-anchor="middle" x="4158" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 13</text>
<text text-anchor="middle" x="4158" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4158" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_13&#45;&gt;expert_0_13 -->
<g id="edge32" class="edge">
<title>comm_0_13&#45;&gt;expert_0_13</title>
<path fill="none" stroke="black" d="M4198.01,-1387.58C4191.74,-1378.63 4184.88,-1368.83 4178.63,-1359.91"/>
<polygon fill="black" stroke="black" points="4181.48,-1357.88 4172.87,-1351.69 4175.74,-1361.89 4181.48,-1357.88"/>
</g>
<!-- expert_0_14 -->
<g id="node34" class="node">
<title>expert_0_14</title>
<polygon fill="lightgreen" stroke="black" points="4575,-1351.45 4363,-1351.45 4363,-1307.45 4575,-1307.45 4575,-1351.45"/>
<text text-anchor="middle" x="4469" y="-1341.05" font-family="Arial" font-size="8.00">Expert 14 Layer 0</text>
<text text-anchor="middle" x="4469" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 14</text>
<text text-anchor="middle" x="4469" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4469" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_14&#45;&gt;expert_0_14 -->
<g id="edge33" class="edge">
<title>comm_0_14&#45;&gt;expert_0_14</title>
<path fill="none" stroke="black" d="M4509.66,-1387.58C4503.29,-1378.63 4496.32,-1368.83 4489.97,-1359.91"/>
<polygon fill="black" stroke="black" points="4492.77,-1357.81 4484.12,-1351.69 4487.06,-1361.87 4492.77,-1357.81"/>
</g>
<!-- expert_0_15 -->
<g id="node35" class="node">
<title>expert_0_15</title>
<polygon fill="lightgreen" stroke="black" points="4887,-1351.45 4675,-1351.45 4675,-1307.45 4887,-1307.45 4887,-1351.45"/>
<text text-anchor="middle" x="4781" y="-1341.05" font-family="Arial" font-size="8.00">Expert 15 Layer 0</text>
<text text-anchor="middle" x="4781" y="-1332.05" font-family="Arial" font-size="8.00">GPU: 15</text>
<text text-anchor="middle" x="4781" y="-1323.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4781" y="-1314.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_0_15&#45;&gt;expert_0_15 -->
<g id="edge34" class="edge">
<title>comm_0_15&#45;&gt;expert_0_15</title>
<path fill="none" stroke="black" d="M4821.66,-1387.58C4815.29,-1378.63 4808.32,-1368.83 4801.97,-1359.91"/>
<polygon fill="black" stroke="black" points="4804.77,-1357.81 4796.12,-1351.69 4799.06,-1361.87 4804.77,-1357.81"/>
</g>
<!-- agg_0 -->
<g id="node36" class="node">
<title>agg_0</title>
<polygon fill="lightyellow" stroke="black" points="2711.24,-1271.45 2346.57,-1271.45 2252.76,-1183.45 2617.43,-1183.45 2711.24,-1271.45"/>
<text text-anchor="middle" x="2482" y="-1239.05" font-family="Arial" font-size="8.00">Aggregate Experts Layer 0</text>
<text text-anchor="middle" x="2482" y="-1230.05" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2482" y="-1221.05" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, experts=16, d_k=512]</text>
<text text-anchor="middle" x="2482" y="-1212.05" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- expert_0_0&#45;&gt;agg_0 -->
<g id="edge35" class="edge">
<title>expert_0_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M310.09,-1317.92C350.97,-1314.16 398.13,-1310.18 441,-1307.45 1122.98,-1264.06 1934.78,-1241.23 2294.49,-1232.59"/>
<polygon fill="black" stroke="black" points="2294.82,-1236.09 2304.74,-1232.35 2294.66,-1229.09 2294.82,-1236.09"/>
</g>
<!-- expert_0_1&#45;&gt;agg_0 -->
<g id="edge36" class="edge">
<title>expert_0_1&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M662.19,-1315.88C691.27,-1312.76 722.82,-1309.68 752,-1307.45 1312.7,-1264.65 1977.53,-1242.22 2295.05,-1233.24"/>
<polygon fill="black" stroke="black" points="2295.37,-1236.74 2305.27,-1232.96 2295.18,-1229.74 2295.37,-1236.74"/>
</g>
<!-- expert_0_2&#45;&gt;agg_0 -->
<g id="edge37" class="edge">
<title>expert_0_2&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M973.17,-1316.01C1001.97,-1312.91 1033.15,-1309.8 1062,-1307.45 1504.65,-1271.33 2026.31,-1246.96 2297.41,-1235.67"/>
<polygon fill="black" stroke="black" points="2297.9,-1239.15 2307.74,-1235.24 2297.61,-1232.16 2297.9,-1239.15"/>
</g>
<!-- expert_0_3&#45;&gt;agg_0 -->
<g id="edge38" class="edge">
<title>expert_0_3&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1283.11,-1316.18C1311.33,-1313.12 1341.8,-1309.99 1370,-1307.45 1697.96,-1277.97 2081.15,-1252.78 2301.31,-1239.2"/>
<polygon fill="black" stroke="black" points="2301.58,-1242.69 2311.34,-1238.58 2301.15,-1235.7 2301.58,-1242.69"/>
</g>
<!-- expert_0_4&#45;&gt;agg_0 -->
<g id="edge39" class="edge">
<title>expert_0_4&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1591.43,-1316.38C1618.36,-1313.39 1647.24,-1310.25 1674,-1307.45 1891.98,-1284.69 2143.26,-1260.43 2306.96,-1244.89"/>
<polygon fill="black" stroke="black" points="2307.5,-1248.36 2317.13,-1243.93 2306.84,-1241.39 2307.5,-1248.36"/>
</g>
<!-- expert_0_5&#45;&gt;agg_0 -->
<g id="edge40" class="edge">
<title>expert_0_5&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1895.01,-1313.15C2006.7,-1297.04 2184.17,-1271.43 2314.76,-1252.58"/>
<polygon fill="black" stroke="black" points="2315.48,-1256.02 2324.87,-1251.12 2314.48,-1249.09 2315.48,-1256.02"/>
</g>
<!-- expert_0_6&#45;&gt;agg_0 -->
<g id="edge41" class="edge">
<title>expert_0_6&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2169.5,-1307.37C2215.84,-1295.66 2274.94,-1280.74 2329.24,-1267.03"/>
<polygon fill="black" stroke="black" points="2330.13,-1270.41 2338.97,-1264.57 2328.41,-1263.63 2330.13,-1270.41"/>
</g>
<!-- expert_0_7&#45;&gt;agg_0 -->
<g id="edge42" class="edge">
<title>expert_0_7&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2391.39,-1307.24C2401.12,-1298.78 2412.78,-1288.64 2424.44,-1278.5"/>
<polygon fill="black" stroke="black" points="2426.83,-1281.06 2432.08,-1271.86 2422.24,-1275.78 2426.83,-1281.06"/>
</g>
<!-- expert_0_8&#45;&gt;agg_0 -->
<g id="edge43" class="edge">
<title>expert_0_8&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2604.92,-1307.24C2591.13,-1298.41 2574.51,-1287.75 2558,-1277.17"/>
<polygon fill="black" stroke="black" points="2559.7,-1274.1 2549.4,-1271.65 2555.93,-1280 2559.7,-1274.1"/>
</g>
<!-- expert_0_9&#45;&gt;agg_0 -->
<g id="edge44" class="edge">
<title>expert_0_9&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2835.02,-1307.43C2791.03,-1297.58 2736.81,-1285.45 2684.18,-1273.68"/>
<polygon fill="black" stroke="black" points="2684.9,-1270.25 2674.37,-1271.49 2683.37,-1277.09 2684.9,-1270.25"/>
</g>
<!-- expert_0_10&#45;&gt;agg_0 -->
<g id="edge45" class="edge">
<title>expert_0_10&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3124.88,-1314.28C3016.4,-1299.8 2844.63,-1276.87 2705.93,-1258.35"/>
<polygon fill="black" stroke="black" points="2706.37,-1254.88 2696,-1257.02 2705.45,-1261.81 2706.37,-1254.88"/>
</g>
<!-- expert_0_11&#45;&gt;agg_0 -->
<g id="edge46" class="edge">
<title>expert_0_11&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3431.9,-1316.51C3403.97,-1313.45 3373.86,-1310.25 3346,-1307.45 3123.82,-1285.14 2869.22,-1262.18 2694.27,-1246.8"/>
<polygon fill="black" stroke="black" points="2694.44,-1243.3 2684.17,-1245.91 2693.82,-1250.28 2694.44,-1243.3"/>
</g>
<!-- expert_0_12&#45;&gt;agg_0 -->
<g id="edge47" class="edge">
<title>expert_0_12&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3740.85,-1316.18C3712.34,-1313.09 3681.52,-1309.96 3653,-1307.45 3314.99,-1277.77 2921.23,-1253.27 2687.28,-1239.78"/>
<polygon fill="black" stroke="black" points="2687.14,-1236.26 2676.95,-1239.18 2686.73,-1243.25 2687.14,-1236.26"/>
</g>
<!-- expert_0_13&#45;&gt;agg_0 -->
<g id="edge48" class="edge">
<title>expert_0_13&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M4051.8,-1316.03C4022.71,-1312.91 3991.17,-1309.79 3962,-1307.45 3505.26,-1270.82 2967.81,-1246.92 2682.95,-1235.77"/>
<polygon fill="black" stroke="black" points="2683.05,-1232.27 2672.92,-1235.38 2682.78,-1239.27 2683.05,-1232.27"/>
</g>
<!-- expert_0_14&#45;&gt;agg_0 -->
<g id="edge49" class="edge">
<title>expert_0_14&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M4362.81,-1315.85C4333.73,-1312.73 4302.18,-1309.66 4273,-1307.45 3695.32,-1263.81 3010.87,-1241.86 2680.3,-1233.14"/>
<polygon fill="black" stroke="black" points="2680.23,-1229.64 2670.14,-1232.87 2680.04,-1236.63 2680.23,-1229.64"/>
</g>
<!-- expert_0_15&#45;&gt;agg_0 -->
<g id="edge50" class="edge">
<title>expert_0_15&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M4674.79,-1315.78C4645.42,-1312.64 4613.5,-1309.58 4584,-1307.45 3884.2,-1257.06 3050.88,-1237.81 2678.59,-1231.34"/>
<polygon fill="black" stroke="black" points="2678.58,-1227.84 2668.52,-1231.17 2678.46,-1234.84 2678.58,-1227.84"/>
</g>
<!-- mha_1 -->
<g id="node37" class="node">
<title>mha_1</title>
<polygon fill="lightgreen" stroke="black" points="2592.5,-1125.45 2371.5,-1125.45 2371.5,-1081.45 2592.5,-1081.45 2592.5,-1125.45"/>
<text text-anchor="middle" x="2482" y="-1115.05" font-family="Arial" font-size="8.00">MHA Layer 1</text>
<text text-anchor="middle" x="2482" y="-1106.05" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2482" y="-1097.05" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2482" y="-1088.05" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_0&#45;&gt;mha_1 -->
<g id="edge51" class="edge">
<title>agg_0&#45;&gt;mha_1</title>
<path fill="none" stroke="blue" stroke-width="2" d="M2482,-1183.44C2482,-1167.8 2482,-1150.44 2482,-1135.98"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="2485.5,-1135.57 2482,-1125.57 2478.5,-1135.57 2485.5,-1135.57"/>
</g>
<!-- gate_1 -->
<g id="node38" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="2714.47,-1023.45 2344.66,-1023.45 2249.53,-935.45 2619.34,-935.45 2714.47,-1023.45"/>
<text text-anchor="middle" x="2482" y="-991.05" font-family="Arial" font-size="8.00">Gate Layer 1</text>
<text text-anchor="middle" x="2482" y="-982.05" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2482" y="-973.05" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2482" y="-964.05" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_1&#45;&gt;gate_1 -->
<g id="edge52" class="edge">
<title>mha_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M2482,-1081.2C2482,-1068.08 2482,-1050.62 2482,-1033.93"/>
<polygon fill="black" stroke="black" points="2485.5,-1033.68 2482,-1023.68 2478.5,-1033.68 2485.5,-1033.68"/>
</g>
<!-- comm_1_0 -->
<g id="node39" class="node">
<title>comm_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="163" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="163" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 0</text>
<text text-anchor="middle" x="163" y="-870.94" font-family="Arial" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="163" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="163" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_0 -->
<g id="edge53" class="edge">
<title>gate_1&#45;&gt;comm_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2292.24,-975.28C1838.1,-967.07 698.3,-942.72 319,-899.45 304.27,-897.77 288.86,-895.47 273.69,-892.88"/>
<polygon fill="red" stroke="red" points="274.22,-889.42 263.77,-891.14 273.01,-896.32 274.22,-889.42"/>
</g>
<!-- comm_1_1 -->
<g id="node40" class="node">
<title>comm_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="475" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="475" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 1</text>
<text text-anchor="middle" x="475" y="-870.94" font-family="Arial" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="475" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="475" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_1 -->
<g id="edge54" class="edge">
<title>gate_1&#45;&gt;comm_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2291.02,-973.89C1885.13,-963.61 947.86,-936.59 631,-899.45 616.28,-897.73 600.87,-895.4 585.7,-892.8"/>
<polygon fill="red" stroke="red" points="586.23,-889.34 575.78,-891.05 585.02,-896.23 586.23,-889.34"/>
</g>
<!-- comm_1_2 -->
<g id="node41" class="node">
<title>comm_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="787" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="787" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 2</text>
<text text-anchor="middle" x="787" y="-870.94" font-family="Arial" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="787" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="787" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_2 -->
<g id="edge55" class="edge">
<title>gate_1&#45;&gt;comm_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2294.42,-977.23C2003.85,-973.45 1427.86,-958.4 943,-899.45 928.4,-897.68 913.11,-895.33 898.06,-892.74"/>
<polygon fill="red" stroke="red" points="898.67,-889.29 888.21,-891 897.45,-896.18 898.67,-889.29"/>
</g>
<!-- comm_1_3 -->
<g id="node42" class="node">
<title>comm_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="1099" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="1099" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 3</text>
<text text-anchor="middle" x="1099" y="-870.94" font-family="Arial" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="1099" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1099" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_3 -->
<g id="edge56" class="edge">
<title>gate_1&#45;&gt;comm_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2290.79,-973.62C2048.81,-965.79 1619.57,-946.18 1255,-899.45 1240.66,-897.61 1225.66,-895.27 1210.86,-892.69"/>
<polygon fill="red" stroke="red" points="1211.12,-889.19 1200.66,-890.88 1209.89,-896.08 1211.12,-889.19"/>
</g>
<!-- comm_1_4 -->
<g id="node43" class="node">
<title>comm_1_4</title>
<ellipse fill="lightblue" stroke="black" cx="1411" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="1411" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 4</text>
<text text-anchor="middle" x="1411" y="-870.94" font-family="Arial" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="1411" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1411" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_4 -->
<g id="edge57" class="edge">
<title>gate_1&#45;&gt;comm_1_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2283.65,-967.33C2097.87,-955.49 1812.76,-933.68 1567,-899.45 1552.9,-897.49 1538.15,-895.09 1523.59,-892.52"/>
<polygon fill="red" stroke="red" points="1524,-889.04 1513.54,-890.71 1522.76,-895.93 1524,-889.04"/>
</g>
<!-- comm_1_5 -->
<g id="node44" class="node">
<title>comm_1_5</title>
<ellipse fill="lightblue" stroke="black" cx="1723" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="1723" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 5</text>
<text text-anchor="middle" x="1723" y="-870.94" font-family="Arial" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="1723" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="1723" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_5 -->
<g id="edge58" class="edge">
<title>gate_1&#45;&gt;comm_1_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2269.1,-953.74C2153.46,-939.52 2008.11,-920.35 1879,-899.45 1865.52,-897.27 1851.43,-894.81 1837.46,-892.25"/>
<polygon fill="red" stroke="red" points="1837.79,-888.75 1827.32,-890.38 1836.51,-895.64 1837.79,-888.75"/>
</g>
<!-- comm_1_6 -->
<g id="node45" class="node">
<title>comm_1_6</title>
<ellipse fill="lightblue" stroke="black" cx="2035" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2035" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 6</text>
<text text-anchor="middle" x="2035" y="-870.94" font-family="Arial" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="2035" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2035" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_6 -->
<g id="edge59" class="edge">
<title>gate_1&#45;&gt;comm_1_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2305.65,-935.4C2249.11,-921.6 2188.35,-906.77 2138.76,-894.67"/>
<polygon fill="red" stroke="red" points="2139.54,-891.25 2128.99,-892.28 2137.88,-898.05 2139.54,-891.25"/>
</g>
<!-- comm_1_7 -->
<g id="node46" class="node">
<title>comm_1_7</title>
<ellipse fill="lightblue" stroke="black" cx="2347" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2347" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 7</text>
<text text-anchor="middle" x="2347" y="-870.94" font-family="Arial" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="2347" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2347" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_7 -->
<g id="edge60" class="edge">
<title>gate_1&#45;&gt;comm_1_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2428.64,-935.33C2416.31,-925.36 2403.31,-914.85 2391.41,-905.23"/>
<polygon fill="red" stroke="red" points="2393.34,-902.29 2383.36,-898.73 2388.94,-907.73 2393.34,-902.29"/>
</g>
<!-- comm_1_8 -->
<g id="node47" class="node">
<title>comm_1_8</title>
<ellipse fill="lightblue" stroke="black" cx="2659" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2659" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 8</text>
<text text-anchor="middle" x="2659" y="-870.94" font-family="Arial" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="2659" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2659" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_8 -->
<g id="edge61" class="edge">
<title>gate_1&#45;&gt;comm_1_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2551.96,-935.33C2569.16,-924.72 2587.34,-913.51 2603.74,-903.4"/>
<polygon fill="red" stroke="red" points="2605.97,-906.14 2612.65,-897.91 2602.3,-900.18 2605.97,-906.14"/>
</g>
<!-- comm_1_9 -->
<g id="node48" class="node">
<title>comm_1_9</title>
<ellipse fill="lightblue" stroke="black" cx="2971" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2971" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 9</text>
<text text-anchor="middle" x="2971" y="-870.94" font-family="Arial" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="2971" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2971" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_9 -->
<g id="edge62" class="edge">
<title>gate_1&#45;&gt;comm_1_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2630.38,-945.34C2704.98,-928.7 2793.78,-908.88 2862.01,-893.66"/>
<polygon fill="red" stroke="red" points="2862.92,-897.04 2871.92,-891.45 2861.4,-890.21 2862.92,-897.04"/>
</g>
<!-- comm_1_10 -->
<g id="node49" class="node">
<title>comm_1_10</title>
<ellipse fill="lightblue" stroke="black" cx="3283" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="3283" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 10</text>
<text text-anchor="middle" x="3283" y="-870.94" font-family="Arial" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="3283" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3283" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_10 -->
<g id="edge63" class="edge">
<title>gate_1&#45;&gt;comm_1_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2647.47,-961.35C2778.03,-947.1 2964.57,-925.04 3127,-899.45 3140.59,-897.31 3154.81,-894.86 3168.9,-892.3"/>
<polygon fill="red" stroke="red" points="3169.92,-895.67 3179.12,-890.42 3168.65,-888.79 3169.92,-895.67"/>
</g>
<!-- comm_1_11 -->
<g id="node50" class="node">
<title>comm_1_11</title>
<ellipse fill="lightblue" stroke="black" cx="3595" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="3595" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 11</text>
<text text-anchor="middle" x="3595" y="-870.94" font-family="Arial" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="3595" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3595" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_11 -->
<g id="edge64" class="edge">
<title>gate_1&#45;&gt;comm_1_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2656.81,-969.72C2849.15,-958.78 3167.11,-936.8 3439,-899.45 3453.1,-897.51 3467.85,-895.13 3482.42,-892.57"/>
<polygon fill="red" stroke="red" points="3483.24,-895.98 3492.47,-890.77 3482.01,-889.09 3483.24,-895.98"/>
</g>
<!-- comm_1_12 -->
<g id="node51" class="node">
<title>comm_1_12</title>
<ellipse fill="lightblue" stroke="black" cx="3907" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="3907" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 12</text>
<text text-anchor="middle" x="3907" y="-870.94" font-family="Arial" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="3907" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="3907" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_12 -->
<g id="edge65" class="edge">
<title>gate_1&#45;&gt;comm_1_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2661.84,-974.52C2908.38,-967.49 3364.78,-948.54 3751,-899.45 3765.34,-897.63 3780.35,-895.29 3795.15,-892.72"/>
<polygon fill="red" stroke="red" points="3796.11,-896.11 3805.35,-890.91 3794.89,-889.21 3796.11,-896.11"/>
</g>
<!-- comm_1_13 -->
<g id="node52" class="node">
<title>comm_1_13</title>
<ellipse fill="lightblue" stroke="black" cx="4219" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="4219" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 13</text>
<text text-anchor="middle" x="4219" y="-870.94" font-family="Arial" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="4219" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="4219" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_13 -->
<g id="edge66" class="edge">
<title>gate_1&#45;&gt;comm_1_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2664.99,-977.65C2960.22,-974.49 3559.45,-960.32 4063,-899.45 4077.6,-897.69 4092.89,-895.35 4107.94,-892.76"/>
<polygon fill="red" stroke="red" points="4108.55,-896.2 4117.79,-891.02 4107.33,-889.31 4108.55,-896.2"/>
</g>
<!-- comm_1_14 -->
<g id="node53" class="node">
<title>comm_1_14</title>
<ellipse fill="lightblue" stroke="black" cx="4531" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="4531" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 14</text>
<text text-anchor="middle" x="4531" y="-870.94" font-family="Arial" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="4531" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="4531" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_14 -->
<g id="edge67" class="edge">
<title>gate_1&#45;&gt;comm_1_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2661.5,-974.38C3067.54,-964.6 4046.75,-937.76 4375,-899.45 4389.72,-897.73 4405.13,-895.41 4420.3,-892.81"/>
<polygon fill="red" stroke="red" points="4420.98,-896.24 4430.22,-891.07 4419.77,-889.35 4420.98,-896.24"/>
</g>
<!-- comm_1_15 -->
<g id="node54" class="node">
<title>comm_1_15</title>
<ellipse fill="lightblue" stroke="black" cx="4843" cy="-868.34" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="4843" y="-879.94" font-family="Arial" font-size="8.00">Route to Expert 15</text>
<text text-anchor="middle" x="4843" y="-870.94" font-family="Arial" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="4843" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="4843" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_1&#45;&gt;comm_1_15 -->
<g id="edge68" class="edge">
<title>gate_1&#45;&gt;comm_1_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2662.8,-975.58C3116.89,-967.8 4296.76,-943.83 4687,-899.45 4701.73,-897.78 4717.14,-895.48 4732.31,-892.89"/>
<polygon fill="red" stroke="red" points="4732.99,-896.33 4742.23,-891.15 4731.78,-889.43 4732.99,-896.33"/>
</g>
<!-- expert_1_0 -->
<g id="node55" class="node">
<title>expert_1_0</title>
<polygon fill="lightgreen" stroke="black" points="350,-779.23 138,-779.23 138,-735.23 350,-735.23 350,-779.23"/>
<text text-anchor="middle" x="244" y="-768.83" font-family="Arial" font-size="8.00">Expert 0 Layer 1</text>
<text text-anchor="middle" x="244" y="-759.83" font-family="Arial" font-size="8.00">GPU: 16</text>
<text text-anchor="middle" x="244" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="244" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_0&#45;&gt;expert_1_0 -->
<g id="edge69" class="edge">
<title>comm_1_0&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M185.13,-837.52C196.67,-821.98 210.74,-803.03 222.23,-787.56"/>
<polygon fill="black" stroke="black" points="225.16,-789.48 228.31,-779.36 219.54,-785.3 225.16,-789.48"/>
</g>
<!-- expert_1_1 -->
<g id="node56" class="node">
<title>expert_1_1</title>
<polygon fill="lightgreen" stroke="black" points="662,-779.23 450,-779.23 450,-735.23 662,-735.23 662,-779.23"/>
<text text-anchor="middle" x="556" y="-768.83" font-family="Arial" font-size="8.00">Expert 1 Layer 1</text>
<text text-anchor="middle" x="556" y="-759.83" font-family="Arial" font-size="8.00">GPU: 17</text>
<text text-anchor="middle" x="556" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="556" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_1&#45;&gt;expert_1_1 -->
<g id="edge70" class="edge">
<title>comm_1_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M497.13,-837.52C508.67,-821.98 522.74,-803.03 534.23,-787.56"/>
<polygon fill="black" stroke="black" points="537.16,-789.48 540.31,-779.36 531.54,-785.3 537.16,-789.48"/>
</g>
<!-- expert_1_2 -->
<g id="node57" class="node">
<title>expert_1_2</title>
<polygon fill="lightgreen" stroke="black" points="973,-779.23 761,-779.23 761,-735.23 973,-735.23 973,-779.23"/>
<text text-anchor="middle" x="867" y="-768.83" font-family="Arial" font-size="8.00">Expert 2 Layer 1</text>
<text text-anchor="middle" x="867" y="-759.83" font-family="Arial" font-size="8.00">GPU: 18</text>
<text text-anchor="middle" x="867" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="867" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_2&#45;&gt;expert_1_2 -->
<g id="edge71" class="edge">
<title>comm_1_2&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M808.86,-837.52C820.26,-821.98 834.15,-803.03 845.49,-787.56"/>
<polygon fill="black" stroke="black" points="848.41,-789.49 851.5,-779.36 842.77,-785.36 848.41,-789.49"/>
</g>
<!-- expert_1_3 -->
<g id="node58" class="node">
<title>expert_1_3</title>
<polygon fill="lightgreen" stroke="black" points="1283,-779.23 1071,-779.23 1071,-735.23 1283,-735.23 1283,-779.23"/>
<text text-anchor="middle" x="1177" y="-768.83" font-family="Arial" font-size="8.00">Expert 3 Layer 1</text>
<text text-anchor="middle" x="1177" y="-759.83" font-family="Arial" font-size="8.00">GPU: 19</text>
<text text-anchor="middle" x="1177" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1177" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_3&#45;&gt;expert_1_3 -->
<g id="edge72" class="edge">
<title>comm_1_3&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M1120.31,-837.52C1131.43,-821.98 1144.97,-803.03 1156.03,-787.56"/>
<polygon fill="black" stroke="black" points="1158.92,-789.53 1161.89,-779.36 1153.23,-785.46 1158.92,-789.53"/>
</g>
<!-- expert_1_4 -->
<g id="node59" class="node">
<title>expert_1_4</title>
<polygon fill="lightgreen" stroke="black" points="1591,-779.23 1379,-779.23 1379,-735.23 1591,-735.23 1591,-779.23"/>
<text text-anchor="middle" x="1485" y="-768.83" font-family="Arial" font-size="8.00">Expert 4 Layer 1</text>
<text text-anchor="middle" x="1485" y="-759.83" font-family="Arial" font-size="8.00">GPU: 20</text>
<text text-anchor="middle" x="1485" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1485" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_4&#45;&gt;expert_1_4 -->
<g id="edge73" class="edge">
<title>comm_1_4&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M1431.42,-837.23C1441.86,-821.84 1454.52,-803.16 1464.92,-787.84"/>
<polygon fill="black" stroke="black" points="1468.03,-789.49 1470.74,-779.25 1462.23,-785.56 1468.03,-789.49"/>
</g>
<!-- expert_1_5 -->
<g id="node60" class="node">
<title>expert_1_5</title>
<polygon fill="lightgreen" stroke="black" points="1895,-779.23 1683,-779.23 1683,-735.23 1895,-735.23 1895,-779.23"/>
<text text-anchor="middle" x="1789" y="-768.83" font-family="Arial" font-size="8.00">Expert 5 Layer 1</text>
<text text-anchor="middle" x="1789" y="-759.83" font-family="Arial" font-size="8.00">GPU: 21</text>
<text text-anchor="middle" x="1789" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="1789" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_5&#45;&gt;expert_1_5 -->
<g id="edge74" class="edge">
<title>comm_1_5&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M1741.21,-837.23C1750.52,-821.84 1761.82,-803.16 1771.09,-787.84"/>
<polygon fill="black" stroke="black" points="1774.1,-789.62 1776.28,-779.25 1768.11,-785.99 1774.1,-789.62"/>
</g>
<!-- expert_1_6 -->
<g id="node61" class="node">
<title>expert_1_6</title>
<polygon fill="lightgreen" stroke="black" points="2192,-779.23 1980,-779.23 1980,-735.23 2192,-735.23 2192,-779.23"/>
<text text-anchor="middle" x="2086" y="-768.83" font-family="Arial" font-size="8.00">Expert 6 Layer 1</text>
<text text-anchor="middle" x="2086" y="-759.83" font-family="Arial" font-size="8.00">GPU: 22</text>
<text text-anchor="middle" x="2086" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2086" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_6&#45;&gt;expert_1_6 -->
<g id="edge75" class="edge">
<title>comm_1_6&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M2049.07,-837.23C2056.13,-822.12 2064.67,-803.86 2071.76,-788.7"/>
<polygon fill="black" stroke="black" points="2075.11,-789.79 2076.17,-779.25 2068.77,-786.83 2075.11,-789.79"/>
</g>
<!-- expert_1_7 -->
<g id="node62" class="node">
<title>expert_1_7</title>
<polygon fill="lightgreen" stroke="black" points="2473,-779.23 2261,-779.23 2261,-735.23 2473,-735.23 2473,-779.23"/>
<text text-anchor="middle" x="2367" y="-768.83" font-family="Arial" font-size="8.00">Expert 7 Layer 1</text>
<text text-anchor="middle" x="2367" y="-759.83" font-family="Arial" font-size="8.00">GPU: 23</text>
<text text-anchor="middle" x="2367" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2367" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_7&#45;&gt;expert_1_7 -->
<g id="edge76" class="edge">
<title>comm_1_7&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M2352.52,-837.23C2355.26,-822.27 2358.57,-804.21 2361.33,-789.13"/>
<polygon fill="black" stroke="black" points="2364.79,-789.72 2363.15,-779.25 2357.9,-788.45 2364.79,-789.72"/>
</g>
<!-- expert_1_8 -->
<g id="node63" class="node">
<title>expert_1_8</title>
<polygon fill="lightgreen" stroke="black" points="2744,-779.23 2532,-779.23 2532,-735.23 2744,-735.23 2744,-779.23"/>
<text text-anchor="middle" x="2638" y="-768.83" font-family="Arial" font-size="8.00">Expert 8 Layer 1</text>
<text text-anchor="middle" x="2638" y="-759.83" font-family="Arial" font-size="8.00">GPU: 24</text>
<text text-anchor="middle" x="2638" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2638" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_8&#45;&gt;expert_1_8 -->
<g id="edge77" class="edge">
<title>comm_1_8&#45;&gt;expert_1_8</title>
<path fill="none" stroke="black" d="M2653.21,-837.23C2650.33,-822.27 2646.85,-804.21 2643.95,-789.13"/>
<polygon fill="black" stroke="black" points="2647.37,-788.41 2642.05,-779.25 2640.5,-789.73 2647.37,-788.41"/>
</g>
<!-- expert_1_9 -->
<g id="node64" class="node">
<title>expert_1_9</title>
<polygon fill="lightgreen" stroke="black" points="3035,-779.23 2823,-779.23 2823,-735.23 3035,-735.23 3035,-779.23"/>
<text text-anchor="middle" x="2929" y="-768.83" font-family="Arial" font-size="8.00">Expert 9 Layer 1</text>
<text text-anchor="middle" x="2929" y="-759.83" font-family="Arial" font-size="8.00">GPU: 25</text>
<text text-anchor="middle" x="2929" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2929" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_9&#45;&gt;expert_1_9 -->
<g id="edge78" class="edge">
<title>comm_1_9&#45;&gt;expert_1_9</title>
<path fill="none" stroke="black" d="M2959.41,-837.23C2953.6,-822.12 2946.57,-803.86 2940.73,-788.7"/>
<polygon fill="black" stroke="black" points="2943.95,-787.32 2937.09,-779.25 2937.42,-789.84 2943.95,-787.32"/>
</g>
<!-- expert_1_10 -->
<g id="node65" class="node">
<title>expert_1_10</title>
<polygon fill="lightgreen" stroke="black" points="3337,-779.23 3125,-779.23 3125,-735.23 3337,-735.23 3337,-779.23"/>
<text text-anchor="middle" x="3231" y="-768.83" font-family="Arial" font-size="8.00">Expert 10 Layer 1</text>
<text text-anchor="middle" x="3231" y="-759.83" font-family="Arial" font-size="8.00">GPU: 26</text>
<text text-anchor="middle" x="3231" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3231" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_10&#45;&gt;expert_1_10 -->
<g id="edge79" class="edge">
<title>comm_1_10&#45;&gt;expert_1_10</title>
<path fill="none" stroke="black" d="M3268.65,-837.23C3261.45,-822.12 3252.75,-803.86 3245.52,-788.7"/>
<polygon fill="black" stroke="black" points="3248.48,-786.77 3241.02,-779.25 3242.16,-789.78 3248.48,-786.77"/>
</g>
<!-- expert_1_11 -->
<g id="node66" class="node">
<title>expert_1_11</title>
<polygon fill="lightgreen" stroke="black" points="3644,-779.23 3432,-779.23 3432,-735.23 3644,-735.23 3644,-779.23"/>
<text text-anchor="middle" x="3538" y="-768.83" font-family="Arial" font-size="8.00">Expert 11 Layer 1</text>
<text text-anchor="middle" x="3538" y="-759.83" font-family="Arial" font-size="8.00">GPU: 27</text>
<text text-anchor="middle" x="3538" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3538" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_11&#45;&gt;expert_1_11 -->
<g id="edge80" class="edge">
<title>comm_1_11&#45;&gt;expert_1_11</title>
<path fill="none" stroke="black" d="M3579.27,-837.23C3571.31,-821.98 3561.66,-803.51 3553.69,-788.27"/>
<polygon fill="black" stroke="black" points="3556.72,-786.49 3548.98,-779.25 3550.51,-789.73 3556.72,-786.49"/>
</g>
<!-- expert_1_12 -->
<g id="node67" class="node">
<title>expert_1_12</title>
<polygon fill="lightgreen" stroke="black" points="3953,-779.23 3741,-779.23 3741,-735.23 3953,-735.23 3953,-779.23"/>
<text text-anchor="middle" x="3847" y="-768.83" font-family="Arial" font-size="8.00">Expert 12 Layer 1</text>
<text text-anchor="middle" x="3847" y="-759.83" font-family="Arial" font-size="8.00">GPU: 28</text>
<text text-anchor="middle" x="3847" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="3847" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_12&#45;&gt;expert_1_12 -->
<g id="edge81" class="edge">
<title>comm_1_12&#45;&gt;expert_1_12</title>
<path fill="none" stroke="black" d="M3890.45,-837.23C3882.06,-821.98 3871.9,-803.51 3863.52,-788.27"/>
<polygon fill="black" stroke="black" points="3866.45,-786.33 3858.56,-779.25 3860.31,-789.7 3866.45,-786.33"/>
</g>
<!-- expert_1_13 -->
<g id="node68" class="node">
<title>expert_1_13</title>
<polygon fill="lightgreen" stroke="black" points="4264,-779.23 4052,-779.23 4052,-735.23 4264,-735.23 4264,-779.23"/>
<text text-anchor="middle" x="4158" y="-768.83" font-family="Arial" font-size="8.00">Expert 13 Layer 1</text>
<text text-anchor="middle" x="4158" y="-759.83" font-family="Arial" font-size="8.00">GPU: 29</text>
<text text-anchor="middle" x="4158" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4158" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_13&#45;&gt;expert_1_13 -->
<g id="edge82" class="edge">
<title>comm_1_13&#45;&gt;expert_1_13</title>
<path fill="none" stroke="black" d="M4202.17,-837.23C4193.64,-821.98 4183.32,-803.51 4174.79,-788.27"/>
<polygon fill="black" stroke="black" points="4177.69,-786.27 4169.75,-779.25 4171.58,-789.69 4177.69,-786.27"/>
</g>
<!-- expert_1_14 -->
<g id="node69" class="node">
<title>expert_1_14</title>
<polygon fill="lightgreen" stroke="black" points="4575,-779.23 4363,-779.23 4363,-735.23 4575,-735.23 4575,-779.23"/>
<text text-anchor="middle" x="4469" y="-768.83" font-family="Arial" font-size="8.00">Expert 14 Layer 1</text>
<text text-anchor="middle" x="4469" y="-759.83" font-family="Arial" font-size="8.00">GPU: 30</text>
<text text-anchor="middle" x="4469" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4469" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_14&#45;&gt;expert_1_14 -->
<g id="edge83" class="edge">
<title>comm_1_14&#45;&gt;expert_1_14</title>
<path fill="none" stroke="black" d="M4513.89,-837.23C4505.23,-821.98 4494.73,-803.51 4486.07,-788.27"/>
<polygon fill="black" stroke="black" points="4488.93,-786.21 4480.95,-779.25 4482.84,-789.67 4488.93,-786.21"/>
</g>
<!-- expert_1_15 -->
<g id="node70" class="node">
<title>expert_1_15</title>
<polygon fill="lightgreen" stroke="black" points="4887,-779.23 4675,-779.23 4675,-735.23 4887,-735.23 4887,-779.23"/>
<text text-anchor="middle" x="4781" y="-768.83" font-family="Arial" font-size="8.00">Expert 15 Layer 1</text>
<text text-anchor="middle" x="4781" y="-759.83" font-family="Arial" font-size="8.00">GPU: 31</text>
<text text-anchor="middle" x="4781" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="4781" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- comm_1_15&#45;&gt;expert_1_15 -->
<g id="edge84" class="edge">
<title>comm_1_15&#45;&gt;expert_1_15</title>
<path fill="none" stroke="black" d="M4825.89,-837.23C4817.23,-821.98 4806.73,-803.51 4798.07,-788.27"/>
<polygon fill="black" stroke="black" points="4800.93,-786.21 4792.95,-779.25 4794.84,-789.67 4800.93,-786.21"/>
</g>
<!-- agg_1 -->
<g id="node71" class="node">
<title>agg_1</title>
<polygon fill="lightyellow" stroke="black" points="2731.24,-677.23 2366.57,-677.23 2272.76,-589.23 2637.43,-589.23 2731.24,-677.23"/>
<text text-anchor="middle" x="2502" y="-644.83" font-family="Arial" font-size="8.00">Aggregate Experts Layer 1</text>
<text text-anchor="middle" x="2502" y="-635.83" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2502" y="-626.83" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, experts=16, d_k=512]</text>
<text text-anchor="middle" x="2502" y="-617.83" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- expert_1_0&#45;&gt;agg_1 -->
<g id="edge85" class="edge">
<title>expert_1_0&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M310.28,-735.2C348.15,-724.16 396.77,-711.63 441,-705.23 798.38,-653.45 1872.26,-639.18 2311.55,-635.46"/>
<polygon fill="black" stroke="black" points="2311.84,-638.96 2321.81,-635.38 2311.78,-631.96 2311.84,-638.96"/>
</g>
<!-- expert_1_1&#45;&gt;agg_1 -->
<g id="edge86" class="edge">
<title>expert_1_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M622.4,-735.17C660.01,-724.2 708.18,-711.74 752,-705.23 1048.17,-661.21 1924.34,-642.89 2312.85,-636.79"/>
<polygon fill="black" stroke="black" points="2313.12,-640.29 2323.07,-636.63 2313.01,-633.29 2313.12,-640.29"/>
</g>
<!-- expert_1_2&#45;&gt;agg_1 -->
<g id="edge87" class="edge">
<title>expert_1_2&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M933.52,-735.18C970.88,-724.29 1018.59,-711.9 1062,-705.23 1297.91,-668.96 1981.49,-647.32 2314.82,-638.65"/>
<polygon fill="black" stroke="black" points="2315.16,-642.14 2325.07,-638.38 2314.98,-635.14 2315.16,-642.14"/>
</g>
<!-- expert_1_3&#45;&gt;agg_1 -->
<g id="edge88" class="edge">
<title>expert_1_3&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1243.74,-735.14C1280.59,-724.37 1327.41,-712.12 1370,-705.23 1697.6,-652.19 2084.48,-638.21 2310.6,-634.85"/>
<polygon fill="black" stroke="black" points="2310.96,-638.35 2320.91,-634.71 2310.86,-631.35 2310.96,-638.35"/>
</g>
<!-- expert_1_4&#45;&gt;agg_1 -->
<g id="edge89" class="edge">
<title>expert_1_4&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1551.7,-735.11C1587.59,-724.54 1632.83,-712.49 1674,-705.23 1892.78,-666.64 2147.93,-648.79 2316.55,-640.68"/>
<polygon fill="black" stroke="black" points="2316.95,-644.17 2326.77,-640.2 2316.62,-637.18 2316.95,-644.17"/>
</g>
<!-- expert_1_5&#45;&gt;agg_1 -->
<g id="edge90" class="edge">
<title>expert_1_5&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1855.44,-735.19C1889.68,-724.97 1932.27,-713.2 1971,-705.23 2088.92,-680.94 2223.36,-663.06 2327.46,-651.32"/>
<polygon fill="black" stroke="black" points="2327.89,-654.8 2337.44,-650.2 2327.11,-647.84 2327.89,-654.8"/>
</g>
<!-- expert_1_6&#45;&gt;agg_1 -->
<g id="edge91" class="edge">
<title>expert_1_6&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2153.34,-735.18C2183.48,-725.85 2219.47,-714.84 2252,-705.23 2284.49,-695.62 2319.43,-685.54 2352.58,-676.1"/>
<polygon fill="black" stroke="black" points="2353.69,-679.42 2362.35,-673.32 2351.77,-672.69 2353.69,-679.42"/>
</g>
<!-- expert_1_7&#45;&gt;agg_1 -->
<g id="edge92" class="edge">
<title>expert_1_7&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2390.52,-734.97C2406.06,-720.93 2427.11,-701.91 2446.73,-684.17"/>
<polygon fill="black" stroke="black" points="2449.09,-686.75 2454.17,-677.45 2444.4,-681.56 2449.09,-686.75"/>
</g>
<!-- expert_1_8&#45;&gt;agg_1 -->
<g id="edge93" class="edge">
<title>expert_1_8&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2614.31,-734.97C2598.65,-720.93 2577.45,-701.91 2557.68,-684.17"/>
<polygon fill="black" stroke="black" points="2559.97,-681.52 2550.19,-677.45 2555.29,-686.74 2559.97,-681.52"/>
</g>
<!-- expert_1_9&#45;&gt;agg_1 -->
<g id="edge94" class="edge">
<title>expert_1_9&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2856.67,-735.15C2824.88,-725.92 2787.1,-714.99 2753,-705.23 2724.45,-697.05 2694.05,-688.4 2664.63,-680.06"/>
<polygon fill="black" stroke="black" points="2665.26,-676.61 2654.69,-677.25 2663.36,-683.34 2665.26,-676.61"/>
</g>
<!-- expert_1_10&#45;&gt;agg_1 -->
<g id="edge95" class="edge">
<title>expert_1_10&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3162.7,-735.2C3127.52,-724.98 3083.76,-713.21 3044,-705.23 2937.18,-683.77 2817.16,-667.27 2717.27,-655.61"/>
<polygon fill="black" stroke="black" points="2717.39,-652.1 2707.05,-654.43 2716.58,-659.06 2717.39,-652.1"/>
</g>
<!-- expert_1_11&#45;&gt;agg_1 -->
<g id="edge96" class="edge">
<title>expert_1_11&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3470.22,-735.1C3433.75,-724.53 3387.8,-712.48 3346,-705.23 3127.95,-667.4 2874.58,-649.51 2702.77,-641.19"/>
<polygon fill="black" stroke="black" points="2702.76,-637.68 2692.61,-640.7 2702.43,-644.68 2702.76,-637.68"/>
</g>
<!-- expert_1_12&#45;&gt;agg_1 -->
<g id="edge97" class="edge">
<title>expert_1_12&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3779.91,-735.13C3742.86,-724.36 3695.81,-712.1 3653,-705.23 3319.69,-651.66 2926.11,-637.86 2696.26,-634.67"/>
<polygon fill="black" stroke="black" points="2696.16,-631.17 2686.12,-634.54 2696.07,-638.17 2696.16,-631.17"/>
</g>
<!-- expert_1_13&#45;&gt;agg_1 -->
<g id="edge98" class="edge">
<title>expert_1_13&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M4091.14,-735.17C4053.58,-724.28 4005.62,-711.89 3962,-705.23 3724.82,-669 3041.49,-647.55 2700.48,-638.82"/>
<polygon fill="black" stroke="black" points="2700.33,-635.31 2690.24,-638.56 2700.15,-642.31 2700.33,-635.31"/>
</g>
<!-- expert_1_14&#45;&gt;agg_1 -->
<g id="edge99" class="edge">
<title>expert_1_14&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M4402.61,-735.16C4364.99,-724.18 4316.82,-711.73 4273,-705.23 3974.52,-660.93 3093.95,-642.84 2698.35,-636.79"/>
<polygon fill="black" stroke="black" points="2698.29,-633.29 2688.23,-636.64 2698.18,-640.29 2698.29,-633.29"/>
</g>
<!-- expert_1_15&#45;&gt;agg_1 -->
<g id="edge100" class="edge">
<title>expert_1_15&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M4714.72,-735.19C4676.85,-724.15 4628.23,-711.63 4584,-705.23 4223.66,-653.08 3142.29,-639.04 2696.94,-635.42"/>
<polygon fill="black" stroke="black" points="2696.89,-631.92 2686.86,-635.34 2696.83,-638.92 2696.89,-631.92"/>
</g>
<!-- mha_2 -->
<g id="node72" class="node">
<title>mha_2</title>
<polygon fill="lightgreen" stroke="black" points="2612.5,-542.23 2391.5,-542.23 2391.5,-498.23 2612.5,-498.23 2612.5,-542.23"/>
<text text-anchor="middle" x="2502" y="-531.83" font-family="Arial" font-size="8.00">MHA Layer 2</text>
<text text-anchor="middle" x="2502" y="-522.83" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2502" y="-513.83" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2502" y="-504.83" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_1&#45;&gt;mha_2 -->
<g id="edge101" class="edge">
<title>agg_1&#45;&gt;mha_2</title>
<path fill="none" stroke="blue" stroke-width="2" d="M2502,-588.99C2502,-576.91 2502,-564 2502,-552.73"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="2505.5,-552.51 2502,-542.51 2498.5,-552.51 2505.5,-552.51"/>
</g>
<!-- gate_2 -->
<g id="node73" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="2734.47,-462.23 2364.66,-462.23 2269.53,-374.23 2639.34,-374.23 2734.47,-462.23"/>
<text text-anchor="middle" x="2502" y="-429.83" font-family="Arial" font-size="8.00">Gate Layer 2</text>
<text text-anchor="middle" x="2502" y="-420.83" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2502" y="-411.83" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2502" y="-402.83" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_2&#45;&gt;gate_2 -->
<g id="edge102" class="edge">
<title>mha_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M2502,-498.02C2502,-490.52 2502,-481.71 2502,-472.75"/>
<polygon fill="black" stroke="black" points="2505.5,-472.63 2502,-462.63 2498.5,-472.63 2505.5,-472.63"/>
</g>
<!-- comm_2 -->
<g id="node75" class="node">
<title>comm_2</title>
<ellipse fill="lightblue" stroke="black" cx="2502" cy="-307.11" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="2502" y="-318.71" font-family="Arial" font-size="8.00">Expert Routing Layer 2</text>
<text text-anchor="middle" x="2502" y="-309.71" font-family="Arial" font-size="8.00">GPUs: 32&#45;47</text>
<text text-anchor="middle" x="2502" y="-300.71" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="2502" y="-291.71" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_2&#45;&gt;comm_2 -->
<g id="edge103" class="edge">
<title>gate_2&#45;&gt;comm_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2502,-374.1C2502,-365.72 2502,-356.97 2502,-348.68"/>
<polygon fill="red" stroke="red" points="2505.5,-348.49 2502,-338.49 2498.5,-348.49 2505.5,-348.49"/>
</g>
<!-- experts_2 -->
<g id="node74" class="node">
<title>experts_2</title>
<polygon fill="lightgreen" stroke="black" points="2608,-240 2396,-240 2396,-196 2608,-196 2608,-240"/>
<text text-anchor="middle" x="2502" y="-229.6" font-family="Arial" font-size="8.00">Experts 0&#45;15 Layer 2</text>
<text text-anchor="middle" x="2502" y="-220.6" font-family="Arial" font-size="8.00">GPUs: 32&#45;47</text>
<text text-anchor="middle" x="2502" y="-211.6" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="2502" y="-202.6" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_2 -->
<g id="node76" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="2731.24,-160 2366.57,-160 2272.76,-72 2637.43,-72 2731.24,-160"/>
<text text-anchor="middle" x="2502" y="-127.6" font-family="Arial" font-size="8.00">Aggregate Experts Layer 2</text>
<text text-anchor="middle" x="2502" y="-118.6" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="2502" y="-109.6" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, experts=16, d_k=512]</text>
<text text-anchor="middle" x="2502" y="-100.6" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_2&#45;&gt;agg_2 -->
<g id="edge105" class="edge">
<title>experts_2&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M2502,-195.79C2502,-188.29 2502,-179.49 2502,-170.53"/>
<polygon fill="black" stroke="black" points="2505.5,-170.41 2502,-160.41 2498.5,-170.41 2505.5,-170.41"/>
</g>
<!-- comm_2&#45;&gt;experts_2 -->
<g id="edge104" class="edge">
<title>comm_2&#45;&gt;experts_2</title>
<path fill="none" stroke="black" d="M2502,-275.64C2502,-267.37 2502,-258.39 2502,-250.08"/>
<polygon fill="black" stroke="black" points="2505.5,-250 2502,-240 2498.5,-250 2505.5,-250"/>
</g>
<!-- mha_3 -->
<g id="node83" class="node">
<title>mha_3</title>
<ellipse fill="none" stroke="black" cx="2502" cy="-18" rx="27" ry="18"/>
<text text-anchor="middle" x="2502" y="-16.1" font-family="Arial" font-size="8.00">mha_3</text>
</g>
<!-- agg_2&#45;&gt;mha_3 -->
<g id="edge106" class="edge">
<title>agg_2&#45;&gt;mha_3</title>
<path fill="none" stroke="blue" stroke-width="2" d="M2502,-71.77C2502,-63.15 2502,-54.32 2502,-46.41"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="2505.5,-46.3 2502,-36.3 2498.5,-46.3 2505.5,-46.3"/>
</g>
<!-- mha_15 -->
<g id="node77" class="node">
<title>mha_15</title>
<polygon fill="lightgreen" stroke="black" points="5356.5,-1249.45 5135.5,-1249.45 5135.5,-1205.45 5356.5,-1205.45 5356.5,-1249.45"/>
<text text-anchor="middle" x="5246" y="-1239.05" font-family="Arial" font-size="8.00">MHA Layer 15</text>
<text text-anchor="middle" x="5246" y="-1230.05" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="5246" y="-1221.05" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5246" y="-1212.05" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- gate_15 -->
<g id="node78" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="5478.47,-1147.45 5108.66,-1147.45 5013.53,-1059.45 5383.34,-1059.45 5478.47,-1147.45"/>
<text text-anchor="middle" x="5246" y="-1115.05" font-family="Arial" font-size="8.00">Gate Layer 15</text>
<text text-anchor="middle" x="5246" y="-1106.05" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="5246" y="-1097.05" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5246" y="-1088.05" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, top_k=2, experts=16]</text>
</g>
<!-- mha_15&#45;&gt;gate_15 -->
<g id="edge112" class="edge">
<title>mha_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M5246,-1205.2C5246,-1192.08 5246,-1174.62 5246,-1157.93"/>
<polygon fill="black" stroke="black" points="5249.5,-1157.68 5246,-1147.68 5242.5,-1157.68 5249.5,-1157.68"/>
</g>
<!-- comm_15 -->
<g id="node80" class="node">
<title>comm_15</title>
<ellipse fill="lightblue" stroke="black" cx="5246" cy="-979.45" rx="147.16" ry="31.23"/>
<text text-anchor="middle" x="5246" y="-991.05" font-family="Arial" font-size="8.00">Expert Routing Layer 15</text>
<text text-anchor="middle" x="5246" y="-982.05" font-family="Arial" font-size="8.00">GPUs: 240&#45;255</text>
<text text-anchor="middle" x="5246" y="-973.05" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, top_k=2]</text>
<text text-anchor="middle" x="5246" y="-964.05" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, tokens_selected=?]</text>
</g>
<!-- gate_15&#45;&gt;comm_15 -->
<g id="edge113" class="edge">
<title>gate_15&#45;&gt;comm_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5246,-1059.44C5246,-1046.9 5246,-1033.24 5246,-1020.87"/>
<polygon fill="red" stroke="red" points="5249.5,-1020.82 5246,-1010.82 5242.5,-1020.82 5249.5,-1020.82"/>
</g>
<!-- experts_15 -->
<g id="node79" class="node">
<title>experts_15</title>
<polygon fill="lightgreen" stroke="black" points="5352,-890.34 5140,-890.34 5140,-846.34 5352,-846.34 5352,-890.34"/>
<text text-anchor="middle" x="5246" y="-879.94" font-family="Arial" font-size="8.00">Experts 0&#45;15 Layer 15</text>
<text text-anchor="middle" x="5246" y="-870.94" font-family="Arial" font-size="8.00">GPUs: 240&#45;255</text>
<text text-anchor="middle" x="5246" y="-861.94" font-family="Arial" font-size="8.00">Input: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5246" y="-852.94" font-family="Arial" font-size="8.00">Output: [batch_size=?, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- agg_15 -->
<g id="node81" class="node">
<title>agg_15</title>
<polygon fill="lightyellow" stroke="black" points="5475.24,-801.23 5110.57,-801.23 5016.76,-713.23 5381.43,-713.23 5475.24,-801.23"/>
<text text-anchor="middle" x="5246" y="-768.83" font-family="Arial" font-size="8.00">Aggregate Experts Layer 15</text>
<text text-anchor="middle" x="5246" y="-759.83" font-family="Arial" font-size="8.00">GPU: All GPUs</text>
<text text-anchor="middle" x="5246" y="-750.83" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, experts=16, d_k=512]</text>
<text text-anchor="middle" x="5246" y="-741.83" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
</g>
<!-- experts_15&#45;&gt;agg_15 -->
<g id="edge115" class="edge">
<title>experts_15&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M5246,-846.3C5246,-836.33 5246,-823.93 5246,-811.61"/>
<polygon fill="black" stroke="black" points="5249.5,-811.33 5246,-801.33 5242.5,-811.33 5249.5,-811.33"/>
</g>
<!-- comm_15&#45;&gt;experts_15 -->
<g id="edge114" class="edge">
<title>comm_15&#45;&gt;experts_15</title>
<path fill="none" stroke="black" d="M5246,-948.06C5246,-933.34 5246,-915.69 5246,-900.83"/>
<polygon fill="black" stroke="black" points="5249.5,-900.59 5246,-890.59 5242.5,-900.59 5249.5,-900.59"/>
</g>
<!-- output -->
<g id="node82" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="5353.5,-651.23 5138.5,-651.23 5138.5,-615.23 5353.5,-615.23 5353.5,-651.23"/>
<text text-anchor="middle" x="5246" y="-640.33" font-family="Arial" font-size="8.00">Output</text>
<text text-anchor="middle" x="5246" y="-631.33" font-family="Arial" font-size="8.00">Input: [batch_size=128, seq_len=?, heads=16, d_k=512]</text>
<text text-anchor="middle" x="5246" y="-622.33" font-family="Arial" font-size="8.00">Output: [batch_size=128, seq_len=?, vocab_size=?]</text>
</g>
<!-- agg_15&#45;&gt;output -->
<g id="edge116" class="edge">
<title>agg_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5246,-713.21C5246,-696.1 5246,-676.91 5246,-661.73"/>
<polygon fill="black" stroke="black" points="5249.5,-661.48 5246,-651.48 5242.5,-661.48 5249.5,-661.48"/>
</g>
<!-- mha_14 -->
<g id="node84" class="node">
<title>mha_14</title>
<ellipse fill="none" stroke="black" cx="5246" cy="-1718.68" rx="27" ry="18"/>
<text text-anchor="middle" x="5246" y="-1716.78" font-family="Arial" font-size="8.00">mha_14</text>
</g>
<!-- gate_14 -->
<g id="node85" class="node">
<title>gate_14</title>
<ellipse fill="none" stroke="black" cx="5246" cy="-1631.68" rx="27" ry="18"/>
<text text-anchor="middle" x="5246" y="-1629.78" font-family="Arial" font-size="8.00">gate_14</text>
</g>
<!-- mha_14&#45;&gt;gate_14 -->
<!-- comm_14 -->
<g id="node86" class="node">
<title>comm_14</title>
<ellipse fill="none" stroke="black" cx="5246" cy="-1529.68" rx="29.49" ry="18"/>
<text text-anchor="middle" x="5246" y="-1527.78" font-family="Arial" font-size="8.00">comm_14</text>
</g>
<!-- gate_14&#45;&gt;comm_14 -->
<!-- experts_14 -->
<g id="node87" class="node">
<title>experts_14</title>
<ellipse fill="none" stroke="black" cx="5246" cy="-1418.56" rx="31.53" ry="18"/>
<text text-anchor="middle" x="5246" y="-1416.66" font-family="Arial" font-size="8.00">experts_14</text>
</g>
<!-- comm_14&#45;&gt;experts_14 -->
<!-- agg_14 -->
<g id="node88" class="node">
<title>agg_14</title>
<ellipse fill="none" stroke="black" cx="5246" cy="-1329.45" rx="27" ry="18"/>
<text text-anchor="middle" x="5246" y="-1327.55" font-family="Arial" font-size="8.00">agg_14</text>
</g>
<!-- experts_14&#45;&gt;agg_14 -->
<!-- agg_14&#45;&gt;mha_15 -->
<g id="edge111" class="edge">
<title>agg_14&#45;&gt;mha_15</title>
<path fill="none" stroke="blue" stroke-width="2" d="M5246,-1311.03C5246,-1296.85 5246,-1276.48 5246,-1259.52"/>
<polygon fill="blue" stroke="blue" stroke-width="2" points="5249.5,-1259.48 5246,-1249.48 5242.5,-1259.48 5249.5,-1259.48"/>
</g>
</g>
</svg>
