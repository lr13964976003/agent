<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="46pt" height="2880pt"
 viewBox="0.00 0.00 46.20 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 55972.83)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-55972.83 894,-55972.83 894,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="black" d="M20,-41734.67C20,-41734.67 870,-41734.67 870,-41734.67 876,-41734.67 882,-41740.67 882,-41746.67 882,-41746.67 882,-55852.67 882,-55852.67 882,-55858.67 876,-55864.67 870,-55864.67 870,-55864.67 20,-55864.67 20,-55864.67 14,-55864.67 8,-55858.67 8,-55852.67 8,-55852.67 8,-41746.67 8,-41746.67 8,-41740.67 14,-41734.67 20,-41734.67"/>
<text text-anchor="middle" x="445" y="-55849.47" font-family="Times,serif" font-size="14.00">Stage 0: Layers 0&#45;23</text>
<text text-anchor="middle" x="445" y="-55834.47" font-family="Times,serif" font-size="14.00">GPUs 0&#45;8</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M20,-27472.5C20,-27472.5 870,-27472.5 870,-27472.5 876,-27472.5 882,-27478.5 882,-27484.5 882,-27484.5 882,-41590.5 882,-41590.5 882,-41596.5 876,-41602.5 870,-41602.5 870,-41602.5 20,-41602.5 20,-41602.5 14,-41602.5 8,-41596.5 8,-41590.5 8,-41590.5 8,-27484.5 8,-27484.5 8,-27478.5 14,-27472.5 20,-27472.5"/>
<text text-anchor="middle" x="445" y="-41587.3" font-family="Times,serif" font-size="14.00">Stage 1: Layers 24&#45;47</text>
<text text-anchor="middle" x="445" y="-41572.3" font-family="Times,serif" font-size="14.00">GPUs 9&#45;17</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="none" stroke="black" d="M20,-13210.33C20,-13210.33 870,-13210.33 870,-13210.33 876,-13210.33 882,-13216.33 882,-13222.33 882,-13222.33 882,-27328.33 882,-27328.33 882,-27334.33 876,-27340.33 870,-27340.33 870,-27340.33 20,-27340.33 20,-27340.33 14,-27340.33 8,-27334.33 8,-27328.33 8,-27328.33 8,-13222.33 8,-13222.33 8,-13216.33 14,-13210.33 20,-13210.33"/>
<text text-anchor="middle" x="445" y="-27325.13" font-family="Times,serif" font-size="14.00">Stage 2: Layers 48&#45;71</text>
<text text-anchor="middle" x="445" y="-27310.13" font-family="Times,serif" font-size="14.00">GPUs 18&#45;26</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="none" stroke="black" d="M20,-124.17C20,-124.17 870,-124.17 870,-124.17 876,-124.17 882,-130.17 882,-136.17 882,-136.17 882,-13066.17 882,-13066.17 882,-13072.17 876,-13078.17 870,-13078.17 870,-13078.17 20,-13078.17 20,-13078.17 14,-13078.17 8,-13072.17 8,-13066.17 8,-13066.17 8,-136.17 8,-136.17 8,-130.17 14,-124.17 20,-124.17"/>
<text text-anchor="middle" x="445" y="-13062.97" font-family="Times,serif" font-size="14.00">Stage 3: Layers 72&#45;93</text>
<text text-anchor="middle" x="445" y="-13047.97" font-family="Times,serif" font-size="14.00">GPUs 27&#45;34</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgray" stroke="black" cx="445" cy="-55920.75" rx="301.46" ry="48.17"/>
<text text-anchor="middle" x="445" y="-55939.55" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="445" y="-55924.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;34</text>
<text text-anchor="middle" x="445" y="-55909.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-55894.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer0_qkv_proj -->
<g id="node2" class="node">
<title>layer0_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-55818.67 218,-55818.67 218,-55750.67 672,-55750.67 672,-55818.67"/>
<text text-anchor="middle" x="445" y="-55803.47" font-family="Times,serif" font-size="14.00">Layer 0 QKV Projection</text>
<text text-anchor="middle" x="445" y="-55788.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55773.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-55758.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- input&#45;&gt;layer0_qkv_proj -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-55872.48C445,-55858.42 445,-55843.08 445,-55829.27"/>
<polygon fill="black" stroke="black" points="448.5,-55829.05 445,-55819.05 441.5,-55829.05 448.5,-55829.05"/>
</g>
<!-- layer0_attn_comp -->
<g id="node3" class="node">
<title>layer0_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-55714.67 218,-55714.67 218,-55646.67 672,-55646.67 672,-55714.67"/>
<text text-anchor="middle" x="445" y="-55699.47" font-family="Times,serif" font-size="14.00">Layer 0 Attention Computation</text>
<text text-anchor="middle" x="445" y="-55684.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55669.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-55654.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer0_qkv_proj&#45;&gt;layer0_attn_comp -->
<g id="edge2" class="edge">
<title>layer0_qkv_proj&#45;&gt;layer0_attn_comp</title>
<path fill="none" stroke="black" d="M445,-55750.55C445,-55742.44 445,-55733.65 445,-55725.14"/>
<polygon fill="black" stroke="black" points="448.5,-55724.97 445,-55714.97 441.5,-55724.97 448.5,-55724.97"/>
</g>
<!-- layer0_out_proj -->
<g id="node4" class="node">
<title>layer0_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-55610.67 224,-55610.67 224,-55542.67 666,-55542.67 666,-55610.67"/>
<text text-anchor="middle" x="445" y="-55595.47" font-family="Times,serif" font-size="14.00">Layer 0 Output Projection</text>
<text text-anchor="middle" x="445" y="-55580.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55565.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-55550.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer0_attn_comp&#45;&gt;layer0_out_proj -->
<g id="edge3" class="edge">
<title>layer0_attn_comp&#45;&gt;layer0_out_proj</title>
<path fill="none" stroke="black" d="M445,-55646.55C445,-55638.44 445,-55629.65 445,-55621.14"/>
<polygon fill="black" stroke="black" points="448.5,-55620.97 445,-55610.97 441.5,-55620.97 448.5,-55620.97"/>
</g>
<!-- layer0_gate -->
<g id="node5" class="node">
<title>layer0_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-55506.67 191.3,-55506.67 15.57,-55370.67 698.7,-55370.67 874.43,-55506.67"/>
<text text-anchor="middle" x="445" y="-55457.47" font-family="Times,serif" font-size="14.00">Layer 0 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-55442.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55427.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-55412.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer0_out_proj&#45;&gt;layer0_gate -->
<g id="edge4" class="edge">
<title>layer0_out_proj&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M445,-55542.4C445,-55534.57 445,-55525.9 445,-55517.02"/>
<polygon fill="black" stroke="black" points="448.5,-55516.93 445,-55506.93 441.5,-55516.93 448.5,-55516.93"/>
</g>
<!-- layer0_moe -->
<g id="node6" class="node">
<title>layer0_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-55334.67 232,-55334.67 232,-55266.67 658,-55266.67 658,-55334.67"/>
<text text-anchor="middle" x="445" y="-55319.47" font-family="Times,serif" font-size="14.00">Layer 0 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-55304.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55289.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-55274.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_moe -->
<g id="edge5" class="edge">
<title>layer0_gate&#45;&gt;layer0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-55370.46C445,-55361.71 445,-55352.94 445,-55344.73"/>
<polygon fill="black" stroke="black" points="448.5,-55344.68 445,-55334.68 441.5,-55344.68 448.5,-55344.68"/>
</g>
<!-- layer1_qkv_proj -->
<g id="node7" class="node">
<title>layer1_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-55230.67 218,-55230.67 218,-55162.67 672,-55162.67 672,-55230.67"/>
<text text-anchor="middle" x="445" y="-55215.47" font-family="Times,serif" font-size="14.00">Layer 1 QKV Projection</text>
<text text-anchor="middle" x="445" y="-55200.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55185.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-55170.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer0_moe&#45;&gt;layer1_qkv_proj -->
<g id="edge6" class="edge">
<title>layer0_moe&#45;&gt;layer1_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-55266.55C445,-55258.44 445,-55249.65 445,-55241.14"/>
<polygon fill="black" stroke="black" points="448.5,-55240.97 445,-55230.97 441.5,-55240.97 448.5,-55240.97"/>
</g>
<!-- layer1_attn_comp -->
<g id="node8" class="node">
<title>layer1_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-55126.67 218,-55126.67 218,-55058.67 672,-55058.67 672,-55126.67"/>
<text text-anchor="middle" x="445" y="-55111.47" font-family="Times,serif" font-size="14.00">Layer 1 Attention Computation</text>
<text text-anchor="middle" x="445" y="-55096.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-55081.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-55066.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer1_qkv_proj&#45;&gt;layer1_attn_comp -->
<g id="edge7" class="edge">
<title>layer1_qkv_proj&#45;&gt;layer1_attn_comp</title>
<path fill="none" stroke="black" d="M445,-55162.55C445,-55154.44 445,-55145.65 445,-55137.14"/>
<polygon fill="black" stroke="black" points="448.5,-55136.97 445,-55126.97 441.5,-55136.97 448.5,-55136.97"/>
</g>
<!-- layer1_out_proj -->
<g id="node9" class="node">
<title>layer1_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-55022.67 224,-55022.67 224,-54954.67 666,-54954.67 666,-55022.67"/>
<text text-anchor="middle" x="445" y="-55007.47" font-family="Times,serif" font-size="14.00">Layer 1 Output Projection</text>
<text text-anchor="middle" x="445" y="-54992.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54977.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-54962.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer1_attn_comp&#45;&gt;layer1_out_proj -->
<g id="edge8" class="edge">
<title>layer1_attn_comp&#45;&gt;layer1_out_proj</title>
<path fill="none" stroke="black" d="M445,-55058.55C445,-55050.44 445,-55041.65 445,-55033.14"/>
<polygon fill="black" stroke="black" points="448.5,-55032.97 445,-55022.97 441.5,-55032.97 448.5,-55032.97"/>
</g>
<!-- layer1_gate -->
<g id="node10" class="node">
<title>layer1_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-54918.67 191.3,-54918.67 15.57,-54782.67 698.7,-54782.67 874.43,-54918.67"/>
<text text-anchor="middle" x="445" y="-54869.47" font-family="Times,serif" font-size="14.00">Layer 1 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-54854.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54839.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-54824.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer1_out_proj&#45;&gt;layer1_gate -->
<g id="edge9" class="edge">
<title>layer1_out_proj&#45;&gt;layer1_gate</title>
<path fill="none" stroke="black" d="M445,-54954.4C445,-54946.57 445,-54937.9 445,-54929.02"/>
<polygon fill="black" stroke="black" points="448.5,-54928.93 445,-54918.93 441.5,-54928.93 448.5,-54928.93"/>
</g>
<!-- layer1_moe -->
<g id="node11" class="node">
<title>layer1_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-54746.67 232,-54746.67 232,-54678.67 658,-54678.67 658,-54746.67"/>
<text text-anchor="middle" x="445" y="-54731.47" font-family="Times,serif" font-size="14.00">Layer 1 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-54716.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54701.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-54686.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_moe -->
<g id="edge10" class="edge">
<title>layer1_gate&#45;&gt;layer1_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-54782.46C445,-54773.71 445,-54764.94 445,-54756.73"/>
<polygon fill="black" stroke="black" points="448.5,-54756.68 445,-54746.68 441.5,-54756.68 448.5,-54756.68"/>
</g>
<!-- layer2_qkv_proj -->
<g id="node12" class="node">
<title>layer2_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-54642.67 218,-54642.67 218,-54574.67 672,-54574.67 672,-54642.67"/>
<text text-anchor="middle" x="445" y="-54627.47" font-family="Times,serif" font-size="14.00">Layer 2 QKV Projection</text>
<text text-anchor="middle" x="445" y="-54612.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54597.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-54582.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer1_moe&#45;&gt;layer2_qkv_proj -->
<g id="edge11" class="edge">
<title>layer1_moe&#45;&gt;layer2_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-54678.55C445,-54670.44 445,-54661.65 445,-54653.14"/>
<polygon fill="black" stroke="black" points="448.5,-54652.97 445,-54642.97 441.5,-54652.97 448.5,-54652.97"/>
</g>
<!-- layer2_attn_comp -->
<g id="node13" class="node">
<title>layer2_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-54538.67 218,-54538.67 218,-54470.67 672,-54470.67 672,-54538.67"/>
<text text-anchor="middle" x="445" y="-54523.47" font-family="Times,serif" font-size="14.00">Layer 2 Attention Computation</text>
<text text-anchor="middle" x="445" y="-54508.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54493.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-54478.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer2_qkv_proj&#45;&gt;layer2_attn_comp -->
<g id="edge12" class="edge">
<title>layer2_qkv_proj&#45;&gt;layer2_attn_comp</title>
<path fill="none" stroke="black" d="M445,-54574.55C445,-54566.44 445,-54557.65 445,-54549.14"/>
<polygon fill="black" stroke="black" points="448.5,-54548.97 445,-54538.97 441.5,-54548.97 448.5,-54548.97"/>
</g>
<!-- layer2_out_proj -->
<g id="node14" class="node">
<title>layer2_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-54434.67 224,-54434.67 224,-54366.67 666,-54366.67 666,-54434.67"/>
<text text-anchor="middle" x="445" y="-54419.47" font-family="Times,serif" font-size="14.00">Layer 2 Output Projection</text>
<text text-anchor="middle" x="445" y="-54404.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54389.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-54374.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer2_attn_comp&#45;&gt;layer2_out_proj -->
<g id="edge13" class="edge">
<title>layer2_attn_comp&#45;&gt;layer2_out_proj</title>
<path fill="none" stroke="black" d="M445,-54470.55C445,-54462.44 445,-54453.65 445,-54445.14"/>
<polygon fill="black" stroke="black" points="448.5,-54444.97 445,-54434.97 441.5,-54444.97 448.5,-54444.97"/>
</g>
<!-- layer2_gate -->
<g id="node15" class="node">
<title>layer2_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-54330.67 191.3,-54330.67 15.57,-54194.67 698.7,-54194.67 874.43,-54330.67"/>
<text text-anchor="middle" x="445" y="-54281.47" font-family="Times,serif" font-size="14.00">Layer 2 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-54266.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54251.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-54236.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer2_out_proj&#45;&gt;layer2_gate -->
<g id="edge14" class="edge">
<title>layer2_out_proj&#45;&gt;layer2_gate</title>
<path fill="none" stroke="black" d="M445,-54366.4C445,-54358.57 445,-54349.9 445,-54341.02"/>
<polygon fill="black" stroke="black" points="448.5,-54340.93 445,-54330.93 441.5,-54340.93 448.5,-54340.93"/>
</g>
<!-- layer2_moe -->
<g id="node16" class="node">
<title>layer2_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-54158.67 232,-54158.67 232,-54090.67 658,-54090.67 658,-54158.67"/>
<text text-anchor="middle" x="445" y="-54143.47" font-family="Times,serif" font-size="14.00">Layer 2 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-54128.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54113.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-54098.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_moe -->
<g id="edge15" class="edge">
<title>layer2_gate&#45;&gt;layer2_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-54194.46C445,-54185.71 445,-54176.94 445,-54168.73"/>
<polygon fill="black" stroke="black" points="448.5,-54168.68 445,-54158.68 441.5,-54168.68 448.5,-54168.68"/>
</g>
<!-- layer3_qkv_proj -->
<g id="node17" class="node">
<title>layer3_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-54054.67 218,-54054.67 218,-53986.67 672,-53986.67 672,-54054.67"/>
<text text-anchor="middle" x="445" y="-54039.47" font-family="Times,serif" font-size="14.00">Layer 3 QKV Projection</text>
<text text-anchor="middle" x="445" y="-54024.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-54009.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-53994.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer2_moe&#45;&gt;layer3_qkv_proj -->
<g id="edge16" class="edge">
<title>layer2_moe&#45;&gt;layer3_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-54090.55C445,-54082.44 445,-54073.65 445,-54065.14"/>
<polygon fill="black" stroke="black" points="448.5,-54064.97 445,-54054.97 441.5,-54064.97 448.5,-54064.97"/>
</g>
<!-- layer3_attn_comp -->
<g id="node18" class="node">
<title>layer3_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-53950.67 218,-53950.67 218,-53882.67 672,-53882.67 672,-53950.67"/>
<text text-anchor="middle" x="445" y="-53935.47" font-family="Times,serif" font-size="14.00">Layer 3 Attention Computation</text>
<text text-anchor="middle" x="445" y="-53920.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53905.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-53890.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer3_qkv_proj&#45;&gt;layer3_attn_comp -->
<g id="edge17" class="edge">
<title>layer3_qkv_proj&#45;&gt;layer3_attn_comp</title>
<path fill="none" stroke="black" d="M445,-53986.55C445,-53978.44 445,-53969.65 445,-53961.14"/>
<polygon fill="black" stroke="black" points="448.5,-53960.97 445,-53950.97 441.5,-53960.97 448.5,-53960.97"/>
</g>
<!-- layer3_out_proj -->
<g id="node19" class="node">
<title>layer3_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-53846.67 224,-53846.67 224,-53778.67 666,-53778.67 666,-53846.67"/>
<text text-anchor="middle" x="445" y="-53831.47" font-family="Times,serif" font-size="14.00">Layer 3 Output Projection</text>
<text text-anchor="middle" x="445" y="-53816.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53801.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-53786.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer3_attn_comp&#45;&gt;layer3_out_proj -->
<g id="edge18" class="edge">
<title>layer3_attn_comp&#45;&gt;layer3_out_proj</title>
<path fill="none" stroke="black" d="M445,-53882.55C445,-53874.44 445,-53865.65 445,-53857.14"/>
<polygon fill="black" stroke="black" points="448.5,-53856.97 445,-53846.97 441.5,-53856.97 448.5,-53856.97"/>
</g>
<!-- layer3_gate -->
<g id="node20" class="node">
<title>layer3_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-53742.67 191.3,-53742.67 15.57,-53606.67 698.7,-53606.67 874.43,-53742.67"/>
<text text-anchor="middle" x="445" y="-53693.47" font-family="Times,serif" font-size="14.00">Layer 3 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-53678.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53663.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-53648.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer3_out_proj&#45;&gt;layer3_gate -->
<g id="edge19" class="edge">
<title>layer3_out_proj&#45;&gt;layer3_gate</title>
<path fill="none" stroke="black" d="M445,-53778.4C445,-53770.57 445,-53761.9 445,-53753.02"/>
<polygon fill="black" stroke="black" points="448.5,-53752.93 445,-53742.93 441.5,-53752.93 448.5,-53752.93"/>
</g>
<!-- layer3_moe -->
<g id="node21" class="node">
<title>layer3_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-53570.67 232,-53570.67 232,-53502.67 658,-53502.67 658,-53570.67"/>
<text text-anchor="middle" x="445" y="-53555.47" font-family="Times,serif" font-size="14.00">Layer 3 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-53540.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53525.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-53510.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_moe -->
<g id="edge20" class="edge">
<title>layer3_gate&#45;&gt;layer3_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-53606.46C445,-53597.71 445,-53588.94 445,-53580.73"/>
<polygon fill="black" stroke="black" points="448.5,-53580.68 445,-53570.68 441.5,-53580.68 448.5,-53580.68"/>
</g>
<!-- layer4_qkv_proj -->
<g id="node22" class="node">
<title>layer4_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-53466.67 218,-53466.67 218,-53398.67 672,-53398.67 672,-53466.67"/>
<text text-anchor="middle" x="445" y="-53451.47" font-family="Times,serif" font-size="14.00">Layer 4 QKV Projection</text>
<text text-anchor="middle" x="445" y="-53436.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53421.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-53406.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer3_moe&#45;&gt;layer4_qkv_proj -->
<g id="edge21" class="edge">
<title>layer3_moe&#45;&gt;layer4_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-53502.55C445,-53494.44 445,-53485.65 445,-53477.14"/>
<polygon fill="black" stroke="black" points="448.5,-53476.97 445,-53466.97 441.5,-53476.97 448.5,-53476.97"/>
</g>
<!-- layer4_attn_comp -->
<g id="node23" class="node">
<title>layer4_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-53362.67 218,-53362.67 218,-53294.67 672,-53294.67 672,-53362.67"/>
<text text-anchor="middle" x="445" y="-53347.47" font-family="Times,serif" font-size="14.00">Layer 4 Attention Computation</text>
<text text-anchor="middle" x="445" y="-53332.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53317.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-53302.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer4_qkv_proj&#45;&gt;layer4_attn_comp -->
<g id="edge22" class="edge">
<title>layer4_qkv_proj&#45;&gt;layer4_attn_comp</title>
<path fill="none" stroke="black" d="M445,-53398.55C445,-53390.44 445,-53381.65 445,-53373.14"/>
<polygon fill="black" stroke="black" points="448.5,-53372.97 445,-53362.97 441.5,-53372.97 448.5,-53372.97"/>
</g>
<!-- layer4_out_proj -->
<g id="node24" class="node">
<title>layer4_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-53258.67 224,-53258.67 224,-53190.67 666,-53190.67 666,-53258.67"/>
<text text-anchor="middle" x="445" y="-53243.47" font-family="Times,serif" font-size="14.00">Layer 4 Output Projection</text>
<text text-anchor="middle" x="445" y="-53228.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53213.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-53198.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer4_attn_comp&#45;&gt;layer4_out_proj -->
<g id="edge23" class="edge">
<title>layer4_attn_comp&#45;&gt;layer4_out_proj</title>
<path fill="none" stroke="black" d="M445,-53294.55C445,-53286.44 445,-53277.65 445,-53269.14"/>
<polygon fill="black" stroke="black" points="448.5,-53268.97 445,-53258.97 441.5,-53268.97 448.5,-53268.97"/>
</g>
<!-- layer4_gate -->
<g id="node25" class="node">
<title>layer4_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-53154.67 191.3,-53154.67 15.57,-53018.67 698.7,-53018.67 874.43,-53154.67"/>
<text text-anchor="middle" x="445" y="-53105.47" font-family="Times,serif" font-size="14.00">Layer 4 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-53090.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-53075.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-53060.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer4_out_proj&#45;&gt;layer4_gate -->
<g id="edge24" class="edge">
<title>layer4_out_proj&#45;&gt;layer4_gate</title>
<path fill="none" stroke="black" d="M445,-53190.4C445,-53182.57 445,-53173.9 445,-53165.02"/>
<polygon fill="black" stroke="black" points="448.5,-53164.93 445,-53154.93 441.5,-53164.93 448.5,-53164.93"/>
</g>
<!-- layer4_moe -->
<g id="node26" class="node">
<title>layer4_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-52982.67 232,-52982.67 232,-52914.67 658,-52914.67 658,-52982.67"/>
<text text-anchor="middle" x="445" y="-52967.47" font-family="Times,serif" font-size="14.00">Layer 4 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-52952.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52937.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-52922.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_moe -->
<g id="edge25" class="edge">
<title>layer4_gate&#45;&gt;layer4_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-53018.46C445,-53009.71 445,-53000.94 445,-52992.73"/>
<polygon fill="black" stroke="black" points="448.5,-52992.68 445,-52982.68 441.5,-52992.68 448.5,-52992.68"/>
</g>
<!-- layer5_qkv_proj -->
<g id="node27" class="node">
<title>layer5_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-52878.67 218,-52878.67 218,-52810.67 672,-52810.67 672,-52878.67"/>
<text text-anchor="middle" x="445" y="-52863.47" font-family="Times,serif" font-size="14.00">Layer 5 QKV Projection</text>
<text text-anchor="middle" x="445" y="-52848.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52833.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-52818.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer4_moe&#45;&gt;layer5_qkv_proj -->
<g id="edge26" class="edge">
<title>layer4_moe&#45;&gt;layer5_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-52914.55C445,-52906.44 445,-52897.65 445,-52889.14"/>
<polygon fill="black" stroke="black" points="448.5,-52888.97 445,-52878.97 441.5,-52888.97 448.5,-52888.97"/>
</g>
<!-- layer5_attn_comp -->
<g id="node28" class="node">
<title>layer5_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-52774.67 218,-52774.67 218,-52706.67 672,-52706.67 672,-52774.67"/>
<text text-anchor="middle" x="445" y="-52759.47" font-family="Times,serif" font-size="14.00">Layer 5 Attention Computation</text>
<text text-anchor="middle" x="445" y="-52744.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52729.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-52714.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer5_qkv_proj&#45;&gt;layer5_attn_comp -->
<g id="edge27" class="edge">
<title>layer5_qkv_proj&#45;&gt;layer5_attn_comp</title>
<path fill="none" stroke="black" d="M445,-52810.55C445,-52802.44 445,-52793.65 445,-52785.14"/>
<polygon fill="black" stroke="black" points="448.5,-52784.97 445,-52774.97 441.5,-52784.97 448.5,-52784.97"/>
</g>
<!-- layer5_out_proj -->
<g id="node29" class="node">
<title>layer5_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-52670.67 224,-52670.67 224,-52602.67 666,-52602.67 666,-52670.67"/>
<text text-anchor="middle" x="445" y="-52655.47" font-family="Times,serif" font-size="14.00">Layer 5 Output Projection</text>
<text text-anchor="middle" x="445" y="-52640.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52625.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-52610.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer5_attn_comp&#45;&gt;layer5_out_proj -->
<g id="edge28" class="edge">
<title>layer5_attn_comp&#45;&gt;layer5_out_proj</title>
<path fill="none" stroke="black" d="M445,-52706.55C445,-52698.44 445,-52689.65 445,-52681.14"/>
<polygon fill="black" stroke="black" points="448.5,-52680.97 445,-52670.97 441.5,-52680.97 448.5,-52680.97"/>
</g>
<!-- layer5_gate -->
<g id="node30" class="node">
<title>layer5_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-52566.67 191.3,-52566.67 15.57,-52430.67 698.7,-52430.67 874.43,-52566.67"/>
<text text-anchor="middle" x="445" y="-52517.47" font-family="Times,serif" font-size="14.00">Layer 5 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-52502.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52487.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-52472.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer5_out_proj&#45;&gt;layer5_gate -->
<g id="edge29" class="edge">
<title>layer5_out_proj&#45;&gt;layer5_gate</title>
<path fill="none" stroke="black" d="M445,-52602.4C445,-52594.57 445,-52585.9 445,-52577.02"/>
<polygon fill="black" stroke="black" points="448.5,-52576.93 445,-52566.93 441.5,-52576.93 448.5,-52576.93"/>
</g>
<!-- layer5_moe -->
<g id="node31" class="node">
<title>layer5_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-52394.67 232,-52394.67 232,-52326.67 658,-52326.67 658,-52394.67"/>
<text text-anchor="middle" x="445" y="-52379.47" font-family="Times,serif" font-size="14.00">Layer 5 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-52364.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52349.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-52334.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_moe -->
<g id="edge30" class="edge">
<title>layer5_gate&#45;&gt;layer5_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-52430.46C445,-52421.71 445,-52412.94 445,-52404.73"/>
<polygon fill="black" stroke="black" points="448.5,-52404.68 445,-52394.68 441.5,-52404.68 448.5,-52404.68"/>
</g>
<!-- layer6_qkv_proj -->
<g id="node32" class="node">
<title>layer6_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-52290.67 218,-52290.67 218,-52222.67 672,-52222.67 672,-52290.67"/>
<text text-anchor="middle" x="445" y="-52275.47" font-family="Times,serif" font-size="14.00">Layer 6 QKV Projection</text>
<text text-anchor="middle" x="445" y="-52260.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52245.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-52230.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer5_moe&#45;&gt;layer6_qkv_proj -->
<g id="edge31" class="edge">
<title>layer5_moe&#45;&gt;layer6_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-52326.55C445,-52318.44 445,-52309.65 445,-52301.14"/>
<polygon fill="black" stroke="black" points="448.5,-52300.97 445,-52290.97 441.5,-52300.97 448.5,-52300.97"/>
</g>
<!-- layer6_attn_comp -->
<g id="node33" class="node">
<title>layer6_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-52186.67 218,-52186.67 218,-52118.67 672,-52118.67 672,-52186.67"/>
<text text-anchor="middle" x="445" y="-52171.47" font-family="Times,serif" font-size="14.00">Layer 6 Attention Computation</text>
<text text-anchor="middle" x="445" y="-52156.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52141.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-52126.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer6_qkv_proj&#45;&gt;layer6_attn_comp -->
<g id="edge32" class="edge">
<title>layer6_qkv_proj&#45;&gt;layer6_attn_comp</title>
<path fill="none" stroke="black" d="M445,-52222.55C445,-52214.44 445,-52205.65 445,-52197.14"/>
<polygon fill="black" stroke="black" points="448.5,-52196.97 445,-52186.97 441.5,-52196.97 448.5,-52196.97"/>
</g>
<!-- layer6_out_proj -->
<g id="node34" class="node">
<title>layer6_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-52082.67 224,-52082.67 224,-52014.67 666,-52014.67 666,-52082.67"/>
<text text-anchor="middle" x="445" y="-52067.47" font-family="Times,serif" font-size="14.00">Layer 6 Output Projection</text>
<text text-anchor="middle" x="445" y="-52052.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-52037.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-52022.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer6_attn_comp&#45;&gt;layer6_out_proj -->
<g id="edge33" class="edge">
<title>layer6_attn_comp&#45;&gt;layer6_out_proj</title>
<path fill="none" stroke="black" d="M445,-52118.55C445,-52110.44 445,-52101.65 445,-52093.14"/>
<polygon fill="black" stroke="black" points="448.5,-52092.97 445,-52082.97 441.5,-52092.97 448.5,-52092.97"/>
</g>
<!-- layer6_gate -->
<g id="node35" class="node">
<title>layer6_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-51978.67 191.3,-51978.67 15.57,-51842.67 698.7,-51842.67 874.43,-51978.67"/>
<text text-anchor="middle" x="445" y="-51929.47" font-family="Times,serif" font-size="14.00">Layer 6 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-51914.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51899.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-51884.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer6_out_proj&#45;&gt;layer6_gate -->
<g id="edge34" class="edge">
<title>layer6_out_proj&#45;&gt;layer6_gate</title>
<path fill="none" stroke="black" d="M445,-52014.4C445,-52006.57 445,-51997.9 445,-51989.02"/>
<polygon fill="black" stroke="black" points="448.5,-51988.93 445,-51978.93 441.5,-51988.93 448.5,-51988.93"/>
</g>
<!-- layer6_moe -->
<g id="node36" class="node">
<title>layer6_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-51806.67 232,-51806.67 232,-51738.67 658,-51738.67 658,-51806.67"/>
<text text-anchor="middle" x="445" y="-51791.47" font-family="Times,serif" font-size="14.00">Layer 6 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-51776.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51761.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-51746.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_moe -->
<g id="edge35" class="edge">
<title>layer6_gate&#45;&gt;layer6_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-51842.46C445,-51833.71 445,-51824.94 445,-51816.73"/>
<polygon fill="black" stroke="black" points="448.5,-51816.68 445,-51806.68 441.5,-51816.68 448.5,-51816.68"/>
</g>
<!-- layer7_qkv_proj -->
<g id="node37" class="node">
<title>layer7_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-51702.67 218,-51702.67 218,-51634.67 672,-51634.67 672,-51702.67"/>
<text text-anchor="middle" x="445" y="-51687.47" font-family="Times,serif" font-size="14.00">Layer 7 QKV Projection</text>
<text text-anchor="middle" x="445" y="-51672.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51657.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-51642.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer6_moe&#45;&gt;layer7_qkv_proj -->
<g id="edge36" class="edge">
<title>layer6_moe&#45;&gt;layer7_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-51738.55C445,-51730.44 445,-51721.65 445,-51713.14"/>
<polygon fill="black" stroke="black" points="448.5,-51712.97 445,-51702.97 441.5,-51712.97 448.5,-51712.97"/>
</g>
<!-- layer7_attn_comp -->
<g id="node38" class="node">
<title>layer7_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-51598.67 218,-51598.67 218,-51530.67 672,-51530.67 672,-51598.67"/>
<text text-anchor="middle" x="445" y="-51583.47" font-family="Times,serif" font-size="14.00">Layer 7 Attention Computation</text>
<text text-anchor="middle" x="445" y="-51568.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51553.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-51538.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer7_qkv_proj&#45;&gt;layer7_attn_comp -->
<g id="edge37" class="edge">
<title>layer7_qkv_proj&#45;&gt;layer7_attn_comp</title>
<path fill="none" stroke="black" d="M445,-51634.55C445,-51626.44 445,-51617.65 445,-51609.14"/>
<polygon fill="black" stroke="black" points="448.5,-51608.97 445,-51598.97 441.5,-51608.97 448.5,-51608.97"/>
</g>
<!-- layer7_out_proj -->
<g id="node39" class="node">
<title>layer7_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-51494.67 224,-51494.67 224,-51426.67 666,-51426.67 666,-51494.67"/>
<text text-anchor="middle" x="445" y="-51479.47" font-family="Times,serif" font-size="14.00">Layer 7 Output Projection</text>
<text text-anchor="middle" x="445" y="-51464.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51449.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-51434.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer7_attn_comp&#45;&gt;layer7_out_proj -->
<g id="edge38" class="edge">
<title>layer7_attn_comp&#45;&gt;layer7_out_proj</title>
<path fill="none" stroke="black" d="M445,-51530.55C445,-51522.44 445,-51513.65 445,-51505.14"/>
<polygon fill="black" stroke="black" points="448.5,-51504.97 445,-51494.97 441.5,-51504.97 448.5,-51504.97"/>
</g>
<!-- layer7_gate -->
<g id="node40" class="node">
<title>layer7_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-51390.67 191.3,-51390.67 15.57,-51254.67 698.7,-51254.67 874.43,-51390.67"/>
<text text-anchor="middle" x="445" y="-51341.47" font-family="Times,serif" font-size="14.00">Layer 7 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-51326.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51311.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-51296.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer7_out_proj&#45;&gt;layer7_gate -->
<g id="edge39" class="edge">
<title>layer7_out_proj&#45;&gt;layer7_gate</title>
<path fill="none" stroke="black" d="M445,-51426.4C445,-51418.57 445,-51409.9 445,-51401.02"/>
<polygon fill="black" stroke="black" points="448.5,-51400.93 445,-51390.93 441.5,-51400.93 448.5,-51400.93"/>
</g>
<!-- layer7_moe -->
<g id="node41" class="node">
<title>layer7_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-51218.67 232,-51218.67 232,-51150.67 658,-51150.67 658,-51218.67"/>
<text text-anchor="middle" x="445" y="-51203.47" font-family="Times,serif" font-size="14.00">Layer 7 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-51188.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51173.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-51158.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_moe -->
<g id="edge40" class="edge">
<title>layer7_gate&#45;&gt;layer7_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-51254.46C445,-51245.71 445,-51236.94 445,-51228.73"/>
<polygon fill="black" stroke="black" points="448.5,-51228.68 445,-51218.68 441.5,-51228.68 448.5,-51228.68"/>
</g>
<!-- layer8_qkv_proj -->
<g id="node42" class="node">
<title>layer8_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-51114.67 218,-51114.67 218,-51046.67 672,-51046.67 672,-51114.67"/>
<text text-anchor="middle" x="445" y="-51099.47" font-family="Times,serif" font-size="14.00">Layer 8 QKV Projection</text>
<text text-anchor="middle" x="445" y="-51084.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-51069.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-51054.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer7_moe&#45;&gt;layer8_qkv_proj -->
<g id="edge41" class="edge">
<title>layer7_moe&#45;&gt;layer8_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-51150.55C445,-51142.44 445,-51133.65 445,-51125.14"/>
<polygon fill="black" stroke="black" points="448.5,-51124.97 445,-51114.97 441.5,-51124.97 448.5,-51124.97"/>
</g>
<!-- layer8_attn_comp -->
<g id="node43" class="node">
<title>layer8_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-51010.67 218,-51010.67 218,-50942.67 672,-50942.67 672,-51010.67"/>
<text text-anchor="middle" x="445" y="-50995.47" font-family="Times,serif" font-size="14.00">Layer 8 Attention Computation</text>
<text text-anchor="middle" x="445" y="-50980.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50965.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-50950.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer8_qkv_proj&#45;&gt;layer8_attn_comp -->
<g id="edge42" class="edge">
<title>layer8_qkv_proj&#45;&gt;layer8_attn_comp</title>
<path fill="none" stroke="black" d="M445,-51046.55C445,-51038.44 445,-51029.65 445,-51021.14"/>
<polygon fill="black" stroke="black" points="448.5,-51020.97 445,-51010.97 441.5,-51020.97 448.5,-51020.97"/>
</g>
<!-- layer8_out_proj -->
<g id="node44" class="node">
<title>layer8_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-50906.67 224,-50906.67 224,-50838.67 666,-50838.67 666,-50906.67"/>
<text text-anchor="middle" x="445" y="-50891.47" font-family="Times,serif" font-size="14.00">Layer 8 Output Projection</text>
<text text-anchor="middle" x="445" y="-50876.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50861.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-50846.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer8_attn_comp&#45;&gt;layer8_out_proj -->
<g id="edge43" class="edge">
<title>layer8_attn_comp&#45;&gt;layer8_out_proj</title>
<path fill="none" stroke="black" d="M445,-50942.55C445,-50934.44 445,-50925.65 445,-50917.14"/>
<polygon fill="black" stroke="black" points="448.5,-50916.97 445,-50906.97 441.5,-50916.97 448.5,-50916.97"/>
</g>
<!-- layer8_gate -->
<g id="node45" class="node">
<title>layer8_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-50802.67 191.3,-50802.67 15.57,-50666.67 698.7,-50666.67 874.43,-50802.67"/>
<text text-anchor="middle" x="445" y="-50753.47" font-family="Times,serif" font-size="14.00">Layer 8 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-50738.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50723.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-50708.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer8_out_proj&#45;&gt;layer8_gate -->
<g id="edge44" class="edge">
<title>layer8_out_proj&#45;&gt;layer8_gate</title>
<path fill="none" stroke="black" d="M445,-50838.4C445,-50830.57 445,-50821.9 445,-50813.02"/>
<polygon fill="black" stroke="black" points="448.5,-50812.93 445,-50802.93 441.5,-50812.93 448.5,-50812.93"/>
</g>
<!-- layer8_moe -->
<g id="node46" class="node">
<title>layer8_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-50630.67 232,-50630.67 232,-50562.67 658,-50562.67 658,-50630.67"/>
<text text-anchor="middle" x="445" y="-50615.47" font-family="Times,serif" font-size="14.00">Layer 8 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-50600.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50585.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-50570.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_moe -->
<g id="edge45" class="edge">
<title>layer8_gate&#45;&gt;layer8_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-50666.46C445,-50657.71 445,-50648.94 445,-50640.73"/>
<polygon fill="black" stroke="black" points="448.5,-50640.68 445,-50630.68 441.5,-50640.68 448.5,-50640.68"/>
</g>
<!-- layer9_qkv_proj -->
<g id="node47" class="node">
<title>layer9_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-50526.67 218,-50526.67 218,-50458.67 672,-50458.67 672,-50526.67"/>
<text text-anchor="middle" x="445" y="-50511.47" font-family="Times,serif" font-size="14.00">Layer 9 QKV Projection</text>
<text text-anchor="middle" x="445" y="-50496.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50481.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-50466.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer8_moe&#45;&gt;layer9_qkv_proj -->
<g id="edge46" class="edge">
<title>layer8_moe&#45;&gt;layer9_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-50562.55C445,-50554.44 445,-50545.65 445,-50537.14"/>
<polygon fill="black" stroke="black" points="448.5,-50536.97 445,-50526.97 441.5,-50536.97 448.5,-50536.97"/>
</g>
<!-- layer9_attn_comp -->
<g id="node48" class="node">
<title>layer9_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-50422.67 218,-50422.67 218,-50354.67 672,-50354.67 672,-50422.67"/>
<text text-anchor="middle" x="445" y="-50407.47" font-family="Times,serif" font-size="14.00">Layer 9 Attention Computation</text>
<text text-anchor="middle" x="445" y="-50392.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50377.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-50362.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer9_qkv_proj&#45;&gt;layer9_attn_comp -->
<g id="edge47" class="edge">
<title>layer9_qkv_proj&#45;&gt;layer9_attn_comp</title>
<path fill="none" stroke="black" d="M445,-50458.55C445,-50450.44 445,-50441.65 445,-50433.14"/>
<polygon fill="black" stroke="black" points="448.5,-50432.97 445,-50422.97 441.5,-50432.97 448.5,-50432.97"/>
</g>
<!-- layer9_out_proj -->
<g id="node49" class="node">
<title>layer9_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-50318.67 224,-50318.67 224,-50250.67 666,-50250.67 666,-50318.67"/>
<text text-anchor="middle" x="445" y="-50303.47" font-family="Times,serif" font-size="14.00">Layer 9 Output Projection</text>
<text text-anchor="middle" x="445" y="-50288.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50273.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-50258.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer9_attn_comp&#45;&gt;layer9_out_proj -->
<g id="edge48" class="edge">
<title>layer9_attn_comp&#45;&gt;layer9_out_proj</title>
<path fill="none" stroke="black" d="M445,-50354.55C445,-50346.44 445,-50337.65 445,-50329.14"/>
<polygon fill="black" stroke="black" points="448.5,-50328.97 445,-50318.97 441.5,-50328.97 448.5,-50328.97"/>
</g>
<!-- layer9_gate -->
<g id="node50" class="node">
<title>layer9_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-50214.67 191.3,-50214.67 15.57,-50078.67 698.7,-50078.67 874.43,-50214.67"/>
<text text-anchor="middle" x="445" y="-50165.47" font-family="Times,serif" font-size="14.00">Layer 9 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-50150.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-50135.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-50120.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer9_out_proj&#45;&gt;layer9_gate -->
<g id="edge49" class="edge">
<title>layer9_out_proj&#45;&gt;layer9_gate</title>
<path fill="none" stroke="black" d="M445,-50250.4C445,-50242.57 445,-50233.9 445,-50225.02"/>
<polygon fill="black" stroke="black" points="448.5,-50224.93 445,-50214.93 441.5,-50224.93 448.5,-50224.93"/>
</g>
<!-- layer9_moe -->
<g id="node51" class="node">
<title>layer9_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-50042.67 232,-50042.67 232,-49974.67 658,-49974.67 658,-50042.67"/>
<text text-anchor="middle" x="445" y="-50027.47" font-family="Times,serif" font-size="14.00">Layer 9 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-50012.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49997.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-49982.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_moe -->
<g id="edge50" class="edge">
<title>layer9_gate&#45;&gt;layer9_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-50078.46C445,-50069.71 445,-50060.94 445,-50052.73"/>
<polygon fill="black" stroke="black" points="448.5,-50052.68 445,-50042.68 441.5,-50052.68 448.5,-50052.68"/>
</g>
<!-- layer10_qkv_proj -->
<g id="node52" class="node">
<title>layer10_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-49938.67 218,-49938.67 218,-49870.67 672,-49870.67 672,-49938.67"/>
<text text-anchor="middle" x="445" y="-49923.47" font-family="Times,serif" font-size="14.00">Layer 10 QKV Projection</text>
<text text-anchor="middle" x="445" y="-49908.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49893.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-49878.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer9_moe&#45;&gt;layer10_qkv_proj -->
<g id="edge51" class="edge">
<title>layer9_moe&#45;&gt;layer10_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-49974.55C445,-49966.44 445,-49957.65 445,-49949.14"/>
<polygon fill="black" stroke="black" points="448.5,-49948.97 445,-49938.97 441.5,-49948.97 448.5,-49948.97"/>
</g>
<!-- layer10_attn_comp -->
<g id="node53" class="node">
<title>layer10_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-49834.67 218,-49834.67 218,-49766.67 672,-49766.67 672,-49834.67"/>
<text text-anchor="middle" x="445" y="-49819.47" font-family="Times,serif" font-size="14.00">Layer 10 Attention Computation</text>
<text text-anchor="middle" x="445" y="-49804.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49789.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-49774.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer10_qkv_proj&#45;&gt;layer10_attn_comp -->
<g id="edge52" class="edge">
<title>layer10_qkv_proj&#45;&gt;layer10_attn_comp</title>
<path fill="none" stroke="black" d="M445,-49870.55C445,-49862.44 445,-49853.65 445,-49845.14"/>
<polygon fill="black" stroke="black" points="448.5,-49844.97 445,-49834.97 441.5,-49844.97 448.5,-49844.97"/>
</g>
<!-- layer10_out_proj -->
<g id="node54" class="node">
<title>layer10_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-49730.67 224,-49730.67 224,-49662.67 666,-49662.67 666,-49730.67"/>
<text text-anchor="middle" x="445" y="-49715.47" font-family="Times,serif" font-size="14.00">Layer 10 Output Projection</text>
<text text-anchor="middle" x="445" y="-49700.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49685.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-49670.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer10_attn_comp&#45;&gt;layer10_out_proj -->
<g id="edge53" class="edge">
<title>layer10_attn_comp&#45;&gt;layer10_out_proj</title>
<path fill="none" stroke="black" d="M445,-49766.55C445,-49758.44 445,-49749.65 445,-49741.14"/>
<polygon fill="black" stroke="black" points="448.5,-49740.97 445,-49730.97 441.5,-49740.97 448.5,-49740.97"/>
</g>
<!-- layer10_gate -->
<g id="node55" class="node">
<title>layer10_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-49626.67 191.3,-49626.67 15.57,-49490.67 698.7,-49490.67 874.43,-49626.67"/>
<text text-anchor="middle" x="445" y="-49577.47" font-family="Times,serif" font-size="14.00">Layer 10 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-49562.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49547.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-49532.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer10_out_proj&#45;&gt;layer10_gate -->
<g id="edge54" class="edge">
<title>layer10_out_proj&#45;&gt;layer10_gate</title>
<path fill="none" stroke="black" d="M445,-49662.4C445,-49654.57 445,-49645.9 445,-49637.02"/>
<polygon fill="black" stroke="black" points="448.5,-49636.93 445,-49626.93 441.5,-49636.93 448.5,-49636.93"/>
</g>
<!-- layer10_moe -->
<g id="node56" class="node">
<title>layer10_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-49454.67 232,-49454.67 232,-49386.67 658,-49386.67 658,-49454.67"/>
<text text-anchor="middle" x="445" y="-49439.47" font-family="Times,serif" font-size="14.00">Layer 10 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-49424.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49409.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-49394.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_moe -->
<g id="edge55" class="edge">
<title>layer10_gate&#45;&gt;layer10_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-49490.46C445,-49481.71 445,-49472.94 445,-49464.73"/>
<polygon fill="black" stroke="black" points="448.5,-49464.68 445,-49454.68 441.5,-49464.68 448.5,-49464.68"/>
</g>
<!-- layer11_qkv_proj -->
<g id="node57" class="node">
<title>layer11_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-49350.67 218,-49350.67 218,-49282.67 672,-49282.67 672,-49350.67"/>
<text text-anchor="middle" x="445" y="-49335.47" font-family="Times,serif" font-size="14.00">Layer 11 QKV Projection</text>
<text text-anchor="middle" x="445" y="-49320.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49305.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-49290.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer10_moe&#45;&gt;layer11_qkv_proj -->
<g id="edge56" class="edge">
<title>layer10_moe&#45;&gt;layer11_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-49386.55C445,-49378.44 445,-49369.65 445,-49361.14"/>
<polygon fill="black" stroke="black" points="448.5,-49360.97 445,-49350.97 441.5,-49360.97 448.5,-49360.97"/>
</g>
<!-- layer11_attn_comp -->
<g id="node58" class="node">
<title>layer11_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-49246.67 218,-49246.67 218,-49178.67 672,-49178.67 672,-49246.67"/>
<text text-anchor="middle" x="445" y="-49231.47" font-family="Times,serif" font-size="14.00">Layer 11 Attention Computation</text>
<text text-anchor="middle" x="445" y="-49216.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49201.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-49186.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer11_qkv_proj&#45;&gt;layer11_attn_comp -->
<g id="edge57" class="edge">
<title>layer11_qkv_proj&#45;&gt;layer11_attn_comp</title>
<path fill="none" stroke="black" d="M445,-49282.55C445,-49274.44 445,-49265.65 445,-49257.14"/>
<polygon fill="black" stroke="black" points="448.5,-49256.97 445,-49246.97 441.5,-49256.97 448.5,-49256.97"/>
</g>
<!-- layer11_out_proj -->
<g id="node59" class="node">
<title>layer11_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-49142.67 224,-49142.67 224,-49074.67 666,-49074.67 666,-49142.67"/>
<text text-anchor="middle" x="445" y="-49127.47" font-family="Times,serif" font-size="14.00">Layer 11 Output Projection</text>
<text text-anchor="middle" x="445" y="-49112.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-49097.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-49082.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer11_attn_comp&#45;&gt;layer11_out_proj -->
<g id="edge58" class="edge">
<title>layer11_attn_comp&#45;&gt;layer11_out_proj</title>
<path fill="none" stroke="black" d="M445,-49178.55C445,-49170.44 445,-49161.65 445,-49153.14"/>
<polygon fill="black" stroke="black" points="448.5,-49152.97 445,-49142.97 441.5,-49152.97 448.5,-49152.97"/>
</g>
<!-- layer11_gate -->
<g id="node60" class="node">
<title>layer11_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-49038.67 191.3,-49038.67 15.57,-48902.67 698.7,-48902.67 874.43,-49038.67"/>
<text text-anchor="middle" x="445" y="-48989.47" font-family="Times,serif" font-size="14.00">Layer 11 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-48974.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48959.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-48944.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer11_out_proj&#45;&gt;layer11_gate -->
<g id="edge59" class="edge">
<title>layer11_out_proj&#45;&gt;layer11_gate</title>
<path fill="none" stroke="black" d="M445,-49074.4C445,-49066.57 445,-49057.9 445,-49049.02"/>
<polygon fill="black" stroke="black" points="448.5,-49048.93 445,-49038.93 441.5,-49048.93 448.5,-49048.93"/>
</g>
<!-- layer11_moe -->
<g id="node61" class="node">
<title>layer11_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-48866.67 232,-48866.67 232,-48798.67 658,-48798.67 658,-48866.67"/>
<text text-anchor="middle" x="445" y="-48851.47" font-family="Times,serif" font-size="14.00">Layer 11 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-48836.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48821.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-48806.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_moe -->
<g id="edge60" class="edge">
<title>layer11_gate&#45;&gt;layer11_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-48902.46C445,-48893.71 445,-48884.94 445,-48876.73"/>
<polygon fill="black" stroke="black" points="448.5,-48876.68 445,-48866.68 441.5,-48876.68 448.5,-48876.68"/>
</g>
<!-- layer12_qkv_proj -->
<g id="node62" class="node">
<title>layer12_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-48762.67 218,-48762.67 218,-48694.67 672,-48694.67 672,-48762.67"/>
<text text-anchor="middle" x="445" y="-48747.47" font-family="Times,serif" font-size="14.00">Layer 12 QKV Projection</text>
<text text-anchor="middle" x="445" y="-48732.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48717.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-48702.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer11_moe&#45;&gt;layer12_qkv_proj -->
<g id="edge61" class="edge">
<title>layer11_moe&#45;&gt;layer12_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-48798.55C445,-48790.44 445,-48781.65 445,-48773.14"/>
<polygon fill="black" stroke="black" points="448.5,-48772.97 445,-48762.97 441.5,-48772.97 448.5,-48772.97"/>
</g>
<!-- layer12_attn_comp -->
<g id="node63" class="node">
<title>layer12_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-48658.67 218,-48658.67 218,-48590.67 672,-48590.67 672,-48658.67"/>
<text text-anchor="middle" x="445" y="-48643.47" font-family="Times,serif" font-size="14.00">Layer 12 Attention Computation</text>
<text text-anchor="middle" x="445" y="-48628.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48613.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-48598.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer12_qkv_proj&#45;&gt;layer12_attn_comp -->
<g id="edge62" class="edge">
<title>layer12_qkv_proj&#45;&gt;layer12_attn_comp</title>
<path fill="none" stroke="black" d="M445,-48694.55C445,-48686.44 445,-48677.65 445,-48669.14"/>
<polygon fill="black" stroke="black" points="448.5,-48668.97 445,-48658.97 441.5,-48668.97 448.5,-48668.97"/>
</g>
<!-- layer12_out_proj -->
<g id="node64" class="node">
<title>layer12_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-48554.67 224,-48554.67 224,-48486.67 666,-48486.67 666,-48554.67"/>
<text text-anchor="middle" x="445" y="-48539.47" font-family="Times,serif" font-size="14.00">Layer 12 Output Projection</text>
<text text-anchor="middle" x="445" y="-48524.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48509.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-48494.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer12_attn_comp&#45;&gt;layer12_out_proj -->
<g id="edge63" class="edge">
<title>layer12_attn_comp&#45;&gt;layer12_out_proj</title>
<path fill="none" stroke="black" d="M445,-48590.55C445,-48582.44 445,-48573.65 445,-48565.14"/>
<polygon fill="black" stroke="black" points="448.5,-48564.97 445,-48554.97 441.5,-48564.97 448.5,-48564.97"/>
</g>
<!-- layer12_gate -->
<g id="node65" class="node">
<title>layer12_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-48450.67 191.3,-48450.67 15.57,-48314.67 698.7,-48314.67 874.43,-48450.67"/>
<text text-anchor="middle" x="445" y="-48401.47" font-family="Times,serif" font-size="14.00">Layer 12 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-48386.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48371.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-48356.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer12_out_proj&#45;&gt;layer12_gate -->
<g id="edge64" class="edge">
<title>layer12_out_proj&#45;&gt;layer12_gate</title>
<path fill="none" stroke="black" d="M445,-48486.4C445,-48478.57 445,-48469.9 445,-48461.02"/>
<polygon fill="black" stroke="black" points="448.5,-48460.93 445,-48450.93 441.5,-48460.93 448.5,-48460.93"/>
</g>
<!-- layer12_moe -->
<g id="node66" class="node">
<title>layer12_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-48278.67 232,-48278.67 232,-48210.67 658,-48210.67 658,-48278.67"/>
<text text-anchor="middle" x="445" y="-48263.47" font-family="Times,serif" font-size="14.00">Layer 12 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-48248.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48233.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-48218.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_moe -->
<g id="edge65" class="edge">
<title>layer12_gate&#45;&gt;layer12_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-48314.46C445,-48305.71 445,-48296.94 445,-48288.73"/>
<polygon fill="black" stroke="black" points="448.5,-48288.68 445,-48278.68 441.5,-48288.68 448.5,-48288.68"/>
</g>
<!-- layer13_qkv_proj -->
<g id="node67" class="node">
<title>layer13_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-48174.67 218,-48174.67 218,-48106.67 672,-48106.67 672,-48174.67"/>
<text text-anchor="middle" x="445" y="-48159.47" font-family="Times,serif" font-size="14.00">Layer 13 QKV Projection</text>
<text text-anchor="middle" x="445" y="-48144.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48129.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-48114.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer12_moe&#45;&gt;layer13_qkv_proj -->
<g id="edge66" class="edge">
<title>layer12_moe&#45;&gt;layer13_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-48210.55C445,-48202.44 445,-48193.65 445,-48185.14"/>
<polygon fill="black" stroke="black" points="448.5,-48184.97 445,-48174.97 441.5,-48184.97 448.5,-48184.97"/>
</g>
<!-- layer13_attn_comp -->
<g id="node68" class="node">
<title>layer13_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-48070.67 218,-48070.67 218,-48002.67 672,-48002.67 672,-48070.67"/>
<text text-anchor="middle" x="445" y="-48055.47" font-family="Times,serif" font-size="14.00">Layer 13 Attention Computation</text>
<text text-anchor="middle" x="445" y="-48040.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-48025.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-48010.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer13_qkv_proj&#45;&gt;layer13_attn_comp -->
<g id="edge67" class="edge">
<title>layer13_qkv_proj&#45;&gt;layer13_attn_comp</title>
<path fill="none" stroke="black" d="M445,-48106.55C445,-48098.44 445,-48089.65 445,-48081.14"/>
<polygon fill="black" stroke="black" points="448.5,-48080.97 445,-48070.97 441.5,-48080.97 448.5,-48080.97"/>
</g>
<!-- layer13_out_proj -->
<g id="node69" class="node">
<title>layer13_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-47966.67 224,-47966.67 224,-47898.67 666,-47898.67 666,-47966.67"/>
<text text-anchor="middle" x="445" y="-47951.47" font-family="Times,serif" font-size="14.00">Layer 13 Output Projection</text>
<text text-anchor="middle" x="445" y="-47936.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47921.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-47906.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer13_attn_comp&#45;&gt;layer13_out_proj -->
<g id="edge68" class="edge">
<title>layer13_attn_comp&#45;&gt;layer13_out_proj</title>
<path fill="none" stroke="black" d="M445,-48002.55C445,-47994.44 445,-47985.65 445,-47977.14"/>
<polygon fill="black" stroke="black" points="448.5,-47976.97 445,-47966.97 441.5,-47976.97 448.5,-47976.97"/>
</g>
<!-- layer13_gate -->
<g id="node70" class="node">
<title>layer13_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-47862.67 191.3,-47862.67 15.57,-47726.67 698.7,-47726.67 874.43,-47862.67"/>
<text text-anchor="middle" x="445" y="-47813.47" font-family="Times,serif" font-size="14.00">Layer 13 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-47798.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47783.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-47768.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer13_out_proj&#45;&gt;layer13_gate -->
<g id="edge69" class="edge">
<title>layer13_out_proj&#45;&gt;layer13_gate</title>
<path fill="none" stroke="black" d="M445,-47898.4C445,-47890.57 445,-47881.9 445,-47873.02"/>
<polygon fill="black" stroke="black" points="448.5,-47872.93 445,-47862.93 441.5,-47872.93 448.5,-47872.93"/>
</g>
<!-- layer13_moe -->
<g id="node71" class="node">
<title>layer13_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-47690.67 232,-47690.67 232,-47622.67 658,-47622.67 658,-47690.67"/>
<text text-anchor="middle" x="445" y="-47675.47" font-family="Times,serif" font-size="14.00">Layer 13 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-47660.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47645.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-47630.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_moe -->
<g id="edge70" class="edge">
<title>layer13_gate&#45;&gt;layer13_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-47726.46C445,-47717.71 445,-47708.94 445,-47700.73"/>
<polygon fill="black" stroke="black" points="448.5,-47700.68 445,-47690.68 441.5,-47700.68 448.5,-47700.68"/>
</g>
<!-- layer14_qkv_proj -->
<g id="node72" class="node">
<title>layer14_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-47586.67 218,-47586.67 218,-47518.67 672,-47518.67 672,-47586.67"/>
<text text-anchor="middle" x="445" y="-47571.47" font-family="Times,serif" font-size="14.00">Layer 14 QKV Projection</text>
<text text-anchor="middle" x="445" y="-47556.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47541.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-47526.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer13_moe&#45;&gt;layer14_qkv_proj -->
<g id="edge71" class="edge">
<title>layer13_moe&#45;&gt;layer14_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-47622.55C445,-47614.44 445,-47605.65 445,-47597.14"/>
<polygon fill="black" stroke="black" points="448.5,-47596.97 445,-47586.97 441.5,-47596.97 448.5,-47596.97"/>
</g>
<!-- layer14_attn_comp -->
<g id="node73" class="node">
<title>layer14_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-47482.67 218,-47482.67 218,-47414.67 672,-47414.67 672,-47482.67"/>
<text text-anchor="middle" x="445" y="-47467.47" font-family="Times,serif" font-size="14.00">Layer 14 Attention Computation</text>
<text text-anchor="middle" x="445" y="-47452.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47437.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-47422.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer14_qkv_proj&#45;&gt;layer14_attn_comp -->
<g id="edge72" class="edge">
<title>layer14_qkv_proj&#45;&gt;layer14_attn_comp</title>
<path fill="none" stroke="black" d="M445,-47518.55C445,-47510.44 445,-47501.65 445,-47493.14"/>
<polygon fill="black" stroke="black" points="448.5,-47492.97 445,-47482.97 441.5,-47492.97 448.5,-47492.97"/>
</g>
<!-- layer14_out_proj -->
<g id="node74" class="node">
<title>layer14_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-47378.67 224,-47378.67 224,-47310.67 666,-47310.67 666,-47378.67"/>
<text text-anchor="middle" x="445" y="-47363.47" font-family="Times,serif" font-size="14.00">Layer 14 Output Projection</text>
<text text-anchor="middle" x="445" y="-47348.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47333.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-47318.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer14_attn_comp&#45;&gt;layer14_out_proj -->
<g id="edge73" class="edge">
<title>layer14_attn_comp&#45;&gt;layer14_out_proj</title>
<path fill="none" stroke="black" d="M445,-47414.55C445,-47406.44 445,-47397.65 445,-47389.14"/>
<polygon fill="black" stroke="black" points="448.5,-47388.97 445,-47378.97 441.5,-47388.97 448.5,-47388.97"/>
</g>
<!-- layer14_gate -->
<g id="node75" class="node">
<title>layer14_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-47274.67 191.3,-47274.67 15.57,-47138.67 698.7,-47138.67 874.43,-47274.67"/>
<text text-anchor="middle" x="445" y="-47225.47" font-family="Times,serif" font-size="14.00">Layer 14 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-47210.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47195.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-47180.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer14_out_proj&#45;&gt;layer14_gate -->
<g id="edge74" class="edge">
<title>layer14_out_proj&#45;&gt;layer14_gate</title>
<path fill="none" stroke="black" d="M445,-47310.4C445,-47302.57 445,-47293.9 445,-47285.02"/>
<polygon fill="black" stroke="black" points="448.5,-47284.93 445,-47274.93 441.5,-47284.93 448.5,-47284.93"/>
</g>
<!-- layer14_moe -->
<g id="node76" class="node">
<title>layer14_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-47102.67 232,-47102.67 232,-47034.67 658,-47034.67 658,-47102.67"/>
<text text-anchor="middle" x="445" y="-47087.47" font-family="Times,serif" font-size="14.00">Layer 14 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-47072.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-47057.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-47042.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_moe -->
<g id="edge75" class="edge">
<title>layer14_gate&#45;&gt;layer14_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-47138.46C445,-47129.71 445,-47120.94 445,-47112.73"/>
<polygon fill="black" stroke="black" points="448.5,-47112.68 445,-47102.68 441.5,-47112.68 448.5,-47112.68"/>
</g>
<!-- layer15_qkv_proj -->
<g id="node77" class="node">
<title>layer15_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-46998.67 218,-46998.67 218,-46930.67 672,-46930.67 672,-46998.67"/>
<text text-anchor="middle" x="445" y="-46983.47" font-family="Times,serif" font-size="14.00">Layer 15 QKV Projection</text>
<text text-anchor="middle" x="445" y="-46968.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46953.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-46938.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer14_moe&#45;&gt;layer15_qkv_proj -->
<g id="edge76" class="edge">
<title>layer14_moe&#45;&gt;layer15_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-47034.55C445,-47026.44 445,-47017.65 445,-47009.14"/>
<polygon fill="black" stroke="black" points="448.5,-47008.97 445,-46998.97 441.5,-47008.97 448.5,-47008.97"/>
</g>
<!-- layer15_attn_comp -->
<g id="node78" class="node">
<title>layer15_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-46894.67 218,-46894.67 218,-46826.67 672,-46826.67 672,-46894.67"/>
<text text-anchor="middle" x="445" y="-46879.47" font-family="Times,serif" font-size="14.00">Layer 15 Attention Computation</text>
<text text-anchor="middle" x="445" y="-46864.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46849.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-46834.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer15_qkv_proj&#45;&gt;layer15_attn_comp -->
<g id="edge77" class="edge">
<title>layer15_qkv_proj&#45;&gt;layer15_attn_comp</title>
<path fill="none" stroke="black" d="M445,-46930.55C445,-46922.44 445,-46913.65 445,-46905.14"/>
<polygon fill="black" stroke="black" points="448.5,-46904.97 445,-46894.97 441.5,-46904.97 448.5,-46904.97"/>
</g>
<!-- layer15_out_proj -->
<g id="node79" class="node">
<title>layer15_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-46790.67 224,-46790.67 224,-46722.67 666,-46722.67 666,-46790.67"/>
<text text-anchor="middle" x="445" y="-46775.47" font-family="Times,serif" font-size="14.00">Layer 15 Output Projection</text>
<text text-anchor="middle" x="445" y="-46760.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46745.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-46730.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer15_attn_comp&#45;&gt;layer15_out_proj -->
<g id="edge78" class="edge">
<title>layer15_attn_comp&#45;&gt;layer15_out_proj</title>
<path fill="none" stroke="black" d="M445,-46826.55C445,-46818.44 445,-46809.65 445,-46801.14"/>
<polygon fill="black" stroke="black" points="448.5,-46800.97 445,-46790.97 441.5,-46800.97 448.5,-46800.97"/>
</g>
<!-- layer15_gate -->
<g id="node80" class="node">
<title>layer15_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-46686.67 191.3,-46686.67 15.57,-46550.67 698.7,-46550.67 874.43,-46686.67"/>
<text text-anchor="middle" x="445" y="-46637.47" font-family="Times,serif" font-size="14.00">Layer 15 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-46622.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46607.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-46592.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer15_out_proj&#45;&gt;layer15_gate -->
<g id="edge79" class="edge">
<title>layer15_out_proj&#45;&gt;layer15_gate</title>
<path fill="none" stroke="black" d="M445,-46722.4C445,-46714.57 445,-46705.9 445,-46697.02"/>
<polygon fill="black" stroke="black" points="448.5,-46696.93 445,-46686.93 441.5,-46696.93 448.5,-46696.93"/>
</g>
<!-- layer15_moe -->
<g id="node81" class="node">
<title>layer15_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-46514.67 232,-46514.67 232,-46446.67 658,-46446.67 658,-46514.67"/>
<text text-anchor="middle" x="445" y="-46499.47" font-family="Times,serif" font-size="14.00">Layer 15 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-46484.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46469.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-46454.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_moe -->
<g id="edge80" class="edge">
<title>layer15_gate&#45;&gt;layer15_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-46550.46C445,-46541.71 445,-46532.94 445,-46524.73"/>
<polygon fill="black" stroke="black" points="448.5,-46524.68 445,-46514.68 441.5,-46524.68 448.5,-46524.68"/>
</g>
<!-- layer16_qkv_proj -->
<g id="node82" class="node">
<title>layer16_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-46410.67 218,-46410.67 218,-46342.67 672,-46342.67 672,-46410.67"/>
<text text-anchor="middle" x="445" y="-46395.47" font-family="Times,serif" font-size="14.00">Layer 16 QKV Projection</text>
<text text-anchor="middle" x="445" y="-46380.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46365.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-46350.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer15_moe&#45;&gt;layer16_qkv_proj -->
<g id="edge81" class="edge">
<title>layer15_moe&#45;&gt;layer16_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-46446.55C445,-46438.44 445,-46429.65 445,-46421.14"/>
<polygon fill="black" stroke="black" points="448.5,-46420.97 445,-46410.97 441.5,-46420.97 448.5,-46420.97"/>
</g>
<!-- layer16_attn_comp -->
<g id="node83" class="node">
<title>layer16_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-46306.67 218,-46306.67 218,-46238.67 672,-46238.67 672,-46306.67"/>
<text text-anchor="middle" x="445" y="-46291.47" font-family="Times,serif" font-size="14.00">Layer 16 Attention Computation</text>
<text text-anchor="middle" x="445" y="-46276.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46261.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-46246.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer16_qkv_proj&#45;&gt;layer16_attn_comp -->
<g id="edge82" class="edge">
<title>layer16_qkv_proj&#45;&gt;layer16_attn_comp</title>
<path fill="none" stroke="black" d="M445,-46342.55C445,-46334.44 445,-46325.65 445,-46317.14"/>
<polygon fill="black" stroke="black" points="448.5,-46316.97 445,-46306.97 441.5,-46316.97 448.5,-46316.97"/>
</g>
<!-- layer16_out_proj -->
<g id="node84" class="node">
<title>layer16_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-46202.67 224,-46202.67 224,-46134.67 666,-46134.67 666,-46202.67"/>
<text text-anchor="middle" x="445" y="-46187.47" font-family="Times,serif" font-size="14.00">Layer 16 Output Projection</text>
<text text-anchor="middle" x="445" y="-46172.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46157.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-46142.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer16_attn_comp&#45;&gt;layer16_out_proj -->
<g id="edge83" class="edge">
<title>layer16_attn_comp&#45;&gt;layer16_out_proj</title>
<path fill="none" stroke="black" d="M445,-46238.55C445,-46230.44 445,-46221.65 445,-46213.14"/>
<polygon fill="black" stroke="black" points="448.5,-46212.97 445,-46202.97 441.5,-46212.97 448.5,-46212.97"/>
</g>
<!-- layer16_gate -->
<g id="node85" class="node">
<title>layer16_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-46098.67 191.3,-46098.67 15.57,-45962.67 698.7,-45962.67 874.43,-46098.67"/>
<text text-anchor="middle" x="445" y="-46049.47" font-family="Times,serif" font-size="14.00">Layer 16 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-46034.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-46019.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-46004.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer16_out_proj&#45;&gt;layer16_gate -->
<g id="edge84" class="edge">
<title>layer16_out_proj&#45;&gt;layer16_gate</title>
<path fill="none" stroke="black" d="M445,-46134.4C445,-46126.57 445,-46117.9 445,-46109.02"/>
<polygon fill="black" stroke="black" points="448.5,-46108.93 445,-46098.93 441.5,-46108.93 448.5,-46108.93"/>
</g>
<!-- layer16_moe -->
<g id="node86" class="node">
<title>layer16_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-45926.67 232,-45926.67 232,-45858.67 658,-45858.67 658,-45926.67"/>
<text text-anchor="middle" x="445" y="-45911.47" font-family="Times,serif" font-size="14.00">Layer 16 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-45896.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45881.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-45866.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer16_gate&#45;&gt;layer16_moe -->
<g id="edge85" class="edge">
<title>layer16_gate&#45;&gt;layer16_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-45962.46C445,-45953.71 445,-45944.94 445,-45936.73"/>
<polygon fill="black" stroke="black" points="448.5,-45936.68 445,-45926.68 441.5,-45936.68 448.5,-45936.68"/>
</g>
<!-- layer17_qkv_proj -->
<g id="node87" class="node">
<title>layer17_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-45822.67 218,-45822.67 218,-45754.67 672,-45754.67 672,-45822.67"/>
<text text-anchor="middle" x="445" y="-45807.47" font-family="Times,serif" font-size="14.00">Layer 17 QKV Projection</text>
<text text-anchor="middle" x="445" y="-45792.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45777.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-45762.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer16_moe&#45;&gt;layer17_qkv_proj -->
<g id="edge86" class="edge">
<title>layer16_moe&#45;&gt;layer17_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-45858.55C445,-45850.44 445,-45841.65 445,-45833.14"/>
<polygon fill="black" stroke="black" points="448.5,-45832.97 445,-45822.97 441.5,-45832.97 448.5,-45832.97"/>
</g>
<!-- layer17_attn_comp -->
<g id="node88" class="node">
<title>layer17_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-45718.67 218,-45718.67 218,-45650.67 672,-45650.67 672,-45718.67"/>
<text text-anchor="middle" x="445" y="-45703.47" font-family="Times,serif" font-size="14.00">Layer 17 Attention Computation</text>
<text text-anchor="middle" x="445" y="-45688.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45673.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-45658.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer17_qkv_proj&#45;&gt;layer17_attn_comp -->
<g id="edge87" class="edge">
<title>layer17_qkv_proj&#45;&gt;layer17_attn_comp</title>
<path fill="none" stroke="black" d="M445,-45754.55C445,-45746.44 445,-45737.65 445,-45729.14"/>
<polygon fill="black" stroke="black" points="448.5,-45728.97 445,-45718.97 441.5,-45728.97 448.5,-45728.97"/>
</g>
<!-- layer17_out_proj -->
<g id="node89" class="node">
<title>layer17_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-45614.67 224,-45614.67 224,-45546.67 666,-45546.67 666,-45614.67"/>
<text text-anchor="middle" x="445" y="-45599.47" font-family="Times,serif" font-size="14.00">Layer 17 Output Projection</text>
<text text-anchor="middle" x="445" y="-45584.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45569.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-45554.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer17_attn_comp&#45;&gt;layer17_out_proj -->
<g id="edge88" class="edge">
<title>layer17_attn_comp&#45;&gt;layer17_out_proj</title>
<path fill="none" stroke="black" d="M445,-45650.55C445,-45642.44 445,-45633.65 445,-45625.14"/>
<polygon fill="black" stroke="black" points="448.5,-45624.97 445,-45614.97 441.5,-45624.97 448.5,-45624.97"/>
</g>
<!-- layer17_gate -->
<g id="node90" class="node">
<title>layer17_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-45510.67 191.3,-45510.67 15.57,-45374.67 698.7,-45374.67 874.43,-45510.67"/>
<text text-anchor="middle" x="445" y="-45461.47" font-family="Times,serif" font-size="14.00">Layer 17 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-45446.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45431.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-45416.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer17_out_proj&#45;&gt;layer17_gate -->
<g id="edge89" class="edge">
<title>layer17_out_proj&#45;&gt;layer17_gate</title>
<path fill="none" stroke="black" d="M445,-45546.4C445,-45538.57 445,-45529.9 445,-45521.02"/>
<polygon fill="black" stroke="black" points="448.5,-45520.93 445,-45510.93 441.5,-45520.93 448.5,-45520.93"/>
</g>
<!-- layer17_moe -->
<g id="node91" class="node">
<title>layer17_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-45338.67 232,-45338.67 232,-45270.67 658,-45270.67 658,-45338.67"/>
<text text-anchor="middle" x="445" y="-45323.47" font-family="Times,serif" font-size="14.00">Layer 17 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-45308.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45293.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-45278.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer17_gate&#45;&gt;layer17_moe -->
<g id="edge90" class="edge">
<title>layer17_gate&#45;&gt;layer17_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-45374.46C445,-45365.71 445,-45356.94 445,-45348.73"/>
<polygon fill="black" stroke="black" points="448.5,-45348.68 445,-45338.68 441.5,-45348.68 448.5,-45348.68"/>
</g>
<!-- layer18_qkv_proj -->
<g id="node92" class="node">
<title>layer18_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-45234.67 218,-45234.67 218,-45166.67 672,-45166.67 672,-45234.67"/>
<text text-anchor="middle" x="445" y="-45219.47" font-family="Times,serif" font-size="14.00">Layer 18 QKV Projection</text>
<text text-anchor="middle" x="445" y="-45204.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45189.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-45174.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer17_moe&#45;&gt;layer18_qkv_proj -->
<g id="edge91" class="edge">
<title>layer17_moe&#45;&gt;layer18_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-45270.55C445,-45262.44 445,-45253.65 445,-45245.14"/>
<polygon fill="black" stroke="black" points="448.5,-45244.97 445,-45234.97 441.5,-45244.97 448.5,-45244.97"/>
</g>
<!-- layer18_attn_comp -->
<g id="node93" class="node">
<title>layer18_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-45130.67 218,-45130.67 218,-45062.67 672,-45062.67 672,-45130.67"/>
<text text-anchor="middle" x="445" y="-45115.47" font-family="Times,serif" font-size="14.00">Layer 18 Attention Computation</text>
<text text-anchor="middle" x="445" y="-45100.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-45085.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-45070.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer18_qkv_proj&#45;&gt;layer18_attn_comp -->
<g id="edge92" class="edge">
<title>layer18_qkv_proj&#45;&gt;layer18_attn_comp</title>
<path fill="none" stroke="black" d="M445,-45166.55C445,-45158.44 445,-45149.65 445,-45141.14"/>
<polygon fill="black" stroke="black" points="448.5,-45140.97 445,-45130.97 441.5,-45140.97 448.5,-45140.97"/>
</g>
<!-- layer18_out_proj -->
<g id="node94" class="node">
<title>layer18_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-45026.67 224,-45026.67 224,-44958.67 666,-44958.67 666,-45026.67"/>
<text text-anchor="middle" x="445" y="-45011.47" font-family="Times,serif" font-size="14.00">Layer 18 Output Projection</text>
<text text-anchor="middle" x="445" y="-44996.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44981.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-44966.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer18_attn_comp&#45;&gt;layer18_out_proj -->
<g id="edge93" class="edge">
<title>layer18_attn_comp&#45;&gt;layer18_out_proj</title>
<path fill="none" stroke="black" d="M445,-45062.55C445,-45054.44 445,-45045.65 445,-45037.14"/>
<polygon fill="black" stroke="black" points="448.5,-45036.97 445,-45026.97 441.5,-45036.97 448.5,-45036.97"/>
</g>
<!-- layer18_gate -->
<g id="node95" class="node">
<title>layer18_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-44922.67 191.3,-44922.67 15.57,-44786.67 698.7,-44786.67 874.43,-44922.67"/>
<text text-anchor="middle" x="445" y="-44873.47" font-family="Times,serif" font-size="14.00">Layer 18 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-44858.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44843.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-44828.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer18_out_proj&#45;&gt;layer18_gate -->
<g id="edge94" class="edge">
<title>layer18_out_proj&#45;&gt;layer18_gate</title>
<path fill="none" stroke="black" d="M445,-44958.4C445,-44950.57 445,-44941.9 445,-44933.02"/>
<polygon fill="black" stroke="black" points="448.5,-44932.93 445,-44922.93 441.5,-44932.93 448.5,-44932.93"/>
</g>
<!-- layer18_moe -->
<g id="node96" class="node">
<title>layer18_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-44750.67 232,-44750.67 232,-44682.67 658,-44682.67 658,-44750.67"/>
<text text-anchor="middle" x="445" y="-44735.47" font-family="Times,serif" font-size="14.00">Layer 18 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-44720.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44705.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-44690.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer18_gate&#45;&gt;layer18_moe -->
<g id="edge95" class="edge">
<title>layer18_gate&#45;&gt;layer18_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-44786.46C445,-44777.71 445,-44768.94 445,-44760.73"/>
<polygon fill="black" stroke="black" points="448.5,-44760.68 445,-44750.68 441.5,-44760.68 448.5,-44760.68"/>
</g>
<!-- layer19_qkv_proj -->
<g id="node97" class="node">
<title>layer19_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-44646.67 218,-44646.67 218,-44578.67 672,-44578.67 672,-44646.67"/>
<text text-anchor="middle" x="445" y="-44631.47" font-family="Times,serif" font-size="14.00">Layer 19 QKV Projection</text>
<text text-anchor="middle" x="445" y="-44616.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44601.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-44586.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer18_moe&#45;&gt;layer19_qkv_proj -->
<g id="edge96" class="edge">
<title>layer18_moe&#45;&gt;layer19_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-44682.55C445,-44674.44 445,-44665.65 445,-44657.14"/>
<polygon fill="black" stroke="black" points="448.5,-44656.97 445,-44646.97 441.5,-44656.97 448.5,-44656.97"/>
</g>
<!-- layer19_attn_comp -->
<g id="node98" class="node">
<title>layer19_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-44542.67 218,-44542.67 218,-44474.67 672,-44474.67 672,-44542.67"/>
<text text-anchor="middle" x="445" y="-44527.47" font-family="Times,serif" font-size="14.00">Layer 19 Attention Computation</text>
<text text-anchor="middle" x="445" y="-44512.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44497.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-44482.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer19_qkv_proj&#45;&gt;layer19_attn_comp -->
<g id="edge97" class="edge">
<title>layer19_qkv_proj&#45;&gt;layer19_attn_comp</title>
<path fill="none" stroke="black" d="M445,-44578.55C445,-44570.44 445,-44561.65 445,-44553.14"/>
<polygon fill="black" stroke="black" points="448.5,-44552.97 445,-44542.97 441.5,-44552.97 448.5,-44552.97"/>
</g>
<!-- layer19_out_proj -->
<g id="node99" class="node">
<title>layer19_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-44438.67 224,-44438.67 224,-44370.67 666,-44370.67 666,-44438.67"/>
<text text-anchor="middle" x="445" y="-44423.47" font-family="Times,serif" font-size="14.00">Layer 19 Output Projection</text>
<text text-anchor="middle" x="445" y="-44408.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44393.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-44378.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer19_attn_comp&#45;&gt;layer19_out_proj -->
<g id="edge98" class="edge">
<title>layer19_attn_comp&#45;&gt;layer19_out_proj</title>
<path fill="none" stroke="black" d="M445,-44474.55C445,-44466.44 445,-44457.65 445,-44449.14"/>
<polygon fill="black" stroke="black" points="448.5,-44448.97 445,-44438.97 441.5,-44448.97 448.5,-44448.97"/>
</g>
<!-- layer19_gate -->
<g id="node100" class="node">
<title>layer19_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-44334.67 191.3,-44334.67 15.57,-44198.67 698.7,-44198.67 874.43,-44334.67"/>
<text text-anchor="middle" x="445" y="-44285.47" font-family="Times,serif" font-size="14.00">Layer 19 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-44270.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44255.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-44240.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer19_out_proj&#45;&gt;layer19_gate -->
<g id="edge99" class="edge">
<title>layer19_out_proj&#45;&gt;layer19_gate</title>
<path fill="none" stroke="black" d="M445,-44370.4C445,-44362.57 445,-44353.9 445,-44345.02"/>
<polygon fill="black" stroke="black" points="448.5,-44344.93 445,-44334.93 441.5,-44344.93 448.5,-44344.93"/>
</g>
<!-- layer19_moe -->
<g id="node101" class="node">
<title>layer19_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-44162.67 232,-44162.67 232,-44094.67 658,-44094.67 658,-44162.67"/>
<text text-anchor="middle" x="445" y="-44147.47" font-family="Times,serif" font-size="14.00">Layer 19 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-44132.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44117.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-44102.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer19_gate&#45;&gt;layer19_moe -->
<g id="edge100" class="edge">
<title>layer19_gate&#45;&gt;layer19_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-44198.46C445,-44189.71 445,-44180.94 445,-44172.73"/>
<polygon fill="black" stroke="black" points="448.5,-44172.68 445,-44162.68 441.5,-44172.68 448.5,-44172.68"/>
</g>
<!-- layer20_qkv_proj -->
<g id="node102" class="node">
<title>layer20_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-44058.67 218,-44058.67 218,-43990.67 672,-43990.67 672,-44058.67"/>
<text text-anchor="middle" x="445" y="-44043.47" font-family="Times,serif" font-size="14.00">Layer 20 QKV Projection</text>
<text text-anchor="middle" x="445" y="-44028.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-44013.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-43998.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer19_moe&#45;&gt;layer20_qkv_proj -->
<g id="edge101" class="edge">
<title>layer19_moe&#45;&gt;layer20_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-44094.55C445,-44086.44 445,-44077.65 445,-44069.14"/>
<polygon fill="black" stroke="black" points="448.5,-44068.97 445,-44058.97 441.5,-44068.97 448.5,-44068.97"/>
</g>
<!-- layer20_attn_comp -->
<g id="node103" class="node">
<title>layer20_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-43954.67 218,-43954.67 218,-43886.67 672,-43886.67 672,-43954.67"/>
<text text-anchor="middle" x="445" y="-43939.47" font-family="Times,serif" font-size="14.00">Layer 20 Attention Computation</text>
<text text-anchor="middle" x="445" y="-43924.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43909.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-43894.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer20_qkv_proj&#45;&gt;layer20_attn_comp -->
<g id="edge102" class="edge">
<title>layer20_qkv_proj&#45;&gt;layer20_attn_comp</title>
<path fill="none" stroke="black" d="M445,-43990.55C445,-43982.44 445,-43973.65 445,-43965.14"/>
<polygon fill="black" stroke="black" points="448.5,-43964.97 445,-43954.97 441.5,-43964.97 448.5,-43964.97"/>
</g>
<!-- layer20_out_proj -->
<g id="node104" class="node">
<title>layer20_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-43850.67 224,-43850.67 224,-43782.67 666,-43782.67 666,-43850.67"/>
<text text-anchor="middle" x="445" y="-43835.47" font-family="Times,serif" font-size="14.00">Layer 20 Output Projection</text>
<text text-anchor="middle" x="445" y="-43820.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43805.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-43790.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer20_attn_comp&#45;&gt;layer20_out_proj -->
<g id="edge103" class="edge">
<title>layer20_attn_comp&#45;&gt;layer20_out_proj</title>
<path fill="none" stroke="black" d="M445,-43886.55C445,-43878.44 445,-43869.65 445,-43861.14"/>
<polygon fill="black" stroke="black" points="448.5,-43860.97 445,-43850.97 441.5,-43860.97 448.5,-43860.97"/>
</g>
<!-- layer20_gate -->
<g id="node105" class="node">
<title>layer20_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-43746.67 191.3,-43746.67 15.57,-43610.67 698.7,-43610.67 874.43,-43746.67"/>
<text text-anchor="middle" x="445" y="-43697.47" font-family="Times,serif" font-size="14.00">Layer 20 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-43682.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43667.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-43652.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer20_out_proj&#45;&gt;layer20_gate -->
<g id="edge104" class="edge">
<title>layer20_out_proj&#45;&gt;layer20_gate</title>
<path fill="none" stroke="black" d="M445,-43782.4C445,-43774.57 445,-43765.9 445,-43757.02"/>
<polygon fill="black" stroke="black" points="448.5,-43756.93 445,-43746.93 441.5,-43756.93 448.5,-43756.93"/>
</g>
<!-- layer20_moe -->
<g id="node106" class="node">
<title>layer20_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-43574.67 232,-43574.67 232,-43506.67 658,-43506.67 658,-43574.67"/>
<text text-anchor="middle" x="445" y="-43559.47" font-family="Times,serif" font-size="14.00">Layer 20 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-43544.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43529.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-43514.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer20_gate&#45;&gt;layer20_moe -->
<g id="edge105" class="edge">
<title>layer20_gate&#45;&gt;layer20_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-43610.46C445,-43601.71 445,-43592.94 445,-43584.73"/>
<polygon fill="black" stroke="black" points="448.5,-43584.68 445,-43574.68 441.5,-43584.68 448.5,-43584.68"/>
</g>
<!-- layer21_qkv_proj -->
<g id="node107" class="node">
<title>layer21_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-43470.67 218,-43470.67 218,-43402.67 672,-43402.67 672,-43470.67"/>
<text text-anchor="middle" x="445" y="-43455.47" font-family="Times,serif" font-size="14.00">Layer 21 QKV Projection</text>
<text text-anchor="middle" x="445" y="-43440.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43425.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-43410.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer20_moe&#45;&gt;layer21_qkv_proj -->
<g id="edge106" class="edge">
<title>layer20_moe&#45;&gt;layer21_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-43506.55C445,-43498.44 445,-43489.65 445,-43481.14"/>
<polygon fill="black" stroke="black" points="448.5,-43480.97 445,-43470.97 441.5,-43480.97 448.5,-43480.97"/>
</g>
<!-- layer21_attn_comp -->
<g id="node108" class="node">
<title>layer21_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-43366.67 218,-43366.67 218,-43298.67 672,-43298.67 672,-43366.67"/>
<text text-anchor="middle" x="445" y="-43351.47" font-family="Times,serif" font-size="14.00">Layer 21 Attention Computation</text>
<text text-anchor="middle" x="445" y="-43336.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43321.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-43306.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer21_qkv_proj&#45;&gt;layer21_attn_comp -->
<g id="edge107" class="edge">
<title>layer21_qkv_proj&#45;&gt;layer21_attn_comp</title>
<path fill="none" stroke="black" d="M445,-43402.55C445,-43394.44 445,-43385.65 445,-43377.14"/>
<polygon fill="black" stroke="black" points="448.5,-43376.97 445,-43366.97 441.5,-43376.97 448.5,-43376.97"/>
</g>
<!-- layer21_out_proj -->
<g id="node109" class="node">
<title>layer21_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-43262.67 224,-43262.67 224,-43194.67 666,-43194.67 666,-43262.67"/>
<text text-anchor="middle" x="445" y="-43247.47" font-family="Times,serif" font-size="14.00">Layer 21 Output Projection</text>
<text text-anchor="middle" x="445" y="-43232.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43217.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-43202.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer21_attn_comp&#45;&gt;layer21_out_proj -->
<g id="edge108" class="edge">
<title>layer21_attn_comp&#45;&gt;layer21_out_proj</title>
<path fill="none" stroke="black" d="M445,-43298.55C445,-43290.44 445,-43281.65 445,-43273.14"/>
<polygon fill="black" stroke="black" points="448.5,-43272.97 445,-43262.97 441.5,-43272.97 448.5,-43272.97"/>
</g>
<!-- layer21_gate -->
<g id="node110" class="node">
<title>layer21_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-43158.67 191.3,-43158.67 15.57,-43022.67 698.7,-43022.67 874.43,-43158.67"/>
<text text-anchor="middle" x="445" y="-43109.47" font-family="Times,serif" font-size="14.00">Layer 21 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-43094.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-43079.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-43064.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer21_out_proj&#45;&gt;layer21_gate -->
<g id="edge109" class="edge">
<title>layer21_out_proj&#45;&gt;layer21_gate</title>
<path fill="none" stroke="black" d="M445,-43194.4C445,-43186.57 445,-43177.9 445,-43169.02"/>
<polygon fill="black" stroke="black" points="448.5,-43168.93 445,-43158.93 441.5,-43168.93 448.5,-43168.93"/>
</g>
<!-- layer21_moe -->
<g id="node111" class="node">
<title>layer21_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-42986.67 232,-42986.67 232,-42918.67 658,-42918.67 658,-42986.67"/>
<text text-anchor="middle" x="445" y="-42971.47" font-family="Times,serif" font-size="14.00">Layer 21 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-42956.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42941.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-42926.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer21_gate&#45;&gt;layer21_moe -->
<g id="edge110" class="edge">
<title>layer21_gate&#45;&gt;layer21_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-43022.46C445,-43013.71 445,-43004.94 445,-42996.73"/>
<polygon fill="black" stroke="black" points="448.5,-42996.68 445,-42986.68 441.5,-42996.68 448.5,-42996.68"/>
</g>
<!-- layer22_qkv_proj -->
<g id="node112" class="node">
<title>layer22_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-42882.67 218,-42882.67 218,-42814.67 672,-42814.67 672,-42882.67"/>
<text text-anchor="middle" x="445" y="-42867.47" font-family="Times,serif" font-size="14.00">Layer 22 QKV Projection</text>
<text text-anchor="middle" x="445" y="-42852.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42837.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-42822.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer21_moe&#45;&gt;layer22_qkv_proj -->
<g id="edge111" class="edge">
<title>layer21_moe&#45;&gt;layer22_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-42918.55C445,-42910.44 445,-42901.65 445,-42893.14"/>
<polygon fill="black" stroke="black" points="448.5,-42892.97 445,-42882.97 441.5,-42892.97 448.5,-42892.97"/>
</g>
<!-- layer22_attn_comp -->
<g id="node113" class="node">
<title>layer22_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-42778.67 218,-42778.67 218,-42710.67 672,-42710.67 672,-42778.67"/>
<text text-anchor="middle" x="445" y="-42763.47" font-family="Times,serif" font-size="14.00">Layer 22 Attention Computation</text>
<text text-anchor="middle" x="445" y="-42748.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42733.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-42718.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer22_qkv_proj&#45;&gt;layer22_attn_comp -->
<g id="edge112" class="edge">
<title>layer22_qkv_proj&#45;&gt;layer22_attn_comp</title>
<path fill="none" stroke="black" d="M445,-42814.55C445,-42806.44 445,-42797.65 445,-42789.14"/>
<polygon fill="black" stroke="black" points="448.5,-42788.97 445,-42778.97 441.5,-42788.97 448.5,-42788.97"/>
</g>
<!-- layer22_out_proj -->
<g id="node114" class="node">
<title>layer22_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-42674.67 224,-42674.67 224,-42606.67 666,-42606.67 666,-42674.67"/>
<text text-anchor="middle" x="445" y="-42659.47" font-family="Times,serif" font-size="14.00">Layer 22 Output Projection</text>
<text text-anchor="middle" x="445" y="-42644.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42629.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-42614.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer22_attn_comp&#45;&gt;layer22_out_proj -->
<g id="edge113" class="edge">
<title>layer22_attn_comp&#45;&gt;layer22_out_proj</title>
<path fill="none" stroke="black" d="M445,-42710.55C445,-42702.44 445,-42693.65 445,-42685.14"/>
<polygon fill="black" stroke="black" points="448.5,-42684.97 445,-42674.97 441.5,-42684.97 448.5,-42684.97"/>
</g>
<!-- layer22_gate -->
<g id="node115" class="node">
<title>layer22_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-42570.67 191.3,-42570.67 15.57,-42434.67 698.7,-42434.67 874.43,-42570.67"/>
<text text-anchor="middle" x="445" y="-42521.47" font-family="Times,serif" font-size="14.00">Layer 22 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-42506.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42491.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-42476.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer22_out_proj&#45;&gt;layer22_gate -->
<g id="edge114" class="edge">
<title>layer22_out_proj&#45;&gt;layer22_gate</title>
<path fill="none" stroke="black" d="M445,-42606.4C445,-42598.57 445,-42589.9 445,-42581.02"/>
<polygon fill="black" stroke="black" points="448.5,-42580.93 445,-42570.93 441.5,-42580.93 448.5,-42580.93"/>
</g>
<!-- layer22_moe -->
<g id="node116" class="node">
<title>layer22_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-42398.67 232,-42398.67 232,-42330.67 658,-42330.67 658,-42398.67"/>
<text text-anchor="middle" x="445" y="-42383.47" font-family="Times,serif" font-size="14.00">Layer 22 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-42368.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42353.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-42338.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer22_gate&#45;&gt;layer22_moe -->
<g id="edge115" class="edge">
<title>layer22_gate&#45;&gt;layer22_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-42434.46C445,-42425.71 445,-42416.94 445,-42408.73"/>
<polygon fill="black" stroke="black" points="448.5,-42408.68 445,-42398.68 441.5,-42408.68 448.5,-42408.68"/>
</g>
<!-- layer23_qkv_proj -->
<g id="node117" class="node">
<title>layer23_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="672,-42294.67 218,-42294.67 218,-42226.67 672,-42226.67 672,-42294.67"/>
<text text-anchor="middle" x="445" y="-42279.47" font-family="Times,serif" font-size="14.00">Layer 23 QKV Projection</text>
<text text-anchor="middle" x="445" y="-42264.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42249.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-42234.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer22_moe&#45;&gt;layer23_qkv_proj -->
<g id="edge116" class="edge">
<title>layer22_moe&#45;&gt;layer23_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-42330.55C445,-42322.44 445,-42313.65 445,-42305.14"/>
<polygon fill="black" stroke="black" points="448.5,-42304.97 445,-42294.97 441.5,-42304.97 448.5,-42304.97"/>
</g>
<!-- layer23_attn_comp -->
<g id="node118" class="node">
<title>layer23_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="672,-42190.67 218,-42190.67 218,-42122.67 672,-42122.67 672,-42190.67"/>
<text text-anchor="middle" x="445" y="-42175.47" font-family="Times,serif" font-size="14.00">Layer 23 Attention Computation</text>
<text text-anchor="middle" x="445" y="-42160.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42145.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-42130.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer23_qkv_proj&#45;&gt;layer23_attn_comp -->
<g id="edge117" class="edge">
<title>layer23_qkv_proj&#45;&gt;layer23_attn_comp</title>
<path fill="none" stroke="black" d="M445,-42226.55C445,-42218.44 445,-42209.65 445,-42201.14"/>
<polygon fill="black" stroke="black" points="448.5,-42200.97 445,-42190.97 441.5,-42200.97 448.5,-42200.97"/>
</g>
<!-- layer23_out_proj -->
<g id="node119" class="node">
<title>layer23_out_proj</title>
<polygon fill="lightblue" stroke="black" points="666,-42086.67 224,-42086.67 224,-42018.67 666,-42018.67 666,-42086.67"/>
<text text-anchor="middle" x="445" y="-42071.47" font-family="Times,serif" font-size="14.00">Layer 23 Output Projection</text>
<text text-anchor="middle" x="445" y="-42056.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-42041.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-42026.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer23_attn_comp&#45;&gt;layer23_out_proj -->
<g id="edge118" class="edge">
<title>layer23_attn_comp&#45;&gt;layer23_out_proj</title>
<path fill="none" stroke="black" d="M445,-42122.55C445,-42114.44 445,-42105.65 445,-42097.14"/>
<polygon fill="black" stroke="black" points="448.5,-42096.97 445,-42086.97 441.5,-42096.97 448.5,-42096.97"/>
</g>
<!-- layer23_gate -->
<g id="node120" class="node">
<title>layer23_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-41982.67 191.3,-41982.67 15.57,-41846.67 698.7,-41846.67 874.43,-41982.67"/>
<text text-anchor="middle" x="445" y="-41933.47" font-family="Times,serif" font-size="14.00">Layer 23 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-41918.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-41903.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-41888.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer23_out_proj&#45;&gt;layer23_gate -->
<g id="edge119" class="edge">
<title>layer23_out_proj&#45;&gt;layer23_gate</title>
<path fill="none" stroke="black" d="M445,-42018.4C445,-42010.57 445,-42001.9 445,-41993.02"/>
<polygon fill="black" stroke="black" points="448.5,-41992.93 445,-41982.93 441.5,-41992.93 448.5,-41992.93"/>
</g>
<!-- layer23_moe -->
<g id="node121" class="node">
<title>layer23_moe</title>
<polygon fill="lightblue" stroke="black" points="658,-41810.67 232,-41810.67 232,-41742.67 658,-41742.67 658,-41810.67"/>
<text text-anchor="middle" x="445" y="-41795.47" font-family="Times,serif" font-size="14.00">Layer 23 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-41780.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="445" y="-41765.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-41750.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer23_gate&#45;&gt;layer23_moe -->
<g id="edge120" class="edge">
<title>layer23_gate&#45;&gt;layer23_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-41846.46C445,-41837.71 445,-41828.94 445,-41820.73"/>
<polygon fill="black" stroke="black" points="448.5,-41820.68 445,-41810.68 441.5,-41820.68 448.5,-41820.68"/>
</g>
<!-- comm_0_1 -->
<g id="node122" class="node">
<title>comm_0_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="445" cy="-41658.58" rx="301.46" ry="48.17"/>
<text text-anchor="middle" x="445" y="-41677.38" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="445" y="-41662.38" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;8  9&#45;17</text>
<text text-anchor="middle" x="445" y="-41647.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-41632.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer23_moe&#45;&gt;comm_0_1 -->
<g id="edge121" class="edge">
<title>layer23_moe&#45;&gt;comm_0_1</title>
<path fill="none" stroke="black" d="M445,-41742.4C445,-41734.41 445,-41725.64 445,-41716.9"/>
<polygon fill="black" stroke="black" points="448.5,-41716.69 445,-41706.69 441.5,-41716.69 448.5,-41716.69"/>
</g>
<!-- layer24_qkv_proj -->
<g id="node123" class="node">
<title>layer24_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-41556.5 218,-41556.5 218,-41488.5 672,-41488.5 672,-41556.5"/>
<text text-anchor="middle" x="445" y="-41541.3" font-family="Times,serif" font-size="14.00">Layer 24 QKV Projection</text>
<text text-anchor="middle" x="445" y="-41526.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-41511.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-41496.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- comm_0_1&#45;&gt;layer24_qkv_proj -->
<g id="edge122" class="edge">
<title>comm_0_1&#45;&gt;layer24_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-41610.31C445,-41596.25 445,-41580.92 445,-41567.1"/>
<polygon fill="black" stroke="black" points="448.5,-41566.88 445,-41556.88 441.5,-41566.88 448.5,-41566.88"/>
</g>
<!-- layer24_attn_comp -->
<g id="node124" class="node">
<title>layer24_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-41452.5 218,-41452.5 218,-41384.5 672,-41384.5 672,-41452.5"/>
<text text-anchor="middle" x="445" y="-41437.3" font-family="Times,serif" font-size="14.00">Layer 24 Attention Computation</text>
<text text-anchor="middle" x="445" y="-41422.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-41407.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-41392.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer24_qkv_proj&#45;&gt;layer24_attn_comp -->
<g id="edge123" class="edge">
<title>layer24_qkv_proj&#45;&gt;layer24_attn_comp</title>
<path fill="none" stroke="black" d="M445,-41488.38C445,-41480.28 445,-41471.48 445,-41462.97"/>
<polygon fill="black" stroke="black" points="448.5,-41462.8 445,-41452.8 441.5,-41462.8 448.5,-41462.8"/>
</g>
<!-- layer24_out_proj -->
<g id="node125" class="node">
<title>layer24_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-41348.5 224,-41348.5 224,-41280.5 666,-41280.5 666,-41348.5"/>
<text text-anchor="middle" x="445" y="-41333.3" font-family="Times,serif" font-size="14.00">Layer 24 Output Projection</text>
<text text-anchor="middle" x="445" y="-41318.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-41303.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-41288.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer24_attn_comp&#45;&gt;layer24_out_proj -->
<g id="edge124" class="edge">
<title>layer24_attn_comp&#45;&gt;layer24_out_proj</title>
<path fill="none" stroke="black" d="M445,-41384.38C445,-41376.28 445,-41367.48 445,-41358.97"/>
<polygon fill="black" stroke="black" points="448.5,-41358.8 445,-41348.8 441.5,-41358.8 448.5,-41358.8"/>
</g>
<!-- layer24_gate -->
<g id="node126" class="node">
<title>layer24_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-41244.5 191.3,-41244.5 15.57,-41108.5 698.7,-41108.5 874.43,-41244.5"/>
<text text-anchor="middle" x="445" y="-41195.3" font-family="Times,serif" font-size="14.00">Layer 24 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-41180.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-41165.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-41150.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer24_out_proj&#45;&gt;layer24_gate -->
<g id="edge125" class="edge">
<title>layer24_out_proj&#45;&gt;layer24_gate</title>
<path fill="none" stroke="black" d="M445,-41280.23C445,-41272.4 445,-41263.74 445,-41254.85"/>
<polygon fill="black" stroke="black" points="448.5,-41254.76 445,-41244.76 441.5,-41254.76 448.5,-41254.76"/>
</g>
<!-- layer24_moe -->
<g id="node127" class="node">
<title>layer24_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-41072.5 232,-41072.5 232,-41004.5 658,-41004.5 658,-41072.5"/>
<text text-anchor="middle" x="445" y="-41057.3" font-family="Times,serif" font-size="14.00">Layer 24 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-41042.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-41027.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-41012.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer24_gate&#45;&gt;layer24_moe -->
<g id="edge126" class="edge">
<title>layer24_gate&#45;&gt;layer24_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-41108.3C445,-41099.54 445,-41090.77 445,-41082.57"/>
<polygon fill="black" stroke="black" points="448.5,-41082.52 445,-41072.52 441.5,-41082.52 448.5,-41082.52"/>
</g>
<!-- layer25_qkv_proj -->
<g id="node128" class="node">
<title>layer25_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-40968.5 218,-40968.5 218,-40900.5 672,-40900.5 672,-40968.5"/>
<text text-anchor="middle" x="445" y="-40953.3" font-family="Times,serif" font-size="14.00">Layer 25 QKV Projection</text>
<text text-anchor="middle" x="445" y="-40938.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40923.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-40908.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer24_moe&#45;&gt;layer25_qkv_proj -->
<g id="edge127" class="edge">
<title>layer24_moe&#45;&gt;layer25_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-41004.38C445,-40996.28 445,-40987.48 445,-40978.97"/>
<polygon fill="black" stroke="black" points="448.5,-40978.8 445,-40968.8 441.5,-40978.8 448.5,-40978.8"/>
</g>
<!-- layer25_attn_comp -->
<g id="node129" class="node">
<title>layer25_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-40864.5 218,-40864.5 218,-40796.5 672,-40796.5 672,-40864.5"/>
<text text-anchor="middle" x="445" y="-40849.3" font-family="Times,serif" font-size="14.00">Layer 25 Attention Computation</text>
<text text-anchor="middle" x="445" y="-40834.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40819.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-40804.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer25_qkv_proj&#45;&gt;layer25_attn_comp -->
<g id="edge128" class="edge">
<title>layer25_qkv_proj&#45;&gt;layer25_attn_comp</title>
<path fill="none" stroke="black" d="M445,-40900.38C445,-40892.28 445,-40883.48 445,-40874.97"/>
<polygon fill="black" stroke="black" points="448.5,-40874.8 445,-40864.8 441.5,-40874.8 448.5,-40874.8"/>
</g>
<!-- layer25_out_proj -->
<g id="node130" class="node">
<title>layer25_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-40760.5 224,-40760.5 224,-40692.5 666,-40692.5 666,-40760.5"/>
<text text-anchor="middle" x="445" y="-40745.3" font-family="Times,serif" font-size="14.00">Layer 25 Output Projection</text>
<text text-anchor="middle" x="445" y="-40730.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40715.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-40700.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer25_attn_comp&#45;&gt;layer25_out_proj -->
<g id="edge129" class="edge">
<title>layer25_attn_comp&#45;&gt;layer25_out_proj</title>
<path fill="none" stroke="black" d="M445,-40796.38C445,-40788.28 445,-40779.48 445,-40770.97"/>
<polygon fill="black" stroke="black" points="448.5,-40770.8 445,-40760.8 441.5,-40770.8 448.5,-40770.8"/>
</g>
<!-- layer25_gate -->
<g id="node131" class="node">
<title>layer25_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-40656.5 191.3,-40656.5 15.57,-40520.5 698.7,-40520.5 874.43,-40656.5"/>
<text text-anchor="middle" x="445" y="-40607.3" font-family="Times,serif" font-size="14.00">Layer 25 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-40592.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40577.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-40562.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer25_out_proj&#45;&gt;layer25_gate -->
<g id="edge130" class="edge">
<title>layer25_out_proj&#45;&gt;layer25_gate</title>
<path fill="none" stroke="black" d="M445,-40692.23C445,-40684.4 445,-40675.74 445,-40666.85"/>
<polygon fill="black" stroke="black" points="448.5,-40666.76 445,-40656.76 441.5,-40666.76 448.5,-40666.76"/>
</g>
<!-- layer25_moe -->
<g id="node132" class="node">
<title>layer25_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-40484.5 232,-40484.5 232,-40416.5 658,-40416.5 658,-40484.5"/>
<text text-anchor="middle" x="445" y="-40469.3" font-family="Times,serif" font-size="14.00">Layer 25 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-40454.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40439.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-40424.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer25_gate&#45;&gt;layer25_moe -->
<g id="edge131" class="edge">
<title>layer25_gate&#45;&gt;layer25_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-40520.3C445,-40511.54 445,-40502.77 445,-40494.57"/>
<polygon fill="black" stroke="black" points="448.5,-40494.52 445,-40484.52 441.5,-40494.52 448.5,-40494.52"/>
</g>
<!-- layer26_qkv_proj -->
<g id="node133" class="node">
<title>layer26_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-40380.5 218,-40380.5 218,-40312.5 672,-40312.5 672,-40380.5"/>
<text text-anchor="middle" x="445" y="-40365.3" font-family="Times,serif" font-size="14.00">Layer 26 QKV Projection</text>
<text text-anchor="middle" x="445" y="-40350.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40335.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-40320.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer25_moe&#45;&gt;layer26_qkv_proj -->
<g id="edge132" class="edge">
<title>layer25_moe&#45;&gt;layer26_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-40416.38C445,-40408.28 445,-40399.48 445,-40390.97"/>
<polygon fill="black" stroke="black" points="448.5,-40390.8 445,-40380.8 441.5,-40390.8 448.5,-40390.8"/>
</g>
<!-- layer26_attn_comp -->
<g id="node134" class="node">
<title>layer26_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-40276.5 218,-40276.5 218,-40208.5 672,-40208.5 672,-40276.5"/>
<text text-anchor="middle" x="445" y="-40261.3" font-family="Times,serif" font-size="14.00">Layer 26 Attention Computation</text>
<text text-anchor="middle" x="445" y="-40246.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40231.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-40216.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer26_qkv_proj&#45;&gt;layer26_attn_comp -->
<g id="edge133" class="edge">
<title>layer26_qkv_proj&#45;&gt;layer26_attn_comp</title>
<path fill="none" stroke="black" d="M445,-40312.38C445,-40304.28 445,-40295.48 445,-40286.97"/>
<polygon fill="black" stroke="black" points="448.5,-40286.8 445,-40276.8 441.5,-40286.8 448.5,-40286.8"/>
</g>
<!-- layer26_out_proj -->
<g id="node135" class="node">
<title>layer26_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-40172.5 224,-40172.5 224,-40104.5 666,-40104.5 666,-40172.5"/>
<text text-anchor="middle" x="445" y="-40157.3" font-family="Times,serif" font-size="14.00">Layer 26 Output Projection</text>
<text text-anchor="middle" x="445" y="-40142.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-40127.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-40112.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer26_attn_comp&#45;&gt;layer26_out_proj -->
<g id="edge134" class="edge">
<title>layer26_attn_comp&#45;&gt;layer26_out_proj</title>
<path fill="none" stroke="black" d="M445,-40208.38C445,-40200.28 445,-40191.48 445,-40182.97"/>
<polygon fill="black" stroke="black" points="448.5,-40182.8 445,-40172.8 441.5,-40182.8 448.5,-40182.8"/>
</g>
<!-- layer26_gate -->
<g id="node136" class="node">
<title>layer26_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-40068.5 191.3,-40068.5 15.57,-39932.5 698.7,-39932.5 874.43,-40068.5"/>
<text text-anchor="middle" x="445" y="-40019.3" font-family="Times,serif" font-size="14.00">Layer 26 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-40004.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39989.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-39974.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer26_out_proj&#45;&gt;layer26_gate -->
<g id="edge135" class="edge">
<title>layer26_out_proj&#45;&gt;layer26_gate</title>
<path fill="none" stroke="black" d="M445,-40104.23C445,-40096.4 445,-40087.74 445,-40078.85"/>
<polygon fill="black" stroke="black" points="448.5,-40078.76 445,-40068.76 441.5,-40078.76 448.5,-40078.76"/>
</g>
<!-- layer26_moe -->
<g id="node137" class="node">
<title>layer26_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-39896.5 232,-39896.5 232,-39828.5 658,-39828.5 658,-39896.5"/>
<text text-anchor="middle" x="445" y="-39881.3" font-family="Times,serif" font-size="14.00">Layer 26 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-39866.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39851.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-39836.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer26_gate&#45;&gt;layer26_moe -->
<g id="edge136" class="edge">
<title>layer26_gate&#45;&gt;layer26_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-39932.3C445,-39923.54 445,-39914.77 445,-39906.57"/>
<polygon fill="black" stroke="black" points="448.5,-39906.52 445,-39896.52 441.5,-39906.52 448.5,-39906.52"/>
</g>
<!-- layer27_qkv_proj -->
<g id="node138" class="node">
<title>layer27_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-39792.5 218,-39792.5 218,-39724.5 672,-39724.5 672,-39792.5"/>
<text text-anchor="middle" x="445" y="-39777.3" font-family="Times,serif" font-size="14.00">Layer 27 QKV Projection</text>
<text text-anchor="middle" x="445" y="-39762.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-39732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer26_moe&#45;&gt;layer27_qkv_proj -->
<g id="edge137" class="edge">
<title>layer26_moe&#45;&gt;layer27_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-39828.38C445,-39820.28 445,-39811.48 445,-39802.97"/>
<polygon fill="black" stroke="black" points="448.5,-39802.8 445,-39792.8 441.5,-39802.8 448.5,-39802.8"/>
</g>
<!-- layer27_attn_comp -->
<g id="node139" class="node">
<title>layer27_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-39688.5 218,-39688.5 218,-39620.5 672,-39620.5 672,-39688.5"/>
<text text-anchor="middle" x="445" y="-39673.3" font-family="Times,serif" font-size="14.00">Layer 27 Attention Computation</text>
<text text-anchor="middle" x="445" y="-39658.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39643.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-39628.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer27_qkv_proj&#45;&gt;layer27_attn_comp -->
<g id="edge138" class="edge">
<title>layer27_qkv_proj&#45;&gt;layer27_attn_comp</title>
<path fill="none" stroke="black" d="M445,-39724.38C445,-39716.28 445,-39707.48 445,-39698.97"/>
<polygon fill="black" stroke="black" points="448.5,-39698.8 445,-39688.8 441.5,-39698.8 448.5,-39698.8"/>
</g>
<!-- layer27_out_proj -->
<g id="node140" class="node">
<title>layer27_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-39584.5 224,-39584.5 224,-39516.5 666,-39516.5 666,-39584.5"/>
<text text-anchor="middle" x="445" y="-39569.3" font-family="Times,serif" font-size="14.00">Layer 27 Output Projection</text>
<text text-anchor="middle" x="445" y="-39554.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39539.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-39524.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer27_attn_comp&#45;&gt;layer27_out_proj -->
<g id="edge139" class="edge">
<title>layer27_attn_comp&#45;&gt;layer27_out_proj</title>
<path fill="none" stroke="black" d="M445,-39620.38C445,-39612.28 445,-39603.48 445,-39594.97"/>
<polygon fill="black" stroke="black" points="448.5,-39594.8 445,-39584.8 441.5,-39594.8 448.5,-39594.8"/>
</g>
<!-- layer27_gate -->
<g id="node141" class="node">
<title>layer27_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-39480.5 191.3,-39480.5 15.57,-39344.5 698.7,-39344.5 874.43,-39480.5"/>
<text text-anchor="middle" x="445" y="-39431.3" font-family="Times,serif" font-size="14.00">Layer 27 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-39416.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39401.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-39386.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer27_out_proj&#45;&gt;layer27_gate -->
<g id="edge140" class="edge">
<title>layer27_out_proj&#45;&gt;layer27_gate</title>
<path fill="none" stroke="black" d="M445,-39516.23C445,-39508.4 445,-39499.74 445,-39490.85"/>
<polygon fill="black" stroke="black" points="448.5,-39490.76 445,-39480.76 441.5,-39490.76 448.5,-39490.76"/>
</g>
<!-- layer27_moe -->
<g id="node142" class="node">
<title>layer27_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-39308.5 232,-39308.5 232,-39240.5 658,-39240.5 658,-39308.5"/>
<text text-anchor="middle" x="445" y="-39293.3" font-family="Times,serif" font-size="14.00">Layer 27 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-39278.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39263.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-39248.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer27_gate&#45;&gt;layer27_moe -->
<g id="edge141" class="edge">
<title>layer27_gate&#45;&gt;layer27_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-39344.3C445,-39335.54 445,-39326.77 445,-39318.57"/>
<polygon fill="black" stroke="black" points="448.5,-39318.52 445,-39308.52 441.5,-39318.52 448.5,-39318.52"/>
</g>
<!-- layer28_qkv_proj -->
<g id="node143" class="node">
<title>layer28_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-39204.5 218,-39204.5 218,-39136.5 672,-39136.5 672,-39204.5"/>
<text text-anchor="middle" x="445" y="-39189.3" font-family="Times,serif" font-size="14.00">Layer 28 QKV Projection</text>
<text text-anchor="middle" x="445" y="-39174.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39159.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-39144.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer27_moe&#45;&gt;layer28_qkv_proj -->
<g id="edge142" class="edge">
<title>layer27_moe&#45;&gt;layer28_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-39240.38C445,-39232.28 445,-39223.48 445,-39214.97"/>
<polygon fill="black" stroke="black" points="448.5,-39214.8 445,-39204.8 441.5,-39214.8 448.5,-39214.8"/>
</g>
<!-- layer28_attn_comp -->
<g id="node144" class="node">
<title>layer28_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-39100.5 218,-39100.5 218,-39032.5 672,-39032.5 672,-39100.5"/>
<text text-anchor="middle" x="445" y="-39085.3" font-family="Times,serif" font-size="14.00">Layer 28 Attention Computation</text>
<text text-anchor="middle" x="445" y="-39070.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-39055.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-39040.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer28_qkv_proj&#45;&gt;layer28_attn_comp -->
<g id="edge143" class="edge">
<title>layer28_qkv_proj&#45;&gt;layer28_attn_comp</title>
<path fill="none" stroke="black" d="M445,-39136.38C445,-39128.28 445,-39119.48 445,-39110.97"/>
<polygon fill="black" stroke="black" points="448.5,-39110.8 445,-39100.8 441.5,-39110.8 448.5,-39110.8"/>
</g>
<!-- layer28_out_proj -->
<g id="node145" class="node">
<title>layer28_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-38996.5 224,-38996.5 224,-38928.5 666,-38928.5 666,-38996.5"/>
<text text-anchor="middle" x="445" y="-38981.3" font-family="Times,serif" font-size="14.00">Layer 28 Output Projection</text>
<text text-anchor="middle" x="445" y="-38966.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38951.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-38936.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer28_attn_comp&#45;&gt;layer28_out_proj -->
<g id="edge144" class="edge">
<title>layer28_attn_comp&#45;&gt;layer28_out_proj</title>
<path fill="none" stroke="black" d="M445,-39032.38C445,-39024.28 445,-39015.48 445,-39006.97"/>
<polygon fill="black" stroke="black" points="448.5,-39006.8 445,-38996.8 441.5,-39006.8 448.5,-39006.8"/>
</g>
<!-- layer28_gate -->
<g id="node146" class="node">
<title>layer28_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-38892.5 191.3,-38892.5 15.57,-38756.5 698.7,-38756.5 874.43,-38892.5"/>
<text text-anchor="middle" x="445" y="-38843.3" font-family="Times,serif" font-size="14.00">Layer 28 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-38828.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38813.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-38798.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer28_out_proj&#45;&gt;layer28_gate -->
<g id="edge145" class="edge">
<title>layer28_out_proj&#45;&gt;layer28_gate</title>
<path fill="none" stroke="black" d="M445,-38928.23C445,-38920.4 445,-38911.74 445,-38902.85"/>
<polygon fill="black" stroke="black" points="448.5,-38902.76 445,-38892.76 441.5,-38902.76 448.5,-38902.76"/>
</g>
<!-- layer28_moe -->
<g id="node147" class="node">
<title>layer28_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-38720.5 232,-38720.5 232,-38652.5 658,-38652.5 658,-38720.5"/>
<text text-anchor="middle" x="445" y="-38705.3" font-family="Times,serif" font-size="14.00">Layer 28 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-38690.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38675.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-38660.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer28_gate&#45;&gt;layer28_moe -->
<g id="edge146" class="edge">
<title>layer28_gate&#45;&gt;layer28_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-38756.3C445,-38747.54 445,-38738.77 445,-38730.57"/>
<polygon fill="black" stroke="black" points="448.5,-38730.52 445,-38720.52 441.5,-38730.52 448.5,-38730.52"/>
</g>
<!-- layer29_qkv_proj -->
<g id="node148" class="node">
<title>layer29_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-38616.5 218,-38616.5 218,-38548.5 672,-38548.5 672,-38616.5"/>
<text text-anchor="middle" x="445" y="-38601.3" font-family="Times,serif" font-size="14.00">Layer 29 QKV Projection</text>
<text text-anchor="middle" x="445" y="-38586.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38571.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-38556.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer28_moe&#45;&gt;layer29_qkv_proj -->
<g id="edge147" class="edge">
<title>layer28_moe&#45;&gt;layer29_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-38652.38C445,-38644.28 445,-38635.48 445,-38626.97"/>
<polygon fill="black" stroke="black" points="448.5,-38626.8 445,-38616.8 441.5,-38626.8 448.5,-38626.8"/>
</g>
<!-- layer29_attn_comp -->
<g id="node149" class="node">
<title>layer29_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-38512.5 218,-38512.5 218,-38444.5 672,-38444.5 672,-38512.5"/>
<text text-anchor="middle" x="445" y="-38497.3" font-family="Times,serif" font-size="14.00">Layer 29 Attention Computation</text>
<text text-anchor="middle" x="445" y="-38482.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38467.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-38452.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer29_qkv_proj&#45;&gt;layer29_attn_comp -->
<g id="edge148" class="edge">
<title>layer29_qkv_proj&#45;&gt;layer29_attn_comp</title>
<path fill="none" stroke="black" d="M445,-38548.38C445,-38540.28 445,-38531.48 445,-38522.97"/>
<polygon fill="black" stroke="black" points="448.5,-38522.8 445,-38512.8 441.5,-38522.8 448.5,-38522.8"/>
</g>
<!-- layer29_out_proj -->
<g id="node150" class="node">
<title>layer29_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-38408.5 224,-38408.5 224,-38340.5 666,-38340.5 666,-38408.5"/>
<text text-anchor="middle" x="445" y="-38393.3" font-family="Times,serif" font-size="14.00">Layer 29 Output Projection</text>
<text text-anchor="middle" x="445" y="-38378.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38363.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-38348.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer29_attn_comp&#45;&gt;layer29_out_proj -->
<g id="edge149" class="edge">
<title>layer29_attn_comp&#45;&gt;layer29_out_proj</title>
<path fill="none" stroke="black" d="M445,-38444.38C445,-38436.28 445,-38427.48 445,-38418.97"/>
<polygon fill="black" stroke="black" points="448.5,-38418.8 445,-38408.8 441.5,-38418.8 448.5,-38418.8"/>
</g>
<!-- layer29_gate -->
<g id="node151" class="node">
<title>layer29_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-38304.5 191.3,-38304.5 15.57,-38168.5 698.7,-38168.5 874.43,-38304.5"/>
<text text-anchor="middle" x="445" y="-38255.3" font-family="Times,serif" font-size="14.00">Layer 29 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-38240.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38225.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-38210.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer29_out_proj&#45;&gt;layer29_gate -->
<g id="edge150" class="edge">
<title>layer29_out_proj&#45;&gt;layer29_gate</title>
<path fill="none" stroke="black" d="M445,-38340.23C445,-38332.4 445,-38323.74 445,-38314.85"/>
<polygon fill="black" stroke="black" points="448.5,-38314.76 445,-38304.76 441.5,-38314.76 448.5,-38314.76"/>
</g>
<!-- layer29_moe -->
<g id="node152" class="node">
<title>layer29_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-38132.5 232,-38132.5 232,-38064.5 658,-38064.5 658,-38132.5"/>
<text text-anchor="middle" x="445" y="-38117.3" font-family="Times,serif" font-size="14.00">Layer 29 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-38102.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-38087.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-38072.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer29_gate&#45;&gt;layer29_moe -->
<g id="edge151" class="edge">
<title>layer29_gate&#45;&gt;layer29_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-38168.3C445,-38159.54 445,-38150.77 445,-38142.57"/>
<polygon fill="black" stroke="black" points="448.5,-38142.52 445,-38132.52 441.5,-38142.52 448.5,-38142.52"/>
</g>
<!-- layer30_qkv_proj -->
<g id="node153" class="node">
<title>layer30_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-38028.5 218,-38028.5 218,-37960.5 672,-37960.5 672,-38028.5"/>
<text text-anchor="middle" x="445" y="-38013.3" font-family="Times,serif" font-size="14.00">Layer 30 QKV Projection</text>
<text text-anchor="middle" x="445" y="-37998.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37983.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-37968.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer29_moe&#45;&gt;layer30_qkv_proj -->
<g id="edge152" class="edge">
<title>layer29_moe&#45;&gt;layer30_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-38064.38C445,-38056.28 445,-38047.48 445,-38038.97"/>
<polygon fill="black" stroke="black" points="448.5,-38038.8 445,-38028.8 441.5,-38038.8 448.5,-38038.8"/>
</g>
<!-- layer30_attn_comp -->
<g id="node154" class="node">
<title>layer30_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-37924.5 218,-37924.5 218,-37856.5 672,-37856.5 672,-37924.5"/>
<text text-anchor="middle" x="445" y="-37909.3" font-family="Times,serif" font-size="14.00">Layer 30 Attention Computation</text>
<text text-anchor="middle" x="445" y="-37894.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37879.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-37864.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer30_qkv_proj&#45;&gt;layer30_attn_comp -->
<g id="edge153" class="edge">
<title>layer30_qkv_proj&#45;&gt;layer30_attn_comp</title>
<path fill="none" stroke="black" d="M445,-37960.38C445,-37952.28 445,-37943.48 445,-37934.97"/>
<polygon fill="black" stroke="black" points="448.5,-37934.8 445,-37924.8 441.5,-37934.8 448.5,-37934.8"/>
</g>
<!-- layer30_out_proj -->
<g id="node155" class="node">
<title>layer30_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-37820.5 224,-37820.5 224,-37752.5 666,-37752.5 666,-37820.5"/>
<text text-anchor="middle" x="445" y="-37805.3" font-family="Times,serif" font-size="14.00">Layer 30 Output Projection</text>
<text text-anchor="middle" x="445" y="-37790.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37775.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-37760.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer30_attn_comp&#45;&gt;layer30_out_proj -->
<g id="edge154" class="edge">
<title>layer30_attn_comp&#45;&gt;layer30_out_proj</title>
<path fill="none" stroke="black" d="M445,-37856.38C445,-37848.28 445,-37839.48 445,-37830.97"/>
<polygon fill="black" stroke="black" points="448.5,-37830.8 445,-37820.8 441.5,-37830.8 448.5,-37830.8"/>
</g>
<!-- layer30_gate -->
<g id="node156" class="node">
<title>layer30_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-37716.5 191.3,-37716.5 15.57,-37580.5 698.7,-37580.5 874.43,-37716.5"/>
<text text-anchor="middle" x="445" y="-37667.3" font-family="Times,serif" font-size="14.00">Layer 30 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-37652.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37637.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-37622.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer30_out_proj&#45;&gt;layer30_gate -->
<g id="edge155" class="edge">
<title>layer30_out_proj&#45;&gt;layer30_gate</title>
<path fill="none" stroke="black" d="M445,-37752.23C445,-37744.4 445,-37735.74 445,-37726.85"/>
<polygon fill="black" stroke="black" points="448.5,-37726.76 445,-37716.76 441.5,-37726.76 448.5,-37726.76"/>
</g>
<!-- layer30_moe -->
<g id="node157" class="node">
<title>layer30_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-37544.5 232,-37544.5 232,-37476.5 658,-37476.5 658,-37544.5"/>
<text text-anchor="middle" x="445" y="-37529.3" font-family="Times,serif" font-size="14.00">Layer 30 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-37514.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37499.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-37484.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer30_gate&#45;&gt;layer30_moe -->
<g id="edge156" class="edge">
<title>layer30_gate&#45;&gt;layer30_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-37580.3C445,-37571.54 445,-37562.77 445,-37554.57"/>
<polygon fill="black" stroke="black" points="448.5,-37554.52 445,-37544.52 441.5,-37554.52 448.5,-37554.52"/>
</g>
<!-- layer31_qkv_proj -->
<g id="node158" class="node">
<title>layer31_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-37440.5 218,-37440.5 218,-37372.5 672,-37372.5 672,-37440.5"/>
<text text-anchor="middle" x="445" y="-37425.3" font-family="Times,serif" font-size="14.00">Layer 31 QKV Projection</text>
<text text-anchor="middle" x="445" y="-37410.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37395.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-37380.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer30_moe&#45;&gt;layer31_qkv_proj -->
<g id="edge157" class="edge">
<title>layer30_moe&#45;&gt;layer31_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-37476.38C445,-37468.28 445,-37459.48 445,-37450.97"/>
<polygon fill="black" stroke="black" points="448.5,-37450.8 445,-37440.8 441.5,-37450.8 448.5,-37450.8"/>
</g>
<!-- layer31_attn_comp -->
<g id="node159" class="node">
<title>layer31_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-37336.5 218,-37336.5 218,-37268.5 672,-37268.5 672,-37336.5"/>
<text text-anchor="middle" x="445" y="-37321.3" font-family="Times,serif" font-size="14.00">Layer 31 Attention Computation</text>
<text text-anchor="middle" x="445" y="-37306.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37291.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-37276.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer31_qkv_proj&#45;&gt;layer31_attn_comp -->
<g id="edge158" class="edge">
<title>layer31_qkv_proj&#45;&gt;layer31_attn_comp</title>
<path fill="none" stroke="black" d="M445,-37372.38C445,-37364.28 445,-37355.48 445,-37346.97"/>
<polygon fill="black" stroke="black" points="448.5,-37346.8 445,-37336.8 441.5,-37346.8 448.5,-37346.8"/>
</g>
<!-- layer31_out_proj -->
<g id="node160" class="node">
<title>layer31_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-37232.5 224,-37232.5 224,-37164.5 666,-37164.5 666,-37232.5"/>
<text text-anchor="middle" x="445" y="-37217.3" font-family="Times,serif" font-size="14.00">Layer 31 Output Projection</text>
<text text-anchor="middle" x="445" y="-37202.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37187.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-37172.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer31_attn_comp&#45;&gt;layer31_out_proj -->
<g id="edge159" class="edge">
<title>layer31_attn_comp&#45;&gt;layer31_out_proj</title>
<path fill="none" stroke="black" d="M445,-37268.38C445,-37260.28 445,-37251.48 445,-37242.97"/>
<polygon fill="black" stroke="black" points="448.5,-37242.8 445,-37232.8 441.5,-37242.8 448.5,-37242.8"/>
</g>
<!-- layer31_gate -->
<g id="node161" class="node">
<title>layer31_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-37128.5 191.3,-37128.5 15.57,-36992.5 698.7,-36992.5 874.43,-37128.5"/>
<text text-anchor="middle" x="445" y="-37079.3" font-family="Times,serif" font-size="14.00">Layer 31 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-37064.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-37049.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-37034.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer31_out_proj&#45;&gt;layer31_gate -->
<g id="edge160" class="edge">
<title>layer31_out_proj&#45;&gt;layer31_gate</title>
<path fill="none" stroke="black" d="M445,-37164.23C445,-37156.4 445,-37147.74 445,-37138.85"/>
<polygon fill="black" stroke="black" points="448.5,-37138.76 445,-37128.76 441.5,-37138.76 448.5,-37138.76"/>
</g>
<!-- layer31_moe -->
<g id="node162" class="node">
<title>layer31_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-36956.5 232,-36956.5 232,-36888.5 658,-36888.5 658,-36956.5"/>
<text text-anchor="middle" x="445" y="-36941.3" font-family="Times,serif" font-size="14.00">Layer 31 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-36926.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36911.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-36896.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer31_gate&#45;&gt;layer31_moe -->
<g id="edge161" class="edge">
<title>layer31_gate&#45;&gt;layer31_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-36992.3C445,-36983.54 445,-36974.77 445,-36966.57"/>
<polygon fill="black" stroke="black" points="448.5,-36966.52 445,-36956.52 441.5,-36966.52 448.5,-36966.52"/>
</g>
<!-- layer32_qkv_proj -->
<g id="node163" class="node">
<title>layer32_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-36852.5 218,-36852.5 218,-36784.5 672,-36784.5 672,-36852.5"/>
<text text-anchor="middle" x="445" y="-36837.3" font-family="Times,serif" font-size="14.00">Layer 32 QKV Projection</text>
<text text-anchor="middle" x="445" y="-36822.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36807.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-36792.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer31_moe&#45;&gt;layer32_qkv_proj -->
<g id="edge162" class="edge">
<title>layer31_moe&#45;&gt;layer32_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-36888.38C445,-36880.28 445,-36871.48 445,-36862.97"/>
<polygon fill="black" stroke="black" points="448.5,-36862.8 445,-36852.8 441.5,-36862.8 448.5,-36862.8"/>
</g>
<!-- layer32_attn_comp -->
<g id="node164" class="node">
<title>layer32_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-36748.5 218,-36748.5 218,-36680.5 672,-36680.5 672,-36748.5"/>
<text text-anchor="middle" x="445" y="-36733.3" font-family="Times,serif" font-size="14.00">Layer 32 Attention Computation</text>
<text text-anchor="middle" x="445" y="-36718.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36703.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-36688.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer32_qkv_proj&#45;&gt;layer32_attn_comp -->
<g id="edge163" class="edge">
<title>layer32_qkv_proj&#45;&gt;layer32_attn_comp</title>
<path fill="none" stroke="black" d="M445,-36784.38C445,-36776.28 445,-36767.48 445,-36758.97"/>
<polygon fill="black" stroke="black" points="448.5,-36758.8 445,-36748.8 441.5,-36758.8 448.5,-36758.8"/>
</g>
<!-- layer32_out_proj -->
<g id="node165" class="node">
<title>layer32_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-36644.5 224,-36644.5 224,-36576.5 666,-36576.5 666,-36644.5"/>
<text text-anchor="middle" x="445" y="-36629.3" font-family="Times,serif" font-size="14.00">Layer 32 Output Projection</text>
<text text-anchor="middle" x="445" y="-36614.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36599.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-36584.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer32_attn_comp&#45;&gt;layer32_out_proj -->
<g id="edge164" class="edge">
<title>layer32_attn_comp&#45;&gt;layer32_out_proj</title>
<path fill="none" stroke="black" d="M445,-36680.38C445,-36672.28 445,-36663.48 445,-36654.97"/>
<polygon fill="black" stroke="black" points="448.5,-36654.8 445,-36644.8 441.5,-36654.8 448.5,-36654.8"/>
</g>
<!-- layer32_gate -->
<g id="node166" class="node">
<title>layer32_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-36540.5 191.3,-36540.5 15.57,-36404.5 698.7,-36404.5 874.43,-36540.5"/>
<text text-anchor="middle" x="445" y="-36491.3" font-family="Times,serif" font-size="14.00">Layer 32 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-36476.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36461.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-36446.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer32_out_proj&#45;&gt;layer32_gate -->
<g id="edge165" class="edge">
<title>layer32_out_proj&#45;&gt;layer32_gate</title>
<path fill="none" stroke="black" d="M445,-36576.23C445,-36568.4 445,-36559.74 445,-36550.85"/>
<polygon fill="black" stroke="black" points="448.5,-36550.76 445,-36540.76 441.5,-36550.76 448.5,-36550.76"/>
</g>
<!-- layer32_moe -->
<g id="node167" class="node">
<title>layer32_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-36368.5 232,-36368.5 232,-36300.5 658,-36300.5 658,-36368.5"/>
<text text-anchor="middle" x="445" y="-36353.3" font-family="Times,serif" font-size="14.00">Layer 32 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-36338.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36323.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-36308.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer32_gate&#45;&gt;layer32_moe -->
<g id="edge166" class="edge">
<title>layer32_gate&#45;&gt;layer32_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-36404.3C445,-36395.54 445,-36386.77 445,-36378.57"/>
<polygon fill="black" stroke="black" points="448.5,-36378.52 445,-36368.52 441.5,-36378.52 448.5,-36378.52"/>
</g>
<!-- layer33_qkv_proj -->
<g id="node168" class="node">
<title>layer33_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-36264.5 218,-36264.5 218,-36196.5 672,-36196.5 672,-36264.5"/>
<text text-anchor="middle" x="445" y="-36249.3" font-family="Times,serif" font-size="14.00">Layer 33 QKV Projection</text>
<text text-anchor="middle" x="445" y="-36234.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36219.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-36204.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer32_moe&#45;&gt;layer33_qkv_proj -->
<g id="edge167" class="edge">
<title>layer32_moe&#45;&gt;layer33_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-36300.38C445,-36292.28 445,-36283.48 445,-36274.97"/>
<polygon fill="black" stroke="black" points="448.5,-36274.8 445,-36264.8 441.5,-36274.8 448.5,-36274.8"/>
</g>
<!-- layer33_attn_comp -->
<g id="node169" class="node">
<title>layer33_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-36160.5 218,-36160.5 218,-36092.5 672,-36092.5 672,-36160.5"/>
<text text-anchor="middle" x="445" y="-36145.3" font-family="Times,serif" font-size="14.00">Layer 33 Attention Computation</text>
<text text-anchor="middle" x="445" y="-36130.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36115.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-36100.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer33_qkv_proj&#45;&gt;layer33_attn_comp -->
<g id="edge168" class="edge">
<title>layer33_qkv_proj&#45;&gt;layer33_attn_comp</title>
<path fill="none" stroke="black" d="M445,-36196.38C445,-36188.28 445,-36179.48 445,-36170.97"/>
<polygon fill="black" stroke="black" points="448.5,-36170.8 445,-36160.8 441.5,-36170.8 448.5,-36170.8"/>
</g>
<!-- layer33_out_proj -->
<g id="node170" class="node">
<title>layer33_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-36056.5 224,-36056.5 224,-35988.5 666,-35988.5 666,-36056.5"/>
<text text-anchor="middle" x="445" y="-36041.3" font-family="Times,serif" font-size="14.00">Layer 33 Output Projection</text>
<text text-anchor="middle" x="445" y="-36026.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-36011.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-35996.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer33_attn_comp&#45;&gt;layer33_out_proj -->
<g id="edge169" class="edge">
<title>layer33_attn_comp&#45;&gt;layer33_out_proj</title>
<path fill="none" stroke="black" d="M445,-36092.38C445,-36084.28 445,-36075.48 445,-36066.97"/>
<polygon fill="black" stroke="black" points="448.5,-36066.8 445,-36056.8 441.5,-36066.8 448.5,-36066.8"/>
</g>
<!-- layer33_gate -->
<g id="node171" class="node">
<title>layer33_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-35952.5 191.3,-35952.5 15.57,-35816.5 698.7,-35816.5 874.43,-35952.5"/>
<text text-anchor="middle" x="445" y="-35903.3" font-family="Times,serif" font-size="14.00">Layer 33 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-35888.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35873.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-35858.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer33_out_proj&#45;&gt;layer33_gate -->
<g id="edge170" class="edge">
<title>layer33_out_proj&#45;&gt;layer33_gate</title>
<path fill="none" stroke="black" d="M445,-35988.23C445,-35980.4 445,-35971.74 445,-35962.85"/>
<polygon fill="black" stroke="black" points="448.5,-35962.76 445,-35952.76 441.5,-35962.76 448.5,-35962.76"/>
</g>
<!-- layer33_moe -->
<g id="node172" class="node">
<title>layer33_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-35780.5 232,-35780.5 232,-35712.5 658,-35712.5 658,-35780.5"/>
<text text-anchor="middle" x="445" y="-35765.3" font-family="Times,serif" font-size="14.00">Layer 33 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-35750.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35735.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-35720.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer33_gate&#45;&gt;layer33_moe -->
<g id="edge171" class="edge">
<title>layer33_gate&#45;&gt;layer33_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-35816.3C445,-35807.54 445,-35798.77 445,-35790.57"/>
<polygon fill="black" stroke="black" points="448.5,-35790.52 445,-35780.52 441.5,-35790.52 448.5,-35790.52"/>
</g>
<!-- layer34_qkv_proj -->
<g id="node173" class="node">
<title>layer34_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-35676.5 218,-35676.5 218,-35608.5 672,-35608.5 672,-35676.5"/>
<text text-anchor="middle" x="445" y="-35661.3" font-family="Times,serif" font-size="14.00">Layer 34 QKV Projection</text>
<text text-anchor="middle" x="445" y="-35646.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35631.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-35616.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer33_moe&#45;&gt;layer34_qkv_proj -->
<g id="edge172" class="edge">
<title>layer33_moe&#45;&gt;layer34_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-35712.38C445,-35704.28 445,-35695.48 445,-35686.97"/>
<polygon fill="black" stroke="black" points="448.5,-35686.8 445,-35676.8 441.5,-35686.8 448.5,-35686.8"/>
</g>
<!-- layer34_attn_comp -->
<g id="node174" class="node">
<title>layer34_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-35572.5 218,-35572.5 218,-35504.5 672,-35504.5 672,-35572.5"/>
<text text-anchor="middle" x="445" y="-35557.3" font-family="Times,serif" font-size="14.00">Layer 34 Attention Computation</text>
<text text-anchor="middle" x="445" y="-35542.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35527.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-35512.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer34_qkv_proj&#45;&gt;layer34_attn_comp -->
<g id="edge173" class="edge">
<title>layer34_qkv_proj&#45;&gt;layer34_attn_comp</title>
<path fill="none" stroke="black" d="M445,-35608.38C445,-35600.28 445,-35591.48 445,-35582.97"/>
<polygon fill="black" stroke="black" points="448.5,-35582.8 445,-35572.8 441.5,-35582.8 448.5,-35582.8"/>
</g>
<!-- layer34_out_proj -->
<g id="node175" class="node">
<title>layer34_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-35468.5 224,-35468.5 224,-35400.5 666,-35400.5 666,-35468.5"/>
<text text-anchor="middle" x="445" y="-35453.3" font-family="Times,serif" font-size="14.00">Layer 34 Output Projection</text>
<text text-anchor="middle" x="445" y="-35438.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35423.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-35408.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer34_attn_comp&#45;&gt;layer34_out_proj -->
<g id="edge174" class="edge">
<title>layer34_attn_comp&#45;&gt;layer34_out_proj</title>
<path fill="none" stroke="black" d="M445,-35504.38C445,-35496.28 445,-35487.48 445,-35478.97"/>
<polygon fill="black" stroke="black" points="448.5,-35478.8 445,-35468.8 441.5,-35478.8 448.5,-35478.8"/>
</g>
<!-- layer34_gate -->
<g id="node176" class="node">
<title>layer34_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-35364.5 191.3,-35364.5 15.57,-35228.5 698.7,-35228.5 874.43,-35364.5"/>
<text text-anchor="middle" x="445" y="-35315.3" font-family="Times,serif" font-size="14.00">Layer 34 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-35300.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35285.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-35270.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer34_out_proj&#45;&gt;layer34_gate -->
<g id="edge175" class="edge">
<title>layer34_out_proj&#45;&gt;layer34_gate</title>
<path fill="none" stroke="black" d="M445,-35400.23C445,-35392.4 445,-35383.74 445,-35374.85"/>
<polygon fill="black" stroke="black" points="448.5,-35374.76 445,-35364.76 441.5,-35374.76 448.5,-35374.76"/>
</g>
<!-- layer34_moe -->
<g id="node177" class="node">
<title>layer34_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-35192.5 232,-35192.5 232,-35124.5 658,-35124.5 658,-35192.5"/>
<text text-anchor="middle" x="445" y="-35177.3" font-family="Times,serif" font-size="14.00">Layer 34 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-35162.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35147.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-35132.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer34_gate&#45;&gt;layer34_moe -->
<g id="edge176" class="edge">
<title>layer34_gate&#45;&gt;layer34_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-35228.3C445,-35219.54 445,-35210.77 445,-35202.57"/>
<polygon fill="black" stroke="black" points="448.5,-35202.52 445,-35192.52 441.5,-35202.52 448.5,-35202.52"/>
</g>
<!-- layer35_qkv_proj -->
<g id="node178" class="node">
<title>layer35_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-35088.5 218,-35088.5 218,-35020.5 672,-35020.5 672,-35088.5"/>
<text text-anchor="middle" x="445" y="-35073.3" font-family="Times,serif" font-size="14.00">Layer 35 QKV Projection</text>
<text text-anchor="middle" x="445" y="-35058.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-35043.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-35028.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer34_moe&#45;&gt;layer35_qkv_proj -->
<g id="edge177" class="edge">
<title>layer34_moe&#45;&gt;layer35_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-35124.38C445,-35116.28 445,-35107.48 445,-35098.97"/>
<polygon fill="black" stroke="black" points="448.5,-35098.8 445,-35088.8 441.5,-35098.8 448.5,-35098.8"/>
</g>
<!-- layer35_attn_comp -->
<g id="node179" class="node">
<title>layer35_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-34984.5 218,-34984.5 218,-34916.5 672,-34916.5 672,-34984.5"/>
<text text-anchor="middle" x="445" y="-34969.3" font-family="Times,serif" font-size="14.00">Layer 35 Attention Computation</text>
<text text-anchor="middle" x="445" y="-34954.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34939.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-34924.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer35_qkv_proj&#45;&gt;layer35_attn_comp -->
<g id="edge178" class="edge">
<title>layer35_qkv_proj&#45;&gt;layer35_attn_comp</title>
<path fill="none" stroke="black" d="M445,-35020.38C445,-35012.28 445,-35003.48 445,-34994.97"/>
<polygon fill="black" stroke="black" points="448.5,-34994.8 445,-34984.8 441.5,-34994.8 448.5,-34994.8"/>
</g>
<!-- layer35_out_proj -->
<g id="node180" class="node">
<title>layer35_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-34880.5 224,-34880.5 224,-34812.5 666,-34812.5 666,-34880.5"/>
<text text-anchor="middle" x="445" y="-34865.3" font-family="Times,serif" font-size="14.00">Layer 35 Output Projection</text>
<text text-anchor="middle" x="445" y="-34850.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34835.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-34820.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer35_attn_comp&#45;&gt;layer35_out_proj -->
<g id="edge179" class="edge">
<title>layer35_attn_comp&#45;&gt;layer35_out_proj</title>
<path fill="none" stroke="black" d="M445,-34916.38C445,-34908.28 445,-34899.48 445,-34890.97"/>
<polygon fill="black" stroke="black" points="448.5,-34890.8 445,-34880.8 441.5,-34890.8 448.5,-34890.8"/>
</g>
<!-- layer35_gate -->
<g id="node181" class="node">
<title>layer35_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-34776.5 191.3,-34776.5 15.57,-34640.5 698.7,-34640.5 874.43,-34776.5"/>
<text text-anchor="middle" x="445" y="-34727.3" font-family="Times,serif" font-size="14.00">Layer 35 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-34712.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34697.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-34682.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer35_out_proj&#45;&gt;layer35_gate -->
<g id="edge180" class="edge">
<title>layer35_out_proj&#45;&gt;layer35_gate</title>
<path fill="none" stroke="black" d="M445,-34812.23C445,-34804.4 445,-34795.74 445,-34786.85"/>
<polygon fill="black" stroke="black" points="448.5,-34786.76 445,-34776.76 441.5,-34786.76 448.5,-34786.76"/>
</g>
<!-- layer35_moe -->
<g id="node182" class="node">
<title>layer35_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-34604.5 232,-34604.5 232,-34536.5 658,-34536.5 658,-34604.5"/>
<text text-anchor="middle" x="445" y="-34589.3" font-family="Times,serif" font-size="14.00">Layer 35 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-34574.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34559.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-34544.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer35_gate&#45;&gt;layer35_moe -->
<g id="edge181" class="edge">
<title>layer35_gate&#45;&gt;layer35_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-34640.3C445,-34631.54 445,-34622.77 445,-34614.57"/>
<polygon fill="black" stroke="black" points="448.5,-34614.52 445,-34604.52 441.5,-34614.52 448.5,-34614.52"/>
</g>
<!-- layer36_qkv_proj -->
<g id="node183" class="node">
<title>layer36_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-34500.5 218,-34500.5 218,-34432.5 672,-34432.5 672,-34500.5"/>
<text text-anchor="middle" x="445" y="-34485.3" font-family="Times,serif" font-size="14.00">Layer 36 QKV Projection</text>
<text text-anchor="middle" x="445" y="-34470.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34455.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-34440.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer35_moe&#45;&gt;layer36_qkv_proj -->
<g id="edge182" class="edge">
<title>layer35_moe&#45;&gt;layer36_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-34536.38C445,-34528.28 445,-34519.48 445,-34510.97"/>
<polygon fill="black" stroke="black" points="448.5,-34510.8 445,-34500.8 441.5,-34510.8 448.5,-34510.8"/>
</g>
<!-- layer36_attn_comp -->
<g id="node184" class="node">
<title>layer36_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-34396.5 218,-34396.5 218,-34328.5 672,-34328.5 672,-34396.5"/>
<text text-anchor="middle" x="445" y="-34381.3" font-family="Times,serif" font-size="14.00">Layer 36 Attention Computation</text>
<text text-anchor="middle" x="445" y="-34366.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34351.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-34336.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer36_qkv_proj&#45;&gt;layer36_attn_comp -->
<g id="edge183" class="edge">
<title>layer36_qkv_proj&#45;&gt;layer36_attn_comp</title>
<path fill="none" stroke="black" d="M445,-34432.38C445,-34424.28 445,-34415.48 445,-34406.97"/>
<polygon fill="black" stroke="black" points="448.5,-34406.8 445,-34396.8 441.5,-34406.8 448.5,-34406.8"/>
</g>
<!-- layer36_out_proj -->
<g id="node185" class="node">
<title>layer36_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-34292.5 224,-34292.5 224,-34224.5 666,-34224.5 666,-34292.5"/>
<text text-anchor="middle" x="445" y="-34277.3" font-family="Times,serif" font-size="14.00">Layer 36 Output Projection</text>
<text text-anchor="middle" x="445" y="-34262.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34247.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-34232.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer36_attn_comp&#45;&gt;layer36_out_proj -->
<g id="edge184" class="edge">
<title>layer36_attn_comp&#45;&gt;layer36_out_proj</title>
<path fill="none" stroke="black" d="M445,-34328.38C445,-34320.28 445,-34311.48 445,-34302.97"/>
<polygon fill="black" stroke="black" points="448.5,-34302.8 445,-34292.8 441.5,-34302.8 448.5,-34302.8"/>
</g>
<!-- layer36_gate -->
<g id="node186" class="node">
<title>layer36_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-34188.5 191.3,-34188.5 15.57,-34052.5 698.7,-34052.5 874.43,-34188.5"/>
<text text-anchor="middle" x="445" y="-34139.3" font-family="Times,serif" font-size="14.00">Layer 36 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-34124.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-34109.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-34094.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer36_out_proj&#45;&gt;layer36_gate -->
<g id="edge185" class="edge">
<title>layer36_out_proj&#45;&gt;layer36_gate</title>
<path fill="none" stroke="black" d="M445,-34224.23C445,-34216.4 445,-34207.74 445,-34198.85"/>
<polygon fill="black" stroke="black" points="448.5,-34198.76 445,-34188.76 441.5,-34198.76 448.5,-34198.76"/>
</g>
<!-- layer36_moe -->
<g id="node187" class="node">
<title>layer36_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-34016.5 232,-34016.5 232,-33948.5 658,-33948.5 658,-34016.5"/>
<text text-anchor="middle" x="445" y="-34001.3" font-family="Times,serif" font-size="14.00">Layer 36 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-33986.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33971.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-33956.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer36_gate&#45;&gt;layer36_moe -->
<g id="edge186" class="edge">
<title>layer36_gate&#45;&gt;layer36_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-34052.3C445,-34043.54 445,-34034.77 445,-34026.57"/>
<polygon fill="black" stroke="black" points="448.5,-34026.52 445,-34016.52 441.5,-34026.52 448.5,-34026.52"/>
</g>
<!-- layer37_qkv_proj -->
<g id="node188" class="node">
<title>layer37_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-33912.5 218,-33912.5 218,-33844.5 672,-33844.5 672,-33912.5"/>
<text text-anchor="middle" x="445" y="-33897.3" font-family="Times,serif" font-size="14.00">Layer 37 QKV Projection</text>
<text text-anchor="middle" x="445" y="-33882.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33867.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-33852.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer36_moe&#45;&gt;layer37_qkv_proj -->
<g id="edge187" class="edge">
<title>layer36_moe&#45;&gt;layer37_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-33948.38C445,-33940.28 445,-33931.48 445,-33922.97"/>
<polygon fill="black" stroke="black" points="448.5,-33922.8 445,-33912.8 441.5,-33922.8 448.5,-33922.8"/>
</g>
<!-- layer37_attn_comp -->
<g id="node189" class="node">
<title>layer37_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-33808.5 218,-33808.5 218,-33740.5 672,-33740.5 672,-33808.5"/>
<text text-anchor="middle" x="445" y="-33793.3" font-family="Times,serif" font-size="14.00">Layer 37 Attention Computation</text>
<text text-anchor="middle" x="445" y="-33778.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33763.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-33748.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer37_qkv_proj&#45;&gt;layer37_attn_comp -->
<g id="edge188" class="edge">
<title>layer37_qkv_proj&#45;&gt;layer37_attn_comp</title>
<path fill="none" stroke="black" d="M445,-33844.38C445,-33836.28 445,-33827.48 445,-33818.97"/>
<polygon fill="black" stroke="black" points="448.5,-33818.8 445,-33808.8 441.5,-33818.8 448.5,-33818.8"/>
</g>
<!-- layer37_out_proj -->
<g id="node190" class="node">
<title>layer37_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-33704.5 224,-33704.5 224,-33636.5 666,-33636.5 666,-33704.5"/>
<text text-anchor="middle" x="445" y="-33689.3" font-family="Times,serif" font-size="14.00">Layer 37 Output Projection</text>
<text text-anchor="middle" x="445" y="-33674.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33659.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-33644.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer37_attn_comp&#45;&gt;layer37_out_proj -->
<g id="edge189" class="edge">
<title>layer37_attn_comp&#45;&gt;layer37_out_proj</title>
<path fill="none" stroke="black" d="M445,-33740.38C445,-33732.28 445,-33723.48 445,-33714.97"/>
<polygon fill="black" stroke="black" points="448.5,-33714.8 445,-33704.8 441.5,-33714.8 448.5,-33714.8"/>
</g>
<!-- layer37_gate -->
<g id="node191" class="node">
<title>layer37_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-33600.5 191.3,-33600.5 15.57,-33464.5 698.7,-33464.5 874.43,-33600.5"/>
<text text-anchor="middle" x="445" y="-33551.3" font-family="Times,serif" font-size="14.00">Layer 37 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-33536.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33521.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-33506.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer37_out_proj&#45;&gt;layer37_gate -->
<g id="edge190" class="edge">
<title>layer37_out_proj&#45;&gt;layer37_gate</title>
<path fill="none" stroke="black" d="M445,-33636.23C445,-33628.4 445,-33619.74 445,-33610.85"/>
<polygon fill="black" stroke="black" points="448.5,-33610.76 445,-33600.76 441.5,-33610.76 448.5,-33610.76"/>
</g>
<!-- layer37_moe -->
<g id="node192" class="node">
<title>layer37_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-33428.5 232,-33428.5 232,-33360.5 658,-33360.5 658,-33428.5"/>
<text text-anchor="middle" x="445" y="-33413.3" font-family="Times,serif" font-size="14.00">Layer 37 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-33398.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33383.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-33368.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer37_gate&#45;&gt;layer37_moe -->
<g id="edge191" class="edge">
<title>layer37_gate&#45;&gt;layer37_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-33464.3C445,-33455.54 445,-33446.77 445,-33438.57"/>
<polygon fill="black" stroke="black" points="448.5,-33438.52 445,-33428.52 441.5,-33438.52 448.5,-33438.52"/>
</g>
<!-- layer38_qkv_proj -->
<g id="node193" class="node">
<title>layer38_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-33324.5 218,-33324.5 218,-33256.5 672,-33256.5 672,-33324.5"/>
<text text-anchor="middle" x="445" y="-33309.3" font-family="Times,serif" font-size="14.00">Layer 38 QKV Projection</text>
<text text-anchor="middle" x="445" y="-33294.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33279.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-33264.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer37_moe&#45;&gt;layer38_qkv_proj -->
<g id="edge192" class="edge">
<title>layer37_moe&#45;&gt;layer38_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-33360.38C445,-33352.28 445,-33343.48 445,-33334.97"/>
<polygon fill="black" stroke="black" points="448.5,-33334.8 445,-33324.8 441.5,-33334.8 448.5,-33334.8"/>
</g>
<!-- layer38_attn_comp -->
<g id="node194" class="node">
<title>layer38_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-33220.5 218,-33220.5 218,-33152.5 672,-33152.5 672,-33220.5"/>
<text text-anchor="middle" x="445" y="-33205.3" font-family="Times,serif" font-size="14.00">Layer 38 Attention Computation</text>
<text text-anchor="middle" x="445" y="-33190.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33175.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-33160.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer38_qkv_proj&#45;&gt;layer38_attn_comp -->
<g id="edge193" class="edge">
<title>layer38_qkv_proj&#45;&gt;layer38_attn_comp</title>
<path fill="none" stroke="black" d="M445,-33256.38C445,-33248.28 445,-33239.48 445,-33230.97"/>
<polygon fill="black" stroke="black" points="448.5,-33230.8 445,-33220.8 441.5,-33230.8 448.5,-33230.8"/>
</g>
<!-- layer38_out_proj -->
<g id="node195" class="node">
<title>layer38_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-33116.5 224,-33116.5 224,-33048.5 666,-33048.5 666,-33116.5"/>
<text text-anchor="middle" x="445" y="-33101.3" font-family="Times,serif" font-size="14.00">Layer 38 Output Projection</text>
<text text-anchor="middle" x="445" y="-33086.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-33071.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-33056.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer38_attn_comp&#45;&gt;layer38_out_proj -->
<g id="edge194" class="edge">
<title>layer38_attn_comp&#45;&gt;layer38_out_proj</title>
<path fill="none" stroke="black" d="M445,-33152.38C445,-33144.28 445,-33135.48 445,-33126.97"/>
<polygon fill="black" stroke="black" points="448.5,-33126.8 445,-33116.8 441.5,-33126.8 448.5,-33126.8"/>
</g>
<!-- layer38_gate -->
<g id="node196" class="node">
<title>layer38_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-33012.5 191.3,-33012.5 15.57,-32876.5 698.7,-32876.5 874.43,-33012.5"/>
<text text-anchor="middle" x="445" y="-32963.3" font-family="Times,serif" font-size="14.00">Layer 38 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-32948.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32933.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-32918.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer38_out_proj&#45;&gt;layer38_gate -->
<g id="edge195" class="edge">
<title>layer38_out_proj&#45;&gt;layer38_gate</title>
<path fill="none" stroke="black" d="M445,-33048.23C445,-33040.4 445,-33031.74 445,-33022.85"/>
<polygon fill="black" stroke="black" points="448.5,-33022.76 445,-33012.76 441.5,-33022.76 448.5,-33022.76"/>
</g>
<!-- layer38_moe -->
<g id="node197" class="node">
<title>layer38_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-32840.5 232,-32840.5 232,-32772.5 658,-32772.5 658,-32840.5"/>
<text text-anchor="middle" x="445" y="-32825.3" font-family="Times,serif" font-size="14.00">Layer 38 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-32810.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-32780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer38_gate&#45;&gt;layer38_moe -->
<g id="edge196" class="edge">
<title>layer38_gate&#45;&gt;layer38_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-32876.3C445,-32867.54 445,-32858.77 445,-32850.57"/>
<polygon fill="black" stroke="black" points="448.5,-32850.52 445,-32840.52 441.5,-32850.52 448.5,-32850.52"/>
</g>
<!-- layer39_qkv_proj -->
<g id="node198" class="node">
<title>layer39_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-32736.5 218,-32736.5 218,-32668.5 672,-32668.5 672,-32736.5"/>
<text text-anchor="middle" x="445" y="-32721.3" font-family="Times,serif" font-size="14.00">Layer 39 QKV Projection</text>
<text text-anchor="middle" x="445" y="-32706.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32691.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-32676.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer38_moe&#45;&gt;layer39_qkv_proj -->
<g id="edge197" class="edge">
<title>layer38_moe&#45;&gt;layer39_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-32772.38C445,-32764.28 445,-32755.48 445,-32746.97"/>
<polygon fill="black" stroke="black" points="448.5,-32746.8 445,-32736.8 441.5,-32746.8 448.5,-32746.8"/>
</g>
<!-- layer39_attn_comp -->
<g id="node199" class="node">
<title>layer39_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-32632.5 218,-32632.5 218,-32564.5 672,-32564.5 672,-32632.5"/>
<text text-anchor="middle" x="445" y="-32617.3" font-family="Times,serif" font-size="14.00">Layer 39 Attention Computation</text>
<text text-anchor="middle" x="445" y="-32602.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32587.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-32572.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer39_qkv_proj&#45;&gt;layer39_attn_comp -->
<g id="edge198" class="edge">
<title>layer39_qkv_proj&#45;&gt;layer39_attn_comp</title>
<path fill="none" stroke="black" d="M445,-32668.38C445,-32660.28 445,-32651.48 445,-32642.97"/>
<polygon fill="black" stroke="black" points="448.5,-32642.8 445,-32632.8 441.5,-32642.8 448.5,-32642.8"/>
</g>
<!-- layer39_out_proj -->
<g id="node200" class="node">
<title>layer39_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-32528.5 224,-32528.5 224,-32460.5 666,-32460.5 666,-32528.5"/>
<text text-anchor="middle" x="445" y="-32513.3" font-family="Times,serif" font-size="14.00">Layer 39 Output Projection</text>
<text text-anchor="middle" x="445" y="-32498.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32483.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-32468.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer39_attn_comp&#45;&gt;layer39_out_proj -->
<g id="edge199" class="edge">
<title>layer39_attn_comp&#45;&gt;layer39_out_proj</title>
<path fill="none" stroke="black" d="M445,-32564.38C445,-32556.28 445,-32547.48 445,-32538.97"/>
<polygon fill="black" stroke="black" points="448.5,-32538.8 445,-32528.8 441.5,-32538.8 448.5,-32538.8"/>
</g>
<!-- layer39_gate -->
<g id="node201" class="node">
<title>layer39_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-32424.5 191.3,-32424.5 15.57,-32288.5 698.7,-32288.5 874.43,-32424.5"/>
<text text-anchor="middle" x="445" y="-32375.3" font-family="Times,serif" font-size="14.00">Layer 39 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-32360.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32345.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-32330.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer39_out_proj&#45;&gt;layer39_gate -->
<g id="edge200" class="edge">
<title>layer39_out_proj&#45;&gt;layer39_gate</title>
<path fill="none" stroke="black" d="M445,-32460.23C445,-32452.4 445,-32443.74 445,-32434.85"/>
<polygon fill="black" stroke="black" points="448.5,-32434.76 445,-32424.76 441.5,-32434.76 448.5,-32434.76"/>
</g>
<!-- layer39_moe -->
<g id="node202" class="node">
<title>layer39_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-32252.5 232,-32252.5 232,-32184.5 658,-32184.5 658,-32252.5"/>
<text text-anchor="middle" x="445" y="-32237.3" font-family="Times,serif" font-size="14.00">Layer 39 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-32222.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32207.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-32192.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer39_gate&#45;&gt;layer39_moe -->
<g id="edge201" class="edge">
<title>layer39_gate&#45;&gt;layer39_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-32288.3C445,-32279.54 445,-32270.77 445,-32262.57"/>
<polygon fill="black" stroke="black" points="448.5,-32262.52 445,-32252.52 441.5,-32262.52 448.5,-32262.52"/>
</g>
<!-- layer40_qkv_proj -->
<g id="node203" class="node">
<title>layer40_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-32148.5 218,-32148.5 218,-32080.5 672,-32080.5 672,-32148.5"/>
<text text-anchor="middle" x="445" y="-32133.3" font-family="Times,serif" font-size="14.00">Layer 40 QKV Projection</text>
<text text-anchor="middle" x="445" y="-32118.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-32103.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-32088.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer39_moe&#45;&gt;layer40_qkv_proj -->
<g id="edge202" class="edge">
<title>layer39_moe&#45;&gt;layer40_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-32184.38C445,-32176.28 445,-32167.48 445,-32158.97"/>
<polygon fill="black" stroke="black" points="448.5,-32158.8 445,-32148.8 441.5,-32158.8 448.5,-32158.8"/>
</g>
<!-- layer40_attn_comp -->
<g id="node204" class="node">
<title>layer40_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-32044.5 218,-32044.5 218,-31976.5 672,-31976.5 672,-32044.5"/>
<text text-anchor="middle" x="445" y="-32029.3" font-family="Times,serif" font-size="14.00">Layer 40 Attention Computation</text>
<text text-anchor="middle" x="445" y="-32014.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31999.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-31984.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer40_qkv_proj&#45;&gt;layer40_attn_comp -->
<g id="edge203" class="edge">
<title>layer40_qkv_proj&#45;&gt;layer40_attn_comp</title>
<path fill="none" stroke="black" d="M445,-32080.38C445,-32072.28 445,-32063.48 445,-32054.97"/>
<polygon fill="black" stroke="black" points="448.5,-32054.8 445,-32044.8 441.5,-32054.8 448.5,-32054.8"/>
</g>
<!-- layer40_out_proj -->
<g id="node205" class="node">
<title>layer40_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-31940.5 224,-31940.5 224,-31872.5 666,-31872.5 666,-31940.5"/>
<text text-anchor="middle" x="445" y="-31925.3" font-family="Times,serif" font-size="14.00">Layer 40 Output Projection</text>
<text text-anchor="middle" x="445" y="-31910.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31895.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-31880.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer40_attn_comp&#45;&gt;layer40_out_proj -->
<g id="edge204" class="edge">
<title>layer40_attn_comp&#45;&gt;layer40_out_proj</title>
<path fill="none" stroke="black" d="M445,-31976.38C445,-31968.28 445,-31959.48 445,-31950.97"/>
<polygon fill="black" stroke="black" points="448.5,-31950.8 445,-31940.8 441.5,-31950.8 448.5,-31950.8"/>
</g>
<!-- layer40_gate -->
<g id="node206" class="node">
<title>layer40_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-31836.5 191.3,-31836.5 15.57,-31700.5 698.7,-31700.5 874.43,-31836.5"/>
<text text-anchor="middle" x="445" y="-31787.3" font-family="Times,serif" font-size="14.00">Layer 40 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-31772.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31757.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-31742.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer40_out_proj&#45;&gt;layer40_gate -->
<g id="edge205" class="edge">
<title>layer40_out_proj&#45;&gt;layer40_gate</title>
<path fill="none" stroke="black" d="M445,-31872.23C445,-31864.4 445,-31855.74 445,-31846.85"/>
<polygon fill="black" stroke="black" points="448.5,-31846.76 445,-31836.76 441.5,-31846.76 448.5,-31846.76"/>
</g>
<!-- layer40_moe -->
<g id="node207" class="node">
<title>layer40_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-31664.5 232,-31664.5 232,-31596.5 658,-31596.5 658,-31664.5"/>
<text text-anchor="middle" x="445" y="-31649.3" font-family="Times,serif" font-size="14.00">Layer 40 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-31634.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31619.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-31604.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer40_gate&#45;&gt;layer40_moe -->
<g id="edge206" class="edge">
<title>layer40_gate&#45;&gt;layer40_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-31700.3C445,-31691.54 445,-31682.77 445,-31674.57"/>
<polygon fill="black" stroke="black" points="448.5,-31674.52 445,-31664.52 441.5,-31674.52 448.5,-31674.52"/>
</g>
<!-- layer41_qkv_proj -->
<g id="node208" class="node">
<title>layer41_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-31560.5 218,-31560.5 218,-31492.5 672,-31492.5 672,-31560.5"/>
<text text-anchor="middle" x="445" y="-31545.3" font-family="Times,serif" font-size="14.00">Layer 41 QKV Projection</text>
<text text-anchor="middle" x="445" y="-31530.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31515.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-31500.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer40_moe&#45;&gt;layer41_qkv_proj -->
<g id="edge207" class="edge">
<title>layer40_moe&#45;&gt;layer41_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-31596.38C445,-31588.28 445,-31579.48 445,-31570.97"/>
<polygon fill="black" stroke="black" points="448.5,-31570.8 445,-31560.8 441.5,-31570.8 448.5,-31570.8"/>
</g>
<!-- layer41_attn_comp -->
<g id="node209" class="node">
<title>layer41_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-31456.5 218,-31456.5 218,-31388.5 672,-31388.5 672,-31456.5"/>
<text text-anchor="middle" x="445" y="-31441.3" font-family="Times,serif" font-size="14.00">Layer 41 Attention Computation</text>
<text text-anchor="middle" x="445" y="-31426.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31411.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-31396.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer41_qkv_proj&#45;&gt;layer41_attn_comp -->
<g id="edge208" class="edge">
<title>layer41_qkv_proj&#45;&gt;layer41_attn_comp</title>
<path fill="none" stroke="black" d="M445,-31492.38C445,-31484.28 445,-31475.48 445,-31466.97"/>
<polygon fill="black" stroke="black" points="448.5,-31466.8 445,-31456.8 441.5,-31466.8 448.5,-31466.8"/>
</g>
<!-- layer41_out_proj -->
<g id="node210" class="node">
<title>layer41_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-31352.5 224,-31352.5 224,-31284.5 666,-31284.5 666,-31352.5"/>
<text text-anchor="middle" x="445" y="-31337.3" font-family="Times,serif" font-size="14.00">Layer 41 Output Projection</text>
<text text-anchor="middle" x="445" y="-31322.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31307.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-31292.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer41_attn_comp&#45;&gt;layer41_out_proj -->
<g id="edge209" class="edge">
<title>layer41_attn_comp&#45;&gt;layer41_out_proj</title>
<path fill="none" stroke="black" d="M445,-31388.38C445,-31380.28 445,-31371.48 445,-31362.97"/>
<polygon fill="black" stroke="black" points="448.5,-31362.8 445,-31352.8 441.5,-31362.8 448.5,-31362.8"/>
</g>
<!-- layer41_gate -->
<g id="node211" class="node">
<title>layer41_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-31248.5 191.3,-31248.5 15.57,-31112.5 698.7,-31112.5 874.43,-31248.5"/>
<text text-anchor="middle" x="445" y="-31199.3" font-family="Times,serif" font-size="14.00">Layer 41 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-31184.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31169.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-31154.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer41_out_proj&#45;&gt;layer41_gate -->
<g id="edge210" class="edge">
<title>layer41_out_proj&#45;&gt;layer41_gate</title>
<path fill="none" stroke="black" d="M445,-31284.23C445,-31276.4 445,-31267.74 445,-31258.85"/>
<polygon fill="black" stroke="black" points="448.5,-31258.76 445,-31248.76 441.5,-31258.76 448.5,-31258.76"/>
</g>
<!-- layer41_moe -->
<g id="node212" class="node">
<title>layer41_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-31076.5 232,-31076.5 232,-31008.5 658,-31008.5 658,-31076.5"/>
<text text-anchor="middle" x="445" y="-31061.3" font-family="Times,serif" font-size="14.00">Layer 41 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-31046.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-31031.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-31016.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer41_gate&#45;&gt;layer41_moe -->
<g id="edge211" class="edge">
<title>layer41_gate&#45;&gt;layer41_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-31112.3C445,-31103.54 445,-31094.77 445,-31086.57"/>
<polygon fill="black" stroke="black" points="448.5,-31086.52 445,-31076.52 441.5,-31086.52 448.5,-31086.52"/>
</g>
<!-- layer42_qkv_proj -->
<g id="node213" class="node">
<title>layer42_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-30972.5 218,-30972.5 218,-30904.5 672,-30904.5 672,-30972.5"/>
<text text-anchor="middle" x="445" y="-30957.3" font-family="Times,serif" font-size="14.00">Layer 42 QKV Projection</text>
<text text-anchor="middle" x="445" y="-30942.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30927.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-30912.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer41_moe&#45;&gt;layer42_qkv_proj -->
<g id="edge212" class="edge">
<title>layer41_moe&#45;&gt;layer42_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-31008.38C445,-31000.28 445,-30991.48 445,-30982.97"/>
<polygon fill="black" stroke="black" points="448.5,-30982.8 445,-30972.8 441.5,-30982.8 448.5,-30982.8"/>
</g>
<!-- layer42_attn_comp -->
<g id="node214" class="node">
<title>layer42_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-30868.5 218,-30868.5 218,-30800.5 672,-30800.5 672,-30868.5"/>
<text text-anchor="middle" x="445" y="-30853.3" font-family="Times,serif" font-size="14.00">Layer 42 Attention Computation</text>
<text text-anchor="middle" x="445" y="-30838.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30823.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-30808.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer42_qkv_proj&#45;&gt;layer42_attn_comp -->
<g id="edge213" class="edge">
<title>layer42_qkv_proj&#45;&gt;layer42_attn_comp</title>
<path fill="none" stroke="black" d="M445,-30904.38C445,-30896.28 445,-30887.48 445,-30878.97"/>
<polygon fill="black" stroke="black" points="448.5,-30878.8 445,-30868.8 441.5,-30878.8 448.5,-30878.8"/>
</g>
<!-- layer42_out_proj -->
<g id="node215" class="node">
<title>layer42_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-30764.5 224,-30764.5 224,-30696.5 666,-30696.5 666,-30764.5"/>
<text text-anchor="middle" x="445" y="-30749.3" font-family="Times,serif" font-size="14.00">Layer 42 Output Projection</text>
<text text-anchor="middle" x="445" y="-30734.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30719.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-30704.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer42_attn_comp&#45;&gt;layer42_out_proj -->
<g id="edge214" class="edge">
<title>layer42_attn_comp&#45;&gt;layer42_out_proj</title>
<path fill="none" stroke="black" d="M445,-30800.38C445,-30792.28 445,-30783.48 445,-30774.97"/>
<polygon fill="black" stroke="black" points="448.5,-30774.8 445,-30764.8 441.5,-30774.8 448.5,-30774.8"/>
</g>
<!-- layer42_gate -->
<g id="node216" class="node">
<title>layer42_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-30660.5 191.3,-30660.5 15.57,-30524.5 698.7,-30524.5 874.43,-30660.5"/>
<text text-anchor="middle" x="445" y="-30611.3" font-family="Times,serif" font-size="14.00">Layer 42 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-30596.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30581.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-30566.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer42_out_proj&#45;&gt;layer42_gate -->
<g id="edge215" class="edge">
<title>layer42_out_proj&#45;&gt;layer42_gate</title>
<path fill="none" stroke="black" d="M445,-30696.23C445,-30688.4 445,-30679.74 445,-30670.85"/>
<polygon fill="black" stroke="black" points="448.5,-30670.76 445,-30660.76 441.5,-30670.76 448.5,-30670.76"/>
</g>
<!-- layer42_moe -->
<g id="node217" class="node">
<title>layer42_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-30488.5 232,-30488.5 232,-30420.5 658,-30420.5 658,-30488.5"/>
<text text-anchor="middle" x="445" y="-30473.3" font-family="Times,serif" font-size="14.00">Layer 42 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-30458.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30443.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-30428.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer42_gate&#45;&gt;layer42_moe -->
<g id="edge216" class="edge">
<title>layer42_gate&#45;&gt;layer42_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-30524.3C445,-30515.54 445,-30506.77 445,-30498.57"/>
<polygon fill="black" stroke="black" points="448.5,-30498.52 445,-30488.52 441.5,-30498.52 448.5,-30498.52"/>
</g>
<!-- layer43_qkv_proj -->
<g id="node218" class="node">
<title>layer43_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-30384.5 218,-30384.5 218,-30316.5 672,-30316.5 672,-30384.5"/>
<text text-anchor="middle" x="445" y="-30369.3" font-family="Times,serif" font-size="14.00">Layer 43 QKV Projection</text>
<text text-anchor="middle" x="445" y="-30354.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30339.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-30324.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer42_moe&#45;&gt;layer43_qkv_proj -->
<g id="edge217" class="edge">
<title>layer42_moe&#45;&gt;layer43_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-30420.38C445,-30412.28 445,-30403.48 445,-30394.97"/>
<polygon fill="black" stroke="black" points="448.5,-30394.8 445,-30384.8 441.5,-30394.8 448.5,-30394.8"/>
</g>
<!-- layer43_attn_comp -->
<g id="node219" class="node">
<title>layer43_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-30280.5 218,-30280.5 218,-30212.5 672,-30212.5 672,-30280.5"/>
<text text-anchor="middle" x="445" y="-30265.3" font-family="Times,serif" font-size="14.00">Layer 43 Attention Computation</text>
<text text-anchor="middle" x="445" y="-30250.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30235.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-30220.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer43_qkv_proj&#45;&gt;layer43_attn_comp -->
<g id="edge218" class="edge">
<title>layer43_qkv_proj&#45;&gt;layer43_attn_comp</title>
<path fill="none" stroke="black" d="M445,-30316.38C445,-30308.28 445,-30299.48 445,-30290.97"/>
<polygon fill="black" stroke="black" points="448.5,-30290.8 445,-30280.8 441.5,-30290.8 448.5,-30290.8"/>
</g>
<!-- layer43_out_proj -->
<g id="node220" class="node">
<title>layer43_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-30176.5 224,-30176.5 224,-30108.5 666,-30108.5 666,-30176.5"/>
<text text-anchor="middle" x="445" y="-30161.3" font-family="Times,serif" font-size="14.00">Layer 43 Output Projection</text>
<text text-anchor="middle" x="445" y="-30146.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-30131.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-30116.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer43_attn_comp&#45;&gt;layer43_out_proj -->
<g id="edge219" class="edge">
<title>layer43_attn_comp&#45;&gt;layer43_out_proj</title>
<path fill="none" stroke="black" d="M445,-30212.38C445,-30204.28 445,-30195.48 445,-30186.97"/>
<polygon fill="black" stroke="black" points="448.5,-30186.8 445,-30176.8 441.5,-30186.8 448.5,-30186.8"/>
</g>
<!-- layer43_gate -->
<g id="node221" class="node">
<title>layer43_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-30072.5 191.3,-30072.5 15.57,-29936.5 698.7,-29936.5 874.43,-30072.5"/>
<text text-anchor="middle" x="445" y="-30023.3" font-family="Times,serif" font-size="14.00">Layer 43 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-30008.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29993.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-29978.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer43_out_proj&#45;&gt;layer43_gate -->
<g id="edge220" class="edge">
<title>layer43_out_proj&#45;&gt;layer43_gate</title>
<path fill="none" stroke="black" d="M445,-30108.23C445,-30100.4 445,-30091.74 445,-30082.85"/>
<polygon fill="black" stroke="black" points="448.5,-30082.76 445,-30072.76 441.5,-30082.76 448.5,-30082.76"/>
</g>
<!-- layer43_moe -->
<g id="node222" class="node">
<title>layer43_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-29900.5 232,-29900.5 232,-29832.5 658,-29832.5 658,-29900.5"/>
<text text-anchor="middle" x="445" y="-29885.3" font-family="Times,serif" font-size="14.00">Layer 43 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-29870.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29855.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-29840.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer43_gate&#45;&gt;layer43_moe -->
<g id="edge221" class="edge">
<title>layer43_gate&#45;&gt;layer43_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-29936.3C445,-29927.54 445,-29918.77 445,-29910.57"/>
<polygon fill="black" stroke="black" points="448.5,-29910.52 445,-29900.52 441.5,-29910.52 448.5,-29910.52"/>
</g>
<!-- layer44_qkv_proj -->
<g id="node223" class="node">
<title>layer44_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-29796.5 218,-29796.5 218,-29728.5 672,-29728.5 672,-29796.5"/>
<text text-anchor="middle" x="445" y="-29781.3" font-family="Times,serif" font-size="14.00">Layer 44 QKV Projection</text>
<text text-anchor="middle" x="445" y="-29766.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29751.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-29736.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer43_moe&#45;&gt;layer44_qkv_proj -->
<g id="edge222" class="edge">
<title>layer43_moe&#45;&gt;layer44_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-29832.38C445,-29824.28 445,-29815.48 445,-29806.97"/>
<polygon fill="black" stroke="black" points="448.5,-29806.8 445,-29796.8 441.5,-29806.8 448.5,-29806.8"/>
</g>
<!-- layer44_attn_comp -->
<g id="node224" class="node">
<title>layer44_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-29692.5 218,-29692.5 218,-29624.5 672,-29624.5 672,-29692.5"/>
<text text-anchor="middle" x="445" y="-29677.3" font-family="Times,serif" font-size="14.00">Layer 44 Attention Computation</text>
<text text-anchor="middle" x="445" y="-29662.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29647.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-29632.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer44_qkv_proj&#45;&gt;layer44_attn_comp -->
<g id="edge223" class="edge">
<title>layer44_qkv_proj&#45;&gt;layer44_attn_comp</title>
<path fill="none" stroke="black" d="M445,-29728.38C445,-29720.28 445,-29711.48 445,-29702.97"/>
<polygon fill="black" stroke="black" points="448.5,-29702.8 445,-29692.8 441.5,-29702.8 448.5,-29702.8"/>
</g>
<!-- layer44_out_proj -->
<g id="node225" class="node">
<title>layer44_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-29588.5 224,-29588.5 224,-29520.5 666,-29520.5 666,-29588.5"/>
<text text-anchor="middle" x="445" y="-29573.3" font-family="Times,serif" font-size="14.00">Layer 44 Output Projection</text>
<text text-anchor="middle" x="445" y="-29558.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29543.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-29528.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer44_attn_comp&#45;&gt;layer44_out_proj -->
<g id="edge224" class="edge">
<title>layer44_attn_comp&#45;&gt;layer44_out_proj</title>
<path fill="none" stroke="black" d="M445,-29624.38C445,-29616.28 445,-29607.48 445,-29598.97"/>
<polygon fill="black" stroke="black" points="448.5,-29598.8 445,-29588.8 441.5,-29598.8 448.5,-29598.8"/>
</g>
<!-- layer44_gate -->
<g id="node226" class="node">
<title>layer44_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-29484.5 191.3,-29484.5 15.57,-29348.5 698.7,-29348.5 874.43,-29484.5"/>
<text text-anchor="middle" x="445" y="-29435.3" font-family="Times,serif" font-size="14.00">Layer 44 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-29420.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29405.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-29390.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer44_out_proj&#45;&gt;layer44_gate -->
<g id="edge225" class="edge">
<title>layer44_out_proj&#45;&gt;layer44_gate</title>
<path fill="none" stroke="black" d="M445,-29520.23C445,-29512.4 445,-29503.74 445,-29494.85"/>
<polygon fill="black" stroke="black" points="448.5,-29494.76 445,-29484.76 441.5,-29494.76 448.5,-29494.76"/>
</g>
<!-- layer44_moe -->
<g id="node227" class="node">
<title>layer44_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-29312.5 232,-29312.5 232,-29244.5 658,-29244.5 658,-29312.5"/>
<text text-anchor="middle" x="445" y="-29297.3" font-family="Times,serif" font-size="14.00">Layer 44 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-29282.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29267.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-29252.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer44_gate&#45;&gt;layer44_moe -->
<g id="edge226" class="edge">
<title>layer44_gate&#45;&gt;layer44_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-29348.3C445,-29339.54 445,-29330.77 445,-29322.57"/>
<polygon fill="black" stroke="black" points="448.5,-29322.52 445,-29312.52 441.5,-29322.52 448.5,-29322.52"/>
</g>
<!-- layer45_qkv_proj -->
<g id="node228" class="node">
<title>layer45_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-29208.5 218,-29208.5 218,-29140.5 672,-29140.5 672,-29208.5"/>
<text text-anchor="middle" x="445" y="-29193.3" font-family="Times,serif" font-size="14.00">Layer 45 QKV Projection</text>
<text text-anchor="middle" x="445" y="-29178.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29163.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-29148.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer44_moe&#45;&gt;layer45_qkv_proj -->
<g id="edge227" class="edge">
<title>layer44_moe&#45;&gt;layer45_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-29244.38C445,-29236.28 445,-29227.48 445,-29218.97"/>
<polygon fill="black" stroke="black" points="448.5,-29218.8 445,-29208.8 441.5,-29218.8 448.5,-29218.8"/>
</g>
<!-- layer45_attn_comp -->
<g id="node229" class="node">
<title>layer45_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-29104.5 218,-29104.5 218,-29036.5 672,-29036.5 672,-29104.5"/>
<text text-anchor="middle" x="445" y="-29089.3" font-family="Times,serif" font-size="14.00">Layer 45 Attention Computation</text>
<text text-anchor="middle" x="445" y="-29074.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-29059.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-29044.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer45_qkv_proj&#45;&gt;layer45_attn_comp -->
<g id="edge228" class="edge">
<title>layer45_qkv_proj&#45;&gt;layer45_attn_comp</title>
<path fill="none" stroke="black" d="M445,-29140.38C445,-29132.28 445,-29123.48 445,-29114.97"/>
<polygon fill="black" stroke="black" points="448.5,-29114.8 445,-29104.8 441.5,-29114.8 448.5,-29114.8"/>
</g>
<!-- layer45_out_proj -->
<g id="node230" class="node">
<title>layer45_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-29000.5 224,-29000.5 224,-28932.5 666,-28932.5 666,-29000.5"/>
<text text-anchor="middle" x="445" y="-28985.3" font-family="Times,serif" font-size="14.00">Layer 45 Output Projection</text>
<text text-anchor="middle" x="445" y="-28970.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28955.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-28940.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer45_attn_comp&#45;&gt;layer45_out_proj -->
<g id="edge229" class="edge">
<title>layer45_attn_comp&#45;&gt;layer45_out_proj</title>
<path fill="none" stroke="black" d="M445,-29036.38C445,-29028.28 445,-29019.48 445,-29010.97"/>
<polygon fill="black" stroke="black" points="448.5,-29010.8 445,-29000.8 441.5,-29010.8 448.5,-29010.8"/>
</g>
<!-- layer45_gate -->
<g id="node231" class="node">
<title>layer45_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-28896.5 191.3,-28896.5 15.57,-28760.5 698.7,-28760.5 874.43,-28896.5"/>
<text text-anchor="middle" x="445" y="-28847.3" font-family="Times,serif" font-size="14.00">Layer 45 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-28832.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28817.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-28802.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer45_out_proj&#45;&gt;layer45_gate -->
<g id="edge230" class="edge">
<title>layer45_out_proj&#45;&gt;layer45_gate</title>
<path fill="none" stroke="black" d="M445,-28932.23C445,-28924.4 445,-28915.74 445,-28906.85"/>
<polygon fill="black" stroke="black" points="448.5,-28906.76 445,-28896.76 441.5,-28906.76 448.5,-28906.76"/>
</g>
<!-- layer45_moe -->
<g id="node232" class="node">
<title>layer45_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-28724.5 232,-28724.5 232,-28656.5 658,-28656.5 658,-28724.5"/>
<text text-anchor="middle" x="445" y="-28709.3" font-family="Times,serif" font-size="14.00">Layer 45 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-28694.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28679.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-28664.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer45_gate&#45;&gt;layer45_moe -->
<g id="edge231" class="edge">
<title>layer45_gate&#45;&gt;layer45_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-28760.3C445,-28751.54 445,-28742.77 445,-28734.57"/>
<polygon fill="black" stroke="black" points="448.5,-28734.52 445,-28724.52 441.5,-28734.52 448.5,-28734.52"/>
</g>
<!-- layer46_qkv_proj -->
<g id="node233" class="node">
<title>layer46_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-28620.5 218,-28620.5 218,-28552.5 672,-28552.5 672,-28620.5"/>
<text text-anchor="middle" x="445" y="-28605.3" font-family="Times,serif" font-size="14.00">Layer 46 QKV Projection</text>
<text text-anchor="middle" x="445" y="-28590.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-28560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer45_moe&#45;&gt;layer46_qkv_proj -->
<g id="edge232" class="edge">
<title>layer45_moe&#45;&gt;layer46_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-28656.38C445,-28648.28 445,-28639.48 445,-28630.97"/>
<polygon fill="black" stroke="black" points="448.5,-28630.8 445,-28620.8 441.5,-28630.8 448.5,-28630.8"/>
</g>
<!-- layer46_attn_comp -->
<g id="node234" class="node">
<title>layer46_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-28516.5 218,-28516.5 218,-28448.5 672,-28448.5 672,-28516.5"/>
<text text-anchor="middle" x="445" y="-28501.3" font-family="Times,serif" font-size="14.00">Layer 46 Attention Computation</text>
<text text-anchor="middle" x="445" y="-28486.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28471.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-28456.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer46_qkv_proj&#45;&gt;layer46_attn_comp -->
<g id="edge233" class="edge">
<title>layer46_qkv_proj&#45;&gt;layer46_attn_comp</title>
<path fill="none" stroke="black" d="M445,-28552.38C445,-28544.28 445,-28535.48 445,-28526.97"/>
<polygon fill="black" stroke="black" points="448.5,-28526.8 445,-28516.8 441.5,-28526.8 448.5,-28526.8"/>
</g>
<!-- layer46_out_proj -->
<g id="node235" class="node">
<title>layer46_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-28412.5 224,-28412.5 224,-28344.5 666,-28344.5 666,-28412.5"/>
<text text-anchor="middle" x="445" y="-28397.3" font-family="Times,serif" font-size="14.00">Layer 46 Output Projection</text>
<text text-anchor="middle" x="445" y="-28382.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28367.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-28352.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer46_attn_comp&#45;&gt;layer46_out_proj -->
<g id="edge234" class="edge">
<title>layer46_attn_comp&#45;&gt;layer46_out_proj</title>
<path fill="none" stroke="black" d="M445,-28448.38C445,-28440.28 445,-28431.48 445,-28422.97"/>
<polygon fill="black" stroke="black" points="448.5,-28422.8 445,-28412.8 441.5,-28422.8 448.5,-28422.8"/>
</g>
<!-- layer46_gate -->
<g id="node236" class="node">
<title>layer46_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-28308.5 191.3,-28308.5 15.57,-28172.5 698.7,-28172.5 874.43,-28308.5"/>
<text text-anchor="middle" x="445" y="-28259.3" font-family="Times,serif" font-size="14.00">Layer 46 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-28244.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28229.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-28214.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer46_out_proj&#45;&gt;layer46_gate -->
<g id="edge235" class="edge">
<title>layer46_out_proj&#45;&gt;layer46_gate</title>
<path fill="none" stroke="black" d="M445,-28344.23C445,-28336.4 445,-28327.74 445,-28318.85"/>
<polygon fill="black" stroke="black" points="448.5,-28318.76 445,-28308.76 441.5,-28318.76 448.5,-28318.76"/>
</g>
<!-- layer46_moe -->
<g id="node237" class="node">
<title>layer46_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-28136.5 232,-28136.5 232,-28068.5 658,-28068.5 658,-28136.5"/>
<text text-anchor="middle" x="445" y="-28121.3" font-family="Times,serif" font-size="14.00">Layer 46 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-28106.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-28091.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-28076.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer46_gate&#45;&gt;layer46_moe -->
<g id="edge236" class="edge">
<title>layer46_gate&#45;&gt;layer46_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-28172.3C445,-28163.54 445,-28154.77 445,-28146.57"/>
<polygon fill="black" stroke="black" points="448.5,-28146.52 445,-28136.52 441.5,-28146.52 448.5,-28146.52"/>
</g>
<!-- layer47_qkv_proj -->
<g id="node238" class="node">
<title>layer47_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="672,-28032.5 218,-28032.5 218,-27964.5 672,-27964.5 672,-28032.5"/>
<text text-anchor="middle" x="445" y="-28017.3" font-family="Times,serif" font-size="14.00">Layer 47 QKV Projection</text>
<text text-anchor="middle" x="445" y="-28002.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-27987.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-27972.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer46_moe&#45;&gt;layer47_qkv_proj -->
<g id="edge237" class="edge">
<title>layer46_moe&#45;&gt;layer47_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-28068.38C445,-28060.28 445,-28051.48 445,-28042.97"/>
<polygon fill="black" stroke="black" points="448.5,-28042.8 445,-28032.8 441.5,-28042.8 448.5,-28042.8"/>
</g>
<!-- layer47_attn_comp -->
<g id="node239" class="node">
<title>layer47_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="672,-27928.5 218,-27928.5 218,-27860.5 672,-27860.5 672,-27928.5"/>
<text text-anchor="middle" x="445" y="-27913.3" font-family="Times,serif" font-size="14.00">Layer 47 Attention Computation</text>
<text text-anchor="middle" x="445" y="-27898.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-27883.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-27868.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer47_qkv_proj&#45;&gt;layer47_attn_comp -->
<g id="edge238" class="edge">
<title>layer47_qkv_proj&#45;&gt;layer47_attn_comp</title>
<path fill="none" stroke="black" d="M445,-27964.38C445,-27956.28 445,-27947.48 445,-27938.97"/>
<polygon fill="black" stroke="black" points="448.5,-27938.8 445,-27928.8 441.5,-27938.8 448.5,-27938.8"/>
</g>
<!-- layer47_out_proj -->
<g id="node240" class="node">
<title>layer47_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="666,-27824.5 224,-27824.5 224,-27756.5 666,-27756.5 666,-27824.5"/>
<text text-anchor="middle" x="445" y="-27809.3" font-family="Times,serif" font-size="14.00">Layer 47 Output Projection</text>
<text text-anchor="middle" x="445" y="-27794.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-27779.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-27764.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer47_attn_comp&#45;&gt;layer47_out_proj -->
<g id="edge239" class="edge">
<title>layer47_attn_comp&#45;&gt;layer47_out_proj</title>
<path fill="none" stroke="black" d="M445,-27860.38C445,-27852.28 445,-27843.48 445,-27834.97"/>
<polygon fill="black" stroke="black" points="448.5,-27834.8 445,-27824.8 441.5,-27834.8 448.5,-27834.8"/>
</g>
<!-- layer47_gate -->
<g id="node241" class="node">
<title>layer47_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-27720.5 191.3,-27720.5 15.57,-27584.5 698.7,-27584.5 874.43,-27720.5"/>
<text text-anchor="middle" x="445" y="-27671.3" font-family="Times,serif" font-size="14.00">Layer 47 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-27656.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-27641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-27626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer47_out_proj&#45;&gt;layer47_gate -->
<g id="edge240" class="edge">
<title>layer47_out_proj&#45;&gt;layer47_gate</title>
<path fill="none" stroke="black" d="M445,-27756.23C445,-27748.4 445,-27739.74 445,-27730.85"/>
<polygon fill="black" stroke="black" points="448.5,-27730.76 445,-27720.76 441.5,-27730.76 448.5,-27730.76"/>
</g>
<!-- layer47_moe -->
<g id="node242" class="node">
<title>layer47_moe</title>
<polygon fill="lightgreen" stroke="black" points="658,-27548.5 232,-27548.5 232,-27480.5 658,-27480.5 658,-27548.5"/>
<text text-anchor="middle" x="445" y="-27533.3" font-family="Times,serif" font-size="14.00">Layer 47 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-27518.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="445" y="-27503.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-27488.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer47_gate&#45;&gt;layer47_moe -->
<g id="edge241" class="edge">
<title>layer47_gate&#45;&gt;layer47_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-27584.3C445,-27575.54 445,-27566.77 445,-27558.57"/>
<polygon fill="black" stroke="black" points="448.5,-27558.52 445,-27548.52 441.5,-27558.52 448.5,-27558.52"/>
</g>
<!-- comm_1_2 -->
<g id="node243" class="node">
<title>comm_1_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="445" cy="-27396.42" rx="301.46" ry="48.17"/>
<text text-anchor="middle" x="445" y="-27415.22" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="445" y="-27400.22" font-family="Times,serif" font-size="14.00">GPUs: 9&#45;17  18&#45;26</text>
<text text-anchor="middle" x="445" y="-27385.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-27370.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer47_moe&#45;&gt;comm_1_2 -->
<g id="edge242" class="edge">
<title>layer47_moe&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M445,-27480.23C445,-27472.24 445,-27463.48 445,-27454.73"/>
<polygon fill="black" stroke="black" points="448.5,-27454.53 445,-27444.53 441.5,-27454.53 448.5,-27454.53"/>
</g>
<!-- layer48_qkv_proj -->
<g id="node244" class="node">
<title>layer48_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-27294.33 218,-27294.33 218,-27226.33 672,-27226.33 672,-27294.33"/>
<text text-anchor="middle" x="445" y="-27279.13" font-family="Times,serif" font-size="14.00">Layer 48 QKV Projection</text>
<text text-anchor="middle" x="445" y="-27264.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-27249.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-27234.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- comm_1_2&#45;&gt;layer48_qkv_proj -->
<g id="edge243" class="edge">
<title>comm_1_2&#45;&gt;layer48_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-27348.14C445,-27334.08 445,-27318.75 445,-27304.94"/>
<polygon fill="black" stroke="black" points="448.5,-27304.72 445,-27294.72 441.5,-27304.72 448.5,-27304.72"/>
</g>
<!-- layer48_attn_comp -->
<g id="node245" class="node">
<title>layer48_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-27190.33 218,-27190.33 218,-27122.33 672,-27122.33 672,-27190.33"/>
<text text-anchor="middle" x="445" y="-27175.13" font-family="Times,serif" font-size="14.00">Layer 48 Attention Computation</text>
<text text-anchor="middle" x="445" y="-27160.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-27145.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-27130.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer48_qkv_proj&#45;&gt;layer48_attn_comp -->
<g id="edge244" class="edge">
<title>layer48_qkv_proj&#45;&gt;layer48_attn_comp</title>
<path fill="none" stroke="black" d="M445,-27226.22C445,-27218.11 445,-27209.32 445,-27200.81"/>
<polygon fill="black" stroke="black" points="448.5,-27200.63 445,-27190.63 441.5,-27200.63 448.5,-27200.63"/>
</g>
<!-- layer48_out_proj -->
<g id="node246" class="node">
<title>layer48_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-27086.33 224,-27086.33 224,-27018.33 666,-27018.33 666,-27086.33"/>
<text text-anchor="middle" x="445" y="-27071.13" font-family="Times,serif" font-size="14.00">Layer 48 Output Projection</text>
<text text-anchor="middle" x="445" y="-27056.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-27041.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-27026.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer48_attn_comp&#45;&gt;layer48_out_proj -->
<g id="edge245" class="edge">
<title>layer48_attn_comp&#45;&gt;layer48_out_proj</title>
<path fill="none" stroke="black" d="M445,-27122.22C445,-27114.11 445,-27105.32 445,-27096.81"/>
<polygon fill="black" stroke="black" points="448.5,-27096.63 445,-27086.63 441.5,-27096.63 448.5,-27096.63"/>
</g>
<!-- layer48_gate -->
<g id="node247" class="node">
<title>layer48_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-26982.33 191.3,-26982.33 15.57,-26846.33 698.7,-26846.33 874.43,-26982.33"/>
<text text-anchor="middle" x="445" y="-26933.13" font-family="Times,serif" font-size="14.00">Layer 48 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-26918.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26903.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-26888.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer48_out_proj&#45;&gt;layer48_gate -->
<g id="edge246" class="edge">
<title>layer48_out_proj&#45;&gt;layer48_gate</title>
<path fill="none" stroke="black" d="M445,-27018.06C445,-27010.24 445,-27001.57 445,-26992.69"/>
<polygon fill="black" stroke="black" points="448.5,-26992.6 445,-26982.6 441.5,-26992.6 448.5,-26992.6"/>
</g>
<!-- layer48_moe -->
<g id="node248" class="node">
<title>layer48_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-26810.33 232,-26810.33 232,-26742.33 658,-26742.33 658,-26810.33"/>
<text text-anchor="middle" x="445" y="-26795.13" font-family="Times,serif" font-size="14.00">Layer 48 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-26780.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26765.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-26750.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer48_gate&#45;&gt;layer48_moe -->
<g id="edge247" class="edge">
<title>layer48_gate&#45;&gt;layer48_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-26846.13C445,-26837.38 445,-26828.61 445,-26820.4"/>
<polygon fill="black" stroke="black" points="448.5,-26820.35 445,-26810.35 441.5,-26820.35 448.5,-26820.35"/>
</g>
<!-- layer49_qkv_proj -->
<g id="node249" class="node">
<title>layer49_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-26706.33 218,-26706.33 218,-26638.33 672,-26638.33 672,-26706.33"/>
<text text-anchor="middle" x="445" y="-26691.13" font-family="Times,serif" font-size="14.00">Layer 49 QKV Projection</text>
<text text-anchor="middle" x="445" y="-26676.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26661.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-26646.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer48_moe&#45;&gt;layer49_qkv_proj -->
<g id="edge248" class="edge">
<title>layer48_moe&#45;&gt;layer49_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-26742.22C445,-26734.11 445,-26725.32 445,-26716.81"/>
<polygon fill="black" stroke="black" points="448.5,-26716.63 445,-26706.63 441.5,-26716.63 448.5,-26716.63"/>
</g>
<!-- layer49_attn_comp -->
<g id="node250" class="node">
<title>layer49_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-26602.33 218,-26602.33 218,-26534.33 672,-26534.33 672,-26602.33"/>
<text text-anchor="middle" x="445" y="-26587.13" font-family="Times,serif" font-size="14.00">Layer 49 Attention Computation</text>
<text text-anchor="middle" x="445" y="-26572.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26557.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-26542.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer49_qkv_proj&#45;&gt;layer49_attn_comp -->
<g id="edge249" class="edge">
<title>layer49_qkv_proj&#45;&gt;layer49_attn_comp</title>
<path fill="none" stroke="black" d="M445,-26638.22C445,-26630.11 445,-26621.32 445,-26612.81"/>
<polygon fill="black" stroke="black" points="448.5,-26612.63 445,-26602.63 441.5,-26612.63 448.5,-26612.63"/>
</g>
<!-- layer49_out_proj -->
<g id="node251" class="node">
<title>layer49_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-26498.33 224,-26498.33 224,-26430.33 666,-26430.33 666,-26498.33"/>
<text text-anchor="middle" x="445" y="-26483.13" font-family="Times,serif" font-size="14.00">Layer 49 Output Projection</text>
<text text-anchor="middle" x="445" y="-26468.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26453.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-26438.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer49_attn_comp&#45;&gt;layer49_out_proj -->
<g id="edge250" class="edge">
<title>layer49_attn_comp&#45;&gt;layer49_out_proj</title>
<path fill="none" stroke="black" d="M445,-26534.22C445,-26526.11 445,-26517.32 445,-26508.81"/>
<polygon fill="black" stroke="black" points="448.5,-26508.63 445,-26498.63 441.5,-26508.63 448.5,-26508.63"/>
</g>
<!-- layer49_gate -->
<g id="node252" class="node">
<title>layer49_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-26394.33 191.3,-26394.33 15.57,-26258.33 698.7,-26258.33 874.43,-26394.33"/>
<text text-anchor="middle" x="445" y="-26345.13" font-family="Times,serif" font-size="14.00">Layer 49 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-26330.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26315.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-26300.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer49_out_proj&#45;&gt;layer49_gate -->
<g id="edge251" class="edge">
<title>layer49_out_proj&#45;&gt;layer49_gate</title>
<path fill="none" stroke="black" d="M445,-26430.06C445,-26422.24 445,-26413.57 445,-26404.69"/>
<polygon fill="black" stroke="black" points="448.5,-26404.6 445,-26394.6 441.5,-26404.6 448.5,-26404.6"/>
</g>
<!-- layer49_moe -->
<g id="node253" class="node">
<title>layer49_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-26222.33 232,-26222.33 232,-26154.33 658,-26154.33 658,-26222.33"/>
<text text-anchor="middle" x="445" y="-26207.13" font-family="Times,serif" font-size="14.00">Layer 49 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-26192.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26177.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-26162.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer49_gate&#45;&gt;layer49_moe -->
<g id="edge252" class="edge">
<title>layer49_gate&#45;&gt;layer49_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-26258.13C445,-26249.38 445,-26240.61 445,-26232.4"/>
<polygon fill="black" stroke="black" points="448.5,-26232.35 445,-26222.35 441.5,-26232.35 448.5,-26232.35"/>
</g>
<!-- layer50_qkv_proj -->
<g id="node254" class="node">
<title>layer50_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-26118.33 218,-26118.33 218,-26050.33 672,-26050.33 672,-26118.33"/>
<text text-anchor="middle" x="445" y="-26103.13" font-family="Times,serif" font-size="14.00">Layer 50 QKV Projection</text>
<text text-anchor="middle" x="445" y="-26088.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-26073.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-26058.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer49_moe&#45;&gt;layer50_qkv_proj -->
<g id="edge253" class="edge">
<title>layer49_moe&#45;&gt;layer50_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-26154.22C445,-26146.11 445,-26137.32 445,-26128.81"/>
<polygon fill="black" stroke="black" points="448.5,-26128.63 445,-26118.63 441.5,-26128.63 448.5,-26128.63"/>
</g>
<!-- layer50_attn_comp -->
<g id="node255" class="node">
<title>layer50_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-26014.33 218,-26014.33 218,-25946.33 672,-25946.33 672,-26014.33"/>
<text text-anchor="middle" x="445" y="-25999.13" font-family="Times,serif" font-size="14.00">Layer 50 Attention Computation</text>
<text text-anchor="middle" x="445" y="-25984.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25969.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-25954.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer50_qkv_proj&#45;&gt;layer50_attn_comp -->
<g id="edge254" class="edge">
<title>layer50_qkv_proj&#45;&gt;layer50_attn_comp</title>
<path fill="none" stroke="black" d="M445,-26050.22C445,-26042.11 445,-26033.32 445,-26024.81"/>
<polygon fill="black" stroke="black" points="448.5,-26024.63 445,-26014.63 441.5,-26024.63 448.5,-26024.63"/>
</g>
<!-- layer50_out_proj -->
<g id="node256" class="node">
<title>layer50_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-25910.33 224,-25910.33 224,-25842.33 666,-25842.33 666,-25910.33"/>
<text text-anchor="middle" x="445" y="-25895.13" font-family="Times,serif" font-size="14.00">Layer 50 Output Projection</text>
<text text-anchor="middle" x="445" y="-25880.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25865.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-25850.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer50_attn_comp&#45;&gt;layer50_out_proj -->
<g id="edge255" class="edge">
<title>layer50_attn_comp&#45;&gt;layer50_out_proj</title>
<path fill="none" stroke="black" d="M445,-25946.22C445,-25938.11 445,-25929.32 445,-25920.81"/>
<polygon fill="black" stroke="black" points="448.5,-25920.63 445,-25910.63 441.5,-25920.63 448.5,-25920.63"/>
</g>
<!-- layer50_gate -->
<g id="node257" class="node">
<title>layer50_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-25806.33 191.3,-25806.33 15.57,-25670.33 698.7,-25670.33 874.43,-25806.33"/>
<text text-anchor="middle" x="445" y="-25757.13" font-family="Times,serif" font-size="14.00">Layer 50 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-25742.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25727.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-25712.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer50_out_proj&#45;&gt;layer50_gate -->
<g id="edge256" class="edge">
<title>layer50_out_proj&#45;&gt;layer50_gate</title>
<path fill="none" stroke="black" d="M445,-25842.06C445,-25834.24 445,-25825.57 445,-25816.69"/>
<polygon fill="black" stroke="black" points="448.5,-25816.6 445,-25806.6 441.5,-25816.6 448.5,-25816.6"/>
</g>
<!-- layer50_moe -->
<g id="node258" class="node">
<title>layer50_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-25634.33 232,-25634.33 232,-25566.33 658,-25566.33 658,-25634.33"/>
<text text-anchor="middle" x="445" y="-25619.13" font-family="Times,serif" font-size="14.00">Layer 50 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-25604.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25589.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-25574.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer50_gate&#45;&gt;layer50_moe -->
<g id="edge257" class="edge">
<title>layer50_gate&#45;&gt;layer50_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-25670.13C445,-25661.38 445,-25652.61 445,-25644.4"/>
<polygon fill="black" stroke="black" points="448.5,-25644.35 445,-25634.35 441.5,-25644.35 448.5,-25644.35"/>
</g>
<!-- layer51_qkv_proj -->
<g id="node259" class="node">
<title>layer51_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-25530.33 218,-25530.33 218,-25462.33 672,-25462.33 672,-25530.33"/>
<text text-anchor="middle" x="445" y="-25515.13" font-family="Times,serif" font-size="14.00">Layer 51 QKV Projection</text>
<text text-anchor="middle" x="445" y="-25500.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25485.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-25470.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer50_moe&#45;&gt;layer51_qkv_proj -->
<g id="edge258" class="edge">
<title>layer50_moe&#45;&gt;layer51_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-25566.22C445,-25558.11 445,-25549.32 445,-25540.81"/>
<polygon fill="black" stroke="black" points="448.5,-25540.63 445,-25530.63 441.5,-25540.63 448.5,-25540.63"/>
</g>
<!-- layer51_attn_comp -->
<g id="node260" class="node">
<title>layer51_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-25426.33 218,-25426.33 218,-25358.33 672,-25358.33 672,-25426.33"/>
<text text-anchor="middle" x="445" y="-25411.13" font-family="Times,serif" font-size="14.00">Layer 51 Attention Computation</text>
<text text-anchor="middle" x="445" y="-25396.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25381.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-25366.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer51_qkv_proj&#45;&gt;layer51_attn_comp -->
<g id="edge259" class="edge">
<title>layer51_qkv_proj&#45;&gt;layer51_attn_comp</title>
<path fill="none" stroke="black" d="M445,-25462.22C445,-25454.11 445,-25445.32 445,-25436.81"/>
<polygon fill="black" stroke="black" points="448.5,-25436.63 445,-25426.63 441.5,-25436.63 448.5,-25436.63"/>
</g>
<!-- layer51_out_proj -->
<g id="node261" class="node">
<title>layer51_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-25322.33 224,-25322.33 224,-25254.33 666,-25254.33 666,-25322.33"/>
<text text-anchor="middle" x="445" y="-25307.13" font-family="Times,serif" font-size="14.00">Layer 51 Output Projection</text>
<text text-anchor="middle" x="445" y="-25292.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25277.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-25262.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer51_attn_comp&#45;&gt;layer51_out_proj -->
<g id="edge260" class="edge">
<title>layer51_attn_comp&#45;&gt;layer51_out_proj</title>
<path fill="none" stroke="black" d="M445,-25358.22C445,-25350.11 445,-25341.32 445,-25332.81"/>
<polygon fill="black" stroke="black" points="448.5,-25332.63 445,-25322.63 441.5,-25332.63 448.5,-25332.63"/>
</g>
<!-- layer51_gate -->
<g id="node262" class="node">
<title>layer51_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-25218.33 191.3,-25218.33 15.57,-25082.33 698.7,-25082.33 874.43,-25218.33"/>
<text text-anchor="middle" x="445" y="-25169.13" font-family="Times,serif" font-size="14.00">Layer 51 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-25154.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25139.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-25124.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer51_out_proj&#45;&gt;layer51_gate -->
<g id="edge261" class="edge">
<title>layer51_out_proj&#45;&gt;layer51_gate</title>
<path fill="none" stroke="black" d="M445,-25254.06C445,-25246.24 445,-25237.57 445,-25228.69"/>
<polygon fill="black" stroke="black" points="448.5,-25228.6 445,-25218.6 441.5,-25228.6 448.5,-25228.6"/>
</g>
<!-- layer51_moe -->
<g id="node263" class="node">
<title>layer51_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-25046.33 232,-25046.33 232,-24978.33 658,-24978.33 658,-25046.33"/>
<text text-anchor="middle" x="445" y="-25031.13" font-family="Times,serif" font-size="14.00">Layer 51 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-25016.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-25001.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-24986.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer51_gate&#45;&gt;layer51_moe -->
<g id="edge262" class="edge">
<title>layer51_gate&#45;&gt;layer51_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-25082.13C445,-25073.38 445,-25064.61 445,-25056.4"/>
<polygon fill="black" stroke="black" points="448.5,-25056.35 445,-25046.35 441.5,-25056.35 448.5,-25056.35"/>
</g>
<!-- layer52_qkv_proj -->
<g id="node264" class="node">
<title>layer52_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-24942.33 218,-24942.33 218,-24874.33 672,-24874.33 672,-24942.33"/>
<text text-anchor="middle" x="445" y="-24927.13" font-family="Times,serif" font-size="14.00">Layer 52 QKV Projection</text>
<text text-anchor="middle" x="445" y="-24912.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24897.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-24882.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer51_moe&#45;&gt;layer52_qkv_proj -->
<g id="edge263" class="edge">
<title>layer51_moe&#45;&gt;layer52_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-24978.22C445,-24970.11 445,-24961.32 445,-24952.81"/>
<polygon fill="black" stroke="black" points="448.5,-24952.63 445,-24942.63 441.5,-24952.63 448.5,-24952.63"/>
</g>
<!-- layer52_attn_comp -->
<g id="node265" class="node">
<title>layer52_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-24838.33 218,-24838.33 218,-24770.33 672,-24770.33 672,-24838.33"/>
<text text-anchor="middle" x="445" y="-24823.13" font-family="Times,serif" font-size="14.00">Layer 52 Attention Computation</text>
<text text-anchor="middle" x="445" y="-24808.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24793.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-24778.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer52_qkv_proj&#45;&gt;layer52_attn_comp -->
<g id="edge264" class="edge">
<title>layer52_qkv_proj&#45;&gt;layer52_attn_comp</title>
<path fill="none" stroke="black" d="M445,-24874.22C445,-24866.11 445,-24857.32 445,-24848.81"/>
<polygon fill="black" stroke="black" points="448.5,-24848.63 445,-24838.63 441.5,-24848.63 448.5,-24848.63"/>
</g>
<!-- layer52_out_proj -->
<g id="node266" class="node">
<title>layer52_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-24734.33 224,-24734.33 224,-24666.33 666,-24666.33 666,-24734.33"/>
<text text-anchor="middle" x="445" y="-24719.13" font-family="Times,serif" font-size="14.00">Layer 52 Output Projection</text>
<text text-anchor="middle" x="445" y="-24704.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24689.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-24674.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer52_attn_comp&#45;&gt;layer52_out_proj -->
<g id="edge265" class="edge">
<title>layer52_attn_comp&#45;&gt;layer52_out_proj</title>
<path fill="none" stroke="black" d="M445,-24770.22C445,-24762.11 445,-24753.32 445,-24744.81"/>
<polygon fill="black" stroke="black" points="448.5,-24744.63 445,-24734.63 441.5,-24744.63 448.5,-24744.63"/>
</g>
<!-- layer52_gate -->
<g id="node267" class="node">
<title>layer52_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-24630.33 191.3,-24630.33 15.57,-24494.33 698.7,-24494.33 874.43,-24630.33"/>
<text text-anchor="middle" x="445" y="-24581.13" font-family="Times,serif" font-size="14.00">Layer 52 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-24566.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24551.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-24536.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer52_out_proj&#45;&gt;layer52_gate -->
<g id="edge266" class="edge">
<title>layer52_out_proj&#45;&gt;layer52_gate</title>
<path fill="none" stroke="black" d="M445,-24666.06C445,-24658.24 445,-24649.57 445,-24640.69"/>
<polygon fill="black" stroke="black" points="448.5,-24640.6 445,-24630.6 441.5,-24640.6 448.5,-24640.6"/>
</g>
<!-- layer52_moe -->
<g id="node268" class="node">
<title>layer52_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-24458.33 232,-24458.33 232,-24390.33 658,-24390.33 658,-24458.33"/>
<text text-anchor="middle" x="445" y="-24443.13" font-family="Times,serif" font-size="14.00">Layer 52 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-24428.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24413.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-24398.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer52_gate&#45;&gt;layer52_moe -->
<g id="edge267" class="edge">
<title>layer52_gate&#45;&gt;layer52_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-24494.13C445,-24485.38 445,-24476.61 445,-24468.4"/>
<polygon fill="black" stroke="black" points="448.5,-24468.35 445,-24458.35 441.5,-24468.35 448.5,-24468.35"/>
</g>
<!-- layer53_qkv_proj -->
<g id="node269" class="node">
<title>layer53_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-24354.33 218,-24354.33 218,-24286.33 672,-24286.33 672,-24354.33"/>
<text text-anchor="middle" x="445" y="-24339.13" font-family="Times,serif" font-size="14.00">Layer 53 QKV Projection</text>
<text text-anchor="middle" x="445" y="-24324.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24309.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-24294.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer52_moe&#45;&gt;layer53_qkv_proj -->
<g id="edge268" class="edge">
<title>layer52_moe&#45;&gt;layer53_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-24390.22C445,-24382.11 445,-24373.32 445,-24364.81"/>
<polygon fill="black" stroke="black" points="448.5,-24364.63 445,-24354.63 441.5,-24364.63 448.5,-24364.63"/>
</g>
<!-- layer53_attn_comp -->
<g id="node270" class="node">
<title>layer53_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-24250.33 218,-24250.33 218,-24182.33 672,-24182.33 672,-24250.33"/>
<text text-anchor="middle" x="445" y="-24235.13" font-family="Times,serif" font-size="14.00">Layer 53 Attention Computation</text>
<text text-anchor="middle" x="445" y="-24220.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24205.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-24190.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer53_qkv_proj&#45;&gt;layer53_attn_comp -->
<g id="edge269" class="edge">
<title>layer53_qkv_proj&#45;&gt;layer53_attn_comp</title>
<path fill="none" stroke="black" d="M445,-24286.22C445,-24278.11 445,-24269.32 445,-24260.81"/>
<polygon fill="black" stroke="black" points="448.5,-24260.63 445,-24250.63 441.5,-24260.63 448.5,-24260.63"/>
</g>
<!-- layer53_out_proj -->
<g id="node271" class="node">
<title>layer53_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-24146.33 224,-24146.33 224,-24078.33 666,-24078.33 666,-24146.33"/>
<text text-anchor="middle" x="445" y="-24131.13" font-family="Times,serif" font-size="14.00">Layer 53 Output Projection</text>
<text text-anchor="middle" x="445" y="-24116.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-24101.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-24086.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer53_attn_comp&#45;&gt;layer53_out_proj -->
<g id="edge270" class="edge">
<title>layer53_attn_comp&#45;&gt;layer53_out_proj</title>
<path fill="none" stroke="black" d="M445,-24182.22C445,-24174.11 445,-24165.32 445,-24156.81"/>
<polygon fill="black" stroke="black" points="448.5,-24156.63 445,-24146.63 441.5,-24156.63 448.5,-24156.63"/>
</g>
<!-- layer53_gate -->
<g id="node272" class="node">
<title>layer53_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-24042.33 191.3,-24042.33 15.57,-23906.33 698.7,-23906.33 874.43,-24042.33"/>
<text text-anchor="middle" x="445" y="-23993.13" font-family="Times,serif" font-size="14.00">Layer 53 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-23978.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23963.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-23948.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer53_out_proj&#45;&gt;layer53_gate -->
<g id="edge271" class="edge">
<title>layer53_out_proj&#45;&gt;layer53_gate</title>
<path fill="none" stroke="black" d="M445,-24078.06C445,-24070.24 445,-24061.57 445,-24052.69"/>
<polygon fill="black" stroke="black" points="448.5,-24052.6 445,-24042.6 441.5,-24052.6 448.5,-24052.6"/>
</g>
<!-- layer53_moe -->
<g id="node273" class="node">
<title>layer53_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-23870.33 232,-23870.33 232,-23802.33 658,-23802.33 658,-23870.33"/>
<text text-anchor="middle" x="445" y="-23855.13" font-family="Times,serif" font-size="14.00">Layer 53 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-23840.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23825.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-23810.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer53_gate&#45;&gt;layer53_moe -->
<g id="edge272" class="edge">
<title>layer53_gate&#45;&gt;layer53_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-23906.13C445,-23897.38 445,-23888.61 445,-23880.4"/>
<polygon fill="black" stroke="black" points="448.5,-23880.35 445,-23870.35 441.5,-23880.35 448.5,-23880.35"/>
</g>
<!-- layer54_qkv_proj -->
<g id="node274" class="node">
<title>layer54_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-23766.33 218,-23766.33 218,-23698.33 672,-23698.33 672,-23766.33"/>
<text text-anchor="middle" x="445" y="-23751.13" font-family="Times,serif" font-size="14.00">Layer 54 QKV Projection</text>
<text text-anchor="middle" x="445" y="-23736.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23721.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-23706.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer53_moe&#45;&gt;layer54_qkv_proj -->
<g id="edge273" class="edge">
<title>layer53_moe&#45;&gt;layer54_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-23802.22C445,-23794.11 445,-23785.32 445,-23776.81"/>
<polygon fill="black" stroke="black" points="448.5,-23776.63 445,-23766.63 441.5,-23776.63 448.5,-23776.63"/>
</g>
<!-- layer54_attn_comp -->
<g id="node275" class="node">
<title>layer54_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-23662.33 218,-23662.33 218,-23594.33 672,-23594.33 672,-23662.33"/>
<text text-anchor="middle" x="445" y="-23647.13" font-family="Times,serif" font-size="14.00">Layer 54 Attention Computation</text>
<text text-anchor="middle" x="445" y="-23632.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23617.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-23602.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer54_qkv_proj&#45;&gt;layer54_attn_comp -->
<g id="edge274" class="edge">
<title>layer54_qkv_proj&#45;&gt;layer54_attn_comp</title>
<path fill="none" stroke="black" d="M445,-23698.22C445,-23690.11 445,-23681.32 445,-23672.81"/>
<polygon fill="black" stroke="black" points="448.5,-23672.63 445,-23662.63 441.5,-23672.63 448.5,-23672.63"/>
</g>
<!-- layer54_out_proj -->
<g id="node276" class="node">
<title>layer54_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-23558.33 224,-23558.33 224,-23490.33 666,-23490.33 666,-23558.33"/>
<text text-anchor="middle" x="445" y="-23543.13" font-family="Times,serif" font-size="14.00">Layer 54 Output Projection</text>
<text text-anchor="middle" x="445" y="-23528.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23513.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-23498.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer54_attn_comp&#45;&gt;layer54_out_proj -->
<g id="edge275" class="edge">
<title>layer54_attn_comp&#45;&gt;layer54_out_proj</title>
<path fill="none" stroke="black" d="M445,-23594.22C445,-23586.11 445,-23577.32 445,-23568.81"/>
<polygon fill="black" stroke="black" points="448.5,-23568.63 445,-23558.63 441.5,-23568.63 448.5,-23568.63"/>
</g>
<!-- layer54_gate -->
<g id="node277" class="node">
<title>layer54_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-23454.33 191.3,-23454.33 15.57,-23318.33 698.7,-23318.33 874.43,-23454.33"/>
<text text-anchor="middle" x="445" y="-23405.13" font-family="Times,serif" font-size="14.00">Layer 54 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-23390.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23375.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-23360.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer54_out_proj&#45;&gt;layer54_gate -->
<g id="edge276" class="edge">
<title>layer54_out_proj&#45;&gt;layer54_gate</title>
<path fill="none" stroke="black" d="M445,-23490.06C445,-23482.24 445,-23473.57 445,-23464.69"/>
<polygon fill="black" stroke="black" points="448.5,-23464.6 445,-23454.6 441.5,-23464.6 448.5,-23464.6"/>
</g>
<!-- layer54_moe -->
<g id="node278" class="node">
<title>layer54_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-23282.33 232,-23282.33 232,-23214.33 658,-23214.33 658,-23282.33"/>
<text text-anchor="middle" x="445" y="-23267.13" font-family="Times,serif" font-size="14.00">Layer 54 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-23252.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23237.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-23222.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer54_gate&#45;&gt;layer54_moe -->
<g id="edge277" class="edge">
<title>layer54_gate&#45;&gt;layer54_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-23318.13C445,-23309.38 445,-23300.61 445,-23292.4"/>
<polygon fill="black" stroke="black" points="448.5,-23292.35 445,-23282.35 441.5,-23292.35 448.5,-23292.35"/>
</g>
<!-- layer55_qkv_proj -->
<g id="node279" class="node">
<title>layer55_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-23178.33 218,-23178.33 218,-23110.33 672,-23110.33 672,-23178.33"/>
<text text-anchor="middle" x="445" y="-23163.13" font-family="Times,serif" font-size="14.00">Layer 55 QKV Projection</text>
<text text-anchor="middle" x="445" y="-23148.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23133.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-23118.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer54_moe&#45;&gt;layer55_qkv_proj -->
<g id="edge278" class="edge">
<title>layer54_moe&#45;&gt;layer55_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-23214.22C445,-23206.11 445,-23197.32 445,-23188.81"/>
<polygon fill="black" stroke="black" points="448.5,-23188.63 445,-23178.63 441.5,-23188.63 448.5,-23188.63"/>
</g>
<!-- layer55_attn_comp -->
<g id="node280" class="node">
<title>layer55_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-23074.33 218,-23074.33 218,-23006.33 672,-23006.33 672,-23074.33"/>
<text text-anchor="middle" x="445" y="-23059.13" font-family="Times,serif" font-size="14.00">Layer 55 Attention Computation</text>
<text text-anchor="middle" x="445" y="-23044.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-23029.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-23014.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer55_qkv_proj&#45;&gt;layer55_attn_comp -->
<g id="edge279" class="edge">
<title>layer55_qkv_proj&#45;&gt;layer55_attn_comp</title>
<path fill="none" stroke="black" d="M445,-23110.22C445,-23102.11 445,-23093.32 445,-23084.81"/>
<polygon fill="black" stroke="black" points="448.5,-23084.63 445,-23074.63 441.5,-23084.63 448.5,-23084.63"/>
</g>
<!-- layer55_out_proj -->
<g id="node281" class="node">
<title>layer55_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-22970.33 224,-22970.33 224,-22902.33 666,-22902.33 666,-22970.33"/>
<text text-anchor="middle" x="445" y="-22955.13" font-family="Times,serif" font-size="14.00">Layer 55 Output Projection</text>
<text text-anchor="middle" x="445" y="-22940.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22925.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-22910.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer55_attn_comp&#45;&gt;layer55_out_proj -->
<g id="edge280" class="edge">
<title>layer55_attn_comp&#45;&gt;layer55_out_proj</title>
<path fill="none" stroke="black" d="M445,-23006.22C445,-22998.11 445,-22989.32 445,-22980.81"/>
<polygon fill="black" stroke="black" points="448.5,-22980.63 445,-22970.63 441.5,-22980.63 448.5,-22980.63"/>
</g>
<!-- layer55_gate -->
<g id="node282" class="node">
<title>layer55_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-22866.33 191.3,-22866.33 15.57,-22730.33 698.7,-22730.33 874.43,-22866.33"/>
<text text-anchor="middle" x="445" y="-22817.13" font-family="Times,serif" font-size="14.00">Layer 55 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-22802.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22787.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-22772.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer55_out_proj&#45;&gt;layer55_gate -->
<g id="edge281" class="edge">
<title>layer55_out_proj&#45;&gt;layer55_gate</title>
<path fill="none" stroke="black" d="M445,-22902.06C445,-22894.24 445,-22885.57 445,-22876.69"/>
<polygon fill="black" stroke="black" points="448.5,-22876.6 445,-22866.6 441.5,-22876.6 448.5,-22876.6"/>
</g>
<!-- layer55_moe -->
<g id="node283" class="node">
<title>layer55_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-22694.33 232,-22694.33 232,-22626.33 658,-22626.33 658,-22694.33"/>
<text text-anchor="middle" x="445" y="-22679.13" font-family="Times,serif" font-size="14.00">Layer 55 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-22664.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22649.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-22634.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer55_gate&#45;&gt;layer55_moe -->
<g id="edge282" class="edge">
<title>layer55_gate&#45;&gt;layer55_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-22730.13C445,-22721.38 445,-22712.61 445,-22704.4"/>
<polygon fill="black" stroke="black" points="448.5,-22704.35 445,-22694.35 441.5,-22704.35 448.5,-22704.35"/>
</g>
<!-- layer56_qkv_proj -->
<g id="node284" class="node">
<title>layer56_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-22590.33 218,-22590.33 218,-22522.33 672,-22522.33 672,-22590.33"/>
<text text-anchor="middle" x="445" y="-22575.13" font-family="Times,serif" font-size="14.00">Layer 56 QKV Projection</text>
<text text-anchor="middle" x="445" y="-22560.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22545.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-22530.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer55_moe&#45;&gt;layer56_qkv_proj -->
<g id="edge283" class="edge">
<title>layer55_moe&#45;&gt;layer56_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-22626.22C445,-22618.11 445,-22609.32 445,-22600.81"/>
<polygon fill="black" stroke="black" points="448.5,-22600.63 445,-22590.63 441.5,-22600.63 448.5,-22600.63"/>
</g>
<!-- layer56_attn_comp -->
<g id="node285" class="node">
<title>layer56_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-22486.33 218,-22486.33 218,-22418.33 672,-22418.33 672,-22486.33"/>
<text text-anchor="middle" x="445" y="-22471.13" font-family="Times,serif" font-size="14.00">Layer 56 Attention Computation</text>
<text text-anchor="middle" x="445" y="-22456.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22441.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-22426.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer56_qkv_proj&#45;&gt;layer56_attn_comp -->
<g id="edge284" class="edge">
<title>layer56_qkv_proj&#45;&gt;layer56_attn_comp</title>
<path fill="none" stroke="black" d="M445,-22522.22C445,-22514.11 445,-22505.32 445,-22496.81"/>
<polygon fill="black" stroke="black" points="448.5,-22496.63 445,-22486.63 441.5,-22496.63 448.5,-22496.63"/>
</g>
<!-- layer56_out_proj -->
<g id="node286" class="node">
<title>layer56_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-22382.33 224,-22382.33 224,-22314.33 666,-22314.33 666,-22382.33"/>
<text text-anchor="middle" x="445" y="-22367.13" font-family="Times,serif" font-size="14.00">Layer 56 Output Projection</text>
<text text-anchor="middle" x="445" y="-22352.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22337.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-22322.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer56_attn_comp&#45;&gt;layer56_out_proj -->
<g id="edge285" class="edge">
<title>layer56_attn_comp&#45;&gt;layer56_out_proj</title>
<path fill="none" stroke="black" d="M445,-22418.22C445,-22410.11 445,-22401.32 445,-22392.81"/>
<polygon fill="black" stroke="black" points="448.5,-22392.63 445,-22382.63 441.5,-22392.63 448.5,-22392.63"/>
</g>
<!-- layer56_gate -->
<g id="node287" class="node">
<title>layer56_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-22278.33 191.3,-22278.33 15.57,-22142.33 698.7,-22142.33 874.43,-22278.33"/>
<text text-anchor="middle" x="445" y="-22229.13" font-family="Times,serif" font-size="14.00">Layer 56 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-22214.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22199.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-22184.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer56_out_proj&#45;&gt;layer56_gate -->
<g id="edge286" class="edge">
<title>layer56_out_proj&#45;&gt;layer56_gate</title>
<path fill="none" stroke="black" d="M445,-22314.06C445,-22306.24 445,-22297.57 445,-22288.69"/>
<polygon fill="black" stroke="black" points="448.5,-22288.6 445,-22278.6 441.5,-22288.6 448.5,-22288.6"/>
</g>
<!-- layer56_moe -->
<g id="node288" class="node">
<title>layer56_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-22106.33 232,-22106.33 232,-22038.33 658,-22038.33 658,-22106.33"/>
<text text-anchor="middle" x="445" y="-22091.13" font-family="Times,serif" font-size="14.00">Layer 56 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-22076.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-22061.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-22046.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer56_gate&#45;&gt;layer56_moe -->
<g id="edge287" class="edge">
<title>layer56_gate&#45;&gt;layer56_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-22142.13C445,-22133.38 445,-22124.61 445,-22116.4"/>
<polygon fill="black" stroke="black" points="448.5,-22116.35 445,-22106.35 441.5,-22116.35 448.5,-22116.35"/>
</g>
<!-- layer57_qkv_proj -->
<g id="node289" class="node">
<title>layer57_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-22002.33 218,-22002.33 218,-21934.33 672,-21934.33 672,-22002.33"/>
<text text-anchor="middle" x="445" y="-21987.13" font-family="Times,serif" font-size="14.00">Layer 57 QKV Projection</text>
<text text-anchor="middle" x="445" y="-21972.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21957.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-21942.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer56_moe&#45;&gt;layer57_qkv_proj -->
<g id="edge288" class="edge">
<title>layer56_moe&#45;&gt;layer57_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-22038.22C445,-22030.11 445,-22021.32 445,-22012.81"/>
<polygon fill="black" stroke="black" points="448.5,-22012.63 445,-22002.63 441.5,-22012.63 448.5,-22012.63"/>
</g>
<!-- layer57_attn_comp -->
<g id="node290" class="node">
<title>layer57_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-21898.33 218,-21898.33 218,-21830.33 672,-21830.33 672,-21898.33"/>
<text text-anchor="middle" x="445" y="-21883.13" font-family="Times,serif" font-size="14.00">Layer 57 Attention Computation</text>
<text text-anchor="middle" x="445" y="-21868.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21853.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-21838.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer57_qkv_proj&#45;&gt;layer57_attn_comp -->
<g id="edge289" class="edge">
<title>layer57_qkv_proj&#45;&gt;layer57_attn_comp</title>
<path fill="none" stroke="black" d="M445,-21934.22C445,-21926.11 445,-21917.32 445,-21908.81"/>
<polygon fill="black" stroke="black" points="448.5,-21908.63 445,-21898.63 441.5,-21908.63 448.5,-21908.63"/>
</g>
<!-- layer57_out_proj -->
<g id="node291" class="node">
<title>layer57_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-21794.33 224,-21794.33 224,-21726.33 666,-21726.33 666,-21794.33"/>
<text text-anchor="middle" x="445" y="-21779.13" font-family="Times,serif" font-size="14.00">Layer 57 Output Projection</text>
<text text-anchor="middle" x="445" y="-21764.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21749.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-21734.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer57_attn_comp&#45;&gt;layer57_out_proj -->
<g id="edge290" class="edge">
<title>layer57_attn_comp&#45;&gt;layer57_out_proj</title>
<path fill="none" stroke="black" d="M445,-21830.22C445,-21822.11 445,-21813.32 445,-21804.81"/>
<polygon fill="black" stroke="black" points="448.5,-21804.63 445,-21794.63 441.5,-21804.63 448.5,-21804.63"/>
</g>
<!-- layer57_gate -->
<g id="node292" class="node">
<title>layer57_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-21690.33 191.3,-21690.33 15.57,-21554.33 698.7,-21554.33 874.43,-21690.33"/>
<text text-anchor="middle" x="445" y="-21641.13" font-family="Times,serif" font-size="14.00">Layer 57 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-21626.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21611.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-21596.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer57_out_proj&#45;&gt;layer57_gate -->
<g id="edge291" class="edge">
<title>layer57_out_proj&#45;&gt;layer57_gate</title>
<path fill="none" stroke="black" d="M445,-21726.06C445,-21718.24 445,-21709.57 445,-21700.69"/>
<polygon fill="black" stroke="black" points="448.5,-21700.6 445,-21690.6 441.5,-21700.6 448.5,-21700.6"/>
</g>
<!-- layer57_moe -->
<g id="node293" class="node">
<title>layer57_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-21518.33 232,-21518.33 232,-21450.33 658,-21450.33 658,-21518.33"/>
<text text-anchor="middle" x="445" y="-21503.13" font-family="Times,serif" font-size="14.00">Layer 57 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-21488.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21473.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-21458.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer57_gate&#45;&gt;layer57_moe -->
<g id="edge292" class="edge">
<title>layer57_gate&#45;&gt;layer57_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-21554.13C445,-21545.38 445,-21536.61 445,-21528.4"/>
<polygon fill="black" stroke="black" points="448.5,-21528.35 445,-21518.35 441.5,-21528.35 448.5,-21528.35"/>
</g>
<!-- layer58_qkv_proj -->
<g id="node294" class="node">
<title>layer58_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-21414.33 218,-21414.33 218,-21346.33 672,-21346.33 672,-21414.33"/>
<text text-anchor="middle" x="445" y="-21399.13" font-family="Times,serif" font-size="14.00">Layer 58 QKV Projection</text>
<text text-anchor="middle" x="445" y="-21384.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21369.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-21354.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer57_moe&#45;&gt;layer58_qkv_proj -->
<g id="edge293" class="edge">
<title>layer57_moe&#45;&gt;layer58_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-21450.22C445,-21442.11 445,-21433.32 445,-21424.81"/>
<polygon fill="black" stroke="black" points="448.5,-21424.63 445,-21414.63 441.5,-21424.63 448.5,-21424.63"/>
</g>
<!-- layer58_attn_comp -->
<g id="node295" class="node">
<title>layer58_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-21310.33 218,-21310.33 218,-21242.33 672,-21242.33 672,-21310.33"/>
<text text-anchor="middle" x="445" y="-21295.13" font-family="Times,serif" font-size="14.00">Layer 58 Attention Computation</text>
<text text-anchor="middle" x="445" y="-21280.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21265.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-21250.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer58_qkv_proj&#45;&gt;layer58_attn_comp -->
<g id="edge294" class="edge">
<title>layer58_qkv_proj&#45;&gt;layer58_attn_comp</title>
<path fill="none" stroke="black" d="M445,-21346.22C445,-21338.11 445,-21329.32 445,-21320.81"/>
<polygon fill="black" stroke="black" points="448.5,-21320.63 445,-21310.63 441.5,-21320.63 448.5,-21320.63"/>
</g>
<!-- layer58_out_proj -->
<g id="node296" class="node">
<title>layer58_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-21206.33 224,-21206.33 224,-21138.33 666,-21138.33 666,-21206.33"/>
<text text-anchor="middle" x="445" y="-21191.13" font-family="Times,serif" font-size="14.00">Layer 58 Output Projection</text>
<text text-anchor="middle" x="445" y="-21176.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21161.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-21146.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer58_attn_comp&#45;&gt;layer58_out_proj -->
<g id="edge295" class="edge">
<title>layer58_attn_comp&#45;&gt;layer58_out_proj</title>
<path fill="none" stroke="black" d="M445,-21242.22C445,-21234.11 445,-21225.32 445,-21216.81"/>
<polygon fill="black" stroke="black" points="448.5,-21216.63 445,-21206.63 441.5,-21216.63 448.5,-21216.63"/>
</g>
<!-- layer58_gate -->
<g id="node297" class="node">
<title>layer58_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-21102.33 191.3,-21102.33 15.57,-20966.33 698.7,-20966.33 874.43,-21102.33"/>
<text text-anchor="middle" x="445" y="-21053.13" font-family="Times,serif" font-size="14.00">Layer 58 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-21038.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-21023.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-21008.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer58_out_proj&#45;&gt;layer58_gate -->
<g id="edge296" class="edge">
<title>layer58_out_proj&#45;&gt;layer58_gate</title>
<path fill="none" stroke="black" d="M445,-21138.06C445,-21130.24 445,-21121.57 445,-21112.69"/>
<polygon fill="black" stroke="black" points="448.5,-21112.6 445,-21102.6 441.5,-21112.6 448.5,-21112.6"/>
</g>
<!-- layer58_moe -->
<g id="node298" class="node">
<title>layer58_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-20930.33 232,-20930.33 232,-20862.33 658,-20862.33 658,-20930.33"/>
<text text-anchor="middle" x="445" y="-20915.13" font-family="Times,serif" font-size="14.00">Layer 58 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-20900.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20885.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-20870.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer58_gate&#45;&gt;layer58_moe -->
<g id="edge297" class="edge">
<title>layer58_gate&#45;&gt;layer58_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-20966.13C445,-20957.38 445,-20948.61 445,-20940.4"/>
<polygon fill="black" stroke="black" points="448.5,-20940.35 445,-20930.35 441.5,-20940.35 448.5,-20940.35"/>
</g>
<!-- layer59_qkv_proj -->
<g id="node299" class="node">
<title>layer59_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-20826.33 218,-20826.33 218,-20758.33 672,-20758.33 672,-20826.33"/>
<text text-anchor="middle" x="445" y="-20811.13" font-family="Times,serif" font-size="14.00">Layer 59 QKV Projection</text>
<text text-anchor="middle" x="445" y="-20796.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20781.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-20766.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer58_moe&#45;&gt;layer59_qkv_proj -->
<g id="edge298" class="edge">
<title>layer58_moe&#45;&gt;layer59_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-20862.22C445,-20854.11 445,-20845.32 445,-20836.81"/>
<polygon fill="black" stroke="black" points="448.5,-20836.63 445,-20826.63 441.5,-20836.63 448.5,-20836.63"/>
</g>
<!-- layer59_attn_comp -->
<g id="node300" class="node">
<title>layer59_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-20722.33 218,-20722.33 218,-20654.33 672,-20654.33 672,-20722.33"/>
<text text-anchor="middle" x="445" y="-20707.13" font-family="Times,serif" font-size="14.00">Layer 59 Attention Computation</text>
<text text-anchor="middle" x="445" y="-20692.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20677.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-20662.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer59_qkv_proj&#45;&gt;layer59_attn_comp -->
<g id="edge299" class="edge">
<title>layer59_qkv_proj&#45;&gt;layer59_attn_comp</title>
<path fill="none" stroke="black" d="M445,-20758.22C445,-20750.11 445,-20741.32 445,-20732.81"/>
<polygon fill="black" stroke="black" points="448.5,-20732.63 445,-20722.63 441.5,-20732.63 448.5,-20732.63"/>
</g>
<!-- layer59_out_proj -->
<g id="node301" class="node">
<title>layer59_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-20618.33 224,-20618.33 224,-20550.33 666,-20550.33 666,-20618.33"/>
<text text-anchor="middle" x="445" y="-20603.13" font-family="Times,serif" font-size="14.00">Layer 59 Output Projection</text>
<text text-anchor="middle" x="445" y="-20588.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20573.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-20558.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer59_attn_comp&#45;&gt;layer59_out_proj -->
<g id="edge300" class="edge">
<title>layer59_attn_comp&#45;&gt;layer59_out_proj</title>
<path fill="none" stroke="black" d="M445,-20654.22C445,-20646.11 445,-20637.32 445,-20628.81"/>
<polygon fill="black" stroke="black" points="448.5,-20628.63 445,-20618.63 441.5,-20628.63 448.5,-20628.63"/>
</g>
<!-- layer59_gate -->
<g id="node302" class="node">
<title>layer59_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-20514.33 191.3,-20514.33 15.57,-20378.33 698.7,-20378.33 874.43,-20514.33"/>
<text text-anchor="middle" x="445" y="-20465.13" font-family="Times,serif" font-size="14.00">Layer 59 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-20450.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20435.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-20420.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer59_out_proj&#45;&gt;layer59_gate -->
<g id="edge301" class="edge">
<title>layer59_out_proj&#45;&gt;layer59_gate</title>
<path fill="none" stroke="black" d="M445,-20550.06C445,-20542.24 445,-20533.57 445,-20524.69"/>
<polygon fill="black" stroke="black" points="448.5,-20524.6 445,-20514.6 441.5,-20524.6 448.5,-20524.6"/>
</g>
<!-- layer59_moe -->
<g id="node303" class="node">
<title>layer59_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-20342.33 232,-20342.33 232,-20274.33 658,-20274.33 658,-20342.33"/>
<text text-anchor="middle" x="445" y="-20327.13" font-family="Times,serif" font-size="14.00">Layer 59 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-20312.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20297.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-20282.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer59_gate&#45;&gt;layer59_moe -->
<g id="edge302" class="edge">
<title>layer59_gate&#45;&gt;layer59_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-20378.13C445,-20369.38 445,-20360.61 445,-20352.4"/>
<polygon fill="black" stroke="black" points="448.5,-20352.35 445,-20342.35 441.5,-20352.35 448.5,-20352.35"/>
</g>
<!-- layer60_qkv_proj -->
<g id="node304" class="node">
<title>layer60_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-20238.33 218,-20238.33 218,-20170.33 672,-20170.33 672,-20238.33"/>
<text text-anchor="middle" x="445" y="-20223.13" font-family="Times,serif" font-size="14.00">Layer 60 QKV Projection</text>
<text text-anchor="middle" x="445" y="-20208.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20193.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-20178.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer59_moe&#45;&gt;layer60_qkv_proj -->
<g id="edge303" class="edge">
<title>layer59_moe&#45;&gt;layer60_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-20274.22C445,-20266.11 445,-20257.32 445,-20248.81"/>
<polygon fill="black" stroke="black" points="448.5,-20248.63 445,-20238.63 441.5,-20248.63 448.5,-20248.63"/>
</g>
<!-- layer60_attn_comp -->
<g id="node305" class="node">
<title>layer60_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-20134.33 218,-20134.33 218,-20066.33 672,-20066.33 672,-20134.33"/>
<text text-anchor="middle" x="445" y="-20119.13" font-family="Times,serif" font-size="14.00">Layer 60 Attention Computation</text>
<text text-anchor="middle" x="445" y="-20104.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-20089.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-20074.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer60_qkv_proj&#45;&gt;layer60_attn_comp -->
<g id="edge304" class="edge">
<title>layer60_qkv_proj&#45;&gt;layer60_attn_comp</title>
<path fill="none" stroke="black" d="M445,-20170.22C445,-20162.11 445,-20153.32 445,-20144.81"/>
<polygon fill="black" stroke="black" points="448.5,-20144.63 445,-20134.63 441.5,-20144.63 448.5,-20144.63"/>
</g>
<!-- layer60_out_proj -->
<g id="node306" class="node">
<title>layer60_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-20030.33 224,-20030.33 224,-19962.33 666,-19962.33 666,-20030.33"/>
<text text-anchor="middle" x="445" y="-20015.13" font-family="Times,serif" font-size="14.00">Layer 60 Output Projection</text>
<text text-anchor="middle" x="445" y="-20000.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19985.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-19970.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer60_attn_comp&#45;&gt;layer60_out_proj -->
<g id="edge305" class="edge">
<title>layer60_attn_comp&#45;&gt;layer60_out_proj</title>
<path fill="none" stroke="black" d="M445,-20066.22C445,-20058.11 445,-20049.32 445,-20040.81"/>
<polygon fill="black" stroke="black" points="448.5,-20040.63 445,-20030.63 441.5,-20040.63 448.5,-20040.63"/>
</g>
<!-- layer60_gate -->
<g id="node307" class="node">
<title>layer60_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-19926.33 191.3,-19926.33 15.57,-19790.33 698.7,-19790.33 874.43,-19926.33"/>
<text text-anchor="middle" x="445" y="-19877.13" font-family="Times,serif" font-size="14.00">Layer 60 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-19862.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19847.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-19832.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer60_out_proj&#45;&gt;layer60_gate -->
<g id="edge306" class="edge">
<title>layer60_out_proj&#45;&gt;layer60_gate</title>
<path fill="none" stroke="black" d="M445,-19962.06C445,-19954.24 445,-19945.57 445,-19936.69"/>
<polygon fill="black" stroke="black" points="448.5,-19936.6 445,-19926.6 441.5,-19936.6 448.5,-19936.6"/>
</g>
<!-- layer60_moe -->
<g id="node308" class="node">
<title>layer60_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-19754.33 232,-19754.33 232,-19686.33 658,-19686.33 658,-19754.33"/>
<text text-anchor="middle" x="445" y="-19739.13" font-family="Times,serif" font-size="14.00">Layer 60 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-19724.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19709.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-19694.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer60_gate&#45;&gt;layer60_moe -->
<g id="edge307" class="edge">
<title>layer60_gate&#45;&gt;layer60_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-19790.13C445,-19781.38 445,-19772.61 445,-19764.4"/>
<polygon fill="black" stroke="black" points="448.5,-19764.35 445,-19754.35 441.5,-19764.35 448.5,-19764.35"/>
</g>
<!-- layer61_qkv_proj -->
<g id="node309" class="node">
<title>layer61_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-19650.33 218,-19650.33 218,-19582.33 672,-19582.33 672,-19650.33"/>
<text text-anchor="middle" x="445" y="-19635.13" font-family="Times,serif" font-size="14.00">Layer 61 QKV Projection</text>
<text text-anchor="middle" x="445" y="-19620.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19605.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-19590.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer60_moe&#45;&gt;layer61_qkv_proj -->
<g id="edge308" class="edge">
<title>layer60_moe&#45;&gt;layer61_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-19686.22C445,-19678.11 445,-19669.32 445,-19660.81"/>
<polygon fill="black" stroke="black" points="448.5,-19660.63 445,-19650.63 441.5,-19660.63 448.5,-19660.63"/>
</g>
<!-- layer61_attn_comp -->
<g id="node310" class="node">
<title>layer61_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-19546.33 218,-19546.33 218,-19478.33 672,-19478.33 672,-19546.33"/>
<text text-anchor="middle" x="445" y="-19531.13" font-family="Times,serif" font-size="14.00">Layer 61 Attention Computation</text>
<text text-anchor="middle" x="445" y="-19516.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19501.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-19486.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer61_qkv_proj&#45;&gt;layer61_attn_comp -->
<g id="edge309" class="edge">
<title>layer61_qkv_proj&#45;&gt;layer61_attn_comp</title>
<path fill="none" stroke="black" d="M445,-19582.22C445,-19574.11 445,-19565.32 445,-19556.81"/>
<polygon fill="black" stroke="black" points="448.5,-19556.63 445,-19546.63 441.5,-19556.63 448.5,-19556.63"/>
</g>
<!-- layer61_out_proj -->
<g id="node311" class="node">
<title>layer61_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-19442.33 224,-19442.33 224,-19374.33 666,-19374.33 666,-19442.33"/>
<text text-anchor="middle" x="445" y="-19427.13" font-family="Times,serif" font-size="14.00">Layer 61 Output Projection</text>
<text text-anchor="middle" x="445" y="-19412.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19397.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-19382.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer61_attn_comp&#45;&gt;layer61_out_proj -->
<g id="edge310" class="edge">
<title>layer61_attn_comp&#45;&gt;layer61_out_proj</title>
<path fill="none" stroke="black" d="M445,-19478.22C445,-19470.11 445,-19461.32 445,-19452.81"/>
<polygon fill="black" stroke="black" points="448.5,-19452.63 445,-19442.63 441.5,-19452.63 448.5,-19452.63"/>
</g>
<!-- layer61_gate -->
<g id="node312" class="node">
<title>layer61_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-19338.33 191.3,-19338.33 15.57,-19202.33 698.7,-19202.33 874.43,-19338.33"/>
<text text-anchor="middle" x="445" y="-19289.13" font-family="Times,serif" font-size="14.00">Layer 61 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-19274.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19259.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-19244.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer61_out_proj&#45;&gt;layer61_gate -->
<g id="edge311" class="edge">
<title>layer61_out_proj&#45;&gt;layer61_gate</title>
<path fill="none" stroke="black" d="M445,-19374.06C445,-19366.24 445,-19357.57 445,-19348.69"/>
<polygon fill="black" stroke="black" points="448.5,-19348.6 445,-19338.6 441.5,-19348.6 448.5,-19348.6"/>
</g>
<!-- layer61_moe -->
<g id="node313" class="node">
<title>layer61_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-19166.33 232,-19166.33 232,-19098.33 658,-19098.33 658,-19166.33"/>
<text text-anchor="middle" x="445" y="-19151.13" font-family="Times,serif" font-size="14.00">Layer 61 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-19136.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19121.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-19106.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer61_gate&#45;&gt;layer61_moe -->
<g id="edge312" class="edge">
<title>layer61_gate&#45;&gt;layer61_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-19202.13C445,-19193.38 445,-19184.61 445,-19176.4"/>
<polygon fill="black" stroke="black" points="448.5,-19176.35 445,-19166.35 441.5,-19176.35 448.5,-19176.35"/>
</g>
<!-- layer62_qkv_proj -->
<g id="node314" class="node">
<title>layer62_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-19062.33 218,-19062.33 218,-18994.33 672,-18994.33 672,-19062.33"/>
<text text-anchor="middle" x="445" y="-19047.13" font-family="Times,serif" font-size="14.00">Layer 62 QKV Projection</text>
<text text-anchor="middle" x="445" y="-19032.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-19017.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-19002.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer61_moe&#45;&gt;layer62_qkv_proj -->
<g id="edge313" class="edge">
<title>layer61_moe&#45;&gt;layer62_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-19098.22C445,-19090.11 445,-19081.32 445,-19072.81"/>
<polygon fill="black" stroke="black" points="448.5,-19072.63 445,-19062.63 441.5,-19072.63 448.5,-19072.63"/>
</g>
<!-- layer62_attn_comp -->
<g id="node315" class="node">
<title>layer62_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-18958.33 218,-18958.33 218,-18890.33 672,-18890.33 672,-18958.33"/>
<text text-anchor="middle" x="445" y="-18943.13" font-family="Times,serif" font-size="14.00">Layer 62 Attention Computation</text>
<text text-anchor="middle" x="445" y="-18928.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18913.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-18898.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer62_qkv_proj&#45;&gt;layer62_attn_comp -->
<g id="edge314" class="edge">
<title>layer62_qkv_proj&#45;&gt;layer62_attn_comp</title>
<path fill="none" stroke="black" d="M445,-18994.22C445,-18986.11 445,-18977.32 445,-18968.81"/>
<polygon fill="black" stroke="black" points="448.5,-18968.63 445,-18958.63 441.5,-18968.63 448.5,-18968.63"/>
</g>
<!-- layer62_out_proj -->
<g id="node316" class="node">
<title>layer62_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-18854.33 224,-18854.33 224,-18786.33 666,-18786.33 666,-18854.33"/>
<text text-anchor="middle" x="445" y="-18839.13" font-family="Times,serif" font-size="14.00">Layer 62 Output Projection</text>
<text text-anchor="middle" x="445" y="-18824.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18809.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-18794.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer62_attn_comp&#45;&gt;layer62_out_proj -->
<g id="edge315" class="edge">
<title>layer62_attn_comp&#45;&gt;layer62_out_proj</title>
<path fill="none" stroke="black" d="M445,-18890.22C445,-18882.11 445,-18873.32 445,-18864.81"/>
<polygon fill="black" stroke="black" points="448.5,-18864.63 445,-18854.63 441.5,-18864.63 448.5,-18864.63"/>
</g>
<!-- layer62_gate -->
<g id="node317" class="node">
<title>layer62_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-18750.33 191.3,-18750.33 15.57,-18614.33 698.7,-18614.33 874.43,-18750.33"/>
<text text-anchor="middle" x="445" y="-18701.13" font-family="Times,serif" font-size="14.00">Layer 62 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-18686.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18671.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-18656.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer62_out_proj&#45;&gt;layer62_gate -->
<g id="edge316" class="edge">
<title>layer62_out_proj&#45;&gt;layer62_gate</title>
<path fill="none" stroke="black" d="M445,-18786.06C445,-18778.24 445,-18769.57 445,-18760.69"/>
<polygon fill="black" stroke="black" points="448.5,-18760.6 445,-18750.6 441.5,-18760.6 448.5,-18760.6"/>
</g>
<!-- layer62_moe -->
<g id="node318" class="node">
<title>layer62_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-18578.33 232,-18578.33 232,-18510.33 658,-18510.33 658,-18578.33"/>
<text text-anchor="middle" x="445" y="-18563.13" font-family="Times,serif" font-size="14.00">Layer 62 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-18548.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18533.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-18518.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer62_gate&#45;&gt;layer62_moe -->
<g id="edge317" class="edge">
<title>layer62_gate&#45;&gt;layer62_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-18614.13C445,-18605.38 445,-18596.61 445,-18588.4"/>
<polygon fill="black" stroke="black" points="448.5,-18588.35 445,-18578.35 441.5,-18588.35 448.5,-18588.35"/>
</g>
<!-- layer63_qkv_proj -->
<g id="node319" class="node">
<title>layer63_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-18474.33 218,-18474.33 218,-18406.33 672,-18406.33 672,-18474.33"/>
<text text-anchor="middle" x="445" y="-18459.13" font-family="Times,serif" font-size="14.00">Layer 63 QKV Projection</text>
<text text-anchor="middle" x="445" y="-18444.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18429.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-18414.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer62_moe&#45;&gt;layer63_qkv_proj -->
<g id="edge318" class="edge">
<title>layer62_moe&#45;&gt;layer63_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-18510.22C445,-18502.11 445,-18493.32 445,-18484.81"/>
<polygon fill="black" stroke="black" points="448.5,-18484.63 445,-18474.63 441.5,-18484.63 448.5,-18484.63"/>
</g>
<!-- layer63_attn_comp -->
<g id="node320" class="node">
<title>layer63_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-18370.33 218,-18370.33 218,-18302.33 672,-18302.33 672,-18370.33"/>
<text text-anchor="middle" x="445" y="-18355.13" font-family="Times,serif" font-size="14.00">Layer 63 Attention Computation</text>
<text text-anchor="middle" x="445" y="-18340.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18325.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-18310.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer63_qkv_proj&#45;&gt;layer63_attn_comp -->
<g id="edge319" class="edge">
<title>layer63_qkv_proj&#45;&gt;layer63_attn_comp</title>
<path fill="none" stroke="black" d="M445,-18406.22C445,-18398.11 445,-18389.32 445,-18380.81"/>
<polygon fill="black" stroke="black" points="448.5,-18380.63 445,-18370.63 441.5,-18380.63 448.5,-18380.63"/>
</g>
<!-- layer63_out_proj -->
<g id="node321" class="node">
<title>layer63_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-18266.33 224,-18266.33 224,-18198.33 666,-18198.33 666,-18266.33"/>
<text text-anchor="middle" x="445" y="-18251.13" font-family="Times,serif" font-size="14.00">Layer 63 Output Projection</text>
<text text-anchor="middle" x="445" y="-18236.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18221.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-18206.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer63_attn_comp&#45;&gt;layer63_out_proj -->
<g id="edge320" class="edge">
<title>layer63_attn_comp&#45;&gt;layer63_out_proj</title>
<path fill="none" stroke="black" d="M445,-18302.22C445,-18294.11 445,-18285.32 445,-18276.81"/>
<polygon fill="black" stroke="black" points="448.5,-18276.63 445,-18266.63 441.5,-18276.63 448.5,-18276.63"/>
</g>
<!-- layer63_gate -->
<g id="node322" class="node">
<title>layer63_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-18162.33 191.3,-18162.33 15.57,-18026.33 698.7,-18026.33 874.43,-18162.33"/>
<text text-anchor="middle" x="445" y="-18113.13" font-family="Times,serif" font-size="14.00">Layer 63 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-18098.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-18083.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-18068.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer63_out_proj&#45;&gt;layer63_gate -->
<g id="edge321" class="edge">
<title>layer63_out_proj&#45;&gt;layer63_gate</title>
<path fill="none" stroke="black" d="M445,-18198.06C445,-18190.24 445,-18181.57 445,-18172.69"/>
<polygon fill="black" stroke="black" points="448.5,-18172.6 445,-18162.6 441.5,-18172.6 448.5,-18172.6"/>
</g>
<!-- layer63_moe -->
<g id="node323" class="node">
<title>layer63_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-17990.33 232,-17990.33 232,-17922.33 658,-17922.33 658,-17990.33"/>
<text text-anchor="middle" x="445" y="-17975.13" font-family="Times,serif" font-size="14.00">Layer 63 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-17960.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17945.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-17930.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer63_gate&#45;&gt;layer63_moe -->
<g id="edge322" class="edge">
<title>layer63_gate&#45;&gt;layer63_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-18026.13C445,-18017.38 445,-18008.61 445,-18000.4"/>
<polygon fill="black" stroke="black" points="448.5,-18000.35 445,-17990.35 441.5,-18000.35 448.5,-18000.35"/>
</g>
<!-- layer64_qkv_proj -->
<g id="node324" class="node">
<title>layer64_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-17886.33 218,-17886.33 218,-17818.33 672,-17818.33 672,-17886.33"/>
<text text-anchor="middle" x="445" y="-17871.13" font-family="Times,serif" font-size="14.00">Layer 64 QKV Projection</text>
<text text-anchor="middle" x="445" y="-17856.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17841.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-17826.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer63_moe&#45;&gt;layer64_qkv_proj -->
<g id="edge323" class="edge">
<title>layer63_moe&#45;&gt;layer64_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-17922.22C445,-17914.11 445,-17905.32 445,-17896.81"/>
<polygon fill="black" stroke="black" points="448.5,-17896.63 445,-17886.63 441.5,-17896.63 448.5,-17896.63"/>
</g>
<!-- layer64_attn_comp -->
<g id="node325" class="node">
<title>layer64_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-17782.33 218,-17782.33 218,-17714.33 672,-17714.33 672,-17782.33"/>
<text text-anchor="middle" x="445" y="-17767.13" font-family="Times,serif" font-size="14.00">Layer 64 Attention Computation</text>
<text text-anchor="middle" x="445" y="-17752.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17737.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-17722.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer64_qkv_proj&#45;&gt;layer64_attn_comp -->
<g id="edge324" class="edge">
<title>layer64_qkv_proj&#45;&gt;layer64_attn_comp</title>
<path fill="none" stroke="black" d="M445,-17818.22C445,-17810.11 445,-17801.32 445,-17792.81"/>
<polygon fill="black" stroke="black" points="448.5,-17792.63 445,-17782.63 441.5,-17792.63 448.5,-17792.63"/>
</g>
<!-- layer64_out_proj -->
<g id="node326" class="node">
<title>layer64_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-17678.33 224,-17678.33 224,-17610.33 666,-17610.33 666,-17678.33"/>
<text text-anchor="middle" x="445" y="-17663.13" font-family="Times,serif" font-size="14.00">Layer 64 Output Projection</text>
<text text-anchor="middle" x="445" y="-17648.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17633.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-17618.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer64_attn_comp&#45;&gt;layer64_out_proj -->
<g id="edge325" class="edge">
<title>layer64_attn_comp&#45;&gt;layer64_out_proj</title>
<path fill="none" stroke="black" d="M445,-17714.22C445,-17706.11 445,-17697.32 445,-17688.81"/>
<polygon fill="black" stroke="black" points="448.5,-17688.63 445,-17678.63 441.5,-17688.63 448.5,-17688.63"/>
</g>
<!-- layer64_gate -->
<g id="node327" class="node">
<title>layer64_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-17574.33 191.3,-17574.33 15.57,-17438.33 698.7,-17438.33 874.43,-17574.33"/>
<text text-anchor="middle" x="445" y="-17525.13" font-family="Times,serif" font-size="14.00">Layer 64 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-17510.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17495.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-17480.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer64_out_proj&#45;&gt;layer64_gate -->
<g id="edge326" class="edge">
<title>layer64_out_proj&#45;&gt;layer64_gate</title>
<path fill="none" stroke="black" d="M445,-17610.06C445,-17602.24 445,-17593.57 445,-17584.69"/>
<polygon fill="black" stroke="black" points="448.5,-17584.6 445,-17574.6 441.5,-17584.6 448.5,-17584.6"/>
</g>
<!-- layer64_moe -->
<g id="node328" class="node">
<title>layer64_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-17402.33 232,-17402.33 232,-17334.33 658,-17334.33 658,-17402.33"/>
<text text-anchor="middle" x="445" y="-17387.13" font-family="Times,serif" font-size="14.00">Layer 64 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-17372.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17357.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-17342.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer64_gate&#45;&gt;layer64_moe -->
<g id="edge327" class="edge">
<title>layer64_gate&#45;&gt;layer64_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-17438.13C445,-17429.38 445,-17420.61 445,-17412.4"/>
<polygon fill="black" stroke="black" points="448.5,-17412.35 445,-17402.35 441.5,-17412.35 448.5,-17412.35"/>
</g>
<!-- layer65_qkv_proj -->
<g id="node329" class="node">
<title>layer65_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-17298.33 218,-17298.33 218,-17230.33 672,-17230.33 672,-17298.33"/>
<text text-anchor="middle" x="445" y="-17283.13" font-family="Times,serif" font-size="14.00">Layer 65 QKV Projection</text>
<text text-anchor="middle" x="445" y="-17268.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17253.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-17238.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer64_moe&#45;&gt;layer65_qkv_proj -->
<g id="edge328" class="edge">
<title>layer64_moe&#45;&gt;layer65_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-17334.22C445,-17326.11 445,-17317.32 445,-17308.81"/>
<polygon fill="black" stroke="black" points="448.5,-17308.63 445,-17298.63 441.5,-17308.63 448.5,-17308.63"/>
</g>
<!-- layer65_attn_comp -->
<g id="node330" class="node">
<title>layer65_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-17194.33 218,-17194.33 218,-17126.33 672,-17126.33 672,-17194.33"/>
<text text-anchor="middle" x="445" y="-17179.13" font-family="Times,serif" font-size="14.00">Layer 65 Attention Computation</text>
<text text-anchor="middle" x="445" y="-17164.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17149.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-17134.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer65_qkv_proj&#45;&gt;layer65_attn_comp -->
<g id="edge329" class="edge">
<title>layer65_qkv_proj&#45;&gt;layer65_attn_comp</title>
<path fill="none" stroke="black" d="M445,-17230.22C445,-17222.11 445,-17213.32 445,-17204.81"/>
<polygon fill="black" stroke="black" points="448.5,-17204.63 445,-17194.63 441.5,-17204.63 448.5,-17204.63"/>
</g>
<!-- layer65_out_proj -->
<g id="node331" class="node">
<title>layer65_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-17090.33 224,-17090.33 224,-17022.33 666,-17022.33 666,-17090.33"/>
<text text-anchor="middle" x="445" y="-17075.13" font-family="Times,serif" font-size="14.00">Layer 65 Output Projection</text>
<text text-anchor="middle" x="445" y="-17060.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-17045.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-17030.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer65_attn_comp&#45;&gt;layer65_out_proj -->
<g id="edge330" class="edge">
<title>layer65_attn_comp&#45;&gt;layer65_out_proj</title>
<path fill="none" stroke="black" d="M445,-17126.22C445,-17118.11 445,-17109.32 445,-17100.81"/>
<polygon fill="black" stroke="black" points="448.5,-17100.63 445,-17090.63 441.5,-17100.63 448.5,-17100.63"/>
</g>
<!-- layer65_gate -->
<g id="node332" class="node">
<title>layer65_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-16986.33 191.3,-16986.33 15.57,-16850.33 698.7,-16850.33 874.43,-16986.33"/>
<text text-anchor="middle" x="445" y="-16937.13" font-family="Times,serif" font-size="14.00">Layer 65 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-16922.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16907.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-16892.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer65_out_proj&#45;&gt;layer65_gate -->
<g id="edge331" class="edge">
<title>layer65_out_proj&#45;&gt;layer65_gate</title>
<path fill="none" stroke="black" d="M445,-17022.06C445,-17014.24 445,-17005.57 445,-16996.69"/>
<polygon fill="black" stroke="black" points="448.5,-16996.6 445,-16986.6 441.5,-16996.6 448.5,-16996.6"/>
</g>
<!-- layer65_moe -->
<g id="node333" class="node">
<title>layer65_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-16814.33 232,-16814.33 232,-16746.33 658,-16746.33 658,-16814.33"/>
<text text-anchor="middle" x="445" y="-16799.13" font-family="Times,serif" font-size="14.00">Layer 65 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-16784.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16769.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-16754.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer65_gate&#45;&gt;layer65_moe -->
<g id="edge332" class="edge">
<title>layer65_gate&#45;&gt;layer65_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-16850.13C445,-16841.38 445,-16832.61 445,-16824.4"/>
<polygon fill="black" stroke="black" points="448.5,-16824.35 445,-16814.35 441.5,-16824.35 448.5,-16824.35"/>
</g>
<!-- layer66_qkv_proj -->
<g id="node334" class="node">
<title>layer66_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-16710.33 218,-16710.33 218,-16642.33 672,-16642.33 672,-16710.33"/>
<text text-anchor="middle" x="445" y="-16695.13" font-family="Times,serif" font-size="14.00">Layer 66 QKV Projection</text>
<text text-anchor="middle" x="445" y="-16680.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16665.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-16650.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer65_moe&#45;&gt;layer66_qkv_proj -->
<g id="edge333" class="edge">
<title>layer65_moe&#45;&gt;layer66_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-16746.22C445,-16738.11 445,-16729.32 445,-16720.81"/>
<polygon fill="black" stroke="black" points="448.5,-16720.63 445,-16710.63 441.5,-16720.63 448.5,-16720.63"/>
</g>
<!-- layer66_attn_comp -->
<g id="node335" class="node">
<title>layer66_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-16606.33 218,-16606.33 218,-16538.33 672,-16538.33 672,-16606.33"/>
<text text-anchor="middle" x="445" y="-16591.13" font-family="Times,serif" font-size="14.00">Layer 66 Attention Computation</text>
<text text-anchor="middle" x="445" y="-16576.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16561.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-16546.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer66_qkv_proj&#45;&gt;layer66_attn_comp -->
<g id="edge334" class="edge">
<title>layer66_qkv_proj&#45;&gt;layer66_attn_comp</title>
<path fill="none" stroke="black" d="M445,-16642.22C445,-16634.11 445,-16625.32 445,-16616.81"/>
<polygon fill="black" stroke="black" points="448.5,-16616.63 445,-16606.63 441.5,-16616.63 448.5,-16616.63"/>
</g>
<!-- layer66_out_proj -->
<g id="node336" class="node">
<title>layer66_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-16502.33 224,-16502.33 224,-16434.33 666,-16434.33 666,-16502.33"/>
<text text-anchor="middle" x="445" y="-16487.13" font-family="Times,serif" font-size="14.00">Layer 66 Output Projection</text>
<text text-anchor="middle" x="445" y="-16472.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16457.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-16442.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer66_attn_comp&#45;&gt;layer66_out_proj -->
<g id="edge335" class="edge">
<title>layer66_attn_comp&#45;&gt;layer66_out_proj</title>
<path fill="none" stroke="black" d="M445,-16538.22C445,-16530.11 445,-16521.32 445,-16512.81"/>
<polygon fill="black" stroke="black" points="448.5,-16512.63 445,-16502.63 441.5,-16512.63 448.5,-16512.63"/>
</g>
<!-- layer66_gate -->
<g id="node337" class="node">
<title>layer66_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-16398.33 191.3,-16398.33 15.57,-16262.33 698.7,-16262.33 874.43,-16398.33"/>
<text text-anchor="middle" x="445" y="-16349.13" font-family="Times,serif" font-size="14.00">Layer 66 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-16334.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-16304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer66_out_proj&#45;&gt;layer66_gate -->
<g id="edge336" class="edge">
<title>layer66_out_proj&#45;&gt;layer66_gate</title>
<path fill="none" stroke="black" d="M445,-16434.06C445,-16426.24 445,-16417.57 445,-16408.69"/>
<polygon fill="black" stroke="black" points="448.5,-16408.6 445,-16398.6 441.5,-16408.6 448.5,-16408.6"/>
</g>
<!-- layer66_moe -->
<g id="node338" class="node">
<title>layer66_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-16226.33 232,-16226.33 232,-16158.33 658,-16158.33 658,-16226.33"/>
<text text-anchor="middle" x="445" y="-16211.13" font-family="Times,serif" font-size="14.00">Layer 66 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-16196.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16181.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-16166.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer66_gate&#45;&gt;layer66_moe -->
<g id="edge337" class="edge">
<title>layer66_gate&#45;&gt;layer66_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-16262.13C445,-16253.38 445,-16244.61 445,-16236.4"/>
<polygon fill="black" stroke="black" points="448.5,-16236.35 445,-16226.35 441.5,-16236.35 448.5,-16236.35"/>
</g>
<!-- layer67_qkv_proj -->
<g id="node339" class="node">
<title>layer67_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-16122.33 218,-16122.33 218,-16054.33 672,-16054.33 672,-16122.33"/>
<text text-anchor="middle" x="445" y="-16107.13" font-family="Times,serif" font-size="14.00">Layer 67 QKV Projection</text>
<text text-anchor="middle" x="445" y="-16092.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-16077.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-16062.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer66_moe&#45;&gt;layer67_qkv_proj -->
<g id="edge338" class="edge">
<title>layer66_moe&#45;&gt;layer67_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-16158.22C445,-16150.11 445,-16141.32 445,-16132.81"/>
<polygon fill="black" stroke="black" points="448.5,-16132.63 445,-16122.63 441.5,-16132.63 448.5,-16132.63"/>
</g>
<!-- layer67_attn_comp -->
<g id="node340" class="node">
<title>layer67_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-16018.33 218,-16018.33 218,-15950.33 672,-15950.33 672,-16018.33"/>
<text text-anchor="middle" x="445" y="-16003.13" font-family="Times,serif" font-size="14.00">Layer 67 Attention Computation</text>
<text text-anchor="middle" x="445" y="-15988.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15973.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-15958.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer67_qkv_proj&#45;&gt;layer67_attn_comp -->
<g id="edge339" class="edge">
<title>layer67_qkv_proj&#45;&gt;layer67_attn_comp</title>
<path fill="none" stroke="black" d="M445,-16054.22C445,-16046.11 445,-16037.32 445,-16028.81"/>
<polygon fill="black" stroke="black" points="448.5,-16028.63 445,-16018.63 441.5,-16028.63 448.5,-16028.63"/>
</g>
<!-- layer67_out_proj -->
<g id="node341" class="node">
<title>layer67_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-15914.33 224,-15914.33 224,-15846.33 666,-15846.33 666,-15914.33"/>
<text text-anchor="middle" x="445" y="-15899.13" font-family="Times,serif" font-size="14.00">Layer 67 Output Projection</text>
<text text-anchor="middle" x="445" y="-15884.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15869.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-15854.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer67_attn_comp&#45;&gt;layer67_out_proj -->
<g id="edge340" class="edge">
<title>layer67_attn_comp&#45;&gt;layer67_out_proj</title>
<path fill="none" stroke="black" d="M445,-15950.22C445,-15942.11 445,-15933.32 445,-15924.81"/>
<polygon fill="black" stroke="black" points="448.5,-15924.63 445,-15914.63 441.5,-15924.63 448.5,-15924.63"/>
</g>
<!-- layer67_gate -->
<g id="node342" class="node">
<title>layer67_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-15810.33 191.3,-15810.33 15.57,-15674.33 698.7,-15674.33 874.43,-15810.33"/>
<text text-anchor="middle" x="445" y="-15761.13" font-family="Times,serif" font-size="14.00">Layer 67 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-15746.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15731.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-15716.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer67_out_proj&#45;&gt;layer67_gate -->
<g id="edge341" class="edge">
<title>layer67_out_proj&#45;&gt;layer67_gate</title>
<path fill="none" stroke="black" d="M445,-15846.06C445,-15838.24 445,-15829.57 445,-15820.69"/>
<polygon fill="black" stroke="black" points="448.5,-15820.6 445,-15810.6 441.5,-15820.6 448.5,-15820.6"/>
</g>
<!-- layer67_moe -->
<g id="node343" class="node">
<title>layer67_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-15638.33 232,-15638.33 232,-15570.33 658,-15570.33 658,-15638.33"/>
<text text-anchor="middle" x="445" y="-15623.13" font-family="Times,serif" font-size="14.00">Layer 67 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-15608.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15593.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-15578.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer67_gate&#45;&gt;layer67_moe -->
<g id="edge342" class="edge">
<title>layer67_gate&#45;&gt;layer67_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-15674.13C445,-15665.38 445,-15656.61 445,-15648.4"/>
<polygon fill="black" stroke="black" points="448.5,-15648.35 445,-15638.35 441.5,-15648.35 448.5,-15648.35"/>
</g>
<!-- layer68_qkv_proj -->
<g id="node344" class="node">
<title>layer68_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-15534.33 218,-15534.33 218,-15466.33 672,-15466.33 672,-15534.33"/>
<text text-anchor="middle" x="445" y="-15519.13" font-family="Times,serif" font-size="14.00">Layer 68 QKV Projection</text>
<text text-anchor="middle" x="445" y="-15504.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15489.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-15474.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer67_moe&#45;&gt;layer68_qkv_proj -->
<g id="edge343" class="edge">
<title>layer67_moe&#45;&gt;layer68_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-15570.22C445,-15562.11 445,-15553.32 445,-15544.81"/>
<polygon fill="black" stroke="black" points="448.5,-15544.63 445,-15534.63 441.5,-15544.63 448.5,-15544.63"/>
</g>
<!-- layer68_attn_comp -->
<g id="node345" class="node">
<title>layer68_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-15430.33 218,-15430.33 218,-15362.33 672,-15362.33 672,-15430.33"/>
<text text-anchor="middle" x="445" y="-15415.13" font-family="Times,serif" font-size="14.00">Layer 68 Attention Computation</text>
<text text-anchor="middle" x="445" y="-15400.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15385.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-15370.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer68_qkv_proj&#45;&gt;layer68_attn_comp -->
<g id="edge344" class="edge">
<title>layer68_qkv_proj&#45;&gt;layer68_attn_comp</title>
<path fill="none" stroke="black" d="M445,-15466.22C445,-15458.11 445,-15449.32 445,-15440.81"/>
<polygon fill="black" stroke="black" points="448.5,-15440.63 445,-15430.63 441.5,-15440.63 448.5,-15440.63"/>
</g>
<!-- layer68_out_proj -->
<g id="node346" class="node">
<title>layer68_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-15326.33 224,-15326.33 224,-15258.33 666,-15258.33 666,-15326.33"/>
<text text-anchor="middle" x="445" y="-15311.13" font-family="Times,serif" font-size="14.00">Layer 68 Output Projection</text>
<text text-anchor="middle" x="445" y="-15296.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15281.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-15266.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer68_attn_comp&#45;&gt;layer68_out_proj -->
<g id="edge345" class="edge">
<title>layer68_attn_comp&#45;&gt;layer68_out_proj</title>
<path fill="none" stroke="black" d="M445,-15362.22C445,-15354.11 445,-15345.32 445,-15336.81"/>
<polygon fill="black" stroke="black" points="448.5,-15336.63 445,-15326.63 441.5,-15336.63 448.5,-15336.63"/>
</g>
<!-- layer68_gate -->
<g id="node347" class="node">
<title>layer68_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-15222.33 191.3,-15222.33 15.57,-15086.33 698.7,-15086.33 874.43,-15222.33"/>
<text text-anchor="middle" x="445" y="-15173.13" font-family="Times,serif" font-size="14.00">Layer 68 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-15158.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15143.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-15128.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer68_out_proj&#45;&gt;layer68_gate -->
<g id="edge346" class="edge">
<title>layer68_out_proj&#45;&gt;layer68_gate</title>
<path fill="none" stroke="black" d="M445,-15258.06C445,-15250.24 445,-15241.57 445,-15232.69"/>
<polygon fill="black" stroke="black" points="448.5,-15232.6 445,-15222.6 441.5,-15232.6 448.5,-15232.6"/>
</g>
<!-- layer68_moe -->
<g id="node348" class="node">
<title>layer68_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-15050.33 232,-15050.33 232,-14982.33 658,-14982.33 658,-15050.33"/>
<text text-anchor="middle" x="445" y="-15035.13" font-family="Times,serif" font-size="14.00">Layer 68 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-15020.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-15005.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-14990.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer68_gate&#45;&gt;layer68_moe -->
<g id="edge347" class="edge">
<title>layer68_gate&#45;&gt;layer68_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-15086.13C445,-15077.38 445,-15068.61 445,-15060.4"/>
<polygon fill="black" stroke="black" points="448.5,-15060.35 445,-15050.35 441.5,-15060.35 448.5,-15060.35"/>
</g>
<!-- layer69_qkv_proj -->
<g id="node349" class="node">
<title>layer69_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-14946.33 218,-14946.33 218,-14878.33 672,-14878.33 672,-14946.33"/>
<text text-anchor="middle" x="445" y="-14931.13" font-family="Times,serif" font-size="14.00">Layer 69 QKV Projection</text>
<text text-anchor="middle" x="445" y="-14916.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14901.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-14886.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer68_moe&#45;&gt;layer69_qkv_proj -->
<g id="edge348" class="edge">
<title>layer68_moe&#45;&gt;layer69_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-14982.22C445,-14974.11 445,-14965.32 445,-14956.81"/>
<polygon fill="black" stroke="black" points="448.5,-14956.63 445,-14946.63 441.5,-14956.63 448.5,-14956.63"/>
</g>
<!-- layer69_attn_comp -->
<g id="node350" class="node">
<title>layer69_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-14842.33 218,-14842.33 218,-14774.33 672,-14774.33 672,-14842.33"/>
<text text-anchor="middle" x="445" y="-14827.13" font-family="Times,serif" font-size="14.00">Layer 69 Attention Computation</text>
<text text-anchor="middle" x="445" y="-14812.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14797.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-14782.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer69_qkv_proj&#45;&gt;layer69_attn_comp -->
<g id="edge349" class="edge">
<title>layer69_qkv_proj&#45;&gt;layer69_attn_comp</title>
<path fill="none" stroke="black" d="M445,-14878.22C445,-14870.11 445,-14861.32 445,-14852.81"/>
<polygon fill="black" stroke="black" points="448.5,-14852.63 445,-14842.63 441.5,-14852.63 448.5,-14852.63"/>
</g>
<!-- layer69_out_proj -->
<g id="node351" class="node">
<title>layer69_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-14738.33 224,-14738.33 224,-14670.33 666,-14670.33 666,-14738.33"/>
<text text-anchor="middle" x="445" y="-14723.13" font-family="Times,serif" font-size="14.00">Layer 69 Output Projection</text>
<text text-anchor="middle" x="445" y="-14708.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14693.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-14678.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer69_attn_comp&#45;&gt;layer69_out_proj -->
<g id="edge350" class="edge">
<title>layer69_attn_comp&#45;&gt;layer69_out_proj</title>
<path fill="none" stroke="black" d="M445,-14774.22C445,-14766.11 445,-14757.32 445,-14748.81"/>
<polygon fill="black" stroke="black" points="448.5,-14748.63 445,-14738.63 441.5,-14748.63 448.5,-14748.63"/>
</g>
<!-- layer69_gate -->
<g id="node352" class="node">
<title>layer69_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-14634.33 191.3,-14634.33 15.57,-14498.33 698.7,-14498.33 874.43,-14634.33"/>
<text text-anchor="middle" x="445" y="-14585.13" font-family="Times,serif" font-size="14.00">Layer 69 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-14570.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14555.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-14540.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer69_out_proj&#45;&gt;layer69_gate -->
<g id="edge351" class="edge">
<title>layer69_out_proj&#45;&gt;layer69_gate</title>
<path fill="none" stroke="black" d="M445,-14670.06C445,-14662.24 445,-14653.57 445,-14644.69"/>
<polygon fill="black" stroke="black" points="448.5,-14644.6 445,-14634.6 441.5,-14644.6 448.5,-14644.6"/>
</g>
<!-- layer69_moe -->
<g id="node353" class="node">
<title>layer69_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-14462.33 232,-14462.33 232,-14394.33 658,-14394.33 658,-14462.33"/>
<text text-anchor="middle" x="445" y="-14447.13" font-family="Times,serif" font-size="14.00">Layer 69 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-14432.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14417.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-14402.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer69_gate&#45;&gt;layer69_moe -->
<g id="edge352" class="edge">
<title>layer69_gate&#45;&gt;layer69_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-14498.13C445,-14489.38 445,-14480.61 445,-14472.4"/>
<polygon fill="black" stroke="black" points="448.5,-14472.35 445,-14462.35 441.5,-14472.35 448.5,-14472.35"/>
</g>
<!-- layer70_qkv_proj -->
<g id="node354" class="node">
<title>layer70_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-14358.33 218,-14358.33 218,-14290.33 672,-14290.33 672,-14358.33"/>
<text text-anchor="middle" x="445" y="-14343.13" font-family="Times,serif" font-size="14.00">Layer 70 QKV Projection</text>
<text text-anchor="middle" x="445" y="-14328.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14313.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-14298.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer69_moe&#45;&gt;layer70_qkv_proj -->
<g id="edge353" class="edge">
<title>layer69_moe&#45;&gt;layer70_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-14394.22C445,-14386.11 445,-14377.32 445,-14368.81"/>
<polygon fill="black" stroke="black" points="448.5,-14368.63 445,-14358.63 441.5,-14368.63 448.5,-14368.63"/>
</g>
<!-- layer70_attn_comp -->
<g id="node355" class="node">
<title>layer70_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-14254.33 218,-14254.33 218,-14186.33 672,-14186.33 672,-14254.33"/>
<text text-anchor="middle" x="445" y="-14239.13" font-family="Times,serif" font-size="14.00">Layer 70 Attention Computation</text>
<text text-anchor="middle" x="445" y="-14224.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14209.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-14194.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer70_qkv_proj&#45;&gt;layer70_attn_comp -->
<g id="edge354" class="edge">
<title>layer70_qkv_proj&#45;&gt;layer70_attn_comp</title>
<path fill="none" stroke="black" d="M445,-14290.22C445,-14282.11 445,-14273.32 445,-14264.81"/>
<polygon fill="black" stroke="black" points="448.5,-14264.63 445,-14254.63 441.5,-14264.63 448.5,-14264.63"/>
</g>
<!-- layer70_out_proj -->
<g id="node356" class="node">
<title>layer70_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-14150.33 224,-14150.33 224,-14082.33 666,-14082.33 666,-14150.33"/>
<text text-anchor="middle" x="445" y="-14135.13" font-family="Times,serif" font-size="14.00">Layer 70 Output Projection</text>
<text text-anchor="middle" x="445" y="-14120.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-14105.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-14090.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer70_attn_comp&#45;&gt;layer70_out_proj -->
<g id="edge355" class="edge">
<title>layer70_attn_comp&#45;&gt;layer70_out_proj</title>
<path fill="none" stroke="black" d="M445,-14186.22C445,-14178.11 445,-14169.32 445,-14160.81"/>
<polygon fill="black" stroke="black" points="448.5,-14160.63 445,-14150.63 441.5,-14160.63 448.5,-14160.63"/>
</g>
<!-- layer70_gate -->
<g id="node357" class="node">
<title>layer70_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-14046.33 191.3,-14046.33 15.57,-13910.33 698.7,-13910.33 874.43,-14046.33"/>
<text text-anchor="middle" x="445" y="-13997.13" font-family="Times,serif" font-size="14.00">Layer 70 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-13982.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13967.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-13952.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer70_out_proj&#45;&gt;layer70_gate -->
<g id="edge356" class="edge">
<title>layer70_out_proj&#45;&gt;layer70_gate</title>
<path fill="none" stroke="black" d="M445,-14082.06C445,-14074.24 445,-14065.57 445,-14056.69"/>
<polygon fill="black" stroke="black" points="448.5,-14056.6 445,-14046.6 441.5,-14056.6 448.5,-14056.6"/>
</g>
<!-- layer70_moe -->
<g id="node358" class="node">
<title>layer70_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-13874.33 232,-13874.33 232,-13806.33 658,-13806.33 658,-13874.33"/>
<text text-anchor="middle" x="445" y="-13859.13" font-family="Times,serif" font-size="14.00">Layer 70 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-13844.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13829.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-13814.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer70_gate&#45;&gt;layer70_moe -->
<g id="edge357" class="edge">
<title>layer70_gate&#45;&gt;layer70_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-13910.13C445,-13901.38 445,-13892.61 445,-13884.4"/>
<polygon fill="black" stroke="black" points="448.5,-13884.35 445,-13874.35 441.5,-13884.35 448.5,-13884.35"/>
</g>
<!-- layer71_qkv_proj -->
<g id="node359" class="node">
<title>layer71_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="672,-13770.33 218,-13770.33 218,-13702.33 672,-13702.33 672,-13770.33"/>
<text text-anchor="middle" x="445" y="-13755.13" font-family="Times,serif" font-size="14.00">Layer 71 QKV Projection</text>
<text text-anchor="middle" x="445" y="-13740.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13725.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-13710.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer70_moe&#45;&gt;layer71_qkv_proj -->
<g id="edge358" class="edge">
<title>layer70_moe&#45;&gt;layer71_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-13806.22C445,-13798.11 445,-13789.32 445,-13780.81"/>
<polygon fill="black" stroke="black" points="448.5,-13780.63 445,-13770.63 441.5,-13780.63 448.5,-13780.63"/>
</g>
<!-- layer71_attn_comp -->
<g id="node360" class="node">
<title>layer71_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="672,-13666.33 218,-13666.33 218,-13598.33 672,-13598.33 672,-13666.33"/>
<text text-anchor="middle" x="445" y="-13651.13" font-family="Times,serif" font-size="14.00">Layer 71 Attention Computation</text>
<text text-anchor="middle" x="445" y="-13636.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13621.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-13606.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer71_qkv_proj&#45;&gt;layer71_attn_comp -->
<g id="edge359" class="edge">
<title>layer71_qkv_proj&#45;&gt;layer71_attn_comp</title>
<path fill="none" stroke="black" d="M445,-13702.22C445,-13694.11 445,-13685.32 445,-13676.81"/>
<polygon fill="black" stroke="black" points="448.5,-13676.63 445,-13666.63 441.5,-13676.63 448.5,-13676.63"/>
</g>
<!-- layer71_out_proj -->
<g id="node361" class="node">
<title>layer71_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="666,-13562.33 224,-13562.33 224,-13494.33 666,-13494.33 666,-13562.33"/>
<text text-anchor="middle" x="445" y="-13547.13" font-family="Times,serif" font-size="14.00">Layer 71 Output Projection</text>
<text text-anchor="middle" x="445" y="-13532.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13517.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-13502.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer71_attn_comp&#45;&gt;layer71_out_proj -->
<g id="edge360" class="edge">
<title>layer71_attn_comp&#45;&gt;layer71_out_proj</title>
<path fill="none" stroke="black" d="M445,-13598.22C445,-13590.11 445,-13581.32 445,-13572.81"/>
<polygon fill="black" stroke="black" points="448.5,-13572.63 445,-13562.63 441.5,-13572.63 448.5,-13572.63"/>
</g>
<!-- layer71_gate -->
<g id="node362" class="node">
<title>layer71_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-13458.33 191.3,-13458.33 15.57,-13322.33 698.7,-13322.33 874.43,-13458.33"/>
<text text-anchor="middle" x="445" y="-13409.13" font-family="Times,serif" font-size="14.00">Layer 71 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-13394.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13379.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-13364.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer71_out_proj&#45;&gt;layer71_gate -->
<g id="edge361" class="edge">
<title>layer71_out_proj&#45;&gt;layer71_gate</title>
<path fill="none" stroke="black" d="M445,-13494.06C445,-13486.24 445,-13477.57 445,-13468.69"/>
<polygon fill="black" stroke="black" points="448.5,-13468.6 445,-13458.6 441.5,-13468.6 448.5,-13468.6"/>
</g>
<!-- layer71_moe -->
<g id="node363" class="node">
<title>layer71_moe</title>
<polygon fill="lightyellow" stroke="black" points="658,-13286.33 232,-13286.33 232,-13218.33 658,-13218.33 658,-13286.33"/>
<text text-anchor="middle" x="445" y="-13271.13" font-family="Times,serif" font-size="14.00">Layer 71 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-13256.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="445" y="-13241.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-13226.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer71_gate&#45;&gt;layer71_moe -->
<g id="edge362" class="edge">
<title>layer71_gate&#45;&gt;layer71_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-13322.13C445,-13313.38 445,-13304.61 445,-13296.4"/>
<polygon fill="black" stroke="black" points="448.5,-13296.35 445,-13286.35 441.5,-13296.35 448.5,-13296.35"/>
</g>
<!-- comm_2_3 -->
<g id="node364" class="node">
<title>comm_2_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="445" cy="-13134.25" rx="301.46" ry="48.17"/>
<text text-anchor="middle" x="445" y="-13153.05" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="445" y="-13138.05" font-family="Times,serif" font-size="14.00">GPUs: 18&#45;26  27&#45;34</text>
<text text-anchor="middle" x="445" y="-13123.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-13108.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer71_moe&#45;&gt;comm_2_3 -->
<g id="edge363" class="edge">
<title>layer71_moe&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M445,-13218.07C445,-13210.07 445,-13201.31 445,-13192.57"/>
<polygon fill="black" stroke="black" points="448.5,-13192.36 445,-13182.36 441.5,-13192.36 448.5,-13192.36"/>
</g>
<!-- layer72_qkv_proj -->
<g id="node365" class="node">
<title>layer72_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-13032.17 218,-13032.17 218,-12964.17 672,-12964.17 672,-13032.17"/>
<text text-anchor="middle" x="445" y="-13016.97" font-family="Times,serif" font-size="14.00">Layer 72 QKV Projection</text>
<text text-anchor="middle" x="445" y="-13001.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12986.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-12971.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- comm_2_3&#45;&gt;layer72_qkv_proj -->
<g id="edge364" class="edge">
<title>comm_2_3&#45;&gt;layer72_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-13085.98C445,-13071.92 445,-13056.58 445,-13042.77"/>
<polygon fill="black" stroke="black" points="448.5,-13042.55 445,-13032.55 441.5,-13042.55 448.5,-13042.55"/>
</g>
<!-- layer72_attn_comp -->
<g id="node366" class="node">
<title>layer72_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-12928.17 218,-12928.17 218,-12860.17 672,-12860.17 672,-12928.17"/>
<text text-anchor="middle" x="445" y="-12912.97" font-family="Times,serif" font-size="14.00">Layer 72 Attention Computation</text>
<text text-anchor="middle" x="445" y="-12897.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12882.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-12867.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer72_qkv_proj&#45;&gt;layer72_attn_comp -->
<g id="edge365" class="edge">
<title>layer72_qkv_proj&#45;&gt;layer72_attn_comp</title>
<path fill="none" stroke="black" d="M445,-12964.05C445,-12955.94 445,-12947.15 445,-12938.64"/>
<polygon fill="black" stroke="black" points="448.5,-12938.47 445,-12928.47 441.5,-12938.47 448.5,-12938.47"/>
</g>
<!-- layer72_out_proj -->
<g id="node367" class="node">
<title>layer72_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-12824.17 224,-12824.17 224,-12756.17 666,-12756.17 666,-12824.17"/>
<text text-anchor="middle" x="445" y="-12808.97" font-family="Times,serif" font-size="14.00">Layer 72 Output Projection</text>
<text text-anchor="middle" x="445" y="-12793.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12778.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-12763.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer72_attn_comp&#45;&gt;layer72_out_proj -->
<g id="edge366" class="edge">
<title>layer72_attn_comp&#45;&gt;layer72_out_proj</title>
<path fill="none" stroke="black" d="M445,-12860.05C445,-12851.94 445,-12843.15 445,-12834.64"/>
<polygon fill="black" stroke="black" points="448.5,-12834.47 445,-12824.47 441.5,-12834.47 448.5,-12834.47"/>
</g>
<!-- layer72_gate -->
<g id="node368" class="node">
<title>layer72_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-12720.17 191.3,-12720.17 15.57,-12584.17 698.7,-12584.17 874.43,-12720.17"/>
<text text-anchor="middle" x="445" y="-12670.97" font-family="Times,serif" font-size="14.00">Layer 72 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-12655.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12640.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-12625.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer72_out_proj&#45;&gt;layer72_gate -->
<g id="edge367" class="edge">
<title>layer72_out_proj&#45;&gt;layer72_gate</title>
<path fill="none" stroke="black" d="M445,-12755.9C445,-12748.07 445,-12739.4 445,-12730.52"/>
<polygon fill="black" stroke="black" points="448.5,-12730.43 445,-12720.43 441.5,-12730.43 448.5,-12730.43"/>
</g>
<!-- layer72_moe -->
<g id="node369" class="node">
<title>layer72_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-12548.17 232,-12548.17 232,-12480.17 658,-12480.17 658,-12548.17"/>
<text text-anchor="middle" x="445" y="-12532.97" font-family="Times,serif" font-size="14.00">Layer 72 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-12517.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12502.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-12487.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer72_gate&#45;&gt;layer72_moe -->
<g id="edge368" class="edge">
<title>layer72_gate&#45;&gt;layer72_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-12583.96C445,-12575.21 445,-12566.44 445,-12558.23"/>
<polygon fill="black" stroke="black" points="448.5,-12558.18 445,-12548.18 441.5,-12558.18 448.5,-12558.18"/>
</g>
<!-- layer73_qkv_proj -->
<g id="node370" class="node">
<title>layer73_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-12444.17 218,-12444.17 218,-12376.17 672,-12376.17 672,-12444.17"/>
<text text-anchor="middle" x="445" y="-12428.97" font-family="Times,serif" font-size="14.00">Layer 73 QKV Projection</text>
<text text-anchor="middle" x="445" y="-12413.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12398.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-12383.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer72_moe&#45;&gt;layer73_qkv_proj -->
<g id="edge369" class="edge">
<title>layer72_moe&#45;&gt;layer73_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-12480.05C445,-12471.94 445,-12463.15 445,-12454.64"/>
<polygon fill="black" stroke="black" points="448.5,-12454.47 445,-12444.47 441.5,-12454.47 448.5,-12454.47"/>
</g>
<!-- layer73_attn_comp -->
<g id="node371" class="node">
<title>layer73_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-12340.17 218,-12340.17 218,-12272.17 672,-12272.17 672,-12340.17"/>
<text text-anchor="middle" x="445" y="-12324.97" font-family="Times,serif" font-size="14.00">Layer 73 Attention Computation</text>
<text text-anchor="middle" x="445" y="-12309.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12294.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-12279.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer73_qkv_proj&#45;&gt;layer73_attn_comp -->
<g id="edge370" class="edge">
<title>layer73_qkv_proj&#45;&gt;layer73_attn_comp</title>
<path fill="none" stroke="black" d="M445,-12376.05C445,-12367.94 445,-12359.15 445,-12350.64"/>
<polygon fill="black" stroke="black" points="448.5,-12350.47 445,-12340.47 441.5,-12350.47 448.5,-12350.47"/>
</g>
<!-- layer73_out_proj -->
<g id="node372" class="node">
<title>layer73_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-12236.17 224,-12236.17 224,-12168.17 666,-12168.17 666,-12236.17"/>
<text text-anchor="middle" x="445" y="-12220.97" font-family="Times,serif" font-size="14.00">Layer 73 Output Projection</text>
<text text-anchor="middle" x="445" y="-12205.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12190.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-12175.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer73_attn_comp&#45;&gt;layer73_out_proj -->
<g id="edge371" class="edge">
<title>layer73_attn_comp&#45;&gt;layer73_out_proj</title>
<path fill="none" stroke="black" d="M445,-12272.05C445,-12263.94 445,-12255.15 445,-12246.64"/>
<polygon fill="black" stroke="black" points="448.5,-12246.47 445,-12236.47 441.5,-12246.47 448.5,-12246.47"/>
</g>
<!-- layer73_gate -->
<g id="node373" class="node">
<title>layer73_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-12132.17 191.3,-12132.17 15.57,-11996.17 698.7,-11996.17 874.43,-12132.17"/>
<text text-anchor="middle" x="445" y="-12082.97" font-family="Times,serif" font-size="14.00">Layer 73 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-12067.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-12052.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-12037.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer73_out_proj&#45;&gt;layer73_gate -->
<g id="edge372" class="edge">
<title>layer73_out_proj&#45;&gt;layer73_gate</title>
<path fill="none" stroke="black" d="M445,-12167.9C445,-12160.07 445,-12151.4 445,-12142.52"/>
<polygon fill="black" stroke="black" points="448.5,-12142.43 445,-12132.43 441.5,-12142.43 448.5,-12142.43"/>
</g>
<!-- layer73_moe -->
<g id="node374" class="node">
<title>layer73_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-11960.17 232,-11960.17 232,-11892.17 658,-11892.17 658,-11960.17"/>
<text text-anchor="middle" x="445" y="-11944.97" font-family="Times,serif" font-size="14.00">Layer 73 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-11929.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11914.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-11899.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer73_gate&#45;&gt;layer73_moe -->
<g id="edge373" class="edge">
<title>layer73_gate&#45;&gt;layer73_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-11995.96C445,-11987.21 445,-11978.44 445,-11970.23"/>
<polygon fill="black" stroke="black" points="448.5,-11970.18 445,-11960.18 441.5,-11970.18 448.5,-11970.18"/>
</g>
<!-- layer74_qkv_proj -->
<g id="node375" class="node">
<title>layer74_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-11856.17 218,-11856.17 218,-11788.17 672,-11788.17 672,-11856.17"/>
<text text-anchor="middle" x="445" y="-11840.97" font-family="Times,serif" font-size="14.00">Layer 74 QKV Projection</text>
<text text-anchor="middle" x="445" y="-11825.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11810.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-11795.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer73_moe&#45;&gt;layer74_qkv_proj -->
<g id="edge374" class="edge">
<title>layer73_moe&#45;&gt;layer74_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-11892.05C445,-11883.94 445,-11875.15 445,-11866.64"/>
<polygon fill="black" stroke="black" points="448.5,-11866.47 445,-11856.47 441.5,-11866.47 448.5,-11866.47"/>
</g>
<!-- layer74_attn_comp -->
<g id="node376" class="node">
<title>layer74_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-11752.17 218,-11752.17 218,-11684.17 672,-11684.17 672,-11752.17"/>
<text text-anchor="middle" x="445" y="-11736.97" font-family="Times,serif" font-size="14.00">Layer 74 Attention Computation</text>
<text text-anchor="middle" x="445" y="-11721.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11706.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-11691.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer74_qkv_proj&#45;&gt;layer74_attn_comp -->
<g id="edge375" class="edge">
<title>layer74_qkv_proj&#45;&gt;layer74_attn_comp</title>
<path fill="none" stroke="black" d="M445,-11788.05C445,-11779.94 445,-11771.15 445,-11762.64"/>
<polygon fill="black" stroke="black" points="448.5,-11762.47 445,-11752.47 441.5,-11762.47 448.5,-11762.47"/>
</g>
<!-- layer74_out_proj -->
<g id="node377" class="node">
<title>layer74_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-11648.17 224,-11648.17 224,-11580.17 666,-11580.17 666,-11648.17"/>
<text text-anchor="middle" x="445" y="-11632.97" font-family="Times,serif" font-size="14.00">Layer 74 Output Projection</text>
<text text-anchor="middle" x="445" y="-11617.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11602.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-11587.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer74_attn_comp&#45;&gt;layer74_out_proj -->
<g id="edge376" class="edge">
<title>layer74_attn_comp&#45;&gt;layer74_out_proj</title>
<path fill="none" stroke="black" d="M445,-11684.05C445,-11675.94 445,-11667.15 445,-11658.64"/>
<polygon fill="black" stroke="black" points="448.5,-11658.47 445,-11648.47 441.5,-11658.47 448.5,-11658.47"/>
</g>
<!-- layer74_gate -->
<g id="node378" class="node">
<title>layer74_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-11544.17 191.3,-11544.17 15.57,-11408.17 698.7,-11408.17 874.43,-11544.17"/>
<text text-anchor="middle" x="445" y="-11494.97" font-family="Times,serif" font-size="14.00">Layer 74 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-11479.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11464.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-11449.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer74_out_proj&#45;&gt;layer74_gate -->
<g id="edge377" class="edge">
<title>layer74_out_proj&#45;&gt;layer74_gate</title>
<path fill="none" stroke="black" d="M445,-11579.9C445,-11572.07 445,-11563.4 445,-11554.52"/>
<polygon fill="black" stroke="black" points="448.5,-11554.43 445,-11544.43 441.5,-11554.43 448.5,-11554.43"/>
</g>
<!-- layer74_moe -->
<g id="node379" class="node">
<title>layer74_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-11372.17 232,-11372.17 232,-11304.17 658,-11304.17 658,-11372.17"/>
<text text-anchor="middle" x="445" y="-11356.97" font-family="Times,serif" font-size="14.00">Layer 74 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-11341.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11326.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-11311.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer74_gate&#45;&gt;layer74_moe -->
<g id="edge378" class="edge">
<title>layer74_gate&#45;&gt;layer74_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-11407.96C445,-11399.21 445,-11390.44 445,-11382.23"/>
<polygon fill="black" stroke="black" points="448.5,-11382.18 445,-11372.18 441.5,-11382.18 448.5,-11382.18"/>
</g>
<!-- layer75_qkv_proj -->
<g id="node380" class="node">
<title>layer75_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-11268.17 218,-11268.17 218,-11200.17 672,-11200.17 672,-11268.17"/>
<text text-anchor="middle" x="445" y="-11252.97" font-family="Times,serif" font-size="14.00">Layer 75 QKV Projection</text>
<text text-anchor="middle" x="445" y="-11237.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11222.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-11207.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer74_moe&#45;&gt;layer75_qkv_proj -->
<g id="edge379" class="edge">
<title>layer74_moe&#45;&gt;layer75_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-11304.05C445,-11295.94 445,-11287.15 445,-11278.64"/>
<polygon fill="black" stroke="black" points="448.5,-11278.47 445,-11268.47 441.5,-11278.47 448.5,-11278.47"/>
</g>
<!-- layer75_attn_comp -->
<g id="node381" class="node">
<title>layer75_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-11164.17 218,-11164.17 218,-11096.17 672,-11096.17 672,-11164.17"/>
<text text-anchor="middle" x="445" y="-11148.97" font-family="Times,serif" font-size="14.00">Layer 75 Attention Computation</text>
<text text-anchor="middle" x="445" y="-11133.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11118.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-11103.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer75_qkv_proj&#45;&gt;layer75_attn_comp -->
<g id="edge380" class="edge">
<title>layer75_qkv_proj&#45;&gt;layer75_attn_comp</title>
<path fill="none" stroke="black" d="M445,-11200.05C445,-11191.94 445,-11183.15 445,-11174.64"/>
<polygon fill="black" stroke="black" points="448.5,-11174.47 445,-11164.47 441.5,-11174.47 448.5,-11174.47"/>
</g>
<!-- layer75_out_proj -->
<g id="node382" class="node">
<title>layer75_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-11060.17 224,-11060.17 224,-10992.17 666,-10992.17 666,-11060.17"/>
<text text-anchor="middle" x="445" y="-11044.97" font-family="Times,serif" font-size="14.00">Layer 75 Output Projection</text>
<text text-anchor="middle" x="445" y="-11029.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-11014.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-10999.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer75_attn_comp&#45;&gt;layer75_out_proj -->
<g id="edge381" class="edge">
<title>layer75_attn_comp&#45;&gt;layer75_out_proj</title>
<path fill="none" stroke="black" d="M445,-11096.05C445,-11087.94 445,-11079.15 445,-11070.64"/>
<polygon fill="black" stroke="black" points="448.5,-11070.47 445,-11060.47 441.5,-11070.47 448.5,-11070.47"/>
</g>
<!-- layer75_gate -->
<g id="node383" class="node">
<title>layer75_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-10956.17 191.3,-10956.17 15.57,-10820.17 698.7,-10820.17 874.43,-10956.17"/>
<text text-anchor="middle" x="445" y="-10906.97" font-family="Times,serif" font-size="14.00">Layer 75 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-10891.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10876.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-10861.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer75_out_proj&#45;&gt;layer75_gate -->
<g id="edge382" class="edge">
<title>layer75_out_proj&#45;&gt;layer75_gate</title>
<path fill="none" stroke="black" d="M445,-10991.9C445,-10984.07 445,-10975.4 445,-10966.52"/>
<polygon fill="black" stroke="black" points="448.5,-10966.43 445,-10956.43 441.5,-10966.43 448.5,-10966.43"/>
</g>
<!-- layer75_moe -->
<g id="node384" class="node">
<title>layer75_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-10784.17 232,-10784.17 232,-10716.17 658,-10716.17 658,-10784.17"/>
<text text-anchor="middle" x="445" y="-10768.97" font-family="Times,serif" font-size="14.00">Layer 75 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-10753.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-10723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer75_gate&#45;&gt;layer75_moe -->
<g id="edge383" class="edge">
<title>layer75_gate&#45;&gt;layer75_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-10819.96C445,-10811.21 445,-10802.44 445,-10794.23"/>
<polygon fill="black" stroke="black" points="448.5,-10794.18 445,-10784.18 441.5,-10794.18 448.5,-10794.18"/>
</g>
<!-- layer76_qkv_proj -->
<g id="node385" class="node">
<title>layer76_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-10680.17 218,-10680.17 218,-10612.17 672,-10612.17 672,-10680.17"/>
<text text-anchor="middle" x="445" y="-10664.97" font-family="Times,serif" font-size="14.00">Layer 76 QKV Projection</text>
<text text-anchor="middle" x="445" y="-10649.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10634.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-10619.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer75_moe&#45;&gt;layer76_qkv_proj -->
<g id="edge384" class="edge">
<title>layer75_moe&#45;&gt;layer76_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-10716.05C445,-10707.94 445,-10699.15 445,-10690.64"/>
<polygon fill="black" stroke="black" points="448.5,-10690.47 445,-10680.47 441.5,-10690.47 448.5,-10690.47"/>
</g>
<!-- layer76_attn_comp -->
<g id="node386" class="node">
<title>layer76_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-10576.17 218,-10576.17 218,-10508.17 672,-10508.17 672,-10576.17"/>
<text text-anchor="middle" x="445" y="-10560.97" font-family="Times,serif" font-size="14.00">Layer 76 Attention Computation</text>
<text text-anchor="middle" x="445" y="-10545.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10530.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-10515.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer76_qkv_proj&#45;&gt;layer76_attn_comp -->
<g id="edge385" class="edge">
<title>layer76_qkv_proj&#45;&gt;layer76_attn_comp</title>
<path fill="none" stroke="black" d="M445,-10612.05C445,-10603.94 445,-10595.15 445,-10586.64"/>
<polygon fill="black" stroke="black" points="448.5,-10586.47 445,-10576.47 441.5,-10586.47 448.5,-10586.47"/>
</g>
<!-- layer76_out_proj -->
<g id="node387" class="node">
<title>layer76_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-10472.17 224,-10472.17 224,-10404.17 666,-10404.17 666,-10472.17"/>
<text text-anchor="middle" x="445" y="-10456.97" font-family="Times,serif" font-size="14.00">Layer 76 Output Projection</text>
<text text-anchor="middle" x="445" y="-10441.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10426.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-10411.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer76_attn_comp&#45;&gt;layer76_out_proj -->
<g id="edge386" class="edge">
<title>layer76_attn_comp&#45;&gt;layer76_out_proj</title>
<path fill="none" stroke="black" d="M445,-10508.05C445,-10499.94 445,-10491.15 445,-10482.64"/>
<polygon fill="black" stroke="black" points="448.5,-10482.47 445,-10472.47 441.5,-10482.47 448.5,-10482.47"/>
</g>
<!-- layer76_gate -->
<g id="node388" class="node">
<title>layer76_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-10368.17 191.3,-10368.17 15.57,-10232.17 698.7,-10232.17 874.43,-10368.17"/>
<text text-anchor="middle" x="445" y="-10318.97" font-family="Times,serif" font-size="14.00">Layer 76 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-10303.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10288.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-10273.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer76_out_proj&#45;&gt;layer76_gate -->
<g id="edge387" class="edge">
<title>layer76_out_proj&#45;&gt;layer76_gate</title>
<path fill="none" stroke="black" d="M445,-10403.9C445,-10396.07 445,-10387.4 445,-10378.52"/>
<polygon fill="black" stroke="black" points="448.5,-10378.43 445,-10368.43 441.5,-10378.43 448.5,-10378.43"/>
</g>
<!-- layer76_moe -->
<g id="node389" class="node">
<title>layer76_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-10196.17 232,-10196.17 232,-10128.17 658,-10128.17 658,-10196.17"/>
<text text-anchor="middle" x="445" y="-10180.97" font-family="Times,serif" font-size="14.00">Layer 76 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-10165.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10150.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-10135.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer76_gate&#45;&gt;layer76_moe -->
<g id="edge388" class="edge">
<title>layer76_gate&#45;&gt;layer76_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-10231.96C445,-10223.21 445,-10214.44 445,-10206.23"/>
<polygon fill="black" stroke="black" points="448.5,-10206.18 445,-10196.18 441.5,-10206.18 448.5,-10206.18"/>
</g>
<!-- layer77_qkv_proj -->
<g id="node390" class="node">
<title>layer77_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-10092.17 218,-10092.17 218,-10024.17 672,-10024.17 672,-10092.17"/>
<text text-anchor="middle" x="445" y="-10076.97" font-family="Times,serif" font-size="14.00">Layer 77 QKV Projection</text>
<text text-anchor="middle" x="445" y="-10061.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-10046.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-10031.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer76_moe&#45;&gt;layer77_qkv_proj -->
<g id="edge389" class="edge">
<title>layer76_moe&#45;&gt;layer77_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-10128.05C445,-10119.94 445,-10111.15 445,-10102.64"/>
<polygon fill="black" stroke="black" points="448.5,-10102.47 445,-10092.47 441.5,-10102.47 448.5,-10102.47"/>
</g>
<!-- layer77_attn_comp -->
<g id="node391" class="node">
<title>layer77_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-9988.17 218,-9988.17 218,-9920.17 672,-9920.17 672,-9988.17"/>
<text text-anchor="middle" x="445" y="-9972.97" font-family="Times,serif" font-size="14.00">Layer 77 Attention Computation</text>
<text text-anchor="middle" x="445" y="-9957.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9942.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-9927.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer77_qkv_proj&#45;&gt;layer77_attn_comp -->
<g id="edge390" class="edge">
<title>layer77_qkv_proj&#45;&gt;layer77_attn_comp</title>
<path fill="none" stroke="black" d="M445,-10024.05C445,-10015.94 445,-10007.15 445,-9998.64"/>
<polygon fill="black" stroke="black" points="448.5,-9998.47 445,-9988.47 441.5,-9998.47 448.5,-9998.47"/>
</g>
<!-- layer77_out_proj -->
<g id="node392" class="node">
<title>layer77_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-9884.17 224,-9884.17 224,-9816.17 666,-9816.17 666,-9884.17"/>
<text text-anchor="middle" x="445" y="-9868.97" font-family="Times,serif" font-size="14.00">Layer 77 Output Projection</text>
<text text-anchor="middle" x="445" y="-9853.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9838.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-9823.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer77_attn_comp&#45;&gt;layer77_out_proj -->
<g id="edge391" class="edge">
<title>layer77_attn_comp&#45;&gt;layer77_out_proj</title>
<path fill="none" stroke="black" d="M445,-9920.05C445,-9911.94 445,-9903.15 445,-9894.64"/>
<polygon fill="black" stroke="black" points="448.5,-9894.47 445,-9884.47 441.5,-9894.47 448.5,-9894.47"/>
</g>
<!-- layer77_gate -->
<g id="node393" class="node">
<title>layer77_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-9780.17 191.3,-9780.17 15.57,-9644.17 698.7,-9644.17 874.43,-9780.17"/>
<text text-anchor="middle" x="445" y="-9730.97" font-family="Times,serif" font-size="14.00">Layer 77 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-9715.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9700.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-9685.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer77_out_proj&#45;&gt;layer77_gate -->
<g id="edge392" class="edge">
<title>layer77_out_proj&#45;&gt;layer77_gate</title>
<path fill="none" stroke="black" d="M445,-9815.9C445,-9808.07 445,-9799.4 445,-9790.52"/>
<polygon fill="black" stroke="black" points="448.5,-9790.43 445,-9780.43 441.5,-9790.43 448.5,-9790.43"/>
</g>
<!-- layer77_moe -->
<g id="node394" class="node">
<title>layer77_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-9608.17 232,-9608.17 232,-9540.17 658,-9540.17 658,-9608.17"/>
<text text-anchor="middle" x="445" y="-9592.97" font-family="Times,serif" font-size="14.00">Layer 77 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-9577.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9562.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-9547.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer77_gate&#45;&gt;layer77_moe -->
<g id="edge393" class="edge">
<title>layer77_gate&#45;&gt;layer77_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-9643.96C445,-9635.21 445,-9626.44 445,-9618.23"/>
<polygon fill="black" stroke="black" points="448.5,-9618.18 445,-9608.18 441.5,-9618.18 448.5,-9618.18"/>
</g>
<!-- layer78_qkv_proj -->
<g id="node395" class="node">
<title>layer78_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-9504.17 218,-9504.17 218,-9436.17 672,-9436.17 672,-9504.17"/>
<text text-anchor="middle" x="445" y="-9488.97" font-family="Times,serif" font-size="14.00">Layer 78 QKV Projection</text>
<text text-anchor="middle" x="445" y="-9473.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9458.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-9443.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer77_moe&#45;&gt;layer78_qkv_proj -->
<g id="edge394" class="edge">
<title>layer77_moe&#45;&gt;layer78_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-9540.05C445,-9531.94 445,-9523.15 445,-9514.64"/>
<polygon fill="black" stroke="black" points="448.5,-9514.47 445,-9504.47 441.5,-9514.47 448.5,-9514.47"/>
</g>
<!-- layer78_attn_comp -->
<g id="node396" class="node">
<title>layer78_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-9400.17 218,-9400.17 218,-9332.17 672,-9332.17 672,-9400.17"/>
<text text-anchor="middle" x="445" y="-9384.97" font-family="Times,serif" font-size="14.00">Layer 78 Attention Computation</text>
<text text-anchor="middle" x="445" y="-9369.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9354.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-9339.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer78_qkv_proj&#45;&gt;layer78_attn_comp -->
<g id="edge395" class="edge">
<title>layer78_qkv_proj&#45;&gt;layer78_attn_comp</title>
<path fill="none" stroke="black" d="M445,-9436.05C445,-9427.94 445,-9419.15 445,-9410.64"/>
<polygon fill="black" stroke="black" points="448.5,-9410.47 445,-9400.47 441.5,-9410.47 448.5,-9410.47"/>
</g>
<!-- layer78_out_proj -->
<g id="node397" class="node">
<title>layer78_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-9296.17 224,-9296.17 224,-9228.17 666,-9228.17 666,-9296.17"/>
<text text-anchor="middle" x="445" y="-9280.97" font-family="Times,serif" font-size="14.00">Layer 78 Output Projection</text>
<text text-anchor="middle" x="445" y="-9265.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9250.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-9235.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer78_attn_comp&#45;&gt;layer78_out_proj -->
<g id="edge396" class="edge">
<title>layer78_attn_comp&#45;&gt;layer78_out_proj</title>
<path fill="none" stroke="black" d="M445,-9332.05C445,-9323.94 445,-9315.15 445,-9306.64"/>
<polygon fill="black" stroke="black" points="448.5,-9306.47 445,-9296.47 441.5,-9306.47 448.5,-9306.47"/>
</g>
<!-- layer78_gate -->
<g id="node398" class="node">
<title>layer78_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-9192.17 191.3,-9192.17 15.57,-9056.17 698.7,-9056.17 874.43,-9192.17"/>
<text text-anchor="middle" x="445" y="-9142.97" font-family="Times,serif" font-size="14.00">Layer 78 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-9127.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-9112.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-9097.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer78_out_proj&#45;&gt;layer78_gate -->
<g id="edge397" class="edge">
<title>layer78_out_proj&#45;&gt;layer78_gate</title>
<path fill="none" stroke="black" d="M445,-9227.9C445,-9220.07 445,-9211.4 445,-9202.52"/>
<polygon fill="black" stroke="black" points="448.5,-9202.43 445,-9192.43 441.5,-9202.43 448.5,-9202.43"/>
</g>
<!-- layer78_moe -->
<g id="node399" class="node">
<title>layer78_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-9020.17 232,-9020.17 232,-8952.17 658,-8952.17 658,-9020.17"/>
<text text-anchor="middle" x="445" y="-9004.97" font-family="Times,serif" font-size="14.00">Layer 78 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-8989.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-8959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer78_gate&#45;&gt;layer78_moe -->
<g id="edge398" class="edge">
<title>layer78_gate&#45;&gt;layer78_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-9055.96C445,-9047.21 445,-9038.44 445,-9030.23"/>
<polygon fill="black" stroke="black" points="448.5,-9030.18 445,-9020.18 441.5,-9030.18 448.5,-9030.18"/>
</g>
<!-- layer79_qkv_proj -->
<g id="node400" class="node">
<title>layer79_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-8916.17 218,-8916.17 218,-8848.17 672,-8848.17 672,-8916.17"/>
<text text-anchor="middle" x="445" y="-8900.97" font-family="Times,serif" font-size="14.00">Layer 79 QKV Projection</text>
<text text-anchor="middle" x="445" y="-8885.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8870.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-8855.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer78_moe&#45;&gt;layer79_qkv_proj -->
<g id="edge399" class="edge">
<title>layer78_moe&#45;&gt;layer79_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-8952.05C445,-8943.94 445,-8935.15 445,-8926.64"/>
<polygon fill="black" stroke="black" points="448.5,-8926.47 445,-8916.47 441.5,-8926.47 448.5,-8926.47"/>
</g>
<!-- layer79_attn_comp -->
<g id="node401" class="node">
<title>layer79_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-8812.17 218,-8812.17 218,-8744.17 672,-8744.17 672,-8812.17"/>
<text text-anchor="middle" x="445" y="-8796.97" font-family="Times,serif" font-size="14.00">Layer 79 Attention Computation</text>
<text text-anchor="middle" x="445" y="-8781.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8766.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-8751.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer79_qkv_proj&#45;&gt;layer79_attn_comp -->
<g id="edge400" class="edge">
<title>layer79_qkv_proj&#45;&gt;layer79_attn_comp</title>
<path fill="none" stroke="black" d="M445,-8848.05C445,-8839.94 445,-8831.15 445,-8822.64"/>
<polygon fill="black" stroke="black" points="448.5,-8822.47 445,-8812.47 441.5,-8822.47 448.5,-8822.47"/>
</g>
<!-- layer79_out_proj -->
<g id="node402" class="node">
<title>layer79_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-8708.17 224,-8708.17 224,-8640.17 666,-8640.17 666,-8708.17"/>
<text text-anchor="middle" x="445" y="-8692.97" font-family="Times,serif" font-size="14.00">Layer 79 Output Projection</text>
<text text-anchor="middle" x="445" y="-8677.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8662.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-8647.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer79_attn_comp&#45;&gt;layer79_out_proj -->
<g id="edge401" class="edge">
<title>layer79_attn_comp&#45;&gt;layer79_out_proj</title>
<path fill="none" stroke="black" d="M445,-8744.05C445,-8735.94 445,-8727.15 445,-8718.64"/>
<polygon fill="black" stroke="black" points="448.5,-8718.47 445,-8708.47 441.5,-8718.47 448.5,-8718.47"/>
</g>
<!-- layer79_gate -->
<g id="node403" class="node">
<title>layer79_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-8604.17 191.3,-8604.17 15.57,-8468.17 698.7,-8468.17 874.43,-8604.17"/>
<text text-anchor="middle" x="445" y="-8554.97" font-family="Times,serif" font-size="14.00">Layer 79 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-8539.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8524.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-8509.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer79_out_proj&#45;&gt;layer79_gate -->
<g id="edge402" class="edge">
<title>layer79_out_proj&#45;&gt;layer79_gate</title>
<path fill="none" stroke="black" d="M445,-8639.9C445,-8632.07 445,-8623.4 445,-8614.52"/>
<polygon fill="black" stroke="black" points="448.5,-8614.43 445,-8604.43 441.5,-8614.43 448.5,-8614.43"/>
</g>
<!-- layer79_moe -->
<g id="node404" class="node">
<title>layer79_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-8432.17 232,-8432.17 232,-8364.17 658,-8364.17 658,-8432.17"/>
<text text-anchor="middle" x="445" y="-8416.97" font-family="Times,serif" font-size="14.00">Layer 79 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-8401.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8386.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-8371.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer79_gate&#45;&gt;layer79_moe -->
<g id="edge403" class="edge">
<title>layer79_gate&#45;&gt;layer79_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-8467.96C445,-8459.21 445,-8450.44 445,-8442.23"/>
<polygon fill="black" stroke="black" points="448.5,-8442.18 445,-8432.18 441.5,-8442.18 448.5,-8442.18"/>
</g>
<!-- layer80_qkv_proj -->
<g id="node405" class="node">
<title>layer80_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-8328.17 218,-8328.17 218,-8260.17 672,-8260.17 672,-8328.17"/>
<text text-anchor="middle" x="445" y="-8312.97" font-family="Times,serif" font-size="14.00">Layer 80 QKV Projection</text>
<text text-anchor="middle" x="445" y="-8297.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8282.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-8267.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer79_moe&#45;&gt;layer80_qkv_proj -->
<g id="edge404" class="edge">
<title>layer79_moe&#45;&gt;layer80_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-8364.05C445,-8355.94 445,-8347.15 445,-8338.64"/>
<polygon fill="black" stroke="black" points="448.5,-8338.47 445,-8328.47 441.5,-8338.47 448.5,-8338.47"/>
</g>
<!-- layer80_attn_comp -->
<g id="node406" class="node">
<title>layer80_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-8224.17 218,-8224.17 218,-8156.17 672,-8156.17 672,-8224.17"/>
<text text-anchor="middle" x="445" y="-8208.97" font-family="Times,serif" font-size="14.00">Layer 80 Attention Computation</text>
<text text-anchor="middle" x="445" y="-8193.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8178.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-8163.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer80_qkv_proj&#45;&gt;layer80_attn_comp -->
<g id="edge405" class="edge">
<title>layer80_qkv_proj&#45;&gt;layer80_attn_comp</title>
<path fill="none" stroke="black" d="M445,-8260.05C445,-8251.94 445,-8243.15 445,-8234.64"/>
<polygon fill="black" stroke="black" points="448.5,-8234.47 445,-8224.47 441.5,-8234.47 448.5,-8234.47"/>
</g>
<!-- layer80_out_proj -->
<g id="node407" class="node">
<title>layer80_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-8120.17 224,-8120.17 224,-8052.17 666,-8052.17 666,-8120.17"/>
<text text-anchor="middle" x="445" y="-8104.97" font-family="Times,serif" font-size="14.00">Layer 80 Output Projection</text>
<text text-anchor="middle" x="445" y="-8089.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-8074.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-8059.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer80_attn_comp&#45;&gt;layer80_out_proj -->
<g id="edge406" class="edge">
<title>layer80_attn_comp&#45;&gt;layer80_out_proj</title>
<path fill="none" stroke="black" d="M445,-8156.05C445,-8147.94 445,-8139.15 445,-8130.64"/>
<polygon fill="black" stroke="black" points="448.5,-8130.47 445,-8120.47 441.5,-8130.47 448.5,-8130.47"/>
</g>
<!-- layer80_gate -->
<g id="node408" class="node">
<title>layer80_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-8016.17 191.3,-8016.17 15.57,-7880.17 698.7,-7880.17 874.43,-8016.17"/>
<text text-anchor="middle" x="445" y="-7966.97" font-family="Times,serif" font-size="14.00">Layer 80 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-7951.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7936.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-7921.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer80_out_proj&#45;&gt;layer80_gate -->
<g id="edge407" class="edge">
<title>layer80_out_proj&#45;&gt;layer80_gate</title>
<path fill="none" stroke="black" d="M445,-8051.9C445,-8044.07 445,-8035.4 445,-8026.52"/>
<polygon fill="black" stroke="black" points="448.5,-8026.43 445,-8016.43 441.5,-8026.43 448.5,-8026.43"/>
</g>
<!-- layer80_moe -->
<g id="node409" class="node">
<title>layer80_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-7844.17 232,-7844.17 232,-7776.17 658,-7776.17 658,-7844.17"/>
<text text-anchor="middle" x="445" y="-7828.97" font-family="Times,serif" font-size="14.00">Layer 80 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-7813.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7798.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-7783.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer80_gate&#45;&gt;layer80_moe -->
<g id="edge408" class="edge">
<title>layer80_gate&#45;&gt;layer80_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-7879.96C445,-7871.21 445,-7862.44 445,-7854.23"/>
<polygon fill="black" stroke="black" points="448.5,-7854.18 445,-7844.18 441.5,-7854.18 448.5,-7854.18"/>
</g>
<!-- layer81_qkv_proj -->
<g id="node410" class="node">
<title>layer81_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-7740.17 218,-7740.17 218,-7672.17 672,-7672.17 672,-7740.17"/>
<text text-anchor="middle" x="445" y="-7724.97" font-family="Times,serif" font-size="14.00">Layer 81 QKV Projection</text>
<text text-anchor="middle" x="445" y="-7709.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7694.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-7679.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer80_moe&#45;&gt;layer81_qkv_proj -->
<g id="edge409" class="edge">
<title>layer80_moe&#45;&gt;layer81_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-7776.05C445,-7767.94 445,-7759.15 445,-7750.64"/>
<polygon fill="black" stroke="black" points="448.5,-7750.47 445,-7740.47 441.5,-7750.47 448.5,-7750.47"/>
</g>
<!-- layer81_attn_comp -->
<g id="node411" class="node">
<title>layer81_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-7636.17 218,-7636.17 218,-7568.17 672,-7568.17 672,-7636.17"/>
<text text-anchor="middle" x="445" y="-7620.97" font-family="Times,serif" font-size="14.00">Layer 81 Attention Computation</text>
<text text-anchor="middle" x="445" y="-7605.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7590.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-7575.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer81_qkv_proj&#45;&gt;layer81_attn_comp -->
<g id="edge410" class="edge">
<title>layer81_qkv_proj&#45;&gt;layer81_attn_comp</title>
<path fill="none" stroke="black" d="M445,-7672.05C445,-7663.94 445,-7655.15 445,-7646.64"/>
<polygon fill="black" stroke="black" points="448.5,-7646.47 445,-7636.47 441.5,-7646.47 448.5,-7646.47"/>
</g>
<!-- layer81_out_proj -->
<g id="node412" class="node">
<title>layer81_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-7532.17 224,-7532.17 224,-7464.17 666,-7464.17 666,-7532.17"/>
<text text-anchor="middle" x="445" y="-7516.97" font-family="Times,serif" font-size="14.00">Layer 81 Output Projection</text>
<text text-anchor="middle" x="445" y="-7501.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7486.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-7471.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer81_attn_comp&#45;&gt;layer81_out_proj -->
<g id="edge411" class="edge">
<title>layer81_attn_comp&#45;&gt;layer81_out_proj</title>
<path fill="none" stroke="black" d="M445,-7568.05C445,-7559.94 445,-7551.15 445,-7542.64"/>
<polygon fill="black" stroke="black" points="448.5,-7542.47 445,-7532.47 441.5,-7542.47 448.5,-7542.47"/>
</g>
<!-- layer81_gate -->
<g id="node413" class="node">
<title>layer81_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-7428.17 191.3,-7428.17 15.57,-7292.17 698.7,-7292.17 874.43,-7428.17"/>
<text text-anchor="middle" x="445" y="-7378.97" font-family="Times,serif" font-size="14.00">Layer 81 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-7363.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-7333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer81_out_proj&#45;&gt;layer81_gate -->
<g id="edge412" class="edge">
<title>layer81_out_proj&#45;&gt;layer81_gate</title>
<path fill="none" stroke="black" d="M445,-7463.9C445,-7456.07 445,-7447.4 445,-7438.52"/>
<polygon fill="black" stroke="black" points="448.5,-7438.43 445,-7428.43 441.5,-7438.43 448.5,-7438.43"/>
</g>
<!-- layer81_moe -->
<g id="node414" class="node">
<title>layer81_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-7256.17 232,-7256.17 232,-7188.17 658,-7188.17 658,-7256.17"/>
<text text-anchor="middle" x="445" y="-7240.97" font-family="Times,serif" font-size="14.00">Layer 81 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-7225.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7210.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-7195.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer81_gate&#45;&gt;layer81_moe -->
<g id="edge413" class="edge">
<title>layer81_gate&#45;&gt;layer81_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-7291.96C445,-7283.21 445,-7274.44 445,-7266.23"/>
<polygon fill="black" stroke="black" points="448.5,-7266.18 445,-7256.18 441.5,-7266.18 448.5,-7266.18"/>
</g>
<!-- layer82_qkv_proj -->
<g id="node415" class="node">
<title>layer82_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-7152.17 218,-7152.17 218,-7084.17 672,-7084.17 672,-7152.17"/>
<text text-anchor="middle" x="445" y="-7136.97" font-family="Times,serif" font-size="14.00">Layer 82 QKV Projection</text>
<text text-anchor="middle" x="445" y="-7121.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7106.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-7091.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer81_moe&#45;&gt;layer82_qkv_proj -->
<g id="edge414" class="edge">
<title>layer81_moe&#45;&gt;layer82_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-7188.05C445,-7179.94 445,-7171.15 445,-7162.64"/>
<polygon fill="black" stroke="black" points="448.5,-7162.47 445,-7152.47 441.5,-7162.47 448.5,-7162.47"/>
</g>
<!-- layer82_attn_comp -->
<g id="node416" class="node">
<title>layer82_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-7048.17 218,-7048.17 218,-6980.17 672,-6980.17 672,-7048.17"/>
<text text-anchor="middle" x="445" y="-7032.97" font-family="Times,serif" font-size="14.00">Layer 82 Attention Computation</text>
<text text-anchor="middle" x="445" y="-7017.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-7002.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-6987.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer82_qkv_proj&#45;&gt;layer82_attn_comp -->
<g id="edge415" class="edge">
<title>layer82_qkv_proj&#45;&gt;layer82_attn_comp</title>
<path fill="none" stroke="black" d="M445,-7084.05C445,-7075.94 445,-7067.15 445,-7058.64"/>
<polygon fill="black" stroke="black" points="448.5,-7058.47 445,-7048.47 441.5,-7058.47 448.5,-7058.47"/>
</g>
<!-- layer82_out_proj -->
<g id="node417" class="node">
<title>layer82_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-6944.17 224,-6944.17 224,-6876.17 666,-6876.17 666,-6944.17"/>
<text text-anchor="middle" x="445" y="-6928.97" font-family="Times,serif" font-size="14.00">Layer 82 Output Projection</text>
<text text-anchor="middle" x="445" y="-6913.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6898.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-6883.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer82_attn_comp&#45;&gt;layer82_out_proj -->
<g id="edge416" class="edge">
<title>layer82_attn_comp&#45;&gt;layer82_out_proj</title>
<path fill="none" stroke="black" d="M445,-6980.05C445,-6971.94 445,-6963.15 445,-6954.64"/>
<polygon fill="black" stroke="black" points="448.5,-6954.47 445,-6944.47 441.5,-6954.47 448.5,-6954.47"/>
</g>
<!-- layer82_gate -->
<g id="node418" class="node">
<title>layer82_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-6840.17 191.3,-6840.17 15.57,-6704.17 698.7,-6704.17 874.43,-6840.17"/>
<text text-anchor="middle" x="445" y="-6790.97" font-family="Times,serif" font-size="14.00">Layer 82 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-6775.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6760.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-6745.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer82_out_proj&#45;&gt;layer82_gate -->
<g id="edge417" class="edge">
<title>layer82_out_proj&#45;&gt;layer82_gate</title>
<path fill="none" stroke="black" d="M445,-6875.9C445,-6868.07 445,-6859.4 445,-6850.52"/>
<polygon fill="black" stroke="black" points="448.5,-6850.43 445,-6840.43 441.5,-6850.43 448.5,-6850.43"/>
</g>
<!-- layer82_moe -->
<g id="node419" class="node">
<title>layer82_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-6668.17 232,-6668.17 232,-6600.17 658,-6600.17 658,-6668.17"/>
<text text-anchor="middle" x="445" y="-6652.97" font-family="Times,serif" font-size="14.00">Layer 82 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-6637.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6622.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-6607.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer82_gate&#45;&gt;layer82_moe -->
<g id="edge418" class="edge">
<title>layer82_gate&#45;&gt;layer82_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-6703.96C445,-6695.21 445,-6686.44 445,-6678.23"/>
<polygon fill="black" stroke="black" points="448.5,-6678.18 445,-6668.18 441.5,-6678.18 448.5,-6678.18"/>
</g>
<!-- layer83_qkv_proj -->
<g id="node420" class="node">
<title>layer83_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-6564.17 218,-6564.17 218,-6496.17 672,-6496.17 672,-6564.17"/>
<text text-anchor="middle" x="445" y="-6548.97" font-family="Times,serif" font-size="14.00">Layer 83 QKV Projection</text>
<text text-anchor="middle" x="445" y="-6533.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6518.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-6503.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer82_moe&#45;&gt;layer83_qkv_proj -->
<g id="edge419" class="edge">
<title>layer82_moe&#45;&gt;layer83_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-6600.05C445,-6591.94 445,-6583.15 445,-6574.64"/>
<polygon fill="black" stroke="black" points="448.5,-6574.47 445,-6564.47 441.5,-6574.47 448.5,-6574.47"/>
</g>
<!-- layer83_attn_comp -->
<g id="node421" class="node">
<title>layer83_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-6460.17 218,-6460.17 218,-6392.17 672,-6392.17 672,-6460.17"/>
<text text-anchor="middle" x="445" y="-6444.97" font-family="Times,serif" font-size="14.00">Layer 83 Attention Computation</text>
<text text-anchor="middle" x="445" y="-6429.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6414.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-6399.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer83_qkv_proj&#45;&gt;layer83_attn_comp -->
<g id="edge420" class="edge">
<title>layer83_qkv_proj&#45;&gt;layer83_attn_comp</title>
<path fill="none" stroke="black" d="M445,-6496.05C445,-6487.94 445,-6479.15 445,-6470.64"/>
<polygon fill="black" stroke="black" points="448.5,-6470.47 445,-6460.47 441.5,-6470.47 448.5,-6470.47"/>
</g>
<!-- layer83_out_proj -->
<g id="node422" class="node">
<title>layer83_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-6356.17 224,-6356.17 224,-6288.17 666,-6288.17 666,-6356.17"/>
<text text-anchor="middle" x="445" y="-6340.97" font-family="Times,serif" font-size="14.00">Layer 83 Output Projection</text>
<text text-anchor="middle" x="445" y="-6325.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6310.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-6295.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer83_attn_comp&#45;&gt;layer83_out_proj -->
<g id="edge421" class="edge">
<title>layer83_attn_comp&#45;&gt;layer83_out_proj</title>
<path fill="none" stroke="black" d="M445,-6392.05C445,-6383.94 445,-6375.15 445,-6366.64"/>
<polygon fill="black" stroke="black" points="448.5,-6366.47 445,-6356.47 441.5,-6366.47 448.5,-6366.47"/>
</g>
<!-- layer83_gate -->
<g id="node423" class="node">
<title>layer83_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-6252.17 191.3,-6252.17 15.57,-6116.17 698.7,-6116.17 874.43,-6252.17"/>
<text text-anchor="middle" x="445" y="-6202.97" font-family="Times,serif" font-size="14.00">Layer 83 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-6187.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6172.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-6157.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer83_out_proj&#45;&gt;layer83_gate -->
<g id="edge422" class="edge">
<title>layer83_out_proj&#45;&gt;layer83_gate</title>
<path fill="none" stroke="black" d="M445,-6287.9C445,-6280.07 445,-6271.4 445,-6262.52"/>
<polygon fill="black" stroke="black" points="448.5,-6262.43 445,-6252.43 441.5,-6262.43 448.5,-6262.43"/>
</g>
<!-- layer83_moe -->
<g id="node424" class="node">
<title>layer83_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-6080.17 232,-6080.17 232,-6012.17 658,-6012.17 658,-6080.17"/>
<text text-anchor="middle" x="445" y="-6064.97" font-family="Times,serif" font-size="14.00">Layer 83 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-6049.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-6034.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-6019.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer83_gate&#45;&gt;layer83_moe -->
<g id="edge423" class="edge">
<title>layer83_gate&#45;&gt;layer83_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-6115.96C445,-6107.21 445,-6098.44 445,-6090.23"/>
<polygon fill="black" stroke="black" points="448.5,-6090.18 445,-6080.18 441.5,-6090.18 448.5,-6090.18"/>
</g>
<!-- layer84_qkv_proj -->
<g id="node425" class="node">
<title>layer84_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-5976.17 218,-5976.17 218,-5908.17 672,-5908.17 672,-5976.17"/>
<text text-anchor="middle" x="445" y="-5960.97" font-family="Times,serif" font-size="14.00">Layer 84 QKV Projection</text>
<text text-anchor="middle" x="445" y="-5945.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5930.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-5915.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer83_moe&#45;&gt;layer84_qkv_proj -->
<g id="edge424" class="edge">
<title>layer83_moe&#45;&gt;layer84_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-6012.05C445,-6003.94 445,-5995.15 445,-5986.64"/>
<polygon fill="black" stroke="black" points="448.5,-5986.47 445,-5976.47 441.5,-5986.47 448.5,-5986.47"/>
</g>
<!-- layer84_attn_comp -->
<g id="node426" class="node">
<title>layer84_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-5872.17 218,-5872.17 218,-5804.17 672,-5804.17 672,-5872.17"/>
<text text-anchor="middle" x="445" y="-5856.97" font-family="Times,serif" font-size="14.00">Layer 84 Attention Computation</text>
<text text-anchor="middle" x="445" y="-5841.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5826.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-5811.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer84_qkv_proj&#45;&gt;layer84_attn_comp -->
<g id="edge425" class="edge">
<title>layer84_qkv_proj&#45;&gt;layer84_attn_comp</title>
<path fill="none" stroke="black" d="M445,-5908.05C445,-5899.94 445,-5891.15 445,-5882.64"/>
<polygon fill="black" stroke="black" points="448.5,-5882.47 445,-5872.47 441.5,-5882.47 448.5,-5882.47"/>
</g>
<!-- layer84_out_proj -->
<g id="node427" class="node">
<title>layer84_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-5768.17 224,-5768.17 224,-5700.17 666,-5700.17 666,-5768.17"/>
<text text-anchor="middle" x="445" y="-5752.97" font-family="Times,serif" font-size="14.00">Layer 84 Output Projection</text>
<text text-anchor="middle" x="445" y="-5737.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5722.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-5707.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer84_attn_comp&#45;&gt;layer84_out_proj -->
<g id="edge426" class="edge">
<title>layer84_attn_comp&#45;&gt;layer84_out_proj</title>
<path fill="none" stroke="black" d="M445,-5804.05C445,-5795.94 445,-5787.15 445,-5778.64"/>
<polygon fill="black" stroke="black" points="448.5,-5778.47 445,-5768.47 441.5,-5778.47 448.5,-5778.47"/>
</g>
<!-- layer84_gate -->
<g id="node428" class="node">
<title>layer84_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-5664.17 191.3,-5664.17 15.57,-5528.17 698.7,-5528.17 874.43,-5664.17"/>
<text text-anchor="middle" x="445" y="-5614.97" font-family="Times,serif" font-size="14.00">Layer 84 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-5599.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5584.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-5569.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer84_out_proj&#45;&gt;layer84_gate -->
<g id="edge427" class="edge">
<title>layer84_out_proj&#45;&gt;layer84_gate</title>
<path fill="none" stroke="black" d="M445,-5699.9C445,-5692.07 445,-5683.4 445,-5674.52"/>
<polygon fill="black" stroke="black" points="448.5,-5674.43 445,-5664.43 441.5,-5674.43 448.5,-5674.43"/>
</g>
<!-- layer84_moe -->
<g id="node429" class="node">
<title>layer84_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-5492.17 232,-5492.17 232,-5424.17 658,-5424.17 658,-5492.17"/>
<text text-anchor="middle" x="445" y="-5476.97" font-family="Times,serif" font-size="14.00">Layer 84 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-5461.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5446.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-5431.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer84_gate&#45;&gt;layer84_moe -->
<g id="edge428" class="edge">
<title>layer84_gate&#45;&gt;layer84_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-5527.96C445,-5519.21 445,-5510.44 445,-5502.23"/>
<polygon fill="black" stroke="black" points="448.5,-5502.18 445,-5492.18 441.5,-5502.18 448.5,-5502.18"/>
</g>
<!-- layer85_qkv_proj -->
<g id="node430" class="node">
<title>layer85_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-5388.17 218,-5388.17 218,-5320.17 672,-5320.17 672,-5388.17"/>
<text text-anchor="middle" x="445" y="-5372.97" font-family="Times,serif" font-size="14.00">Layer 85 QKV Projection</text>
<text text-anchor="middle" x="445" y="-5357.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5342.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-5327.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer84_moe&#45;&gt;layer85_qkv_proj -->
<g id="edge429" class="edge">
<title>layer84_moe&#45;&gt;layer85_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-5424.05C445,-5415.94 445,-5407.15 445,-5398.64"/>
<polygon fill="black" stroke="black" points="448.5,-5398.47 445,-5388.47 441.5,-5398.47 448.5,-5398.47"/>
</g>
<!-- layer85_attn_comp -->
<g id="node431" class="node">
<title>layer85_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-5284.17 218,-5284.17 218,-5216.17 672,-5216.17 672,-5284.17"/>
<text text-anchor="middle" x="445" y="-5268.97" font-family="Times,serif" font-size="14.00">Layer 85 Attention Computation</text>
<text text-anchor="middle" x="445" y="-5253.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5238.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-5223.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer85_qkv_proj&#45;&gt;layer85_attn_comp -->
<g id="edge430" class="edge">
<title>layer85_qkv_proj&#45;&gt;layer85_attn_comp</title>
<path fill="none" stroke="black" d="M445,-5320.05C445,-5311.94 445,-5303.15 445,-5294.64"/>
<polygon fill="black" stroke="black" points="448.5,-5294.47 445,-5284.47 441.5,-5294.47 448.5,-5294.47"/>
</g>
<!-- layer85_out_proj -->
<g id="node432" class="node">
<title>layer85_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-5180.17 224,-5180.17 224,-5112.17 666,-5112.17 666,-5180.17"/>
<text text-anchor="middle" x="445" y="-5164.97" font-family="Times,serif" font-size="14.00">Layer 85 Output Projection</text>
<text text-anchor="middle" x="445" y="-5149.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-5134.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-5119.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer85_attn_comp&#45;&gt;layer85_out_proj -->
<g id="edge431" class="edge">
<title>layer85_attn_comp&#45;&gt;layer85_out_proj</title>
<path fill="none" stroke="black" d="M445,-5216.05C445,-5207.94 445,-5199.15 445,-5190.64"/>
<polygon fill="black" stroke="black" points="448.5,-5190.47 445,-5180.47 441.5,-5190.47 448.5,-5190.47"/>
</g>
<!-- layer85_gate -->
<g id="node433" class="node">
<title>layer85_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-5076.17 191.3,-5076.17 15.57,-4940.17 698.7,-4940.17 874.43,-5076.17"/>
<text text-anchor="middle" x="445" y="-5026.97" font-family="Times,serif" font-size="14.00">Layer 85 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-5011.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4996.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-4981.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer85_out_proj&#45;&gt;layer85_gate -->
<g id="edge432" class="edge">
<title>layer85_out_proj&#45;&gt;layer85_gate</title>
<path fill="none" stroke="black" d="M445,-5111.9C445,-5104.07 445,-5095.4 445,-5086.52"/>
<polygon fill="black" stroke="black" points="448.5,-5086.43 445,-5076.43 441.5,-5086.43 448.5,-5086.43"/>
</g>
<!-- layer85_moe -->
<g id="node434" class="node">
<title>layer85_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-4904.17 232,-4904.17 232,-4836.17 658,-4836.17 658,-4904.17"/>
<text text-anchor="middle" x="445" y="-4888.97" font-family="Times,serif" font-size="14.00">Layer 85 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-4873.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4858.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-4843.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer85_gate&#45;&gt;layer85_moe -->
<g id="edge433" class="edge">
<title>layer85_gate&#45;&gt;layer85_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-4939.96C445,-4931.21 445,-4922.44 445,-4914.23"/>
<polygon fill="black" stroke="black" points="448.5,-4914.18 445,-4904.18 441.5,-4914.18 448.5,-4914.18"/>
</g>
<!-- layer86_qkv_proj -->
<g id="node435" class="node">
<title>layer86_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-4800.17 218,-4800.17 218,-4732.17 672,-4732.17 672,-4800.17"/>
<text text-anchor="middle" x="445" y="-4784.97" font-family="Times,serif" font-size="14.00">Layer 86 QKV Projection</text>
<text text-anchor="middle" x="445" y="-4769.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4754.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-4739.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer85_moe&#45;&gt;layer86_qkv_proj -->
<g id="edge434" class="edge">
<title>layer85_moe&#45;&gt;layer86_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-4836.05C445,-4827.94 445,-4819.15 445,-4810.64"/>
<polygon fill="black" stroke="black" points="448.5,-4810.47 445,-4800.47 441.5,-4810.47 448.5,-4810.47"/>
</g>
<!-- layer86_attn_comp -->
<g id="node436" class="node">
<title>layer86_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-4696.17 218,-4696.17 218,-4628.17 672,-4628.17 672,-4696.17"/>
<text text-anchor="middle" x="445" y="-4680.97" font-family="Times,serif" font-size="14.00">Layer 86 Attention Computation</text>
<text text-anchor="middle" x="445" y="-4665.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4650.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-4635.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer86_qkv_proj&#45;&gt;layer86_attn_comp -->
<g id="edge435" class="edge">
<title>layer86_qkv_proj&#45;&gt;layer86_attn_comp</title>
<path fill="none" stroke="black" d="M445,-4732.05C445,-4723.94 445,-4715.15 445,-4706.64"/>
<polygon fill="black" stroke="black" points="448.5,-4706.47 445,-4696.47 441.5,-4706.47 448.5,-4706.47"/>
</g>
<!-- layer86_out_proj -->
<g id="node437" class="node">
<title>layer86_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-4592.17 224,-4592.17 224,-4524.17 666,-4524.17 666,-4592.17"/>
<text text-anchor="middle" x="445" y="-4576.97" font-family="Times,serif" font-size="14.00">Layer 86 Output Projection</text>
<text text-anchor="middle" x="445" y="-4561.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4546.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-4531.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer86_attn_comp&#45;&gt;layer86_out_proj -->
<g id="edge436" class="edge">
<title>layer86_attn_comp&#45;&gt;layer86_out_proj</title>
<path fill="none" stroke="black" d="M445,-4628.05C445,-4619.94 445,-4611.15 445,-4602.64"/>
<polygon fill="black" stroke="black" points="448.5,-4602.47 445,-4592.47 441.5,-4602.47 448.5,-4602.47"/>
</g>
<!-- layer86_gate -->
<g id="node438" class="node">
<title>layer86_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-4488.17 191.3,-4488.17 15.57,-4352.17 698.7,-4352.17 874.43,-4488.17"/>
<text text-anchor="middle" x="445" y="-4438.97" font-family="Times,serif" font-size="14.00">Layer 86 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-4423.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4408.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-4393.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer86_out_proj&#45;&gt;layer86_gate -->
<g id="edge437" class="edge">
<title>layer86_out_proj&#45;&gt;layer86_gate</title>
<path fill="none" stroke="black" d="M445,-4523.9C445,-4516.07 445,-4507.4 445,-4498.52"/>
<polygon fill="black" stroke="black" points="448.5,-4498.43 445,-4488.43 441.5,-4498.43 448.5,-4498.43"/>
</g>
<!-- layer86_moe -->
<g id="node439" class="node">
<title>layer86_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-4316.17 232,-4316.17 232,-4248.17 658,-4248.17 658,-4316.17"/>
<text text-anchor="middle" x="445" y="-4300.97" font-family="Times,serif" font-size="14.00">Layer 86 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-4285.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4270.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-4255.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer86_gate&#45;&gt;layer86_moe -->
<g id="edge438" class="edge">
<title>layer86_gate&#45;&gt;layer86_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-4351.96C445,-4343.21 445,-4334.44 445,-4326.23"/>
<polygon fill="black" stroke="black" points="448.5,-4326.18 445,-4316.18 441.5,-4326.18 448.5,-4326.18"/>
</g>
<!-- layer87_qkv_proj -->
<g id="node440" class="node">
<title>layer87_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-4212.17 218,-4212.17 218,-4144.17 672,-4144.17 672,-4212.17"/>
<text text-anchor="middle" x="445" y="-4196.97" font-family="Times,serif" font-size="14.00">Layer 87 QKV Projection</text>
<text text-anchor="middle" x="445" y="-4181.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer86_moe&#45;&gt;layer87_qkv_proj -->
<g id="edge439" class="edge">
<title>layer86_moe&#45;&gt;layer87_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-4248.05C445,-4239.94 445,-4231.15 445,-4222.64"/>
<polygon fill="black" stroke="black" points="448.5,-4222.47 445,-4212.47 441.5,-4222.47 448.5,-4222.47"/>
</g>
<!-- layer87_attn_comp -->
<g id="node441" class="node">
<title>layer87_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-4108.17 218,-4108.17 218,-4040.17 672,-4040.17 672,-4108.17"/>
<text text-anchor="middle" x="445" y="-4092.97" font-family="Times,serif" font-size="14.00">Layer 87 Attention Computation</text>
<text text-anchor="middle" x="445" y="-4077.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-4062.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-4047.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer87_qkv_proj&#45;&gt;layer87_attn_comp -->
<g id="edge440" class="edge">
<title>layer87_qkv_proj&#45;&gt;layer87_attn_comp</title>
<path fill="none" stroke="black" d="M445,-4144.05C445,-4135.94 445,-4127.15 445,-4118.64"/>
<polygon fill="black" stroke="black" points="448.5,-4118.47 445,-4108.47 441.5,-4118.47 448.5,-4118.47"/>
</g>
<!-- layer87_out_proj -->
<g id="node442" class="node">
<title>layer87_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-4004.17 224,-4004.17 224,-3936.17 666,-3936.17 666,-4004.17"/>
<text text-anchor="middle" x="445" y="-3988.97" font-family="Times,serif" font-size="14.00">Layer 87 Output Projection</text>
<text text-anchor="middle" x="445" y="-3973.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3958.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-3943.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer87_attn_comp&#45;&gt;layer87_out_proj -->
<g id="edge441" class="edge">
<title>layer87_attn_comp&#45;&gt;layer87_out_proj</title>
<path fill="none" stroke="black" d="M445,-4040.05C445,-4031.94 445,-4023.15 445,-4014.64"/>
<polygon fill="black" stroke="black" points="448.5,-4014.47 445,-4004.47 441.5,-4014.47 448.5,-4014.47"/>
</g>
<!-- layer87_gate -->
<g id="node443" class="node">
<title>layer87_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-3900.17 191.3,-3900.17 15.57,-3764.17 698.7,-3764.17 874.43,-3900.17"/>
<text text-anchor="middle" x="445" y="-3850.97" font-family="Times,serif" font-size="14.00">Layer 87 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-3835.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3820.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-3805.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer87_out_proj&#45;&gt;layer87_gate -->
<g id="edge442" class="edge">
<title>layer87_out_proj&#45;&gt;layer87_gate</title>
<path fill="none" stroke="black" d="M445,-3935.9C445,-3928.07 445,-3919.4 445,-3910.52"/>
<polygon fill="black" stroke="black" points="448.5,-3910.43 445,-3900.43 441.5,-3910.43 448.5,-3910.43"/>
</g>
<!-- layer87_moe -->
<g id="node444" class="node">
<title>layer87_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-3728.17 232,-3728.17 232,-3660.17 658,-3660.17 658,-3728.17"/>
<text text-anchor="middle" x="445" y="-3712.97" font-family="Times,serif" font-size="14.00">Layer 87 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-3697.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3682.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-3667.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer87_gate&#45;&gt;layer87_moe -->
<g id="edge443" class="edge">
<title>layer87_gate&#45;&gt;layer87_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-3763.96C445,-3755.21 445,-3746.44 445,-3738.23"/>
<polygon fill="black" stroke="black" points="448.5,-3738.18 445,-3728.18 441.5,-3738.18 448.5,-3738.18"/>
</g>
<!-- layer88_qkv_proj -->
<g id="node445" class="node">
<title>layer88_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-3624.17 218,-3624.17 218,-3556.17 672,-3556.17 672,-3624.17"/>
<text text-anchor="middle" x="445" y="-3608.97" font-family="Times,serif" font-size="14.00">Layer 88 QKV Projection</text>
<text text-anchor="middle" x="445" y="-3593.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3578.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-3563.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer87_moe&#45;&gt;layer88_qkv_proj -->
<g id="edge444" class="edge">
<title>layer87_moe&#45;&gt;layer88_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-3660.05C445,-3651.94 445,-3643.15 445,-3634.64"/>
<polygon fill="black" stroke="black" points="448.5,-3634.47 445,-3624.47 441.5,-3634.47 448.5,-3634.47"/>
</g>
<!-- layer88_attn_comp -->
<g id="node446" class="node">
<title>layer88_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-3520.17 218,-3520.17 218,-3452.17 672,-3452.17 672,-3520.17"/>
<text text-anchor="middle" x="445" y="-3504.97" font-family="Times,serif" font-size="14.00">Layer 88 Attention Computation</text>
<text text-anchor="middle" x="445" y="-3489.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3474.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-3459.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer88_qkv_proj&#45;&gt;layer88_attn_comp -->
<g id="edge445" class="edge">
<title>layer88_qkv_proj&#45;&gt;layer88_attn_comp</title>
<path fill="none" stroke="black" d="M445,-3556.05C445,-3547.94 445,-3539.15 445,-3530.64"/>
<polygon fill="black" stroke="black" points="448.5,-3530.47 445,-3520.47 441.5,-3530.47 448.5,-3530.47"/>
</g>
<!-- layer88_out_proj -->
<g id="node447" class="node">
<title>layer88_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-3416.17 224,-3416.17 224,-3348.17 666,-3348.17 666,-3416.17"/>
<text text-anchor="middle" x="445" y="-3400.97" font-family="Times,serif" font-size="14.00">Layer 88 Output Projection</text>
<text text-anchor="middle" x="445" y="-3385.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3370.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-3355.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer88_attn_comp&#45;&gt;layer88_out_proj -->
<g id="edge446" class="edge">
<title>layer88_attn_comp&#45;&gt;layer88_out_proj</title>
<path fill="none" stroke="black" d="M445,-3452.05C445,-3443.94 445,-3435.15 445,-3426.64"/>
<polygon fill="black" stroke="black" points="448.5,-3426.47 445,-3416.47 441.5,-3426.47 448.5,-3426.47"/>
</g>
<!-- layer88_gate -->
<g id="node448" class="node">
<title>layer88_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-3312.17 191.3,-3312.17 15.57,-3176.17 698.7,-3176.17 874.43,-3312.17"/>
<text text-anchor="middle" x="445" y="-3262.97" font-family="Times,serif" font-size="14.00">Layer 88 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-3247.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3232.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-3217.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer88_out_proj&#45;&gt;layer88_gate -->
<g id="edge447" class="edge">
<title>layer88_out_proj&#45;&gt;layer88_gate</title>
<path fill="none" stroke="black" d="M445,-3347.9C445,-3340.07 445,-3331.4 445,-3322.52"/>
<polygon fill="black" stroke="black" points="448.5,-3322.43 445,-3312.43 441.5,-3322.43 448.5,-3322.43"/>
</g>
<!-- layer88_moe -->
<g id="node449" class="node">
<title>layer88_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-3140.17 232,-3140.17 232,-3072.17 658,-3072.17 658,-3140.17"/>
<text text-anchor="middle" x="445" y="-3124.97" font-family="Times,serif" font-size="14.00">Layer 88 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-3109.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-3094.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-3079.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer88_gate&#45;&gt;layer88_moe -->
<g id="edge448" class="edge">
<title>layer88_gate&#45;&gt;layer88_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-3175.96C445,-3167.21 445,-3158.44 445,-3150.23"/>
<polygon fill="black" stroke="black" points="448.5,-3150.18 445,-3140.18 441.5,-3150.18 448.5,-3150.18"/>
</g>
<!-- layer89_qkv_proj -->
<g id="node450" class="node">
<title>layer89_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-3036.17 218,-3036.17 218,-2968.17 672,-2968.17 672,-3036.17"/>
<text text-anchor="middle" x="445" y="-3020.97" font-family="Times,serif" font-size="14.00">Layer 89 QKV Projection</text>
<text text-anchor="middle" x="445" y="-3005.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2990.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-2975.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer88_moe&#45;&gt;layer89_qkv_proj -->
<g id="edge449" class="edge">
<title>layer88_moe&#45;&gt;layer89_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-3072.05C445,-3063.94 445,-3055.15 445,-3046.64"/>
<polygon fill="black" stroke="black" points="448.5,-3046.47 445,-3036.47 441.5,-3046.47 448.5,-3046.47"/>
</g>
<!-- layer89_attn_comp -->
<g id="node451" class="node">
<title>layer89_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-2932.17 218,-2932.17 218,-2864.17 672,-2864.17 672,-2932.17"/>
<text text-anchor="middle" x="445" y="-2916.97" font-family="Times,serif" font-size="14.00">Layer 89 Attention Computation</text>
<text text-anchor="middle" x="445" y="-2901.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2886.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-2871.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer89_qkv_proj&#45;&gt;layer89_attn_comp -->
<g id="edge450" class="edge">
<title>layer89_qkv_proj&#45;&gt;layer89_attn_comp</title>
<path fill="none" stroke="black" d="M445,-2968.05C445,-2959.94 445,-2951.15 445,-2942.64"/>
<polygon fill="black" stroke="black" points="448.5,-2942.47 445,-2932.47 441.5,-2942.47 448.5,-2942.47"/>
</g>
<!-- layer89_out_proj -->
<g id="node452" class="node">
<title>layer89_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-2828.17 224,-2828.17 224,-2760.17 666,-2760.17 666,-2828.17"/>
<text text-anchor="middle" x="445" y="-2812.97" font-family="Times,serif" font-size="14.00">Layer 89 Output Projection</text>
<text text-anchor="middle" x="445" y="-2797.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2782.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-2767.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer89_attn_comp&#45;&gt;layer89_out_proj -->
<g id="edge451" class="edge">
<title>layer89_attn_comp&#45;&gt;layer89_out_proj</title>
<path fill="none" stroke="black" d="M445,-2864.05C445,-2855.94 445,-2847.15 445,-2838.64"/>
<polygon fill="black" stroke="black" points="448.5,-2838.47 445,-2828.47 441.5,-2838.47 448.5,-2838.47"/>
</g>
<!-- layer89_gate -->
<g id="node453" class="node">
<title>layer89_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-2724.17 191.3,-2724.17 15.57,-2588.17 698.7,-2588.17 874.43,-2724.17"/>
<text text-anchor="middle" x="445" y="-2674.97" font-family="Times,serif" font-size="14.00">Layer 89 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2644.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-2629.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer89_out_proj&#45;&gt;layer89_gate -->
<g id="edge452" class="edge">
<title>layer89_out_proj&#45;&gt;layer89_gate</title>
<path fill="none" stroke="black" d="M445,-2759.9C445,-2752.07 445,-2743.4 445,-2734.52"/>
<polygon fill="black" stroke="black" points="448.5,-2734.43 445,-2724.43 441.5,-2734.43 448.5,-2734.43"/>
</g>
<!-- layer89_moe -->
<g id="node454" class="node">
<title>layer89_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-2552.17 232,-2552.17 232,-2484.17 658,-2484.17 658,-2552.17"/>
<text text-anchor="middle" x="445" y="-2536.97" font-family="Times,serif" font-size="14.00">Layer 89 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-2521.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2506.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-2491.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer89_gate&#45;&gt;layer89_moe -->
<g id="edge453" class="edge">
<title>layer89_gate&#45;&gt;layer89_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-2587.96C445,-2579.21 445,-2570.44 445,-2562.23"/>
<polygon fill="black" stroke="black" points="448.5,-2562.18 445,-2552.18 441.5,-2562.18 448.5,-2562.18"/>
</g>
<!-- layer90_qkv_proj -->
<g id="node455" class="node">
<title>layer90_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-2448.17 218,-2448.17 218,-2380.17 672,-2380.17 672,-2448.17"/>
<text text-anchor="middle" x="445" y="-2432.97" font-family="Times,serif" font-size="14.00">Layer 90 QKV Projection</text>
<text text-anchor="middle" x="445" y="-2417.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2402.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-2387.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer89_moe&#45;&gt;layer90_qkv_proj -->
<g id="edge454" class="edge">
<title>layer89_moe&#45;&gt;layer90_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-2484.05C445,-2475.94 445,-2467.15 445,-2458.64"/>
<polygon fill="black" stroke="black" points="448.5,-2458.47 445,-2448.47 441.5,-2458.47 448.5,-2458.47"/>
</g>
<!-- layer90_attn_comp -->
<g id="node456" class="node">
<title>layer90_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-2344.17 218,-2344.17 218,-2276.17 672,-2276.17 672,-2344.17"/>
<text text-anchor="middle" x="445" y="-2328.97" font-family="Times,serif" font-size="14.00">Layer 90 Attention Computation</text>
<text text-anchor="middle" x="445" y="-2313.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2298.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-2283.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer90_qkv_proj&#45;&gt;layer90_attn_comp -->
<g id="edge455" class="edge">
<title>layer90_qkv_proj&#45;&gt;layer90_attn_comp</title>
<path fill="none" stroke="black" d="M445,-2380.05C445,-2371.94 445,-2363.15 445,-2354.64"/>
<polygon fill="black" stroke="black" points="448.5,-2354.47 445,-2344.47 441.5,-2354.47 448.5,-2354.47"/>
</g>
<!-- layer90_out_proj -->
<g id="node457" class="node">
<title>layer90_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-2240.17 224,-2240.17 224,-2172.17 666,-2172.17 666,-2240.17"/>
<text text-anchor="middle" x="445" y="-2224.97" font-family="Times,serif" font-size="14.00">Layer 90 Output Projection</text>
<text text-anchor="middle" x="445" y="-2209.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2194.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-2179.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer90_attn_comp&#45;&gt;layer90_out_proj -->
<g id="edge456" class="edge">
<title>layer90_attn_comp&#45;&gt;layer90_out_proj</title>
<path fill="none" stroke="black" d="M445,-2276.05C445,-2267.94 445,-2259.15 445,-2250.64"/>
<polygon fill="black" stroke="black" points="448.5,-2250.47 445,-2240.47 441.5,-2250.47 448.5,-2250.47"/>
</g>
<!-- layer90_gate -->
<g id="node458" class="node">
<title>layer90_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-2136.17 191.3,-2136.17 15.57,-2000.17 698.7,-2000.17 874.43,-2136.17"/>
<text text-anchor="middle" x="445" y="-2086.97" font-family="Times,serif" font-size="14.00">Layer 90 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-2071.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-2056.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-2041.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer90_out_proj&#45;&gt;layer90_gate -->
<g id="edge457" class="edge">
<title>layer90_out_proj&#45;&gt;layer90_gate</title>
<path fill="none" stroke="black" d="M445,-2171.9C445,-2164.07 445,-2155.4 445,-2146.52"/>
<polygon fill="black" stroke="black" points="448.5,-2146.43 445,-2136.43 441.5,-2146.43 448.5,-2146.43"/>
</g>
<!-- layer90_moe -->
<g id="node459" class="node">
<title>layer90_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-1964.17 232,-1964.17 232,-1896.17 658,-1896.17 658,-1964.17"/>
<text text-anchor="middle" x="445" y="-1948.97" font-family="Times,serif" font-size="14.00">Layer 90 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-1933.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1918.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-1903.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer90_gate&#45;&gt;layer90_moe -->
<g id="edge458" class="edge">
<title>layer90_gate&#45;&gt;layer90_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-1999.96C445,-1991.21 445,-1982.44 445,-1974.23"/>
<polygon fill="black" stroke="black" points="448.5,-1974.18 445,-1964.18 441.5,-1974.18 448.5,-1974.18"/>
</g>
<!-- layer91_qkv_proj -->
<g id="node460" class="node">
<title>layer91_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-1860.17 218,-1860.17 218,-1792.17 672,-1792.17 672,-1860.17"/>
<text text-anchor="middle" x="445" y="-1844.97" font-family="Times,serif" font-size="14.00">Layer 91 QKV Projection</text>
<text text-anchor="middle" x="445" y="-1829.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1814.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-1799.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer90_moe&#45;&gt;layer91_qkv_proj -->
<g id="edge459" class="edge">
<title>layer90_moe&#45;&gt;layer91_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-1896.05C445,-1887.94 445,-1879.15 445,-1870.64"/>
<polygon fill="black" stroke="black" points="448.5,-1870.47 445,-1860.47 441.5,-1870.47 448.5,-1870.47"/>
</g>
<!-- layer91_attn_comp -->
<g id="node461" class="node">
<title>layer91_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-1756.17 218,-1756.17 218,-1688.17 672,-1688.17 672,-1756.17"/>
<text text-anchor="middle" x="445" y="-1740.97" font-family="Times,serif" font-size="14.00">Layer 91 Attention Computation</text>
<text text-anchor="middle" x="445" y="-1725.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1710.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-1695.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer91_qkv_proj&#45;&gt;layer91_attn_comp -->
<g id="edge460" class="edge">
<title>layer91_qkv_proj&#45;&gt;layer91_attn_comp</title>
<path fill="none" stroke="black" d="M445,-1792.05C445,-1783.94 445,-1775.15 445,-1766.64"/>
<polygon fill="black" stroke="black" points="448.5,-1766.47 445,-1756.47 441.5,-1766.47 448.5,-1766.47"/>
</g>
<!-- layer91_out_proj -->
<g id="node462" class="node">
<title>layer91_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-1652.17 224,-1652.17 224,-1584.17 666,-1584.17 666,-1652.17"/>
<text text-anchor="middle" x="445" y="-1636.97" font-family="Times,serif" font-size="14.00">Layer 91 Output Projection</text>
<text text-anchor="middle" x="445" y="-1621.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1606.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-1591.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer91_attn_comp&#45;&gt;layer91_out_proj -->
<g id="edge461" class="edge">
<title>layer91_attn_comp&#45;&gt;layer91_out_proj</title>
<path fill="none" stroke="black" d="M445,-1688.05C445,-1679.94 445,-1671.15 445,-1662.64"/>
<polygon fill="black" stroke="black" points="448.5,-1662.47 445,-1652.47 441.5,-1662.47 448.5,-1662.47"/>
</g>
<!-- layer91_gate -->
<g id="node463" class="node">
<title>layer91_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-1548.17 191.3,-1548.17 15.57,-1412.17 698.7,-1412.17 874.43,-1548.17"/>
<text text-anchor="middle" x="445" y="-1498.97" font-family="Times,serif" font-size="14.00">Layer 91 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-1483.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1468.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-1453.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer91_out_proj&#45;&gt;layer91_gate -->
<g id="edge462" class="edge">
<title>layer91_out_proj&#45;&gt;layer91_gate</title>
<path fill="none" stroke="black" d="M445,-1583.9C445,-1576.07 445,-1567.4 445,-1558.52"/>
<polygon fill="black" stroke="black" points="448.5,-1558.43 445,-1548.43 441.5,-1558.43 448.5,-1558.43"/>
</g>
<!-- layer91_moe -->
<g id="node464" class="node">
<title>layer91_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-1376.17 232,-1376.17 232,-1308.17 658,-1308.17 658,-1376.17"/>
<text text-anchor="middle" x="445" y="-1360.97" font-family="Times,serif" font-size="14.00">Layer 91 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-1345.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1330.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-1315.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer91_gate&#45;&gt;layer91_moe -->
<g id="edge463" class="edge">
<title>layer91_gate&#45;&gt;layer91_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-1411.96C445,-1403.21 445,-1394.44 445,-1386.23"/>
<polygon fill="black" stroke="black" points="448.5,-1386.18 445,-1376.18 441.5,-1386.18 448.5,-1386.18"/>
</g>
<!-- layer92_qkv_proj -->
<g id="node465" class="node">
<title>layer92_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-1272.17 218,-1272.17 218,-1204.17 672,-1204.17 672,-1272.17"/>
<text text-anchor="middle" x="445" y="-1256.97" font-family="Times,serif" font-size="14.00">Layer 92 QKV Projection</text>
<text text-anchor="middle" x="445" y="-1241.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1226.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-1211.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer91_moe&#45;&gt;layer92_qkv_proj -->
<g id="edge464" class="edge">
<title>layer91_moe&#45;&gt;layer92_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-1308.05C445,-1299.94 445,-1291.15 445,-1282.64"/>
<polygon fill="black" stroke="black" points="448.5,-1282.47 445,-1272.47 441.5,-1282.47 448.5,-1282.47"/>
</g>
<!-- layer92_attn_comp -->
<g id="node466" class="node">
<title>layer92_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-1168.17 218,-1168.17 218,-1100.17 672,-1100.17 672,-1168.17"/>
<text text-anchor="middle" x="445" y="-1152.97" font-family="Times,serif" font-size="14.00">Layer 92 Attention Computation</text>
<text text-anchor="middle" x="445" y="-1137.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1122.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-1107.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer92_qkv_proj&#45;&gt;layer92_attn_comp -->
<g id="edge465" class="edge">
<title>layer92_qkv_proj&#45;&gt;layer92_attn_comp</title>
<path fill="none" stroke="black" d="M445,-1204.05C445,-1195.94 445,-1187.15 445,-1178.64"/>
<polygon fill="black" stroke="black" points="448.5,-1178.47 445,-1168.47 441.5,-1178.47 448.5,-1178.47"/>
</g>
<!-- layer92_out_proj -->
<g id="node467" class="node">
<title>layer92_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-1064.17 224,-1064.17 224,-996.17 666,-996.17 666,-1064.17"/>
<text text-anchor="middle" x="445" y="-1048.97" font-family="Times,serif" font-size="14.00">Layer 92 Output Projection</text>
<text text-anchor="middle" x="445" y="-1033.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-1018.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-1003.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer92_attn_comp&#45;&gt;layer92_out_proj -->
<g id="edge466" class="edge">
<title>layer92_attn_comp&#45;&gt;layer92_out_proj</title>
<path fill="none" stroke="black" d="M445,-1100.05C445,-1091.94 445,-1083.15 445,-1074.64"/>
<polygon fill="black" stroke="black" points="448.5,-1074.47 445,-1064.47 441.5,-1074.47 448.5,-1074.47"/>
</g>
<!-- layer92_gate -->
<g id="node468" class="node">
<title>layer92_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-960.17 191.3,-960.17 15.57,-824.17 698.7,-824.17 874.43,-960.17"/>
<text text-anchor="middle" x="445" y="-910.97" font-family="Times,serif" font-size="14.00">Layer 92 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-895.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-880.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-865.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer92_out_proj&#45;&gt;layer92_gate -->
<g id="edge467" class="edge">
<title>layer92_out_proj&#45;&gt;layer92_gate</title>
<path fill="none" stroke="black" d="M445,-995.9C445,-988.07 445,-979.4 445,-970.52"/>
<polygon fill="black" stroke="black" points="448.5,-970.43 445,-960.43 441.5,-970.43 448.5,-970.43"/>
</g>
<!-- layer92_moe -->
<g id="node469" class="node">
<title>layer92_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-788.17 232,-788.17 232,-720.17 658,-720.17 658,-788.17"/>
<text text-anchor="middle" x="445" y="-772.97" font-family="Times,serif" font-size="14.00">Layer 92 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-757.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-742.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-727.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer92_gate&#45;&gt;layer92_moe -->
<g id="edge468" class="edge">
<title>layer92_gate&#45;&gt;layer92_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-823.96C445,-815.21 445,-806.44 445,-798.23"/>
<polygon fill="black" stroke="black" points="448.5,-798.18 445,-788.18 441.5,-798.18 448.5,-798.18"/>
</g>
<!-- layer93_qkv_proj -->
<g id="node470" class="node">
<title>layer93_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="672,-684.17 218,-684.17 218,-616.17 672,-616.17 672,-684.17"/>
<text text-anchor="middle" x="445" y="-668.97" font-family="Times,serif" font-size="14.00">Layer 93 QKV Projection</text>
<text text-anchor="middle" x="445" y="-653.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-638.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-623.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer92_moe&#45;&gt;layer93_qkv_proj -->
<g id="edge469" class="edge">
<title>layer92_moe&#45;&gt;layer93_qkv_proj</title>
<path fill="none" stroke="black" d="M445,-720.05C445,-711.94 445,-703.15 445,-694.64"/>
<polygon fill="black" stroke="black" points="448.5,-694.47 445,-684.47 441.5,-694.47 448.5,-694.47"/>
</g>
<!-- layer93_attn_comp -->
<g id="node471" class="node">
<title>layer93_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="672,-580.17 218,-580.17 218,-512.17 672,-512.17 672,-580.17"/>
<text text-anchor="middle" x="445" y="-564.97" font-family="Times,serif" font-size="14.00">Layer 93 Attention Computation</text>
<text text-anchor="middle" x="445" y="-549.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-534.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-519.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- layer93_qkv_proj&#45;&gt;layer93_attn_comp -->
<g id="edge470" class="edge">
<title>layer93_qkv_proj&#45;&gt;layer93_attn_comp</title>
<path fill="none" stroke="black" d="M445,-616.05C445,-607.94 445,-599.15 445,-590.64"/>
<polygon fill="black" stroke="black" points="448.5,-590.47 445,-580.47 441.5,-590.47 448.5,-590.47"/>
</g>
<!-- layer93_out_proj -->
<g id="node472" class="node">
<title>layer93_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="666,-476.17 224,-476.17 224,-408.17 666,-408.17 666,-476.17"/>
<text text-anchor="middle" x="445" y="-460.97" font-family="Times,serif" font-size="14.00">Layer 93 Output Projection</text>
<text text-anchor="middle" x="445" y="-445.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-430.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="445" y="-415.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer93_attn_comp&#45;&gt;layer93_out_proj -->
<g id="edge471" class="edge">
<title>layer93_attn_comp&#45;&gt;layer93_out_proj</title>
<path fill="none" stroke="black" d="M445,-512.05C445,-503.94 445,-495.15 445,-486.64"/>
<polygon fill="black" stroke="black" points="448.5,-486.47 445,-476.47 441.5,-486.47 448.5,-486.47"/>
</g>
<!-- layer93_gate -->
<g id="node473" class="node">
<title>layer93_gate</title>
<polygon fill="orange" stroke="black" points="874.43,-372.17 191.3,-372.17 15.57,-236.17 698.7,-236.17 874.43,-372.17"/>
<text text-anchor="middle" x="445" y="-322.97" font-family="Times,serif" font-size="14.00">Layer 93 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="445" y="-307.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-292.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-277.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, top_k=8]</text>
</g>
<!-- layer93_out_proj&#45;&gt;layer93_gate -->
<g id="edge472" class="edge">
<title>layer93_out_proj&#45;&gt;layer93_gate</title>
<path fill="none" stroke="black" d="M445,-407.9C445,-400.07 445,-391.4 445,-382.52"/>
<polygon fill="black" stroke="black" points="448.5,-382.43 445,-372.43 441.5,-382.43 448.5,-382.43"/>
</g>
<!-- layer93_moe -->
<g id="node474" class="node">
<title>layer93_moe</title>
<polygon fill="lightcoral" stroke="black" points="658,-200.17 232,-200.17 232,-132.17 658,-132.17 658,-200.17"/>
<text text-anchor="middle" x="445" y="-184.97" font-family="Times,serif" font-size="14.00">Layer 93 MoE (128 experts)</text>
<text text-anchor="middle" x="445" y="-169.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-154.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-139.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- layer93_gate&#45;&gt;layer93_moe -->
<g id="edge473" class="edge">
<title>layer93_gate&#45;&gt;layer93_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M445,-235.96C445,-227.21 445,-218.44 445,-210.23"/>
<polygon fill="black" stroke="black" points="448.5,-210.18 445,-200.18 441.5,-210.18 448.5,-210.18"/>
</g>
<!-- output -->
<g id="node475" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="445" cy="-48.08" rx="325.95" ry="48.17"/>
<text text-anchor="middle" x="445" y="-66.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="445" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="445" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="445" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=2048, vocab_size=151936]</text>
</g>
<!-- layer93_moe&#45;&gt;output -->
<g id="edge474" class="edge">
<title>layer93_moe&#45;&gt;output</title>
<path fill="none" stroke="black" d="M445,-131.9C445,-123.91 445,-115.14 445,-106.4"/>
<polygon fill="black" stroke="black" points="448.5,-106.19 445,-96.19 441.5,-106.19 448.5,-106.19"/>
</g>
</g>
</svg>
