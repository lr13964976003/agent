<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="47pt" height="2880pt"
 viewBox="0.00 0.00 46.52 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 56712.83)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-56712.83 912.2,-56712.83 912.2,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="black" d="M57.1,-42160.67C57.1,-42160.67 851.1,-42160.67 851.1,-42160.67 857.1,-42160.67 863.1,-42166.67 863.1,-42172.67 863.1,-42172.67 863.1,-56278.67 863.1,-56278.67 863.1,-56284.67 857.1,-56290.67 851.1,-56290.67 851.1,-56290.67 57.1,-56290.67 57.1,-56290.67 51.1,-56290.67 45.1,-56284.67 45.1,-56278.67 45.1,-56278.67 45.1,-42172.67 45.1,-42172.67 45.1,-42166.67 51.1,-42160.67 57.1,-42160.67"/>
<text text-anchor="middle" x="454.1" y="-56275.47" font-family="Times,serif" font-size="14.00">Stage 0: Layers 0&#45;23</text>
<text text-anchor="middle" x="454.1" y="-56260.47" font-family="Times,serif" font-size="14.00">GPUs 0&#45;8</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M57.1,-27756.5C57.1,-27756.5 851.1,-27756.5 851.1,-27756.5 857.1,-27756.5 863.1,-27762.5 863.1,-27768.5 863.1,-27768.5 863.1,-41874.5 863.1,-41874.5 863.1,-41880.5 857.1,-41886.5 851.1,-41886.5 851.1,-41886.5 57.1,-41886.5 57.1,-41886.5 51.1,-41886.5 45.1,-41880.5 45.1,-41874.5 45.1,-41874.5 45.1,-27768.5 45.1,-27768.5 45.1,-27762.5 51.1,-27756.5 57.1,-27756.5"/>
<text text-anchor="middle" x="454.1" y="-41871.3" font-family="Times,serif" font-size="14.00">Stage 1: Layers 24&#45;47</text>
<text text-anchor="middle" x="454.1" y="-41856.3" font-family="Times,serif" font-size="14.00">GPUs 9&#45;17</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="none" stroke="black" d="M57.1,-13352.33C57.1,-13352.33 851.1,-13352.33 851.1,-13352.33 857.1,-13352.33 863.1,-13358.33 863.1,-13364.33 863.1,-13364.33 863.1,-27470.33 863.1,-27470.33 863.1,-27476.33 857.1,-27482.33 851.1,-27482.33 851.1,-27482.33 57.1,-27482.33 57.1,-27482.33 51.1,-27482.33 45.1,-27476.33 45.1,-27470.33 45.1,-27470.33 45.1,-13364.33 45.1,-13364.33 45.1,-13358.33 51.1,-13352.33 57.1,-13352.33"/>
<text text-anchor="middle" x="454.1" y="-27467.13" font-family="Times,serif" font-size="14.00">Stage 2: Layers 48&#45;71</text>
<text text-anchor="middle" x="454.1" y="-27452.13" font-family="Times,serif" font-size="14.00">GPUs 18&#45;26</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="none" stroke="black" d="M57.1,-124.17C57.1,-124.17 851.1,-124.17 851.1,-124.17 857.1,-124.17 863.1,-130.17 863.1,-136.17 863.1,-136.17 863.1,-13066.17 863.1,-13066.17 863.1,-13072.17 857.1,-13078.17 851.1,-13078.17 851.1,-13078.17 57.1,-13078.17 57.1,-13078.17 51.1,-13078.17 45.1,-13072.17 45.1,-13066.17 45.1,-13066.17 45.1,-136.17 45.1,-136.17 45.1,-130.17 51.1,-124.17 57.1,-124.17"/>
<text text-anchor="middle" x="454.1" y="-13062.97" font-family="Times,serif" font-size="14.00">Stage 3: Layers 72&#45;93</text>
<text text-anchor="middle" x="454.1" y="-13047.97" font-family="Times,serif" font-size="14.00">GPUs 27&#45;34</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgray" stroke="black" cx="454.1" cy="-56660.75" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="454.1" y="-56679.55" font-family="Times,serif" font-size="14.00">Input Token Embedding</text>
<text text-anchor="middle" x="454.1" y="-56664.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;34</text>
<text text-anchor="middle" x="454.1" y="-56649.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-56634.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- kv_cache -->
<g id="node2" class="node">
<title>kv_cache</title>
<polygon fill="lightpink" stroke="black" points="908.29,-56576.67 185.77,-56576.67 -0.1,-56440.67 722.43,-56440.67 908.29,-56576.67"/>
<text text-anchor="middle" x="454.1" y="-56527.47" font-family="Times,serif" font-size="14.00">KV Cache Storage</text>
<text text-anchor="middle" x="454.1" y="-56512.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;34</text>
<text text-anchor="middle" x="454.1" y="-56497.47" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-56482.47" font-family="Times,serif" font-size="14.00">Hit Rate: 95%+</text>
</g>
<!-- input&#45;&gt;kv_cache -->
<g id="edge1" class="edge">
<title>input&#45;&gt;kv_cache</title>
<path fill="none" stroke="black" d="M454.1,-56612.26C454.1,-56604.18 454.1,-56595.59 454.1,-56586.97"/>
<polygon fill="black" stroke="black" points="457.6,-56586.86 454.1,-56576.86 450.6,-56586.86 457.6,-56586.86"/>
</g>
<!-- kv_access_0 -->
<g id="node123" class="node">
<title>kv_access_0</title>
<polygon fill="lightcyan" stroke="black" points="908.29,-56404.67 185.77,-56404.67 -0.1,-56298.67 722.43,-56298.67 908.29,-56404.67"/>
<text text-anchor="middle" x="454.1" y="-56362.97" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="454.1" y="-56347.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-56332.97" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- kv_cache&#45;&gt;kv_access_0 -->
<g id="edge2" class="edge">
<title>kv_cache&#45;&gt;kv_access_0</title>
<path fill="none" stroke="black" d="M454.1,-56440.58C454.1,-56432.09 454.1,-56423.43 454.1,-56415.01"/>
<polygon fill="black" stroke="black" points="457.6,-56414.9 454.1,-56404.9 450.6,-56414.9 457.6,-56414.9"/>
</g>
<!-- layer0_qkv_proj -->
<g id="node3" class="node">
<title>layer0_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-56244.67 240.6,-56244.67 240.6,-56176.67 667.6,-56176.67 667.6,-56244.67"/>
<text text-anchor="middle" x="454.1" y="-56229.47" font-family="Times,serif" font-size="14.00">Layer 0 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-56214.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-56199.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-56184.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer0_attn_comp -->
<g id="node4" class="node">
<title>layer0_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-56140.67 240.6,-56140.67 240.6,-56072.67 667.6,-56072.67 667.6,-56140.67"/>
<text text-anchor="middle" x="454.1" y="-56125.47" font-family="Times,serif" font-size="14.00">Layer 0 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-56110.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-56095.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-56080.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer0_qkv_proj&#45;&gt;layer0_attn_comp -->
<g id="edge4" class="edge">
<title>layer0_qkv_proj&#45;&gt;layer0_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-56176.55C454.1,-56168.44 454.1,-56159.65 454.1,-56151.14"/>
<polygon fill="black" stroke="black" points="457.6,-56150.97 454.1,-56140.97 450.6,-56150.97 457.6,-56150.97"/>
</g>
<!-- layer0_out_proj -->
<g id="node5" class="node">
<title>layer0_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-56036.67 246.6,-56036.67 246.6,-55968.67 661.6,-55968.67 661.6,-56036.67"/>
<text text-anchor="middle" x="454.1" y="-56021.47" font-family="Times,serif" font-size="14.00">Layer 0 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-56006.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55991.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-55976.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer0_attn_comp&#45;&gt;layer0_out_proj -->
<g id="edge5" class="edge">
<title>layer0_attn_comp&#45;&gt;layer0_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-56072.55C454.1,-56064.44 454.1,-56055.65 454.1,-56047.14"/>
<polygon fill="black" stroke="black" points="457.6,-56046.97 454.1,-56036.97 450.6,-56046.97 457.6,-56046.97"/>
</g>
<!-- layer0_gate -->
<g id="node6" class="node">
<title>layer0_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-55932.67 216.93,-55932.67 52.65,-55796.67 691.26,-55796.67 855.54,-55932.67"/>
<text text-anchor="middle" x="454.1" y="-55883.47" font-family="Times,serif" font-size="14.00">Layer 0 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-55868.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55853.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-55838.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer0_out_proj&#45;&gt;layer0_gate -->
<g id="edge6" class="edge">
<title>layer0_out_proj&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M454.1,-55968.4C454.1,-55960.57 454.1,-55951.9 454.1,-55943.02"/>
<polygon fill="black" stroke="black" points="457.6,-55942.93 454.1,-55932.93 450.6,-55942.93 457.6,-55942.93"/>
</g>
<!-- layer0_moe -->
<g id="node7" class="node">
<title>layer0_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-55760.67 254.6,-55760.67 254.6,-55692.67 653.6,-55692.67 653.6,-55760.67"/>
<text text-anchor="middle" x="454.1" y="-55745.47" font-family="Times,serif" font-size="14.00">Layer 0 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-55730.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55715.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-55700.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer0_gate&#45;&gt;layer0_moe -->
<g id="edge7" class="edge">
<title>layer0_gate&#45;&gt;layer0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-55796.46C454.1,-55787.71 454.1,-55778.94 454.1,-55770.73"/>
<polygon fill="black" stroke="black" points="457.6,-55770.68 454.1,-55760.68 450.6,-55770.68 457.6,-55770.68"/>
</g>
<!-- layer1_qkv_proj -->
<g id="node8" class="node">
<title>layer1_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-55656.67 240.6,-55656.67 240.6,-55588.67 667.6,-55588.67 667.6,-55656.67"/>
<text text-anchor="middle" x="454.1" y="-55641.47" font-family="Times,serif" font-size="14.00">Layer 1 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-55626.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55611.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-55596.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer0_moe&#45;&gt;layer1_qkv_proj -->
<g id="edge8" class="edge">
<title>layer0_moe&#45;&gt;layer1_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-55692.55C454.1,-55684.44 454.1,-55675.65 454.1,-55667.14"/>
<polygon fill="black" stroke="black" points="457.6,-55666.97 454.1,-55656.97 450.6,-55666.97 457.6,-55666.97"/>
</g>
<!-- layer1_attn_comp -->
<g id="node9" class="node">
<title>layer1_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-55552.67 240.6,-55552.67 240.6,-55484.67 667.6,-55484.67 667.6,-55552.67"/>
<text text-anchor="middle" x="454.1" y="-55537.47" font-family="Times,serif" font-size="14.00">Layer 1 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-55522.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55507.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-55492.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer1_qkv_proj&#45;&gt;layer1_attn_comp -->
<g id="edge9" class="edge">
<title>layer1_qkv_proj&#45;&gt;layer1_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-55588.55C454.1,-55580.44 454.1,-55571.65 454.1,-55563.14"/>
<polygon fill="black" stroke="black" points="457.6,-55562.97 454.1,-55552.97 450.6,-55562.97 457.6,-55562.97"/>
</g>
<!-- layer1_out_proj -->
<g id="node10" class="node">
<title>layer1_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-55448.67 246.6,-55448.67 246.6,-55380.67 661.6,-55380.67 661.6,-55448.67"/>
<text text-anchor="middle" x="454.1" y="-55433.47" font-family="Times,serif" font-size="14.00">Layer 1 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-55418.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55403.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-55388.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer1_attn_comp&#45;&gt;layer1_out_proj -->
<g id="edge10" class="edge">
<title>layer1_attn_comp&#45;&gt;layer1_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-55484.55C454.1,-55476.44 454.1,-55467.65 454.1,-55459.14"/>
<polygon fill="black" stroke="black" points="457.6,-55458.97 454.1,-55448.97 450.6,-55458.97 457.6,-55458.97"/>
</g>
<!-- layer1_gate -->
<g id="node11" class="node">
<title>layer1_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-55344.67 216.93,-55344.67 52.65,-55208.67 691.26,-55208.67 855.54,-55344.67"/>
<text text-anchor="middle" x="454.1" y="-55295.47" font-family="Times,serif" font-size="14.00">Layer 1 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-55280.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55265.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-55250.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer1_out_proj&#45;&gt;layer1_gate -->
<g id="edge11" class="edge">
<title>layer1_out_proj&#45;&gt;layer1_gate</title>
<path fill="none" stroke="black" d="M454.1,-55380.4C454.1,-55372.57 454.1,-55363.9 454.1,-55355.02"/>
<polygon fill="black" stroke="black" points="457.6,-55354.93 454.1,-55344.93 450.6,-55354.93 457.6,-55354.93"/>
</g>
<!-- layer1_moe -->
<g id="node12" class="node">
<title>layer1_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-55172.67 254.6,-55172.67 254.6,-55104.67 653.6,-55104.67 653.6,-55172.67"/>
<text text-anchor="middle" x="454.1" y="-55157.47" font-family="Times,serif" font-size="14.00">Layer 1 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-55142.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55127.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-55112.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer1_gate&#45;&gt;layer1_moe -->
<g id="edge12" class="edge">
<title>layer1_gate&#45;&gt;layer1_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-55208.46C454.1,-55199.71 454.1,-55190.94 454.1,-55182.73"/>
<polygon fill="black" stroke="black" points="457.6,-55182.68 454.1,-55172.68 450.6,-55182.68 457.6,-55182.68"/>
</g>
<!-- layer2_qkv_proj -->
<g id="node13" class="node">
<title>layer2_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-55068.67 240.6,-55068.67 240.6,-55000.67 667.6,-55000.67 667.6,-55068.67"/>
<text text-anchor="middle" x="454.1" y="-55053.47" font-family="Times,serif" font-size="14.00">Layer 2 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-55038.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-55023.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-55008.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer1_moe&#45;&gt;layer2_qkv_proj -->
<g id="edge13" class="edge">
<title>layer1_moe&#45;&gt;layer2_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-55104.55C454.1,-55096.44 454.1,-55087.65 454.1,-55079.14"/>
<polygon fill="black" stroke="black" points="457.6,-55078.97 454.1,-55068.97 450.6,-55078.97 457.6,-55078.97"/>
</g>
<!-- layer2_attn_comp -->
<g id="node14" class="node">
<title>layer2_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-54964.67 240.6,-54964.67 240.6,-54896.67 667.6,-54896.67 667.6,-54964.67"/>
<text text-anchor="middle" x="454.1" y="-54949.47" font-family="Times,serif" font-size="14.00">Layer 2 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-54934.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54919.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-54904.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer2_qkv_proj&#45;&gt;layer2_attn_comp -->
<g id="edge14" class="edge">
<title>layer2_qkv_proj&#45;&gt;layer2_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-55000.55C454.1,-54992.44 454.1,-54983.65 454.1,-54975.14"/>
<polygon fill="black" stroke="black" points="457.6,-54974.97 454.1,-54964.97 450.6,-54974.97 457.6,-54974.97"/>
</g>
<!-- layer2_out_proj -->
<g id="node15" class="node">
<title>layer2_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-54860.67 246.6,-54860.67 246.6,-54792.67 661.6,-54792.67 661.6,-54860.67"/>
<text text-anchor="middle" x="454.1" y="-54845.47" font-family="Times,serif" font-size="14.00">Layer 2 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-54830.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54815.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-54800.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer2_attn_comp&#45;&gt;layer2_out_proj -->
<g id="edge15" class="edge">
<title>layer2_attn_comp&#45;&gt;layer2_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-54896.55C454.1,-54888.44 454.1,-54879.65 454.1,-54871.14"/>
<polygon fill="black" stroke="black" points="457.6,-54870.97 454.1,-54860.97 450.6,-54870.97 457.6,-54870.97"/>
</g>
<!-- layer2_gate -->
<g id="node16" class="node">
<title>layer2_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-54756.67 216.93,-54756.67 52.65,-54620.67 691.26,-54620.67 855.54,-54756.67"/>
<text text-anchor="middle" x="454.1" y="-54707.47" font-family="Times,serif" font-size="14.00">Layer 2 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-54692.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54677.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-54662.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer2_out_proj&#45;&gt;layer2_gate -->
<g id="edge16" class="edge">
<title>layer2_out_proj&#45;&gt;layer2_gate</title>
<path fill="none" stroke="black" d="M454.1,-54792.4C454.1,-54784.57 454.1,-54775.9 454.1,-54767.02"/>
<polygon fill="black" stroke="black" points="457.6,-54766.93 454.1,-54756.93 450.6,-54766.93 457.6,-54766.93"/>
</g>
<!-- layer2_moe -->
<g id="node17" class="node">
<title>layer2_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-54584.67 254.6,-54584.67 254.6,-54516.67 653.6,-54516.67 653.6,-54584.67"/>
<text text-anchor="middle" x="454.1" y="-54569.47" font-family="Times,serif" font-size="14.00">Layer 2 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-54554.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54539.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-54524.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer2_gate&#45;&gt;layer2_moe -->
<g id="edge17" class="edge">
<title>layer2_gate&#45;&gt;layer2_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-54620.46C454.1,-54611.71 454.1,-54602.94 454.1,-54594.73"/>
<polygon fill="black" stroke="black" points="457.6,-54594.68 454.1,-54584.68 450.6,-54594.68 457.6,-54594.68"/>
</g>
<!-- layer3_qkv_proj -->
<g id="node18" class="node">
<title>layer3_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-54480.67 240.6,-54480.67 240.6,-54412.67 667.6,-54412.67 667.6,-54480.67"/>
<text text-anchor="middle" x="454.1" y="-54465.47" font-family="Times,serif" font-size="14.00">Layer 3 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-54450.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54435.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-54420.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer2_moe&#45;&gt;layer3_qkv_proj -->
<g id="edge18" class="edge">
<title>layer2_moe&#45;&gt;layer3_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-54516.55C454.1,-54508.44 454.1,-54499.65 454.1,-54491.14"/>
<polygon fill="black" stroke="black" points="457.6,-54490.97 454.1,-54480.97 450.6,-54490.97 457.6,-54490.97"/>
</g>
<!-- layer3_attn_comp -->
<g id="node19" class="node">
<title>layer3_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-54376.67 240.6,-54376.67 240.6,-54308.67 667.6,-54308.67 667.6,-54376.67"/>
<text text-anchor="middle" x="454.1" y="-54361.47" font-family="Times,serif" font-size="14.00">Layer 3 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-54346.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54331.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-54316.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer3_qkv_proj&#45;&gt;layer3_attn_comp -->
<g id="edge19" class="edge">
<title>layer3_qkv_proj&#45;&gt;layer3_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-54412.55C454.1,-54404.44 454.1,-54395.65 454.1,-54387.14"/>
<polygon fill="black" stroke="black" points="457.6,-54386.97 454.1,-54376.97 450.6,-54386.97 457.6,-54386.97"/>
</g>
<!-- layer3_out_proj -->
<g id="node20" class="node">
<title>layer3_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-54272.67 246.6,-54272.67 246.6,-54204.67 661.6,-54204.67 661.6,-54272.67"/>
<text text-anchor="middle" x="454.1" y="-54257.47" font-family="Times,serif" font-size="14.00">Layer 3 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-54242.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54227.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-54212.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer3_attn_comp&#45;&gt;layer3_out_proj -->
<g id="edge20" class="edge">
<title>layer3_attn_comp&#45;&gt;layer3_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-54308.55C454.1,-54300.44 454.1,-54291.65 454.1,-54283.14"/>
<polygon fill="black" stroke="black" points="457.6,-54282.97 454.1,-54272.97 450.6,-54282.97 457.6,-54282.97"/>
</g>
<!-- layer3_gate -->
<g id="node21" class="node">
<title>layer3_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-54168.67 216.93,-54168.67 52.65,-54032.67 691.26,-54032.67 855.54,-54168.67"/>
<text text-anchor="middle" x="454.1" y="-54119.47" font-family="Times,serif" font-size="14.00">Layer 3 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-54104.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-54089.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-54074.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer3_out_proj&#45;&gt;layer3_gate -->
<g id="edge21" class="edge">
<title>layer3_out_proj&#45;&gt;layer3_gate</title>
<path fill="none" stroke="black" d="M454.1,-54204.4C454.1,-54196.57 454.1,-54187.9 454.1,-54179.02"/>
<polygon fill="black" stroke="black" points="457.6,-54178.93 454.1,-54168.93 450.6,-54178.93 457.6,-54178.93"/>
</g>
<!-- layer3_moe -->
<g id="node22" class="node">
<title>layer3_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-53996.67 254.6,-53996.67 254.6,-53928.67 653.6,-53928.67 653.6,-53996.67"/>
<text text-anchor="middle" x="454.1" y="-53981.47" font-family="Times,serif" font-size="14.00">Layer 3 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-53966.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53951.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-53936.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer3_gate&#45;&gt;layer3_moe -->
<g id="edge22" class="edge">
<title>layer3_gate&#45;&gt;layer3_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-54032.46C454.1,-54023.71 454.1,-54014.94 454.1,-54006.73"/>
<polygon fill="black" stroke="black" points="457.6,-54006.68 454.1,-53996.68 450.6,-54006.68 457.6,-54006.68"/>
</g>
<!-- layer4_qkv_proj -->
<g id="node23" class="node">
<title>layer4_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-53892.67 240.6,-53892.67 240.6,-53824.67 667.6,-53824.67 667.6,-53892.67"/>
<text text-anchor="middle" x="454.1" y="-53877.47" font-family="Times,serif" font-size="14.00">Layer 4 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-53862.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53847.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-53832.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer3_moe&#45;&gt;layer4_qkv_proj -->
<g id="edge23" class="edge">
<title>layer3_moe&#45;&gt;layer4_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-53928.55C454.1,-53920.44 454.1,-53911.65 454.1,-53903.14"/>
<polygon fill="black" stroke="black" points="457.6,-53902.97 454.1,-53892.97 450.6,-53902.97 457.6,-53902.97"/>
</g>
<!-- layer4_attn_comp -->
<g id="node24" class="node">
<title>layer4_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-53788.67 240.6,-53788.67 240.6,-53720.67 667.6,-53720.67 667.6,-53788.67"/>
<text text-anchor="middle" x="454.1" y="-53773.47" font-family="Times,serif" font-size="14.00">Layer 4 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-53758.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53743.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-53728.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer4_qkv_proj&#45;&gt;layer4_attn_comp -->
<g id="edge24" class="edge">
<title>layer4_qkv_proj&#45;&gt;layer4_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-53824.55C454.1,-53816.44 454.1,-53807.65 454.1,-53799.14"/>
<polygon fill="black" stroke="black" points="457.6,-53798.97 454.1,-53788.97 450.6,-53798.97 457.6,-53798.97"/>
</g>
<!-- layer4_out_proj -->
<g id="node25" class="node">
<title>layer4_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-53684.67 246.6,-53684.67 246.6,-53616.67 661.6,-53616.67 661.6,-53684.67"/>
<text text-anchor="middle" x="454.1" y="-53669.47" font-family="Times,serif" font-size="14.00">Layer 4 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-53654.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53639.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-53624.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer4_attn_comp&#45;&gt;layer4_out_proj -->
<g id="edge25" class="edge">
<title>layer4_attn_comp&#45;&gt;layer4_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-53720.55C454.1,-53712.44 454.1,-53703.65 454.1,-53695.14"/>
<polygon fill="black" stroke="black" points="457.6,-53694.97 454.1,-53684.97 450.6,-53694.97 457.6,-53694.97"/>
</g>
<!-- layer4_gate -->
<g id="node26" class="node">
<title>layer4_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-53580.67 216.93,-53580.67 52.65,-53444.67 691.26,-53444.67 855.54,-53580.67"/>
<text text-anchor="middle" x="454.1" y="-53531.47" font-family="Times,serif" font-size="14.00">Layer 4 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-53516.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53501.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-53486.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer4_out_proj&#45;&gt;layer4_gate -->
<g id="edge26" class="edge">
<title>layer4_out_proj&#45;&gt;layer4_gate</title>
<path fill="none" stroke="black" d="M454.1,-53616.4C454.1,-53608.57 454.1,-53599.9 454.1,-53591.02"/>
<polygon fill="black" stroke="black" points="457.6,-53590.93 454.1,-53580.93 450.6,-53590.93 457.6,-53590.93"/>
</g>
<!-- layer4_moe -->
<g id="node27" class="node">
<title>layer4_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-53408.67 254.6,-53408.67 254.6,-53340.67 653.6,-53340.67 653.6,-53408.67"/>
<text text-anchor="middle" x="454.1" y="-53393.47" font-family="Times,serif" font-size="14.00">Layer 4 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-53378.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53363.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-53348.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer4_gate&#45;&gt;layer4_moe -->
<g id="edge27" class="edge">
<title>layer4_gate&#45;&gt;layer4_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-53444.46C454.1,-53435.71 454.1,-53426.94 454.1,-53418.73"/>
<polygon fill="black" stroke="black" points="457.6,-53418.68 454.1,-53408.68 450.6,-53418.68 457.6,-53418.68"/>
</g>
<!-- layer5_qkv_proj -->
<g id="node28" class="node">
<title>layer5_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-53304.67 240.6,-53304.67 240.6,-53236.67 667.6,-53236.67 667.6,-53304.67"/>
<text text-anchor="middle" x="454.1" y="-53289.47" font-family="Times,serif" font-size="14.00">Layer 5 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-53274.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53259.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-53244.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer4_moe&#45;&gt;layer5_qkv_proj -->
<g id="edge28" class="edge">
<title>layer4_moe&#45;&gt;layer5_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-53340.55C454.1,-53332.44 454.1,-53323.65 454.1,-53315.14"/>
<polygon fill="black" stroke="black" points="457.6,-53314.97 454.1,-53304.97 450.6,-53314.97 457.6,-53314.97"/>
</g>
<!-- layer5_attn_comp -->
<g id="node29" class="node">
<title>layer5_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-53200.67 240.6,-53200.67 240.6,-53132.67 667.6,-53132.67 667.6,-53200.67"/>
<text text-anchor="middle" x="454.1" y="-53185.47" font-family="Times,serif" font-size="14.00">Layer 5 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-53170.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53155.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-53140.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer5_qkv_proj&#45;&gt;layer5_attn_comp -->
<g id="edge29" class="edge">
<title>layer5_qkv_proj&#45;&gt;layer5_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-53236.55C454.1,-53228.44 454.1,-53219.65 454.1,-53211.14"/>
<polygon fill="black" stroke="black" points="457.6,-53210.97 454.1,-53200.97 450.6,-53210.97 457.6,-53210.97"/>
</g>
<!-- layer5_out_proj -->
<g id="node30" class="node">
<title>layer5_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-53096.67 246.6,-53096.67 246.6,-53028.67 661.6,-53028.67 661.6,-53096.67"/>
<text text-anchor="middle" x="454.1" y="-53081.47" font-family="Times,serif" font-size="14.00">Layer 5 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-53066.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-53051.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-53036.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer5_attn_comp&#45;&gt;layer5_out_proj -->
<g id="edge30" class="edge">
<title>layer5_attn_comp&#45;&gt;layer5_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-53132.55C454.1,-53124.44 454.1,-53115.65 454.1,-53107.14"/>
<polygon fill="black" stroke="black" points="457.6,-53106.97 454.1,-53096.97 450.6,-53106.97 457.6,-53106.97"/>
</g>
<!-- layer5_gate -->
<g id="node31" class="node">
<title>layer5_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-52992.67 216.93,-52992.67 52.65,-52856.67 691.26,-52856.67 855.54,-52992.67"/>
<text text-anchor="middle" x="454.1" y="-52943.47" font-family="Times,serif" font-size="14.00">Layer 5 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-52928.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52913.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-52898.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer5_out_proj&#45;&gt;layer5_gate -->
<g id="edge31" class="edge">
<title>layer5_out_proj&#45;&gt;layer5_gate</title>
<path fill="none" stroke="black" d="M454.1,-53028.4C454.1,-53020.57 454.1,-53011.9 454.1,-53003.02"/>
<polygon fill="black" stroke="black" points="457.6,-53002.93 454.1,-52992.93 450.6,-53002.93 457.6,-53002.93"/>
</g>
<!-- layer5_moe -->
<g id="node32" class="node">
<title>layer5_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-52820.67 254.6,-52820.67 254.6,-52752.67 653.6,-52752.67 653.6,-52820.67"/>
<text text-anchor="middle" x="454.1" y="-52805.47" font-family="Times,serif" font-size="14.00">Layer 5 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-52790.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52775.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-52760.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer5_gate&#45;&gt;layer5_moe -->
<g id="edge32" class="edge">
<title>layer5_gate&#45;&gt;layer5_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-52856.46C454.1,-52847.71 454.1,-52838.94 454.1,-52830.73"/>
<polygon fill="black" stroke="black" points="457.6,-52830.68 454.1,-52820.68 450.6,-52830.68 457.6,-52830.68"/>
</g>
<!-- layer6_qkv_proj -->
<g id="node33" class="node">
<title>layer6_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-52716.67 240.6,-52716.67 240.6,-52648.67 667.6,-52648.67 667.6,-52716.67"/>
<text text-anchor="middle" x="454.1" y="-52701.47" font-family="Times,serif" font-size="14.00">Layer 6 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-52686.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52671.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-52656.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer5_moe&#45;&gt;layer6_qkv_proj -->
<g id="edge33" class="edge">
<title>layer5_moe&#45;&gt;layer6_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-52752.55C454.1,-52744.44 454.1,-52735.65 454.1,-52727.14"/>
<polygon fill="black" stroke="black" points="457.6,-52726.97 454.1,-52716.97 450.6,-52726.97 457.6,-52726.97"/>
</g>
<!-- layer6_attn_comp -->
<g id="node34" class="node">
<title>layer6_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-52612.67 240.6,-52612.67 240.6,-52544.67 667.6,-52544.67 667.6,-52612.67"/>
<text text-anchor="middle" x="454.1" y="-52597.47" font-family="Times,serif" font-size="14.00">Layer 6 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-52582.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52567.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-52552.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer6_qkv_proj&#45;&gt;layer6_attn_comp -->
<g id="edge34" class="edge">
<title>layer6_qkv_proj&#45;&gt;layer6_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-52648.55C454.1,-52640.44 454.1,-52631.65 454.1,-52623.14"/>
<polygon fill="black" stroke="black" points="457.6,-52622.97 454.1,-52612.97 450.6,-52622.97 457.6,-52622.97"/>
</g>
<!-- layer6_out_proj -->
<g id="node35" class="node">
<title>layer6_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-52508.67 246.6,-52508.67 246.6,-52440.67 661.6,-52440.67 661.6,-52508.67"/>
<text text-anchor="middle" x="454.1" y="-52493.47" font-family="Times,serif" font-size="14.00">Layer 6 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-52478.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52463.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-52448.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer6_attn_comp&#45;&gt;layer6_out_proj -->
<g id="edge35" class="edge">
<title>layer6_attn_comp&#45;&gt;layer6_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-52544.55C454.1,-52536.44 454.1,-52527.65 454.1,-52519.14"/>
<polygon fill="black" stroke="black" points="457.6,-52518.97 454.1,-52508.97 450.6,-52518.97 457.6,-52518.97"/>
</g>
<!-- layer6_gate -->
<g id="node36" class="node">
<title>layer6_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-52404.67 216.93,-52404.67 52.65,-52268.67 691.26,-52268.67 855.54,-52404.67"/>
<text text-anchor="middle" x="454.1" y="-52355.47" font-family="Times,serif" font-size="14.00">Layer 6 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-52340.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52325.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-52310.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer6_out_proj&#45;&gt;layer6_gate -->
<g id="edge36" class="edge">
<title>layer6_out_proj&#45;&gt;layer6_gate</title>
<path fill="none" stroke="black" d="M454.1,-52440.4C454.1,-52432.57 454.1,-52423.9 454.1,-52415.02"/>
<polygon fill="black" stroke="black" points="457.6,-52414.93 454.1,-52404.93 450.6,-52414.93 457.6,-52414.93"/>
</g>
<!-- layer6_moe -->
<g id="node37" class="node">
<title>layer6_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-52232.67 254.6,-52232.67 254.6,-52164.67 653.6,-52164.67 653.6,-52232.67"/>
<text text-anchor="middle" x="454.1" y="-52217.47" font-family="Times,serif" font-size="14.00">Layer 6 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-52202.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52187.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-52172.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer6_gate&#45;&gt;layer6_moe -->
<g id="edge37" class="edge">
<title>layer6_gate&#45;&gt;layer6_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-52268.46C454.1,-52259.71 454.1,-52250.94 454.1,-52242.73"/>
<polygon fill="black" stroke="black" points="457.6,-52242.68 454.1,-52232.68 450.6,-52242.68 457.6,-52242.68"/>
</g>
<!-- layer7_qkv_proj -->
<g id="node38" class="node">
<title>layer7_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-52128.67 240.6,-52128.67 240.6,-52060.67 667.6,-52060.67 667.6,-52128.67"/>
<text text-anchor="middle" x="454.1" y="-52113.47" font-family="Times,serif" font-size="14.00">Layer 7 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-52098.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-52083.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-52068.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer6_moe&#45;&gt;layer7_qkv_proj -->
<g id="edge38" class="edge">
<title>layer6_moe&#45;&gt;layer7_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-52164.55C454.1,-52156.44 454.1,-52147.65 454.1,-52139.14"/>
<polygon fill="black" stroke="black" points="457.6,-52138.97 454.1,-52128.97 450.6,-52138.97 457.6,-52138.97"/>
</g>
<!-- layer7_attn_comp -->
<g id="node39" class="node">
<title>layer7_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-52024.67 240.6,-52024.67 240.6,-51956.67 667.6,-51956.67 667.6,-52024.67"/>
<text text-anchor="middle" x="454.1" y="-52009.47" font-family="Times,serif" font-size="14.00">Layer 7 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-51994.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51979.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-51964.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer7_qkv_proj&#45;&gt;layer7_attn_comp -->
<g id="edge39" class="edge">
<title>layer7_qkv_proj&#45;&gt;layer7_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-52060.55C454.1,-52052.44 454.1,-52043.65 454.1,-52035.14"/>
<polygon fill="black" stroke="black" points="457.6,-52034.97 454.1,-52024.97 450.6,-52034.97 457.6,-52034.97"/>
</g>
<!-- layer7_out_proj -->
<g id="node40" class="node">
<title>layer7_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-51920.67 246.6,-51920.67 246.6,-51852.67 661.6,-51852.67 661.6,-51920.67"/>
<text text-anchor="middle" x="454.1" y="-51905.47" font-family="Times,serif" font-size="14.00">Layer 7 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-51890.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51875.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-51860.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer7_attn_comp&#45;&gt;layer7_out_proj -->
<g id="edge40" class="edge">
<title>layer7_attn_comp&#45;&gt;layer7_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-51956.55C454.1,-51948.44 454.1,-51939.65 454.1,-51931.14"/>
<polygon fill="black" stroke="black" points="457.6,-51930.97 454.1,-51920.97 450.6,-51930.97 457.6,-51930.97"/>
</g>
<!-- layer7_gate -->
<g id="node41" class="node">
<title>layer7_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-51816.67 216.93,-51816.67 52.65,-51680.67 691.26,-51680.67 855.54,-51816.67"/>
<text text-anchor="middle" x="454.1" y="-51767.47" font-family="Times,serif" font-size="14.00">Layer 7 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-51752.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51737.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-51722.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer7_out_proj&#45;&gt;layer7_gate -->
<g id="edge41" class="edge">
<title>layer7_out_proj&#45;&gt;layer7_gate</title>
<path fill="none" stroke="black" d="M454.1,-51852.4C454.1,-51844.57 454.1,-51835.9 454.1,-51827.02"/>
<polygon fill="black" stroke="black" points="457.6,-51826.93 454.1,-51816.93 450.6,-51826.93 457.6,-51826.93"/>
</g>
<!-- layer7_moe -->
<g id="node42" class="node">
<title>layer7_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-51644.67 254.6,-51644.67 254.6,-51576.67 653.6,-51576.67 653.6,-51644.67"/>
<text text-anchor="middle" x="454.1" y="-51629.47" font-family="Times,serif" font-size="14.00">Layer 7 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-51614.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51599.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-51584.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer7_gate&#45;&gt;layer7_moe -->
<g id="edge42" class="edge">
<title>layer7_gate&#45;&gt;layer7_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-51680.46C454.1,-51671.71 454.1,-51662.94 454.1,-51654.73"/>
<polygon fill="black" stroke="black" points="457.6,-51654.68 454.1,-51644.68 450.6,-51654.68 457.6,-51654.68"/>
</g>
<!-- layer8_qkv_proj -->
<g id="node43" class="node">
<title>layer8_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-51540.67 240.6,-51540.67 240.6,-51472.67 667.6,-51472.67 667.6,-51540.67"/>
<text text-anchor="middle" x="454.1" y="-51525.47" font-family="Times,serif" font-size="14.00">Layer 8 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-51510.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51495.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-51480.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer7_moe&#45;&gt;layer8_qkv_proj -->
<g id="edge43" class="edge">
<title>layer7_moe&#45;&gt;layer8_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-51576.55C454.1,-51568.44 454.1,-51559.65 454.1,-51551.14"/>
<polygon fill="black" stroke="black" points="457.6,-51550.97 454.1,-51540.97 450.6,-51550.97 457.6,-51550.97"/>
</g>
<!-- layer8_attn_comp -->
<g id="node44" class="node">
<title>layer8_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-51436.67 240.6,-51436.67 240.6,-51368.67 667.6,-51368.67 667.6,-51436.67"/>
<text text-anchor="middle" x="454.1" y="-51421.47" font-family="Times,serif" font-size="14.00">Layer 8 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-51406.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51391.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-51376.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer8_qkv_proj&#45;&gt;layer8_attn_comp -->
<g id="edge44" class="edge">
<title>layer8_qkv_proj&#45;&gt;layer8_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-51472.55C454.1,-51464.44 454.1,-51455.65 454.1,-51447.14"/>
<polygon fill="black" stroke="black" points="457.6,-51446.97 454.1,-51436.97 450.6,-51446.97 457.6,-51446.97"/>
</g>
<!-- layer8_out_proj -->
<g id="node45" class="node">
<title>layer8_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-51332.67 246.6,-51332.67 246.6,-51264.67 661.6,-51264.67 661.6,-51332.67"/>
<text text-anchor="middle" x="454.1" y="-51317.47" font-family="Times,serif" font-size="14.00">Layer 8 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-51302.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51287.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-51272.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer8_attn_comp&#45;&gt;layer8_out_proj -->
<g id="edge45" class="edge">
<title>layer8_attn_comp&#45;&gt;layer8_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-51368.55C454.1,-51360.44 454.1,-51351.65 454.1,-51343.14"/>
<polygon fill="black" stroke="black" points="457.6,-51342.97 454.1,-51332.97 450.6,-51342.97 457.6,-51342.97"/>
</g>
<!-- layer8_gate -->
<g id="node46" class="node">
<title>layer8_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-51228.67 216.93,-51228.67 52.65,-51092.67 691.26,-51092.67 855.54,-51228.67"/>
<text text-anchor="middle" x="454.1" y="-51179.47" font-family="Times,serif" font-size="14.00">Layer 8 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-51164.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51149.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-51134.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer8_out_proj&#45;&gt;layer8_gate -->
<g id="edge46" class="edge">
<title>layer8_out_proj&#45;&gt;layer8_gate</title>
<path fill="none" stroke="black" d="M454.1,-51264.4C454.1,-51256.57 454.1,-51247.9 454.1,-51239.02"/>
<polygon fill="black" stroke="black" points="457.6,-51238.93 454.1,-51228.93 450.6,-51238.93 457.6,-51238.93"/>
</g>
<!-- layer8_moe -->
<g id="node47" class="node">
<title>layer8_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-51056.67 254.6,-51056.67 254.6,-50988.67 653.6,-50988.67 653.6,-51056.67"/>
<text text-anchor="middle" x="454.1" y="-51041.47" font-family="Times,serif" font-size="14.00">Layer 8 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-51026.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-51011.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-50996.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer8_gate&#45;&gt;layer8_moe -->
<g id="edge47" class="edge">
<title>layer8_gate&#45;&gt;layer8_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-51092.46C454.1,-51083.71 454.1,-51074.94 454.1,-51066.73"/>
<polygon fill="black" stroke="black" points="457.6,-51066.68 454.1,-51056.68 450.6,-51066.68 457.6,-51066.68"/>
</g>
<!-- layer9_qkv_proj -->
<g id="node48" class="node">
<title>layer9_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-50952.67 240.6,-50952.67 240.6,-50884.67 667.6,-50884.67 667.6,-50952.67"/>
<text text-anchor="middle" x="454.1" y="-50937.47" font-family="Times,serif" font-size="14.00">Layer 9 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-50922.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50907.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-50892.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer8_moe&#45;&gt;layer9_qkv_proj -->
<g id="edge48" class="edge">
<title>layer8_moe&#45;&gt;layer9_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-50988.55C454.1,-50980.44 454.1,-50971.65 454.1,-50963.14"/>
<polygon fill="black" stroke="black" points="457.6,-50962.97 454.1,-50952.97 450.6,-50962.97 457.6,-50962.97"/>
</g>
<!-- layer9_attn_comp -->
<g id="node49" class="node">
<title>layer9_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-50848.67 240.6,-50848.67 240.6,-50780.67 667.6,-50780.67 667.6,-50848.67"/>
<text text-anchor="middle" x="454.1" y="-50833.47" font-family="Times,serif" font-size="14.00">Layer 9 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-50818.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50803.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-50788.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer9_qkv_proj&#45;&gt;layer9_attn_comp -->
<g id="edge49" class="edge">
<title>layer9_qkv_proj&#45;&gt;layer9_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-50884.55C454.1,-50876.44 454.1,-50867.65 454.1,-50859.14"/>
<polygon fill="black" stroke="black" points="457.6,-50858.97 454.1,-50848.97 450.6,-50858.97 457.6,-50858.97"/>
</g>
<!-- layer9_out_proj -->
<g id="node50" class="node">
<title>layer9_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-50744.67 246.6,-50744.67 246.6,-50676.67 661.6,-50676.67 661.6,-50744.67"/>
<text text-anchor="middle" x="454.1" y="-50729.47" font-family="Times,serif" font-size="14.00">Layer 9 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-50714.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50699.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-50684.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer9_attn_comp&#45;&gt;layer9_out_proj -->
<g id="edge50" class="edge">
<title>layer9_attn_comp&#45;&gt;layer9_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-50780.55C454.1,-50772.44 454.1,-50763.65 454.1,-50755.14"/>
<polygon fill="black" stroke="black" points="457.6,-50754.97 454.1,-50744.97 450.6,-50754.97 457.6,-50754.97"/>
</g>
<!-- layer9_gate -->
<g id="node51" class="node">
<title>layer9_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-50640.67 216.93,-50640.67 52.65,-50504.67 691.26,-50504.67 855.54,-50640.67"/>
<text text-anchor="middle" x="454.1" y="-50591.47" font-family="Times,serif" font-size="14.00">Layer 9 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-50576.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50561.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-50546.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer9_out_proj&#45;&gt;layer9_gate -->
<g id="edge51" class="edge">
<title>layer9_out_proj&#45;&gt;layer9_gate</title>
<path fill="none" stroke="black" d="M454.1,-50676.4C454.1,-50668.57 454.1,-50659.9 454.1,-50651.02"/>
<polygon fill="black" stroke="black" points="457.6,-50650.93 454.1,-50640.93 450.6,-50650.93 457.6,-50650.93"/>
</g>
<!-- layer9_moe -->
<g id="node52" class="node">
<title>layer9_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-50468.67 254.6,-50468.67 254.6,-50400.67 653.6,-50400.67 653.6,-50468.67"/>
<text text-anchor="middle" x="454.1" y="-50453.47" font-family="Times,serif" font-size="14.00">Layer 9 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-50438.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50423.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-50408.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer9_gate&#45;&gt;layer9_moe -->
<g id="edge52" class="edge">
<title>layer9_gate&#45;&gt;layer9_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-50504.46C454.1,-50495.71 454.1,-50486.94 454.1,-50478.73"/>
<polygon fill="black" stroke="black" points="457.6,-50478.68 454.1,-50468.68 450.6,-50478.68 457.6,-50478.68"/>
</g>
<!-- layer10_qkv_proj -->
<g id="node53" class="node">
<title>layer10_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-50364.67 240.6,-50364.67 240.6,-50296.67 667.6,-50296.67 667.6,-50364.67"/>
<text text-anchor="middle" x="454.1" y="-50349.47" font-family="Times,serif" font-size="14.00">Layer 10 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-50334.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50319.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-50304.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer9_moe&#45;&gt;layer10_qkv_proj -->
<g id="edge53" class="edge">
<title>layer9_moe&#45;&gt;layer10_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-50400.55C454.1,-50392.44 454.1,-50383.65 454.1,-50375.14"/>
<polygon fill="black" stroke="black" points="457.6,-50374.97 454.1,-50364.97 450.6,-50374.97 457.6,-50374.97"/>
</g>
<!-- layer10_attn_comp -->
<g id="node54" class="node">
<title>layer10_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-50260.67 240.6,-50260.67 240.6,-50192.67 667.6,-50192.67 667.6,-50260.67"/>
<text text-anchor="middle" x="454.1" y="-50245.47" font-family="Times,serif" font-size="14.00">Layer 10 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-50230.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50215.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-50200.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer10_qkv_proj&#45;&gt;layer10_attn_comp -->
<g id="edge54" class="edge">
<title>layer10_qkv_proj&#45;&gt;layer10_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-50296.55C454.1,-50288.44 454.1,-50279.65 454.1,-50271.14"/>
<polygon fill="black" stroke="black" points="457.6,-50270.97 454.1,-50260.97 450.6,-50270.97 457.6,-50270.97"/>
</g>
<!-- layer10_out_proj -->
<g id="node55" class="node">
<title>layer10_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-50156.67 246.6,-50156.67 246.6,-50088.67 661.6,-50088.67 661.6,-50156.67"/>
<text text-anchor="middle" x="454.1" y="-50141.47" font-family="Times,serif" font-size="14.00">Layer 10 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-50126.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-50111.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-50096.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer10_attn_comp&#45;&gt;layer10_out_proj -->
<g id="edge55" class="edge">
<title>layer10_attn_comp&#45;&gt;layer10_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-50192.55C454.1,-50184.44 454.1,-50175.65 454.1,-50167.14"/>
<polygon fill="black" stroke="black" points="457.6,-50166.97 454.1,-50156.97 450.6,-50166.97 457.6,-50166.97"/>
</g>
<!-- layer10_gate -->
<g id="node56" class="node">
<title>layer10_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-50052.67 216.93,-50052.67 52.65,-49916.67 691.26,-49916.67 855.54,-50052.67"/>
<text text-anchor="middle" x="454.1" y="-50003.47" font-family="Times,serif" font-size="14.00">Layer 10 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-49988.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49973.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-49958.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer10_out_proj&#45;&gt;layer10_gate -->
<g id="edge56" class="edge">
<title>layer10_out_proj&#45;&gt;layer10_gate</title>
<path fill="none" stroke="black" d="M454.1,-50088.4C454.1,-50080.57 454.1,-50071.9 454.1,-50063.02"/>
<polygon fill="black" stroke="black" points="457.6,-50062.93 454.1,-50052.93 450.6,-50062.93 457.6,-50062.93"/>
</g>
<!-- layer10_moe -->
<g id="node57" class="node">
<title>layer10_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-49880.67 254.6,-49880.67 254.6,-49812.67 653.6,-49812.67 653.6,-49880.67"/>
<text text-anchor="middle" x="454.1" y="-49865.47" font-family="Times,serif" font-size="14.00">Layer 10 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-49850.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49835.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-49820.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer10_gate&#45;&gt;layer10_moe -->
<g id="edge57" class="edge">
<title>layer10_gate&#45;&gt;layer10_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-49916.46C454.1,-49907.71 454.1,-49898.94 454.1,-49890.73"/>
<polygon fill="black" stroke="black" points="457.6,-49890.68 454.1,-49880.68 450.6,-49890.68 457.6,-49890.68"/>
</g>
<!-- layer11_qkv_proj -->
<g id="node58" class="node">
<title>layer11_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-49776.67 240.6,-49776.67 240.6,-49708.67 667.6,-49708.67 667.6,-49776.67"/>
<text text-anchor="middle" x="454.1" y="-49761.47" font-family="Times,serif" font-size="14.00">Layer 11 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-49746.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49731.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-49716.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer10_moe&#45;&gt;layer11_qkv_proj -->
<g id="edge58" class="edge">
<title>layer10_moe&#45;&gt;layer11_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-49812.55C454.1,-49804.44 454.1,-49795.65 454.1,-49787.14"/>
<polygon fill="black" stroke="black" points="457.6,-49786.97 454.1,-49776.97 450.6,-49786.97 457.6,-49786.97"/>
</g>
<!-- layer11_attn_comp -->
<g id="node59" class="node">
<title>layer11_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-49672.67 240.6,-49672.67 240.6,-49604.67 667.6,-49604.67 667.6,-49672.67"/>
<text text-anchor="middle" x="454.1" y="-49657.47" font-family="Times,serif" font-size="14.00">Layer 11 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-49642.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49627.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-49612.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer11_qkv_proj&#45;&gt;layer11_attn_comp -->
<g id="edge59" class="edge">
<title>layer11_qkv_proj&#45;&gt;layer11_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-49708.55C454.1,-49700.44 454.1,-49691.65 454.1,-49683.14"/>
<polygon fill="black" stroke="black" points="457.6,-49682.97 454.1,-49672.97 450.6,-49682.97 457.6,-49682.97"/>
</g>
<!-- layer11_out_proj -->
<g id="node60" class="node">
<title>layer11_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-49568.67 246.6,-49568.67 246.6,-49500.67 661.6,-49500.67 661.6,-49568.67"/>
<text text-anchor="middle" x="454.1" y="-49553.47" font-family="Times,serif" font-size="14.00">Layer 11 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-49538.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49523.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-49508.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer11_attn_comp&#45;&gt;layer11_out_proj -->
<g id="edge60" class="edge">
<title>layer11_attn_comp&#45;&gt;layer11_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-49604.55C454.1,-49596.44 454.1,-49587.65 454.1,-49579.14"/>
<polygon fill="black" stroke="black" points="457.6,-49578.97 454.1,-49568.97 450.6,-49578.97 457.6,-49578.97"/>
</g>
<!-- layer11_gate -->
<g id="node61" class="node">
<title>layer11_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-49464.67 216.93,-49464.67 52.65,-49328.67 691.26,-49328.67 855.54,-49464.67"/>
<text text-anchor="middle" x="454.1" y="-49415.47" font-family="Times,serif" font-size="14.00">Layer 11 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-49400.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49385.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-49370.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer11_out_proj&#45;&gt;layer11_gate -->
<g id="edge61" class="edge">
<title>layer11_out_proj&#45;&gt;layer11_gate</title>
<path fill="none" stroke="black" d="M454.1,-49500.4C454.1,-49492.57 454.1,-49483.9 454.1,-49475.02"/>
<polygon fill="black" stroke="black" points="457.6,-49474.93 454.1,-49464.93 450.6,-49474.93 457.6,-49474.93"/>
</g>
<!-- layer11_moe -->
<g id="node62" class="node">
<title>layer11_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-49292.67 254.6,-49292.67 254.6,-49224.67 653.6,-49224.67 653.6,-49292.67"/>
<text text-anchor="middle" x="454.1" y="-49277.47" font-family="Times,serif" font-size="14.00">Layer 11 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-49262.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49247.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-49232.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer11_gate&#45;&gt;layer11_moe -->
<g id="edge62" class="edge">
<title>layer11_gate&#45;&gt;layer11_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-49328.46C454.1,-49319.71 454.1,-49310.94 454.1,-49302.73"/>
<polygon fill="black" stroke="black" points="457.6,-49302.68 454.1,-49292.68 450.6,-49302.68 457.6,-49302.68"/>
</g>
<!-- layer12_qkv_proj -->
<g id="node63" class="node">
<title>layer12_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-49188.67 240.6,-49188.67 240.6,-49120.67 667.6,-49120.67 667.6,-49188.67"/>
<text text-anchor="middle" x="454.1" y="-49173.47" font-family="Times,serif" font-size="14.00">Layer 12 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-49158.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49143.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-49128.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer11_moe&#45;&gt;layer12_qkv_proj -->
<g id="edge63" class="edge">
<title>layer11_moe&#45;&gt;layer12_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-49224.55C454.1,-49216.44 454.1,-49207.65 454.1,-49199.14"/>
<polygon fill="black" stroke="black" points="457.6,-49198.97 454.1,-49188.97 450.6,-49198.97 457.6,-49198.97"/>
</g>
<!-- layer12_attn_comp -->
<g id="node64" class="node">
<title>layer12_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-49084.67 240.6,-49084.67 240.6,-49016.67 667.6,-49016.67 667.6,-49084.67"/>
<text text-anchor="middle" x="454.1" y="-49069.47" font-family="Times,serif" font-size="14.00">Layer 12 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-49054.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-49039.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-49024.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer12_qkv_proj&#45;&gt;layer12_attn_comp -->
<g id="edge64" class="edge">
<title>layer12_qkv_proj&#45;&gt;layer12_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-49120.55C454.1,-49112.44 454.1,-49103.65 454.1,-49095.14"/>
<polygon fill="black" stroke="black" points="457.6,-49094.97 454.1,-49084.97 450.6,-49094.97 457.6,-49094.97"/>
</g>
<!-- layer12_out_proj -->
<g id="node65" class="node">
<title>layer12_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-48980.67 246.6,-48980.67 246.6,-48912.67 661.6,-48912.67 661.6,-48980.67"/>
<text text-anchor="middle" x="454.1" y="-48965.47" font-family="Times,serif" font-size="14.00">Layer 12 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-48950.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48935.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-48920.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer12_attn_comp&#45;&gt;layer12_out_proj -->
<g id="edge65" class="edge">
<title>layer12_attn_comp&#45;&gt;layer12_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-49016.55C454.1,-49008.44 454.1,-48999.65 454.1,-48991.14"/>
<polygon fill="black" stroke="black" points="457.6,-48990.97 454.1,-48980.97 450.6,-48990.97 457.6,-48990.97"/>
</g>
<!-- layer12_gate -->
<g id="node66" class="node">
<title>layer12_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-48876.67 216.93,-48876.67 52.65,-48740.67 691.26,-48740.67 855.54,-48876.67"/>
<text text-anchor="middle" x="454.1" y="-48827.47" font-family="Times,serif" font-size="14.00">Layer 12 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-48812.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48797.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-48782.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer12_out_proj&#45;&gt;layer12_gate -->
<g id="edge66" class="edge">
<title>layer12_out_proj&#45;&gt;layer12_gate</title>
<path fill="none" stroke="black" d="M454.1,-48912.4C454.1,-48904.57 454.1,-48895.9 454.1,-48887.02"/>
<polygon fill="black" stroke="black" points="457.6,-48886.93 454.1,-48876.93 450.6,-48886.93 457.6,-48886.93"/>
</g>
<!-- layer12_moe -->
<g id="node67" class="node">
<title>layer12_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-48704.67 254.6,-48704.67 254.6,-48636.67 653.6,-48636.67 653.6,-48704.67"/>
<text text-anchor="middle" x="454.1" y="-48689.47" font-family="Times,serif" font-size="14.00">Layer 12 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-48674.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48659.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-48644.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer12_gate&#45;&gt;layer12_moe -->
<g id="edge67" class="edge">
<title>layer12_gate&#45;&gt;layer12_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-48740.46C454.1,-48731.71 454.1,-48722.94 454.1,-48714.73"/>
<polygon fill="black" stroke="black" points="457.6,-48714.68 454.1,-48704.68 450.6,-48714.68 457.6,-48714.68"/>
</g>
<!-- layer13_qkv_proj -->
<g id="node68" class="node">
<title>layer13_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-48600.67 240.6,-48600.67 240.6,-48532.67 667.6,-48532.67 667.6,-48600.67"/>
<text text-anchor="middle" x="454.1" y="-48585.47" font-family="Times,serif" font-size="14.00">Layer 13 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-48570.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48555.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-48540.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer12_moe&#45;&gt;layer13_qkv_proj -->
<g id="edge68" class="edge">
<title>layer12_moe&#45;&gt;layer13_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-48636.55C454.1,-48628.44 454.1,-48619.65 454.1,-48611.14"/>
<polygon fill="black" stroke="black" points="457.6,-48610.97 454.1,-48600.97 450.6,-48610.97 457.6,-48610.97"/>
</g>
<!-- layer13_attn_comp -->
<g id="node69" class="node">
<title>layer13_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-48496.67 240.6,-48496.67 240.6,-48428.67 667.6,-48428.67 667.6,-48496.67"/>
<text text-anchor="middle" x="454.1" y="-48481.47" font-family="Times,serif" font-size="14.00">Layer 13 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-48466.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48451.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-48436.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer13_qkv_proj&#45;&gt;layer13_attn_comp -->
<g id="edge69" class="edge">
<title>layer13_qkv_proj&#45;&gt;layer13_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-48532.55C454.1,-48524.44 454.1,-48515.65 454.1,-48507.14"/>
<polygon fill="black" stroke="black" points="457.6,-48506.97 454.1,-48496.97 450.6,-48506.97 457.6,-48506.97"/>
</g>
<!-- layer13_out_proj -->
<g id="node70" class="node">
<title>layer13_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-48392.67 246.6,-48392.67 246.6,-48324.67 661.6,-48324.67 661.6,-48392.67"/>
<text text-anchor="middle" x="454.1" y="-48377.47" font-family="Times,serif" font-size="14.00">Layer 13 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-48362.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48347.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-48332.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer13_attn_comp&#45;&gt;layer13_out_proj -->
<g id="edge70" class="edge">
<title>layer13_attn_comp&#45;&gt;layer13_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-48428.55C454.1,-48420.44 454.1,-48411.65 454.1,-48403.14"/>
<polygon fill="black" stroke="black" points="457.6,-48402.97 454.1,-48392.97 450.6,-48402.97 457.6,-48402.97"/>
</g>
<!-- layer13_gate -->
<g id="node71" class="node">
<title>layer13_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-48288.67 216.93,-48288.67 52.65,-48152.67 691.26,-48152.67 855.54,-48288.67"/>
<text text-anchor="middle" x="454.1" y="-48239.47" font-family="Times,serif" font-size="14.00">Layer 13 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-48224.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48209.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-48194.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer13_out_proj&#45;&gt;layer13_gate -->
<g id="edge71" class="edge">
<title>layer13_out_proj&#45;&gt;layer13_gate</title>
<path fill="none" stroke="black" d="M454.1,-48324.4C454.1,-48316.57 454.1,-48307.9 454.1,-48299.02"/>
<polygon fill="black" stroke="black" points="457.6,-48298.93 454.1,-48288.93 450.6,-48298.93 457.6,-48298.93"/>
</g>
<!-- layer13_moe -->
<g id="node72" class="node">
<title>layer13_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-48116.67 254.6,-48116.67 254.6,-48048.67 653.6,-48048.67 653.6,-48116.67"/>
<text text-anchor="middle" x="454.1" y="-48101.47" font-family="Times,serif" font-size="14.00">Layer 13 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-48086.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-48071.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-48056.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer13_gate&#45;&gt;layer13_moe -->
<g id="edge72" class="edge">
<title>layer13_gate&#45;&gt;layer13_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-48152.46C454.1,-48143.71 454.1,-48134.94 454.1,-48126.73"/>
<polygon fill="black" stroke="black" points="457.6,-48126.68 454.1,-48116.68 450.6,-48126.68 457.6,-48126.68"/>
</g>
<!-- layer14_qkv_proj -->
<g id="node73" class="node">
<title>layer14_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-48012.67 240.6,-48012.67 240.6,-47944.67 667.6,-47944.67 667.6,-48012.67"/>
<text text-anchor="middle" x="454.1" y="-47997.47" font-family="Times,serif" font-size="14.00">Layer 14 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-47982.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47967.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-47952.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer13_moe&#45;&gt;layer14_qkv_proj -->
<g id="edge73" class="edge">
<title>layer13_moe&#45;&gt;layer14_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-48048.55C454.1,-48040.44 454.1,-48031.65 454.1,-48023.14"/>
<polygon fill="black" stroke="black" points="457.6,-48022.97 454.1,-48012.97 450.6,-48022.97 457.6,-48022.97"/>
</g>
<!-- layer14_attn_comp -->
<g id="node74" class="node">
<title>layer14_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-47908.67 240.6,-47908.67 240.6,-47840.67 667.6,-47840.67 667.6,-47908.67"/>
<text text-anchor="middle" x="454.1" y="-47893.47" font-family="Times,serif" font-size="14.00">Layer 14 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-47878.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47863.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-47848.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer14_qkv_proj&#45;&gt;layer14_attn_comp -->
<g id="edge74" class="edge">
<title>layer14_qkv_proj&#45;&gt;layer14_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-47944.55C454.1,-47936.44 454.1,-47927.65 454.1,-47919.14"/>
<polygon fill="black" stroke="black" points="457.6,-47918.97 454.1,-47908.97 450.6,-47918.97 457.6,-47918.97"/>
</g>
<!-- layer14_out_proj -->
<g id="node75" class="node">
<title>layer14_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-47804.67 246.6,-47804.67 246.6,-47736.67 661.6,-47736.67 661.6,-47804.67"/>
<text text-anchor="middle" x="454.1" y="-47789.47" font-family="Times,serif" font-size="14.00">Layer 14 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-47774.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47759.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-47744.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer14_attn_comp&#45;&gt;layer14_out_proj -->
<g id="edge75" class="edge">
<title>layer14_attn_comp&#45;&gt;layer14_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-47840.55C454.1,-47832.44 454.1,-47823.65 454.1,-47815.14"/>
<polygon fill="black" stroke="black" points="457.6,-47814.97 454.1,-47804.97 450.6,-47814.97 457.6,-47814.97"/>
</g>
<!-- layer14_gate -->
<g id="node76" class="node">
<title>layer14_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-47700.67 216.93,-47700.67 52.65,-47564.67 691.26,-47564.67 855.54,-47700.67"/>
<text text-anchor="middle" x="454.1" y="-47651.47" font-family="Times,serif" font-size="14.00">Layer 14 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-47636.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47621.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-47606.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer14_out_proj&#45;&gt;layer14_gate -->
<g id="edge76" class="edge">
<title>layer14_out_proj&#45;&gt;layer14_gate</title>
<path fill="none" stroke="black" d="M454.1,-47736.4C454.1,-47728.57 454.1,-47719.9 454.1,-47711.02"/>
<polygon fill="black" stroke="black" points="457.6,-47710.93 454.1,-47700.93 450.6,-47710.93 457.6,-47710.93"/>
</g>
<!-- layer14_moe -->
<g id="node77" class="node">
<title>layer14_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-47528.67 254.6,-47528.67 254.6,-47460.67 653.6,-47460.67 653.6,-47528.67"/>
<text text-anchor="middle" x="454.1" y="-47513.47" font-family="Times,serif" font-size="14.00">Layer 14 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-47498.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47483.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-47468.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer14_gate&#45;&gt;layer14_moe -->
<g id="edge77" class="edge">
<title>layer14_gate&#45;&gt;layer14_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-47564.46C454.1,-47555.71 454.1,-47546.94 454.1,-47538.73"/>
<polygon fill="black" stroke="black" points="457.6,-47538.68 454.1,-47528.68 450.6,-47538.68 457.6,-47538.68"/>
</g>
<!-- layer15_qkv_proj -->
<g id="node78" class="node">
<title>layer15_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-47424.67 240.6,-47424.67 240.6,-47356.67 667.6,-47356.67 667.6,-47424.67"/>
<text text-anchor="middle" x="454.1" y="-47409.47" font-family="Times,serif" font-size="14.00">Layer 15 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-47394.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47379.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-47364.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer14_moe&#45;&gt;layer15_qkv_proj -->
<g id="edge78" class="edge">
<title>layer14_moe&#45;&gt;layer15_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-47460.55C454.1,-47452.44 454.1,-47443.65 454.1,-47435.14"/>
<polygon fill="black" stroke="black" points="457.6,-47434.97 454.1,-47424.97 450.6,-47434.97 457.6,-47434.97"/>
</g>
<!-- layer15_attn_comp -->
<g id="node79" class="node">
<title>layer15_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-47320.67 240.6,-47320.67 240.6,-47252.67 667.6,-47252.67 667.6,-47320.67"/>
<text text-anchor="middle" x="454.1" y="-47305.47" font-family="Times,serif" font-size="14.00">Layer 15 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-47290.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47275.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-47260.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer15_qkv_proj&#45;&gt;layer15_attn_comp -->
<g id="edge79" class="edge">
<title>layer15_qkv_proj&#45;&gt;layer15_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-47356.55C454.1,-47348.44 454.1,-47339.65 454.1,-47331.14"/>
<polygon fill="black" stroke="black" points="457.6,-47330.97 454.1,-47320.97 450.6,-47330.97 457.6,-47330.97"/>
</g>
<!-- layer15_out_proj -->
<g id="node80" class="node">
<title>layer15_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-47216.67 246.6,-47216.67 246.6,-47148.67 661.6,-47148.67 661.6,-47216.67"/>
<text text-anchor="middle" x="454.1" y="-47201.47" font-family="Times,serif" font-size="14.00">Layer 15 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-47186.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47171.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-47156.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer15_attn_comp&#45;&gt;layer15_out_proj -->
<g id="edge80" class="edge">
<title>layer15_attn_comp&#45;&gt;layer15_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-47252.55C454.1,-47244.44 454.1,-47235.65 454.1,-47227.14"/>
<polygon fill="black" stroke="black" points="457.6,-47226.97 454.1,-47216.97 450.6,-47226.97 457.6,-47226.97"/>
</g>
<!-- layer15_gate -->
<g id="node81" class="node">
<title>layer15_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-47112.67 216.93,-47112.67 52.65,-46976.67 691.26,-46976.67 855.54,-47112.67"/>
<text text-anchor="middle" x="454.1" y="-47063.47" font-family="Times,serif" font-size="14.00">Layer 15 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-47048.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-47033.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-47018.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer15_out_proj&#45;&gt;layer15_gate -->
<g id="edge81" class="edge">
<title>layer15_out_proj&#45;&gt;layer15_gate</title>
<path fill="none" stroke="black" d="M454.1,-47148.4C454.1,-47140.57 454.1,-47131.9 454.1,-47123.02"/>
<polygon fill="black" stroke="black" points="457.6,-47122.93 454.1,-47112.93 450.6,-47122.93 457.6,-47122.93"/>
</g>
<!-- layer15_moe -->
<g id="node82" class="node">
<title>layer15_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-46940.67 254.6,-46940.67 254.6,-46872.67 653.6,-46872.67 653.6,-46940.67"/>
<text text-anchor="middle" x="454.1" y="-46925.47" font-family="Times,serif" font-size="14.00">Layer 15 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-46910.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46895.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-46880.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer15_gate&#45;&gt;layer15_moe -->
<g id="edge82" class="edge">
<title>layer15_gate&#45;&gt;layer15_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-46976.46C454.1,-46967.71 454.1,-46958.94 454.1,-46950.73"/>
<polygon fill="black" stroke="black" points="457.6,-46950.68 454.1,-46940.68 450.6,-46950.68 457.6,-46950.68"/>
</g>
<!-- layer16_qkv_proj -->
<g id="node83" class="node">
<title>layer16_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-46836.67 240.6,-46836.67 240.6,-46768.67 667.6,-46768.67 667.6,-46836.67"/>
<text text-anchor="middle" x="454.1" y="-46821.47" font-family="Times,serif" font-size="14.00">Layer 16 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-46806.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46791.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-46776.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer15_moe&#45;&gt;layer16_qkv_proj -->
<g id="edge83" class="edge">
<title>layer15_moe&#45;&gt;layer16_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-46872.55C454.1,-46864.44 454.1,-46855.65 454.1,-46847.14"/>
<polygon fill="black" stroke="black" points="457.6,-46846.97 454.1,-46836.97 450.6,-46846.97 457.6,-46846.97"/>
</g>
<!-- layer16_attn_comp -->
<g id="node84" class="node">
<title>layer16_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-46732.67 240.6,-46732.67 240.6,-46664.67 667.6,-46664.67 667.6,-46732.67"/>
<text text-anchor="middle" x="454.1" y="-46717.47" font-family="Times,serif" font-size="14.00">Layer 16 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-46702.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46687.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-46672.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer16_qkv_proj&#45;&gt;layer16_attn_comp -->
<g id="edge84" class="edge">
<title>layer16_qkv_proj&#45;&gt;layer16_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-46768.55C454.1,-46760.44 454.1,-46751.65 454.1,-46743.14"/>
<polygon fill="black" stroke="black" points="457.6,-46742.97 454.1,-46732.97 450.6,-46742.97 457.6,-46742.97"/>
</g>
<!-- layer16_out_proj -->
<g id="node85" class="node">
<title>layer16_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-46628.67 246.6,-46628.67 246.6,-46560.67 661.6,-46560.67 661.6,-46628.67"/>
<text text-anchor="middle" x="454.1" y="-46613.47" font-family="Times,serif" font-size="14.00">Layer 16 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-46598.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46583.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-46568.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer16_attn_comp&#45;&gt;layer16_out_proj -->
<g id="edge85" class="edge">
<title>layer16_attn_comp&#45;&gt;layer16_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-46664.55C454.1,-46656.44 454.1,-46647.65 454.1,-46639.14"/>
<polygon fill="black" stroke="black" points="457.6,-46638.97 454.1,-46628.97 450.6,-46638.97 457.6,-46638.97"/>
</g>
<!-- layer16_gate -->
<g id="node86" class="node">
<title>layer16_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-46524.67 216.93,-46524.67 52.65,-46388.67 691.26,-46388.67 855.54,-46524.67"/>
<text text-anchor="middle" x="454.1" y="-46475.47" font-family="Times,serif" font-size="14.00">Layer 16 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-46460.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46445.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-46430.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer16_out_proj&#45;&gt;layer16_gate -->
<g id="edge86" class="edge">
<title>layer16_out_proj&#45;&gt;layer16_gate</title>
<path fill="none" stroke="black" d="M454.1,-46560.4C454.1,-46552.57 454.1,-46543.9 454.1,-46535.02"/>
<polygon fill="black" stroke="black" points="457.6,-46534.93 454.1,-46524.93 450.6,-46534.93 457.6,-46534.93"/>
</g>
<!-- layer16_moe -->
<g id="node87" class="node">
<title>layer16_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-46352.67 254.6,-46352.67 254.6,-46284.67 653.6,-46284.67 653.6,-46352.67"/>
<text text-anchor="middle" x="454.1" y="-46337.47" font-family="Times,serif" font-size="14.00">Layer 16 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-46322.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46307.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-46292.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer16_gate&#45;&gt;layer16_moe -->
<g id="edge87" class="edge">
<title>layer16_gate&#45;&gt;layer16_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-46388.46C454.1,-46379.71 454.1,-46370.94 454.1,-46362.73"/>
<polygon fill="black" stroke="black" points="457.6,-46362.68 454.1,-46352.68 450.6,-46362.68 457.6,-46362.68"/>
</g>
<!-- layer17_qkv_proj -->
<g id="node88" class="node">
<title>layer17_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-46248.67 240.6,-46248.67 240.6,-46180.67 667.6,-46180.67 667.6,-46248.67"/>
<text text-anchor="middle" x="454.1" y="-46233.47" font-family="Times,serif" font-size="14.00">Layer 17 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-46218.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46203.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-46188.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer16_moe&#45;&gt;layer17_qkv_proj -->
<g id="edge88" class="edge">
<title>layer16_moe&#45;&gt;layer17_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-46284.55C454.1,-46276.44 454.1,-46267.65 454.1,-46259.14"/>
<polygon fill="black" stroke="black" points="457.6,-46258.97 454.1,-46248.97 450.6,-46258.97 457.6,-46258.97"/>
</g>
<!-- layer17_attn_comp -->
<g id="node89" class="node">
<title>layer17_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-46144.67 240.6,-46144.67 240.6,-46076.67 667.6,-46076.67 667.6,-46144.67"/>
<text text-anchor="middle" x="454.1" y="-46129.47" font-family="Times,serif" font-size="14.00">Layer 17 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-46114.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-46099.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-46084.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer17_qkv_proj&#45;&gt;layer17_attn_comp -->
<g id="edge89" class="edge">
<title>layer17_qkv_proj&#45;&gt;layer17_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-46180.55C454.1,-46172.44 454.1,-46163.65 454.1,-46155.14"/>
<polygon fill="black" stroke="black" points="457.6,-46154.97 454.1,-46144.97 450.6,-46154.97 457.6,-46154.97"/>
</g>
<!-- layer17_out_proj -->
<g id="node90" class="node">
<title>layer17_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-46040.67 246.6,-46040.67 246.6,-45972.67 661.6,-45972.67 661.6,-46040.67"/>
<text text-anchor="middle" x="454.1" y="-46025.47" font-family="Times,serif" font-size="14.00">Layer 17 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-46010.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45995.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-45980.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer17_attn_comp&#45;&gt;layer17_out_proj -->
<g id="edge90" class="edge">
<title>layer17_attn_comp&#45;&gt;layer17_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-46076.55C454.1,-46068.44 454.1,-46059.65 454.1,-46051.14"/>
<polygon fill="black" stroke="black" points="457.6,-46050.97 454.1,-46040.97 450.6,-46050.97 457.6,-46050.97"/>
</g>
<!-- layer17_gate -->
<g id="node91" class="node">
<title>layer17_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-45936.67 216.93,-45936.67 52.65,-45800.67 691.26,-45800.67 855.54,-45936.67"/>
<text text-anchor="middle" x="454.1" y="-45887.47" font-family="Times,serif" font-size="14.00">Layer 17 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-45872.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45857.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-45842.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer17_out_proj&#45;&gt;layer17_gate -->
<g id="edge91" class="edge">
<title>layer17_out_proj&#45;&gt;layer17_gate</title>
<path fill="none" stroke="black" d="M454.1,-45972.4C454.1,-45964.57 454.1,-45955.9 454.1,-45947.02"/>
<polygon fill="black" stroke="black" points="457.6,-45946.93 454.1,-45936.93 450.6,-45946.93 457.6,-45946.93"/>
</g>
<!-- layer17_moe -->
<g id="node92" class="node">
<title>layer17_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-45764.67 254.6,-45764.67 254.6,-45696.67 653.6,-45696.67 653.6,-45764.67"/>
<text text-anchor="middle" x="454.1" y="-45749.47" font-family="Times,serif" font-size="14.00">Layer 17 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-45734.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45719.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-45704.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer17_gate&#45;&gt;layer17_moe -->
<g id="edge92" class="edge">
<title>layer17_gate&#45;&gt;layer17_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-45800.46C454.1,-45791.71 454.1,-45782.94 454.1,-45774.73"/>
<polygon fill="black" stroke="black" points="457.6,-45774.68 454.1,-45764.68 450.6,-45774.68 457.6,-45774.68"/>
</g>
<!-- layer18_qkv_proj -->
<g id="node93" class="node">
<title>layer18_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-45660.67 240.6,-45660.67 240.6,-45592.67 667.6,-45592.67 667.6,-45660.67"/>
<text text-anchor="middle" x="454.1" y="-45645.47" font-family="Times,serif" font-size="14.00">Layer 18 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-45630.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45615.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-45600.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer17_moe&#45;&gt;layer18_qkv_proj -->
<g id="edge93" class="edge">
<title>layer17_moe&#45;&gt;layer18_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-45696.55C454.1,-45688.44 454.1,-45679.65 454.1,-45671.14"/>
<polygon fill="black" stroke="black" points="457.6,-45670.97 454.1,-45660.97 450.6,-45670.97 457.6,-45670.97"/>
</g>
<!-- layer18_attn_comp -->
<g id="node94" class="node">
<title>layer18_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-45556.67 240.6,-45556.67 240.6,-45488.67 667.6,-45488.67 667.6,-45556.67"/>
<text text-anchor="middle" x="454.1" y="-45541.47" font-family="Times,serif" font-size="14.00">Layer 18 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-45526.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45511.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-45496.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer18_qkv_proj&#45;&gt;layer18_attn_comp -->
<g id="edge94" class="edge">
<title>layer18_qkv_proj&#45;&gt;layer18_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-45592.55C454.1,-45584.44 454.1,-45575.65 454.1,-45567.14"/>
<polygon fill="black" stroke="black" points="457.6,-45566.97 454.1,-45556.97 450.6,-45566.97 457.6,-45566.97"/>
</g>
<!-- layer18_out_proj -->
<g id="node95" class="node">
<title>layer18_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-45452.67 246.6,-45452.67 246.6,-45384.67 661.6,-45384.67 661.6,-45452.67"/>
<text text-anchor="middle" x="454.1" y="-45437.47" font-family="Times,serif" font-size="14.00">Layer 18 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-45422.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45407.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-45392.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer18_attn_comp&#45;&gt;layer18_out_proj -->
<g id="edge95" class="edge">
<title>layer18_attn_comp&#45;&gt;layer18_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-45488.55C454.1,-45480.44 454.1,-45471.65 454.1,-45463.14"/>
<polygon fill="black" stroke="black" points="457.6,-45462.97 454.1,-45452.97 450.6,-45462.97 457.6,-45462.97"/>
</g>
<!-- layer18_gate -->
<g id="node96" class="node">
<title>layer18_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-45348.67 216.93,-45348.67 52.65,-45212.67 691.26,-45212.67 855.54,-45348.67"/>
<text text-anchor="middle" x="454.1" y="-45299.47" font-family="Times,serif" font-size="14.00">Layer 18 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-45284.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45269.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-45254.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer18_out_proj&#45;&gt;layer18_gate -->
<g id="edge96" class="edge">
<title>layer18_out_proj&#45;&gt;layer18_gate</title>
<path fill="none" stroke="black" d="M454.1,-45384.4C454.1,-45376.57 454.1,-45367.9 454.1,-45359.02"/>
<polygon fill="black" stroke="black" points="457.6,-45358.93 454.1,-45348.93 450.6,-45358.93 457.6,-45358.93"/>
</g>
<!-- layer18_moe -->
<g id="node97" class="node">
<title>layer18_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-45176.67 254.6,-45176.67 254.6,-45108.67 653.6,-45108.67 653.6,-45176.67"/>
<text text-anchor="middle" x="454.1" y="-45161.47" font-family="Times,serif" font-size="14.00">Layer 18 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-45146.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45131.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-45116.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer18_gate&#45;&gt;layer18_moe -->
<g id="edge97" class="edge">
<title>layer18_gate&#45;&gt;layer18_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-45212.46C454.1,-45203.71 454.1,-45194.94 454.1,-45186.73"/>
<polygon fill="black" stroke="black" points="457.6,-45186.68 454.1,-45176.68 450.6,-45186.68 457.6,-45186.68"/>
</g>
<!-- layer19_qkv_proj -->
<g id="node98" class="node">
<title>layer19_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-45072.67 240.6,-45072.67 240.6,-45004.67 667.6,-45004.67 667.6,-45072.67"/>
<text text-anchor="middle" x="454.1" y="-45057.47" font-family="Times,serif" font-size="14.00">Layer 19 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-45042.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-45027.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-45012.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer18_moe&#45;&gt;layer19_qkv_proj -->
<g id="edge98" class="edge">
<title>layer18_moe&#45;&gt;layer19_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-45108.55C454.1,-45100.44 454.1,-45091.65 454.1,-45083.14"/>
<polygon fill="black" stroke="black" points="457.6,-45082.97 454.1,-45072.97 450.6,-45082.97 457.6,-45082.97"/>
</g>
<!-- layer19_attn_comp -->
<g id="node99" class="node">
<title>layer19_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-44968.67 240.6,-44968.67 240.6,-44900.67 667.6,-44900.67 667.6,-44968.67"/>
<text text-anchor="middle" x="454.1" y="-44953.47" font-family="Times,serif" font-size="14.00">Layer 19 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-44938.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44923.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-44908.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer19_qkv_proj&#45;&gt;layer19_attn_comp -->
<g id="edge99" class="edge">
<title>layer19_qkv_proj&#45;&gt;layer19_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-45004.55C454.1,-44996.44 454.1,-44987.65 454.1,-44979.14"/>
<polygon fill="black" stroke="black" points="457.6,-44978.97 454.1,-44968.97 450.6,-44978.97 457.6,-44978.97"/>
</g>
<!-- layer19_out_proj -->
<g id="node100" class="node">
<title>layer19_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-44864.67 246.6,-44864.67 246.6,-44796.67 661.6,-44796.67 661.6,-44864.67"/>
<text text-anchor="middle" x="454.1" y="-44849.47" font-family="Times,serif" font-size="14.00">Layer 19 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-44834.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44819.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-44804.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer19_attn_comp&#45;&gt;layer19_out_proj -->
<g id="edge100" class="edge">
<title>layer19_attn_comp&#45;&gt;layer19_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-44900.55C454.1,-44892.44 454.1,-44883.65 454.1,-44875.14"/>
<polygon fill="black" stroke="black" points="457.6,-44874.97 454.1,-44864.97 450.6,-44874.97 457.6,-44874.97"/>
</g>
<!-- layer19_gate -->
<g id="node101" class="node">
<title>layer19_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-44760.67 216.93,-44760.67 52.65,-44624.67 691.26,-44624.67 855.54,-44760.67"/>
<text text-anchor="middle" x="454.1" y="-44711.47" font-family="Times,serif" font-size="14.00">Layer 19 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-44696.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44681.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-44666.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer19_out_proj&#45;&gt;layer19_gate -->
<g id="edge101" class="edge">
<title>layer19_out_proj&#45;&gt;layer19_gate</title>
<path fill="none" stroke="black" d="M454.1,-44796.4C454.1,-44788.57 454.1,-44779.9 454.1,-44771.02"/>
<polygon fill="black" stroke="black" points="457.6,-44770.93 454.1,-44760.93 450.6,-44770.93 457.6,-44770.93"/>
</g>
<!-- layer19_moe -->
<g id="node102" class="node">
<title>layer19_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-44588.67 254.6,-44588.67 254.6,-44520.67 653.6,-44520.67 653.6,-44588.67"/>
<text text-anchor="middle" x="454.1" y="-44573.47" font-family="Times,serif" font-size="14.00">Layer 19 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-44558.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44543.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-44528.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer19_gate&#45;&gt;layer19_moe -->
<g id="edge102" class="edge">
<title>layer19_gate&#45;&gt;layer19_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-44624.46C454.1,-44615.71 454.1,-44606.94 454.1,-44598.73"/>
<polygon fill="black" stroke="black" points="457.6,-44598.68 454.1,-44588.68 450.6,-44598.68 457.6,-44598.68"/>
</g>
<!-- layer20_qkv_proj -->
<g id="node103" class="node">
<title>layer20_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-44484.67 240.6,-44484.67 240.6,-44416.67 667.6,-44416.67 667.6,-44484.67"/>
<text text-anchor="middle" x="454.1" y="-44469.47" font-family="Times,serif" font-size="14.00">Layer 20 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-44454.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44439.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-44424.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer19_moe&#45;&gt;layer20_qkv_proj -->
<g id="edge103" class="edge">
<title>layer19_moe&#45;&gt;layer20_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-44520.55C454.1,-44512.44 454.1,-44503.65 454.1,-44495.14"/>
<polygon fill="black" stroke="black" points="457.6,-44494.97 454.1,-44484.97 450.6,-44494.97 457.6,-44494.97"/>
</g>
<!-- layer20_attn_comp -->
<g id="node104" class="node">
<title>layer20_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-44380.67 240.6,-44380.67 240.6,-44312.67 667.6,-44312.67 667.6,-44380.67"/>
<text text-anchor="middle" x="454.1" y="-44365.47" font-family="Times,serif" font-size="14.00">Layer 20 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-44350.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44335.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-44320.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer20_qkv_proj&#45;&gt;layer20_attn_comp -->
<g id="edge104" class="edge">
<title>layer20_qkv_proj&#45;&gt;layer20_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-44416.55C454.1,-44408.44 454.1,-44399.65 454.1,-44391.14"/>
<polygon fill="black" stroke="black" points="457.6,-44390.97 454.1,-44380.97 450.6,-44390.97 457.6,-44390.97"/>
</g>
<!-- layer20_out_proj -->
<g id="node105" class="node">
<title>layer20_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-44276.67 246.6,-44276.67 246.6,-44208.67 661.6,-44208.67 661.6,-44276.67"/>
<text text-anchor="middle" x="454.1" y="-44261.47" font-family="Times,serif" font-size="14.00">Layer 20 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-44246.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44231.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-44216.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer20_attn_comp&#45;&gt;layer20_out_proj -->
<g id="edge105" class="edge">
<title>layer20_attn_comp&#45;&gt;layer20_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-44312.55C454.1,-44304.44 454.1,-44295.65 454.1,-44287.14"/>
<polygon fill="black" stroke="black" points="457.6,-44286.97 454.1,-44276.97 450.6,-44286.97 457.6,-44286.97"/>
</g>
<!-- layer20_gate -->
<g id="node106" class="node">
<title>layer20_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-44172.67 216.93,-44172.67 52.65,-44036.67 691.26,-44036.67 855.54,-44172.67"/>
<text text-anchor="middle" x="454.1" y="-44123.47" font-family="Times,serif" font-size="14.00">Layer 20 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-44108.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-44093.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-44078.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer20_out_proj&#45;&gt;layer20_gate -->
<g id="edge106" class="edge">
<title>layer20_out_proj&#45;&gt;layer20_gate</title>
<path fill="none" stroke="black" d="M454.1,-44208.4C454.1,-44200.57 454.1,-44191.9 454.1,-44183.02"/>
<polygon fill="black" stroke="black" points="457.6,-44182.93 454.1,-44172.93 450.6,-44182.93 457.6,-44182.93"/>
</g>
<!-- layer20_moe -->
<g id="node107" class="node">
<title>layer20_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-44000.67 254.6,-44000.67 254.6,-43932.67 653.6,-43932.67 653.6,-44000.67"/>
<text text-anchor="middle" x="454.1" y="-43985.47" font-family="Times,serif" font-size="14.00">Layer 20 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-43970.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43955.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-43940.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer20_gate&#45;&gt;layer20_moe -->
<g id="edge107" class="edge">
<title>layer20_gate&#45;&gt;layer20_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-44036.46C454.1,-44027.71 454.1,-44018.94 454.1,-44010.73"/>
<polygon fill="black" stroke="black" points="457.6,-44010.68 454.1,-44000.68 450.6,-44010.68 457.6,-44010.68"/>
</g>
<!-- layer21_qkv_proj -->
<g id="node108" class="node">
<title>layer21_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-43896.67 240.6,-43896.67 240.6,-43828.67 667.6,-43828.67 667.6,-43896.67"/>
<text text-anchor="middle" x="454.1" y="-43881.47" font-family="Times,serif" font-size="14.00">Layer 21 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-43866.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43851.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-43836.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer20_moe&#45;&gt;layer21_qkv_proj -->
<g id="edge108" class="edge">
<title>layer20_moe&#45;&gt;layer21_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-43932.55C454.1,-43924.44 454.1,-43915.65 454.1,-43907.14"/>
<polygon fill="black" stroke="black" points="457.6,-43906.97 454.1,-43896.97 450.6,-43906.97 457.6,-43906.97"/>
</g>
<!-- layer21_attn_comp -->
<g id="node109" class="node">
<title>layer21_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-43792.67 240.6,-43792.67 240.6,-43724.67 667.6,-43724.67 667.6,-43792.67"/>
<text text-anchor="middle" x="454.1" y="-43777.47" font-family="Times,serif" font-size="14.00">Layer 21 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-43762.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43747.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-43732.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer21_qkv_proj&#45;&gt;layer21_attn_comp -->
<g id="edge109" class="edge">
<title>layer21_qkv_proj&#45;&gt;layer21_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-43828.55C454.1,-43820.44 454.1,-43811.65 454.1,-43803.14"/>
<polygon fill="black" stroke="black" points="457.6,-43802.97 454.1,-43792.97 450.6,-43802.97 457.6,-43802.97"/>
</g>
<!-- layer21_out_proj -->
<g id="node110" class="node">
<title>layer21_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-43688.67 246.6,-43688.67 246.6,-43620.67 661.6,-43620.67 661.6,-43688.67"/>
<text text-anchor="middle" x="454.1" y="-43673.47" font-family="Times,serif" font-size="14.00">Layer 21 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-43658.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43643.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-43628.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer21_attn_comp&#45;&gt;layer21_out_proj -->
<g id="edge110" class="edge">
<title>layer21_attn_comp&#45;&gt;layer21_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-43724.55C454.1,-43716.44 454.1,-43707.65 454.1,-43699.14"/>
<polygon fill="black" stroke="black" points="457.6,-43698.97 454.1,-43688.97 450.6,-43698.97 457.6,-43698.97"/>
</g>
<!-- layer21_gate -->
<g id="node111" class="node">
<title>layer21_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-43584.67 216.93,-43584.67 52.65,-43448.67 691.26,-43448.67 855.54,-43584.67"/>
<text text-anchor="middle" x="454.1" y="-43535.47" font-family="Times,serif" font-size="14.00">Layer 21 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-43520.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43505.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-43490.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer21_out_proj&#45;&gt;layer21_gate -->
<g id="edge111" class="edge">
<title>layer21_out_proj&#45;&gt;layer21_gate</title>
<path fill="none" stroke="black" d="M454.1,-43620.4C454.1,-43612.57 454.1,-43603.9 454.1,-43595.02"/>
<polygon fill="black" stroke="black" points="457.6,-43594.93 454.1,-43584.93 450.6,-43594.93 457.6,-43594.93"/>
</g>
<!-- layer21_moe -->
<g id="node112" class="node">
<title>layer21_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-43412.67 254.6,-43412.67 254.6,-43344.67 653.6,-43344.67 653.6,-43412.67"/>
<text text-anchor="middle" x="454.1" y="-43397.47" font-family="Times,serif" font-size="14.00">Layer 21 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-43382.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43367.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-43352.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer21_gate&#45;&gt;layer21_moe -->
<g id="edge112" class="edge">
<title>layer21_gate&#45;&gt;layer21_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-43448.46C454.1,-43439.71 454.1,-43430.94 454.1,-43422.73"/>
<polygon fill="black" stroke="black" points="457.6,-43422.68 454.1,-43412.68 450.6,-43422.68 457.6,-43422.68"/>
</g>
<!-- layer22_qkv_proj -->
<g id="node113" class="node">
<title>layer22_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-43308.67 240.6,-43308.67 240.6,-43240.67 667.6,-43240.67 667.6,-43308.67"/>
<text text-anchor="middle" x="454.1" y="-43293.47" font-family="Times,serif" font-size="14.00">Layer 22 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-43278.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43263.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-43248.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer21_moe&#45;&gt;layer22_qkv_proj -->
<g id="edge113" class="edge">
<title>layer21_moe&#45;&gt;layer22_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-43344.55C454.1,-43336.44 454.1,-43327.65 454.1,-43319.14"/>
<polygon fill="black" stroke="black" points="457.6,-43318.97 454.1,-43308.97 450.6,-43318.97 457.6,-43318.97"/>
</g>
<!-- layer22_attn_comp -->
<g id="node114" class="node">
<title>layer22_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-43204.67 240.6,-43204.67 240.6,-43136.67 667.6,-43136.67 667.6,-43204.67"/>
<text text-anchor="middle" x="454.1" y="-43189.47" font-family="Times,serif" font-size="14.00">Layer 22 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-43174.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43159.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-43144.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer22_qkv_proj&#45;&gt;layer22_attn_comp -->
<g id="edge114" class="edge">
<title>layer22_qkv_proj&#45;&gt;layer22_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-43240.55C454.1,-43232.44 454.1,-43223.65 454.1,-43215.14"/>
<polygon fill="black" stroke="black" points="457.6,-43214.97 454.1,-43204.97 450.6,-43214.97 457.6,-43214.97"/>
</g>
<!-- layer22_out_proj -->
<g id="node115" class="node">
<title>layer22_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-43100.67 246.6,-43100.67 246.6,-43032.67 661.6,-43032.67 661.6,-43100.67"/>
<text text-anchor="middle" x="454.1" y="-43085.47" font-family="Times,serif" font-size="14.00">Layer 22 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-43070.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-43055.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-43040.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer22_attn_comp&#45;&gt;layer22_out_proj -->
<g id="edge115" class="edge">
<title>layer22_attn_comp&#45;&gt;layer22_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-43136.55C454.1,-43128.44 454.1,-43119.65 454.1,-43111.14"/>
<polygon fill="black" stroke="black" points="457.6,-43110.97 454.1,-43100.97 450.6,-43110.97 457.6,-43110.97"/>
</g>
<!-- layer22_gate -->
<g id="node116" class="node">
<title>layer22_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-42996.67 216.93,-42996.67 52.65,-42860.67 691.26,-42860.67 855.54,-42996.67"/>
<text text-anchor="middle" x="454.1" y="-42947.47" font-family="Times,serif" font-size="14.00">Layer 22 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-42932.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42917.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-42902.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer22_out_proj&#45;&gt;layer22_gate -->
<g id="edge116" class="edge">
<title>layer22_out_proj&#45;&gt;layer22_gate</title>
<path fill="none" stroke="black" d="M454.1,-43032.4C454.1,-43024.57 454.1,-43015.9 454.1,-43007.02"/>
<polygon fill="black" stroke="black" points="457.6,-43006.93 454.1,-42996.93 450.6,-43006.93 457.6,-43006.93"/>
</g>
<!-- layer22_moe -->
<g id="node117" class="node">
<title>layer22_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-42824.67 254.6,-42824.67 254.6,-42756.67 653.6,-42756.67 653.6,-42824.67"/>
<text text-anchor="middle" x="454.1" y="-42809.47" font-family="Times,serif" font-size="14.00">Layer 22 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-42794.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42779.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-42764.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer22_gate&#45;&gt;layer22_moe -->
<g id="edge117" class="edge">
<title>layer22_gate&#45;&gt;layer22_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-42860.46C454.1,-42851.71 454.1,-42842.94 454.1,-42834.73"/>
<polygon fill="black" stroke="black" points="457.6,-42834.68 454.1,-42824.68 450.6,-42834.68 457.6,-42834.68"/>
</g>
<!-- layer23_qkv_proj -->
<g id="node118" class="node">
<title>layer23_qkv_proj</title>
<polygon fill="lightblue" stroke="black" points="667.6,-42720.67 240.6,-42720.67 240.6,-42652.67 667.6,-42652.67 667.6,-42720.67"/>
<text text-anchor="middle" x="454.1" y="-42705.47" font-family="Times,serif" font-size="14.00">Layer 23 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-42690.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42675.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-42660.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer22_moe&#45;&gt;layer23_qkv_proj -->
<g id="edge118" class="edge">
<title>layer22_moe&#45;&gt;layer23_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-42756.55C454.1,-42748.44 454.1,-42739.65 454.1,-42731.14"/>
<polygon fill="black" stroke="black" points="457.6,-42730.97 454.1,-42720.97 450.6,-42730.97 457.6,-42730.97"/>
</g>
<!-- layer23_attn_comp -->
<g id="node119" class="node">
<title>layer23_attn_comp</title>
<polygon fill="lightblue" stroke="black" points="667.6,-42616.67 240.6,-42616.67 240.6,-42548.67 667.6,-42548.67 667.6,-42616.67"/>
<text text-anchor="middle" x="454.1" y="-42601.47" font-family="Times,serif" font-size="14.00">Layer 23 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-42586.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42571.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-42556.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer23_qkv_proj&#45;&gt;layer23_attn_comp -->
<g id="edge119" class="edge">
<title>layer23_qkv_proj&#45;&gt;layer23_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-42652.55C454.1,-42644.44 454.1,-42635.65 454.1,-42627.14"/>
<polygon fill="black" stroke="black" points="457.6,-42626.97 454.1,-42616.97 450.6,-42626.97 457.6,-42626.97"/>
</g>
<!-- layer23_out_proj -->
<g id="node120" class="node">
<title>layer23_out_proj</title>
<polygon fill="lightblue" stroke="black" points="661.6,-42512.67 246.6,-42512.67 246.6,-42444.67 661.6,-42444.67 661.6,-42512.67"/>
<text text-anchor="middle" x="454.1" y="-42497.47" font-family="Times,serif" font-size="14.00">Layer 23 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-42482.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42467.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-42452.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer23_attn_comp&#45;&gt;layer23_out_proj -->
<g id="edge120" class="edge">
<title>layer23_attn_comp&#45;&gt;layer23_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-42548.55C454.1,-42540.44 454.1,-42531.65 454.1,-42523.14"/>
<polygon fill="black" stroke="black" points="457.6,-42522.97 454.1,-42512.97 450.6,-42522.97 457.6,-42522.97"/>
</g>
<!-- layer23_gate -->
<g id="node121" class="node">
<title>layer23_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-42408.67 216.93,-42408.67 52.65,-42272.67 691.26,-42272.67 855.54,-42408.67"/>
<text text-anchor="middle" x="454.1" y="-42359.47" font-family="Times,serif" font-size="14.00">Layer 23 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-42344.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42329.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-42314.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer23_out_proj&#45;&gt;layer23_gate -->
<g id="edge121" class="edge">
<title>layer23_out_proj&#45;&gt;layer23_gate</title>
<path fill="none" stroke="black" d="M454.1,-42444.4C454.1,-42436.57 454.1,-42427.9 454.1,-42419.02"/>
<polygon fill="black" stroke="black" points="457.6,-42418.93 454.1,-42408.93 450.6,-42418.93 457.6,-42418.93"/>
</g>
<!-- layer23_moe -->
<g id="node122" class="node">
<title>layer23_moe</title>
<polygon fill="lightblue" stroke="black" points="653.6,-42236.67 254.6,-42236.67 254.6,-42168.67 653.6,-42168.67 653.6,-42236.67"/>
<text text-anchor="middle" x="454.1" y="-42221.47" font-family="Times,serif" font-size="14.00">Layer 23 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-42206.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="454.1" y="-42191.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-42176.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer23_gate&#45;&gt;layer23_moe -->
<g id="edge122" class="edge">
<title>layer23_gate&#45;&gt;layer23_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-42272.46C454.1,-42263.71 454.1,-42254.94 454.1,-42246.73"/>
<polygon fill="black" stroke="black" points="457.6,-42246.68 454.1,-42236.68 450.6,-42246.68 457.6,-42246.68"/>
</g>
<!-- comm_0_1 -->
<g id="node124" class="node">
<title>comm_0_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="454.1" cy="-42084.58" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="454.1" y="-42103.38" font-family="Times,serif" font-size="14.00">Pipeline Communication (Single Token)</text>
<text text-anchor="middle" x="454.1" y="-42088.38" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;8  9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-42073.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-42058.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer23_moe&#45;&gt;comm_0_1 -->
<g id="edge123" class="edge">
<title>layer23_moe&#45;&gt;comm_0_1</title>
<path fill="none" stroke="black" d="M454.1,-42168.4C454.1,-42160.41 454.1,-42151.64 454.1,-42142.9"/>
<polygon fill="black" stroke="black" points="457.6,-42142.69 454.1,-42132.69 450.6,-42142.69 457.6,-42142.69"/>
</g>
<!-- kv_access_0&#45;&gt;layer0_qkv_proj -->
<g id="edge3" class="edge">
<title>kv_access_0&#45;&gt;layer0_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-56298.51C454.1,-56284.15 454.1,-56268.73 454.1,-56254.92"/>
<polygon fill="black" stroke="black" points="457.6,-56254.73 454.1,-56244.73 450.6,-56254.73 457.6,-56254.73"/>
</g>
<!-- kv_access_1 -->
<g id="node245" class="node">
<title>kv_access_1</title>
<polygon fill="lightcyan" stroke="black" points="908.29,-42000.5 185.77,-42000.5 -0.1,-41894.5 722.43,-41894.5 908.29,-42000.5"/>
<text text-anchor="middle" x="454.1" y="-41958.8" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="454.1" y="-41943.8" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41928.8" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- comm_0_1&#45;&gt;kv_access_1 -->
<g id="edge124" class="edge">
<title>comm_0_1&#45;&gt;kv_access_1</title>
<path fill="none" stroke="black" d="M454.1,-42036.34C454.1,-42028.03 454.1,-42019.26 454.1,-42010.62"/>
<polygon fill="black" stroke="black" points="457.6,-42010.56 454.1,-42000.56 450.6,-42010.56 457.6,-42010.56"/>
</g>
<!-- layer24_qkv_proj -->
<g id="node125" class="node">
<title>layer24_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-41840.5 240.6,-41840.5 240.6,-41772.5 667.6,-41772.5 667.6,-41840.5"/>
<text text-anchor="middle" x="454.1" y="-41825.3" font-family="Times,serif" font-size="14.00">Layer 24 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-41810.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-41780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer24_attn_comp -->
<g id="node126" class="node">
<title>layer24_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-41736.5 240.6,-41736.5 240.6,-41668.5 667.6,-41668.5 667.6,-41736.5"/>
<text text-anchor="middle" x="454.1" y="-41721.3" font-family="Times,serif" font-size="14.00">Layer 24 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-41706.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41691.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-41676.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer24_qkv_proj&#45;&gt;layer24_attn_comp -->
<g id="edge126" class="edge">
<title>layer24_qkv_proj&#45;&gt;layer24_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-41772.38C454.1,-41764.28 454.1,-41755.48 454.1,-41746.97"/>
<polygon fill="black" stroke="black" points="457.6,-41746.8 454.1,-41736.8 450.6,-41746.8 457.6,-41746.8"/>
</g>
<!-- layer24_out_proj -->
<g id="node127" class="node">
<title>layer24_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-41632.5 246.6,-41632.5 246.6,-41564.5 661.6,-41564.5 661.6,-41632.5"/>
<text text-anchor="middle" x="454.1" y="-41617.3" font-family="Times,serif" font-size="14.00">Layer 24 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-41602.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41587.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-41572.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer24_attn_comp&#45;&gt;layer24_out_proj -->
<g id="edge127" class="edge">
<title>layer24_attn_comp&#45;&gt;layer24_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-41668.38C454.1,-41660.28 454.1,-41651.48 454.1,-41642.97"/>
<polygon fill="black" stroke="black" points="457.6,-41642.8 454.1,-41632.8 450.6,-41642.8 457.6,-41642.8"/>
</g>
<!-- layer24_gate -->
<g id="node128" class="node">
<title>layer24_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-41528.5 216.93,-41528.5 52.65,-41392.5 691.26,-41392.5 855.54,-41528.5"/>
<text text-anchor="middle" x="454.1" y="-41479.3" font-family="Times,serif" font-size="14.00">Layer 24 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-41464.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41449.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-41434.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer24_out_proj&#45;&gt;layer24_gate -->
<g id="edge128" class="edge">
<title>layer24_out_proj&#45;&gt;layer24_gate</title>
<path fill="none" stroke="black" d="M454.1,-41564.23C454.1,-41556.4 454.1,-41547.74 454.1,-41538.85"/>
<polygon fill="black" stroke="black" points="457.6,-41538.76 454.1,-41528.76 450.6,-41538.76 457.6,-41538.76"/>
</g>
<!-- layer24_moe -->
<g id="node129" class="node">
<title>layer24_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-41356.5 254.6,-41356.5 254.6,-41288.5 653.6,-41288.5 653.6,-41356.5"/>
<text text-anchor="middle" x="454.1" y="-41341.3" font-family="Times,serif" font-size="14.00">Layer 24 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-41326.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41311.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-41296.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer24_gate&#45;&gt;layer24_moe -->
<g id="edge129" class="edge">
<title>layer24_gate&#45;&gt;layer24_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-41392.3C454.1,-41383.54 454.1,-41374.77 454.1,-41366.57"/>
<polygon fill="black" stroke="black" points="457.6,-41366.52 454.1,-41356.52 450.6,-41366.52 457.6,-41366.52"/>
</g>
<!-- layer25_qkv_proj -->
<g id="node130" class="node">
<title>layer25_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-41252.5 240.6,-41252.5 240.6,-41184.5 667.6,-41184.5 667.6,-41252.5"/>
<text text-anchor="middle" x="454.1" y="-41237.3" font-family="Times,serif" font-size="14.00">Layer 25 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-41222.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41207.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-41192.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer24_moe&#45;&gt;layer25_qkv_proj -->
<g id="edge130" class="edge">
<title>layer24_moe&#45;&gt;layer25_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-41288.38C454.1,-41280.28 454.1,-41271.48 454.1,-41262.97"/>
<polygon fill="black" stroke="black" points="457.6,-41262.8 454.1,-41252.8 450.6,-41262.8 457.6,-41262.8"/>
</g>
<!-- layer25_attn_comp -->
<g id="node131" class="node">
<title>layer25_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-41148.5 240.6,-41148.5 240.6,-41080.5 667.6,-41080.5 667.6,-41148.5"/>
<text text-anchor="middle" x="454.1" y="-41133.3" font-family="Times,serif" font-size="14.00">Layer 25 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-41118.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-41103.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-41088.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer25_qkv_proj&#45;&gt;layer25_attn_comp -->
<g id="edge131" class="edge">
<title>layer25_qkv_proj&#45;&gt;layer25_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-41184.38C454.1,-41176.28 454.1,-41167.48 454.1,-41158.97"/>
<polygon fill="black" stroke="black" points="457.6,-41158.8 454.1,-41148.8 450.6,-41158.8 457.6,-41158.8"/>
</g>
<!-- layer25_out_proj -->
<g id="node132" class="node">
<title>layer25_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-41044.5 246.6,-41044.5 246.6,-40976.5 661.6,-40976.5 661.6,-41044.5"/>
<text text-anchor="middle" x="454.1" y="-41029.3" font-family="Times,serif" font-size="14.00">Layer 25 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-41014.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40999.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-40984.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer25_attn_comp&#45;&gt;layer25_out_proj -->
<g id="edge132" class="edge">
<title>layer25_attn_comp&#45;&gt;layer25_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-41080.38C454.1,-41072.28 454.1,-41063.48 454.1,-41054.97"/>
<polygon fill="black" stroke="black" points="457.6,-41054.8 454.1,-41044.8 450.6,-41054.8 457.6,-41054.8"/>
</g>
<!-- layer25_gate -->
<g id="node133" class="node">
<title>layer25_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-40940.5 216.93,-40940.5 52.65,-40804.5 691.26,-40804.5 855.54,-40940.5"/>
<text text-anchor="middle" x="454.1" y="-40891.3" font-family="Times,serif" font-size="14.00">Layer 25 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-40876.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40861.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-40846.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer25_out_proj&#45;&gt;layer25_gate -->
<g id="edge133" class="edge">
<title>layer25_out_proj&#45;&gt;layer25_gate</title>
<path fill="none" stroke="black" d="M454.1,-40976.23C454.1,-40968.4 454.1,-40959.74 454.1,-40950.85"/>
<polygon fill="black" stroke="black" points="457.6,-40950.76 454.1,-40940.76 450.6,-40950.76 457.6,-40950.76"/>
</g>
<!-- layer25_moe -->
<g id="node134" class="node">
<title>layer25_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-40768.5 254.6,-40768.5 254.6,-40700.5 653.6,-40700.5 653.6,-40768.5"/>
<text text-anchor="middle" x="454.1" y="-40753.3" font-family="Times,serif" font-size="14.00">Layer 25 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-40738.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40723.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-40708.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer25_gate&#45;&gt;layer25_moe -->
<g id="edge134" class="edge">
<title>layer25_gate&#45;&gt;layer25_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-40804.3C454.1,-40795.54 454.1,-40786.77 454.1,-40778.57"/>
<polygon fill="black" stroke="black" points="457.6,-40778.52 454.1,-40768.52 450.6,-40778.52 457.6,-40778.52"/>
</g>
<!-- layer26_qkv_proj -->
<g id="node135" class="node">
<title>layer26_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-40664.5 240.6,-40664.5 240.6,-40596.5 667.6,-40596.5 667.6,-40664.5"/>
<text text-anchor="middle" x="454.1" y="-40649.3" font-family="Times,serif" font-size="14.00">Layer 26 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-40634.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40619.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-40604.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer25_moe&#45;&gt;layer26_qkv_proj -->
<g id="edge135" class="edge">
<title>layer25_moe&#45;&gt;layer26_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-40700.38C454.1,-40692.28 454.1,-40683.48 454.1,-40674.97"/>
<polygon fill="black" stroke="black" points="457.6,-40674.8 454.1,-40664.8 450.6,-40674.8 457.6,-40674.8"/>
</g>
<!-- layer26_attn_comp -->
<g id="node136" class="node">
<title>layer26_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-40560.5 240.6,-40560.5 240.6,-40492.5 667.6,-40492.5 667.6,-40560.5"/>
<text text-anchor="middle" x="454.1" y="-40545.3" font-family="Times,serif" font-size="14.00">Layer 26 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-40530.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40515.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-40500.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer26_qkv_proj&#45;&gt;layer26_attn_comp -->
<g id="edge136" class="edge">
<title>layer26_qkv_proj&#45;&gt;layer26_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-40596.38C454.1,-40588.28 454.1,-40579.48 454.1,-40570.97"/>
<polygon fill="black" stroke="black" points="457.6,-40570.8 454.1,-40560.8 450.6,-40570.8 457.6,-40570.8"/>
</g>
<!-- layer26_out_proj -->
<g id="node137" class="node">
<title>layer26_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-40456.5 246.6,-40456.5 246.6,-40388.5 661.6,-40388.5 661.6,-40456.5"/>
<text text-anchor="middle" x="454.1" y="-40441.3" font-family="Times,serif" font-size="14.00">Layer 26 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-40426.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40411.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-40396.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer26_attn_comp&#45;&gt;layer26_out_proj -->
<g id="edge137" class="edge">
<title>layer26_attn_comp&#45;&gt;layer26_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-40492.38C454.1,-40484.28 454.1,-40475.48 454.1,-40466.97"/>
<polygon fill="black" stroke="black" points="457.6,-40466.8 454.1,-40456.8 450.6,-40466.8 457.6,-40466.8"/>
</g>
<!-- layer26_gate -->
<g id="node138" class="node">
<title>layer26_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-40352.5 216.93,-40352.5 52.65,-40216.5 691.26,-40216.5 855.54,-40352.5"/>
<text text-anchor="middle" x="454.1" y="-40303.3" font-family="Times,serif" font-size="14.00">Layer 26 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-40288.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40273.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-40258.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer26_out_proj&#45;&gt;layer26_gate -->
<g id="edge138" class="edge">
<title>layer26_out_proj&#45;&gt;layer26_gate</title>
<path fill="none" stroke="black" d="M454.1,-40388.23C454.1,-40380.4 454.1,-40371.74 454.1,-40362.85"/>
<polygon fill="black" stroke="black" points="457.6,-40362.76 454.1,-40352.76 450.6,-40362.76 457.6,-40362.76"/>
</g>
<!-- layer26_moe -->
<g id="node139" class="node">
<title>layer26_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-40180.5 254.6,-40180.5 254.6,-40112.5 653.6,-40112.5 653.6,-40180.5"/>
<text text-anchor="middle" x="454.1" y="-40165.3" font-family="Times,serif" font-size="14.00">Layer 26 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-40150.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40135.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-40120.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer26_gate&#45;&gt;layer26_moe -->
<g id="edge139" class="edge">
<title>layer26_gate&#45;&gt;layer26_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-40216.3C454.1,-40207.54 454.1,-40198.77 454.1,-40190.57"/>
<polygon fill="black" stroke="black" points="457.6,-40190.52 454.1,-40180.52 450.6,-40190.52 457.6,-40190.52"/>
</g>
<!-- layer27_qkv_proj -->
<g id="node140" class="node">
<title>layer27_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-40076.5 240.6,-40076.5 240.6,-40008.5 667.6,-40008.5 667.6,-40076.5"/>
<text text-anchor="middle" x="454.1" y="-40061.3" font-family="Times,serif" font-size="14.00">Layer 27 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-40046.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-40031.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-40016.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer26_moe&#45;&gt;layer27_qkv_proj -->
<g id="edge140" class="edge">
<title>layer26_moe&#45;&gt;layer27_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-40112.38C454.1,-40104.28 454.1,-40095.48 454.1,-40086.97"/>
<polygon fill="black" stroke="black" points="457.6,-40086.8 454.1,-40076.8 450.6,-40086.8 457.6,-40086.8"/>
</g>
<!-- layer27_attn_comp -->
<g id="node141" class="node">
<title>layer27_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-39972.5 240.6,-39972.5 240.6,-39904.5 667.6,-39904.5 667.6,-39972.5"/>
<text text-anchor="middle" x="454.1" y="-39957.3" font-family="Times,serif" font-size="14.00">Layer 27 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-39942.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39927.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-39912.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer27_qkv_proj&#45;&gt;layer27_attn_comp -->
<g id="edge141" class="edge">
<title>layer27_qkv_proj&#45;&gt;layer27_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-40008.38C454.1,-40000.28 454.1,-39991.48 454.1,-39982.97"/>
<polygon fill="black" stroke="black" points="457.6,-39982.8 454.1,-39972.8 450.6,-39982.8 457.6,-39982.8"/>
</g>
<!-- layer27_out_proj -->
<g id="node142" class="node">
<title>layer27_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-39868.5 246.6,-39868.5 246.6,-39800.5 661.6,-39800.5 661.6,-39868.5"/>
<text text-anchor="middle" x="454.1" y="-39853.3" font-family="Times,serif" font-size="14.00">Layer 27 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-39838.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39823.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-39808.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer27_attn_comp&#45;&gt;layer27_out_proj -->
<g id="edge142" class="edge">
<title>layer27_attn_comp&#45;&gt;layer27_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-39904.38C454.1,-39896.28 454.1,-39887.48 454.1,-39878.97"/>
<polygon fill="black" stroke="black" points="457.6,-39878.8 454.1,-39868.8 450.6,-39878.8 457.6,-39878.8"/>
</g>
<!-- layer27_gate -->
<g id="node143" class="node">
<title>layer27_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-39764.5 216.93,-39764.5 52.65,-39628.5 691.26,-39628.5 855.54,-39764.5"/>
<text text-anchor="middle" x="454.1" y="-39715.3" font-family="Times,serif" font-size="14.00">Layer 27 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-39700.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39685.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-39670.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer27_out_proj&#45;&gt;layer27_gate -->
<g id="edge143" class="edge">
<title>layer27_out_proj&#45;&gt;layer27_gate</title>
<path fill="none" stroke="black" d="M454.1,-39800.23C454.1,-39792.4 454.1,-39783.74 454.1,-39774.85"/>
<polygon fill="black" stroke="black" points="457.6,-39774.76 454.1,-39764.76 450.6,-39774.76 457.6,-39774.76"/>
</g>
<!-- layer27_moe -->
<g id="node144" class="node">
<title>layer27_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-39592.5 254.6,-39592.5 254.6,-39524.5 653.6,-39524.5 653.6,-39592.5"/>
<text text-anchor="middle" x="454.1" y="-39577.3" font-family="Times,serif" font-size="14.00">Layer 27 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-39562.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39547.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-39532.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer27_gate&#45;&gt;layer27_moe -->
<g id="edge144" class="edge">
<title>layer27_gate&#45;&gt;layer27_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-39628.3C454.1,-39619.54 454.1,-39610.77 454.1,-39602.57"/>
<polygon fill="black" stroke="black" points="457.6,-39602.52 454.1,-39592.52 450.6,-39602.52 457.6,-39602.52"/>
</g>
<!-- layer28_qkv_proj -->
<g id="node145" class="node">
<title>layer28_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-39488.5 240.6,-39488.5 240.6,-39420.5 667.6,-39420.5 667.6,-39488.5"/>
<text text-anchor="middle" x="454.1" y="-39473.3" font-family="Times,serif" font-size="14.00">Layer 28 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-39458.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39443.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-39428.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer27_moe&#45;&gt;layer28_qkv_proj -->
<g id="edge145" class="edge">
<title>layer27_moe&#45;&gt;layer28_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-39524.38C454.1,-39516.28 454.1,-39507.48 454.1,-39498.97"/>
<polygon fill="black" stroke="black" points="457.6,-39498.8 454.1,-39488.8 450.6,-39498.8 457.6,-39498.8"/>
</g>
<!-- layer28_attn_comp -->
<g id="node146" class="node">
<title>layer28_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-39384.5 240.6,-39384.5 240.6,-39316.5 667.6,-39316.5 667.6,-39384.5"/>
<text text-anchor="middle" x="454.1" y="-39369.3" font-family="Times,serif" font-size="14.00">Layer 28 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-39354.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39339.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-39324.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer28_qkv_proj&#45;&gt;layer28_attn_comp -->
<g id="edge146" class="edge">
<title>layer28_qkv_proj&#45;&gt;layer28_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-39420.38C454.1,-39412.28 454.1,-39403.48 454.1,-39394.97"/>
<polygon fill="black" stroke="black" points="457.6,-39394.8 454.1,-39384.8 450.6,-39394.8 457.6,-39394.8"/>
</g>
<!-- layer28_out_proj -->
<g id="node147" class="node">
<title>layer28_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-39280.5 246.6,-39280.5 246.6,-39212.5 661.6,-39212.5 661.6,-39280.5"/>
<text text-anchor="middle" x="454.1" y="-39265.3" font-family="Times,serif" font-size="14.00">Layer 28 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-39250.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39235.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-39220.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer28_attn_comp&#45;&gt;layer28_out_proj -->
<g id="edge147" class="edge">
<title>layer28_attn_comp&#45;&gt;layer28_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-39316.38C454.1,-39308.28 454.1,-39299.48 454.1,-39290.97"/>
<polygon fill="black" stroke="black" points="457.6,-39290.8 454.1,-39280.8 450.6,-39290.8 457.6,-39290.8"/>
</g>
<!-- layer28_gate -->
<g id="node148" class="node">
<title>layer28_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-39176.5 216.93,-39176.5 52.65,-39040.5 691.26,-39040.5 855.54,-39176.5"/>
<text text-anchor="middle" x="454.1" y="-39127.3" font-family="Times,serif" font-size="14.00">Layer 28 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-39112.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-39097.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-39082.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer28_out_proj&#45;&gt;layer28_gate -->
<g id="edge148" class="edge">
<title>layer28_out_proj&#45;&gt;layer28_gate</title>
<path fill="none" stroke="black" d="M454.1,-39212.23C454.1,-39204.4 454.1,-39195.74 454.1,-39186.85"/>
<polygon fill="black" stroke="black" points="457.6,-39186.76 454.1,-39176.76 450.6,-39186.76 457.6,-39186.76"/>
</g>
<!-- layer28_moe -->
<g id="node149" class="node">
<title>layer28_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-39004.5 254.6,-39004.5 254.6,-38936.5 653.6,-38936.5 653.6,-39004.5"/>
<text text-anchor="middle" x="454.1" y="-38989.3" font-family="Times,serif" font-size="14.00">Layer 28 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-38974.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38959.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-38944.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer28_gate&#45;&gt;layer28_moe -->
<g id="edge149" class="edge">
<title>layer28_gate&#45;&gt;layer28_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-39040.3C454.1,-39031.54 454.1,-39022.77 454.1,-39014.57"/>
<polygon fill="black" stroke="black" points="457.6,-39014.52 454.1,-39004.52 450.6,-39014.52 457.6,-39014.52"/>
</g>
<!-- layer29_qkv_proj -->
<g id="node150" class="node">
<title>layer29_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-38900.5 240.6,-38900.5 240.6,-38832.5 667.6,-38832.5 667.6,-38900.5"/>
<text text-anchor="middle" x="454.1" y="-38885.3" font-family="Times,serif" font-size="14.00">Layer 29 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-38870.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38855.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-38840.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer28_moe&#45;&gt;layer29_qkv_proj -->
<g id="edge150" class="edge">
<title>layer28_moe&#45;&gt;layer29_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-38936.38C454.1,-38928.28 454.1,-38919.48 454.1,-38910.97"/>
<polygon fill="black" stroke="black" points="457.6,-38910.8 454.1,-38900.8 450.6,-38910.8 457.6,-38910.8"/>
</g>
<!-- layer29_attn_comp -->
<g id="node151" class="node">
<title>layer29_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-38796.5 240.6,-38796.5 240.6,-38728.5 667.6,-38728.5 667.6,-38796.5"/>
<text text-anchor="middle" x="454.1" y="-38781.3" font-family="Times,serif" font-size="14.00">Layer 29 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-38766.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38751.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-38736.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer29_qkv_proj&#45;&gt;layer29_attn_comp -->
<g id="edge151" class="edge">
<title>layer29_qkv_proj&#45;&gt;layer29_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-38832.38C454.1,-38824.28 454.1,-38815.48 454.1,-38806.97"/>
<polygon fill="black" stroke="black" points="457.6,-38806.8 454.1,-38796.8 450.6,-38806.8 457.6,-38806.8"/>
</g>
<!-- layer29_out_proj -->
<g id="node152" class="node">
<title>layer29_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-38692.5 246.6,-38692.5 246.6,-38624.5 661.6,-38624.5 661.6,-38692.5"/>
<text text-anchor="middle" x="454.1" y="-38677.3" font-family="Times,serif" font-size="14.00">Layer 29 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-38662.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38647.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-38632.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer29_attn_comp&#45;&gt;layer29_out_proj -->
<g id="edge152" class="edge">
<title>layer29_attn_comp&#45;&gt;layer29_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-38728.38C454.1,-38720.28 454.1,-38711.48 454.1,-38702.97"/>
<polygon fill="black" stroke="black" points="457.6,-38702.8 454.1,-38692.8 450.6,-38702.8 457.6,-38702.8"/>
</g>
<!-- layer29_gate -->
<g id="node153" class="node">
<title>layer29_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-38588.5 216.93,-38588.5 52.65,-38452.5 691.26,-38452.5 855.54,-38588.5"/>
<text text-anchor="middle" x="454.1" y="-38539.3" font-family="Times,serif" font-size="14.00">Layer 29 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-38524.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38509.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-38494.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer29_out_proj&#45;&gt;layer29_gate -->
<g id="edge153" class="edge">
<title>layer29_out_proj&#45;&gt;layer29_gate</title>
<path fill="none" stroke="black" d="M454.1,-38624.23C454.1,-38616.4 454.1,-38607.74 454.1,-38598.85"/>
<polygon fill="black" stroke="black" points="457.6,-38598.76 454.1,-38588.76 450.6,-38598.76 457.6,-38598.76"/>
</g>
<!-- layer29_moe -->
<g id="node154" class="node">
<title>layer29_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-38416.5 254.6,-38416.5 254.6,-38348.5 653.6,-38348.5 653.6,-38416.5"/>
<text text-anchor="middle" x="454.1" y="-38401.3" font-family="Times,serif" font-size="14.00">Layer 29 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-38386.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38371.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-38356.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer29_gate&#45;&gt;layer29_moe -->
<g id="edge154" class="edge">
<title>layer29_gate&#45;&gt;layer29_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-38452.3C454.1,-38443.54 454.1,-38434.77 454.1,-38426.57"/>
<polygon fill="black" stroke="black" points="457.6,-38426.52 454.1,-38416.52 450.6,-38426.52 457.6,-38426.52"/>
</g>
<!-- layer30_qkv_proj -->
<g id="node155" class="node">
<title>layer30_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-38312.5 240.6,-38312.5 240.6,-38244.5 667.6,-38244.5 667.6,-38312.5"/>
<text text-anchor="middle" x="454.1" y="-38297.3" font-family="Times,serif" font-size="14.00">Layer 30 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-38282.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38267.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-38252.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer29_moe&#45;&gt;layer30_qkv_proj -->
<g id="edge155" class="edge">
<title>layer29_moe&#45;&gt;layer30_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-38348.38C454.1,-38340.28 454.1,-38331.48 454.1,-38322.97"/>
<polygon fill="black" stroke="black" points="457.6,-38322.8 454.1,-38312.8 450.6,-38322.8 457.6,-38322.8"/>
</g>
<!-- layer30_attn_comp -->
<g id="node156" class="node">
<title>layer30_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-38208.5 240.6,-38208.5 240.6,-38140.5 667.6,-38140.5 667.6,-38208.5"/>
<text text-anchor="middle" x="454.1" y="-38193.3" font-family="Times,serif" font-size="14.00">Layer 30 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-38178.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38163.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-38148.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer30_qkv_proj&#45;&gt;layer30_attn_comp -->
<g id="edge156" class="edge">
<title>layer30_qkv_proj&#45;&gt;layer30_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-38244.38C454.1,-38236.28 454.1,-38227.48 454.1,-38218.97"/>
<polygon fill="black" stroke="black" points="457.6,-38218.8 454.1,-38208.8 450.6,-38218.8 457.6,-38218.8"/>
</g>
<!-- layer30_out_proj -->
<g id="node157" class="node">
<title>layer30_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-38104.5 246.6,-38104.5 246.6,-38036.5 661.6,-38036.5 661.6,-38104.5"/>
<text text-anchor="middle" x="454.1" y="-38089.3" font-family="Times,serif" font-size="14.00">Layer 30 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-38074.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-38059.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-38044.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer30_attn_comp&#45;&gt;layer30_out_proj -->
<g id="edge157" class="edge">
<title>layer30_attn_comp&#45;&gt;layer30_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-38140.38C454.1,-38132.28 454.1,-38123.48 454.1,-38114.97"/>
<polygon fill="black" stroke="black" points="457.6,-38114.8 454.1,-38104.8 450.6,-38114.8 457.6,-38114.8"/>
</g>
<!-- layer30_gate -->
<g id="node158" class="node">
<title>layer30_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-38000.5 216.93,-38000.5 52.65,-37864.5 691.26,-37864.5 855.54,-38000.5"/>
<text text-anchor="middle" x="454.1" y="-37951.3" font-family="Times,serif" font-size="14.00">Layer 30 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-37936.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37921.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-37906.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer30_out_proj&#45;&gt;layer30_gate -->
<g id="edge158" class="edge">
<title>layer30_out_proj&#45;&gt;layer30_gate</title>
<path fill="none" stroke="black" d="M454.1,-38036.23C454.1,-38028.4 454.1,-38019.74 454.1,-38010.85"/>
<polygon fill="black" stroke="black" points="457.6,-38010.76 454.1,-38000.76 450.6,-38010.76 457.6,-38010.76"/>
</g>
<!-- layer30_moe -->
<g id="node159" class="node">
<title>layer30_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-37828.5 254.6,-37828.5 254.6,-37760.5 653.6,-37760.5 653.6,-37828.5"/>
<text text-anchor="middle" x="454.1" y="-37813.3" font-family="Times,serif" font-size="14.00">Layer 30 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-37798.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37783.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-37768.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer30_gate&#45;&gt;layer30_moe -->
<g id="edge159" class="edge">
<title>layer30_gate&#45;&gt;layer30_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-37864.3C454.1,-37855.54 454.1,-37846.77 454.1,-37838.57"/>
<polygon fill="black" stroke="black" points="457.6,-37838.52 454.1,-37828.52 450.6,-37838.52 457.6,-37838.52"/>
</g>
<!-- layer31_qkv_proj -->
<g id="node160" class="node">
<title>layer31_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-37724.5 240.6,-37724.5 240.6,-37656.5 667.6,-37656.5 667.6,-37724.5"/>
<text text-anchor="middle" x="454.1" y="-37709.3" font-family="Times,serif" font-size="14.00">Layer 31 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-37694.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37679.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-37664.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer30_moe&#45;&gt;layer31_qkv_proj -->
<g id="edge160" class="edge">
<title>layer30_moe&#45;&gt;layer31_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-37760.38C454.1,-37752.28 454.1,-37743.48 454.1,-37734.97"/>
<polygon fill="black" stroke="black" points="457.6,-37734.8 454.1,-37724.8 450.6,-37734.8 457.6,-37734.8"/>
</g>
<!-- layer31_attn_comp -->
<g id="node161" class="node">
<title>layer31_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-37620.5 240.6,-37620.5 240.6,-37552.5 667.6,-37552.5 667.6,-37620.5"/>
<text text-anchor="middle" x="454.1" y="-37605.3" font-family="Times,serif" font-size="14.00">Layer 31 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-37590.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-37560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer31_qkv_proj&#45;&gt;layer31_attn_comp -->
<g id="edge161" class="edge">
<title>layer31_qkv_proj&#45;&gt;layer31_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-37656.38C454.1,-37648.28 454.1,-37639.48 454.1,-37630.97"/>
<polygon fill="black" stroke="black" points="457.6,-37630.8 454.1,-37620.8 450.6,-37630.8 457.6,-37630.8"/>
</g>
<!-- layer31_out_proj -->
<g id="node162" class="node">
<title>layer31_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-37516.5 246.6,-37516.5 246.6,-37448.5 661.6,-37448.5 661.6,-37516.5"/>
<text text-anchor="middle" x="454.1" y="-37501.3" font-family="Times,serif" font-size="14.00">Layer 31 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-37486.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37471.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-37456.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer31_attn_comp&#45;&gt;layer31_out_proj -->
<g id="edge162" class="edge">
<title>layer31_attn_comp&#45;&gt;layer31_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-37552.38C454.1,-37544.28 454.1,-37535.48 454.1,-37526.97"/>
<polygon fill="black" stroke="black" points="457.6,-37526.8 454.1,-37516.8 450.6,-37526.8 457.6,-37526.8"/>
</g>
<!-- layer31_gate -->
<g id="node163" class="node">
<title>layer31_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-37412.5 216.93,-37412.5 52.65,-37276.5 691.26,-37276.5 855.54,-37412.5"/>
<text text-anchor="middle" x="454.1" y="-37363.3" font-family="Times,serif" font-size="14.00">Layer 31 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-37348.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37333.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-37318.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer31_out_proj&#45;&gt;layer31_gate -->
<g id="edge163" class="edge">
<title>layer31_out_proj&#45;&gt;layer31_gate</title>
<path fill="none" stroke="black" d="M454.1,-37448.23C454.1,-37440.4 454.1,-37431.74 454.1,-37422.85"/>
<polygon fill="black" stroke="black" points="457.6,-37422.76 454.1,-37412.76 450.6,-37422.76 457.6,-37422.76"/>
</g>
<!-- layer31_moe -->
<g id="node164" class="node">
<title>layer31_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-37240.5 254.6,-37240.5 254.6,-37172.5 653.6,-37172.5 653.6,-37240.5"/>
<text text-anchor="middle" x="454.1" y="-37225.3" font-family="Times,serif" font-size="14.00">Layer 31 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-37210.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37195.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-37180.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer31_gate&#45;&gt;layer31_moe -->
<g id="edge164" class="edge">
<title>layer31_gate&#45;&gt;layer31_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-37276.3C454.1,-37267.54 454.1,-37258.77 454.1,-37250.57"/>
<polygon fill="black" stroke="black" points="457.6,-37250.52 454.1,-37240.52 450.6,-37250.52 457.6,-37250.52"/>
</g>
<!-- layer32_qkv_proj -->
<g id="node165" class="node">
<title>layer32_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-37136.5 240.6,-37136.5 240.6,-37068.5 667.6,-37068.5 667.6,-37136.5"/>
<text text-anchor="middle" x="454.1" y="-37121.3" font-family="Times,serif" font-size="14.00">Layer 32 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-37106.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-37091.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-37076.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer31_moe&#45;&gt;layer32_qkv_proj -->
<g id="edge165" class="edge">
<title>layer31_moe&#45;&gt;layer32_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-37172.38C454.1,-37164.28 454.1,-37155.48 454.1,-37146.97"/>
<polygon fill="black" stroke="black" points="457.6,-37146.8 454.1,-37136.8 450.6,-37146.8 457.6,-37146.8"/>
</g>
<!-- layer32_attn_comp -->
<g id="node166" class="node">
<title>layer32_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-37032.5 240.6,-37032.5 240.6,-36964.5 667.6,-36964.5 667.6,-37032.5"/>
<text text-anchor="middle" x="454.1" y="-37017.3" font-family="Times,serif" font-size="14.00">Layer 32 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-37002.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36987.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-36972.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer32_qkv_proj&#45;&gt;layer32_attn_comp -->
<g id="edge166" class="edge">
<title>layer32_qkv_proj&#45;&gt;layer32_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-37068.38C454.1,-37060.28 454.1,-37051.48 454.1,-37042.97"/>
<polygon fill="black" stroke="black" points="457.6,-37042.8 454.1,-37032.8 450.6,-37042.8 457.6,-37042.8"/>
</g>
<!-- layer32_out_proj -->
<g id="node167" class="node">
<title>layer32_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-36928.5 246.6,-36928.5 246.6,-36860.5 661.6,-36860.5 661.6,-36928.5"/>
<text text-anchor="middle" x="454.1" y="-36913.3" font-family="Times,serif" font-size="14.00">Layer 32 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-36898.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36883.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-36868.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer32_attn_comp&#45;&gt;layer32_out_proj -->
<g id="edge167" class="edge">
<title>layer32_attn_comp&#45;&gt;layer32_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-36964.38C454.1,-36956.28 454.1,-36947.48 454.1,-36938.97"/>
<polygon fill="black" stroke="black" points="457.6,-36938.8 454.1,-36928.8 450.6,-36938.8 457.6,-36938.8"/>
</g>
<!-- layer32_gate -->
<g id="node168" class="node">
<title>layer32_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-36824.5 216.93,-36824.5 52.65,-36688.5 691.26,-36688.5 855.54,-36824.5"/>
<text text-anchor="middle" x="454.1" y="-36775.3" font-family="Times,serif" font-size="14.00">Layer 32 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-36760.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36745.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-36730.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer32_out_proj&#45;&gt;layer32_gate -->
<g id="edge168" class="edge">
<title>layer32_out_proj&#45;&gt;layer32_gate</title>
<path fill="none" stroke="black" d="M454.1,-36860.23C454.1,-36852.4 454.1,-36843.74 454.1,-36834.85"/>
<polygon fill="black" stroke="black" points="457.6,-36834.76 454.1,-36824.76 450.6,-36834.76 457.6,-36834.76"/>
</g>
<!-- layer32_moe -->
<g id="node169" class="node">
<title>layer32_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-36652.5 254.6,-36652.5 254.6,-36584.5 653.6,-36584.5 653.6,-36652.5"/>
<text text-anchor="middle" x="454.1" y="-36637.3" font-family="Times,serif" font-size="14.00">Layer 32 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-36622.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36607.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-36592.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer32_gate&#45;&gt;layer32_moe -->
<g id="edge169" class="edge">
<title>layer32_gate&#45;&gt;layer32_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-36688.3C454.1,-36679.54 454.1,-36670.77 454.1,-36662.57"/>
<polygon fill="black" stroke="black" points="457.6,-36662.52 454.1,-36652.52 450.6,-36662.52 457.6,-36662.52"/>
</g>
<!-- layer33_qkv_proj -->
<g id="node170" class="node">
<title>layer33_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-36548.5 240.6,-36548.5 240.6,-36480.5 667.6,-36480.5 667.6,-36548.5"/>
<text text-anchor="middle" x="454.1" y="-36533.3" font-family="Times,serif" font-size="14.00">Layer 33 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-36518.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36503.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-36488.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer32_moe&#45;&gt;layer33_qkv_proj -->
<g id="edge170" class="edge">
<title>layer32_moe&#45;&gt;layer33_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-36584.38C454.1,-36576.28 454.1,-36567.48 454.1,-36558.97"/>
<polygon fill="black" stroke="black" points="457.6,-36558.8 454.1,-36548.8 450.6,-36558.8 457.6,-36558.8"/>
</g>
<!-- layer33_attn_comp -->
<g id="node171" class="node">
<title>layer33_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-36444.5 240.6,-36444.5 240.6,-36376.5 667.6,-36376.5 667.6,-36444.5"/>
<text text-anchor="middle" x="454.1" y="-36429.3" font-family="Times,serif" font-size="14.00">Layer 33 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-36414.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36399.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-36384.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer33_qkv_proj&#45;&gt;layer33_attn_comp -->
<g id="edge171" class="edge">
<title>layer33_qkv_proj&#45;&gt;layer33_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-36480.38C454.1,-36472.28 454.1,-36463.48 454.1,-36454.97"/>
<polygon fill="black" stroke="black" points="457.6,-36454.8 454.1,-36444.8 450.6,-36454.8 457.6,-36454.8"/>
</g>
<!-- layer33_out_proj -->
<g id="node172" class="node">
<title>layer33_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-36340.5 246.6,-36340.5 246.6,-36272.5 661.6,-36272.5 661.6,-36340.5"/>
<text text-anchor="middle" x="454.1" y="-36325.3" font-family="Times,serif" font-size="14.00">Layer 33 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-36310.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36295.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-36280.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer33_attn_comp&#45;&gt;layer33_out_proj -->
<g id="edge172" class="edge">
<title>layer33_attn_comp&#45;&gt;layer33_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-36376.38C454.1,-36368.28 454.1,-36359.48 454.1,-36350.97"/>
<polygon fill="black" stroke="black" points="457.6,-36350.8 454.1,-36340.8 450.6,-36350.8 457.6,-36350.8"/>
</g>
<!-- layer33_gate -->
<g id="node173" class="node">
<title>layer33_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-36236.5 216.93,-36236.5 52.65,-36100.5 691.26,-36100.5 855.54,-36236.5"/>
<text text-anchor="middle" x="454.1" y="-36187.3" font-family="Times,serif" font-size="14.00">Layer 33 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-36172.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36157.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-36142.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer33_out_proj&#45;&gt;layer33_gate -->
<g id="edge173" class="edge">
<title>layer33_out_proj&#45;&gt;layer33_gate</title>
<path fill="none" stroke="black" d="M454.1,-36272.23C454.1,-36264.4 454.1,-36255.74 454.1,-36246.85"/>
<polygon fill="black" stroke="black" points="457.6,-36246.76 454.1,-36236.76 450.6,-36246.76 457.6,-36246.76"/>
</g>
<!-- layer33_moe -->
<g id="node174" class="node">
<title>layer33_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-36064.5 254.6,-36064.5 254.6,-35996.5 653.6,-35996.5 653.6,-36064.5"/>
<text text-anchor="middle" x="454.1" y="-36049.3" font-family="Times,serif" font-size="14.00">Layer 33 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-36034.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-36019.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-36004.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer33_gate&#45;&gt;layer33_moe -->
<g id="edge174" class="edge">
<title>layer33_gate&#45;&gt;layer33_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-36100.3C454.1,-36091.54 454.1,-36082.77 454.1,-36074.57"/>
<polygon fill="black" stroke="black" points="457.6,-36074.52 454.1,-36064.52 450.6,-36074.52 457.6,-36074.52"/>
</g>
<!-- layer34_qkv_proj -->
<g id="node175" class="node">
<title>layer34_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-35960.5 240.6,-35960.5 240.6,-35892.5 667.6,-35892.5 667.6,-35960.5"/>
<text text-anchor="middle" x="454.1" y="-35945.3" font-family="Times,serif" font-size="14.00">Layer 34 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-35930.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35915.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-35900.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer33_moe&#45;&gt;layer34_qkv_proj -->
<g id="edge175" class="edge">
<title>layer33_moe&#45;&gt;layer34_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-35996.38C454.1,-35988.28 454.1,-35979.48 454.1,-35970.97"/>
<polygon fill="black" stroke="black" points="457.6,-35970.8 454.1,-35960.8 450.6,-35970.8 457.6,-35970.8"/>
</g>
<!-- layer34_attn_comp -->
<g id="node176" class="node">
<title>layer34_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-35856.5 240.6,-35856.5 240.6,-35788.5 667.6,-35788.5 667.6,-35856.5"/>
<text text-anchor="middle" x="454.1" y="-35841.3" font-family="Times,serif" font-size="14.00">Layer 34 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-35826.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35811.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-35796.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer34_qkv_proj&#45;&gt;layer34_attn_comp -->
<g id="edge176" class="edge">
<title>layer34_qkv_proj&#45;&gt;layer34_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-35892.38C454.1,-35884.28 454.1,-35875.48 454.1,-35866.97"/>
<polygon fill="black" stroke="black" points="457.6,-35866.8 454.1,-35856.8 450.6,-35866.8 457.6,-35866.8"/>
</g>
<!-- layer34_out_proj -->
<g id="node177" class="node">
<title>layer34_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-35752.5 246.6,-35752.5 246.6,-35684.5 661.6,-35684.5 661.6,-35752.5"/>
<text text-anchor="middle" x="454.1" y="-35737.3" font-family="Times,serif" font-size="14.00">Layer 34 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-35722.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35707.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-35692.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer34_attn_comp&#45;&gt;layer34_out_proj -->
<g id="edge177" class="edge">
<title>layer34_attn_comp&#45;&gt;layer34_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-35788.38C454.1,-35780.28 454.1,-35771.48 454.1,-35762.97"/>
<polygon fill="black" stroke="black" points="457.6,-35762.8 454.1,-35752.8 450.6,-35762.8 457.6,-35762.8"/>
</g>
<!-- layer34_gate -->
<g id="node178" class="node">
<title>layer34_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-35648.5 216.93,-35648.5 52.65,-35512.5 691.26,-35512.5 855.54,-35648.5"/>
<text text-anchor="middle" x="454.1" y="-35599.3" font-family="Times,serif" font-size="14.00">Layer 34 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-35584.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35569.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-35554.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer34_out_proj&#45;&gt;layer34_gate -->
<g id="edge178" class="edge">
<title>layer34_out_proj&#45;&gt;layer34_gate</title>
<path fill="none" stroke="black" d="M454.1,-35684.23C454.1,-35676.4 454.1,-35667.74 454.1,-35658.85"/>
<polygon fill="black" stroke="black" points="457.6,-35658.76 454.1,-35648.76 450.6,-35658.76 457.6,-35658.76"/>
</g>
<!-- layer34_moe -->
<g id="node179" class="node">
<title>layer34_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-35476.5 254.6,-35476.5 254.6,-35408.5 653.6,-35408.5 653.6,-35476.5"/>
<text text-anchor="middle" x="454.1" y="-35461.3" font-family="Times,serif" font-size="14.00">Layer 34 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-35446.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35431.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-35416.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer34_gate&#45;&gt;layer34_moe -->
<g id="edge179" class="edge">
<title>layer34_gate&#45;&gt;layer34_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-35512.3C454.1,-35503.54 454.1,-35494.77 454.1,-35486.57"/>
<polygon fill="black" stroke="black" points="457.6,-35486.52 454.1,-35476.52 450.6,-35486.52 457.6,-35486.52"/>
</g>
<!-- layer35_qkv_proj -->
<g id="node180" class="node">
<title>layer35_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-35372.5 240.6,-35372.5 240.6,-35304.5 667.6,-35304.5 667.6,-35372.5"/>
<text text-anchor="middle" x="454.1" y="-35357.3" font-family="Times,serif" font-size="14.00">Layer 35 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-35342.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35327.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-35312.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer34_moe&#45;&gt;layer35_qkv_proj -->
<g id="edge180" class="edge">
<title>layer34_moe&#45;&gt;layer35_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-35408.38C454.1,-35400.28 454.1,-35391.48 454.1,-35382.97"/>
<polygon fill="black" stroke="black" points="457.6,-35382.8 454.1,-35372.8 450.6,-35382.8 457.6,-35382.8"/>
</g>
<!-- layer35_attn_comp -->
<g id="node181" class="node">
<title>layer35_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-35268.5 240.6,-35268.5 240.6,-35200.5 667.6,-35200.5 667.6,-35268.5"/>
<text text-anchor="middle" x="454.1" y="-35253.3" font-family="Times,serif" font-size="14.00">Layer 35 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-35238.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35223.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-35208.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer35_qkv_proj&#45;&gt;layer35_attn_comp -->
<g id="edge181" class="edge">
<title>layer35_qkv_proj&#45;&gt;layer35_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-35304.38C454.1,-35296.28 454.1,-35287.48 454.1,-35278.97"/>
<polygon fill="black" stroke="black" points="457.6,-35278.8 454.1,-35268.8 450.6,-35278.8 457.6,-35278.8"/>
</g>
<!-- layer35_out_proj -->
<g id="node182" class="node">
<title>layer35_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-35164.5 246.6,-35164.5 246.6,-35096.5 661.6,-35096.5 661.6,-35164.5"/>
<text text-anchor="middle" x="454.1" y="-35149.3" font-family="Times,serif" font-size="14.00">Layer 35 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-35134.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-35119.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-35104.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer35_attn_comp&#45;&gt;layer35_out_proj -->
<g id="edge182" class="edge">
<title>layer35_attn_comp&#45;&gt;layer35_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-35200.38C454.1,-35192.28 454.1,-35183.48 454.1,-35174.97"/>
<polygon fill="black" stroke="black" points="457.6,-35174.8 454.1,-35164.8 450.6,-35174.8 457.6,-35174.8"/>
</g>
<!-- layer35_gate -->
<g id="node183" class="node">
<title>layer35_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-35060.5 216.93,-35060.5 52.65,-34924.5 691.26,-34924.5 855.54,-35060.5"/>
<text text-anchor="middle" x="454.1" y="-35011.3" font-family="Times,serif" font-size="14.00">Layer 35 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-34996.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34981.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-34966.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer35_out_proj&#45;&gt;layer35_gate -->
<g id="edge183" class="edge">
<title>layer35_out_proj&#45;&gt;layer35_gate</title>
<path fill="none" stroke="black" d="M454.1,-35096.23C454.1,-35088.4 454.1,-35079.74 454.1,-35070.85"/>
<polygon fill="black" stroke="black" points="457.6,-35070.76 454.1,-35060.76 450.6,-35070.76 457.6,-35070.76"/>
</g>
<!-- layer35_moe -->
<g id="node184" class="node">
<title>layer35_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-34888.5 254.6,-34888.5 254.6,-34820.5 653.6,-34820.5 653.6,-34888.5"/>
<text text-anchor="middle" x="454.1" y="-34873.3" font-family="Times,serif" font-size="14.00">Layer 35 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-34858.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34843.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-34828.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer35_gate&#45;&gt;layer35_moe -->
<g id="edge184" class="edge">
<title>layer35_gate&#45;&gt;layer35_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-34924.3C454.1,-34915.54 454.1,-34906.77 454.1,-34898.57"/>
<polygon fill="black" stroke="black" points="457.6,-34898.52 454.1,-34888.52 450.6,-34898.52 457.6,-34898.52"/>
</g>
<!-- layer36_qkv_proj -->
<g id="node185" class="node">
<title>layer36_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-34784.5 240.6,-34784.5 240.6,-34716.5 667.6,-34716.5 667.6,-34784.5"/>
<text text-anchor="middle" x="454.1" y="-34769.3" font-family="Times,serif" font-size="14.00">Layer 36 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-34754.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34739.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-34724.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer35_moe&#45;&gt;layer36_qkv_proj -->
<g id="edge185" class="edge">
<title>layer35_moe&#45;&gt;layer36_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-34820.38C454.1,-34812.28 454.1,-34803.48 454.1,-34794.97"/>
<polygon fill="black" stroke="black" points="457.6,-34794.8 454.1,-34784.8 450.6,-34794.8 457.6,-34794.8"/>
</g>
<!-- layer36_attn_comp -->
<g id="node186" class="node">
<title>layer36_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-34680.5 240.6,-34680.5 240.6,-34612.5 667.6,-34612.5 667.6,-34680.5"/>
<text text-anchor="middle" x="454.1" y="-34665.3" font-family="Times,serif" font-size="14.00">Layer 36 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-34650.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34635.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-34620.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer36_qkv_proj&#45;&gt;layer36_attn_comp -->
<g id="edge186" class="edge">
<title>layer36_qkv_proj&#45;&gt;layer36_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-34716.38C454.1,-34708.28 454.1,-34699.48 454.1,-34690.97"/>
<polygon fill="black" stroke="black" points="457.6,-34690.8 454.1,-34680.8 450.6,-34690.8 457.6,-34690.8"/>
</g>
<!-- layer36_out_proj -->
<g id="node187" class="node">
<title>layer36_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-34576.5 246.6,-34576.5 246.6,-34508.5 661.6,-34508.5 661.6,-34576.5"/>
<text text-anchor="middle" x="454.1" y="-34561.3" font-family="Times,serif" font-size="14.00">Layer 36 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-34546.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34531.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-34516.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer36_attn_comp&#45;&gt;layer36_out_proj -->
<g id="edge187" class="edge">
<title>layer36_attn_comp&#45;&gt;layer36_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-34612.38C454.1,-34604.28 454.1,-34595.48 454.1,-34586.97"/>
<polygon fill="black" stroke="black" points="457.6,-34586.8 454.1,-34576.8 450.6,-34586.8 457.6,-34586.8"/>
</g>
<!-- layer36_gate -->
<g id="node188" class="node">
<title>layer36_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-34472.5 216.93,-34472.5 52.65,-34336.5 691.26,-34336.5 855.54,-34472.5"/>
<text text-anchor="middle" x="454.1" y="-34423.3" font-family="Times,serif" font-size="14.00">Layer 36 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-34408.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34393.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-34378.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer36_out_proj&#45;&gt;layer36_gate -->
<g id="edge188" class="edge">
<title>layer36_out_proj&#45;&gt;layer36_gate</title>
<path fill="none" stroke="black" d="M454.1,-34508.23C454.1,-34500.4 454.1,-34491.74 454.1,-34482.85"/>
<polygon fill="black" stroke="black" points="457.6,-34482.76 454.1,-34472.76 450.6,-34482.76 457.6,-34482.76"/>
</g>
<!-- layer36_moe -->
<g id="node189" class="node">
<title>layer36_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-34300.5 254.6,-34300.5 254.6,-34232.5 653.6,-34232.5 653.6,-34300.5"/>
<text text-anchor="middle" x="454.1" y="-34285.3" font-family="Times,serif" font-size="14.00">Layer 36 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-34270.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34255.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-34240.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer36_gate&#45;&gt;layer36_moe -->
<g id="edge189" class="edge">
<title>layer36_gate&#45;&gt;layer36_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-34336.3C454.1,-34327.54 454.1,-34318.77 454.1,-34310.57"/>
<polygon fill="black" stroke="black" points="457.6,-34310.52 454.1,-34300.52 450.6,-34310.52 457.6,-34310.52"/>
</g>
<!-- layer37_qkv_proj -->
<g id="node190" class="node">
<title>layer37_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-34196.5 240.6,-34196.5 240.6,-34128.5 667.6,-34128.5 667.6,-34196.5"/>
<text text-anchor="middle" x="454.1" y="-34181.3" font-family="Times,serif" font-size="14.00">Layer 37 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-34166.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34151.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-34136.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer36_moe&#45;&gt;layer37_qkv_proj -->
<g id="edge190" class="edge">
<title>layer36_moe&#45;&gt;layer37_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-34232.38C454.1,-34224.28 454.1,-34215.48 454.1,-34206.97"/>
<polygon fill="black" stroke="black" points="457.6,-34206.8 454.1,-34196.8 450.6,-34206.8 457.6,-34206.8"/>
</g>
<!-- layer37_attn_comp -->
<g id="node191" class="node">
<title>layer37_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-34092.5 240.6,-34092.5 240.6,-34024.5 667.6,-34024.5 667.6,-34092.5"/>
<text text-anchor="middle" x="454.1" y="-34077.3" font-family="Times,serif" font-size="14.00">Layer 37 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-34062.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-34047.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-34032.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer37_qkv_proj&#45;&gt;layer37_attn_comp -->
<g id="edge191" class="edge">
<title>layer37_qkv_proj&#45;&gt;layer37_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-34128.38C454.1,-34120.28 454.1,-34111.48 454.1,-34102.97"/>
<polygon fill="black" stroke="black" points="457.6,-34102.8 454.1,-34092.8 450.6,-34102.8 457.6,-34102.8"/>
</g>
<!-- layer37_out_proj -->
<g id="node192" class="node">
<title>layer37_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-33988.5 246.6,-33988.5 246.6,-33920.5 661.6,-33920.5 661.6,-33988.5"/>
<text text-anchor="middle" x="454.1" y="-33973.3" font-family="Times,serif" font-size="14.00">Layer 37 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-33958.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33943.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-33928.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer37_attn_comp&#45;&gt;layer37_out_proj -->
<g id="edge192" class="edge">
<title>layer37_attn_comp&#45;&gt;layer37_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-34024.38C454.1,-34016.28 454.1,-34007.48 454.1,-33998.97"/>
<polygon fill="black" stroke="black" points="457.6,-33998.8 454.1,-33988.8 450.6,-33998.8 457.6,-33998.8"/>
</g>
<!-- layer37_gate -->
<g id="node193" class="node">
<title>layer37_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-33884.5 216.93,-33884.5 52.65,-33748.5 691.26,-33748.5 855.54,-33884.5"/>
<text text-anchor="middle" x="454.1" y="-33835.3" font-family="Times,serif" font-size="14.00">Layer 37 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-33820.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33805.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-33790.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer37_out_proj&#45;&gt;layer37_gate -->
<g id="edge193" class="edge">
<title>layer37_out_proj&#45;&gt;layer37_gate</title>
<path fill="none" stroke="black" d="M454.1,-33920.23C454.1,-33912.4 454.1,-33903.74 454.1,-33894.85"/>
<polygon fill="black" stroke="black" points="457.6,-33894.76 454.1,-33884.76 450.6,-33894.76 457.6,-33894.76"/>
</g>
<!-- layer37_moe -->
<g id="node194" class="node">
<title>layer37_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-33712.5 254.6,-33712.5 254.6,-33644.5 653.6,-33644.5 653.6,-33712.5"/>
<text text-anchor="middle" x="454.1" y="-33697.3" font-family="Times,serif" font-size="14.00">Layer 37 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-33682.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33667.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-33652.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer37_gate&#45;&gt;layer37_moe -->
<g id="edge194" class="edge">
<title>layer37_gate&#45;&gt;layer37_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-33748.3C454.1,-33739.54 454.1,-33730.77 454.1,-33722.57"/>
<polygon fill="black" stroke="black" points="457.6,-33722.52 454.1,-33712.52 450.6,-33722.52 457.6,-33722.52"/>
</g>
<!-- layer38_qkv_proj -->
<g id="node195" class="node">
<title>layer38_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-33608.5 240.6,-33608.5 240.6,-33540.5 667.6,-33540.5 667.6,-33608.5"/>
<text text-anchor="middle" x="454.1" y="-33593.3" font-family="Times,serif" font-size="14.00">Layer 38 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-33578.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33563.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-33548.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer37_moe&#45;&gt;layer38_qkv_proj -->
<g id="edge195" class="edge">
<title>layer37_moe&#45;&gt;layer38_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-33644.38C454.1,-33636.28 454.1,-33627.48 454.1,-33618.97"/>
<polygon fill="black" stroke="black" points="457.6,-33618.8 454.1,-33608.8 450.6,-33618.8 457.6,-33618.8"/>
</g>
<!-- layer38_attn_comp -->
<g id="node196" class="node">
<title>layer38_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-33504.5 240.6,-33504.5 240.6,-33436.5 667.6,-33436.5 667.6,-33504.5"/>
<text text-anchor="middle" x="454.1" y="-33489.3" font-family="Times,serif" font-size="14.00">Layer 38 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-33474.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33459.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-33444.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer38_qkv_proj&#45;&gt;layer38_attn_comp -->
<g id="edge196" class="edge">
<title>layer38_qkv_proj&#45;&gt;layer38_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-33540.38C454.1,-33532.28 454.1,-33523.48 454.1,-33514.97"/>
<polygon fill="black" stroke="black" points="457.6,-33514.8 454.1,-33504.8 450.6,-33514.8 457.6,-33514.8"/>
</g>
<!-- layer38_out_proj -->
<g id="node197" class="node">
<title>layer38_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-33400.5 246.6,-33400.5 246.6,-33332.5 661.6,-33332.5 661.6,-33400.5"/>
<text text-anchor="middle" x="454.1" y="-33385.3" font-family="Times,serif" font-size="14.00">Layer 38 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-33370.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33355.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-33340.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer38_attn_comp&#45;&gt;layer38_out_proj -->
<g id="edge197" class="edge">
<title>layer38_attn_comp&#45;&gt;layer38_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-33436.38C454.1,-33428.28 454.1,-33419.48 454.1,-33410.97"/>
<polygon fill="black" stroke="black" points="457.6,-33410.8 454.1,-33400.8 450.6,-33410.8 457.6,-33410.8"/>
</g>
<!-- layer38_gate -->
<g id="node198" class="node">
<title>layer38_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-33296.5 216.93,-33296.5 52.65,-33160.5 691.26,-33160.5 855.54,-33296.5"/>
<text text-anchor="middle" x="454.1" y="-33247.3" font-family="Times,serif" font-size="14.00">Layer 38 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-33232.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33217.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-33202.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer38_out_proj&#45;&gt;layer38_gate -->
<g id="edge198" class="edge">
<title>layer38_out_proj&#45;&gt;layer38_gate</title>
<path fill="none" stroke="black" d="M454.1,-33332.23C454.1,-33324.4 454.1,-33315.74 454.1,-33306.85"/>
<polygon fill="black" stroke="black" points="457.6,-33306.76 454.1,-33296.76 450.6,-33306.76 457.6,-33306.76"/>
</g>
<!-- layer38_moe -->
<g id="node199" class="node">
<title>layer38_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-33124.5 254.6,-33124.5 254.6,-33056.5 653.6,-33056.5 653.6,-33124.5"/>
<text text-anchor="middle" x="454.1" y="-33109.3" font-family="Times,serif" font-size="14.00">Layer 38 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-33094.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-33079.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-33064.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer38_gate&#45;&gt;layer38_moe -->
<g id="edge199" class="edge">
<title>layer38_gate&#45;&gt;layer38_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-33160.3C454.1,-33151.54 454.1,-33142.77 454.1,-33134.57"/>
<polygon fill="black" stroke="black" points="457.6,-33134.52 454.1,-33124.52 450.6,-33134.52 457.6,-33134.52"/>
</g>
<!-- layer39_qkv_proj -->
<g id="node200" class="node">
<title>layer39_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-33020.5 240.6,-33020.5 240.6,-32952.5 667.6,-32952.5 667.6,-33020.5"/>
<text text-anchor="middle" x="454.1" y="-33005.3" font-family="Times,serif" font-size="14.00">Layer 39 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-32990.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32975.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-32960.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer38_moe&#45;&gt;layer39_qkv_proj -->
<g id="edge200" class="edge">
<title>layer38_moe&#45;&gt;layer39_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-33056.38C454.1,-33048.28 454.1,-33039.48 454.1,-33030.97"/>
<polygon fill="black" stroke="black" points="457.6,-33030.8 454.1,-33020.8 450.6,-33030.8 457.6,-33030.8"/>
</g>
<!-- layer39_attn_comp -->
<g id="node201" class="node">
<title>layer39_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-32916.5 240.6,-32916.5 240.6,-32848.5 667.6,-32848.5 667.6,-32916.5"/>
<text text-anchor="middle" x="454.1" y="-32901.3" font-family="Times,serif" font-size="14.00">Layer 39 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-32886.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32871.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-32856.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer39_qkv_proj&#45;&gt;layer39_attn_comp -->
<g id="edge201" class="edge">
<title>layer39_qkv_proj&#45;&gt;layer39_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-32952.38C454.1,-32944.28 454.1,-32935.48 454.1,-32926.97"/>
<polygon fill="black" stroke="black" points="457.6,-32926.8 454.1,-32916.8 450.6,-32926.8 457.6,-32926.8"/>
</g>
<!-- layer39_out_proj -->
<g id="node202" class="node">
<title>layer39_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-32812.5 246.6,-32812.5 246.6,-32744.5 661.6,-32744.5 661.6,-32812.5"/>
<text text-anchor="middle" x="454.1" y="-32797.3" font-family="Times,serif" font-size="14.00">Layer 39 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-32782.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32767.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-32752.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer39_attn_comp&#45;&gt;layer39_out_proj -->
<g id="edge202" class="edge">
<title>layer39_attn_comp&#45;&gt;layer39_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-32848.38C454.1,-32840.28 454.1,-32831.48 454.1,-32822.97"/>
<polygon fill="black" stroke="black" points="457.6,-32822.8 454.1,-32812.8 450.6,-32822.8 457.6,-32822.8"/>
</g>
<!-- layer39_gate -->
<g id="node203" class="node">
<title>layer39_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-32708.5 216.93,-32708.5 52.65,-32572.5 691.26,-32572.5 855.54,-32708.5"/>
<text text-anchor="middle" x="454.1" y="-32659.3" font-family="Times,serif" font-size="14.00">Layer 39 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-32644.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32629.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-32614.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer39_out_proj&#45;&gt;layer39_gate -->
<g id="edge203" class="edge">
<title>layer39_out_proj&#45;&gt;layer39_gate</title>
<path fill="none" stroke="black" d="M454.1,-32744.23C454.1,-32736.4 454.1,-32727.74 454.1,-32718.85"/>
<polygon fill="black" stroke="black" points="457.6,-32718.76 454.1,-32708.76 450.6,-32718.76 457.6,-32718.76"/>
</g>
<!-- layer39_moe -->
<g id="node204" class="node">
<title>layer39_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-32536.5 254.6,-32536.5 254.6,-32468.5 653.6,-32468.5 653.6,-32536.5"/>
<text text-anchor="middle" x="454.1" y="-32521.3" font-family="Times,serif" font-size="14.00">Layer 39 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-32506.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32491.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-32476.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer39_gate&#45;&gt;layer39_moe -->
<g id="edge204" class="edge">
<title>layer39_gate&#45;&gt;layer39_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-32572.3C454.1,-32563.54 454.1,-32554.77 454.1,-32546.57"/>
<polygon fill="black" stroke="black" points="457.6,-32546.52 454.1,-32536.52 450.6,-32546.52 457.6,-32546.52"/>
</g>
<!-- layer40_qkv_proj -->
<g id="node205" class="node">
<title>layer40_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-32432.5 240.6,-32432.5 240.6,-32364.5 667.6,-32364.5 667.6,-32432.5"/>
<text text-anchor="middle" x="454.1" y="-32417.3" font-family="Times,serif" font-size="14.00">Layer 40 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-32402.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32387.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-32372.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer39_moe&#45;&gt;layer40_qkv_proj -->
<g id="edge205" class="edge">
<title>layer39_moe&#45;&gt;layer40_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-32468.38C454.1,-32460.28 454.1,-32451.48 454.1,-32442.97"/>
<polygon fill="black" stroke="black" points="457.6,-32442.8 454.1,-32432.8 450.6,-32442.8 457.6,-32442.8"/>
</g>
<!-- layer40_attn_comp -->
<g id="node206" class="node">
<title>layer40_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-32328.5 240.6,-32328.5 240.6,-32260.5 667.6,-32260.5 667.6,-32328.5"/>
<text text-anchor="middle" x="454.1" y="-32313.3" font-family="Times,serif" font-size="14.00">Layer 40 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-32298.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32283.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-32268.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer40_qkv_proj&#45;&gt;layer40_attn_comp -->
<g id="edge206" class="edge">
<title>layer40_qkv_proj&#45;&gt;layer40_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-32364.38C454.1,-32356.28 454.1,-32347.48 454.1,-32338.97"/>
<polygon fill="black" stroke="black" points="457.6,-32338.8 454.1,-32328.8 450.6,-32338.8 457.6,-32338.8"/>
</g>
<!-- layer40_out_proj -->
<g id="node207" class="node">
<title>layer40_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-32224.5 246.6,-32224.5 246.6,-32156.5 661.6,-32156.5 661.6,-32224.5"/>
<text text-anchor="middle" x="454.1" y="-32209.3" font-family="Times,serif" font-size="14.00">Layer 40 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-32194.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32179.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-32164.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer40_attn_comp&#45;&gt;layer40_out_proj -->
<g id="edge207" class="edge">
<title>layer40_attn_comp&#45;&gt;layer40_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-32260.38C454.1,-32252.28 454.1,-32243.48 454.1,-32234.97"/>
<polygon fill="black" stroke="black" points="457.6,-32234.8 454.1,-32224.8 450.6,-32234.8 457.6,-32234.8"/>
</g>
<!-- layer40_gate -->
<g id="node208" class="node">
<title>layer40_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-32120.5 216.93,-32120.5 52.65,-31984.5 691.26,-31984.5 855.54,-32120.5"/>
<text text-anchor="middle" x="454.1" y="-32071.3" font-family="Times,serif" font-size="14.00">Layer 40 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-32056.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-32041.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-32026.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer40_out_proj&#45;&gt;layer40_gate -->
<g id="edge208" class="edge">
<title>layer40_out_proj&#45;&gt;layer40_gate</title>
<path fill="none" stroke="black" d="M454.1,-32156.23C454.1,-32148.4 454.1,-32139.74 454.1,-32130.85"/>
<polygon fill="black" stroke="black" points="457.6,-32130.76 454.1,-32120.76 450.6,-32130.76 457.6,-32130.76"/>
</g>
<!-- layer40_moe -->
<g id="node209" class="node">
<title>layer40_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-31948.5 254.6,-31948.5 254.6,-31880.5 653.6,-31880.5 653.6,-31948.5"/>
<text text-anchor="middle" x="454.1" y="-31933.3" font-family="Times,serif" font-size="14.00">Layer 40 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-31918.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31903.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-31888.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer40_gate&#45;&gt;layer40_moe -->
<g id="edge209" class="edge">
<title>layer40_gate&#45;&gt;layer40_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-31984.3C454.1,-31975.54 454.1,-31966.77 454.1,-31958.57"/>
<polygon fill="black" stroke="black" points="457.6,-31958.52 454.1,-31948.52 450.6,-31958.52 457.6,-31958.52"/>
</g>
<!-- layer41_qkv_proj -->
<g id="node210" class="node">
<title>layer41_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-31844.5 240.6,-31844.5 240.6,-31776.5 667.6,-31776.5 667.6,-31844.5"/>
<text text-anchor="middle" x="454.1" y="-31829.3" font-family="Times,serif" font-size="14.00">Layer 41 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-31814.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31799.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-31784.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer40_moe&#45;&gt;layer41_qkv_proj -->
<g id="edge210" class="edge">
<title>layer40_moe&#45;&gt;layer41_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-31880.38C454.1,-31872.28 454.1,-31863.48 454.1,-31854.97"/>
<polygon fill="black" stroke="black" points="457.6,-31854.8 454.1,-31844.8 450.6,-31854.8 457.6,-31854.8"/>
</g>
<!-- layer41_attn_comp -->
<g id="node211" class="node">
<title>layer41_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-31740.5 240.6,-31740.5 240.6,-31672.5 667.6,-31672.5 667.6,-31740.5"/>
<text text-anchor="middle" x="454.1" y="-31725.3" font-family="Times,serif" font-size="14.00">Layer 41 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-31710.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31695.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-31680.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer41_qkv_proj&#45;&gt;layer41_attn_comp -->
<g id="edge211" class="edge">
<title>layer41_qkv_proj&#45;&gt;layer41_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-31776.38C454.1,-31768.28 454.1,-31759.48 454.1,-31750.97"/>
<polygon fill="black" stroke="black" points="457.6,-31750.8 454.1,-31740.8 450.6,-31750.8 457.6,-31750.8"/>
</g>
<!-- layer41_out_proj -->
<g id="node212" class="node">
<title>layer41_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-31636.5 246.6,-31636.5 246.6,-31568.5 661.6,-31568.5 661.6,-31636.5"/>
<text text-anchor="middle" x="454.1" y="-31621.3" font-family="Times,serif" font-size="14.00">Layer 41 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-31606.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31591.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-31576.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer41_attn_comp&#45;&gt;layer41_out_proj -->
<g id="edge212" class="edge">
<title>layer41_attn_comp&#45;&gt;layer41_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-31672.38C454.1,-31664.28 454.1,-31655.48 454.1,-31646.97"/>
<polygon fill="black" stroke="black" points="457.6,-31646.8 454.1,-31636.8 450.6,-31646.8 457.6,-31646.8"/>
</g>
<!-- layer41_gate -->
<g id="node213" class="node">
<title>layer41_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-31532.5 216.93,-31532.5 52.65,-31396.5 691.26,-31396.5 855.54,-31532.5"/>
<text text-anchor="middle" x="454.1" y="-31483.3" font-family="Times,serif" font-size="14.00">Layer 41 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-31468.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31453.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-31438.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer41_out_proj&#45;&gt;layer41_gate -->
<g id="edge213" class="edge">
<title>layer41_out_proj&#45;&gt;layer41_gate</title>
<path fill="none" stroke="black" d="M454.1,-31568.23C454.1,-31560.4 454.1,-31551.74 454.1,-31542.85"/>
<polygon fill="black" stroke="black" points="457.6,-31542.76 454.1,-31532.76 450.6,-31542.76 457.6,-31542.76"/>
</g>
<!-- layer41_moe -->
<g id="node214" class="node">
<title>layer41_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-31360.5 254.6,-31360.5 254.6,-31292.5 653.6,-31292.5 653.6,-31360.5"/>
<text text-anchor="middle" x="454.1" y="-31345.3" font-family="Times,serif" font-size="14.00">Layer 41 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-31330.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31315.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-31300.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer41_gate&#45;&gt;layer41_moe -->
<g id="edge214" class="edge">
<title>layer41_gate&#45;&gt;layer41_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-31396.3C454.1,-31387.54 454.1,-31378.77 454.1,-31370.57"/>
<polygon fill="black" stroke="black" points="457.6,-31370.52 454.1,-31360.52 450.6,-31370.52 457.6,-31370.52"/>
</g>
<!-- layer42_qkv_proj -->
<g id="node215" class="node">
<title>layer42_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-31256.5 240.6,-31256.5 240.6,-31188.5 667.6,-31188.5 667.6,-31256.5"/>
<text text-anchor="middle" x="454.1" y="-31241.3" font-family="Times,serif" font-size="14.00">Layer 42 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-31226.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31211.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-31196.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer41_moe&#45;&gt;layer42_qkv_proj -->
<g id="edge215" class="edge">
<title>layer41_moe&#45;&gt;layer42_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-31292.38C454.1,-31284.28 454.1,-31275.48 454.1,-31266.97"/>
<polygon fill="black" stroke="black" points="457.6,-31266.8 454.1,-31256.8 450.6,-31266.8 457.6,-31266.8"/>
</g>
<!-- layer42_attn_comp -->
<g id="node216" class="node">
<title>layer42_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-31152.5 240.6,-31152.5 240.6,-31084.5 667.6,-31084.5 667.6,-31152.5"/>
<text text-anchor="middle" x="454.1" y="-31137.3" font-family="Times,serif" font-size="14.00">Layer 42 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-31122.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31107.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-31092.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer42_qkv_proj&#45;&gt;layer42_attn_comp -->
<g id="edge216" class="edge">
<title>layer42_qkv_proj&#45;&gt;layer42_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-31188.38C454.1,-31180.28 454.1,-31171.48 454.1,-31162.97"/>
<polygon fill="black" stroke="black" points="457.6,-31162.8 454.1,-31152.8 450.6,-31162.8 457.6,-31162.8"/>
</g>
<!-- layer42_out_proj -->
<g id="node217" class="node">
<title>layer42_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-31048.5 246.6,-31048.5 246.6,-30980.5 661.6,-30980.5 661.6,-31048.5"/>
<text text-anchor="middle" x="454.1" y="-31033.3" font-family="Times,serif" font-size="14.00">Layer 42 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-31018.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-31003.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-30988.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer42_attn_comp&#45;&gt;layer42_out_proj -->
<g id="edge217" class="edge">
<title>layer42_attn_comp&#45;&gt;layer42_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-31084.38C454.1,-31076.28 454.1,-31067.48 454.1,-31058.97"/>
<polygon fill="black" stroke="black" points="457.6,-31058.8 454.1,-31048.8 450.6,-31058.8 457.6,-31058.8"/>
</g>
<!-- layer42_gate -->
<g id="node218" class="node">
<title>layer42_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-30944.5 216.93,-30944.5 52.65,-30808.5 691.26,-30808.5 855.54,-30944.5"/>
<text text-anchor="middle" x="454.1" y="-30895.3" font-family="Times,serif" font-size="14.00">Layer 42 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-30880.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30865.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-30850.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer42_out_proj&#45;&gt;layer42_gate -->
<g id="edge218" class="edge">
<title>layer42_out_proj&#45;&gt;layer42_gate</title>
<path fill="none" stroke="black" d="M454.1,-30980.23C454.1,-30972.4 454.1,-30963.74 454.1,-30954.85"/>
<polygon fill="black" stroke="black" points="457.6,-30954.76 454.1,-30944.76 450.6,-30954.76 457.6,-30954.76"/>
</g>
<!-- layer42_moe -->
<g id="node219" class="node">
<title>layer42_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-30772.5 254.6,-30772.5 254.6,-30704.5 653.6,-30704.5 653.6,-30772.5"/>
<text text-anchor="middle" x="454.1" y="-30757.3" font-family="Times,serif" font-size="14.00">Layer 42 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-30742.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30727.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-30712.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer42_gate&#45;&gt;layer42_moe -->
<g id="edge219" class="edge">
<title>layer42_gate&#45;&gt;layer42_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-30808.3C454.1,-30799.54 454.1,-30790.77 454.1,-30782.57"/>
<polygon fill="black" stroke="black" points="457.6,-30782.52 454.1,-30772.52 450.6,-30782.52 457.6,-30782.52"/>
</g>
<!-- layer43_qkv_proj -->
<g id="node220" class="node">
<title>layer43_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-30668.5 240.6,-30668.5 240.6,-30600.5 667.6,-30600.5 667.6,-30668.5"/>
<text text-anchor="middle" x="454.1" y="-30653.3" font-family="Times,serif" font-size="14.00">Layer 43 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-30638.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30623.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-30608.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer42_moe&#45;&gt;layer43_qkv_proj -->
<g id="edge220" class="edge">
<title>layer42_moe&#45;&gt;layer43_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-30704.38C454.1,-30696.28 454.1,-30687.48 454.1,-30678.97"/>
<polygon fill="black" stroke="black" points="457.6,-30678.8 454.1,-30668.8 450.6,-30678.8 457.6,-30678.8"/>
</g>
<!-- layer43_attn_comp -->
<g id="node221" class="node">
<title>layer43_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-30564.5 240.6,-30564.5 240.6,-30496.5 667.6,-30496.5 667.6,-30564.5"/>
<text text-anchor="middle" x="454.1" y="-30549.3" font-family="Times,serif" font-size="14.00">Layer 43 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-30534.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30519.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-30504.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer43_qkv_proj&#45;&gt;layer43_attn_comp -->
<g id="edge221" class="edge">
<title>layer43_qkv_proj&#45;&gt;layer43_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-30600.38C454.1,-30592.28 454.1,-30583.48 454.1,-30574.97"/>
<polygon fill="black" stroke="black" points="457.6,-30574.8 454.1,-30564.8 450.6,-30574.8 457.6,-30574.8"/>
</g>
<!-- layer43_out_proj -->
<g id="node222" class="node">
<title>layer43_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-30460.5 246.6,-30460.5 246.6,-30392.5 661.6,-30392.5 661.6,-30460.5"/>
<text text-anchor="middle" x="454.1" y="-30445.3" font-family="Times,serif" font-size="14.00">Layer 43 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-30430.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30415.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-30400.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer43_attn_comp&#45;&gt;layer43_out_proj -->
<g id="edge222" class="edge">
<title>layer43_attn_comp&#45;&gt;layer43_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-30496.38C454.1,-30488.28 454.1,-30479.48 454.1,-30470.97"/>
<polygon fill="black" stroke="black" points="457.6,-30470.8 454.1,-30460.8 450.6,-30470.8 457.6,-30470.8"/>
</g>
<!-- layer43_gate -->
<g id="node223" class="node">
<title>layer43_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-30356.5 216.93,-30356.5 52.65,-30220.5 691.26,-30220.5 855.54,-30356.5"/>
<text text-anchor="middle" x="454.1" y="-30307.3" font-family="Times,serif" font-size="14.00">Layer 43 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-30292.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30277.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-30262.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer43_out_proj&#45;&gt;layer43_gate -->
<g id="edge223" class="edge">
<title>layer43_out_proj&#45;&gt;layer43_gate</title>
<path fill="none" stroke="black" d="M454.1,-30392.23C454.1,-30384.4 454.1,-30375.74 454.1,-30366.85"/>
<polygon fill="black" stroke="black" points="457.6,-30366.76 454.1,-30356.76 450.6,-30366.76 457.6,-30366.76"/>
</g>
<!-- layer43_moe -->
<g id="node224" class="node">
<title>layer43_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-30184.5 254.6,-30184.5 254.6,-30116.5 653.6,-30116.5 653.6,-30184.5"/>
<text text-anchor="middle" x="454.1" y="-30169.3" font-family="Times,serif" font-size="14.00">Layer 43 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-30154.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30139.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-30124.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer43_gate&#45;&gt;layer43_moe -->
<g id="edge224" class="edge">
<title>layer43_gate&#45;&gt;layer43_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-30220.3C454.1,-30211.54 454.1,-30202.77 454.1,-30194.57"/>
<polygon fill="black" stroke="black" points="457.6,-30194.52 454.1,-30184.52 450.6,-30194.52 457.6,-30194.52"/>
</g>
<!-- layer44_qkv_proj -->
<g id="node225" class="node">
<title>layer44_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-30080.5 240.6,-30080.5 240.6,-30012.5 667.6,-30012.5 667.6,-30080.5"/>
<text text-anchor="middle" x="454.1" y="-30065.3" font-family="Times,serif" font-size="14.00">Layer 44 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-30050.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-30035.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-30020.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer43_moe&#45;&gt;layer44_qkv_proj -->
<g id="edge225" class="edge">
<title>layer43_moe&#45;&gt;layer44_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-30116.38C454.1,-30108.28 454.1,-30099.48 454.1,-30090.97"/>
<polygon fill="black" stroke="black" points="457.6,-30090.8 454.1,-30080.8 450.6,-30090.8 457.6,-30090.8"/>
</g>
<!-- layer44_attn_comp -->
<g id="node226" class="node">
<title>layer44_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-29976.5 240.6,-29976.5 240.6,-29908.5 667.6,-29908.5 667.6,-29976.5"/>
<text text-anchor="middle" x="454.1" y="-29961.3" font-family="Times,serif" font-size="14.00">Layer 44 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-29946.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29931.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-29916.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer44_qkv_proj&#45;&gt;layer44_attn_comp -->
<g id="edge226" class="edge">
<title>layer44_qkv_proj&#45;&gt;layer44_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-30012.38C454.1,-30004.28 454.1,-29995.48 454.1,-29986.97"/>
<polygon fill="black" stroke="black" points="457.6,-29986.8 454.1,-29976.8 450.6,-29986.8 457.6,-29986.8"/>
</g>
<!-- layer44_out_proj -->
<g id="node227" class="node">
<title>layer44_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-29872.5 246.6,-29872.5 246.6,-29804.5 661.6,-29804.5 661.6,-29872.5"/>
<text text-anchor="middle" x="454.1" y="-29857.3" font-family="Times,serif" font-size="14.00">Layer 44 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-29842.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29827.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-29812.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer44_attn_comp&#45;&gt;layer44_out_proj -->
<g id="edge227" class="edge">
<title>layer44_attn_comp&#45;&gt;layer44_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-29908.38C454.1,-29900.28 454.1,-29891.48 454.1,-29882.97"/>
<polygon fill="black" stroke="black" points="457.6,-29882.8 454.1,-29872.8 450.6,-29882.8 457.6,-29882.8"/>
</g>
<!-- layer44_gate -->
<g id="node228" class="node">
<title>layer44_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-29768.5 216.93,-29768.5 52.65,-29632.5 691.26,-29632.5 855.54,-29768.5"/>
<text text-anchor="middle" x="454.1" y="-29719.3" font-family="Times,serif" font-size="14.00">Layer 44 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-29704.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29689.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-29674.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer44_out_proj&#45;&gt;layer44_gate -->
<g id="edge228" class="edge">
<title>layer44_out_proj&#45;&gt;layer44_gate</title>
<path fill="none" stroke="black" d="M454.1,-29804.23C454.1,-29796.4 454.1,-29787.74 454.1,-29778.85"/>
<polygon fill="black" stroke="black" points="457.6,-29778.76 454.1,-29768.76 450.6,-29778.76 457.6,-29778.76"/>
</g>
<!-- layer44_moe -->
<g id="node229" class="node">
<title>layer44_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-29596.5 254.6,-29596.5 254.6,-29528.5 653.6,-29528.5 653.6,-29596.5"/>
<text text-anchor="middle" x="454.1" y="-29581.3" font-family="Times,serif" font-size="14.00">Layer 44 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-29566.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29551.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-29536.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer44_gate&#45;&gt;layer44_moe -->
<g id="edge229" class="edge">
<title>layer44_gate&#45;&gt;layer44_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-29632.3C454.1,-29623.54 454.1,-29614.77 454.1,-29606.57"/>
<polygon fill="black" stroke="black" points="457.6,-29606.52 454.1,-29596.52 450.6,-29606.52 457.6,-29606.52"/>
</g>
<!-- layer45_qkv_proj -->
<g id="node230" class="node">
<title>layer45_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-29492.5 240.6,-29492.5 240.6,-29424.5 667.6,-29424.5 667.6,-29492.5"/>
<text text-anchor="middle" x="454.1" y="-29477.3" font-family="Times,serif" font-size="14.00">Layer 45 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-29462.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29447.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-29432.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer44_moe&#45;&gt;layer45_qkv_proj -->
<g id="edge230" class="edge">
<title>layer44_moe&#45;&gt;layer45_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-29528.38C454.1,-29520.28 454.1,-29511.48 454.1,-29502.97"/>
<polygon fill="black" stroke="black" points="457.6,-29502.8 454.1,-29492.8 450.6,-29502.8 457.6,-29502.8"/>
</g>
<!-- layer45_attn_comp -->
<g id="node231" class="node">
<title>layer45_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-29388.5 240.6,-29388.5 240.6,-29320.5 667.6,-29320.5 667.6,-29388.5"/>
<text text-anchor="middle" x="454.1" y="-29373.3" font-family="Times,serif" font-size="14.00">Layer 45 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-29358.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29343.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-29328.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer45_qkv_proj&#45;&gt;layer45_attn_comp -->
<g id="edge231" class="edge">
<title>layer45_qkv_proj&#45;&gt;layer45_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-29424.38C454.1,-29416.28 454.1,-29407.48 454.1,-29398.97"/>
<polygon fill="black" stroke="black" points="457.6,-29398.8 454.1,-29388.8 450.6,-29398.8 457.6,-29398.8"/>
</g>
<!-- layer45_out_proj -->
<g id="node232" class="node">
<title>layer45_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-29284.5 246.6,-29284.5 246.6,-29216.5 661.6,-29216.5 661.6,-29284.5"/>
<text text-anchor="middle" x="454.1" y="-29269.3" font-family="Times,serif" font-size="14.00">Layer 45 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-29254.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29239.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-29224.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer45_attn_comp&#45;&gt;layer45_out_proj -->
<g id="edge232" class="edge">
<title>layer45_attn_comp&#45;&gt;layer45_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-29320.38C454.1,-29312.28 454.1,-29303.48 454.1,-29294.97"/>
<polygon fill="black" stroke="black" points="457.6,-29294.8 454.1,-29284.8 450.6,-29294.8 457.6,-29294.8"/>
</g>
<!-- layer45_gate -->
<g id="node233" class="node">
<title>layer45_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-29180.5 216.93,-29180.5 52.65,-29044.5 691.26,-29044.5 855.54,-29180.5"/>
<text text-anchor="middle" x="454.1" y="-29131.3" font-family="Times,serif" font-size="14.00">Layer 45 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-29116.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-29101.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-29086.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer45_out_proj&#45;&gt;layer45_gate -->
<g id="edge233" class="edge">
<title>layer45_out_proj&#45;&gt;layer45_gate</title>
<path fill="none" stroke="black" d="M454.1,-29216.23C454.1,-29208.4 454.1,-29199.74 454.1,-29190.85"/>
<polygon fill="black" stroke="black" points="457.6,-29190.76 454.1,-29180.76 450.6,-29190.76 457.6,-29190.76"/>
</g>
<!-- layer45_moe -->
<g id="node234" class="node">
<title>layer45_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-29008.5 254.6,-29008.5 254.6,-28940.5 653.6,-28940.5 653.6,-29008.5"/>
<text text-anchor="middle" x="454.1" y="-28993.3" font-family="Times,serif" font-size="14.00">Layer 45 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-28978.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28963.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-28948.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer45_gate&#45;&gt;layer45_moe -->
<g id="edge234" class="edge">
<title>layer45_gate&#45;&gt;layer45_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-29044.3C454.1,-29035.54 454.1,-29026.77 454.1,-29018.57"/>
<polygon fill="black" stroke="black" points="457.6,-29018.52 454.1,-29008.52 450.6,-29018.52 457.6,-29018.52"/>
</g>
<!-- layer46_qkv_proj -->
<g id="node235" class="node">
<title>layer46_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-28904.5 240.6,-28904.5 240.6,-28836.5 667.6,-28836.5 667.6,-28904.5"/>
<text text-anchor="middle" x="454.1" y="-28889.3" font-family="Times,serif" font-size="14.00">Layer 46 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-28874.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28859.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-28844.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer45_moe&#45;&gt;layer46_qkv_proj -->
<g id="edge235" class="edge">
<title>layer45_moe&#45;&gt;layer46_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-28940.38C454.1,-28932.28 454.1,-28923.48 454.1,-28914.97"/>
<polygon fill="black" stroke="black" points="457.6,-28914.8 454.1,-28904.8 450.6,-28914.8 457.6,-28914.8"/>
</g>
<!-- layer46_attn_comp -->
<g id="node236" class="node">
<title>layer46_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-28800.5 240.6,-28800.5 240.6,-28732.5 667.6,-28732.5 667.6,-28800.5"/>
<text text-anchor="middle" x="454.1" y="-28785.3" font-family="Times,serif" font-size="14.00">Layer 46 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-28770.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28755.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-28740.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer46_qkv_proj&#45;&gt;layer46_attn_comp -->
<g id="edge236" class="edge">
<title>layer46_qkv_proj&#45;&gt;layer46_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-28836.38C454.1,-28828.28 454.1,-28819.48 454.1,-28810.97"/>
<polygon fill="black" stroke="black" points="457.6,-28810.8 454.1,-28800.8 450.6,-28810.8 457.6,-28810.8"/>
</g>
<!-- layer46_out_proj -->
<g id="node237" class="node">
<title>layer46_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-28696.5 246.6,-28696.5 246.6,-28628.5 661.6,-28628.5 661.6,-28696.5"/>
<text text-anchor="middle" x="454.1" y="-28681.3" font-family="Times,serif" font-size="14.00">Layer 46 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-28666.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28651.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-28636.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer46_attn_comp&#45;&gt;layer46_out_proj -->
<g id="edge237" class="edge">
<title>layer46_attn_comp&#45;&gt;layer46_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-28732.38C454.1,-28724.28 454.1,-28715.48 454.1,-28706.97"/>
<polygon fill="black" stroke="black" points="457.6,-28706.8 454.1,-28696.8 450.6,-28706.8 457.6,-28706.8"/>
</g>
<!-- layer46_gate -->
<g id="node238" class="node">
<title>layer46_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-28592.5 216.93,-28592.5 52.65,-28456.5 691.26,-28456.5 855.54,-28592.5"/>
<text text-anchor="middle" x="454.1" y="-28543.3" font-family="Times,serif" font-size="14.00">Layer 46 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-28528.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28513.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-28498.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer46_out_proj&#45;&gt;layer46_gate -->
<g id="edge238" class="edge">
<title>layer46_out_proj&#45;&gt;layer46_gate</title>
<path fill="none" stroke="black" d="M454.1,-28628.23C454.1,-28620.4 454.1,-28611.74 454.1,-28602.85"/>
<polygon fill="black" stroke="black" points="457.6,-28602.76 454.1,-28592.76 450.6,-28602.76 457.6,-28602.76"/>
</g>
<!-- layer46_moe -->
<g id="node239" class="node">
<title>layer46_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-28420.5 254.6,-28420.5 254.6,-28352.5 653.6,-28352.5 653.6,-28420.5"/>
<text text-anchor="middle" x="454.1" y="-28405.3" font-family="Times,serif" font-size="14.00">Layer 46 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-28390.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28375.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-28360.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer46_gate&#45;&gt;layer46_moe -->
<g id="edge239" class="edge">
<title>layer46_gate&#45;&gt;layer46_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-28456.3C454.1,-28447.54 454.1,-28438.77 454.1,-28430.57"/>
<polygon fill="black" stroke="black" points="457.6,-28430.52 454.1,-28420.52 450.6,-28430.52 457.6,-28430.52"/>
</g>
<!-- layer47_qkv_proj -->
<g id="node240" class="node">
<title>layer47_qkv_proj</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-28316.5 240.6,-28316.5 240.6,-28248.5 667.6,-28248.5 667.6,-28316.5"/>
<text text-anchor="middle" x="454.1" y="-28301.3" font-family="Times,serif" font-size="14.00">Layer 47 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-28286.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28271.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-28256.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer46_moe&#45;&gt;layer47_qkv_proj -->
<g id="edge240" class="edge">
<title>layer46_moe&#45;&gt;layer47_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-28352.38C454.1,-28344.28 454.1,-28335.48 454.1,-28326.97"/>
<polygon fill="black" stroke="black" points="457.6,-28326.8 454.1,-28316.8 450.6,-28326.8 457.6,-28326.8"/>
</g>
<!-- layer47_attn_comp -->
<g id="node241" class="node">
<title>layer47_attn_comp</title>
<polygon fill="lightgreen" stroke="black" points="667.6,-28212.5 240.6,-28212.5 240.6,-28144.5 667.6,-28144.5 667.6,-28212.5"/>
<text text-anchor="middle" x="454.1" y="-28197.3" font-family="Times,serif" font-size="14.00">Layer 47 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-28182.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28167.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-28152.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer47_qkv_proj&#45;&gt;layer47_attn_comp -->
<g id="edge241" class="edge">
<title>layer47_qkv_proj&#45;&gt;layer47_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-28248.38C454.1,-28240.28 454.1,-28231.48 454.1,-28222.97"/>
<polygon fill="black" stroke="black" points="457.6,-28222.8 454.1,-28212.8 450.6,-28222.8 457.6,-28222.8"/>
</g>
<!-- layer47_out_proj -->
<g id="node242" class="node">
<title>layer47_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="661.6,-28108.5 246.6,-28108.5 246.6,-28040.5 661.6,-28040.5 661.6,-28108.5"/>
<text text-anchor="middle" x="454.1" y="-28093.3" font-family="Times,serif" font-size="14.00">Layer 47 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-28078.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-28063.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-28048.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer47_attn_comp&#45;&gt;layer47_out_proj -->
<g id="edge242" class="edge">
<title>layer47_attn_comp&#45;&gt;layer47_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-28144.38C454.1,-28136.28 454.1,-28127.48 454.1,-28118.97"/>
<polygon fill="black" stroke="black" points="457.6,-28118.8 454.1,-28108.8 450.6,-28118.8 457.6,-28118.8"/>
</g>
<!-- layer47_gate -->
<g id="node243" class="node">
<title>layer47_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-28004.5 216.93,-28004.5 52.65,-27868.5 691.26,-27868.5 855.54,-28004.5"/>
<text text-anchor="middle" x="454.1" y="-27955.3" font-family="Times,serif" font-size="14.00">Layer 47 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-27940.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-27925.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-27910.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer47_out_proj&#45;&gt;layer47_gate -->
<g id="edge243" class="edge">
<title>layer47_out_proj&#45;&gt;layer47_gate</title>
<path fill="none" stroke="black" d="M454.1,-28040.23C454.1,-28032.4 454.1,-28023.74 454.1,-28014.85"/>
<polygon fill="black" stroke="black" points="457.6,-28014.76 454.1,-28004.76 450.6,-28014.76 457.6,-28014.76"/>
</g>
<!-- layer47_moe -->
<g id="node244" class="node">
<title>layer47_moe</title>
<polygon fill="lightgreen" stroke="black" points="653.6,-27832.5 254.6,-27832.5 254.6,-27764.5 653.6,-27764.5 653.6,-27832.5"/>
<text text-anchor="middle" x="454.1" y="-27817.3" font-family="Times,serif" font-size="14.00">Layer 47 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-27802.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="454.1" y="-27787.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-27772.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer47_gate&#45;&gt;layer47_moe -->
<g id="edge244" class="edge">
<title>layer47_gate&#45;&gt;layer47_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-27868.3C454.1,-27859.54 454.1,-27850.77 454.1,-27842.57"/>
<polygon fill="black" stroke="black" points="457.6,-27842.52 454.1,-27832.52 450.6,-27842.52 457.6,-27842.52"/>
</g>
<!-- comm_1_2 -->
<g id="node246" class="node">
<title>comm_1_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="454.1" cy="-27680.42" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="454.1" y="-27699.22" font-family="Times,serif" font-size="14.00">Pipeline Communication (Single Token)</text>
<text text-anchor="middle" x="454.1" y="-27684.22" font-family="Times,serif" font-size="14.00">GPUs: 9&#45;17  18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-27669.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-27654.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer47_moe&#45;&gt;comm_1_2 -->
<g id="edge245" class="edge">
<title>layer47_moe&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M454.1,-27764.23C454.1,-27756.24 454.1,-27747.48 454.1,-27738.73"/>
<polygon fill="black" stroke="black" points="457.6,-27738.53 454.1,-27728.53 450.6,-27738.53 457.6,-27738.53"/>
</g>
<!-- kv_access_1&#45;&gt;layer24_qkv_proj -->
<g id="edge125" class="edge">
<title>kv_access_1&#45;&gt;layer24_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-41894.35C454.1,-41879.98 454.1,-41864.56 454.1,-41850.76"/>
<polygon fill="black" stroke="black" points="457.6,-41850.56 454.1,-41840.56 450.6,-41850.56 457.6,-41850.56"/>
</g>
<!-- kv_access_2 -->
<g id="node367" class="node">
<title>kv_access_2</title>
<polygon fill="lightcyan" stroke="black" points="908.29,-27596.33 185.77,-27596.33 -0.1,-27490.33 722.43,-27490.33 908.29,-27596.33"/>
<text text-anchor="middle" x="454.1" y="-27554.63" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="454.1" y="-27539.63" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-27524.63" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- comm_1_2&#45;&gt;kv_access_2 -->
<g id="edge246" class="edge">
<title>comm_1_2&#45;&gt;kv_access_2</title>
<path fill="none" stroke="black" d="M454.1,-27632.17C454.1,-27623.86 454.1,-27615.09 454.1,-27606.45"/>
<polygon fill="black" stroke="black" points="457.6,-27606.39 454.1,-27596.39 450.6,-27606.39 457.6,-27606.39"/>
</g>
<!-- layer48_qkv_proj -->
<g id="node247" class="node">
<title>layer48_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-27436.33 240.6,-27436.33 240.6,-27368.33 667.6,-27368.33 667.6,-27436.33"/>
<text text-anchor="middle" x="454.1" y="-27421.13" font-family="Times,serif" font-size="14.00">Layer 48 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-27406.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-27391.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-27376.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer48_attn_comp -->
<g id="node248" class="node">
<title>layer48_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-27332.33 240.6,-27332.33 240.6,-27264.33 667.6,-27264.33 667.6,-27332.33"/>
<text text-anchor="middle" x="454.1" y="-27317.13" font-family="Times,serif" font-size="14.00">Layer 48 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-27302.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-27287.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-27272.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer48_qkv_proj&#45;&gt;layer48_attn_comp -->
<g id="edge248" class="edge">
<title>layer48_qkv_proj&#45;&gt;layer48_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-27368.22C454.1,-27360.11 454.1,-27351.32 454.1,-27342.81"/>
<polygon fill="black" stroke="black" points="457.6,-27342.63 454.1,-27332.63 450.6,-27342.63 457.6,-27342.63"/>
</g>
<!-- layer48_out_proj -->
<g id="node249" class="node">
<title>layer48_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-27228.33 246.6,-27228.33 246.6,-27160.33 661.6,-27160.33 661.6,-27228.33"/>
<text text-anchor="middle" x="454.1" y="-27213.13" font-family="Times,serif" font-size="14.00">Layer 48 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-27198.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-27183.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-27168.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer48_attn_comp&#45;&gt;layer48_out_proj -->
<g id="edge249" class="edge">
<title>layer48_attn_comp&#45;&gt;layer48_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-27264.22C454.1,-27256.11 454.1,-27247.32 454.1,-27238.81"/>
<polygon fill="black" stroke="black" points="457.6,-27238.63 454.1,-27228.63 450.6,-27238.63 457.6,-27238.63"/>
</g>
<!-- layer48_gate -->
<g id="node250" class="node">
<title>layer48_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-27124.33 216.93,-27124.33 52.65,-26988.33 691.26,-26988.33 855.54,-27124.33"/>
<text text-anchor="middle" x="454.1" y="-27075.13" font-family="Times,serif" font-size="14.00">Layer 48 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-27060.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-27045.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-27030.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer48_out_proj&#45;&gt;layer48_gate -->
<g id="edge250" class="edge">
<title>layer48_out_proj&#45;&gt;layer48_gate</title>
<path fill="none" stroke="black" d="M454.1,-27160.06C454.1,-27152.24 454.1,-27143.57 454.1,-27134.69"/>
<polygon fill="black" stroke="black" points="457.6,-27134.6 454.1,-27124.6 450.6,-27134.6 457.6,-27134.6"/>
</g>
<!-- layer48_moe -->
<g id="node251" class="node">
<title>layer48_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-26952.33 254.6,-26952.33 254.6,-26884.33 653.6,-26884.33 653.6,-26952.33"/>
<text text-anchor="middle" x="454.1" y="-26937.13" font-family="Times,serif" font-size="14.00">Layer 48 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-26922.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26907.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-26892.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer48_gate&#45;&gt;layer48_moe -->
<g id="edge251" class="edge">
<title>layer48_gate&#45;&gt;layer48_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-26988.13C454.1,-26979.38 454.1,-26970.61 454.1,-26962.4"/>
<polygon fill="black" stroke="black" points="457.6,-26962.35 454.1,-26952.35 450.6,-26962.35 457.6,-26962.35"/>
</g>
<!-- layer49_qkv_proj -->
<g id="node252" class="node">
<title>layer49_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-26848.33 240.6,-26848.33 240.6,-26780.33 667.6,-26780.33 667.6,-26848.33"/>
<text text-anchor="middle" x="454.1" y="-26833.13" font-family="Times,serif" font-size="14.00">Layer 49 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-26818.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26803.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-26788.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer48_moe&#45;&gt;layer49_qkv_proj -->
<g id="edge252" class="edge">
<title>layer48_moe&#45;&gt;layer49_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-26884.22C454.1,-26876.11 454.1,-26867.32 454.1,-26858.81"/>
<polygon fill="black" stroke="black" points="457.6,-26858.63 454.1,-26848.63 450.6,-26858.63 457.6,-26858.63"/>
</g>
<!-- layer49_attn_comp -->
<g id="node253" class="node">
<title>layer49_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-26744.33 240.6,-26744.33 240.6,-26676.33 667.6,-26676.33 667.6,-26744.33"/>
<text text-anchor="middle" x="454.1" y="-26729.13" font-family="Times,serif" font-size="14.00">Layer 49 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-26714.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26699.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-26684.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer49_qkv_proj&#45;&gt;layer49_attn_comp -->
<g id="edge253" class="edge">
<title>layer49_qkv_proj&#45;&gt;layer49_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-26780.22C454.1,-26772.11 454.1,-26763.32 454.1,-26754.81"/>
<polygon fill="black" stroke="black" points="457.6,-26754.63 454.1,-26744.63 450.6,-26754.63 457.6,-26754.63"/>
</g>
<!-- layer49_out_proj -->
<g id="node254" class="node">
<title>layer49_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-26640.33 246.6,-26640.33 246.6,-26572.33 661.6,-26572.33 661.6,-26640.33"/>
<text text-anchor="middle" x="454.1" y="-26625.13" font-family="Times,serif" font-size="14.00">Layer 49 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-26610.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26595.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-26580.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer49_attn_comp&#45;&gt;layer49_out_proj -->
<g id="edge254" class="edge">
<title>layer49_attn_comp&#45;&gt;layer49_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-26676.22C454.1,-26668.11 454.1,-26659.32 454.1,-26650.81"/>
<polygon fill="black" stroke="black" points="457.6,-26650.63 454.1,-26640.63 450.6,-26650.63 457.6,-26650.63"/>
</g>
<!-- layer49_gate -->
<g id="node255" class="node">
<title>layer49_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-26536.33 216.93,-26536.33 52.65,-26400.33 691.26,-26400.33 855.54,-26536.33"/>
<text text-anchor="middle" x="454.1" y="-26487.13" font-family="Times,serif" font-size="14.00">Layer 49 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-26472.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26457.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-26442.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer49_out_proj&#45;&gt;layer49_gate -->
<g id="edge255" class="edge">
<title>layer49_out_proj&#45;&gt;layer49_gate</title>
<path fill="none" stroke="black" d="M454.1,-26572.06C454.1,-26564.24 454.1,-26555.57 454.1,-26546.69"/>
<polygon fill="black" stroke="black" points="457.6,-26546.6 454.1,-26536.6 450.6,-26546.6 457.6,-26546.6"/>
</g>
<!-- layer49_moe -->
<g id="node256" class="node">
<title>layer49_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-26364.33 254.6,-26364.33 254.6,-26296.33 653.6,-26296.33 653.6,-26364.33"/>
<text text-anchor="middle" x="454.1" y="-26349.13" font-family="Times,serif" font-size="14.00">Layer 49 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-26334.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26319.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-26304.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer49_gate&#45;&gt;layer49_moe -->
<g id="edge256" class="edge">
<title>layer49_gate&#45;&gt;layer49_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-26400.13C454.1,-26391.38 454.1,-26382.61 454.1,-26374.4"/>
<polygon fill="black" stroke="black" points="457.6,-26374.35 454.1,-26364.35 450.6,-26374.35 457.6,-26374.35"/>
</g>
<!-- layer50_qkv_proj -->
<g id="node257" class="node">
<title>layer50_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-26260.33 240.6,-26260.33 240.6,-26192.33 667.6,-26192.33 667.6,-26260.33"/>
<text text-anchor="middle" x="454.1" y="-26245.13" font-family="Times,serif" font-size="14.00">Layer 50 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-26230.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26215.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-26200.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer49_moe&#45;&gt;layer50_qkv_proj -->
<g id="edge257" class="edge">
<title>layer49_moe&#45;&gt;layer50_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-26296.22C454.1,-26288.11 454.1,-26279.32 454.1,-26270.81"/>
<polygon fill="black" stroke="black" points="457.6,-26270.63 454.1,-26260.63 450.6,-26270.63 457.6,-26270.63"/>
</g>
<!-- layer50_attn_comp -->
<g id="node258" class="node">
<title>layer50_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-26156.33 240.6,-26156.33 240.6,-26088.33 667.6,-26088.33 667.6,-26156.33"/>
<text text-anchor="middle" x="454.1" y="-26141.13" font-family="Times,serif" font-size="14.00">Layer 50 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-26126.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26111.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-26096.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer50_qkv_proj&#45;&gt;layer50_attn_comp -->
<g id="edge258" class="edge">
<title>layer50_qkv_proj&#45;&gt;layer50_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-26192.22C454.1,-26184.11 454.1,-26175.32 454.1,-26166.81"/>
<polygon fill="black" stroke="black" points="457.6,-26166.63 454.1,-26156.63 450.6,-26166.63 457.6,-26166.63"/>
</g>
<!-- layer50_out_proj -->
<g id="node259" class="node">
<title>layer50_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-26052.33 246.6,-26052.33 246.6,-25984.33 661.6,-25984.33 661.6,-26052.33"/>
<text text-anchor="middle" x="454.1" y="-26037.13" font-family="Times,serif" font-size="14.00">Layer 50 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-26022.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-26007.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-25992.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer50_attn_comp&#45;&gt;layer50_out_proj -->
<g id="edge259" class="edge">
<title>layer50_attn_comp&#45;&gt;layer50_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-26088.22C454.1,-26080.11 454.1,-26071.32 454.1,-26062.81"/>
<polygon fill="black" stroke="black" points="457.6,-26062.63 454.1,-26052.63 450.6,-26062.63 457.6,-26062.63"/>
</g>
<!-- layer50_gate -->
<g id="node260" class="node">
<title>layer50_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-25948.33 216.93,-25948.33 52.65,-25812.33 691.26,-25812.33 855.54,-25948.33"/>
<text text-anchor="middle" x="454.1" y="-25899.13" font-family="Times,serif" font-size="14.00">Layer 50 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-25884.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25869.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-25854.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer50_out_proj&#45;&gt;layer50_gate -->
<g id="edge260" class="edge">
<title>layer50_out_proj&#45;&gt;layer50_gate</title>
<path fill="none" stroke="black" d="M454.1,-25984.06C454.1,-25976.24 454.1,-25967.57 454.1,-25958.69"/>
<polygon fill="black" stroke="black" points="457.6,-25958.6 454.1,-25948.6 450.6,-25958.6 457.6,-25958.6"/>
</g>
<!-- layer50_moe -->
<g id="node261" class="node">
<title>layer50_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-25776.33 254.6,-25776.33 254.6,-25708.33 653.6,-25708.33 653.6,-25776.33"/>
<text text-anchor="middle" x="454.1" y="-25761.13" font-family="Times,serif" font-size="14.00">Layer 50 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-25746.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25731.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-25716.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer50_gate&#45;&gt;layer50_moe -->
<g id="edge261" class="edge">
<title>layer50_gate&#45;&gt;layer50_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-25812.13C454.1,-25803.38 454.1,-25794.61 454.1,-25786.4"/>
<polygon fill="black" stroke="black" points="457.6,-25786.35 454.1,-25776.35 450.6,-25786.35 457.6,-25786.35"/>
</g>
<!-- layer51_qkv_proj -->
<g id="node262" class="node">
<title>layer51_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-25672.33 240.6,-25672.33 240.6,-25604.33 667.6,-25604.33 667.6,-25672.33"/>
<text text-anchor="middle" x="454.1" y="-25657.13" font-family="Times,serif" font-size="14.00">Layer 51 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-25642.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25627.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-25612.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer50_moe&#45;&gt;layer51_qkv_proj -->
<g id="edge262" class="edge">
<title>layer50_moe&#45;&gt;layer51_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-25708.22C454.1,-25700.11 454.1,-25691.32 454.1,-25682.81"/>
<polygon fill="black" stroke="black" points="457.6,-25682.63 454.1,-25672.63 450.6,-25682.63 457.6,-25682.63"/>
</g>
<!-- layer51_attn_comp -->
<g id="node263" class="node">
<title>layer51_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-25568.33 240.6,-25568.33 240.6,-25500.33 667.6,-25500.33 667.6,-25568.33"/>
<text text-anchor="middle" x="454.1" y="-25553.13" font-family="Times,serif" font-size="14.00">Layer 51 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-25538.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25523.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-25508.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer51_qkv_proj&#45;&gt;layer51_attn_comp -->
<g id="edge263" class="edge">
<title>layer51_qkv_proj&#45;&gt;layer51_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-25604.22C454.1,-25596.11 454.1,-25587.32 454.1,-25578.81"/>
<polygon fill="black" stroke="black" points="457.6,-25578.63 454.1,-25568.63 450.6,-25578.63 457.6,-25578.63"/>
</g>
<!-- layer51_out_proj -->
<g id="node264" class="node">
<title>layer51_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-25464.33 246.6,-25464.33 246.6,-25396.33 661.6,-25396.33 661.6,-25464.33"/>
<text text-anchor="middle" x="454.1" y="-25449.13" font-family="Times,serif" font-size="14.00">Layer 51 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-25434.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25419.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-25404.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer51_attn_comp&#45;&gt;layer51_out_proj -->
<g id="edge264" class="edge">
<title>layer51_attn_comp&#45;&gt;layer51_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-25500.22C454.1,-25492.11 454.1,-25483.32 454.1,-25474.81"/>
<polygon fill="black" stroke="black" points="457.6,-25474.63 454.1,-25464.63 450.6,-25474.63 457.6,-25474.63"/>
</g>
<!-- layer51_gate -->
<g id="node265" class="node">
<title>layer51_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-25360.33 216.93,-25360.33 52.65,-25224.33 691.26,-25224.33 855.54,-25360.33"/>
<text text-anchor="middle" x="454.1" y="-25311.13" font-family="Times,serif" font-size="14.00">Layer 51 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-25296.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25281.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-25266.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer51_out_proj&#45;&gt;layer51_gate -->
<g id="edge265" class="edge">
<title>layer51_out_proj&#45;&gt;layer51_gate</title>
<path fill="none" stroke="black" d="M454.1,-25396.06C454.1,-25388.24 454.1,-25379.57 454.1,-25370.69"/>
<polygon fill="black" stroke="black" points="457.6,-25370.6 454.1,-25360.6 450.6,-25370.6 457.6,-25370.6"/>
</g>
<!-- layer51_moe -->
<g id="node266" class="node">
<title>layer51_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-25188.33 254.6,-25188.33 254.6,-25120.33 653.6,-25120.33 653.6,-25188.33"/>
<text text-anchor="middle" x="454.1" y="-25173.13" font-family="Times,serif" font-size="14.00">Layer 51 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-25158.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25143.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-25128.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer51_gate&#45;&gt;layer51_moe -->
<g id="edge266" class="edge">
<title>layer51_gate&#45;&gt;layer51_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-25224.13C454.1,-25215.38 454.1,-25206.61 454.1,-25198.4"/>
<polygon fill="black" stroke="black" points="457.6,-25198.35 454.1,-25188.35 450.6,-25198.35 457.6,-25198.35"/>
</g>
<!-- layer52_qkv_proj -->
<g id="node267" class="node">
<title>layer52_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-25084.33 240.6,-25084.33 240.6,-25016.33 667.6,-25016.33 667.6,-25084.33"/>
<text text-anchor="middle" x="454.1" y="-25069.13" font-family="Times,serif" font-size="14.00">Layer 52 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-25054.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-25039.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-25024.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer51_moe&#45;&gt;layer52_qkv_proj -->
<g id="edge267" class="edge">
<title>layer51_moe&#45;&gt;layer52_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-25120.22C454.1,-25112.11 454.1,-25103.32 454.1,-25094.81"/>
<polygon fill="black" stroke="black" points="457.6,-25094.63 454.1,-25084.63 450.6,-25094.63 457.6,-25094.63"/>
</g>
<!-- layer52_attn_comp -->
<g id="node268" class="node">
<title>layer52_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-24980.33 240.6,-24980.33 240.6,-24912.33 667.6,-24912.33 667.6,-24980.33"/>
<text text-anchor="middle" x="454.1" y="-24965.13" font-family="Times,serif" font-size="14.00">Layer 52 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-24950.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24935.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-24920.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer52_qkv_proj&#45;&gt;layer52_attn_comp -->
<g id="edge268" class="edge">
<title>layer52_qkv_proj&#45;&gt;layer52_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-25016.22C454.1,-25008.11 454.1,-24999.32 454.1,-24990.81"/>
<polygon fill="black" stroke="black" points="457.6,-24990.63 454.1,-24980.63 450.6,-24990.63 457.6,-24990.63"/>
</g>
<!-- layer52_out_proj -->
<g id="node269" class="node">
<title>layer52_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-24876.33 246.6,-24876.33 246.6,-24808.33 661.6,-24808.33 661.6,-24876.33"/>
<text text-anchor="middle" x="454.1" y="-24861.13" font-family="Times,serif" font-size="14.00">Layer 52 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-24846.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24831.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-24816.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer52_attn_comp&#45;&gt;layer52_out_proj -->
<g id="edge269" class="edge">
<title>layer52_attn_comp&#45;&gt;layer52_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-24912.22C454.1,-24904.11 454.1,-24895.32 454.1,-24886.81"/>
<polygon fill="black" stroke="black" points="457.6,-24886.63 454.1,-24876.63 450.6,-24886.63 457.6,-24886.63"/>
</g>
<!-- layer52_gate -->
<g id="node270" class="node">
<title>layer52_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-24772.33 216.93,-24772.33 52.65,-24636.33 691.26,-24636.33 855.54,-24772.33"/>
<text text-anchor="middle" x="454.1" y="-24723.13" font-family="Times,serif" font-size="14.00">Layer 52 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-24708.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24693.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-24678.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer52_out_proj&#45;&gt;layer52_gate -->
<g id="edge270" class="edge">
<title>layer52_out_proj&#45;&gt;layer52_gate</title>
<path fill="none" stroke="black" d="M454.1,-24808.06C454.1,-24800.24 454.1,-24791.57 454.1,-24782.69"/>
<polygon fill="black" stroke="black" points="457.6,-24782.6 454.1,-24772.6 450.6,-24782.6 457.6,-24782.6"/>
</g>
<!-- layer52_moe -->
<g id="node271" class="node">
<title>layer52_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-24600.33 254.6,-24600.33 254.6,-24532.33 653.6,-24532.33 653.6,-24600.33"/>
<text text-anchor="middle" x="454.1" y="-24585.13" font-family="Times,serif" font-size="14.00">Layer 52 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-24570.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24555.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-24540.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer52_gate&#45;&gt;layer52_moe -->
<g id="edge271" class="edge">
<title>layer52_gate&#45;&gt;layer52_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-24636.13C454.1,-24627.38 454.1,-24618.61 454.1,-24610.4"/>
<polygon fill="black" stroke="black" points="457.6,-24610.35 454.1,-24600.35 450.6,-24610.35 457.6,-24610.35"/>
</g>
<!-- layer53_qkv_proj -->
<g id="node272" class="node">
<title>layer53_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-24496.33 240.6,-24496.33 240.6,-24428.33 667.6,-24428.33 667.6,-24496.33"/>
<text text-anchor="middle" x="454.1" y="-24481.13" font-family="Times,serif" font-size="14.00">Layer 53 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-24466.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24451.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-24436.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer52_moe&#45;&gt;layer53_qkv_proj -->
<g id="edge272" class="edge">
<title>layer52_moe&#45;&gt;layer53_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-24532.22C454.1,-24524.11 454.1,-24515.32 454.1,-24506.81"/>
<polygon fill="black" stroke="black" points="457.6,-24506.63 454.1,-24496.63 450.6,-24506.63 457.6,-24506.63"/>
</g>
<!-- layer53_attn_comp -->
<g id="node273" class="node">
<title>layer53_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-24392.33 240.6,-24392.33 240.6,-24324.33 667.6,-24324.33 667.6,-24392.33"/>
<text text-anchor="middle" x="454.1" y="-24377.13" font-family="Times,serif" font-size="14.00">Layer 53 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-24362.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24347.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-24332.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer53_qkv_proj&#45;&gt;layer53_attn_comp -->
<g id="edge273" class="edge">
<title>layer53_qkv_proj&#45;&gt;layer53_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-24428.22C454.1,-24420.11 454.1,-24411.32 454.1,-24402.81"/>
<polygon fill="black" stroke="black" points="457.6,-24402.63 454.1,-24392.63 450.6,-24402.63 457.6,-24402.63"/>
</g>
<!-- layer53_out_proj -->
<g id="node274" class="node">
<title>layer53_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-24288.33 246.6,-24288.33 246.6,-24220.33 661.6,-24220.33 661.6,-24288.33"/>
<text text-anchor="middle" x="454.1" y="-24273.13" font-family="Times,serif" font-size="14.00">Layer 53 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-24258.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24243.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-24228.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer53_attn_comp&#45;&gt;layer53_out_proj -->
<g id="edge274" class="edge">
<title>layer53_attn_comp&#45;&gt;layer53_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-24324.22C454.1,-24316.11 454.1,-24307.32 454.1,-24298.81"/>
<polygon fill="black" stroke="black" points="457.6,-24298.63 454.1,-24288.63 450.6,-24298.63 457.6,-24298.63"/>
</g>
<!-- layer53_gate -->
<g id="node275" class="node">
<title>layer53_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-24184.33 216.93,-24184.33 52.65,-24048.33 691.26,-24048.33 855.54,-24184.33"/>
<text text-anchor="middle" x="454.1" y="-24135.13" font-family="Times,serif" font-size="14.00">Layer 53 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-24120.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-24105.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-24090.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer53_out_proj&#45;&gt;layer53_gate -->
<g id="edge275" class="edge">
<title>layer53_out_proj&#45;&gt;layer53_gate</title>
<path fill="none" stroke="black" d="M454.1,-24220.06C454.1,-24212.24 454.1,-24203.57 454.1,-24194.69"/>
<polygon fill="black" stroke="black" points="457.6,-24194.6 454.1,-24184.6 450.6,-24194.6 457.6,-24194.6"/>
</g>
<!-- layer53_moe -->
<g id="node276" class="node">
<title>layer53_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-24012.33 254.6,-24012.33 254.6,-23944.33 653.6,-23944.33 653.6,-24012.33"/>
<text text-anchor="middle" x="454.1" y="-23997.13" font-family="Times,serif" font-size="14.00">Layer 53 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-23982.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23967.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-23952.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer53_gate&#45;&gt;layer53_moe -->
<g id="edge276" class="edge">
<title>layer53_gate&#45;&gt;layer53_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-24048.13C454.1,-24039.38 454.1,-24030.61 454.1,-24022.4"/>
<polygon fill="black" stroke="black" points="457.6,-24022.35 454.1,-24012.35 450.6,-24022.35 457.6,-24022.35"/>
</g>
<!-- layer54_qkv_proj -->
<g id="node277" class="node">
<title>layer54_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-23908.33 240.6,-23908.33 240.6,-23840.33 667.6,-23840.33 667.6,-23908.33"/>
<text text-anchor="middle" x="454.1" y="-23893.13" font-family="Times,serif" font-size="14.00">Layer 54 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-23878.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23863.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-23848.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer53_moe&#45;&gt;layer54_qkv_proj -->
<g id="edge277" class="edge">
<title>layer53_moe&#45;&gt;layer54_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-23944.22C454.1,-23936.11 454.1,-23927.32 454.1,-23918.81"/>
<polygon fill="black" stroke="black" points="457.6,-23918.63 454.1,-23908.63 450.6,-23918.63 457.6,-23918.63"/>
</g>
<!-- layer54_attn_comp -->
<g id="node278" class="node">
<title>layer54_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-23804.33 240.6,-23804.33 240.6,-23736.33 667.6,-23736.33 667.6,-23804.33"/>
<text text-anchor="middle" x="454.1" y="-23789.13" font-family="Times,serif" font-size="14.00">Layer 54 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-23774.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23759.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-23744.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer54_qkv_proj&#45;&gt;layer54_attn_comp -->
<g id="edge278" class="edge">
<title>layer54_qkv_proj&#45;&gt;layer54_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-23840.22C454.1,-23832.11 454.1,-23823.32 454.1,-23814.81"/>
<polygon fill="black" stroke="black" points="457.6,-23814.63 454.1,-23804.63 450.6,-23814.63 457.6,-23814.63"/>
</g>
<!-- layer54_out_proj -->
<g id="node279" class="node">
<title>layer54_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-23700.33 246.6,-23700.33 246.6,-23632.33 661.6,-23632.33 661.6,-23700.33"/>
<text text-anchor="middle" x="454.1" y="-23685.13" font-family="Times,serif" font-size="14.00">Layer 54 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-23670.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23655.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-23640.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer54_attn_comp&#45;&gt;layer54_out_proj -->
<g id="edge279" class="edge">
<title>layer54_attn_comp&#45;&gt;layer54_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-23736.22C454.1,-23728.11 454.1,-23719.32 454.1,-23710.81"/>
<polygon fill="black" stroke="black" points="457.6,-23710.63 454.1,-23700.63 450.6,-23710.63 457.6,-23710.63"/>
</g>
<!-- layer54_gate -->
<g id="node280" class="node">
<title>layer54_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-23596.33 216.93,-23596.33 52.65,-23460.33 691.26,-23460.33 855.54,-23596.33"/>
<text text-anchor="middle" x="454.1" y="-23547.13" font-family="Times,serif" font-size="14.00">Layer 54 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-23532.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23517.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-23502.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer54_out_proj&#45;&gt;layer54_gate -->
<g id="edge280" class="edge">
<title>layer54_out_proj&#45;&gt;layer54_gate</title>
<path fill="none" stroke="black" d="M454.1,-23632.06C454.1,-23624.24 454.1,-23615.57 454.1,-23606.69"/>
<polygon fill="black" stroke="black" points="457.6,-23606.6 454.1,-23596.6 450.6,-23606.6 457.6,-23606.6"/>
</g>
<!-- layer54_moe -->
<g id="node281" class="node">
<title>layer54_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-23424.33 254.6,-23424.33 254.6,-23356.33 653.6,-23356.33 653.6,-23424.33"/>
<text text-anchor="middle" x="454.1" y="-23409.13" font-family="Times,serif" font-size="14.00">Layer 54 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-23394.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23379.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-23364.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer54_gate&#45;&gt;layer54_moe -->
<g id="edge281" class="edge">
<title>layer54_gate&#45;&gt;layer54_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-23460.13C454.1,-23451.38 454.1,-23442.61 454.1,-23434.4"/>
<polygon fill="black" stroke="black" points="457.6,-23434.35 454.1,-23424.35 450.6,-23434.35 457.6,-23434.35"/>
</g>
<!-- layer55_qkv_proj -->
<g id="node282" class="node">
<title>layer55_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-23320.33 240.6,-23320.33 240.6,-23252.33 667.6,-23252.33 667.6,-23320.33"/>
<text text-anchor="middle" x="454.1" y="-23305.13" font-family="Times,serif" font-size="14.00">Layer 55 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-23290.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23275.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-23260.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer54_moe&#45;&gt;layer55_qkv_proj -->
<g id="edge282" class="edge">
<title>layer54_moe&#45;&gt;layer55_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-23356.22C454.1,-23348.11 454.1,-23339.32 454.1,-23330.81"/>
<polygon fill="black" stroke="black" points="457.6,-23330.63 454.1,-23320.63 450.6,-23330.63 457.6,-23330.63"/>
</g>
<!-- layer55_attn_comp -->
<g id="node283" class="node">
<title>layer55_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-23216.33 240.6,-23216.33 240.6,-23148.33 667.6,-23148.33 667.6,-23216.33"/>
<text text-anchor="middle" x="454.1" y="-23201.13" font-family="Times,serif" font-size="14.00">Layer 55 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-23186.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23171.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-23156.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer55_qkv_proj&#45;&gt;layer55_attn_comp -->
<g id="edge283" class="edge">
<title>layer55_qkv_proj&#45;&gt;layer55_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-23252.22C454.1,-23244.11 454.1,-23235.32 454.1,-23226.81"/>
<polygon fill="black" stroke="black" points="457.6,-23226.63 454.1,-23216.63 450.6,-23226.63 457.6,-23226.63"/>
</g>
<!-- layer55_out_proj -->
<g id="node284" class="node">
<title>layer55_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-23112.33 246.6,-23112.33 246.6,-23044.33 661.6,-23044.33 661.6,-23112.33"/>
<text text-anchor="middle" x="454.1" y="-23097.13" font-family="Times,serif" font-size="14.00">Layer 55 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-23082.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-23067.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-23052.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer55_attn_comp&#45;&gt;layer55_out_proj -->
<g id="edge284" class="edge">
<title>layer55_attn_comp&#45;&gt;layer55_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-23148.22C454.1,-23140.11 454.1,-23131.32 454.1,-23122.81"/>
<polygon fill="black" stroke="black" points="457.6,-23122.63 454.1,-23112.63 450.6,-23122.63 457.6,-23122.63"/>
</g>
<!-- layer55_gate -->
<g id="node285" class="node">
<title>layer55_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-23008.33 216.93,-23008.33 52.65,-22872.33 691.26,-22872.33 855.54,-23008.33"/>
<text text-anchor="middle" x="454.1" y="-22959.13" font-family="Times,serif" font-size="14.00">Layer 55 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-22944.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22929.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-22914.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer55_out_proj&#45;&gt;layer55_gate -->
<g id="edge285" class="edge">
<title>layer55_out_proj&#45;&gt;layer55_gate</title>
<path fill="none" stroke="black" d="M454.1,-23044.06C454.1,-23036.24 454.1,-23027.57 454.1,-23018.69"/>
<polygon fill="black" stroke="black" points="457.6,-23018.6 454.1,-23008.6 450.6,-23018.6 457.6,-23018.6"/>
</g>
<!-- layer55_moe -->
<g id="node286" class="node">
<title>layer55_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-22836.33 254.6,-22836.33 254.6,-22768.33 653.6,-22768.33 653.6,-22836.33"/>
<text text-anchor="middle" x="454.1" y="-22821.13" font-family="Times,serif" font-size="14.00">Layer 55 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-22806.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22791.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-22776.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer55_gate&#45;&gt;layer55_moe -->
<g id="edge286" class="edge">
<title>layer55_gate&#45;&gt;layer55_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-22872.13C454.1,-22863.38 454.1,-22854.61 454.1,-22846.4"/>
<polygon fill="black" stroke="black" points="457.6,-22846.35 454.1,-22836.35 450.6,-22846.35 457.6,-22846.35"/>
</g>
<!-- layer56_qkv_proj -->
<g id="node287" class="node">
<title>layer56_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-22732.33 240.6,-22732.33 240.6,-22664.33 667.6,-22664.33 667.6,-22732.33"/>
<text text-anchor="middle" x="454.1" y="-22717.13" font-family="Times,serif" font-size="14.00">Layer 56 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-22702.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22687.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-22672.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer55_moe&#45;&gt;layer56_qkv_proj -->
<g id="edge287" class="edge">
<title>layer55_moe&#45;&gt;layer56_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-22768.22C454.1,-22760.11 454.1,-22751.32 454.1,-22742.81"/>
<polygon fill="black" stroke="black" points="457.6,-22742.63 454.1,-22732.63 450.6,-22742.63 457.6,-22742.63"/>
</g>
<!-- layer56_attn_comp -->
<g id="node288" class="node">
<title>layer56_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-22628.33 240.6,-22628.33 240.6,-22560.33 667.6,-22560.33 667.6,-22628.33"/>
<text text-anchor="middle" x="454.1" y="-22613.13" font-family="Times,serif" font-size="14.00">Layer 56 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-22598.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22583.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-22568.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer56_qkv_proj&#45;&gt;layer56_attn_comp -->
<g id="edge288" class="edge">
<title>layer56_qkv_proj&#45;&gt;layer56_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-22664.22C454.1,-22656.11 454.1,-22647.32 454.1,-22638.81"/>
<polygon fill="black" stroke="black" points="457.6,-22638.63 454.1,-22628.63 450.6,-22638.63 457.6,-22638.63"/>
</g>
<!-- layer56_out_proj -->
<g id="node289" class="node">
<title>layer56_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-22524.33 246.6,-22524.33 246.6,-22456.33 661.6,-22456.33 661.6,-22524.33"/>
<text text-anchor="middle" x="454.1" y="-22509.13" font-family="Times,serif" font-size="14.00">Layer 56 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-22494.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22479.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-22464.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer56_attn_comp&#45;&gt;layer56_out_proj -->
<g id="edge289" class="edge">
<title>layer56_attn_comp&#45;&gt;layer56_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-22560.22C454.1,-22552.11 454.1,-22543.32 454.1,-22534.81"/>
<polygon fill="black" stroke="black" points="457.6,-22534.63 454.1,-22524.63 450.6,-22534.63 457.6,-22534.63"/>
</g>
<!-- layer56_gate -->
<g id="node290" class="node">
<title>layer56_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-22420.33 216.93,-22420.33 52.65,-22284.33 691.26,-22284.33 855.54,-22420.33"/>
<text text-anchor="middle" x="454.1" y="-22371.13" font-family="Times,serif" font-size="14.00">Layer 56 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-22356.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22341.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-22326.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer56_out_proj&#45;&gt;layer56_gate -->
<g id="edge290" class="edge">
<title>layer56_out_proj&#45;&gt;layer56_gate</title>
<path fill="none" stroke="black" d="M454.1,-22456.06C454.1,-22448.24 454.1,-22439.57 454.1,-22430.69"/>
<polygon fill="black" stroke="black" points="457.6,-22430.6 454.1,-22420.6 450.6,-22430.6 457.6,-22430.6"/>
</g>
<!-- layer56_moe -->
<g id="node291" class="node">
<title>layer56_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-22248.33 254.6,-22248.33 254.6,-22180.33 653.6,-22180.33 653.6,-22248.33"/>
<text text-anchor="middle" x="454.1" y="-22233.13" font-family="Times,serif" font-size="14.00">Layer 56 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-22218.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22203.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-22188.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer56_gate&#45;&gt;layer56_moe -->
<g id="edge291" class="edge">
<title>layer56_gate&#45;&gt;layer56_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-22284.13C454.1,-22275.38 454.1,-22266.61 454.1,-22258.4"/>
<polygon fill="black" stroke="black" points="457.6,-22258.35 454.1,-22248.35 450.6,-22258.35 457.6,-22258.35"/>
</g>
<!-- layer57_qkv_proj -->
<g id="node292" class="node">
<title>layer57_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-22144.33 240.6,-22144.33 240.6,-22076.33 667.6,-22076.33 667.6,-22144.33"/>
<text text-anchor="middle" x="454.1" y="-22129.13" font-family="Times,serif" font-size="14.00">Layer 57 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-22114.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-22099.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-22084.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer56_moe&#45;&gt;layer57_qkv_proj -->
<g id="edge292" class="edge">
<title>layer56_moe&#45;&gt;layer57_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-22180.22C454.1,-22172.11 454.1,-22163.32 454.1,-22154.81"/>
<polygon fill="black" stroke="black" points="457.6,-22154.63 454.1,-22144.63 450.6,-22154.63 457.6,-22154.63"/>
</g>
<!-- layer57_attn_comp -->
<g id="node293" class="node">
<title>layer57_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-22040.33 240.6,-22040.33 240.6,-21972.33 667.6,-21972.33 667.6,-22040.33"/>
<text text-anchor="middle" x="454.1" y="-22025.13" font-family="Times,serif" font-size="14.00">Layer 57 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-22010.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21995.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-21980.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer57_qkv_proj&#45;&gt;layer57_attn_comp -->
<g id="edge293" class="edge">
<title>layer57_qkv_proj&#45;&gt;layer57_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-22076.22C454.1,-22068.11 454.1,-22059.32 454.1,-22050.81"/>
<polygon fill="black" stroke="black" points="457.6,-22050.63 454.1,-22040.63 450.6,-22050.63 457.6,-22050.63"/>
</g>
<!-- layer57_out_proj -->
<g id="node294" class="node">
<title>layer57_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-21936.33 246.6,-21936.33 246.6,-21868.33 661.6,-21868.33 661.6,-21936.33"/>
<text text-anchor="middle" x="454.1" y="-21921.13" font-family="Times,serif" font-size="14.00">Layer 57 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-21906.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21891.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-21876.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer57_attn_comp&#45;&gt;layer57_out_proj -->
<g id="edge294" class="edge">
<title>layer57_attn_comp&#45;&gt;layer57_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-21972.22C454.1,-21964.11 454.1,-21955.32 454.1,-21946.81"/>
<polygon fill="black" stroke="black" points="457.6,-21946.63 454.1,-21936.63 450.6,-21946.63 457.6,-21946.63"/>
</g>
<!-- layer57_gate -->
<g id="node295" class="node">
<title>layer57_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-21832.33 216.93,-21832.33 52.65,-21696.33 691.26,-21696.33 855.54,-21832.33"/>
<text text-anchor="middle" x="454.1" y="-21783.13" font-family="Times,serif" font-size="14.00">Layer 57 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-21768.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21753.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-21738.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer57_out_proj&#45;&gt;layer57_gate -->
<g id="edge295" class="edge">
<title>layer57_out_proj&#45;&gt;layer57_gate</title>
<path fill="none" stroke="black" d="M454.1,-21868.06C454.1,-21860.24 454.1,-21851.57 454.1,-21842.69"/>
<polygon fill="black" stroke="black" points="457.6,-21842.6 454.1,-21832.6 450.6,-21842.6 457.6,-21842.6"/>
</g>
<!-- layer57_moe -->
<g id="node296" class="node">
<title>layer57_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-21660.33 254.6,-21660.33 254.6,-21592.33 653.6,-21592.33 653.6,-21660.33"/>
<text text-anchor="middle" x="454.1" y="-21645.13" font-family="Times,serif" font-size="14.00">Layer 57 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-21630.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21615.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-21600.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer57_gate&#45;&gt;layer57_moe -->
<g id="edge296" class="edge">
<title>layer57_gate&#45;&gt;layer57_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-21696.13C454.1,-21687.38 454.1,-21678.61 454.1,-21670.4"/>
<polygon fill="black" stroke="black" points="457.6,-21670.35 454.1,-21660.35 450.6,-21670.35 457.6,-21670.35"/>
</g>
<!-- layer58_qkv_proj -->
<g id="node297" class="node">
<title>layer58_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-21556.33 240.6,-21556.33 240.6,-21488.33 667.6,-21488.33 667.6,-21556.33"/>
<text text-anchor="middle" x="454.1" y="-21541.13" font-family="Times,serif" font-size="14.00">Layer 58 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-21526.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21511.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-21496.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer57_moe&#45;&gt;layer58_qkv_proj -->
<g id="edge297" class="edge">
<title>layer57_moe&#45;&gt;layer58_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-21592.22C454.1,-21584.11 454.1,-21575.32 454.1,-21566.81"/>
<polygon fill="black" stroke="black" points="457.6,-21566.63 454.1,-21556.63 450.6,-21566.63 457.6,-21566.63"/>
</g>
<!-- layer58_attn_comp -->
<g id="node298" class="node">
<title>layer58_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-21452.33 240.6,-21452.33 240.6,-21384.33 667.6,-21384.33 667.6,-21452.33"/>
<text text-anchor="middle" x="454.1" y="-21437.13" font-family="Times,serif" font-size="14.00">Layer 58 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-21422.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21407.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-21392.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer58_qkv_proj&#45;&gt;layer58_attn_comp -->
<g id="edge298" class="edge">
<title>layer58_qkv_proj&#45;&gt;layer58_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-21488.22C454.1,-21480.11 454.1,-21471.32 454.1,-21462.81"/>
<polygon fill="black" stroke="black" points="457.6,-21462.63 454.1,-21452.63 450.6,-21462.63 457.6,-21462.63"/>
</g>
<!-- layer58_out_proj -->
<g id="node299" class="node">
<title>layer58_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-21348.33 246.6,-21348.33 246.6,-21280.33 661.6,-21280.33 661.6,-21348.33"/>
<text text-anchor="middle" x="454.1" y="-21333.13" font-family="Times,serif" font-size="14.00">Layer 58 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-21318.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21303.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-21288.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer58_attn_comp&#45;&gt;layer58_out_proj -->
<g id="edge299" class="edge">
<title>layer58_attn_comp&#45;&gt;layer58_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-21384.22C454.1,-21376.11 454.1,-21367.32 454.1,-21358.81"/>
<polygon fill="black" stroke="black" points="457.6,-21358.63 454.1,-21348.63 450.6,-21358.63 457.6,-21358.63"/>
</g>
<!-- layer58_gate -->
<g id="node300" class="node">
<title>layer58_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-21244.33 216.93,-21244.33 52.65,-21108.33 691.26,-21108.33 855.54,-21244.33"/>
<text text-anchor="middle" x="454.1" y="-21195.13" font-family="Times,serif" font-size="14.00">Layer 58 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-21180.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21165.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-21150.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer58_out_proj&#45;&gt;layer58_gate -->
<g id="edge300" class="edge">
<title>layer58_out_proj&#45;&gt;layer58_gate</title>
<path fill="none" stroke="black" d="M454.1,-21280.06C454.1,-21272.24 454.1,-21263.57 454.1,-21254.69"/>
<polygon fill="black" stroke="black" points="457.6,-21254.6 454.1,-21244.6 450.6,-21254.6 457.6,-21254.6"/>
</g>
<!-- layer58_moe -->
<g id="node301" class="node">
<title>layer58_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-21072.33 254.6,-21072.33 254.6,-21004.33 653.6,-21004.33 653.6,-21072.33"/>
<text text-anchor="middle" x="454.1" y="-21057.13" font-family="Times,serif" font-size="14.00">Layer 58 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-21042.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-21027.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-21012.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer58_gate&#45;&gt;layer58_moe -->
<g id="edge301" class="edge">
<title>layer58_gate&#45;&gt;layer58_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-21108.13C454.1,-21099.38 454.1,-21090.61 454.1,-21082.4"/>
<polygon fill="black" stroke="black" points="457.6,-21082.35 454.1,-21072.35 450.6,-21082.35 457.6,-21082.35"/>
</g>
<!-- layer59_qkv_proj -->
<g id="node302" class="node">
<title>layer59_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-20968.33 240.6,-20968.33 240.6,-20900.33 667.6,-20900.33 667.6,-20968.33"/>
<text text-anchor="middle" x="454.1" y="-20953.13" font-family="Times,serif" font-size="14.00">Layer 59 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-20938.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20923.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-20908.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer58_moe&#45;&gt;layer59_qkv_proj -->
<g id="edge302" class="edge">
<title>layer58_moe&#45;&gt;layer59_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-21004.22C454.1,-20996.11 454.1,-20987.32 454.1,-20978.81"/>
<polygon fill="black" stroke="black" points="457.6,-20978.63 454.1,-20968.63 450.6,-20978.63 457.6,-20978.63"/>
</g>
<!-- layer59_attn_comp -->
<g id="node303" class="node">
<title>layer59_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-20864.33 240.6,-20864.33 240.6,-20796.33 667.6,-20796.33 667.6,-20864.33"/>
<text text-anchor="middle" x="454.1" y="-20849.13" font-family="Times,serif" font-size="14.00">Layer 59 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-20834.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20819.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-20804.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer59_qkv_proj&#45;&gt;layer59_attn_comp -->
<g id="edge303" class="edge">
<title>layer59_qkv_proj&#45;&gt;layer59_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-20900.22C454.1,-20892.11 454.1,-20883.32 454.1,-20874.81"/>
<polygon fill="black" stroke="black" points="457.6,-20874.63 454.1,-20864.63 450.6,-20874.63 457.6,-20874.63"/>
</g>
<!-- layer59_out_proj -->
<g id="node304" class="node">
<title>layer59_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-20760.33 246.6,-20760.33 246.6,-20692.33 661.6,-20692.33 661.6,-20760.33"/>
<text text-anchor="middle" x="454.1" y="-20745.13" font-family="Times,serif" font-size="14.00">Layer 59 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-20730.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20715.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-20700.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer59_attn_comp&#45;&gt;layer59_out_proj -->
<g id="edge304" class="edge">
<title>layer59_attn_comp&#45;&gt;layer59_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-20796.22C454.1,-20788.11 454.1,-20779.32 454.1,-20770.81"/>
<polygon fill="black" stroke="black" points="457.6,-20770.63 454.1,-20760.63 450.6,-20770.63 457.6,-20770.63"/>
</g>
<!-- layer59_gate -->
<g id="node305" class="node">
<title>layer59_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-20656.33 216.93,-20656.33 52.65,-20520.33 691.26,-20520.33 855.54,-20656.33"/>
<text text-anchor="middle" x="454.1" y="-20607.13" font-family="Times,serif" font-size="14.00">Layer 59 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-20592.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20577.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-20562.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer59_out_proj&#45;&gt;layer59_gate -->
<g id="edge305" class="edge">
<title>layer59_out_proj&#45;&gt;layer59_gate</title>
<path fill="none" stroke="black" d="M454.1,-20692.06C454.1,-20684.24 454.1,-20675.57 454.1,-20666.69"/>
<polygon fill="black" stroke="black" points="457.6,-20666.6 454.1,-20656.6 450.6,-20666.6 457.6,-20666.6"/>
</g>
<!-- layer59_moe -->
<g id="node306" class="node">
<title>layer59_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-20484.33 254.6,-20484.33 254.6,-20416.33 653.6,-20416.33 653.6,-20484.33"/>
<text text-anchor="middle" x="454.1" y="-20469.13" font-family="Times,serif" font-size="14.00">Layer 59 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-20454.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20439.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-20424.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer59_gate&#45;&gt;layer59_moe -->
<g id="edge306" class="edge">
<title>layer59_gate&#45;&gt;layer59_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-20520.13C454.1,-20511.38 454.1,-20502.61 454.1,-20494.4"/>
<polygon fill="black" stroke="black" points="457.6,-20494.35 454.1,-20484.35 450.6,-20494.35 457.6,-20494.35"/>
</g>
<!-- layer60_qkv_proj -->
<g id="node307" class="node">
<title>layer60_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-20380.33 240.6,-20380.33 240.6,-20312.33 667.6,-20312.33 667.6,-20380.33"/>
<text text-anchor="middle" x="454.1" y="-20365.13" font-family="Times,serif" font-size="14.00">Layer 60 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-20350.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20335.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-20320.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer59_moe&#45;&gt;layer60_qkv_proj -->
<g id="edge307" class="edge">
<title>layer59_moe&#45;&gt;layer60_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-20416.22C454.1,-20408.11 454.1,-20399.32 454.1,-20390.81"/>
<polygon fill="black" stroke="black" points="457.6,-20390.63 454.1,-20380.63 450.6,-20390.63 457.6,-20390.63"/>
</g>
<!-- layer60_attn_comp -->
<g id="node308" class="node">
<title>layer60_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-20276.33 240.6,-20276.33 240.6,-20208.33 667.6,-20208.33 667.6,-20276.33"/>
<text text-anchor="middle" x="454.1" y="-20261.13" font-family="Times,serif" font-size="14.00">Layer 60 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-20246.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20231.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-20216.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer60_qkv_proj&#45;&gt;layer60_attn_comp -->
<g id="edge308" class="edge">
<title>layer60_qkv_proj&#45;&gt;layer60_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-20312.22C454.1,-20304.11 454.1,-20295.32 454.1,-20286.81"/>
<polygon fill="black" stroke="black" points="457.6,-20286.63 454.1,-20276.63 450.6,-20286.63 457.6,-20286.63"/>
</g>
<!-- layer60_out_proj -->
<g id="node309" class="node">
<title>layer60_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-20172.33 246.6,-20172.33 246.6,-20104.33 661.6,-20104.33 661.6,-20172.33"/>
<text text-anchor="middle" x="454.1" y="-20157.13" font-family="Times,serif" font-size="14.00">Layer 60 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-20142.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-20127.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-20112.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer60_attn_comp&#45;&gt;layer60_out_proj -->
<g id="edge309" class="edge">
<title>layer60_attn_comp&#45;&gt;layer60_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-20208.22C454.1,-20200.11 454.1,-20191.32 454.1,-20182.81"/>
<polygon fill="black" stroke="black" points="457.6,-20182.63 454.1,-20172.63 450.6,-20182.63 457.6,-20182.63"/>
</g>
<!-- layer60_gate -->
<g id="node310" class="node">
<title>layer60_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-20068.33 216.93,-20068.33 52.65,-19932.33 691.26,-19932.33 855.54,-20068.33"/>
<text text-anchor="middle" x="454.1" y="-20019.13" font-family="Times,serif" font-size="14.00">Layer 60 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-20004.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19989.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-19974.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer60_out_proj&#45;&gt;layer60_gate -->
<g id="edge310" class="edge">
<title>layer60_out_proj&#45;&gt;layer60_gate</title>
<path fill="none" stroke="black" d="M454.1,-20104.06C454.1,-20096.24 454.1,-20087.57 454.1,-20078.69"/>
<polygon fill="black" stroke="black" points="457.6,-20078.6 454.1,-20068.6 450.6,-20078.6 457.6,-20078.6"/>
</g>
<!-- layer60_moe -->
<g id="node311" class="node">
<title>layer60_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-19896.33 254.6,-19896.33 254.6,-19828.33 653.6,-19828.33 653.6,-19896.33"/>
<text text-anchor="middle" x="454.1" y="-19881.13" font-family="Times,serif" font-size="14.00">Layer 60 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-19866.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19851.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-19836.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer60_gate&#45;&gt;layer60_moe -->
<g id="edge311" class="edge">
<title>layer60_gate&#45;&gt;layer60_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-19932.13C454.1,-19923.38 454.1,-19914.61 454.1,-19906.4"/>
<polygon fill="black" stroke="black" points="457.6,-19906.35 454.1,-19896.35 450.6,-19906.35 457.6,-19906.35"/>
</g>
<!-- layer61_qkv_proj -->
<g id="node312" class="node">
<title>layer61_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-19792.33 240.6,-19792.33 240.6,-19724.33 667.6,-19724.33 667.6,-19792.33"/>
<text text-anchor="middle" x="454.1" y="-19777.13" font-family="Times,serif" font-size="14.00">Layer 61 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-19762.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19747.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-19732.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer60_moe&#45;&gt;layer61_qkv_proj -->
<g id="edge312" class="edge">
<title>layer60_moe&#45;&gt;layer61_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-19828.22C454.1,-19820.11 454.1,-19811.32 454.1,-19802.81"/>
<polygon fill="black" stroke="black" points="457.6,-19802.63 454.1,-19792.63 450.6,-19802.63 457.6,-19802.63"/>
</g>
<!-- layer61_attn_comp -->
<g id="node313" class="node">
<title>layer61_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-19688.33 240.6,-19688.33 240.6,-19620.33 667.6,-19620.33 667.6,-19688.33"/>
<text text-anchor="middle" x="454.1" y="-19673.13" font-family="Times,serif" font-size="14.00">Layer 61 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-19658.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19643.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-19628.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer61_qkv_proj&#45;&gt;layer61_attn_comp -->
<g id="edge313" class="edge">
<title>layer61_qkv_proj&#45;&gt;layer61_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-19724.22C454.1,-19716.11 454.1,-19707.32 454.1,-19698.81"/>
<polygon fill="black" stroke="black" points="457.6,-19698.63 454.1,-19688.63 450.6,-19698.63 457.6,-19698.63"/>
</g>
<!-- layer61_out_proj -->
<g id="node314" class="node">
<title>layer61_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-19584.33 246.6,-19584.33 246.6,-19516.33 661.6,-19516.33 661.6,-19584.33"/>
<text text-anchor="middle" x="454.1" y="-19569.13" font-family="Times,serif" font-size="14.00">Layer 61 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-19554.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19539.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-19524.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer61_attn_comp&#45;&gt;layer61_out_proj -->
<g id="edge314" class="edge">
<title>layer61_attn_comp&#45;&gt;layer61_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-19620.22C454.1,-19612.11 454.1,-19603.32 454.1,-19594.81"/>
<polygon fill="black" stroke="black" points="457.6,-19594.63 454.1,-19584.63 450.6,-19594.63 457.6,-19594.63"/>
</g>
<!-- layer61_gate -->
<g id="node315" class="node">
<title>layer61_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-19480.33 216.93,-19480.33 52.65,-19344.33 691.26,-19344.33 855.54,-19480.33"/>
<text text-anchor="middle" x="454.1" y="-19431.13" font-family="Times,serif" font-size="14.00">Layer 61 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-19416.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19401.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-19386.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer61_out_proj&#45;&gt;layer61_gate -->
<g id="edge315" class="edge">
<title>layer61_out_proj&#45;&gt;layer61_gate</title>
<path fill="none" stroke="black" d="M454.1,-19516.06C454.1,-19508.24 454.1,-19499.57 454.1,-19490.69"/>
<polygon fill="black" stroke="black" points="457.6,-19490.6 454.1,-19480.6 450.6,-19490.6 457.6,-19490.6"/>
</g>
<!-- layer61_moe -->
<g id="node316" class="node">
<title>layer61_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-19308.33 254.6,-19308.33 254.6,-19240.33 653.6,-19240.33 653.6,-19308.33"/>
<text text-anchor="middle" x="454.1" y="-19293.13" font-family="Times,serif" font-size="14.00">Layer 61 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-19278.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19263.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-19248.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer61_gate&#45;&gt;layer61_moe -->
<g id="edge316" class="edge">
<title>layer61_gate&#45;&gt;layer61_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-19344.13C454.1,-19335.38 454.1,-19326.61 454.1,-19318.4"/>
<polygon fill="black" stroke="black" points="457.6,-19318.35 454.1,-19308.35 450.6,-19318.35 457.6,-19318.35"/>
</g>
<!-- layer62_qkv_proj -->
<g id="node317" class="node">
<title>layer62_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-19204.33 240.6,-19204.33 240.6,-19136.33 667.6,-19136.33 667.6,-19204.33"/>
<text text-anchor="middle" x="454.1" y="-19189.13" font-family="Times,serif" font-size="14.00">Layer 62 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-19174.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19159.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-19144.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer61_moe&#45;&gt;layer62_qkv_proj -->
<g id="edge317" class="edge">
<title>layer61_moe&#45;&gt;layer62_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-19240.22C454.1,-19232.11 454.1,-19223.32 454.1,-19214.81"/>
<polygon fill="black" stroke="black" points="457.6,-19214.63 454.1,-19204.63 450.6,-19214.63 457.6,-19214.63"/>
</g>
<!-- layer62_attn_comp -->
<g id="node318" class="node">
<title>layer62_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-19100.33 240.6,-19100.33 240.6,-19032.33 667.6,-19032.33 667.6,-19100.33"/>
<text text-anchor="middle" x="454.1" y="-19085.13" font-family="Times,serif" font-size="14.00">Layer 62 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-19070.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-19055.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-19040.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer62_qkv_proj&#45;&gt;layer62_attn_comp -->
<g id="edge318" class="edge">
<title>layer62_qkv_proj&#45;&gt;layer62_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-19136.22C454.1,-19128.11 454.1,-19119.32 454.1,-19110.81"/>
<polygon fill="black" stroke="black" points="457.6,-19110.63 454.1,-19100.63 450.6,-19110.63 457.6,-19110.63"/>
</g>
<!-- layer62_out_proj -->
<g id="node319" class="node">
<title>layer62_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-18996.33 246.6,-18996.33 246.6,-18928.33 661.6,-18928.33 661.6,-18996.33"/>
<text text-anchor="middle" x="454.1" y="-18981.13" font-family="Times,serif" font-size="14.00">Layer 62 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-18966.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18951.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-18936.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer62_attn_comp&#45;&gt;layer62_out_proj -->
<g id="edge319" class="edge">
<title>layer62_attn_comp&#45;&gt;layer62_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-19032.22C454.1,-19024.11 454.1,-19015.32 454.1,-19006.81"/>
<polygon fill="black" stroke="black" points="457.6,-19006.63 454.1,-18996.63 450.6,-19006.63 457.6,-19006.63"/>
</g>
<!-- layer62_gate -->
<g id="node320" class="node">
<title>layer62_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-18892.33 216.93,-18892.33 52.65,-18756.33 691.26,-18756.33 855.54,-18892.33"/>
<text text-anchor="middle" x="454.1" y="-18843.13" font-family="Times,serif" font-size="14.00">Layer 62 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-18828.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18813.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-18798.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer62_out_proj&#45;&gt;layer62_gate -->
<g id="edge320" class="edge">
<title>layer62_out_proj&#45;&gt;layer62_gate</title>
<path fill="none" stroke="black" d="M454.1,-18928.06C454.1,-18920.24 454.1,-18911.57 454.1,-18902.69"/>
<polygon fill="black" stroke="black" points="457.6,-18902.6 454.1,-18892.6 450.6,-18902.6 457.6,-18902.6"/>
</g>
<!-- layer62_moe -->
<g id="node321" class="node">
<title>layer62_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-18720.33 254.6,-18720.33 254.6,-18652.33 653.6,-18652.33 653.6,-18720.33"/>
<text text-anchor="middle" x="454.1" y="-18705.13" font-family="Times,serif" font-size="14.00">Layer 62 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-18690.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18675.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-18660.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer62_gate&#45;&gt;layer62_moe -->
<g id="edge321" class="edge">
<title>layer62_gate&#45;&gt;layer62_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-18756.13C454.1,-18747.38 454.1,-18738.61 454.1,-18730.4"/>
<polygon fill="black" stroke="black" points="457.6,-18730.35 454.1,-18720.35 450.6,-18730.35 457.6,-18730.35"/>
</g>
<!-- layer63_qkv_proj -->
<g id="node322" class="node">
<title>layer63_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-18616.33 240.6,-18616.33 240.6,-18548.33 667.6,-18548.33 667.6,-18616.33"/>
<text text-anchor="middle" x="454.1" y="-18601.13" font-family="Times,serif" font-size="14.00">Layer 63 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-18586.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18571.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-18556.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer62_moe&#45;&gt;layer63_qkv_proj -->
<g id="edge322" class="edge">
<title>layer62_moe&#45;&gt;layer63_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-18652.22C454.1,-18644.11 454.1,-18635.32 454.1,-18626.81"/>
<polygon fill="black" stroke="black" points="457.6,-18626.63 454.1,-18616.63 450.6,-18626.63 457.6,-18626.63"/>
</g>
<!-- layer63_attn_comp -->
<g id="node323" class="node">
<title>layer63_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-18512.33 240.6,-18512.33 240.6,-18444.33 667.6,-18444.33 667.6,-18512.33"/>
<text text-anchor="middle" x="454.1" y="-18497.13" font-family="Times,serif" font-size="14.00">Layer 63 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-18482.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18467.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-18452.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer63_qkv_proj&#45;&gt;layer63_attn_comp -->
<g id="edge323" class="edge">
<title>layer63_qkv_proj&#45;&gt;layer63_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-18548.22C454.1,-18540.11 454.1,-18531.32 454.1,-18522.81"/>
<polygon fill="black" stroke="black" points="457.6,-18522.63 454.1,-18512.63 450.6,-18522.63 457.6,-18522.63"/>
</g>
<!-- layer63_out_proj -->
<g id="node324" class="node">
<title>layer63_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-18408.33 246.6,-18408.33 246.6,-18340.33 661.6,-18340.33 661.6,-18408.33"/>
<text text-anchor="middle" x="454.1" y="-18393.13" font-family="Times,serif" font-size="14.00">Layer 63 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-18378.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18363.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-18348.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer63_attn_comp&#45;&gt;layer63_out_proj -->
<g id="edge324" class="edge">
<title>layer63_attn_comp&#45;&gt;layer63_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-18444.22C454.1,-18436.11 454.1,-18427.32 454.1,-18418.81"/>
<polygon fill="black" stroke="black" points="457.6,-18418.63 454.1,-18408.63 450.6,-18418.63 457.6,-18418.63"/>
</g>
<!-- layer63_gate -->
<g id="node325" class="node">
<title>layer63_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-18304.33 216.93,-18304.33 52.65,-18168.33 691.26,-18168.33 855.54,-18304.33"/>
<text text-anchor="middle" x="454.1" y="-18255.13" font-family="Times,serif" font-size="14.00">Layer 63 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-18240.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18225.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-18210.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer63_out_proj&#45;&gt;layer63_gate -->
<g id="edge325" class="edge">
<title>layer63_out_proj&#45;&gt;layer63_gate</title>
<path fill="none" stroke="black" d="M454.1,-18340.06C454.1,-18332.24 454.1,-18323.57 454.1,-18314.69"/>
<polygon fill="black" stroke="black" points="457.6,-18314.6 454.1,-18304.6 450.6,-18314.6 457.6,-18314.6"/>
</g>
<!-- layer63_moe -->
<g id="node326" class="node">
<title>layer63_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-18132.33 254.6,-18132.33 254.6,-18064.33 653.6,-18064.33 653.6,-18132.33"/>
<text text-anchor="middle" x="454.1" y="-18117.13" font-family="Times,serif" font-size="14.00">Layer 63 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-18102.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-18087.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-18072.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer63_gate&#45;&gt;layer63_moe -->
<g id="edge326" class="edge">
<title>layer63_gate&#45;&gt;layer63_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-18168.13C454.1,-18159.38 454.1,-18150.61 454.1,-18142.4"/>
<polygon fill="black" stroke="black" points="457.6,-18142.35 454.1,-18132.35 450.6,-18142.35 457.6,-18142.35"/>
</g>
<!-- layer64_qkv_proj -->
<g id="node327" class="node">
<title>layer64_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-18028.33 240.6,-18028.33 240.6,-17960.33 667.6,-17960.33 667.6,-18028.33"/>
<text text-anchor="middle" x="454.1" y="-18013.13" font-family="Times,serif" font-size="14.00">Layer 64 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-17998.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17983.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-17968.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer63_moe&#45;&gt;layer64_qkv_proj -->
<g id="edge327" class="edge">
<title>layer63_moe&#45;&gt;layer64_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-18064.22C454.1,-18056.11 454.1,-18047.32 454.1,-18038.81"/>
<polygon fill="black" stroke="black" points="457.6,-18038.63 454.1,-18028.63 450.6,-18038.63 457.6,-18038.63"/>
</g>
<!-- layer64_attn_comp -->
<g id="node328" class="node">
<title>layer64_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-17924.33 240.6,-17924.33 240.6,-17856.33 667.6,-17856.33 667.6,-17924.33"/>
<text text-anchor="middle" x="454.1" y="-17909.13" font-family="Times,serif" font-size="14.00">Layer 64 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-17894.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17879.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-17864.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer64_qkv_proj&#45;&gt;layer64_attn_comp -->
<g id="edge328" class="edge">
<title>layer64_qkv_proj&#45;&gt;layer64_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-17960.22C454.1,-17952.11 454.1,-17943.32 454.1,-17934.81"/>
<polygon fill="black" stroke="black" points="457.6,-17934.63 454.1,-17924.63 450.6,-17934.63 457.6,-17934.63"/>
</g>
<!-- layer64_out_proj -->
<g id="node329" class="node">
<title>layer64_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-17820.33 246.6,-17820.33 246.6,-17752.33 661.6,-17752.33 661.6,-17820.33"/>
<text text-anchor="middle" x="454.1" y="-17805.13" font-family="Times,serif" font-size="14.00">Layer 64 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-17790.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17775.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-17760.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer64_attn_comp&#45;&gt;layer64_out_proj -->
<g id="edge329" class="edge">
<title>layer64_attn_comp&#45;&gt;layer64_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-17856.22C454.1,-17848.11 454.1,-17839.32 454.1,-17830.81"/>
<polygon fill="black" stroke="black" points="457.6,-17830.63 454.1,-17820.63 450.6,-17830.63 457.6,-17830.63"/>
</g>
<!-- layer64_gate -->
<g id="node330" class="node">
<title>layer64_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-17716.33 216.93,-17716.33 52.65,-17580.33 691.26,-17580.33 855.54,-17716.33"/>
<text text-anchor="middle" x="454.1" y="-17667.13" font-family="Times,serif" font-size="14.00">Layer 64 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-17652.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17637.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-17622.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer64_out_proj&#45;&gt;layer64_gate -->
<g id="edge330" class="edge">
<title>layer64_out_proj&#45;&gt;layer64_gate</title>
<path fill="none" stroke="black" d="M454.1,-17752.06C454.1,-17744.24 454.1,-17735.57 454.1,-17726.69"/>
<polygon fill="black" stroke="black" points="457.6,-17726.6 454.1,-17716.6 450.6,-17726.6 457.6,-17726.6"/>
</g>
<!-- layer64_moe -->
<g id="node331" class="node">
<title>layer64_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-17544.33 254.6,-17544.33 254.6,-17476.33 653.6,-17476.33 653.6,-17544.33"/>
<text text-anchor="middle" x="454.1" y="-17529.13" font-family="Times,serif" font-size="14.00">Layer 64 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-17514.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17499.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-17484.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer64_gate&#45;&gt;layer64_moe -->
<g id="edge331" class="edge">
<title>layer64_gate&#45;&gt;layer64_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-17580.13C454.1,-17571.38 454.1,-17562.61 454.1,-17554.4"/>
<polygon fill="black" stroke="black" points="457.6,-17554.35 454.1,-17544.35 450.6,-17554.35 457.6,-17554.35"/>
</g>
<!-- layer65_qkv_proj -->
<g id="node332" class="node">
<title>layer65_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-17440.33 240.6,-17440.33 240.6,-17372.33 667.6,-17372.33 667.6,-17440.33"/>
<text text-anchor="middle" x="454.1" y="-17425.13" font-family="Times,serif" font-size="14.00">Layer 65 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-17410.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17395.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-17380.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer64_moe&#45;&gt;layer65_qkv_proj -->
<g id="edge332" class="edge">
<title>layer64_moe&#45;&gt;layer65_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-17476.22C454.1,-17468.11 454.1,-17459.32 454.1,-17450.81"/>
<polygon fill="black" stroke="black" points="457.6,-17450.63 454.1,-17440.63 450.6,-17450.63 457.6,-17450.63"/>
</g>
<!-- layer65_attn_comp -->
<g id="node333" class="node">
<title>layer65_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-17336.33 240.6,-17336.33 240.6,-17268.33 667.6,-17268.33 667.6,-17336.33"/>
<text text-anchor="middle" x="454.1" y="-17321.13" font-family="Times,serif" font-size="14.00">Layer 65 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-17306.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17291.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-17276.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer65_qkv_proj&#45;&gt;layer65_attn_comp -->
<g id="edge333" class="edge">
<title>layer65_qkv_proj&#45;&gt;layer65_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-17372.22C454.1,-17364.11 454.1,-17355.32 454.1,-17346.81"/>
<polygon fill="black" stroke="black" points="457.6,-17346.63 454.1,-17336.63 450.6,-17346.63 457.6,-17346.63"/>
</g>
<!-- layer65_out_proj -->
<g id="node334" class="node">
<title>layer65_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-17232.33 246.6,-17232.33 246.6,-17164.33 661.6,-17164.33 661.6,-17232.33"/>
<text text-anchor="middle" x="454.1" y="-17217.13" font-family="Times,serif" font-size="14.00">Layer 65 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-17202.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17187.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-17172.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer65_attn_comp&#45;&gt;layer65_out_proj -->
<g id="edge334" class="edge">
<title>layer65_attn_comp&#45;&gt;layer65_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-17268.22C454.1,-17260.11 454.1,-17251.32 454.1,-17242.81"/>
<polygon fill="black" stroke="black" points="457.6,-17242.63 454.1,-17232.63 450.6,-17242.63 457.6,-17242.63"/>
</g>
<!-- layer65_gate -->
<g id="node335" class="node">
<title>layer65_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-17128.33 216.93,-17128.33 52.65,-16992.33 691.26,-16992.33 855.54,-17128.33"/>
<text text-anchor="middle" x="454.1" y="-17079.13" font-family="Times,serif" font-size="14.00">Layer 65 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-17064.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-17049.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-17034.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer65_out_proj&#45;&gt;layer65_gate -->
<g id="edge335" class="edge">
<title>layer65_out_proj&#45;&gt;layer65_gate</title>
<path fill="none" stroke="black" d="M454.1,-17164.06C454.1,-17156.24 454.1,-17147.57 454.1,-17138.69"/>
<polygon fill="black" stroke="black" points="457.6,-17138.6 454.1,-17128.6 450.6,-17138.6 457.6,-17138.6"/>
</g>
<!-- layer65_moe -->
<g id="node336" class="node">
<title>layer65_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-16956.33 254.6,-16956.33 254.6,-16888.33 653.6,-16888.33 653.6,-16956.33"/>
<text text-anchor="middle" x="454.1" y="-16941.13" font-family="Times,serif" font-size="14.00">Layer 65 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-16926.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16911.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-16896.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer65_gate&#45;&gt;layer65_moe -->
<g id="edge336" class="edge">
<title>layer65_gate&#45;&gt;layer65_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-16992.13C454.1,-16983.38 454.1,-16974.61 454.1,-16966.4"/>
<polygon fill="black" stroke="black" points="457.6,-16966.35 454.1,-16956.35 450.6,-16966.35 457.6,-16966.35"/>
</g>
<!-- layer66_qkv_proj -->
<g id="node337" class="node">
<title>layer66_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-16852.33 240.6,-16852.33 240.6,-16784.33 667.6,-16784.33 667.6,-16852.33"/>
<text text-anchor="middle" x="454.1" y="-16837.13" font-family="Times,serif" font-size="14.00">Layer 66 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-16822.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16807.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-16792.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer65_moe&#45;&gt;layer66_qkv_proj -->
<g id="edge337" class="edge">
<title>layer65_moe&#45;&gt;layer66_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-16888.22C454.1,-16880.11 454.1,-16871.32 454.1,-16862.81"/>
<polygon fill="black" stroke="black" points="457.6,-16862.63 454.1,-16852.63 450.6,-16862.63 457.6,-16862.63"/>
</g>
<!-- layer66_attn_comp -->
<g id="node338" class="node">
<title>layer66_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-16748.33 240.6,-16748.33 240.6,-16680.33 667.6,-16680.33 667.6,-16748.33"/>
<text text-anchor="middle" x="454.1" y="-16733.13" font-family="Times,serif" font-size="14.00">Layer 66 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-16718.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16703.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-16688.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer66_qkv_proj&#45;&gt;layer66_attn_comp -->
<g id="edge338" class="edge">
<title>layer66_qkv_proj&#45;&gt;layer66_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-16784.22C454.1,-16776.11 454.1,-16767.32 454.1,-16758.81"/>
<polygon fill="black" stroke="black" points="457.6,-16758.63 454.1,-16748.63 450.6,-16758.63 457.6,-16758.63"/>
</g>
<!-- layer66_out_proj -->
<g id="node339" class="node">
<title>layer66_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-16644.33 246.6,-16644.33 246.6,-16576.33 661.6,-16576.33 661.6,-16644.33"/>
<text text-anchor="middle" x="454.1" y="-16629.13" font-family="Times,serif" font-size="14.00">Layer 66 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-16614.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16599.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-16584.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer66_attn_comp&#45;&gt;layer66_out_proj -->
<g id="edge339" class="edge">
<title>layer66_attn_comp&#45;&gt;layer66_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-16680.22C454.1,-16672.11 454.1,-16663.32 454.1,-16654.81"/>
<polygon fill="black" stroke="black" points="457.6,-16654.63 454.1,-16644.63 450.6,-16654.63 457.6,-16654.63"/>
</g>
<!-- layer66_gate -->
<g id="node340" class="node">
<title>layer66_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-16540.33 216.93,-16540.33 52.65,-16404.33 691.26,-16404.33 855.54,-16540.33"/>
<text text-anchor="middle" x="454.1" y="-16491.13" font-family="Times,serif" font-size="14.00">Layer 66 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-16476.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16461.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-16446.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer66_out_proj&#45;&gt;layer66_gate -->
<g id="edge340" class="edge">
<title>layer66_out_proj&#45;&gt;layer66_gate</title>
<path fill="none" stroke="black" d="M454.1,-16576.06C454.1,-16568.24 454.1,-16559.57 454.1,-16550.69"/>
<polygon fill="black" stroke="black" points="457.6,-16550.6 454.1,-16540.6 450.6,-16550.6 457.6,-16550.6"/>
</g>
<!-- layer66_moe -->
<g id="node341" class="node">
<title>layer66_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-16368.33 254.6,-16368.33 254.6,-16300.33 653.6,-16300.33 653.6,-16368.33"/>
<text text-anchor="middle" x="454.1" y="-16353.13" font-family="Times,serif" font-size="14.00">Layer 66 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-16338.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16323.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-16308.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer66_gate&#45;&gt;layer66_moe -->
<g id="edge341" class="edge">
<title>layer66_gate&#45;&gt;layer66_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-16404.13C454.1,-16395.38 454.1,-16386.61 454.1,-16378.4"/>
<polygon fill="black" stroke="black" points="457.6,-16378.35 454.1,-16368.35 450.6,-16378.35 457.6,-16378.35"/>
</g>
<!-- layer67_qkv_proj -->
<g id="node342" class="node">
<title>layer67_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-16264.33 240.6,-16264.33 240.6,-16196.33 667.6,-16196.33 667.6,-16264.33"/>
<text text-anchor="middle" x="454.1" y="-16249.13" font-family="Times,serif" font-size="14.00">Layer 67 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-16234.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16219.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-16204.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer66_moe&#45;&gt;layer67_qkv_proj -->
<g id="edge342" class="edge">
<title>layer66_moe&#45;&gt;layer67_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-16300.22C454.1,-16292.11 454.1,-16283.32 454.1,-16274.81"/>
<polygon fill="black" stroke="black" points="457.6,-16274.63 454.1,-16264.63 450.6,-16274.63 457.6,-16274.63"/>
</g>
<!-- layer67_attn_comp -->
<g id="node343" class="node">
<title>layer67_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-16160.33 240.6,-16160.33 240.6,-16092.33 667.6,-16092.33 667.6,-16160.33"/>
<text text-anchor="middle" x="454.1" y="-16145.13" font-family="Times,serif" font-size="14.00">Layer 67 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-16130.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16115.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-16100.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer67_qkv_proj&#45;&gt;layer67_attn_comp -->
<g id="edge343" class="edge">
<title>layer67_qkv_proj&#45;&gt;layer67_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-16196.22C454.1,-16188.11 454.1,-16179.32 454.1,-16170.81"/>
<polygon fill="black" stroke="black" points="457.6,-16170.63 454.1,-16160.63 450.6,-16170.63 457.6,-16170.63"/>
</g>
<!-- layer67_out_proj -->
<g id="node344" class="node">
<title>layer67_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-16056.33 246.6,-16056.33 246.6,-15988.33 661.6,-15988.33 661.6,-16056.33"/>
<text text-anchor="middle" x="454.1" y="-16041.13" font-family="Times,serif" font-size="14.00">Layer 67 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-16026.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-16011.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-15996.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer67_attn_comp&#45;&gt;layer67_out_proj -->
<g id="edge344" class="edge">
<title>layer67_attn_comp&#45;&gt;layer67_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-16092.22C454.1,-16084.11 454.1,-16075.32 454.1,-16066.81"/>
<polygon fill="black" stroke="black" points="457.6,-16066.63 454.1,-16056.63 450.6,-16066.63 457.6,-16066.63"/>
</g>
<!-- layer67_gate -->
<g id="node345" class="node">
<title>layer67_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-15952.33 216.93,-15952.33 52.65,-15816.33 691.26,-15816.33 855.54,-15952.33"/>
<text text-anchor="middle" x="454.1" y="-15903.13" font-family="Times,serif" font-size="14.00">Layer 67 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-15888.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15873.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-15858.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer67_out_proj&#45;&gt;layer67_gate -->
<g id="edge345" class="edge">
<title>layer67_out_proj&#45;&gt;layer67_gate</title>
<path fill="none" stroke="black" d="M454.1,-15988.06C454.1,-15980.24 454.1,-15971.57 454.1,-15962.69"/>
<polygon fill="black" stroke="black" points="457.6,-15962.6 454.1,-15952.6 450.6,-15962.6 457.6,-15962.6"/>
</g>
<!-- layer67_moe -->
<g id="node346" class="node">
<title>layer67_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-15780.33 254.6,-15780.33 254.6,-15712.33 653.6,-15712.33 653.6,-15780.33"/>
<text text-anchor="middle" x="454.1" y="-15765.13" font-family="Times,serif" font-size="14.00">Layer 67 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-15750.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15735.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-15720.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer67_gate&#45;&gt;layer67_moe -->
<g id="edge346" class="edge">
<title>layer67_gate&#45;&gt;layer67_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-15816.13C454.1,-15807.38 454.1,-15798.61 454.1,-15790.4"/>
<polygon fill="black" stroke="black" points="457.6,-15790.35 454.1,-15780.35 450.6,-15790.35 457.6,-15790.35"/>
</g>
<!-- layer68_qkv_proj -->
<g id="node347" class="node">
<title>layer68_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-15676.33 240.6,-15676.33 240.6,-15608.33 667.6,-15608.33 667.6,-15676.33"/>
<text text-anchor="middle" x="454.1" y="-15661.13" font-family="Times,serif" font-size="14.00">Layer 68 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-15646.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15631.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-15616.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer67_moe&#45;&gt;layer68_qkv_proj -->
<g id="edge347" class="edge">
<title>layer67_moe&#45;&gt;layer68_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-15712.22C454.1,-15704.11 454.1,-15695.32 454.1,-15686.81"/>
<polygon fill="black" stroke="black" points="457.6,-15686.63 454.1,-15676.63 450.6,-15686.63 457.6,-15686.63"/>
</g>
<!-- layer68_attn_comp -->
<g id="node348" class="node">
<title>layer68_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-15572.33 240.6,-15572.33 240.6,-15504.33 667.6,-15504.33 667.6,-15572.33"/>
<text text-anchor="middle" x="454.1" y="-15557.13" font-family="Times,serif" font-size="14.00">Layer 68 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-15542.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15527.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-15512.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer68_qkv_proj&#45;&gt;layer68_attn_comp -->
<g id="edge348" class="edge">
<title>layer68_qkv_proj&#45;&gt;layer68_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-15608.22C454.1,-15600.11 454.1,-15591.32 454.1,-15582.81"/>
<polygon fill="black" stroke="black" points="457.6,-15582.63 454.1,-15572.63 450.6,-15582.63 457.6,-15582.63"/>
</g>
<!-- layer68_out_proj -->
<g id="node349" class="node">
<title>layer68_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-15468.33 246.6,-15468.33 246.6,-15400.33 661.6,-15400.33 661.6,-15468.33"/>
<text text-anchor="middle" x="454.1" y="-15453.13" font-family="Times,serif" font-size="14.00">Layer 68 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-15438.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15423.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-15408.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer68_attn_comp&#45;&gt;layer68_out_proj -->
<g id="edge349" class="edge">
<title>layer68_attn_comp&#45;&gt;layer68_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-15504.22C454.1,-15496.11 454.1,-15487.32 454.1,-15478.81"/>
<polygon fill="black" stroke="black" points="457.6,-15478.63 454.1,-15468.63 450.6,-15478.63 457.6,-15478.63"/>
</g>
<!-- layer68_gate -->
<g id="node350" class="node">
<title>layer68_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-15364.33 216.93,-15364.33 52.65,-15228.33 691.26,-15228.33 855.54,-15364.33"/>
<text text-anchor="middle" x="454.1" y="-15315.13" font-family="Times,serif" font-size="14.00">Layer 68 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-15300.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15285.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-15270.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer68_out_proj&#45;&gt;layer68_gate -->
<g id="edge350" class="edge">
<title>layer68_out_proj&#45;&gt;layer68_gate</title>
<path fill="none" stroke="black" d="M454.1,-15400.06C454.1,-15392.24 454.1,-15383.57 454.1,-15374.69"/>
<polygon fill="black" stroke="black" points="457.6,-15374.6 454.1,-15364.6 450.6,-15374.6 457.6,-15374.6"/>
</g>
<!-- layer68_moe -->
<g id="node351" class="node">
<title>layer68_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-15192.33 254.6,-15192.33 254.6,-15124.33 653.6,-15124.33 653.6,-15192.33"/>
<text text-anchor="middle" x="454.1" y="-15177.13" font-family="Times,serif" font-size="14.00">Layer 68 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-15162.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15147.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-15132.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer68_gate&#45;&gt;layer68_moe -->
<g id="edge351" class="edge">
<title>layer68_gate&#45;&gt;layer68_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-15228.13C454.1,-15219.38 454.1,-15210.61 454.1,-15202.4"/>
<polygon fill="black" stroke="black" points="457.6,-15202.35 454.1,-15192.35 450.6,-15202.35 457.6,-15202.35"/>
</g>
<!-- layer69_qkv_proj -->
<g id="node352" class="node">
<title>layer69_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-15088.33 240.6,-15088.33 240.6,-15020.33 667.6,-15020.33 667.6,-15088.33"/>
<text text-anchor="middle" x="454.1" y="-15073.13" font-family="Times,serif" font-size="14.00">Layer 69 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-15058.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-15043.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-15028.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer68_moe&#45;&gt;layer69_qkv_proj -->
<g id="edge352" class="edge">
<title>layer68_moe&#45;&gt;layer69_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-15124.22C454.1,-15116.11 454.1,-15107.32 454.1,-15098.81"/>
<polygon fill="black" stroke="black" points="457.6,-15098.63 454.1,-15088.63 450.6,-15098.63 457.6,-15098.63"/>
</g>
<!-- layer69_attn_comp -->
<g id="node353" class="node">
<title>layer69_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-14984.33 240.6,-14984.33 240.6,-14916.33 667.6,-14916.33 667.6,-14984.33"/>
<text text-anchor="middle" x="454.1" y="-14969.13" font-family="Times,serif" font-size="14.00">Layer 69 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-14954.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14939.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-14924.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer69_qkv_proj&#45;&gt;layer69_attn_comp -->
<g id="edge353" class="edge">
<title>layer69_qkv_proj&#45;&gt;layer69_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-15020.22C454.1,-15012.11 454.1,-15003.32 454.1,-14994.81"/>
<polygon fill="black" stroke="black" points="457.6,-14994.63 454.1,-14984.63 450.6,-14994.63 457.6,-14994.63"/>
</g>
<!-- layer69_out_proj -->
<g id="node354" class="node">
<title>layer69_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-14880.33 246.6,-14880.33 246.6,-14812.33 661.6,-14812.33 661.6,-14880.33"/>
<text text-anchor="middle" x="454.1" y="-14865.13" font-family="Times,serif" font-size="14.00">Layer 69 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-14850.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14835.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-14820.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer69_attn_comp&#45;&gt;layer69_out_proj -->
<g id="edge354" class="edge">
<title>layer69_attn_comp&#45;&gt;layer69_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-14916.22C454.1,-14908.11 454.1,-14899.32 454.1,-14890.81"/>
<polygon fill="black" stroke="black" points="457.6,-14890.63 454.1,-14880.63 450.6,-14890.63 457.6,-14890.63"/>
</g>
<!-- layer69_gate -->
<g id="node355" class="node">
<title>layer69_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-14776.33 216.93,-14776.33 52.65,-14640.33 691.26,-14640.33 855.54,-14776.33"/>
<text text-anchor="middle" x="454.1" y="-14727.13" font-family="Times,serif" font-size="14.00">Layer 69 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-14712.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14697.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-14682.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer69_out_proj&#45;&gt;layer69_gate -->
<g id="edge355" class="edge">
<title>layer69_out_proj&#45;&gt;layer69_gate</title>
<path fill="none" stroke="black" d="M454.1,-14812.06C454.1,-14804.24 454.1,-14795.57 454.1,-14786.69"/>
<polygon fill="black" stroke="black" points="457.6,-14786.6 454.1,-14776.6 450.6,-14786.6 457.6,-14786.6"/>
</g>
<!-- layer69_moe -->
<g id="node356" class="node">
<title>layer69_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-14604.33 254.6,-14604.33 254.6,-14536.33 653.6,-14536.33 653.6,-14604.33"/>
<text text-anchor="middle" x="454.1" y="-14589.13" font-family="Times,serif" font-size="14.00">Layer 69 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-14574.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14559.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-14544.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer69_gate&#45;&gt;layer69_moe -->
<g id="edge356" class="edge">
<title>layer69_gate&#45;&gt;layer69_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-14640.13C454.1,-14631.38 454.1,-14622.61 454.1,-14614.4"/>
<polygon fill="black" stroke="black" points="457.6,-14614.35 454.1,-14604.35 450.6,-14614.35 457.6,-14614.35"/>
</g>
<!-- layer70_qkv_proj -->
<g id="node357" class="node">
<title>layer70_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-14500.33 240.6,-14500.33 240.6,-14432.33 667.6,-14432.33 667.6,-14500.33"/>
<text text-anchor="middle" x="454.1" y="-14485.13" font-family="Times,serif" font-size="14.00">Layer 70 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-14470.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14455.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-14440.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer69_moe&#45;&gt;layer70_qkv_proj -->
<g id="edge357" class="edge">
<title>layer69_moe&#45;&gt;layer70_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-14536.22C454.1,-14528.11 454.1,-14519.32 454.1,-14510.81"/>
<polygon fill="black" stroke="black" points="457.6,-14510.63 454.1,-14500.63 450.6,-14510.63 457.6,-14510.63"/>
</g>
<!-- layer70_attn_comp -->
<g id="node358" class="node">
<title>layer70_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-14396.33 240.6,-14396.33 240.6,-14328.33 667.6,-14328.33 667.6,-14396.33"/>
<text text-anchor="middle" x="454.1" y="-14381.13" font-family="Times,serif" font-size="14.00">Layer 70 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-14366.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14351.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-14336.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer70_qkv_proj&#45;&gt;layer70_attn_comp -->
<g id="edge358" class="edge">
<title>layer70_qkv_proj&#45;&gt;layer70_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-14432.22C454.1,-14424.11 454.1,-14415.32 454.1,-14406.81"/>
<polygon fill="black" stroke="black" points="457.6,-14406.63 454.1,-14396.63 450.6,-14406.63 457.6,-14406.63"/>
</g>
<!-- layer70_out_proj -->
<g id="node359" class="node">
<title>layer70_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-14292.33 246.6,-14292.33 246.6,-14224.33 661.6,-14224.33 661.6,-14292.33"/>
<text text-anchor="middle" x="454.1" y="-14277.13" font-family="Times,serif" font-size="14.00">Layer 70 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-14262.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14247.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-14232.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer70_attn_comp&#45;&gt;layer70_out_proj -->
<g id="edge359" class="edge">
<title>layer70_attn_comp&#45;&gt;layer70_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-14328.22C454.1,-14320.11 454.1,-14311.32 454.1,-14302.81"/>
<polygon fill="black" stroke="black" points="457.6,-14302.63 454.1,-14292.63 450.6,-14302.63 457.6,-14302.63"/>
</g>
<!-- layer70_gate -->
<g id="node360" class="node">
<title>layer70_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-14188.33 216.93,-14188.33 52.65,-14052.33 691.26,-14052.33 855.54,-14188.33"/>
<text text-anchor="middle" x="454.1" y="-14139.13" font-family="Times,serif" font-size="14.00">Layer 70 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-14124.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-14109.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-14094.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer70_out_proj&#45;&gt;layer70_gate -->
<g id="edge360" class="edge">
<title>layer70_out_proj&#45;&gt;layer70_gate</title>
<path fill="none" stroke="black" d="M454.1,-14224.06C454.1,-14216.24 454.1,-14207.57 454.1,-14198.69"/>
<polygon fill="black" stroke="black" points="457.6,-14198.6 454.1,-14188.6 450.6,-14198.6 457.6,-14198.6"/>
</g>
<!-- layer70_moe -->
<g id="node361" class="node">
<title>layer70_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-14016.33 254.6,-14016.33 254.6,-13948.33 653.6,-13948.33 653.6,-14016.33"/>
<text text-anchor="middle" x="454.1" y="-14001.13" font-family="Times,serif" font-size="14.00">Layer 70 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-13986.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-13971.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-13956.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer70_gate&#45;&gt;layer70_moe -->
<g id="edge361" class="edge">
<title>layer70_gate&#45;&gt;layer70_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-14052.13C454.1,-14043.38 454.1,-14034.61 454.1,-14026.4"/>
<polygon fill="black" stroke="black" points="457.6,-14026.35 454.1,-14016.35 450.6,-14026.35 457.6,-14026.35"/>
</g>
<!-- layer71_qkv_proj -->
<g id="node362" class="node">
<title>layer71_qkv_proj</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-13912.33 240.6,-13912.33 240.6,-13844.33 667.6,-13844.33 667.6,-13912.33"/>
<text text-anchor="middle" x="454.1" y="-13897.13" font-family="Times,serif" font-size="14.00">Layer 71 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-13882.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-13867.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-13852.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer70_moe&#45;&gt;layer71_qkv_proj -->
<g id="edge362" class="edge">
<title>layer70_moe&#45;&gt;layer71_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-13948.22C454.1,-13940.11 454.1,-13931.32 454.1,-13922.81"/>
<polygon fill="black" stroke="black" points="457.6,-13922.63 454.1,-13912.63 450.6,-13922.63 457.6,-13922.63"/>
</g>
<!-- layer71_attn_comp -->
<g id="node363" class="node">
<title>layer71_attn_comp</title>
<polygon fill="lightyellow" stroke="black" points="667.6,-13808.33 240.6,-13808.33 240.6,-13740.33 667.6,-13740.33 667.6,-13808.33"/>
<text text-anchor="middle" x="454.1" y="-13793.13" font-family="Times,serif" font-size="14.00">Layer 71 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-13778.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-13763.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-13748.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer71_qkv_proj&#45;&gt;layer71_attn_comp -->
<g id="edge363" class="edge">
<title>layer71_qkv_proj&#45;&gt;layer71_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-13844.22C454.1,-13836.11 454.1,-13827.32 454.1,-13818.81"/>
<polygon fill="black" stroke="black" points="457.6,-13818.63 454.1,-13808.63 450.6,-13818.63 457.6,-13818.63"/>
</g>
<!-- layer71_out_proj -->
<g id="node364" class="node">
<title>layer71_out_proj</title>
<polygon fill="lightyellow" stroke="black" points="661.6,-13704.33 246.6,-13704.33 246.6,-13636.33 661.6,-13636.33 661.6,-13704.33"/>
<text text-anchor="middle" x="454.1" y="-13689.13" font-family="Times,serif" font-size="14.00">Layer 71 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-13674.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-13659.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-13644.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer71_attn_comp&#45;&gt;layer71_out_proj -->
<g id="edge364" class="edge">
<title>layer71_attn_comp&#45;&gt;layer71_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-13740.22C454.1,-13732.11 454.1,-13723.32 454.1,-13714.81"/>
<polygon fill="black" stroke="black" points="457.6,-13714.63 454.1,-13704.63 450.6,-13714.63 457.6,-13714.63"/>
</g>
<!-- layer71_gate -->
<g id="node365" class="node">
<title>layer71_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-13600.33 216.93,-13600.33 52.65,-13464.33 691.26,-13464.33 855.54,-13600.33"/>
<text text-anchor="middle" x="454.1" y="-13551.13" font-family="Times,serif" font-size="14.00">Layer 71 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-13536.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-13521.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-13506.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer71_out_proj&#45;&gt;layer71_gate -->
<g id="edge365" class="edge">
<title>layer71_out_proj&#45;&gt;layer71_gate</title>
<path fill="none" stroke="black" d="M454.1,-13636.06C454.1,-13628.24 454.1,-13619.57 454.1,-13610.69"/>
<polygon fill="black" stroke="black" points="457.6,-13610.6 454.1,-13600.6 450.6,-13610.6 457.6,-13610.6"/>
</g>
<!-- layer71_moe -->
<g id="node366" class="node">
<title>layer71_moe</title>
<polygon fill="lightyellow" stroke="black" points="653.6,-13428.33 254.6,-13428.33 254.6,-13360.33 653.6,-13360.33 653.6,-13428.33"/>
<text text-anchor="middle" x="454.1" y="-13413.13" font-family="Times,serif" font-size="14.00">Layer 71 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-13398.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="454.1" y="-13383.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-13368.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer71_gate&#45;&gt;layer71_moe -->
<g id="edge366" class="edge">
<title>layer71_gate&#45;&gt;layer71_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-13464.13C454.1,-13455.38 454.1,-13446.61 454.1,-13438.4"/>
<polygon fill="black" stroke="black" points="457.6,-13438.35 454.1,-13428.35 450.6,-13438.35 457.6,-13438.35"/>
</g>
<!-- comm_2_3 -->
<g id="node368" class="node">
<title>comm_2_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="454.1" cy="-13276.25" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="454.1" y="-13295.05" font-family="Times,serif" font-size="14.00">Pipeline Communication (Single Token)</text>
<text text-anchor="middle" x="454.1" y="-13280.05" font-family="Times,serif" font-size="14.00">GPUs: 18&#45;26  27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-13265.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-13250.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer71_moe&#45;&gt;comm_2_3 -->
<g id="edge367" class="edge">
<title>layer71_moe&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M454.1,-13360.07C454.1,-13352.07 454.1,-13343.31 454.1,-13334.57"/>
<polygon fill="black" stroke="black" points="457.6,-13334.36 454.1,-13324.36 450.6,-13334.36 457.6,-13334.36"/>
</g>
<!-- kv_access_2&#45;&gt;layer48_qkv_proj -->
<g id="edge247" class="edge">
<title>kv_access_2&#45;&gt;layer48_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-27490.18C454.1,-27475.81 454.1,-27460.39 454.1,-27446.59"/>
<polygon fill="black" stroke="black" points="457.6,-27446.4 454.1,-27436.4 450.6,-27446.4 457.6,-27446.4"/>
</g>
<!-- kv_access_3 -->
<g id="node479" class="node">
<title>kv_access_3</title>
<polygon fill="lightcyan" stroke="black" points="908.29,-13192.17 185.77,-13192.17 -0.1,-13086.17 722.43,-13086.17 908.29,-13192.17"/>
<text text-anchor="middle" x="454.1" y="-13150.47" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="454.1" y="-13135.47" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-13120.47" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- comm_2_3&#45;&gt;kv_access_3 -->
<g id="edge368" class="edge">
<title>comm_2_3&#45;&gt;kv_access_3</title>
<path fill="none" stroke="black" d="M454.1,-13228C454.1,-13219.69 454.1,-13210.93 454.1,-13202.28"/>
<polygon fill="black" stroke="black" points="457.6,-13202.22 454.1,-13192.22 450.6,-13202.22 457.6,-13202.22"/>
</g>
<!-- layer72_qkv_proj -->
<g id="node369" class="node">
<title>layer72_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-13032.17 240.6,-13032.17 240.6,-12964.17 667.6,-12964.17 667.6,-13032.17"/>
<text text-anchor="middle" x="454.1" y="-13016.97" font-family="Times,serif" font-size="14.00">Layer 72 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-13001.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12986.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-12971.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer72_attn_comp -->
<g id="node370" class="node">
<title>layer72_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-12928.17 240.6,-12928.17 240.6,-12860.17 667.6,-12860.17 667.6,-12928.17"/>
<text text-anchor="middle" x="454.1" y="-12912.97" font-family="Times,serif" font-size="14.00">Layer 72 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-12897.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12882.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-12867.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer72_qkv_proj&#45;&gt;layer72_attn_comp -->
<g id="edge370" class="edge">
<title>layer72_qkv_proj&#45;&gt;layer72_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-12964.05C454.1,-12955.94 454.1,-12947.15 454.1,-12938.64"/>
<polygon fill="black" stroke="black" points="457.6,-12938.47 454.1,-12928.47 450.6,-12938.47 457.6,-12938.47"/>
</g>
<!-- layer72_out_proj -->
<g id="node371" class="node">
<title>layer72_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-12824.17 246.6,-12824.17 246.6,-12756.17 661.6,-12756.17 661.6,-12824.17"/>
<text text-anchor="middle" x="454.1" y="-12808.97" font-family="Times,serif" font-size="14.00">Layer 72 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-12793.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12778.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-12763.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer72_attn_comp&#45;&gt;layer72_out_proj -->
<g id="edge371" class="edge">
<title>layer72_attn_comp&#45;&gt;layer72_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-12860.05C454.1,-12851.94 454.1,-12843.15 454.1,-12834.64"/>
<polygon fill="black" stroke="black" points="457.6,-12834.47 454.1,-12824.47 450.6,-12834.47 457.6,-12834.47"/>
</g>
<!-- layer72_gate -->
<g id="node372" class="node">
<title>layer72_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-12720.17 216.93,-12720.17 52.65,-12584.17 691.26,-12584.17 855.54,-12720.17"/>
<text text-anchor="middle" x="454.1" y="-12670.97" font-family="Times,serif" font-size="14.00">Layer 72 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-12655.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12640.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-12625.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer72_out_proj&#45;&gt;layer72_gate -->
<g id="edge372" class="edge">
<title>layer72_out_proj&#45;&gt;layer72_gate</title>
<path fill="none" stroke="black" d="M454.1,-12755.9C454.1,-12748.07 454.1,-12739.4 454.1,-12730.52"/>
<polygon fill="black" stroke="black" points="457.6,-12730.43 454.1,-12720.43 450.6,-12730.43 457.6,-12730.43"/>
</g>
<!-- layer72_moe -->
<g id="node373" class="node">
<title>layer72_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-12548.17 254.6,-12548.17 254.6,-12480.17 653.6,-12480.17 653.6,-12548.17"/>
<text text-anchor="middle" x="454.1" y="-12532.97" font-family="Times,serif" font-size="14.00">Layer 72 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-12517.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12502.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-12487.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer72_gate&#45;&gt;layer72_moe -->
<g id="edge373" class="edge">
<title>layer72_gate&#45;&gt;layer72_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-12583.96C454.1,-12575.21 454.1,-12566.44 454.1,-12558.23"/>
<polygon fill="black" stroke="black" points="457.6,-12558.18 454.1,-12548.18 450.6,-12558.18 457.6,-12558.18"/>
</g>
<!-- layer73_qkv_proj -->
<g id="node374" class="node">
<title>layer73_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-12444.17 240.6,-12444.17 240.6,-12376.17 667.6,-12376.17 667.6,-12444.17"/>
<text text-anchor="middle" x="454.1" y="-12428.97" font-family="Times,serif" font-size="14.00">Layer 73 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-12413.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12398.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-12383.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer72_moe&#45;&gt;layer73_qkv_proj -->
<g id="edge374" class="edge">
<title>layer72_moe&#45;&gt;layer73_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-12480.05C454.1,-12471.94 454.1,-12463.15 454.1,-12454.64"/>
<polygon fill="black" stroke="black" points="457.6,-12454.47 454.1,-12444.47 450.6,-12454.47 457.6,-12454.47"/>
</g>
<!-- layer73_attn_comp -->
<g id="node375" class="node">
<title>layer73_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-12340.17 240.6,-12340.17 240.6,-12272.17 667.6,-12272.17 667.6,-12340.17"/>
<text text-anchor="middle" x="454.1" y="-12324.97" font-family="Times,serif" font-size="14.00">Layer 73 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-12309.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12294.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-12279.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer73_qkv_proj&#45;&gt;layer73_attn_comp -->
<g id="edge375" class="edge">
<title>layer73_qkv_proj&#45;&gt;layer73_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-12376.05C454.1,-12367.94 454.1,-12359.15 454.1,-12350.64"/>
<polygon fill="black" stroke="black" points="457.6,-12350.47 454.1,-12340.47 450.6,-12350.47 457.6,-12350.47"/>
</g>
<!-- layer73_out_proj -->
<g id="node376" class="node">
<title>layer73_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-12236.17 246.6,-12236.17 246.6,-12168.17 661.6,-12168.17 661.6,-12236.17"/>
<text text-anchor="middle" x="454.1" y="-12220.97" font-family="Times,serif" font-size="14.00">Layer 73 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-12205.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12190.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-12175.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer73_attn_comp&#45;&gt;layer73_out_proj -->
<g id="edge376" class="edge">
<title>layer73_attn_comp&#45;&gt;layer73_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-12272.05C454.1,-12263.94 454.1,-12255.15 454.1,-12246.64"/>
<polygon fill="black" stroke="black" points="457.6,-12246.47 454.1,-12236.47 450.6,-12246.47 457.6,-12246.47"/>
</g>
<!-- layer73_gate -->
<g id="node377" class="node">
<title>layer73_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-12132.17 216.93,-12132.17 52.65,-11996.17 691.26,-11996.17 855.54,-12132.17"/>
<text text-anchor="middle" x="454.1" y="-12082.97" font-family="Times,serif" font-size="14.00">Layer 73 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-12067.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-12052.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-12037.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer73_out_proj&#45;&gt;layer73_gate -->
<g id="edge377" class="edge">
<title>layer73_out_proj&#45;&gt;layer73_gate</title>
<path fill="none" stroke="black" d="M454.1,-12167.9C454.1,-12160.07 454.1,-12151.4 454.1,-12142.52"/>
<polygon fill="black" stroke="black" points="457.6,-12142.43 454.1,-12132.43 450.6,-12142.43 457.6,-12142.43"/>
</g>
<!-- layer73_moe -->
<g id="node378" class="node">
<title>layer73_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-11960.17 254.6,-11960.17 254.6,-11892.17 653.6,-11892.17 653.6,-11960.17"/>
<text text-anchor="middle" x="454.1" y="-11944.97" font-family="Times,serif" font-size="14.00">Layer 73 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-11929.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11914.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-11899.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer73_gate&#45;&gt;layer73_moe -->
<g id="edge378" class="edge">
<title>layer73_gate&#45;&gt;layer73_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-11995.96C454.1,-11987.21 454.1,-11978.44 454.1,-11970.23"/>
<polygon fill="black" stroke="black" points="457.6,-11970.18 454.1,-11960.18 450.6,-11970.18 457.6,-11970.18"/>
</g>
<!-- layer74_qkv_proj -->
<g id="node379" class="node">
<title>layer74_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-11856.17 240.6,-11856.17 240.6,-11788.17 667.6,-11788.17 667.6,-11856.17"/>
<text text-anchor="middle" x="454.1" y="-11840.97" font-family="Times,serif" font-size="14.00">Layer 74 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-11825.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11810.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-11795.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer73_moe&#45;&gt;layer74_qkv_proj -->
<g id="edge379" class="edge">
<title>layer73_moe&#45;&gt;layer74_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-11892.05C454.1,-11883.94 454.1,-11875.15 454.1,-11866.64"/>
<polygon fill="black" stroke="black" points="457.6,-11866.47 454.1,-11856.47 450.6,-11866.47 457.6,-11866.47"/>
</g>
<!-- layer74_attn_comp -->
<g id="node380" class="node">
<title>layer74_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-11752.17 240.6,-11752.17 240.6,-11684.17 667.6,-11684.17 667.6,-11752.17"/>
<text text-anchor="middle" x="454.1" y="-11736.97" font-family="Times,serif" font-size="14.00">Layer 74 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-11721.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11706.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-11691.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer74_qkv_proj&#45;&gt;layer74_attn_comp -->
<g id="edge380" class="edge">
<title>layer74_qkv_proj&#45;&gt;layer74_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-11788.05C454.1,-11779.94 454.1,-11771.15 454.1,-11762.64"/>
<polygon fill="black" stroke="black" points="457.6,-11762.47 454.1,-11752.47 450.6,-11762.47 457.6,-11762.47"/>
</g>
<!-- layer74_out_proj -->
<g id="node381" class="node">
<title>layer74_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-11648.17 246.6,-11648.17 246.6,-11580.17 661.6,-11580.17 661.6,-11648.17"/>
<text text-anchor="middle" x="454.1" y="-11632.97" font-family="Times,serif" font-size="14.00">Layer 74 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-11617.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11602.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-11587.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer74_attn_comp&#45;&gt;layer74_out_proj -->
<g id="edge381" class="edge">
<title>layer74_attn_comp&#45;&gt;layer74_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-11684.05C454.1,-11675.94 454.1,-11667.15 454.1,-11658.64"/>
<polygon fill="black" stroke="black" points="457.6,-11658.47 454.1,-11648.47 450.6,-11658.47 457.6,-11658.47"/>
</g>
<!-- layer74_gate -->
<g id="node382" class="node">
<title>layer74_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-11544.17 216.93,-11544.17 52.65,-11408.17 691.26,-11408.17 855.54,-11544.17"/>
<text text-anchor="middle" x="454.1" y="-11494.97" font-family="Times,serif" font-size="14.00">Layer 74 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-11479.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11464.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-11449.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer74_out_proj&#45;&gt;layer74_gate -->
<g id="edge382" class="edge">
<title>layer74_out_proj&#45;&gt;layer74_gate</title>
<path fill="none" stroke="black" d="M454.1,-11579.9C454.1,-11572.07 454.1,-11563.4 454.1,-11554.52"/>
<polygon fill="black" stroke="black" points="457.6,-11554.43 454.1,-11544.43 450.6,-11554.43 457.6,-11554.43"/>
</g>
<!-- layer74_moe -->
<g id="node383" class="node">
<title>layer74_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-11372.17 254.6,-11372.17 254.6,-11304.17 653.6,-11304.17 653.6,-11372.17"/>
<text text-anchor="middle" x="454.1" y="-11356.97" font-family="Times,serif" font-size="14.00">Layer 74 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-11341.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11326.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-11311.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer74_gate&#45;&gt;layer74_moe -->
<g id="edge383" class="edge">
<title>layer74_gate&#45;&gt;layer74_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-11407.96C454.1,-11399.21 454.1,-11390.44 454.1,-11382.23"/>
<polygon fill="black" stroke="black" points="457.6,-11382.18 454.1,-11372.18 450.6,-11382.18 457.6,-11382.18"/>
</g>
<!-- layer75_qkv_proj -->
<g id="node384" class="node">
<title>layer75_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-11268.17 240.6,-11268.17 240.6,-11200.17 667.6,-11200.17 667.6,-11268.17"/>
<text text-anchor="middle" x="454.1" y="-11252.97" font-family="Times,serif" font-size="14.00">Layer 75 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-11237.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11222.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-11207.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer74_moe&#45;&gt;layer75_qkv_proj -->
<g id="edge384" class="edge">
<title>layer74_moe&#45;&gt;layer75_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-11304.05C454.1,-11295.94 454.1,-11287.15 454.1,-11278.64"/>
<polygon fill="black" stroke="black" points="457.6,-11278.47 454.1,-11268.47 450.6,-11278.47 457.6,-11278.47"/>
</g>
<!-- layer75_attn_comp -->
<g id="node385" class="node">
<title>layer75_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-11164.17 240.6,-11164.17 240.6,-11096.17 667.6,-11096.17 667.6,-11164.17"/>
<text text-anchor="middle" x="454.1" y="-11148.97" font-family="Times,serif" font-size="14.00">Layer 75 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-11133.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11118.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-11103.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer75_qkv_proj&#45;&gt;layer75_attn_comp -->
<g id="edge385" class="edge">
<title>layer75_qkv_proj&#45;&gt;layer75_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-11200.05C454.1,-11191.94 454.1,-11183.15 454.1,-11174.64"/>
<polygon fill="black" stroke="black" points="457.6,-11174.47 454.1,-11164.47 450.6,-11174.47 457.6,-11174.47"/>
</g>
<!-- layer75_out_proj -->
<g id="node386" class="node">
<title>layer75_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-11060.17 246.6,-11060.17 246.6,-10992.17 661.6,-10992.17 661.6,-11060.17"/>
<text text-anchor="middle" x="454.1" y="-11044.97" font-family="Times,serif" font-size="14.00">Layer 75 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-11029.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-11014.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-10999.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer75_attn_comp&#45;&gt;layer75_out_proj -->
<g id="edge386" class="edge">
<title>layer75_attn_comp&#45;&gt;layer75_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-11096.05C454.1,-11087.94 454.1,-11079.15 454.1,-11070.64"/>
<polygon fill="black" stroke="black" points="457.6,-11070.47 454.1,-11060.47 450.6,-11070.47 457.6,-11070.47"/>
</g>
<!-- layer75_gate -->
<g id="node387" class="node">
<title>layer75_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-10956.17 216.93,-10956.17 52.65,-10820.17 691.26,-10820.17 855.54,-10956.17"/>
<text text-anchor="middle" x="454.1" y="-10906.97" font-family="Times,serif" font-size="14.00">Layer 75 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-10891.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10876.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-10861.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer75_out_proj&#45;&gt;layer75_gate -->
<g id="edge387" class="edge">
<title>layer75_out_proj&#45;&gt;layer75_gate</title>
<path fill="none" stroke="black" d="M454.1,-10991.9C454.1,-10984.07 454.1,-10975.4 454.1,-10966.52"/>
<polygon fill="black" stroke="black" points="457.6,-10966.43 454.1,-10956.43 450.6,-10966.43 457.6,-10966.43"/>
</g>
<!-- layer75_moe -->
<g id="node388" class="node">
<title>layer75_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-10784.17 254.6,-10784.17 254.6,-10716.17 653.6,-10716.17 653.6,-10784.17"/>
<text text-anchor="middle" x="454.1" y="-10768.97" font-family="Times,serif" font-size="14.00">Layer 75 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-10753.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10738.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-10723.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer75_gate&#45;&gt;layer75_moe -->
<g id="edge388" class="edge">
<title>layer75_gate&#45;&gt;layer75_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-10819.96C454.1,-10811.21 454.1,-10802.44 454.1,-10794.23"/>
<polygon fill="black" stroke="black" points="457.6,-10794.18 454.1,-10784.18 450.6,-10794.18 457.6,-10794.18"/>
</g>
<!-- layer76_qkv_proj -->
<g id="node389" class="node">
<title>layer76_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-10680.17 240.6,-10680.17 240.6,-10612.17 667.6,-10612.17 667.6,-10680.17"/>
<text text-anchor="middle" x="454.1" y="-10664.97" font-family="Times,serif" font-size="14.00">Layer 76 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-10649.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10634.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-10619.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer75_moe&#45;&gt;layer76_qkv_proj -->
<g id="edge389" class="edge">
<title>layer75_moe&#45;&gt;layer76_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-10716.05C454.1,-10707.94 454.1,-10699.15 454.1,-10690.64"/>
<polygon fill="black" stroke="black" points="457.6,-10690.47 454.1,-10680.47 450.6,-10690.47 457.6,-10690.47"/>
</g>
<!-- layer76_attn_comp -->
<g id="node390" class="node">
<title>layer76_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-10576.17 240.6,-10576.17 240.6,-10508.17 667.6,-10508.17 667.6,-10576.17"/>
<text text-anchor="middle" x="454.1" y="-10560.97" font-family="Times,serif" font-size="14.00">Layer 76 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-10545.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10530.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-10515.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer76_qkv_proj&#45;&gt;layer76_attn_comp -->
<g id="edge390" class="edge">
<title>layer76_qkv_proj&#45;&gt;layer76_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-10612.05C454.1,-10603.94 454.1,-10595.15 454.1,-10586.64"/>
<polygon fill="black" stroke="black" points="457.6,-10586.47 454.1,-10576.47 450.6,-10586.47 457.6,-10586.47"/>
</g>
<!-- layer76_out_proj -->
<g id="node391" class="node">
<title>layer76_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-10472.17 246.6,-10472.17 246.6,-10404.17 661.6,-10404.17 661.6,-10472.17"/>
<text text-anchor="middle" x="454.1" y="-10456.97" font-family="Times,serif" font-size="14.00">Layer 76 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-10441.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10426.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-10411.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer76_attn_comp&#45;&gt;layer76_out_proj -->
<g id="edge391" class="edge">
<title>layer76_attn_comp&#45;&gt;layer76_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-10508.05C454.1,-10499.94 454.1,-10491.15 454.1,-10482.64"/>
<polygon fill="black" stroke="black" points="457.6,-10482.47 454.1,-10472.47 450.6,-10482.47 457.6,-10482.47"/>
</g>
<!-- layer76_gate -->
<g id="node392" class="node">
<title>layer76_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-10368.17 216.93,-10368.17 52.65,-10232.17 691.26,-10232.17 855.54,-10368.17"/>
<text text-anchor="middle" x="454.1" y="-10318.97" font-family="Times,serif" font-size="14.00">Layer 76 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-10303.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10288.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-10273.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer76_out_proj&#45;&gt;layer76_gate -->
<g id="edge392" class="edge">
<title>layer76_out_proj&#45;&gt;layer76_gate</title>
<path fill="none" stroke="black" d="M454.1,-10403.9C454.1,-10396.07 454.1,-10387.4 454.1,-10378.52"/>
<polygon fill="black" stroke="black" points="457.6,-10378.43 454.1,-10368.43 450.6,-10378.43 457.6,-10378.43"/>
</g>
<!-- layer76_moe -->
<g id="node393" class="node">
<title>layer76_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-10196.17 254.6,-10196.17 254.6,-10128.17 653.6,-10128.17 653.6,-10196.17"/>
<text text-anchor="middle" x="454.1" y="-10180.97" font-family="Times,serif" font-size="14.00">Layer 76 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-10165.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10150.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-10135.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer76_gate&#45;&gt;layer76_moe -->
<g id="edge393" class="edge">
<title>layer76_gate&#45;&gt;layer76_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-10231.96C454.1,-10223.21 454.1,-10214.44 454.1,-10206.23"/>
<polygon fill="black" stroke="black" points="457.6,-10206.18 454.1,-10196.18 450.6,-10206.18 457.6,-10206.18"/>
</g>
<!-- layer77_qkv_proj -->
<g id="node394" class="node">
<title>layer77_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-10092.17 240.6,-10092.17 240.6,-10024.17 667.6,-10024.17 667.6,-10092.17"/>
<text text-anchor="middle" x="454.1" y="-10076.97" font-family="Times,serif" font-size="14.00">Layer 77 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-10061.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-10046.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-10031.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer76_moe&#45;&gt;layer77_qkv_proj -->
<g id="edge394" class="edge">
<title>layer76_moe&#45;&gt;layer77_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-10128.05C454.1,-10119.94 454.1,-10111.15 454.1,-10102.64"/>
<polygon fill="black" stroke="black" points="457.6,-10102.47 454.1,-10092.47 450.6,-10102.47 457.6,-10102.47"/>
</g>
<!-- layer77_attn_comp -->
<g id="node395" class="node">
<title>layer77_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-9988.17 240.6,-9988.17 240.6,-9920.17 667.6,-9920.17 667.6,-9988.17"/>
<text text-anchor="middle" x="454.1" y="-9972.97" font-family="Times,serif" font-size="14.00">Layer 77 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-9957.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9942.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-9927.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer77_qkv_proj&#45;&gt;layer77_attn_comp -->
<g id="edge395" class="edge">
<title>layer77_qkv_proj&#45;&gt;layer77_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-10024.05C454.1,-10015.94 454.1,-10007.15 454.1,-9998.64"/>
<polygon fill="black" stroke="black" points="457.6,-9998.47 454.1,-9988.47 450.6,-9998.47 457.6,-9998.47"/>
</g>
<!-- layer77_out_proj -->
<g id="node396" class="node">
<title>layer77_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-9884.17 246.6,-9884.17 246.6,-9816.17 661.6,-9816.17 661.6,-9884.17"/>
<text text-anchor="middle" x="454.1" y="-9868.97" font-family="Times,serif" font-size="14.00">Layer 77 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-9853.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9838.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-9823.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer77_attn_comp&#45;&gt;layer77_out_proj -->
<g id="edge396" class="edge">
<title>layer77_attn_comp&#45;&gt;layer77_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-9920.05C454.1,-9911.94 454.1,-9903.15 454.1,-9894.64"/>
<polygon fill="black" stroke="black" points="457.6,-9894.47 454.1,-9884.47 450.6,-9894.47 457.6,-9894.47"/>
</g>
<!-- layer77_gate -->
<g id="node397" class="node">
<title>layer77_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-9780.17 216.93,-9780.17 52.65,-9644.17 691.26,-9644.17 855.54,-9780.17"/>
<text text-anchor="middle" x="454.1" y="-9730.97" font-family="Times,serif" font-size="14.00">Layer 77 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-9715.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9700.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-9685.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer77_out_proj&#45;&gt;layer77_gate -->
<g id="edge397" class="edge">
<title>layer77_out_proj&#45;&gt;layer77_gate</title>
<path fill="none" stroke="black" d="M454.1,-9815.9C454.1,-9808.07 454.1,-9799.4 454.1,-9790.52"/>
<polygon fill="black" stroke="black" points="457.6,-9790.43 454.1,-9780.43 450.6,-9790.43 457.6,-9790.43"/>
</g>
<!-- layer77_moe -->
<g id="node398" class="node">
<title>layer77_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-9608.17 254.6,-9608.17 254.6,-9540.17 653.6,-9540.17 653.6,-9608.17"/>
<text text-anchor="middle" x="454.1" y="-9592.97" font-family="Times,serif" font-size="14.00">Layer 77 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-9577.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9562.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-9547.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer77_gate&#45;&gt;layer77_moe -->
<g id="edge398" class="edge">
<title>layer77_gate&#45;&gt;layer77_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-9643.96C454.1,-9635.21 454.1,-9626.44 454.1,-9618.23"/>
<polygon fill="black" stroke="black" points="457.6,-9618.18 454.1,-9608.18 450.6,-9618.18 457.6,-9618.18"/>
</g>
<!-- layer78_qkv_proj -->
<g id="node399" class="node">
<title>layer78_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-9504.17 240.6,-9504.17 240.6,-9436.17 667.6,-9436.17 667.6,-9504.17"/>
<text text-anchor="middle" x="454.1" y="-9488.97" font-family="Times,serif" font-size="14.00">Layer 78 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-9473.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9458.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-9443.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer77_moe&#45;&gt;layer78_qkv_proj -->
<g id="edge399" class="edge">
<title>layer77_moe&#45;&gt;layer78_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-9540.05C454.1,-9531.94 454.1,-9523.15 454.1,-9514.64"/>
<polygon fill="black" stroke="black" points="457.6,-9514.47 454.1,-9504.47 450.6,-9514.47 457.6,-9514.47"/>
</g>
<!-- layer78_attn_comp -->
<g id="node400" class="node">
<title>layer78_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-9400.17 240.6,-9400.17 240.6,-9332.17 667.6,-9332.17 667.6,-9400.17"/>
<text text-anchor="middle" x="454.1" y="-9384.97" font-family="Times,serif" font-size="14.00">Layer 78 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-9369.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9354.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-9339.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer78_qkv_proj&#45;&gt;layer78_attn_comp -->
<g id="edge400" class="edge">
<title>layer78_qkv_proj&#45;&gt;layer78_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-9436.05C454.1,-9427.94 454.1,-9419.15 454.1,-9410.64"/>
<polygon fill="black" stroke="black" points="457.6,-9410.47 454.1,-9400.47 450.6,-9410.47 457.6,-9410.47"/>
</g>
<!-- layer78_out_proj -->
<g id="node401" class="node">
<title>layer78_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-9296.17 246.6,-9296.17 246.6,-9228.17 661.6,-9228.17 661.6,-9296.17"/>
<text text-anchor="middle" x="454.1" y="-9280.97" font-family="Times,serif" font-size="14.00">Layer 78 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-9265.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9250.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-9235.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer78_attn_comp&#45;&gt;layer78_out_proj -->
<g id="edge401" class="edge">
<title>layer78_attn_comp&#45;&gt;layer78_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-9332.05C454.1,-9323.94 454.1,-9315.15 454.1,-9306.64"/>
<polygon fill="black" stroke="black" points="457.6,-9306.47 454.1,-9296.47 450.6,-9306.47 457.6,-9306.47"/>
</g>
<!-- layer78_gate -->
<g id="node402" class="node">
<title>layer78_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-9192.17 216.93,-9192.17 52.65,-9056.17 691.26,-9056.17 855.54,-9192.17"/>
<text text-anchor="middle" x="454.1" y="-9142.97" font-family="Times,serif" font-size="14.00">Layer 78 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-9127.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-9112.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-9097.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer78_out_proj&#45;&gt;layer78_gate -->
<g id="edge402" class="edge">
<title>layer78_out_proj&#45;&gt;layer78_gate</title>
<path fill="none" stroke="black" d="M454.1,-9227.9C454.1,-9220.07 454.1,-9211.4 454.1,-9202.52"/>
<polygon fill="black" stroke="black" points="457.6,-9202.43 454.1,-9192.43 450.6,-9202.43 457.6,-9202.43"/>
</g>
<!-- layer78_moe -->
<g id="node403" class="node">
<title>layer78_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-9020.17 254.6,-9020.17 254.6,-8952.17 653.6,-8952.17 653.6,-9020.17"/>
<text text-anchor="middle" x="454.1" y="-9004.97" font-family="Times,serif" font-size="14.00">Layer 78 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-8989.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8974.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-8959.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer78_gate&#45;&gt;layer78_moe -->
<g id="edge403" class="edge">
<title>layer78_gate&#45;&gt;layer78_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-9055.96C454.1,-9047.21 454.1,-9038.44 454.1,-9030.23"/>
<polygon fill="black" stroke="black" points="457.6,-9030.18 454.1,-9020.18 450.6,-9030.18 457.6,-9030.18"/>
</g>
<!-- layer79_qkv_proj -->
<g id="node404" class="node">
<title>layer79_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-8916.17 240.6,-8916.17 240.6,-8848.17 667.6,-8848.17 667.6,-8916.17"/>
<text text-anchor="middle" x="454.1" y="-8900.97" font-family="Times,serif" font-size="14.00">Layer 79 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-8885.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8870.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-8855.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer78_moe&#45;&gt;layer79_qkv_proj -->
<g id="edge404" class="edge">
<title>layer78_moe&#45;&gt;layer79_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-8952.05C454.1,-8943.94 454.1,-8935.15 454.1,-8926.64"/>
<polygon fill="black" stroke="black" points="457.6,-8926.47 454.1,-8916.47 450.6,-8926.47 457.6,-8926.47"/>
</g>
<!-- layer79_attn_comp -->
<g id="node405" class="node">
<title>layer79_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-8812.17 240.6,-8812.17 240.6,-8744.17 667.6,-8744.17 667.6,-8812.17"/>
<text text-anchor="middle" x="454.1" y="-8796.97" font-family="Times,serif" font-size="14.00">Layer 79 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-8781.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8766.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-8751.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer79_qkv_proj&#45;&gt;layer79_attn_comp -->
<g id="edge405" class="edge">
<title>layer79_qkv_proj&#45;&gt;layer79_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-8848.05C454.1,-8839.94 454.1,-8831.15 454.1,-8822.64"/>
<polygon fill="black" stroke="black" points="457.6,-8822.47 454.1,-8812.47 450.6,-8822.47 457.6,-8822.47"/>
</g>
<!-- layer79_out_proj -->
<g id="node406" class="node">
<title>layer79_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-8708.17 246.6,-8708.17 246.6,-8640.17 661.6,-8640.17 661.6,-8708.17"/>
<text text-anchor="middle" x="454.1" y="-8692.97" font-family="Times,serif" font-size="14.00">Layer 79 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-8677.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8662.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-8647.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer79_attn_comp&#45;&gt;layer79_out_proj -->
<g id="edge406" class="edge">
<title>layer79_attn_comp&#45;&gt;layer79_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-8744.05C454.1,-8735.94 454.1,-8727.15 454.1,-8718.64"/>
<polygon fill="black" stroke="black" points="457.6,-8718.47 454.1,-8708.47 450.6,-8718.47 457.6,-8718.47"/>
</g>
<!-- layer79_gate -->
<g id="node407" class="node">
<title>layer79_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-8604.17 216.93,-8604.17 52.65,-8468.17 691.26,-8468.17 855.54,-8604.17"/>
<text text-anchor="middle" x="454.1" y="-8554.97" font-family="Times,serif" font-size="14.00">Layer 79 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-8539.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8524.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-8509.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer79_out_proj&#45;&gt;layer79_gate -->
<g id="edge407" class="edge">
<title>layer79_out_proj&#45;&gt;layer79_gate</title>
<path fill="none" stroke="black" d="M454.1,-8639.9C454.1,-8632.07 454.1,-8623.4 454.1,-8614.52"/>
<polygon fill="black" stroke="black" points="457.6,-8614.43 454.1,-8604.43 450.6,-8614.43 457.6,-8614.43"/>
</g>
<!-- layer79_moe -->
<g id="node408" class="node">
<title>layer79_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-8432.17 254.6,-8432.17 254.6,-8364.17 653.6,-8364.17 653.6,-8432.17"/>
<text text-anchor="middle" x="454.1" y="-8416.97" font-family="Times,serif" font-size="14.00">Layer 79 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-8401.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8386.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-8371.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer79_gate&#45;&gt;layer79_moe -->
<g id="edge408" class="edge">
<title>layer79_gate&#45;&gt;layer79_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-8467.96C454.1,-8459.21 454.1,-8450.44 454.1,-8442.23"/>
<polygon fill="black" stroke="black" points="457.6,-8442.18 454.1,-8432.18 450.6,-8442.18 457.6,-8442.18"/>
</g>
<!-- layer80_qkv_proj -->
<g id="node409" class="node">
<title>layer80_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-8328.17 240.6,-8328.17 240.6,-8260.17 667.6,-8260.17 667.6,-8328.17"/>
<text text-anchor="middle" x="454.1" y="-8312.97" font-family="Times,serif" font-size="14.00">Layer 80 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-8297.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8282.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-8267.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer79_moe&#45;&gt;layer80_qkv_proj -->
<g id="edge409" class="edge">
<title>layer79_moe&#45;&gt;layer80_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-8364.05C454.1,-8355.94 454.1,-8347.15 454.1,-8338.64"/>
<polygon fill="black" stroke="black" points="457.6,-8338.47 454.1,-8328.47 450.6,-8338.47 457.6,-8338.47"/>
</g>
<!-- layer80_attn_comp -->
<g id="node410" class="node">
<title>layer80_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-8224.17 240.6,-8224.17 240.6,-8156.17 667.6,-8156.17 667.6,-8224.17"/>
<text text-anchor="middle" x="454.1" y="-8208.97" font-family="Times,serif" font-size="14.00">Layer 80 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-8193.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8178.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-8163.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer80_qkv_proj&#45;&gt;layer80_attn_comp -->
<g id="edge410" class="edge">
<title>layer80_qkv_proj&#45;&gt;layer80_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-8260.05C454.1,-8251.94 454.1,-8243.15 454.1,-8234.64"/>
<polygon fill="black" stroke="black" points="457.6,-8234.47 454.1,-8224.47 450.6,-8234.47 457.6,-8234.47"/>
</g>
<!-- layer80_out_proj -->
<g id="node411" class="node">
<title>layer80_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-8120.17 246.6,-8120.17 246.6,-8052.17 661.6,-8052.17 661.6,-8120.17"/>
<text text-anchor="middle" x="454.1" y="-8104.97" font-family="Times,serif" font-size="14.00">Layer 80 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-8089.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-8074.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-8059.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer80_attn_comp&#45;&gt;layer80_out_proj -->
<g id="edge411" class="edge">
<title>layer80_attn_comp&#45;&gt;layer80_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-8156.05C454.1,-8147.94 454.1,-8139.15 454.1,-8130.64"/>
<polygon fill="black" stroke="black" points="457.6,-8130.47 454.1,-8120.47 450.6,-8130.47 457.6,-8130.47"/>
</g>
<!-- layer80_gate -->
<g id="node412" class="node">
<title>layer80_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-8016.17 216.93,-8016.17 52.65,-7880.17 691.26,-7880.17 855.54,-8016.17"/>
<text text-anchor="middle" x="454.1" y="-7966.97" font-family="Times,serif" font-size="14.00">Layer 80 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-7951.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7936.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-7921.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer80_out_proj&#45;&gt;layer80_gate -->
<g id="edge412" class="edge">
<title>layer80_out_proj&#45;&gt;layer80_gate</title>
<path fill="none" stroke="black" d="M454.1,-8051.9C454.1,-8044.07 454.1,-8035.4 454.1,-8026.52"/>
<polygon fill="black" stroke="black" points="457.6,-8026.43 454.1,-8016.43 450.6,-8026.43 457.6,-8026.43"/>
</g>
<!-- layer80_moe -->
<g id="node413" class="node">
<title>layer80_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-7844.17 254.6,-7844.17 254.6,-7776.17 653.6,-7776.17 653.6,-7844.17"/>
<text text-anchor="middle" x="454.1" y="-7828.97" font-family="Times,serif" font-size="14.00">Layer 80 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-7813.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7798.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-7783.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer80_gate&#45;&gt;layer80_moe -->
<g id="edge413" class="edge">
<title>layer80_gate&#45;&gt;layer80_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-7879.96C454.1,-7871.21 454.1,-7862.44 454.1,-7854.23"/>
<polygon fill="black" stroke="black" points="457.6,-7854.18 454.1,-7844.18 450.6,-7854.18 457.6,-7854.18"/>
</g>
<!-- layer81_qkv_proj -->
<g id="node414" class="node">
<title>layer81_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-7740.17 240.6,-7740.17 240.6,-7672.17 667.6,-7672.17 667.6,-7740.17"/>
<text text-anchor="middle" x="454.1" y="-7724.97" font-family="Times,serif" font-size="14.00">Layer 81 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-7709.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7694.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-7679.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer80_moe&#45;&gt;layer81_qkv_proj -->
<g id="edge414" class="edge">
<title>layer80_moe&#45;&gt;layer81_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-7776.05C454.1,-7767.94 454.1,-7759.15 454.1,-7750.64"/>
<polygon fill="black" stroke="black" points="457.6,-7750.47 454.1,-7740.47 450.6,-7750.47 457.6,-7750.47"/>
</g>
<!-- layer81_attn_comp -->
<g id="node415" class="node">
<title>layer81_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-7636.17 240.6,-7636.17 240.6,-7568.17 667.6,-7568.17 667.6,-7636.17"/>
<text text-anchor="middle" x="454.1" y="-7620.97" font-family="Times,serif" font-size="14.00">Layer 81 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-7605.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7590.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-7575.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer81_qkv_proj&#45;&gt;layer81_attn_comp -->
<g id="edge415" class="edge">
<title>layer81_qkv_proj&#45;&gt;layer81_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-7672.05C454.1,-7663.94 454.1,-7655.15 454.1,-7646.64"/>
<polygon fill="black" stroke="black" points="457.6,-7646.47 454.1,-7636.47 450.6,-7646.47 457.6,-7646.47"/>
</g>
<!-- layer81_out_proj -->
<g id="node416" class="node">
<title>layer81_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-7532.17 246.6,-7532.17 246.6,-7464.17 661.6,-7464.17 661.6,-7532.17"/>
<text text-anchor="middle" x="454.1" y="-7516.97" font-family="Times,serif" font-size="14.00">Layer 81 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-7501.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7486.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-7471.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer81_attn_comp&#45;&gt;layer81_out_proj -->
<g id="edge416" class="edge">
<title>layer81_attn_comp&#45;&gt;layer81_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-7568.05C454.1,-7559.94 454.1,-7551.15 454.1,-7542.64"/>
<polygon fill="black" stroke="black" points="457.6,-7542.47 454.1,-7532.47 450.6,-7542.47 457.6,-7542.47"/>
</g>
<!-- layer81_gate -->
<g id="node417" class="node">
<title>layer81_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-7428.17 216.93,-7428.17 52.65,-7292.17 691.26,-7292.17 855.54,-7428.17"/>
<text text-anchor="middle" x="454.1" y="-7378.97" font-family="Times,serif" font-size="14.00">Layer 81 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-7363.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7348.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-7333.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer81_out_proj&#45;&gt;layer81_gate -->
<g id="edge417" class="edge">
<title>layer81_out_proj&#45;&gt;layer81_gate</title>
<path fill="none" stroke="black" d="M454.1,-7463.9C454.1,-7456.07 454.1,-7447.4 454.1,-7438.52"/>
<polygon fill="black" stroke="black" points="457.6,-7438.43 454.1,-7428.43 450.6,-7438.43 457.6,-7438.43"/>
</g>
<!-- layer81_moe -->
<g id="node418" class="node">
<title>layer81_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-7256.17 254.6,-7256.17 254.6,-7188.17 653.6,-7188.17 653.6,-7256.17"/>
<text text-anchor="middle" x="454.1" y="-7240.97" font-family="Times,serif" font-size="14.00">Layer 81 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-7225.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7210.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-7195.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer81_gate&#45;&gt;layer81_moe -->
<g id="edge418" class="edge">
<title>layer81_gate&#45;&gt;layer81_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-7291.96C454.1,-7283.21 454.1,-7274.44 454.1,-7266.23"/>
<polygon fill="black" stroke="black" points="457.6,-7266.18 454.1,-7256.18 450.6,-7266.18 457.6,-7266.18"/>
</g>
<!-- layer82_qkv_proj -->
<g id="node419" class="node">
<title>layer82_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-7152.17 240.6,-7152.17 240.6,-7084.17 667.6,-7084.17 667.6,-7152.17"/>
<text text-anchor="middle" x="454.1" y="-7136.97" font-family="Times,serif" font-size="14.00">Layer 82 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-7121.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7106.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-7091.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer81_moe&#45;&gt;layer82_qkv_proj -->
<g id="edge419" class="edge">
<title>layer81_moe&#45;&gt;layer82_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-7188.05C454.1,-7179.94 454.1,-7171.15 454.1,-7162.64"/>
<polygon fill="black" stroke="black" points="457.6,-7162.47 454.1,-7152.47 450.6,-7162.47 457.6,-7162.47"/>
</g>
<!-- layer82_attn_comp -->
<g id="node420" class="node">
<title>layer82_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-7048.17 240.6,-7048.17 240.6,-6980.17 667.6,-6980.17 667.6,-7048.17"/>
<text text-anchor="middle" x="454.1" y="-7032.97" font-family="Times,serif" font-size="14.00">Layer 82 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-7017.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-7002.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-6987.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer82_qkv_proj&#45;&gt;layer82_attn_comp -->
<g id="edge420" class="edge">
<title>layer82_qkv_proj&#45;&gt;layer82_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-7084.05C454.1,-7075.94 454.1,-7067.15 454.1,-7058.64"/>
<polygon fill="black" stroke="black" points="457.6,-7058.47 454.1,-7048.47 450.6,-7058.47 457.6,-7058.47"/>
</g>
<!-- layer82_out_proj -->
<g id="node421" class="node">
<title>layer82_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-6944.17 246.6,-6944.17 246.6,-6876.17 661.6,-6876.17 661.6,-6944.17"/>
<text text-anchor="middle" x="454.1" y="-6928.97" font-family="Times,serif" font-size="14.00">Layer 82 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-6913.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6898.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-6883.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer82_attn_comp&#45;&gt;layer82_out_proj -->
<g id="edge421" class="edge">
<title>layer82_attn_comp&#45;&gt;layer82_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-6980.05C454.1,-6971.94 454.1,-6963.15 454.1,-6954.64"/>
<polygon fill="black" stroke="black" points="457.6,-6954.47 454.1,-6944.47 450.6,-6954.47 457.6,-6954.47"/>
</g>
<!-- layer82_gate -->
<g id="node422" class="node">
<title>layer82_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-6840.17 216.93,-6840.17 52.65,-6704.17 691.26,-6704.17 855.54,-6840.17"/>
<text text-anchor="middle" x="454.1" y="-6790.97" font-family="Times,serif" font-size="14.00">Layer 82 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-6775.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6760.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-6745.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer82_out_proj&#45;&gt;layer82_gate -->
<g id="edge422" class="edge">
<title>layer82_out_proj&#45;&gt;layer82_gate</title>
<path fill="none" stroke="black" d="M454.1,-6875.9C454.1,-6868.07 454.1,-6859.4 454.1,-6850.52"/>
<polygon fill="black" stroke="black" points="457.6,-6850.43 454.1,-6840.43 450.6,-6850.43 457.6,-6850.43"/>
</g>
<!-- layer82_moe -->
<g id="node423" class="node">
<title>layer82_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-6668.17 254.6,-6668.17 254.6,-6600.17 653.6,-6600.17 653.6,-6668.17"/>
<text text-anchor="middle" x="454.1" y="-6652.97" font-family="Times,serif" font-size="14.00">Layer 82 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-6637.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6622.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-6607.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer82_gate&#45;&gt;layer82_moe -->
<g id="edge423" class="edge">
<title>layer82_gate&#45;&gt;layer82_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-6703.96C454.1,-6695.21 454.1,-6686.44 454.1,-6678.23"/>
<polygon fill="black" stroke="black" points="457.6,-6678.18 454.1,-6668.18 450.6,-6678.18 457.6,-6678.18"/>
</g>
<!-- layer83_qkv_proj -->
<g id="node424" class="node">
<title>layer83_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-6564.17 240.6,-6564.17 240.6,-6496.17 667.6,-6496.17 667.6,-6564.17"/>
<text text-anchor="middle" x="454.1" y="-6548.97" font-family="Times,serif" font-size="14.00">Layer 83 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-6533.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6518.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-6503.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer82_moe&#45;&gt;layer83_qkv_proj -->
<g id="edge424" class="edge">
<title>layer82_moe&#45;&gt;layer83_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-6600.05C454.1,-6591.94 454.1,-6583.15 454.1,-6574.64"/>
<polygon fill="black" stroke="black" points="457.6,-6574.47 454.1,-6564.47 450.6,-6574.47 457.6,-6574.47"/>
</g>
<!-- layer83_attn_comp -->
<g id="node425" class="node">
<title>layer83_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-6460.17 240.6,-6460.17 240.6,-6392.17 667.6,-6392.17 667.6,-6460.17"/>
<text text-anchor="middle" x="454.1" y="-6444.97" font-family="Times,serif" font-size="14.00">Layer 83 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-6429.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6414.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-6399.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer83_qkv_proj&#45;&gt;layer83_attn_comp -->
<g id="edge425" class="edge">
<title>layer83_qkv_proj&#45;&gt;layer83_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-6496.05C454.1,-6487.94 454.1,-6479.15 454.1,-6470.64"/>
<polygon fill="black" stroke="black" points="457.6,-6470.47 454.1,-6460.47 450.6,-6470.47 457.6,-6470.47"/>
</g>
<!-- layer83_out_proj -->
<g id="node426" class="node">
<title>layer83_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-6356.17 246.6,-6356.17 246.6,-6288.17 661.6,-6288.17 661.6,-6356.17"/>
<text text-anchor="middle" x="454.1" y="-6340.97" font-family="Times,serif" font-size="14.00">Layer 83 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-6325.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6310.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-6295.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer83_attn_comp&#45;&gt;layer83_out_proj -->
<g id="edge426" class="edge">
<title>layer83_attn_comp&#45;&gt;layer83_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-6392.05C454.1,-6383.94 454.1,-6375.15 454.1,-6366.64"/>
<polygon fill="black" stroke="black" points="457.6,-6366.47 454.1,-6356.47 450.6,-6366.47 457.6,-6366.47"/>
</g>
<!-- layer83_gate -->
<g id="node427" class="node">
<title>layer83_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-6252.17 216.93,-6252.17 52.65,-6116.17 691.26,-6116.17 855.54,-6252.17"/>
<text text-anchor="middle" x="454.1" y="-6202.97" font-family="Times,serif" font-size="14.00">Layer 83 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-6187.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6172.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-6157.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer83_out_proj&#45;&gt;layer83_gate -->
<g id="edge427" class="edge">
<title>layer83_out_proj&#45;&gt;layer83_gate</title>
<path fill="none" stroke="black" d="M454.1,-6287.9C454.1,-6280.07 454.1,-6271.4 454.1,-6262.52"/>
<polygon fill="black" stroke="black" points="457.6,-6262.43 454.1,-6252.43 450.6,-6262.43 457.6,-6262.43"/>
</g>
<!-- layer83_moe -->
<g id="node428" class="node">
<title>layer83_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-6080.17 254.6,-6080.17 254.6,-6012.17 653.6,-6012.17 653.6,-6080.17"/>
<text text-anchor="middle" x="454.1" y="-6064.97" font-family="Times,serif" font-size="14.00">Layer 83 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-6049.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-6034.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-6019.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer83_gate&#45;&gt;layer83_moe -->
<g id="edge428" class="edge">
<title>layer83_gate&#45;&gt;layer83_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-6115.96C454.1,-6107.21 454.1,-6098.44 454.1,-6090.23"/>
<polygon fill="black" stroke="black" points="457.6,-6090.18 454.1,-6080.18 450.6,-6090.18 457.6,-6090.18"/>
</g>
<!-- layer84_qkv_proj -->
<g id="node429" class="node">
<title>layer84_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-5976.17 240.6,-5976.17 240.6,-5908.17 667.6,-5908.17 667.6,-5976.17"/>
<text text-anchor="middle" x="454.1" y="-5960.97" font-family="Times,serif" font-size="14.00">Layer 84 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-5945.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5930.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-5915.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer83_moe&#45;&gt;layer84_qkv_proj -->
<g id="edge429" class="edge">
<title>layer83_moe&#45;&gt;layer84_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-6012.05C454.1,-6003.94 454.1,-5995.15 454.1,-5986.64"/>
<polygon fill="black" stroke="black" points="457.6,-5986.47 454.1,-5976.47 450.6,-5986.47 457.6,-5986.47"/>
</g>
<!-- layer84_attn_comp -->
<g id="node430" class="node">
<title>layer84_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-5872.17 240.6,-5872.17 240.6,-5804.17 667.6,-5804.17 667.6,-5872.17"/>
<text text-anchor="middle" x="454.1" y="-5856.97" font-family="Times,serif" font-size="14.00">Layer 84 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-5841.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5826.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-5811.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer84_qkv_proj&#45;&gt;layer84_attn_comp -->
<g id="edge430" class="edge">
<title>layer84_qkv_proj&#45;&gt;layer84_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-5908.05C454.1,-5899.94 454.1,-5891.15 454.1,-5882.64"/>
<polygon fill="black" stroke="black" points="457.6,-5882.47 454.1,-5872.47 450.6,-5882.47 457.6,-5882.47"/>
</g>
<!-- layer84_out_proj -->
<g id="node431" class="node">
<title>layer84_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-5768.17 246.6,-5768.17 246.6,-5700.17 661.6,-5700.17 661.6,-5768.17"/>
<text text-anchor="middle" x="454.1" y="-5752.97" font-family="Times,serif" font-size="14.00">Layer 84 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-5737.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5722.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-5707.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer84_attn_comp&#45;&gt;layer84_out_proj -->
<g id="edge431" class="edge">
<title>layer84_attn_comp&#45;&gt;layer84_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-5804.05C454.1,-5795.94 454.1,-5787.15 454.1,-5778.64"/>
<polygon fill="black" stroke="black" points="457.6,-5778.47 454.1,-5768.47 450.6,-5778.47 457.6,-5778.47"/>
</g>
<!-- layer84_gate -->
<g id="node432" class="node">
<title>layer84_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-5664.17 216.93,-5664.17 52.65,-5528.17 691.26,-5528.17 855.54,-5664.17"/>
<text text-anchor="middle" x="454.1" y="-5614.97" font-family="Times,serif" font-size="14.00">Layer 84 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-5599.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5584.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-5569.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer84_out_proj&#45;&gt;layer84_gate -->
<g id="edge432" class="edge">
<title>layer84_out_proj&#45;&gt;layer84_gate</title>
<path fill="none" stroke="black" d="M454.1,-5699.9C454.1,-5692.07 454.1,-5683.4 454.1,-5674.52"/>
<polygon fill="black" stroke="black" points="457.6,-5674.43 454.1,-5664.43 450.6,-5674.43 457.6,-5674.43"/>
</g>
<!-- layer84_moe -->
<g id="node433" class="node">
<title>layer84_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-5492.17 254.6,-5492.17 254.6,-5424.17 653.6,-5424.17 653.6,-5492.17"/>
<text text-anchor="middle" x="454.1" y="-5476.97" font-family="Times,serif" font-size="14.00">Layer 84 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-5461.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5446.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-5431.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer84_gate&#45;&gt;layer84_moe -->
<g id="edge433" class="edge">
<title>layer84_gate&#45;&gt;layer84_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-5527.96C454.1,-5519.21 454.1,-5510.44 454.1,-5502.23"/>
<polygon fill="black" stroke="black" points="457.6,-5502.18 454.1,-5492.18 450.6,-5502.18 457.6,-5502.18"/>
</g>
<!-- layer85_qkv_proj -->
<g id="node434" class="node">
<title>layer85_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-5388.17 240.6,-5388.17 240.6,-5320.17 667.6,-5320.17 667.6,-5388.17"/>
<text text-anchor="middle" x="454.1" y="-5372.97" font-family="Times,serif" font-size="14.00">Layer 85 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-5357.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5342.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-5327.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer84_moe&#45;&gt;layer85_qkv_proj -->
<g id="edge434" class="edge">
<title>layer84_moe&#45;&gt;layer85_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-5424.05C454.1,-5415.94 454.1,-5407.15 454.1,-5398.64"/>
<polygon fill="black" stroke="black" points="457.6,-5398.47 454.1,-5388.47 450.6,-5398.47 457.6,-5398.47"/>
</g>
<!-- layer85_attn_comp -->
<g id="node435" class="node">
<title>layer85_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-5284.17 240.6,-5284.17 240.6,-5216.17 667.6,-5216.17 667.6,-5284.17"/>
<text text-anchor="middle" x="454.1" y="-5268.97" font-family="Times,serif" font-size="14.00">Layer 85 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-5253.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5238.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-5223.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer85_qkv_proj&#45;&gt;layer85_attn_comp -->
<g id="edge435" class="edge">
<title>layer85_qkv_proj&#45;&gt;layer85_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-5320.05C454.1,-5311.94 454.1,-5303.15 454.1,-5294.64"/>
<polygon fill="black" stroke="black" points="457.6,-5294.47 454.1,-5284.47 450.6,-5294.47 457.6,-5294.47"/>
</g>
<!-- layer85_out_proj -->
<g id="node436" class="node">
<title>layer85_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-5180.17 246.6,-5180.17 246.6,-5112.17 661.6,-5112.17 661.6,-5180.17"/>
<text text-anchor="middle" x="454.1" y="-5164.97" font-family="Times,serif" font-size="14.00">Layer 85 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-5149.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-5134.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-5119.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer85_attn_comp&#45;&gt;layer85_out_proj -->
<g id="edge436" class="edge">
<title>layer85_attn_comp&#45;&gt;layer85_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-5216.05C454.1,-5207.94 454.1,-5199.15 454.1,-5190.64"/>
<polygon fill="black" stroke="black" points="457.6,-5190.47 454.1,-5180.47 450.6,-5190.47 457.6,-5190.47"/>
</g>
<!-- layer85_gate -->
<g id="node437" class="node">
<title>layer85_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-5076.17 216.93,-5076.17 52.65,-4940.17 691.26,-4940.17 855.54,-5076.17"/>
<text text-anchor="middle" x="454.1" y="-5026.97" font-family="Times,serif" font-size="14.00">Layer 85 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-5011.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4996.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-4981.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer85_out_proj&#45;&gt;layer85_gate -->
<g id="edge437" class="edge">
<title>layer85_out_proj&#45;&gt;layer85_gate</title>
<path fill="none" stroke="black" d="M454.1,-5111.9C454.1,-5104.07 454.1,-5095.4 454.1,-5086.52"/>
<polygon fill="black" stroke="black" points="457.6,-5086.43 454.1,-5076.43 450.6,-5086.43 457.6,-5086.43"/>
</g>
<!-- layer85_moe -->
<g id="node438" class="node">
<title>layer85_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-4904.17 254.6,-4904.17 254.6,-4836.17 653.6,-4836.17 653.6,-4904.17"/>
<text text-anchor="middle" x="454.1" y="-4888.97" font-family="Times,serif" font-size="14.00">Layer 85 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-4873.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4858.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-4843.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer85_gate&#45;&gt;layer85_moe -->
<g id="edge438" class="edge">
<title>layer85_gate&#45;&gt;layer85_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-4939.96C454.1,-4931.21 454.1,-4922.44 454.1,-4914.23"/>
<polygon fill="black" stroke="black" points="457.6,-4914.18 454.1,-4904.18 450.6,-4914.18 457.6,-4914.18"/>
</g>
<!-- layer86_qkv_proj -->
<g id="node439" class="node">
<title>layer86_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-4800.17 240.6,-4800.17 240.6,-4732.17 667.6,-4732.17 667.6,-4800.17"/>
<text text-anchor="middle" x="454.1" y="-4784.97" font-family="Times,serif" font-size="14.00">Layer 86 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-4769.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4754.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-4739.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer85_moe&#45;&gt;layer86_qkv_proj -->
<g id="edge439" class="edge">
<title>layer85_moe&#45;&gt;layer86_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-4836.05C454.1,-4827.94 454.1,-4819.15 454.1,-4810.64"/>
<polygon fill="black" stroke="black" points="457.6,-4810.47 454.1,-4800.47 450.6,-4810.47 457.6,-4810.47"/>
</g>
<!-- layer86_attn_comp -->
<g id="node440" class="node">
<title>layer86_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-4696.17 240.6,-4696.17 240.6,-4628.17 667.6,-4628.17 667.6,-4696.17"/>
<text text-anchor="middle" x="454.1" y="-4680.97" font-family="Times,serif" font-size="14.00">Layer 86 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-4665.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4650.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-4635.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer86_qkv_proj&#45;&gt;layer86_attn_comp -->
<g id="edge440" class="edge">
<title>layer86_qkv_proj&#45;&gt;layer86_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-4732.05C454.1,-4723.94 454.1,-4715.15 454.1,-4706.64"/>
<polygon fill="black" stroke="black" points="457.6,-4706.47 454.1,-4696.47 450.6,-4706.47 457.6,-4706.47"/>
</g>
<!-- layer86_out_proj -->
<g id="node441" class="node">
<title>layer86_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-4592.17 246.6,-4592.17 246.6,-4524.17 661.6,-4524.17 661.6,-4592.17"/>
<text text-anchor="middle" x="454.1" y="-4576.97" font-family="Times,serif" font-size="14.00">Layer 86 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-4561.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4546.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-4531.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer86_attn_comp&#45;&gt;layer86_out_proj -->
<g id="edge441" class="edge">
<title>layer86_attn_comp&#45;&gt;layer86_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-4628.05C454.1,-4619.94 454.1,-4611.15 454.1,-4602.64"/>
<polygon fill="black" stroke="black" points="457.6,-4602.47 454.1,-4592.47 450.6,-4602.47 457.6,-4602.47"/>
</g>
<!-- layer86_gate -->
<g id="node442" class="node">
<title>layer86_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-4488.17 216.93,-4488.17 52.65,-4352.17 691.26,-4352.17 855.54,-4488.17"/>
<text text-anchor="middle" x="454.1" y="-4438.97" font-family="Times,serif" font-size="14.00">Layer 86 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-4423.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4408.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-4393.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer86_out_proj&#45;&gt;layer86_gate -->
<g id="edge442" class="edge">
<title>layer86_out_proj&#45;&gt;layer86_gate</title>
<path fill="none" stroke="black" d="M454.1,-4523.9C454.1,-4516.07 454.1,-4507.4 454.1,-4498.52"/>
<polygon fill="black" stroke="black" points="457.6,-4498.43 454.1,-4488.43 450.6,-4498.43 457.6,-4498.43"/>
</g>
<!-- layer86_moe -->
<g id="node443" class="node">
<title>layer86_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-4316.17 254.6,-4316.17 254.6,-4248.17 653.6,-4248.17 653.6,-4316.17"/>
<text text-anchor="middle" x="454.1" y="-4300.97" font-family="Times,serif" font-size="14.00">Layer 86 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-4285.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4270.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-4255.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer86_gate&#45;&gt;layer86_moe -->
<g id="edge443" class="edge">
<title>layer86_gate&#45;&gt;layer86_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-4351.96C454.1,-4343.21 454.1,-4334.44 454.1,-4326.23"/>
<polygon fill="black" stroke="black" points="457.6,-4326.18 454.1,-4316.18 450.6,-4326.18 457.6,-4326.18"/>
</g>
<!-- layer87_qkv_proj -->
<g id="node444" class="node">
<title>layer87_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-4212.17 240.6,-4212.17 240.6,-4144.17 667.6,-4144.17 667.6,-4212.17"/>
<text text-anchor="middle" x="454.1" y="-4196.97" font-family="Times,serif" font-size="14.00">Layer 87 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-4181.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4166.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-4151.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer86_moe&#45;&gt;layer87_qkv_proj -->
<g id="edge444" class="edge">
<title>layer86_moe&#45;&gt;layer87_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-4248.05C454.1,-4239.94 454.1,-4231.15 454.1,-4222.64"/>
<polygon fill="black" stroke="black" points="457.6,-4222.47 454.1,-4212.47 450.6,-4222.47 457.6,-4222.47"/>
</g>
<!-- layer87_attn_comp -->
<g id="node445" class="node">
<title>layer87_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-4108.17 240.6,-4108.17 240.6,-4040.17 667.6,-4040.17 667.6,-4108.17"/>
<text text-anchor="middle" x="454.1" y="-4092.97" font-family="Times,serif" font-size="14.00">Layer 87 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-4077.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-4062.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-4047.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer87_qkv_proj&#45;&gt;layer87_attn_comp -->
<g id="edge445" class="edge">
<title>layer87_qkv_proj&#45;&gt;layer87_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-4144.05C454.1,-4135.94 454.1,-4127.15 454.1,-4118.64"/>
<polygon fill="black" stroke="black" points="457.6,-4118.47 454.1,-4108.47 450.6,-4118.47 457.6,-4118.47"/>
</g>
<!-- layer87_out_proj -->
<g id="node446" class="node">
<title>layer87_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-4004.17 246.6,-4004.17 246.6,-3936.17 661.6,-3936.17 661.6,-4004.17"/>
<text text-anchor="middle" x="454.1" y="-3988.97" font-family="Times,serif" font-size="14.00">Layer 87 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-3973.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3958.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-3943.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer87_attn_comp&#45;&gt;layer87_out_proj -->
<g id="edge446" class="edge">
<title>layer87_attn_comp&#45;&gt;layer87_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-4040.05C454.1,-4031.94 454.1,-4023.15 454.1,-4014.64"/>
<polygon fill="black" stroke="black" points="457.6,-4014.47 454.1,-4004.47 450.6,-4014.47 457.6,-4014.47"/>
</g>
<!-- layer87_gate -->
<g id="node447" class="node">
<title>layer87_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-3900.17 216.93,-3900.17 52.65,-3764.17 691.26,-3764.17 855.54,-3900.17"/>
<text text-anchor="middle" x="454.1" y="-3850.97" font-family="Times,serif" font-size="14.00">Layer 87 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-3835.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3820.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-3805.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer87_out_proj&#45;&gt;layer87_gate -->
<g id="edge447" class="edge">
<title>layer87_out_proj&#45;&gt;layer87_gate</title>
<path fill="none" stroke="black" d="M454.1,-3935.9C454.1,-3928.07 454.1,-3919.4 454.1,-3910.52"/>
<polygon fill="black" stroke="black" points="457.6,-3910.43 454.1,-3900.43 450.6,-3910.43 457.6,-3910.43"/>
</g>
<!-- layer87_moe -->
<g id="node448" class="node">
<title>layer87_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-3728.17 254.6,-3728.17 254.6,-3660.17 653.6,-3660.17 653.6,-3728.17"/>
<text text-anchor="middle" x="454.1" y="-3712.97" font-family="Times,serif" font-size="14.00">Layer 87 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-3697.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3682.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-3667.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer87_gate&#45;&gt;layer87_moe -->
<g id="edge448" class="edge">
<title>layer87_gate&#45;&gt;layer87_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-3763.96C454.1,-3755.21 454.1,-3746.44 454.1,-3738.23"/>
<polygon fill="black" stroke="black" points="457.6,-3738.18 454.1,-3728.18 450.6,-3738.18 457.6,-3738.18"/>
</g>
<!-- layer88_qkv_proj -->
<g id="node449" class="node">
<title>layer88_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-3624.17 240.6,-3624.17 240.6,-3556.17 667.6,-3556.17 667.6,-3624.17"/>
<text text-anchor="middle" x="454.1" y="-3608.97" font-family="Times,serif" font-size="14.00">Layer 88 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-3593.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3578.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-3563.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer87_moe&#45;&gt;layer88_qkv_proj -->
<g id="edge449" class="edge">
<title>layer87_moe&#45;&gt;layer88_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-3660.05C454.1,-3651.94 454.1,-3643.15 454.1,-3634.64"/>
<polygon fill="black" stroke="black" points="457.6,-3634.47 454.1,-3624.47 450.6,-3634.47 457.6,-3634.47"/>
</g>
<!-- layer88_attn_comp -->
<g id="node450" class="node">
<title>layer88_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-3520.17 240.6,-3520.17 240.6,-3452.17 667.6,-3452.17 667.6,-3520.17"/>
<text text-anchor="middle" x="454.1" y="-3504.97" font-family="Times,serif" font-size="14.00">Layer 88 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-3489.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3474.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-3459.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer88_qkv_proj&#45;&gt;layer88_attn_comp -->
<g id="edge450" class="edge">
<title>layer88_qkv_proj&#45;&gt;layer88_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-3556.05C454.1,-3547.94 454.1,-3539.15 454.1,-3530.64"/>
<polygon fill="black" stroke="black" points="457.6,-3530.47 454.1,-3520.47 450.6,-3530.47 457.6,-3530.47"/>
</g>
<!-- layer88_out_proj -->
<g id="node451" class="node">
<title>layer88_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-3416.17 246.6,-3416.17 246.6,-3348.17 661.6,-3348.17 661.6,-3416.17"/>
<text text-anchor="middle" x="454.1" y="-3400.97" font-family="Times,serif" font-size="14.00">Layer 88 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-3385.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3370.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-3355.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer88_attn_comp&#45;&gt;layer88_out_proj -->
<g id="edge451" class="edge">
<title>layer88_attn_comp&#45;&gt;layer88_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-3452.05C454.1,-3443.94 454.1,-3435.15 454.1,-3426.64"/>
<polygon fill="black" stroke="black" points="457.6,-3426.47 454.1,-3416.47 450.6,-3426.47 457.6,-3426.47"/>
</g>
<!-- layer88_gate -->
<g id="node452" class="node">
<title>layer88_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-3312.17 216.93,-3312.17 52.65,-3176.17 691.26,-3176.17 855.54,-3312.17"/>
<text text-anchor="middle" x="454.1" y="-3262.97" font-family="Times,serif" font-size="14.00">Layer 88 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-3247.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3232.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-3217.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer88_out_proj&#45;&gt;layer88_gate -->
<g id="edge452" class="edge">
<title>layer88_out_proj&#45;&gt;layer88_gate</title>
<path fill="none" stroke="black" d="M454.1,-3347.9C454.1,-3340.07 454.1,-3331.4 454.1,-3322.52"/>
<polygon fill="black" stroke="black" points="457.6,-3322.43 454.1,-3312.43 450.6,-3322.43 457.6,-3322.43"/>
</g>
<!-- layer88_moe -->
<g id="node453" class="node">
<title>layer88_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-3140.17 254.6,-3140.17 254.6,-3072.17 653.6,-3072.17 653.6,-3140.17"/>
<text text-anchor="middle" x="454.1" y="-3124.97" font-family="Times,serif" font-size="14.00">Layer 88 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-3109.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-3094.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-3079.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer88_gate&#45;&gt;layer88_moe -->
<g id="edge453" class="edge">
<title>layer88_gate&#45;&gt;layer88_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-3175.96C454.1,-3167.21 454.1,-3158.44 454.1,-3150.23"/>
<polygon fill="black" stroke="black" points="457.6,-3150.18 454.1,-3140.18 450.6,-3150.18 457.6,-3150.18"/>
</g>
<!-- layer89_qkv_proj -->
<g id="node454" class="node">
<title>layer89_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-3036.17 240.6,-3036.17 240.6,-2968.17 667.6,-2968.17 667.6,-3036.17"/>
<text text-anchor="middle" x="454.1" y="-3020.97" font-family="Times,serif" font-size="14.00">Layer 89 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-3005.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2990.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-2975.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer88_moe&#45;&gt;layer89_qkv_proj -->
<g id="edge454" class="edge">
<title>layer88_moe&#45;&gt;layer89_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-3072.05C454.1,-3063.94 454.1,-3055.15 454.1,-3046.64"/>
<polygon fill="black" stroke="black" points="457.6,-3046.47 454.1,-3036.47 450.6,-3046.47 457.6,-3046.47"/>
</g>
<!-- layer89_attn_comp -->
<g id="node455" class="node">
<title>layer89_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-2932.17 240.6,-2932.17 240.6,-2864.17 667.6,-2864.17 667.6,-2932.17"/>
<text text-anchor="middle" x="454.1" y="-2916.97" font-family="Times,serif" font-size="14.00">Layer 89 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-2901.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2886.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-2871.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer89_qkv_proj&#45;&gt;layer89_attn_comp -->
<g id="edge455" class="edge">
<title>layer89_qkv_proj&#45;&gt;layer89_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-2968.05C454.1,-2959.94 454.1,-2951.15 454.1,-2942.64"/>
<polygon fill="black" stroke="black" points="457.6,-2942.47 454.1,-2932.47 450.6,-2942.47 457.6,-2942.47"/>
</g>
<!-- layer89_out_proj -->
<g id="node456" class="node">
<title>layer89_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-2828.17 246.6,-2828.17 246.6,-2760.17 661.6,-2760.17 661.6,-2828.17"/>
<text text-anchor="middle" x="454.1" y="-2812.97" font-family="Times,serif" font-size="14.00">Layer 89 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-2797.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2782.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-2767.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer89_attn_comp&#45;&gt;layer89_out_proj -->
<g id="edge456" class="edge">
<title>layer89_attn_comp&#45;&gt;layer89_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-2864.05C454.1,-2855.94 454.1,-2847.15 454.1,-2838.64"/>
<polygon fill="black" stroke="black" points="457.6,-2838.47 454.1,-2828.47 450.6,-2838.47 457.6,-2838.47"/>
</g>
<!-- layer89_gate -->
<g id="node457" class="node">
<title>layer89_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-2724.17 216.93,-2724.17 52.65,-2588.17 691.26,-2588.17 855.54,-2724.17"/>
<text text-anchor="middle" x="454.1" y="-2674.97" font-family="Times,serif" font-size="14.00">Layer 89 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-2659.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2644.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-2629.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer89_out_proj&#45;&gt;layer89_gate -->
<g id="edge457" class="edge">
<title>layer89_out_proj&#45;&gt;layer89_gate</title>
<path fill="none" stroke="black" d="M454.1,-2759.9C454.1,-2752.07 454.1,-2743.4 454.1,-2734.52"/>
<polygon fill="black" stroke="black" points="457.6,-2734.43 454.1,-2724.43 450.6,-2734.43 457.6,-2734.43"/>
</g>
<!-- layer89_moe -->
<g id="node458" class="node">
<title>layer89_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-2552.17 254.6,-2552.17 254.6,-2484.17 653.6,-2484.17 653.6,-2552.17"/>
<text text-anchor="middle" x="454.1" y="-2536.97" font-family="Times,serif" font-size="14.00">Layer 89 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-2521.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2506.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-2491.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer89_gate&#45;&gt;layer89_moe -->
<g id="edge458" class="edge">
<title>layer89_gate&#45;&gt;layer89_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-2587.96C454.1,-2579.21 454.1,-2570.44 454.1,-2562.23"/>
<polygon fill="black" stroke="black" points="457.6,-2562.18 454.1,-2552.18 450.6,-2562.18 457.6,-2562.18"/>
</g>
<!-- layer90_qkv_proj -->
<g id="node459" class="node">
<title>layer90_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-2448.17 240.6,-2448.17 240.6,-2380.17 667.6,-2380.17 667.6,-2448.17"/>
<text text-anchor="middle" x="454.1" y="-2432.97" font-family="Times,serif" font-size="14.00">Layer 90 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-2417.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2402.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-2387.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer89_moe&#45;&gt;layer90_qkv_proj -->
<g id="edge459" class="edge">
<title>layer89_moe&#45;&gt;layer90_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-2484.05C454.1,-2475.94 454.1,-2467.15 454.1,-2458.64"/>
<polygon fill="black" stroke="black" points="457.6,-2458.47 454.1,-2448.47 450.6,-2458.47 457.6,-2458.47"/>
</g>
<!-- layer90_attn_comp -->
<g id="node460" class="node">
<title>layer90_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-2344.17 240.6,-2344.17 240.6,-2276.17 667.6,-2276.17 667.6,-2344.17"/>
<text text-anchor="middle" x="454.1" y="-2328.97" font-family="Times,serif" font-size="14.00">Layer 90 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-2313.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2298.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-2283.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer90_qkv_proj&#45;&gt;layer90_attn_comp -->
<g id="edge460" class="edge">
<title>layer90_qkv_proj&#45;&gt;layer90_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-2380.05C454.1,-2371.94 454.1,-2363.15 454.1,-2354.64"/>
<polygon fill="black" stroke="black" points="457.6,-2354.47 454.1,-2344.47 450.6,-2354.47 457.6,-2354.47"/>
</g>
<!-- layer90_out_proj -->
<g id="node461" class="node">
<title>layer90_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-2240.17 246.6,-2240.17 246.6,-2172.17 661.6,-2172.17 661.6,-2240.17"/>
<text text-anchor="middle" x="454.1" y="-2224.97" font-family="Times,serif" font-size="14.00">Layer 90 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-2209.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2194.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-2179.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer90_attn_comp&#45;&gt;layer90_out_proj -->
<g id="edge461" class="edge">
<title>layer90_attn_comp&#45;&gt;layer90_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-2276.05C454.1,-2267.94 454.1,-2259.15 454.1,-2250.64"/>
<polygon fill="black" stroke="black" points="457.6,-2250.47 454.1,-2240.47 450.6,-2250.47 457.6,-2250.47"/>
</g>
<!-- layer90_gate -->
<g id="node462" class="node">
<title>layer90_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-2136.17 216.93,-2136.17 52.65,-2000.17 691.26,-2000.17 855.54,-2136.17"/>
<text text-anchor="middle" x="454.1" y="-2086.97" font-family="Times,serif" font-size="14.00">Layer 90 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-2071.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-2056.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-2041.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer90_out_proj&#45;&gt;layer90_gate -->
<g id="edge462" class="edge">
<title>layer90_out_proj&#45;&gt;layer90_gate</title>
<path fill="none" stroke="black" d="M454.1,-2171.9C454.1,-2164.07 454.1,-2155.4 454.1,-2146.52"/>
<polygon fill="black" stroke="black" points="457.6,-2146.43 454.1,-2136.43 450.6,-2146.43 457.6,-2146.43"/>
</g>
<!-- layer90_moe -->
<g id="node463" class="node">
<title>layer90_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-1964.17 254.6,-1964.17 254.6,-1896.17 653.6,-1896.17 653.6,-1964.17"/>
<text text-anchor="middle" x="454.1" y="-1948.97" font-family="Times,serif" font-size="14.00">Layer 90 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-1933.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1918.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-1903.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer90_gate&#45;&gt;layer90_moe -->
<g id="edge463" class="edge">
<title>layer90_gate&#45;&gt;layer90_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-1999.96C454.1,-1991.21 454.1,-1982.44 454.1,-1974.23"/>
<polygon fill="black" stroke="black" points="457.6,-1974.18 454.1,-1964.18 450.6,-1974.18 457.6,-1974.18"/>
</g>
<!-- layer91_qkv_proj -->
<g id="node464" class="node">
<title>layer91_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-1860.17 240.6,-1860.17 240.6,-1792.17 667.6,-1792.17 667.6,-1860.17"/>
<text text-anchor="middle" x="454.1" y="-1844.97" font-family="Times,serif" font-size="14.00">Layer 91 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-1829.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1814.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-1799.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer90_moe&#45;&gt;layer91_qkv_proj -->
<g id="edge464" class="edge">
<title>layer90_moe&#45;&gt;layer91_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-1896.05C454.1,-1887.94 454.1,-1879.15 454.1,-1870.64"/>
<polygon fill="black" stroke="black" points="457.6,-1870.47 454.1,-1860.47 450.6,-1870.47 457.6,-1870.47"/>
</g>
<!-- layer91_attn_comp -->
<g id="node465" class="node">
<title>layer91_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-1756.17 240.6,-1756.17 240.6,-1688.17 667.6,-1688.17 667.6,-1756.17"/>
<text text-anchor="middle" x="454.1" y="-1740.97" font-family="Times,serif" font-size="14.00">Layer 91 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-1725.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1710.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-1695.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer91_qkv_proj&#45;&gt;layer91_attn_comp -->
<g id="edge465" class="edge">
<title>layer91_qkv_proj&#45;&gt;layer91_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-1792.05C454.1,-1783.94 454.1,-1775.15 454.1,-1766.64"/>
<polygon fill="black" stroke="black" points="457.6,-1766.47 454.1,-1756.47 450.6,-1766.47 457.6,-1766.47"/>
</g>
<!-- layer91_out_proj -->
<g id="node466" class="node">
<title>layer91_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-1652.17 246.6,-1652.17 246.6,-1584.17 661.6,-1584.17 661.6,-1652.17"/>
<text text-anchor="middle" x="454.1" y="-1636.97" font-family="Times,serif" font-size="14.00">Layer 91 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-1621.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1606.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-1591.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer91_attn_comp&#45;&gt;layer91_out_proj -->
<g id="edge466" class="edge">
<title>layer91_attn_comp&#45;&gt;layer91_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-1688.05C454.1,-1679.94 454.1,-1671.15 454.1,-1662.64"/>
<polygon fill="black" stroke="black" points="457.6,-1662.47 454.1,-1652.47 450.6,-1662.47 457.6,-1662.47"/>
</g>
<!-- layer91_gate -->
<g id="node467" class="node">
<title>layer91_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-1548.17 216.93,-1548.17 52.65,-1412.17 691.26,-1412.17 855.54,-1548.17"/>
<text text-anchor="middle" x="454.1" y="-1498.97" font-family="Times,serif" font-size="14.00">Layer 91 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-1483.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1468.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-1453.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer91_out_proj&#45;&gt;layer91_gate -->
<g id="edge467" class="edge">
<title>layer91_out_proj&#45;&gt;layer91_gate</title>
<path fill="none" stroke="black" d="M454.1,-1583.9C454.1,-1576.07 454.1,-1567.4 454.1,-1558.52"/>
<polygon fill="black" stroke="black" points="457.6,-1558.43 454.1,-1548.43 450.6,-1558.43 457.6,-1558.43"/>
</g>
<!-- layer91_moe -->
<g id="node468" class="node">
<title>layer91_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-1376.17 254.6,-1376.17 254.6,-1308.17 653.6,-1308.17 653.6,-1376.17"/>
<text text-anchor="middle" x="454.1" y="-1360.97" font-family="Times,serif" font-size="14.00">Layer 91 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-1345.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1330.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-1315.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer91_gate&#45;&gt;layer91_moe -->
<g id="edge468" class="edge">
<title>layer91_gate&#45;&gt;layer91_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-1411.96C454.1,-1403.21 454.1,-1394.44 454.1,-1386.23"/>
<polygon fill="black" stroke="black" points="457.6,-1386.18 454.1,-1376.18 450.6,-1386.18 457.6,-1386.18"/>
</g>
<!-- layer92_qkv_proj -->
<g id="node469" class="node">
<title>layer92_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-1272.17 240.6,-1272.17 240.6,-1204.17 667.6,-1204.17 667.6,-1272.17"/>
<text text-anchor="middle" x="454.1" y="-1256.97" font-family="Times,serif" font-size="14.00">Layer 92 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-1241.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1226.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-1211.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer91_moe&#45;&gt;layer92_qkv_proj -->
<g id="edge469" class="edge">
<title>layer91_moe&#45;&gt;layer92_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-1308.05C454.1,-1299.94 454.1,-1291.15 454.1,-1282.64"/>
<polygon fill="black" stroke="black" points="457.6,-1282.47 454.1,-1272.47 450.6,-1282.47 457.6,-1282.47"/>
</g>
<!-- layer92_attn_comp -->
<g id="node470" class="node">
<title>layer92_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-1168.17 240.6,-1168.17 240.6,-1100.17 667.6,-1100.17 667.6,-1168.17"/>
<text text-anchor="middle" x="454.1" y="-1152.97" font-family="Times,serif" font-size="14.00">Layer 92 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-1137.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1122.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-1107.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer92_qkv_proj&#45;&gt;layer92_attn_comp -->
<g id="edge470" class="edge">
<title>layer92_qkv_proj&#45;&gt;layer92_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-1204.05C454.1,-1195.94 454.1,-1187.15 454.1,-1178.64"/>
<polygon fill="black" stroke="black" points="457.6,-1178.47 454.1,-1168.47 450.6,-1178.47 457.6,-1178.47"/>
</g>
<!-- layer92_out_proj -->
<g id="node471" class="node">
<title>layer92_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-1064.17 246.6,-1064.17 246.6,-996.17 661.6,-996.17 661.6,-1064.17"/>
<text text-anchor="middle" x="454.1" y="-1048.97" font-family="Times,serif" font-size="14.00">Layer 92 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-1033.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-1018.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-1003.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer92_attn_comp&#45;&gt;layer92_out_proj -->
<g id="edge471" class="edge">
<title>layer92_attn_comp&#45;&gt;layer92_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-1100.05C454.1,-1091.94 454.1,-1083.15 454.1,-1074.64"/>
<polygon fill="black" stroke="black" points="457.6,-1074.47 454.1,-1064.47 450.6,-1074.47 457.6,-1074.47"/>
</g>
<!-- layer92_gate -->
<g id="node472" class="node">
<title>layer92_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-960.17 216.93,-960.17 52.65,-824.17 691.26,-824.17 855.54,-960.17"/>
<text text-anchor="middle" x="454.1" y="-910.97" font-family="Times,serif" font-size="14.00">Layer 92 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-895.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-880.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-865.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer92_out_proj&#45;&gt;layer92_gate -->
<g id="edge472" class="edge">
<title>layer92_out_proj&#45;&gt;layer92_gate</title>
<path fill="none" stroke="black" d="M454.1,-995.9C454.1,-988.07 454.1,-979.4 454.1,-970.52"/>
<polygon fill="black" stroke="black" points="457.6,-970.43 454.1,-960.43 450.6,-970.43 457.6,-970.43"/>
</g>
<!-- layer92_moe -->
<g id="node473" class="node">
<title>layer92_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-788.17 254.6,-788.17 254.6,-720.17 653.6,-720.17 653.6,-788.17"/>
<text text-anchor="middle" x="454.1" y="-772.97" font-family="Times,serif" font-size="14.00">Layer 92 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-757.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-742.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-727.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer92_gate&#45;&gt;layer92_moe -->
<g id="edge473" class="edge">
<title>layer92_gate&#45;&gt;layer92_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-823.96C454.1,-815.21 454.1,-806.44 454.1,-798.23"/>
<polygon fill="black" stroke="black" points="457.6,-798.18 454.1,-788.18 450.6,-798.18 457.6,-798.18"/>
</g>
<!-- layer93_qkv_proj -->
<g id="node474" class="node">
<title>layer93_qkv_proj</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-684.17 240.6,-684.17 240.6,-616.17 667.6,-616.17 667.6,-684.17"/>
<text text-anchor="middle" x="454.1" y="-668.97" font-family="Times,serif" font-size="14.00">Layer 93 QKV Projection</text>
<text text-anchor="middle" x="454.1" y="-653.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-638.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-623.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer92_moe&#45;&gt;layer93_qkv_proj -->
<g id="edge474" class="edge">
<title>layer92_moe&#45;&gt;layer93_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-720.05C454.1,-711.94 454.1,-703.15 454.1,-694.64"/>
<polygon fill="black" stroke="black" points="457.6,-694.47 454.1,-684.47 450.6,-694.47 457.6,-694.47"/>
</g>
<!-- layer93_attn_comp -->
<g id="node475" class="node">
<title>layer93_attn_comp</title>
<polygon fill="lightcoral" stroke="black" points="667.6,-580.17 240.6,-580.17 240.6,-512.17 667.6,-512.17 667.6,-580.17"/>
<text text-anchor="middle" x="454.1" y="-564.97" font-family="Times,serif" font-size="14.00">Layer 93 Attention Computation + KV Cache</text>
<text text-anchor="middle" x="454.1" y="-549.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-534.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-519.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
</g>
<!-- layer93_qkv_proj&#45;&gt;layer93_attn_comp -->
<g id="edge475" class="edge">
<title>layer93_qkv_proj&#45;&gt;layer93_attn_comp</title>
<path fill="none" stroke="black" d="M454.1,-616.05C454.1,-607.94 454.1,-599.15 454.1,-590.64"/>
<polygon fill="black" stroke="black" points="457.6,-590.47 454.1,-580.47 450.6,-590.47 457.6,-590.47"/>
</g>
<!-- layer93_out_proj -->
<g id="node476" class="node">
<title>layer93_out_proj</title>
<polygon fill="lightcoral" stroke="black" points="661.6,-476.17 246.6,-476.17 246.6,-408.17 661.6,-408.17 661.6,-476.17"/>
<text text-anchor="middle" x="454.1" y="-460.97" font-family="Times,serif" font-size="14.00">Layer 93 Output Projection</text>
<text text-anchor="middle" x="454.1" y="-445.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-430.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="454.1" y="-415.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer93_attn_comp&#45;&gt;layer93_out_proj -->
<g id="edge476" class="edge">
<title>layer93_attn_comp&#45;&gt;layer93_out_proj</title>
<path fill="none" stroke="black" d="M454.1,-512.05C454.1,-503.94 454.1,-495.15 454.1,-486.64"/>
<polygon fill="black" stroke="black" points="457.6,-486.47 454.1,-476.47 450.6,-486.47 457.6,-486.47"/>
</g>
<!-- layer93_gate -->
<g id="node477" class="node">
<title>layer93_gate</title>
<polygon fill="orange" stroke="black" points="855.54,-372.17 216.93,-372.17 52.65,-236.17 691.26,-236.17 855.54,-372.17"/>
<text text-anchor="middle" x="454.1" y="-322.97" font-family="Times,serif" font-size="14.00">Layer 93 Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="454.1" y="-307.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-292.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-277.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- layer93_out_proj&#45;&gt;layer93_gate -->
<g id="edge477" class="edge">
<title>layer93_out_proj&#45;&gt;layer93_gate</title>
<path fill="none" stroke="black" d="M454.1,-407.9C454.1,-400.07 454.1,-391.4 454.1,-382.52"/>
<polygon fill="black" stroke="black" points="457.6,-382.43 454.1,-372.43 450.6,-382.43 457.6,-382.43"/>
</g>
<!-- layer93_moe -->
<g id="node478" class="node">
<title>layer93_moe</title>
<polygon fill="lightcoral" stroke="black" points="653.6,-200.17 254.6,-200.17 254.6,-132.17 653.6,-132.17 653.6,-200.17"/>
<text text-anchor="middle" x="454.1" y="-184.97" font-family="Times,serif" font-size="14.00">Layer 93 MoE (128 experts)</text>
<text text-anchor="middle" x="454.1" y="-169.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-154.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-139.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- layer93_gate&#45;&gt;layer93_moe -->
<g id="edge478" class="edge">
<title>layer93_gate&#45;&gt;layer93_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M454.1,-235.96C454.1,-227.21 454.1,-218.44 454.1,-210.23"/>
<polygon fill="black" stroke="black" points="457.6,-210.18 454.1,-200.18 450.6,-210.18 457.6,-210.18"/>
</g>
<!-- output -->
<g id="node480" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="454.1" cy="-48.08" rx="306.77" ry="48.17"/>
<text text-anchor="middle" x="454.1" y="-66.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="454.1" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="454.1" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="454.1" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, vocab_size=151936]</text>
</g>
<!-- layer93_moe&#45;&gt;output -->
<g id="edge479" class="edge">
<title>layer93_moe&#45;&gt;output</title>
<path fill="none" stroke="black" d="M454.1,-131.9C454.1,-123.91 454.1,-115.14 454.1,-106.4"/>
<polygon fill="black" stroke="black" points="457.6,-106.19 454.1,-96.19 450.6,-106.19 457.6,-106.19"/>
</g>
<!-- kv_access_3&#45;&gt;layer72_qkv_proj -->
<g id="edge369" class="edge">
<title>kv_access_3&#45;&gt;layer72_qkv_proj</title>
<path fill="none" stroke="black" d="M454.1,-13086.01C454.1,-13071.65 454.1,-13056.23 454.1,-13042.43"/>
<polygon fill="black" stroke="black" points="457.6,-13042.23 454.1,-13032.23 450.6,-13042.23 457.6,-13042.23"/>
</g>
</g>
</svg>
