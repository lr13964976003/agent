<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="1520pt"
 viewBox="0.00 0.00 1440.00 1520.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.43 0.43) rotate(0) translate(4 3520.83)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3520.83 3335.1,-3520.83 3335.1,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="black" d="M2480,-2252.67C2480,-2252.67 3274,-2252.67 3274,-2252.67 3280,-2252.67 3286,-2258.67 3286,-2264.67 3286,-2264.67 3286,-3065.67 3286,-3065.67 3286,-3071.67 3280,-3077.67 3274,-3077.67 3274,-3077.67 2480,-3077.67 2480,-3077.67 2474,-3077.67 2468,-3071.67 2468,-3065.67 2468,-3065.67 2468,-2264.67 2468,-2264.67 2468,-2258.67 2474,-2252.67 2480,-2252.67"/>
<text text-anchor="middle" x="2877" y="-3062.47" font-family="Times,serif" font-size="14.00">Stage 0: Layers 0&#45;23</text>
<text text-anchor="middle" x="2877" y="-3047.47" font-family="Times,serif" font-size="14.00">GPUs 0&#45;8</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M1660,-1543.5C1660,-1543.5 3274,-1543.5 3274,-1543.5 3280,-1543.5 3286,-1549.5 3286,-1555.5 3286,-1555.5 3286,-1945.5 3286,-1945.5 3286,-1951.5 3280,-1957.5 3274,-1957.5 3274,-1957.5 1660,-1957.5 1660,-1957.5 1654,-1957.5 1648,-1951.5 1648,-1945.5 1648,-1945.5 1648,-1555.5 1648,-1555.5 1648,-1549.5 1654,-1543.5 1660,-1543.5"/>
<text text-anchor="middle" x="2467" y="-1942.3" font-family="Times,serif" font-size="14.00">Stage 1: Layers 24&#45;47</text>
<text text-anchor="middle" x="2467" y="-1927.3" font-family="Times,serif" font-size="14.00">GPUs 9&#45;17</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="none" stroke="black" d="M840,-834.33C840,-834.33 2454,-834.33 2454,-834.33 2460,-834.33 2466,-840.33 2466,-846.33 2466,-846.33 2466,-1236.33 2466,-1236.33 2466,-1242.33 2460,-1248.33 2454,-1248.33 2454,-1248.33 840,-1248.33 840,-1248.33 834,-1248.33 828,-1242.33 828,-1236.33 828,-1236.33 828,-846.33 828,-846.33 828,-840.33 834,-834.33 840,-834.33"/>
<text text-anchor="middle" x="1647" y="-1233.13" font-family="Times,serif" font-size="14.00">Stage 2: Layers 48&#45;71</text>
<text text-anchor="middle" x="1647" y="-1218.13" font-family="Times,serif" font-size="14.00">GPUs 18&#45;26</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="none" stroke="black" d="M20,-125.17C20,-125.17 1634,-125.17 1634,-125.17 1640,-125.17 1646,-131.17 1646,-137.17 1646,-137.17 1646,-527.17 1646,-527.17 1646,-533.17 1640,-539.17 1634,-539.17 1634,-539.17 20,-539.17 20,-539.17 14,-539.17 8,-533.17 8,-527.17 8,-527.17 8,-137.17 8,-137.17 8,-131.17 14,-125.17 20,-125.17"/>
<text text-anchor="middle" x="827" y="-523.97" font-family="Times,serif" font-size="14.00">Stage 3: Layers 72&#45;93</text>
<text text-anchor="middle" x="827" y="-508.97" font-family="Times,serif" font-size="14.00">GPUs 27&#45;34</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgray" stroke="black" cx="2877" cy="-3468.75" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="2877" y="-3487.55" font-family="Times,serif" font-size="14.00">Input Token Embedding</text>
<text text-anchor="middle" x="2877" y="-3472.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;34</text>
<text text-anchor="middle" x="2877" y="-3457.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-3442.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- kv_cache -->
<g id="node2" class="node">
<title>kv_cache</title>
<polygon fill="lightpink" stroke="black" points="3331.2,-3383.67 2608.67,-3383.67 2422.8,-3247.67 3145.33,-3247.67 3331.2,-3383.67"/>
<text text-anchor="middle" x="2877" y="-3334.47" font-family="Times,serif" font-size="14.00">KV Cache Storage</text>
<text text-anchor="middle" x="2877" y="-3319.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;34</text>
<text text-anchor="middle" x="2877" y="-3304.47" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2877" y="-3289.47" font-family="Times,serif" font-size="14.00">Hit Rate: 95%+</text>
</g>
<!-- input&#45;&gt;kv_cache -->
<g id="edge1" class="edge">
<title>input&#45;&gt;kv_cache</title>
<path fill="none" stroke="black" d="M2877,-3420.36C2877,-3411.93 2877,-3402.96 2877,-3393.96"/>
<polygon fill="black" stroke="black" points="2880.5,-3393.81 2877,-3383.81 2873.5,-3393.81 2880.5,-3393.81"/>
</g>
<!-- kv_access_0 -->
<g id="node31" class="node">
<title>kv_access_0</title>
<polygon fill="lightcyan" stroke="black" points="3331.2,-3210.67 2608.67,-3210.67 2422.8,-3104.67 3145.33,-3104.67 3331.2,-3210.67"/>
<text text-anchor="middle" x="2877" y="-3168.97" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="2877" y="-3153.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-3138.97" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- kv_cache&#45;&gt;kv_access_0 -->
<g id="edge2" class="edge">
<title>kv_cache&#45;&gt;kv_access_0</title>
<path fill="none" stroke="black" d="M2877,-3247.6C2877,-3238.82 2877,-3229.84 2877,-3221.14"/>
<polygon fill="black" stroke="black" points="2880.5,-3221.07 2877,-3211.07 2873.5,-3221.07 2880.5,-3221.07"/>
</g>
<!-- stage0_layer0_attn -->
<g id="node3" class="node">
<title>stage0_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="3076.5,-3031.67 2677.5,-3031.67 2677.5,-2963.67 3076.5,-2963.67 3076.5,-3031.67"/>
<text text-anchor="middle" x="2877" y="-3016.47" font-family="Times,serif" font-size="14.00">Layer 0 Attention + KV Cache</text>
<text text-anchor="middle" x="2877" y="-3001.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-2986.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2971.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage0_layer0_gate -->
<g id="node4" class="node">
<title>stage0_layer0_gate</title>
<polygon fill="orange" stroke="black" points="3278.45,-2926.67 2639.83,-2926.67 2475.55,-2790.67 3114.17,-2790.67 3278.45,-2926.67"/>
<text text-anchor="middle" x="2877" y="-2877.47" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="2877" y="-2862.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-2847.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2832.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage0_layer0_attn&#45;&gt;stage0_layer0_gate -->
<g id="edge4" class="edge">
<title>stage0_layer0_attn&#45;&gt;stage0_layer0_gate</title>
<path fill="none" stroke="black" d="M2877,-2963.5C2877,-2955.36 2877,-2946.3 2877,-2937.02"/>
<polygon fill="black" stroke="black" points="2880.5,-2936.9 2877,-2926.9 2873.5,-2936.9 2880.5,-2936.9"/>
</g>
<!-- stage0_layer0_moe -->
<g id="node5" class="node">
<title>stage0_layer0_moe</title>
<polygon fill="lightblue" stroke="black" points="3076.5,-2739.67 2677.5,-2739.67 2677.5,-2671.67 3076.5,-2671.67 3076.5,-2739.67"/>
<text text-anchor="middle" x="2877" y="-2724.47" font-family="Times,serif" font-size="14.00">Layer 0 MoE (128 experts)</text>
<text text-anchor="middle" x="2877" y="-2709.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-2694.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2679.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage0_layer0_gate&#45;&gt;stage0_layer0_moe -->
<g id="edge5" class="edge">
<title>stage0_layer0_gate&#45;&gt;stage0_layer0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2877,-2790.56C2877,-2776.77 2877,-2762.61 2877,-2749.94"/>
<polygon fill="black" stroke="black" points="2880.5,-2749.69 2877,-2739.69 2873.5,-2749.69 2880.5,-2749.69"/>
<text text-anchor="middle" x="2956.5" y="-2761.47" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- stage0_layer23_attn -->
<g id="node6" class="node">
<title>stage0_layer23_attn</title>
<polygon fill="lightblue" stroke="black" points="3076.5,-2620.67 2677.5,-2620.67 2677.5,-2552.67 3076.5,-2552.67 3076.5,-2620.67"/>
<text text-anchor="middle" x="2877" y="-2605.47" font-family="Times,serif" font-size="14.00">Layer 23 Attention + KV Cache</text>
<text text-anchor="middle" x="2877" y="-2590.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-2575.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2560.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage0_layer0_moe&#45;&gt;stage0_layer23_attn -->
<g id="edge6" class="edge">
<title>stage0_layer0_moe&#45;&gt;stage0_layer23_attn</title>
<path fill="none" stroke="black" d="M2877,-2671.45C2877,-2658.98 2877,-2644.6 2877,-2631.32"/>
<polygon fill="black" stroke="black" points="2880.5,-2630.96 2877,-2620.96 2873.5,-2630.96 2880.5,-2630.96"/>
<text text-anchor="middle" x="2919.5" y="-2642.47" font-family="Times,serif" font-size="14.00">Layers 1&#45;22</text>
</g>
<!-- stage0_layer23_gate -->
<g id="node7" class="node">
<title>stage0_layer23_gate</title>
<polygon fill="orange" stroke="black" points="3278.45,-2515.67 2639.83,-2515.67 2475.55,-2379.67 3114.17,-2379.67 3278.45,-2515.67"/>
<text text-anchor="middle" x="2877" y="-2466.47" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="2877" y="-2451.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-2436.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2421.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage0_layer23_attn&#45;&gt;stage0_layer23_gate -->
<g id="edge7" class="edge">
<title>stage0_layer23_attn&#45;&gt;stage0_layer23_gate</title>
<path fill="none" stroke="black" d="M2877,-2552.5C2877,-2544.36 2877,-2535.3 2877,-2526.02"/>
<polygon fill="black" stroke="black" points="2880.5,-2525.9 2877,-2515.9 2873.5,-2525.9 2880.5,-2525.9"/>
</g>
<!-- stage0_layer23_moe -->
<g id="node8" class="node">
<title>stage0_layer23_moe</title>
<polygon fill="lightblue" stroke="black" points="3076.5,-2328.67 2677.5,-2328.67 2677.5,-2260.67 3076.5,-2260.67 3076.5,-2328.67"/>
<text text-anchor="middle" x="2877" y="-2313.47" font-family="Times,serif" font-size="14.00">Layer 23 MoE (128 experts)</text>
<text text-anchor="middle" x="2877" y="-2298.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;8</text>
<text text-anchor="middle" x="2877" y="-2283.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2268.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage0_layer23_gate&#45;&gt;stage0_layer23_moe -->
<g id="edge8" class="edge">
<title>stage0_layer23_gate&#45;&gt;stage0_layer23_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2877,-2379.56C2877,-2365.77 2877,-2351.61 2877,-2338.94"/>
<polygon fill="black" stroke="black" points="2880.5,-2338.69 2877,-2328.69 2873.5,-2338.69 2880.5,-2338.69"/>
<text text-anchor="middle" x="2956.5" y="-2350.47" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- comm_0_1 -->
<g id="node28" class="node">
<title>comm_0_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2877" cy="-2175.58" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="2877" y="-2194.38" font-family="Times,serif" font-size="14.00">Pipeline Communication (Single Token)</text>
<text text-anchor="middle" x="2877" y="-2179.38" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;8 → 9&#45;17</text>
<text text-anchor="middle" x="2877" y="-2164.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-2149.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage0_layer23_moe&#45;&gt;comm_0_1 -->
<g id="edge9" class="edge">
<title>stage0_layer23_moe&#45;&gt;comm_0_1</title>
<path fill="none" stroke="black" d="M2877,-2260.43C2877,-2252.18 2877,-2243.09 2877,-2234.04"/>
<polygon fill="black" stroke="black" points="2880.5,-2233.89 2877,-2223.89 2873.5,-2233.89 2880.5,-2233.89"/>
</g>
<!-- stage1_layer24_attn -->
<g id="node9" class="node">
<title>stage1_layer24_attn</title>
<polygon fill="lightgreen" stroke="black" points="3076.5,-1911.5 2677.5,-1911.5 2677.5,-1843.5 3076.5,-1843.5 3076.5,-1911.5"/>
<text text-anchor="middle" x="2877" y="-1896.3" font-family="Times,serif" font-size="14.00">Layer 24 Attention + KV Cache</text>
<text text-anchor="middle" x="2877" y="-1881.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2877" y="-1866.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-1851.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage1_layer24_gate -->
<g id="node10" class="node">
<title>stage1_layer24_gate</title>
<polygon fill="orange" stroke="black" points="3278.45,-1806.5 2639.83,-1806.5 2475.55,-1670.5 3114.17,-1670.5 3278.45,-1806.5"/>
<text text-anchor="middle" x="2877" y="-1757.3" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="2877" y="-1742.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2877" y="-1727.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-1712.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage1_layer24_attn&#45;&gt;stage1_layer24_gate -->
<g id="edge12" class="edge">
<title>stage1_layer24_attn&#45;&gt;stage1_layer24_gate</title>
<path fill="none" stroke="black" d="M2877,-1843.34C2877,-1835.19 2877,-1826.13 2877,-1816.86"/>
<polygon fill="black" stroke="black" points="2880.5,-1816.73 2877,-1806.73 2873.5,-1816.73 2880.5,-1816.73"/>
</g>
<!-- stage1_layer24_moe -->
<g id="node11" class="node">
<title>stage1_layer24_moe</title>
<polygon fill="lightgreen" stroke="black" points="3076.5,-1619.5 2677.5,-1619.5 2677.5,-1551.5 3076.5,-1551.5 3076.5,-1619.5"/>
<text text-anchor="middle" x="2877" y="-1604.3" font-family="Times,serif" font-size="14.00">Layer 24 MoE (128 experts)</text>
<text text-anchor="middle" x="2877" y="-1589.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2877" y="-1574.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2877" y="-1559.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage1_layer24_gate&#45;&gt;stage1_layer24_moe -->
<g id="edge13" class="edge">
<title>stage1_layer24_gate&#45;&gt;stage1_layer24_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2877,-1670.39C2877,-1656.61 2877,-1642.44 2877,-1629.77"/>
<polygon fill="black" stroke="black" points="2880.5,-1629.52 2877,-1619.52 2873.5,-1629.52 2880.5,-1629.52"/>
<text text-anchor="middle" x="2956.5" y="-1641.3" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- stage1_layer47_attn -->
<g id="node12" class="node">
<title>stage1_layer47_attn</title>
<polygon fill="lightgreen" stroke="black" points="2256.5,-1911.5 1857.5,-1911.5 1857.5,-1843.5 2256.5,-1843.5 2256.5,-1911.5"/>
<text text-anchor="middle" x="2057" y="-1896.3" font-family="Times,serif" font-size="14.00">Layer 47 Attention + KV Cache</text>
<text text-anchor="middle" x="2057" y="-1881.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2057" y="-1866.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-1851.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage1_layer47_gate -->
<g id="node13" class="node">
<title>stage1_layer47_gate</title>
<polygon fill="orange" stroke="black" points="2458.45,-1806.5 1819.83,-1806.5 1655.55,-1670.5 2294.17,-1670.5 2458.45,-1806.5"/>
<text text-anchor="middle" x="2057" y="-1757.3" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="2057" y="-1742.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2057" y="-1727.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-1712.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage1_layer47_attn&#45;&gt;stage1_layer47_gate -->
<g id="edge14" class="edge">
<title>stage1_layer47_attn&#45;&gt;stage1_layer47_gate</title>
<path fill="none" stroke="black" d="M2057,-1843.34C2057,-1835.19 2057,-1826.13 2057,-1816.86"/>
<polygon fill="black" stroke="black" points="2060.5,-1816.73 2057,-1806.73 2053.5,-1816.73 2060.5,-1816.73"/>
</g>
<!-- stage1_layer47_moe -->
<g id="node14" class="node">
<title>stage1_layer47_moe</title>
<polygon fill="lightgreen" stroke="black" points="2256.5,-1619.5 1857.5,-1619.5 1857.5,-1551.5 2256.5,-1551.5 2256.5,-1619.5"/>
<text text-anchor="middle" x="2057" y="-1604.3" font-family="Times,serif" font-size="14.00">Layer 47 MoE (128 experts)</text>
<text text-anchor="middle" x="2057" y="-1589.3" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2057" y="-1574.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-1559.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage1_layer47_gate&#45;&gt;stage1_layer47_moe -->
<g id="edge15" class="edge">
<title>stage1_layer47_gate&#45;&gt;stage1_layer47_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2057,-1670.39C2057,-1656.61 2057,-1642.44 2057,-1629.77"/>
<polygon fill="black" stroke="black" points="2060.5,-1629.52 2057,-1619.52 2053.5,-1629.52 2060.5,-1629.52"/>
<text text-anchor="middle" x="2136.5" y="-1641.3" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- comm_1_2 -->
<g id="node29" class="node">
<title>comm_1_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2057" cy="-1466.42" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="2057" y="-1485.22" font-family="Times,serif" font-size="14.00">Pipeline Communication (Single Token)</text>
<text text-anchor="middle" x="2057" y="-1470.22" font-family="Times,serif" font-size="14.00">GPUs: 9&#45;17 → 18&#45;26</text>
<text text-anchor="middle" x="2057" y="-1455.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-1440.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage1_layer47_moe&#45;&gt;comm_1_2 -->
<g id="edge16" class="edge">
<title>stage1_layer47_moe&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M2057,-1551.26C2057,-1543.01 2057,-1533.93 2057,-1524.88"/>
<polygon fill="black" stroke="black" points="2060.5,-1524.72 2057,-1514.72 2053.5,-1524.72 2060.5,-1524.72"/>
</g>
<!-- stage2_layer48_attn -->
<g id="node15" class="node">
<title>stage2_layer48_attn</title>
<polygon fill="lightyellow" stroke="black" points="2256.5,-1202.33 1857.5,-1202.33 1857.5,-1134.33 2256.5,-1134.33 2256.5,-1202.33"/>
<text text-anchor="middle" x="2057" y="-1187.13" font-family="Times,serif" font-size="14.00">Layer 48 Attention + KV Cache</text>
<text text-anchor="middle" x="2057" y="-1172.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="2057" y="-1157.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-1142.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage2_layer48_gate -->
<g id="node16" class="node">
<title>stage2_layer48_gate</title>
<polygon fill="orange" stroke="black" points="2458.45,-1097.33 1819.83,-1097.33 1655.55,-961.33 2294.17,-961.33 2458.45,-1097.33"/>
<text text-anchor="middle" x="2057" y="-1048.13" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="2057" y="-1033.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="2057" y="-1018.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-1003.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage2_layer48_attn&#45;&gt;stage2_layer48_gate -->
<g id="edge19" class="edge">
<title>stage2_layer48_attn&#45;&gt;stage2_layer48_gate</title>
<path fill="none" stroke="black" d="M2057,-1134.17C2057,-1126.03 2057,-1116.97 2057,-1107.69"/>
<polygon fill="black" stroke="black" points="2060.5,-1107.57 2057,-1097.57 2053.5,-1107.57 2060.5,-1107.57"/>
</g>
<!-- stage2_layer48_moe -->
<g id="node17" class="node">
<title>stage2_layer48_moe</title>
<polygon fill="lightyellow" stroke="black" points="2256.5,-910.33 1857.5,-910.33 1857.5,-842.33 2256.5,-842.33 2256.5,-910.33"/>
<text text-anchor="middle" x="2057" y="-895.13" font-family="Times,serif" font-size="14.00">Layer 48 MoE (128 experts)</text>
<text text-anchor="middle" x="2057" y="-880.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="2057" y="-865.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="2057" y="-850.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage2_layer48_gate&#45;&gt;stage2_layer48_moe -->
<g id="edge20" class="edge">
<title>stage2_layer48_gate&#45;&gt;stage2_layer48_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2057,-961.22C2057,-947.44 2057,-933.28 2057,-920.61"/>
<polygon fill="black" stroke="black" points="2060.5,-920.35 2057,-910.35 2053.5,-920.35 2060.5,-920.35"/>
<text text-anchor="middle" x="2136.5" y="-932.13" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- stage2_layer71_attn -->
<g id="node18" class="node">
<title>stage2_layer71_attn</title>
<polygon fill="lightyellow" stroke="black" points="1436.5,-1202.33 1037.5,-1202.33 1037.5,-1134.33 1436.5,-1134.33 1436.5,-1202.33"/>
<text text-anchor="middle" x="1237" y="-1187.13" font-family="Times,serif" font-size="14.00">Layer 71 Attention + KV Cache</text>
<text text-anchor="middle" x="1237" y="-1172.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="1237" y="-1157.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-1142.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage2_layer71_gate -->
<g id="node19" class="node">
<title>stage2_layer71_gate</title>
<polygon fill="orange" stroke="black" points="1638.45,-1097.33 999.83,-1097.33 835.55,-961.33 1474.17,-961.33 1638.45,-1097.33"/>
<text text-anchor="middle" x="1237" y="-1048.13" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="1237" y="-1033.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="1237" y="-1018.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-1003.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage2_layer71_attn&#45;&gt;stage2_layer71_gate -->
<g id="edge21" class="edge">
<title>stage2_layer71_attn&#45;&gt;stage2_layer71_gate</title>
<path fill="none" stroke="black" d="M1237,-1134.17C1237,-1126.03 1237,-1116.97 1237,-1107.69"/>
<polygon fill="black" stroke="black" points="1240.5,-1107.57 1237,-1097.57 1233.5,-1107.57 1240.5,-1107.57"/>
</g>
<!-- stage2_layer71_moe -->
<g id="node20" class="node">
<title>stage2_layer71_moe</title>
<polygon fill="lightyellow" stroke="black" points="1436.5,-910.33 1037.5,-910.33 1037.5,-842.33 1436.5,-842.33 1436.5,-910.33"/>
<text text-anchor="middle" x="1237" y="-895.13" font-family="Times,serif" font-size="14.00">Layer 71 MoE (128 experts)</text>
<text text-anchor="middle" x="1237" y="-880.13" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="1237" y="-865.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-850.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage2_layer71_gate&#45;&gt;stage2_layer71_moe -->
<g id="edge22" class="edge">
<title>stage2_layer71_gate&#45;&gt;stage2_layer71_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1237,-961.22C1237,-947.44 1237,-933.28 1237,-920.61"/>
<polygon fill="black" stroke="black" points="1240.5,-920.35 1237,-910.35 1233.5,-920.35 1240.5,-920.35"/>
<text text-anchor="middle" x="1316.5" y="-932.13" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- comm_2_3 -->
<g id="node30" class="node">
<title>comm_2_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1237" cy="-757.25" rx="282.27" ry="48.17"/>
<text text-anchor="middle" x="1237" y="-776.05" font-family="Times,serif" font-size="14.00">Pipeline Communication (Single Token)</text>
<text text-anchor="middle" x="1237" y="-761.05" font-family="Times,serif" font-size="14.00">GPUs: 18&#45;26 → 27&#45;34</text>
<text text-anchor="middle" x="1237" y="-746.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-731.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage2_layer71_moe&#45;&gt;comm_2_3 -->
<g id="edge23" class="edge">
<title>stage2_layer71_moe&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M1237,-842.09C1237,-833.84 1237,-824.76 1237,-815.71"/>
<polygon fill="black" stroke="black" points="1240.5,-815.56 1237,-805.56 1233.5,-815.56 1240.5,-815.56"/>
</g>
<!-- stage3_layer72_attn -->
<g id="node21" class="node">
<title>stage3_layer72_attn</title>
<polygon fill="lightcoral" stroke="black" points="1436.5,-493.17 1037.5,-493.17 1037.5,-425.17 1436.5,-425.17 1436.5,-493.17"/>
<text text-anchor="middle" x="1237" y="-477.97" font-family="Times,serif" font-size="14.00">Layer 72 Attention + KV Cache</text>
<text text-anchor="middle" x="1237" y="-462.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="1237" y="-447.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-432.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage3_layer72_gate -->
<g id="node22" class="node">
<title>stage3_layer72_gate</title>
<polygon fill="orange" stroke="black" points="1638.45,-388.17 999.83,-388.17 835.55,-252.17 1474.17,-252.17 1638.45,-388.17"/>
<text text-anchor="middle" x="1237" y="-338.97" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="1237" y="-323.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="1237" y="-308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage3_layer72_attn&#45;&gt;stage3_layer72_gate -->
<g id="edge26" class="edge">
<title>stage3_layer72_attn&#45;&gt;stage3_layer72_gate</title>
<path fill="none" stroke="black" d="M1237,-425C1237,-416.86 1237,-407.8 1237,-398.52"/>
<polygon fill="black" stroke="black" points="1240.5,-398.4 1237,-388.4 1233.5,-398.4 1240.5,-398.4"/>
</g>
<!-- stage3_layer72_moe -->
<g id="node23" class="node">
<title>stage3_layer72_moe</title>
<polygon fill="lightcoral" stroke="black" points="1436.5,-201.17 1037.5,-201.17 1037.5,-133.17 1436.5,-133.17 1436.5,-201.17"/>
<text text-anchor="middle" x="1237" y="-185.97" font-family="Times,serif" font-size="14.00">Layer 72 MoE (128 experts)</text>
<text text-anchor="middle" x="1237" y="-170.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="1237" y="-155.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="1237" y="-140.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage3_layer72_gate&#45;&gt;stage3_layer72_moe -->
<g id="edge27" class="edge">
<title>stage3_layer72_gate&#45;&gt;stage3_layer72_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1237,-252.06C1237,-238.27 1237,-224.11 1237,-211.44"/>
<polygon fill="black" stroke="black" points="1240.5,-211.19 1237,-201.19 1233.5,-211.19 1240.5,-211.19"/>
<text text-anchor="middle" x="1316.5" y="-222.97" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- stage3_layer93_attn -->
<g id="node24" class="node">
<title>stage3_layer93_attn</title>
<polygon fill="lightcoral" stroke="black" points="616.5,-493.17 217.5,-493.17 217.5,-425.17 616.5,-425.17 616.5,-493.17"/>
<text text-anchor="middle" x="417" y="-477.97" font-family="Times,serif" font-size="14.00">Layer 93 Attention + KV Cache</text>
<text text-anchor="middle" x="417" y="-462.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="417" y="-447.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="417" y="-432.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage3_layer93_gate -->
<g id="node25" class="node">
<title>stage3_layer93_gate</title>
<polygon fill="orange" stroke="black" points="818.45,-388.17 179.83,-388.17 15.55,-252.17 654.17,-252.17 818.45,-388.17"/>
<text text-anchor="middle" x="417" y="-338.97" font-family="Times,serif" font-size="14.00">Gate Selection (Top&#45;8)</text>
<text text-anchor="middle" x="417" y="-323.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="417" y="-308.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="417" y="-293.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, top_k=8]</text>
</g>
<!-- stage3_layer93_attn&#45;&gt;stage3_layer93_gate -->
<g id="edge28" class="edge">
<title>stage3_layer93_attn&#45;&gt;stage3_layer93_gate</title>
<path fill="none" stroke="black" d="M417,-425C417,-416.86 417,-407.8 417,-398.52"/>
<polygon fill="black" stroke="black" points="420.5,-398.4 417,-388.4 413.5,-398.4 420.5,-398.4"/>
</g>
<!-- stage3_layer93_moe -->
<g id="node26" class="node">
<title>stage3_layer93_moe</title>
<polygon fill="lightcoral" stroke="black" points="616.5,-201.17 217.5,-201.17 217.5,-133.17 616.5,-133.17 616.5,-201.17"/>
<text text-anchor="middle" x="417" y="-185.97" font-family="Times,serif" font-size="14.00">Layer 93 MoE (128 experts)</text>
<text text-anchor="middle" x="417" y="-170.97" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="417" y="-155.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="417" y="-140.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, d_model=4096]</text>
</g>
<!-- stage3_layer93_gate&#45;&gt;stage3_layer93_moe -->
<g id="edge29" class="edge">
<title>stage3_layer93_gate&#45;&gt;stage3_layer93_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M417,-252.06C417,-238.27 417,-224.11 417,-211.44"/>
<polygon fill="black" stroke="black" points="420.5,-211.19 417,-201.19 413.5,-211.19 420.5,-211.19"/>
<text text-anchor="middle" x="496.5" y="-222.97" font-family="Times,serif" font-size="14.00">Top&#45;8 expert selection</text>
</g>
<!-- output -->
<g id="node27" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="417" cy="-48.08" rx="306.77" ry="48.17"/>
<text text-anchor="middle" x="417" y="-66.88" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="417" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="417" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="417" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1, vocab_size=151936]</text>
</g>
<!-- stage3_layer93_moe&#45;&gt;output -->
<g id="edge30" class="edge">
<title>stage3_layer93_moe&#45;&gt;output</title>
<path fill="none" stroke="black" d="M417,-132.93C417,-124.68 417,-115.59 417,-106.54"/>
<polygon fill="black" stroke="black" points="420.5,-106.39 417,-96.39 413.5,-106.39 420.5,-106.39"/>
</g>
<!-- kv_access_1 -->
<g id="node32" class="node">
<title>kv_access_1</title>
<polygon fill="lightcyan" stroke="black" points="3331.2,-2090.5 2608.67,-2090.5 2422.8,-1984.5 3145.33,-1984.5 3331.2,-2090.5"/>
<text text-anchor="middle" x="2877" y="-2048.8" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="2877" y="-2033.8" font-family="Times,serif" font-size="14.00">GPU: 9&#45;17</text>
<text text-anchor="middle" x="2877" y="-2018.8" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- comm_0_1&#45;&gt;kv_access_1 -->
<g id="edge10" class="edge">
<title>comm_0_1&#45;&gt;kv_access_1</title>
<path fill="none" stroke="black" d="M2877,-2127.37C2877,-2118.78 2877,-2109.7 2877,-2100.76"/>
<polygon fill="black" stroke="black" points="2880.5,-2100.75 2877,-2090.75 2873.5,-2100.75 2880.5,-2100.75"/>
</g>
<!-- kv_access_2 -->
<g id="node33" class="node">
<title>kv_access_2</title>
<polygon fill="lightcyan" stroke="black" points="2511.2,-1381.33 1788.67,-1381.33 1602.8,-1275.33 2325.33,-1275.33 2511.2,-1381.33"/>
<text text-anchor="middle" x="2057" y="-1339.63" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="2057" y="-1324.63" font-family="Times,serif" font-size="14.00">GPU: 18&#45;26</text>
<text text-anchor="middle" x="2057" y="-1309.63" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- comm_1_2&#45;&gt;kv_access_2 -->
<g id="edge17" class="edge">
<title>comm_1_2&#45;&gt;kv_access_2</title>
<path fill="none" stroke="black" d="M2057,-1418.2C2057,-1409.61 2057,-1400.53 2057,-1391.59"/>
<polygon fill="black" stroke="black" points="2060.5,-1391.58 2057,-1381.58 2053.5,-1391.58 2060.5,-1391.58"/>
</g>
<!-- kv_access_3 -->
<g id="node34" class="node">
<title>kv_access_3</title>
<polygon fill="lightcyan" stroke="black" points="1691.2,-672.17 968.67,-672.17 782.8,-566.17 1505.33,-566.17 1691.2,-672.17"/>
<text text-anchor="middle" x="1237" y="-630.47" font-family="Times,serif" font-size="14.00">KV Cache Access</text>
<text text-anchor="middle" x="1237" y="-615.47" font-family="Times,serif" font-size="14.00">GPU: 27&#45;34</text>
<text text-anchor="middle" x="1237" y="-600.47" font-family="Times,serif" font-size="14.00">Cache: [batch_size=128, seq_len=2048, heads=4, d_k=64]</text>
</g>
<!-- comm_2_3&#45;&gt;kv_access_3 -->
<g id="edge24" class="edge">
<title>comm_2_3&#45;&gt;kv_access_3</title>
<path fill="none" stroke="black" d="M1237,-709.04C1237,-700.45 1237,-691.37 1237,-682.42"/>
<polygon fill="black" stroke="black" points="1240.5,-682.41 1237,-672.41 1233.5,-682.41 1240.5,-682.41"/>
</g>
<!-- kv_access_0&#45;&gt;stage0_layer0_attn -->
<g id="edge3" class="edge">
<title>kv_access_0&#45;&gt;stage0_layer0_attn</title>
<path fill="none" stroke="black" d="M2877,-3104.49C2877,-3084.23 2877,-3061.29 2877,-3041.96"/>
<polygon fill="black" stroke="black" points="2880.5,-3041.92 2877,-3031.92 2873.5,-3041.92 2880.5,-3041.92"/>
</g>
<!-- kv_access_1&#45;&gt;stage1_layer24_attn -->
<g id="edge11" class="edge">
<title>kv_access_1&#45;&gt;stage1_layer24_attn</title>
<path fill="none" stroke="black" d="M2877,-1984.33C2877,-1964.06 2877,-1941.12 2877,-1921.79"/>
<polygon fill="black" stroke="black" points="2880.5,-1921.76 2877,-1911.76 2873.5,-1921.76 2880.5,-1921.76"/>
</g>
<!-- kv_access_2&#45;&gt;stage2_layer48_attn -->
<g id="edge18" class="edge">
<title>kv_access_2&#45;&gt;stage2_layer48_attn</title>
<path fill="none" stroke="black" d="M2057,-1275.16C2057,-1254.89 2057,-1231.95 2057,-1212.62"/>
<polygon fill="black" stroke="black" points="2060.5,-1212.59 2057,-1202.59 2053.5,-1212.59 2060.5,-1212.59"/>
</g>
<!-- kv_access_3&#45;&gt;stage3_layer72_attn -->
<g id="edge25" class="edge">
<title>kv_access_3&#45;&gt;stage3_layer72_attn</title>
<path fill="none" stroke="black" d="M1237,-565.99C1237,-545.73 1237,-522.79 1237,-503.46"/>
<polygon fill="black" stroke="black" points="1240.5,-503.42 1237,-493.42 1233.5,-503.42 1240.5,-503.42"/>
</g>
</g>
</svg>
