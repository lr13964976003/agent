<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="6000pt" height="1261pt"
 viewBox="0.00 0.00 1440.00 302.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.22 1.22) rotate(0) translate(4 1030.77)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1030.77 4921.24,-1030.77 4921.24,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M871,-907.27C871,-907.27 1193,-907.27 1193,-907.27 1199,-907.27 1205,-913.27 1205,-919.27 1205,-919.27 1205,-975.27 1205,-975.27 1205,-981.27 1199,-987.27 1193,-987.27 1193,-987.27 871,-987.27 871,-987.27 865,-987.27 859,-981.27 859,-975.27 859,-975.27 859,-919.27 859,-919.27 859,-913.27 865,-907.27 871,-907.27"/>
<text text-anchor="middle" x="1032" y="-972.07" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0_s0</title>
<path fill="none" stroke="black" d="M20,-453.5C20,-453.5 931,-453.5 931,-453.5 937,-453.5 943,-459.5 943,-465.5 943,-465.5 943,-836.77 943,-836.77 943,-842.77 937,-848.77 931,-848.77 931,-848.77 20,-848.77 20,-848.77 14,-848.77 8,-842.77 8,-836.77 8,-836.77 8,-465.5 8,-465.5 8,-459.5 14,-453.5 20,-453.5"/>
<text text-anchor="middle" x="475.5" y="-833.57" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu1_s0</title>
<path fill="none" stroke="black" d="M963,-433C963,-433 2526,-433 2526,-433 2532,-433 2538,-439 2538,-445 2538,-445 2538,-564 2538,-564 2538,-570 2532,-576 2526,-576 2526,-576 963,-576 963,-576 957,-576 951,-570 951,-564 951,-564 951,-445 951,-445 951,-439 957,-433 963,-433"/>
<text text-anchor="middle" x="1744.5" y="-560.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_tp_pairs_s0</title>
<path fill="none" stroke="black" d="M1957,-618.23C1957,-618.23 2169,-618.23 2169,-618.23 2175,-618.23 2181,-624.23 2181,-630.23 2181,-630.23 2181,-718.77 2181,-718.77 2181,-724.77 2175,-730.77 2169,-730.77 2169,-730.77 1957,-730.77 1957,-730.77 1951,-730.77 1945,-724.77 1945,-718.77 1945,-718.77 1945,-630.23 1945,-630.23 1945,-624.23 1951,-618.23 1957,-618.23"/>
<text text-anchor="middle" x="2063" y="-715.57" font-family="Times,serif" font-size="14.00">Tensor Parallel Groups</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer1_s0</title>
<path fill="none" stroke="black" d="M169,-263C169,-263 2268,-263 2268,-263 2274,-263 2280,-269 2280,-275 2280,-275 2280,-394 2280,-394 2280,-400 2274,-406 2268,-406 2268,-406 169,-406 169,-406 163,-406 157,-400 157,-394 157,-394 157,-275 157,-275 157,-269 163,-263 169,-263"/>
<text text-anchor="middle" x="1218.5" y="-390.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer2_s0</title>
<path fill="none" stroke="black" d="M1891,-875.77C1891,-875.77 3990,-875.77 3990,-875.77 3996,-875.77 4002,-881.77 4002,-887.77 4002,-887.77 4002,-1006.77 4002,-1006.77 4002,-1012.77 3996,-1018.77 3990,-1018.77 3990,-1018.77 1891,-1018.77 1891,-1018.77 1885,-1018.77 1879,-1012.77 1879,-1006.77 1879,-1006.77 1879,-887.77 1879,-887.77 1879,-881.77 1885,-875.77 1891,-875.77"/>
<text text-anchor="middle" x="2940.5" y="-1003.57" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer3_s0</title>
<path fill="none" stroke="black" d="M2558,-433C2558,-433 4657,-433 4657,-433 4663,-433 4669,-439 4669,-445 4669,-445 4669,-564 4669,-564 4669,-570 4663,-576 4657,-576 4657,-576 2558,-576 2558,-576 2552,-576 2546,-570 2546,-564 2546,-564 2546,-445 2546,-445 2546,-439 2552,-433 2558,-433"/>
<text text-anchor="middle" x="3607.5" y="-560.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_pp0_stage1</title>
<path fill="none" stroke="black" d="M4753,-130C4753,-130 4863,-130 4863,-130 4869,-130 4875,-136 4875,-142 4875,-142 4875,-224 4875,-224 4875,-230 4869,-236 4863,-236 4863,-236 4753,-236 4753,-236 4747,-236 4741,-230 4741,-224 4741,-224 4741,-142 4741,-142 4741,-136 4747,-130 4753,-130"/>
<text text-anchor="middle" x="4808" y="-220.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="4808" y="-205.8" font-family="Times,serif" font-size="14.00">Ranks 8&#45;15</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_dp1</title>
<path fill="none" stroke="black" d="M4355,-901.77C4355,-901.77 4481,-901.77 4481,-901.77 4487,-901.77 4493,-907.77 4493,-913.77 4493,-913.77 4493,-980.77 4493,-980.77 4493,-986.77 4487,-992.77 4481,-992.77 4481,-992.77 4355,-992.77 4355,-992.77 4349,-992.77 4343,-986.77 4343,-980.77 4343,-980.77 4343,-913.77 4343,-913.77 4343,-907.77 4349,-901.77 4355,-901.77"/>
<text text-anchor="middle" x="4418" y="-977.57" font-family="Times,serif" font-size="14.00">DP Group 1</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_communication</title>
<path fill="none" stroke="black" d="M3607,-278.23C3607,-278.23 4581,-278.23 4581,-278.23 4587,-278.23 4593,-284.23 4593,-290.23 4593,-290.23 4593,-378.77 4593,-378.77 4593,-384.77 4587,-390.77 4581,-390.77 4581,-390.77 3607,-390.77 3607,-390.77 3601,-390.77 3595,-384.77 3595,-378.77 3595,-378.77 3595,-290.23 3595,-290.23 3595,-284.23 3601,-278.23 3607,-278.23"/>
<text text-anchor="middle" x="4094" y="-375.57" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Communication</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_routing</title>
<path fill="none" stroke="black" d="M4083,-115C4083,-115 4721,-115 4721,-115 4727,-115 4733,-121 4733,-127 4733,-127 4733,-224 4733,-224 4733,-230 4727,-236 4721,-236 4721,-236 4083,-236 4083,-236 4077,-236 4071,-230 4071,-224 4071,-224 4071,-127 4071,-127 4071,-121 4077,-115 4083,-115"/>
<text text-anchor="middle" x="4402" y="-220.8" font-family="Times,serif" font-size="14.00">Routing &amp; Aggregation</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M4084,-8C4084,-8 4372,-8 4372,-8 4378,-8 4384,-14 4384,-20 4384,-20 4384,-76 4384,-76 4384,-82 4378,-88 4372,-88 4372,-88 4084,-88 4084,-88 4078,-88 4072,-82 4072,-76 4072,-76 4072,-20 4072,-20 4072,-14 4078,-8 4084,-8"/>
<text text-anchor="middle" x="4228" y="-72.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="1197,-956.27 867,-956.27 867,-915.27 1197,-915.27 1197,-956.27"/>
<text text-anchor="middle" x="1032" y="-944.27" font-family="Times,serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="1032" y="-933.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1032" y="-922.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gpu0_embed -->
<g id="node2" class="node">
<title>gpu0_embed</title>
<polygon fill="lightgreen" stroke="black" points="935,-817.77 619,-817.77 619,-765.77 935,-765.77 935,-817.77"/>
<text text-anchor="middle" x="777" y="-805.77" font-family="Times,serif" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="777" y="-794.77" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="777" y="-783.77" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="777" y="-772.77" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- input&#45;&gt;gpu0_embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;gpu0_embed</title>
<path fill="none" stroke="black" d="M996.81,-915.17C953.89,-891.27 880.89,-850.62 830.88,-822.77"/>
<polygon fill="black" stroke="black" points="832.57,-819.71 822.13,-817.9 829.17,-825.82 832.57,-819.71"/>
<text text-anchor="middle" x="926" y="-859.37" font-family="Times,serif" font-size="8.00">batch split</text>
</g>
<!-- gpu1_embed -->
<g id="node6" class="node">
<title>gpu1_embed</title>
<polygon fill="lightgreen" stroke="black" points="1895,-519 1579,-519 1579,-467 1895,-467 1895,-519"/>
<text text-anchor="middle" x="1737" y="-507" font-family="Times,serif" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="1737" y="-496" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1737" y="-485" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1737" y="-474" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- input&#45;&gt;gpu1_embed -->
<g id="edge2" class="edge">
<title>input&#45;&gt;gpu1_embed</title>
<path fill="none" stroke="black" d="M1031.53,-915.25C1031.24,-854.01 1039.63,-664.92 1150,-584 1168.82,-570.2 1547.32,-581.5 1570,-576 1612.75,-565.64 1657.28,-543.09 1689.6,-524.26"/>
<polygon fill="black" stroke="black" points="1691.56,-527.17 1698.38,-519.06 1687.99,-521.15 1691.56,-527.17"/>
<text text-anchor="middle" x="1075" y="-741.37" font-family="Times,serif" font-size="8.00">batch split</text>
</g>
<!-- gpu0_l0_attn -->
<g id="node3" class="node">
<title>gpu0_l0_attn</title>
<polygon fill="lightgreen" stroke="black" points="934.5,-689 635.5,-689 635.5,-637 934.5,-637 934.5,-689"/>
<text text-anchor="middle" x="785" y="-677" font-family="Times,serif" font-size="10.00">Layer 0 Attention</text>
<text text-anchor="middle" x="785" y="-666" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="785" y="-655" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="785" y="-644" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu0_embed&#45;&gt;gpu0_l0_attn -->
<g id="edge3" class="edge">
<title>gpu0_embed&#45;&gt;gpu0_l0_attn</title>
<path fill="none" stroke="black" d="M778.58,-765.72C779.77,-746.84 781.42,-720.67 782.75,-699.61"/>
<polygon fill="black" stroke="black" points="786.26,-699.63 783.4,-689.43 779.27,-699.19 786.26,-699.63"/>
</g>
<!-- gpu0_l0_moe -->
<g id="node4" class="node">
<title>gpu0_l0_moe</title>
<polygon fill="lightgreen" stroke="black" points="934.5,-524.5 635.5,-524.5 635.5,-461.5 934.5,-461.5 934.5,-524.5"/>
<text text-anchor="middle" x="785" y="-512.5" font-family="Times,serif" font-size="10.00">Layer 0 MoE</text>
<text text-anchor="middle" x="785" y="-501.5" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="785" y="-490.5" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="785" y="-479.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="785" y="-468.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu0_l0_attn&#45;&gt;gpu0_l0_moe -->
<g id="edge4" class="edge">
<title>gpu0_l0_attn&#45;&gt;gpu0_l0_moe</title>
<path fill="none" stroke="black" d="M785,-636.85C785,-609.96 785,-566.89 785,-535.07"/>
<polygon fill="black" stroke="black" points="788.5,-534.75 785,-524.75 781.5,-534.75 788.5,-534.75"/>
</g>
<!-- tp_01_comm -->
<g id="node10" class="node">
<title>tp_01_comm</title>
<ellipse fill="lightblue" stroke="black" cx="2063" cy="-663" rx="109.7" ry="36.54"/>
<text text-anchor="middle" x="2063" y="-677" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2063" y="-666" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="2063" y="-655" font-family="Times,serif" font-size="10.00">Input: partial results</text>
<text text-anchor="middle" x="2063" y="-644" font-family="Times,serif" font-size="10.00">Output: aggregated results</text>
</g>
<!-- gpu0_l0_attn&#45;&gt;tp_01_comm -->
<g id="edge6" class="edge">
<title>gpu0_l0_attn&#45;&gt;tp_01_comm</title>
<path fill="none" stroke="black" d="M934.73,-663C1190.95,-663 1708.47,-663 1942.83,-663"/>
<polygon fill="black" stroke="black" points="1943.09,-666.5 1953.09,-663 1943.09,-659.5 1943.09,-666.5"/>
<text text-anchor="middle" x="1443.95" y="-668.6" font-family="Times,serif" font-size="8.00">partial results</text>
</g>
<!-- gpu0_l1_attn -->
<g id="node11" class="node">
<title>gpu0_l1_attn</title>
<polygon fill="lightgreen" stroke="black" points="1637.5,-349 1338.5,-349 1338.5,-297 1637.5,-297 1637.5,-349"/>
<text text-anchor="middle" x="1488" y="-337" font-family="Times,serif" font-size="10.00">Layer 1 Attention</text>
<text text-anchor="middle" x="1488" y="-326" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1488" y="-315" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="1488" y="-304" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu0_l0_moe&#45;&gt;gpu0_l1_attn -->
<g id="edge10" class="edge">
<title>gpu0_l0_moe&#45;&gt;gpu0_l1_attn</title>
<path fill="none" stroke="black" d="M855.51,-461.47C883.48,-450.65 916.26,-439.55 947,-433 1113.47,-397.53 1165.12,-451.95 1329,-406 1369.15,-394.74 1410.91,-372.74 1441.56,-354.36"/>
<polygon fill="black" stroke="black" points="1443.58,-357.23 1450.3,-349.04 1439.94,-351.25 1443.58,-357.23"/>
</g>
<!-- ep_all2all -->
<g id="node33" class="node">
<title>ep_all2all</title>
<ellipse fill="lightblue" stroke="black" cx="3942" cy="-323" rx="114.6" ry="36.54"/>
<text text-anchor="middle" x="3942" y="-337" font-family="Times,serif" font-size="10.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="3942" y="-326" font-family="Times,serif" font-size="10.00">GPUs: per EP group</text>
<text text-anchor="middle" x="3942" y="-315" font-family="Times,serif" font-size="10.00">Input: token representations</text>
<text text-anchor="middle" x="3942" y="-304" font-family="Times,serif" font-size="10.00">Output: routed tokens</text>
</g>
<!-- gpu0_l0_moe&#45;&gt;ep_all2all -->
<g id="edge16" class="edge">
<title>gpu0_l0_moe&#45;&gt;ep_all2all</title>
<path fill="none" stroke="black" d="M852.94,-461.42C881.39,-450.17 915.19,-438.77 947,-433 986.24,-425.89 3779.87,-417.66 3818,-406 3846.01,-397.43 3873.56,-380.34 3895.55,-363.97"/>
<polygon fill="black" stroke="black" points="3897.87,-366.6 3903.69,-357.75 3893.62,-361.04 3897.87,-366.6"/>
<text text-anchor="middle" x="3339" y="-416.6" font-family="Times,serif" font-size="8.00">tokens</text>
</g>
<!-- gpu0_l0_gate -->
<g id="node5" class="node">
<title>gpu0_l0_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="617.82,-715 139.28,-715 16.18,-611 494.72,-611 617.82,-715"/>
<text text-anchor="middle" x="317" y="-677" font-family="Times,serif" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="317" y="-666" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="317" y="-655" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="317" y="-644" font-family="Times,serif" font-size="10.00">Output: routing decisions</text>
</g>
<!-- gpu0_l0_gate&#45;&gt;gpu0_l0_moe -->
<g id="edge5" class="edge">
<title>gpu0_l0_gate&#45;&gt;gpu0_l0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M459.32,-610.91C534.17,-584.04 623.87,-551.84 690.17,-528.04"/>
<polygon fill="black" stroke="black" points="691.55,-531.27 699.78,-524.59 689.18,-524.68 691.55,-531.27"/>
<text text-anchor="middle" x="538" y="-586.6" font-family="Times,serif" font-size="8.00">routing</text>
</g>
<!-- gpu1_l0_attn -->
<g id="node7" class="node">
<title>gpu1_l0_attn</title>
<polygon fill="lightgreen" stroke="black" points="2212.5,-519 1913.5,-519 1913.5,-467 2212.5,-467 2212.5,-519"/>
<text text-anchor="middle" x="2063" y="-507" font-family="Times,serif" font-size="10.00">Layer 0 Attention</text>
<text text-anchor="middle" x="2063" y="-496" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2063" y="-485" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="2063" y="-474" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l0_attn&#45;&gt;tp_01_comm -->
<g id="edge7" class="edge">
<title>gpu1_l0_attn&#45;&gt;tp_01_comm</title>
<path fill="none" stroke="black" d="M2063,-519.08C2063,-544.54 2063,-584.53 2063,-615.74"/>
<polygon fill="black" stroke="black" points="2059.5,-615.96 2063,-625.96 2066.5,-615.96 2059.5,-615.96"/>
<text text-anchor="middle" x="2090.5" y="-586.6" font-family="Times,serif" font-size="8.00">partial results</text>
</g>
<!-- gpu1_l0_moe -->
<g id="node8" class="node">
<title>gpu1_l0_moe</title>
<polygon fill="lightgreen" stroke="black" points="2529.5,-524.5 2230.5,-524.5 2230.5,-461.5 2529.5,-461.5 2529.5,-524.5"/>
<text text-anchor="middle" x="2380" y="-512.5" font-family="Times,serif" font-size="10.00">Layer 0 MoE</text>
<text text-anchor="middle" x="2380" y="-501.5" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2380" y="-490.5" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2380" y="-479.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="2380" y="-468.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l1_attn -->
<g id="node13" class="node">
<title>gpu1_l1_attn</title>
<polygon fill="lightgreen" stroke="black" points="2271.5,-349 1972.5,-349 1972.5,-297 2271.5,-297 2271.5,-349"/>
<text text-anchor="middle" x="2122" y="-337" font-family="Times,serif" font-size="10.00">Layer 1 Attention</text>
<text text-anchor="middle" x="2122" y="-326" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2122" y="-315" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="2122" y="-304" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l0_moe&#45;&gt;gpu1_l1_attn -->
<g id="edge11" class="edge">
<title>gpu1_l0_moe&#45;&gt;gpu1_l1_attn</title>
<path fill="none" stroke="black" d="M2332.98,-461.38C2286.46,-431.09 2215.65,-384.98 2169.1,-354.67"/>
<polygon fill="black" stroke="black" points="2170.99,-351.72 2160.7,-349.2 2167.17,-357.59 2170.99,-351.72"/>
</g>
<!-- gpu1_l0_moe&#45;&gt;ep_all2all -->
<g id="edge17" class="edge">
<title>gpu1_l0_moe&#45;&gt;ep_all2all</title>
<path fill="none" stroke="black" d="M2448.37,-461.46C2476.74,-450.28 2510.37,-438.93 2542,-433 2681.38,-406.89 3682.64,-448.28 3818,-406 3845.85,-397.3 3873.29,-380.29 3895.24,-364.01"/>
<polygon fill="black" stroke="black" points="3897.54,-366.66 3903.38,-357.83 3893.3,-361.09 3897.54,-366.66"/>
<text text-anchor="middle" x="3782" y="-416.6" font-family="Times,serif" font-size="8.00">tokens</text>
</g>
<!-- gpu1_l0_gate -->
<g id="node9" class="node">
<title>gpu1_l0_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1560.82,-545 1082.28,-545 959.18,-441 1437.72,-441 1560.82,-545"/>
<text text-anchor="middle" x="1260" y="-507" font-family="Times,serif" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="1260" y="-496" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1260" y="-485" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="1260" y="-474" font-family="Times,serif" font-size="10.00">Output: routing decisions</text>
</g>
<!-- tp_01_comm&#45;&gt;gpu0_l0_moe -->
<g id="edge8" class="edge">
<title>tp_01_comm&#45;&gt;gpu0_l0_moe</title>
<path fill="none" stroke="black" d="M1953.93,-659C1711.47,-651.45 1134.38,-628.41 947,-576 910.11,-565.68 871.75,-546.69 841.62,-529.57"/>
<polygon fill="black" stroke="black" points="843.35,-526.54 832.94,-524.57 839.86,-532.6 843.35,-526.54"/>
<text text-anchor="middle" x="1039" y="-586.6" font-family="Times,serif" font-size="8.00">aggregated</text>
</g>
<!-- tp_01_comm&#45;&gt;gpu1_l0_moe -->
<g id="edge9" class="edge">
<title>tp_01_comm&#45;&gt;gpu1_l0_moe</title>
<path fill="none" stroke="black" d="M2120.41,-631.58C2174.69,-602.81 2256.11,-559.66 2313.26,-529.37"/>
<polygon fill="black" stroke="black" points="2315.02,-532.4 2322.22,-524.62 2311.74,-526.21 2315.02,-532.4"/>
<text text-anchor="middle" x="2225" y="-586.6" font-family="Times,serif" font-size="8.00">aggregated</text>
</g>
<!-- gpu0_l1_moe -->
<g id="node12" class="node">
<title>gpu0_l1_moe</title>
<polygon fill="lightgreen" stroke="black" points="1954.5,-354.5 1655.5,-354.5 1655.5,-291.5 1954.5,-291.5 1954.5,-354.5"/>
<text text-anchor="middle" x="1805" y="-342.5" font-family="Times,serif" font-size="10.00">Layer 1 MoE</text>
<text text-anchor="middle" x="1805" y="-331.5" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="1805" y="-320.5" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1805" y="-309.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="1805" y="-298.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l1_moe -->
<g id="node14" class="node">
<title>gpu1_l1_moe</title>
<polygon fill="lightgreen" stroke="black" points="1320.5,-354.5 1021.5,-354.5 1021.5,-291.5 1320.5,-291.5 1320.5,-354.5"/>
<text text-anchor="middle" x="1171" y="-342.5" font-family="Times,serif" font-size="10.00">Layer 1 MoE</text>
<text text-anchor="middle" x="1171" y="-331.5" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1171" y="-320.5" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1171" y="-309.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="1171" y="-298.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gate_l1_01 -->
<g id="node15" class="node">
<title>gate_l1_01</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1003.82,-375 525.28,-375 402.18,-271 880.72,-271 1003.82,-375"/>
<text text-anchor="middle" x="703" y="-337" font-family="Times,serif" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="703" y="-326" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="703" y="-315" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="703" y="-304" font-family="Times,serif" font-size="10.00">Output: routing decisions</text>
</g>
<!-- tp_l1_01_comm -->
<g id="node16" class="node">
<title>tp_l1_01_comm</title>
<ellipse fill="lightblue" stroke="black" cx="275" cy="-323" rx="109.7" ry="36.54"/>
<text text-anchor="middle" x="275" y="-337" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="275" y="-326" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="275" y="-315" font-family="Times,serif" font-size="10.00">Input: partial results</text>
<text text-anchor="middle" x="275" y="-304" font-family="Times,serif" font-size="10.00">Output: aggregated results</text>
</g>
<!-- gpu0_l2_attn -->
<g id="node17" class="node">
<title>gpu0_l2_attn</title>
<polygon fill="lightgreen" stroke="black" points="3993.5,-961.77 3694.5,-961.77 3694.5,-909.77 3993.5,-909.77 3993.5,-961.77"/>
<text text-anchor="middle" x="3844" y="-949.77" font-family="Times,serif" font-size="10.00">Layer 2 Attention</text>
<text text-anchor="middle" x="3844" y="-938.77" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3844" y="-927.77" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="3844" y="-916.77" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu0_l2_moe -->
<g id="node18" class="node">
<title>gpu0_l2_moe</title>
<polygon fill="lightgreen" stroke="black" points="3676.5,-967.27 3377.5,-967.27 3377.5,-904.27 3676.5,-904.27 3676.5,-967.27"/>
<text text-anchor="middle" x="3527" y="-955.27" font-family="Times,serif" font-size="10.00">Layer 2 MoE</text>
<text text-anchor="middle" x="3527" y="-944.27" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="3527" y="-933.27" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3527" y="-922.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="3527" y="-911.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l2_attn -->
<g id="node19" class="node">
<title>gpu1_l2_attn</title>
<polygon fill="lightgreen" stroke="black" points="3359.5,-961.77 3060.5,-961.77 3060.5,-909.77 3359.5,-909.77 3359.5,-961.77"/>
<text text-anchor="middle" x="3210" y="-949.77" font-family="Times,serif" font-size="10.00">Layer 2 Attention</text>
<text text-anchor="middle" x="3210" y="-938.77" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="3210" y="-927.77" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="3210" y="-916.77" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l2_moe -->
<g id="node20" class="node">
<title>gpu1_l2_moe</title>
<polygon fill="lightgreen" stroke="black" points="3042.5,-967.27 2743.5,-967.27 2743.5,-904.27 3042.5,-904.27 3042.5,-967.27"/>
<text text-anchor="middle" x="2893" y="-955.27" font-family="Times,serif" font-size="10.00">Layer 2 MoE</text>
<text text-anchor="middle" x="2893" y="-944.27" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2893" y="-933.27" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2893" y="-922.27" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="2893" y="-911.27" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gate_l2_01 -->
<g id="node21" class="node">
<title>gate_l2_01</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2725.82,-987.77 2247.28,-987.77 2124.18,-883.77 2602.72,-883.77 2725.82,-987.77"/>
<text text-anchor="middle" x="2425" y="-949.77" font-family="Times,serif" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="2425" y="-938.77" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="2425" y="-927.77" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="2425" y="-916.77" font-family="Times,serif" font-size="10.00">Output: routing decisions</text>
</g>
<!-- tp_l2_01_comm -->
<g id="node22" class="node">
<title>tp_l2_01_comm</title>
<ellipse fill="lightblue" stroke="black" cx="1997" cy="-935.77" rx="109.7" ry="36.54"/>
<text text-anchor="middle" x="1997" y="-949.77" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1997" y="-938.77" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="1997" y="-927.77" font-family="Times,serif" font-size="10.00">Input: partial results</text>
<text text-anchor="middle" x="1997" y="-916.77" font-family="Times,serif" font-size="10.00">Output: aggregated results</text>
</g>
<!-- gpu0_l3_attn -->
<g id="node23" class="node">
<title>gpu0_l3_attn</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-519 4361.5,-519 4361.5,-467 4660.5,-467 4660.5,-519"/>
<text text-anchor="middle" x="4511" y="-507" font-family="Times,serif" font-size="10.00">Layer 3 Attention</text>
<text text-anchor="middle" x="4511" y="-496" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4511" y="-485" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="4511" y="-474" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu0_l3_moe -->
<g id="node24" class="node">
<title>gpu0_l3_moe</title>
<polygon fill="lightgreen" stroke="black" points="4343.5,-524.5 4044.5,-524.5 4044.5,-461.5 4343.5,-461.5 4343.5,-524.5"/>
<text text-anchor="middle" x="4194" y="-512.5" font-family="Times,serif" font-size="10.00">Layer 3 MoE</text>
<text text-anchor="middle" x="4194" y="-501.5" font-family="Times,serif" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="4194" y="-490.5" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="4194" y="-479.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="4194" y="-468.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- pp_sendrecv -->
<g id="node32" class="node">
<title>pp_sendrecv</title>
<ellipse fill="lightblue" stroke="black" cx="4194" cy="-323" rx="119.5" ry="36.54"/>
<text text-anchor="middle" x="4194" y="-337" font-family="Times,serif" font-size="10.00">PP Send/Recv</text>
<text text-anchor="middle" x="4194" y="-326" font-family="Times,serif" font-size="10.00">GPUs: stage0â†’stage1</text>
<text text-anchor="middle" x="4194" y="-315" font-family="Times,serif" font-size="10.00">Input: activations</text>
<text text-anchor="middle" x="4194" y="-304" font-family="Times,serif" font-size="10.00">Output: forwarded activations</text>
</g>
<!-- gpu0_l3_moe&#45;&gt;pp_sendrecv -->
<g id="edge12" class="edge">
<title>gpu0_l3_moe&#45;&gt;pp_sendrecv</title>
<path fill="none" stroke="black" d="M4194,-461.19C4194,-435.71 4194,-399.14 4194,-370.16"/>
<polygon fill="black" stroke="black" points="4197.5,-369.87 4194,-359.87 4190.5,-369.87 4197.5,-369.87"/>
<text text-anchor="middle" x="4215.5" y="-416.6" font-family="Times,serif" font-size="8.00">activations</text>
</g>
<!-- gpu1_l3_attn -->
<g id="node25" class="node">
<title>gpu1_l3_attn</title>
<polygon fill="lightgreen" stroke="black" points="4026.5,-519 3727.5,-519 3727.5,-467 4026.5,-467 4026.5,-519"/>
<text text-anchor="middle" x="3877" y="-507" font-family="Times,serif" font-size="10.00">Layer 3 Attention</text>
<text text-anchor="middle" x="3877" y="-496" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="3877" y="-485" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="3877" y="-474" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gpu1_l3_moe -->
<g id="node26" class="node">
<title>gpu1_l3_moe</title>
<polygon fill="lightgreen" stroke="black" points="3709.5,-524.5 3410.5,-524.5 3410.5,-461.5 3709.5,-461.5 3709.5,-524.5"/>
<text text-anchor="middle" x="3560" y="-512.5" font-family="Times,serif" font-size="10.00">Layer 3 MoE</text>
<text text-anchor="middle" x="3560" y="-501.5" font-family="Times,serif" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="3560" y="-490.5" font-family="Times,serif" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3560" y="-479.5" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="3560" y="-468.5" font-family="Times,serif" font-size="10.00">Output: [batch_size=43, seq_len=10240, d_model=512]</text>
</g>
<!-- gate_l3_01 -->
<g id="node27" class="node">
<title>gate_l3_01</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3392.82,-545 2914.28,-545 2791.18,-441 3269.72,-441 3392.82,-545"/>
<text text-anchor="middle" x="3092" y="-507" font-family="Times,serif" font-size="10.00">Gate Router</text>
<text text-anchor="middle" x="3092" y="-496" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="3092" y="-485" font-family="Times,serif" font-size="10.00">Input: [batch_size=43, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="3092" y="-474" font-family="Times,serif" font-size="10.00">Output: routing decisions</text>
</g>
<!-- tp_l3_01_comm -->
<g id="node28" class="node">
<title>tp_l3_01_comm</title>
<ellipse fill="lightblue" stroke="black" cx="2664" cy="-493" rx="109.7" ry="36.54"/>
<text text-anchor="middle" x="2664" y="-507" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2664" y="-496" font-family="Times,serif" font-size="10.00">GPUs: 0,1</text>
<text text-anchor="middle" x="2664" y="-485" font-family="Times,serif" font-size="10.00">Input: partial results</text>
<text text-anchor="middle" x="2664" y="-474" font-family="Times,serif" font-size="10.00">Output: aggregated results</text>
</g>
<!-- pp0_s1_summary -->
<g id="node29" class="node">
<title>pp0_s1_summary</title>
<polygon fill="lightgray" stroke="black" points="4852.5,-190 4749.5,-190 4749.5,-138 4852.5,-138 4852.5,-190"/>
<text text-anchor="middle" x="4801" y="-178" font-family="Times,serif" font-size="10.00">Layers 8&#45;15</text>
<text text-anchor="middle" x="4801" y="-167" font-family="Times,serif" font-size="10.00">GPUs: 8&#45;15</text>
<text text-anchor="middle" x="4801" y="-156" font-family="Times,serif" font-size="10.00">Similar structure</text>
<text text-anchor="middle" x="4801" y="-145" font-family="Times,serif" font-size="10.00">8 layers per GPU</text>
</g>
<!-- dp1_summary -->
<g id="node30" class="node">
<title>dp1_summary</title>
<polygon fill="lightgray" stroke="black" points="4484.5,-961.77 4351.5,-961.77 4351.5,-909.77 4484.5,-909.77 4484.5,-961.77"/>
<text text-anchor="middle" x="4418" y="-949.77" font-family="Times,serif" font-size="10.00">DP Group 1</text>
<text text-anchor="middle" x="4418" y="-938.77" font-family="Times,serif" font-size="10.00">Ranks 16&#45;23</text>
<text text-anchor="middle" x="4418" y="-927.77" font-family="Times,serif" font-size="10.00">Same structure as DP0</text>
<text text-anchor="middle" x="4418" y="-916.77" font-family="Times,serif" font-size="10.00">Duplicate computation</text>
</g>
<!-- dp_allreduce -->
<g id="node31" class="node">
<title>dp_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="4458" cy="-323" rx="126.64" ry="36.54"/>
<text text-anchor="middle" x="4458" y="-337" font-family="Times,serif" font-size="10.00">DP All&#45;Sum</text>
<text text-anchor="middle" x="4458" y="-326" font-family="Times,serif" font-size="10.00">GPUs: 0&#45;23</text>
<text text-anchor="middle" x="4458" y="-315" font-family="Times,serif" font-size="10.00">Input: gradient chunks</text>
<text text-anchor="middle" x="4458" y="-304" font-family="Times,serif" font-size="10.00">Output: synchronized gradients</text>
</g>
<!-- global_agg -->
<g id="node35" class="node">
<title>global_agg</title>
<polygon fill="lightyellow" stroke="black" points="4377.09,-205 4139.92,-205 4078.91,-123 4316.08,-123 4377.09,-205"/>
<text text-anchor="middle" x="4228" y="-172.5" font-family="Times,serif" font-size="10.00">Global Aggregation</text>
<text text-anchor="middle" x="4228" y="-161.5" font-family="Times,serif" font-size="10.00">Input: distributed results</text>
<text text-anchor="middle" x="4228" y="-150.5" font-family="Times,serif" font-size="10.00">Output: final predictions</text>
</g>
<!-- dp_allreduce&#45;&gt;global_agg -->
<g id="edge18" class="edge">
<title>dp_allreduce&#45;&gt;global_agg</title>
<path fill="none" stroke="black" d="M4389.33,-291.96C4368.07,-282.67 4344.57,-272.4 4323,-263 4312.78,-258.55 4308.89,-259.72 4300,-253 4285.52,-242.05 4272.16,-227.61 4260.97,-213.61"/>
<polygon fill="black" stroke="black" points="4263.54,-211.2 4254.65,-205.44 4258,-215.49 4263.54,-211.2"/>
<text text-anchor="middle" x="4327" y="-246.6" font-family="Times,serif" font-size="8.00">synchronized</text>
</g>
<!-- pp_sendrecv&#45;&gt;pp0_s1_summary -->
<g id="edge13" class="edge">
<title>pp_sendrecv&#45;&gt;pp0_s1_summary</title>
<path fill="none" stroke="black" d="M4250.65,-290.45C4272.33,-279.85 4297.69,-269.17 4322,-263 4411.58,-240.28 4653.83,-276.29 4737,-236 4754.1,-227.71 4768.71,-212.63 4779.64,-198.49"/>
<polygon fill="black" stroke="black" points="4782.53,-200.47 4785.63,-190.34 4776.89,-196.32 4782.53,-200.47"/>
<text text-anchor="middle" x="4735" y="-246.6" font-family="Times,serif" font-size="8.00">forwarded</text>
</g>
<!-- tp_allreduce -->
<g id="node34" class="node">
<title>tp_allreduce</title>
<ellipse fill="lightblue" stroke="black" cx="3706" cy="-323" rx="103.48" ry="36.54"/>
<text text-anchor="middle" x="3706" y="-337" font-family="Times,serif" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3706" y="-326" font-family="Times,serif" font-size="10.00">GPUs: per TP pair</text>
<text text-anchor="middle" x="3706" y="-315" font-family="Times,serif" font-size="10.00">Input: partial tensors</text>
<text text-anchor="middle" x="3706" y="-304" font-family="Times,serif" font-size="10.00">Output: complete tensors</text>
</g>
<!-- output -->
<g id="node37" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="4376,-57 4080,-57 4080,-16 4376,-16 4376,-57"/>
<text text-anchor="middle" x="4228" y="-45" font-family="Times,serif" font-size="10.00">Output</text>
<text text-anchor="middle" x="4228" y="-34" font-family="Times,serif" font-size="10.00">Input: [batch_size=128, seq_len=10240, d_model=512]</text>
<text text-anchor="middle" x="4228" y="-23" font-family="Times,serif" font-size="10.00">Output: [batch_size=128, seq_len=10240, vocab_size]</text>
</g>
<!-- global_agg&#45;&gt;output -->
<g id="edge19" class="edge">
<title>global_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4228,-122.95C4228,-104.94 4228,-84.05 4228,-67.43"/>
<polygon fill="black" stroke="black" points="4231.5,-67.21 4228,-57.21 4224.5,-67.21 4231.5,-67.21"/>
<text text-anchor="middle" x="4249.5" y="-98.6" font-family="Times,serif" font-size="8.00">final result</text>
</g>
<!-- load_balance -->
<g id="node36" class="node">
<title>load_balance</title>
<polygon fill="lightyellow" stroke="black" points="4724.69,-205 4462.71,-205 4395.31,-123 4657.29,-123 4724.69,-205"/>
<text text-anchor="middle" x="4560" y="-172.5" font-family="Times,serif" font-size="10.00">Load Balancer</text>
<text text-anchor="middle" x="4560" y="-161.5" font-family="Times,serif" font-size="10.00">Input: GPU loads</text>
<text text-anchor="middle" x="4560" y="-150.5" font-family="Times,serif" font-size="10.00">Output: balancing decisions</text>
</g>
<!-- gate_l0_01 -->
<g id="node40" class="node">
<title>gate_l0_01</title>
<polygon fill="lightyellow" stroke="black" points="4621.06,-54.5 4523.93,-54.5 4498.94,-18.5 4596.07,-18.5 4621.06,-54.5"/>
<text text-anchor="middle" x="4560" y="-34" font-family="Times,serif" font-size="10.00">gate_l0_01</text>
</g>
<!-- load_balance&#45;&gt;gate_l0_01 -->
<g id="edge20" class="edge">
<title>load_balance&#45;&gt;gate_l0_01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4560,-122.95C4560,-104 4560,-81.86 4560,-64.86"/>
<polygon fill="black" stroke="black" points="4563.5,-64.52 4560,-54.52 4556.5,-64.52 4563.5,-64.52"/>
<text text-anchor="middle" x="4580" y="-98.6" font-family="Times,serif" font-size="8.00">balancing</text>
</g>
<!-- dp0_final -->
<g id="node38" class="node">
<title>dp0_final</title>
<polygon fill="lightyellow" stroke="black" points="4789.48,-511 4701.23,-511 4678.52,-475 4766.77,-475 4789.48,-511"/>
<text text-anchor="middle" x="4734" y="-490.5" font-family="Times,serif" font-size="10.00">dp0_final</text>
</g>
<!-- dp0_final&#45;&gt;dp_allreduce -->
<g id="edge14" class="edge">
<title>dp0_final&#45;&gt;dp_allreduce</title>
<path fill="none" stroke="black" d="M4718.87,-474.81C4707.18,-462.2 4690.16,-445.22 4673,-433 4631.33,-403.32 4580.43,-377.12 4538.61,-357.86"/>
<polygon fill="black" stroke="black" points="4539.84,-354.57 4529.29,-353.61 4536.94,-360.94 4539.84,-354.57"/>
<text text-anchor="middle" x="4675" y="-416.6" font-family="Times,serif" font-size="8.00">gradients</text>
</g>
<!-- dp1_final -->
<g id="node39" class="node">
<title>dp1_final</title>
<polygon fill="lightyellow" stroke="black" points="4917.48,-511 4829.23,-511 4806.52,-475 4894.77,-475 4917.48,-511"/>
<text text-anchor="middle" x="4862" y="-490.5" font-family="Times,serif" font-size="10.00">dp1_final</text>
</g>
<!-- dp1_final&#45;&gt;dp_allreduce -->
<g id="edge15" class="edge">
<title>dp1_final&#45;&gt;dp_allreduce</title>
<path fill="none" stroke="black" d="M4847.27,-474.83C4835.2,-461.73 4817.06,-444.11 4798,-433 4727.42,-391.88 4639.42,-364.22 4570.63,-347.05"/>
<polygon fill="black" stroke="black" points="4571.17,-343.57 4560.63,-344.59 4569.5,-350.37 4571.17,-343.57"/>
<text text-anchor="middle" x="4791" y="-416.6" font-family="Times,serif" font-size="8.00">gradients</text>
</g>
</g>
</svg>
